{"total":19203,"page":1,"pagesize":100,"questions":[{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13297995,"title":"changing font size and direction of axes text in ggplot2","body":"<p>I am plotting a graph with a categorical variable on the x axis and a numerical variable on the y axis. For the x axis, given that there are many data points, the default text formatting causes the label for each tick mark to overlap with other labels. How do I (a) change the font size for my axis text and (b) change the orientation of the text so that the text is perpendicular to the axis.\nThanks,\nAnjan</p>\n"},{"tags":["r","date","ggplot2","epoch","chron"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2,"score":0,"question_id":13298614,"title":"Trouble with placing and formatting dates in ggplot2 graph using chron","body":"<p>I've been trying to add appropriate dates on the x-axis of my graph, but can't figure out how to do it in a sane way. What I want is pretty simple: a date at every January 1st in between the minimum and maximum of my data set.</p>\n\n<p>I don't want to include the month - just '2008' or '2009' or whatever is fine. A great example would be this graph:</p>\n\n<p><a href=\"http://blog.stephenwolfram.com/data/uploads/2012/03/outgoing-mail-diurnal-image.png\" rel=\"nofollow\">example graph</a></p>\n\n<p>Except I want the date on every year, rather than every other year.</p>\n\n<p>I can't seem to figure this out. My dates are defined as days since 1/1/1970, and I've included a method <code>dateEPOCH_formatter</code> which converts the epoch format to a format using the chron package. I've figured out how to make a tick mark and date at the origin of the graph and every 365 days thereafter, but that's not quite the same thing.</p>\n\n<p>Another minor problem is that, mysteriously, the line <code>chron(floor(y), out.format=\"mon year\",origin.=epoch)</code> outputs a graph with axis markers like 'Mar 2008', but changing the line to <code>chron(floor(y), out.format=\"year\",origin.=epoch)</code> doesn't give me a result like '2008' - it just results in the error:</p>\n\n<pre><code>Error in parse.format(format[1]) : unrecognized format year\nCalls: print ... as.character.times -&gt; format -&gt; format.dates -&gt; parse.format\nExecution halted\n</code></pre>\n\n<p>Here's my code - thanks for the help.</p>\n\n<pre><code>library(ggplot2)\nlibrary(chron)\nargv &lt;- commandArgs(trailingOnly = TRUE)\nmydata = read.csv(argv[1])\npng(argv[2], height=300, width=470)\n\n\ntimeHMS_formatter &lt;- function(x) {                  # Takes time in seconds from midnight, converts to HH:MM:SS\nh &lt;- floor(x/3600)\nm &lt;- floor(x %% 60)\ns &lt;- round(60*(x %% 1))                         # Round to nearest second\nlab &lt;- sprintf('%02d:%02d', h, m, s)        # Format the strings as HH:MM:SS\nlab &lt;- gsub('^00:', '', lab)                    # Remove leading 00: if present\nlab &lt;- gsub('^0', '', lab)                      # Remove leading 0 if present\n}\n\ndateEPOCH_formatter &lt;- function (y){\nepoch &lt;- c(month=1,day=1,year=1970)\n    chron(floor(y), out.format=\"mon year\",origin.=epoch)\n}\n\np=  ggplot() + \ncoord_cartesian(xlim=c(min(mydata$day),max(mydata$day)), ylim=c(0,86400)) +         # displays data from first email through present\nscale_color_hue() +\nxlab(\"Date\") +\nylab(\"Time of Day\") +\nscale_y_continuous(label=timeHMS_formatter, breaks=seq(0, 86400, 14400)) +              # adds tick marks every 4 hours\nscale_x_continuous(label=dateEPOCH_formatter, breaks=seq(min(mydata$day), max(mydata$day), 365) ) +\nggtitle(\"Email Sending Times\") +                                                        # adds graph title\ntheme( legend.position = \"none\", axis.title.x = element_text(vjust=-0.3)) +\ntheme_bw() +\nlayer(\n    data=mydata, \n    mapping=aes(x=mydata$day, y=mydata$seconds), \n    stat=\"identity\", \n    stat_params=list(), \n    geom=\"point\", \n    geom_params=list(alpha=5/8, size=2, color=\"#A9203E\"),\n    position=position_identity(),\n)   \n\nprint(p)\ndev.off()\n</code></pre>\n"},{"tags":["r","ggplot2","reshape2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13295697,"title":"Reshape/melt a dataframe for scatter plot","body":"<p>I have a data file that looks like this:</p>\n\n<pre><code>x   ys ---------------------&gt;\n1   20   25   30   12   22   12\n2   12    9   12   32   12 \n3   33   12   11    6    1\n4    5   10   41   12    3\n5    7   81   12   31    8   3   4   11\n</code></pre>\n\n<p>I'd like to make a scatter plot with one x value and multiple y values (ys).  I was trying to use reshape with melt, but I couldn't get the proper data structure created to make this plot. How can I do this in R and plot with ggplot? Thanks for the help.</p>\n"},{"tags":["r","graph"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13295855,"title":"Plotting Multiple Graphs using R","body":"<p>I currently have a dataset which has a format of: (x, y, type)</p>\n\n<p>I've used the code that is found on the example <a href=\"http://www.varlena.com/GeneralBits/Tidbits/bernier/art_66/graphingWithR.html\" rel=\"nofollow\">of plotting with Postgres through R.</a> </p>\n\n<p>My question is: How would I get R to generate multiple graphs for each unique \"type\" column?</p>\n\n<p>I'm new to R, so my appologies if this is something that is extremely easy and I just lack the understanding of loops with R.</p>\n\n<p>So lets say we have this data: </p>\n\n<pre><code>(1,1,T), (1,2,T), (1,3,T), (1,4,T), (1,5,T), (1,6,T), \n(1,1,A), (1,2,B), (1,3,B), (1,4,B), (1,5,A), (1,6,A), \n(1,1,B), (1,2,B), (1,3,C), (1,4,C), (1,5,C), (1,6,C), \n</code></pre>\n\n<p>It would plot 4 individual graphs on the page. One for each of the types T, A, B, and C. [Ploting x,y]</p>\n\n<p>How would I do that with R when the data coming in may look like the data above? </p>\n"},{"tags":["r","ggplot2","robust"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13259357,"title":"Using ggplot2 to plot predicted values with robust standard errors","body":"<p>I am trying to use ggplot2 to plot the predicted values of negative binomial regression, one with a binary variable turned on, and another with it turned off. So there will be two two plots that can be compared.</p>\n\n<p>The link <a href=\"http://www.ats.ucla.edu/stat/r/dae/nbreg.htm\" rel=\"nofollow\">here</a> demonstrates how to do it at the bottom of the page, but I want to be able to create shading around the plot of the predicted values using robust standard errors.  I don't see how to get this from the predict() function.  Is there any work around from this code example to get robust standard errors to shade around the plotted lines?</p>\n\n<p>I use the code here from <a href=\"http://www.ats.ucla.edu/stat/r/dae/poissonreg.htm\" rel=\"nofollow\">this site</a> to generate robust standard errors:</p>\n\n<pre><code>require(sandwich)\ncov.nb1 &lt;- vcovHC(nb1, type = \"HC0\")\nstd.err &lt;- sqrt(diag(cov.nb1))\nr.est &lt;- cbind(Estimate = coef(nb1), `Robust SE` = std.err, `Pr(&gt;|z|)` = 2 *\n    pnorm(abs(coef(nb1)/std.err), lower.tail = FALSE), LL = coef(nb1) - 1.96 *\n    std.err, UL = coef(nb1) + 1.96 * std.err)\n\nr.est\n</code></pre>\n\n<p>the model I am using is this:</p>\n\n<pre><code>nb1 &lt;- glm.nb(citecount ~ expbin*novcr + expbin*I(novcr^2) + disease + length +\nas.factor(year), data = nov4d.dt)\n</code></pre>\n\n<p>And a sample of the data I am using is this:</p>\n\n<pre><code>nov4d.dt  &lt;-\n    structure(list(PMID = c(1279136L, 1279186L, 1279186L, 1279187L, \n    1279187L, 1279190L, 1279257L, 1279317L, 1279332L, 1279523L), \n        min = c(0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L), max = c(32L, \n        32L, 32L, 32L, 32L, 32L, 32L, 32L, 32L, 32L), mean = c(11L, \n        13L, 13L, 19L, 19L, 16L, 24L, 15L, 8L, 19L), length = c(45L, \n        120L, 120L, 78L, 78L, 136L, 45L, 36L, 171L, 78L), threslength = c(13L, \n        20L, 20L, 7L, 7L, 26L, 4L, 6L, 77L, 14L), novlength = c(5L, \n        6L, 6L, 3L, 3L, 6L, 3L, 3L, 36L, 5L), novind = c(\"TRUE\", \n        \"TRUE\", \"TRUE\", \"TRUE\", \"TRUE\", \"TRUE\", \"TRUE\", \"TRUE\", \"TRUE\", \n        \"TRUE\"), novcr = c(0.111111, 0.05, 0.05, 0.0384615, 0.0384615, \n        0.0441176, 0.0666667, 0.0833333, 0.210526, 0.0641026), novcrt = c(0.288889, \n        0.166667, 0.166667, 0.0897436, 0.0897436, 0.191176, 0.0888889, \n        0.166667, 0.450292, 0.179487), year = c(1991L, 1991L, 1992L, \n        1992L, 1992L, 1992L, 1992L, 1992L, 1991L, 1992L), disease = structure(c(1L, \n        4L, 2L, 4L, 2L, 1L, 4L, 4L, 2L, 4L), .Label = c(\"alz\", \"bc\", \n        \"cl\", \"lc\"), class = \"factor\"), citecount = c(5L, 8L, 8L, \n        12L, 12L, 0L, 1L, 0L, 92L, 0L), novind2 = c(TRUE, TRUE, TRUE, \n        TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE), rad = c(FALSE, \n        FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE\n        ), exp = c(260, 351, 351, 65, 65, 480, 104, 273, 223, 0), \n        novind4 = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, \n        FALSE, TRUE, FALSE), novind5 = c(FALSE, FALSE, FALSE, FALSE, \n        FALSE, FALSE, FALSE, FALSE, TRUE, FALSE), novind6 = c(FALSE, \n        FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE\n        ), expbin = c(TRUE, TRUE, TRUE, FALSE, FALSE, TRUE, FALSE, \n        TRUE, TRUE, FALSE), expbin2 = c(TRUE, TRUE, TRUE, FALSE, \n        FALSE, TRUE, FALSE, TRUE, TRUE, FALSE)), .Names = c(\"PMID\", \n    \"min\", \"max\", \"mean\", \"length\", \"threslength\", \"novlength\", \"novind\", \n    \"novcr\", \"novcrt\", \"year\", \"disease\", \"citecount\", \"novind2\", \n    \"rad\", \"exp\", \"novind4\", \"novind5\", \"novind6\", \"expbin\", \"expbin2\"\n    ), sorted = \"PMID\", class = c(\"data.frame\"), row.names = c(NA, \n    -10L))\n</code></pre>\n"},{"tags":["r","reference-class"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":25,"score":3,"question_id":13297841,"title":"R testing for reference classes","body":"<p>Is there a quick and dirty way to test whether an instance is from an (R5) reference class?</p>\n\n<p>The standard R object tests yield the following - but nothing that seems to exclusively mark a reference class.</p>\n\n<pre><code>classy &lt;- setRefClass('classy',\n    fields = list(\n        count = 'numeric'\n    ),\n    methods = list(\n        initialize = function( data=NULL ) {\n            .self$data &lt;&lt;- data\n        }\n    )\n)\n\ninstance &lt;- classy$new() # instantiation\n\nisS4(instance) # TRUE\nmode(instance) # \"S4\"\ntypeof(instance) # \"S4\"\nclass(instance) # [1] \"classy\" attr(,\"package\") [1] \".GlobalEnv\"\ndput(instance) # new(\"classy\", .xData = &lt;environment&gt;)\nstr(instance) # \n# Reference class 'classy' [package \".GlobalEnv\"] with 1 fields\n#  $ count: num(0) \n#  and 13 methods, of which 1 are possibly relevant:\n#    initialize\n</code></pre>\n"},{"tags":["r","reference-class"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13115913,"title":"Instantiation of reference classes within reference classes - problems with lock() and immutability","body":"<p>I have come across some behaviour from R reference classes I would like to work around. In the following code, reference class B has two fields of reference class A in it. </p>\n\n<p>These fields in B appear to be instantiated (possibly twice) with a zero-argument (default) versions of reference class A before B's <code>initialize()</code> method is called. These instances are then replaced with the correct versions of instance A during B's initialization process. The problem is that if I use <code>lock()</code> from B's instance generator, the initial empty instantiation's of A cannot be replaced in B. Another problem is that reference class A needs a default value in initialize [or a missing(c) test]. </p>\n\n<p>Help - suggestions - etc. appreciated.</p>\n\n<pre><code>A &lt;- setRefClass('A',\n    fields = list(\n        count = 'numeric'\n    ),\n\n    methods = list(\n        initialize = function (c=0) {\n            cat('DEBUG: A$initialize(c); where c=');  cat(c); cat('\\n')\n            count &lt;&lt;- c\n        }\n    )\n)\n\ninstance.of.A &lt;- A$new(10)\nstr(instance.of.A)\n\nB &lt;- setRefClass('B',\n    field = list(\n        a = 'A',\n        b = 'A'\n    ),\n\n    methods = list(\n        initialize = function(c) {\n            a &lt;&lt;- instance.of.A\n            b &lt;&lt;- getRefClass('A')$new(c)\n        }\n    )\n)\n\ninstance.of.b &lt;- B$new(100)\nstr(instance.of.b)\n</code></pre>\n"},{"tags":["r","ssh","parallel-processing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13297848,"title":"Remote R process Dies","body":"<p>I am running R on an Ubuntu machine and trying to utilize a remote Ubuntu machine for parallel processing. I can ssh to the remote machine.</p>\n\n<pre><code>hosts=\"remoteIPaddress\"; cluster=makeCluster(hosts, type=\"PSOCK\",user=\"myusername\",master=\"mylocalIPaddress\"); registerDoParallel(cluster); foreach(i=1:100,.combine=\"rbind\") %dopar% i^2\n</code></pre>\n\n<p>The makeCluster command prompts me for my password and on the remote machine I can see an R process start when this is entered. This process immediately dies and when I run the foreach command, I get \"Error in unserialize(node$con) : error reading from connection\". Does anyone know what is going on?</p>\n\n<blockquote>\n  <p>sessionInfo()\n  R version 2.15.1 (2012-06-22)\n  Platform: x86_64-pc-linux-gnu (64-bit)</p>\n</blockquote>\n\n<p>locale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8<br>\n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    LC_PAPER=C                 LC_NAME=C<br>\n [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </p>\n\n<p>attached base packages:\n[1] grDevices datasets  grid      parallel  utils     stats     graphics  methods   base     </p>\n\n<p>other attached packages:\n [1] quantmod_0.3-17              TTR_0.21-1                   Defaults_1.1-1               portfolio_0.4-5<br>\n [5] nlme_3.1-104                 lattice_0.20-6               PerformanceAnalytics_1.0.4.4 xts_0.8-6<br>\n [9] zoo_1.7-8                    np_0.40-13                   cubature_1.1-1               doParallel_1.0.1<br>\n[13] iterators_1.0.6              foreach_1.4.0                boot_1.3-5                  </p>\n\n<p>loaded via a namespace (and not attached):\n[1] codetools_0.2-8 compiler_2.15.1 tools_2.15.1 </p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13294445,"title":"ggplot2 - plot multiple models on the same plot","body":"<p>I have a list of linear and non-linear models derived from different data sets measuring the same two variables <code>x</code> and <code>y</code> that I would like to plot on the same plot using <code>stat_smooth</code>. This is to be able to easily compare the shape of the relationship between <code>x</code> and <code>y</code> across datasets.</p>\n\n<p>I'm trying to figure out the most effective way to do this. Right now I am considering creating an empty ggplot object and then using some kind of loop or <code>lapply</code> to add sequentially to that object, but this is proving more difficult than I thought. Of course it would be easiest to simply supply the models to <code>ggplot</code> but as far as I know, this is not possible. Any thoughts?</p>\n\n<p>Here is a simple example data set to play with using just two models, one linear and one exponential:</p>\n\n<pre><code>df1=data.frame(x=rnorm(10),y=rnorm(10))\ndf2=data.frame(x=rnorm(15),y=rnorm(15))\n\ndf.list=list(lm(y~x,df1),nls(y~exp(a+b*x),start=list(a=1,b=1),df2))\n</code></pre>\n\n<p>And two separate example plots:</p>\n\n<pre><code>ggplot(df1,aes(x,y))+stat_smooth(method=lm,se=F)\nggplot(df2,aes(x,y))+stat_smooth(method=nls,formula=y~exp(a+b*x),start=list(a=1,b=1),se=F)\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13286699,"title":"plot a \"list\" of densities","body":"<p>I have a data.frame composed of 10 columns and 50 rows. I computed density function, column by column using the apply function. Now I would like to plot the densities I computed  at once. </p>\n\n<p>In other words, instead of plotting...</p>\n\n<pre><code>plot(den[[1]]) \nplot(den[[2]]\nplot(den[[3]]\n</code></pre>\n\n<p>...I would like to plot all the densities at once.</p>\n\n<p>I suppose I have to use the <code>lapply</code> function and probably I have to write a specific function to do this. Can anyone help me?</p>\n"},{"tags":["r","ggplot2"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13294952,"title":"left align two graph edges (ggplot)","body":"<p>I'm using ggplot and have two graphs that I want to display on top of each other.  I used <code>grid.arrange</code> from gridExtra to stack them.  The problem is I want the left edges of the graphs to align as well as the right edges regardless of axis labels.  (the problem arises because the labels of one graph are short while the other is long).</p>\n\n<p><strong>The Question:</strong><br>\nHow can I do this?  I am not married to grid.arrange but the ggplot2 is a must.  </p>\n\n<p><strong>What I've tried:</strong><br>\nI tried playing with widths and heights as well as ncol and nrow to make a 2 x 2 grid and place the visuals in opposite corners and then play with the widths but I couldn't get the visuals in opposite corners.</p>\n\n<pre><code>require(ggplot2);require(gridExtra)\nA &lt;- ggplot(CO2, aes(x=Plant)) + geom_bar() +coord_flip() \nB &lt;- ggplot(CO2, aes(x=Type)) + geom_bar() +coord_flip() \ngrid.arrange(A, B, ncol=1)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/gvnx5.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","binary-data","factor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13279524,"title":"How to call the factor level of a variable for each observation, and use those values to create a new variable in R?","body":"<p>I have a dataset with a categorical variable \"<code>hospital_code</code>\" which has 10 levels.  </p>\n\n<p>The program that I am running loops through and takes a subset of the data such that the variable \"<code>compLbl</code>\" contains exactly 2 of the 10 hospital_codes so that they can be compared to each other. I now have a situation where in each loop, I need compLbl to be binary coded (1s, and 0s).  </p>\n\n<p>If I just take the subset data from the first loop in which the possible values for compLbl are \"AMH\", and \"BJH\", I can easily do this as follows:</p>\n\n<pre><code>nData$compLbl2 = with(nData,(ifelse(compLbl == \"AMH\", 1,0)))\n</code></pre>\n\n<p>And get data that looks like this:</p>\n\n<pre><code>head(nData)\ncompLbl outLbl Race_Code Age Complexity_Subclass_Code compLbl2\n1     AMH      0         W  63                        1        1\n2     AMH      0         W  44                        2        1\n3     AMH      0         W  88                        3        1\n4     BHC      0         W  64                        1        0\n5     BHC      0         W  61                        2        0\n6     BHC      0         W  61                        1        0\n</code></pre>\n\n<p>How can I generalize this so that no matter what two values are in \"<code>compLbl</code>\" it will binary code them?  My thought was to possibly do this by referencing factor level 1 for whatever two values are present in the factor variable compLbl. Like this:</p>\n\n<pre><code>nData$compLbl2 = with(nData,(ifelse(FACTORLEVEL(compLbl) == 1, 1,0)))\n</code></pre>\n\n<p>Where in my above example <code>FACTORLEVEL(compLbl)</code> would return a 1 for \"AMH\" and a 2 for \"BHC\" since those are the factor levels that R would automatically assign. However, I'm not sure how to do this, or if it is possible. </p>\n"},{"tags":["r","date","intervals"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":52,"score":4,"question_id":13287798,"title":"Calculating days per month between interval of two dates","body":"<p>I have a set of events that each have a start and end date, but they take place over the scope of a number of months. I would like to create a table that shows the number of days in each month for this event. </p>\n\n<p>I have the following example. </p>\n\n<pre><code>event_start_date &lt;- as.Date(\"23/10/2012\", \"%d/%m/%Y\")\nevent_end_date   &lt;- as.Date(\"07/02/2013\", \"%d/%m/%Y\")\n</code></pre>\n\n<p>I would expect to get a table out as the following:</p>\n\n<pre><code>Oct-12  8\nNov-12  30\nDec-12  31\nJan-13  31\nFeb-13  7\n</code></pre>\n\n<p>Does anybody know about a smart and elegant way of doing this or is creating a system of loops the only viable method? </p>\n\n<p>Jochem</p>\n"},{"tags":["r","matrix"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13297033,"title":"efficiently update matrix element with a matrix of indices","body":"<p>I have a matrix of indices I where some of the indices are repeated. I put an example below.</p>\n\n<p>I have another matrix A with dimensions compatible with the indices and initiated to 0 everywhere. I would like to do something like</p>\n\n<pre><code>A[I] += 1\n</code></pre>\n\n<p>I face two issues:</p>\n\n<ol>\n<li><code>A[I] = A[I] + 1</code> is too inefficient</li>\n<li>matrix <code>I</code> has redundant indices. For example rows 2 &amp; 6 are identical and I would like to obtain <code>A[1,2] = 2</code></li>\n</ol>\n\n<p>A partial answer would be to create a 3 columns matrix with the two first columns being the product of <code>unique(I)</code> and the third column with the counts, but I don't see any solution for that either. Any pointer or help would be greatly appreciated!</p>\n\n<pre><code>&gt; I is:\n     [,1] [,2]\n[1,]    1    1\n[2,]    1    2\n[3,]    1    3\n[4,]    1    4\n[5,]    1    1\n[6,]    1    2\n[7,]    1    3\n</code></pre>\n"},{"tags":["r","ggplot2","facet-wrap"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13297155,"title":"add \"floating\" axis labels in facet_wrap plot","body":"<p>I have the same problem as <a href=\"http://stackoverflow.com/questions/11163400/x-axis-labels-in-facet-wrap-for-ggplot2\">this</a> user - I have a 'jagged' faceted plot, in which the bottom row has fewer panels than the other rows, and I would like to have x-axis ticks on the bottom of each column. </p>\n\n<p>The suggested solution for that problem was to set <code>scales=\"free_x\"</code>. (In ggplot 0.9.2.1; I believe the behavior I'm looking for was default in earlier versions.) That's a poor solution in my case: my actual axis labels will be rather long, so putting them under each row will occupy too much room.  The results are something like this:</p>\n\n<pre><code> x &lt;- gl(3, 1, 15, labels=paste(\"this is a very long axis label \", letters[1:5]))\n y &lt;- rnorm(length(x))\n l &lt;- gl(5, 3, 15)\n d &lt;- data.frame(x=x, y=y, l=l)\n ggplot(d, aes(x=x, y=y)) + geom_point() + facet_wrap(~l, scales=\"free_x\") + \n   theme(axis.text.x=element_text(angle=90, hjust=1))\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/AaqHf.png\" alt=\"enter image description here\"></p>\n\n<p>In a comment <a href=\"http://stackoverflow.com/questions/12096492/remove-floating-axis-labels-in-facet-wrap-plot\">here</a>, Andrie suggests that it can be done manually in <code>grid</code> but I have no idea how to get started on that.</p>\n"},{"tags":["r","for-loop","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13294266,"title":"for loop and filling results in an empty matrix in R","body":"<p>I'm trying to fill an empty matrix with results calculated from a for loop. I don't know how to specify the indexing in my for loop i.e., right now my for loop code does not work and I can't get result into my matrix.</p>\n\n<p>Here's a subset of my data:</p>\n\n<pre><code>&gt; dput(eg)\nstructure(list(month = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, \n2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, \n2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L), .Label = c(\"7\", \n\"8\", \"9\", \"10\", \"11\"), class = \"factor\"), LONG = c(980.744064583783, \n983.838644208237, 978.459941419921, 984.841644157878, 968.200358699171, \n967.552217901586, 981.077638048121, 975.435563330951, 982.123246960536, \n975.383981047645, 978.181377755365, 975.001205420472, 980.410452250835, \n971.112535576725, 980.744064583783, 981.789215313314, 982.835292295612, \n975.435563330951, 982.457239633824, 976.095788761194, 977.468633236679, \n983.50423264086, 985.221850881562, 983.838644208237, 980.410452250835, \n970.785922305654, 983.838644208237, 981.789215313314, 975.435563330951, \n968.457651588967, 981.744668260738, 976.807567823793, 975.765695304413, \n977.850367309317, 967.487216377624, 967.487216377624, 981.121035207435, \n970.785922305654, 981.455144719747, 976.372538872237, 947.785924542022, \n949.961077537064, 953.277469897636, 956.588193000174, 954.107424886471, \n969.362874319781, 967.61505086351, 986.40950486552, 989.671406838413, \n914.2401235585), LAT = c(7497.04118692311, 7488.13522468594, \n7485.26645510239, 7482.63600422376, 7489.1136371139, 7492.78277930456, \n7495.20802780153, 7497.97375736711, 7493.50450717453, 7494.17837952228, \n7490.89595766574, 7492.21670554412, 7498.87433550932, 7493.41424827727, \n7497.04118692311, 7495.33760219375, 7493.63434928842, 7497.97375736711, \n7491.67140156528, 7494.30641015495, 7490.76739320858, 7489.96827686286, \n7484.59949728804, 7488.13522468594, 7498.87433550932, 7495.2484410159, \n7488.13522468594, 7495.33760219375, 7497.97375736711, 7483.48377437677, \n7491.5416779275, 7494.4346337625, 7496.14008888173, 7492.72950917327, \n7488.98777760417, 7488.98777760417, 7499.00376048698, 7495.2484410159, \n7497.17068662916, 7488.67706076623, 7444.0453546661, 7444.40653631031, \n7446.84930605798, 7449.2962767147, 7450.76636540362, 7494.995420297, \n7496.57764523632, 7465.87604399919, 7468.36476722201, 7434.9359208897\n)), .Names = c(\"month\", \"LONG\", \"LAT\"), row.names = c(740L, 741L, \n742L, 743L, 751L, 762L, 773L, 784L, 795L, 806L, 817L, 828L, 744L, \n745L, 746L, 747L, 748L, 749L, 750L, 752L, 753L, 754L, 755L, 756L, \n757L, 758L, 759L, 760L, 761L, 763L, 764L, 765L, 766L, 767L, 768L, \n769L, 770L, 771L, 772L, 774L, 775L, 776L, 777L, 778L, 779L, 780L, \n781L, 782L, 783L, 785L), class = \"data.frame\")\n</code></pre>\n\n<p>This is what I've done so far:</p>\n\n<pre><code># CREATE AN EMPRTY MATRIX FOR RESULTS\n    nrow&lt;-3 #there are 3 results calculated for each ncol\n    ncol&lt;-length(unique(eg$month))\n    total&lt;-matrix(0,nrow=nrow,ncol=ncol)\n\n    month&lt;-unique(eg$month)\n    library(spatstat) #need spatstat for calculating the window &amp; nndist\n    W2&lt;-ripras(eg$LONG,eg$LAT) #defining the window\n\n    # FOR LOOP TO CALCULATE NNDIST &lt; &amp; &gt; 1KM &amp; == 0KM FOR EACH MONTHLY POINT PATTERN \n\n    for(i in month){\n      m&lt;-subset(eg, month==i) #subsetting my data for each month\n      mp&lt;-ppp(m$LONG,m$LAT,window=W2) #creating a point pattern\n      nnd&lt;-nndist(mp) #calculating the nearest neighbour in a point pattern\n      total[1,i]&lt;-length(nnd[which(nnd&gt;1)]) #Filling up the matrix with results 1\n      total[2,i]&lt;-length(nnd[which(nnd==0)]) \n      total[3,i]&lt;-length(nnd[which(nnd&lt;1)])\n    }\n</code></pre>\n\n<p>I get this error message:</p>\n\n<pre><code>Error in total[1, i] &lt;- length(nnd[which(nnd &gt; 1)]) : \n  no 'dimnames' attribute for array\n</code></pre>\n\n<p><strong>EDITS:</strong></p>\n\n<p>Thanks @SvenHohenstein, I need to use either for(i in seq_along(month)) or for (i in 1:length(month)), however the problem is that my months are factors with levels \"7\" and \"8\". </p>\n\n<p>I have to first rename my factors level before running the loop (which now works!). However is there another way of doing this without renaming your factors?</p>\n\n<pre><code>levels(eg$month)&lt;-c(1:2) \nfor(i in 1:length(month)){\n  m&lt;-subset(DF, month==i) #subsetting my data for each month\n  mp&lt;-ppp(m$LONG,m$LAT,window=W2) #creating a point pattern\n  nnd&lt;-nndist(mp) #calculating the nearest neighbour in a point pattern\n  total[1,i]&lt;-length(nnd[nnd&gt;1]) #Filling up the matrix with results 1\n  total[2,i]&lt;-length(nnd[nnd==0]) \n  total[3,i]&lt;-length(nnd[nnd&lt;1])\n}\n</code></pre>\n"},{"tags":["json","r","twitter"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":123,"score":0,"question_id":12049560,"title":"R / JSON Can't figure out parsing issue","body":"<p>I have a text file full of Tweets stored in JSON format. </p>\n\n<pre><code>\"{\\\"contributors\\\":null,\\\"coordinates\\\":null,\\\"in_reply_to_user_id\\\":null,\\\"truncated\\\":false,\\\"text\\\":\\\"I find wrapping myself up in my rug more fun than I should.\\\",\\\"entities\\\":{\\\"hashtags\\\":[],\\\"urls\\\":[],\\\"user_mentions\\\":[]},\\\"place\\\":null,\\\"id_str\\\":\\\"234702954832220160\\\",\\\"favorited\\\":false,\\\"geo\\\":null,\\\"source\\\":\\\"\\u003Ca href=\\\\\"http:\\/\\/blackberry.com\\/twitter\\\\\" rel=\\\\\"nofollow\\\\\"\\u003ETwitter for BlackBerry\\u00ae\\u003C\\/a\\u003E\\\",\\\"retweet_count\\\":0,\\\"in_reply_to_status_id_str\\\":null,\\\"in_reply_to_screen_name\\\":null,\\\"created_at\\\":\\\"Sun Aug 12 17:28:39 +0000 2012\\\",\\\"in_reply_to_user_id_str\\\":null,\\\"user\\\":{\\\"show_all_inline_media\\\":true,\\\"lang\\\":\\\"en\\\",\\\"friends_count\\\":200,\\\"profile_sidebar_border_color\\\":\\\"BDDCAD\\\",\\\"location\\\":\\\"Newcastle\\\",\\\"profile_background_image_url_https\\\":\\\"https:\\/\\/si0.twimg.com\\/profile_background_images\\/613341681\\/ed47iwy7apcu7nltbj1y.jpeg\\\",\\\"id_str\\\":\\\"369637639\\\",\\\"listed_count\\\":0,\\\"profile_use_background_image\\\":true,\\\"profile_image_url_https\\\":\\\"https:\\/\\/si0.twimg.com\\/profile_images\\/2459865521\\/photo_653_normal.jpg\\\",\\\"description\\\":\\\"Hi, I'm Ellen, but you've probably guessed that by now. You can follow me but I don't know where I'm going.\\\",\\\"follow_request_sent\\\":null,\\\"following\\\":null,\\\"profile_text_color\\\":\\\"333333\\\",\\\"default_profile\\\":false,\\\"profile_background_image_url\\\":\\\"http:\\/\\/a0.twimg.com\\/profile_background_images\\/613341681\\/ed47iwy7apcu7nltbj1y.jpeg\\\",\\\"followers_count\\\":335,\\\"is_translator\\\":false,\\\"time_zone\\\":\\\"London\\\",\\\"profile_link_color\\\":\\\"0084B4\\\",\\\"protected\\\":false,\\\"created_at\\\":\\\"Wed Sep 07 17:56:39 +0000 2011\\\",\\\"profile_background_color\\\":\\\"9AE4E8\\\",\\\"name\\\":\\\"ellen\\u2020urnbull \\\",\\\"default_profile_image\\\":false,\\\"contributors_enabled\\\":false,\\\"statuses_count\\\":788,\\\"geo_enabled\\\":false,\\\"notifications\\\":null,\\\"profile_background_tile\\\":false,\\\"url\\\":null,\\\"profile_image_url\\\":\\\"http:\\/\\/a0.twimg.com\\/profile_images\\/2459865521\\/photo_653_normal.jpg\\\",\\\"screen_name\\\":\\\"ellenteee\\\",\\\"id\\\":369637639,\\\"verified\\\":false,\\\"utc_offset\\\":0,\\\"favourites_count\\\":10,\\\"profile_sidebar_fill_color\\\":\\\"DDFFCC\\\"},\\\"retweeted\\\":false,\\\"in_reply_to_status_id\\\":null,\\\"id\\\":234702954832220160}\n\"\n\"{\\\"contributors\\\":null,\\\"coordinates\\\":null,\\\"in_reply_to_user_id\\\":null,\\\"truncated\\\":false,\\\"text\\\":\\\"Goodevening!\\\",\\\"entities\\\":{\\\"hashtags\\\":[],\\\"urls\\\":[],\\\"user_mentions\\\":[]},\\\"place\\\":null,\\\"id_str\\\":\\\"234702954828029952\\\",\\\"favorited\\\":false,\\\"geo\\\":null,\\\"source\\\":\\\"\\u003Ca href=\\\\\"http:\\/\\/twitter.com\\/download\\/android\\\\\" rel=\\\\\"nofollow\\\\\"\\u003ETwitter for Android\\u003C\\/a\\u003E\\\",\\\"retweet_count\\\":0,\\\"in_reply_to_status_id_str\\\":null,\\\"in_reply_to_screen_name\\\":null,\\\"created_at\\\":\\\"Sun Aug 12 17:28:39 +0000 2012\\\",\\\"in_reply_to_user_id_str\\\":null,\\\"user\\\":{\\\"show_all_inline_media\\\":true,\\\"lang\\\":\\\"en\\\",\\\"friends_count\\\":130,\\\"profile_sidebar_border_color\\\":\\\"D3D2CF\\\",\\\"location\\\":\\\"#3block,St. Rose \\\",\\\"profile_background_image_url_https\\\":\\\"https:\\/\\/si0.twimg.com\\/profile_background_images\\/341819936\\/Tyga.jpg\\\",\\\"id_str\\\":\\\"331869167\\\",\\\"listed_count\\\":0,\\\"profile_use_background_image\\\":true,\\\"profile_image_url_https\\\":\\\"https:\\/\\/si0.twimg.com\\/sticky\\/default_profile_images\\/default_profile_0_normal.png\\\",\\\"description\\\":\\\" R.I.P Mealey you will be truly miss. Gone but never forgotten. #teamGod #HeatNation\\\",\\\"follow_request_sent\\\":null,\\\"following\\\":null,\\\"profile_text_color\\\":\\\"634047\\\",\\\"default_profile\\\":false,\\\"profile_background_image_url\\\":\\\"http:\\/\\/a0.twimg.com\\/profile_background_images\\/341819936\\/Tyga.jpg\\\",\\\"followers_count\\\":100,\\\"is_translator\\\":false,\\\"time_zone\\\":\\\"Central Time (US &amp; Canada)\\\",\\\"profile_link_color\\\":\\\"088253\\\",\\\"protected\\\":false,\\\"created_at\\\":\\\"Fri Jul 08 21:06:02 +0000 2011\\\",\\\"profile_background_color\\\":\\\"EDECE9\\\",\\\"name\\\":\\\"T\\u00e9 lu\\u00f2 y\\u012b \\\",\\\"default_profile_image\\\":true,\\\"contributors_enabled\\\":false,\\\"statuses_count\\\":16944,\\\"geo_enabled\\\":false,\\\"notifications\\\":null,\\\"profile_background_tile\\\":false,\\\"url\\\":null,\\\"profile_image_url\\\":\\\"http:\\/\\/a0.twimg.com\\/sticky\\/default_profile_images\\/default_profile_0_normal.png\\\",\\\"screen_name\\\":\\\"Troy_rollupone\\\",\\\"id\\\":331869167,\\\"verified\\\":false,\\\"utc_offset\\\":-21600,\\\"favourites_count\\\":41,\\\"profile_sidebar_fill_color\\\":\\\"E3E2DE\\\"},\\\"retweeted\\\":false,\\\"in_reply_to_status_id\\\":null,\\\"id\\\":234702954828029952}\n\"\n</code></pre>\n\n<p>I scan the file using:</p>\n\n<pre><code>&gt; twit &lt;- scan(\"twitCapture2.txt\",\"\",sep=\"\\n\")\nRead 4 items\n&gt; twit\n[1] \"\\\"{\\\\\\\"contributors\\\\\\\":null,\\\\\\\"coordinates\\\\\\\":null,\\\\\\\"in_reply_to_user_id\\\\\\\":null,\\\\\\\"truncated\\\\\\\":false,\\\\\\\"text\\\\\\\":\\\\\\\"I find wrapping myself up in my rug more fun than I should.\\\\\\\",\\\\\\\"entities\\\\\\\":{\\\\\\\"hashtags\\\\\\\":[],\\\\\\\"urls\\\\\\\":[],\\\\\\\"user_mentions\\\\\\\":[]},\\\\\\\"place\\\\\\\":null,\\\\\\\"id_str\\\\\\\":\\\\\\\"234702954832220160\\\\\\\",\\\\\\\"favorited\\\\\\\":false,\\\\\\\"geo\\\\\\\":null,\\\\\\\"source\\\\\\\":\\\\\\\"\\\\u003Ca href=\\\\\\\\\\\"http:\\\\/\\\\/blackberry.com\\\\/twitter\\\\\\\\\\\" rel=\\\\\\\\\\\"nofollow\\\\\\\\\\\"\\\\u003ETwitter for BlackBerry\\\\u00ae\\\\u003C\\\\/a\\\\u003E\\\\\\\",\\\\\\\"retweet_count\\\\\\\":0,\\\\\\\"in_reply_to_status_id_str\\\\\\\":null,\\\\\\\"in_reply_to_screen_name\\\\\\\":null,\\\\\\\"created_at\\\\\\\":\\\\\\\"Sun Aug 12 17:28:39 +0000 2012\\\\\\\",\\\\\\\"in_reply_to_user_id_str\\\\\\\":null,\\\\\\\"user\\\\\\\":{\\\\\\\"show_all_inline_media\\\\\\\":true,\\\\\\\"lang\\\\\\\":\\\\\\\"en\\\\\\\",\\\\\\\"friends_count\\\\\\\":200,\\\\\\\"profile_sidebar_border_color\\\\\\\":\\\\\\\"BDDCAD\\\\\\\",\\\\\\\"location\\\\\\\":\\\\\\\"Newcastle\\\\\\\",\\\\\\\"profile_background_image_url_https\\\\\\\":\\\\\\\"https:\\\\/\\\\/si0.twimg.com\\\\/profile_background_images\\\\/613341681\\\\/ed47iwy7apcu7nltbj1y.jpeg\\\\\\\",\\\\\\\"id_str\\\\\\\":\\\\\\\"369637639\\\\\\\",\\\\\\\"listed_count\\\\\\\":0,\\\\\\\"profile_use_background_image\\\\\\\":true,\\\\\\\"profile_image_url_https\\\\\\\":\\\\\\\"https:\\\\/\\\\/si0.twimg.com\\\\/profile_images\\\\/2459865521\\\\/photo_653_normal.jpg\\\\\\\",\\\\\\\"description\\\\\\\":\\\\\\\"Hi, I'm Ellen, but you've probably guessed that by now. You can follow me but I don't know where I'm going.\\\\\\\",\\\\\\\"follow_request_sent\\\\\\\":null,\\\\\\\"following\\\\\\\":null,\\\\\\\"profile_text_color\\\\\\\":\\\\\\\"333333\\\\\\\",\\\\\\\"default_profile\\\\\\\":false,\\\\\\\"profile_background_image_url\\\\\\\":\\\\\\\"http:\\\\/\\\\/a0.twimg.com\\\\/profile_background_images\\\\/613341681\\\\/ed47iwy7apcu7nltbj1y.jpeg\\\\\\\",\\\\\\\"followers_count\\\\\\\":335,\\\\\\\"is_translator\\\\\\\":false,\\\\\\\"time_zone\\\\\\\":\\\\\\\"London\\\\\\\",\\\\\\\"profile_link_color\\\\\\\":\\\\\\\"0084B4\\\\\\\",\\\\\\\"protected\\\\\\\":false,\\\\\\\"created_at\\\\\\\":\\\\\\\"Wed Sep 07 17:56:39 +0000 2011\\\\\\\",\\\\\\\"profile_background_color\\\\\\\":\\\\\\\"9AE4E8\\\\\\\",\\\\\\\"name\\\\\\\":\\\\\\\"ellen\\\\u2020urnbull \\\\\\\",\\\\\\\"default_profile_image\\\\\\\":false,\\\\\\\"contributors_enabled\\\\\\\":false,\\\\\\\"statuses_count\\\\\\\":788,\\\\\\\"geo_enabled\\\\\\\":false,\\\\\\\"notifications\\\\\\\":null,\\\\\\\"profile_background_tile\\\\\\\":false,\\\\\\\"url\\\\\\\":null,\\\\\\\"profile_image_url\\\\\\\":\\\\\\\"http:\\\\/\\\\/a0.twimg.com\\\\/profile_images\\\\/2459865521\\\\/photo_653_normal.jpg\\\\\\\",\\\\\\\"screen_name\\\\\\\":\\\\\\\"ellenteee\\\\\\\",\\\\\\\"id\\\\\\\":369637639,\\\\\\\"verified\\\\\\\":false,\\\\\\\"utc_offset\\\\\\\":0,\\\\\\\"favourites_count\\\\\\\":10,\\\\\\\"profile_sidebar_fill_color\\\\\\\":\\\\\\\"DDFFCC\\\\\\\"},\\\\\\\"retweeted\\\\\\\":false,\\\\\\\"in_reply_to_status_id\\\\\\\":null,\\\\\\\"id\\\\\\\":234702954832220160}\"\n[2] \"\\\"\"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \n[3] \"\\\"{\\\\\\\"contributors\\\\\\\":null,\\\\\\\"coordinates\\\\\\\":null,\\\\\\\"in_reply_to_user_id\\\\\\\":null,\\\\\\\"truncated\\\\\\\":false,\\\\\\\"text\\\\\\\":\\\\\\\"Goodevening!\\\\\\\",\\\\\\\"entities\\\\\\\":{\\\\\\\"hashtags\\\\\\\":[],\\\\\\\"urls\\\\\\\":[],\\\\\\\"user_mentions\\\\\\\":[]},\\\\\\\"place\\\\\\\":null,\\\\\\\"id_str\\\\\\\":\\\\\\\"234702954828029952\\\\\\\",\\\\\\\"favorited\\\\\\\":false,\\\\\\\"geo\\\\\\\":null,\\\\\\\"source\\\\\\\":\\\\\\\"\\\\u003Ca href=\\\\\\\\\\\"http:\\\\/\\\\/twitter.com\\\\/download\\\\/android\\\\\\\\\\\" rel=\\\\\\\\\\\"nofollow\\\\\\\\\\\"\\\\u003ETwitter for Android\\\\u003C\\\\/a\\\\u003E\\\\\\\",\\\\\\\"retweet_count\\\\\\\":0,\\\\\\\"in_reply_to_status_id_str\\\\\\\":null,\\\\\\\"in_reply_to_screen_name\\\\\\\":null,\\\\\\\"created_at\\\\\\\":\\\\\\\"Sun Aug 12 17:28:39 +0000 2012\\\\\\\",\\\\\\\"in_reply_to_user_id_str\\\\\\\":null,\\\\\\\"user\\\\\\\":{\\\\\\\"show_all_inline_media\\\\\\\":true,\\\\\\\"lang\\\\\\\":\\\\\\\"en\\\\\\\",\\\\\\\"friends_count\\\\\\\":130,\\\\\\\"profile_sidebar_border_color\\\\\\\":\\\\\\\"D3D2CF\\\\\\\",\\\\\\\"location\\\\\\\":\\\\\\\"#3block,St. Rose \\\\\\\",\\\\\\\"profile_background_image_url_https\\\\\\\":\\\\\\\"https:\\\\/\\\\/si0.twimg.com\\\\/profile_background_images\\\\/341819936\\\\/Tyga.jpg\\\\\\\",\\\\\\\"id_str\\\\\\\":\\\\\\\"331869167\\\\\\\",\\\\\\\"listed_count\\\\\\\":0,\\\\\\\"profile_use_background_image\\\\\\\":true,\\\\\\\"profile_image_url_https\\\\\\\":\\\\\\\"https:\\\\/\\\\/si0.twimg.com\\\\/sticky\\\\/default_profile_images\\\\/default_profile_0_normal.png\\\\\\\",\\\\\\\"description\\\\\\\":\\\\\\\" R.I.P Mealey you will be truly miss. Gone but never forgotten. #teamGod #HeatNation\\\\\\\",\\\\\\\"follow_request_sent\\\\\\\":null,\\\\\\\"following\\\\\\\":null,\\\\\\\"profile_text_color\\\\\\\":\\\\\\\"634047\\\\\\\",\\\\\\\"default_profile\\\\\\\":false,\\\\\\\"profile_background_image_url\\\\\\\":\\\\\\\"http:\\\\/\\\\/a0.twimg.com\\\\/profile_background_images\\\\/341819936\\\\/Tyga.jpg\\\\\\\",\\\\\\\"followers_count\\\\\\\":100,\\\\\\\"is_translator\\\\\\\":false,\\\\\\\"time_zone\\\\\\\":\\\\\\\"Central Time (US &amp; Canada)\\\\\\\",\\\\\\\"profile_link_color\\\\\\\":\\\\\\\"088253\\\\\\\",\\\\\\\"protected\\\\\\\":false,\\\\\\\"created_at\\\\\\\":\\\\\\\"Fri Jul 08 21:06:02 +0000 2011\\\\\\\",\\\\\\\"profile_background_color\\\\\\\":\\\\\\\"EDECE9\\\\\\\",\\\\\\\"name\\\\\\\":\\\\\\\"T\\\\u00e9 lu\\\\u00f2 y\\\\u012b \\\\\\\",\\\\\\\"default_profile_image\\\\\\\":true,\\\\\\\"contributors_enabled\\\\\\\":false,\\\\\\\"statuses_count\\\\\\\":16944,\\\\\\\"geo_enabled\\\\\\\":false,\\\\\\\"notifications\\\\\\\":null,\\\\\\\"profile_background_tile\\\\\\\":false,\\\\\\\"url\\\\\\\":null,\\\\\\\"profile_image_url\\\\\\\":\\\\\\\"http:\\\\/\\\\/a0.twimg.com\\\\/sticky\\\\/default_profile_images\\\\/default_profile_0_normal.png\\\\\\\",\\\\\\\"screen_name\\\\\\\":\\\\\\\"Troy_rollupone\\\\\\\",\\\\\\\"id\\\\\\\":331869167,\\\\\\\"verified\\\\\\\":false,\\\\\\\"utc_offset\\\\\\\":-21600,\\\\\\\"favourites_count\\\\\\\":41,\\\\\\\"profile_sidebar_fill_color\\\\\\\":\\\\\\\"E3E2DE\\\\\\\"},\\\\\\\"retweeted\\\\\\\":false,\\\\\\\"in_reply_to_status_id\\\\\\\":null,\\\\\\\"id\\\\\\\":234702954828029952}\"                                   \n[4] \"\\\"\"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \n&gt; \n</code></pre>\n\n<p>Then when I try to use <code>fromJSON</code> I get the following errors:</p>\n\n<pre><code>&gt; library(RJSONIO)\n&gt; \n&gt; twit1&lt;-fromJSON(twit1)\nError in file(con, \"r\") : invalid 'description' argument\n&gt; twit1&lt;-fromJSON(twit1[1])\nError in file(con, \"r\") : cannot open the connection\n\n&gt; f &lt;- RJSONIO::fromJSON(toJSON(twit1[3]))\n&gt; f$text\nError in f$text : $ operator is invalid for atomic vectors\n&gt; f &lt;- rjson::fromJSON(toJSON(twit1[3]))\n&gt; f$text\nError in f$text : $ operator is invalid for atomic vectors\n&gt; \n</code></pre>\n\n<p>Any ideas on what I'm doing wrong?</p>\n"},{"tags":["r","save","override","ellipsis"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":176,"score":3,"question_id":10971217,"title":"How to pass object in nested functions?","body":"<p>I'm trying to override <code>save()</code> in R so that it creates any missing directories before saving an object.  I'm having trouble passing an object through one function to another using the ellipsis method.</p>\n\n<p>My example:</p>\n\n<pre><code>save &lt;- function(...,file){ #Overridden save()\n  target.dir &lt;- dirname(file) #Extract the target directory\n  if(!file.exists(target.dir)) {\n      #Create the target directory if it doesn't exist.\n      dir.create(target.dir,showWarnings=T,recursive=T)\n  }\n  base::save(...,file=file.path(target.dir,basename(file)))\n}\n\nfun1 &lt;- function(obj) {\n  obj1 &lt;- obj + 1\n  save(obj1,file=\"~/test/obj.RData\")\n}\n\nfun1(obj = 1)\n</code></pre>\n\n<p>The code above results in this error: </p>\n\n<blockquote>\n<pre><code>Error in base::save(..., file = file.path(target.dir, basename(file))) : \nobject ‘obj1’ not found\n</code></pre>\n</blockquote>\n\n<p>I realize that the problem is that the object 'obj1' doesn't exist inside my custom save() function, but I haven't yet figured out how to pass it from fun1 to base::save.  </p>\n\n<p>I have tried: </p>\n\n<pre><code>base::save(parent.frame()$...,file=file.path(target.dir,basename(file)))\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>base::save(list=list(...),file=file.path(target.dir,basename(file)))\n</code></pre>\n\n<p>with no success.  </p>\n\n<p>Any suggestions?</p>\n"},{"tags":["r","cran","reference-class"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":11816015,"title":"Reference class fields disappearing","body":"<p>I decided to give Reference Classes another shot, but my first hello world is already giving me issues. What is going wrong here?</p>\n\n<pre><code>&gt; memory &lt;- setRefClass(\n+   Class = \"memory\",\n+   fields = list(state=\"vector\"),\n+   methods = list(\n+     get = function() { return(state) },\n+     set = function(x) { state &lt;&lt;- x }\n+   )\n+ )$new()\n\n&gt; memory$set(123)\n\n&gt; print(memory)\nReference class object of class \"memory\"\nField \"state\":\n[1] 123\n\n&gt; memory$get()\n[1] 123\n\n&gt; print(memory)\nReference class object of class \"memory\"\nField \"state\":\nError in methods::show(field(fi)) : \n  error in evaluating the argument 'object' in selecting a method for function 'show': Error in get(name, envir = .self) : \n  unused argument(s) (name, envir = .self)\n</code></pre>\n"},{"tags":["r","reference-class"],"answer_count":0,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":92,"score":1,"question_id":9856830,"title":"list (or array) of RefClass object in Reference Class","body":"<p>I can make a parent class containing an object</p>\n\n<pre><code>setRefClass(\"img\",fields=list(name=\"character\"))\nsetRefClass(\"imgs\",fields=list(img=\"img\"))\n</code></pre>\n\n<p>However, I want to create an RefClass object with an array of other RefClass objects.\nI can use a \"list\" as place holder and fill it in manually, but is there a better way?</p>\n\n<p>For example, can a \"list\" type be specified to hold a certain object in it?\nHypothetically, something like this: (but doesn't work)</p>\n\n<pre><code>setRefClass(\"img\",fields=list(name=\"character\"))\nsetRefClass(\"imgs\",contains=list(imgList=list(\"img\")))\n</code></pre>\n\n<p>I am hoping that when I call a method on \"imgList\", it knows to call method for each \"img\" element.</p>\n"},{"tags":["r","loops","for-loop","boxplot"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13296148,"title":"Recursive boxplot in R returning invalid variable type error","body":"<p>I'm trying to plot multiple boxplots in R within a for loop but can't reference columns in the dataset using the <code>data.frame[column]</code>as it returns the following:</p>\n\n<p><code>Error in model.frame.default(formula = e[1] ~ e[2]) :</code>\n<code>invalid type (list) for variable 'e[1]'</code></p>\n\n<p>The following code returns the same error that I'm getting:</p>\n\n<pre><code>x &lt;- rnorm(20)\ny &lt;- rnorm(20)\ne &lt;- data.frame(x, y)\nboxplot(e[1] ~ e$y)\n</code></pre>\n\n<p>Any suggestions? I'm really stuck here.</p>\n"},{"tags":["r","search"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":235,"score":4,"question_id":6211130,"title":"How to search for patterns that are not exactly same each time?","body":"<p>I have a list like this:</p>\n\n<pre><code> list &lt;- c(\"xxx 23 cut\", \"yyy\", \"zzz\", \"www 55 cut\", \"kkk\", \"ggg\", \"yyy\", \"eee 7 cut\", \"ccd\" )\n</code></pre>\n\n<p>The searching patter in this case is \"any-number cut\".  Thus, to visualize the list in a better way, the list is in the following pattern</p>\n\n<pre><code>\"before item (=xxx) \"  \"any number cut (= 23 cut)\"\n\"after item (=yyy)\"\n\"after item (=zzz)\"\n\"before item (=www) \"  \"any number cut (= 55 cut)\"\n\"after item (=kkk)\"\n\"after item (=ggg)\"\n\"after items (=yyy)\"\n\"before item (=eee) \"  \"any number cut (= 7cut)\"\n\"after item (=cce)\"\n</code></pre>\n\n<p>I want place the \"before items\" to column 1, until it found another \"any number cut\" pattern, and put the \"after items\" to column 2.  The final results would as follows:</p>\n\n<pre><code>xxx yyy\nxxx zzz\nwww kkk\nwww ggg\nwww yyy\neee ccd\n</code></pre>\n\n<p>Could experts teach me how to do it with R?  I learn from previous stackoverflow messages that R can search for fixed items (e.g. cut) and strsplit them into different cells.  The challenge here (to me) is the searching pattern is changing that the number before the word \"cut\" is different for each of them.  what is the most efficient way to search and cut it in the right place using R?  </p>\n"},{"tags":["r","data.frame","data.table","sqldf"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":93,"score":2,"question_id":13279582,"title":"Select only the first rows for each unique value of a column in R","body":"<p>From a dataframe like this</p>\n\n<pre><code>test &lt;- data.frame('id'= rep(1:5,2), 'string'= LETTERS[1:10])\ntest &lt;- test[order(test$id), ]\nrownames(test) &lt;- 1:10\n\n&gt; test\n    id string\n 1   1      A\n 2   1      F\n 3   2      B\n 4   2      G\n 5   3      C\n 6   3      H\n 7   4      D\n 8   4      I\n 9   5      E\n 10  5      J\n</code></pre>\n\n<p>I want to create a new one with the first appearance of each id / string pair. If sqldf accepted R code within it, the query could look like this:</p>\n\n<pre><code>res &lt;- sqldf(\"select id, min(rownames(test)), string \n              from test \n              group by id, string\")\n\n&gt; res\n    id string\n 1   1      A\n 3   2      B\n 5   3      C\n 7   4      D\n 9   5      E\n</code></pre>\n\n<p>Is there a solution short of creating a new column like</p>\n\n<pre><code>test$row &lt;- rownames(test)\n</code></pre>\n\n<p>and running the same sqldf query with min(row)?</p>\n"},{"tags":["r","data"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":37,"score":3,"question_id":13294560,"title":"How to programmatically get header information of dataset from UCI data repository in R","body":"<p>I am trying to collect publicly available <a href=\"http://archive.ics.uci.edu/ml/datasets.html\" rel=\"nofollow\">datasets from UCI repository</a> for R. I understand there are lots of datasets already usable with several R packages such as <code>mlbench.</code> But there are still several datasets I will need from UCI repository.</p>\n\n<p>This is a trick I learned </p>\n\n<pre><code>url=\"http://archive.ics.uci.edu/ml/machine-learning-databases/credit-screening/crx.data\"\ncredit&lt;-read.csv(url, header=F)\n</code></pre>\n\n<p>But this does not get header (variable name) information. That information is in <a href=\"http://archive.ics.uci.edu/ml/machine-learning-databases/credit-screening/crx.names\" rel=\"nofollow\">*.names</a> file in text format. Any idea how I can programmatically get header information as well?</p>\n"},{"tags":["r","latex","system","knitr"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13295130,"title":"Knitr hanging on system() call","body":"<p>How do I get knitr to un-hang after running a system call in a chunk? For example:</p>\n\n<pre><code>\\documentclass{article}\n\n\\begin{document}\nTest \n\n&lt;&lt;&gt;&gt;=\nsystem('\"C:\\\\Program Files\\\\SASHome\\\\SASFoundation\\\\9.3\\\\sas.exe\" \"test.sas\"')\n@\n\n\\end{document}\n</code></pre>\n\n<p>This code just hangs forever. By the way, the R code above runs fine. Thanks.</p>\n"},{"tags":["r","mongodb","hadoop"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":43,"score":3,"question_id":13294924,"title":"Getting Started with Hadoop and R","body":"<p>I am trying to learn about \"Big Data\" and figured the only way to start is to dive right in. Worth noting is that I am going to use a single machine that I have at home.  For context, I have about 700 text files that total about 300gb's of data.  Each file contains JSON responses captured from Twitter's firehouse over the last month.  </p>\n\n<p>I love R and ultimately what to use it to study my dataset, but I know that I need a way to \"store\" the data.  I hear a lot about Hadoop and HDFS, but can't get my head wrapped around it.  Would I simply \"copy\" the text files to HDFS on my local machine and use the <code>RHadoop</code>to write Map/Reduce statements to create datasets?  </p>\n\n<p>Lastly, I have MongoDB up and running and was considering storing the data there but I am not sure that the I would capture analytical performance gains, although I know that there is an adaptor for Haddop.</p>\n\n<p>My question:  Having successfully captured the data, what is the best way to store this such that I can use R (and other tools) to analyze the data.  </p>\n"},{"tags":["r","coordinates","netlogo"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":9,"score":2,"question_id":13294484,"title":"I want to extract coordinate data from NetLogo using the RNetLogo package","body":"<p>I'm using the sample Flocking code as an example to play with if anyone is familiar   </p>\n\n<pre><code>NLCommand(\"set population 1\")\nNLCommand(\"setup\")\nnruns &lt;- 10\ntimedata &lt;- list()\nfor(i in 1:nruns) {\nNLCommand(\"go\")\ntimedata[[i]] &lt;- NLGetAgentSet(c(\"who\",\"xcor\",\"ycor\"),\"turtles\",\nas.data.frame=T,df.col.names=c(\"who\",\"xcor\",\"ycor\")) }\ntimedata\n</code></pre>\n\n<p>The problem is that it produces new headers for each model iteration. So I get the following instead of the header appearing only once:</p>\n\n<pre><code>[[1]]\n who     xcor      ycor\n1   0 34.56833 -26.47777\n\n[[2]]\n who     xcor      ycor\n1   0 35.19765 -25.70063\n</code></pre>\n\n<p>Any help would be much appreciated </p>\n"},{"tags":["r","plot","axis","ranges"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13287537,"title":"Adjusting the limits of x and y axis, when adding new curves to a plot in R","body":"<p>I have two datasets (<code>df1</code> and <code>df2</code>) that are plotted.</p>\n\n<pre><code>df1 = data.frame(x=c(1:10), y=c(1:10))\ndf2 = data.frame(x=c(0:13), y=c(0:13)^1.2)\n\n# plot\nplot(df1)\n# add lines of another dataset\nlines(df2)\n</code></pre>\n\n<p>Some values of <code>df2</code> are out of the plot-range and thus not visible. (In this example I could just plot <code>df2</code> first). I usually try to find out the ranges of my data, as shown below.</p>\n\n<pre><code># manual solution\nminX = min(df1$x, df2$x)\nminY = min(df1$y, df2$y)\nmaxX = max(df1$x, df2$x)\nmaxY = max(df1$y, df2$y)\n\nplot (df1, xlim=c(minX, maxX), ylim=c(minY, maxY))\nlines(df2)\n</code></pre>\n\n<p>When having many datasets, this becomes annoying. I was wondering, if there is an easier way of adjusting the ranges of the axis.\nIn the first step R finds axis ranges itself. Is there also a way that R adjusts the axis-ranges, when new datasets are added?</p>\n"},{"tags":["r","spss","rstudio"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13293552,"title":"Rstudio stopped working after installing SPSS R-plugin","body":"<p>I'm trying to use R through SPSS syntax (I'm using SPSS 18 on windows 7) which requires installing a special plugin: PASWStatistics_RPlugIn_1802_win32.exe. Also I had to install an older version of R(2.8.1 - required by my older version of SPSS - i like it better than the new ones). The plugin now works, R (both versions) works, but Rstudio stopped working and won't start even after uninstalling and re-installing.\nDoes anyone have any similar experience and could suggest a solution?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13293569,"title":"using split, cut and duplicated function to filter data in R","body":"<p>I have a data set like this one i've shown below. </p>\n\n<pre><code>date &lt;- strptime(c(\"2011-09-01 00:00:00\",\"2011-09-01 06:00:00\",\"2011-09-01 12:00:00\",\"2011-09-01 18:00:00\",\"2011-09-02 00:00:00\",\n\"2011-09-02 06:00:00\",\"2011-09-02 12:00:00\",\"2011-09-02 18:00:00\",\"2011-09-03 00:00:00\",\"2011-09-03 06:00:00\",\"2011-09-03 12:00:00\",\n\"2011-09-03 18:00:00\",\"2011-09-04 00:00:00\",\"2011-09-04 06:00:00\",\"2011-09-04 12:00:00\",\"2011-09-04 18:00:00\",\"2011-09-05 00:00:00\",\n\"2011-09-05 06:00:00\",\"2011-09-05 12:00:00\",\"2011-09-05 18:00:00\",\"2011-09-06 00:00:00\"), format =\"%Y-%m-%d %H:%M:%S\")\n\nvolt &lt;- c(7,8,9,10, 7, 8, 9, 10,  6.1, 11.1,  9.1,  10.1, 7, 8,  9, 10, 6.3, 9.4, 1.3, 19.1, 5.6)\n\nsampV &lt;- data.frame(date,volt)\nsampV\n\n\n               date volt\n2011-09-01 00:00:00 7\n2011-09-01 06:00:00 8\n2011-09-01 12:00:00 9\n2011-09-01 18:00:00 10\n2011-09-02 00:00:00 7\n2011-09-02 06:00:00 8\n2011-09-02 12:00:00 9\n2011-09-02 18:00:00 10\n2011-09-03 00:00:00 6.1\n2011-09-03 06:00:00 11.1\n2011-09-03 12:00:00 9.1\n2011-09-03 18:00:00 10.1\n2011-09-04 00:00:00 7\n2011-09-04 06:00:00 8\n2011-09-04 12:00:00 9\n2011-09-04 18:00:00 10\n2011-09-05 00:00:00 6.3\n2011-09-05 06:00:00 9.4\n2011-09-05 12:00:00 1.3\n2011-09-05 18:00:00 19.1\n2011-09-06 00:00:00 5.6\n</code></pre>\n\n<p>Now i'd like to group the data using the date column <strong>every day</strong> and then check if the resulting groupings in v are duplicated. For instance, the \"volt\" data for 1st and 2nd Sept are repeated (7,8,9,10). </p>\n\n<p>I have been trying to use this code to split it into the various days but that is as far as i can go.</p>\n\n<pre><code>t1 &lt;- strptime(\"2011-09-01 00:00:00\",format=\"%Y-%m-%d %H:%M:%S\")\nt2 &lt;- strptime(\"2011-09-06 00:00:00\",format=\"%Y-%m-%d %H:%M:%S\")\n\nseqD &lt;- seq(t1,t2, by=\"day\")\nctD &lt;- cut(sampV$date, seqD, labels=F )\nspD &lt;- split(sampV$date,ctD)\n</code></pre>\n\n<p>SO my question is, how do you extract those data that have been copied from one day to the next using duplicated function or any function for that matter? I'm just a beginner in R and i'm still learning the ropes so your help will be greatly appreciated. Thanks</p>\n"},{"tags":["r","data.table"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":101,"score":1,"question_id":13238691,"title":"remove seasonality from daily time series data","body":"<pre><code>dput(df)\nstructure(list(Process = c(\"PROC050D\", \"PROC051D\", \"PROC100D\", \n\"PROC103D\", \"PROC104D\", \"PROC106D\", \"PROC106D\", \"PROC110D\", \"PROC111D\", \n\"PROC112D\", \"PROC113D\", \"PROC114D\", \"PROC130D\", \"PROC131D\", \"PROC132D\", \n\"PROC154D\", \"PROC155D\", \"PROC156D\", \"PROC157D\", \"PROC158D\", \"PROC159D\", \n\"PROC160D\", \"PROC161D\", \"PROC162D\", \"PROC163D\", \"PROC164D\", \"PROC165D\", \n\"PROC166D\", \"PROC170D\", \"PROC171D\", \"PROC173D\", \"PROC174D\", \"PROC177D\", \n\"PROC180D\", \"PROC181D\", \"PROC182D\", \"PROC185D\", \"PROC186D\", \"PROC187D\", \n\"PROC190D\", \"PROC191D\", \"PROC192D\", \"PROC196D\", \"PROC197D\", \"PROC201D\", \n\"PROC202D\", \"PROC203D\", \"PROC204D\", \"PROC205D\", \"PROC206D\"), \n    Date = structure(c(15393, 15393, 15393, 15393, 15393, 15393, \n    15393, 15393, 15393, 15393, 15393, 15393, 15393, 15393, 15393, \n    15393, 15393, 15393, 15393, 15393, 15393, 15393, 15393, 15393, \n    15393, 15393, 15393, 15393, 15393, 15393, 15393, 15393, 15393, \n    15393, 15393, 15393, 15393, 15393, 15393, 15393, 15393, 15393, \n    15393, 15393, 15393, 15393, 15393, 15393, 15393, 15393), class = \"Date\"), \n    Duration = c(30L, 78L, 20L, 15L, 129L, 56L, 156L, 10L, 1656L, \n    1530L, 52L, 9L, 10L, 38L, 48L, 9L, 26L, 90L, 15L, 23L, 13L, \n    9L, 34L, 12L, 11L, 16L, 24L, 11L, 236L, 104L, 9L, 139L, 11L, \n    10L, 22L, 11L, 55L, 35L, 12L, 635L, 44L, 337L, 44L, 9L, 231L, \n    32L, 19L, 170L, 22L, 19L)), .Names = c(\"Process\", \"Date\", \n\"Duration\"), row.names = c(NA, 50L), class = \"data.frame\")\n</code></pre>\n\n<p>I'm trying to capture outliers from my data using IQR method. But when I use this data, I also capture the data that maybe normal. I like to remove the seasonality from my data points and then apply the outlier rules.</p>\n\n<p>There are thousands of different processes on the Process column. I just need to capture the processes' duration that is not normal. Any ideas how to remove the seasonality from my data set? The code below calculates outliers but the outliers may be normal due to seasonality factor. Before calculating the outliers, I like to remove the seasonality from my data frame.</p>\n\n<pre><code>library(data.table)\n\ndf&lt;-df[, seventyFifth := quantile(Duration, .75), by = Process]\ndf&lt;-df[, twentyFifth := quantile(Duration, .25), by = Process]\ndf&lt;-df[, IQR := (seventyFifth-twentyFifth), by = Process]\n\ndf$diff&lt;-df$Duration-df$seventyFifth\n\ndf&lt;-df[, outlier := diff &gt; 3 * IQR, by = Process]\n</code></pre>\n"},{"tags":["r","apache2","opencpu","opencpu.org"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13292928,"title":"Opencpu App-Development process and deployment","body":"<p>I found an R package <code>opencpu-demo</code> which gets installed as an App on the server. However it isn't clear which files the user needs to explicitly create in the <code>/install</code> directory and how to tie it with R functions. Does it require JavaScript embedded with R or vice-versa. Any help or pointer to a tutorial will be greatly appreciated.</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13291308,"title":"Generate numbers with specific correlation","body":"<p>How to generate a sequence of numbers, which would have a specific correlation (for example 0.56) and would consist of.. say 50 numbers with R program?\nTy.</p>\n"},{"tags":["ios","cocoa","r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":11,"view_count":58,"score":-11,"question_id":13292552,"title":"How to conver this R code to Cocoa IOS?","body":"<p>I have found this code here: <a href=\"http://stackoverflow.com/questions/257717/position-of-the-sun-given-time-of-day-and-lat-long\">Position of the sun given time of day, and lat/long</a> \nIt is used to calculate the sun position. I am writing an ios app for that needs sun position.\nThe question is how to transform this piece of R code to Cocoa?</p>\n\n<pre><code>  sunPosition &lt;- function(year, month, day, hour=12, min=0, sec=0,\n                    lat=46.5, long=6.5) {\n  twopi &lt;- 2 * pi\n  deg2rad &lt;- pi / 180\n\n  # Get day of the year, e.g. Feb 1 = 32, Mar 1 = 61 on leap years\n  month.days &lt;- c(0,31,28,31,30,31,30,31,31,30,31,30)\n  day &lt;- day + cumsum(month.days)[month]\n  leapdays &lt;- year %% 4 == 0 &amp; (year %% 400 == 0 | year %% 100 != 0) &amp; day &gt;= 60\n  day[leapdays] &lt;- day[leapdays] + 1\n\n  # Get Julian date - 2400000\n  hour &lt;- hour + min / 60 + sec / 3600 # hour plus fraction\n  delta &lt;- year - 1949\n  leap &lt;- trunc(delta / 4) # former leapyears\n  jd &lt;- 32916.5 + delta * 365 + leap + day + hour / 24\n\n  # The input to the Atronomer's almanach is the difference between\n  # the Julian date and JD 2451545.0 (noon, 1 January 2000)\n  time &lt;- jd - 51545.\n\n  # Ecliptic coordinates\n\n  # Mean longitude\n  mnlong &lt;- 280.460 + .9856474 * time\n  mnlong &lt;- mnlong %% 360\n  mnlong[mnlong &lt; 0] &lt;- mnlong[mnlong &lt; 0] + 360\n\n  # Mean anomaly\n  mnanom &lt;- 357.528 + .9856003 * time\n  mnanom &lt;- mnanom %% 360\n  mnanom[mnanom &lt; 0] &lt;- mnanom[mnanom &lt; 0] + 360\n  mnanom &lt;- mnanom * deg2rad\n\n  # Ecliptic longitude and obliquity of ecliptic\n  eclong &lt;- mnlong + 1.915 * sin(mnanom) + 0.020 * sin(2 * mnanom)\n  eclong &lt;- eclong %% 360\n  eclong[eclong &lt; 0] &lt;- eclong[eclong &lt; 0] + 360\n  oblqec &lt;- 23.429 - 0.0000004 * time\n  eclong &lt;- eclong * deg2rad\n  oblqec &lt;- oblqec * deg2rad\n\n  # Celestial coordinates\n  # Right ascension and declination\n  num &lt;- cos(oblqec) * sin(eclong)\n  den &lt;- cos(eclong)\n  ra &lt;- atan(num / den)\n  ra[den &lt; 0] &lt;- ra[den &lt; 0] + pi\n  ra[den &gt;= 0 &amp; num &lt; 0] &lt;- ra[den &gt;= 0 &amp; num &lt; 0] + twopi\n  dec &lt;- asin(sin(oblqec) * sin(eclong))\n\n  # Local coordinates\n  # Greenwich mean sidereal time\n  gmst &lt;- 6.697375 + .0657098242 * time + hour\n  gmst &lt;- gmst %% 24\n  gmst[gmst &lt; 0] &lt;- gmst[gmst &lt; 0] + 24.\n\n  # Local mean sidereal time\n  lmst &lt;- gmst + long / 15.\n  lmst &lt;- lmst %% 24.\n  lmst[lmst &lt; 0] &lt;- lmst[lmst &lt; 0] + 24.\n  lmst &lt;- lmst * 15. * deg2rad\n\n  # Hour angle\n  ha &lt;- lmst - ra\n  ha[ha &lt; -pi] &lt;- ha[ha &lt; -pi] + twopi\n  ha[ha &gt; pi] &lt;- ha[ha &gt; pi] - twopi\n\n  # Latitude to radians\n  lat &lt;- lat * deg2rad\n\n  # Azimuth and elevation\n  el &lt;- asin(sin(dec) * sin(lat) + cos(dec) * cos(lat) * cos(ha))\n  az &lt;- asin(-cos(dec) * sin(ha) / cos(el))\n  elc &lt;- asin(sin(dec) / sin(lat))\n  az[el &gt;= elc] &lt;- pi - az[el &gt;= elc]\n  az[el &lt;= elc &amp; ha &gt; 0] &lt;- az[el &lt;= elc &amp; ha &gt; 0] + twopi\n\n  el &lt;- el / deg2rad\n  az &lt;- az / deg2rad\n  lat &lt;- lat / deg2rad\n\n  return(list(elevation=el, azimuth=az))\n}\n</code></pre>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":46,"score":4,"question_id":13291447,"title":"Recode based on TRUE or FALSE in another variable","body":"<p>I'm calculating a new variable based on the TRUE/FALSE status of another:</p>\n\n<pre><code>value&lt;-c(2, 4, 5, 8, 2, 3, 1)\ntf&lt;-c(TRUE, FALSE, FALSE, FALSE, TRUE, FALSE, TRUE)\ndf&lt;-data.frame(value, tf)\n</code></pre>\n\n<p>The following code does what I need (halves 'value' if 'tf' is TRUE)...</p>\n\n<pre><code>df$newVals[which(df$tf)]&lt;-df$value[which(df$tf)]/2\ndf$newVals[which(!df$tf)]&lt;-df$value[which(!df$tf)]\n</code></pre>\n\n<p>...but it feels too complicated.  Is there a simpler approach?</p>\n\n<p>Thanks</p>\n"},{"tags":["r","binary"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13290869,"title":"How to use information from a file to calculate the spatial average for other several files?","body":"<p>Assume that I have a file called river and there is a region of interest in this file has the value=1.<br>\nThe file that i want as a mask can be read as:</p>\n\n<pre><code>sd &lt;- file(\"C:\\\\lai_28_06.bin\", \"rb\")\nriver&lt;- readBin(sd, integer(), size=2,  n=360*720, signed=T)\n</code></pre>\n\n<p>The code given bellow will extract a region from several binary files(366) and then will calculate the mean. As you can see, I selected the region by using (X&lt;-c(450:455) ; Y&lt;-c(140:145) ). Now I want to do the same thing but with using information from the file\"river\". By saying ,for example, when \"river\"=1,take the corresponding value (from the files listed under a) into account and then divide the sum of those values by the number of values (simply the mean).</p>\n\n<pre><code>a&lt;-list.files(\"C:\\\\New folder (13)\", \"*.bin\", full.names = TRUE)\nX&lt;-c(450:455) ; Y&lt;-c(140:145) \nextract&lt;-vector()\n# construct a vector of file names and loop through\nfor (i in 1:366) {\n    conne &lt;- file(k[i], \"rb\")\n    file&lt;- readBin(conne, integer(), size=2,  n=360*720, signed=T)\n    file2&lt;-t(t(matrix(data=file,ncol=360,nrow=720)))\n    extract[i]&lt;-mean(file2[X,Y])\n    close(conne)\n    }\nwrite.table(extract,\"C:\\\\yeinteg.txt\")\n</code></pre>\n"},{"tags":["database","r"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13289796,"title":"Speed up sqlFetch()","body":"<p>I am working with an Oracle database and like to fetch a table with 30 million records. </p>\n\n<pre><code>library(RODBC)\nch &lt;- odbcConnect(\"test\", uid=\"test_user\", \n                  pwd=\"test_pwd\", \n                  believeNRows=FALSE, readOnly=TRUE)\ndb &lt;- sqlFetch(ch, \"test_table\")\n</code></pre>\n\n<p>For 1 million records the process needs 1074.58 sec. Thus, it takes quite a while for all 30 million records. Is there any possiblity to speed up the process? </p>\n\n<p>I would appreciate any help. Thanks.</p>\n"},{"tags":["r","sorting","ggplot2","facet"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13268737,"title":"Internal ordering of facets ggplot2","body":"<p>I'm trying to plot a facets in ggplot2 but I struggle to get the internal ordering of the different facets right. The data looks like this:</p>\n\n<pre><code>head(THAT_EXT)\n  ID          FILE           GENRE      NODE\n1 CKC_1823_01  CKC          Novels    better\n2 CKC_1824_01  CKC          Novels    better\n3  EW9_192_03  EW9 Popular Science    better\n4  H0B_265_01  H0B Popular Science       sad\n5  CS2_231_03  CS2  Academic Prose desirable\n6    FED_8_05  FED  Academic Prose   certain\n\nstr(THAT_EXT)\n'data.frame':   851 obs. of  4 variables:\n $ ID   : Factor w/ 851 levels \"A05_122_01\",\"A05_277_07\",..: 345 346 439 608 402 484 319 395 228 5 ...\n $ FILE : Factor w/ 241 levels \"A05\",\"A06\",\"A0K\",..: 110 110 127 169 120 135 105 119 79 2 ...\n $ GENRE: Factor w/ 5 levels \"Academic Prose\",..: 4 4 5 5 1 1 1 5 1 5 ...\n $ NODE : Factor w/ 115 levels \"absurd\",\"accepted\",..: 14 14 14 89 23 16 59 59 18 66 ...\n</code></pre>\n\n<p>Part of the problem is that can't get the sorting right. Here is the code for the sorting of NODE that I use:</p>\n\n<pre><code>THAT_EXT &lt;- within(THAT_EXT, \n               NODE &lt;- factor(NODE, \n                              levels=names(sort(table(NODE), \n                                                decreasing=TRUE))))\n</code></pre>\n\n<p>When I plot this with the code below I get a graphs in which the NODE is not correctly sorted in the individual GENREs since different NODEs are more frequent in different GENREs: </p>\n\n<pre><code>p1 &lt;- \nggplot(THAT_EXT, aes(x=NODE)) +\ngeom_bar() +\nscale_x_discrete(\"THAT_EXT\", breaks=NULL) + # supress tick marks on x axis\nfacet_wrap(~GENRE)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/Wdb6K.png\" alt=\"The resulting plot with the wrong ordering of NODE\"></p>\n\n<p>What I want is for every facet to have NODE sorted in decreasing order for that particular GENRE. Can anyone help with this? </p>\n\n<pre><code>structure(list(ID = structure(c(1L, 2L, 3L, 4L, 10L, 133L, 137L, \n138L, 139L, 140L, 141L, 142L, 143L, 144L, 145L, 146L, 147L, 148L, \n149L, 150L, 151L, 152L, 153L, 154L, 155L, 156L, 157L, 158L, 159L, \n160L, 161L, 162L, 163L, 164L, 165L, 166L, 167L, 168L, 169L, 170L, \n171L, 172L, 173L, 174L, 175L, 176L, 177L, 178L, 179L, 180L, 181L, \n182L, 183L, 184L, 185L, 186L, 187L, 188L, 189L, 190L, 191L, 192L, \n193L, 194L, 195L, 196L, 197L, 198L, 199L, 200L, 201L, 202L, 203L, \n204L, 205L, 206L, 207L, 208L, 212L, 213L, 214L, 215L, 216L, 217L, \n218L, 219L, 220L, 221L, 222L, 223L, 224L, 225L, 226L, 227L, 228L, \n229L, 230L, 231L, 232L, 233L, 234L, 235L, 236L, 237L, 238L, 239L, \n240L, 241L, 267L, 268L, 269L, 270L, 271L, 272L, 273L, 274L, 275L, \n276L, 277L, 278L, 279L, 280L, 281L, 282L, 283L, 284L, 290L, 291L, \n298L, 299L, 300L, 303L, 304L, 305L, 306L, 307L, 308L, 309L, 310L, \n313L, 314L, 315L, 316L, 317L, 318L, 319L, 327L, 328L, 329L, 330L, \n331L, 332L, 333L, 334L, 335L, 336L, 337L, 338L, 339L, 340L, 341L, \n342L, 343L, 344L, 345L, 346L, 347L, 348L, 352L, 353L, 354L, 355L, \n356L, 357L, 358L, 359L, 360L, 349L, 350L, 351L, 361L, 362L, 363L, \n364L, 365L, 366L, 367L, 368L, 369L, 370L, 371L, 372L, 373L, 374L, \n375L, 376L, 377L, 378L, 379L, 380L, 381L, 12L, 13L, 14L, 15L, \n16L, 17L, 18L, 19L, 20L, 21L, 22L, 23L, 24L, 25L, 26L, 27L, 28L, \n29L, 30L, 31L, 32L, 33L, 34L, 35L, 36L, 41L, 42L, 43L, 44L, 45L, \n46L, 50L, 54L, 72L, 73L, 74L, 75L, 76L, 90L, 91L, 92L, 97L, 98L, \n102L, 115L, 125L, 126L, 127L, 128L, 129L, 130L, 131L, 132L, 209L, \n210L, 211L, 242L, 243L, 244L, 245L, 246L, 289L, 292L, 293L, 294L, \n295L, 296L, 297L, 301L, 302L, 311L, 312L, 320L, 321L, 322L, 323L, \n324L, 325L, 326L, 382L, 383L, 384L, 385L, 386L, 387L, 388L, 5L, \n6L, 7L, 8L, 9L, 11L, 37L, 38L, 39L, 40L, 47L, 48L, 49L, 51L, \n52L, 53L, 55L, 56L, 57L, 58L, 59L, 60L, 61L, 62L, 63L, 64L, 65L, \n66L, 67L, 68L, 69L, 70L, 71L, 77L, 78L, 79L, 80L, 81L, 82L, 83L, \n84L, 85L, 86L, 87L, 88L, 89L, 93L, 94L, 95L, 96L, 99L, 100L, \n101L, 103L, 104L, 105L, 106L, 107L, 108L, 109L, 110L, 111L, 112L, \n113L, 114L, 116L, 117L, 118L, 119L, 120L, 121L, 122L, 123L, 124L, \n134L, 135L, 136L, 247L, 248L, 249L, 250L, 251L, 252L, 253L, 254L, \n255L, 256L, 257L, 258L, 259L, 260L, 261L, 262L, 263L, 264L, 265L, \n266L, 285L, 286L, 287L, 288L), .Label = c(\"A05_122_01\", \"A05_277_07\", \n\"A05_400_01\", \"A05_99_01\", \"A06_1283_02\", \"A06_1389_01\", \"A06_1390_01\", \n\"A06_1441_02\", \"A06_884_03\", \"A0K_1190_03\", \"A77_1684_01\", \"A8K_525_03\", \n\"A8K_582_01\", \"A8K_645_01\", \"A8K_799_01\", \"A90_341_02\", \"A90_496_01\", \n\"A94_217_01\", \"A94_472_01\", \"A94_477_03\", \"A9M_164_01\", \"A9M_259_03\", \n\"A9N_199_01\", \"A9N_489_01\", \"A9N_591_01\", \"A9R_173_01\", \"A9R_425_02\", \n\"A9W_536_02\", \"AA5_121_01\", \"AAE_203_01\", \"AAE_243_01\", \"AAE_412_01\", \n\"AAW_14_03\", \"AAW_244_02\", \"AAW_297_04\", \"AAW_365_04\", \"ADG_1398_01\", \n\"ADG_1500_01\", \"ADG_1507_01\", \"ADG_1516_01\", \"AHB_336_01\", \"AHB_421_01\", \n\"AHJ_1090_02\", \"AHJ_619_01\", \"AR3_340_01\", \"AR3_91_03\", \"ARF_879_01\", \n\"ARF_985_01\", \"ARF_991_02\", \"ARK_1891_01\", \"ASL_33_04\", \"ASL_43_01\", \n\"ASL_9_01\", \"AT7_1031_01\", \"B09_1162_01\", \"B09_1475_01\", \"B09_1493_01\", \n\"B09_1539_01\", \"B0G_197_01\", \"B0G_320_01\", \"B0N_1037_01\", \"B0N_624_01\", \n\"B0N_645_02\", \"B0N_683_01\", \"B3G_313_04\", \"B3G_320_03\", \"B3G_398_02\", \n\"B7M_1630_01\", \"B7M_1913_01\", \"BNN_746_02\", \"BNN_895_01\", \"BP7_2426_01\", \n\"BP7_2777_01\", \"BP7_2898_01\", \"BP9_410_01\", \"BP9_599_01\", \"BPK_829_01\", \n\"C93_1407_02\", \"C9A_181_01\", \"C9A_196_01\", \"C9A_365_01\", \"C9A_82_02\", \n\"C9A_9_01\", \"CB9_306_02\", \"CB9_63_04\", \"CB9_86_01\", \"CBJ_439_01\", \n\"CBJ_702_02\", \"CBJ_705_01\", \"CCM_320_01\", \"CCM_665_01\", \"CCM_669_02\", \n\"CCN_1036_02\", \"CCN_1078_01\", \"CCN_1119_01\", \"CCN_784_01\", \"CCW_2284_02\", \n\"CCW_2349_03\", \"CE7_242_02\", \"CE7_284_01\", \"CE7_39_01\", \"CEB_1675_01\", \n\"CER_145_03\", \"CER_23_01\", \"CER_235_02\", \"CER_378_10\", \"CET_1056_02\", \n\"CET_680_01\", \"CET_705_01\", \"CET_797_01\", \"CET_838_01\", \"CET_879_05\", \n\"CET_946_03\", \"CET_986_01\", \"CEY_2977_01\", \"CJ3_107_02\", \"CJ3_114_03\", \n\"CJ3_20_01\", \"CJ3_81_01\", \"CK2_112_01\", \"CK2_22_01\", \"CK2_392_01\", \n\"CK2_42_01\", \"CK2_75_01\", \"CKC_1776_01\", \"CKC_1777_01\", \"CKC_1823_01\", \n\"CKC_1824_01\", \"CKC_1860_01\", \"CKC_1883_01\", \"CKC_1883_02\", \"CKC_2127_01\", \n\"CMN_1439_02\", \"CRM_5767_01\", \"CRM_5770_03\", \"CRM_5789_01\", \"CS2_110_01\", \n\"CS2_131_01\", \"CS2_139_01\", \"CS2_187_01\", \"CS2_187_03\", \"CS2_231_03\", \n\"CS2_249_02\", \"CS2_301_01\", \"CS2_35_01\", \"CS2_58_02\", \"EV6_16_01\", \n\"EV6_206_02\", \"EV6_240_01\", \"EV6_244_02\", \"EV6_28_01\", \"EV6_30_01\", \n\"EV6_32_01\", \"EV6_450_01\", \"EV6_69_01\", \"EV6_80_01\", \"EV6_91_01\", \n\"FAC_1019_01\", \"FAC_1026_01\", \"FAC_1027_01\", \"FAC_1235_01\", \"FAC_1269_05\", \n\"FAC_1270_05\", \"FAC_1393_01\", \"FAC_1406_03\", \"FAC_933_01\", \"FAC_950_01\", \n\"FAC_960_01\", \"FED_105_01\", \"FED_120_02\", \"FED_21_02\", \"FED_281_02\", \n\"FED_302_02\", \"FED_53_01\", \"FED_8_05\", \"FEF_498_03\", \"FEF_674_03\", \n\"FR2_410_01\", \"FR2_557_02\", \"FR2_593_01\", \"FR2_691_01\", \"FR4_232_01\", \n\"FR4_331_01\", \"FR4_346_01\", \"FS7_818_01\", \"FS7_919_01\", \"FU0_368_02\", \n\"FYT_1138_01\", \"FYT_1183_01\", \"FYT_901_05\", \"G08_1336_01\", \"G1E_385_01\", \n\"G1N_824_01\", \"G1N_860_01\", \"G1N_868_01\", \"G1N_975_01\", \"GU5_854_01\", \n\"GUJ_423_01\", \"GUJ_501_01\", \"GUJ_611_01\", \"GUJ_629_03\", \"GUJ_700_01\", \n\"GV0_10_01\", \"GV0_104_01\", \"GV0_111_01\", \"GV0_122_01\", \"GV0_160_01\", \n\"GV0_232_02\", \"GV2_1465_01\", \"GV2_1899_01\", \"GV6_2683_01\", \"GW6_297_01\", \n\"GW6_306_05\", \"GW6_307_01\", \"GW6_322_01\", \"GW6_330_02\", \"GW6_335_01\", \n\"GW6_338_01\", \"GW6_367_02\", \"GW6_373_01\", \"GW6_407_01\", \"GW6_411_01\", \n\"GW6_413_01\", \"GW6_421_01\", \"GW6_423_01\", \"GW6_424_01\", \"GW6_428_01\", \n\"GW6_447_01\", \"GWM_480_01\", \"GWM_533_02\", \"GWM_554_02\", \"GWM_554_03\", \n\"GWM_609_01\", \"GWM_609_04\", \"GWM_610_01\", \"GWM_730_01\", \"GWM_731_01\", \n\"GWM_738_01\", \"GWM_804_06\", \"GWM_815_01\", \"GWM_832_03\", \"GVP_179_01\", \n\"GVP_211_01\", \"GVP_393_02\", \"GVP_443_02\", \"GVP_710_01\", \"H0B_171_04\", \n\"H0B_216_01\", \"H0B_265_01\", \"H0B_32_01\", \"H0B_361_03\", \"H0B_365_01\", \n\"H0B_369_01\", \"H0B_74_01\", \"H0B_93_01\", \"H10_1002_01\", \"H10_1032_04\", \n\"H10_653_01\", \"H10_803_01\", \"H10_824_01\", \"H10_825_03\", \"H10_881_01\", \n\"H10_986_01\", \"H78_851_04\", \"H78_891_01\", \"H78_946_04\", \"H79_1959_19\", \n\"H7S_110_05\", \"H7S_130_06\", \"H7S_131_03\", \"H7S_131_04\", \"H7S_146_01\", \n\"H7S_148_01\", \"H7S_164_01\", \"H7S_179_01\", \"H7S_54_01\", \"H7S_56_05\", \n\"H7S_62_03\", \"H7S_79_01\", \"H7S_8_01\", \"H7S_81_01\", \"H7S_83_01\", \n\"H7S_87_01\", \"H7S_92_03\", \"H7X_1028_02\", \"H7X_1091_01\", \"H7X_691_01\", \n\"H7X_695_01\", \"H8H_2917_01\", \"H8K_153_01\", \"H8K_55_01\", \"H8M_1897_01\", \n\"H8M_2104_02\", \"H8T_3316_03\", \"H98_3204_01\", \"H98_3410_01\", \"H98_3490_02\", \n\"H9R_130_02\", \"H9R_39_01\", \"H9S_1297_01\", \"HA2_3107_02\", \"HA2_3284_01\", \n\"HPY_754_04\", \"HPY_785_09\", \"HPY_799_03\", \"HPY_807_04\", \"HPY_830_04\", \n\"HPY_838_02\", \"HPY_843_01\", \"HPY_869_11\", \"HR7_190_01\", \"HR7_440_01\", \n\"HTP_540_01\", \"HTP_585_01\", \"HTP_588_05\", \"HTP_593_01\", \"HTP_601_01\", \n\"HTP_613_01\", \"HTP_648_02\", \"HTW_197_01\", \"HTW_494_01\", \"HTW_750_01\", \n\"HWL_2770_01\", \"HWL_2919_01\", \"HWM_45_01\", \"HWM_45_02\", \"HXY_1047_03\", \n\"HXY_701_01\", \"HXY_781_01\", \"HXY_783_01\", \"HXY_784_01\", \"HXY_836_01\", \n\"HXY_931_01\", \"HXY_963_01\", \"HXY_972_01\", \"HXY_985_03\", \"HY6_1024_01\", \n\"HY6_1025_01\", \"HY6_1164_01\", \"HY6_1223_01\", \"HY6_988_03\", \"HY6_989_01\", \n\"HY8_160_01\", \"HY8_164_01\", \"HY8_292_03\", \"HY8_316_01\", \"HY9_778_03\", \n\"HY9_845_02\", \"HYX_235_08\", \"HYX_245_01\", \"HYX_88_01\", \"J12_1474_02\", \n\"J12_1492_01\", \"J12_1571_01\", \"J12_1845_01\", \"J14_341_01\", \"J18_597_04\", \n\"J18_698_02\", \"J18_759_01\", \"J18_828_01\", \"J3R_197_01\", \"J3R_219_02\", \n\"J3R_277_04\", \"J3T_267_01\", \"J3T_269_02\", \"J3T_57_02\", \"J41_41_02\", \n\"J41_58_03\", \"J9B_133_03\", \"J9B_341_02\", \"J9B_341_03\", \"J9D_147_05\", \n\"J9D_218_01\", \"J9D_411_01\", \"J9D_616_01\", \"J9D_616_02\", \"JNB_563_02\", \n\"JT7_118_01\", \"JT7_129_02\", \"JT7_218_02\", \"JT7_344_02\", \"JXS_3663_01\", \n\"JXU_407_01\", \"JXU_468_02\", \"JXU_559_01\", \"JXV_1439_04\", \"JXV_1592_01\", \n\"JY1_100_01\"), class = \"factor\"), GENRE = structure(c(1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, \n2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, \n2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, \n3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, \n3L, 3L, 3L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, \n4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, \n4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, \n4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 5L, 5L, 5L, \n5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, \n5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, \n5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, \n5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, \n5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, \n5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, \n5L, 5L), .Label = c(\"Academic Prose\", \"Conversation\", \"News\", \n\"Novels\", \"Popular Science\"), class = \"factor\"), NODE = structure(c(9L, \n10L, 10L, 10L, 4L, 10L, 71L, 35L, 49L, 6L, 5L, 15L, 28L, 44L, \n64L, 64L, 28L, 28L, 18L, 18L, 32L, 18L, 58L, 10L, 72L, 28L, 18L, \n10L, 64L, 10L, 35L, 64L, 64L, 69L, 8L, 10L, 50L, 69L, 49L, 49L, \n15L, 69L, 10L, 49L, 8L, 64L, 49L, 10L, 69L, 18L, 61L, 67L, 67L, \n61L, 57L, 69L, 11L, 10L, 64L, 10L, 59L, 61L, 49L, 10L, 59L, 1L, \n61L, 35L, 54L, 54L, 39L, 44L, 61L, 64L, 69L, 1L, 23L, 49L, 49L, \n8L, 69L, 49L, 69L, 49L, 49L, 69L, 35L, 49L, 49L, 49L, 35L, 10L, \n49L, 48L, 10L, 49L, 11L, 44L, 50L, 11L, 50L, 69L, 49L, 10L, 59L, \n68L, 47L, 69L, 49L, 35L, 29L, 8L, 49L, 50L, 35L, 10L, 35L, 8L, \n35L, 8L, 10L, 35L, 10L, 10L, 10L, 35L, 44L, 61L, 35L, 44L, 28L, \n47L, 39L, 39L, 49L, 61L, 43L, 60L, 19L, 10L, 10L, 10L, 44L, 44L, \n62L, 44L, 10L, 59L, 10L, 61L, 1L, 53L, 33L, 10L, 8L, 8L, 64L, \n64L, 10L, 57L, 61L, 64L, 66L, 19L, 61L, 64L, 10L, 10L, 8L, 19L, \n35L, 28L, 10L, 61L, 35L, 42L, 35L, 28L, 32L, 64L, 10L, 18L, 28L, \n25L, 35L, 35L, 10L, 18L, 10L, 22L, 55L, 28L, 10L, 1L, 55L, 51L, \n1L, 38L, 28L, 28L, 33L, 10L, 44L, 29L, 16L, 8L, 28L, 69L, 32L, \n10L, 61L, 20L, 35L, 10L, 28L, 10L, 32L, 10L, 46L, 59L, 64L, 35L, \n66L, 2L, 35L, 28L, 30L, 18L, 69L, 32L, 10L, 28L, 17L, 36L, 64L, \n61L, 10L, 64L, 33L, 3L, 37L, 26L, 28L, 64L, 44L, 28L, 64L, 64L, \n6L, 6L, 64L, 50L, 32L, 8L, 64L, 50L, 28L, 24L, 18L, 47L, 35L, \n40L, 24L, 55L, 44L, 22L, 1L, 49L, 44L, 18L, 45L, 63L, 64L, 35L, \n12L, 35L, 10L, 35L, 10L, 10L, 10L, 44L, 44L, 44L, 65L, 44L, 55L, \n32L, 49L, 64L, 39L, 69L, 1L, 60L, 7L, 14L, 44L, 33L, 10L, 19L, \n10L, 70L, 53L, 8L, 61L, 61L, 44L, 61L, 65L, 28L, 68L, 69L, 27L, \n61L, 28L, 72L, 34L, 61L, 32L, 10L, 49L, 35L, 49L, 10L, 10L, 69L, \n39L, 40L, 19L, 59L, 53L, 49L, 49L, 44L, 49L, 35L, 49L, 61L, 61L, \n1L, 10L, 28L, 49L, 35L, 49L, 61L, 50L, 69L, 35L, 61L, 35L, 50L, \n10L, 28L, 69L, 61L, 21L, 69L, 29L, 35L, 35L, 35L, 11L, 69L, 8L, \n41L, 56L, 35L, 61L, 69L, 49L, 49L, 49L, 1L, 13L, 64L, 64L, 52L, \n44L, 64L, 64L, 50L, 49L, 69L, 11L, 59L, 49L, 31L), .Label = c(\"apparent\", \n\"appropriate\", \"awful\", \"axiomatic\", \"best\", \"better\", \"breathtaking\", \n\"certain\", \"characteristic\", \"clear\", \"conceivable\", \"convenient\", \n\"crucial\", \"cruel\", \"desirable\", \"disappointing\", \"emphatic\", \n\"essential\", \"evident\", \"expected\", \"extraordinary\", \"fair\", \n\"fortunate\", \"Funny\", \"good\", \"great\", \"imperative\", \"important\", \n\"impossible\", \"incredible\", \"inescapable\", \"inevitable\", \"interesting\", \n\"ironic\", \"likely\", \"Likely\", \"lucky\", \"ludicrous\", \"natural\", \n\"necessary\", \"needful\", \"notable\", \"noteworthy\", \"obvious\", \"odd\", \n\"paradoxical\", \"plain\", \"plausible\", \"possible\", \"probable\", \n\"proper\", \"relevant\", \"remarkable\", \"revealing\", \"right\", \"Sad\", \n\"self-evident\", \"sensible\", \"significant\", \"striking\", \"surprising\", \n\"symptomatic\", \"terrible\", \"true\", \"typical\", \"understandable\", \n\"unexpected\", \"unfortunate\", \"unlikely\", \"unreasonable\", \"untrue\", \n\"vital\"), class = \"factor\")), .Names = c(\"ID\", \"GENRE\", \"NODE\"\n), class = \"data.frame\", row.names = c(NA, -388L))\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":1,"up_vote_count":12,"down_vote_count":0,"view_count":98,"score":12,"question_id":13289009,"title":"Check if character string is a valid color representation","body":"<p>Short question, if I have a string, how can I test if that string is a valid color representation in <code>R</code>?</p>\n\n<p>Two things I tried, first uses the function <code>col2rgb()</code> to test if it is a color:</p>\n\n<pre><code>isColor &lt;- function(x)\n{\n  res &lt;- try(col2rgb(x),silent=TRUE)\n  return(!\"try-error\"%in%class(res))\n}\n\n&gt; isColor(\"white\")\n[1] TRUE\n&gt; isColor(\"#000000\")\n[1] TRUE\n&gt; isColor(\"foo\")\n[1] FALSE\n</code></pre>\n\n<p>Works, but doesn't seem very pretty and isn't vectorized. Second thing is to just check if the string is in the <code>colors()</code> vector or a <code>#</code> followed by a hexadecimal number of length 4 to 6:</p>\n\n<pre><code>isColor2 &lt;- function(x)\n{\n  return(x%in%colors() | grepl(\"^#(\\\\d|[a-f]){6,8}$\",x,ignore.case=TRUE))\n}\n\n&gt; isColor2(\"white\")\n[1] TRUE\n&gt; isColor2(\"#000000\")\n[1] TRUE\n&gt; isColor2(\"foo\")\n[1] FALSE\n</code></pre>\n\n<p>Which works though I am not sure how stable it is. But it seems that there should be a built in function to make this check?</p>\n"},{"tags":["r","web-scraping"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13282094,"title":"Download VIX futures prices from CBOE","body":"<p>I am trying to get historical prices for VIX futures by downloading all the CSV files on this page (http://cfe.cboe.com/Products/historicalVIX.aspx).  Here is the code I am using to do this:</p>\n\n<pre><code>library(XML)\n\n#Extract all links for url\nurl &lt;- \"http://cfe.cboe.com/Products/historicalVIX.aspx\"\ndoc &lt;- htmlParse(url)\nlinks &lt;- xpathSApply(doc, \"//a/@href\")\nfree(doc)\n\n#Filter out URLs ending with csv and complete the link.\nlinks &lt;- links[substr(links, nchar(links) - 2, nchar(links)) == \"csv\"]\nlinks &lt;- paste(\"http://cfe.cboe.com\", links, sep=\"\")\n\n#Peform read.csv on each url in links, skipping the first two URLs as they are not relevant.\nc &lt;- lapply(links[-(1:2)], read.csv, header = TRUE)\n</code></pre>\n\n<p>I get the error:</p>\n\n<pre><code>Error in read.table(file = file, header = header, sep = sep, quote = quote,  : \n  more columns than column names\n</code></pre>\n\n<p>Upon further investigation, I realize this is because some of the CSV files are formatted differently.  If I load the URL <code>links[9]</code> manually, I see that the first row has this disclaimer:</p>\n\n<pre><code>CFE data is compiled for the .......use of CFE data is subject to the Terms and Conditions of CBOE's Websites.\n</code></pre>\n\n<p>Most of the other files (e.g.<code>links[8]</code> and <code>links[10]</code>) are fine so it seems this has been randomly inserted.  Is there some R magic that can be done to handle this?</p>\n\n<p>Thank you.</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13277666,"title":"Replace element in vector if element is x and previous element is na, in R","body":"<pre><code>foo &lt;- c(\"a\",\"a\",NA,\"b\",\"a\",\"a\",\"b\",\"b\")\n</code></pre>\n\n<p>How to replace \"b\" by whatever if previous element is NA ?</p>\n\n<pre><code>foo[foo==\"b\" &amp; \"previous-element\"==NA] &lt;- \"whatever\"\n</code></pre>\n\n<p>So expected output would be :</p>\n\n<pre><code>result &lt;- c(\"a\",\"a\",NA,\"whatever\",\"a\",\"a\",\"b\",\"b\")\n</code></pre>\n\n<p>So only \"b\" (many in real datas) preceded by NA would be changed.</p>\n\n<p>Thank's for helping !</p>\n"},{"tags":["r","ggplot2"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":62,"score":5,"question_id":13286531,"title":"how to suppress warnings when plotting with ggplot","body":"<p>When passing missing values to ggplot, it's very kind and warns us that they are present. This is acceptable in an interactive session, but when writing reports, you do not the output get cluttered with warnings, especially if there's many of them. Below example has one label missing, which produces a warning.</p>\n\n<pre><code>library(ggplot2)\nlibrary(reshape2)\nmydf &lt;- data.frame(\n  species = sample(c(\"A\", \"B\"), 100, replace = TRUE), \n  lvl = factor(sample(1:3, 100, replace = TRUE))\n)\nlabs &lt;- melt(with(mydf, table(species, lvl)))\nnames(labs) &lt;- c(\"species\", \"lvl\", \"value\")\nlabs[3, \"value\"] &lt;- NA\nggplot(mydf, aes(x = species)) + \n   stat_bin() + \n   geom_text(data = labs, aes(x = species, y = value, label = value, vjust = -0.5)) +\n   facet_wrap(~ lvl)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/l9AnH.png\" alt=\"enter image description here\"></p>\n\n<p>If we wrap <code>suppressWarnings</code> around the last expression, we get a summary of how many warnings there were. For the sake of argument, let's say that this isn't acceptable (but is indeed very honest and correct). How to (completely) suppress warnings when printing a ggplot2 object?</p>\n"},{"tags":["r","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13286741,"title":"How do I make my list into a dataframe if rbind.fill always returns null?","body":"<p>I have this list:</p>\n\n<pre><code>myList&lt;-list(c(\"Developmental Biology\", \" Neuroscience\", \" Cell Biology\"\n), c(\"Developmental Biology\", \" Neuroscience\", \" Cell Biology\"\n), c(\"Developmental Biology\", \" Neuroscience\", \" Genomics &amp; Genetics\"\n), c(\"Developmental Biology\", \" Neuroscience\", \" Cell Biology\"\n), c(\"Developmental Biology\", \" Neuroscience\", \" Cell Biology\"\n), c(\"Developmental Biology\", \" Genomics &amp; Genetics\"))\n</code></pre>\n\n<p>I want this dataframe:</p>\n\n<pre><code>     [,1]                    [,2]                   [,3]                   \n[1,] \"Developmental Biology\" \" Neuroscience\"        \" Cell Biology\"        \n[2,] \"Developmental Biology\" \" Neuroscience\"        \" Cell Biology\"        \n[3,] \"Developmental Biology\" \" Neuroscience\"        \" Genomics &amp; Genetics\" \n[4,] \"Developmental Biology\" \" Neuroscience\"        \" Cell Biology\"        \n[5,] \"Developmental Biology\" \" Neuroscience\"        \" Cell Biology\"        \n[6,] \"Developmental Biology\" \" Genomics &amp; Genetics\" \"NA\"\n</code></pre>\n\n<p>I would have thought rbind.fill would be the way to go, but <code>do.call(rbind.fill,myList)</code> returns <code>NULL</code>. </p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13289275,"title":"atan2 confusion","body":"<p>Given two lines, <code>q</code> and <code>w</code> the slope of <code>w=-1</code> and the slope of <code>q=1</code></p>\n\n<p>I can find the angle of intersect with:</p>\n\n<pre><code>atan(abs((-1-1)/(1+ (-1*1))))\n\n# in degrees\n#( 1.570796/pi)*180\n# [1] 89.99998\n</code></pre>\n\n<p>as in this <a href=\"http://planetmath.org/AngleBetweenTwoLines.html\" rel=\"nofollow\">helpful link</a></p>\n\n<p>but to generalise this to case where  the  lines might be one horizontal <code>l1</code> one vertical <code>l2</code>. The slope of <code>l1=0</code> and the slope of <code>l2 = Inf</code></p>\n\n<p>It is not possible to use the above code to get the angle they intersect e.g. like <code>atan2</code></p>\n\n<p>but <code>atan2</code> always compares to the x-axis from my reading. Is there a similar function where I can give  the expression:</p>\n\n<pre><code>(abs((Inf-0)/(1+ (0*Inf))))\n</code></pre>\n\n<p>or is it best that go for:</p>\n\n<pre><code>a &lt;- ifelse(!l2 == 0, atan(abs((l1-l2)/(1+ (l1*l2)))),max(abs(l1,l2)))\na &lt;- ifelse(!l1 == Inf, atan(abs((l1-l2)/(1+ (l1*l2)))),abs(1/min(l1,l2)))\na &lt;- ifelse(!l2 == 0, atan(abs((l1-l2)/(1+ (l1*l2)))),max(abs(l1,l2)))\na &lt;- ifelse(!l2 == Inf, atan(abs((l1-l2)/(1+ (l1*l2)))),abs(1/min(l1,l2)))\na &lt;- ifelse(a == Inf, 90, a)\n</code></pre>\n\n<p>But this sort if thing seems rubbish</p>\n\n<p>or likely I am confused with how to utlize <code>atan2</code></p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":41,"score":-5,"question_id":13289669,"title":"How to find aggregate in R","body":"<pre><code>quartiles &lt;- quantcut(num$data_m, seq (0,1,by=0.25),label = F)\n\naggdata &lt;-aggregate(quartiles, by=list(a,b), FUN = mean)\nError in aggregate.data.frame(as.data.frame(x), ...) : \n  arguments must have same length\n</code></pre>\n\n<p>anyone can help, I have problem with <code>list(a,b)</code></p>\n"},{"tags":["r","encoding"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13251665,"title":"Rhtml: Warning: conversion failure on '<var>' in 'mbcsToSbcs': dot substituted for <var>","body":"<p><strong>Environment:</strong></p>\n\n<p>R v. 2.15.1 on Mac OS 10.8.2, platform x86_64-apple-darwin9.8.0/x86_64 (64-bit), with RStudio IDE which is set to use UTF-8 as its default encoding. The OS also uses UTF-8.</p>\n\n<pre><code>&gt; Sys.getlocale(category = \"LC_ALL\")\n[1] \"sk_SK.UTF-8/sk_SK.UTF-8/sk_SK.UTF-8/C/sk_SK.UTF-8/sk_SK.UTF-8\"\n</code></pre>\n\n<p><strong>Objective:</strong></p>\n\n<p>Generate an HTML file from the R HTML (.Rhtml) file, containing a plot with extended latin characters, such as š or č.</p>\n\n<p><strong>Problem:</strong></p>\n\n<p>When I click on <strong>Knit HTML</strong>, the output looks like this:</p>\n\n<pre><code>plot(1:2, main = \"šč\")\n## Warning: conversion failure on 'šč' in 'mbcsToSbcs': dot substituted for\n## \n## Warning: conversion failure on 'šč' in 'mbcsToSbcs': dot substituted for\n## \n## Warning: conversion failure on 'šč' in 'mbcsToSbcs': dot substituted for\n## \n## Warning: conversion failure on 'šč' in 'mbcsToSbcs': dot substituted for\n## &lt;8d&gt;\n**Plot with correct characters despite the warnings.**\n</code></pre>\n\n<p><strong>Question:</strong></p>\n\n<p>What causes the problem and how to solve it? How can I at least get rid of the warnings which do show in the resulting file?</p>\n\n<p><strong>Hopeless note:</strong></p>\n\n<p>I have been searching for a solution for the past hour or two, found many similar cases and tried many different potential solutions (many related to PDF output, which is cocked up the same way if I use just Sweave), and now I am literally hopeless.</p>\n"},{"tags":["r","matrix","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13287147,"title":"How to merge two matrices with differing number of rows","body":"<p>Lets say i have 2 matrices looking like this:</p>\n\n<pre><code>structure(c(0.315789473684211, 0.315789473684211, 0.315789473684211, \n0.315789473684211, 0.315789473684211, 0.315789473684211, 0.315789473684211, \n0.315789473684211, 0.315789473684211, 0.315789473684211, 0.315789473684211, \n0.315789473684211, 0.315789473684211, 0.315789473684211), .Dim = c(14L, \n1L), .Dimnames = list(c(\"ch5_98500001\", \"ch5_99500001\", \"ch5_100500001\", \n\"ch5_101500001\", \"ch5_102500001\", \"ch5_103500001\", \"ch5_104500001\", \n\"ch5_105500001\", \"ch5_106500001\", \"ch5_110500001\", \"ch5_111500001\", \n\"ch5_112500001\", \"ch5_113500001\", \"ch5_114500001\"), \"loh\"))\n                    loh\nch5_98500001  0.3157895\nch5_99500001  0.3157895\nch5_100500001 0.3157895\nch5_101500001 0.3157895\nch5_102500001 0.3157895\nch5_103500001 0.3157895\n\nstructure(c(0.315789473684211, 0.315789473684211, 0.315789473684211, \n0.315789473684211, 0.315789473684211, 0.315789473684211, 0.315789473684211, \n0.315789473684211, 0.315789473684211, 0.315789473684211, 0.315789473684211, \n0.315789473684211, 0.315789473684211, 0.315789473684211, 0.315789473684211, \n0.315789473684211, 0.315789473684211, 0.315789473684211, 0.315789473684211, \n0.315789473684211, 0.315789473684211, 0.315789473684211, 0.315789473684211, \n0.315789473684211, 0.315789473684211, 0.315789473684211, 0.315789473684211, \n0.315789473684211, 0.315789473684211, 0.315789473684211, 0.315789473684211, \n0.315789473684211, 0.315789473684211, 0.315789473684211, 0.315789473684211, \n0.315789473684211, 0.315789473684211, 0.368421052631579, 0.368421052631579, \n0.368421052631579, 0.368421052631579, 0.368421052631579, 0.368421052631579, \n0.368421052631579, 0.368421052631579, 0.368421052631579, 0.368421052631579, \n0.368421052631579, 0.368421052631579, 0.368421052631579, 0.368421052631579, \n0.368421052631579, 0.368421052631579, 0.368421052631579, 0.368421052631579, \n0.368421052631579, 0.368421052631579, 0.368421052631579, 0.368421052631579, \n0.368421052631579, 0.368421052631579, 0.368421052631579, 0.368421052631579, \n0.368421052631579, 0.368421052631579, 0.368421052631579, 0.368421052631579, \n0.368421052631579, 0.368421052631579, 0.368421052631579, 0.368421052631579, \n0.368421052631579, 0.368421052631579, 0.368421052631579, 0.368421052631579, \n0.368421052631579, 0.368421052631579, 0.368421052631579, 0.368421052631579, \n0.368421052631579, 0.368421052631579, 0.368421052631579, 0.368421052631579\n), .Dim = c(83L, 1L), .Dimnames = list(c(\"ch8_20500001\", \"ch8_21500001\", \n\"ch8_22500001\", \"ch8_23500001\", \"ch8_24500001\", \"ch8_25500001\", \n\"ch8_26500001\", \"ch8_27500001\", \"ch8_28500001\", \"ch18_500001\", \n\"ch18_1500001\", \"ch18_2500001\", \"ch18_3500001\", \"ch18_4500001\", \n\"ch18_5500001\", \"ch18_6500001\", \"ch18_7500001\", \"ch18_8500001\", \n\"ch18_9500001\", \"ch18_10500001\", \"ch18_11500001\", \"ch18_12500001\", \n\"ch18_13500001\", \"ch18_14500001\", \"ch18_15500001\", \"ch18_16500001\", \n\"ch18_17500001\", \"ch18_18500001\", \"ch18_19500001\", \"ch18_20500001\", \n\"ch18_21500001\", \"ch18_24500001\", \"ch18_25500001\", \"ch18_26500001\", \n\"ch18_27500001\", \"ch18_28500001\", \"ch18_29500001\", \"ch18_30500001\", \n\"ch18_31500001\", \"ch18_32500001\", \"ch18_33500001\", \"ch18_34500001\", \n\"ch18_35500001\", \"ch18_36500001\", \"ch18_37500001\", \"ch18_38500001\", \n\"ch18_39500001\", \"ch18_40500001\", \"ch18_41500001\", \"ch18_42500001\", \n\"ch18_43500001\", \"ch18_44500001\", \"ch18_45500001\", \"ch18_46500001\", \n\"ch18_47500001\", \"ch18_48500001\", \"ch18_49500001\", \"ch18_50500001\", \n\"ch18_51500001\", \"ch18_52500001\", \"ch18_53500001\", \"ch18_54500001\", \n\"ch18_55500001\", \"ch18_56500001\", \"ch18_57500001\", \"ch18_58500001\", \n\"ch18_59500001\", \"ch18_60500001\", \"ch18_61500001\", \"ch18_62500001\", \n\"ch18_63500001\", \"ch18_64500001\", \"ch18_65500001\", \"ch18_66500001\", \n\"ch18_67500001\", \"ch18_68500001\", \"ch18_69500001\", \"ch18_70500001\", \n\"ch18_71500001\", \"ch18_72500001\", \"ch18_73500001\", \"ch18_74500001\", \n\"ch18_75500001\"), \"loss\"))\n                  loss\nch8_20500001 0.3157895\nch8_21500001 0.3157895\nch8_22500001 0.3157895\nch8_23500001 0.3157895\nch8_24500001 0.3157895\nch8_25500001 0.3157895\nch8_26500001 0.3157895\nch8_27500001 0.3157895\nch8_28500001 0.3157895\nch18_500001  0.3157895\nch18_1500001 0.3157895\nch18_2500001 0.3157895\n</code></pre>\n\n<p>And i want them to merge in 1 data.frame or matrix just so that i have an overview and there's no need for switching between the files. But the problem solving this seems a bit harder than just use <code>data.frame</code>.</p>\n\n<p>Anyone any idea how not to get the problem of differing row lengths?</p>\n"},{"tags":["r","reference-class"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":172,"score":6,"question_id":8159317,"title":"Private Members in R Reference Class","body":"<p>Is it possible to have private member fields inside of an R reference class.  Playing with some of the online examples I have:</p>\n\n<pre><code>&gt; Account &lt;- setRefClass(    \"ref_Account\"\n&gt;      , fields = list(\n&gt;       number = \"character\"\n&gt;       , balance =\"numeric\")\n&gt;      , methods = list( \n&gt;     deposit &lt;- function(amount) {\n&gt;       if(amount &lt; 0)   {\n&gt;         stop(\"deposits must be positive\")\n&gt;       }\n&gt;       balance &lt;&lt;- balance + amount\n&gt;     }\n&gt;     , withdraw &lt;- function(amount) {\n&gt;       if(amount &lt; 0)   {\n&gt;         stop(\"withdrawls must be positive\")\n&gt;       }\n&gt;       balance &lt;&lt;- balance - amount\n&gt;     }       \n&gt;   ) )\n&gt; \n&gt; \n&gt; tb &lt;- Account$new(balance=50.75, number=\"baml-029873\") tb$balance\n&gt; tb$balance &lt;- 12 \n&gt; tb$balance\n</code></pre>\n\n<p>I hate the fact I can update the balance directly.  Perhaps that the old pure OO in me, I really would like to be able make the balance private, at least non-settable from outside the class.</p>\n\n<p>Thoughts</p>\n"},{"tags":["r","statistics"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13287493,"title":"In a time series study, how many time points are enough for unit root test","body":"<p>I'm keeping some fish for toxicity test and will analyze specific parameter after exposing toxicants. I am keeping the fish in normal condition and check the parameter daily as \"baseline\". I plan to run unit root test to confirm whether there is change after toxicant exposure. However, I'm not quite sure how long the \"baseline\" data I need to obtain will considered \"enough\" for the upcoming analysis. Anyone may provide me hints? Thank you.</p>\n"},{"tags":["r","data.frame","matching","multiple-columns"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13286881,"title":"Matching multiple columns on different data frames and getting other column as result","body":"<p>I got two big data frames, one (<code>df1</code>) has this structure</p>\n\n<pre><code>   chr    init\n1  12  25289552\n2   3 180418785\n3   3 180434779\n</code></pre>\n\n<p>The other (<code>df2</code>) has this</p>\n\n<pre><code>    V1    V2     V3\n10  1     69094 medium\n11  1     69094 medium\n12  12 25289552 high\n13  1     69095 medium\n14  3 180418785 medium\n15  3 180434779 low\n</code></pre>\n\n<p>What I'm trying to do is to add the column <code>V3</code> of <code>df2</code> to <code>df1</code>, to get the info of the mutation</p>\n\n<pre><code>   chr    init  Mut\n1  12  25289552 high\n2   3 180418785 medium\n3   3 180434779 low\n</code></pre>\n\n<p>I'm trying loading both into R and then doing a for loop using match but it doesn't work. Do you know any special way to do this? I am also open to do using awk or something similar</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":13085481,"title":"Namespace dependencies not required","body":"<p>I am trying to build an R package so reading the manual on CRAN.\nI could figure out that using imports to load functions in your namespace would be the best bet to use in the Description file.\nAfter adding to the description file, I also added it to the namespace file.\nI added importFrom to the namespace file with the functions required.</p>\n\n<p>Now when I run R CMD check on my package,\nI get an ERROR as</p>\n\n<blockquote>\n  <p>Namespace dependencies not required :\n  'ggplot2'</p>\n</blockquote>\n\n<p>Further information : Even if i add the package to the Depends in the description file, they are not getting loaded.</p>\n\n<p>Please help with this.</p>\n\n<p>Please find my description file below</p>\n\n<blockquote>\n  <p>Package: bigpackage</p>\n  \n  <p>Type: Package</p>\n  \n  <p>Title: Some title</p>\n  \n  <p>Version: 1.0</p>\n  \n  <p>Date: 2012-10-25</p>\n  \n  <p>Author: Mayank Bansal  </p>\n  \n  <p>Maintainer: somename</p>\n  \n  <p>Imports : R(>= 2.15.1), SweaveListingUtils( >=0.5.5),xtable(>=1.7-0),\n          brew(>=1.0-6), knitr(>=0.8), RHive(>= 0.0-6), ggplot2(>=0.9.2)\n          , brew, knitr</p>\n  \n  <p>SystemRequirements : LaTeX(texi2dvi) must be present in the system to\n          create PDF reports</p>\n  \n  <p>Description: Some Description</p>\n  \n  <p>License: file LICENSE</p>\n  \n  <p>LazyLoad: yes</p>\n  \n  <p>ByteCompile: true</p>\n  \n  <p>OS_type : unix</p>\n</blockquote>\n"},{"tags":["r","function","if-statement","else"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":24,"score":0,"question_id":13286922,"title":"Multivariate probability densitiy function in R","body":"<p>I want to create a multivariate probability density function with R to plot it as a perspective plot. f(x,y) is x+y for [0,1]*[0,1], 0 else. I tried this: </p>\n\n<pre><code>x &lt;- seq(-0.5,1.5,length=50)*seq(0.5,1.5,length=50)\ny &lt;- x\n\nf &lt;- function(x,y){\n  if (0&lt;=x&lt;=1 &amp;&amp; 0&lt;=y&lt;=1){\n    x+y\n  } else {\n    0\n  }\n}\nf(x,y)  \n</code></pre>\n\n<p>But the function is not working and I don't know how to fix it. Does anyone have an idea?</p>\n"},{"tags":["r","debugging","ide","rstudio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13286281,"title":"Hide function definitions from the history for easier debug","body":"<p>Just suppose we are debugging a function <code>foo()</code>, and we want to modify it again and again and run it with some arguments - <code>foo(bar=\"Hello\", baz=\"How are you?\")</code> - to be sure the problem is solved. </p>\n\n<p>After a modification of the <code>foo()</code> body, we run the lines of the function definition - to make the function modified - and now, we have to search over the history for the line containing <code>foo(bar=\"Hello\", baz=\"How are you?\")</code> to see if the modified <code>foo()</code> works properly. \nSearching the history can also be replaced by continued pressing the \"Up\" key until it reaches before the function definition, when the last time we run <code>foo(bar=\"Hello\", baz=\"How are you?\")</code>. </p>\n\n<p>The other possibility is to keep <code>foo(bar=\"Hello\", baz=\"How are you?\")</code> in the clipboard and every time we modify the <code>foo()</code> body, we just paste <code>foo(bar=\"Hello\", baz=\"How are you?\")</code> from the clipboard and run it. </p>\n\n<p>But all of these solutions are quite hard if we are modifying several functions with long bodies at the same time. The best possibility I have taught is to hide the function definitions from the history - when we are working with native R environment or with IDEs like RStudio. Is there any possibility to do this? Is there any better solution?</p>\n"},{"tags":["r","sum","weighted"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13281532,"title":"Fastest way to take the weighted sum of the columns of a matrix in R","body":"<p>I need the weighted sum of each column of a matrix.</p>\n\n<pre><code>data &lt;- matrix(1:2e7,1e7,2) # warning large number, will eat up &gt;100 megs of memory\nweights &lt;- 1:1e7/1e5\nsystem.time(colSums(data*weights))\nsystem.time(apply(data,2,function(x) sum(x*weights)))\nall.equal(colSums(data*weights), apply(data,2,function(x) sum(x*weights)))\n</code></pre>\n\n<p>Typically <code>colSums(data*weights)</code> is faster than the apply call. </p>\n\n<p>I do this operation often (on a large matrix). Hence looking for advice on the most efficient implementation. Ideally, would have been great if we could pass weights to colSums (or rowSums).</p>\n\n<p>Thanks, appreciate any insights!</p>\n"},{"tags":["r","rjava"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":11838034,"title":"Passing parameters in .jcall","body":"<p>I have just started working with rJava to utilise a host of Java code in an R based application. I've tried some simple \"Hello world\" type things so I know the basic setup is working. I have several issues however I am hoping they will be resolved if I can resolve this basic problem using .jcall. </p>\n\n<pre><code>&gt; cal = new(J(\"java/util/GregorianCalendar\"))\n&gt; obj = new(J(\"au.gov.ips.dataarchive.TIndex\"))\n&gt; obj$monthlyT(cal)\n[1] 77\n&gt; .jcall(obj,\"I\",\"monthlyT\",cal)\n    Error in .jcall(obj, \"I\", \"monthlyT\", cal) : \n     method monthlyT with signature (Ljava/util/GregorianCalendar;)I not found\n</code></pre>\n\n<p>To my understanding, the 3rd and 4th lines are equivalent and should produce the same result. Clearly I am doing something wrong. The 'monthlyT' method is defined in the java code as:</p>\n\n<pre><code>static public Integer monthlyT(Calendar month)\n</code></pre>\n\n<p>I am not a Java expert, so please let me know what other info about the Java objects I might need to provide to answer the question.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":39,"score":7,"question_id":13279256,"title":"How to find out which .c file contains the .c functions of R internals?","body":"<p>I want to view the source code of R's <code>match.call</code> function. As it is an internal function, I downloaded the R source code, went to ./src/main/names.c and looked for <code>match.call</code> there. </p>\n\n<p>Thus, I found out that the corresponding .c function is called <code>do_matchcall</code>. Ok, but how can I find out which of the dozens of .c files in ./src/main/ contains the function <code>do_matchcall</code>?</p>\n\n<p>Btw I'm using a Windows machine, in case that makes a difference.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":8,"view_count":52,"score":-8,"question_id":13281860,"title":"Making a Barplot","body":"<p>I need to make a barplot in R.<br>\nBasically I have a dataset of baseball players that lists what team each player is on and what position each player plays at. For example:</p>\n\n<pre><code>Player    Team    Position \n1    Diamondbacks First Base\n2    Diamondbacks Third Base\n3    White Sox    Left Field\n4    Giants       Pitcher\n</code></pre>\n\n<p>The actual dataset is much bigger than this, but its the same idea. I need to make a barplot of the showing the frequencies of the different positions in the teams, and I do not know how to go about doing so. Basically, all I know is <code>barplot()</code>, so any help would be great.</p>\n\n<p>Thanks!</p>\n"},{"tags":["r","map","ggplot2"],"answer_count":1,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":171,"score":7,"question_id":13219387,"title":"world map - map halves of countries to different colors","body":"<p>I am using the example here for discussion:\n<a href=\"http://stackoverflow.com/questions/9558040/ggplot-map-with-l\">ggplot map with l</a></p>\n\n<pre><code>library(rgdal)\nlibrary(ggplot2)\nlibrary(maptools)\n\n# Data from http://thematicmapping.org/downloads/world_borders.php.\n# Direct link: http://thematicmapping.org/downloads/TM_WORLD_BORDERS_SIMPL-0.3.zip\n# Unpack and put the files in a dir 'data'\n\ngpclibPermit()\nworld.map &lt;- readOGR(dsn=\"data\", layer=\"TM_WORLD_BORDERS_SIMPL-0.3\")\nworld.ggmap &lt;- fortify(world.map, region = \"NAME\")\n\nn &lt;- length(unique(world.ggmap$id))\ndf &lt;- data.frame(id = unique(world.ggmap$id),\n                 growth = 4*runif(n),\n                 category = factor(sample(1:5, n, replace=T)))\n\n## noise\ndf[c(sample(1:100,40)),c(\"growth\", \"category\")] &lt;- NA\n\n\nggplot(df, aes(map_id = id)) +\n     geom_map(aes(fill = growth, color = category), map =world.ggmap) +\n     expand_limits(x = world.ggmap$long, y = world.ggmap$lat) +\n     scale_fill_gradient(low = \"red\", high = \"blue\", guide = \"colorbar\")\n</code></pre>\n\n<p>Gives the following results:\n<img src=\"http://i.stack.imgur.com/ZEYpc.png\" alt=\"enter image description here\"></p>\n\n<p>I would like to map one variable to the left \"half\" of a country and a different variable to the right \"half\" of the country. I put \"half\" in quotes because it's not clearly defined (or at least I'm not clearly defining it). The answer by Ian Fellows might help (which gives an easy way to get the centroid). I'm hoping for something so that I can do <code>aes(left_half_color = growth, right_half_color = category)</code> in the example. I'm also interested in top half and bottom half if that is different.</p>\n\n<p>If possible, I would also like to map the individual centroids of the halves to something.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13282716,"title":"R call java method with List as parameter","body":"<p>How can I pass a list from my R to java function ??\nMy java function is </p>\n\n<pre><code> public void test(List&lt;String&gt; arg){\n String[][] resultArray =new String[1][1];\n System.out.println(arg.size());\n resultArray[0][0]=\"hai\";\n return resultArray;\n</code></pre>\n\n<p>}</p>\n\n<p>R function is</p>\n\n<pre><code>test&lt;-function(params){\nobj=.jnew(\"com/algoTree/ClientElasticSearch/ElasticSearchLoader\")\na &lt;- .jnew( \"java/util/ArrayList\", params )\nresult=.jcall(obj,\"[[Ljava/lang/String;\",\"test\",a)\nmat=sapply(result,.jevalArray)\nmat\n</code></pre>\n\n<p>}</p>\n\n<p>R call </p>\n\n<pre><code>temp=c(\"bloomberg\",\"reuters\") \ntest(list(temp))\n</code></pre>\n\n<p>But I didn't get the value passed in params in my java code</p>\n\n<pre><code>System.out.println(arg.size());  outputs 0\n</code></pre>\n"},{"tags":["r","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":30,"score":3,"question_id":13281177,"title":"Calculate one value based on the sum of other values within one dataframe","body":"<p>I am trying to solve this in R, although I know I would have done it by now in Excel, I really want to learn how to use R.</p>\n\n<p>My dataframe looks like this:</p>\n\n<pre><code> OBJECTID CDUID SENSI_FINA FREQUENCY SUM_LENGTH\n\n        6  5915          1        51      19178\n\n        7  5915          2        97      21536\n\n        8  5915          3       201      35640\n\n        9  5915          4       551     170549\n\n       10  5915          5       308     145126\n\n       11  5917          1       210      28104\n\n       12  5917          2      1897     249379\n</code></pre>\n\n<p>Now I would like to sum the <code>SUM_LENGTH</code> per <code>CDUID</code> and then calculate the percentage the <code>SUM_LENGTH</code> with <code>SENSI_FINAL=5</code> is of the summed <code>SUM_LENGTH</code> per <code>CDUID</code></p>\n\n<p>So in simple words I want to do this:</p>\n\n<blockquote>\n  <p>(145123/(19178+21536+35640+170549))*100 </p>\n</blockquote>\n\n<p>for <code>CDUID =  5915</code> and then for the next 5917 etc..</p>\n\n<p>What I did so far is I calculated the sum based on the CDUID:</p>\n\n<pre><code>CDlenght &lt;- aggregate(step1$SUM_LENGTH~step1$CDUID, data=step1, sum)\n</code></pre>\n\n<p>but now I'm stuck...:-(</p>\n"},{"tags":["c++","windows","r","rcpp","rinside"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":83,"score":-2,"question_id":13266038,"title":"multiple definition of `imp_ZTVN4Rcpp14not_compatibleE` on WindowsXP with RInside","body":"<p>The software I am talking of contains 5 files and compiles \"perfectly fine\" on <code>openSUSE 11.3</code> with <code>gcc-4.5.1</code>:</p>\n\n<p>The same software shows the following error on <code>Windows XP</code> with <code>Mingw (gcc-4.6.3)</code>.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>The problem is discovered.</p>\n\n<p>The problem is w.r.t the R's function <code>parseEval</code>.\nThere are two similar functions: <code>parseEval</code> and <code>parseEvalQ</code>.\nThe former returns a value, and the other returns void.</p>\n\n<p>I have used <code>parseEval</code> in a C++ plus Qt project, and it works very fine on Linux, and throws the above shown error on Windows.</p>\n\n<p><strong>Here is the reproducible example:</strong></p>\n\n<p>demo.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;RInside.h&gt;\n#include &lt;Rcpp.h&gt;\n\nRInside R (0, NULL);\nRInside &amp; qtToR (R);\n\nint main ()\n{\n    int numberOne = 1;\n    int numberTwo = 2;\n\n    qtToR [\"numberOne\"] = numberOne;\n    qtToR [\"numberTwo\"] = numberTwo;\n\n    R.parseEvalQ (\"sum = numberOne + numberTwo;\");\n\n    int returnValue = R.parseEval (\"sum\");\n    std :: cout &lt;&lt; \"\\n\" &lt;&lt; returnValue &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>Corresponding .pro file:</p>\n\n<pre><code>TEMPLATE    = app\nTARGET      =\nDEPENDPATH  += .\n\nSOURCES     += demo.cpp\n\nINCLUDEPATH += .\nINCLUDEPATH += c:/R-2.15.1/include\nINCLUDEPATH += c:/R-2.15.1/library/Rcpp/include\nINCLUDEPATH += c:/R-2.15.1/library/RInside/include\n\nLIBS        += -Lc:/R-2.15.1/bin/i386 -lR\nLIBS        += -Lc:/R-2.15.1/library/Rcpp/libs/i386 -lRcpp\nLIBS        += -Lc:/R-2.15.1/library/RInside/libs/i386 -lRInside\n\n# You'll keep pulling your hair if you miss this statement when you are on windows.\nCONFIG      += console\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/XRBPP.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":27,"score":-1,"question_id":13282530,"title":"Good package to fit a bivariate normal distribution in R?","body":"<p>Anyone knows what is a robust R package that allows me to find MLE estimators and fit bi-variate normal or student's t  using sample moments? Thanks!!</p>\n"},{"tags":["r","vector","matrix","indices"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13282382,"title":"How to select and remove specific elements or find their index in a vector or matrix?","body":"<p>Let's say I have two vectors:</p>\n\n<pre><code>x &lt;- c(1,16,20,7,2)\n\ny &lt;- c(1, 7, 5,2,4,16,20,10)\n</code></pre>\n\n<p>I want to remove elements in <code>y</code> that are not in <code>x</code>. That is, I want to remove elements <code>5, 4, 10</code> from <code>y</code>.</p>\n\n<pre><code>y\n[1] 1 7 2 16 20 \n</code></pre>\n\n<p>In the end, I want vectors <code>x</code> and <code>y</code> to have to same elements. Order does not matter.</p>\n\n<p>My thoughts: The <code>match</code> function lists the indices of the where the two vectors contains a matching element but I need a function is that essentially the opposite. I need a function that displays the indices where the elements in the two vectors don't match.</p>\n\n<pre><code># this lists the indices in y that match the elements in x\nmatch(x,y)\n[1] 1 6 7 2 4   # these are the indices that I want; I want to remove\n                # the other indices from y\n</code></pre>\n\n<p>Does anyone know how to do this? thank you</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":92,"score":0,"question_id":13274565,"title":"difference between !duplicated() and unique()","body":"<p>I can't figure out what is the difference between these two functions in R.\nI have a data.frame, and I want to remove rows corresponding to duplicated values in a given column;</p>\n\n<pre><code>    Acc         Probe             Coord_homol\n1   NR_004442.1 225541_at~122     391\n2   NM_028059.2 241348_at~444     4642\n3   NM_028059.2 241348_at~468     4666\n4   NM_001114   212306_at~4357    5034\n5   NM_010573.2 230472_at~402     1987\n6   NM_029633.2 212306_at~4357    4289\n7   NM_00108196 212306_at~4357    4292\n8   NM_029891.2 205004_at~3421    2963\n9   NM_029891.2 205004_at~3635    3173\n10  NM_007892.2 221586_s_at~1356 1257\n11  NR_036613.1 208672_s_at~829  1301\n12  NR_036613.1 208673_s_at~1472 1854\n13  NM_011078.3 212726_at~3872    5175\n14  NM_011078.3 212726_at~3887    5190\n15  NM_013915.3 207164_s_at~1523 2911\n</code></pre>\n\n<p>in this case, I would like to remove rows 7 because the probe is the same as in row 6 (rows with same probes do not have to be successive ones).</p>\n\n<p>I first tried unique(), and later found duplicated.\nbut if the following command </p>\n\n<pre><code>dat[!duplicated(dat$probe),]\n\ndat[unique(dat$probe),]\n</code></pre>\n\n<p>give the same number of lines in the resulting data.frame, the results are not the same.</p>\n\n<p>I tried on a much simpler case, like the following:</p>\n\n<p>a simple data.frame:</p>\n\n<pre><code>&gt; dat\n   probe val\n1    aaa  10\n2    bbb  12\n3    ccc  45\n4    ddd  32\n5    aaa  42\n6    eee  10\n7    fff  13\n8    ccc  85\n9    aaa  75\n10   ddd  64\n</code></pre>\n\n<p>using !duplicated(): it seems to be what I want to do;</p>\n\n<pre><code>dat[!duplicated(dat$probe),]\n\n  probe val\n1   aaa  10\n2   bbb  12\n3   ccc  45\n4   ddd  32\n6   eee  10\n7   fff  13\n</code></pre>\n\n<p>using unique():</p>\n\n<pre><code>dat[unique(dat$probe),]\n</code></pre>\n\n<p>I get: </p>\n\n<pre><code> probe val\n1   aaa  10\n2   bbb  12\n3   ccc  45\n4   ddd  32\n5   aaa  42\n6   eee  10\n</code></pre>\n\n<p>Not what I want; </p>\n\n<p>But what exactly unique() is doing ?</p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["r","graph","ggplot2","alpha"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13281684,"title":"Changing alpha doesn't affect anything in ggplot2","body":"<p>I'm somewhat new to R and ggplot2 so this question is likely somewhat low-level. But I've done a fair amount of experimenting and found no answers online, so I thought I'd ask here.</p>\n\n<p>When I <em>add</em> alpha to my graph, the graph appears as follows:</p>\n\n<p><a href=\"http://imageshack.us/photo/my-images/703/floole.png/\" rel=\"nofollow\">Some alpha</a></p>\n\n<p><strong>However, no matter how I <em>change</em> the value of alpha, I get no changes in the graph. I tried alpha=.9 and alpha=1/10000, and there was no difference whatsoever in the graph.</strong></p>\n\n<p>Yet it seems that the 'alpha' term is doing <em>something</em>. When I <em>remove</em> the 'alpha' from the code, I get the following graph:</p>\n\n<p><a href=\"http://imageshack.us/photo/my-images/805/floo.png/\" rel=\"nofollow\">No alpha</a></p>\n\n<p>Here's my code. Thanks!</p>\n\n<pre><code>library(ggplot2)\nlibrary(chron)\nargv &lt;- commandArgs(trailingOnly = TRUE)\nmydata = read.csv(argv[1])\npng(argv[2], height=300, width=470)\n\n\ntimeHMS_formatter &lt;- function(x) {                  # Takes time in seconds from midnight, converts to HH:MM:SS\nh &lt;- floor(x/3600)\nm &lt;- floor(x %% 60)\ns &lt;- round(60*(x %% 1))                         # Round to nearest second\nlab &lt;- sprintf('%02d:%02d', h, m, s)        # Format the strings as HH:MM:SS\nlab &lt;- gsub('^00:', '', lab)                    # Remove leading 00: if present\nlab &lt;- gsub('^0', '', lab)                      # Remove leading 0 if present\n}\n\ndateEPOCH_formatter &lt;- function (y){\nepoch &lt;- c(month=1,day=1,year=1970)\n    chron(floor(y),out.format=\"mon-year\",origin.=epoch)\n}\n\np=  ggplot() + \ncoord_cartesian(xlim=c(min(mydata$day),max(mydata$day)), ylim=c(0,86400)) +         # displays data from first email through present\nscale_color_hue() +\nxlab(\"Date\") +\nylab(\"Time of Day\") +\nscale_y_continuous(label=timeHMS_formatter, breaks=seq(0, 86400, 7200)) +           # adds tick marks every 2 hours\nscale_x_continuous(label=dateEPOCH_formatter, breaks=seq(min(mydata$day), max(mydata$day), 365) ) +\nggtitle(\"Email Sending Times\") +                                                        # adds graph title\ntheme( legend.position = \"none\", axis.title.x = element_text(vjust=-0.3)) +\nlayer(\n    data=mydata, \n    mapping=aes(x=mydata$day, y=mydata$seconds, alpha=1/2, size=5), \n    stat=\"identity\", \n    stat_params=list(), \n    geom=\"point\", \n    geom_params=list(),\n    position=position_identity(),\n)       \n\nprint(p)\ndev.off()\n</code></pre>\n"},{"tags":["r","ggplot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13281871,"title":"Is my stat_summary considering all points for calculating the mean?","body":"<p>My code is as follows:</p>\n\n<pre><code>ggplot(data=ICL1, aes(x=as.Date(AÑO_MES), y=IndICL1, group=RUN_FM, colour=RUN_FM)) +\n ylim(0,150)+ xlab(\"Periodo\") + ylab(\"% Cobertura\") + \ngeom_hline(aes(yintercept=100),colour=\"red\")+\nstat_summary(fun.y = mean, geom=\"line\",size=1.5 , mapping = aes (group = 1),colour=\"green\") + geom_point()\n</code></pre>\n\n<p>The thing is that with this I receive the following message: *\"Removed 153 rows containing missing values (stat_summary)\"*</p>\n\n<p>This is because these points are beyond my <strong><code>ylim(0,150)</code></strong>, which I use it like this because the scale gives a properly view of what I want to show.</p>\n\n<p>I want to know if with this message, <code>stat_summary</code> is considering this missing points for calculating the mean ?... If not, what should I do to consider this points in the mean calculation but not showing them in the graphs.</p>\n"},{"tags":["r","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13281303,"title":"Creating co-occurrence matrix","body":"<p>I'm trying to solve the problem of having a co-occurence matrix. I have a datafile of transactions and items, and I want to see a matrix of the number of transactions where items appear together.</p>\n\n<p>I'm a newbie in R programming and I'm having some fun finding out all the shortcuts that R has, rather than creating specific loops (I used to use C years ago and only sticking to Excel macros and SPSS now). I have checked the solutions here, but haven't found one that works (the closest is the solution given here: <a href=\"http://stackoverflow.com/questions/10568540/co-occurrence-matrix-using-sac\">Co-occurrence matrix using SAC?</a> - but it produced an error message when I used projecting_tm, I suspected that the cbind wasn't successful in my case.</p>\n\n<p>Essentially I have a table containing the following:</p>\n\n<p>TrxID Items Quant<br>\nTrx1 A 3<br>\nTrx1 B 1<br>\nTrx1 C 1<br>\nTrx2 E 3<br>\nTrx2 B 1<br>\nTrx3 B 1<br>\nTrx3 C 4<br>\nTrx4 D 1<br>\nTrx4 E 1<br>\nTrx4 A 1<br>\nTrx5 F 5<br>\nTrx5 B 3<br>\nTrx5 C 2<br>\nTrx5 D 1, etc.</p>\n\n<p>I want to create something like:</p>\n\n<pre><code>   A B C D E F\nA  0 1 1 0 1 1\nB  1 0 3 1 1 0\nC  1 3 0 1 0 0\nD  1 1 1 0 1 1\nE  1 1 0 1 0 0\nF  0 1 1 1 0 0\n</code></pre>\n\n<p>What I did was (and you'd probably laugh at my rookie R approach):</p>\n\n<pre><code>library(igraph)\nlibrary(tnet)\n\ntrx &lt;- read.table(\"FileName.txt\", header=TRUE) \ntransID &lt;- t(trx[1])\nitems &lt;- t(trx[2])\n\nid_item &lt;- cbind(items,transID)\nitem_item &lt;- projecting_tm(id_item, method=\"sum\")\nitem_item &lt;- tnet_igraph(item_item,type=\"weighted one-mode tnet\")\nitem_matrix &lt;-get.adjacency(item_item,attr=\"weight\")\nitem_matrix\n</code></pre>\n\n<p>As mentioned above the cbind was probably unsuccessful, so the projecting_tm couldn't give me any result. </p>\n\n<p>Any alternative approach or a correction to my method?</p>\n\n<p>Your help would be much appreciated!</p>\n"},{"tags":["r","csv","boxplot"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13281040,"title":"Merge columns of different length and missing values in R","body":"<p>I have a simple problem, honestly I have tried to find an answer. I really did.</p>\n\n<p>I have a bunch of .csv files that have been imported into R data frames</p>\n\n<p>I would like to take a specific column (with a common name) from each data frame, merge it into a single data frame with the name of the data frame as the column name, and produce a boxplot using each column.</p>\n\n<p>The columns are not of the same length and frequently contain NA's.</p>\n\n<p>Example: Data frames (in which the first row is the header)</p>\n\n<p>Data frame name <code>Tom</code>:</p>\n\n<pre><code>col1    col2 col3 col4\nname1   33   44   55\nname2   33   NA   55\nname3   33   34   55\nname4   33   24   55\n</code></pre>\n\n<p>Data frame name <code>Bob</code>:</p>\n\n<pre><code>col1    col2 col3 col4\nname5   33   74   55\nname6   33   NA   55\nname7   33   32   55\n</code></pre>\n\n<p>Data frame name <code>Stu</code>:</p>\n\n<pre><code>col1    col2 col3 col4\nname8   33   44   55\nname9   33   11   55\nname10  33   34   55\nname11  33   24   55\nname12  33   32   55\nname13  33   24   5\nname14  33   34   55\nname15  33   24   5\n</code></pre>\n\n<p>Desired result</p>\n\n<pre><code>Tom  Bob  Stu\n44   74   44\nNA   NA   11 \n34   32   34\n24        24\n          32\n          24\n          34\n          24\n</code></pre>\n\n<p>So, taking \"col3\" (the column name is shared) from each data frame, and produce a new data frame of only the col3 data, each column to be named as the name of the data frame it came from...followed by producing a side-by-side boxplot of Tom, Bob and Stu (but I can probably work that out). It's OK to have NA's in the empty spaces in the desired result above.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":514,"score":2,"question_id":9238038,"title":"passing a vector of variables into lm() formula","body":"<p>I was trying to automate a piece of my code so that programming become less tedious.\nBasically I was trying to do a stepwise selection of variables using <code>fastbw()</code> in the <strong>rms</strong> package. I would like to pass the list of variables selected by <code>fastbw()</code> into a formula as <code>y ~ x1+x2+x3</code>, \"x1\" \"x2\" \"x3\" being the list of variables selected by <code>fastbw()</code></p>\n\n<p>Here is the code I tried and did not work</p>\n\n<pre><code>olsOAW0.r060 &lt;- ols(roll_pct~byoy+trans_YoY+change18m, \n                    subset= helper==\"POPNOAW0_r060\", \n                    na.action = na.exclude, \n                    data = modelready)\n\nOAW0 &lt;- fastbw(olsOAW0.r060, rule=\"p\", type=\"residual\", sls= 0.05)\n\nvec &lt;- as.vector(OAW0$names.kept, mode=\"any\")\n\nb &lt;- paste(vec, sep =\"+\") ##I even tried b &lt;- paste(OAW0$names.kept, sep=\"+\")\n\nbestp.OAW0.r060 &lt;- lm(roll_pct ~ b , \n                      data = modelready, \n                      subset = helper ==\"POPNOAW0_r060\",    \n                      na.action = na.exclude)\n</code></pre>\n\n<p>I am new to R and still havent trailed the steep learning curve, so apologize for obvious programming blunders. Any  help is much appreciated</p>\n"},{"tags":["r","rstudio","maptools"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":29,"score":-1,"question_id":13270286,"title":"Error opening SHP file in Rstudio","body":"<p>I am using maptools to open a shapefile in R, but I get the following error in Rstudio:</p>\n\n<pre><code>library(maptools)\nbasins = readShapeSpatial(\"H:GIS/shapefiles/basins\")\nError in getinfo.shape(fn) : Error opening SHP file\n</code></pre>\n\n<p>When I try the exact same code in RGui (instead of Rstudio) it works! I would like to keep using Rstudio as it is so convenient so anybody know how to fix this problem?</p>\n\n<p>Thanks!</p>\n"},{"tags":["linux","r"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":75,"score":3,"question_id":13235100,"title":"Empty plot in R","body":"<p>I did a fresh install of ARCH linux and so of R version 2.15.1. But after plotting anything with the plot command, the plot window is always empty (nothing shown). Could there be an issue with drivers or something else. I have tried graphics.off() function but to no avail.</p>\n\n<p>Question edited:</p>\n\n<p>The plot however is visible after resizing the plot window.</p>\n\n<pre><code>x&lt;-c(1, 2, 3, 4, 5)\ny&lt;-c(0.1, 0.3, 0.7, 1.11, 1.3) \nplot(x, y) \n\n&gt; sessionInfo() \nR version 2.15.1 (2012-06-22) \nPlatform: x86_64-unknown-linux-gnu (64-bit) \nlocale: \n[1] C \n\nattached base packages: \n[1] stats graphics grDevices utils datasets methods base\n</code></pre>\n\n<p>Question edited:</p>\n\n<p>Setting X11.options(type=\"nbcairo\") works fine.</p>\n"},{"tags":["r","math"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13280359,"title":"intercept between straight line and circle","body":"<p>Imagine we have the circle defined by:</p>\n\n<pre><code>X^2 + Y^2 = r^2\n</code></pre>\n\n<p>The origin of the circle is <code>0</code> and <code>radius = 1</code>. If we draw a horizontal line from the origin moving to the right with coordinates <code>(x1,y1)=(0,0)</code> and <code>(x2,y2) = (2,0)</code> this line should intersect the circle.  e.g.</p>\n\n<pre><code>library(plotrix)\nplot(0,0,xlim=c(-3,3),ylim=c(-2,2))\ndraw.circle(0,0,1)\nlines(c(0,2),c(0,0))\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/1XUSa.png\" alt=\"enter image description here\"></p>\n\n<p>I have tried to find the intersect of the line with the circle but with no luck.  I took \nmy approach from the this <a href=\"http://mathworld.wolfram.com/Circle-LineIntersection.html\" rel=\"nofollow\">wolfram page</a> and produce the following code but it does not seem to produce the correct result. Can someone please point me to my (no doubt) stupid mistake?</p>\n\n<pre><code>r &lt;- 1\nid &lt;- 1:5\nx1 &lt;- c(0)\ny1 &lt;- c(0)\nx2 &lt;- c(2)\ny2 &lt;- c(0)\ndf &lt;- data.frame(id,x1,y1,x2,y2)\n\ndf &lt;- transform(df, dx = x2-x1)\ndf &lt;- transform(df, dy = y2-y1)\ndf &lt;- transform(df, dr = sqrt(dx^2+dy^2))\ndf &lt;- transform(df, D  = (x1*y2)-(x2*y1))\ndf &lt;- transform(df, dysign = sapply(dy,function(x) ifelse(x &lt; 0,-1,1)))\ndf &lt;- transform(df, newxplus = (D*dy + (dysign*dy) *dx*sqrt(r^2*dr^2-D^2))/dr^2)\ndf &lt;- transform(df, newxneg  = (D*dy - (dysign*dy) *dx*sqrt(r^2*dr^2-D^2))/dr^2)\ndf &lt;- transform(df, newyplus = (-D*dx + (abs(dy)) *sqrt(r^2*dr^2-D^2))/dr^2)\ndf &lt;- transform(df, newyneg  = (-D*dx - (abs(dy)) *sqrt(r^2*dr^2-D^2))/dr^2)\n\n# where newxplus and newxneg are the two x coordinates for the two possible intercepts\n# similarly for newyplus and newyneg\ndf\n</code></pre>\n"},{"tags":["r","plot","ggplot2","data-visualization","hexagonal-tiles"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":68,"score":3,"question_id":13150868,"title":"ggplot2 stat_binhex(): keep bin radius while changing plot size","body":"<p>I'd like to a find a way to keep regular hexagons (all sides have equal length) when resizing hexbin plots in ggplot2 without manually adjusting the binwidth parameter. </p>\n\n<p>To illustrate:</p>\n\n<pre><code>d &lt;- ggplot(diamonds, aes(carat, price))+ \n  stat_binhex(colour=\"white\")\ntry(ggsave(plot=d,filename=&lt;some file&gt;,height=6,width=8))\n</code></pre>\n\n<p>yields hexagons that at least look regular to the eye:<img src=\"http://i.stack.imgur.com/tRYoD.png\" alt=\"ggplot2 stat_binhex plot1\"></p>\n\n<p>And</p>\n\n<pre><code>try(ggsave(plot=d,filename=&lt;some other file&gt;,height=6,width=12))\n</code></pre>\n\n<p>yields irregular hexagons:<img src=\"http://i.stack.imgur.com/byYmZ.png\" alt=\"ggplot2 stat_binhex plot2\"></p>\n\n<p>The <a href=\"http://docs.ggplot2.org/0.9.2.1/stat_binhex.html\" rel=\"nofollow\">documentation</a> describes the binwidth parameter (e.g. <code>binwidth = c(1, 1000)</code>) which specifies bin width. I'd like a function which, when given any plot size, returns the right binwidth settings to create regular hexagons. </p>\n"},{"tags":["r","vector"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":9,"view_count":78,"score":-7,"question_id":13279449,"title":"Counting Values in R Vector","body":"<p>I have a large vector of percentages (0-100) and I am trying to count how many of them are in \nspecific 20% buckets (&lt;20, 20-40, 40-60,60-80,80-100). The vector has length 129605 and there are no \nNA values. Here's my code: </p>\n\n<pre><code>x&lt;-c(0,0,0,0,0)\nfor(i in 1: length(mail_return))\n{\n    if (mail_return[i]&lt;=20)\n    {\n        x[1] = x[1] + 1\n    }\n    if (mail_return[i]&gt;20 &amp;&amp; mail_return[i]&lt;=40)\n    {\n        x[2] = x[2] + 1\n    }\n    if (mail_return[i]&gt;40 &amp;&amp; mail_return[i]&lt;=60)\n    {\n        x[3] = x[3] + 1\n    }\n    if (mail_return[i]&gt;60 &amp;&amp; mail_return[i]&lt;=80)\n    {\n        x[4] = x[4] + 1\n    }\n    else\n    {   \n        x[5] = x[5] + 1\n    }\n}\n</code></pre>\n\n<p>But <code>sum(x)</code> is giving me length 133171. Shouldn't it be the length of the vector, 129605? What's wrong? </p>\n"},{"tags":["r","bar-chart","qplot"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":21,"score":3,"question_id":13279318,"title":"qplot factor by condition","body":"<p>Using this dataframe, <code>df</code>:</p>\n\n<pre><code>bat.condition bat.group      bat.money\n1              safe          2825.882\n2              safe          2931.875\n1              glsa          6975.882\n2              glsa          5407.500\n1              studyabroad   3084.706\n2              studyabroad   2253.750 \n1              jcc           4134.706\n2              jcc           5550.625\n1              eagg          4578.824\n2              eagg          5456.250\n</code></pre>\n\n<p>I would like to plot a bar chart with group on the x axis, money on the y axis.  Further, I would like the bars to be separated/factored by the condition in which they occur.  So far I have used the following code and it is nearly ideal.  I have the bars factored by group, I would just like to further factor it by condition.  </p>\n\n<pre><code>qplot(factor(bat.group), data = df, geom = \"bar\", fill = bat.group, \n      weight = bat.money, position = \"dodge\")\n</code></pre>\n\n<p>Which produces the image seen here.</p>\n\n<p><img src=\"http://i.stack.imgur.com/532OF.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","time-series"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13278972,"title":"How to name columns in time series objects?","body":"<p>I am a bit puzzled here and must be missing something quite basic. \nI want to extract columns from a multiple time series object. It can perhaps be done by making the ts object into a dataframe and then extracting them, but there is a direct way of subsetting time series as given in this question <a href=\"http://stackoverflow.com/questions/11542584/refer-to-time-series-object-by-column-name\">link</a></p>\n\n<p>To figure out how to assign names to ts objects, ?ts shows </p>\n\n<pre><code>ts(data = NA, start = 1, end = numeric(), frequency = 1,\n   deltat = 1, ts.eps = getOption(\"ts.eps\"), class = , names = )\n</code></pre>\n\n<p>but on running the code in ?ts help, with or without the names parameter gives \n<code>names(z)</code> NULL.</p>\n\n<p><code>z &lt;- ts(matrix(rnorm(300), 100, 3), start=c(1961, 1), frequency=12)</code>\nor <code>z &lt;- ts(matrix(rnorm(300), 100, 3), start=c(1961, 1), frequency=12, names=c(\"x1\", \"x2\", \"x3\"))</code></p>\n\n<p>Main question: 1. How does one assign names to columns in time series objects ts and mts ?\n2. What are the methods of extracting columns directly from time series object along with the time index? Is it necessary to convert it to zoo or xts class? or add the time index separately?</p>\n\n<p>To give an idea of problem I am trying to solve:</p>\n\n<pre><code># using inbuilt ldeaths time series dataset\nldeaths\nd &lt;- diff(ldeaths)\npercen &lt;- quantile(d, 0.9)\ni &lt;- ifelse(d&gt;percen, 1,0)\nsignal &lt;- cbind(d,i) \n</code></pre>\n\n<p>Now to extract the dataset for which the indicator is 1, <em>with the time index</em>,\nI am not sure how to proceed. str(signal) is an mts object but printing signal shows no time index. </p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["r","pdf","plot"],"answer_count":3,"favorite_count":2,"up_vote_count":11,"down_vote_count":0,"view_count":88,"score":11,"question_id":13273611,"title":"How to append a plot to an existing pdf file","body":"<p>I want to append a plot to an existing pdf long after <code>dev.off()</code> has been called*.  After reading the <code>pdf()</code> help file and after reading the Q &amp; A <a href=\"http://stackoverflow.com/questions/1395410/how-to-print-r-graphics-to-multiple-pages-of-a-pdf-and-multiple-pdfs\">here</a> and <a href=\"http://stackoverflow.com/questions/7534606/save-multiple-graphs-one-after-another-in-one-pdf-file\">here</a>, I'm pretty sure it can't be done in R. But, maybe some of you smarter people have a solution that I wasn't able to find.</p>\n\n<pre><code>pdf(\"Append to me.%03d.pdf\",onefile=T)\nplot(1:10,10:1) #First plot (page 1)\ndev.off()\npdf(\"Append to me.%03d.pdf\",onefile=T)\nplot(1:10,rep(5,10)) #Want this one on page 2\ndev.off()\n</code></pre>\n\n<p>*This not a duplicate of the questions linked above because I want to append to a pdf file <i>after</i> the pdf device has been closed.</p>\n"},{"tags":["r","awk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13278957,"title":"remove a value and its corresponding value in a table","body":"<p>In a file (1000 columns, 2000 rows), for each column there is another column next to it. something like:</p>\n\n<pre><code>[,1] [,2] [,3] [,4] [,5] [,6]\n3      3    4    4     4     6\n6      5    2    2     5     1\n9      1    3    5     4     1\n2      5    6    4     8     5\n6      1    5    2     3     1\n</code></pre>\n\n<p>I want to remove those values which their corresponding value is 1\nthe result:</p>\n\n<pre><code>[,1] [,3] [,5] \n3    4     4\n6    2     8\n2    3\n     6\n     5\n</code></pre>\n"},{"tags":["r","graph","flow"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13272612,"title":"Min Cost Flow in R","body":"<p>Is there a package which implements a min cost flow algorithm in R?</p>\n\n<p>The <code>igraph</code>package seems only to have max flows (via the <code>graph.maxflow()</code> function), and nothing else here or on <a href=\"http://www.rseek.org/\" rel=\"nofollow\">rseek.org</a> looks helpful.</p>\n"},{"tags":["string","r","expression","gsub"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13275614,"title":"Replace entire expression that contains a specific string","body":"<p>I have data frame that has a column with large number of file names like: </p>\n\n<pre><code>d &lt;- c(\"harry11_scott80_norm.avi\",\"harry11_norm.avi\",\"harry11_scott80_lpf.avi\", \n       \"joel51_lpf.avi\",\"rich82_joel51_lpf.avi\")\n</code></pre>\n\n<p>I want R to replace all expressions with two people names like <code>harry11_scott80_norm.avi</code> with the expression <code>incongruent</code> and all the ones with single person name like <code>harry11_norm.avi</code> with <code>congruent</code>. I could use <code>gsub</code> to do that:</p>\n\n<pre><code>dd &lt;- gsub(\"harry11_scott80_norm.avi\", \"incongruent\", d) \n</code></pre>\n\n<p>but I got a lot of those names, so it would be a very clunky solution. So ideally I want to replace the ENTIRE expression that contains strings like <code>_scott80_</code> with \"incongruent\". I thought that <code>gsub</code> can do this, but when I run it:</p>\n\n<pre><code>dd &lt;- gsub(\"_scott80_\", \"incongruent\", d)\n</code></pre>\n\n<p>it returns with <code>harry11incongruentnorm.avi</code>, which is obviously because it simply replace the exact string match. I recon there is some way to tell <code>gsub</code> to replace expression entirely that contains selected string, but I can't find it.</p>\n\n<p>There was a question <a href=\"http://stackoverflow.com/questions/5302669/in-r-how-do-i-replace-a-string-that-contains-a-certain-pattern-with-another-str\">In R, how do I replace a string that contains a certain pattern with another string?</a>, but I am not sure how to use  <code>agrep</code> in this context.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> Side bonus question - based on @GSee answer, is there any function that allows you to pass a list of strings that you want to replace? For example, <code>gsub(c(\".*_scott80_.*\", \".*_harry11_.*\"), \"incongruent\", d)</code> won't work.</p>\n"},{"tags":["r","awk"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13276998,"title":"combine the same column numbers from 2 files","body":"<p>I have two big files. each file have 1000 columns and 2000 rows. I would like to merge them using a loop (R or linux) so that the same columns numbers come together:</p>\n\n<p>file a:</p>\n\n<pre><code>[,1] [,2] ... [,1000]\n1    3\n1    3\n1    4\n1    3\n1    5\n</code></pre>\n\n<p>file b:</p>\n\n<pre><code>[,1] [,2] .... [,1000]\n2    7\n2    8\n2    9\n2    10\n2    11\n</code></pre>\n\n<p>after merging:</p>\n\n<pre><code>[,1] [,1] [,2][,2] .... [,1000][,1000]\n1  2  3  7\n1  2  3  8\n1  2  4  9\n1  2  3  10\n1  2  5  11 \n</code></pre>\n"},{"tags":["r","forecasting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13256789,"title":"Future Simulation with External Regressions using simulate.Arima()","body":"<p>My question involves the <code>simulate.Arima()</code> function in the forecasting.  I have an ARIMA function with seasonality, a nonzero degree of differencing, and external regressors (dummy variables for holidays).  Here is a reproducible example:</p>\n\n<pre><code>y &lt;- ts(c(3,5,10,13,4,15,13,17,20,24,26,27))\ndummy &lt;- data.frame(dummy=c(0,0,0,0,1,0,0,0,0,0,0,0))\narima.1 &lt;- arima(y, order=c(1,1,0), xreg=dummy)\n\nfuture.dummy &lt;- data.frame(dummy=c(0,0,1,0,0,0,0,0,0,0,0,0))\nn &lt;- nrow(future.dummy)\n\nsim.1 &lt;- simulate(arima.1, nsim=n, xreg=future.dummy)\n</code></pre>\n\n<p>When I perform this, I get an error message.  I noticed that when I set the parameter <code>future=FALSE</code> it works perfectly fine.</p>\n\n<p>My question: Does simulate.Arima not allow you to run a future simulation with new external regressors?  In other words, do you have to choose between</p>\n\n<ol>\n<li>forecasting the future with no external regressors or</li>\n<li>simulating non-future data with different external regressors?</li>\n</ol>\n\n<p>And if this is the case, is it feasible to develop a workaround running a <code>simulate()</code> on a <code>predict.Arima</code> object?  I have a nonzero degree of differencing, so it's important that I be able to look in the future. Thanks for any insight that can be provided.</p>\n"},{"tags":["r","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13267771,"title":"how to deal with different data type between R and sqlite in a simple way?","body":"<p>data is a data.frame,there is a column <code>tdate</code>  whose type is character,now i want write the data into sqlite,</p>\n\n<pre><code>require(RSQLite)\ndbWriteTable(con2, name=\"quote\",value=data,row.names=FALSE,append=TRUE)\n</code></pre>\n\n<p>there is a still problem ,tdata is date type in sqlite,after i write the data into sqlite  database ,i'll   change the field <code>tdata</code> in table quote  into data type,is there a simple way to do that? </p>\n"},{"tags":["r","rgl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13277339,"title":"adding a second 3dplot","body":"<p>I have a 3d scatterplot produced as follows:</p>\n\n<pre><code>library(rgl)\nN &lt;- 10000\n\nX &lt;- rnorm(N,0,1)\nY &lt;- rnorm(N,0,1)\n\nZ &lt;- X * Y\n\nwant &lt;- Z &gt;0 &amp; X&gt;0\n\npalette &lt;- colorRampPalette(c(\"blue\", \"green\", \"yellow\", \"red\")) \ncol.table &lt;- palette(256)\ncol.index &lt;- cut(Z, 256)\nplot3d(X,Y,Z, col=col.table[col.index])\ngrid3d(c(\"x\", \"y\", \"z\"))\n</code></pre>\n\n<p>This works fine. Now I want to overlay another plot, so I tried this:</p>\n\n<pre><code>par(new=F)\nplot3d(X[want],Y[want],Z[want], col=\"black\")\n</code></pre>\n\n<p>However this fails - it just overwrites the old plot. Is there a way to overlay the new plot ?</p>\n"},{"tags":["r","split"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13276728,"title":"Split a dataframe into a list of dataframes, but how to re-merge?","body":"<p>I have a big ol' data frame with two ID columns for courses and users, and I needed to split it into one dataframe per course to do some further analysis/subsetting. After eliminating quite a few rows from each of the individual course dataframes, I'll need to stick them back together.</p>\n\n<p>I split it up using, you guessed it, <code>split</code>, and that worked exactly as I needed it to. However, unsplitting was harder than I thought. The R documentation says that \"<code>unsplit</code> reverses the effect of <code>split</code>,\" but my reading on the web so far is suggesting that that is not the case when the elements of the split-out list are themselves dataframes.</p>\n\n<p>What can I do to rejoin my modified dfs?</p>\n"},{"tags":["r","sum","data.table"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":121,"score":2,"question_id":13106645,"title":"Using `:=` in data.table to sum the values of two columns in R, ignoring NAs","body":"<p>I have what I think is a very simple question related to the use of data.table and the <code>:=</code> function. I don't think I quite understand the behaviour of <code>:=</code> and often I run into similar problems.</p>\n\n<p>Here is some example data</p>\n\n<pre><code> mat &lt;- structure(list(\n              col1 = c(NA, 0, -0.015038, 0.003817, -0.011407), \n              col2 = c(0.003745, 0.007463, -0.007407, -0.003731, -0.007491)), \n              .Names = c(\"col1\", \"col2\"), \n              row.names = c(NA, 10L), \n              class = c(\"data.table\", \"data.frame\"))\n</code></pre>\n\n<p>which gives</p>\n\n<pre><code>&gt; mat\n         col1      col2\n 1:        NA  0.003745\n 2:  0.000000  0.007463\n 3: -0.015038 -0.007407\n 4:  0.003817 -0.003731\n 5: -0.011407 -0.007491\n</code></pre>\n\n<p>I want to create a column called col3 which gives the sum of col1 and col2. If I use</p>\n\n<pre><code>mat[,col3 := col1 + col2]\n\n#        col1      col2      col3\n#1:        NA  0.003745        NA\n#2:  0.000000  0.007463  0.007463\n#3: -0.015038 -0.007407 -0.022445\n#4:  0.003817 -0.003731  0.000086\n#5: -0.011407 -0.007491 -0.018898\n</code></pre>\n\n<p>then I get an NA for the first row, but I want NAs to be ignored. So I tried instead</p>\n\n<pre><code>mat[,col3 := sum(col1,col2,na.rm=TRUE)]\n\n#        col1      col2      col3\n#1:        NA  0.003745 -0.030049\n#2:  0.000000  0.007463 -0.030049\n#3: -0.015038 -0.007407 -0.030049\n#4:  0.003817 -0.003731 -0.030049\n#5: -0.011407 -0.007491 -0.030049\n</code></pre>\n\n<p>which is not what I am after, since it is giving me the sum of all elements of col1 and col2. I think I don't quite get <code>:=</code>... How can I get the sum of the element of col1 and col2 ignoring NA values?</p>\n\n<p>Not sure this is relevant, but here is my sessionInfo</p>\n\n<pre><code>&gt; sessionInfo()\nR version 2.15.1 (2012-06-22)\nPlatform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)\n\nlocale:\n[1] en_AU.UTF-8/en_AU.UTF-8/en_AU.UTF-8/C/en_AU.UTF-8/en_AU.UTF-8\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] data.table_1.8.3\n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":42,"score":0,"question_id":13276017,"title":"Dodge width in geom_boxplot when using fill","body":"<p>I couldn't find anything on this in my searching, so sorry if I am missing something obvious here. What I am trying to do is overlay some points on top of boxplots and I want to dodging to be exactly the same. </p>\n\n<p>For example:</p>\n\n<pre><code># Dummy data\ndf &lt;- data.frame(Group = rep(c(\"Group 1\", \"Group 2\"), 10), \n          Value.1 = rnorm(20), \n          Class = c(rep(\"A\",10), rep(\"B\",10)), \n          Value.2 = c(rep(0.5, 10), rep(1, 10)));\n# Create the boxplots\np &lt;- ggplot(df, aes(x = Group, y = Value.1, fill = Class)) + geom_boxplot();\n# Overlay the points\np &lt;- p + geom_point(aes(y = Value.2), \n          color = \"gold\", \n          position = position_dodge(width = 0.75));\n</code></pre>\n\n<p>In this example, with two fill colors, the width of 0.75 looks right, but this does not work if you change the number of fill colors. My real data could have any number of fills and I want my code to be flexible to handle all cases. How can I calculate the width parameter so that it changes appropriately? The help file for position_dodge has the default width set to NULL so I am not sure how the width is determined.</p>\n\n<p>Thanks!</p>\n\n<p>p.s. I am also getting the following message that I am not clear on?</p>\n\n<pre><code>  ymax not defined: adjusting position using y instead\n</code></pre>\n"},{"tags":["r","eval"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13272479,"title":"How can I assign a function to a variable that its name should be made by paste function?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2679193/how-to-name-variables-on-the-fly-in-r\">How to name variables on the fly in R?</a>  </p>\n</blockquote>\n\n\n\n<p>I have 10 objects of type list named: <code>list1</code>, <code>list2</code>, ..., <code>list10</code>. And I wanted to use the output from my function <code>FUN</code> to <em>replace</em> the first index of these list variables through a <code>for</code> loop like this:</p>\n\n<pre><code>for (i in 1:10){\n  eval(parse(test=(paste(\"list\",i,sep=\"\"))))[[1]] &lt;- FUN()\n}\n</code></pre>\n\n<p>but this does not work. I also used <code>lapply</code> in this way and again it is wrong:   </p>\n\n<pre><code> lapply(eval(parse(text=(paste(\"list\",i,sep=\"\"))))[[1]], FUN)\n</code></pre>\n\n<p>Any opinion would be appreciated.</p>\n"},{"tags":["r","regression"],"answer_count":0,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":136,"score":5,"question_id":13073853,"title":"R DOLS (Dynamic Ordinary Least Squares) packages","body":"<p>I've been messing around with different regression options in <strong>R</strong> and noticed that I haven't see any regression options that explicitly state they're implementing a <strong>DOLS</strong> algorithm. Many of the statistical papers mention the algorithm but when I go through source code for packages like <strong>urca</strong> or <strong>tseries</strong> I see them just using the standard <strong>lm</strong> package. For instance, <strong>urca</strong>'s <code>ca.po</code> test and <strong>tseries</strong>' <code>po.test</code> both use straight <strong>lm</strong> to estimate the residual for the test. Is it possible to simulate <strong>DOLS</strong> using <strong>lm</strong> or <strong>dynlm</strong>? </p>\n\n<p>I'm asking because I'd like to use <strong>DOLS</strong> for some stuff I've been working on and I can't figure out how to either simulate it with an existing package or what I'd need to write. </p>\n"},{"tags":["string","r","parsing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13274175,"title":"R coding string","body":"<p>I have a list of 96 files that I would like to open and perform some functions on the data.  I am VERY new to R, and am unsure how to manipulate strings to open the sequential file names.  Here is my code below, which clearly does not work:</p>\n\n<pre><code>for (N in (1:96)){\n  if (N &gt; 10) \n      TrackID &lt;- \"000$N\"\n  }\n  else{\n      TrackID &lt;- \"00$N\"\n  }\n\n  fname_in &lt;- 'input/intersections_track_calibrated_jma_from1951_$TrackID.csv'\n  fname_out &lt;- 'output/tracks_crossing_regional_polygon_$TrackID.csv'\n\n  ......data manipulations.....\n\n}\n</code></pre>\n\n<p>So basically I just need to be able to, for instance, when N=1, reference a file called intersections_track_calibrated_jma_from1951_0001.csv.</p>\n\n<p>Thanks in advance!</p>\n\n<p>Kimberly</p>\n"},{"tags":["r","data.frame"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":13275260,"title":"How can I repeat a data.frame?","body":"<p>It's easy to repeat a data.frame once,</p>\n\n<pre><code>mt2 &lt;- rbind(mtcars, mtcars)\n</code></pre>\n\n<p>But what's an R-like way to do this generally? If I want 10 copies of <code>mtcars</code> together I could</p>\n\n<pre><code>mt10 &lt;- mtcars\nfor (i in 2:10) mt10 &lt;- rbind(mt10, mtcars)\n</code></pre>\n\n<p>which is plenty concise, but seems not in the spirit of R. Is there a better way to do this, or a clever trick using vector recycling?</p>\n"},{"tags":["r","bioconductor"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13274171,"title":"XCMS Package - Retention time","body":"<p>Is there a simple way to get the list/array of retention times from a <code>xcmsRaw</code> object?</p>\n\n<p>Example Code:</p>\n\n<pre><code>xraw &lt;- xcmsRaw(cdfFile) \n</code></pre>\n\n<p>So for example getting information from it : </p>\n\n<pre><code>xraw@env$intensity \n</code></pre>\n\n<p>or</p>\n\n<pre><code>xraw@env$mz \n</code></pre>\n"},{"tags":["python","r","rpy2"],"answer_count":3,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":1500,"score":6,"question_id":2447454,"title":"Converting python objects for rpy2","body":"<p>The following code is supposed to create a heatmap in rpy2</p>\n\n<pre><code>import numpy as np\nfrom rpy2.robjects import r\ndata = np.random.random((10,10))\nr.heatmap(data)    \n</code></pre>\n\n<p>However, it results in the following error</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"z.py\", line 8, in &lt;module&gt;\n    labRow=rowNames, labCol=colNames)\n  File \"C:\\Python25\\lib\\site-packages\\rpy2\\robjects\\__init__.py\", line 418, in __call__\n    new_args = [conversion.py2ri(a) for a in args]\n  File \"C:\\Python25\\lib\\site-packages\\rpy2\\robjects\\__init__.py\", line 93, in default_py2ri\n    raise(ValueError(\"Nothing can be done for the type %s at the moment.\" %(type(o))))\nValueError: Nothing can be done for the type &lt;type 'numpy.ndarray'&gt; at the moment.\n</code></pre>\n\n<p>From the documentation I learn that r.heatmap expects \"a numeric matrix\". How do I convert np.array to the required data type?</p>\n"},{"tags":["r","spatial","polygons"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13269370,"title":"convert loess to spatial data","body":"<p>I am completely at loss on how to convert from atomic vectors, lists, etc. to spatial data.</p>\n\n<p>I want to work with data in polygons on a map (nxm matrix).  Specifically the output from functions such as loess and akima.  For example from loess I get:\nList of 3</p>\n\n<pre><code> $ x: num [1:112] 656977 657024 657071 657118 657165 ...\n $ y: num [1:82] 661500 661544 661587 661631 661675 ...\n $ z: num [1:112, 1:82] -725 -724 -720 -715 -707 ...\n</code></pre>\n\n<p>where x and y a State Plane Coordinates, and z is a combination of land surface and bathymetry elevations. The bathymetry is inside a polygon and some of the loess results spill  outside of the polygon onto the matrix.  I want to zero out everything out side of the polygon.  I believe I can do that with over, but the data needs to be a spatial coordinates.</p>\n\n<p>How do I do that?  I have been searching and trying things out for weeks.</p>\n\n<p>Thanks in advance...</p>\n"},{"tags":["r","plot"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1084,"score":0,"question_id":7534606,"title":"Save multiple graphs one after another in one pdf file","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1395410/how-to-print-r-graphics-to-multiple-pages-of-a-pdf-and-multiple-pdfs\">How to print R graphics to multiple pages of a PDF and multiple PDFs?</a>  </p>\n</blockquote>\n\n\n\n<p>I am new to R and have a quick question. The following code writes one .pdf file for each graph. I would like to add figures one after another in ONE pdf file. Thank you so much. Greatly appreciate any help.  </p>\n\n<pre><code>i=5  \nwhile (i&lt;=10)   \n{   \n  name1=\"C:\\\\temp\\\\\"  \n  num=i   \n  ext = \".pdf\"  \n  path3 = paste(name1,num,ext)  \n  par(mfrow = c(2,1))  \n  pdf(file=path3)  \n  VAR1=rnorm(i)  \n  VAR2=rnorm(i)  \n  plot(VAR1,VAR2)  \n  dev.off()  \n  i=i+1  \n}  \n</code></pre>\n"},{"tags":["r","plot"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13273271,"title":"Combining 2 datasets in a single plot in R","body":"<p>I have two columns of data, <code>f.delta</code> and <code>g.delta</code> that I  would like to produce a scatter plot of in R. </p>\n\n<p>Here is how I am doing it.</p>\n\n<pre><code>plot(f.delta~x, pch=20, col=\"blue\")\npoints(g.delta~x, pch=20, col=\"red\")\n</code></pre>\n\n<p>The problem is this: the values of <code>f.delta</code> vary from 0 to -7; the values of <code>g.delta</code> vary from 0 to 10. </p>\n\n<p>When the plot is drawn, the y axis extends from 1 to -7. So while all the <code>f.delta</code> points are visible, any <code>g.delta</code> point that has y>1 is cut-off from view.</p>\n\n<p>How do I stop R from automatically setting the ylims from the data values. Have tried, unsuccessfully, various combinations of <code>yaxt</code>, <code>yaxp</code>, <code>ylims</code>. </p>\n\n<p>Any suggestion will be greatly appreciated.</p>\n\n<p>Thanks,\nAnjan </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":63,"score":-5,"question_id":13273002,"title":"What does <<- mean in R?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2628621/how-do-you-use-scoping-assignment-in-r\">How do you use “&lt;&lt;-” (scoping assignment) in R?</a>  </p>\n</blockquote>\n\n\n\n<p>I am reading a pseudocode. I came across with this <code>&lt;&lt;-</code> many times. What is the significance of <code>&lt;&lt;-</code>? What does it mean? And what do we need to consider or be careful with when using the <code>&lt;&lt;-</code> operator?</p>\n"},{"tags":["r","list","data.frame","subset"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13270424,"title":"Subsetting a data frame by means of columns contents","body":"<p>I have the following data frame:</p>\n\n<pre><code>Test &lt;- data.frame(Species = c(\"A\",\"B\",\"C\",\"D\"), \n       WB1=c(0.1,1.1,0.9,1.2), \n       WB2=c(1, 0.8, 1.3, 1),\n       WB3=c(0.5, 0.7, 1.2, 0.9),\n       WB4=c(1.3, 1.2, 0.9, 0.6))\n</code></pre>\n\n<p>And I would like to get a new data frame per species that only lists the <code>WB's</code> that are lager than one. So in this example for species <code>A</code> that would be</p>\n\n<pre><code>WB1 WB4\n1.0 1.3\n</code></pre>\n\n<p>I have tried the following:</p>\n\n<pre><code>AllSpecies &lt;- Test$Species\nAllWaterbodies &lt;- colnames(Test)\nfor(species in AllSpecies)\n{ \n  ind &lt;- which(Test$Species == species)\n  x &lt;- Test[ind,]\n  colnames(x) &lt;- AllWaterbodies\n</code></pre>\n\n<p>If say <code>species &lt;- \"A\"</code>, than this would already give me:</p>\n\n<pre><code>  Species WB1 WB2 WB3  NA\n1       A 0.1   1 0.5 1.3\n</code></pre>\n\n<p>now I would like to only list the <code>WB's</code> that are larger than one,\nand this is where I am stuck.\nCan any body help me to complete my loop?</p>\n"},{"tags":["r","csv","for-loop","zoo"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12929891,"title":"change date format with Fun in read.zoo","body":"<p>I try to use this code to read multiple CSV file with read.zoo but I have a problem. the direction is different so I used <code>file.path()</code>. The problem is that: Date.Time into original file has Date <code>format= \"%m/%d %HH:%MM:%SS\"</code> and I need to add <code>\"%Y/\"</code> before or inside <code>read.zoo()</code> function. How could I do this? I try to use sub funtion but I need an argument. which? Is it possible to bypass this problem?</p>\n\n<pre><code>library(zoo)\nfor(i in Dir1){\n   filepath &lt;- file.path(paste(i,\".csv\",sep=\"\"))\n   #f&lt;-function(x) sub(\"([[:print:]]{15})$\", \"2005/\\\\1\",x)\n   dat&lt;-read.zoo(filepath,header=TRUE,sep=\",\",\n                 FUN = function(x) sub(\"([[:print:]]{15})$\", \"2005/\\\\1\"))\n   filenames &lt;- substr(filepath,122,155)\n   names &lt;-substr(filenames,1,21)\n   assign(names, dat)\n}\n\n   Some of my data:\n   Date.time,Outdoor Dry Bulb [C],Outdoor Relative Humidity [%],Air Temperature [C],Surface Temperature [C]\n   01/01  00:03:00,0.0,50.,23.,16.3588068633603\n   01/01  00:06:00,0.0,50.,23.,16.1696661072302\n   01/01  00:09:00,0.0,50.,23.,13.8864861630478 \n   01/01  00:12:00,0.0,50.,23.,13.006618496734\n   01/01  00:15:00,0.0,50.,23.,12.5542552024807 \n   01/01  00:18:00,0.0,50.,23.,11.6201669301972\n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13271810,"title":"Installing ggplot2 from local zip isn't happening","body":"<p>I'm using R version 2.15.1, but I accidentally upgraded ggplot2 to the latest version. Now I need to roll back to the last version of ggplot2 that was built for 2.15.1. I've downloaded version 0.8.9 from Hadley's github repo, but I can't seem to install it. Running install.packages() fails silently:</p>\n\n<pre><code>&gt; install.packages(\"~/My Documents/ggplot2-ggplot2-0.8.9.zip\", repos=NULL)\n&gt; require(ggplot2)\nLoading required package: ggplot2\nWarning message:\nIn library(package, lib.loc = lib.loc, character.only = TRUE, logical.return = TRUE,  :\n  there is no package called ‘ggplot2’\n</code></pre>\n\n<p>Here's another approach to the same problem, using Hadley's <code>devtools</code>:</p>\n\n<pre><code>&gt; install_version('ggplot2',version='0.8.9', repos='http://cran.us.r-project.org',type='win.binary') \nInstalling ggplot2_0.8.9.tar.gz from http://cran.us.r-project.org/src/contrib/Archive/ggplot2/ggplot2_0.8.9.tar.gz\nInstalling ggplot2\nC:/PROGRA~1/R/R-215~1.1/bin/i386/R --vanilla CMD build \"C:\\Documents and Settings\\matthewfrost\\Local Settings\\Temp\\RtmpcP0EzQ\\ggplot2\" --no-manual --no-resave-data \n\n* checking for file 'C:\\Documents and Settings\\matthewfrost\\Local Settings\\Temp\\RtmpcP0EzQ\\ggplot2/DESCRIPTION' ... OK\n* preparing 'ggplot2':\n* checking DESCRIPTION meta-information ... OK\n* checking for LF line-endings in source and make files\n* checking for empty or unneeded directories\n* looking to see if a 'data/datalist' file should be added\n* building 'ggplot2_0.8.9.tar.gz'\nERROR\npackaging into .tar.gz failed\nError: Command failed (1)\nIn addition: Warning message:\nrunning command '\"C:/PROGRA~1/R/R-215~1.1/bin/i386/R\" --vanilla CMD build \"C:\\Documents and Settings\\matthewfrost\\Local Settings\\Temp\\RtmpcP0EzQ\\ggplot2\" --no-manual --no-resave-data'     had status 1 \n</code></pre>\n"}]}
{"total":19203,"page":2,"pagesize":100,"questions":[{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13268610,"title":"getting prevoius month start date and end date from current date in R","body":"<p>Is there any easy way for getting start date and end date of previous month from the current date in R?</p>\n\n<p>I have only the current date.from these i want to get the previous month, start date of previous month, end date of previous month.</p>\n\n<pre><code>currentDate&lt;-Sys.Date()#return today's date as \"2012-11-07\"\n</code></pre>\n\n<p>I want the previous month start date as 2012-10-01 and end date as 2012-10-31 from today's date. </p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":34,"score":-1,"question_id":13271832,"title":"How to check if a certain numerical value is above 20% in a atomic vector","body":"<p>I have a atomic vector and want to filter out all the rows that scores above 20%.\nThe data looks as follows:</p>\n\n<pre><code>                 Gain\nch1_500001  0.0000000\nch1_1500001 0.0000000\nch1_2500001 0.3157895\nch1_3500001 0.1578947\nch1_4500001 0.1578947\nch1_5500001 0.1578947\n</code></pre>\n\n<p>So i want ch1_2500001 to be selected.</p>\n\n<p>I've tried several options:</p>\n\n<p><code>freqsnormg&lt;- freqsnorm==0.20</code>  gives only FALSE </p>\n\n<p><code>freqsnormg&lt;- freqsnorm[,1]==0.20</code> gives only FALSE</p>\n\n<p>How to get a new table that holds only the values above the 20%. And do not changes the values in a logical.</p>\n"},{"tags":["r","forecasting"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13260652,"title":"Error in simulate.Arima with Nonzero Differencing Term and External Regressor","body":"<p>When I try to simulate an Arima process with a unit root and external regressors, I get an error.  Reproducible code below:</p>\n\n<pre><code>y &lt;- ts(c(3,5,10,13,4,15,13,17,20,24,26,27))\ndummy &lt;- data.frame(dummy=c(0,0,0,0,1,0,0,0,0,0,0,0))\narima.1 &lt;- arima(y, order=c(1,1,0), xreg=dummy)\n\nfuture.dummy &lt;- data.frame(dummy=c(0,0,1,0,0,0,0,0,0,0,0,0))\nn &lt;- nrow(future.dummy)\n\nsim.1 &lt;- simulate(arima.1, nsim=n, xreg=future.dummy)\n</code></pre>\n\n<p>This produces the following error message:</p>\n\n<pre><code>Error in array(x, c(length(x), 1L), if (!is.null(names(x))) list(names(x),  : \n  attempt to set an attribute on NULL\n</code></pre>\n\n<p>I notice that when I set <code>future=FALSE</code> it works perfectly, but for my problem I want to be able to look at future simulated values.  I'd greatly any ideas as to what the problem might be. Thanks.</p>\n"},{"tags":["r","csv","data.frame","rowname"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13271820,"title":"Specifying row names when reading in a file","body":"<p>I have a <code>.txt</code> file that contains row names. However, R set the row names as the first column.</p>\n"},{"tags":["r","pdf","ggplot2","data-visualization","adobe-illustrator"],"answer_count":1,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":77,"score":7,"question_id":13262470,"title":"ggplot2: theme_set, pdf export, and Illustrator having difficulties","body":"<p>I have a list of all theme elements stored as a theme that is evoked before plotting. However, I recently found that when I export to pdf and try to open in Adobe Illustrator, I get an error \"Acrobat PDF File Format is having difficulties.\" I've also seen Illustrator report that it has \"Too few operands.\" However, when I use a standard theme (say, <code>theme_set(theme_gray())</code>), there's no problem in Illustrator. Also, regardless of the theme, I don't have issues with plotting or saving modified figures.</p>\n\n<p>Perhaps someone can suggest a) the best way to store and evoke large quantities of theme settings, and b) what could be the source of my ggplot2 -> pdf -> Illustrator woes. </p>\n\n<p>Here is my current theme, how I evoke it, and a sample plot. Note that some of the parameters are commented out, serving as placeholders if I should need them later. </p>\n\n<pre><code>textc &lt;- \"grey20\"\ngridc &lt;- \"grey20\"\nbackc &lt;- \"white\"\nfontsize &lt;- 12\n\nnew_theme &lt;- theme_set(theme_update(  \n  #axis.title = element_text()\n  axis.title.x = element_text(colour=textc,size=fontsize,angle=0,hjust=.5,vjust=.5,face=\"plain\"),\n  axis.title.y = element_text(colour=textc,size=fontsize,angle=90,hjust=.5,vjust=.5,face=\"plain\"),\n\n  #axis.text = element_text()\n  axis.text.x = element_text(colour=textc,size=fontsize,angle=0,hjust=.5,vjust=1.5,face=\"plain\"),\n  axis.text.y = element_text(colour=textc,size=fontsize,angle=0,hjust=1,vjust=0,face=\"plain\"),\n\n  axis.ticks = element_line(colour=gridc, size=0.5, linetype=\"solid\"),\n  axis.ticks.length = unit(.25,'cm'),\n  axis.ticks.margin = unit(.25,'cm'), \n\n  axis.line = element_line(colour=gridc, size=NA, linetype=\"solid\"),\n  #axis.line.x = element_line()\n  #axis.line.y = element_line()\n\n  legend.background = element_rect(colour=NA,fill=NA,size=NA,linetype=\"solid\"), # removes title and legend\n  legend.margin = unit(0,\"cm\"),\n  legend.key = element_rect(colour=NA,fill=NA,size=NA,linetype=\"solid\"),\n  legend.key.size = unit(1, 'cm'), # spacing between entries\n  #legend.key.height = unit(),\n  legend.key.width = unit(1,'cm'),\n  legend.text = element_text(colour=textc,size=fontsize,angle=0,hjust=0,vjust=0,face=\"plain\"),\n  #legend.title.align =  0,#between 0 and 1\n  legend.title = element_text(colour=textc,size=fontsize,angle=0,hjust=0,vjust=0,face=\"plain\"),\n  #legend.title.align = 0,# between 0 and 1\n\n  #legend.position = \"right\"\n  #legend.direction = \"horizonal\"\n  #legend.justification = \"center\"\n  #legend.box = \"horizontal  \n\n  panel.background = element_rect(colour=NA,fill=NA,size=NA,linetype=\"solid\"),\n  panel.border = element_rect(colour=NA,fill=NA,size=NA,linetype=\"solid\"),\n  panel.margin = unit(c(0, 0, 0, 0),'cm'),\n  #panel.grid = element_line()\n  panel.grid.major = element_line(colour=gridc, size=.4, linetype=\"dashed\"),\n  panel.grid.minor = element_line(colour=gridc, size=.4, linetype=\"dashed\"),\n  panel.grid.minor.x = element_blank(),\n  panel.grid.major.x = element_blank(),\n  #  panel.grid.minor.y = element_blank(),\n  #  panel.grid.major.y = element_blank(),\n\n  plot.background = element_rect(colour=NA,fill=backc,size=NA,linetype=\"solid\"),\n  plot.title = element_text(colour=textc,size=16,angle=0,hjust=0,vjust=1,face=\"plain\"),\n  plot.margin = unit(c(.25, .25, .25, .25),'in') # top, right, bottom, left\n\n  #strip.background = element_rect(colour=NA,fill=NA,size=NA,linetype=NA),\n  #strip.text\n  #strip.text.x = element_text(colour=textc,size=fontsize,angle=0,hjust=0,vjust=0,face=\"plain\"),\n  #strip.text.y = element_text(colour=textc,size=fontsize,angle=-90,hjust=0,vjust=0,face=\"plain\")\n))\n\ntheme_set(theme_gray())\ntheme_set(new_theme)\noptions(scipen=9999) # suppress scientific notation\n\n\nd &lt;- ggplot(mtcars,aes(x=wt,y=mpg))+\n  stat_binhex()+\n  scale_fill_gradientn(colours=c(\"darkorange2\",\"red\",\"black\"),name = \"Frequency\",na.value=NA)\ntry(ggsave(plot=d,filename=&lt;some file.pdf&gt;,height=4,width=6))\n</code></pre>\n\n<p><code>SessionInfo()</code>:</p>\n\n<pre><code>R version 2.15.2 (2012-10-26)\nPlatform: x86_64-w64-mingw32/x64 (64-bit)\n\nlocale:\n[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252   \n[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.1252    \n\nattached base packages:\n[1] grid      splines   stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] hexbin_1.26.0      lattice_0.20-10    reshape2_1.2.1     Hmisc_3.10-1       survival_2.36-14  \n[6] plyr_1.7.1         RColorBrewer_1.0-5 ggplot2_0.9.2.1   \n\nloaded via a namespace (and not attached):\n [1] cluster_1.14.3   colorspace_1.2-0 dichromat_1.2-4  digest_0.5.2     gtable_0.1.1    \n [6] labeling_0.1     MASS_7.3-22      memoise_0.1      munsell_0.4      proto_0.3-9.2   \n[11] scales_0.2.2     stringr_0.6.1    tools_2.15.2 \n</code></pre>\n"},{"tags":["eclipse","r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13271451,"title":"connecting R on Eclipse ,configuration error","body":"<p>i am connecting R 2.15 with Eclipse IDE 3.7,using <a href=\"http://www.walware.de/\" rel=\"nofollow\">StatET</a></p>\n\n<p>I have installed rjava,rj-1.1,rj.gd-1.1,installed new software \"StatET 3.0/3.1\" in Eclipse ,etc as prerequisite,\nI done all procedure as per eclipse says(Configure &amp; Launch R console panel),but at end,when configuring with R,gives error in Eclipse console</p>\n\n<pre><code>* using log directory ‘/home/trendwise/lib.Rcheck’\n* using R version 2.15.1 (2012-06-22)\n* using platform: x86_64-pc-linux-gnu (64-bit)\n* using session charset: UTF-8\n* checking for file ‘lib/DESCRIPTION’ ... NO\n</code></pre>\n\n<p>i have installed R in /usr/lib/R (R_HOME),why R checking for DESCRIPTION file ?</p>\n"},{"tags":["r","rscript"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13270564,"title":"How to invoke script that uses scan() on Windows?","body":"<p>How to invoke an R script like the following</p>\n\n<pre><code>scan()\n</code></pre>\n\n<p>in Windows? When using either <code>R</code> or <code>Rscript</code> (even with the <code>--interactive</code> switch), nothing is read. With <code>littler</code> the script works as expected but this is not available for Windows.</p>\n\n<pre><code># Doesn't work:\nR --no-save &lt; test.R\n\n# Works on Linux, doesn't on Windows\nRscript test.R\n\n# Works on Linux, doesn't exist in Windows\nr test.R\n</code></pre>\n\n<p>Is there any way at all to achieve this without changing the code?</p>\n"},{"tags":["r","machine-learning","data-mining"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":12670253,"title":"fast computation of Tomek link in R","body":"<p>i want to implement tomek's link for dealing with unbalanced data.\nThis code is used for binary classification problem, where the 1 class is the majority class and the 0 class is the minority. X the imput, Y the output\nI've written the following code but i'm looking for a way to speed up computation.</p>\n\n<p>How can i improve my code?</p>\n\n<pre><code>#########################\n#remove overlapping observation using tomek links\n#given observations i and j belonging to different classes\n#(i,j) is a Tomek link if there is NO example z, such that d(i, z) &lt; d(i, j) or d(j , z) &lt; d(i, j)\n#find tomek links and remove only the observations of the tomek links belonging to majority class (0 class).\n#########################\ntomekLink&lt;-function(X,Y,distType=\"euclidean\"){\ni.1&lt;-which(Y==1)\ni.0&lt;-which(Y==0)\nX.1&lt;-X[i.1,]\nX.0&lt;-X[i.0,]\ni.tomekLink=NULL\nj.tomekLink=NULL\n#i and j belong to different classes\ntimeTomek&lt;-system.time({\nfor(i in i.1){\n    for(j in i.0){\n        d&lt;-dst(X,i,j,distType)\n        obsleft&lt;-setdiff(1:nrow(X),c(i,j))\n        for(z in obsleft){\n            if ( dst(X,i,z,distType)&lt;d | dst(X,j,z,distType)&lt;d ){\n                break() #(i,j) is not a Tomek link, get next pair (i,j)\n                } \n            #if z is the last obs and d(i, z) &gt; d(i, j) and d(j , z) &gt; d(i, j),then (i,j) is a Tomek link\n            if(z==obsleft[length(obsleft)]){\n                if ( dst(X,i,z,distType)&gt;d &amp; dst(X,j,z,distType)&gt;d ){\n                    #(i,j) is a Tomek link\n                    #cat(\"\\n tomeklink obs\",i,\"and\",j)\n                    i.tomekLink=c(i.tomekLink,i)\n                    j.tomekLink=c(j.tomekLink,j)\n                    #since we want to eliminate only majority class observations\n                    #remove j from i.0 to speed up the loop\n                    i.0&lt;-setdiff(i.0,j)\n                    }\n                }\n            }\n        }\n    }\n})  \nprint(paste(\"Time to find tomek links:\",round(timeTomek[3],digit=2))) \n#id2keep&lt;-setdiff(1:nrow(X),c(i.tomekLink,j.tomekLink))\nid2keep&lt;-setdiff(1:nrow(X),j.tomekLink)\ncat(\"numb of obs removed usign tomeklink\",nrow(X)-length(id2keep),\"\\n\",\n    (nrow(X)-length(id2keep))/nrow(X)*100,\"% of training ;\",\n    (length(j.tomekLink))/length(which(Y==0))*100,\"% of 0 class\")\nX&lt;-X[id2keep,]\nY&lt;-Y[id2keep]\ncat(\"\\n prop of 1 afer TomekLink:\",(length(which(Y==1))/length(Y))*100,\"% \\n\")\nreturn(list(X=X,Y=Y))\n}\n\n\n#distance measure used in tomekLink function\ndst&lt;-function(X,i,j,distType=\"euclidean\"){\nd&lt;-dist(rbind(X[i,],X[j,]), method= distType)\nreturn(d)\n}\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":84,"score":5,"question_id":13244516,"title":"Draw multiple Bootstrap curves in R","body":"<p>I am wondering how to draw these multiple bootstrap curves in R.\nThe codes of mine is like</p>\n\n<pre><code>dat2 &lt;- read.delim(\"bone.data\", sep =\"\\t\", header= TRUE)\ny &lt;- dat2[,4]\nx &lt;- dat2[,2]\nplot(x,y,xlab=\"age\",ylab=\"BMD\",col=ifelse(dat2[,3]==\"female\",\"red\",\"blue\"))\n</code></pre>\n\n<p>The multiple Bootstrap Curves are like Fig 8.2 bottom left one in this book.\n<a href=\"http://www-stat.stanford.edu/~tibs/ElemStatLearn/\" rel=\"nofollow\">ESL</a></p>\n\n<p><img src=\"http://i.stack.imgur.com/Umrz4.png\" alt=\"enter image description here\"></p>\n\n<p>And the data named Bone Mineral Density could be get from this website:\n<a href=\"http://www-stat.stanford.edu/~tibs/ElemStatLearn/data.html\" rel=\"nofollow\">data</a></p>\n\n<p>The direct link to the file being: <a href=\"http://www-stat.stanford.edu/~tibs/ElemStatLearn/datasets/bone.data\" rel=\"nofollow\" title=\"here\">here</a></p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13256694,"title":"Format legend for multiple layers ggplot2","body":"<p>I'm trying to modify the legend in my graph. The graph it self is so far ok, but 2 points were missing. The Legend for the stat_density() layer - which is the over all density -, and the legend for the to geom_vline() layers - which is the means of the variables. I tried with guides = TRUE, but the result is not what I want.</p>\n\n<p>How can I add theses? And how can I modify these?\nOh and how I can get rid of the diagonal lines if I set colour in geom_density()?</p>\n\n<p>Thanks for your help!</p>\n\n<p>Here is my code for the graph:</p>\n\n<pre><code>ggplot(DEMDes) +\n  geom_density(alpha=.3, colour=NA, aes(x=AGE, fill=factor(SEX))) +\n  stat_density(geom = \"line\", aes(x=AGE), colour = \"black\", linetype=\"dashed\") +\n  geom_vline(data=cdf[1,], aes(xintercept=rating.mean), colour=\"#122bc7\",\n             linetype=\"dashed\", size=1) +\n  geom_vline(data=cdf[2,], aes(xintercept=rating.mean) , colour=\"#dc143c\",\n             linetype=\"dashed\", size=1) +\n  scale_fill_manual(name = \"Geschlecht\", values = c(\"#122bc7\", \"#dc143c\"), labels = c(\"1\" = \"Männlich\", \"2\" = \"Weiblich\"))\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/F9Ip6.png\" alt=\"enter image description here\"></p>\n\n<hr>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Here the first 500 rows of the data frame:</p>\n\n<pre><code>structure(list(SEX = c(2, 1, 1, 2, 2, 2, 1, 1, 1, 2, 2, 2, 2, \n2, 2, 2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 1, 1, 1, 1, 1, 2, 2, 2, 1, \n1, 1, 2, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 2, 1, 2, 1, 1, \n2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, \n2, 2, 2, 1, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, 1, 1, 1, 2, 1, 1, 2, \n1, 2, 2, 2, 1, 2, 2, 1, 2, 2, 1, 2, 1, 2, 1, 1, 2, 2, 1, 2, 1, \n2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, 2, 2, 1, 1, 1, 1, 2, 1, 2, 2, \n1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 1, \n2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, \n1, 2, 1, 1, 2, 2, 2, 2, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 2, 1, 2, \n2, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, 1, 1, \n2, 2, 2, 1, 2, 1, 1, 1, 2, 1, 2, 1, 1, 2, 1, 2, 2, 2, 2, 1, 1, \n1, 2, 2, 1, 1, 2, 1, 2, 1, 2, 1, 2, 2, 2, 1, 1, 2, 2, 2, 1, 2, \n1, 2, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 1, 1, 2, 2, 2, 1, 1, 2, 1, \n1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 1, 2, 1, \n2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, \n2, 2, 1, 1, 2, 2, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 2, 2, 1, 1, \n2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 2, 1, 2, 2, 1, 1, 2, 2, 2, 1, 2, \n1, 2, 2, 2, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2, 2, 1, 2, 1, \n2, 1, 2, 2, 2, 1, 1, 2, 2, 2, 1, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, \n2, 2, 2, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, \n2, 1, 2, 1, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 1, 2, 1, \n2, 1, 2, 1, 2, 1, 1, 2, 2, 1, 2, 2, 2, 1, 2, 1, 1, 1, 2, 1, 2, \n1, 1, 1, 2, 2, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 1, 2, 1, 2, 1, \n2, 2, 1, 2), AGE = c(53, 46, 56, 48, 19, 56, 58, 26, 79, 71, \n85, 79, 75, 67, 65, 97, 74, 66, 62, 46, 20, 22, 50, 41, 44, 41, \n18, 54, 60, 66, 68, 80, 45, 59, 62, 62, 54, 67, 75, 75, 44, 78, \n68, 67, 55, 54, 56, 62, 69, 70, 68, 52, 48, 23, 74, 82, 57, 40, \n41, 58, 53, 62, 64, 85, 85, 52, 34, 36, 77, 83, 36, 49, 46, 79, \n76, 63, 43, 44, 18, 18, 36, 41, 75, 66, 78, 65, 61, 61, 59, 21, \n61, 67, 57, 55, 57, 47, 41, 49, 65, 84, 54, 69, 60, 81, 62, 60, \n76, 77, 66, 79, 74, 67, 64, 66, 76, 50, 49, 55, 54, 59, 54, 63, \n48, 81, 54, 64, 43, 21, 64, 85, 79, 67, 55, 60, 59, 55, 83, 80, \n79, 47, 37, 62, 59, 81, 80, 65, 65, 76, 75, 73, 73, 83, 45, 47, \n65, 63, 66, 63, 58, 84, 72, 72, 42, 47, 65, 47, 42, 80, 54, 53, \n87, 63, 64, 54, 50, 61, 66, 57, 63, 62, 41, 73, 70, 68, 73, 69, \n55, 79, 52, 63, 66, 66, 47, 63, 62, 73, 46, 89, 83, 80, 64, 58, \n89, 40, 51, 46, 64, 64, 55, 76, 52, 64, 66, 60, 59, 73, 67, 66, \n64, 47, 39, 51, 46, 42, 18, 73, 46, 40, 24, 42, 53, 18, 49, 45, \n22, 79, 65, 69, 69, 74, 69, 72, 53, 26, 78, 75, 50, 52, 69, 69, \n65, 59, 75, 77, 78, 81, 83, 62, 67, 37, 68, 81, 84, 61, 56, 25, \n61, 55, 54, 28, 54, 47, 64, 63, 49, 53, 50, 61, 68, 67, 72, 51, \n21, 55, 51, 22, 62, 61, 55, 31, 54, 63, 59, 34, 74, 64, 73, 79, \n76, 21, 60, 59, 60, 82, 76, 71, 66, 61, 19, 55, 54, 54, 27, 57, \n67, 49, 83, 76, 72, 72, 45, 42, 64, 62, 53, 49, 21, 18, 65, 82, \n31, 62, 62, 28, 25, 60, 57, 72, 70, 66, 64, 48, 22, 41, 67, 64, \n66, 60, 70, 68, 65, 67, 64, 65, 60, 58, 38, 73, 68, 79, 67, 68, \n85, 68, 64, 69, 40, 19, 37, 54, 89, 84, 95, 70, 76, 74, 92, 54, \n54, 73, 74, 46, 48, 92, 87, 49, 49, 20, 66, 79, 67, 69, 80, 78, \n57, 56, 63, 49, 45, 92, 44, 46, 47, 46, 58, 54, 18, 44, 41, 60, \n54, 69, 45, 81, 80, 60, 75, 71, 73, 71, 71, 70, 48, 42, 81, 83, \n48, 43, 20, 63, 62, 73, 47, 63, 44, 34, 19, 18, 87, 82, 48, 75, \n63, 80, 51, 76, 50, 51, 79, 40, 75, 83, 82, 66, 64, 58, 56, 22, \n19, 71, 43, 39, 45, 18, 60, 21, 19, 70, 68, 33, 58, 49, 48, 65, \n66, 44, 55, 55, 55, 33, 46, 63, 72, 48, 46, 55, 53, 22, 20, 60, \n57, 64, 60, 29, 56, 57, 78, 43, 56, 52)), .Names = c(\"SEX\", \"AGE\"\n), row.names = c(NA, 500L), class = \"data.frame\")\n</code></pre>\n\n<p>The result might look a bit different of course. The cdf is just the mean of the SEX...</p>\n\n<pre><code>cdf &lt;- ddply(DEMDes, .(SEX), summarise, rating.mean=mean(AGE))\n</code></pre>\n"},{"tags":["r","plot","interpolation"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13268998,"title":"Calculating residuals of two curves with different datapoints in R","body":"<p>I have two different datasets (<code>c1</code> and <code>c2</code>), which are plotted together in one graph. both curves have different x- and y-values:</p>\n\n<pre><code>c1 = data.frame(\n  x=c(0,1.1,2,  3,  4,  5),\n  y=c(0,1.1,1.9,3.2,4.3,5.2)\n)\nc2 = data.frame(\n  x=c(0,0.3,0.9,2.1,3.2,4.2,5),\n  y=c(0,0.4,1.5,2.3,3.2,4.1,5.1)\n)\nplot(c1, type=\"o\", col=2)\nlines(c2, type=\"o\", col=3)\n</code></pre>\n\n<p>Now I like to plot the residuals of the two curves (<code>res=c1-c2</code>) for all unique x values (<code>unique(c(c1$x, c2$x))</code>). This would be easy if I had the same x-values. But it seems, that I have to interpolate all missing x-values and add them to the measured dataset.</p>\n\n<p>Is there an easy way for doing this in R?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13254114,"title":"Trouble with applying a nested loop on a list","body":"<p>I have a list consisting of 3 elements:</p>\n\n<pre><code>datalist=list(a=datanew1,b=datanew2,c=datanew3)\n</code></pre>\n\n<p>datalist$a :</p>\n\n<pre><code>      Inv_ret Firm size  leverage        Risk  Liquidity Equity\n17  0.04555968  17.34834 0.1323199 0.011292273 0.02471489      0\n48  0.01405835  15.86315 0.6931730 0.002491093 0.12054914      0\n109 0.04556252  16.91602 0.1714068 0.006235836 0.01194579      0\n159 0.04753472  14.77039 0.3885720 0.007126830 0.06373028      0\n301 0.03941040  16.94377 0.1805346 0.005450653 0.01723319      0\n</code></pre>\n\n<p>datalist$b :</p>\n\n<pre><code>      Inv_ret Firm size   leverage        Risk  Liquidity      Equity\n31  0.04020832  18.13300 0.09326265 0.015235240 0.01579559 0.005025379\n62  0.04439078  17.84086 0.11016402 0.005486982 0.01266566 0.006559096\n123 0.04543250  18.00517 0.12215307 0.011154742 0.01531451 0.002282790\n173 0.03960613  16.45457 0.10828643 0.011506857 0.02385191 0.009003780\n180 0.03139643  17.57671 0.40063094 0.003447233 0.04530395 0.000000000\n</code></pre>\n\n<p>datalist$c :</p>\n\n<pre><code>   Inv_ret Firm size   leverage       Risk   Liquidity      Equity\n92  0.03081029  19.25359 0.10513159 0.01635201 0.025760806 0.000119744\n153 0.03280746  19.90229 0.11731517 0.01443786 0.006769735 0.011999005\n210 0.04655847  20.12543 0.11622403 0.01418010 0.003125632 0.003802365\n250 0.03301018  20.67197 0.13208234 0.01262499 0.009418828 0.021400052\n282 0.04355975  20.03012 0.08588316 0.01918129 0.004213846 0.023657440\n</code></pre>\n\n<p>I am trying to create a <code>cor.test</code> on the <code>datalist</code> above :</p>\n\n<pre><code>Cor.tests=sapply(datalist,function(x){ \n  for(h in 1:length(names(x))){\n\n    for(i in 1:length(names(x$h[i]))){\n      for(j in 1:length(names(x$h[j]))){\n      cor.test(x$h[,i],x$h[,j])$p.value \n\n\n    }}}})\n</code></pre>\n\n<p>But I get an <code>error</code> :</p>\n\n<pre><code>Error in cor.test.default(x$h[, i], x$h[, j]) : \n  'x' must be a numeric vector\n</code></pre>\n\n<p>Any suggestions about what I am doing wrong? </p>\n\n<p>P.S. If I simply have one dataframe, <code>datanew1</code> :</p>\n\n<pre><code>      Inv_ret Firm size  leverage        Risk  Liquidity Equity\n17  0.04555968  17.34834 0.1323199 0.011292273 0.02471489      0\n48  0.01405835  15.86315 0.6931730 0.002491093 0.12054914      0\n109 0.04556252  16.91602 0.1714068 0.006235836 0.01194579      0\n159 0.04753472  14.77039 0.3885720 0.007126830 0.06373028      0\n301 0.03941040  16.94377 0.1805346 0.005450653 0.01723319      0\n</code></pre>\n\n<p>I use this <code>loop</code> :</p>\n\n<pre><code>results=matrix(NA,nrow=6,ncol=6)\nfor(i in 1:length(names(datanew1))){\n  for(j in 1:length(names(datanew1))){\n    results[i,j]&lt;-cor.test(datanew1[,i],datanew1[,j])$p.value \n\n\n}}\n</code></pre>\n\n<p>And the output is: </p>\n\n<pre><code>results :\n             [,1]         [,2]         [,3]         [,4]         [,5]        [,6]\n[1,] 0.000000e+00 7.085663e-09 3.128975e-10 3.018239e-02 4.806400e-10 0.475139526\n[2,] 7.085663e-09 0.000000e+00 2.141581e-21 0.000000e+00 2.247825e-20 0.454032499\n[3,] 3.128975e-10 2.141581e-21 0.000000e+00 2.485924e-25 2.220446e-16 0.108643838\n[4,] 3.018239e-02 0.000000e+00 2.485924e-25 0.000000e+00 5.870007e-15 0.006783324\n[5,] 4.806400e-10 2.247825e-20 2.220446e-16 5.870007e-15 0.000000e+00 0.558827862\n[6,] 4.751395e-01 4.540325e-01 1.086438e-01 6.783324e-03 5.588279e-01 0.000000000\n</code></pre>\n\n<p>Which is exactly what I want. But I want to get 3 matrices, one for each element of the <code>datalist</code> above.</p>\n\n<p><code>EDIT</code>:\nIf I do as Joran says:</p>\n\n<pre><code>Cor.tests=lapply(datalist,function(x){ \n\n  results=matrix(NA,nrow=6,ncol=6)\n  for(i in 1:length(names(x))){\n    for(j in 1:length(names(x))){\n      results[i,j]&lt;-cor.test(x[,i],x[,j])$p.value \n    }}})\n</code></pre>\n\n<p>I get: </p>\n\n<pre><code>$a\nNULL\n\n$b\nNULL\n\n$c\nNULL\n</code></pre>\n"},{"tags":["string","r","concatenation","paste","cat"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13268698,"title":"Concatenate numerical values in a string","body":"<p>I would like to store this output in a string:</p>\n\n<pre><code>&gt; x=1:5\n&gt; cat(\"hi\",x)\nhi 1 2 3 4 5\n</code></pre>\n\n<p>So I use <code>paste</code>, but I obtain this different result:</p>\n\n<pre><code>&gt; paste(\"hi\",x)\n[1] \"hi 1\" \"hi 2\" \"hi 3\" \"hi 4\" \"hi 5\"\n</code></pre>\n\n<p>Any idea how to obtain the string:</p>\n\n<pre><code>\"hi 1 2 3 4 5\"\n</code></pre>\n\n<p>Thank you very much!</p>\n"},{"tags":["r","social-networking","gephi","sna"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":28,"score":-1,"question_id":13268005,"title":"Doing Procrustes analysis with Gephi to see if clusters overlap between 2 networks","body":"<p>I am trying to run a Procrustes analysis on 2 networks, to see if the clusters in one network overlap with the clusters in another network. The nodes are the same, but the edges are based upon different relationships. Anyhow I was trying to see if I could do this in Gephi, but I have not found a way to do it. I was hoping someone might be able to indicate if I am looking in the wrong place or overlooking the correct options. </p>\n\n<p>I have tried to use the Procrustes transform in the Statnet/Latentnet package in R. The latent cluster model works, but I have a lot of nodes and it takes forever to run. Also, the separation of the clusters in the latent space model is not as nice as I would like. </p>\n"},{"tags":["r","proxy","rstudio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13264761,"title":"R connect via proxy in Ubuntu","body":"<p>I had installed RStudio 0.97.168 on Ubuntu 12.04.  When I try to install gstat library I get the below error</p>\n\n<pre><code>install.packages(\"gstat\", dependencies=TRUE)\n\nWarning in install.packages :\n  cannot open: HTTP status was '407 Proxy Authentication Required'\nWarning in install.packages :\n  cannot open: HTTP status was '407 Proxy Authentication Required'\nWarning in install.packages :\n  unable to access index for repository http://software.rc.fas.harvard.edu/mirrors/R/src/contrib\nWarning in install.packages :\n  package ‘gstat’ is not available (for R version 2.14.1)\n</code></pre>\n\n<p>I saw solutions like <code>--intenet</code> and <code>setInternet(TRUE)</code> which are only applicable for Windows OS.</p>\n\n<p>Please provide help on changes I need to make to get behind my university proxy?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13266056,"title":"trouble in read tab delimited file R","body":"<p>I am trying to read a tab delimited file that looks like this:\n<img src=\"http://i.stack.imgur.com/ptWdm.png\" alt=\"enter image description here\"></p>\n\n<p>I am using the read.table for this propose but I am not able to read the file.</p>\n\n<pre><code>table&lt;- read.table(\"/Users/Desktop/R-test/HumanHT-12_V4_0_R2_15002873_B.txt\",\n                   header =FALSE, sep = \"\\t\", \n                   comment.char=\"#\", check.names=FALSE)\n</code></pre>\n\n<p>When I run the code I have this error:</p>\n\n<pre><code>Error in scan(file, what, nmax, sep, dec, quote, skip, nlines, na.strings,  : \n  line 1 did not have 2 elements \n</code></pre>\n\n<p>What am I doing wrong while reading the table? \nI am not so familiarized with R, so any help would be really useful.</p>\n"},{"tags":["r","data"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13267595,"title":"variable with vacant value","body":"<p>Hy, I want to know how R treats the vacant value of a variable. I mean: I have a variable with two values: 1 (a behavior occurs) 0 (a behavior doesn't occur). But in my table same data are missing because I couldn't see the behavior, so there are some vacant. if I work with this variable, I can use it without any problems or, before working, I have to get out the vacant data and remain just only with the known variables?\nThanks\nGianlu</p>\n"},{"tags":["performance","r","join","merge","data.table"],"answer_count":3,"favorite_count":22,"up_vote_count":28,"down_vote_count":0,"view_count":3670,"score":28,"question_id":4322219,"title":"What's the fastest way to merge/join data.frames in R?","body":"<p>For example (not sure if most representative example though):</p>\n\n<pre><code>N &lt;- 1e6\nd1 &lt;- data.frame(x=sample(N,N), y1=rnorm(N))\nd2 &lt;- data.frame(x=sample(N,N), y2=rnorm(N))\n</code></pre>\n\n<p>This is what I've got so far:</p>\n\n<pre><code>d &lt;- merge(d1,d2)\n# 7.6 sec\n\nlibrary(plyr)\nd &lt;- join(d1,d2)\n# 2.9 sec\n\nlibrary(data.table)\ndt1 &lt;- data.table(d1, key=\"x\")\ndt2 &lt;- data.table(d2, key=\"x\")\nd &lt;- data.frame( dt1[dt2,list(x,y1,y2=dt2$y2)] )\n# 4.9 sec\n\nlibrary(sqldf)\nsqldf()\nsqldf(\"create index ix1 on d1(x)\")\nsqldf(\"create index ix2 on d2(x)\")\nd &lt;- sqldf(\"select * from d1 inner join d2 on d1.x=d2.x\")\nsqldf()\n# 17.4 sec\n</code></pre>\n"},{"tags":["r","data.frame","data.table"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13263750,"title":"OR in dataframe select expression","body":"<pre><code>DF1 &lt;- DF[DF$cat == 'A', ]\nDF2 &lt;- DF[DF$cat == 'B', ]\nRDF &lt;- rbind(DF1, DF2)\n</code></pre>\n\n<p>Is there a way to express this in a more straightforward way, such as</p>\n\n<pre><code>RDF &lt;- DF[DF$ cat == c('A','B'), ] # Does not work\n</code></pre>\n"},{"tags":["r","cran"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":501,"score":2,"question_id":5805049,"title":"Package dependencies when installing from source in R","body":"<p>Just confirming: If I distribute my R package as ZIP/TAR then installing the package will not automatically download/install dependencies because I have to set <code>repos = NULL</code> in <code>install.packages()</code> and dependencies parameter is not used if <code>repos = NULL</code>? The way to possibly get this to work is to package an install script.  Is that possible?  Am I completely missing something here and there is a mechanism to install from source AND automagically download and install dependencies?</p>\n"},{"tags":["r","dependencies","packages","cran"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13267140,"title":"Possible to state explicit versions of package dependencies?","body":"<p>I tend to be rather explicit than implicit about the code I write. So after having managed to create my own packages, the next thing that immediately comes to my mind is how best to ensure robustness and reliability of my code. Part of that has to do with the packages my package depends on.</p>\n\n<h2>Actual Question</h2>\n\n<p><strong>In that respect: is it possible to explicitly state which version of a package dependency is required/desired?</strong></p>\n\n<p>I'm looking for ways that don't require stating the actual path to, say, the <code>zip</code> file (which of course would easily be possible), but just make use of <code>install.packages</code> \"standard behavior\" of stating the package name <strong>only</strong> (possibly with some reference of the required version).</p>\n\n<h2>Due dilligence</h2>\n\n<p>I've checked <a href=\"http://cran.r-project.org/doc/manuals/R-exts.html#The-DESCRIPTION-file\" rel=\"nofollow\">Writing R Extensions</a> to see what my options are with respect to the <code>Depends</code> section of the <code>DESCRIPTION</code> file, hoping for a similar mechanism that works for stating the required R version (e.g. <code>R (&gt;= 2.15.2)</code>). But I didn't find anything similar for package dependencies:</p>\n\n<blockquote>\n  <blockquote>\n    <p>The ‘Depends’ field gives a comma-separated list of package names which this package depends on. The package name may be optionally followed by a comment in parentheses. The comment should contain a comparison operator, whitespace and a valid version number. </p>\n    \n    <p>You can also use the special package name ‘R’ if your package depends on a certain version of R — e.g., if the package works only with R version 2.11.0 or later, include ‘R (>= 2.11.0)’ in the ‘Depends’ field. You can also require a certain SVN revision for R-devel or R-patched, e.g. ‘R (>= 2.14.0), R (>= r56550)’ requires a version later than R-devel of late July 2011 (including released versions of 2.14.0). Both library and the R package checking facilities use this field: hence it is an error to use improper syntax or misuse the ‘Depends’ field for comments on other software that might be needed. Other dependencies (external to the R system) should be listed in the ‘SystemRequirements’ field, possibly amplified in a separate README file. </p>\n    \n    <p>The R INSTALL facilities check if the version of R used is recent enough for the package being installed, and the list of packages which is specified will be attached (after checking version requirements) before the current package, both when library is called and when preparing for lazy-loading during installation. </p>\n  </blockquote>\n</blockquote>\n\n<p>Then I also had a look a <code>install.packages</code> and hoped for something like a <code>version</code> argument, but I guess there isn't.</p>\n\n<h2>Disclaimer</h2>\n\n<p>I'm perfectly aware that the goal of my questions might contrast R's philosophy of distributing and installing packages via CRAN package repositories where (at least I guess) new versions of certain packages just \"overrule\" previous ones and <code>install.packages()</code> always picks up the latest one available. It also does make a lot of sense to hide version peculiarities from the end user in order not to make things overly complex.</p>\n\n<p>Yet, with respect to the goal of writing as robust code as possible, IMHO it also makes sense to state things very explicitly. Or at least to have the option to do so.</p>\n"},{"tags":["r","statistics"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13263584,"title":"unused arguments and invalid subscript type list error in R","body":"<p>i am struggling with an assignment and i would like your input.\n<em>note: this is a homework but when i tried to add the tag it said not to add it..</em>\ni don't want the resulting code, just suggestions on how to get this working :)</p>\n\n<p>so, i have a t.test function as such:</p>\n\n<pre><code>    my.t.test &lt;- function(x,s1,s2){\n        x1 &lt;- x[s1]\n        x2 &lt;- x[s2]\n        x1 &lt;- as.numeric(x1)\n        x2 &lt;- as.numeric(x2)\n        t.out &lt;- t.test(x1,x2,alternative=\"two.sided\",var.equal=T)\nout &lt;- as.numeric(t.out$p.value)\n        return(out)\n    }\n</code></pre>\n\n<p>a matrix 30cols x 12k rows called <code>data</code> and an annotation file containing col names and data on the colums named <code>dataAnn</code></p>\n\n<p><code>dataAnn</code> first column contains a list of M (male) or F (female) corresponding to the samples (or cols) in <code>data</code> (that follow the same order as in <code>dataAnn</code>), i have to run a t.test comparing the two samples and get the p values out</p>\n\n<p>when i call </p>\n\n<pre><code>raw.pValue &lt;- apply(data,1,my.t.test,s1=dataAnn[,1]==\"M\",s2=dataAnn[,1]==\"F\")\n</code></pre>\n\n<p>i get the error </p>\n\n<pre><code>Error in t.test(x1, x2, alternative = \"two.sided\", var.equal = T) : \n  unused argument(s) (alternative = \"two.sided\", var.equal = T)\n</code></pre>\n\n<p>i even tried to use </p>\n\n<pre><code>raw.pValue &lt;- apply(data,1,my.t.test,s1=unlist(data[,1:18]),s2=unlist(data[,19:30]))\n</code></pre>\n\n<p>to divide the cols i want to compare but in this case i get the error</p>\n\n<pre><code>Error in x[s1] : invalid subscript type 'list'\n</code></pre>\n\n<p>i have been looking online, i understand that the second error is caused by an indices being a list...but this didn't really clarify it for me...\nany input would be appreciated!!</p>\n"},{"tags":["r","gdb","emacs23"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":535,"score":4,"question_id":4980595,"title":"How to debug an R package (with C code) in Emacs using GDB?","body":"<p>I am currently writing an R package and using compiled C++ code through the <code>Rcpp</code> package in R (Rcpp makes the interaction of R and C++ code easier for a non-programmer like me, IMHO).</p>\n\n<p>I want to debug a few errors in my C++ program using gdb. I have googled and found mainly a few resources on debugging R within emacs, <a href=\"http://cran.r-project.org/doc/FAQ/R-FAQ.html#Should-I-run-R-from-within-Emacs_003f\" rel=\"nofollow\">R-FAQ</a>, a few mails <a href=\"http://comments.gmane.org/gmane.comp.lang.r.rcpp/1436\" rel=\"nofollow\">here</a>, and definitely the R's Writing R Extension Manual. </p>\n\n<p>However, I am doing this for the first time, I could not go too far. Could anyone give me a few pointers on how to debug R packages (or extensions with C++/C code) within emacs. Specifically, I want to take advantages of using ESS with R and gdb with Emacs (as the R-FAQ talks about).</p>\n\n<p>Please note, I am ok on how to use gdb using <em>only</em> C or C++ programs. But I could not translate this knowledge to using gdb with R and extensions.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13249350,"title":"Split a R dataframe by rows containing a keyword","body":"<p>Is there a quick way to split a large data.frame by keywords</p>\n\n<p>so for example if I have the data set below is there a quick way to split the data frame at each occurrence of the <code>source:restaurant</code> line? Another take on the question would be is there a quick way of creating factors for the dataframe based upon a list of cut offs (in this case <code>c(3,7,10)</code>) that would then give me e.g. <code>factors=c(A,A,A,B,B,B,B,C,C,C)</code> that I could use in a <code>split(mylist,factors)</code> formula? Thanks</p>\n\n<pre><code>mylist=structure(list(V1 = structure(c(5L, 3L, 7L, 8L, 6L, 4L, 7L, 2L, \n1L, 7L), .Label = c(\"cider\", \"claret\", \"custard\", \"krispies\", \n\"rhubarb\", \"shreddies\", \"source:restaurant\", \"weetabix\"), class = \"factor\"), \n    V2 = c(1L, 5L, NA, 9L, 13L, 17L, NA, 21L, 25L, NA), V3 = c(2L, \n    6L, NA, 10L, 14L, 18L, NA, 22L, 26L, NA), V4 = c(3L, 7L, \n    NA, 11L, 15L, 19L, NA, 23L, 27L, NA), V5 = c(4L, 8L, NA, \n    12L, 16L, 20L, NA, 24L, 28L, NA)), .Names = c(\"V1\", \"V2\", \n\"V3\", \"V4\", \"V5\"), class = \"data.frame\", row.names = c(NA, -10L\n))\n</code></pre>\n\n<p>A very clunky possible solution below but I'm hoping for something a bit more elegant..</p>\n\n<pre><code>temp=NULL\na=which(mylist[,1] == 'source:restaurant')\nfor(i in seq_along(a)){temp=c(temp,rep(letters[i],(a[i]-length(temp))))}\ntemp=as.factor(temp)\nsplit(mylist,temp)\n</code></pre>\n"},{"tags":["r","list"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":34,"score":3,"question_id":13263974,"title":"To add new value in every element in list in R?","body":"<p>here is <code>list1</code>, only tow elements--\"<code>name</code>\" and \"<code>age</code>\" in it,there are two value in every element ,now i want to add new value in every element,</p>\n\n<pre><code>list1&lt;-list(name=c(\"bob\",\"john\"),age=c(15,17))\nlist1\n$name\n[1] \"bob\"  \"john\"\n\n$age\n[1] 15 17\nlist1[[1]][3]&lt;-\"herry\"\nlist1[[2]][3]&lt;-17\nlist1\n$name\n[1] \"bob\"   \"john\"  \"herry\"\n\n$age\n[1] 15 17 17\n</code></pre>\n\n<p>is there more simple way to do ?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13265577,"title":"compute difference between each and every element in a row and report as a single column using r?","body":"<p>I have a vector that I have created from grouped data:</p>\n\n<pre><code>sitesMODE\nFT         KM         KO         LN         LY \n16.840000  32.230769   8.846154 237.000000  57.923077\n</code></pre>\n\n<p>I want to find the difference of each value to every value and ULTIMATELY report it in a single object or column so that I can plot it.</p>\n\n<p>I will reproduce the data here(albeit in matrix form): </p>\n\n<pre><code>siteMODE &lt;- matrix(c(16.84, 32.23, 8.84, 237.00, 57.92), 1, 5, byrow = TRUE)\ncolnames(siteMODE) &lt;- c(\"FT\", \"KM\", \"KO\", \"LN\", \"LY\")\n</code></pre>\n\n<p>I know that I can use:</p>\n\n<pre><code>diffMODELY &lt;- abs(siteMODE - siteMODE[[5]])\n</code></pre>\n\n<p>to find the difference between the expressed column/element <code>[[n]]</code> so that:</p>\n\n<pre><code>diffMODELY \nFT        KM        KO        LN        LY \n41.08308  25.69231  49.07692 179.07692   0.00000 \n</code></pre>\n\n<p>My question is now, how can I do this without having to create an object like <code>diffMODELY</code> for every column's/element's difference? AND how can I report the results into as a single object or column in a matrix?</p>\n"},{"tags":["r"],"answer_count":24,"favorite_count":30,"up_vote_count":34,"down_vote_count":0,"view_count":1727,"score":34,"question_id":1535021,"title":"What's the biggest R-gotcha you've run across?","body":"<p>Is there a certain R-gotcha that had you really surprised one day? I think we'd all gain from sharing these.</p>\n\n<p>Here's mine: in list indexing, my.list[[1]] is not my.list[1]. Learned this in the early days of R.</p>\n"},{"tags":["r","import"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":11,"view_count":58,"score":-10,"question_id":13265153,"title":"how to import csv file to R","body":"<p>I have a <code>.csv</code> file in my workstation. How can I open that file in R and do statistical calculation.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13265215,"title":"Annotation using org.At.tair.db package in R","body":"<p>Iam using R version 2.15 in a linux operating system. I have a matrix consisting of the  gene ids and their specific signal intensity values as follows( a subset of the whole matrix) :</p>\n\n<pre><code> probes GSM362180    GSM362181  GSM362188    GSM362189  GSM362192\n 244901 5.094871713 4.626623079 4.554272515 4.748604391 4.759221647\n 244902 5.194528083 4.985930299 4.817426064 5.151654407 4.838741605\n 244903 5.412329253 5.352970877 5.06250609  5.305709079 8.365082403\n 244904 5.529220594 5.28134657  5.467445095 5.62968933  5.458388909\n 244905 5.024052699 4.714631878 4.792865831 4.843975286 4.657188246\n 244906 5.786557533 5.242403911 5.060605782 5.458148567 5.890061836\n</code></pre>\n\n<p>I would like to extract only the first column as follows :\nids &lt;- scr[,2]\nand then I got a factor[2368]</p>\n\n<p>And tehn I proceeded to the annotation as follows:</p>\n\n<pre><code> biocLite(\"GO.db\")\n library(\"AnnotationDbi\")\n biocLite(\"org.At.tair.db\")\n biocLite(\"ath1121501.db\").\n genenames &lt;-  org.At.tairGENENAME[ids] #map the probe ids to the gene names in TAIR\n\n The output of which is  AnnDbBiMap[1]\n\n number&lt;-org.At.tairENTREZID[ids] #map the probe ids to the gene ids in TAIR\n The output of which is AnnDbBiMap[1]\n\n And then I try to merge both the lists as : \n xx&lt;-toTable(entrez)\n yy&lt;-toTable(number)\n complete&lt;-merge(xx,yy)\n</code></pre>\n\n<p>I get an error in this step and unable to proceed further.The error reads:</p>\n\n<pre><code> Error in fix.by(by.y.y): 'by' must specify uniquely valid column(s) \n</code></pre>\n\n<p>Is it because ids &lt;- scr[,1] is a factor ?</p>\n"},{"tags":["r","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13264001,"title":"R, rbinom(), NA, and matrices: How to ignore NA yet retain them","body":"<p>I am putting some values in a matrix through a binomial probability expression.  The problem is that I have some NA values that I need to keep in my matrix, but rbinom() returns an error when NA is inputted.</p>\n\n<p>My algorithm consists of the following:</p>\n\n<ul>\n<li>(1) start with a matrix of values in one column. </li>\n<li>(2) double the\nvalues in that matrix. </li>\n<li>(3) select a random value from a binomial\nprobability of 0.5.</li>\n<li>... some more things that are uneccessary</li>\n</ul>\n\n<p>Here is a reproducible example.</p>\n\n<pre><code>set.seed(10)\nxn &lt;- matrix(c(NA, 100, 100, 100, 100, NA, NA, 100, 100, NA), byrow=TRUE, ncol=2)\ndup &lt;- xn * 2 \nz &lt;- matrix(rbinom(n=rep(1,length(dup)), size = as.vector(dup), prob = 0.5), nrow = nrow(dup))\nWarning message:\nIn rbinom(n = rep(1, length(dup)), size = as.vector(dup), prob = 0.5) :\n  NAs produced\n</code></pre>\n\n<p>I thought about only selecting the values in the matrix that have actual values.</p>\n\n<pre><code>set.seed(6)\nxn_bin &lt;- rbinom(n=rep(1,length(dup[-which(is.na(dup))])), size = as.vector(dup[-which(is.na(dup))]),prob = 0.5)\n</code></pre>\n\n<p>I don't know how to get the matrix back together since I need take the results from xn_bin and put them back into the same position in a new matrix as the dup values were located inputted into rbinom().</p>\n\n<p>If that does not make any sense.  xn_bin will give the values:\n     xn_bin\n     [1] 101 115 112  98 103 103</p>\n\n<p>dup will give:</p>\n\n<pre><code>dup\n     [,1] [,2]\n[1,]   NA  200\n[2,]  200  200\n[3,]  200   NA\n[4,]   NA  200\n[5,]  200   NA\n</code></pre>\n\n<p>I want the final matrix to have the values from xn_bin and the NA values from xn:</p>\n\n<pre><code>         [,1] [,2]\n[1,]   NA   101\n[2,]   115  112\n[3,]   98   NA\n[4,]   NA   103\n[5,]   103  NA\n</code></pre>\n\n<p>Any idea how to do this effectively?</p>\n"},{"tags":["r","finance","xts"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":448,"score":4,"question_id":8830472,"title":"create an OHLC series from ticker data using R","body":"<p>This seems like it should be a common thing, but all my searching comes up with half or unfinished answers.</p>\n\n<p>I have a set of data in a csv.  But the data is set up so it is time, price, volume.  To properly analyze my data I need it in OHLCV format: open, high, low, close, volume.</p>\n\n<p>Does anyone have an idea how to reformat into OHLCV?</p>\n\n<p>Here is <a href=\"http://www.mediafire.com/?fyunce685ekuyo3\" rel=\"nofollow\">a sample of a data set</a>:</p>\n\n<pre><code>time,price,volume,\n7/18/10 0:09,0.04951,20,\n7/18/10 4:43,0.05941,50.01,\n7/18/10 18:48,0.0808,5,\n7/18/10 22:44,0.08585,10,\n7/18/10 23:00,0.08584,5,\n7/18/10 23:00,0.08584,5,\n7/19/10 4:53,0.0909,5,\n7/19/10 17:24,0.09307,80,\n7/19/10 18:03,0.08911,100,\n7/19/10 18:07,0.08752,100,\n7/19/10 18:12,0.09109,90,\n7/19/10 21:44,0.08416,20,\n7/19/10 21:55,0.07921,100,\n7/19/10 21:56,0.07921,10,\n7/19/10 21:57,0.07723,20,\n7/19/10 22:02,0.0808,49\n7/20/10 3:36,0.08181,100\n7/20/10 4:54,0.0818,12\n7/20/10 13:48,0.08119,4\n7/20/10 13:50,0.07921,10\n7/20/10 15:37,0.07822,10\n7/20/10 15:39,0.07723,10\n7/20/10 16:01,0.07624,10\n7/20/10 18:08,0.07723,10\n7/20/10 18:09,0.07723,10\n7/20/10 18:09,0.07723,20\n7/20/10 21:09,0.07426,4.5\n7/20/10 21:38,0.07426,5.5\n7/20/10 21:38,0.07426,4.5\n7/20/10 21:41,0.07426,45.5\n7/20/10 22:24,0.07472,3\n7/20/10 22:28,0.07472,1\n7/20/10 22:29,0.07474,1\n7/20/10 22:29,0.07474,1\n7/21/10 3:27,0.07425,60\n7/21/10 3:30,0.07327,10\n7/21/10 3:41,0.07228,10\n7/21/10 3:41,0.07129,10\n7/21/10 15:11,0.0703,10\n7/21/10 15:45,0.06931,10\n7/21/10 15:56,0.06832,10\n7/21/10 19:58,0.06733,10\n7/21/10 20:26,0.06634,10\n7/21/10 20:35,0.06634,70\n7/22/10 0:02,0.07171,100\n7/22/10 0:02,0.07171,10\n7/22/10 0:02,0.07272,10\n7/22/10 0:02,0.07373,10\n7/22/10 0:02,0.07425,40\n7/22/10 0:02,0.07474,10\n7/22/10 0:02,0.07575,20\n7/22/10 0:02,0.07575,10\n7/22/10 0:04,0.07676,10\n7/22/10 0:04,0.07777,10\n7/22/10 0:04,0.07878,5\n7/22/10 0:33,0.07921,10\n7/22/10 0:53,0.07921,20\n7/22/10 0:53,0.07921,20\n7/22/10 0:54,0.07921,20\n7/22/10 0:54,0.07921,20\n7/22/10 0:54,0.07921,20\n7/22/10 0:54,0.07921,20\n7/22/10 1:16,0.07921,65\n7/22/10 1:50,0.07979,5\n7/22/10 1:51,0.0808,20\n7/22/10 1:51,0.0808,5\n7/22/10 1:51,0.08181,5\n7/22/10 5:20,0.07878,30\n7/22/10 5:21,0.07878,3\n7/22/10 10:28,0.06931,100\n7/22/10 10:53,0.06535,10\n7/22/10 10:53,0.06436,10\n7/22/10 10:53,0.06436,45\n7/22/10 10:54,0.06337,10\n7/22/10 10:54,0.06238,10\n7/22/10 10:54,0.06139,10\n7/22/10 11:43,0.06138,605\n7/22/10 11:59,0.06436,10\n7/22/10 16:14,0.06436,10\n7/22/10 16:14,0.06436,1\n7/22/10 16:15,0.06436,1\n7/22/10 16:15,0.06436,1\n7/22/10 16:15,0.06436,1\n7/22/10 16:15,0.06436,1\n7/22/10 16:18,0.06436,85\n7/22/10 16:18,0.06337,10\n7/22/10 16:18,0.06238,5\n7/22/10 16:33,0.06238,1\n7/22/10 16:33,0.06238,1\n7/22/10 16:33,0.06238,1\n7/22/10 16:33,0.06238,1\n7/22/10 16:33,0.06238,1\n7/22/10 16:33,0.06238,1\n7/22/10 16:33,0.06238,1\n7/22/10 16:34,0.06238,1\n7/22/10 16:34,0.06238,1\n7/22/10 16:34,0.06238,1\n7/22/10 16:34,0.06139,1\n7/22/10 16:34,0.06139,1\n7/22/10 16:34,0.06139,1\n7/22/10 16:34,0.06139,1\n7/22/10 16:34,0.06139,1\n7/22/10 16:34,0.06139,1\n7/22/10 16:34,0.06139,1\n7/22/10 16:34,0.06139,1\n7/22/10 16:34,0.06139,1\n7/22/10 16:34,0.06139,1\n7/22/10 16:34,0.0604,1\n7/22/10 16:34,0.0604,1\n7/22/10 16:34,0.0604,1\n7/22/10 16:34,0.0604,1\n7/22/10 16:34,0.0604,1\n7/22/10 16:34,0.0604,1\n7/22/10 16:34,0.0604,1\n7/22/10 16:34,0.0604,1\n7/22/10 16:34,0.0604,1\n7/22/10 16:34,0.0604,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:34,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 16:35,0.05941,1\n7/22/10 18:38,0.0604,10\n7/22/10 18:39,0.05941,10\n7/22/10 18:39,0.05842,10\n7/22/10 18:39,0.05743,10\n7/22/10 18:39,0.05644,10\n7/22/10 18:39,0.05594,20\n7/22/10 18:39,0.05584,250\n7/22/10 18:39,0.05545,10\n7/22/10 18:39,0.05446,500\n7/22/10 18:46,0.05446,90\n7/22/10 20:18,0.05446,3\n7/22/10 20:18,0.05446,10\n7/22/10 22:48,0.06363,1\n7/23/10 0:55,0.05941,10\n7/23/10 0:56,0.05842,10\n7/23/10 0:56,0.05743,10\n7/23/10 0:56,0.05644,10\n7/23/10 0:56,0.05545,10\n7/23/10 0:56,0.05446,10\n7/23/10 0:56,0.05347,10\n7/23/10 0:56,0.05248,10\n7/23/10 0:56,0.05149,10\n7/23/10 0:56,0.0505,10\n7/23/10 1:13,0.0505,804.23\n7/23/10 1:14,0.0505,95.77\n7/23/10 1:15,0.06358,30\n7/23/10 1:15,0.06358,5\n7/23/10 1:15,0.06358,1\n7/23/10 2:53,0.06358,100\n7/23/10 3:19,0.06358,100\n7/23/10 3:19,0.06358,100\n7/23/10 3:20,0.06363,199\n7/23/10 3:20,0.06565,10\n7/23/10 5:03,0.06535,100\n7/23/10 5:20,0.06555,88\n7/23/10 5:20,0.06666,10\n7/23/10 5:21,0.06767,84.29\n7/23/10 5:25,0.06767,10\n7/23/10 5:25,0.06767,90\n7/23/10 8:24,0.06767,9\n7/23/10 12:05,0.06161,0.1\n7/23/10 13:38,0.05545,10\n7/23/10 15:23,0.0606,10\n7/23/10 16:55,0.06161,10\n7/23/10 17:03,0.06161,1\n7/23/10 17:21,0.06262,10\n7/23/10 17:42,0.06262,4.74\n7/23/10 19:08,0.06262,1.71\n7/23/10 19:46,0.06262,140\n7/23/10 19:58,0.06262,10\n7/23/10 20:14,0.06262,4\n7/23/10 20:35,0.06262,250\n7/23/10 21:13,0.06161,0\n7/23/10 21:37,0.06161,10\n7/23/10 22:32,0.06162,5\n7/23/10 23:29,0.05545,10\n7/23/10 23:29,0.05446,10\n7/23/10 23:29,0.05446,5\n7/23/10 23:29,0.05347,10\n7/23/10 23:30,0.05248,5.66\n7/23/10 23:30,0.05248,4.34\n7/23/10 23:30,0.05248,5.66\n7/23/10 23:40,0.06161,10\n7/23/10 23:40,0.06262,35\n7/23/10 23:40,0.06262,4\n7/24/10 1:16,0.06161,0.32\n7/24/10 1:16,0.06161,0\n7/24/10 6:53,0.05149,10\n7/24/10 8:06,0.05858,50\n7/24/10 9:26,0.05941,106\n7/24/10 12:55,0.05248,0.57\n7/24/10 12:55,0.05149,20.43\n7/24/10 14:08,0.05149,10\n7/24/10 14:08,0.05149,79.57\n7/24/10 14:08,0.0505,10\n7/24/10 14:08,0.0505,150\n7/24/10 14:08,0.05049,29.43\n7/24/10 14:08,0.05049,0\n7/24/10 15:03,0.05757,10\n7/24/10 15:04,0.05858,10\n7/24/10 16:49,0.05454,10\n7/25/10 1:59,0.05545,1\n7/25/10 5:29,0.05555,10\n7/25/10 5:29,0.05757,10\n7/25/10 5:29,0.05858,10\n7/25/10 5:33,0.05941,95.5\n7/25/10 17:01,0.05693,441\n7/25/10 17:03,0.05446,114.29\n7/25/10 17:49,0.05446,578.71\n7/25/10 20:12,0.05248,10\n7/25/10 20:12,0.05149,10\n7/25/10 20:12,0.05149,20\n7/25/10 20:13,0.05099,53\n7/25/10 20:13,0.0505,187\n7/25/10 20:13,0.0505,10\n7/25/10 20:58,0.0505,0.98\n7/26/10 11:53,0.05,1\n7/26/10 14:29,0.05,119\n7/26/10 14:29,0.05,10\n7/26/10 20:27,0.052,0.96\n7/26/10 20:53,0.052,20\n7/26/10 20:53,0.052,199.04\n7/26/10 20:53,0.053,10\n7/26/10 20:53,0.054,200\n7/26/10 20:53,0.055,100\n7/26/10 20:53,0.055,10\n7/26/10 20:53,0.0559,50\n7/26/10 20:53,0.056,2\n7/26/10 20:53,0.056,8.96\n7/26/10 20:54,0.056,100\n7/26/10 20:54,0.056,1.04\n7/26/10 20:54,0.056,18\n7/26/10 20:54,0.056,0.96\n7/26/10 21:03,0.056,26.04\n7/27/10 5:02,0.053,100\n7/27/10 5:02,0.054,100\n7/27/10 5:02,0.055,100\n7/27/10 5:02,0.0559,50\n7/27/10 5:02,0.056,10\n7/27/10 5:02,0.056,40\n7/27/10 5:06,0.056,110\n7/27/10 5:06,0.057,50\n7/27/10 5:06,0.057,10\n7/27/10 5:06,0.0575,65.98\n7/27/10 5:06,0.0575,68.04\n7/27/10 5:06,0.0579,200\n7/27/10 5:06,0.058,10\n7/27/10 5:06,0.058,450\n7/27/10 5:06,0.058,53\n7/27/10 5:06,0.059,2\n7/27/10 5:06,0.059,10\n7/27/10 5:06,0.0599,200\n7/27/10 5:06,0.06,100\n7/27/10 5:06,0.06,10\n7/27/10 5:06,0.06,35\n7/27/10 5:06,0.06,639\n7/27/10 5:07,0.0605,50\n7/27/10 16:23,0.055,100\n7/27/10 16:39,0.058,10\n7/27/10 16:41,0.0589,100\n7/27/10 16:42,0.0589,100\n7/27/10 16:43,0.059,10\n7/27/10 16:45,0.0594,100\n7/27/10 16:45,0.0594,100\n7/27/10 16:45,0.0599,100\n7/27/10 16:45,0.0599,100\n7/27/10 16:46,0.06,100\n7/27/10 16:46,0.06,50\n7/27/10 16:46,0.06,30\n7/27/10 16:46,0.06,10\n7/27/10 16:47,0.06,0.67\n7/28/10 5:19,0.06,309\n7/28/10 5:30,0.06,0.33\n7/28/10 5:30,0.061,10\n7/28/10 5:31,0.0615,200\n7/28/10 12:21,0.0582,400\n7/28/10 12:21,0.058,551.72\n7/28/10 12:58,0.057,300\n7/28/10 12:58,0.056,200\n7/28/10 12:59,0.055,127.27\n7/28/10 12:59,0.055,10\n7/28/10 12:59,0.055,200\n7/28/10 12:59,0.054,211.01\n7/28/10 19:34,0.058,50\n7/28/10 20:07,0.054,10\n7/28/10 22:37,0.0574,160\n7/28/10 22:51,0.0574,260\n7/28/10 22:52,0.058,50\n7/28/10 22:52,0.058,185\n7/28/10 23:03,0.058,15\n7/28/10 23:03,0.059,10\n7/28/10 23:04,0.0595,300\n7/28/10 23:05,0.06,500\n7/28/10 23:05,0.061,10\n7/28/10 23:05,0.061,127\n7/28/10 23:06,0.062,160\n7/28/10 23:41,0.0589,33.96\n7/29/10 5:04,0.0597,230\n7/29/10 10:02,0.0571,37.4\n7/29/10 15:33,0.05789,2\n7/29/10 17:05,0.05789,2\n7/29/10 19:04,0.05789,76\n7/29/10 19:05,0.058,20\n7/29/10 19:06,0.05939,100\n7/29/10 19:06,0.05939,100\n7/29/10 19:06,0.0599,100\n7/29/10 19:06,0.0599,60\n7/29/10 19:06,0.06,1\n7/29/10 19:11,0.06,29\n7/29/10 19:45,0.0614,9.61\n7/29/10 20:44,0.0614,410.39\n7/29/10 21:01,0.0619,96\n7/29/10 21:05,0.05991,23.31\n7/29/10 21:14,0.0599,16.69\n7/29/10 21:14,0.0619,104\n7/29/10 21:14,0.062,900\n7/29/10 21:14,0.062,100\n7/29/10 21:14,0.062,400\n7/29/10 21:19,0.062,305.72\n7/29/10 21:19,0.0631,100\n7/29/10 21:19,0.06311,50\n7/29/10 21:20,0.0635,65\n7/29/10 21:20,0.064,7\n7/29/10 21:20,0.064,10\n7/29/10 21:20,0.064,5\n7/29/10 21:20,0.065,116\n7/29/10 21:20,0.065,100\n7/29/10 21:20,0.06501,200\n7/29/10 21:21,0.067,10\n7/29/10 21:21,0.067,216.71\n7/29/10 21:21,0.0678,900\n7/29/10 21:21,0.06701,159.68\n7/29/10 21:22,0.06699,20\n7/29/10 21:23,0.05799,4.01\n7/29/10 21:28,0.0678,5\n7/29/10 21:31,0.0678,95\n7/29/10 21:31,0.068,100\n7/29/10 21:31,0.0689,16.97\n7/29/10 21:31,0.0699,900\n7/29/10 21:31,0.0699,900\n7/29/10 21:32,0.0699,73.24\n7/29/10 21:46,0.065,13\n7/29/10 21:49,0.069,5\n7/29/10 21:50,0.0699,73\n7/29/10 22:25,0.0699,64.37\n7/29/10 22:30,0.065,12\n7/29/10 22:37,0.0639,30\n7/29/10 22:41,0.0639,16\n7/29/10 22:45,0.06499,70\n7/30/10 0:07,0.0685,16\n7/30/10 0:07,0.0699,582.39\n7/30/10 2:24,0.0698,50\n7/30/10 4:55,0.062,715\n7/30/10 4:55,0.0602,200\n7/30/10 4:55,0.06,1\n7/30/10 4:55,0.06,50\n7/30/10 4:55,0.0582,34\n7/30/10 9:00,0.06,1\n7/30/10 9:00,0.0669,0.9\n7/30/10 11:01,0.06,1.09\n7/30/10 11:02,0.06,1.09\n7/30/10 11:12,0.06,1.09\n7/30/10 11:12,0.06,1.09\n7/30/10 11:28,0.0669,49.1\n7/30/10 11:29,0.0674,215\n7/30/10 11:30,0.0684,298\n7/30/10 13:33,0.06741,0.89\n7/30/10 16:10,0.061,49.11\n7/30/10 22:31,0.0681,20\n7/30/10 22:31,0.0684,42\n7/30/10 22:31,0.069,140\n7/30/10 22:31,0.069,5.49\n7/30/10 22:31,0.069,354.51\n7/30/10 22:31,0.069,360.49\n7/30/10 22:31,0.069,50\n7/30/10 22:32,0.0692,50\n7/30/10 23:25,0.0692,100\n7/31/10 0:41,0.067,25\n7/31/10 0:42,0.06315,150\n7/31/10 0:43,0.0627,55\n7/31/10 4:40,0.065,20\n7/31/10 4:40,0.0621,150\n7/31/10 4:40,0.062,20\n7/31/10 4:40,0.0612,200\n7/31/10 4:41,0.061,100.89\n7/31/10 4:41,0.061,18\n7/31/10 4:41,0.06,25\n7/31/10 4:41,0.06,4.64\n7/31/10 4:41,0.06,100\n7/31/10 4:41,0.0582,360\n7/31/10 4:41,0.0582,1.47\n7/31/10 5:07,0.0662,50\n7/31/10 5:07,0.0687,44\n7/31/10 15:49,0.0605,1\n7/31/10 15:53,0.0605,30\n7/31/10 15:53,0.06,60\n7/31/10 15:53,0.06,150\n7/31/10 15:53,0.06,1\n7/31/10 15:54,0.059,340\n7/31/10 15:56,0.05823,419\n7/31/10 16:20,0.06889,20\n7/31/10 17:53,0.05823,81\n7/31/10 17:53,0.0582,4.53\n7/31/10 17:59,0.0582,25\n7/31/10 18:33,0.058,130\n7/31/10 18:33,0.058,100\n7/31/10 18:33,0.058,60.52\n7/31/10 18:33,0.0568,9.48\n7/31/10 18:40,0.0582,89.47\n7/31/10 23:35,0.056,10\n7/31/10 23:58,0.06,800\n8/1/10 0:00,0.064,20\n8/1/10 0:12,0.06401,4\n8/1/10 0:18,0.065,20\n8/1/10 0:18,0.066,56\n8/1/10 0:18,0.066,10.25\n8/1/10 0:18,0.066,20\n8/1/10 0:18,0.067,300\n8/1/10 0:18,0.067,20\n8/1/10 0:28,0.067,73.75\n8/1/10 0:28,0.061,64.25\n8/1/10 0:55,0.06785,5\n8/1/10 0:57,0.06785,4\n8/1/10 3:21,0.061,0.75\n8/1/10 3:21,0.0601,36\n8/1/10 3:53,0.06,20\n8/1/10 4:19,0.06,20\n8/1/10 7:26,0.06,75.8\n8/1/10 11:01,0.06,80\n8/1/10 13:03,0.06,804.2\n8/1/10 13:04,0.06009,13.25\n8/1/10 13:10,0.06001,5\n8/1/10 14:11,0.061,20\n8/1/10 14:11,0.062,20\n8/1/10 14:11,0.063,100\n8/1/10 14:11,0.0636,240\n8/1/10 14:11,0.0639,36\n8/1/10 14:11,0.064,84\n8/1/10 14:12,0.064,166\n8/1/10 14:12,0.065,334\n8/1/10 14:17,0.065,500\n8/1/10 18:36,0.0602,6\n8/2/10 0:01,0.0611,40\n8/2/10 4:23,0.0627,200\n8/2/10 4:23,0.0625,128\n8/2/10 6:22,0.0625,872\n8/2/10 6:22,0.0615,128\n8/2/10 6:23,0.0615,872\n8/2/10 6:23,0.0611,128\n8/2/10 10:42,0.0611,166\n8/2/10 19:13,0.0633,80\n8/2/10 19:23,0.0611,5\n8/2/10 19:28,0.0611,20\n8/2/10 22:55,0.0611,21\n8/2/10 22:55,0.061,20\n8/2/10 22:55,0.0604,86\n8/2/10 22:55,0.0602,136.36\n8/2/10 22:55,0.06001,90.8\n8/2/10 22:55,0.06,20\n8/2/10 22:55,0.06,111.82\n8/2/10 22:55,0.06,514.02\n8/3/10 1:01,0.06,10\n8/3/10 2:49,0.06,30\n8/3/10 3:00,0.061,20\n8/3/10 3:17,0.0619,86\n8/3/10 3:17,0.062,324\n8/3/10 6:54,0.062,11.13\n8/3/10 6:57,0.062,300\n8/3/10 10:23,0.06,65\n8/3/10 10:23,0.06,20\n8/3/10 10:23,0.06,237.33\n8/3/10 10:23,0.0591,90\n8/3/10 10:23,0.059,621.67\n8/3/10 12:41,0.059,178.33\n8/3/10 12:53,0.06,40\n8/3/10 13:02,0.062,100\n8/3/10 13:02,0.062,100\n8/3/10 13:02,0.062,100\n8/3/10 13:02,0.062,64.87\n8/3/10 13:02,0.062,20\n8/3/10 13:02,0.0625,100\n8/3/10 13:03,0.0625,100\n8/3/10 13:03,0.0625,100\n8/3/10 13:03,0.0625,100\n8/3/10 13:03,0.0625,100\n8/3/10 13:03,0.0625,100\n8/3/10 13:04,0.0625,100\n8/3/10 13:04,0.0625,92.79\n8/3/10 14:07,0.061,20\n8/3/10 14:07,0.0625,207.21\n8/3/10 14:08,0.0633,12\n8/3/10 14:08,0.0635,1000\n8/3/10 14:25,0.06331,988\n8/3/10 14:25,0.06251,12\n8/3/10 14:55,0.065,5\n8/3/10 14:55,0.065,15\n8/3/10 15:53,0.06251,3\n8/3/10 15:55,0.06251,3\n8/3/10 15:56,0.06251,3\n8/3/10 19:48,0.06251,779\n8/3/10 21:06,0.06201,15.1\n8/3/10 21:07,0.06201,0.03\n8/3/10 21:08,0.061,69\n8/3/10 21:12,0.0605,1000\n8/3/10 22:17,0.0605,1000\n8/3/10 22:19,0.062,69\n8/3/10 22:19,0.0629,90\n8/3/10 22:19,0.063,100\n8/3/10 22:20,0.063,100\n8/3/10 22:20,0.063,100\n8/3/10 22:20,0.063,100\n8/3/10 22:20,0.063,100\n8/3/10 22:20,0.063,100\n8/3/10 22:20,0.063,100\n8/3/10 22:20,0.063,100\n8/3/10 22:31,0.061,70\n8/3/10 23:21,0.0601,94\n8/3/10 23:32,0.06,356\n8/4/10 1:39,0.06229,94\n8/4/10 1:39,0.0623,135.5\n8/4/10 2:02,0.0623,264.5\n8/4/10 3:02,0.06231,985.5\n8/4/10 3:02,0.0601,14.5\n8/4/10 11:57,0.0601,83.36\n8/4/10 12:29,0.06,23.56\n8/4/10 12:29,0.06,20\n8/4/10 12:29,0.06,373.08\n8/4/10 18:04,0.06,626.92\n8/4/10 18:04,0.06,20\n8/4/10 18:04,0.0591,12\n8/4/10 18:05,0.059,16\n8/4/10 18:05,0.059,20\n8/4/10 18:05,0.058,20\n8/4/10 18:05,0.0578,182\n8/4/10 18:05,0.057,20\n8/4/10 18:05,0.057,583.08\n8/5/10 2:24,0.0581,316.92\n8/5/10 2:25,0.058,53.24\n8/5/10 4:04,0.0603,10\n8/5/10 6:14,0.0603,5\n8/5/10 12:58,0.0603,1\n8/5/10 12:58,0.06,1\n8/5/10 14:18,0.06,600\n8/5/10 17:43,0.06,1000\n8/5/10 20:10,0.0603,584\n8/5/10 20:11,0.0604,190\n8/5/10 20:35,0.0608,321\n8/5/10 20:35,0.0609,911.91\n8/5/10 20:35,0.0609,117.09\n8/5/10 20:42,0.0609,882.91\n8/5/10 20:42,0.061,20\n8/5/10 21:22,0.061,20\n8/6/10 5:30,0.062,20\n8/6/10 5:34,0.0624,100\n8/6/10 5:55,0.0624,100\n8/6/10 5:56,0.0624,100\n8/6/10 7:38,0.0624,100\n8/6/10 7:49,0.0624,25\n8/6/10 9:52,0.0624,12\n8/6/10 16:01,0.0619,100\n8/6/10 20:39,0.0614,188\n8/7/10 0:09,0.0607,500\n8/7/10 0:49,0.0614,10\n8/7/10 0:52,0.0619,50\n8/7/10 0:53,0.0623,90\n8/7/10 4:48,0.0608,200\n8/7/10 6:06,0.06079,100\n8/7/10 14:16,0.06079,200\n8/7/10 14:23,0.0622,19\n8/7/10 14:56,0.06081,50\n8/7/10 16:27,0.0609,50\n8/7/10 20:58,0.061,263\n8/7/10 20:59,0.0609,175\n8/7/10 20:59,0.0608,200\n8/7/10 20:59,0.0606,200\n8/7/10 20:59,0.06,20\n8/7/10 20:59,0.06,1\n8/7/10 20:59,0.05975,141\n8/7/10 23:04,0.05975,15\n8/7/10 23:05,0.059,20\n8/7/10 23:05,0.059,20\n8/7/10 23:05,0.059,445\n8/7/10 23:05,0.059,500\n8/8/10 4:14,0.059,25\n8/8/10 16:07,0.06,1000\n8/8/10 16:07,0.0604,1000\n8/8/10 16:08,0.061,20\n8/8/10 23:24,0.0609,156\n8/9/10 2:01,0.06091,158.25\n8/9/10 2:01,0.0595,1000\n8/9/10 2:01,0.0593,841.75\n8/9/10 3:23,0.061,20\n8/9/10 3:23,0.0615,521.94\n8/9/10 3:31,0.062,4.52\n8/9/10 4:18,0.0615,389\n8/9/10 4:22,0.0615,0.81\n8/9/10 4:31,0.0615,432.44\n8/9/10 4:31,0.0615,231.35\n8/9/10 9:54,0.0615,19.94\n8/9/10 9:54,0.062,20\n8/9/10 9:54,0.0624,148.71\n8/9/10 9:54,0.0629,922.91\n8/9/10 9:55,0.063,40\n8/9/10 9:55,0.063,20\n8/9/10 9:55,0.063,10\n8/9/10 9:55,0.063,20\n8/9/10 9:55,0.064,20\n8/9/10 9:55,0.064,20\n8/9/10 9:55,0.064,55\n8/9/10 9:55,0.064,50\n8/9/10 9:55,0.0644,198.04\n8/9/10 9:55,0.0644,301.96\n8/9/10 9:55,0.065,20\n8/9/10 9:55,0.065,100\n8/9/10 9:55,0.065,142.36\n8/9/10 9:55,0.065,35\n8/9/10 9:55,0.066,265.26\n8/9/10 12:59,0.063,300\n8/9/10 13:20,0.062,10\n8/9/10 15:06,0.063,10\n8/9/10 15:06,0.065,50\n8/9/10 16:22,0.065,189\n8/9/10 16:43,0.065,500\n8/9/10 16:43,0.065,500\n8/9/10 16:43,0.065,300.23\n8/9/10 18:00,0.066,34.74\n8/9/10 18:00,0.0675,100\n8/9/10 18:00,0.0675,50\n8/9/10 18:00,0.068,1.15\n8/9/10 18:00,0.068,12.5\n8/9/10 18:00,0.068,20\n8/9/10 18:00,0.06887,100\n8/9/10 18:00,0.06887,100\n8/9/10 18:00,0.06887,100\n8/9/10 18:00,0.06887,100\n8/9/10 18:00,0.06887,100\n8/9/10 18:01,0.06887,100\n8/9/10 18:01,0.06887,100\n8/9/10 18:01,0.06887,100\n8/9/10 18:01,0.06887,100\n8/9/10 18:01,0.06887,100\n8/9/10 18:01,0.06887,100\n8/9/10 18:01,0.06887,100\n8/9/10 18:01,0.06887,100\n8/9/10 18:01,0.06887,100\n8/9/10 18:01,0.06887,100\n8/9/10 18:01,0.06887,100\n8/9/10 18:01,0.06887,400\n8/9/10 18:01,0.069,20\n8/9/10 18:01,0.069,210\n8/9/10 18:01,0.0695,1000\n8/9/10 18:01,0.0695,500\n8/9/10 18:01,0.0695,124\n8/9/10 18:01,0.0699,100\n8/9/10 18:06,0.0646,2\n8/9/10 18:07,0.0646,2\n8/9/10 18:35,0.07,20\n8/9/10 18:35,0.07,10\n8/9/10 18:35,0.071,48\n8/9/10 18:35,0.073,10\n8/9/10 18:35,0.0735,29.25\n8/9/10 18:37,0.0735,15\n8/9/10 19:38,0.06624,705\n8/9/10 20:47,0.0714,46\n8/9/10 21:36,0.06651,1.98\n8/9/10 21:39,0.06651,1\n8/9/10 21:51,0.06651,500\n8/9/10 22:42,0.0704,100\n8/9/10 22:42,0.071,100\n8/10/10 3:40,0.068,1\n8/10/10 3:42,0.068,1\n8/10/10 12:22,0.0708,7\n8/10/10 12:58,0.0708,134\n8/10/10 13:35,0.0681,100\n8/10/10 13:35,0.068,18\n8/10/10 13:36,0.0666,400\n8/10/10 13:38,0.06651,149.11\n8/10/10 19:02,0.0708,10\n8/10/10 19:02,0.0708,4.1\n8/10/10 20:05,0.0708,44.9\n8/10/10 20:05,0.0709,19\n8/10/10 20:11,0.07081,0.28\n8/10/10 21:24,0.0709,71\n8/10/10 23:51,0.0672,300\n8/11/10 0:29,0.06711,50\n8/11/10 0:58,0.07,1\n8/11/10 1:07,0.06,1\n8/11/10 1:16,0.06,1\n8/11/10 1:16,0.06,2\n8/11/10 1:16,0.06,3\n8/11/10 1:16,0.06,1\n8/11/10 1:17,0.06,1\n8/11/10 1:17,0.06,1\n8/11/10 1:18,0.07,50\n8/11/10 1:27,0.068,2\n8/11/10 2:16,0.068,49\n8/11/10 2:17,0.06711,1\n8/11/10 2:17,0.06711,1\n8/11/10 2:17,0.06711,1\n8/11/10 2:17,0.06711,1\n8/11/10 2:17,0.06711,1\n8/11/10 2:17,0.06711,1\n8/11/10 2:18,0.06711,5\n8/11/10 2:18,0.06711,140\n8/11/10 3:02,0.07,9\n8/11/10 3:03,0.07019,50\n8/11/10 3:03,0.0702,10\n8/11/10 3:03,0.0703,65\n8/11/10 11:40,0.069,70\n8/11/10 14:51,0.0691,1000\n8/11/10 15:10,0.069,5\n8/11/10 15:10,0.069,9\n8/11/10 15:45,0.07029,151\n8/11/10 15:45,0.0703,335\n8/11/10 15:46,0.071,6.72\n8/11/10 15:46,0.071,3\n8/11/10 15:46,0.0711,100.33\n8/11/10 15:47,0.07148,771.68\n8/11/10 16:28,0.069,3.77\n8/11/10 16:28,0.0683,46.23\n8/11/10 16:42,0.0684,100\n8/11/10 16:53,0.06839,200\n8/11/10 16:58,0.07,64.99\n8/11/10 17:40,0.07,1\n8/11/10 17:40,0.07,35.01\n8/11/10 17:40,0.0714,100\n8/11/10 17:47,0.0714,200\n8/11/10 17:47,0.07148,29.32\n8/11/10 17:47,0.07149,602\n8/11/10 17:47,0.0715,1000\n8/11/10 17:47,0.0715,11.77\n8/11/10 17:47,0.0715,1\n8/11/10 17:47,0.072,50\n8/11/10 17:47,0.07248,116.12\n8/11/10 18:02,0.07248,699.88\n8/11/10 18:02,0.073,300\n8/11/10 18:02,0.073,20.01\n8/11/10 18:02,0.0735,134\n8/11/10 18:02,0.0735,55.75\n8/11/10 18:02,0.07479,500\n8/11/10 18:08,0.07494,240\n8/11/10 18:14,0.07491,2\n8/11/10 18:14,0.07491,2\n8/11/10 18:14,0.07491,1.74\n8/11/10 18:15,0.07,2\n8/11/10 18:22,0.073,2\n8/11/10 18:22,0.07489,0.26\n8/11/10 18:23,0.07494,1170\n8/11/10 18:24,0.075,10\n8/11/10 18:24,0.075,30\n8/11/10 18:24,0.075,50\n8/11/10 18:24,0.075,100\n8/11/10 18:25,0.07541,400\n8/11/10 18:25,0.07541,150\n8/11/10 18:29,0.07541,1799.12\n8/11/10 18:29,0.07541,450.88\n8/11/10 18:35,0.0751,2\n8/11/10 18:48,0.0751,1.73\n8/11/10 18:50,0.07001,1506.27\n8/11/10 19:58,0.0711,37\n8/11/10 19:58,0.071,2\n8/11/10 19:58,0.0701,50\n8/11/10 19:59,0.07,857.71\n8/11/10 21:00,0.069,66.52\n8/11/10 22:53,0.067,9.37\n8/12/10 2:55,0.068,40\n8/12/10 6:56,0.067,20.31\n8/12/10 8:48,0.067,10.32\n8/12/10 8:49,0.06624,1000\n8/12/10 8:49,0.06624,10.32\n8/12/10 8:49,0.06624,9.32\n8/12/10 8:50,0.06624,275.36\n8/12/10 8:50,0.0649,73.5\n8/12/10 8:50,0.0648,189.5\n8/12/10 8:50,0.063,150\n8/12/10 8:51,0.06141,281.68\n8/12/10 22:28,0.0665,1\n8/12/10 23:20,0.07,1\n8/13/10 6:37,0.0665,147\n8/13/10 6:38,0.066,15\n8/13/10 6:38,0.065,638\n8/13/10 14:36,0.0679,86.77\n8/13/10 14:39,0.068,14\n8/13/10 20:26,0.0652,312.112\n8/13/10 20:26,0.0652,312.112\n8/13/10 20:26,0.0652,375.776\n8/13/10 20:34,0.065,300\n8/13/10 21:37,0.0651,15\n8/13/10 21:38,0.065,185\n8/13/10 21:38,0.06509,1\n8/13/10 22:44,0.065,366.38\n8/13/10 22:49,0.0645,200\n8/13/10 22:51,0.06499,33.62\n8/13/10 23:40,0.0645,128.53\n8/13/10 23:40,0.0645,45.735\n8/13/10 23:40,0.0645,10.23\n8/13/10 23:40,0.0645,300\n8/13/10 23:40,0.0645,105.505\n8/14/10 10:20,0.0655,45\n8/14/10 13:58,0.0655,1\n8/14/10 16:18,0.065,35.077\n8/14/10 16:18,0.0645,0.003\n8/14/10 16:51,0.0655,154\n8/14/10 16:51,0.066,200\n8/14/10 16:51,0.067,40\n8/14/10 16:57,0.0673,400\n8/14/10 16:58,0.0675,1000\n8/14/10 17:06,0.0685,100\n8/14/10 17:06,0.06879,50\n8/14/10 17:06,0.069,5.2\n8/14/10 17:06,0.0695,100\n8/14/10 17:06,0.0695,49\n8/14/10 17:13,0.069,300\n8/14/10 21:03,0.06587,924.92\n8/14/10 21:42,0.067,1000\n8/15/10 2:09,0.067,1000\n8/15/10 20:01,0.0667,155\n8/15/10 20:26,0.06644,414.7\n8/15/10 20:28,0.066,571.061\n8/15/10 20:33,0.06579,400\n8/15/10 20:34,0.06579,1000\n8/15/10 20:35,0.06579,92\n8/15/10 20:36,0.0655,150\n8/15/10 20:45,0.06526,5\n8/15/10 20:45,0.06526,300\n8/15/10 20:45,0.06526,300\n8/15/10 20:53,0.06526,2\n8/15/10 22:09,0.06529,5\n8/15/10 22:51,0.06529,10.106\n8/15/10 23:22,0.06529,9.799\n8/16/10 0:47,0.065,1\n8/16/10 0:47,0.065,4\n8/16/10 0:56,0.06529,9\n8/16/10 0:57,0.06529,9\n8/16/10 0:58,0.06529,7.6\n8/16/10 0:58,0.06529,17.6\n8/16/10 3:52,0.06319,83.2\n8/16/10 4:04,0.06529,547\n8/16/10 4:10,0.06529,0.001\n8/16/10 4:17,0.0678,35\n8/16/10 4:17,0.0678,35\n8/16/10 5:11,0.0652,2.7\n8/16/10 5:28,0.066,23\n8/16/10 5:28,0.067,13\n8/16/10 5:28,0.067,17\n8/16/10 5:28,0.067,10\n8/16/10 5:28,0.0678,120\n8/16/10 5:30,0.0679,264\n8/16/10 6:01,0.0676,75\n8/16/10 10:36,0.066,50\n8/16/10 10:56,0.066,221.667\n8/16/10 10:56,0.0652,161\n8/16/10 10:57,0.065,145\n8/16/10 10:57,0.065,20\n8/16/10 10:59,0.063,50\n8/16/10 10:59,0.063,36.03\n8/16/10 10:59,0.063,150\n8/16/10 15:53,0.06337,52\n8/16/10 17:41,0.063,20\n8/16/10 17:41,0.0629,100\n8/16/10 17:41,0.062,200\n8/16/10 17:41,0.062,80\n8/16/10 18:21,0.0668,1000\n8/16/10 19:17,0.0639,1000\n8/16/10 19:17,0.064,1000\n8/16/10 19:58,0.0644,2.26\n8/16/10 20:32,0.0644,500\n8/16/10 20:32,0.0644,500\n8/16/10 20:32,0.0644,500\n8/16/10 20:32,0.0644,500\n8/16/10 20:32,0.0644,500\n8/16/10 20:33,0.0644,497.74\n8/16/10 20:33,0.0645,500\n8/16/10 20:33,0.0645,218\n8/16/10 20:33,0.0669,161\n8/16/10 20:33,0.067,100\n8/16/10 20:33,0.067,100\n8/16/10 20:33,0.067,100\n8/16/10 20:45,0.0655,102.29\n8/16/10 20:45,0.0655,102.29\n8/16/10 20:45,0.0655,95.42\n8/16/10 21:58,0.0655,6.87\n8/16/10 22:48,0.06549,693.13\n8/16/10 22:49,0.0665,35\n</code></pre>\n"},{"tags":["r","plot","ggplot2","reshape"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13250872,"title":"Reshaping data to plot in R using ggplot2","body":"<p>I want to plot 3 lines using ggplot2.\nMy data looks like this</p>\n\n<pre><code>print(x)\n     V1       V2       V3      V4\n 1 -4800 25195.73 7415.219 7264.28\n 2 -2800 15195.73 5415.219 7264.28\n</code></pre>\n\n<p>From this example, I understadn that I would need to reshape my data to something like this. Is that right?</p>\n\n<pre><code>     id       x       y      \n1     1     -4800   25195.73 \n2     1     -2800   15195.73\n3     2     -4800   7415.219\n4     2     -2800   5415.219\n5     3     -4800   7264.28\n6     3     -2800   7264.28\n</code></pre>\n\n<p>How do I do this reshaping?</p>\n\n<p>Thanks!</p>\n"},{"tags":["r","rss"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":97,"score":2,"question_id":10477010,"title":"retrieving News Feed using R and getNews2 function","body":"<p>What is the reason for error that my computer is throwing me? </p>\n\n<pre><code>getNews2('IBM',5)\n</code></pre>\n\n<blockquote>\n<pre><code>   No such file or directoryfailed to load external         \n   entity \"http://www.google.com/finance/company_news?q=IBM&amp;output=rss&amp;start=1&amp;num=5\"\n\n    Error: 1: No such file or directory2: failed to load external\n    entity \"http://www.google.com/finance/company_news?q=IBM&amp;output=rss&amp;start=1&amp;num=5\n</code></pre>\n</blockquote>\n\n<p>the source code is:</p>\n\n<pre><code>getNews2 &lt;- function(symbol, number)\n{ \n  require(XML); require(plyr); require(stringr); require(lubridate);   \n\n  # construct url to news feed rss and encode it correctly \n  url.b1 = 'http://www.google.com/finance/company_news?q=' \n  url    = paste(url.b1, symbol, '&amp;output=rss', \"&amp;start=\", 1, \n           \"&amp;num=\", number, sep = '') \n  url    = URLencode(url) \n\n  # parse xml tree, get item nodes, extract data and return data frame \n  doc   = xmlTreeParse(url, useInternalNodes = TRUE); \n  nodes = getNodeSet(doc, \"//item\"); \n  mydf  = ldply(nodes, as.data.frame(xmlToList)) \n\n  # clean up names of data frame \n  names(mydf) = str_replace_all(names(mydf), \"value\\\\.\", \"\") \n\n  # convert pubDate to date-time object and convert time zone \n  mydf$pubDate = strptime(mydf$pubDate,  \n                 format = '%a, %d %b %Y %H:%M:%S', tz = 'GMT') \n  mydf$pubDate = with_tz(mydf$pubDate, tz = 'America/New_york') \n\n  # drop guid.text and guid..attrs \n  mydf$guid.text = mydf$guid..attrs = NULL \n\n  return(mydf)     \n}\n</code></pre>\n"},{"tags":["r","plot","curve-fitting"],"answer_count":4,"favorite_count":5,"up_vote_count":6,"down_vote_count":0,"view_count":14428,"score":6,"question_id":3480388,"title":"How to fit a smooth curve to my data in R?","body":"<p>I'm trying to draw a smooth curve in <code>R</code>. I have the following simple toy data:</p>\n\n<pre><code>&gt; x\n [1]  1  2  3  4  5  6  7  8  9 10\n&gt; y\n [1]  2  4  6  8  7 12 14 16 18 20\n</code></pre>\n\n<p>Now when I plot it with a standard command it looks bumpy and edgy, of course:</p>\n\n<blockquote>\n  <p>plot(x,y, type='l', lwd=2, col='red')</p>\n</blockquote>\n\n<p>How can I make the curve smooth so that the 3 edges are rounded using estimated values? I know there are many methods to fit a smooth curve but I'm not sure which one would be most appropriate for this type of curve and how you would write it in <code>R</code>. </p>\n"},{"tags":["r","quantmod"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":278,"score":2,"question_id":7629896,"title":"How to calculate days since moving average crossover?","body":"<p>I'm trying to determine the number of days that have passed since the beginning of a trend, e.g. when price has moved above the 200 day moving average (SMA).  For example:</p>\n\n<pre><code>require(quantmod)\nticker &lt;- \"QQQ\"\nx &lt;-getSymbols(ticker, auto.assign = FALSE)\nsma &lt;- SMA(Ad(x), 200)\n</code></pre>\n\n<p>I'm trying to return a variable that ranges from 0 (first day crossing over the 200 day SMA) to X or -X, depending on whether price is trending above the SMA or below.</p>\n\n<p>Can it be done without a for loop? </p>\n"},{"tags":["r","arraylist","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13262431,"title":"R converting list to array","body":"<p>Hi I have a quick question about converting a list of data.frames into an array (I prefer the latter format for plotting and manipulation).</p>\n\n<p>I have the following code which just about works but I am not getting the loop right and wondered if someone could point me to what I am doing wrong.</p>\n\n<p>What I want to do is fill an array with the values of one of the columns from each of the different data.frames in my list of data.frames.</p>\n\n<pre><code># list all the files in a directory\ndata.dir = \"/data/output\"\n\n# list all the files to plot\nfiles &lt;- list.files(data.dir, full=TRUE, pattern=\"Fields_grid*\")\n\n# cat them together into one data frame\ndata &lt;- lapply( files,  read.csv, header=FALSE, skip=26)\n\n# calc no. of files\nnfiles &lt;- length(files)\n\n# set up an empty array to fill with data\nz &lt;- array( NA, dim=c(length(x), length(y), nfiles ))\n\n# loop through all the data.frames/files \nfor (i in 1:length(nfiles)) {\n\n# calc index's of lists\nx &lt;- sort(unique( data[[i]]$V3))\ny &lt;- sort(unique( data[[i]]$V4))\nindx &lt;- match( data[[i]]$V3, x)\nindy &lt;- match( data[[i]]$V4, y)\n\n# fill array\nz[ cbind( indx, indy, i)] &lt;- data[[i]]$V5 }\n</code></pre>\n\n<p>I know this is a terrible question as I can not reproduce the result I get, but I hope you can understand my issue. When I look at z[,,1] this contains data but z[,,2] to z[,,nfiles] contains NA (i.e. my loop has not worked). I guess its something to do with the indexing but I really can't see what I have done wrong.</p>\n\n<p>Again apologies for an opaque question and thanks for having a look!</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13254353,"title":"Documentation when Package Name = Main Function Name","body":"<p>I am writing an R package names <code>slidify</code>. The main function in the package is also named <code>slidify</code>. When I run <code>devtools::check</code>, I get a warning that there is a conflict in the Rd files. </p>\n\n<p>I don't want to rename the function, since it succintly conveys what the package is intended for. What is best practice in this situation? Should typing <code>? slidify</code> lead to the function documentation or package documentation?</p>\n\n<p>Any thoughts would be appreciated.</p>\n"},{"tags":["regex","r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13261985,"title":"Character matching in R","body":"<p>In R, I have table:</p>\n\n<pre><code>Field1\n\n&amp;&amp;hello\n&amp;hi\nHello\nHi\n</code></pre>\n\n<p>How to remove everything that starts with \"&amp;\"?</p>\n\n<pre><code>gsub(\"&amp;\", \"\", A$Field1) \n</code></pre>\n\n<p>will only remove \"&amp;\" but not \"&amp;&amp;hello\" or \"&amp;hi\" as I need it.\nI tried \"&amp;*\" or \"&amp;+\" but it’s still not working.</p>\n"},{"tags":["r","classification","random-forest"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13262003,"title":"Random Forest in R - many classes","body":"<p>I want to do a multilabel classification with R randomForest.\nI have ten classes A..J,</p>\n\n<p>I found examples how to predict a single class, like:</p>\n\n<pre><code>r = randomForest(J ~., data=train, importance=TRUE, do.trace=100)\n</code></pre>\n\n<p>But I want to predict more classes, for instance H,I,J. (i.e. say that only A..G are given attributes).\nHow can I do it?</p>\n\n<p>I have an idea of preserving A..G and only one of the predicted classes (H/I/J) and run randomForest 3 times, but maybe there is a better way? To do it in one run?</p>\n\n<p>Many thanks in advance.</p>\n"},{"tags":["r","function","gui","cran","rgui"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13261348,"title":"Making simple R GUI with tcltk package","body":"<p>I'm trying to make very simple GUI for my script. In nutshell problem looks like that : </p>\n\n<p><code>data</code> is dataframe, each column is a time series. I want to plot one time series at time and to use simple GUI for moving to next or previous time series and to have possibility to put number of time series/column manually into interface.</p>\n\n<p>Example with simple code :</p>\n\n<p><code>data&lt;-data.frame(rnorm(11),rnorm(11),rnorm(11))</code></p>\n\n<p><code>i=1</code></p>\n\n<p><code>fplot&lt;-function(i,data=data){</code></p>\n\n<p><code>plot(data[,i])</code></p>\n\n<p><code>}</code></p>\n\n<p>and now how to use <code>tcltk</code> for calling <code>fplot</code> with different <code>i</code> ( by default plot for i=1 ) and after pressing first button call 'fplot' for <code>i</code> decreased by 1 and second one for increased by 1 and to optionally put value of <code>i</code> manually into GUI interface. </p>\n\n<p>This seems to be really easy, but after looking into <code>tcltk</code> documentation I'm still in point where I've started.</p>\n"},{"tags":["r","data.table"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":78,"score":-2,"question_id":13237960,"title":"data.table return multiple rows","body":"<p>I'm trying to return multiple columns for some groups in data.table. I use a function to separate a list of values and compute a vector for each group. I'd like to return these values for a table like this</p>\n\n<pre><code>address1, time1, value1\naddress1, time2, value2\naddress1, time3, value3\n</code></pre>\n\n<p>I group time1-time2 in a function and would like to return something like this</p>\n\n<pre><code>address1,sum(value1),       mean(value1)                     (by timegr1)\naddress1,sum(value2+value3),mean(value2+value3)              (by timegr2)\n</code></pre>\n\n<p>I managed to compute all the values, just cannot format the results, so that it'd put the two time-groups in different lines and keep the sum and mean in the same line.</p>\n\n<p>EDIT\nhere is the code:</p>\n\n<pre><code>v &lt;- data.table(address =c(1,1,1,1),time=c(1,50,51,52),value=c(1,2,3,4))\n\nfun &lt;- function(time,value) {\ndata &lt;- data.table(time=time,value=value)\n#this split depends on a number of criteria\nk &lt;- split(data,c(0,rep(1,nrow(data)-1))) \nk1 &lt;- sapply(k,function(x) c(mean(x$value),sum(x$value)))\nreturn(k1)\n}\n\nv1 &lt;- v[,fun(time,value),by=address]\n</code></pre>\n\n<p>V1 comes out as</p>\n\n<pre><code>   address V1\n1:       1  1\n2:       1  1\n3:       1  3\n4:       1  9\n</code></pre>\n\n<p>I really need something like</p>\n\n<pre><code>   address  mean sum\n1: 1        1    1\n2: 1        3    9\n</code></pre>\n\n<p>thanks a lot.</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":47,"score":4,"question_id":13258454,"title":"Marking specific tiles in geom_tile() / geom_raster()","body":"<p>Let's say I have a data.frame like this:</p>\n\n<pre><code>df &lt;- matrix( rnorm(100), nrow = 10)\nrownames(df) &lt;- LETTERS[1:10]\nmolten &lt;- melt(df)\nmolten$na &lt;- FALSE\nmolten[ round(runif(10,  0, 100 )), \"na\" ] &lt;- T\nhead(molten)\n\n  Var1 Var2      value    na\n1    A    1 -0.2413015 FALSE\n2    B    1  1.5077282 FALSE\n3    C    1 -1.0798806 TRUE\n4    D    1  2.0723791 FALSE\n</code></pre>\n\n<p>Now, I want to plot a tile (or raster)  plot using ggplot and <em>mark</em> those tiles which have <code>na=TRUE</code>. Currently I plot the marks as points:</p>\n\n<pre><code>g &lt;- ggplot( molten ) +\n  geom_raster( aes( x = Var1, y = Var2, fill = value )  ) + \n  scale_fill_gradient2( low = \"blue\", high = \"red\", na.value=\"black\", name = \"\" ) +\n  geom_point( aes( x = Var1, y = Var2, size= as.numeric(na) ) )\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/VdgDs.png\" alt=\"tiles with points\"></p>\n\n<p>However, I don't like this plot very much for two reasons:</p>\n\n<ol>\n<li>There is still a point drawn even if <code>molten$na = FALSE</code>. Sure I could specify <code>data=molten[ molten$na, ]</code>, but actually this should be possible without specifying another data set.</li>\n<li>I don't like the points, but would rather like to have frames around or stripes through the tiles. But I have no idea how to achieve this. If I would use <code>geom_segment()</code> for stripes, how would I specify <code>yend</code>and <code>xend</code>?</li>\n</ol>\n\n<p>Any help is appreciated.</p>\n\n<p><strong>Edit 1</strong>\nHere is the <code>dput</code>for reproducibility:</p>\n\n<pre><code>structure(list(Var1 = structure(c(1L, 2L, 3L, 4L, 1L, 2L, 3L, \n4L, 1L, 2L, 3L, 4L, 1L, 2L, 3L, 4L, 1L, 2L, 3L, 4L), .Label = c(\"A\", \n\"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\"), class = \"factor\"), \n    Var2 = c(6L, 6L, 6L, 6L, 7L, 7L, 7L, 7L, 8L, 8L, 8L, 8L, \n    9L, 9L, 9L, 9L, 10L, 10L, 10L, 10L), value = c(-0.468920099229389, \n    0.996105987531978, -0.527496444770932, -0.767851702991822, \n    -0.36077954422072, -0.145335912847538, 0.114951323188032, \n    0.644232124274217, 0.971443502096584, 0.774515290180507, \n    -0.436252398260595, -0.111174676975868, 1.16095688943808, \n    0.44677656465583, -0.708779168274131, 0.460296447139761, \n    -0.475304748445917, -0.481548436194392, -1.66560630161765, \n    -2.06055347675196), na = c(FALSE, FALSE, FALSE, FALSE, FALSE, \n    FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, \n    FALSE, FALSE, TRUE, FALSE, FALSE, FALSE)), .Names = c(\"Var1\", \n\"Var2\", \"value\", \"na\"), row.names = c(51L, 52L, 53L, 54L, 61L, \n62L, 63L, 64L, 71L, 72L, 73L, 74L, 81L, 82L, 83L, 84L, 91L, 92L, \n93L, 94L), class = \"data.frame\")\n</code></pre>\n"},{"tags":["r","data.table"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13261240,"title":"cross sectional sub-sets in data.table","body":"<p>I have a data.table which contains multiple columns, which is well represented by the following: </p>\n\n<pre><code>DT &lt;- data.table(date = as.IDate(rep(c(\"2012-10-17\", \"2012-10-18\", \"2012-10-19\"), each=10)), \n                   session = c(1,2,3), price = c(10, 11, 12,13,14), \n                   volume = runif(30, min=10, max=1000)) \n</code></pre>\n\n<p>I would like to extract a multiple column table which shows the volume traded at each price in a particular type of session -- with each column representing a date. </p>\n\n<p>At present, i extract this data one date at a time using the following: </p>\n\n<pre><code>DT[session==1,][date==\"2012-10-17\", sum(volume), by=price]\n</code></pre>\n\n<p>and then bind the columns. </p>\n\n<p>Is there a way of obtaining the end product (a table with each column referring to a particular date) without sticking all the single queries together -- as i'm currently doing? </p>\n\n<p>thanks</p>\n"},{"tags":["r","zoo"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13243148,"title":"Rollapply for time series","body":"<p>I am trying to calculate the rolling 20 period historical volatility. I take the daily returns:</p>\n\n<pre><code>ret&lt;-ROC(data1)\n</code></pre>\n\n<p>And then I use rollapply to get the 20 day HV for each column:</p>\n\n<pre><code>vol&lt;-rollapply(ret,20,sd,by.column=T,fill=NA)\n</code></pre>\n\n<p>The problem is that observations in vol starts appearing after ten days which is wrong as I specified 20.</p>\n\n<p>For demonstration here is sample of the data:</p>\n\n<pre><code>0.000000000, 0.005277045, 0.023622047, 0.002564103,-0.002557545, -0.020512821,\n0.007853403,-0.012987013,  0.007894737,  0.015665796,  0.000000000, -0.002570694,\n0.002577320, -0.015424165, 0.002610966,  0.010416667,  0.002577320,  0.015424165, \n0.000000000, -0.002531646, -0.002538071, 0.030534351,  0.014814815, -0.007299270,\n-0.009803922, -0.012376238,  0.002506266, -0.015000000,-0.002538071,  0.002544529\n</code></pre>\n\n<p>Assume the data above is stored in x, then:</p>\n\n<pre><code>rollapply(x,20,sd,fill=NA)\n</code></pre>\n\n<p>will yield a first observation at 10th row instead of 20. Also the sd is wrong too.</p>\n\n<p>I should be missing something here...</p>\n"},{"tags":["r","ggplot2"],"answer_count":4,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13260626,"title":"Selecting data frame columns to plot in ggplot2","body":"<p>I have a big table of data with ~150 columns. I need to make a series of histograms out of about 1/3rd of them. Rather than putting 50 lines of the same plot command in my script, I want to loop over a list telling me which columns to use. Here is a test dataset to illustrate:</p>\n\n<pre><code>d &lt;- data.frame(c(rep(\"A\",5), rep(\"B\",5)),\n                sample(c(1:10), 10, replace=TRUE),     \n                sample(c(1:10), 10, replace=TRUE),     \n                sample(c(1:10), 10, replace=TRUE),     \n                sample(c(1:10), 10, replace=TRUE),     \n                sample(c(1:10), 10, replace=TRUE))\n\ncolnames(d) &lt;- c(\"col1\",\"col2\",\"col3\",\"col4\",\"col5\",\"col6\" )\n\n\nggplot(data=d, aes(col2, fill= col1)) + geom_density(alpha = 0.5)\n</code></pre>\n\n<p>So, rather than writing this a 50 times and replacing the <code>aes()</code> values, I really want to do something more like this...</p>\n\n<pre><code>cols_to_plot &lt;- c(\"col2\",\"col4\",\"col6\")\n\nfor (i in length(cols_to_plot)) {\n  ggplot(data=d, aes(cols_to_plot[i], fill= col1)) + geom_density(alpha = 0.5)\n\n} \n</code></pre>\n\n<p>But of course, this doesn't work... Is there a way to do this kind of thing? </p>\n\n<p>Thanks!</p>\n"},{"tags":["java","r","jri"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13260649,"title":"Proper Way to end a JRI program?","body":"<p>I'm using JRI to use R to plot a histogram from within Java. After it prints the histogram, I want it to pause until the user presses enter. The code I'm using for this is:</p>\n\n<pre><code>//Wait for quit\nSystem.out.print(\"Press Enter When Finished\");\nscan.nextLine();\nr.end();\n</code></pre>\n\n<p>However, when I run the program, it plots the graph all right, but then after a second, it freezes. It doesn't terminate on its own, and I have to force quit it in Activity Monitor. What am I doing wrong?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13239499,"title":"How to replace numeric dates with month names for a column in R","body":"<p>I have a current DataFrame that looks like this:</p>\n\n<pre><code>      DATETIME MEAS_AVG TARG_MIN TARG_AVG TARG_MAX DESPORT_NOTE\n1  2012/04/10 14:03:37   0.2888     0.22     0.25     0.27      GOOD_PT\n2  2012/03/30 07:48:17   0.2544     0.22     0.25     0.27      GOOD_PT\n3  2012/03/24 19:23:08   0.2333     0.22     0.25     0.27      GOOD_PT\n4  2012/03/25 16:10:17   0.2111     0.22     0.25     0.27      GOOD_PT\n5  2012/04/10 00:58:29   0.2222     0.22     0.25     0.27      GOOD_PT\n6  2012/04/14 18:32:52   0.2888     0.22     0.25     0.27      GOOD_PT\n7  2012/04/21 14:47:47   0.2777     0.22     0.25     0.27      GOOD_PT\n</code></pre>\n\n<p>The data frame is called df3 and the specific column I am looking to replace the dates for are df3$DATETIME.</p>\n\n<p>I have this function in my code already in order to strip the datetime:</p>\n\n<p>date &lt;- strptime(df3$DATETIME, \"%Y/%m/%d %H:%M:%S\")</p>\n\n<p>All I am looking to replace all the datetime information with simple month names.\nThis is what it should look like after the replace function:</p>\n\n<pre><code>      DATETIME MEAS_AVG TARG_MIN TARG_AVG TARG_MAX DESPORT_NOTE\n1  April   0.2888     0.22     0.25     0.27      GOOD_PT\n2  March   0.2544     0.22     0.25     0.27      GOOD_PT\n3  March   0.2333     0.22     0.25     0.27      GOOD_PT\n4  March   0.2111     0.22     0.25     0.27      GOOD_PT\n5  April   0.2222     0.22     0.25     0.27      GOOD_PT\n6  April   0.2888     0.22     0.25     0.27      GOOD_PT\n7  April   0.2777     0.22     0.25     0.27      GOOD_PT\n</code></pre>\n\n<p>I am been looking all over for a simple replace column function, but can't seem to find it. I know that I can use the as.Date() function with the formated %B to return the unabreviated month. The only problem is I do not know how to use this to replace the column values already existing.</p>\n\n<p>I can list the months using this function:</p>\n\n<pre><code>list(month=months(as.Date(df3$DATETIME)))\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13259186,"title":"Plot GLM model in R","body":"<p>I am doing a linear regression model, so right now I have</p>\n\n<pre><code>mylogit &lt;- glm(Gender ~ Drug*Environment + Ethnicity + Age, data = mydata, family = \"binomial\")    \n</code></pre>\n\n<p>Gender (F/M), Drug (Y/N), Environment (H/L) are all factors and age is the only numeric. </p>\n\n<p>I am trying to graph a scatter plot with proportion of males (y-axis) vs. age (x-axis). There are four conditions, so four different colors/lines:</p>\n\n<p>1) Drug Y/Env H\n2) Drug N/Env H\n3) Drug N/Env L\n4) Drug Y/Env L</p>\n\n<p>I've tried using </p>\n\n<pre><code>plot(effect(\"Gender*Drug*Environment*Age\", mylogit, xlevels=list(Age=20:60)), + multiline=TRUE, rug=FALSE)\n</code></pre>\n\n<p>But this just separates it into two graphs with two lines in each graph and does not plot the individual data points on there. </p>\n"},{"tags":["r","text"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13256405,"title":"aligned & alternating character strings","body":"<p>I have been working to provide text analysis of data.  Often analysis included coding of a transcript on paper and then importing the information as numeric codes into R.  I want to output a transcript of words with their word number above cut to a certain line width (let's use an arbitrary 80 characters).</p>\n\n<p><strong>A minimal visualization example:</strong></p>\n\n<pre><code>#what we start with:\n\n   person   text word.num\n1    greg    The        1\n2    greg    dog        2\n3    greg   went        3\n4    greg     to        4\n5    greg    the        5\n6    greg   zoo,        6\n7    greg    but        7\n8    greg    ate        8\n9    greg first.        9\n10  sally     He       10\n11  sally  likes       11\n12  sally  water       12\n13  sally      a       13\n14  sally    bit       14\n15  sally   too.       15\n</code></pre>\n\n<p>#what I'd like:</p>\n\n<pre><code>1   2   3    4  5   6\nThe dog went to the zoo, \n\n7   8   9      10 11     \nbut ate first. He likes   \n\n12    13  14  15\nwater a   bit too.  \n</code></pre>\n\n<p>An additional problem arises as the numbers get large in that a larger word number may exceed a short word and the word would need an additional space placed in front of it.  I think this would be easy enough to do in the pasting process by determining the max characters (digits) of the largest number and adding that much space after words that are less than this amount.  </p>\n\n<p>My thought to tackle this thus far was to:</p>\n\n<ol>\n<li>Create a 1 column matrix for the character vector that each row is a certain max length (<code>strwrap</code> may be useful here)</li>\n<li>Add extra spaces after short words as discussed above (<code>nchar</code> and <code>gsub</code> may be useful here)</li>\n<li>Determine the the numeric values for an accompanying matrix by using a word count function and then <code>cumsum</code> and <code>seq</code> to make an accompanying matrix of numeric values (actually character) that is also 1 column.  This will match row for row with the character (words) matrix.</li>\n<li>Now the two matrices need to be alternated row by row (not sure how to do this)</li>\n<li>Align the numbers above the words (not sure how to do this but <code>nchar</code> may be useful here)</li>\n</ol>\n\n<p>I'd like to keep this in base tools though I'm sure Hadely's <code>stringR</code> would be useful I want to avoid this dependency.  </p>\n\n<p><strong><code>dput</code> data above:</strong></p>\n\n<pre><code> dat &lt;- structure(list(person = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L,                           \n     1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L), .Label = c(\"greg\", \"sally\"), class = \"factor\"),             \n         text = structure(c(10L, 5L, 14L, 11L, 9L, 15L, 4L, 2L, 6L,                               \n         7L, 8L, 13L, 1L, 3L, 12L), .Label = c(\"a\", \"ate\", \"bit\",                                 \n         \"but\", \"dog\", \"first.\", \"He\", \"likes\", \"the\", \"The\", \"to\",                               \n         \"too.\", \"water\", \"went\", \"zoo,\"), class = \"factor\"), word.num = 1:15), row.names = c(NA, \n     -15L), .Names = c(\"person\", \"text\", \"word.num\"), class = \"data.frame\")  \n</code></pre>\n\n<p><em>I couldn't devise a title I felt captured the thought while being searchable to future SO users.  Please suggest edits...</em></p>\n"},{"tags":["r","data.frame"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13251966,"title":"Repeat and reorder columns in a data frame","body":"<p>Let's say I have the following data frame:</p>\n\n<pre><code>&gt; df = data.frame(seq(0, 150, length.out=11), 1:11, rep(0, 11), sample(1:50, 11), \n+ sample(1:50, 11), sample(1:50, 11))\n&gt; colnames(df) = c(\"Time\", \"Inc\", \"Side\", \"Pat1\", \"Pat2\", \"Pat3\")\n&gt; df\n    Time Inc Side Pat1 Pat2 Pat3\n1     0   1    0   48   49   13\n2    15   2    0   43   33   15\n3    30   3    0   27   48   38\n4    45   4    0   41   47   46\n5    60   5    0   11   25   37\n6    75   6    0    5   15    4\n7    90   7    0   17   22    2\n8   105   8    0   10   41   24\n9   120   9    0   45   21   33\n10  135  10    0   19   26   41\n11  150  11    0   25   42   45\n</code></pre>\n\n<p>Now I want to repeat the first 3 columns n times (n = number of Pat columns) and attach it one below each other. Then I want to place Pat2 below Pat1, Pat3 below Pat2, ...</p>\n\n<p>My first intetion was to split the df into a Time/Inc/Side part and a Pat part, but I had problems arranging the columns below each other. Any suggestions? </p>\n"},{"tags":["r","bash","function","split"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":58,"score":3,"question_id":13260252,"title":"A better way to extract functions from an R script?","body":"<p>Say I have a file \"myfuncs.R\" with a few functions in it:</p>\n\n<pre><code>A &lt;- function(x) x\nB &lt;- function(y) y\nC &lt;- function(z) z\n</code></pre>\n\n<p>I want to place all the functions contained within \"myfuncs.R\" into their own files, named appropriately.  I have a simple Bash-shell script to extract functions and place them in separate files:</p>\n\n<pre><code>split -p \"function\\(\" myfuncs.R tmpfunc\ngrep \"function(\" tmpfunc* | awk '{\n  # strip first-instances of function assignment\n  sub(\"&lt;-\", \" \")\n  sub(\"=\", \" \")\n  sub(\":\", \" \")  # and colon introduced by grep\n  mv=$1\n  mvto=sprintf(\"func_%s.R\",$2)\n  print \"mv\", mv, mvto\n}' | sh\n</code></pre>\n\n<p>leaving me with:</p>\n\n<pre><code>func_A.R\nfunc_B.R\nfunc_C.R\n</code></pre>\n\n<p>But, this script has obvious limitations.  For example, it will misbehave when function 'A' has a nested function:</p>\n\n<pre><code>A &lt;- function(x){\n    Aa &lt;- function(x){x}\n    return(Aa)\n}\n</code></pre>\n\n<p>and outright fails if the whole function is on a single line.</p>\n\n<p>Does anyone know of a more robust, and less error-prone method to do this? </p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13254441,"title":"Add a horizontal line to plot and legend in ggplot2","body":"<p>This code creates a nice plot but I would like to add a horizontal black line at y=50 AND have the legend show a black line with the text \"cutoff\" in the legend, but leave points in the legend for the sources. I can add the line with geom_line but cannot get the line in the legend. </p>\n\n<pre><code>    library(ggplot2)\n    the.data &lt;- read.table( header=TRUE, sep=\",\", \n    text=\"source,year,value\n    S1,1976,56.98\n    S1,1977,55.26\n    S1,1978,68.83\n    S1,1979,59.70\n    S1,1980,57.58\n    S1,1981,61.54\n    S1,1982,48.65\n    S1,1983,53.45\n    S1,1984,45.95\n    S1,1985,51.95\n    S1,1986,51.85\n    S1,1987,54.55\n    S1,1988,51.61\n    S1,1989,52.24\n    S1,1990,49.28\n    S1,1991,57.33\n    S1,1992,51.28\n    S1,1993,55.07\n    S1,1994,50.88\n    S2,1993,54.90\n    S2,1994,51.20\n    S2,1995,52.10\n    S2,1996,51.40\n    S3,2002,57.95\n    S3,2003,47.95\n    S3,2004,48.15\n    S3,2005,37.80\n    S3,2006,56.96\n    S3,2007,48.91\n    S3,2008,44.00\n    S3,2009,45.35\n    S3,2010,49.40\n    S3,2011,51.19\") \n    ggplot(the.data, aes( x = year, y = value ) ) + \n        geom_point(aes(colour = source)) + \n        geom_smooth(aes(group = 1))\n</code></pre>\n"},{"tags":["r","data","script"],"answer_count":6,"favorite_count":4,"up_vote_count":5,"down_vote_count":2,"view_count":1730,"score":3,"question_id":7781798,"title":"Seeing if data is normally distributed in R","body":"<p>Can someone please help me fill in the following function in R:</p>\n\n<pre><code>#data is a single vector of decimal values\nnormally.distributed &lt;- function(data) {\nif(data is normal)\nreturn(TRUE)\nelse\nreturn(NO)\n}\n</code></pre>\n"},{"tags":["r","optimization","constraints"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13248189,"title":"how to set the constraints for constrOptim","body":"<p>I have a function that has needs weights to be applied to a matrix to return a scalar value. But the weights can only be between an upper and lower bound say <code>c(-5,5)</code>, and must sum to less than a numerical value <code>y</code>. How does one apply these contraints to the constrOptim function?</p>\n\n<p>So for example my function could be any function that does the trick but im going to provide a mock example one anyway...(I think its non-linear...)</p>\n\n<p>example weights are where <code>y==1</code> is say</p>\n\n<pre><code>weights &lt;- c(0.1,0.4,0.5)\n\nrequire(timeSeries)\n\nobjective.fun &lt;- function(weights, matrix.obj){\n    sum( colSds( matrix.obj * rep(weights,each=nrow(matrix.obj)) )\n}\n</code></pre>\n\n<p>and an example matrix.obj of say </p>\n\n<pre><code>matrix.obj &lt;- data.frame(cbind(x=rnorm(100), y=rnorm(100), z=rnorm(100)))\n</code></pre>\n\n<p>The number of columns is variable....</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13259434,"title":"R Date format with months and days of two digits","body":"<p>I needed to turn character Date \"2008-1-1\" to numeric 20080101, but what I get is 200811, could anybody help me with this? Thank you very much. This is my code:</p>\n\n<pre><code>year &lt;- c(2008:2012)\nmth &lt;- c(1:5)  \nday &lt;- c(1:5) \nA &lt;- data.frame(cbind(year,mth,day)) \ndate.ch &lt;- as.character(with(A, paste(year, mth, day, sep=\"-\")))\ndate.n &lt;- as.numeric(with(A, paste(year, mth, day, sep=\"\")))\n</code></pre>\n"},{"tags":["r","combinations"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":63,"score":3,"question_id":13258586,"title":"Given a vector, return a list of all combinations up to size n","body":"<p>I'm trying to write a function in R that, given a vector and a maximum size n, will return all the combinations of elements from that vector, up to size n.</p>\n\n<p>E.g.:</p>\n\n<pre><code>multi_combn(LETTERS[1:3], 2)\n</code></pre>\n\n<p>Would yield:</p>\n\n<pre><code>[[1]]\n[1] \"A\"\n\n[[2]]\n[1] \"B\"\n\n[[3]]\n[1] \"C\"\n\n[[4]]\n[1] \"A\" \"B\"\n\n[[5]]\n[1] \"A\" \"C\"\n\n[[6]]\n[1] \"B\" \"C\"\n</code></pre>\n\n<p>I've figured out an inelegant way to run <code>combn</code> for each size up to n, but I can't seem to combine the results into a single list.  Any suggestions?</p>\n"},{"tags":["r","data-mining","cluster-analysis"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13249422,"title":"Hierarchical Clustering: Determine optimal number of cluster and statistically describe Clusters","body":"<p>I could use some advice on methods in R to determine the optimal number of clusters and later on describe the clusters with different statistical criteria. I’m new to R with basic knowledge about the statistical foundations of cluster analysis. </p>\n\n<ol>\n<li><p><strong>Methods to determine the number of clusters:</strong> In the literature one common method to do so is the so called \"Elbow-criterion\" which compares the Sum of Squared Differences (SSD) for different cluster solutions. Therefore the SSD is plotted against the numbers of Cluster in the analysis and an optimal number of clusters is determined by identifying the “elbow” in the plot (e.g. here: <a href=\"https://en.wikipedia.org/wiki/File:DataClustering_ElbowCriterion.JPG\" rel=\"nofollow\">https://en.wikipedia.org/wiki/File:DataClustering_ElbowCriterion.JPG</a>)\nThis method is a first approach to get a subjective impression. Therefore I’d like to implement it in R. The information on the internet on this is sparse. There is one good example here: <a href=\"http://www.mattpeeples.net/kmeans.html\" rel=\"nofollow\">http://www.mattpeeples.net/kmeans.html</a> where the author also did an interesting iterative approach to see if the elbow is somehow stable after several repetitions of the clustering process (nevertheless it is for partitioning cluster methods not for hierarchical). \nOther methods in Literature comprise the so called “stopping rules”. MILLIGAN &amp; COOPER compared 30 of these stopping rules in their paper “An examination of procedures for determining the number of clusters in a data set” (available here: <a href=\"http://link.springer.com/article/10.1007%2FBF02294245\" rel=\"nofollow\">http://link.springer.com/article/10.1007%2FBF02294245</a>) finding that the Stopping Rule from Calinski and Harabasz provided the best results in a Monte Carlo evaluation. Information on implementing this in R is even sparser. \nSo if anyone has ever implemented this or another Stopping rule (or other method) some advice would be very helpful.</p></li>\n<li><p><strong>Statistically describe the clusters</strong>:For describing the clusters I thought of using the mean and some sort of Variance Criterion. My data is on agricultural land-use and shows the production numbers of different crops per Municipality. My aim is to find similar patterns of land-use in my dataset. </p></li>\n</ol>\n\n<p>I produced a script for a subset of objects to do a first test-run. It looks like this (explanations on the steps within the script, sources below).  </p>\n\n<pre><code>    #Clusteranalysis agriculture\n\n    #Load data\n    agriculture &lt;-read.table (\"C:\\\\Users\\\\etc...\", header=T,sep=\";\")\n    attach(agriculture)\n\n    #Define Dataframe to work with\n    df&lt;-data.frame(agriculture)\n\n    #Define a Subset of objects to first test the script\n    a&lt;-df[1,]\n    b&lt;-df[2,]\n    c&lt;-df[3,]\n    d&lt;-df[4,]\n    e&lt;-df[5,]\n    f&lt;-df[6,]\n    g&lt;-df[7,]\n    h&lt;-df[8,]\n    i&lt;-df[9,]\n    j&lt;-df[10,]\n    k&lt;-df[11,]\n    #Bind the objects\n    aTOk&lt;-rbind(a,b,c,d,e,f,g,h,i,j,k)\n\n    #Calculate euclidian distances including only the columns 4 to 24\n    dist.euklid&lt;-dist(aTOk[,4:24],method=\"euclidean\",diag=TRUE,upper=FALSE, p=2)\n    print(dist.euklid)\n\n    #Cluster with Ward\n    cluster.ward&lt;-hclust(dist.euklid,method=\"ward\")\n\n    #Plot the dendogramm. define Labels with labels=df$Geocode didn't work\n    plot(cluster.ward, hang = -0.01, cex = 0.7)\n\n    #here are missing methods to determine the optimal number of clusters\n\n    #Calculate different solutions with different number of clusters\n    n.cluster&lt;-sapply(2:5, function(n.cluster)table(cutree(cluster.ward,n.cluster)))\n    n.cluster\n\n    #Show the objects within clusters for the three cluster solution\n    three.cluster&lt;-cutree(cluster.ward,3)\n    sapply(unique(three.cluster), function(g)aTOk$Geocode[three.cluster==g])\n\n    #Calculate some statistics to describe the clusters\n    three.cluster.median&lt;-aggregate(aTOk[,4:24],list(three.cluster),median)\n    three.cluster.median\n    three.cluster.min&lt;-aggregate(aTOk[,4:24],list(three.cluster),min)\n    three.cluster.min\n    three.cluster.max&lt;-aggregate(aTOk[,4:24],list(three.cluster),max)\n    three.cluster.max\n    #Summary statistics for one variable\n    three.cluster.summary&lt;-aggregate(aTOk[,4],list(three.cluster),summary)\n    three.cluster.summary\n\n    detach(agriculture)\n</code></pre>\n\n<p><strong>Sources</strong>:</p>\n\n<ul>\n<li><a href=\"http://www.r-tutor.com/gpu-computing/clustering/distance-matrix\" rel=\"nofollow\">http://www.r-tutor.com/gpu-computing/clustering/distance-matrix</a></li>\n<li><a href=\"http://stackoverflow.com/questions/5648383/how-to-apply-a-hierarchical-or-k-means-cluster-analysis-using-r/5648425#5648425\">How to apply a hierarchical or k-means cluster analysis using R?</a></li>\n<li><a href=\"http://statistics.berkeley.edu/classes/s133/Cluster2a.html\" rel=\"nofollow\">http://statistics.berkeley.edu/classes/s133/Cluster2a.html</a></li>\n</ul>\n"},{"tags":["r","plot"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":71,"score":4,"question_id":13239986,"title":"Avoid wasting space when placing multiple aligned plots onto one page","body":"<p>I'd like to place four plots onto a single page. Axis labels should be printed only at the very rim, i.e. <em>x</em> axis labels for the bottom diagrams only, and <em>y</em> axis labels for the left diagrams only. This goes both for the name of the axis as a whole and the individual tick marks. I can generate something along these lines using the following code:</p>\n\n<pre><code>pdf(file = \"ExampleOutput.pdf\",\n    width = 6.61,\n    height = 6.61,\n    pointsize = 10\n    )\nset.seed(42)\ncatA &lt;- factor(c(\"m100\", \"m500\", \"m1000\", \"m2000\", \"m3000\", \"m5000\"))\ncatB &lt;- factor(20:28)\nsamples &lt;- 100\nrsample &lt;- function(v) v[ceiling(runif(samples, max=length(v)))]\nTab &lt;- data.frame(catA = rsample(catA),\n                  catB = rsample(catB),\n                  valA = rnorm(samples, 150, 8),\n                  valB = pmin(1,pmax(0,rnorm(samples, 0.5, 0.3))))\npar(mfrow = c(2,2))\nfor (i in 0:3) {\n  x &lt;- Tab[[1 + i %% 2]]\n  plot(x, Tab[[3 + i %/% 2]],\n       xlab = if (i %/% 2 == 1) \"Some Categories\" else NULL,\n       ylab = if (i %% 2 == 0) \"Some Values\" else NULL,\n       axes = FALSE\n       )\n  axis(side = 1,\n       at=1:nlevels(x),\n       labels = if (i %/% 2 == 1) levels(x) else FALSE)\n  axis(side = 2, labels = (i %% 2 == 0))\n  box(which = \"plot\", bty = \"l\")\n}\npar(mfrow = c(1,1))\ndev.off()\n</code></pre>\n\n<p>I'll welcome suggestions for how to improve my ploting commands, perhaps avoid draing the axes and the L in the lower left corner manually. But that's only a besides.</p>\n\n<p>The result of this sequence looks like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/0dCA6.png\" alt=\"Current output\"></p>\n\n<p>The problem here is the <em>huge</em> amount of wasted whitespace. I have the impression that R reserves space for axis and tick labels even if they are not used. As a consequence of this wasted space, for the left bottom diagram, only every second <em>x</em> tick actually gets labeled, which is really bad here.</p>\n\n<p>I'd like to generate a similar plot without that much white space. The actual plots should be the same size, so they line up properly, but the space for the labels should be only at the outside. I imagine a layout like this (mockup created in GIMP):</p>\n\n<p><img src=\"http://i.stack.imgur.com/78N1R.png\" alt=\"Desired output\"></p>\n\n<p>How can I achieve such a layout?</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":253,"score":4,"question_id":5478508,"title":"Encoding whole numbers in R to a base 62 character vector","body":"<p>What's a quick way to encode either integer values or numeric whole number values in R to a character vector in base 62 encoding, i.e. a string that only contains [a-zA-Z0-9]? Would translating the answer to this question be sufficient?\n<a href=\"http://stackoverflow.com/questions/4964197/converting-a-number-base-10-to-base-62-a-za-z0-9\">converting a number base 10 to base 62 (a-zA-Z0-9)</a></p>\n\n<p><strong>Edited</strong></p>\n\n<p>Here's my solution:</p>\n\n<pre><code>toBase &lt;- function(num, base=62) {\n    bv &lt;- c(seq(0,9),letters,LETTERS)\n    r &lt;- num %% base\n    res &lt;- bv[r+1]\n    q &lt;- floor(num/base)\n    while (q &gt; 0L) {\n        r &lt;- q %% base\n        q  &lt;- floor(q/base)\n        res &lt;- paste(bv[r+1],res,sep='')\n    }\n    res\n} \nto10 &lt;- function(num, base=62) {\n    bv &lt;- c(seq(0,9),letters,LETTERS)\n    vb &lt;- list()\n    for (i in 1:length(bv)) vb[[bv[i]]] &lt;- i\n    num &lt;- strsplit(num,'')[[1]]\n    res &lt;- vb[[num[1]]]-1\n    if (length(num) &gt; 1)\n         for (i in 2:length(num)) res &lt;- base * res + (vb[[num[i]]]-1)\n    res\n}\n</code></pre>\n\n<p>Is that missing anything?</p>\n"},{"tags":["r","simulation","spatial","truncated"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13255163,"title":"How to generate a random field with truncated marginal distributions?","body":"<p>Is there an R package or functions which can generate a random field with truncated distributions?</p>\n\n<p>I am trying to simulate a lognormal spatial random field but I need the simulated value in a certain range. So I need some easy to use functions to generate a truncated Gaussian field to start with. To be specific, I need a function like <code>GaussRF</code> from the RandomFields package or <code>grf</code> from the geoR package to generate a random field with truncated marginal distributions and a correlation structure with a specified range direclty.</p>\n\n<p>If there is no availabe read-to-use functions or packages,is it possible that I write my own very easily?</p>\n"},{"tags":["r","lattice","levelplot"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":1,"view_count":64,"score":4,"question_id":13251200,"title":"R levelplot and interpolation","body":"<p>some days ago I managed to make levelplots, with interpolation, with the following command within a script:</p>\n\n<pre><code>levelplot(jan~lon*lat,APM,main=\"Jan\",panel=panel.levelplot.raster,interpolate=T)\n</code></pre>\n\n<p>I accidentaly did not keep that session, only the script, so it is not possible for me to go through the history and recover all the commands I had used.</p>\n\n<p>Now, after loading latticeExtra, the same command produces an empty plot. On the other hand, leaving out the last two elements of the instruction, i.e.:</p>\n\n<pre><code>levelplot(jan~lon*lat,APM,main=\"Jan\")\n</code></pre>\n\n<p>The graph is drawn.</p>\n\n<p>I'd like to have interpolation at the surface, but something is going wrong with</p>\n\n<pre><code>panel=panel.levelplot.raster\n</code></pre>\n\n<p>the same behaviour happens when rasterVis is loaded.\nI guess I am missing something... any help?</p>\n\n<p>The data has the following structure:</p>\n\n<pre><code>&gt; head(APM)\n    lat  lon  jan  feb  mar  apr  may  jun   jul   aug  sep  oct  nov  dec\n1 -18.5 10.5 29.7 28.8 25.6 25.6 26.8 29.9  35.5  46.8 35.5 27.5 27.5 27.9\n2 -17.5 10.5 28.8 29.8 26.3 26.2 27.8 31.6  39.7  63.1 40.4 27.6 27.6 28.3\n3 -16.5 10.5 28.7 30.0 26.9 26.8 28.6 32.1  41.1 109.4 42.8 29.7 28.9 29.4\n4 -15.5 10.5 28.4 29.5 27.5 26.9 29.1 34.2  46.4 109.5 40.8 29.7 29.7 28.5\n5 -14.5 10.5 28.2 29.3 27.4 27.8 27.8 42.8  60.7 104.3 49.1 29.4 28.8 28.6\n6 -13.5 10.5 27.8 28.4 27.7 28.3 29.8 41.2 102.8 105.7 47.8 29.5 28.5 28.0\n</code></pre>\n\n<p>totalling 224 cells listed by latitude and longitude:</p>\n\n<pre><code>&gt; dput(APM)\nstructure(list(lat = c(-18.5, -17.5, -16.5, -15.5, -14.5, -13.5, \n-12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -18.5, -17.5, \n-16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, \n-7.5, -6.5, -5.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, \n-11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -18.5, -17.5, -16.5, \n-15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, \n-5.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, \n-10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -18.5, -17.5, -16.5, -15.5, \n-14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, \n-18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, \n-9.5, -8.5, -7.5, -6.5, -5.5, -18.5, -17.5, -16.5, -15.5, -14.5, \n-13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -18.5, \n-17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, \n-8.5, -7.5, -6.5, -5.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, \n-12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -18.5, -17.5, \n-16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, \n-7.5, -6.5, -5.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, \n-11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -18.5, -17.5, -16.5, \n-15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, \n-5.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, \n-10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -18.5, -17.5, -16.5, -15.5, \n-14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, \n-18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, \n-9.5, -8.5, -7.5, -6.5, -5.5), lon = c(10.5, 10.5, 10.5, 10.5, \n10.5, 10.5, 10.5, 10.5, 10.5, 10.5, 10.5, 10.5, 10.5, 10.5, 11.5, \n11.5, 11.5, 11.5, 11.5, 11.5, 11.5, 11.5, 11.5, 11.5, 11.5, 11.5, \n11.5, 11.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5, \n12.5, 12.5, 12.5, 12.5, 12.5, 13.5, 13.5, 13.5, 13.5, 13.5, 13.5, \n13.5, 13.5, 13.5, 13.5, 13.5, 13.5, 13.5, 13.5, 14.5, 14.5, 14.5, \n14.5, 14.5, 14.5, 14.5, 14.5, 14.5, 14.5, 14.5, 14.5, 14.5, 14.5, \n15.5, 15.5, 15.5, 15.5, 15.5, 15.5, 15.5, 15.5, 15.5, 15.5, 15.5, \n15.5, 15.5, 15.5, 16.5, 16.5, 16.5, 16.5, 16.5, 16.5, 16.5, 16.5, \n16.5, 16.5, 16.5, 16.5, 16.5, 16.5, 17.5, 17.5, 17.5, 17.5, 17.5, \n17.5, 17.5, 17.5, 17.5, 17.5, 17.5, 17.5, 17.5, 17.5, 18.5, 18.5, \n18.5, 18.5, 18.5, 18.5, 18.5, 18.5, 18.5, 18.5, 18.5, 18.5, 18.5, \n18.5, 19.5, 19.5, 19.5, 19.5, 19.5, 19.5, 19.5, 19.5, 19.5, 19.5, \n19.5, 19.5, 19.5, 19.5, 20.5, 20.5, 20.5, 20.5, 20.5, 20.5, 20.5, \n20.5, 20.5, 20.5, 20.5, 20.5, 20.5, 20.5, 21.5, 21.5, 21.5, 21.5, \n21.5, 21.5, 21.5, 21.5, 21.5, 21.5, 21.5, 21.5, 21.5, 21.5, 22.5, \n22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, 22.5, \n22.5, 22.5, 23.5, 23.5, 23.5, 23.5, 23.5, 23.5, 23.5, 23.5, 23.5, \n23.5, 23.5, 23.5, 23.5, 23.5, 24.5, 24.5, 24.5, 24.5, 24.5, 24.5, \n24.5, 24.5, 24.5, 24.5, 24.5, 24.5, 24.5, 24.5, 25.5, 25.5, 25.5, \n25.5, 25.5, 25.5, 25.5, 25.5, 25.5, 25.5, 25.5, 25.5, 25.5, 25.5\n), jan = c(29.7, 28.8, 28.7, 28.4, 28.2, 27.8, 28, 29.4, 30.3, \n32.5, 33.2, 33.5, 33.1, 34.3, 28.4, 29.4, 29.6, 29, 28.9, 28.8, \n28.5, 28.9, 29.9, 31, 32.2, 32.9, 35.8, 37.4, 30, 27.4, 29.6, \n30, 28.4, 30.6, 30.4, 29.9, 30.2, 31.3, 33.9, 35.5, 35.8, 34.5, \n30.3, 23.8, 25.2, 23.2, 22.9, 24, 27.2, 29.3, 31.6, 32.3, 31, \n31.4, 37.3, 37.4, 24.9, 25.1, 23.4, 21.2, 23.5, 22.8, 23.5, 24.5, \n26, 27.7, 28.6, 33.3, 37.3, 40.7, 37.9, 38.5, 27.1, 22.5, 24.7, \n23.3, 24.7, 24.8, 26.6, 27.4, 30.7, 33.9, 35.9, 37.6, 30.7, 29.5, \n26.6, 24.1, 24.1, 25.4, 25.4, 25.7, 28, 28.2, 32.9, 36.3, 35.2, \n40.4, 22.7, 25.5, 26.5, 24.6, 24.3, 24, 25.8, 26.7, 29.4, 31.8, \n35.4, 38, 37.4, 41.3, 22.2, 23.7, 26.8, 25.8, 25.3, 24, 25.1, \n26.9, 29.6, 31.8, 34.4, 35.6, 39.3, 40.1, 26.2, 26.2, 26, 25.8, \n25.3, 23.2, 24.5, 25.9, 26.9, 30.8, 33.3, 38.3, 40.2, 41.2, 26.9, \n26.4, 27.1, 23.1, 22.9, 24, 28.5, 26.9, 27.1, 31, 32.7, 36.6, \n38, 41.6, 26.6, 27.2, 27.3, 26, 23.6, 25.8, 33.2, 33.8, 25.8, \n28.1, 31.6, 34.7, 35.3, 38.5, 27.3, 28.1, 28.6, 27, 31.5, 31.8, \n29.9, 27.6, 25.4, 28.4, 29.8, 32.2, 36.4, 36.8, 28.2, 26.2, 27.3, \n27, 27.1, 23.7, 23.5, 25.3, 26.1, 29, 29.3, 29.3, 36.4, 35.1, \n24.2, 25.1, 23.5, 23.1, 24, 24.2, 24.3, 26.7, 26.7, 26.8, 29.3, \n30.4, 33.3, 33.4, 24.8, 24.3, 24.5, 24.8, 26.1, 24.6, 25, 25.3, \n27.2, 26.8, 28.9, 30.5, 31.2, 33.1), feb = c(28.8, 29.8, 30, \n29.5, 29.3, 28.4, 28.6, 28.7, 28.7, 28.5, 29.4, 32.2, 34.4, 37.4, \n29.4, 30.5, 30.8, 30.7, 29.6, 28.3, 28, 28.4, 28.4, 29, 29.5, \n31.4, 33.3, 37.1, 31.7, 26.5, 29.8, 30.4, 28.4, 28.9, 27.7, 27.8, \n29.3, 30, 30.4, 31.7, 32.9, 34.7, 29.1, 23.5, 24.2, 23.3, 22.7, \n23.6, 25.4, 26.4, 27.7, 28.1, 26.9, 27.5, 30.4, 31.6, 22.3, 24.7, \n23.7, 21.2, 23.4, 22.5, 22.3, 21.7, 23.2, 23.3, 23.2, 27.5, 31.6, \n34, 33, 33.3, 26.3, 22.5, 23.9, 24, 24.5, 23.7, 24.2, 24.5, 25.4, \n27.8, 31, 33.4, 29.3, 27.5, 24.7, 23.2, 23.5, 24.7, 25.7, 25.4, \n25.8, 25.6, 27.2, 30.7, 30.4, 35, 21.4, 23.3, 24.1, 24.7, 25.2, \n25.2, 25.6, 25.9, 27.7, 26.9, 30.1, 31.5, 32, 34.5, 20.2, 22.4, \n24.9, 25.1, 25.3, 25.5, 24.1, 25.8, 26.2, 28.4, 29.3, 30.9, 33.5, \n35.6, 24.3, 24.2, 24, 24.5, 24.9, 24.7, 23.8, 25, 26.2, 27.1, \n29.9, 31.3, 34.6, 34.7, 25.3, 23.6, 24.9, 22.6, 23.1, 23.1, 25.3, \n26.8, 24.9, 25.1, 28.1, 30.7, 32.1, 34.2, 24, 23.4, 24.6, 25.6, \n24.9, 26.4, 30.6, 31.2, 22.2, 23.9, 27.6, 30.8, 29.1, 29.7, 24, \n23.6, 25.4, 25.8, 29.9, 29.5, 27.2, 26.3, 23.5, 24.5, 25.6, 27, \n28.9, 28.3, 24.4, 22, 23.4, 24.9, 25.4, 22.7, 23, 23, 22.4, 23.7, \n24.6, 24.9, 29.8, 28.5, 21.3, 22.8, 21.3, 21.1, 21.7, 22.8, 24.4, \n23.2, 23.3, 22.4, 25.4, 26.3, 27.3, 27.1, 22.8, 22.1, 21.4, 21.9, \n24.1, 24.1, 26, 23.5, 23.8, 22.5, 23, 24.9, 26.5, 28)), .Names = c(\"lat\", \n\"lon\", \"jan\", \"feb\"), row.names = c(NA, \n-224L))\n</code></pre>\n"},{"tags":["r","data.frame"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13258444,"title":"split data frame into smaller data frames","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3302356/r-language-how-to-split-a-data-frame\">R language: how to split a data frame</a>  </p>\n</blockquote>\n\n\n\n<p>I have the following data.frame:</p>\n\n<pre><code>set.seed(10)\nRandData &lt;- rnorm(8760*2)\nAmerica &lt;- rep(c('NewYork','Miami'),each=8760)\n\nDate = seq(from=as.POSIXct(\"1991-01-01 00:00\"), \n           to=as.POSIXct(\"1991-12-31 23:00\"), length=8760)\n\nDatNew &lt;- data.frame(Loc = America,\n                     Month = as.numeric(format(Date, format = \"%m\")),\n                     Doy = as.numeric(format(Date,format = \"%j\")),\n                     Tod = as.numeric(format(Date,format = \"%H\")),\n                     Temp = RandData,\n                     DecTime = rep(seq(1, length(RandData)/2) / (length(RandData)/2),\n                                   2))\n</code></pre>\n\n<p>I would like to split this into 4 smaller data frames, representing different seasons of the year (spring (months 3-5), summer (months 6-8), autumn (months 9-11), winter (months 12,1,2)), how can this be achieved? </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13258020,"title":"Change letter case of column names","body":"<p>I have a large number of data sets each containing a long list of column names.  In some files the column names are all capital letters and in some files only the first letter of the column names is capitalized.  I need to append the data sets and thought the easiest way to match column names among data sets would be to convert the all-capital names into names with only the first letter capitalized.</p>\n\n<p>I am hoping to find a general solution, maybe even a one-liner.</p>\n\n<p>Here is my example data set.  The desired names are included in the <code>names</code> statements.</p>\n\n<pre><code>my.data2 &lt;-  \"\nlanduse units grade CLAY    LINCOLN  BASINANDRANGE  MCCARTNEY  MAPLE\napple   acres AAA     0         2          3             4         6\napple   acres AA   1000       900         NA            NA       700\npear    acres AA   10.0        20         NA          30.0        40\npeach   acres AAA   500       400        350           300       200\n\"\nmy.data2 &lt;- read.table(textConnection(my.data2), header=TRUE)\n\nnames(my.data2)[names(my.data2)==\"CLAY\"]            &lt;- \"Clay\"\nnames(my.data2)[names(my.data2)==\"BASINANDRANGE\"]   &lt;- \"BasinandRange\"\nnames(my.data2)[names(my.data2)==\"LINCOLN\"]         &lt;- \"Lincoln\"\nnames(my.data2)[names(my.data2)==\"MCCARTNEY\"]       &lt;- \"McCartney\"\nnames(my.data2)[names(my.data2)==\"MAPLE\"]           &lt;- \"Maple\"\n\nmy.data2\n</code></pre>\n\n<p>Note that I included the names <code>McCartney</code> and <code>BasinandRange</code> to make things more realistic and more difficult.  However, if I can find a one-liner to deal with 95% of the names and use the above <code>names</code> statements to deal with complications like <code>McCartney</code> and <code>BasinandRange</code> that would be great.</p>\n\n<p>I have searched the internet, including the StackOverflow archives, without finding a solution.  Sorry if I overlooked one.  Thank you for any help.</p>\n"},{"tags":["r","plot","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13255036,"title":"How to place text after symbol in auto.key (lattice)?","body":"<p>When using <code>auto.key</code> in <code>lattice</code>, can I swap the default positions of symbols and text? That is, I'd like the text in the legend to be on the right side with respect to the symbols. I know this is easy to do with <code>key</code>, but separately linking colours with groups for each plot isn't only tedious, but also very error-prone.</p>\n"},{"tags":["r","package"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":47,"score":3,"question_id":13254595,"title":"R Package with Large Size External Assets","body":"<p>This is a followup to a <a href=\"http://stackoverflow.com/questions/11314342/managing-external-assets-in-r-package\">question</a> I posted earlier. To summarize, I am writing an R Package called Slidify, which makes use of several external non-R based libraries. My earlier question was about how to manage dependencies.</p>\n\n<p>Several solutions were proposed, of which the most attractive solution was to package the external libraries as a different R package, and make it a dependency for Slidify. This is the strategy followed by the package <code>xlsx</code>, which packages the java dependencies as a different package <code>xlsxjars</code>.</p>\n\n<p>An alterative is for me to provide the external libraries as a download and package a <code>install_libraries</code> function within Slidify, which would automatically fetch the required files and download it into the package directory. I can also add an <code>update_libraries</code> function which would update if things change.  </p>\n\n<p>My question is, are there any specific advantages to doing the CRAN dance for external libraries which are not R based. Am I missing something here?</p>\n"},{"tags":["git","r"],"answer_count":2,"favorite_count":1,"up_vote_count":22,"down_vote_count":0,"view_count":240,"score":22,"question_id":11314342,"title":"Managing External Assets in R Package","body":"<p>I am writing an R package called <code>slidify</code> which makes it easy to generate reproducible HTML5 slides from R Markdown files. The package makes use of <code>css</code> and <code>js</code> files from several existing HTML5 slide generation frameworks like <code>dzslides</code>, <code>deck.js</code> etc. Currently, I have organized the downloaded versions of these external assets in the <code>inst/libraries</code> folder of <code>slidify</code>, so that it is automatically available for users upon installation. While this approach is simple, there are some disadvantages:</p>\n\n<ol>\n<li><p>These frameworks are constantly updated on <code>github</code>. Under the current setup, I would have to push a new version of the package everytime any of these frameworks are updated.</p></li>\n<li><p>If I make any tweaks to the default <code>css</code> and <code>js</code> that come with these frameworks, then I need to merge the updates carefully so that I don't lose <code>slidify</code> specific customizations.</p></li>\n</ol>\n\n<p>I had a couple of thoughts on how to manage this.</p>\n\n<ol>\n<li><p>Don't package these libraries with <code>slidify</code>. Instead, provide a <code>function</code> that would allow users to add the frameworks they desire.</p></li>\n<li><p>Add these frameworks to the <code>inst\\libraries</code> folder on <code>slidify</code>, but as <code>submodules</code>. Now, I have no idea if adding them as <code>submodules</code> would get them installed if someone were to use <code>devtools::install_github</code>.</p></li>\n</ol>\n\n<p><strong>So my question is, when writing an R package how can I manage external non-R dependencies which are updated constantly?</strong></p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":678,"score":5,"question_id":9555889,"title":"Producing a vector graphics image (i.e. metafile) in R suitable for printing in Word 2007","body":"<p>First a caveat:  I posted this question <a href=\"http://superuser.com/questions/396582/incorporating-vector-graphics-metafile-figures-from-r-into-microsoft-word-2007\">here</a> on SuperUser, but it is clearly the wrong place to ask R questions.  I recognize that it is not directly a programming question, but I believe it can be solved by changing how plots are produced (i.e. by coding appropriately).  So I hope readers find this appropriate for the forum.</p>\n\n<p>R plots usually consist entirely of vector graphics elements (i.e. points, lines, polygons, text).  R permits you to save your figure (or copy-paste) in various formats including various raster formats, as a PDF, or as a Windows meta-file.</p>\n\n<p>I usually save my images as PDFs and print them. This renders the images exactly as I intended them on paper, in the highest quality. I avoid raster formats (e.g. JPG, TIFF) for printing as inevitably the quality is poorer and publishers prefer vector formats.</p>\n\n<p>However, I need to make a large multi-page desktop published document using Microsoft Word 2007, and therefore using PDFs is not an option. When I import my figures from meta-files, or copy and paste directly from R into Word both the screen and print rendering of the image changes slightly (e.g. polygons and their fills become slightly misaligned).</p>\n\n<p>Given that I want to retain high vector quality (and not use raster formats), what can I do to make R vector graphics work with Word?  (Of course Sweave and LaTeX would be nice, but again, not a realistic option).</p>\n\n<p>Consider this example:</p>\n\n<pre><code>plot(c(1:100), c(1:100), pch=20)\n## Copy and paste to Word 2007 as Windows metafile\n## Print\n## Quality is poorer (e.g. dot fills misaligned with borders)\n\npdf(\"printsPerfectly.pdf\")\nplot(c(1:100), c(1:100), pch=20)\ndev.off()\n## Now print PDF\n## Quality is as expected\n</code></pre>\n\n<p>EDIT:  Further to suggestions by @John I produced it as an EPS postscript file (see below), inserted it as a picture into Word.  Because ultimately it will be printed from a PDF created from Word, I converted it to a PDF using default Word 2007 settings, printed it on my HP Laserjet P1606dn laser printer, and then took aphotograph to illustrate the issue of polygons borders and fills misaligning (image on left, below).  I also produced it directly as PDF from R using <code>pdf()</code> and printed the PDF and took a photograph (image on right, below).</p>\n\n<p><img src=\"http://i.stack.imgur.com/53elG.jpg\" alt=\"Illustration of misalignment (left) and perfection (right)\"></p>\n\n<p>It may seem like small potatoes!  But when you have gone to a lot of trouble to achieve high quality, it is disappointing to be thwarted at the end.  In addition, it is not really obvious here, but the numerals are not as high-quality (left) as in the PDF (right), disregarding differences in focus on the photograph.</p>\n"},{"tags":["r"],"answer_count":5,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":64,"score":2,"question_id":13253142,"title":"change function argument name","body":"<p>How to change function argument name. For example using substitute I can change function argument value or function name:</p>\n\n<pre><code>substitute(quote(F(x= A)), list(A= quote(B), F= quote(G)))\n## result\nquote(G(x = B))\n</code></pre>\n\n<p>but this doesn't work:</p>\n\n<pre><code>substitute(quote(F(x= A)), list(x= quote(y)))\n## result\nquote(F(x = A))\n</code></pre>\n\n<p>#\n EDIT (@Joran here is real example, maybe not so real but very close to what I am doing)</p>\n\n<h1> </h1>\n\n<p>#</p>\n\n<pre><code>library(\"multcomp\")\ndata(\"mtcars\")\n\nmtcars$gear &lt;- factor(mtcars$gear)\nmtcars$cyl &lt;- factor(mtcars$cyl)\nxv &lt;- c(\"gear\",\"cyl\")\n\nfor(v in xv){\n fo &lt;- as.formula(paste(\"mpg\",v,sep=\"~\"))\n fit &lt;- lm(fo,data=mtcars)\n print(eval(substitute(summary(glht(fit,linfct= mcp(vn=\"Dunnett\"))),list(vn=v))))\n}\n</code></pre>\n"},{"tags":["r","plot","frame"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13255527,"title":"manually create a plot frame in R","body":"<p>I need to control the style of a basic xy plot in R, and so have build the plotting area like this:</p>\n\n<pre><code>frame()\nplot.window(xlim=c(0,1), ylim=c(-.6, .8))\naxis(1, at=c(0, .2, .4, .6, .8, 1.0), lwd=2)\naxis(2, at=c(-.6, -.4, -.2, 0, .2, .4, .6, .8), lwd=2)\n</code></pre>\n\n<p>I cannot, however, figure out how to create a physical frame around this plot (with lwd = 2). Is it possible (necessary?) to use <code>line()</code> or <code>polygon()</code>? Or is there something more built-in for this?</p>\n\n<p>I'm also interested in how to change the frame and axis weights for a plot created using the <code>plot()</code> function. </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13242024,"title":"Windows 7: Installing multiple R packages via script","body":"<p>I am trying to script the installation of R 2.15.1 on Windows 7.  R installs just fine, but I cannot figure out how to install multiple packages from the same batch script (or any batch script, for that matter).  Below is the part of the script where I call a simple R file.</p>\n\n<pre><code>\"%ProgramFiles%\\R\\R-2.15.1\\bin\\R.exe\" CMD BATCH \"%~dp0R packages for GME.R\"\n</code></pre>\n\n<p>Here is the contents of \"R packages for GME.R\" that has the packages to install.</p>\n\n<pre><code>install.packages(\"CircStats\",\"coda\",\"deldir\",\"gplots\",\"igraph\",\"ks\",\"odesolve\",\"RandomFields\",dep=TRUE)\n</code></pre>\n\n<p>Given <a href=\"http://cran.r-project.org/bin/windows/base/rw-FAQ.html#Does-R-run-under-Windows-Vista_003f\" rel=\"nofollow\">documented ownership and ACLs issues with writing to the default library folder in Windows</a>, I've tried the following:</p>\n\n<ol>\n<li>Taking ownership of \"C:\\Program Files\\R\\R-2.15.1\\library\", then running <code>R CMD BATCH &lt;file&gt;</code> (no change);</li>\n<li>Giving \"Full Control\" permissions to my user account on the same folder, then running <code>R CMD BATCH &lt;file&gt;</code> (no change);</li>\n<li>Changing the library folder to another location via Rprofile.site, then running <code>R CMD BATCH &lt;file&gt;</code> (no change);</li>\n<li>Running command via Rgui <code>install.packages(\"CircStats\",\"coda\",\"deldir\",\"gplots\",\"igraph\",\"ks\",\"odesolve\",\"RandomFields\",dep=TRUE)</code> (works).</li>\n</ol>\n\n<p>So far, I have had no luck using CMD or batch scripts to install packages.  Is there something I'm missing?  Any alternative ways of scripting package installation would be greatly appreciated.</p>\n\n<p>Also, the machines I will be installing on are for multiple users, so system-wide installations and configurations are preferred.</p>\n\n<p>//</p>\n\n<p>Edit 2012-11-06:\nHere is the error message from the .Rout file:</p>\n\n<pre><code>install.packages(\"CircStats\",\"coda\",\"deldir\",\"gplots\",\"igraph\",\"ks\",\"odesolve\",\"RandomFields\",dep=TRUE)\nWarning in install.packages(\"CircStats\", \"coda\", \"deldir\", \"gplots\", \"igraph\",  :\n  'lib = \"coda\"' is not writable\nError in install.packages(\"CircStats\", \"coda\", \"deldir\", \"gplots\", \"igraph\",  : \n  unable to install packages\nExecution halted\n</code></pre>\n\n<p>If I execute <code>library(coda)</code> afterwards, it gives <code>Error in library(coda) : there is no package called ‘coda’</code>.</p>\n"},{"tags":["r","date","google-visualization"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":113,"score":1,"question_id":10486052,"title":"TimeVar Date for googlVis MotionChart R","body":"<p>Here is my code:</p>\n\n<pre><code>ages &lt;- c(\"12\", \"13\", \"14\", \"15\", \"16\", \"17\") #building a dataframe        \nsubjects &lt;- rep(ages, 9)\ndate &lt;- c(\"2008-05-01\",\"2008-06-01\", \"2008-07-01\", \"2008-08-01\", \"2008-09-01\", \"2008-10-01\", \"2008-11-01\", \"2008-12-01\", \"2009-01-01\")\ndate.class &lt;- as.Date(rep(date, rep(6, length(date))))\nval1 &lt;- rnorm(54) \nval2 &lt;- rnorm(54)\nval3 &lt;- rnorm(54)\nval4 &lt;- rnorm(54)\nDF &lt;- data.frame(Subject = subjects, \n                 Date = date.class, \n                 Val1 = val1, \n                 Val2 = val2, \n                 Val3 = val3, \n                 Val4 = val4)\n\nlibrary(googleVis) \nM &lt;- gvisMotionChart(DF, idvar = \"Subject\", timevar = \"Date\")\nplot(M)\n</code></pre>\n\n<p>I would like the time variable slider in the plot to only show the <code>MONTHLY</code> dates which occur in my <code>DF</code>. For example, as time progresses, I want to only to see \"5/1/2008\", \"6/1/2008\", etc. googleVis for some reason wants to create a finer mesh of for the time slider and instead displays \"5/1/2008\", \"5/2/2008\", ... \"5/31/2008\", \"6/1/2008, \"6/2/2008\", etc. \nI've tried messing with the 'date.format' option in the 'gvisMotionChart' function. </p>\n\n<p>help(gvisMotionChart)</p>\n\n<p>But I've had no luck. Does anyone have a solution?</p>\n"},{"tags":["r","time-series"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":62,"score":6,"question_id":13241212,"title":"How can I create a column that indicates the observation's lag from another observation in R?","body":"<p>I have dataframe d with a Boolean variable event indicating whether a certain event occurred on a given date.  I want to create a new variable that indicates how many observations (days) away the closest event is.</p>\n\n<pre><code>d=structure(list(date = structure(c(-365, -364, -363, -362, -361, \n-360, -359, -358, -357, -356, -355, -354, -353, -352, -351, -350, \n-349, -348, -347, -346), class = \"Date\"), event = c(TRUE, \nFALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, \nFALSE, FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, \nFALSE)), .Names = c(\"date\", \"event\"), row.names = c(NA, 20L\n), class = \"data.frame\")\n</code></pre>\n\n<p>Is there a function that will do this?</p>\n"},{"tags":["r","web-scraping"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":58,"score":3,"question_id":13252231,"title":"Web scraping requiring a mouse click?","body":"<p>I am trying (in R) to scrape some data from:</p>\n\n<p><a href=\"http://www.soccerbase.com/matches/results.sd?date=2012-11-04\" rel=\"nofollow\">http://www.soccerbase.com/matches/results.sd?date=2012-11-04</a></p>\n\n<p>namely, I want to get the match details which appear on the page when you press the <em>i</em> button. However, the information that appears having clicked on the button is not contained in the original html code. All I can see is a line (where I expected the data to be contained)...</p>\n\n<pre><code>&lt;span class=\"infoField\"&gt;&lt;a href=\"#\" class=\"info finished\" title=\"Show full match details\"&gt;&lt;/a&gt;&lt;/span&gt;\n</code></pre>\n\n<p>...which pretty much leaves me at a dead end...any ideas?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13241726,"title":"How to use system() in R?","body":"<p>I want to invoke a system command to change directory in R console.</p>\n\n<p>For example,</p>\n\n<pre><code>system(paste('\"cd C:/Users/Dropbox/RPackages\"'),intern = TRUE)\nsystem(paste('\"R CMD build test\"'))\nsystem(paste('\"R CMD check test\"'))\nsystem(paste('\"R CMD INSTALL test\"'))\nlibrary(test)\n</code></pre>\n\n<p>These commands are supposed to run in Windows Command Prompt. But I want to bury them inside the RGUI script file to allow the change of parameters by users before wrap it into a Package.The error message I got from R console is</p>\n\n<pre><code>Error in system(paste(\"\\\"cd C:/Users/Dropbox/RPackages\"\\\"\"), intern = TRUE) : \n'\"cd C:/Users/Dropbox/RPackages\"' not found\n</code></pre>\n\n<p>I also tried </p>\n\n<pre><code>system(\"cd C:/Users/Dropbox/RPackages\",intern = TRUE)\n</code></pre>\n\n<p>but got similar error message</p>\n\n<pre><code>Error in system(\"cd C:/Users/Dropbox/RPackages\", intern = TRUE) : \n'cd' not found\n</code></pre>\n"},{"tags":["r","plot","lattice"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13253150,"title":"How to change horizontal spaces within legend in lattice?","body":"<p>While there is a <code>padding.text</code> argument for <code>key</code> in <code>lattice</code> to adjust vertical space between rows within the legend, I couldn't find anything similar for the horizontal space between symbol and text, as well as between legend and plot. As far as I understand, <code>between</code> and <code>between.columns</code> only apply to spaces around and between columns, respectively, but how do I alter horizontal spaces within the columns?</p>\n"},{"tags":["r","hadoop","rhipe"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":18,"score":-1,"question_id":13252784,"title":"unexpected symbol error using Rhipe package","body":"<p>At time of developing linear regression model with R and Hadoop via Rhipe package, I am got error while extending rhipe.lm.R to current file to use rhlm method.</p>\n\n<pre><code>&gt; source(file=\"/media/SYSTEM@/ML/R_HADOOP/rhipe.lm.R\") \nerror :\nError in source(file = \"/media/SYSTEM@/ML/R_HADOOP/rhipe.lm.R\") :\n  /media/SYSTEM@/ML/R_HADOOP/rhipe.lm.R:1:3: unexpected symbol\n188:   reduce = { total &lt;- total+sum(unlist(reduce.\nvalues)) }\n189:   post\n       ^\n</code></pre>\n\n<ol>\n<li>R [ Version 2.12.1] + Rstudio [ version v0.97.168 ] -> For R operation </li>\n<li>Hadoop [ version 1.1.0]  -> For parallel computation on multi cores </li>\n<li>Protocol buffer [2.4.1] -> For serialization of structured data</li>\n<li>Rhipe [0.69] -> Its R packege, For interface between Hadoop and R</li>\n</ol>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":39,"score":-2,"question_id":13252902,"title":"GO annotation in R","body":"<p>I have the matrix as follows :</p>\n\n<pre><code>probes GSM362180    GSM362181  GSM362188    GSM362189  GSM362192\n244901 5.094871713 4.626623079 4.554272515 4.748604391 4.759221647\n244902 5.194528083 4.985930299 4.817426064 5.151654407 4.838741605\n244903 5.412329253 5.352970877 5.06250609  5.305709079 8.365082403\n244904 5.529220594 5.28134657  5.467445095 5.62968933  5.458388909\n244905 5.024052699 4.714631878 4.792865831 4.843975286 4.657188246\n244906 5.786557533 5.242403911 5.060605782 5.458148567 5.890061836\n</code></pre>\n\n<p>I would like to extract only the first column as follows :</p>\n\n<pre><code> ids &lt;- scr[,1]\n</code></pre>\n\n<p>and then</p>\n\n<pre><code> biocLite(\"GO.db\")\n library(\"AnnotationDbi\")\n biocLite(\"org.At.tair.db\")\n biocLite(\"ath1121501.db\")\n library(\"ath1121501.db\")\n genenames &lt;-  org.At.tairGENENAME[ids]\n number&lt;-org.At.tairENTREZID[ids]\n xx&lt;-toTable(entrez)\n yy&lt;-toTable(number)\n complete&lt;-merge(xx,yy)\n</code></pre>\n\n<p>I get an error in this step and unable to proceed further. Is it because ids &lt;- scr[,1] is a factor ?</p>\n\n<p>Iam not sure how to store the id names to carry out the annotation correctly .I would like to use GO.db to find the Terms associated with the go Ids, displaying the result as a data frame with my probes and their corresponding TAIR ID and TAIR genename and annotation.</p>\n"},{"tags":["r","select","data.frame","rows"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13232748,"title":"How to select rows based on the combination of columns","body":"<p>I have the following data frame:</p>\n\n<pre><code>structure(list(Species = 1:4, Ni = c(1, NA, 1, 1), Zn = c(1, \n1, 1, 1), Cu = c(NA, NA, 1, NA)), .Names = c(\"Species\", \"Ni\", \n\"Zn\", \"Cu\"), row.names = c(NA, -4L), class = \"data.frame\")\n</code></pre>\n\n<p>and I would like to get a vector containing all the species where <code>Ni = 1</code>, <code>Zn = 1</code> and <code>Cu = NA</code>. So in this example that would be (1,4)</p>\n\n<p>I thought I could have a try with the R script <code>select * from where</code>, but I can't seem to install the package RMySQL on RStudio (R version 2.15.1).</p>\n"},{"tags":["r","matrix","lm","qr-decomposition"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13248960,"title":"QR decomposition different in lm and biglm?","body":"<p>I'm trying to recover the R matrix from the QR decomposition used in biglm. For this I am using a portion of the code in vcov.biglm and put it into a function like so:</p>\n\n<pre><code>qr.R.biglm &lt;- function (object, ...) {\n    # Return the qr.R matrix from a biglm object\n    object$qr &lt;- .Call(\"singcheckQR\", object$qr)\n    p &lt;- length(object$qr$D)\n    R &lt;- diag(p)\n    R[row(R) &gt; col(R)] &lt;- object$qr$rbar\n    R &lt;- t(R)\n    R &lt;- sqrt(object$qr$D) * R\n    dimnames(R) &lt;- list(object$names, object$names)\n    return(R)\n}\n</code></pre>\n\n<p>More specifically, I'm trying to get the same result as using qr.R from the base package, which is used on QR decompositions of class \"qr\" such as those contained in the lm class (lm$qr). The code for the base function is as follows:</p>\n\n<pre><code>qr.R &lt;- function (qr, complete = FALSE) {\n    if (!is.qr(qr)) \n        stop(\"argument is not a QR decomposition\")\n    R &lt;- qr$qr\n    if (!complete) \n        R &lt;- R[seq.int(min(dim(R))), , drop = FALSE]\n    R[row(R) &gt; col(R)] &lt;- 0\n    R\n}\n</code></pre>\n\n<p>I manage to get the same result for a sample regression, except for the signs.</p>\n\n<pre><code>x &lt;- as.data.frame(matrix(rnorm(100 * 10), 100, 10))\ny &lt;- seq.int(1, 100)\nfit.lm &lt;- lm(\"y ~ .\", data =  cbind(y, x))\nR.lm &lt;- qr.R(fit.lm$qr)\n\nlibrary(biglm)\nfmla &lt;- as.formula(paste(\"y ~ \", paste(colnames(x), collapse = \"+\")))\nfit.biglm &lt;- biglm(fmla, data = cbind(y, x))\nR.biglm &lt;- qr.R.biglm(fit.biglm)\n</code></pre>\n\n<p>Comparing both, it's clear that the absolute values match, but not the signs.</p>\n\n<pre><code>mean(abs(R.lm) - abs(R.biglm) &lt; 1e-6)\n[1] 1\nmean(R.lm - R.biglm &lt; 1e-6)\n[1] 0.9338843\n</code></pre>\n\n<p>I can't quite figure out why this is. I would like to be able to get the same result for the R matrix as lm from biglm.</p>\n"},{"tags":["r","ggplot2","boxplot","ggplot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13248226,"title":"ggplot2: How do I create a simple boxplot from a dataframe?","body":"<p>I've been trying to do this boxplot now for a whole day. I give up soon. Please help. \nI just want a simple boxplot for my 3 groups, A, B and C. \nThis is my data simplified:</p>\n\n<pre><code>&gt; mydata \n   A01 A02 A03 B01 B02 B03 C01 C02 C03\nid0001    1    2    3    6    7    8    11    12    13\n</code></pre>\n\n<p>A01, A02 and A03 should make up the confidence interval for A, etc. How can I have a very simple boxplot with the 3 groups on the x-axis?\nAlthough boxes would be great too, I would be so grateful if someone could help me make my plot similar to <a href=\"http://compbio.mit.edu/cummeRbund/images/plots/cummeRbund-manual-gene_plots_line-4.png\" rel=\"nofollow\">this one</a>. Eventually, I want to make a graph that contains more than one ID, so it looks like <a href=\"http://compbio.mit.edu/cummeRbund/images/plots/cummeRbund-manual-similar_plots_2.png\" rel=\"nofollow\">this one</a>, but with error bars like the first one.</p>\n\n<p>If someone could help me or give me tips on how to proceed, I would appreciate it so much!</p>\n\n<p>Thank you.</p>\n"},{"tags":["r","forecasting"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":26,"score":-1,"question_id":13252216,"title":"forecast volatility in R","body":"<p>I want to forecast volatility of daily stock return in R with a GARCH process, but i didn't find a linear way to do it. I only find specific topic.\nCan you help me?</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13233700,"title":"R: SAS (if/then statement )in R","body":"<p>I was working previously with sas and then decided to shift to R for academic requirements reasons..\nmy data (healthdemo) are health data containing some health diagnostic codes (ICD-10),, I want to separate these codes into different columns..this is part of str(healthdemo):</p>\n\n<pre><code>$ PATIENT_KEY     : int  7391510 7404298 7390196 7381208 7401691 7381223 7383005 10188634 7384574 7398317 ...\n $ ICDCODE         : Factor w/ 1125 levels \"\",\"H00\",\"H00.0\",..: 654 56 654 654 665 48 90 679 654 654 ...\n $ PATIENT_ID      : int  39387 50244 38388 27346 49922 27901 27867 61527 33186 45309 ...\n $ DATE_OF_BIRTH   : Factor w/ 14801 levels \"\",\"01/01/1000\",..: 7506 10250 52 73 94 6130 85 2710 95 100 ...\n</code></pre>\n\n<p>the ICDCODE contains many diseases from H00 to J99, first;I separated the letters from numbers in the ICDCODE</p>\n\n<pre><code>healthdemo$icd_char = substr(healthdemo$ICDCODE,1,1)\nhealthdemo$icd_num = substr(healthdemo$ICDCODE,2,2)\n</code></pre>\n\n<p>then I created diseases columns by this function:</p>\n\n<pre><code>healthdemo$cvd = 0\nhealthdemo$ihd = 0\nhealthdemo$mi = 0\nhealthdemo$dys = 0\nhealthdemo$afib = 0\nhealthdemo$chf = 0\n</code></pre>\n\n<p>now I want to apply a function similar to this SAS function (that I used to use):</p>\n\n<pre><code>if icd_char = 'I' and 01 &lt;= icd_num &lt; 52 then cvd = 1;\n\nif icd_char = 'I' and 20 &lt;= icd_num &lt;= 25 then ihd = 1;\n\nif icd_char = 'I' and 21 &lt;= icd_num &lt;= 22 then mi = 1;\n\nif icd_char = 'I' and 46 &lt;= icd_num &lt;= 49 then dys = 1;\n\nif icd_char = 'I' and icd_num = 48 then afib = 1;\n</code></pre>\n\n<p>this function will assign each patient with the given  Icd caharcter and Icd-number into cvd=1 (e.g.) and so on. </p>\n\n<p>I tried using these functions in R but they didnt work for me:</p>\n\n<pre><code>healthdemo$cvd[healthdemo$icd_char == 'I' &amp; 01 &lt;= healthdemo$icd_num \n      &amp; healthdemo$icd_num &lt; 52 ] &lt;- 1\n</code></pre>\n\n<p>and this </p>\n\n<pre><code>if (healthdemo$icd_char == \"I\" &amp;  01 &lt; = healthdemo$icd_num &lt; 52  )\n   {healthdemo$cvd &lt;- 1} \n</code></pre>\n\n<p>would somebody help me please</p>\n"},{"tags":["r","comments","read.table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13251000,"title":"read.table function in R drops elements","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12771522/cannt-read-file-with-and-space-using-read-table-or-read-csv-in-r\">cannt read file with “#” and space using read.table or read.csv in R</a>  </p>\n</blockquote>\n\n\n\n<p>I have them problem with R that when I'm reading in (using read.table function) delimited files (e.g. tab delimited text files) with R, the rows containing <code>#</code> or ' characters are silently dropped. how the file should be read in so that the rows containing these characters aren't dropped? </p>\n"},{"tags":[".net","r","interop","statistics","compatibility"],"answer_count":4,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":1287,"score":7,"question_id":5025340,"title":"Call R (programming language) from .net","body":"<p>I'm working on an application that requires a great deal of stastical processing and output as images in a .net desktop application. The problems, including generating the output images, seem like a natural fit for R <a href=\"http://www.r-project.org/\">http://www.r-project.org/</a> </p>\n\n<p>Is there a wrapper, API, SDK, or port that will allow me to call R from .net?</p>\n"},{"tags":["r","plot","ggplot2","font-size"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13242436,"title":"Label size in directlabels geom_dl()","body":"<p>I have really enjoyed the package <code>directlabels</code> for dynamic positioning the lables of a plot. Although still not perfect, it helps reasonably to prevent overlaps between labels of a scatter plots with many points for example - specially for the draft version of the charts, not the final one. </p>\n\n<p>However I can not find anyway to change the label size while using <code>geom_dl()</code> function. Is there anyway?</p>\n\n<p>I have tried to pass <code>size</code> and <code>cex</code> as a normal or <code>aes()</code> argument to the function.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":25,"score":-1,"question_id":13248697,"title":"Spearman rank decay over time","body":"<p>I came across this Credit Suisse research pdf <a href=\"http://www.scribd.com/doc/62210581/CSFB-Quant-Research\" rel=\"nofollow\">(http://www.scribd.com/doc/62210581/CSFB-Quant-Research)</a> and was wondering about the implementation of spearman rank decay analysis presented on pp.27.</p>\n\n<p>If we take exhibit 34 as an example, what have the authors done? Have they:</p>\n\n<ol>\n<li>Ranked the universe of stocks in terms of the Traditional Value\nfactor at time t ; Ranked the universe of stocks in terms of returns\nat time t+1 and computed the rank correlation qnd repeated this step\nfor future months.(E.g. Rank stocks in terms of factor in Jan;Rank\nstocks in terms of future returns in Feb;compute rank correlation)</li>\n<li>OR Ranked the universe of stocks in terms of the Traditional Value\nfactor at time t;Ranked the universe of stocks in terms of returns\nat time t+1;computed the rank correlation statistic; and extended\nthe data set to include more periods before calculating the rank\nagain. (E.g. Rank stocks in terms of factor in Jan;Rank stocks in\nterms of returns in Feb;calculate rank correlation;extend data set\nfrom jan to feb for the factor and from feb to march for\nreturns;recalculate rank correlation)</li>\n<li>OR something else completely?</li>\n</ol>\n\n<p>Any help would be much appreciated!</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":306,"score":4,"question_id":8440666,"title":"Removing the margin and change the font style for labels in ggplot","body":"<p>I have generated a dendrogram using ggdendro and ggplot. I have two issues regarding the generated plot. </p>\n\n<ol>\n<li>Is that possible to cut some margin from the generated plot?</li>\n<li>How to change the font style, e.g., size, for the label along one axis?</li>\n</ol>\n\n<p>In the plot, the two areas marked by \"red pane\" are the margins I would like to remove. The six labels along the x-axis is marked with yellow color. I would like to increase the size of them. </p>\n\n<p><img src=\"http://i.stack.imgur.com/H14u4.png\" alt=\"enter image description here\"></p>\n\n<p>The code:</p>\n\n<pre><code>&gt; x&lt;-read.csv(\"test1.csv\",header=TRUE)\n&gt; d&lt;-as.dist(x,diag=FALSE,upper=FALSE)\n&gt; hc&lt;-hclust(d,\"ave\")\n&gt; dhc&lt;-as.dendrogram(hc)\n&gt; ddata&lt;-dendro_data(dhc,type=\"rectangle\")\n&gt; ddata$labels$text &lt;- gsub(\"\\\\.\",\" \",ddata$labels$text)\n&gt; fig1&lt;-ggplot(segment(ddata))+geom_segment(aes(x=x0,y=y0,xend=x1,yend=y1))\n&gt; fig1&lt;-fig1+xlab(NULL)+ylab(NULL)+opts(panel.grid.minor=theme_blank())\n&gt; fig1&lt;-fig1+scale_x_discrete(limits=ddata$labels$text)\n&gt; fig1&lt;-fig1+coord_flip()\n&gt; last_plot()\n&gt; fig1&lt;-last_plot()\n&gt; ggsave(\"test1.pdf\")\n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":5,"favorite_count":122,"up_vote_count":172,"down_vote_count":7,"view_count":11682,"score":165,"question_id":12675147,"title":"How can we make xkcd style graphs in R?","body":"<p>Apparently, folk have figured out how to make <a href=\"http://xkcd.com/\">xkcd</a> style graphs in <a href=\"http://mathematica.stackexchange.com/questions/11350/xkcd-style-graphs\">mathematica</a> and <a href=\"http://tex.stackexchange.com/questions/74878/create-xkcd-style-diagram-in-tex\">LaTeX</a>.  Can we do it in R?  Ggplot2-ers?  A geom_xkcd and/or theme_xkcd?</p>\n\n<p>I guess in base graphics, par(xkcd=TRUE)?  How to do it...</p>\n\n<p><img src=\"http://i.stack.imgur.com/f2UqI.png\" alt=\"xkcd#1064\" title=\"FYI: I&#39;ll be releasing a wolf into a randomly-chosen front yard sometime in the next 30 years. Now your fear is reasonable, and you don&#39;t need to feel embarrassed anymore. Problem solved!\"></p>\n\n<p>As a first stab (and as much more elegantly shown below) in ggplot2, adding the jitter argument to a line makes for a great hand-drawn look.  So - </p>\n\n<pre><code>ggplot(mapping=aes(x=seq(1,10,.1), y=seq(1,10,.1))) + geom_line(position=\"jitter\", color=\"red\", size=2) + theme_bw()\n</code></pre>\n\n<p>Makes for a nice example - but the axes and fonts appear trickier. Fonts appear solved (below), though.  Is the only way to deal with axes to blank them out and draw them in by hand?  Is there a more elegant solution?  In particular, in ggplot2, can element_line in the new theme system be modified to take a jitter-like argument?  Hrm...</p>\n"},{"tags":["r","datetime"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13247993,"title":"Getting start date of current month in R","body":"<p>I want to get start date of current month in R.\nNow I use the following</p>\n\n<pre><code>currentDate&lt;-Sys.Date()  #for getting current system date eg:2012-11-06\nformatDate&lt;-format(currentDate,\"%Y-%m\")  #it return 2012-11\nstartDate&lt;-as.Date(paste(formatDate,\"-01\",sep=\"\"))  #it return 2012-11-01\n</code></pre>\n\n<p>Is there any easy way to do this?</p>\n"},{"tags":["r","poisson"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13248033,"title":"Generate Poisson Confidence Limit using R","body":"<p>I have use the reference from <a href=\"http://www.nbdpn.org/docs/Ch_8_Statistics6-04.pdf\" rel=\"nofollow\">here</a> (Page 19 of the PDF) to calculate the confidence interval of a direct standardized incidence rate. The chapter quoted <code>Table of 95% Confidence Limits for the Number of Cases, for 1-29 Cases, Based on the Poisson Distribution</code>, which is attached here:</p>\n\n<p><img src=\"http://i.stack.imgur.com/hZ3vd.png\" alt=\"enter image description here\"></p>\n\n<p>I tried to generate the number using <code>ci.poisson</code> function in <code>epicalc</code> package:</p>\n\n<pre><code>&gt; ci.poisson(0,29)\n events person.time incidence se exact.lower95ci exact.upper95ci\n      0          29         0  0               0       0.1272069\n</code></pre>\n\n<p>The output is different from the PDF's table, which should be <code>0.0000</code>-<code>3.6889</code>. I wonder if I am using the wrong function for generating the numbers. How can I construct that table using R? Thanks.</p>\n"},{"tags":["r","d3.js"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":66,"score":-1,"question_id":13238492,"title":"generate D3 html pages with R?","body":"<p>I would like to generate an interactive plot with R, for example an xyplot that shows information of the data points on mouseover, and I've read about D3. I would like to be able to write R code to generate the D3 html pages automatically. Is there any R package able to do that? </p>\n\n<p>I've seen there is a r2d3 package on github but I am not sure how far that project is. Any ideas?</p>\n"},{"tags":["r","data.frame","reshape"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13247417,"title":"R reshape function","body":"<p>I have a problem with the reshape function. I tired it for while now, but it just doesn't work. My data looks like this:</p>\n\n<pre><code>    KeyItem    Year    Value\n    Income     2011     10000\n    Income     2010     29299\n    Depth      2010     29393\n    Market Cap 2010     39393\n    Depth      2011     20000\n    Market Cap 2011     30000\n</code></pre>\n\n<p>and I need it to look like this for my function:</p>\n\n<pre><code>   KeyItem        2011         2010\n   Income         10000        29299\n   Depth          20000        29393\n   Market Cap     30000        39393\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13246671,"title":"recursively adding columns to a data.frame where values corresponds to vectors in a list","body":"<p>I have a list of vectors whose values are bounded between 1 and 100.   </p>\n\n<pre><code>[[1]]\n[[1]][[1]]\n[1] \"a\"\n\n[[1]][[2]]\n[1] 41  5 53 55 56\n\n\n[[2]]\n[[2]][[1]]\n[1] \"b\"\n\n[[2]][[2]]\n[1] 41 1 57 53  48\n</code></pre>\n\n<p>etc. </p>\n\n<p>How do i somehow get to the following data.frame</p>\n\n<pre><code>  no      1        2\n  1      NA        b\n  41      a        b\n   5      a       NA\n  53      a       NA\n  55      a       NA\n  56      a       NA\n  48     NA        b\n  57     NA        b\n  53     NA        b\n</code></pre>\n\n<p>and from there fill in the missing rows and ordered according to the column \"no\" where column no. runs from 1 to 100?\neg. </p>\n\n<pre><code>  no      1        2\n  1      NA        b\n  2      NA       NA\n  3      NA       NA\n  4      NA       NA\n  5      a        NA\n</code></pre>\n\n<p>etc. \nall the way until the 100th row. </p>\n"},{"tags":["r","survey","replicate"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":75,"score":2,"question_id":12905936,"title":"How are BRR weights used in the survey package for R?","body":"<p>Does anyone know how to use BRR weights in Lumley's survey package for estimating variance if your dataset <em>already</em> has BRR weights it in?</p>\n\n<p>I am working with PISA data, and they already include 80 BRR replicates in their dataset. How can I get as.svrepdesign to use these, instead of trying to create its own? I tried the following and got the subsequent error:</p>\n\n<pre><code>dstrat &lt;- svydesign(id=~uniqueID,strata=~strataVar, weights=~studentWeight, \n                data=data, nest=TRUE)\ndstrat &lt;- as.svrepdesign(dstrat, type=\"BRR\")\n\nError in brrweights(design$strata[, 1], design$cluster[, 1], ..., \n    fay.rho = fay.rho,  : Can't split with odd numbers of PSUs in a stratum\n</code></pre>\n\n<p>Any help would be greatly appreciated, thanks.</p>\n"},{"tags":["r","curl","markdown"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":87,"score":1,"question_id":13111688,"title":"Add Parameters to Basic Post Command in R","body":"<p>I came across <a href=\"http://documentup.com/#themes\" rel=\"nofollow\">this service</a> that will format my local markdown files rather nicely.  Per the example, it is easy to get a nicely formatted response with a sample curl command. </p>\n\n<p>What I am looking to do is utilize some of the options available, namely the version and \"name\" parameters. How would I go about structuring the curl command?  Below are the code samples that I have used within R.</p>\n\n<p>This code works nicely, but lacks the specified options:</p>\n\n<pre><code>doc.up &lt;- \"curl -X POST --data-urlencode content@test-markdown.md  \\ http://documentup.com/compiled &gt; index.html\"\nsystem(doc.up)\n</code></pre>\n\n<p>I tried to specify the name option, but no dice:</p>\n\n<pre><code>doc.up &lt;- \"curl -X POST --data-urlencode name@mynamevar content@test-markdown.md  \\ http://documentup.com/compiled &gt; index.html\"\nsystem(doc.up)\n</code></pre>\n\n<p>Any help will be greatly appreciated!</p>\n\n<p>EDIT:  Per some of the suggestions below, I have attempted a few ways to use <code>Rcurl</code> and <code>HTTR</code>.  I am using the default Markdown template within Rstudio, but for completeness sake, I saved it as test-markdown.Rmd and compiled it test-markdown.md.</p>\n\n<p>Using RCurl, I attempted:</p>\n\n<pre><code>## attempt 1\nf &lt;- paste(readLines('test-markdown.md'),collapse=\"\\n\" )\nh &lt;- dynCurlReader()\nwp &lt;- curlPerform(url=\"http://documentup.com/compiled\", \n            postfields = c(content=f))\n## attempt 2\npostForm(\"http://documentup.com/compiled\",\n         \"content\" = fileUpload('test-markdown.md'))\n</code></pre>\n\n<p>Using httr, I tried:</p>\n\n<pre><code>## attempt 3\ntmp &lt;- POST(\"http://documentup.com/compiled\", body = list(content= upload_file(f)))\ncontent(tmp)\n\n## attempt 4\ntmp &lt;- POST(\"http://documentup.com/compiled\", body = list(content= upload_file(\"test-markdown.md\")))\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13243873,"title":"Is it appropriate to create a filename using \"paste\" inside of file.path?","body":"<p><code>?file.path</code> indicates that this function is designed to be faster than <code>paste</code>, so I am concerned that writing</p>\n\n<pre><code>dirname &lt;- \"/path/to/myfile/\"\nfile.path(dirname, paste(output, \".csv\", sep = \"\"))\n</code></pre>\n\n<p>is missing the point.</p>\n\n<p>Is it? </p>\n"},{"tags":["r","ggplot2","bipartite"],"answer_count":1,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":52,"score":5,"question_id":13235972,"title":"Bipartite network graph with ggplot2","body":"<p>I have the following data frame:</p>\n\n<pre><code>structure(list(X1 = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 4L, 4L, \n4L, 4L, 4L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 6L, 6L, 6L\n), .Label = c(\"1\", \"2\", \"3\", \"4\", \"5\", \"6\"), class = \"factor\"), \n    X2 = structure(c(1L, 6L, 8L, 10L, 12L, 13L, 3L, 4L, 1L, 6L, \n    7L, 9L, 10L, 12L, 13L, 3L, 4L, 5L, 10L, 12L, 13L, 4L, 1L, \n    6L, 12L, 13L, 3L, 1L, 6L, 7L, 8L, 10L, 11L, 12L, 13L, 2L, \n    3L, 11L, 12L, 13L), .Label = c(\"I1\", \"I10\", \"I11\", \"I12\", \n    \"I13\", \"I2\", \"I3\", \"I4\", \"I5\", \"I6\", \"I7\", \"I8\", \"I9\"), class = \"factor\")), .Names = c(\"X1\", \n\"X2\"), row.names = c(NA, -40L), class = \"data.frame\")\n</code></pre>\n\n<p>Where in X1 is the person number and in X2 the group to which the person belongs to. One person can be in different groups.\nNow I want to draw a line from each person to each group he belongs to. With <code>plot()</code> I solved it this way:</p>\n\n<pre><code>plot(0, xlim=c(0,1), ylim=c(0,1), type=\"n\", axes=FALSE, xlab=\"\", ylab=\"\")\n\nfactor.to.int &lt;- function(f) {\n  (as.integer(f) - 1) / (length(levels(f)) - 1)\n}\n\nsegments(factor.to.int(data$X1), 0, factor.to.int(data$X2), 1, col=data$X1)\naxis(1, at = seq(0, 1, by = 1 / (length(levels(data$X1)) - 1)), labels = levels(data$X1))\naxis(3, at = seq(0, 1, by = 1 / (length(levels(data$X2)) - 1)), labels = levels(data$X2))\n</code></pre>\n\n<p>The result looks like this:\n<img src=\"http://i.stack.imgur.com/Wud0d.png\" alt=\"bipartite graph\"></p>\n\n<p>Now I wondering how I can do this with ggplot2?</p>\n\n<p>Thanks for your help!</p>\n"},{"tags":["r","model","regression","glm","anova"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13237824,"title":"How to extract a p-value when performing anova() between two glm models in R","body":"<p>So, I'm trying to compare two models, fit1 and fit2.</p>\n\n<p>Initially, I was just doing anova(fit1,fit2), and this yielded output that I understood (including a p-value).</p>\n\n<p>However, when I switched my models from lm()-based models to glm()-based models, anova(fit1,fit2) now yielded Residual Degrees of Freedom, Residuals Deviances, and Df Deviances, which I am having trouble interpreting (resources explaining these metrics seem scarce). I was hoping to extract a p-value for the comparison between the two models, but for some reason anova(fit1,fit2, test='Chisq') isn't working. Any suggestions?</p>\n\n<p>I realize that, depending on the link function in my glms, Chi-squared may not be the most appropriate test, but I have used 'F' in appropriate contexts as well with similar disappointment.</p>\n\n<p>Is this problem familiar to anybody else? Suggestions? Many thanks!</p>\n"},{"tags":["r","plot"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":625,"score":6,"question_id":10730303,"title":"How to plot multiple lines in R","body":"<p>I have a data that looks like this:</p>\n\n<pre><code>#d  TRUE    FALSE   Cutoff\n4   28198   0   0.1\n4   28198   0   0.2\n4   28198   0   0.3\n4   28198   13  0.4\n4   28251   611 0.5\n4   28251   611 0.6\n4   28251   611 0.7\n4   28251   611 0.8\n4   28251   611 0.9\n4   28251   611 1\n6   19630   0   0\n6   19630   0   0.1\n6   19630   0   0.2\n6   19630   0   0.3\n6   19630   0   0.4\n6   19636   56  0.5\n6   19636   56  0.6\n6   19636   56  0.7\n6   19636   56  0.8\n6   19636   56  0.9\n6   19636   56  1\n</code></pre>\n\n<p>So I want to plot them based on True (Y-axis) and False (X-axis).</p>\n\n<p>This is the way I want it to appear roughly.\n<img src=\"http://i.stack.imgur.com/Dvjo3.jpg\" alt=\"This is the way I want it to appear roughly\"></p>\n\n<p>What's the right way to do it?\nMy code below fails</p>\n\n<pre><code>dat&lt;-read.table(\"mydat.txt\", header=F);\ndis     &lt;- c(4,6);\nlinecols &lt;-c(\"red\",\"blue\");\nplot(dat$V2 ~ dat$V3, data = dat,  xlim = c(0,611),ylim =c(0,28251), type=\"l\")\n\nfor (i in 1:length(dis)){\ndatax &lt;- subset(dat, dat$V1==dis[i], select = c(dat$V2,dat$V3))\nlines(datax,lty=1,type=\"l\",col=linecols[i]);\n}\n</code></pre>\n"},{"tags":["r","mongodb","rmongodb"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":802,"score":2,"question_id":7527088,"title":"How to query MongoDB from R?","body":"<p>I want to get a MongoDB query from R.</p>\n\n<p>With the <code>mongo</code> shell, I would query with:</p>\n\n<pre><code>db.user.find({age:{$gt:21}})\n</code></pre>\n\n<p>However, In R-Mongo, I haven't found how to describe this query.</p>\n\n<p>Thanks</p>\n"}]}
{"total":19203,"page":3,"pagesize":100,"questions":[{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13243323,"title":"How to work out the Net Promotion Score by prop.table()","body":"<pre><code>    ############ uncoded data\n   x10&lt;- structure(c(0L, 0L, 0L, 0L, 1L, 1L, 1L, 5L, 8L, 9L, 31L, 1L, \n    0L, 0L, 0L, 1L, 0L, 1L, 2L, 7L, 2L, 10L, 0L, 2L, 0L, 2L, 2L, \n    5L, 2L, 4L, 6L, 8L, 4L, 1L, 1L, 3L, 2L, 2L, 6L, 1L, 12L, 18L, \n    7L, 29L, 8L, 4L, 6L, 8L, 6L, 19L, 3L, 9L, 12L, 3L, 12L, 14L, \n    1L, 2L, 1L, 3L, 1L, 0L, 4L, 6L, 3L, 11L, 0L, 0L, 0L, 1L, 3L, \n    7L, 5L, 8L, 21L, 26L, 51L, 0L, 1L, 0L, 3L, 5L, 10L, 9L, 29L, \n    55L, 60L, 125L, 3L, 0L, 1L, 1L, 3L, 10L, 1L, 6L, 18L, 17L, 13L, \n    6L, 3L, 4L, 13L, 6L, 33L, 17L, 48L, 84L, 54L, 103L, 34L, 11L, \n    20L, 27L, 26L, 50L, 29L, 30L, 54L, 28L, 34L, 31L, 5L, 7L, 3L, \n    4L, 20L, 8L, 16L, 16L, 8L, 41L, 1L, 0L, 0L, 3L, 1L, 3L, 3L, 11L, \n    19L, 16L, 56L, 0L, 0L, 0L, 0L, 3L, 11L, 3L, 18L, 25L, 21L, 62L, \n    3L, 0L, 1L, 4L, 2L, 7L, 8L, 15L, 22L, 12L, 19L, 5L, 2L, 8L, 9L, \n    9L, 42L, 18L, 51L, 70L, 45L, 103L, 29L, 15L, 23L, 34L, 25L, 57L, \n    23L, 38L, 55L, 30L, 33L, 36L, 5L, 5L, 6L, 6L, 16L, 6L, 10L, 17L, \n    9L, 35L, 2L, 0L, 1L, 1L, 2L, 4L, 6L, 8L, 22L, 33L, 73L, 0L, 0L, \n    0L, 1L, 2L, 7L, 7L, 15L, 27L, 21L, 56L, 1L, 2L, 2L, 0L, 2L, 9L, \n    4L, 8L, 24L, 13L, 17L, 14L, 2L, 8L, 10L, 16L, 51L, 16L, 51L, \n    69L, 29L, 99L, 44L, 18L, 25L, 34L, 19L, 49L, 26L, 43L, 63L, 15L, \n    30L, 42L, 9L, 17L, 7L, 3L, 16L, 8L, 13L, 22L, 18L, 45L, 0L, 0L, \n    1L, 3L, 0L, 7L, 4L, 14L, 15L, 20L, 47L, 0L, 1L, 0L, 1L, 1L, 3L, \n    3L, 5L, 6L, 11L, 21L, 1L, 0L, 0L, 4L, 2L, 3L, 8L, 7L, 17L, 3L, \n    13L, 5L, 2L, 6L, 13L, 15L, 34L, 19L, 42L, 62L, 37L, 83L, 52L, \n    16L, 26L, 26L, 29L, 53L, 28L, 45L, 45L, 15L, 22L, 26L, 8L, 12L, \n    11L, 5L, 12L, 5L, 7L, 17L, 10L, 28L), .Dim = c(11L, 6L, 5L), .Dimnames = structure(list(\n        c(\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\"), \n        c(\"I've changed for work/ a new job/ gone on a work plan\", \n        \"I want a phone that doesn't offer\", \"I want Best Mates/ Favourites\", \n        \"I was offered or saw a better offer on another network\", \n        \"Issues with the network (poor coverage)\", \"Other\"\n        ), YearQuarter = c(\"2011-09-01\", \"2011-12-01\", \"2012-03-01\", \n        \"2012-06-01\", \"2012-09-01\")), .Names = c(\"\", \"\", \"YearQuarter\"\n    )), class = \"table\")  \n\n############ recoded data\n x10 &lt;- structure(c(40L, 3L, 13L, 12L, 3L, 9L, 12L, 13L, 10L, 36L, 16L, \n    30L, 15L, 54L, 21L, 14L, 22L, 10L, 77L, 16L, 29L, 185L, 28L, \n    84L, 30L, 19L, 24L, 157L, 82L, 132L, 62L, 197L, 84L, 49L, 78L, \n    32L, 72L, 11L, 30L, 83L, 17L, 43L, 31L, 25L, 37L, 148L, 93L, \n    121L, 63L, 206L, 93L, 44L, 80L, 27L, 106L, 16L, 30L, 77L, 17L, \n    42L, 30L, 20L, 32L, 128L, 117L, 120L, 45L, 215L, 106L, 63L, 102L, \n    35L, 67L, 15L, 29L, 32L, 9L, 11L, 16L, 18L, 24L, 120L, 94L, 104L, \n    37L, 230L, 90L, 38L, 79L, 24L), .Dim = c(3L, 6L, 5L), .Dimnames = structure(list(\n        c(\"Promoters\", \"Detractors\", \"Passive\"), c(\"I've changed for work/ a new job/ gone on a work plan\", \n        \"I want a phone that doesn't offer\", \"I want Best Mates/ Favourites\", \n        \"I was offered or saw a better offer on another network\", \n        \"Issues with the network (poor coverage)\", \"Other\"\n        ), YearQuarter = c(\"2011-09-01\", \"2011-12-01\", \"2012-03-01\", \n        \"2012-06-01\", \"2012-09-01\")), .Names = c(\"\", \"\", \"YearQuarter\"\n    )), class = \"table\") \n\n\n    x10.p &lt;- round(prop.table(x10,c(3,2)),2)*100\n</code></pre>\n\n<p>Hi there</p>\n\n<p>The Net Promotion Score is a question which asks the consumers to rate the 'the likelihood to recommend the product or the service' on a zero to ten scale. People reported with 10 and 9 are called 'promoters', people rated 8 and 7 are seen as 'Passive', and people reported less than 6 are considered as detractors. The Net Promotion score is the difference between the percentage of 'Promoters' minus the the percentage of 'Detractors'.</p>\n\n<p>I summerised and recoded the answers from the question into a table x10 from Sep 2011 to Sep 2012. The numbers are actual people counts for each group (Promoter,Detractor and Passive). Apologies for the three dimensioanl table, I am interested in the Net Promoter Score for each reason( i.e what's the percentage difference among the promoters and detractors for \"I've changed for work/ a new job/ gone on a work plan\" in Sep 2012.</p>\n\n<p>The Net Promotion Score before I can plot it which requires a bit manipulation. I wonder if anyone knows to how do it?</p>\n\n<p>Cheers</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":79,"score":3,"question_id":12217200,"title":"How to select groups of rows and store to variables?","body":"<p>I currently use the following code to input a csv file, plot the data points based off one column and store a CpK number to a variable. This code works to calculate the CpK for the entire data set and the graph works as well. I am now looking to calculate the CpK number for each month in the dataset (graphing is not necessary). I looked through the data.table documentation as well as other R documentation, but I having a tough time selecting only the data for each month.</p>\n\n<p><strong>Current Code:</strong>(I could have calculated the CpK in one formula, but I have it broken up purposely)</p>\n\n<pre><code>mydf &lt;- read.csv('ID35.csv', header = TRUE, sep=\",\")\ndate &lt;- strptime(mydf$DATETIME, \"%Y/%m/%d %H:%M:%S\")\nplot(date,mydf$AVG,xlab='Date',ylab='AVG',main='Data')\nabline(h=mydf$MIN,col=3,lty=1)\nabline(h=mydf$MAX,col=3,lty=1)\ngrid(NULL,NULL,col=\"black\")\nlegend(\"topright\", legend = c(\" \", \" \"), text.width = strwidth(\"1,000,000\"), lty = 1:2, xjust = 1, yjust = 1, title = \"Points\")\nmyavg &lt;-mean(mydf$AVG, na.rm=TRUE)\nnewds &lt;- (mydf$AVG - myavg)^2\nnewsum &lt;- sum(newds, na.rm=TRUE)\nN &lt;- length(mydf$AVG) - 1\nnewN &lt;- 1/N\ntotal &lt;- newN*newsum\nsigma &lt;- total^(1/2)\nUSL &lt;- mean(mydf$MAX, na.rm=TRUE)\nLSL &lt;- mean(mydf$MIN, na.rm=TRUE)\ncpk &lt;- min(((USL-myavg)/(3*sigma)),((myavg-LSL)/(3*sigma)))\ncpk\n</code></pre>\n\n<p>Here is what the dataset looks like(date formatting is already done):</p>\n\n<p>mydf(only 24/1000 rows):</p>\n\n<pre><code>Code           DATETIME AVG MIN TARG_AVG MAX\nN9 2012/04/10 14:03:37   0.2647     0.22     0.25     0.27\nNA 2012/03/30 07:48:17   0.2589     0.22     0.25     0.27\nNB 2012/03/24 19:23:08   0.2912     0.22     0.25     0.27\nNB 2012/03/25 16:10:17   0.2659     0.22     0.25     0.27\nNC 2012/04/10 00:58:29   0.2622     0.22     0.25     0.27\nND 2012/04/14 18:32:52   0.2600     0.22     0.25     0.27\nNG 2012/04/21 14:47:47   0.2671     0.22     0.25     0.27\nNH 2012/04/09 20:31:17   0.2648     0.22     0.25     0.27\nNL 2012/04/24 07:28:17   0.2527     0.22     0.25     0.27\nNP 2012/04/23 13:26:50   0.2640     0.22     0.25     0.27\nNQ 2012/04/14 20:30:42   0.2590     0.22     0.25     0.27\nNS 2012/05/02 09:09:52   0.2651     0.22     0.25     0.27\nNU 2012/05/04 13:07:49   0.2688     0.22     0.25     0.27\nNV 2012/05/19 23:07:08   0.2716     0.22     0.25     0.27\nNX 2012/05/03 02:00:13   0.2670     0.22     0.25     0.27\nNY 2012/05/04 12:56:52   0.2680     0.22     0.25     0.27\nNZ 2012/05/06 10:05:38   0.2697     0.22     0.25     0.27\nO0 2012/05/07 22:01:11   0.2675     0.22     0.25     0.27\nO3 2012/06/21 18:09:47   0.2606     0.22     0.25     0.27\n04 2012/06/21 18:47:36   0.2545     0.22     0.25     0.27\n51 2012/07/24 21:13:08   0.2541     0.22     0.25     0.27\nO5 2012/07/26 16:54:09   0.2575     0.22     0.25     0.27\nO6 2012/07/20 02:42:29   0.2603     0.22     0.25     0.27\nOD 2012/08/25 20:56:55   0.2559     0.22     0.25     0.27\nOH 2012/08/28 10:30:11   0.2372     0.22     0.25     0.27\n</code></pre>\n\n<p>From the table above the only two columns I care about are the DATETIME and the AVG. Once I have the new \"myavg\" variable for each month I can use the same formula to calculate the CpK number. I am thinking the variable name could be something like' 2012/08' I think the code should go something like:</p>\n\n<pre><code>for(each month mydf$DATETIME) (date like 2012/04*,2012/05*)\nmonthavg &lt;-(mydf$AVG, na.rm=TRUE)\n</code></pre>\n\n<p>Is there a way to store the CpK number for each month in variables I can access?</p>\n"},{"tags":["r","data.frame"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13237526,"title":"Change values in Dataframe with function in R","body":"<p>i have a data frame, which looks like this, but huge so I can't do anything manually:</p>\n\n<pre><code>   Bank  Country  KeyItem    Year    Value \n    A      AU     Income     2010     1000\n    A      AU     Income     2011     1130\n    A      AU     Income     2012     1160\n    B      USA    Depth      2010     10000\n</code></pre>\n\n<p>What I  want to do is create a function where I can select the Bank, the Keyitem and from which year onwards and it returns a dataframe with the values as percentage of the first value . Like this:</p>\n\n<pre><code>   Bank  Country  KeyItem    Year    Value\n    A      AU     Income     2010     100\n    A      AU     Income     2011     113\n    A      AU     Income     2012     116\n</code></pre>\n\n<p>Thank you in advance! </p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":294,"score":5,"question_id":10405823,"title":"Changing the symbol in the legend key in ggplot2","body":"<p>How do I change the geom_text legend key symbol? In the example below, I'd like to change the symbol in the legend key from a lower case \"a\" to, say, an upper case \"N\". I've looked at an example for doing <a href=\"http://stackoverflow.com/questions/7634276/replacing-ggplot2-legend-key-for-geom-line-with-symbol\">something similar here</a>, but couldn't get that example to work.</p>\n\n<pre><code># Some toy data\ndf &lt;- expand.grid(x = factor(seq(1:5)), y = factor(seq(1:5)), KEEP.OUT.ATTRS = FALSE)\ndf$Count = seq(1:25)\n\n# An example plot\nlibrary(ggplot2)\nggplot(data = df, aes( x = x, y = y, label = Count, size = Count)) + \n   geom_text() +\n   scale_size(range = c(2, 10))\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/8w3S4.png\" alt=\"enter image description here\"></p>\n"},{"tags":["python","r","rpy2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13242662,"title":"Unable to use Rpy2","body":"<p>Why I try to load Rpy2 in Python, the interpreter finds the module but as soon as I try to import anything from it, it returns an error:</p>\n\n<p>e.g. </p>\n\n<pre><code>import rpy2 # No errors, although it does not print anything\n</code></pre>\n\n<p>But</p>\n\n<pre><code>import rpy2.robjects \n</code></pre>\n\n<p>returns the following error:</p>\n\n<blockquote>\n  <p>/home/jimmy/.python_easy_install/rpy2-2.3.0beta1-py2.7-linux-x86_64.egg/rpy2/rinterface/_rinterface.so:\n  undefined symbol: Rf_translateCha rUTF8</p>\n</blockquote>\n\n<hr>\n\n<p>I followed the instructions in the website:</p>\n\n<p><strong>1.</strong> Installed R with the option for shared libraries:</p>\n\n<pre><code># &lt;go to the R source directory&gt;\nmake distclean\n./configure --enable-R-shlib\nmake\nmake install\n</code></pre>\n\n<p><strong>2.</strong> Added this to my <code>.bashhrc</code>:</p>\n\n<pre><code>export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$RHOME/lib\n</code></pre>\n\n<p><strong>3.</strong> And then installed <code>rpy2</code> with <code>easy_install</code> (I also tried with <code>pip</code>):</p>\n\n<pre><code>easy_install -d /home/jimmy/.python_easy_install rpy2\n</code></pre>\n\n<p>Why is it not working?</p>\n\n<p>This is all on Linux with the latest versions of <code>Rpy2</code>, <code>R</code> and <code>Python</code>.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13189514,"title":"How can I build a stand alone R engine with some packages included?","body":"<p>I have a windows server that does not allow me to install anything but it allows me to run exe files (Meaning that I cannot simply download the R installation package and install R that way). I want to run R on it and I like to know if it is possible for me to make an R.exe with some packages like ggplot and lattice included? </p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13239843,"title":"Annotate ggplot2 facets with number of observations per facet","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2050610/creating-a-facet-wrap-plot-with-ggplot2-with-different-annotations-in-each-plot\">Creating a facet_wrap plot with ggplot2 with different annotations in each plot</a><br>\n  <a href=\"http://stackoverflow.com/questions/11458349/add-text-to-a-faceted-plot-in-ggplot2-with-dates-on-x-axis\">Add text to a faceted plot in ggplot2 with dates on X axis</a>  </p>\n</blockquote>\n\n\n\n<p>Occasionally when faceting data in ggplot, I think it would be nice to annotate each facet with the number of observations that fell into each facet. This is particularly important when faceting may result in relatively few observations per facet.</p>\n\n<p>What would be the best / simplest way to add an \"n=X\" to each facet of this plot?</p>\n\n<pre><code>require(ggplot2)\nmms &lt;- data.frame(deliciousness = rnorm(100),\n                  type=sample(as.factor(c(\"peanut\", \"regular\")), 100, replace=TRUE),\n                  color=sample(as.factor(c(\"red\", \"green\", \"yellow\", \"brown\")), 100, replace=TRUE))\n\n\nplot &lt;- ggplot(data=mms, aes(x=deliciousness)) + geom_density() + facet_grid(type ~ color)\n</code></pre>\n"},{"tags":["r","matrix","zero"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13241600,"title":"How to keep the zeros in the characters when I use the function read.fwf in R?","body":"<p>My code is </p>\n\n<pre><code>ff &lt;- tempfile()\ncat(file=ff,\"11220011003\",\"11220011003\",sep=\"\\n\");\nx &lt;- read.fwf(ff,widths=c(2,2,4,3))\n</code></pre>\n\n<p>And I get a matrix like this: </p>\n\n<pre><code>11 22 11  3\n11 22 11  3\n</code></pre>\n\n<p>But the result I want is </p>\n\n<pre><code>11 22 0011 003\n11 22 0011 003\n</code></pre>\n\n<p>How should I correct my code to get the matrix I want?</p>\n"},{"tags":["r","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13235163,"title":"How do I stop R from prepending X to my numeric column labels?","body":"<p>I have a matrix with numeric column labels, for example:</p>\n\n<pre><code>1,2,3\n1,2,3\n4,5,6\n7,8,9\n</code></pre>\n\n<p>When I load this data into a variable in R using <code>as.matrix(read.table(\"myfile\", sep=\",\", header=TRUE)</code> and print the resulting matrix, the column headers have been prepended with X, and this extra character appears in plots and the like:</p>\n\n<pre><code>     X1     X2     X3\n[1,]  1      2      3\n[2,]  4      5      6\n[3,]  7      8      9\n</code></pre>\n\n<p>How can I stop this behaviour?</p>\n"},{"tags":["r","glm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13237940,"title":"Offset not working in binomial GLM","body":"<p>I'm trying to fit a logistic regression using <code>glm( family='binomial')</code>.</p>\n\n<p>Here is the model:  </p>\n\n<pre><code>model&lt;-glm(f_ocur~altitud+UTM_X+UTM_Y+j_sin+j_cos+temp_res+pp, \n           offset=(log(1/off)), data=mydata, family='binomial')\n</code></pre>\n\n<p><code>mydata</code> has 76820 observations.\nThe response variable (f_ocur) is 0-1.<br>\nThis data is a <em>sample</em> of a bigger dataset, so the idea of setting the offset is to account that the data used here represents a sample of the real data to be analysed. </p>\n\n<p>For some reason the offset is not working. When I run this model I get a result, but when I run the same model but without the offset I get the exact same result as the previous model. I was expecting a different result but there is no difference.</p>\n\n<p>Am I doing something wrong? Should the offset be with the linear predictors? like this:           </p>\n\n<pre><code>model &lt;- glm(f_ocur~altitud+UTM_X+UTM_Y+j_sin+j_cos+temp_res+pp+offset(log(1/off)), \n             data=mydata, family='binomial')\n</code></pre>\n\n<p>Once the model is ready, I´d like to use it with new data. The new data would be the data to validate this model, this data has the same columns. My idea is to use:</p>\n\n<pre><code>validate &lt;- predict(model, newdata=data2, type='response')\n</code></pre>\n\n<p>And here comes my question, does the predict function takes into consideration the offset used to create the model? If not, what should I do in order to get the correct probabilities for the new data?</p>\n"},{"tags":["r","concatenation"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13240879,"title":"concatenate numbers in the vector, ensuring that each number will take some space","body":"<p>I have a vector </p>\n\n<pre><code>a&lt;-c(18.123412, 0, 1.5, 34.123, 2.1)\n</code></pre>\n\n<p>And I want to create a string from it.</p>\n\n<pre><code>paste(round(a,3), collapse = \" \" )\n</code></pre>\n\n<p>Everything is working nice, but the problem that I want the output for an each number to be the same, by this I mean the following. Now I have </p>\n\n<pre><code>\"18.123 0 1.5 34.123 2.1\"\n</code></pre>\n\n<p>and I need</p>\n\n<pre><code>\"18.123 0___ 1.5__ 34.123 2.1__\"\n</code></pre>\n\n<p>Here _ denote the idea that because the number has smaller amount of digits, we need to substitute them with space.\nAny idea how I can achieve this?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13239639,"title":"Duplicate 'row.names' error reading table. row.names=NULL shifts columns","body":"<p>This is similar to <a href=\"http://stackoverflow.com/questions/6595673/read-csv-row-names\">read.csv row.names</a> and to <a href=\"http://stackoverflow.com/questions/12425599/duplicated-row-names\">duplicated row.names</a> , but I do not see answers that help.</p>\n\n<p>Problem: Trying to read in a file which contains duplicate numbers in first column, but shifts the column headers when row.names=NULL. </p>\n\n<p>I'm trying to read the following file into R</p>\n\n<pre><code>TripId  VID TspVID  VWT VCLS    Week\n\n201110041426    2226    33889   1   0   41\n\n201110041501    2226    33889   1   0   41\n\n201110041510    2226    33889   1   0   41\n\n201110041557    2226    33889   1   0   41\n</code></pre>\n\n<p>(this is a small excerpt from Excel of a CSV file with many thousands of rows and ~200 columns.  There are the same number of entries in the first row as in all others.  There are duplicates in the first row.  The columns don't line up with the labels in this view, but they do in CSV space.)</p>\n\n<p>The command</p>\n\n<pre><code>&gt; lm.table  &lt;- read.table(file= file.in, sep=\",\", header=TRUE)\nError in read.table(file = file.in, sep = \",\", header = TRUE) : \n  duplicate 'row.names' are not allowed\n</code></pre>\n\n<p>doesn't work.  Using the first column for row.names implies that the first row has less values than the others, which is not the case.  I certainly don't want the first column as row.names.</p>\n\n<p>I try to set row.names=NULL</p>\n\n<pre><code>&gt; lm.table  &lt;- read.table(file= file.in, sep=\",\", header=TRUE, row.names=NULL)\n</code></pre>\n\n<p>which runs, but the columns have been shifted</p>\n\n<pre><code>&gt; head(lm.table)\n\n     row.names TripId   VID TspVID VWT VCLS       Week     Date TimeStart TimeEnd     Lat1\n\n1 201110010006   2226 33889      1   0   40 2011/09/30 17:06:37  17:25:16 47.5168 -122.209\n\n2 201110010028   2226 33889      1   0   40 2011/09/30 17:28:45  17:43:14 47.5517 -122.058\n\n3 201110010000   2231 45781      1   0   40 2011/09/30 17:00:00  18:02:30 32.9010 -117.193\n\n4 201110011407   2231 45781      1   0   40 2011/10/01 07:07:57  07:48:17 32.7044 -117.004\n</code></pre>\n\n<p>Note that the new column name \"row.names has been introduced and the entire row shifted right.  </p>\n\n<p>Here is the tail end of the > head(lm.table) result.  It's shifted the column labels onto an undefined column (I think this also shows the number of column labels = number of columns, which is also true from inspection.)</p>\n\n<pre><code>      FVavR FVstdR FIdlR\n\n1  3.959140      2    NA\n\n2  5.285770     20    NA\n\n3  4.274140     26    NA\n</code></pre>\n\n<p>Any idea why I get the shifting in the columns and how to not shift and have the row.names simply be ascending numbers?</p>\n"},{"tags":["r","graph"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13237916,"title":"Plot 3 lines in one graph","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/10730303/how-to-plot-multiple-lines-in-r\">How to plot multiple lines in R</a>  </p>\n</blockquote>\n\n\n\n<p>I'm new with R. \nI want to plot 3 lines in one graph. \nThis is my data</p>\n\n<pre><code>print(x)\n     V1       V2       V3      V4\n1 -4800 25195.73 7415.219 7264.28\n2 -2800 15195.73 5415.219 7264.28\n</code></pre>\n\n<p>where V1 is the coordinates of the points X and V2 V3 V4 are the Y coordinates for the 3 lines that I want to plot.</p>\n\n<p>Thanks for the help!</p>\n"},{"tags":["r","union","igraph"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13226109,"title":"How to retain vertex names when combining graphs in iGraph?","body":"<p>I'm trying to combine to graphs with <code>graph.union</code> in iGraph, but when I do the resulting graph does not retain its vertex labels.  </p>\n\n<pre><code>testGraph1 = barabasi.game(3, \n    m = 5,\n    power = 0.6, \n    out.pref = TRUE,\n    zero.appeal = 0.5,\n    directed = TRUE)\nV(testGraph1)$name = c('one', 'two', 'three')   \n\ntestGraph2 = barabasi.game(5, \n    m = 5,\n    power = 0.6, \n    out.pref = TRUE,\n    zero.appeal = 0.5,\n    directed = TRUE)    \nV(testGraph2)$name = c('one', 'two', 'three', 'four', 'five')   \n\ncombine = graph.union(testGraph1, testGraph2)\nV(combine)$name #Is NULL\n</code></pre>\n\n<p>I also tried using <code>graph.union.by.name</code>, but I think there's a bug because both of the test graphs are definitely directed but I'm getting a weird error.</p>\n\n<pre><code>combine = graph.union.by.name(testGraph1, testGraph2)\n#Error: !is.directed(g1) &amp; !is.directed(g2) is not TRUE\n</code></pre>\n"},{"tags":["r","colors","ggplot2","scale","data-visualization"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":78,"score":3,"question_id":13221830,"title":"How can I fill the background with a color scale in function of a lineal model?","body":"<p>I'm analysing an example of datavis in \"The Functional Art \" of Alberto Cairo (I recomend to you)</p>\n\n<p>In that book, there are this example</p>\n\n<p><img src=\"http://i.stack.imgur.com/R1bL5.png\" alt=\"http://img546.imageshack.us/img546/8327/snap1026.png\"></p>\n\n<p>And I try in R. In the bottom left graph (scatter plot)</p>\n\n<p>I use the data from the book, and i calculate the efectives militaries in function of population with <code>lm(efect ~ pop)</code> and the budget in function of population + efect</p>\n\n<p>And here is the question: How can I paint the background of the scatterplot with colorscale (gradient) where the color represent the value of BUDGET?</p>\n\n<p>After that I want to put the points (population, efects) with the color of the budget.\nIn this way, I can compare the budget of the country with the stimated budget in function of population + efect</p>\n\n<p>I know basic R, I have installed <strong>ggplot2</strong> and <strong>scales</strong> packages</p>\n\n<p>I want a graph similar to</p>\n\n<p><img src=\"http://i.stack.imgur.com/U7uTi.png\" alt=\"enter image description here\"></p>\n\n<p>but with the correct colors. </p>\n\n<p>Thank you.</p>\n"},{"tags":["r","model","svm","floating"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":24,"score":-1,"question_id":13237380,"title":"SVM on float datasets in R (resolved)","body":"<p>I have read a simple instruction of SVM in R and the example showed in this link.\n<a href=\"http://planatscher.net/svmtut/svmtut.html\" rel=\"nofollow\">http://planatscher.net/svmtut/svmtut.html</a></p>\n\n<p>In this example, all the numeric data are integer. The result is,</p>\n\n<pre><code>pred             benign   malignant\n      benign       446         5\n      malignant     12       236\n</code></pre>\n\n<p>I simply copied this program and used my datasets what are float type. But the output result confused me.</p>\n\n<pre><code>pred                   0 1\n  -0.0073402637514991  1 0\n  -0.00209152512582178 1 0\n  0.00394879392844333  0 1\n  0.0514435817920311   1 0\n  0.0767218906381403   1 0\n  0.173737199282672    1 0\n  0.272802021017386    0 1\n  0.277712551740357    1 0\n  0.296655542722117    1 0\n  0.301822255313875    1 0\n  0.413510881580231    0 1\n  0.511559463233687    1 0\n  0.924899162774121    0 3\n  0.948411755474413    0 2\n  0.948845746300719    0 1\n  0.985487570406757    0 1\n  0.989107559370754    1 0\n</code></pre>\n\n<p>My datasets like this</p>\n\n<pre><code>\"Number01\",\"2012-11-05\",11,2,15,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.01011804384,1.1686143577,1\n\"Number02\",\"2012-11-05\",11,39,0,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.01517706577,1.16279069711,1\n...\n...\n\"Number19\",\"2012-11-05\",12,18,15,1.001404741,1.001404741,1.00158033363,1.00158033363,1.00158033363,1.00158033363,1.00158033363,1.00158033363,1.00158033363,1.00158033363,1.00175592625,1.00175592625,1.00175592625,1.00175592625,1.00175592625,1.00175592625,1.00175592625,1.00175592625,1.00175592625,1.00175592625,0.0175284842743,0\n\"Number20\",\"2012-11-05\",9,49,0,1.00032015367,1.00032015367,1.00032015367,1.00032015367,1.00032015367,1.00032015367,1.00032015367,1.00032015367,1.00032015367,1.00032015367,1.00048023051,1.00048023051,1.00048023051,1.00048023051,1.00048023051,1.00048023051,1.00048023051,1.00048023051,1.00048023051,1.00048023051,0.143999999807,0\n</code></pre>\n\n<p>For my datasets, I only use the data from the 6th field to 25th field for datacall, and the 27th field for class.\nHere is my program,</p>\n\n<pre><code>library('e1071')\nclassifydata &lt;- read.csv(file = \"uniqTest\",head = FALSE,sep = \",\",fill = TRUE,blank.lines.skip = TRUE)\nnames(classifydata)\ndatacall &lt;- subset(classifydata,select=c(-V1,-V2,-V3,-V4,-V5,-V26,-V27))\nclasscall &lt;- subset(classifydata,select=V27)\ndatatrain &lt;- datacall[,]\nclasstrain &lt;- classcall[,]\nmodel &lt;- svm(datatrain,classtrain)\npred &lt;- predict(model, datatrain)\ntable(pred,t(classtrain))\n</code></pre>\n\n<p>Please help me that why I can't get the correct result? Is there any option for float values in SVM model? Thanks a lot. </p>\n"},{"tags":["r","type-conversion"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":461,"score":5,"question_id":8596466,"title":"R change all columns of type factor to numeric","body":"<p>I have a data frame that is 100 X 100.  There are 30 columns that are factors.  Is there a way to switch only factor-type columns to numeric type without affecting the other columns (without going the loop route)?</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":49,"score":-5,"question_id":13239356,"title":"R: How can I export multiple plots as a pdf in R?","body":"<p>How can I export multiple plots as a pdf in R ?\nDoes anyone know What is the command for this ? Thanks</p>\n"},{"tags":["r","save","data.frame"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":83,"score":3,"question_id":13206876,"title":"Saving and loading data.frames","body":"<p>I have made a dataframe based on a set of twitters in the following form:</p>\n\n<pre><code> rdmTweets &lt;- userTimeline(\"rdatamining\", n=200)\n df &lt;- do.call(\"rbind\", lapply(rdmTweets, as.data.frame))\n</code></pre>\n\n<p>Now I am saving the data frame with save in this way:</p>\n\n<pre><code> save(df, file=\"data\")\n</code></pre>\n\n<p>How I can load that saved data frame for future use? When I use:</p>\n\n<pre><code>  df2 &lt;- load(\"data\")\n</code></pre>\n\n<p>and I apply <code>dim(df2)</code> it should return the quantity of tweets that data frame has, but it only shows 1.</p>\n"},{"tags":["r","pdf","plot","export","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13239336,"title":"Exporting individual pdf's for each plot created from a single file in R (using lattice)","body":"<p>So I have a fairly large dataset of GPS locations corresponding to different individuals at different times. It looks like a more complicated version of this...</p>\n\n<pre><code>ID________________Year________________Julian.date________________Distance\n\n1_________________2003______________________15_____________________200\n\n1_________________2004______________________20_____________________500\n\n1_________________2005______________________24_____________________462\n\n1_________________2006______________________28_____________________51\n\n2_________________2002______________________12_____________________248\n\n2_________________2003______________________15_____________________571\n\n2_________________2004______________________16_____________________685\n\n3_________________2003______________________20_____________________521\n\n3_________________2004______________________25_____________________1251\n\n3_________________2005______________________29_____________________225\n\n3_________________2006______________________54_____________________144\n</code></pre>\n\n<p>What I am trying to do is separate the data out by year and individual. So each individual with have a boxplot of their Distances and the corresponding Julian date. I am able to create a massive pdf of all the plots (12X11) on one sheet using the lattice package (Separator is a column combining the ID and Year columns)..</p>\n\n<pre><code>&gt; barchart(Julian.date~Distance|factor(Separator),data=data)\n</code></pre>\n\n<p>This isn't particularly helpful as I can't do much with such a massive pdf. So I tried restricting the number of plots per sheet to 1 using...</p>\n\n<pre><code>&gt; barchart(Julian.date~Distance|factor(Separator),data=data,layout=c(1,1))\n</code></pre>\n\n<p>Which results in all the plots flying past me and none of them exporting to pdf. I have tried searching for a way to accomplish this, but so far no luck. If anyone knows a way of getting these to export as they fly past I would be extremely thankful.</p>\n\n<p>So thanks in advance if anyone out there can help out. And if you need any more information, let me know, I tend not to use the terminology properly.</p>\n\n<p>Ayden</p>\n"},{"tags":["r","ggplot2","adobe-illustrator"],"answer_count":3,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":769,"score":8,"question_id":9992275,"title":"ggplot2 pdf import in Adobe Illustrator missing font AdobePiStd","body":"<p>I created several simple ggplot2 plots and saved them to PDF files using the following commands:</p>\n\n<pre><code>p &lt;- ggplot(plotobject, aes(x=Pos, y=Pval),res=300)\nggsave(plot=p,height=6,width=6,dpi=200, filename=\"~/example.pdf\")\n</code></pre>\n\n<p>If I now open this example.pdf in Adobe Illustrator I get the following error:</p>\n\n<blockquote>\n  <p>The font AdobePiStd is missing.  Affected text will be displayed using\n  a substitute font.</p>\n</blockquote>\n\n<p>Is there a way in ggplot2 to specify a font (I presume this is for the dots/points) that Adobe will understand or otherwise is there a way to get this font working in Adobe? </p>\n\n<p>/edit just to clarify, the text/labels/titles are all just fine its the dots that are missing for the font \n/edit2 I got a working solution by just using the EPS output in ggsave, but still would love to find out a way to also be able to just open/import ggplot2 plots in PDF format directly in AI</p>\n"},{"tags":["r","data-visualization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13237316,"title":"hexbin data aggregation with color and size attributes","body":"<p>I am interested in displaying \"large n\" ordinal scale survey response information across 2 covariates (consumer attribute and provider attribute). I am using R's hexbin package. I would like to have the size of the hexagon indicate the number of survey responses and the color of the hexagon to represent the linear mean satisfaction response.</p>\n\n<p>I can't seem to find documentation indicating how one would do so with either the hexbin or other existing packages.</p>\n\n<p>EDIT for more clarification:</p>\n\n<p>My data is structured like the following:</p>\n\n<pre><code>csr_score pro_score rating\n       15        16      8\n       17        18     10\n       19        12      4\n</code></pre>\n\n<p>where the length of this data frame is 20,000 rows.</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13238273,"title":"uneven spacing on axis with R","body":"<p>I have a problem in plotting uneven scale plot on x axis with R</p>\n\n<p>Here is an example:</p>\n\n<pre><code>plot(1:100,1:100)\n</code></pre>\n\n<p>will give the equal tick space on x axis. </p>\n\n<p>However, I want to show the graph with first half of space showing 1 to 10, and the left half space showing 10 to 100, so the points in the 10 to 100 more dense, and points in <code>1:10</code> are easier to see. How  to do it with R?</p>\n\n<p>Like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/ef16K.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","ggplot2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13237697,"title":"plotting times with ggplot: added hour in plot maybe due to daylight saving?","body":"<p>Forgive me if this is already answered, but I cannot find the question in the archives.</p>\n\n<p>I am trying to plot some data with times on x axis. The problem is that it plots the times with an extra hour added. E.g. 7pm becomes 8pm in the plot. I think this might be due to the fact that the dates are in daylight saving time period (april-october). When I change the dates to for example November, ggplot2 plots it fine. How can I fix this? As the time in the dataframe is the correct time (no need for +1 hour). I know I can just create a new column where it is time -1 hour but it seems that ggplot2 should just plot it at the right time from the start.</p>\n\n<p>Thanks!</p>\n\n<p>the code with some random data:</p>\n\n<pre><code>library(lubridate)\nlibrary(ggplot2)\nee = read.table(textConnection('Timestamp Temp.Diff\n  \"5/14/2011 19:00\" -0.385\n  \"5/14/2011 19:10\" -0.535\n  \"5/14/2011 19:20\" -0.484\n  \"5/14/2011 19:30\" -0.409\n  \"5/14/2011 19:40\" -0.385\n  \"5/14/2011 19:50\" -0.215'), header=TRUE)\nee$Timestamp &lt;- mdy_hm(ee$Timestamp)\nggplot(data=ee, aes(x=Timestamp, y=Temp.Diff)) + geom_point()\n</code></pre>\n\n<p><img src=\"http://i.imgur.com/sBOIX.png\" alt=\"plot showing added hour\"></p>\n"},{"tags":["r","cube-root"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":13236158,"title":"real cube root of a negative number in R","body":"<p>I'm trying to see if there is a function to directly get the real cube root of a negative number. For example, in <a href=\"http://stackoverflow.com/questions/8290804/cube-root-of-a-negative-number\">Java</a>, there is the <code>Math.cbrt()</code> function. I'm looking for the equivalent in R.</p>\n\n<p>Otherwise, my current hack is </p>\n\n<pre><code>x &lt;- -8\nsign(x) * abs(x)^(1/3)\n</code></pre>\n\n<p>which is very inelegant and cumbersome to type everytime. Thx!</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13236554,"title":"loading package error message - mac os x","body":"<p>I'm a relatively novice user trying to install package NMF_0.2.2.tar from the cran archive.</p>\n\n<p>I'm getting an error message which seems to relate to machine architecture, and I'm not sure how to address it.\nSearching here and on google didn't provide a fix.\nThe installation command and error message is below.</p>\n\n<p>I'm running R version 2.15.2 under Mac OS X 10.6.8 on an Intel Core 2 Duo Macbook Pro.\nI haven't heard back from the package maintainer, perhaps he's no longer available to maintain it which is why it's archived.\nAny help would be appreciated as I have some older results from using this package and would like to finish that investigation.</p>\n\n<p>Thank you.</p>\n\n<h1>------------------------------------------------</h1>\n\n<p>sudo -E R CMD INSTALL ~/Downloads/NMF_0.2.2.tar</p>\n\n<ul>\n<li><p>installing to library '/Library/Frameworks/R.framework/Versions/2.15/Resources/library'</p></li>\n<li><p>installing <em>source</em> package 'NMF' ...</p></li>\n</ul>\n\n<p>** R</p>\n\n<p>** data</p>\n\n<p>** inst</p>\n\n<p>** preparing package for lazy loading</p>\n\n<p>Creating a generic function for 'residuals' from package 'stats' in package 'NMF'\n** help</p>\n\n<p><em>*</em> installing help indices</p>\n\n<p>** building package indices</p>\n\n<p>** installing vignettes</p>\n\n<p>'NMF-vignette.Rnw'\n** testing if installed package can be loaded</p>\n\n<p><em>*</em> arch - i386</p>\n\n<p>Error : .onLoad failed in loadNamespace() for 'NMF', details:</p>\n\n<p>call: is.list(...)</p>\n\n<p>error: supplied argument name 'default.algorithm' does not match 'x'</p>\n\n<p>Error: loading failed</p>\n\n<p>Execution halted</p>\n\n<p><em>*</em> arch - x86_64</p>\n\n<p>Error : .onLoad failed in loadNamespace() for 'NMF', details:</p>\n\n<p>call: is.list(...)</p>\n\n<p>error: supplied argument name 'default.algorithm' does not match 'x'</p>\n\n<p>Error: loading failed</p>\n\n<p>Execution halted</p>\n\n<p>ERROR: loading failed for 'i386', 'x86_64'</p>\n\n<ul>\n<li>removing '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/NMF'</li>\n</ul>\n"},{"tags":["python","r","google-scholar"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":86,"score":3,"question_id":13200709,"title":"Extract Google Scholar results using Python (or R)","body":"<p>I'd like to use python to scrape google scholar search results. I found two different script to do that, one is [<code>gscholar.py</code>](<a href=\"https://github.com/venthur/gscholar\" rel=\"nofollow\">link</a>) and the other is <code>scholar.py</code> (can that one be used as a python library?). </p>\n\n<p>Now, I should maybe say that I'm totally new to python, so sorry if I miss the obvious! </p>\n\n<p>The problem is when I use <code>gscholar.py</code> as explained in the README file, I get as a result </p>\n\n<p><code>query() takes at least 2 arguments (1 given)</code>. </p>\n\n<p>Even when I specify another argument (e.g. <code>gscholar.query(\"my query\", allresults=True)</code>, I get </p>\n\n<p><code>query() takes at least 2 arguments (2 given)</code>. </p>\n\n<p>This puzzles me. I also tried to specify the third possible argument (<code>outformat=4</code>; which is the BibTex format) but this gives me a list of function errors. A colleague advised me to import BeautifulSoup and <a href=\"http://code.activestate.com/recipes/523047-search-google-scholar/\" rel=\"nofollow\">this</a> before running the query, but also that doesn't change the problem. Any suggestions how to solve the problem?</p>\n\n<p>I found code for R (see <a href=\"http://www.github.com/gimoya/theBioBucket-Archives/blob/master/R/Functions/GScholarScraper_3.1.R\" rel=\"nofollow\">link</a>) as a solution but got quickly blocked by google. Maybe someone could suggest how improve that code to avoid being blocked? Any help would be appreciated! Thanks!</p>\n"},{"tags":["r","boxplot"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13232600,"title":"Plot boxplot in R with temperature records by years and months","body":"<p>I have a dataset with temperature records like:</p>\n\n<pre><code>    row.names   Collection_date temprature  col_yr  col_mnth\n    1   1       4-Aug-04          27        2004    8\n    2   2       9-Aug-04          26        2004    8\n    3   3       4-Aug-04          27        2004    8\n    4   4       9-Aug-04          26        2004    8\n    5   5       9-Aug-04          26        2004    8\n    6   6       9-Aug-04          26        2004    8\n...\n1031 1031       6-Aug-06          32        2006    8\n</code></pre>\n\n<p>I want to create boxplot in R with x axis like:</p>\n\n<pre><code>1 2 3 4 5 6 7 8 9 10 11 12 1 2 3 4 5 6 7 8 9 10 11 12 ...\n        2004                         2005 \n</code></pre>\n"},{"tags":["r","outofmemoryexception","random-forest"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13236005,"title":"Memory error using rfimpute from randomForest package in R","body":"<p>I want to try to fill in my missing values in a data set im currently working on. The data has 13300 observations and 9 features. I want to run a random forest so I tried using rfimpute to fill in these missing values. I get the following error: cannot allocate vector of size 678.4 Mb. I'm running this on a windows machine with 8 gbs of ram. This is the call that I do:</p>\n\n<pre><code>datos.imputados &lt;- rfImpute(vo~P4.Plan.Esp+P11.Comprador+SegmentoDisipado+PersMcKinsey+Kids+IndefDulceSal+lugarcons+Compania,data=datos,ntrees=300,iter=6)\n</code></pre>\n\n<p>¿What is going on here? 670 mbs doesnt sound like a lot...</p>\n"},{"tags":["html","r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13235968,"title":"R Custom HTTP Handler - Rook","body":"<p>I am building this app using the Rook package in R:</p>\n\n<pre><code>library(Rook) \n\ns &lt;- Rhttpd$new()\n\ns$start(quiet=T)\n\nPIC.DIR = paste(getwd(), 'pic', sep='/')\n\nmy.app &lt;- function(env){\n  ## Start with a predefined lognormal mean and median, and allow a user to input custom values\n  req &lt;- Request$new(env)\n  res &lt;- Response$new()\n\n  E &lt;- 1.5\n  MED &lt;- 1\n  xmax &lt;- 5\n  breaks &lt;- 500\n  ## Allow user to input custom mean/median values\n  if (!is.null(req$POST())){\n    E &lt;- as.numeric(req$POST()[[\"mean\"]])\n    MED &lt;- as.numeric(req$POST()[[\"median\"]])\n    xmax &lt;- as.numeric(req$POST()[[\"xmax\"]])\n    breaks &lt;- as.numeric(req$POST()[[\"breaks\"]])\n  }\n\n  mu &lt;- log(MED)\n  sd &lt;- sqrt(2*log(E/MED))\n  MO &lt;- exp(mu - sd^2)\n\n  rate &lt;- rlnorm(1000000, mu, sd)\n\n  today &lt;- Sys.Date()\n  dt &lt;- format(today, format=\"%m/%d/%y\")\n  sc &lt;- paste(\"Source: My Source, accessed \", dt)\n\n  png(file=paste(PIC.DIR, \"/mypic.png\", sep=\"\"), width=1024, height=612)\n  h1 &lt;- hist(rate, freq=F, col=\"red\", xlim=c(0,xmax), breaks=breaks, main=\"Rate\",\n         xlab=\"Rate\", ylab=\"# of Studies\", sub=sc)\n  dev.off()\n\n\n  res$write('&lt;head&gt; \n          &lt;title&gt; Rate Curve &lt;/title&gt;\n         &lt;/head&gt;\n        &lt;h1&gt;Rate Distribution Analysis&lt;/h1&gt;')\n  res$write(paste(\"&lt;img src='\", s$full_url(\"pic\"), \"/mypic.png'\", \n        \"width='1024 px' height='612 px' /&gt;\", sep = \"\"))\n  res$write('&lt;p&gt;\n        Input Lognormal Parameters:&lt;form method=\"POST\"&gt; &lt;/br&gt;\n        mean: &lt;input type=\"text\" name=\"mean\" value=\"1.5\" /&gt; &lt;/t&gt;\n        median: &lt;input type=\"text\" name=\"median\" value=\"1\" /&gt; &lt;/br&gt;\n        &lt;/br&gt;\n        Graphics parameters &lt;/br&gt;\n        X-axis limit: &lt;input type=\"text\" name=\"xmax\" value=\"5\" /&gt; &lt;/t&gt;\n        Histogram breaks: &lt;input type=\"text\" name=\"breaks\" value=\"500\" /&gt; &lt;/br&gt;\n        &lt;input type=\"submit\" name=\"Go\" /&gt;\\n&lt;/form&gt;\n        &lt;/p&gt;')\n  res$finish()\n\n}\n\ns$add(app=my.app, name='lognorm')\ns$add(app = File$new(PIC.DIR), name = \"pic\")\ns$browse('lognorm')\n</code></pre>\n\n<p>The browser initially loads fine, but when I try to enter different values in the inputs, I get this error:</p>\n\n<p>R Custom HTTP Handler Not Found</p>\n\n<p>Unable to locate custom HTTP handler for /custom/lognorm_mode</p>\n\n<p>Is the package which implements this HTTP handler loaded?</p>\n\n<p>Any ideas on how to solve this? Thanks, </p>\n"},{"tags":["r","data","plot","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13233249,"title":"Use row-names of a data.frame in R-plots?","body":"<p>I have data for several (here: 2) plots, which both have the same x-values. I thought, that it might be nice to have a data.frame, that has those x-values als row-names.</p>\n\n<pre><code># initialize the datafrane with x-values as row names\ntest = data.frame(\n  row.names = c(1,2,3,3.5,4,5)\n  )\n\n# Add data\ntest = cbind(test, c(1:6))\ntest = cbind(test, a=c(3, 4, 2, 1, 4, 5))\n\nstr(test)\ntest[1]\n\n# try plotting\nplot(test[1])\n</code></pre>\n\n<p>How can I get the row-names as x-values? Do I need to add an extra variable for the x-values? If so: what are row-names used for?</p>\n"},{"tags":["r","formula"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13234575,"title":"How to represent a matrix symbolically in R","body":"<p>Consider the following matrix </p>\n\n<pre><code>&gt; A\n   a  b  k\na  1  0  0\nb  0  1  0\nc  2  3  0\nd -1 -1 10\n</code></pre>\n\n<p>it is to be interpreted as a series of equations:</p>\n\n<pre><code>a = a\nb = b\nc = 2*a + 3*b\nd = 10 - a - b\n</code></pre>\n\n<p>I have a function that accepts such a matrix as argument, however it would be nice if the function could accept the equations themselves instead of a matrix and build the matrix using the information supplied via formulas. I have been reading the R documentation about various formula-related functions, including <code>terms()</code>, <code>model.matrix()</code> and others, and does not look like what I want to do can be done in a straightforward manner.</p>\n\n<p>What do you think, is it doable with a reasonable amount of work or should I ditch the idea?</p>\n"},{"tags":["r","excel","data.frame","numeric"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":34,"score":-1,"question_id":13233823,"title":"Excel misses values from numeric vector with write.table function in R","body":"<p>I am trying to save a data.frame from R so that it can be read from Excel. I have done this with several other data.frames that have the same structure as the one I refer to now, so far without problems. But for some reason when I try to save this data.frame and then open it with Excel, many of the numerical values in the columns FreqDev and LengthDev are not read by Excel. Instead, the rows show a string of \"#\" symbols. </p>\n\n<p>My data.frame looks like this:</p>\n\n<pre><code>head(RegPartV)\n     LogFreq     Word   PhonCV WordClass  FreqDev  LengthDev Irregular\n1277  28.395  geweest CV-CVVCC         V 5.464336 -1.1518498     FALSE\n903   25.647  gemaakt CV-CVVCC         V 4.885296 -1.1518498     FALSE\n752   23.304    gehad   CV-CVC         V 4.391595 -2.1100420     FALSE\n610   22.765 gebracht CV-CCVCC         V 4.278021 -0.6727537     FALSE\n1312  22.041   gezegd  CV-CVCC         V 4.125465 -1.6309459     FALSE\n647   21.987   gedaan  CV-CVVC         V 4.114086 -1.6309459     FALSE\n</code></pre>\n\n<p>The type of information in the data.frame is:</p>\n\n<pre><code>str(RegPartV)\n'data.frame':   2096 obs. of  7 variables:\n $ LogFreq  : num  28.4 25.6 23.3 22.8 22 ...\n $ Word     : chr  \"geweest\" \"gemaakt\" \"gehad\" \"gebracht\" ...\n $ PhonCV   : chr  \"CV-CVVCC\" \"CV-CVVCC\" \"CV-CVC\" \"CV-CCVCC\" ...\n $ WordClass: Factor w/ 1 level \"V\": 1 1 1 1 1 1 1 1 1 1 ...\n $ FreqDev  : num  5.46 4.89 4.39 4.28 4.13 ...\n $ LengthDev: num  -1.152 -1.152 -2.11 -0.673 -1.631 ...\n $ Irregular: logi  FALSE FALSE FALSE FALSE FALSE FALSE ...\n</code></pre>\n\n<p>What is strange is that if I put my mouse over the numerical cells that now have only # symbols (in the excel file), I see a trace of the numbers that used to be there in the original R data.frame. For example, the values of these columns for the first row in the data.frame are:</p>\n\n<pre><code>&gt;RegPartV[1,c(5,6)]\n      FreqDev LengthDev\n1277 5.464336  -1.15185\n</code></pre>\n\n<p>And if I put my mouse over the Excel cells (that contain only # symbols)  corresponding to the same values I just showed, I see: </p>\n\n<pre><code>54643356148468 \n</code></pre>\n\n<p>and</p>\n\n<pre><code>-115184982188519\n</code></pre>\n\n<p>So the numbers are still there, but for some reason either R or Excel lost count of where the decimal was. </p>\n\n<p>The method I am using to save the data.frame (and that I've used for structurally equivalent data.frame) is:</p>\n\n<pre><code>write.table(RegPartV,file=\"RegPartV\",quote=F,sep=\"\\t\",row.names=F,col.names=T)\n</code></pre>\n\n<p>Then I open the file with Excel and I would expect to see all the info there, for some reason I'm having this numeric problem with this particular data.frame. </p>\n\n<p>Any suggestions to get an Excel-readable data.frame are very welcome.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["r","export-to-excel","xlsx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13224692,"title":"R XLConnect package keeps creating corrupt files","body":"<p>I am trying to use the XLConnect package with R to import some Excel data, make some modifications and then save it. Every time I do this though it corrupts the file. I tried to do the most basic thing of creating a Workbook with XLConnect and then immediately save it but even the files XLConnect is creating are corrupt. Every time I try to open them in Excel I only get an error. Here is the very simple code that I am using to try to create a file and then save it.</p>\n\n<pre><code>library(rJava)\nlibrary(XLConnectJars)\nlibrary(XLConnect)\n\nwb.new &lt;- loadWorkbook(\"myNewExcelFile.xlsx\", create= TRUE)\nsaveWorkbook(wb.new)\n</code></pre>\n\n<p>Every time I do this Excel give me an error saying the file was corrupted. I can create the Workbook object in R and manipulate it but I can't save it without corruption. This is my environment:</p>\n\n<blockquote>\n  <p>Windows 7 Pro 64-bit</p>\n  \n  <p>Java 1.7.0_06 64-bit</p>\n  \n  <p>RStudio ver. 0.96.331</p>\n  \n  <p>R ver. 2.15.2 64-bit</p>\n</blockquote>\n"},{"tags":["r","plot"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13234824,"title":"output text and a matrix in the plot in R","body":"<p>I have the following problem:</p>\n\n<p>I need to create a picture which consists of a plot, histogram, specific text and example of a matrix. I found a way how to do part of the task:</p>\n\n<pre><code>    png('Erdos-Renyi.png', width=800, height=800)\n    par(mfrow=c(2,2))\n    plot(g, main=paste('Erdos-Renyi model, V=', V, ' E=',E, sep=\"\"))\n    hist(degree(g))\n    ...\n    dev.off()\n</code></pre>\n\n<p>In two additional plots I would like to output a text and a matrix. I tried to achieve this with <code>text</code> and <code>mtext</code> commands, but with no success.</p>\n\n<p><img src=\"http://i.stack.imgur.com/obG9e.png\" alt=\"image \"></p>\n\n<p>Here is an example of what I am trying to achieve.</p>\n"},{"tags":["r","statistics","missing-data"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":49,"score":-1,"question_id":13234005,"title":"Filling missing values","body":"<p>I have a dataset like this</p>\n\n<pre><code> 4  6 18 12  4  5\n 2  9  0  3 NA 13\n11 NA  6  7  7  9\n</code></pre>\n\n<p>How I can fill the missing values using R?</p>\n"},{"tags":["r","confidence-interval","pca"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":116,"score":2,"question_id":12063270,"title":"R PCA plot using Hotelling's T2 for a confidence interval","body":"<p>For my test data, I calculated the first two principal components using the <code>prcomp</code> function. I then plotted the first 2 components using the plot function.</p>\n\n<pre><code>df &lt;- data.frame(x1 = runif(10), x2 = runif(10), x3 = runif(10), x4 = runif(10))\nrownames(df) &lt;- letters[1:10]\n\nres &lt;- prcomp(df, center = TRUE, scale = TRUE, na.action = na.omit)\n\nplot(res$x, xlim = c(-5, 5), ylim = c(-5, 5))\n</code></pre>\n\n<p>I now would like to place an ellipse around the data that represens a 95% confidence interval using Hotelling's T2 statistic.</p>\n\n<p>The <code>SensoMineR</code> package in particular the <code>panellipse</code> function seems to be what I am looking for. However, my R knowledge is still quite limited and I was therefore wondering if you could point me in the right direction on to construct such a confidence interval.</p>\n\n<p>Many thanks!\nJacky</p>\n"},{"tags":["r","graphics","graph","plot","postscript"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":24,"score":-1,"question_id":13233898,"title":"Using dev.new() with postscript()","body":"<p>How can I fix the following code?</p>\n\n<pre><code>postscript(\"test.eps\")\n    dev.new(width=5,height=2)\n    plot(1:10)\ndev.off()\n</code></pre>\n\n<p>Obviously I want to export this small height plot to an <code>eps</code> file. Right now a completely blank <code>.eps</code> will be exported.</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":70,"score":4,"question_id":13223846,"title":"ggplot2 two-line label with expression","body":"<p>I'd like to write an axis label over two lines with an <code>expression()</code> statement. However, <code>plotmath</code> and <code>expression</code> won't allow this (e.g. subscripted text appears on the far right). I found <a href=\"https://stat.ethz.ch/pipermail/r-help/2005-February/066776.html\" rel=\"nofollow\">this discussion</a> circa 2005 of a similar issue but the work around that they offer doesn't translate to my application in ggplot2. <a href=\"http://stackoverflow.com/questions/13198170/combining-expression-with-n\">A recent question</a> addressed a a different permutation of multi-line expression statements, but again the work around provided doesn't apply here.</p>\n\n<p>Example:</p>\n\n<pre><code>p &lt;- ggplot(mtcars,aes(x=wt,y=mpg))+\n  geom_point()+\n  xlab(expression(paste(\"A long string of text goes here just for the purpose \\n of illustrating my point Weight \"[reported])))\ntry(ggsave(plot=p,filename=&lt;some file&gt;,height=4,width=6))\n</code></pre>\n\n<p>yields an image where subscript \"reported\" is kicked out to the right when I'd like it to sit next to the previous word.\n<img src=\"http://i.stack.imgur.com/n0uHU.png\" alt=\"ggplot2 two line label with expression\"></p>\n"},{"tags":["r","label","point","scatter-plot"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13229546,"title":"How can i label points in this scatterplot?","body":"<p>Can you help me on putting labels on the following graph?</p>\n\n<p><img src=\"http://i.stack.imgur.com/7hCZw.png\" alt=\"http://img849.imageshack.us/img849/7594/snap1034.png\"></p>\n\n<p>The code i use is:  </p>\n\n<pre><code>valbanks&lt;-scan(\"banks.txt\", what=list(0,0,\"\"), sep=\"\", skip=1, comment.char=\"#\")\nvalbanks\n\nvalj2007&lt;-valbanks[[1]]\nvalj2009&lt;-valbanks[[2]]\nnamebank&lt;-valbanks[[3]]\n\npercent_losses&lt;-(valj2009-valj2007)/valj2007\npercent_losses\n\nabs_losses&lt;-(valj2007-valj2009)\nabs_losses\n\nplot(abs_losses, percent_losses,main=\"Absolute Losses vs. Relative Losses(in%)\",xlab=\"Losses (absolute, in miles of millions)\",ylab=\"Losses relative (in % of January´2007 value\",col=\"blue\", pch = 19, cex = 1, lty = \"solid\", lwd = 2,text(percet_losses, abs_losses,namebank))\n\ntext(percet_losses, abs_losses,labels=namebank, cex= 0.7, offset = 10)\n</code></pre>\n\n<p>and the data is:</p>\n\n<pre><code>Value_Jan_2007  Value_Jan_2009  Bank    #\n49  16  Morgan_Stanley\n120 4.6 RBS\n76  10.3    Deutsche_Bank\n67  17  Credit_Agricole\n80  26  Societé_Generale\n91  7.4 Barclays\n108 32.5    BNP-Paribas\n93  26  Unicredit\n116 35  UBS\n75 27   Credit_Suise\n100 35  Goldman_Sachs\n116 64  Santander\n255 19  Citigroup\n165 85  JP_Morgan\n215 97  HSBC\n</code></pre>\n\n<p>Thank you very much</p>\n\n<p>What is the option to put the label at the bottom, right, up, left,... ?</p>\n\n<p>Summarizing: I want a graph similar that the one that is in the second message from <a href=\"http://stackoverflow.com/questions/7611169/intelligent-point-label-placement-in-r\">this post</a>\nbut there is no the code there.</p>\n\n<p>What code i have to put?</p>\n\n<hr>\n\n<p>if i put <code>text(percet_losses, abs_losses,namebank)</code>, i obtain nothing: the graph continue without changes.</p>\n\n<p>Could you show me the code i need to put?</p>\n\n<p>Thanks</p>\n"},{"tags":["r","data.frame","data.table","plyr"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":78,"score":5,"question_id":13220395,"title":"how to operate with a subset of an R dataframe in long format?","body":"<p>I have a data frame with 3 groups and 3 days:</p>\n\n<pre><code>set.seed(10)\ndat &lt;- data.frame(group=rep(c(\"g1\",\"g2\",\"g3\"),each=3), day=rep(c(0,2,4),3), value=runif(9))\n#   group day    value\n# 1    g1   0 0.507478\n# 2    g1   2 0.306769\n# 3    g1   4 0.426908\n# 4    g2   0 0.693102\n# 5    g2   2 0.085136\n# 6    g2   4 0.225437\n# 7    g3   0 0.274531\n# 8    g3   2 0.272305\n# 9    g3   4 0.615829\n</code></pre>\n\n<p>I want to take the log2 and divide each value with the day 0 value within each group. The way I'm doing it now is by calculating each day group in an intermediate step:</p>\n\n<pre><code>day_0 &lt;- dat[dat$day==0, \"value\"]\nday_2 &lt;- dat[dat$day==2, \"value\"]\nday_4 &lt;- dat[dat$day==4, \"value\"]\nres &lt;- cbind(0, log2(day_2/day_0), log2(day_4/day_0))\nrownames(res) &lt;- c(\"g1\",\"g2\",\"g3\")\ncolnames(res) &lt;- c(\"day_0\",\"log_ratio_day_2_day_0\",\"log_ratio_day_4_day_0\")\n#    day_0 log_ratio_day_2_day_0 log_ratio_day_4_day_0\n# g1     0            -0.7261955             -0.249422\n# g2     0            -3.0252272             -1.620346\n# g3     0            -0.0117427              1.165564\n</code></pre>\n\n<p>What's the proper way of calculating <code>res</code> without an intermediate step?</p>\n"},{"tags":["r","sum","data.frame","chr"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13227460,"title":"Sum columns with a column as a chr type","body":"<p>I have something like this:</p>\n\n<pre><code>Date        Point1 Point2 Point3\n01-03-2000     23     57    98\n02-03-2000     67     36    77 \n03-03-2000     67     25    47 \n... \n</code></pre>\n\n<p>I wanna get the sum of each column with a function like <code>colSums</code>, but my first column it isn't numeric, is a character type. How do I get the sum?</p>\n"},{"tags":["r","data.table","sequences"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13230696,"title":"Create unique identifier for different row-groups","body":"<p>I want to number certain combinations of row in a dataframe (which is ordered on ID and on Time)</p>\n\n<pre><code>tc &lt;- textConnection('\nid              time       end_yn   number\nabc             10         0        1\nabc             11         0        2\nabc             12         1        3 \nabc             13         0        1 \ndef             10         0        1\ndef             15         1        2\ndef             16         0        1\ndef             17         0        2\ndef             18         1        3\n')\n\ntest &lt;- read.table(tc, header=TRUE)\n</code></pre>\n\n<p>The goal is to create a new column (\"<code>journey_nr</code>\") that give a unique number to each row based on the journey it belongs to. Journeys are defined as a sequence of rows per <code>id</code> up until to <code>end_yn == 1</code>, also if <code>end_yn</code>never becomes 1, the journey should also be numbered (see the expected outcome example). It is only possible to have <code>end_yn == 0</code> journeys at the end of a collection of rows for an ID (as shown at row 4 for id 3). So either no <code>end_yn == 1</code> has occured for that ID or that happened before the <code>end_yn == 0</code>-journey (see <code>id == abc</code> in the example).</p>\n\n<p>I know how to number using the <code>data.table</code> package, but I do not know which columns to combine in order to get the expected outcome. I've searched the <code>data.table</code>-tag on SO, but could not find a similar problem. </p>\n\n<p>Expected outcome:</p>\n\n<pre><code>id              time       end_yn   number    journey_nr\nabc             10         0        1         1\nabc             11         0        2         1\nabc             12         1        3         1\nabc             13         0        1         2\ndef             10         0        1         3\ndef             15         1        2         3\ndef             16         0        1         4\ndef             17         0        2         4\ndef             18         1        3         4\n</code></pre>\n"},{"tags":["r","parallel-processing","data.table","vectorization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13226111,"title":"Vectorising a for loop","body":"<p>Is it possible to vectorise the following function, (<code>f</code>)?</p>\n\n<p>I have a vector <code>x</code> for which I want to maximise the output value of the function <code>f</code> by altering <code>p</code>.</p>\n\n<p>But the function is quite slow as it is not vectorised in anyway and was wondering if there was a good way to do so. The idea is to parallelise this in the future, and also potentially use <code>data.table</code> to speed it up</p>\n\n<p>my real data is significantly larger...so I'm providing a mock example....</p>\n\n<pre><code># My mock data \nx &lt;- data.frame(x=rep(c(rep(c(0.2,-0.2),4),0.2,0.2,-0.2,0.2),20))\n\n# The function to optimise for\nf &lt;- function(p,x){\n    # Generate columns before filling\n    x$multiplier &lt;- NA\n    x$cumulative &lt;- NA\n\n    for(i in 1:nrow(x)){\n        # Going through each row systematically\n        if(i==1){\n            # If first row do a slightly different set of commands\n            x[i,'multiplier'] &lt;- 1 * p\n            x[i,'cumulative'] &lt;- (x[i,'multiplier'] * x[i,'x']) + 1\n        } else {\n            # For the rest of the rows carry out these commands\n            x[i,'multiplier'] &lt;- x[i-1,'cumulative'] * p\n            x[i,'cumulative'] &lt;- (x[i,'multiplier'] * x[i,'x']) + x[i-1,'cumulative']\n        }\n    }\n\n# output the final row's output for the cumulative column\nas.numeric(x[nrow(x),'cumulative'])\n}\n\n# Checking the function works by putting in a test value of p = 0.5\nf(0.5,x)\n\n# Now optimise the function between the interval of p between 0 and 1\noptim.p &lt;- optimise(f=f, interval=c(0,1),x, maximum=TRUE)\n\n# Viewing the output of optim.p\noptim.p\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13229118,"title":"Plotting multiple BeanPlots in 1 Graph","body":"<p>I would like to display n beanplots in one graph next to each other. I receive vectors of respective values from a for-loop. In each iteration a new bean plot should be generated an put right next to the former bean plots. I tried several ways.</p>\n\n<ol>\n<li><p>Passing values as a list:</p>\n\n<pre><code>allValues &lt;- list()\npdf(\"Values\")\nfor(f in files)\n{\n  ...    \n  ...\n  values = getValues(f)\n  allValues &lt;- append(allValues, values)\n}\nbeanplot(allvalues, what=c(1,1,1,0))\ndev.off()\n</code></pre></li>\n</ol>\n\n<p>This gives me strange results.</p>\n\n<p>I also tried a data.frame\nI tried adding the parameter \"add=T\" to <code>beanplot()</code> command and putting <code>beanplot()</code> inside the for loop.</p>\n\n<p>Any Help?</p>\n"},{"tags":["r","gis","lattice"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13227503,"title":"Add units to scale bar in spplot()","body":"<p>I am working with R version 2.14.1-1 on Ubuntu 12.04, using spplot to plot GIS data, specifically 2008 vote tallies by precinct. </p>\n\n<p>I am a bit new to R. I have researched my problem without finding a solution. I would like to add units to the scale bar, in this case something like \"% of vote\" running vertically down the bar.</p>\n\n<p>My code so far is:</p>\n\n<pre><code>library(gpclib)\ngpclibPermit()\nlibrary(maptools)\nlibrary(maps)\nlibrary(classInt)\nlibrary(RColorBrewer)\nlibrary(sp)\nrequire(graphics)\nlibrary(rgdal)\nlibrary(lattice)\n\npennStateMap &lt;- readShapeSpatial(\"/home/jgoodson/stateData/Pennsylvania/shapeFiles/pa_final.shp\")\nplotvar &lt;- pennStateMap@data$USPP2008\n\nnclr &lt;- 10\nclass &lt;- classIntervals(plotvar, nclr, style=\"equal\")\npoliPallet &lt;- colorRampPalette(c(\"red1\", \"blue1\"), space=\"Lab\")\n\npennCounties &lt;- unionSpatialPolygons(pennStateMap, as.numeric(pennStateMap@data$COUNTYFP10))\n\nspCounties &lt;- list(\"sp.polygons\", as(pennCounties, \"SpatialPolygonsDataFrame\"), col.regions=\"transparent\")\n\nspplot(pennStateMap, \"USPP2008\", main=\"2008 Presidential Election Results by Precinct in Pennsylvania\", col.regions=poliPallet(10), col=\"transparent\", at=round(class$brks, digits=1), sp.layout = list(spCounties))\n</code></pre>\n\n<p>I tried adding the units via:<br>\n<code>barLabel &lt;- list(\"sp.text\", c(40, -71), \"Dem % of Two-Party Vote\",  srt=-90)</code><br>\nand then adding that to <code>sp.layout</code>. But this will not go outside the drawing box for the geographic data, so it disappears when I try to get to the correct side of the scale bar.</p>\n\n<p>I would appreciate any help I can get on how to accomplish this.</p>\n"},{"tags":["r","summary","lm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13230640,"title":"How to obtain just particular lines of summary on lm object","body":"<p>This problem comes from easier problem which I managed to solve myself. So here is my original question.</p>\n\n<p>In my data I have lots of categories, but i'm not interested in estimating coefficients for all of them, I just want to test the hypothesis, that there is no difference in categories. And calling <code>summary</code> on my object produces most information that I don't need for my report.</p>\n\n<pre><code>set.seed(42)\ndat &lt;- data.frame(cat=factor(sample(1:10, 100, replace=T)), y=rnorm(100))\nl1 &lt;- lm(y~cat-1, data=dat)\nsummary(l1)\n</code></pre>\n\n<p>How do I extract only the last line from call to <code>summary(l1)</code>?</p>\n\n<p>In this particular case I can just used <code>anova</code> function</p>\n\n<pre><code>anova(l1)\n</code></pre>\n\n<p>and got only the info that I needed, just in different formatting than <code>summary(l1)</code> produces.</p>\n\n<p>What if I have some kind of a summary on an object and I want to extract just particular part of <code>summary(object)</code> how do I do that? For example, how do I get <code>R</code> to print only the line of call <code>summary(l1)</code>?</p>\n\n<p>p.s. I am aware of <code>summary(l1)$fstatistic</code>.</p>\n"},{"tags":["r","data.table"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13230800,"title":"data.table and time between two variables in long format","body":"<p>I have a long dataset (both sizewise and according to id). I need to create a new variable based on (in this artifical dataset) whether i=A happen before k=B and if so the time between the two, otherwise return NA. I can do it plyr, but it takes forever. How could I do this in data.table?</p>\n\n<pre><code>library(plyr)\nlibrary(data.table)\nset.seed(192)\nj&lt;-data.table(i=sample(size=50,c(\"A\",NA),replace=T),id=sample(size=50,x=1:50),\n    d=sample(size=50,seq(from=as.Date(\"2005-06-01\"), to=as.Date(\"2008-06-30\"), by=1)))\nh&lt;-data.table(k=sample(size=50,c(\"B\",NA),replace=T),id=sample(size=50,x=1:50),\n                 d=sample(size=50,seq(from=as.Date(\"2005-06-01\"), to=as.Date(\"2008-06-30\"), by=1)))\n\nm&lt;-data.table(rbind.fill(j,h))\n</code></pre>\n"},{"tags":["r"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":130,"score":0,"question_id":13186077,"title":"Work in R with very large data set","body":"<p>I am working with a very large data set which I am downloading from an Oracle data base. The Data frame has about 21 millions rows and 15 columns.\nMy OS is windows xp (32-bit), I have 2GB RAM. Short-term I cannot upgrade my RAM or my OS (it is at work, it will take months before I get a decent pc).</p>\n\n<pre><code>library(RODBC)\nsqlQuery(Channel1,\"Select * from table1\",stringsAsFactor=FALSE)\n</code></pre>\n\n<p>I get here already stuck with the usual \"Cannot allocate xMb to vector\".\nI found some suggestion about using the <code>ff</code> package. I would appreciate to know if anybody familiar with the ff package can tell me if it would help in my case.\nDo you know another way to get around the memory problem?\nWould a 64-bit solution help?\nThanks for your suggestions.</p>\n"},{"tags":["r","list","count","data.frame","histogram"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13228962,"title":"Merge dataframes of different length at unique values (or count number occourrences) in R?","body":"<p>In have carried out three experiments, each rusluting in a list of numbers.</p>\n\n<pre><code>data1 = c(1,1,1,2,2)\ndata2 = c(2,2,3,3,3,4)\ndata3 = c(1,1,1,4,4,4,4,4,4, 5, 6)\n</code></pre>\n\n<p>Now I want to count the occurences of each number in each of the experiments. I do this with <code>table</code>, since hist uses class mids (the nice thing about histo would be, that I can give it the list of unique values)</p>\n\n<pre><code># save histograms\nresult = list()\nresult$values[[1]] = as.data.frame(table(data1), stringsAsFactors=F)\nresult$values[[2]] = as.data.frame(table(data2), stringsAsFactors=F)\nresult$values[[3]] = as.data.frame(table(data3), stringsAsFactors=F)\n\nstr(result)\n</code></pre>\n\n<p>Now I only have a list of dataframes of different length, But I'd like to have a single dataframe containinglists of the same length (I want to subtract them)</p>\n\n<pre><code>nerv=data.frame(names=c(1, 2, 3, 4, 5, 6))\nnerv[[2]] = c(3, 2, 0, 0, 0, 0)\nnerv[[3]] = c(0, 2, 3, 1, 0, 0)\nnerv[[4]] = c(3, 0, 0, 6, 1, 1)\n</code></pre>\n\n<p>Is it somehow possible to tell <code>table()</code>, which values to count? Or is there another function that allows counter of a list of values in another list (<code>count unique(data1, data2, data3)</code> in data1)?</p>\n\n<p>Or should I merge the data.frames and fill zeros into empty spaces?</p>\n"},{"tags":["python","r","time-series","forecasting"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":84,"score":0,"question_id":13197097,"title":"Forecast Package from R in Python","body":"<p>I found forecast package from R the best solution for time series analysis and forecasting. </p>\n\n<p>I want to use it in Python. Could I use rpy and after take the forecast package in Python?</p>\n"},{"tags":["r","plot","label"],"answer_count":3,"favorite_count":11,"up_vote_count":29,"down_vote_count":0,"view_count":2329,"score":29,"question_id":7611169,"title":"Intelligent point label placement in R","body":"<p>1) Is there any R library/function which would implement INTELLIGENT label placement in R plot? I tried some but they are all problematic - many labels are overlaping either each other or other points (or other objects in the plot, but I see that this is much harder to handle).</p>\n\n<p>2) If not, is there any way how to COMFORTABLY help the algorithm with the label placement for particular problematic points? Most comfortable and efficient solution wanted.</p>\n\n<p>You can play and test other possibilities with my <strong>reproducible example</strong> and see if you are able to achieve better results than I have:</p>\n\n<pre><code># data\nx = c(0.8846, 1.1554, 0.9317, 0.9703, 0.9053, 0.9454, 1.0146, 0.9012, \n0.9055, 1.3307)\ny = c(0.9828, 1.0329, 0.931, 1.3794, 0.9273, 0.9605, 1.0259, 0.9542, \n0.9717, 0.9357)\nShortSci = c(\"MotAlb\", \"PruMod\", \"EriRub\", \"LusMeg\", \"PhoOch\", \"PhoPho\", \n\"SaxRub\", \"TurMer\", \"TurPil\", \"TurPhi\")\n\n# basic plot\nplot(x, y, asp=1)\nabline(h = 1, col = \"green\")\nabline(v = 1, col = \"green\")\n</code></pre>\n\n<p><strong>For labelling, I then tried these possibilities, no one is really good:</strong></p>\n\n<p>1) this one is terrible:</p>\n\n<pre><code>text(x, y, labels = ShortSci, cex= 0.7, offset = 10)\n</code></pre>\n\n<p>2) this one is good if you don't want to place labels for all points, but just for the \noutliers, but still, the labels are often placed wrong:</p>\n\n<pre><code>identify(x, y, labels = ShortSci, cex = 0.7)\n</code></pre>\n\n<p>3) this one looked promissing but there is the problem of labels being too close to the\npoints; I had to pad them with spaces but this doesn't help much:</p>\n\n<pre><code>require(maptools)\npointLabel(x, y, labels = paste(\"  \", ShortSci, \"  \", sep=\"\"), cex=0.7)\n</code></pre>\n\n<p>4) </p>\n\n<pre><code>require(plotrix)\nthigmophobe.labels(x, y, labels = ShortSci, cex=0.7, offset=0.5)\n</code></pre>\n\n<p>5)</p>\n\n<pre><code>require(calibrate)\ntextxy(x, y, labs=ShortSci, cx=0.7)\n</code></pre>\n\n<p>Thank you in advance!</p>\n\n<p><strong>EDIT:</strong> todo: try <a href=\"http://stackoverflow.com/q/6234335/324364\">labcurve {Hmisc}</a>.</p>\n"},{"tags":["r","installation","make","configure"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13225349,"title":"Installing R on a custom path","body":"<p>When installing R (the interpreter and the shared library) <a href=\"http://cran.r-project.org/doc/manuals/R-admin.html#Installation\" rel=\"nofollow\">the documentation</a> says that one should follow the next steps:</p>\n\n<pre><code> # &lt;go to the R source directory&gt;\n make distclean\n ./configure --enable-R-shlib\n make\n make install\n</code></pre>\n\n<p>Here I have one question:</p>\n\n<p><strong>Q1.</strong> What is the difference between <code>make</code> and <code>make install</code> (do I need to run both commands?)</p>\n\n<p><strong>Q2</strong>. Say I don't have root access that I would like to install R under a specific path <code>/path/to/R/</code>. The documentation mentions I should use the options:</p>\n\n<p><code>./configure --prefix /path/to/R</code></p>\n\n<p>and</p>\n\n<p><code>make prefix=/path/to/R install</code></p>\n\n<p>Do I really have to pass the path to both commands? (i.e. to <code>./configure</code> and to <code>make</code>). If I recall correctly from installing other SW, usually using the <code>./configure --prefix</code> is enough. </p>\n"},{"tags":["r","rcpp","cgal","point-cloud-library"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13191091,"title":"lidar - mesh package in R","body":"<p>I am looking for an <code>R</code> package which could provide a framework to interact with\nAirborne-Laster-Scanning (ALS)-data and polygon-meshes. I guess it is pretty\nstraightforward to use <code>RCPP</code> for interfacing:</p>\n\n<h2>Libraries</h2>\n\n<ul>\n<li><a href=\"http://www.openmesh.org/\" rel=\"nofollow\">OpenMesh</a></li>\n<li><a href=\"http://www.liblas.org/\" rel=\"nofollow\">libLas</a></li>\n<li><a href=\"http://www.pointclouds.org/\" rel=\"nofollow\">Pointclouds</a></li>\n<li><a href=\"http://www.cgal.org/\" rel=\"nofollow\">CGAL</a></li>\n<li><a href=\"http://meshlab.sourceforge.net/\" rel=\"nofollow\">meshlab</a></li>\n</ul>\n\n<h2>Requested Features</h2>\n\n<p>To name a few:</p>\n\n<ul>\n<li>Mesh-Lidar-interaction\n<ul>\n<li>refine/coarse triangulated mesh according to ALS</li>\n<li>interpolate elevation from ALS</li>\n</ul></li>\n<li>Inject points/lines/holes into the mesh</li>\n<li>Mesh-Simplification</li>\n<li>Reading and writing in different mesh-formats (<code>.stl,.2dm</code>, ...)</li>\n</ul>\n\n<p>P.S.: I would also be interested in implementations  in <code>julia</code> or <code>haskell</code>.</p>\n"},{"tags":["r","time-series","regression"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":93,"score":0,"question_id":13212619,"title":"Regression with xts object, determine t-statistic of slope coefficient using R","body":"<p>I posted this question yesterday but received some valuable feedback that my post left a little to be desired :). Here is an updated attempt that hopefully is much clearer:</p>\n\n<p>I have a xts zoo object and would like to determine the t-statistic of the slope coefficient over the last 20 periods using R and then test whether that t value is > 2.</p>\n\n<pre><code>class(prices)\n\n[1] \"xts\" \"zoo\"\n\ntail(prices)\n             IWM    SPY    TLT\n2012-10-24 81.20 141.02 121.48\n2012-10-25 81.53 141.43 120.86\n2012-10-26 81.14 141.35 122.64\n2012-10-31 81.63 141.35 123.36\n2012-11-01 82.49 142.83 122.35\n2012-11-02 81.19 141.56 122.26\n</code></pre>\n\n<p>I could not figure out how to perform a regression for each column versus time so I created a new column (daynumber) with the index and performed the regression versus the index:</p>\n\n<pre><code>lastprices = last(prices,20)\nprices.data.frame = as.data.frame(lastprices)\ndaynumber = index(prices.data.frame)\npdfd = data.frame(prices.data.frame, daynumber)\npdfd.lm = lm(pdfd$daynumber ~ ., data=pdfd)\ntstat = coef(summary(pdfd.lm))\ntstat[,\"t value\"]\n(Intercept)         IWM         SPY         TLT \n  4.5426630  -0.1788975  -1.3521969  -2.2362345 \ntstattest = ifelse(tstat[,\"t value\"]&gt;2,1,0)\ntstattest\n(Intercept)         IWM         SPY         TLT \n          1           0           0           0 \n</code></pre>\n\n<p>I cant help but think this is not the most efficient way to accomplish this task. Does anyone have ideas on how to just perform the regression for each column versus time without creating the daynumber column?</p>\n\n<p>Thanks - take it easy on me I just started learning!</p>\n"},{"tags":["r","function","data.frame","vectorization"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13224883,"title":"Calling function that summarizes data frame based on parameter and applying to data frame and nls","body":"<p>I am working with weather data and utility bills and am trying estimate a nonlinear regression model.</p>\n\n<p>I am coming up with a problem.  The function I call to calculate the weather statistics, Heating and Cooling Degree Days, (HDD and CDD) can not be applied to a data frame and nls can not use it.  Clearly, I am missing something pretty obvious about function arguments.</p>\n\n<p>Can someone point out where I am going wrong with the HDD and CDD functions below?</p>\n\n<p>Here is a simple example of the problem with some code that generates fake weather and billing data.</p>\n\n<pre><code># Generate Fake Weather Data\nCZ&lt;-c(1,2)\nDate&lt;-c('2001-01-01','2001-01-02','2001-01-03','2001-01-04')\nWeather&lt;-expand.grid(CZ,Date)\nnames(Weather)&lt;-c(\"CZ\",\"Date\")\nWeather$AvgTemp&lt;-rnorm(8,mean= 60,sd=20)\n\n#Generate Fake Billing Data\nID&lt;-as.numeric(1:10)\nCZ&lt;-c(1,2)\nStartDate&lt;-'2001-01-01'\nEndDate&lt;-'2001-02-01'\nFakeBilling&lt;-data.frame(cbind(ID,CZ,StartDate,EndDate))\nFakeBilling$KWH&lt;-rnorm(10,mean=1000, sd=200)\n\n#Heating and cooling degree functions\nHDD&lt;- function(b,CZ,StartDate,EndDate) {\n    Temps&lt;-Weather$AvgTemp[Weather$CZ==CZ&amp;as.Date(Weather$Date) &gt;=as.Date(StartDate) &amp;     as.Date(Weather$Date) &lt; as.Date(EndDate)];\n\n    sum((b-Temps)/(1+exp(-5*(b-Temps))))\n}\n\n\nCDD &lt;- function(b,CZ,StartDate,EndDate) {\nTemps&lt;- Weather$AvgTemp[as.character(Weather$CZ)==as.character(CZ) &amp;     as.Date(Weather$Date) &gt;=as.Date(StartDate)&amp; as.Date(Weather$Date) &lt; as.Date(EndDate)]\n\n    sum((Temps-b)/(1+exp(-5*(Temps-b))))\n}\n\n#these work\nHDD(60,1,'2001-01-01','2001-02-01')\n# [1] 29.34333\nCDD(60,1,'2001-01-01','2001-02-01')\n# [1] 53.49393\n\n# This does not. Lots of warnings about length\nHDD(60,FakeBilling$CZ,FakeBilling$StartDate,FakeBilling$EndDate)\n# [1] NA\n# Warning messages:\n#   1: In is.na(e1) | is.na(e2) :\n#   longer object length is not a multiple of shorter object length\n# 2: In `==.default`(Weather$CZ, CZ) :\n#   longer object length is not a multiple of shorter object length\n# 3: In `&gt;=.default`(as.Date(Weather$Date), as.Date(StartDate)) :\n#   longer object length is not a multiple of shorter object length\n# 4: In `&lt;.default`(as.Date(Weather$Date), as.Date(EndDate)) :\n#   longer object length is not a multiple of shorter object length\n\n# Would like to run this but get similar error.\nnls(KWH~load + heatload*(HDD(base,CZ,StartDate,EndDate)) ,start=c(load=200,     heatload=.1,base=65), data=FakeBilling, na.action=na.omit)\n# Error in numericDeriv(form[[3L]], names(ind), env) : \n#   Missing value or an infinity produced when evaluating the model\n# In addition: Warning messages:\n#   1: In is.na(e1) | is.na(e2) :\n#   longer object length is not a multiple of shorter object length\n# 2: In `==.default`(Weather$CZ, CZ) :\n#   longer object length is not a multiple of shorter object length\n# 3: In `&gt;=.default`(as.Date(Weather$Date), as.Date(StartDate)) :\n#   longer object length is not a multiple of shorter object length\n# 4: In `&lt;.default`(as.Date(Weather$Date), as.Date(EndDate)) :\n#   longer object length is not a multiple of shorter object length\n# 5: In is.na(e1) | is.na(e2) :\n#   longer object length is not a multiple of shorter object length\n# 6: In `==.default`(Weather$CZ, CZ) :\n#   longer object length is not a multiple of shorter object length\n# 7: In `&gt;=.default`(as.Date(Weather$Date), as.Date(StartDate)) :\n#   longer object length is not a multiple of shorter object length\n# 8: In `&lt;.default`(as.Date(Weather$Date), as.Date(EndDate)) :\n#   longer object length is not a multiple of shorter object length\n</code></pre>\n"},{"tags":["arrays","string","r","loops","subset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13225300,"title":"Subset with loop over an array of strings","body":"<p>I have my code like this:</p>\n\n<pre><code>for (i in 1:b) {\ncarteraR[[i]]=subset(carteraR[[i]],RUN.FONDO==\"8026\" | RUN.FONDO==\"8036\" | RUN.FONDO==\"8048\" | RUN.FONDO==\"8057\" | RUN.FONDO==\"8059\" | RUN.FONDO==\"8072\" | RUN.FONDO==\"8094\" | \nRUN.FONDO==\"8107\" | RUN.FONDO==\"8110\" | RUN.FONDO==\"8115\" | RUN.FONDO==\"8130\" | RUN.FONDO==\"8230\" | RUN.FONDO==\"8248\" | RUN.FONDO==\"8257\" | RUN.FONDO==\"8319\")\n}\n</code></pre>\n\n<p>Where <code>b=length(carteraR)</code>, and <code>class(carteraR[[i]])=data.frame</code>. <code>RUN.FONDO</code> is one of the head of these data frames. This code is working fine but I want to save some lines.</p>\n\n<p>What I want is something like:</p>\n\n<pre><code>for (i in 1:b) {\nfor (j in 1:length(A)){\ncarteraR[[i]]=subset(carteraR[[i]],RUN.FONDO==A[j])\n}\n}\n</code></pre>\n\n<p>And where <code>A= \"8026\" \"8036\" \"8048\" \"8057\" ... \"8319\"</code> ....... etc......</p>\n\n<p>What should the code be like ?</p>\n\n<p>Thx</p>\n"},{"tags":["r","profiling","rcpp"],"answer_count":1,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":89,"score":6,"question_id":13224322,"title":"Profiling Rcpp code on OS X","body":"<p>I am interested in profiling some Rcpp code under OS X (Mountain Lion 10.8.2), but the profiler crashes when being run.</p>\n\n<p>Toy example, using <code>inline</code>, just designed to take enough time for a profiler to notice.</p>\n\n<pre><code>library(Rcpp)\nlibrary(inline)\n\nsrc.cpp &lt;- \"\n  RNGScope scope;\n  int n = as&lt;int&gt;(n_);\n  double x = 0.0;\n  for ( int i = 0; i &lt; n; i++ )\n    x += (unif_rand()-.5);\n  return wrap(x);\"\n\nsrc.c &lt;- \"\n  int i, n = INTEGER(n_)[0];\n  double x = 0.0;\n  GetRNGstate();\n  for ( i = 0; i &lt; n; i++ )\n    x += (unif_rand()-.5);\n  PutRNGstate();\n  return ScalarReal(x);\"\n\nf.cpp &lt;- cxxfunction(signature(n_=\"integer\"), src.cpp, plugin=\"Rcpp\")\nf.c &lt;- cfunction(signature(n_=\"integer\"), src.c)\n</code></pre>\n\n<p>If I use either the GUI Instruments (in Xcode, version 4.5 (4523)) or the command line <code>sample</code>, both crash: Instruments crashes straight away, while sample completes processing samples before crashing:</p>\n\n<pre><code># (in R)\nset.seed(1)\nf.cpp(200000000L)\n\n# (in a separate terminal window)\n~ » sample R  # this invokes the profiler\nSampling process 81337 for 10 seconds with 1 millisecond of run time between samples\nSampling completed, processing symbols...\n[1]    81654 segmentation fault  sample 81337\n</code></pre>\n\n<p>If I do the same process but with the C version (i.e., <code>f.c(200000000L)</code>) both Instruments and <code>sample</code> work fine, and produce output like</p>\n\n<pre><code>Call graph:\n1832 Thread_6890779   DispatchQueue_1: com.apple.main-thread  (serial)\n  1832 start  (in R) + 52  [0x100000e74]\n    1832 main  (in R) + 27  [0x100000eeb]\n      1832 run_Rmainloop  (in libR.dylib) + 80  [0x1000e4020]\n        1832 R_ReplConsole  (in libR.dylib) + 161  [0x1000e3b11]\n          1832 Rf_ReplIteration  (in libR.dylib) + 514  [0x1000e3822]\n            1832 Rf_eval  (in libR.dylib) + 1010  [0x1000aa402]\n              1832 Rf_applyClosure  (in libR.dylib) + 849  [0x1000af5d1]\n                1832 Rf_eval  (in libR.dylib) + 1672  [0x1000aa698]\n                  1832 do_dotcall  (in libR.dylib) + 16315  [0x10007af3b]\n                    1382 file1412f6e212474  (in file1412f6e212474.so) + 53  [0x1007fded5]  file1412f6e212474.cpp:16\n                    + 862 unif_rand  (in libR.dylib) + 1127,1099,...  [0x10000b057,0x10000b03b,...]\n                    + 520 fixup  (in libR.dylib) + 39,67,...  [0x10000aab7,0x10000aad3,...]\n                    356 file1412f6e212474  (in file1412f6e212474.so) + 70,61,...  [0x1007fdee6,0x1007fdedd,...]  file1412f6e212474.cpp:16\n                    56 unif_rand  (in libR.dylib) + 1133  [0x10000b05d]\n                    38 DYLD-STUB$$unif_rand  (in file1412f6e212474.so) + 0  [0x1007fdf1c]\n</code></pre>\n\n<p>I would really appreciate some advice into if there is anything I'm doing wrong, if there is some other preferred way, or if this is just not possible.  Given that one of the main uses of Rcpp seems to be in speeding up R code, I'm surprised not to find more information on this, but perhaps I'm looking in the wrong place.</p>\n\n<p>This is on OS X 10.8.2 with R 2.15.1 (x86_64-apple-darwin9.8.0), Rcpp 0.9.15, and g++ --version reports \"i686-apple-darwin11-llvm-g++-4.2 (GCC) 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.11.00)\".</p>\n\n<h1>A solution</h1>\n\n<p>Thanks to Dirk's answer below, and his talk here <a href=\"http://dirk.eddelbuettel.com/papers/ismNov2009introHPCwithR.pdf\" rel=\"nofollow\">http://dirk.eddelbuettel.com/papers/ismNov2009introHPCwithR.pdf</a>, I have at least a partial solution using Google perftools.  First, install from here <a href=\"http://code.google.com/p/gperftools/\" rel=\"nofollow\">http://code.google.com/p/gperftools/</a>, and add -lprofiler to PKG_LIBS when compiling the C++ code.  Then either</p>\n\n<p>(a) Run R as <code>CPUPROFILE=samples.log R</code>, run all code and quit (or use Rscript)</p>\n\n<p>(b) Use two small utility functions to turn on/off profiling:</p>\n\n<pre><code>RcppExport SEXP start_profiler(SEXP str) {\n  ProfilerStart(as&lt;const char*&gt;(str));\n  return R_NilValue;\n}\n\nRcppExport SEXP stop_profiler() {\n  ProfilerStop();\n  return R_NilValue;\n}\n</code></pre>\n\n<p>Then, within R you can do</p>\n\n<pre><code>.Call(\"start_profiler\", \"samples.log\")\n# code that calls C++ code to be profiled\n.Call(\"stop_profiler\")\n</code></pre>\n\n<p>either way, the file <code>samples.log</code> will contain profiling information.  This can be looked at with </p>\n\n<pre><code>pprof --text /Library/Frameworks/R.framework/Resources/bin/exec/x86_64/R samples.log\n</code></pre>\n\n<p>which produces output like</p>\n\n<pre><code>Using local file /Library/Frameworks/R.framework/Resources/bin/exec/x86_64/R.\nUsing local file samples.log.\nRemoving __sigtramp from all stack traces.\nTotal: 112 samples\n  64  57.1%  57.1%       64  57.1% _unif_rand\n  30  26.8%  83.9%       30  26.8% _process_system_Renviron\n  14  12.5%  96.4%      101  90.2% _for_profile\n   3   2.7%  99.1%        3   2.7% Rcpp::internal::expr_eval_methods\n   1   0.9% 100.0%        1   0.9% _Rf_PrintValueRec\n   0   0.0% 100.0%        1   0.9% 0x0000000102bbc1ff\n   0   0.0% 100.0%       15  13.4% 0x00007fff5fbfe06f\n   0   0.0% 100.0%        1   0.9% _Rf_InitFunctionHashing\n   0   0.0% 100.0%        1   0.9% _Rf_PrintValueEnv\n   0   0.0% 100.0%      112 100.0% _Rf_ReplIteration\n</code></pre>\n\n<p>which would probably be more informative on a real example.</p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":116,"score":2,"question_id":13176741,"title":"How to calculate a table of pairwise counts from a 'long' data frame","body":"<p>An R question from a beginner:</p>\n\n<p>I have a 'long' data frame with <code>id</code> and <code>featureCode</code> columns. The former contains primary keys to records; the latter, values of a categorical variable. Each record has between 1 and 9 values of the categorical variable. For example:</p>\n\n<pre><code>id  featureCode\n5   PPLC\n5   PCLI\n6   PPLC\n6   PCLI\n7   PPL\n7   PPLC\n7   PCLI\n8   PPLC\n9   PPLC\n10  PPLC\n</code></pre>\n\n<p>I'd like to calculate the number of times each feature code is used with the other feature codes (the \"pairwise counts\" of the title). At this stage, the order each feature code is used is not important. I envisage the result would be another data frame, where the rows and columns are feature codes, and the cells are counts. For example:</p>\n\n<pre><code>      PPLC  PCLI  PPL\nPPLC  0     3     1\nPCLI  3     0     1\nPPL   1     1     0\n</code></pre>\n\n<p>Unfortunately, I don't know how to perform this calculation and I've drawn a blank when searching for advice (mostly, I suspect, because I don't know the correct terminology).</p>\n\n<p>Thanks in advance for any help.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13224946,"title":"Why does summary() output label factor levels differently for models, depending on previous commands?","body":"<p>I am working on a large R project to perform different analyses of a common dataset.  I have built up several individual scripts for each analysis, as well as high-level scripts to call each one in sequence.  Each script starts by calling an <code>init.R</code> script that wipes the memory ( <code>rm(list=ls(all=TRUE))</code> ).</p>\n\n<p>I have recently discovered that <code>summary()</code> (and, I think <code>coef()</code>) produces different output, depending on the order of the scripts.  In scripts that fit models using <code>lm()</code> or <code>gam()</code> (<code>mgcv</code> package), if these are run first, in a \"fresh\" R session, the <code>summary()</code> output lists factors with the full labels.</p>\n\n<p>However, if I run other scripts first, which use simple nested <code>aov()</code> functions and produce some graphs and other output using some other packages, then re-run the previously-mentioned scripts, <code>summary()</code> instead produces output with factor levels labeled using numbers (the 'coded' values, not the actual factor level labels).</p>\n\n<p>This is not something I can easily \"reproduce\" using a minimal working example, unfortunately, because I haven't quite pinpointed where in my scripts this behaviour changes.  I have confirmed a few things in quick tests:</p>\n\n<ul>\n<li>memory is cleared in between scripts using <code>rm(list=ls())</code>, so there shouldn't be anything in memory causing this change.</li>\n<li><code>summary()</code> itself does not change: the model-fitting functions actually produce slightly different output (as confirmed with <code>all.equal()</code> ), which is even more disturbing.  Saved objects produced when running the scripts in a different order reliably produce the same output whenever they are loaded, but that output differs depending on the order of scripts used to generate the fitted model objects (even though memory is cleared in between each script).\n<ul>\n<li>Depending on the order of scripts, <code>summary( lm(...) )</code> also outputs different estimates for model terms, but the same Residuals summary, R^2, and overall F-test.  Very bizarre.</li>\n</ul></li>\n<li>I can not recover the default (desired) behaviour by removing packages loaded in prior scripts.  Does the order of loading packages matter?</li>\n<li>default behaviour is restored after quitting and re-starting R\n<ul>\n<li>nothing in this answer seemed to fix the problem:  <a href=\"http://stackoverflow.com/questions/3716764/reset-r-instance\">Reset R instance</a></li>\n</ul></li>\n</ul>\n\n<p>Ideally, I would like my project to be able to reproduce all results and output by simply <code>source()</code>ing each script in turn, but this strange 'bug' (in my code - I'm not blaming this on R) means that the output is not consistent and depends on the order :(</p>\n\n<p>Is there anything other than objects or packages that stays in memory that could alter the way model-fitting functions work, or store factor levels in data-frames that are passed in?</p>\n\n<h2>EDIT</h2>\n\n<p>I realized the answer to the above question was the contrasts option (see below).  New question:</p>\n\n<p>How can you reset options() to the default settings, i.e. to the values used when R starts up?  The 'factory default' is\n<code>options(contrasts=c(\"contr.treatment\",\"contr.poly\")))</code> but I'm wondering if there is a way to restart to the internal defaults (in case they aren't 'factory fresh'.</p>\n"},{"tags":["r","xtable"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13224814,"title":"Sorting output of xtable","body":"<p>I have a data set with which I create a table, but now I would like the output to be sorted alphabetically. <code>order</code>, <code>sort</code> or <code>sort.list</code> I don't get to work. Here is an example of what I have. </p>\n\n<pre><code>library(maptools)\ndata(wrld_simpl)\ntab.test &lt;- xtable(subset(wrld_simpl@data, select=c(NAME, REGION)))\nhead(tab.test)\n% latex table generated in R 2.15.1 by xtable 1.7-0 package\n% Sun Nov  4 19:58:19 2012\n\\begin{table}[ht]\n\\begin{center}\n\\begin{tabular}{rll}\n  \\hline\n &amp; NAME &amp; REGION \\\\ \n  \\hline\nATG &amp; Antigua and Barbuda &amp;  19 \\\\ \nDZA &amp; Algeria &amp;   2 \\\\ \nAZE &amp; Azerbaijan &amp; 142 \\\\ \nALB &amp; Albania &amp; 150 \\\\ \nARM &amp; Armenia &amp; 142 \\\\ \nAGO &amp; Angola &amp;   2 \\\\ \n   \\hline\n\\end{tabular}\n\\end{center}\n\\end{table}\n</code></pre>\n\n<p>I would like to be able to sort it by <code>NAME</code>, <code>REGION</code> or even the first column, which is <code>ISO3</code> and seems to be the default left column. I appreciate your help, including hints to similar questions (I might have overlooked them during my search for a cure).</p>\n"},{"tags":["r","installation","shared-libraries","rpy2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13224871,"title":"Installing the R interpeter and R as a shared library uder the same tree","body":"<p>I am a bit confused about how to install R (via compilation) as a shared library.</p>\n\n<p>The instructions <a href=\"http://rpy.sourceforge.net/rpy_faq.html\" rel=\"nofollow\">here</a> (<a href=\"http://rpy.sourceforge.net/rpy2.html\" rel=\"nofollow\">Rpy2</a>) say that I should do the following:</p>\n\n<pre><code>  # &lt;go to the R source directory&gt;\n  make distclean\n  ./configure --enable-R-shlib\n  make\n  make install\n</code></pre>\n\n<p>but the first <code>make</code> (<code>make distclean</code>) would remove any previous installation of R under the same directory tree (e.g. the contents of the <code>bin</code> folder).  </p>\n\n<p>What if I want to use the same installation for the R interpreter and the shared libraries? For example, say I want to use the interpreter to install R packages, and then the shared library of the installation to call R (and those packages) from Rpy2.</p>\n\n<p>Otherwise, how can I install R packages for use through Rpy2?</p>\n"},{"tags":["php","r","amazon-ec2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":450,"score":2,"question_id":8481790,"title":"Run exec() Rscript from wordpress install","body":"<p><strong>Goal:</strong>\nRun a simple Rscript from a wordpress page.</p>\n\n<ul>\n<li>I'm currently attempting to run an Rscript using exec() upon loading the page. The script creates a histogram of 100 random samples from integers 1 through 10, writes system time to title and saves figure to .png file.</li>\n</ul>\n\n<p><strong>Setup</strong>:</p>\n\n<ul>\n<li>Running Wordpress install on Ubuntu EC2 micro instance</li>\n<li>R has been successfully installed and tested through ssh</li>\n<li>Using Exec-PHP Wordpress plugin so that PHP code can be written and executed (tested successfully)</li>\n</ul>\n\n<p><strong>PHP code (within wordpress Page)</strong></p>\n\n<pre><code>    &lt;?php \n    echo \"This is the Exec-PHP 'Hello World'\\n\"; \n    echo exec(\"date\");\n    ?&gt;\n\n    &lt;?php\n    exec(\"Rscript &lt;PATH&gt;/test.R\");\n    ?&gt;\n\n    &lt;img src=\"&lt;Image Location&gt;/samplePlot.png\" alt=\"\" title=\"Sample R\" /&gt;\n</code></pre>\n\n<p><strong>Rscript - test.R</strong></p>\n\n<pre><code>    png( \"&lt;Image Location&gt;/samplePlot.png\")\n    hist( sample( 1:10, 100, replace = TRUE), main= Sys.time(), lwd = 5)\n    dev.off()\n</code></pre>\n\n<p>The image file loads but it is not updated, indicating the Rscript was never executed. I've isolated it down to that being the issue but unsure why that is. </p>\n\n<p>How can I debug this? I don't really know any PHP but I tried the following:</p>\n\n<pre><code>    &lt;?php\n    exec(\"\\usr\\bin\\Rscript &lt;PATH&gt;/test.R\", $output, $result);\n    echo $output;\n    echo $result\n    ?&gt;\n</code></pre>\n\n<p>Which returns:</p>\n\n<pre><code>Array2\n</code></pre>\n\n<p>I was hoping to get the command line output to check for errors. Is this possible?</p>\n"},{"tags":["r","list","matrix","code-efficiency"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":13224553,"title":"How to convert a list to a matrix more efficiently in R?","body":"<p>I have a list of length 130,000 where each element is a character vector of length 110. I would like to convert this list to a matrix with dimension 1,430,000*10. How can I do it more efficiently?\nMy code is :</p>\n\n<pre><code>output=NULL\nfor(i in 1:length(z)) output=rbind(output,matrix(z[[i]],ncol=10,byrow=T))\n</code></pre>\n"},{"tags":["r","fonts","size","axis"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":27,"score":3,"question_id":13224320,"title":"R - how do I change font style and size on my two x-axes which I have moved to the top of the graph?","body":"<p>I am having bother changing the font style and size on my two x-axes, both of which I have moved to the top of the graph.</p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>x1&lt;-Temperature\nx2&lt;-Salinity\n\ny&lt;-Depth\npar(mar=c(4, 4, 8, 4))\n\nplot(x2,y, type=\"l\",col=\"darkgrey\",ylim=rev(range(0,300)),las=2,xlim=(range(32.5,34.5)),xaxt='n',xlab='',font.axis=2,lwd=3,ylab=\"Depth [m]\",font=2,font.lab=2,cex.lab=1.3,cex.axis=1.2)\naxis(side=3, line=4)\npar(new=TRUE)\nplot(x1,y, type=\"l\",col=\"black\",ylim=rev(range(0,300)),las=2,xaxt='n',xlab='',lwd=3,ylab='Depth [m]',font=2,font.lab=2,cex.lab=1.3,cex.axis=1.2)\naxis(side=3, line=0)\npar(new=TRUE)\n</code></pre>\n\n<p>This successfully changes my y-axis but leaves my x-axes unchanged.</p>\n\n<p>Help!  </p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":74,"score":3,"question_id":13198170,"title":"Combining `expression()` with `\\n`","body":"<p>I have a ggplot where I have used <code>expression(phantom(x) &gt;=80)</code> in the label text to get a proper greater-than-or-equal symbol.</p>\n\n<p>However I also need to have (N=...) immediately underneath:</p>\n\n<pre><code>require(ggplot2)\n.d &lt;- data.frame(a = letters[1:6], y = 1:6)\n\nlabs &lt;- c(\"0-9\\n(N=10)\",\"10-29\\n(N=10)\",\"30-49\\n(N=10)\", +\n   \"50-64\\n(N=10)\",\"65-79\\n(N=10)\", expression(phantom(x) &gt;=80))\n\nggplot(.d, aes(x=a,y=y)) + geom_point() + \n   scale_x_discrete(labels = labs)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/2r7Ck.png\" alt=\"enter image description here\"></p>\n\n<p>How can I combine the <code>expression()</code> with the escape <code>\\n</code> ?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":118,"score":1,"question_id":13132111,"title":"My package doesn't work for R 2.15.2","body":"<p>I have a package called <code>rpackage</code> on a local (corporate) repo. When I run <code>install.packages(\"rpackage\")</code> it tells me that:</p>\n\n<pre><code>Installing package(s) into ‘C:/Program Files/R/R-2.15.2/library’\n(as ‘lib’ is unspecified)\nWarning in install.packages :\n  package ‘rpackage’ is not available (for R version 2.15.2)\n</code></pre>\n\n<p>I have built this package using <code>R CMD INSTALL --build .</code> , released to the local repo and also ran <code>tools::write_PACKAGES()</code> to update the <code>PACKAGES</code> files. When I run <code>R --version</code> I get:</p>\n\n<pre><code>R version 2.15.2 (2012-10-26) -- \"Trick or Treat\"\nCopyright (C) 2012 The R Foundation for Statistical Computing\nISBN 3-900051-07-0\nPlatform: i386-w64-mingw32/i386 (32-bit)\n</code></pre>\n\n<p>And when I run <code>R CMD INSTALL --build --version</code> I get:</p>\n\n<pre><code>R add-on package installer: 2.15.2 (r61015)\n</code></pre>\n\n<p>The local repo directory structure follows the <a href=\"http://cran.r-project.org/doc/manuals/R-admin.html#Setting-up-a-package-repository\" rel=\"nofollow\">official documentation</a> and has been working until I updated to R 2.15.2. The structure is:</p>\n\n<pre><code>\\\\server\\folder\\R\\bin\\windows\\contrib\\\n    2.11\\\n    2.12\\\n    2.13\\\n    2.14\\\n    2.15\\\n\\\\server\\folder\\R\\src\\contrib\\\n</code></pre>\n\n<p>If I run <code>install.packages(\"rpackage\")</code> in R 2.15.1 I have no problems. Is there something special I need to do to get it to work with the new version of R?</p>\n\n<p>I noticed the CRAN servers use a slightly different directory structure. For example, the CSIRO CRAN mirror uses:</p>\n\n<pre><code>http://cran.csiro.au/bin/windows/contrib/r-release/\n</code></pre>\n\n<p>Any idea about how to fix this?</p>\n\n<p>Many thanks.</p>\n"},{"tags":["r","gam","mgcv"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":75,"score":3,"question_id":12944278,"title":"Extract estimates of GAM","body":"<p>I am fairly new to R and presently reading a book “Generalized Additive Models”, an Introduction with R by Wood (2006) and going through some of the exercises, particularly the part on air pollution and death which is my area of interest. Using the mgcv package I run the following model.</p>\n\n<pre><code>library(gamair) \nlibrary(mgcv) \ndata(chicago) \n\nap1&lt;-gam(death ~ pm10median + so2median + o3median +s(time,bs=\"cr\",k=200)+ s(tmpd,bs=\"cr\"), data=chicago,family=poisson)\n</code></pre>\n\n<p>How can I extract the effect estimates of pm10median and 95% CI of x and export the output to CSV or any other option?</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13223367,"title":"Minimise absolute values PACF to < 0.1","body":"<p>I am fitting a gam model using the mgcv package of R to analyse association of environmental pollutants and mortality. I have built my final model which looks like this one: </p>\n\n<pre><code>Fit1&lt;-gam(death~ ozone + s(trend,k=10*7,fx=T)+ s(temp,k=5) + s(humidity,k=5)+  \n             as.factor(dow) ,family=poisson,na.action=na.omit,data=mortality)\n</code></pre>\n\n<p>There are several recommendations on how to build such models, one of which is to reduce residual autocorrelation.  Thus I am interested to include this technique in my model building. Thus I would like to include a model that would reduce the absolute values of PACF to &lt; 0.1 . How can I achieve this aim? </p>\n\n<p>Thanks in advance</p>\n"},{"tags":["r","ggplot2","ggmap"],"answer_count":2,"favorite_count":1,"up_vote_count":10,"down_vote_count":0,"view_count":558,"score":10,"question_id":11201997,"title":"World map with ggmap","body":"<p>I am using ggmap and wish to have a map of the world centered on Australia to which I can easily plot geocoded points. ggmap seems to be a lot easier to use compared to some of the other mapping packages. Yet when I bring through a map using the code below it errors. </p>\n\n<pre><code>gc &lt;- geocode('australia')\ncenter &lt;- as.numeric(gc) \n&gt; map &lt;- get_map(location = center, source=\"google\", maptype=\"terrain\", zoom=0)\nError: zoom must be a whole number between 1 and 21\n</code></pre>\n\n<p>From the get_map help:\n\"zoom: map zoom, an integer from <strong>0 (whole world) to 21</strong> (building), default value 10 (city). openstreetmaps limits a zoom of 18, and the limit on stamen maps depends on the maptype. 'auto' automatically determines the zoom for bounding box specifications, and is defaulted to 10 with center/zoom specifications.\"</p>\n\n<p>Changing the zoom to one does not error for get_map but does for plotting that map</p>\n\n<pre><code>map &lt;- get_map(location = center, source=\"google\", maptype=\"terrain\", zoom=1)\nggmap(map)\n\nWarning messages:\n1: In min(x) : no non-missing arguments to min; returning Inf\n2: In max(x) : no non-missing arguments to max; returning -Inf\n3: In min(x) : no non-missing arguments to min; returning Inf\n4: In max(x) : no non-missing arguments to max; returning -Inf\n</code></pre>\n\n<p>It looks like the longitude isn't being pulled through. \nFinally with a zoom of 2 it does work but does not bring through a map of the whole world</p>\n\n<p>So, my question is how can I use get_map to get a world map?</p>\n\n<p>Session info:</p>\n\n<blockquote>\n  <p>sessionInfo()\n      R version 2.15.0 (2012-03-30)\n      Platform: i386-pc-mingw32/i386 (32-bit)</p>\n</blockquote>\n\n<pre><code>locale:\n[1] LC_COLLATE=English_United Kingdom.1252 \n[2] LC_CTYPE=English_United Kingdom.1252   \n[3] LC_MONETARY=English_United Kingdom.1252\n[4] LC_NUMERIC=C                           \n[5] LC_TIME=English_United Kingdom.1252    \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] mapproj_1.1-8.3 maps_2.2-6      rgdal_0.7-12    sp_0.9-99      \n[5] ggmap_2.1       ggplot2_0.9.1  \n\nloaded via a namespace (and not attached):\n[1] colorspace_1.1-1   dichromat_1.2-4    digest_0.5.2       grid_2.15.0       \n[5] labeling_0.1       lattice_0.20-6     MASS_7.3-17        memoise_0.1       \n[9] munsell_0.3        plyr_1.7.1         png_0.1-4          proto_0.3-9.2     \n[13] RColorBrewer_1.0-5 reshape2_1.2.1     RgoogleMaps_1.2.0  rjson_0.2.8       \n[17] scales_0.2.1       stringr_0.6        tools_2.15.0 \n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13221767,"title":"Import from database into http://yeroon.net/ggplot2/","body":"<p>I'm unable to connect to a database from within the Yeroon.net/ggplot2 environment. \n<a href=\"http://i.stack.imgur.com/aqHcM.jpg\" rel=\"nofollow\">http://i.stack.imgur.com/aqHcM.jpg</a></p>\n\n<p>I've defined a System DSN using SQL Server Native Client 10.0 and have no issues connecting through RStudio/R Console.</p>\n\n<p>Thanks, in advance for any suggestions.</p>\n\n<p><em><strong></em>* In response, to question about error notification <em>*</em></strong>\nNo error, just not able to connect. The database option is grayed out. Please click this URL to see the issue:\n<a href=\"http://i.stack.imgur.com/aqHcM.jpg\" rel=\"nofollow\">http://i.stack.imgur.com/aqHcM.jpg</a></p>\n\n<p><strong>Environment Details</strong></p>\n\n<p>Windows 7 Enterprise, Google Chrome (Version 22.0.1229.79), RStudio (0.96.331), R i386 2.15.1, SQL Server 2008 R2, System DSN using SQL Server Native Client 10.0</p>\n"},{"tags":["r","conditional","package","software-tools","markov-chains"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":605,"score":3,"question_id":6524232,"title":"conditional random fields package for R","body":"<p>I'm quite new to R (I want to switch from Matlab to an open source tool and love R plots ;)\nFor my new side project, I need a Conditional Random Fields package for R, that is general purpose and can potentially also deal with continuous data. \nSimilar to the one from Kevin Murphy for Matlab: <a href=\"http://www.cs.ubc.ca/~murphyk/Software/CRF/crfGeneralOld.html\" rel=\"nofollow\">http://www.cs.ubc.ca/~murphyk/Software/CRF/crfGeneralOld.html</a></p>\n\n<p>Otherwise, I will be stuck with Matlab again.</p>\n\n<p>I tried to google and could not find any (especially as including R does not really help.) </p>\n"},{"tags":["r","loops","printing","for-loop","formatting"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13221881,"title":"Formatting print output of for loop","body":"<h2>Updated with code that addresses most of my questions.</h2>\n\n<p>I have a modest function to generate iterations of a MLE for a population estimate. (I know that iterations are poor form in R, but I am trying to show a nonlinear search procedure in detail, to accompany methods from an Excel spreadsheet).</p>\n\n<pre><code>n&lt;-c(32,54,37,60,41)# number of captures \nR&lt;-c(32,36,6,13,5)# of marked fish returned to the population\n\nfn&lt;-function(x){\n  N&lt;-97 #starting value of N\n  mle = matrix(0, nrow=x, ncol=8) #per suggestion\n  colnames(mle)&lt;-c(\"N\",\"g.N\",\"h.N\",\"N1\",\"g.N1\",\"h.N1\",\"delta.h\",\"corr\") #added column names\n     for (i in 1:x) {\n         g.N&lt;-prod(1-n/N)\n         h.N&lt;-N-sum(R)-N*g.N\n         N1&lt;-N-1\n         g.N1&lt;-prod(1-n/N1)\n         h.N1&lt;-N1-sum(R)-N*g.N1\n         delta.h&lt;-h.N-h.N1\n         corr&lt;- -h.N/delta.h\n   #print(c(N,g.N,h.N,N1,g.N1,h.N1,delta.h,corr))#original output\n  mle[i,]&lt;-c(N,g.N,h.N,N1,g.N1,h.N1,delta.h,corr) #per suggestion\n      N&lt;-N+corr\n}\nreturn(mle) #per suggestion\n}\nfn(5)\n</code></pre>\n\n<p>This creates the following output</p>\n\n<pre><code>        N        g.N          h.N       N1       g.N1       h.N1   delta.h          corr\n[1,] 97.00000 0.04046356 1.075034e+00 96.00000 0.03851149  0.2643856 0.8106486 -1.326141e+00\n[2,] 95.67386 0.03788200 4.954192e-02 94.67386 0.03597455 -0.7679654 0.8175073 -6.060119e-02\n[3,] 95.61326 0.03776543 2.382189e-03 94.61326 0.03586008 -0.8154412 0.8178234 -2.912841e-03\n[4,] 95.61035 0.03775983 1.147664e-04 94.61035 0.03585458 -0.8177238 0.8178386 -1.403289e-04\n[5,] 95.61020 0.03775956 5.529592e-06 94.61020 0.03585432 -0.8178338 0.8178393 -6.761220e-06\n</code></pre>\n\n<p>I would like to cleanup the output, but have not been able to crack the code to put the results in a matrix or data.frame or any format where I can give column titles and adjust the digits, numeric format, etc. in a meaningful manner. I've have had limited success with cat and format but have been unable to get them to do precisely what I would like. Any help formatting this as a table, or matrix or data.frame would be appreciated.</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13216768,"title":"How to put a chart in grid","body":"<p>Is there a way to put a .png in a grid. I wanted to display 4 .png single charts in one, using grid.</p>\n\n<p><img src=\"http://i.stack.imgur.com/EmJ7o.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["r","finance","xts"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13220590,"title":"PerformanceAnalytics breaks rollaply on xts... Strange","body":"<p>I am trying to calculate some function on a rolling basis on some xts object. There seems to be a problem with doing so in many cases with xts after I load PerformanceAnalytics package... Please see below for example. What am I doing wrong? This is quite important to me since it brakes many of the calculations I am performing (good that it is still weekend). I have rebuilt all major packages a few hours ago. Please see my sessionInfo below.\nEDIT:\nLooking at this PerformanceAnalytics thing, I guess more things are broken right now. For example: </p>\n\n<blockquote>\n  <p>table.DownsideRisk(ret)</p>\n</blockquote>\n\n<pre><code>Error: could not find function \"sd.xts\"\n</code></pre>\n\n<p>Here is my original example:</p>\n\n<pre><code>require(quantmod)\n\n# Get SP500 Index\ngetSymbols(\"^GSPC\")\n\n# This does not work\ntail(rollapply(Cl(GSPC), 20, FUN=sd, fill=NA), 5)\n\n# Hm, something with xts maybe?\nz &lt;- zoo(1:1500, as.Date(1:1500))\ntail(rollapply(z, 20, mean, fill=NA), 5)\ntail(rollapply(z, 20, sd, fill=NA), 5)\n\nz &lt;- as.xts(z)\ntail(rollapply(z, 20, mean, fill=NA), 5)\ntail(rollapply(z, 20, sd, fill=NA), 5)\n\nrequire(PerformanceAnalytics)\n# This does not work anymore\ntail(rollapply(z, 20, sd, fill=NA), 5)\n# This does not work anymore\ntail(rollapply(Cl(GSPC), 20, FUN=sd, fill=NA), 5)\n# Well, it looks like xts or PerformanceAnalytics problem... When I load PerformanceAnalytics, problems...\n\n&gt; require(quantmod)\nLoading required package: quantmod\nLoading required package: Defaults\nLoading required package: xts\nLoading required package: zoo\n\nAttaching package: ‘zoo’\n\nThe following object(s) are masked from ‘package:base’:\n\n    as.Date, as.Date.numeric\n\nLoading required package: TTR\n&gt; \n&gt; # Get SP500 Index\n&gt; getSymbols(\"^GSPC\")\n[1] \"GSPC\"\n&gt; \n&gt; # This does not work\n&gt; tail(rollapply(Cl(GSPC), 20, FUN=sd, fill=NA), 5)\n           GSPC.Close\n2012-10-25         NA\n2012-10-26         NA\n2012-10-31         NA\n2012-11-01         NA\n2012-11-02         NA\n&gt; \n&gt; # Hm, something with xts maybe?\n&gt; z &lt;- zoo(1:1500, as.Date(1:1500))\n&gt; tail(rollapply(z, 20, mean, fill=NA), 5)\n1974-02-05 1974-02-06 1974-02-07 1974-02-08 1974-02-09 \n        NA         NA         NA         NA         NA \n&gt; tail(rollapply(z, 20, sd, fill=NA), 5)\n1974-02-05 1974-02-06 1974-02-07 1974-02-08 1974-02-09 \n        NA         NA         NA         NA         NA \n&gt; \n&gt; z &lt;- as.xts(z)\n&gt; tail(rollapply(z, 20, mean, fill=NA), 5)\n           [,1]\n1974-02-05   NA\n1974-02-06   NA\n1974-02-07   NA\n1974-02-08   NA\n1974-02-09   NA\n&gt; tail(rollapply(z, 20, sd, fill=NA), 5)\n\n1974-02-05 NA\n1974-02-06 NA\n1974-02-07 NA\n1974-02-08 NA\n1974-02-09 NA\n&gt; \n&gt; require(PerformanceAnalytics)\nLoading required package: PerformanceAnalytics\n\nPackage PerformanceAnalytics (1.0.5.1) loaded.\nEconometric tools for performance and risk analysis.\n(c) 2004-2012 Peter Carl, Brian G. Peterson. License: GPL\nhttp://r-forge.r-project.org/projects/returnanalytics/\n\n\nAttaching package: ‘PerformanceAnalytics’\n\nThe following object(s) are masked from ‘package:graphics’:\n\n    legend\n\n&gt; # This does not work anymore\n&gt; tail(rollapply(z, 20, sd, fill=NA), 5)\nError in FUN(.subset_xts(data, (i - width + 1):i), ...) : \n  unused argument(s) (fill = NA)\n&gt; # This does not work anymore\n&gt; tail(rollapply(Cl(GSPC), 20, FUN=sd, fill=NA), 5)\nError in FUN(.subset_xts(data, (i - width + 1):i), ...) : \n  unused argument(s) (fill = NA)\n&gt; # Well, it looks like xts or PerformanceAnalytics problem... When I load PerformanceAnalytics, problems...\n&gt; sessionInfo()\nR version 2.15.2 (2012-10-26)\nPlatform: x86_64-pc-linux-gnu (64-bit)\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8          LC_NUMERIC=C                 \n [3] LC_TIME=en_US.UTF-8           LC_COLLATE=en_US.UTF-8       \n [5] LC_MONETARY=en_US.UTF-8       LC_MESSAGES=en_US.UTF-8      \n [7] LC_PAPER=en_US.UTF-8          LC_NAME=en_US.UTF-8          \n [9] LC_ADDRESS=en_US.UTF-8        LC_TELEPHONE=en_US.UTF-8     \n[11] LC_MEASUREMENT=en_US.UTF-8    LC_IDENTIFICATION=en_US.UTF-8\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] PerformanceAnalytics_1.0.5.1 quantmod_0.3-21             \n[3] TTR_0.21-1                   xts_0.8-8                   \n[5] zoo_1.7-9                    Defaults_1.1-1              \n[7] rj_1.1.0-4                  \n\nloaded via a namespace (and not attached):\n[1] grid_2.15.2    lattice_0.20-0 tools_2.15.2  \n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":86,"score":1,"question_id":13215246,"title":"Function to calculate NYSE Trading Day of Month","body":"<p>Hoping that someone could provide a function that given a date, it will return the NYSE trading day of month.</p>\n\n<p>If it takes into consideration holidays that is a bonus, if not I'm not too worried.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":95,"score":3,"question_id":13216544,"title":"Undo a round in R","body":"<p>This is a curiousity and I highly doubt you can do what I am asking because the concept is, well silly.  If I were to round something can it be unrounded?</p>\n\n<p>So:</p>\n\n<pre><code>x &lt;- round(rnorm(10))\nx\n</code></pre>\n\n<p>You have no idea what the original something is can you get back to the original numbers generated by <code>rnorm</code>?</p>\n\n<p>I ask because when I write functions for users I often put rounding arguments in them to make display better but I always give the user control of the digits and allow independent control of digit rounding for list objects.  That makes a function full of <code>digits=</code> arguments really quickly.  I would put these arguments in the function internally if I knew the user could somehow magically re-extract the original values.  I could leave the digits as are, assign to a class and use a print method but for a list this is a pain at best.</p>\n"},{"tags":["r","binary"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13219133,"title":"How to calculate spatial averag for certain area in abinary file using R?","body":"<p>I have been searching for long time to find out how we can calculate a spatial average by R.However,i failed to find something.I have a binary file has 720 columns and 360 rows,float of air temperature. and I want first to calculate the spatial average over the whole area and to calculate the spatial average over an area of (500-600 colu and 200-250rows) and then extract the area.</p>\n\n<pre><code>t&lt;- file(\"C:annual_Prc2000_without999_1.img\",\"rb\")\n e=readBin(t, double(), size=4,n=720*360, signed=TRUE)\n</code></pre>\n\n<p>from answer 1 :</p>\n\n<pre><code>             mean(e)\n                I got \n                NaN\n</code></pre>\n\n<p>from answer 2:i got</p>\n\n<pre><code>              spat_mean = apply(e, c(2,1), mean)\n            Error in apply(e, c(2, 1), mean) : dim(X) must have a positive length\n</code></pre>\n\n<p>let me explain it:\nassume</p>\n\n<pre><code>       m &lt;- matrix(rnorm(10000),4,4)\n         &gt; m\n            [,1]       [,2]         [,3]       [,4]\n   [1,]  0.7930132  2.1973895  0.063493345 -0.5484056\n   [2,]  0.5222513  0.4331308 -0.002393336  0.1725495\n   [3,]  1.7462222 -1.5701996 -2.276781240  0.5628531\n   [4,] -1.2713361 -0.9349057  0.757412225  1.5118180\n        &gt; mean(m)\n      [1] 0.134757\n        now I want this:\n          [,1]       [,2]         [,3]       [,4]\n   [1,] 0.134757   0.134757     0.134757    0.134757\n   [2,]  0.134757   0.134757     0.134757   0.134757\n    [3,]  0.134757   0.134757       0.134757   0.134757\n    [4,] 0.134757    0.134757     0.134757     0.134757\n</code></pre>\n\n<p>I did this manually but i want to do it thru R</p>\n"},{"tags":["r","statistics"],"answer_count":2,"favorite_count":4,"up_vote_count":14,"down_vote_count":0,"view_count":3754,"score":14,"question_id":2602583,"title":"Geometric Mean: is there a built-in?","body":"<p>i tried to find a built-in for geometric mean but couldn't.</p>\n\n<p>(Obviously a built-in isn't going to save me any time while working in the shell, nor do i suspect there's any difference in accuracy; for scripts i try to use built-ins as often as possible, where the (cumulative) performance gain is often noticeable.</p>\n\n<p>In case there isn't one (which i doubt is the case) here's mine. </p>\n\n<pre><code>gm_mean = function(a){prod(a)^(1/length(a))}\n</code></pre>\n"},{"tags":["r","simulation","sample","random-sample"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":78,"score":4,"question_id":13219444,"title":"Sample Function R does not produce uniformly distributed sample","body":"<p>I am creating a survey. There are 31 possible questions, I would like each respondent to answer a subset of 3. I would like them to be administered in a random order. Participants should not answer the same questions twice</p>\n\n<p>I have created a table matrix with a participant index, and a column for the question indices for the 1st, 2nd and 3rd questions.</p>\n\n<p>Using the code below, index 31 is under-represented in my sample.</p>\n\n<p>I think I am using the sample function incorrectly. I was hoping someone could please help me?</p>\n\n<pre><code>SgPassCode &lt;- data.frame(PassCode=rep(0,10000), QIndex1=rep(0,10000),\n  QIndex2=rep(0,10000), QIndex3=rep(0,10000))\n\nset.seed(123)\nfor (n in 1:10000){\n  temp &lt;- sample(31,3,FALSE)\n  SgPassCode[n,1] &lt;- n \n  SgPassCode[n,-1] &lt;- temp\n}\n\nd &lt;- c(SgPassCode[,2],SgPassCode[,3],SgPassCode[,4])\nhist(d)\n</code></pre>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":65,"score":3,"question_id":13217322,"title":"How to reliably get dependent variable name from formula object?","body":"<p>Let's say I have the following formula:</p>\n\n<pre><code>myformula&lt;-formula(\"depVar ~ Var1 + Var2\")\n</code></pre>\n\n<p>How to reliably get dependent variable name from formula object? </p>\n\n<p>I failed to find any built-in function that serves this purpose.\nI know that <code>as.character(myformula)[[2]]</code> works, as do </p>\n\n<pre><code>sub(\"^(\\\\w*)\\\\s~\\\\s.*$\",\"\\\\1\",deparse(myform))\n</code></pre>\n\n<p>It just seems to me, that these methods are more a hackery, than a reliable and standard method to do it.</p>\n\n<hr>\n\n<p>Does anyone know perchance what exactly method the e.g. <code>lm</code> use? I've seen it's code, but it is a little to cryptic to me... here is a quote for your convenience:</p>\n\n<pre><code>    &gt; lm\nfunction (formula, data, subset, weights, na.action, method = \"qr\", \n    model = TRUE, x = FALSE, y = FALSE, qr = TRUE, singular.ok = TRUE, \n    contrasts = NULL, offset, ...) \n{\n    ret.x &lt;- x\n    ret.y &lt;- y\n    cl &lt;- match.call()\n    mf &lt;- match.call(expand.dots = FALSE)\n    m &lt;- match(c(\"formula\", \"data\", \"subset\", \"weights\", \"na.action\", \n        \"offset\"), names(mf), 0L)\n    mf &lt;- mf[c(1L, m)]\n    mf$drop.unused.levels &lt;- TRUE\n    mf[[1L]] &lt;- as.name(\"model.frame\")\n    mf &lt;- eval(mf, parent.frame())\n    if (method == \"model.frame\") \n        return(mf)\n    else if (method != \"qr\") \n        warning(gettextf(\"method = '%s' is not supported. Using 'qr'\", \n            method), domain = NA)\n    mt &lt;- attr(mf, \"terms\")\n    y &lt;- model.response(mf, \"numeric\")\n    w &lt;- as.vector(model.weights(mf))\n    if (!is.null(w) &amp;&amp; !is.numeric(w)) \n        stop(\"'weights' must be a numeric vector\")\n    offset &lt;- as.vector(model.offset(mf))\n    if (!is.null(offset)) {\n        if (length(offset) != NROW(y)) \n            stop(gettextf(\"number of offsets is %d, should equal %d (number of observations)\", \n                length(offset), NROW(y)), domain = NA)\n    }\n    if (is.empty.model(mt)) {\n        x &lt;- NULL\n        z &lt;- list(coefficients = if (is.matrix(y)) matrix(, 0, \n            3) else numeric(), residuals = y, fitted.values = 0 * \n            y, weights = w, rank = 0L, df.residual = if (!is.null(w)) sum(w != \n            0) else if (is.matrix(y)) nrow(y) else length(y))\n        if (!is.null(offset)) {\n            z$fitted.values &lt;- offset\n            z$residuals &lt;- y - offset\n        }\n    }\n    else {\n        x &lt;- model.matrix(mt, mf, contrasts)\n        z &lt;- if (is.null(w)) \n            lm.fit(x, y, offset = offset, singular.ok = singular.ok, \n                ...)\n        else lm.wfit(x, y, w, offset = offset, singular.ok = singular.ok, \n            ...)\n    }\n    class(z) &lt;- c(if (is.matrix(y)) \"mlm\", \"lm\")\n    z$na.action &lt;- attr(mf, \"na.action\")\n    z$offset &lt;- offset\n    z$contrasts &lt;- attr(x, \"contrasts\")\n    z$xlevels &lt;- .getXlevels(mt, mf)\n    z$call &lt;- cl\n    z$terms &lt;- mt\n    if (model) \n        z$model &lt;- mf\n    if (ret.x) \n        z$x &lt;- x\n    if (ret.y) \n        z$y &lt;- y\n    if (!qr) \n        z$qr &lt;- NULL\n    z\n}\n</code></pre>\n"},{"tags":["r","matrix","contour"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13218541,"title":"How to produce contour plot in R from matrix","body":"<p>I have a file containing an nxn matrix of numeric values with a header row and column containing labels.</p>\n\n<p>I want to produce a contour plot of the values with R (2.14.x) so I am loading in the matrix like so:</p>\n\n<p><code>mat &lt;- as.matrix(read.table(\"myfile\", row.names=1, sep=\",\", header=TRUE))</code></p>\n\n<p>and then attempting to produce a contour plot by:</p>\n\n<p><code>contour(rownames(mat), colnames(mat), mat)</code></p>\n\n<p>but I get the error:</p>\n\n<pre><code>Error in r[i1] - r[-length(r):-(length(r) - lag + 1L)] : \n  non-numeric argument to binary operator\n</code></pre>\n\n<p>An example matrix that produces the problem contains:</p>\n\n<pre><code>,1,2,3\n1,827786,672544,622597\n2,674201,651413,533766\n3,626531,533179,489844\n</code></pre>\n\n<p>What's going wrong and how do I fix it?\nI'm very new to R so I might be doing something stupid here. Any help appreciated.</p>\n"},{"tags":["r","terminal","gnome"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":50,"score":3,"question_id":13216480,"title":"paste character limit","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13059083/why-and-where-are-n-newline-characters-getting-introduced-to-c\">Why and where are \\n newline characters getting introduced to c()?</a>  </p>\n</blockquote>\n\n\n\n<p>I am running <code>R</code> (version 2.15.1) in a <code>bash</code> shell (version 4.2.36(1)) in the GNOME terminal (version 3.4.1.1). Sometimes I write my code in a text file and then paste it directly into the console (when running <code>R</code>). I didn't have any problems until the scripts I was pasting grew in length. Now, it appears that any code greater than 4206 characters (including <code>\\n</code>) is rejected (i.e., the first 4206 characters are accepted and the remaining code is truncated; the truncation is accompanied by the terminal \"bell\" sound). This character limit is not specific to <code>bash</code> or GNOME terminal because I do not observe a character limit when pasting into e.g., <code>vi</code>. Therefore, I suspect that the character limit is imposed by <code>R</code>, but do not know how to change it, assuming it is a user-configurable parameter. Can the paste limit be changed and if so, what parameter governs it?</p>\n"},{"tags":["r","comments"],"answer_count":4,"favorite_count":3,"up_vote_count":16,"down_vote_count":0,"view_count":3564,"score":16,"question_id":1231195,"title":"R: Multiline Comment Workarounds?","body":"<p>I (sort of) already know the answer to this question.  But I figured it is one that gets asked so frequently on the R Users list, that one solid good answer belongs on SO.  <strong>To the best of my knowledge there is no multiline comment functionality in R.  So, do you have any good workarounds?</strong></p>\n\n<p>While quite a bit of work in R usually involves interactive sessions (which casts doubt on the need for multiline comments), there are times when I've had to send scripts to colleagues and classmates, much of which involves nontrivial blocks of code.  And for people coming from other languages it is a fairly natural question.  So.</p>\n\n<p>In the past I've used quotes.  Since strings support linebreaks, running an R script with</p>\n\n<pre><code>\"\nHere's my multiline comment.\n\n\"\na &lt;- 10\nrocknroll.lm &lt;- lm(blah blah blah)\n ...\n</code></pre>\n\n<p>works fine.  Do y'all have better solutions?</p>\n"},{"tags":["r","quantmod"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13216567,"title":"quantmod - getSymbols.MySQL format","body":"<p>I query a MySQL database using quantmod getSymbols with the following:</p>\n\n<pre><code>pot&lt;-getSymbols(Symbols=\"pot\",src='MySQL',user='root',password='root',dbname='data',\n   adjust=TRUE,db.fields=c(\"date\",\"open\",\"high\",\"low\",\"close\",\"volume\",\"time\"),\n   auto.assign=FALSE,\n   field.names=c(\"ticker\",\"date\",\"time\",\"open\",\"high\",\"low\",\"close\",\"volume\"),\n   format=\"%Y%m%d\")\n</code></pre>\n\n<p>Returns:\nMessing up the date conversion.</p>\n\n<blockquote>\n<pre><code>      pot.Open  pot.High  pot.Low   pot.Close pot.Volume pot.Adjusted\n</code></pre>\n  \n  <p>7058-02-20 \"40.1700\" \"40.1900\" \"40.1000\" \"40.1500\" \" 104900\"  \"09:30:59\"<br>\n  7058-02-20 \"40.0900\" \"40.1725\" \"40.0900\" \"40.1725\" \"  13200\"  \"09:31:53\"<br>\n  7058-02-20 \"40.1900\" \"40.3394\" \"40.1800\" \"40.2900\" \"  16500\"  \"09:32:57\"<br>\n  7058-02-20 \"40.3000\" \"40.3700\" \"40.2400\" \"40.2400\" \"  36500\"  \"09:33:58\"<br>\n  7058-02-20 \"40.2600\" \"40.3000\" \"40.2000\" \"40.2500\" \"   6700\"  \"09:34:59\"<br>\n  7058-02-20 \"40.2600\" \"40.3100\" \"40.2000\" \"40.2000\" \"  13900\"  \"09:35:59\"  </p>\n</blockquote>\n\n<p>I would like it to look like this:</p>\n\n<blockquote>\n<pre><code>               pot.Open  pot.High  pot.Low   pot.Close pot.Volume pot.Adjusted\n</code></pre>\n  \n  <p>2012-10-31 09:30:59 \"40.1700\" \"40.1900\" \"40.1000\" \"40.1500\" \" 104900\"  \"09:30:59\"<br>\n  2012-10-31 09:31:53 \"40.0900\" \"40.1725\" \"40.0900\" \"40.1725\" \"  13200\"  \"09:31:53\"<br>\n  2012-10-31 09:32:57 \"40.1900\" \"40.3394\" \"40.1800\" \"40.2900\" \"  16500\"  \"09:32:57\"<br>\n  2012-10-31 09:33:58 \"40.3000\" \"40.3700\" \"40.2400\" \"40.2400\" \"  36500\"  \"09:33:58\"<br>\n  2012-10-31 09:34:59 \"40.2600\" \"40.3000\" \"40.2000\" \"40.2500\" \"   6700\"  \"09:34:59\"<br>\n  2012-10-31 09:35:59 \"40.2600\" \"40.3100\" \"40.2000\" \"40.2000\" \"  13900\"  \"09:35:59\"  </p>\n</blockquote>\n\n<p>I believe it has to do with the date format in the table being (%Y%m%d) ex. 20121031 as opposed to the normal (%Y-%m-%d) ex.2012-10-31 format quantmod usually expects. The documentation says this can be changed via setDefaults(getSymbols.MySQL,...) but doesn't say how. Any thoughts? </p>\n"},{"tags":["r","conditional"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13216369,"title":"assigning based on more than 2 conditions in R to reassign data values for a vector","body":"<p>I have rather large meteorological data sets that look something like:</p>\n\n<pre><code>year  month day hour min sec temp RH Rad \n</code></pre>\n\n<p>I need to convert the day to the sequential day of year, e.g:</p>\n\n<ul>\n<li>jan 1 is day 0</li>\n<li>feb 1 is day 31</li>\n<li>march 1 is day 59 (in non leap years)</li>\n<li>April 1 is 90, etc.</li>\n</ul>\n\n<p>Data are stored in a data frame, say <code>met_dat</code>, with <code>met_dat$year</code>,  <code>met_dat$day</code>, etc.</p>\n\n<p>I'd like to assign the yd based on the month, i.e., </p>\n\n<pre><code>if met_dat$month==0, /*this is the code for january*/\nthen \nmet_dat$yd&lt;-met_dat$day,\n\nelse if met_dat$month==1, /*this is the code for february*/\nthen\nmet_dat$yd&lt;-met_dat$day+30\n\nelse if met_dat$month==2,\nthen\nmet_dat$yd&lt;-met_dat$day+58\n\netc, for the remaining months.\n</code></pre>\n\n<p>I've tried nesting ifelse statements as:</p>\n\n<pre><code>met_dat$yd&lt;-ifelse( (met_dat$month==0),met_dat$yd&lt;-met_dat$day,\n           (ifelse( (met_dat$month==1), met_dat$yd&lt;-met_dat$day+30,\n              (ifelse( (met_dat$month==2), met_dat$yd&lt;-met_dat$day+58, NA) )))\n</code></pre>\n\n<p>My real code has all 12 months, but 12 or three, this doesn't work...it assigns incorrect values for met_dat$yd, sometimes near correct, but never correct for all months.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13212015,"title":"Setting the endscale in filled.contour function","body":"<p>I have to plot a physical variable over a world map at differents moments. So i have to make many plot as how many moments i have to plot. The problem is that my routine set the end of the scale by default, and this make the reading of the plot difficult. I would like to fix the end of the scale, in order to have one scale for all the plots. This is piece of an old code i would reuse</p>\n\n<pre><code>  require(reshape)\n  require(mapdata)\n  require(mapproj)\n  df &lt;- read.table('/media/Lacie2/dati/hy.dat',head=F)\n  names(df) &lt;- c(\"value\", \"x\", \"y\")#, \"t\")\n  dfc &lt;- cast(df[ ,-4], x ~ y)\n  mm&lt;-as.matrix(dfc,ncol=480,nrow=241)\n  filled.contour(x=seq(0,360,length.out=480),y=seq(-90,90,length.out=241),mm,\n  color.palette = colorRampPalette(c(\"lightblue\", \"blue\",\"violet\", \"black\")),\n  xlab = \"Longitude (°)\", ylab = \"Latitude (°)\",\n  plot.axes = {axis(1); axis(2);            \n  map('world2Hires',\n  xlim = c(0, 360), \n  ylim = c(-90, 90), \n  add = T, col = \"black\")}\n )\n</code></pre>\n\n<p>I don't understand how to fix the endscale of the ladder. How can i do it?</p>\n"},{"tags":["r","variable-assignment"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13213845,"title":"Variable assignment within a for-loop","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6034655/r-how-to-convert-string-to-variable-name\">R: How to convert string to variable name?</a>  </p>\n</blockquote>\n\n\n\n<p>In R, I'm writing a for-loop that will iteratively create variable names and then assign values to each variable.</p>\n\n<p>Here is a simplified version. The intention is to create the variable's name based on the value of iterating variable i, then fill the new variable with NA values.  </p>\n\n<p>(I'm only iterating 1:1 below since the problem occurs isn't related to the looping itself, but rather to the way the variable is being created and assigned.)</p>\n\n<pre><code>for (i in 1:1) {\n\n    #name variable i \"Variablei\"\n    varName = paste(\"Variable\", as.character(i), sep=\"\")\n\n    #fill variable with NA values\n    varName = rep(NA, 12)\n\n    print(varName)\n    print(Variable1)\n}\n</code></pre>\n\n<p>Now, varName prints out as</p>\n\n<pre><code> [1] NA NA NA NA NA NA NA NA NA NA NA NA\n</code></pre>\n\n<p>and Variable1 is not found.</p>\n\n<p>I understand on some level why this is buggy. In the first line, varName becomes a vector whose only entry is the string \"Variable1\". Then varName gets reassigned to hold the NA values. So when I try to print Variable1, it doesn't exist.  </p>\n\n<p>I think the more general issue is assignment vs. equality. In the first line, I want varName to <em>be equal to</em> the newly made string, but in the next line, I want varName to <em>be assigned to</em> the NA value vector.</p>\n\n<p>What is the simplest way of creating that distinction? I'm also open to entirely different, better ways to go about this.</p>\n\n<p><em>EDIT: Changed title because I had mischaracterized the problem.</em></p>\n"},{"tags":["string","r","substring"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13215637,"title":"How to extract substrings from this string?","body":"<p>The string is \n<img src=\"http://i.stack.imgur.com/6jSVx.png\" alt=\"enter image description here\">\nAnd I want to get substrings \"11\",\"1.1\",\"282\". Can anyone show me how to do this in R? Thanks!</p>\n"},{"tags":["r","function","vectorization"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":74,"score":2,"question_id":11755545,"title":"check each element of vector against all rows of data frame","body":"<p>I have a vector, for which I want to check each element against each row of a data frame. It involves a grep function, since the elements to be checked are buried in other text.</p>\n\n<p>With help of <a href=\"http://stackoverflow.com/questions/11667734/r-check-elements-of-vector-against-other-vector\">this forum</a>, I got this code:</p>\n\n<pre><code>    mat=data.frame(par=c('long A story','C story', 'blabla D'),val=1:3) \n    vec=c('Z','D','A')\n    mat$label &lt;- NA\n    for (x in vec){\n       is.match &lt;- lapply(mat$par,function(y) grep(x, y))\n       mat$label[which(is.match &gt; 0)] &lt;- x\n    }\n</code></pre>\n\n<p>The problem is that it takes minutes to execute. Is there a way to vectorize this?</p>\n"},{"tags":["r","sample"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13214769,"title":"Randomly select groups (and all cases per group) in R?","body":"<p>I have an R dataframe with two levels of data: <code>id</code> and <code>year</code>. Within groups defined by <code>id</code>, the years increase (entire dataset has the same (number of) years per group, like so:</p>\n\n<pre><code>id    year    var1    var2\n11A   2001    ...     ...\n11A   2002    ...     ...\n11A   2003    ...     ...\n11A   2004    ...     ...\n13B   2001    ...     ...\n13B   2002    ...     ...\n13B   2003    ...     ...\n13B   2004    ...     ...\n22Z   2001    ...     ...\n</code></pre>\n\n<p>I have about 20.000 groups in my data, of couse way too many to make nice plots of growth curves. How do I randomly select about 20 of my id's? (so: also select all 4 rows of years corresponding to that id?)</p>\n"},{"tags":["r","for-loop","automation","paste"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":46,"score":0,"question_id":13214508,"title":"performing a calculation with a `paste`d vector reference","body":"<p>So I have some lidar data that I want to calculate some metrics for (I'll attach a link to the data in a comment).<br>\nI also have ground plots that I have extracted the lidar points around, so that I have a couple hundred points per plot (19 plots). Each point has X, Y, Z, height above ground, and the associated plot.  </p>\n\n<p>I need to calculate a bunch of metrics on the plot level, so I created <code>plotsgrouped</code> with <code>split(plotpts, plotpts$AssocPlot)</code>.<br>\nSo now I have a data frame with a \"page\" for each plot, so I can calculate all my metrics by the \"plot page\". This works just dandy for individual plots, but I want to automate it. (yes, I know there's only 19 plots, but it's the principle of it, darn it! :-P)<br>\nSo far, I've got a for loop going that calculates the metrics and puts the results in a data frame called <code>Results</code>. I pulled the names of the groups into a list called <code>groups</code> as well.  </p>\n\n<pre><code>for(i in 1:length(groups)){\nResults$Plot[i] &lt;- groups[i]\nResults$Mean[i] &lt;- mean(plotsgrouped$PLT01$Z)\nResults$Std.Dev.[i] &lt;- sd(plotsgrouped$PLT01$Z)\nResults$Max[i] &lt;- max(plotsgrouped$PLT01$Z)\nResults$75%Avg.[i] &lt;- mean(plotsgrouped$PLT01$Z[plotsgrouped$PLT01$Z &lt;= quantile(plotsgrouped$PLT01$Z, .75)])\nResults$50%Avg.[i] &lt;- mean(plotsgrouped$PLT01$Z[plotsgrouped$PLT01$Z &lt;= quantile(plotsgrouped$PLT01$Z, .50)])\n...\nand so on.\n</code></pre>\n\n<p>The problem arises when I try to do something like:<br>\n<code>Results$mean[i] &lt;- mean(paste(\"plotsgrouped\", groups[i],\"Z\", sep=\"$\"))</code>. <code>mean()</code> doesn't recognize the <code>paste</code> as a reference to the vector <code>plotsgrouped$PLT27$Z</code>, and instead fails. I've deduced that it's because it sees the quotes and thinks, \"Oh, you're just some text, I can't get the mean of you.\" or something to that effect.<br>\nBtw, groups is a list of the 19 plot names: PLT01-PLT27 (non-consecutive sometimes) and FTWR, so I can't simply put a sequence for the numeric part of the name.<br>\n<strong>Anyone have an easier way to iterate across my test plots and get arbitrary metrics?<br>\nI feel like I have all the right pieces, but just don't know how they go together to give me what I want.</strong><br>\nAlso, if anyone can come up with a better title for the question, feel free to post it or change it or whatever.</p>\n"},{"tags":["r","latex","knitr"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13214741,"title":"How to put greek letters in latex knitr figure caption?","body":"<p>I searched for this, but wasn't able to find it. In a knitr document, I want to put $\\alpha_1$ as the caption to a plot like so:</p>\n\n<pre><code>&lt;&lt;fig.cap='$\\alpha_1$'&gt;&gt;=\n plot(1:5,1:5)\n@\n</code></pre>\n\n<p>Trying to knit this comes back with the error</p>\n\n<pre><code>! Text line contains an invalid character.\nl.172 ...axwidth]{figure/plotSigma1} \\caption[$^^G\n                                              lpha_1$]{$^^Glpha_1$\\label...\n</code></pre>\n\n<p>Is there a way?</p>\n"},{"tags":["r","for-loop","model","build-automation","paste"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":11723551,"title":"using the output of paste() as an object, within a for loop in R","body":"<p>I want to construct a matrix of results for 48 GLMs (including model coefficients, R2, etc.). I though in calling the model objects by using a <code>for</code> loop which iteratively call them using <code>paste()</code> and <code>mget()</code> functions, which create a variable with the same name that the model object. Imagine these are the model objects:</p>\n\n<pre><code>var1_ds1_1&lt;-glm(var1~var_ds1)\nvar1_ds2_1&lt;-glm(var1~var_ds2)\nvar1_ds3_1&lt;-glm(var1~var_ds3)\n</code></pre>\n\n<p>My problem arise when I create a name to call the object using <code>paste()</code> and <code>mget()</code> to automatically create an object name identical to the model object name (in this simple example <code>mget(paste (\"var1\",table.row))</code> should result in <code>var1_ds1_1</code>, but I cannot extract the model coefficients or any other parameters.</p>\n\n<pre><code>for (tab.row in 1:48) {\n     result.matrix[tab.row,]&lt;-mget(paste (\"var1_ds\",table.row,\"_1\"))$coef[1] # An example to extract the linear coefficient\n}\n</code></pre>\n\n<p>My question is: How can I automatically generate the names of the model objects to store their parameters into a new result matrix?</p>\n\n<p>The new matrix should be:</p>\n\n<pre><code>Row Variable Dataset Slope P-Value R2\n 1  Var 1    1       1.3   0.001   50%\n 2  Var 1    2       0.8   0.004   32%   \n .    .      .        .      .      .\n48  Var n    n        .      .      .\n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["r","aggregate"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13202931,"title":"Aggregate lowess() over a dataframe","body":"<p>So I have a dataframe with four columns: Course ID, User ID, Day (an integer), and Cumulative Points Received. What I want to do is, for each user-course pair, use <code>lowess</code> to smooth the cumulative points over all of the days of the course. The <code>lowess</code> function takes a vector, applies a smoothing algorithm, and then returns two vectors <code>x</code> and <code>y</code>... I'm only interested in the <code>y</code> vector.</p>\n\n<p>My first idea was </p>\n\n<pre><code>aggregate(df$CumulativePointsReceived, \n          list(df$UserID, df$CourseID),\n          function(x) lowess(x)$y)\n</code></pre>\n\n<p>But that returns a basically unusable dataframe where the third column is a list of those vectors. What I want is a dataframe exactly like the input df, but with a column of the smoothed point values for each user-course-day. I'm sure there's a non-for-loop way to do this, but I can't seem to think about it the right way. Thanks in advance...</p>\n\n<p>Here's the dput of the first user-course pair in the original df. I would have put more, but it gets stupidly large with 110 days for each user-course.</p>\n\n<pre><code>structure(list(CourseID = c(6567146L, 6567146L, 6567146L, 6567146L,\n6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L,\n6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L,\n6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L,\n6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L,\n6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L,\n6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L,\n6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L,\n6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L,\n6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L,\n6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L,\n6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L,\n6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L,\n6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L,\n6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L,\n6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L, 6567146L,\n6567146L), UserID = c(4759679L, 4759679L, 4759679L, 4759679L,\n4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L,\n4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L,\n4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L,\n4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L,\n4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L,\n4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L,\n4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L,\n4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L,\n4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L,\n4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L,\n4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L,\n4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L,\n4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L,\n4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L,\n4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L, 4759679L,\n4759679L), DayInCourse = 1:110, CumulativePointsReceived = c(0,\n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 47, 47, 47, 47, 47, 47, 47, 47,\n47, 47, 47, 47, 47, 107, 107, 107, 107, 107, 107, 107, 107, 107,\n107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107,\n107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107,\n107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107,\n107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107,\n107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107,\n107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107, 107)), .Names =     c(\"CourseID\",\n\"UserID\", \"DayInCourse\", \"CumulativePointsReceived\"), row.names =     c(46085L,\n46118L, 46120L, 46133L, 46102L, 46086L, 46182L, 46184L, 46159L,\n46139L, 46088L, 46090L, 46144L, 46161L, 46187L, 46113L, 46177L,\n46193L, 46151L, 46143L, 46126L, 46121L, 46104L, 46170L, 46128L,\n46131L, 46167L, 46098L, 46127L, 46178L, 46101L, 46129L, 46152L,\n46175L, 46093L, 46122L, 46096L, 46136L, 46106L, 46116L, 46148L,\n46173L, 46189L, 46117L, 46172L, 46162L, 46164L, 46108L, 46091L,\n46112L, 46135L, 46181L, 46190L, 46171L, 46169L, 46100L, 46141L,\n46103L, 46168L, 46110L, 46107L, 46089L, 46154L, 46165L, 46125L,\n46163L, 46147L, 46166L, 46183L, 46160L, 46150L, 46097L, 46115L,\n46157L, 46194L, 46138L, 46188L, 46153L, 46155L, 46179L, 46180L,\n46191L, 46095L, 46176L, 46111L, 46105L, 46142L, 46087L, 46109L,\n46158L, 46145L, 46114L, 46192L, 46140L, 46146L, 46174L, 46094L,\n46124L, 46149L, 46119L, 46186L, 46130L, 46134L, 46156L, 46185L,\n46099L, 46123L, 46137L, 46132L, 46092L), class = \"data.frame\")\n</code></pre>\n"},{"tags":["r","plot","bar-chart"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":86,"score":2,"question_id":13210152,"title":"plotting grouped bar charts in R","body":"<p>i am trying to plot this data in R -</p>\n\n<pre><code>column1  column2  column3\n1-2       abc       10\n1-2       def       15\n1-2       ghi       20\n2-3       abc       80\n2-3       def       95\n2-3       ghi       10\n3-4       abc       30\n3-4       def       55\n3-4       ghi       80\n</code></pre>\n\n<p>the x axis would be column1 (so 1-2, 2-3 and 3-4 would be present as the x axis), and on y axis, the values in column3 should be plotted for each of the column2 elements. So this would be a \"grouped\" barchart essentially.</p>\n\n<p>I am not able to plot this grouped bar chart using R. \nThe code snippet I am using is below:</p>\n\n<pre><code>dataset &lt;- fetch(rs,n=-1)\nplot_var &lt;- table(dataset$percentage, dataset$age)\nbarplot(plot_var, names.arg,\n        main=\"Title of Graph\",\n        xlab=\"Column1\", col=c(\"darkblue\",\"red\"),\n        legend = rownames(plot_var), beside=TRUE)\n</code></pre>\n\n<p>How do I get this grouped bar chart to display?\nThanks!</p>\n"},{"tags":["r","function","statistics"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":59,"score":0,"question_id":13213544,"title":"R optimization function","body":"<p>I wanted to use the optim function to get the optimal value for my variable \"result\"</p>\n\n<p>The variable \"<code>returns</code>\" has proper values (503). I printed the values and its working fine.\nHowever, I get an error where I call \"<code>optim</code>\":</p>\n\n<blockquote>\n  <p>Error in optim(): L-BFGS-B needs finite values of 'fn</p>\n</blockquote>\n\n<p>Actual Code:</p>\n\n<pre><code>library(VGAM)\nini_val &lt;- c(mean(returns), 1)\nla_ret = optim(init_val, fn = function(theta){\n-sum(log(dlaplace(returns, theta[1], theta[2])))},\nmethod = \"L-BFGS-B\", lower = c(-Inf, 0))\nla_ret\n</code></pre>\n\n<p>I don't understand why I'm getting <em>infinite</em> values of '<code>fn</code>'</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":61,"score":5,"question_id":13213451,"title":"Smoothing in ggplot","body":"<p>I have this ggplot</p>\n\n<pre><code>ggplot(dt.1, aes(x=pctOAC,y=NoP, fill=Age)) +\n    geom_bar(stat=\"identity\",position=position_dodge()) +\n    geom_smooth(aes(x=pctOAC,y=NoP, colour=Age), se=F, method=\"loess\",show_guide = FALSE,lwd=0.7) +\n    theme(legend.position=c(.2,0.8))\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/vXpaD.png\" alt=\"enter image description here\"></p>\n\n<pre><code>dt1 &lt;- structure(list(Age = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L), .Label = c(\"o80\", \"u80\"), class = \"factor\"), NoP = c(47L, 5L, 33L, 98L, 287L, 543L, 516L, 222L, 67L, 14L, 13L, 30L, 1L, 6L, 17L, 30L, 116L, 390L, 612L, 451L, 146L, 52L), pctOAC = c(0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100)), .Names = c(\"Age\", \"NoP\", \"pctOAC\"), row.names = c(NA, -22L), class = \"data.frame\")\n</code></pre>\n\n<p>I would like to have the smooth lines constrained to lie above zero, perhaps something similar to a kernel density. In fact if I <strong>had</strong> the underlying data, I expect a kernel density is <strong>exactly</strong> what I would want, but I only have the aggregated data. Is there any way to do this ? I tried using different <code>method=</code> in the <code>geom_smooth</code>, but the small dataset seems to prevent it. I wondered about using <code>stat_function</code> but I don't have much clue about how to proceed with finding a suitable function to plot.</p>\n"},{"tags":["r","scope","statistics","global-variables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13213170,"title":"0 vector result in R after running function","body":"<p>After I finished running my function, I kept on getting 0s as my answer:</p>\n\n<pre><code> niv_density &lt;- function(returns, mu, delta, alpha, beta, t)\n{\n    t &lt;- 1/t\n    gamma &lt;- sqrt(alpha^2 - beta^2)\n    result &lt;- rep(0, (1/t))\n    for(i in 1:(1/t))\n    {\n        term3 &lt;- exp(delta*gamma*t + beta*(returns[i] - mu*t))\n        term1 &lt;- alpha*delta*t/pi\n        term2_1 &lt;- besselY(alpha*sqrt(delta^2*t^2 + (returns[i] - mu*t)^2), 1)\n        term2_2 &lt;- sqrt(delta^2*t^2 + (returns[i] - mu*t)^2)\n        term2 &lt;- term2_1/term2_2\n        result[i] &lt;- (term1*term2*term3)\n    }\n}\n\nniv_density(returns, 0, 2, 50, 0, 10)\nresult\n</code></pre>\n\n<p>After executing the last part, I get a vector of 0s. I think I'm having a problem with global vs. local scopes, but I'm not sure how to fix it.</p>\n\n<pre><code>dput(returns)\nstructure(c(-0.003859212, 0.011873365, -0.004826217, -0.004006846, \n-0.004527209, -0.005597606, -0.001446292, 0.004890173, 0.001260653, \n-0.005469839, 0.001715495, 0.00776223, -6.79514e-05, -0.002405413, \n-0.00344927, 0.013203733, 0.009007395, -0.002918161, -0.000682757, \n0.003600917, -0.001584568, 0.001778635, 0.003881849, -0.003228443, \n0.00809855, -0.003407655, 0.006570117, -0.001629285, -0.001479157, \n-0.000683758, 0.007489741, 0.007807378, 0.001399056, -0.000578823, \n-0.002437511, -0.000593349, -0.004020762, 0.004744014, -0.001815119, \n0.007757796, -0.002401808, -0.00225831, -0.005162853, -0.002256747, \n0.032891919, 0.005882631, -0.011822966, -0.005744899, -0.004359233, \n0.00405189, 0.017035644, 0.001079738, 0.001845759, -0.004758891, \n0.006067706, -0.006027932, -0.00224155, -0.010844493, 0, -0.003861616, \n-0.004698823, 0.000397524, 0.001840917, 0.013599978, -0.008376557, \n1.92494e-05, 0.010797502, -0.004105023, 0.003119424, -0.004797368, \n-0.001962367, 0.002663974, 0.008489008, 0.007827146, -0.000566674, \n-0.003404669, -0.000160508, -0.003953786, -0.000635631, 0.0023086, \n0.008931147, -0.002761431, 0.013046559, -0.009673618, 0.007572105, \n-0.011309217, 0.003777911, -0.004767721, -0.004096769, 0.003915212, \n-0.005571037, 0.008566323, -0.009063831, -0.011191246, -0.000639167, \n0.002834983, -0.009156367, 0.00189252, 0.007166451, -0.001788182, \n-0.002437146, 0.00226261, -0.010459432, -0.001511577, 0.00039628, \n-0.00349739, 0.009561965, 0.063504871, 0.003492974, 0.009233691, \n0.004795333, -0.003995969, -0.002552804, 6.81834e-05, 0.006134657, \n0.006713932, -0.006875273, -0.005108732, 0.006239377, 0.002293386, \n-0.01121192, -0.005666844, 0.000894577, -0.012511724, 0.00351622, \n-0.009671627, -0.004480382, 0.007385228, -0.009143379, 0.005467177, \n0.017094141, 0.005918621, 0.001514995, -0.001356959, 0.015656296, \n0.001101646, 0.001457523, 0.0051402, -0.005516804, 0.002832519, \n-0.002196811, -0.007752963, 0.009050809, 0.006380147, 0.001995102, \n0.002319077, -0.001788715, 0.000845096, -0.009821598, 0.012634302, \n-0.001457121, 0.000582262, -0.004083585, -0.004021717, -0.000571503, \n0.006159289, -0.010822168, -0.015789222, -0.000657867, 0.013935285, \n0.001312777, -0.001172312, 0.003031039, 0.002482838, -0.010634785, \n0.014015267, 0.005435065, -0.034817949, 0.005145224, -0.007217488, \n0.00458109, 0.012581199, 0.001853981, 0.002118571, -0.011151137, \n-0.007933775, 0.011336262, 0.018212375, 0.007815775, 0.006103632, \n-0.007270438, -0.001066825, 0.001892988, -0.009740379, 0.012057142, \n0.00024459, -0.003702988, 0.014628744, -0.001902607, -7.49322e-05, \n-0.005903797, -0.002481339, -0.004266069, 0.01150386, -0.019888508, \n0.007657512, -0.004649027, 0, 0.002523089, -0.00072238, -0.021153782, \n-0.007969763, 0.005775428, -0.010897333, 0.007468107, -0.009508927, \n0.000464995, -0.002430182, 0.010796022, 0.008898853, -0.013079549, \n0.027112561, -0.015413991, -0.007630787, 0.007033724, -0.017738864, \n-0.015961032, -0.015579591, -0.011802317, -0.002187586, 0.003065715, \n0.013389559, -0.000885034, -0.013701533, 0.001976838, 0.001041955, \n-0.003616062, 0.005344799, 0.007148373, -0.002877552, -0.007681476, \n0.021591165, 0.017966863, -0.058771073, -0.019551973, 0.005203616, \n0.002169669, 0.003884158, -0.022568915, 0.002769004, -0.007779571, \n0.018998803, -0.001212088, 0.002446011, 0.007740844, 0.012532807, \n0.006287039, 0.003958813, 0.01407559, 0.001064047, -0.00862106, \n-0.012296938, -0.013967015, 0.010524923, -0.010789529, 0.011953286, \n0.000738662, -0.016492003, -0.00257709, -0.015437029, 0.004315983, \n0.023337948, 0.008138125, 0.005972748, 0.005915635, 0.010493804, \n-0.011895336, -0.005245454, 0.007409717, 0.012596218, -0.005221382, \n-0.005462129, 0.008785043, 0.009134618, 0.015541224, 0.016072839, \n-0.003827797, 0.000403703, 0.03749696, -0.003386946, -0.008627298, \n-0.030790478, -0.003861794, -0.011426323, 0.001393173, 0.008541783, \n0.009361445, -0.023851831, 0.024814864, -0.019724128, 0.002621807, \n-0.017904622, -0.003584294, -0.019299804, -0.00234839, -0.002685042, \n0.002685042, 0.016590137, 0.001401377, -0.006120481, 0.006690448, \n-0.004740457, -0.005027981, 0.013204038, -0.002742491, 0.005110009, \n-0.006393429, 0.00464228, -0.00270551, -0.011552836, 0.003074876, \n0.005139878, 0.002032361, 0.007603533, 0.010491222, 0.000658875, \n0.003909991, 0.00236732, 0.019192366, -0.00361624, 0.005696264, \n-0.005852811, 0.014805765, 0.00313454, 0.006385073, -0.005475311, \n-0.009195918, 0.008472618, -0.000559148, -0.007272851, 0.003748203, \n0.001156269, 0.004328552, -0.006107929, -0.012121056, 0.002812434, \n-0.009577213, 0.005689626, -0.001941957, 0.006145673, -0.002275509, \n-0.006578825, -0.005345298, -0.000327811, 0.003751791, 0.005053343, \n0.005157952, -0.022100394, -0.007461083, 0.003576376, 0.00093598, \n0.006738706, 0.006976768, 0.001078282, -0.006256189, 0.003313743, \n-0.005955287, 0.011771523, 0.001644383, -0.003459295, 0.032863111, \n-0.007369908, -0.001099451, 0.004745151, 0.012094786, 0.001167328, \n-0.00404787, -0.004345022, -0.001121192, 0.004333763, -0.008483142, \n-0.001578184, -0.00046999, 0.005079249, -0.005970832, 0.005543307, \n0.006722626, 0, 0.001715197, 0.011776868, 0.013308783, -0.004160112, \n-0.000304697, 0.014924613, 0.007204855, -0.00509816, 0.007186504, \n0.002287253, -0.009948655, -0.001000861, -0.00431929, -0.00347645, \n0.005015994, -0.007540969, 0.00558486, -0.005661924, -0.006602168, \n-0.002824197, 0.001939661, 0.006563001, -0.009757559, -0.00978824, \n-0.001247868, 0.002622219, -0.009097288, -0.014394158, -0.00292424, \n0.002644891, -0.005572549, -0.003181826, 0.002676673, 0.007032888, \n0.002127581, 0.005281961, 0.016021024, 0.001232531, 0.005515082, \n0.000450254, 0.003568462, 0.006277841, -0.003823264, -0.032527132, \n0.021873831, -0.003231721, -0.000368515, -0.001397511, -0.010973353, \n-0.011563657, -0.010061858, 0.005714484, 0.007472816, 0.003407539, \n-0.000612977, -0.000800283, -0.001900635, -0.000865432, -0.003630001, \n0.00562073, 0.001858425, 0.010064273, -0.006584881, -0.001470899, \n0.005433816, -0.002510864, -0.001071656, -0.005130965, 2.35065e-05, \n0.003445676, 0.01374472, -0.001123534, 0.006067276, 0.004050843, \n-0.000773321, -0.003401186, 0.001908336, -0.003562041, -0.001180884, \n-0.003133416, 0.005819655, -0.002096198, -4.92007e-05, 0.002838133, \n-0.010010669, 0.00557654, -0.000122526, 0.022760252, -0.005618111, \n0.014434193, 0.001716112, 0.01567573, 0.001566116, -0.003071945, \n-0.018146189, -0.012123038, -0.007480614, 0.007735601, -0.00436506, \n0.003091618, 0.004704796, 0.001184206, 0.010066361, 0.005389096, \n-0.007021784, -0.004211278, -0.001740557, -0.00628043, 0.002434464, \n-0.000333944, 0.010815674, 0.016910153, 0, -0.01318228, -0.002858256, \n0.024721185, 0.001006412, -0.003651077, 0.009682259, -0.007093437, \n-0.002005597, 0.002424598, -0.015024047, 0.015051995, 0.004720944\n), na.action = structure(504L, class = \"omit\"))\n</code></pre>\n"},{"tags":["r","colors","heatmap","labels"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13206335,"title":"Color Labels (text) in R heatmap","body":"<p>I am trying to make a heatmap in R in which the label text is colored (to indicate which group the data point comes from).</p>\n\n<p>I am currently using heatmap.2, but would be happy to use another package. </p>\n\n<pre><code>heatmap.2(data.matrix(data),trace = 'none', dendrogram='none',ColSideColors=col)\n</code></pre>\n\n<p>This call gives me the colored bar (ColSideColors) along the labels, but I'd like to make the labels themselves colored.  </p>\n\n<p>Many thanks! </p>\n"}]}
{"total":19203,"page":4,"pagesize":100,"questions":[{"tags":["r","replace","numbers"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":1374,"score":-2,"question_id":5612821,"title":"Replace specific column \"words\" into number or blank","body":"<p>Input table</p>\n\n<pre><code>Patients  Hospital   Drug   Response\n1         AAA        a      Good\n1         AAA        a      Bad\n2         BBB        a      Bad\n3         CCC        b      Good\n4         CCC        c      Bad\n5         DDD        e      undefined \n</code></pre>\n\n<p>Output file</p>\n\n<pre><code>Patients  Hospital   Drug   Response\n1         AAA        a      1\n1         AAA        a      -1\n2         BBB        a      -1\n3         CCC        b      1\n4         CCC        c      -1\n5         DDD        e       \n</code></pre>\n\n<p>How to replace 3 texts in one column to number and blank?</p>\n\n<p>\"good in Reponse column\" to \"1\"\n\"bad in Reponse column\" to \"-1\"\n\"undefined in Reponse column\" to \" \"</p>\n\n<p>Data:</p>\n\n<pre><code>structure(list(Patients = c(1L, 1L, 2L, 3L, 4L, 5L), Hospital = structure(c(1L, \n1L, 2L, 3L, 3L, 4L), .Label = c(\"AAA\", \"BBB\", \"CCC\", \"DDD\"), class = \"factor\"), \n    Drug = structure(c(1L, 1L, 1L, 2L, 3L, 4L), .Label = c(\"a\", \n    \"b\", \"c\", \"e\"), class = \"factor\"), Response = structure(c(2L, \n    1L, 1L, 2L, 1L, 3L), .Label = c(\"Bad\", \"Good\", \"undefined\"\n    ), class = \"factor\")), .Names = c(\"Patients\", \"Hospital\", \n\"Drug\", \"Response\"), class = \"data.frame\", row.names = c(NA, \n-6L))\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13210962,"title":"Generating new sub timeseries in R","body":"<p>I would like to generate a list of time series based on the column indexs of a master time series (<code>m</code>)</p>\n\n<pre><code>head(cols)\n          [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15] [,16] [,17] [,18]\n    [1,]    1    1    1    1    1    1    1    1    1     1     1     1     1     1     1     1     1     1\n    [2,]    2    2    2    2    2    2    2    2    2     2     2     2     2     2     2     2     2     2\n    [3,]    3    3    3    3    3    3    3    3    4     4     4     4     4     4     4     5     5     5\n    [4,]    4    5    6    7    8    9   10   11    5     6     7     8     9    10    11     6     7     8\n</code></pre>\n\n<p>so for example the first data.frame in the list would be made from <code>m[,1], m[,2], m[,3]</code> and <code>m[,4]</code> and look something like</p>\n\n<pre><code>              1            2             3            4   \n2012-01-01 -0.0248361511  0.0127908458 -0.011976191  0.009987137\n2012-01-02 -0.0005351887  0.0290350115  0.004208001  0.007078312\n2012-01-03 -0.0016072867  0.0042660695  0.008660648 -0.018255748\n2012-01-04  0.0016072867 -0.0001303243  0.001782532 -0.004775416\n2012-01-05  0.0026730837 -0.0038740336 -0.007149271  0.015511091\n</code></pre>\n\n<p>And the 14th would be something like</p>\n\n<pre><code>              1            2             4            10\n2012-01-01 -0.0248361511  0.0127908458  0.009987137  0.0051973431\n2012-01-02 -0.0005351887  0.0290350115  0.007078312  0.0081517268\n2012-01-03 -0.0016072867  0.0042660695 -0.018255748 -0.0008121889\n2012-01-04  0.0016072867 -0.0001303243 -0.004775416  0.0071366761\n2012-01-05  0.0026730837 -0.0038740336  0.015511091  0.0186782999\n</code></pre>\n\n<p>is there some function I can write or use in the form</p>\n\n<pre><code>apply(cols,2, function(x)  DOSOMETHINGLIKE\"a &lt;- merge(a,m[x])\"HERE)\n</code></pre>\n"},{"tags":["r","subset","ranking"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":23,"score":-2,"question_id":13196923,"title":"R: local ranking lists, aggregated by value in row","body":"<p>I have data of the following form:</p>\n\n<pre><code>\"almond\" \"blueberry\" 3\n\"almond\" \"leek\" 6\n\"almond\" \"citron\" 7\n\"almond\" \"fish\" 2\n...\n\"leek\" \"swiss_cheese\" 3\n\"leek\" \"pumpkin\" 5\n\"leek\" \"onion\" 4\n\"leek\" \"chocolate\" 10\n...\n</code></pre>\n\n<p>For each value in the first column I want to find the <em>k</em> best partners according to the third column. \"Best\" means: lower number in the third row. Thus, for <em>almond</em> its three best partners are <em>fish, blueberry, leek</em>. For <em>leek</em>, its three best partners are <em><code>swiss_cheese</code>, onion, and pumpkin</em>. I finally want to reduce the full table to the three best partners for each of the factors in the first column, i.e.</p>\n\n<pre><code>\"almond\" \"blueberry\" 3\n\"almond\" \"leek\" 6\n\"almond\" \"fish\" 2\n...\n\"leek\" \"swiss_cheese\" 3\n\"leek\" \"pumpkin\" 5\n\"leek\" \"onion\" 4\n...\n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":70,"score":1,"question_id":13203512,"title":"adding a legend to a scatterplot with fitted line and prediction interval","body":"<p>I have this ggplot</p>\n\n<pre><code>ggplot(dt1, aes(x=x,y=y)) +\n    geom_point(color=\"orange\",shape=1, size=1.5) +\n    stat_function(fun=function(x) 1.05+.65*sqrt(x)+.1*x, color=\"blue\" ) +\n    stat_function(fun=function(x) 1.05-.65*sqrt(x)+.1*x, color=\"blue\" ) +\n    stat_smooth(method=\"lm\",formula=\"y~-1+x\",fullrange=TRUE,se = FALSE, color=\"black\")\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/n9KgC.png\" alt=\"enter image description here\"></p>\n\n<p>The data are simply:</p>\n\n<pre><code>&gt; str(dt1)\n'data.frame':   1451 obs. of  2 variables:\n $ y: int  70 161 151 207 100 268 184 156 246 43 ...\n $ x: int  679 1818 1650 2325 992 2412 1830 1398 2207 495 ...\n</code></pre>\n\n<p>Here is a sample of data:</p>\n\n<pre><code>dt1 &lt;- structure(list(y = c(70L, 161L, 151L, 207L, 100L, 268L, 184L, 156L, 246L, 43L, 125L, 135L, 45L, 93L, 88L, 162L, 131L, 143L, 227L, 177L, 124L, 203L, 243L, 193L, 182L, +\n223L, 259L, 215L, 170L, 288L, 67L, 141L, 272L, 160L, 66L, 123L, 226L, 383L, 149L, 354L), x = c(679L, 1818L, 1650L, 2325L, 992L, 2412L, 1830L, 1398L, 2207L, 495L, 1071L, 1200L, 723L, 1162L, 1075L, 1431L, 1169L, 1665L, 2136L, 1402L, 896L, 1951L, 2222L, 1960L, 1601L,+\n1787L, 2277L, 1861L, 1432L, 2451L, 626L, 1292L, 2216L, 1499L, 766L, 906L, 2157L, 3419L, 1352L, 3346L)), .Names = c(\"y\", \"x\"), row.names = c(NA, 40L), class = \"data.frame\")\n</code></pre>\n\n<p>I would like to have a legend with the following 3 entries:</p>\n\n<ul>\n<li>one for the geom_point showing the correct type of point</li>\n<li>one for the stat_smooth showing a black line</li>\n<li>one for stat_function (that is, one legend entry, not two), showing a blue line</li>\n</ul>\n\n<p>How can I achieve this ?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":75,"score":2,"question_id":13210672,"title":"Dynamic list creation","body":"<p>I am vexed by the way R dynamically creates lists and I am hoping someone can help me understand what is going on and what to do to fix my code. My problem is that for assignments of a vector of length one, a named vector is assigned, but assignments of a vector of length greater than one, a list is assigned. My desired outcome is that a list is assigned no matter the length of the vector I am assigning. How do I achieve such a result?</p>\n\n<p>For example,</p>\n\n<pre><code>types &lt;- c(\"a\", \"b\")\nlst &lt;- vector(\"list\", length(types))\nnames(lst) &lt;- types\nstr(lst)\nList of 2\n $ a: NULL\n $ b: NULL\nlst$a[[\"foo\"]] &lt;- \"hi\"\nlst$b[[\"foo\"]] &lt;- c(\"hi\", \"SO\")\nstr(lst)\nList of 2\n $ a: Named chr \"hi\"\n  ..- attr(*, \"names\")= chr \"foo\"\n $ b:List of 1\n  ..$ foo: chr [1:2] \"hi\" \"SO\"\nstr(lst$a)\n Named chr \"hi\"\n - attr(*, \"names\")= chr \"foo\"\nstr(lst$b)\nList of 1\n $ foo: chr [1:2] \"hi\" \"SO\"\n</code></pre>\n\n<p>What I want to have as the outcome is a data structure that looks like this.</p>\n\n<pre><code>List of 2\n $ a:List of 1\n  ..$ foo: chr [1] \"hi\"\n $ b:List of 1\n  ..$ foo: chr [1:2] \"hi\" \"SO\"\n</code></pre>\n"},{"tags":["r","plot","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13209950,"title":"Simple plotting function in R","body":"<p>I am having a problem with a plotting function in R. Here is what i got so far.</p>\n\n<pre><code>countries &lt;- c(\"CHINA \", \"UNITED STATES\", \"UNITED KINGDOM\", \"GERMANY\")\nKeyItems &lt;- c(\"Pretax Income\", \"Total Liabilities\", \"Total Assets\")\ndatA &lt;- mean_values[mean_values$Country %in% countries &amp; mean_values$KeyItem %in% KeyItems, ]\ndatA$KeyItem &lt;- factor(datA$KeyItem, levels = KeyItems, order = TRUE)\np &lt;- xyplot(mn_value ~ Year | KeyItem, datA, groups = datA$Country[, drop = TRUE],\n            auto.key = list(space = \"right\"), par.settings = simpleTheme(pch = 1:5),\n            type = c(\"p\", \"l\"), as.table = TRUE)\nprint(p)\n</code></pre>\n\n<p>my dataframe looks like this:</p>\n\n<pre><code>    KeyItem         Year     Country                                      mn_value\n172 Pretax Income   1980    SWITZERLAND                                 2.091623e+08\n173 Pretax Income   1980    IRELAND                                     3.597619e+07\n174 Pretax Income   1980    GERMANY                                     2.301015e+07\n175 Pretax Income   1980    SWEDEN                                      4.980680e+07\n</code></pre>\n\n<p>It returns this error:</p>\n\n<pre><code>Error in dat$Year == Year : 'Year' is missing\n</code></pre>\n\n<p>I have hardly any experience in R. I just can't find a fix for my Problem. Thank you in advance.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13204699,"title":"How do you cast a double to an integer in R?","body":"<p>My question is: Suppose you have computed an algorithm that gives the number of iterations and you would like to print the number of iterations out. But the output always many decimal places, like the following:</p>\n\n<pre><code>64.00000000\n</code></pre>\n\n<p>Is it possible to get an integer by doing type casting in R ? How would you do it ??</p>\n"},{"tags":["r","bigdata","pca"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":96,"score":2,"question_id":12670972,"title":"doing PCA on very large data set in R","body":"<p>I have a very large training set (~2Gb) in a CSV file. The file is <strong>too large</strong> to read directly into memory (<code>read.csv()</code> brings the computer to a halt) and I would like to reduce the size of the data file using PCA. The problem is that (as far as I can tell) I need to read the file into memory in order to run a PCA algorithm (e.g., <code>princomp()</code>).</p>\n\n<p>I have tried the <code>bigmemory</code> package to read the file in as a <code>big.matrix</code>, but <code>princomp</code> doesn't function on <code>big.matrix</code> objects and it doesn't seem like <code>big.matrix</code> can be converted into something like a <code>data.frame</code>.</p>\n\n<p><strong>Is there a way of running <code>princomp</code> on a large data file that I'm missing?</strong></p>\n\n<p>I'm a relative novice at R, so some of this may be obvious to more seasoned users (apologies in avance).</p>\n\n<p>Thanks for any info.</p>\n"},{"tags":["r","bigdata","logfile-analysis"],"answer_count":1,"favorite_count":4,"up_vote_count":22,"down_vote_count":0,"view_count":314,"score":22,"question_id":12767432,"title":"How can I tell when my dataset in R is going to be too large?","body":"<p>I am going to be undertaking some logfile analyses in R (unless I can't do it in R),  and I understand that my data needs to fit in RAM (unless I use some kind of fix like an interface to a keyval store, maybe?).  So I am wondering how to tell ahead of time how much room my data is going to take up in RAM, and whether I will have enough.  I know how much RAM I have (not a huge amount - 3GB under XP), and I know how many rows and cols my logfile will end up as and what data types the col entries ought to be (which presumably I need to check as it reads).   </p>\n\n<p>How do I put this together into a go/nogo decision for undertaking the analysis in R?  (Presumably R needs to be able to have some RAM to do operations, as well as holding the data!)  My immediate required output is a bunch of simple summary stats, frequencies, contingencies, etc, and so I could probably write some kind of parser/tabulator that will give me the output I need short term, but I also want to play around with lots of different approaches to this data as a next step, so am looking at feasibility of using R. </p>\n\n<p>I have seen lots of useful advice about large datasets in R here, which I have read and will reread, but for now I would like to understand better how to figure out whether I should (a) go there at all,  (b) go there but expect to have to do some extra stuff to make it manageable, or (c)  run away before it's too late and do something in some other language/environment (suggestions welcome...!).  thanks!</p>\n"},{"tags":["r","web-scraping","rcurl"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":75,"score":4,"question_id":13204503,"title":"How to use R to download a zipped file from a SSL page that requires cookies","body":"<p>I am trying to download a file from an https page that requires an \"I Agree\" button be pushed and then stores a cookie.  My apologies if this answer is obvious somewhere..</p>\n\n<p>When I open up the web page directly in Chrome and click \"I Agree\" - the file starts to download automatically.</p>\n\n<p><a href=\"http://www.icpsr.umich.edu/cgi-bin/bob/zipcart2?path=SAMHDA&amp;study=32722&amp;bundle=delimited&amp;ds=1&amp;dups=yes\" rel=\"nofollow\">http://www.icpsr.umich.edu/cgi-bin/bob/zipcart2?path=SAMHDA&amp;study=32722&amp;bundle=delimited&amp;ds=1&amp;dups=yes</a></p>\n\n<p>I tried to replicate <a href=\"http://stackoverflow.com/questions/10213194/use-rcurl-to-bypass-disclaimer-page-then-do-the-web-scrapping\">this example</a>, but I don't think that hangseng website actually stores the cookie/authentication, so I don't know if that example should be all I need.</p>\n\n<p>Beyond that, I believe the SSL complicates the authentication, since I think the getURL() call will require a certificate specification like cainfo = system.file(\"CurlSSL\", \"cacert.pem\", package = \"RCurl\"))</p>\n\n<p>I'm too much of a beginner with RCurl to know if this website is pretty difficult or if I'm just missing something obvious.</p>\n\n<p>Thank you!</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":12,"down_vote_count":0,"view_count":115,"score":12,"question_id":13056392,"title":"print if not assigned","body":"<p>How can I write into a function a way to detect if the output is being assigned (<code>&lt;-</code>) to something?  The reasoning is I'd like to print a message if it is not being assigned and just goes to the console but if it is being assigned I'd like it not to print the message.</p>\n\n<p>Here's a dummy example and how I'd like it to behave:</p>\n\n<pre><code>fun &lt;- function(x) {\n    if (being_assigned) {\n        print(\"message\")\n    }\n    return(x)\n}\n\n#no assignment so message prints \n&gt; fun(6)  \n[1] \"message\"\n[1] 6\n\n#assignment so message does not prints\n&gt; x &lt;- fun(6)\n</code></pre>\n\n<p>The <code>being_assigned</code> in the function is the imaginary unknown condition I'd like to detect but don't know how.</p>\n"},{"tags":["r","snowfall"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13209668,"title":"Snowfall sfApply() is slower than apply()","body":"<p>I am new to multicore in R and is trying out the snowfall package to test if it is possible to speed up the apply function. </p>\n\n<p>Not sure what went wrong but my multi-core implementation of sfApply() is always about 2 times slower than the apply()</p>\n\n<p>Any help is greatly appreciated! Thanks in advance.</p>\n\n<p>Single core example - complete to about 1.3 seconds in my PC:</p>\n\n<pre><code>x=2000\ny=10000\nstartTime &lt;- proc.time()\n\nrandomX &lt;- sample(1:100,x*y, replace=T)/100+0.5\nrandomMatrix &lt;- matrix(NA,x,y)\nrandomMatrix[,] &lt;- randomX\nrandomRetX &lt;- apply(randomMatrix,2,cumprod)\n\nendTime &lt;- proc.time()\nendTime-startTime\n</code></pre>\n\n<p>Snowfall Implementation - close to 3 secs in my PC:</p>\n\n<pre><code>library(snowfall)\nsfInit( parallel=TRUE, cpus=4)\nx=2000\ny=10000\n\nstartTime &lt;- proc.time()\n\nrandomX &lt;- sample(1:100,x*y, replace=T)/100+0.5\nrandomMatrix &lt;- matrix(NA,x,y)\nrandomMatrix[,] &lt;- randomX\nrandomRetX &lt;- sfApply(randomMatrix,2,cumprod)\n\nendTime &lt;- proc.time()\n\nendTime-startTime\nsfStop()\n</code></pre>\n"},{"tags":["r","sum","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13208989,"title":"Add colum that sums up values until this row","body":"<p>Assume I have a dataframe <code>df</code> with one column namely <code>time</code>. Now, I'd like to add a new column to the dataframe <code>accumulated</code> as seen below, that sums up the values from <code>df.time</code> for each row.</p>\n\n<pre><code>    time     accumulated\n1   10       10\n2   12       22\n3   14       36\n4   6        42  \n</code></pre>\n\n<p>A quick hint would be really nice!</p>\n"},{"tags":["r","foreach","domc"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":68,"score":3,"question_id":13206223,"title":"R foreach : Number of threads reduce to 1","body":"<p>Consider a sample code</p>\n\n<pre><code>library(\"foreach\")\n\n library(\"doMC\")\n\n library(\"multicore\")\n\n multicore:::detectCores()\n\n registerDoMC(cores=6)\n\n alpha &lt;- foreach(i = 1:10) %dopar% {\n  ...\n }\n</code></pre>\n\n<p>When I use top, on launch the number of threads is say 6. The amount of work for each thread is substantial. But, the number of threads quickly drops down to 5,4,3,2 and then 1. I guess from then on the execution is serial. I don't understand why ?</p>\n\n<p>Cheers</p>\n"},{"tags":["r","functional-programming","tail-recursion"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13208963,"title":"Tail recursion on R Statistical Environment","body":"<p>Does R support proper tail recursion and where can I find documentation about this? Thanks in advance.</p>\n"},{"tags":["algorithm","r","permutation"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13200650,"title":"Creating a permutation of a length 40 vector of boolean values in R","body":"<p>I am trying to create the unique permutations of the vector</p>\n\n<pre><code> c(rep(0,20),rep(1,20))\n</code></pre>\n\n<p>but permn in the combinat package says \"Error in vector.... vector size specified is too large\".</p>\n\n<p>I also tried the script uniqueperm2 from <a href=\"http://stackoverflow.com/questions/5671149/permute-all-unique-enumerations-of-a-vector-in-r\">this question</a> and got a \"vector specified is too large\" error again.  </p>\n\n<p>In my understanding permn would be creating 40! permutations. </p>\n\n<p>I might be able to solve the overall problem I am working on just by finding the number of unique permutations of this vector. </p>\n\n<p>Is the problem of finding the unique permutations of a length 40 vector too big for R and can anyone explain to me how to figure out the number of unique permutations of the listed vector?</p>\n"},{"tags":["sql","r","data.table","xts","zoo"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":196,"score":3,"question_id":12557762,"title":"Splitting irregular time series into regular monthly averages - R","body":"<p>In order to establish seasonal effects on energy use, I need to align the energy use information that I have from a billing database with monthly temperatures.</p>\n\n<p>I'm working with a billing dataset that has bills of varying lengths and start and end dates, and I'd like to obtain the monthly average for each account within each month.  For example, I have a billing database that has the following characteristics:</p>\n\n<pre><code>   acct amount      begin        end days\n1  2242  11349 2009-10-06 2009-11-04   29\n2  2242  12252 2009-11-04 2009-12-04   30\n3  2242  21774 2009-12-04 2010-01-08   35\n4  2242  18293 2010-01-08 2010-02-05   28\n5  2243  27217 2009-10-06 2009-11-04   29\n6  2243    117 2009-11-04 2009-12-04   30\n7  2243  14543 2009-12-04 2010-01-08   35\n</code></pre>\n\n<p>I would like to figure out how to coerce these somewhat irregular time series (for each  account) to get the average amount per day within each month that is spanned within each bill, such that:</p>\n\n<pre><code>   acct amount      begin        end days avgamtpday\n1  2242  11349 2009-10-01 2009-10-31   31          X\n2  2242  12252 2009-11-01 2009-11-30   30          X\n3  2242  21774 2009-12-01 2010-12-31   31          X\n4  2242  18293 2010-01-01 2010-01-31   31          X\n4  2242  18293 2010-02-01 2010-02-28   28          X\n5  2243  27217 2009-10-01 2009-10-31   31          X\n6  2243    117 2009-11-01 2009-11-30   30          X\n7  2243  14543 2009-12-01 2009-12-31   30          X\n7  2243  14543 2010-01-01 2010-01-31   31          X\n</code></pre>\n\n<p>I'm fairly agnostic to whichever tool can do this, since I only have to do this once.</p>\n\n<p>An additional wrinkle is the table is about 150,000 rows long, which is not really very big by most standards, but big enough to make a loop solution in R difficult.  I've investigated using the zoo, xts, and tempdisagg packages in R.  I started writing a really ugly loop that would split each bill, then create one row for each month within an existing bill, and then tapply() to summarize by accts and months, but honestly, couldn't see how to do it efficiently.</p>\n\n<p>In MySQL, I've tried this:</p>\n\n<blockquote>\n  <p>create or replace view v3 as select 1 n union all select 1 union all select 1;<br>\n  create or replace view v as select 1 n from v3 a, v3 b union all select 1;<br>\n  set @n = 0;<br>\n  drop table if exists calendar; \n  create table calendar(dt date primary key);<br>\n  insert into calendar<br>\n     select cast('2008-1-1' + interval @n:=@n+1 day as date) as dt \n     from v a, v b, v c, v d, v e, v; </p>\n  \n  <p>select acct, amount, begin, end, billAmtPerDay, sum(billAmtPerDay), MonthAmt, \n  count(<em>) Days, sum(billAmtPerDay)/count(</em>) AverageAmtPerDay, year(dt), month(dt)\n     FROM ( select *, amount/days billAmtPerDay \n        from bills b \n           inner join calendar c on dt between begin and end and begin &lt;> dt) x \n  group by acct, amount, begin, end, billAmtPerDay, year(dt), month(dt);</p>\n</blockquote>\n\n<p>But for reasons I don't understand, my server doesn't like this table, and gets hung up on the inner join, even when I stage the different calculations.  I'm investigating if there are any temporary memory limits on it.</p>\n\n<p>Thanks!</p>\n"},{"tags":["r","rstudio"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13204873,"title":"Transfer packages from old to new version R studio","body":"<p>I am using a R studio 0.96.331 (and R 2.15.1) and wanted to install new version of the studio (0.97). But, I am a bit worried about whether I have to install all the packages that I downloaded in the old version of the studio. Is there a simple way to  transfer all the downloaded packages of old version into new one? </p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":13205174,"title":"Position of a variable within a vector","body":"<p>Does anyone know of a simple and efficient way to figure out how many values, in an unsorted vector, are greater than a variable?</p>\n\n<p>My vector is 1,000,000 values long, and I have about 400 of these comparisons to make, with different vectors and variables. Any time-saving function would be appreciated...</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":71,"score":5,"question_id":13195442,"title":"Moving variance in R","body":"<p>I know that the <code>filter()</code> function in R calculate the moving average. I would like to know if exists a function that return me the moving variance or standard deviation, in order to show it in a plot side by side with the output of <code>filter()</code> function. </p>\n"},{"tags":["r","list","matrix","social-networking","edge"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13204046,"title":"How to create an edge list from a matrix in R?","body":"<p>The relationship is expressed as a matrix <code>x</code> like this: </p>\n\n<pre><code>      A    B    C     D\nA     0    2    1     1\nB     2    0    1     0\nC     1    1    0     1\nD     1    0    1     0\n</code></pre>\n\n<p>The entries refer to the number of connections they have.\nCould anyone show me how to write it as an edge list? Thanks!\nI am considering to write it as an edge list like:\n  <img src=\"http://i.stack.imgur.com/6gN8Q.png\" alt=\"enter image description here\"></p>\n\n<p>But is this edge list right if I want to create a network plot?\nThank you!</p>\n"},{"tags":["r","memory"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":13204672,"title":"Memory Usage/Allocation in R","body":"<p>I'm running R to handle a file which is about 1Gb in size, filtering it into several smaller files, and then trying to print them out. I'm getting errors like this at different points throughout the process: </p>\n\n<pre><code>**Error: cannot allocate vector of size 79.4 Mb**\n</code></pre>\n\n<p>A vector of this size should be a non-issue, with how much memory I /should/ be working with. My machine has 24Gb of memory, and the overwhelming majority of that is still free, even when the R environment with these large objects in it is up and running, and I'm seeing the error above.</p>\n\n<pre><code>free -m\n             total       used       free     shared    buffers     cached\nMem:         24213       2134      22079          0         55        965\n-/+ buffers/cache:       1113      23100\nSwap:        32705          0      32705\n</code></pre>\n\n<p>here is R's response to gc():</p>\n\n<pre><code>corner      used   (Mb) gc trigger   (Mb)  max used   (Mb)\nNcells    673097   18.0    1073225   28.7    956062   25.6\nVcells 182223974 1390.3  195242849 1489.6 182848399 1395.1\n</code></pre>\n\n<p>I'm working in Ubuntu 12.04.1 LTS</p>\n\n<p>here are some specs from the machine I'm using: </p>\n\n<pre><code>i7-3930K 3.20 GHz Hexa-core (6 Core)12MB Cache\nASUS P9X79 s2011 DDR3-1333MHZ,1600 upto 64GB\n32GB DDR3 ( 8x4GB Module )\n128GB SSD drive\nAsus nVidia 2GB GTX660 TI-DC2O-2GD5 GeForce GTX 660 Ti i\n</code></pre>\n\n<p>this is the object I'm attempting to write to file:</p>\n\n<pre><code>dim(plant)\n[1] 10409404       13\n</code></pre>\n\n<p>the 'plant' object is of the class \"data.frame\". here is one of the lines of code that prompts the error:</p>\n\n<pre><code>write.table(plant, \"file.txt\", quote=F, sep=\"\\t\", row.names=T, col.names=F)\n</code></pre>\n\n<p>Any help on solving this issue would be much appreciated.</p>\n"},{"tags":["r","extract","match","subset"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":56,"score":4,"question_id":13148128,"title":"Extract data using a matching matrix pair of data in R","body":"<p>I have two data sets with latitude, longitude, and temperature data. One data set corresponds to a geographic region of interest with the corresponding lat/long pairs that form the boundary and contents of the region (Matrix Dimension = 4518x2)</p>\n\n<p>The other data set contains lat/long and temperature data for a larger region that envelopes the region of interest (Matrix Dimenion = 10875x3).</p>\n\n<p>My question is: How do you extract the appropriate row data (lat, long, temperature) from the 2nd data set that matches the first data set's lat/long data?</p>\n\n<p>I've tried a variety of \"for loops,\" \"subset,\" and \"unique\" commands but I can't obtain the matching temperature data.</p>\n\n<p>Thanks in advance!</p>\n\n<hr>\n\n<p>10/31 Edit: I forgot to mention that I'm using \"R\" to process this data.</p>\n\n<p>The lat/long data for the region of interest was provided as a list of 4,518 files containing the lat/long coordinates in the name of each file:</p>\n\n<pre><code>x&lt;- dir()\n\nlenx&lt;- length(x)\n\ng &lt;- strsplit(x, \"_\")\n\ncoord1 &lt;- matrix(NA,nrow=lenx, ncol=1)  \ncoord2 &lt;- matrix(NA,nrow=lenx, ncol=1)\n\nfor(i in 1:lenx) {  \ncoord1[i,1] &lt;- unlist(g)[2+3*(i-1)]  \ncoord2[i,1] &lt;- unlist(g)[3+3*(i-1)]     \n} \n\ncoord1&lt;-as.numeric(coord1)  \ncoord2&lt;-as.numeric(coord2)\n\ncoord&lt;- cbind(coord1, coord2)\n</code></pre>\n\n<p>The lat/long and temperature data was obtained from an NCDF file for with temperature data for 10,875 lat/long pairs:</p>\n\n<pre><code>long&lt;- tempcd$var[[\"Temp\"]]$size[1]   \nlat&lt;- tempcd$var[[\"Temp\"]]$size[2]   \ntime&lt;- tempcd$var[[\"Temp\"]]$size[3]  \nproj&lt;- tempcd$var[[\"Temp\"]]$size[4]  \n\ntemp&lt;- matrix(NA, nrow=lat*long, ncol = time)  \nlat_c&lt;- matrix(NA, nrow=lat*long, ncol=1)  \nlong_c&lt;- matrix(NA, nrow=lat*long, ncol =1)  \n\ncounter&lt;- 1  \n\nfor(i in 1:lat){  \n    for(j in 1:long){  \n        temp[counter,]&lt;-get.var.ncdf(precipcd, varid= \"Prcp\", count = c(1,1,time,1), start=c(j,i,1,1))  \n        counter&lt;- counter+1  \n    }  \n}  \n\ntemp_gcm &lt;- cbind(lat_c, long_c, temp)`\n</code></pre>\n\n<p>So now the question is how do you remove values from \"temp_gcm\" that correspond to lat/long data pairs from \"coord?\"</p>\n"},{"tags":["r","vector","statistics","median"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":48,"score":0,"question_id":13204008,"title":"median in R need numeric data","body":"<p>I was trying to compute the median of a given vector, but when I tried I kept on getting an error:</p>\n\n<pre><code>median(returns)\nError in median.default(returns) : need numeric data\n\n&gt; returns\n [1] 0.001262733  -0.005048584 -0.009160197 0.010411955  -0.00542421 \n [6] -0.010982649 -0.005807832 0.000863131  -0.00210823  0.000117543 \n[11] 0.001319904  0.005307534  0.005246006  0.008469327  0.006006664 \n[16] -0.001411188 -0.011446652 0.002669714  0.003896259  -0.003060607\n[21] 0.006306116  0.000895311  -0.006235211 -0.000856819 -0.00056599 \n[26] 0.00808345   0.00038652   -0.004070623 0.008398158  -0.005976036\n[31] 0.011270873  0.007959499  0.003776885  -0.000591663 0.001163452 \n[36] 0.005759682  0.000678132  0.000609123  -0.000735042\n40 Levels: -0.00056599 -0.000591663 -0.000735042 -0.000856819 ... 0.011270873\n\ndput(returns)\nstructure(c(25L, 9L, 14L, 39L, 10L, 15L, 11L, 22L, 6L, 18L, 26L, \n31L, 30L, 38L, 33L, 5L, 16L, 27L, 29L, 7L, 34L, 23L, 13L, 4L, \n1L, 36L, 19L, 8L, 37L, 12L, 40L, 35L, 28L, 2L, 24L, 32L, 21L, \n20L, 3L), .Label = c(\"-0.00056599\", \"-0.000591663\", \"-0.000735042\", \n\"-0.000856819\", \"-0.001411188\", \"-0.00210823\", \"-0.003060607\", \n\"-0.004070623\", \"-0.005048584\", \"-0.00542421\", \"-0.005807832\", \n\"-0.005976036\", \"-0.006235211\", \"-0.009160197\", \"-0.010982649\", \n\"-0.011446652\", \"#DIV/0!\", \"0.000117543\", \"0.00038652\", \"0.000609123\", \n\"0.000678132\", \"0.000863131\", \"0.000895311\", \"0.001163452\", \"0.001262733\", \n\"0.001319904\", \"0.002669714\", \"0.003776885\", \"0.003896259\", \"0.005246006\", \n\"0.005307534\", \"0.005759682\", \"0.006006664\", \"0.006306116\", \"0.007959499\", \n\"0.00808345\", \"0.008398158\", \"0.008469327\", \"0.010411955\", \"0.011270873\"\n), class = \"factor\")\n</code></pre>\n"},{"tags":["r","data.table","xts","zoo"],"answer_count":0,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":132,"score":5,"question_id":13200600,"title":"working with panel data in R","body":"<p>I would like to see what people use to work with panel data in R with large datasets (ie 50 mil + obs): the <code>data.table</code> package is useful in that it has keys and is very fast.  The <code>xts</code> package is useful because it has facilities for doing all sorts of time series stuff.  Therefore, it seems there are two good options:</p>\n\n<ol>\n<li>have a <code>data.table</code> and write custom time series functions to work on that</li>\n<li>have a list of <code>xts</code> objects and run <code>lapply</code> on that list every time you want to do something.  eventually this will need to be merged into a <code>data.frame</code> to do regressions etc.</li>\n</ol>\n\n<p>I am aware of the <code>plm</code> package but have not found it as useful for data management as the two options above.  What do you guys use? Any ideas on what works best when?</p>\n\n<p>Let me propose a scenario: imagine having N firms with T time periods, where N>>0 and T>>0. <code>data.table</code> will be super fast if I want to lag each firm by 1 time period, for example:</p>\n\n<pre><code>x &lt;- data.table(id=1:10, dte=rep(seq(from=as.Date(\"2012-01-01\"), to=as.Date(\"2012-01-10\"), by=\"day\"), each=10), val=1:100, key=c(\"id\", \"dte\"))\nx[,lag_val:=c(NA, head(val, -1)),by=id]\n</code></pre>\n\n<p>Another way to do this might be:</p>\n\n<pre><code>y &lt;- lapply(ids, function(i) {xts(x[id==i, val], order.by=x[id == i, dte])})\ny &lt;- lapply(y, function(obj) { cbind(obj, lag(obj, 1)) })\n</code></pre>\n\n<p>The advantage of the former is it's speed with big data. The advantage of the latter is the ability to do things like <code>period.apply</code> and use other functionality of <code>xts</code>.  Are there tricks to making the <code>xts</code> representation faster? Maybe a combination of the two? Converting from and to <code>xts</code> objects is costly, it seems.</p>\n"},{"tags":["r","matrix","plot","social-networking","relationship"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":13203778,"title":"How to plot relationships in R?","body":"<p>The relationship is expressed as a matrix <code>x</code> like this: </p>\n\n<pre><code>      John Jack Mary Wendy\nJohn     0    2    1     1\nJack     2    0    1     0\nMary     1    1    0     1\nWendy    1    0    1     0\n</code></pre>\n\n<p>The entries refer to the number of connections they have.\nCould anyone show me how to plot it as a network in R? Thanks!</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":55,"score":3,"question_id":13202573,"title":"Alternative to class() that does not distinguish between \"numeric\" and \"integer\"","body":"<p>Given a data.frame, I would like to test if all the columns are of the same \"class\". if they are I'd like to leave the data.frame as is. If they aren't I'd like to keep all columns that match the first variables class and drop any that are not of that class. The exception being that, for my purposes, integer and numeric are equal. </p>\n\n<p>For example: </p>\n\n<pre><code>dat &lt;- data.frame(numeric,numeric,integer,factor) \n</code></pre>\n\n<p>Would be: </p>\n\n<pre><code>data.frame(numeric,numeric,integer) \n</code></pre>\n\n<p>Additionally</p>\n\n<pre><code>dat &lt;- data.frame(character,character,integer)\n</code></pre>\n\n<p>Would be: </p>\n\n<pre><code>data.frame(character,character) \n</code></pre>\n\n<p>And finally: </p>\n\n<pre><code>dat &lt;- data.frame(numeric,numeric,numeric,factor)\n</code></pre>\n\n<p>Would be: </p>\n\n<pre><code>data.frame(numeric,numeric,numeric)\n</code></pre>\n"},{"tags":["r","ggplot2","ggplot","axis-labels"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13191601,"title":"Thousand separator in label of x or y axis","body":"<p>I would like to have pretty labels on the y-axis. For example, I prefer to have 1,000 instead of 1000. How can I perform this in ggplot? Here is a minimum example:</p>\n\n<pre><code>x &lt;- data.frame(a=c(\"a\",\"b\",\"c\",\"d\"), b=c(300,1000,2000,4000))\nggplot(x,aes(x=a, y=b))+\n               geom_point(size=4)\n</code></pre>\n\n<p>Thanks for any hint.</p>\n"},{"tags":["r","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13202790,"title":"How to place categorical labels on right side of barchart?","body":"<p>In the default Lattice barchart, categorical variable labels are placed on the left.  I want to put them on the right as well.  I can manipulate locations of numeric ticks and labels using <code>scales</code>, but have had no success in moving the categorical labels.  Study of <code>help(barchart)</code> and Sarkar's book has not led to the answer (which is not to say the answer isn't there).</p>\n"},{"tags":["arrays","r","table","dim"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":26,"score":-2,"question_id":13202641,"title":"converting array (produced by \"table\") to data frame in r or s-plus","body":"<p>I am trying to convert an array that was produced by the \"table\" function into a normal data frame within a function.  I've tried \"as.data.frame\", and get is.data.frame=TRUE.  However, the object is still an array with an extra dim.  This causes problems when I merge it with a data frame, and I end up with a single column of the data frame having array dimensions.  How can I coerce the object to a simple data frame? The extra dim contains only the rownames.  I've tried setting rownames to null to no avail.  </p>\n"},{"tags":["r","sas"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":592,"score":0,"question_id":3391644,"title":"Replicating probit regression in SAS and R","body":"<p>I'm trying to replicate my SAS work in R, but I get slightly different results -- differences that can't be explained by rounding error.</p>\n\n<p>Here's my SAS code:</p>\n\n<pre><code>proc qlim data=mydata;\n   model y = x1 x2 x3/ discrete(d=probit);\n   output out=outdata marginal;\n   title \"just ran QLIM model\";\nrun;\nquit;\n</code></pre>\n\n<p>And here's my R code:</p>\n\n<pre><code>mymodel &lt;- glm(y ~ x1 + x2 + x3, family=binomial(link=\"probit\"), data=mydata)\n</code></pre>\n\n<p>I'm not really sure why I'd get the different results, and would greatly appreciate an explanation.</p>\n\n<p>EDIT\nHere's my data:</p>\n\n<pre><code>2.66  20  0  0\n2.89  22  0  0\n3.28  24  0  0\n2.92  12  0  0\n4.00  21  0  1\n2.86  17  0  0\n2.76  17  0  0\n2.87  21  0  0\n3.03  25  0  0\n3.92  29  0  1\n2.63  20  0  0\n3.32  23  0  0\n3.57  23  0  0\n3.26  25  0  1\n3.53  26  0  0\n2.74  19  0  0\n2.75  25  0  0\n2.83  19  0  0\n3.12  23  1  0\n3.16  25  1  1\n2.06  22  1  0\n3.62  28  1  1\n2.89  14  1  0\n3.51  26  1  0\n3.54  24  1  1\n2.83  27  1  1\n3.39  17  1  1\n2.67  24  1  0\n3.65  21  1  1\n4.00  23  1  1\n3.1   21  1  0\n2.39  19  1  1\n</code></pre>\n\n<p>And here's my estimated coefficients (std errors in parantheses):</p>\n\n<pre><code>SAS: -7.452320 (2.542536)\n      1.625810 (0.693869)\n      0.051729 (0.083891)\n      1.426332 (0.595036)\nR:   -7.25319  (2.50977)\n      1.64888  (0.69427)\n      0.03989  (0.07961)\n      1.42490  (0.58347)\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13202167,"title":"Melt/dcast/melt with margins not working","body":"<p>I have a data frame defined somewhat as follows (there are really 200+ variables):</p>\n\n<pre><code>class_level var1 var2\n          1    4    7\n          1    6    7\n          1    7    6\n          4    3    1\n          4    1    3\n</code></pre>\n\n<p>where class_level is either 1 or 4, and var1 and var2 have values of 1-7 which are likert-like response levels from a survey.</p>\n\n<p>I want a data frame that includes counts by level for each var by class level, with a totals row for each variable, something like:</p>\n\n<pre><code>class_level variable Levels Students\n          1     var1      1       10  \n          1     var1      2        7  \n          1     var1      3       28  \n          1     var1      4       15  \n          1     var1      5       54  \n          1     var1      6       38  \n          1     var1      7       16\n          1     var1  Total      168  \n          4     var1      1       58\n          .        .      .        .\n          .        .      .        .\n          .        .      .        .\n          4     var1      7       33\n          4     var1  Total      294  \n</code></pre>\n\n<p>I have tried the following:</p>\n\n<pre><code>df.m &lt;- melt( df, id.vars=c(\"class_level\"), na.rm=TRUE )\nhead(df.m)\n#  class_level variable value\n#1           4     var1     4\n#2           4     var1     6\n#3           1     var1     7\n#4           4     var1     3\n#5           1     var1     5\n#6           4     var1     6\n\ndf.c &lt;- dcast( df.m, class_level+variable ~ value,\n               fun.aggregate=length, \n               subset=.(variable %in% c(\"var1\",\"var2\")),\n               margins=TRUE\n             )\nhead(df.c)\n#  class_level variable 1 2  3  4  5   6   7 (all)\n#1           1     var1 1 1  8 24 56 101  32   223\n#2           1     var2 2 4  4 22 49  79  56   216\n#3           4     var1 4 5 11 38 91 114  76   339\n#4           4     var2 2 6 11 35 73  98 106   331\n\ndf.o &lt;- melt( df.c, id.vars=c(\"class_level\",\"variable\"),\n              variable.name=\"Levels\", value.name=\"Students\"\n            )\nhead(df.o)\n#  class_level variable Levels Students\n#1           1     var1      1        1\n#2           1     var2      1        2\n#3           4     var1      1        4\n#4           4     var2      1        2\n#5           1     var1      2        1\n#6           1     var2      2        4\n</code></pre>\n\n<p>As you can see, this produces counts by levels for each variable, but no totals rows.  How do I get the totals rows in the final dataset (df.o).  Any help would be greatly appreciated.</p>\n\n<p>David</p>\n"},{"tags":["r","plot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13202173,"title":"R plot for showing true/false positives","body":"<p>I'm looking for a way to plot my data.  Suppose you have a number of algorithms that produce a ranked list, and a classifier that identifies each item in the list as true or false.  How can I produce a chart that puts each algorithm beside each other and each rank has its own square stacked as follow:</p>\n\n<pre><code>      __   __\n 3   |TP| |FP|\n     |__| |__|\n 2   |FP| |TP|\n     |__| |__|\n 1   |TP| |TP|\n     |__| |__|\n      a    b\n</code></pre>\n\n<p>Where TP could be coloured green and FP could be coloured red for example.</p>\n"},{"tags":["r","plot","expression","legend"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13201503,"title":"R: legend expression how to add comma between two values and how to supress scientific notation","body":"<p>I'm trying to format the legend in my plot, but I have to use expression() because of greek and superscripts.  However, when I want to display r^2 = 0.45, P&lt;0.0001, I get r^2 = 0.45 P&lt;1e-04, when I type in </p>\n\n<pre><code>legend(expression(r^2==0.9230~~P&lt;0.0001))\n</code></pre>\n\n<p>I tried looking up the list() function but it doesn't help with the commas.  I couldn't find anything on using decimals in the expression() function either.</p>\n\n<p>Any suggestions would be appreciated.</p>\n\n<p>Thanks</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13199301,"title":"split and table","body":"<p>I have a data frame like this:</p>\n\n<blockquote>\n<pre><code> GN  SN  \n  a   b   \n  a   b   \n  a   c   \n  d   e   \n  d   f \n  d   e\n</code></pre>\n</blockquote>\n\n<p>I would like the following output:<br>\nGN: a  SN: 2 b  1 c<br>\n GN  d  SN: 2 e  1 f</p>\n\n<p>In other words I would like to have a sort of table() of the data.frame on the column S.N. First of all I splitted the data.frame according to $GN, so I have blocks. At this point I' m not able to have the counting of the elements on column SN according to the split I've done. Is the \"apply\" function a way to do this? And how can i save a general output belonging from split function?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","asp.net-mvc-3","r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13201574,"title":"REngine rengine = REngine.CreateInstance(\"RDotNet\", new[] { \"-q\" } stops the execution further when called second time","body":"<p>I am plotting the forecast graph by using R.NET  and using ASP.NET MVC3. At first time, it creates an instance of RENgine. by </p>\n\n<pre><code>REngine rengine = REngine.CreateInstance(\"RDotNet\", new[] { \"-q\" })\n</code></pre>\n\n<p>and plots the graph as required. But when I call this same method second time by choosing another graph to be plotted, it stops to move further after this,. Please someone help me to figure out where I am going wrong. The code I have used is </p>\n\n<pre><code>using (REngine rengine = REngine.CreateInstance(\"RDotNet\", new[] { \"-q\" }))\n    {\n        rengine.EagerEvaluate(\"YrTimeSeries&lt;-c(123,234,255,456)\");\n        rengine.EagerEvaluate(\"tsValue&lt;-ts(YrTimeSeries,frequency=1,\" \n                               + dt_StartYr.Rows[0][0].ToString() + \")\");\n        rengine.EagerEvaluate(\"library(Cairo);\");\n        rengine.EagerEvaluate(\"library(forecast)\");\n        rengine.EagerEvaluate(@\"CairoPNG('C:\\\\Documents and Settings\\\\a\\\\im.png);\n        rengine.EagerEvaluate(\"plot(forecast(tsValue,h=5),main='Immunization')\");\n        rengine.EagerEvaluate(\"graphics.off();\");\n        rengine.Close();\n        rengine.Dispose();\n\n    }\n}\n</code></pre>\n"},{"tags":["r","attributes","count","genetics","cytoscape"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13114681,"title":"R WGCNA Cytoscape hub genes","body":"<p>I have the following problem with </p>\n\n<p>WGCNA - <a href=\"http://labs.genetics.ucla.edu/horvath/htdocs/CoexpressionNetwork/Rpackages/WGCNA/Tutorials/\" rel=\"nofollow\">http://labs.genetics.ucla.edu/horvath/htdocs/CoexpressionNetwork/Rpackages/WGCNA/Tutorials/</a></p>\n\n<p>Working on Section 1.6, Export of networks to external software (Cytoscape)</p>\n\n<p>I'm currently trying to perform WGCNA on a set of genes and I'm having trouble getting the top x hub genes for each module. I am trying to export a network to Cytoscape and used the same method for getting the top x hub genes as outlined for exporting to VisANT.</p>\n\n<pre><code># Select modules (only interested in one for now)\nmodules = c(\"greenyellow\")\n\n# Select module probes\nprobes = names(datExpr)\ninModule = is.finite(match(bwModuleColors, modules))\nmodProbes = probes[inModule]\nmodGenes = annot$gene_symbols[match(modProbes, annot$geneID)]\n\n# Select the corresponding Topological Overlap\nmodTOM = TOM[inModule, inModule]\ndimnames(modTOM) = list(modProbes, modProbes)\n\n# Restrict the network to the top 30 genes\nnTop = 30\nIMConn = softConnectivity(datExpr[, modProbes]\ntop = (order(-IMConn) &lt;= nTop)\n\n# Export the network into a fomat that Cytoscape can read\ncyt = exportNetworkToCytoscape(modTOM[top, top],\n  edgeFile = paste(\"CytoscapeInput-edges-\", paste(modules, collapse=\"-\"), \".txt\", sep = \"\"),\n  nodeFile = paste(\"CytoscapeInput-nodes-\", paste(modules, collapse=\"-\"), \".txt\", sep = \"\"),\n  weight = TRUE,\n  threshold = 0.02,\n  nodeNames = modProbes,\n  altNodeNames = modGenes,\n  nodeAttr = bwModuleColors[inModule])\n</code></pre>\n\n<p>I've written a short loop to count the number of connections to each gene and it works as expected, but the xth gene consistently has zero connections. Let's say that x is 30. If I increase the cutoff to 31 hub genes, the 30th gene now shows connections to the others in the network, but the 31st gene shows nothing. In addition, this change increases AND decreases some of the number of connections to other genes in the network. This really bothers me, because connections should only be added, since the network is getting bigger by one gene, and the changes should be accounted for by the 30th gene, but this is not the case for the output.</p>\n\n<pre><code># Split the cytoscape file into two parts: edge and node\nnode &lt;- cyt$nodeData\nedge &lt;- cyt$edgeData\n\n\n# The limit covers all of the connections in the edge file by determining the length of the column ‘fromNode’\nlimit &lt;- length(edge$fromNode)\n\n# Create an empty list to store the counts for each gene\ncounts = list()\n\n# Loop for the genes going from 1 to the number of genes specified for the network, ‘nTop’\nfor (i in 1:nTop) {\n\n# Reset the count for each new gene and specify the names of the gene of interest and the matching genes\n  name = node$nodeName[[i]]\n\n  count = 0\n\n# Nested loop that searches for matches to the gene in question in both the ‘fromNode’ and ‘toNode’columns, and adds one to the count for each match.\n  for (j in 1:limit) {\n    matchName1 = edge$fromNode[[j]]\n    matchName2 = edge$toNode[[j]]\n    if (name == matchName1 || name == matchName2)\n      {count = count + 1}\n    }\n\n# Create a string for the attribute in the correct format\n    attribute &lt;- paste(name, \"=\", count)\n\n# Adds the count to the list\n  counts &lt;- c(counts, attribute)\n  }\n# End of loop\n</code></pre>\n\n<p>The loop seems to be working as expected, so I'm thinking that the problem is with the network construction. I'm currently referring back to what I know about linear algebra, matrices and topology to try to see if the problem is the way they're being sorted or something like that, but it might just be the way that the exportNetworkToCytoscape() function works.</p>\n"},{"tags":["python","r","interface","python-3.x"],"answer_count":3,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":1528,"score":8,"question_id":2573132,"title":"What is the best interface from Python 3.1.1 to R?","body":"<p>I am using Python 3.1.1 on Mac OS X 10.6.2 and need an interface to R. When browsing the internet I found out about RPy. Is this the right choice? </p>\n\n<p>Currently, a program in Python computes a distance matrix and, stores it in a file. I invoke R separately in an interactive way and read in the matrix for cluster analysis. In order to\nsimplify computation one could prepare a script file for R then call it from Python and read back the results. Since I am new to Python, I would not like to go back to 2.6. </p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13200821,"title":"Using str_sub from stringr to replace characters in all elements of a vector","body":"<p>I am trying to replace characters in all elements of a string vector, where the characters are different, but always a certain distance from the beginning or the end of the string.  I can use <code>substr</code> successfully to replace the characters from the beginning of the string. I am trying to use <code>str_sub</code> from the package <code>stringr</code> to replace the characters from the end of the sting (because it allows counting backwards with negative numbers).  It replaces the character, but for all elements after the first one, it replaces everything to the right of the character with the end of the string from the first element:</p>\n\n<pre><code>&gt; require(stringr)\n&gt; x &lt;- c(\"A'B'C\",\"E!FG@H\",\"I$JKL&amp;M\")\n&gt; substr(x,2,2) &lt;- \":\"\n&gt; x\n[1] \"A:B'C\"   \"E:FG@H\"  \"I:JKL&amp;M\"\n&gt; str_sub(x,-2,-2) &lt;- \":\"\n&gt; x\n[1] \"A:B:C\"   \"E:FG:C\"  \"I:JKL:C\"\n</code></pre>\n"},{"tags":["r","vectorization","cumsum"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13201206,"title":"Vectorizing a function: cumsum with a decay parameter","body":"<p>I've written a variation of the <code>cumsum</code> function, where I multiply the previous sum by a decay factor before adding the current value:</p>\n\n<pre><code>decay &lt;- function(x, decay=0.5){\n  for (i in 2:length(x)){\n    x[i] &lt;- x[i] + decay*x[(i-1)]\n  }\n  return(x)\n}\n</code></pre>\n\n<p>Here's a demo, using a binary variable to make the effect clear:</p>\n\n<pre><code>set.seed(42)\nEvents &lt;- sample(0:1, 50, replace=TRUE, prob=c(.7, .3))\nplot(decay(Events), type='l')\npoints(Events)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/U1eQP.png\" alt=\"Rplot\"></p>\n\n<p>Compiling this function speeds it up a lot:</p>\n\n<pre><code>#Benchmark\nlibrary(compiler)\nlibrary(rbenchmark)\ncumsum_decayCOMP &lt;- cmpfun(cumsum_decay)\nEvents &lt;- sample(0:1, 10000, replace=TRUE, prob=c(.7, .3))\nbenchmark(replications=rep(100, 1),\n          cumsum_decay(Events),\n          cumsum_decayCOMP(Events),\n          columns=c('test', 'elapsed', 'replications', 'relative'))\n\n                      test elapsed replications relative\n1     cumsum_decay(Events)    3.28          100    6.979\n2 cumsum_decayCOMP(Events)    0.47          100    1.000\n</code></pre>\n\n<p>But I suspect vectorizing would improve it even more.  Any ideas?</p>\n"},{"tags":["r","list","subset"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":52,"score":1,"question_id":13201081,"title":"How to subset from a long list?","body":"<p>I have a list <code>x</code> with millions of entries in it. And I want to put all the entries with a length larger than one into a new list <code>z</code>. How can I do this efficiently in R?</p>\n\n<p>I tried this code, and R just keeps running for a long time.</p>\n\n<pre><code>z=NULL\nfor(i in 1:length(x)) {\n  if(length(x[[i]])!=1) z=list(z,x[[i]])\n}\n</code></pre>\n"},{"tags":["r","sweave"],"answer_count":1,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":332,"score":8,"question_id":8519128,"title":"Can Sweave produce many pdfs automatically?","body":"<p>I analyze measurements from many cities (hundreds), and need to create separate reports per city (in Adobe pdf-format).</p>\n\n<p>My process is like this:</p>\n\n<ol>\n<li>First RStudio to prepare the data to be shown, saved in X.Rda.</li>\n<li>In X.Rnw (RStudio) I read X.Rda, select one city, and produce the tables and plots.</li>\n<li>In RStudio I press \"Compile PDF\" and the city-report X.pdf is produced.</li>\n<li>I go to step 2, choose another city, and so on.</li>\n</ol>\n\n<p>This is very tedious, and looks perfect for a for-loop per city, but how can it be done?</p>\n\n<p>Thank you r-contributors!</p>\n\n<p>/Chris</p>\n"},{"tags":["python","r","install","rpy2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":13055340,"title":"Rpy2 Installation issue, windows 7","body":"<p>I am trying to find solution for my problem, so far not with success.</p>\n\n<p>I am trying to install latest Rpy2 version on my computer. I already have all required programs (R 2.15.1 and 2.7 Python) installed. I am installing Rpy2 (rpy2-2.3.0) trough cmd with command</p>\n\n<p><code>python setup.py build install</code></p>\n\n<p>I am getting this traceback:</p>\n\n<blockquote>\n  <p>Traceback (most recent call last):</p>\n  \n  <p>File \"setup.py\", line 441, in </p>\n  \n  <p>[os.path.join('doc', 'source', 'rpy2_logo.png')])],</p>\n  \n  <p>File \"c:\\Python27\\lib\\distutils\\core.py\", line 152, in setup</p>\n  \n  <p>dist.run_commands()</p>\n  \n  <p>File \"c:\\Python27\\lib\\distutils\\dist.py\", line 953, in run_commands</p>\n  \n  <p>self.run_command(cmd)</p>\n  \n  <p>File \"c:\\Python27\\lib\\distutils\\dist.py\", line 972, in run_command</p>\n  \n  <p>cmd_obj.>run()</p>\n  \n  <p>File \"c:\\Python27\\lib\\distutils\\command\\install.py\", line 563, in run</p>\n  \n  <p>self.run_command('build')</p>\n  \n  <p>File \"c:\\Python27\\lib\\distutils\\cmd.py\", line 326, in run_command</p>\n  \n  <p>self.distribution.run_command(command)</p>\n  \n  <p>File \"c:\\Python27\\lib\\distutils\\dist.py\", line 972, in run_command</p>\n  \n  <p>cmd_obj.run()</p>\n  \n  <p>File \"c:\\Python27\\lib\\distutils\\command\\build.py\", line 127, in run</p>\n  \n  <p>self.run_command(cmd_name)</p>\n  \n  <p>File \"c:\\Python27\\lib\\distutils\\cmd.py\", line 326, in run_command</p>\n  \n  <p>self.distribution.run_command(command)</p>\n  \n  <p>File \"c:\\Python27\\lib\\distutils\\dist.py\", line 971, in run_command</p>\n  \n  <p>cmd_obj.ensure_finalized()</p>\n  \n  <p>File \"c:\\Python27\\lib\\distutils\\cmd.py\", line 109, in ensure_finalized</p>\n  \n  <p>self.finalize_options()</p>\n  \n  <p>File \"setup.py\", line 152, in finalize_options</p>\n  \n  <p>config += get_rconfig(r_home, about)</p>\n  \n  <p>File \"setup.py\", line 312, in get_rconfig</p>\n  \n  <p>rc = RConfig.from_string(rconfig, allow_empty = allow_empty)</p>\n  \n  <p>File \"setup.py\", line 272, in from_string</p>\n  \n  <ul>\n  <li>'\\nin string\\n' + string)</li>\n  </ul>\n  \n  <p>ValueError: Invalid substring</p>\n  \n  <p>in string</p>\n</blockquote>\n\n<p>The same error I get when trying to install with </p>\n\n<p><code>easy_install rpy2</code></p>\n\n<p>UPDATE: now the same error shows on the other pc (64bit)</p>\n\n<p>Thanks for help! :D</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":74,"score":-5,"question_id":13199701,"title":"Reading column names in R","body":"<p>I have data which is 50000 x 22 matrix (50000 rows and 22 columns)..\nI am reading this in R using data table function, which is done properly\nbut I have a problem in reading column names.</p>\n\n<p>I used <code>colnames(data)</code> it is is following result</p>\n\n<pre><code>[1] \"V1\"  \"V2\"  \"V3\"  \"V4\"  \"V5\"  \"V6\"  \"V7\"  \"V8\"  \"V9\"  \"V10\" \"V11\" \"V12\"\n[13] \"V13\" \"V14\" \"V15\" \"V16\" \"V17\" \"V18\" \"V19\" \"V20\" \"V21\" \"V22\"\n</code></pre>\n\n<p>But I have different names for each column. I know it is simple, but I couldn't figure it out.</p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":76,"score":5,"question_id":13199221,"title":"speeding up running if.. else loop in R","body":"<p>Does anyone know how to speed up running the following command? I want to replace the numerical \"month\" values with a character string ... e.g. month 1 goes to \"Jul\".</p>\n\n<p>This command is really really slow as the dataframe I trying to implement it on is enormous!</p>\n\n<pre><code>for (i in 1:length(CO2$month)){\n    if(CO2$month[i]=='1') {CO2$months[i]&lt;-'Jul'} else\n    if(CO2$month[i]=='2') {CO2$months[i]&lt;-'Aug'} else\n    if(CO2$month[i]=='3') {CO2$months[i]&lt;-'Sept'} else\n    if(CO2$month[i]=='4') {CO2$months[i]&lt;-'Oct'} else\n    if(CO2$month[i]=='5') {CO2$months[i]&lt;-'Nov'} else\n    if(CO2$month[i]=='6') {CO2$months[i]&lt;-'Dec'} else\n    if(CO2$month[i]=='7') {CO2$months[i]&lt;-'Jan'} else\n    if(CO2$month[i]=='8') {CO2$months[i]&lt;-'Feb'} else\n    if(CO2$month[i]=='9') {CO2$months[i]&lt;-'Mar'} else\n    if(CO2$month[i]=='10') {CO2$months[i]&lt;-'Apr'} else\n    if(CO2$month[i]=='11') {CO2$months[i]&lt;-'May'} else\n    if(CO2$month[i]=='12') {CO2$months[i]&lt;-'Jun'}\n}\n</code></pre>\n"},{"tags":["r","shape","igraph","arrow"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13198486,"title":"R igraph package - changing arrow head shape","body":"<p>I am fairly new to this whole R coding malarky, but needed to take the plunge for my social network analysis and visualisation. However I encountered an issue with the igraph package that I am using in R. Although I am able to chnage the line width, type, vertex colour, shape etc etc I have been unable to change the arrow head shape. I spent a fair amount of time searching online, but to no avail. The only website I found that pertains directly to my situation is:</p>\n\n<p><a href=\"https://bugs.launchpad.net/igraph/+bug/1026648\" rel=\"nofollow\">https://bugs.launchpad.net/igraph/+bug/1026648</a></p>\n\n<p>Therefore I was wondering if anyone here would know how to go about doing this?</p>\n"},{"tags":["r","csv","zoo"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13197484,"title":"How to drop decimal precision when writing a zoo object to csv file with R?","body":"<p>When writing out a zoo object to a CSV file using write.zoo(), I would actually like to drop decimal precision from the default of 14 to just 3. However, even with setting scipen &amp; digits in options(), I have not been able to drop the precision in output.</p>\n\n<p>Here is a sample code to illustrate the issue.</p>\n\n<pre><code>blah &lt;- zoo(cbind(c(1.590833333333335, NA), c(NA, 21.590833333333337)))\nindex(blah) &lt;- c(\"Dec 1985\", \"Dec 1986\")\ncolnames(blah) &lt;- c(\"FooHeader\", \"BarHeader\")\noptions(scipen = 3, digits = 3)\nwrite.zoo(blah, file = \"blah.csv\", sep = \",\")\n</code></pre>\n\n<p>If I open the <code>blah.csv</code> file, I see</p>\n\n<pre><code>\"Index\",\"FooHeader\",\"BarHeader\"\n\"Dec 1985\",1.59083333333334,NA\n\"Dec 1986\",NA,21.5908333333333\n</code></pre>\n\n<p>But what I would really want to see is</p>\n\n<pre><code>\"Index\",\"FooHeader\",\"BarHeader\"\n\"Dec 1985\",1.591,NA\n\"Dec 1986\",NA,21.591\n</code></pre>\n\n<p>How do I go about making this happen? Thanks a bunch in advance!</p>\n\n<p>Note: I am aware that by dropping the precision, if I read the data into the R again, I would still lose the precision. That's fine. I can live with that.</p>\n"},{"tags":["r","operator-overloading"],"answer_count":0,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":76,"score":5,"question_id":13195165,"title":"R unary operator overload: risks?","body":"<p>In my continuing quest to avoid using parentheses for some simple commands, I wrote up the following operator to create a new graphics window.  My question is: am I at risk of \"breaking\" anything in R, other than the obvious inability to execute the \"not\" function on my variable \"newdev\"?</p>\n\n<pre><code># function to overload \"!\" for one purpose only\n#this is adapted  from the sos package code for \"???\", credited to Duncan Murdoch.\n# Example of how to create a specialized unary  operator that doesn't require\n# parentheses for its argument.  So far as I can tell,  \n#the only way to do this is to overload an existing function or\n# operator which doesn't require parentheses.  \"?\" and \"!\" meet this requirement.\n`!` &lt;- function (e1, e2)  { \ncall &lt;- match.call()\n#  match.call breaks out each callable function in argument list (which was \"??foo\" for the sos package \"???\",\n #  which allows topicExpr1 to become  a list variable w/ callable function \"!\"  (or \"?\" in sos) \noriginal &lt;- function() { \n    call[[1]]&lt;-quote(base::`!`)\n    return(eval(call, parent.frame(2)))\n}\n\n   # this does preclude my ever having an actual\n   # variable called \"newdev\" (or at least trying to create the actual NOT of it) \nif(call[[2]] =='newdev') {\n    windows(4.5,4.5,restoreConsole=T)\n}else{\n    return(original())  # do what \"!\" is supposed to do \n}\n}\n</code></pre>\n"},{"tags":["r","regression","poisson"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13190232,"title":"Fitting a Poisson distribution with weighted observations in R","body":"<p>I am wanting to fit a Poisson distribution but I am wanting to weight some of the values as more important. Is there a way to do this in R with fitdistr() or some equivalent function? Here is what I have at the moment:</p>\n\n<pre><code>randoms &lt;- rpois(15,10)\nweighting &lt;- seq(1, 100, by=1)\nfit &lt;- fitdistr(randoms, \"poisson\")\n</code></pre>\n\n<p>I would like to use the 'weighting' data as a way to emphasize the observation at the end of the data set</p>\n"},{"tags":["r","data.table"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13196296,"title":"Why is length of a group variable always 1 in data.table grouping?","body":"<p>I know this can be achieve with other packages, but I'm trying to do it in data.table (as it seems to be the fastest for grouping).</p>\n\n<pre><code>library(data.table)\ndt = data.table(a=c(1,2,2,3))\ndt[,length(a),by=a]\n</code></pre>\n\n<p>results in</p>\n\n<pre><code>   a V1\n1: 1  1\n2: 2  1\n3: 3  1\n</code></pre>\n\n<p>whereas</p>\n\n<pre><code>df = data.frame(a=c(1,2,2,3))\nddply(df,.(a),summarise,V1=length(a))\n</code></pre>\n\n<p>produces</p>\n\n<pre><code>  a V1\n1 1  1\n2 2  2\n3 3  1\n</code></pre>\n\n<p>which is a more sensible results. Just wondering why data.table is not giving the same results, and how this can be achieved.</p>\n\n<p>thanks</p>\n"},{"tags":["r","memory-management"],"answer_count":0,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":111,"score":6,"question_id":13195733,"title":"How can I remove invisible objects form an R workspace that are not removed by garbage collection?","body":"<p>I am using the blackboost function from the mboost package to estimate a model on a approx. 500mb dataset on a Windows 7 64bit, 8gb RAM machine. During the execution R uses up to virtually all available memory. After the calculation is done, over 4.5gb keeps allocated to R even after calling the garbage collection with gc() or saving and reloading the workspace to a new R session. Using .ls.objects (<a href=\"http://stackoverflow.com/questions/1358003/tricks-to-manage-the-available-memory-in-an-r-session\">1358003</a>) I found that the size of all visible objects is about 550mb.</p>\n\n<p>The output of gc() tells me that the bulk of data is in vector cells, although I'm not sure what that means:</p>\n\n<pre><code>            used   (Mb) gc trigger   (Mb)  max used   (Mb)\nNcells   2856967  152.6    4418719  236.0   3933533  210.1\nVcells 526859527 4019.7  610311178 4656.4 558577920 4261.7\n</code></pre>\n\n<p>This is what I'm doing:</p>\n\n<pre><code>&gt; memory.size()\n[1] 1443.99\n&gt; model &lt;- blackboost(formula, data = mydata[mydata$var == 1,c(dv,ivs)],tree_control=ctree_control(maxdepth = 4))\n</code></pre>\n\n<p>...a bunch of packages are loaded...</p>\n\n<pre><code>&gt; memory.size()\n[1] 4431.85\n&gt; print(object.size(model),units=\"Mb\")\n25.7 Mb\n&gt; memory.profile()\n     NULL      symbol    pairlist     closure environment     promise    language \n        1       15895      826659       20395        4234       13694      248423 \n  special     builtin        char     logical     integer      double     complex \n      174        1572     1197774       34286       84631       42071          28 \ncharacter         ...         any        list  expression    bytecode externalptr \n   228592           1           0       79877           1       51276        2182 \n  weakref         raw          S4 \n      413         417        4385 \n</code></pre>\n\n<p>mydata[mydata$var == 1,c(dv,ivs)] has 139593 rows and 75 columns with mostly factor variables, and some logical or numerical variables. formula is a formula object of the type: \"dv ~ var2 + var3 + .... + var73\". dv is a variable name string and ivs is a string vector with all independent variables var2 ... var74.</p>\n\n<p>Why is so much memory being allocated to R? How can I make R free up the extra memory? Any thoughts appreciated!</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":60,"score":6,"question_id":13196883,"title":"parallel coord plot ggplot2 deprecated?","body":"<p>When i try to make a parallel coordinate in ggplot2, i get the message that it is deprecated:</p>\n\n<pre><code>require(ggplot2)\nggpcp(mtcars) + geom_line()\n</code></pre>\n\n<p>Warning message:\n'ggpcp' is deprecated.\nSee help(\"Deprecated\")</p>\n\n<p>however, the ggplot documentation did not say anything about this: <a href=\"http://docs.ggplot2.org/current/ggpcp.html\">http://docs.ggplot2.org/current/ggpcp.html</a>. </p>\n\n<p>is there a new pcp function somewhere?</p>\n"},{"tags":["r","function","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":40,"score":4,"question_id":13174998,"title":"Draw a function in ggplot2 with more than x as parameter","body":"<p>I would like to draw a power-law function which depends on three parameters: <code>x</code>, <code>a</code>, and <code>gamma</code>. The function looks like this:</p>\n\n<pre><code>powerlaw &lt;- function(x, a, gamma){\n   a*(x**(-gamma))\n}\n</code></pre>\n\n<p>Now I want to plot this but I cannot figure out how to specifiy <code>a</code> and <code>gamma</code> while telling R to use the chosen range for <code>x</code>. I tried this:</p>\n\n<pre><code>require(ggplot2)\nqplot(c(1,10), stat=\"function\", fun=powerlaw(x, a=1, gamma=1), geom=\"line\")\n</code></pre>\n\n<p>but it says</p>\n\n<pre><code>Error in (x^(-gamma)): x is missing  \n</code></pre>\n\n<p>Of course, the following code works by fixing <code>a</code> and <code>gamma</code>:</p>\n\n<pre><code>powerlaw1 &lt;- function(x){\n   1*(x**(-1))\n}\nqplot(c(1,10), stat=\"function\", fun=powerlaw1, geom=\"line\")\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["data","r"],"answer_count":2,"favorite_count":6,"up_vote_count":12,"down_vote_count":0,"view_count":8143,"score":12,"question_id":2613420,"title":"Handling missing/incomplete data in R--is there function to mask but not remove NAs?","body":"<p>As you would expect from a DSL aimed at data analysis, R handles missing/incomplete data very well, for instance:</p>\n\n<p>Many R functions have an 'na.rm' flag that you can set to 'T' to remove the NAs:</p>\n\n<pre><code>mean( c(5,6,12,87,9,NA,43,67), na.rm=T)\n</code></pre>\n\n<p>But if you want to deal with NAs <em>before</em> the function call, you need to do something like this:</p>\n\n<p>to remove each 'NA' from a vector:</p>\n\n<pre><code>vx = vx[!is.na(a)]\n</code></pre>\n\n<p>to remove each 'NA' from a vector and replace it w/ a '0':</p>\n\n<pre><code>ifelse(is.na(vx), 0, vx)\n</code></pre>\n\n<p>to remove entire each row that contains 'NA' from a data frame:</p>\n\n<pre><code>dfx = dfx[complete.cases(dfx),]\n</code></pre>\n\n<p>All of these functions permanently <em>remove</em> 'NA' or rows with an 'NA' in them.</p>\n\n<p>Sometimes this isn't quite what you want though--making an 'NA'-excised copy of the data frame might be necessary for the next step in the workflow but in subsequent steps you often want those rows back (e.g., to calculate a column-wise statistic for a column that has missing rows caused by a prior call to 'complete cases' yet that column has no 'NA' values in it).</p>\n\n<p>to be as clear as possible about what i'm looking for: python/numpy has a class, 'masked array', with a 'mask' method, which lets you <strong>conceal</strong>--but not remove--NAs during a function call. Is there an analogous function in R?</p>\n"},{"tags":["r","higher-order-functions"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":13190844,"title":"Reduce with less than symbol","body":"<p>I never think to use <code>Reduce</code> but I have a problem I thought it would be good for.  I want to make sure the size of each iterative element of a vector is equal to or larger than the previous element.  I can do this with <code>sapply</code> but my attempt with <code>Reduce</code> fails.  How can I use this with <code>Reduce</code>?</p>\n\n<pre><code>#This works\ny &lt;- c(1,2,3,2,4,4)\nsapply(seq_along(y)[-length(y)], function(i) y[i] &lt;= y[i+1])\n\n#attempts\nReduce('&lt;', c(1,2,3,2,4,4)), accumulate = TRUE)\nReduce('&lt;', c(1,2,3,2,4,4)))\n</code></pre>\n"},{"tags":["r","date","time","business","holidays"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13184404,"title":"R timeDate convert weekend/holiday to Bizday","body":"<p>I would like to convert a column of dates into a column of business days.  To do so, I would like to successively add one day to any non business date until it becomes a business day.  Here is my best attempt.  Any suggestions are greatly appreciated.</p>\n\n<pre><code>library('timeDate')\n\n#make a data frame with dates\ndats &lt;- data.frame(OBS=c(rep('ALPHA',5), rep('BETA',5)),\n  DATE=c('2011-01-01','2011-01-02','2011-01-03','2011-01-04','2011-01-05',\n         '2011-01-06','2011-01-07','2011-01-08','2011-01-09','2011-01-10'))\n\n#convert date to timeDate format\ndats[['DATE']] &lt;- timeDate(dats[['DATE']])\n\n#look at the data\nprint(dats)\n\n#attempt to make all dates business days\nbizdays &lt;- isBizday(dats[['DATE']], holidays=holidayNYSE(2011), wday=1:5)\ndats[['DATE']][bizdays] &lt;- dats[['DATE']] + 1\n\n#ideally I want to do this\nwhile(!isBizday(dats[['DATE']], holidays=holidayNYSE(2011), wday=1:5)) {\n  dats[['DATE']] + 1\n}\n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":70,"score":3,"question_id":13192984,"title":"Displaying a greater than or equal sign","body":"<p>I have a plot which is generated thus:</p>\n\n<pre><code>ggplot(dt.2, aes(x=AgeGroup, y=Prevalence)) + \n    geom_errorbar(aes(ymin=lower, ymax=upper), colour=\"black\", width=.2) +\n    geom_point(size=2, colour=\"Red\")\n</code></pre>\n\n<p>I control the x axis labels like this:</p>\n\n<pre><code>scale_x_discrete(labels=c(\"0-29\",\"30-49\",\"50-64\",\"65-79\",\"&gt;80\",\"All\")) +\n</code></pre>\n\n<p>This works but I need to change the \">80\" label to \"≥80\".</p>\n\n<p>However \"≥80\" is displayed as \"=80\". </p>\n\n<p>How can I display the greater than or equal sign ?</p>\n"},{"tags":["r","transformation","sapply"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13195898,"title":"simple z-tranformation over all columns","body":"<p>i just wrote a very basic function for the z tranformation in a Matrix over all columns. It looks like this:</p>\n\n<p><code>sapply(MyObject, function(x){(x-mean(x))/sd(x)})</code></p>\n\n<p>I randomly checked my function for some cells within the Matrix and it seems to work fine. Still I wanted to check with you if the function is okay, because i'm very new to R and I could not find any good examples on the internet.\nSo could any one give his opinion?\nThx.</p>\n"},{"tags":["r","data","file-conversion"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13189467,"title":"How to convert .Rdata format into text file format","body":"<p>I am a novice in R and I am trying to convert .Rdata format file into  comman delimited text file format.Can someone help me out regarding this? Thank you.</p>\n"},{"tags":["r","styles","plot","legend"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":13192535,"title":"Automatically generate legend for graphs in r?","body":"<p>Is it somehow possible, to automatically generate a legend in R? One thing that really annoys me, is redundant information, that I have to enter to show the legend (for example the line colour,...)</p>\n\n<pre><code>plot(\n  c(1:5), c(.7, 2.2, 3.1, 3.9, 5.2),\n  col=1,\n  pch=3,\n  type=\"b\"\n)\n\nlines(\n  c(1:5), c(1:5),\n  col=2,\n  pch=6,\n  type=\"o\"\n)\n\nlegend(\n  \"topleft\",\n  legend=c(\"data\", \"expactation\"),\n  col=c(1, 2),\n  pch=c(3, 6),\n  lty=c(2 ,1)\n)\n</code></pre>\n\n<p>I already gave information about the line colour,... in the commands <code>plot</code> and <code>lines</code>. It would be nice, if I do not have to add this information again in legend.</p>\n\n<p>Is it for example possible to store the \"lines\"-Object and \"plot\"-object in a variable and only pass these objects to legend (where legend finds the required information)?</p>\n\n<pre><code>p = plot(...)\nl = lines (...)\nlegend(\"topleft\", p, l)\n</code></pre>\n"},{"tags":["r","data.frame","aggregate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13194263,"title":"Long Format Function","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8225621/faster-way-to-create-variable-that-aggregates-a-column-by-id\">faster way to create variable that aggregates a column by id</a>  </p>\n</blockquote>\n\n\n\n<p>I am having trouble with a project. I created a dataframe (called dat) in long format (i copied the first 3 rows below) and I want to calculate for example the mean of the Pretax Income of all Banks in the United States for the years 2000 to 2011. How would I do that? I have hardly any experience in R. I am sorry if the answer is too obvious, but I couldn't find anything and i  already spent a lot of time on the project. Thank you in advance! </p>\n\n<pre><code>KeyItem     Bank    Country Year    Value  \n1   Pretax Income   WELLS_FARGO_&amp;_COMPANY   UNITED STATES   2011    2.365600e+10                            \n2   Total Assets    WELLS_FARGO_&amp;_COMPANY   UNITED STATES   2011    1.313867e+12                            \n3   Total Liabilities   WELLS_FARGO_&amp;_COMPANY   UNITED STATES 2011  1.172180e+12                            \n</code></pre>\n"},{"tags":["r","input"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13194558,"title":"Vector read from text file different from same vector generated in console","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/9508518/why-are-these-numbers-not-equal\">Why are these numbers not equal?</a>  </p>\n</blockquote>\n\n\n\n<p>I've come across a very bizarre situation. If I store a vector (sequence) in a text file with the following code:</p>\n\n<pre><code>fileConn&lt;-file('test.txt')\nsink(fileConn,append=T,split=T)\ncat('sequence','\\n')\ncat(as.character(unlist(seq(0,1,0.1))),'\\n')\nsink()\nclose(fileConn)\n</code></pre>\n\n<p>And then load it again:</p>\n\n<pre><code>test=readLines('test.txt')\n</code></pre>\n\n<p>I then try and extract the same vector I've stored in the text file and compare to the original sequence using 2 \"different\" approaches:</p>\n\n<pre><code>sequence1=laply(strsplit(test[2],\" \")[[1]],as.numeric)\nsequence2=as.numeric(strsplit(test[2],\" \")[[1]])\n</code></pre>\n\n<p>What's bizarre is that even though they look and (apparently) are the same type of vectors, R seems to think they're not!!!</p>\n\n<pre><code>cbind(seq(0,1,0.1),sequence1,sequence2)\n\n          sequence1 sequence2\n [1,] 0.0       0.0       0.0\n [2,] 0.1       0.1       0.1\n [3,] 0.2       0.2       0.2\n [4,] 0.3       0.3       0.3\n [5,] 0.4       0.4       0.4\n [6,] 0.5       0.5       0.5\n [7,] 0.6       0.6       0.6\n [8,] 0.7       0.7       0.7\n [9,] 0.8       0.8       0.8\n[10,] 0.9       0.9       0.9\n[11,] 1.0       1.0       1.0\n\napply(cbind(seq(0,1,0.1),sequence1,sequence2),2,class)\n          sequence1 sequence2 \n\"numeric\" \"numeric\" \"numeric\"\n\n\n\napply(cbind(seq(0,1,0.1),sequence1,sequence2),2,nchar)\n        sequence1 sequence2\n [1,] 1         1         1\n [2,] 3         3         3\n [3,] 3         3         3\n [4,] 3         3         3\n [5,] 3         3         3\n [6,] 3         3         3\n [7,] 3         3         3\n [8,] 3         3         3\n [9,] 3         3         3\n[10,] 3         3         3\n[11,] 1         1         1\n\nsequence1==seq(0,1,0.1)\n [1]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE\n\nsequence2==seq(0,1,0.1)\n [1]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE\n</code></pre>\n\n<p>Does anybody have any clue why this happens and how I can prevent it from happening?\nThanks very much!</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":12942254,"title":"optimization in R across multiple 'areas'","body":"<p>I am building a bioeconomic model of a fishery with multiple areas and fleets. \nI need to add a cost function to the objective function.\nThe cost function derivative is: </p>\n\n<pre><code>dvcost&lt;-(maxeff/(maxeff-(total f))*k*(f/total f)-ln(1-((total f)/maxeff))*k*maxeff/(total f)*(1-(f/total f))\n</code></pre>\n\n<p>where: for each fleet, f is effort in a specific area where the objective function is being minimized, total f is the sum of effort across areas for a particular fleet. k and maxeff are parameters.</p>\n\n<p>My question is: how do I apply this cost function to my problem? I already have total f (which is 'f' in the code), but I need to find the f for the area that the objective function is working over.</p>\n\n<p>Any suggestions are much appreciated. Thanks!</p>\n\n<p>The full code is below:\n<strong><em>CODE</em></strong></p>\n\n<pre><code>nfleets&lt;-2\nnareas&lt;-2\nM&lt;-1\nM&lt;-array(M,dim=c(nfleets,nareas))\nN&lt;-1000\ncost&lt;-c(30,30)\ncost&lt;-array(cost,dim=c(nfleets,nareas))\nPrice&lt;-2\nPrice&lt;-array(Price,dim=c(nfleets,nareas))\nq&lt;-array(0.1,dim=c(nfleets,nareas))\nf&lt;-1\nf&lt;-array(f,dim=c(nfleets,nareas))\ninit.eff&lt;-array(3,dim=c(nfleets,nareas))\nOF&lt;-array(c(q*f), dim=c(nfleets, nareas))\n\nCatch&lt;-array(0,dim=c(nfleets, nareas))\n\nobj&lt;-function(f){\n    f &lt;- array(f, dim=c(nfleets, nareas)) \n    F &lt;- q*f\n    Z &lt;- M+sum(F)\n    S &lt;- exp(-Z)\n    Catch&lt;- N*F/Z*(1-S)\n    Tot.Catch &lt;- sum(Catch)\n    NR&lt;-array(0,dim=c(nfleets,nareas))\n    NR&lt;-Price*Catch - f*cost\n    d.NR&lt;-array(0,dim=c(nfleets,nareas))\n    f &lt;- apply(f, 1, sum)\n    d.NR&lt;- N*q/Z*(1-S-F/Z+F/Z*S+F*S)*Price - cost\n    return(sum(d.NR*d.NR))\n}\nzero.bnd &lt;-  rep.int(0, length(f))\nopt.eff  &lt;- optim( init.eff, obj, method=\"Nelder-Mead\" )  \n</code></pre>\n"},{"tags":["r","data.table"],"answer_count":6,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":357,"score":4,"question_id":8225621,"title":"faster way to create variable that aggregates a column by id","body":"<p>Is there a faster way to do this? I guess this is unnecessary slow and that a task like this can be accomplished with base functions.</p>\n\n<pre><code>df &lt;- ddply(df, \"id\", function(x) cbind(x, perc.total = sum(x$cand.perc)))\n</code></pre>\n\n<p>I'm quite new to R. I have looked at <code>by()</code>, <code>aggregate()</code> and <code>tapply()</code>, but didn't get them to work at all or in the way I wanted. Rather than returning a shorter vector, I want to attach the sum to the original dataframe. What is the best way to do this?</p>\n\n<p>Edit: Here is a speed comparison of the answers applied to my data. </p>\n\n<pre><code>&gt; # My original solution\n&gt; system.time( ddply(df, \"id\", function(x) cbind(x, perc.total = sum(x$cand.perc))) )\n   user  system elapsed \n 14.405   0.000  14.479 \n\n&gt; # Paul Hiemstra\n&gt; system.time( ddply(df, \"id\", transform, perc.total = sum(cand.perc)) )\n   user  system elapsed \n 15.973   0.000  15.992 \n\n&gt; # Richie Cotton\n&gt; system.time( with(df, tapply(df$cand.perc, df$id, sum))[df$id] )\n   user  system elapsed \n  0.048   0.000   0.048 \n\n&gt; # John\n&gt; system.time( with(df, ave(cand.perc, id, FUN = sum)) )\n       user  system elapsed \n      0.032   0.000   0.030 \n\n&gt; # Christoph_J\n&gt; system.time( df[ , list(perc.total = sum(cand.perc)), by=\"id\"][df])\n   user  system elapsed \n  0.028   0.000   0.028 \n</code></pre>\n"},{"tags":["java","r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13193747,"title":"R passing list as argument to java","body":"<p>How can I pass a list to java from R\nMy java function is </p>\n\n<pre><code>public String[][] test(String x,List&lt;String&gt; Y){}\n</code></pre>\n\n<p>IN R I tried </p>\n\n<pre><code>getFiledFromID&lt;-function(keyword,sources)\n{\n obj=.jnew(\"com/algoTree/ClientElasticSearch/ElasticSearchLoader\")\n b &lt;- .jnew( \"java/lang/String\", field )    \n n&lt;-.jnew(list( sources))\n result=.jcall(obj,\"Ljava/lang/String;\",\"test\",b,n)\n result\n}\ntemp=c(\"bloomberg\",\"reuters\")\ngetFiledFromID(\"opening\",temp)\n</code></pre>\n\n<p>But it gives ERROR Error in .jnew(list(sources)) : java.lang.ClassNotFoundException</p>\n\n<p>Any one please help</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":11498371,"title":"Get value from mpfr generated list","body":"<p>Considering the following vector :</p>\n\n<pre><code>&gt; v1\n[1] 0.000000e+00 0.000000e+00 1.110223e-16 4.440892e-15 3.266195e-08 2.531242e-07   \n1.041204e-05 1.172329e-05 1.672447e-05 1.803203e-05\n</code></pre>\n\n<p>I have applied mpfr from function (from the Rmpfr package)to v1 :</p>\n\n<pre><code>&gt; v2&lt;-sapply(v1,function(x){mpfr(x,5)})\n</code></pre>\n\n<p>v2 is apparently a list, but I cannot get the actual value. I have tried using unlist, v2[[]], converting to character v2[[]] or vector..</p>\n\n<pre><code>&gt; v2\n\n[[1]]\n'mpfr1' 0\n\n[[2]]\n'mpfr1' 0\n\n[[3]]\n 'mpfr1' 1.11e-16\n</code></pre>\n"},{"tags":["r","data.frame"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13192030,"title":"What is a faster way to manipulate one column in a data.frame row by row?","body":"<p>I have a data frame with numeric latitude and longitude values. The data.frame has 14K rows and 40 columns.</p>\n\n<p>I'd like to add a category column called \"hemisphere\" to the data frame in order to easily distinguish between northern (latitude > 0) and southern locations (latitude &lt; 0). This is what I do:</p>\n\n<pre><code>for (r in 1:nrow(myDataFrame)) {\n  if (myDataFrame[r, \"latitude\"] &gt; 0) {\n    myDataFrame[r, \"hemisphere\"] &lt;- \"North\"\n  } else {\n    myDataFrame[r, \"hemisphere\"] &lt;- \"South\"\n  }\n}\n</code></pre>\n\n<p>Running this code block takes about a minute, maybe two, on my MacBook Pro - much longer than I'd expect. It seems as if something makes it very inefficient and there should be a better way. Any hints?</p>\n"},{"tags":["r","list","matrix","relationship"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13190627,"title":"How to use matrix to show relationship in R?","body":"<p>I have a list x here:\n<img src=\"http://i.stack.imgur.com/gPASr.png\" alt=\"enter image description here\"></p>\n\n<p>I want to show the relationship between the elements like this:\n<img src=\"http://i.stack.imgur.com/zsrAt.png\" alt=\"enter image description here\"></p>\n\n<p>Can anyone tell me how to do this in R?\nThank you very much!</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13193051,"title":"Control 'base' point size in ggplot aes(size)","body":"<p>I am looking for a way to increase or decrease the all the points in the graph below with a factor. I can control the within the aes. And I can control the size outside aes. But I can't figure out how to combine both.    </p>\n\n<pre><code>df &lt;- data.frame(val1 = rnorm(10, 5), val2 = rnorm(10, 5), size = rnorm(10, 5))\nggplot(df) + geom_point(aes(val1, val2, size = size))\n</code></pre>\n\n<p>Thanks in advance for your time.</p>\n"},{"tags":["r","function","parameters","default-value"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13193060,"title":"Changing default-values for parameters in R-function?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/9073912/setting-function-defaults-r-on-a-project-specific-basis\">Setting Function Defaults R on a Project Specific Basis</a>  </p>\n</blockquote>\n\n\n\n<p>The default-value for the parameter <code>sep</code> in the R-function <code>paste()</code> is <code>sep=\" \"</code>. I prefer having <code>sep=\"\"</code>, so I'm changing it everytime I use paste. Is it also possible to change the default-value at the beginning of my R-script, and always have <code>sep=\"\"</code> without the need to change it manually?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13190952,"title":"How to find compiled function source code in R package?","body":"<p>For example, I am looking into a <code>R</code> function <code>PTdensity.R</code> source code in a package called <code>DPpackage</code>, where I found the author called a <code>fortran</code> function <code>ptdensityu</code> : </p>\n\n<pre><code> foo &lt;- .Fortran(\"ptdensityu\", ...\n</code></pre>\n\n<p>The thing is how to find source code for <code>ptdensityu</code> subroutine. It may contains in a certain fortran file in <code>/src/</code> directory, but how do I know which file is it. (Actually I found it by manually check each file under <code>/src/</code> and found it is in the <code>/src/PTudensity.f</code>.)</p>\n\n<p>Quick link for the package : <a href=\"http://cran.r-project.org/web/packages/DPpackage/index.html\" rel=\"nofollow\">link</a> </p>\n\n<p>PS: I used to use this <a href=\"http://rgm2.lab.nig.ac.jp:8080/source/search?q=loglik_unippt&amp;project=R&amp;defs=&amp;refs=&amp;path=&amp;hist=\" rel=\"nofollow\">link</a> to search source code, but somehow it does not work any more.</p>\n"},{"tags":["r","rstudio"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":49,"score":-1,"question_id":13191848,"title":"Reset working dir to default","body":"<p>I'm working with RStudio on Windows where I can set a default working dir in the options menu. Is there a way to read out this path in a script or simply reset the wd to the default path after changing, something like <code>setwd(default.dir)</code>?</p>\n"},{"tags":["r","rstudio"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13175556,"title":"par(mfcol=c(2,1)) and blank second row","body":"<p>I am wondering why the following bit of code doesn't produce the two plots one below the other.</p>\n\n<pre><code>data(mtcars)\nlibrary(randomForest)\n\nmtcars.rf &lt;- randomForest(mpg ~ ., data=mtcars, ntree=1000, keep.forest=FALSE,\n                          importance=TRUE)\npng(\"rf1.png\", width=6, height=6, units=\"in\", res=100)\npar(mfcol=c(2,1))\nvarImpPlot(mtcars.rf)\nplot(mtcars.rf, log=\"y\")\ndev.off()\n</code></pre>\n\n<p>This just produces</p>\n\n<p><img src=\"http://i.stack.imgur.com/LyHts.png\" alt=\"enter image description here\"> </p>\n\n<p>with a blank second row. </p>\n"},{"tags":["r","statistics","gis","regression"],"answer_count":4,"favorite_count":8,"up_vote_count":15,"down_vote_count":0,"view_count":35532,"score":15,"question_id":2870631,"title":"What is the difference between Multiple R-squared and Adjusted R-squared in a single-variate least squares regression?","body":"<p>Could someone explain to the statistically naive what the difference between <code>Multiple R-squared</code> and <code>Adjusted R-squared</code> is?  I am doing a single-variate regression analysis as follows:</p>\n\n<pre><code> v.lm &lt;- lm(epm ~ n_days, data=v)\n print(summary(v.lm))\n</code></pre>\n\n<p>Results:</p>\n\n<pre><code>Call:\nlm(formula = epm ~ n_days, data = v)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-693.59 -325.79   53.34  302.46  964.95 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  2550.39      92.15  27.677   &lt;2e-16 ***\nn_days        -13.12       5.39  -2.433   0.0216 *  \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 \n\nResidual standard error: 410.1 on 28 degrees of freedom\nMultiple R-squared: 0.1746,     Adjusted R-squared: 0.1451 \nF-statistic: 5.921 on 1 and 28 DF,  p-value: 0.0216 \n</code></pre>\n"},{"tags":["r","order","match"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13189956,"title":"R match changes order","body":"<p>I have a vector (A, say column names of A bigger matrix) and a matrix(B). </p>\n\n<p>A = q,w,e,r,t</p>\n\n<p>B = </p>\n\n<pre><code>q 1 \ny 2\nw 3\ne 4\nu 5\nt 6\nr 7\n</code></pre>\n\n<p>I match A with B's first column</p>\n\n<p>matchAB = </p>\n\n<pre><code>      q 1\n      w 3\n      i 4\n      e 5 \n      t 6\n      r 7\n</code></pre>\n\n<p>I only need the second column. and use it with A. If you see the order is not the same. where a = q,w,e,r,t. matchAB, becomes, q,w,e,t,r. I don't want to do alphabetical sorting on A. I want matchAB to have the same order as A. \nAny help ?</p>\n\n<p>Thanks ! </p>\n\n<p>As asked by mnel:</p>\n\n<blockquote>\n  <p>dput(a)</p>\n</blockquote>\n\n<pre><code>a =c(\"q\", \"w\", \"e\", \"r\", \"t\")\n</code></pre>\n\n<blockquote>\n  <p>dput(b)</p>\n</blockquote>\n\n<pre><code>b &lt;- structure(c(\"q\", \"1\", \"y\", \"2\", \"w\", \"3\", \"i\", \"4\", \"e\", \"5\",\n    \"t\", \"6\", \"r\", \"7\"), .Dim = c(2L, 7L), .Dimnames = list(c(\"bi\",\"bb\"), NULL))\n\n\nind=which(match(b[1,],a) != 0)\n\n&gt; b[,ind]=\n\n[,1] [,2] [,3] [,4] [,5]\n\nbi \"q\"  \"w\"  \"e\"  \"t\"  \"r\"\n\nbb \"1\"  \"3\"  \"5\"  \"6\"  \"7\"\n</code></pre>\n\n<p>So, the output that I want is, </p>\n\n<pre><code>b[,ind]=\n\n[,1] [,2] [,3] [,4] [,5]\n\nbi \"q\"  \"w\"  \"e\"  \"r\"  \"t\"\n\nbb \"1\"  \"3\"  \"5\"  \"7\"  \"6\"\n</code></pre>\n"},{"tags":["r","treemap","portfolio"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13190740,"title":"treemaps in R: alternatives to the portfolio package?","body":"<p>I would like to generate treemaps in R. Right now I am using the portfolio package, but the problem with this package is that there is not enough ways to control the output: text attributes like font, font size, color can not be controlled, borders between map squares with same color are not distinguishable, there is no control over the color gradient legend etc.</p>\n\n<p>I am looking for a treemap library which allows for a more fine-grained control over the resulting appearance than the portfolio package.</p>\n\n<p>Which alternatives are there to the portfolio package for making treemaps in R?</p>\n"},{"tags":["r","glm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13188768,"title":"Switch to other function when an error occurs and program breaks in R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2622777/exception-handling-in-r\">Exception handling in R</a>  </p>\n</blockquote>\n\n\n\n<p>I use <code>glm.nb</code> function to fit an NB model, but sometimes the program gives an error:</p>\n\n<p><code>Error in while ((it &lt;- it + 1) &lt; limit &amp;&amp; abs(del) &gt; eps) { : \n  missing value where TRUE/FALSE needed</code></p>\n\n<p>The whole program then breaks down. Now I write another function that can address such convergence issue (it's due to extremely large likelihood value; see <a href=\"http://stackoverflow.com/questions/11749977/why-does-glm-nb-throw-a-missing-value-error-only-on-very-specific-inputs\">this post</a>).</p>\n\n<p>My question is: how can I tell R to switch to my own function when the <code>glm.nb</code> function breaks down? </p>\n\n<p>I was told to look for the error message in the source code of <code>glm.nb</code> and then modify that part. However, I didn't find such codes explicitly, and wonder if there is an easier way in R to jump out of a breaking-down function and switching to another function by some <code>if-else</code> statements? </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":30,"score":-2,"question_id":13189392,"title":"How to combine elements in a three dimensional prop.table()?","body":"<pre><code>x10 &lt;structure(c(0L, 0L, 0L, 0L, 1L, 1L, 1L, 5L, 8L, 9L, 31L, 1L, \n0L, 0L, 0L, 1L, 0L, 1L, 2L, 7L, 2L, 10L, 0L, 2L, 0L, 2L, 2L, \n5L, 2L, 4L, 6L, 8L, 4L, 1L, 1L, 3L, 2L, 2L, 6L, 1L, 12L, 18L, \n7L, 29L, 8L, 4L, 6L, 8L, 6L, 19L, 3L, 9L, 12L, 3L, 12L, 14L, \n1L, 2L, 1L, 3L, 1L, 0L, 4L, 6L, 3L, 11L, 0L, 0L, 0L, 1L, 3L, \n7L, 5L, 8L, 21L, 26L, 51L, 0L, 1L, 0L, 3L, 5L, 10L, 9L, 29L, \n55L, 60L, 125L, 3L, 0L, 1L, 1L, 3L, 10L, 1L, 6L, 18L, 17L, 13L, \n6L, 3L, 4L, 13L, 6L, 33L, 17L, 48L, 84L, 54L, 103L, 34L, 11L, \n20L, 27L, 26L, 50L, 29L, 30L, 54L, 28L, 34L, 31L, 5L, 7L, 3L, \n4L, 20L, 8L, 16L, 16L, 8L, 41L, 1L, 0L, 0L, 3L, 1L, 3L, 3L, 11L, \n19L, 16L, 56L, 0L, 0L, 0L, 0L, 3L, 11L, 3L, 18L, 25L, 21L, 62L, \n3L, 0L, 1L, 4L, 2L, 7L, 8L, 15L, 22L, 12L, 19L, 5L, 2L, 8L, 9L, \n9L, 42L, 18L, 51L, 70L, 45L, 103L, 29L, 15L, 23L, 34L, 25L, 57L, \n23L, 38L, 55L, 30L, 33L, 36L, 5L, 5L, 6L, 6L, 16L, 6L, 10L, 17L, \n9L, 35L, 2L, 0L, 1L, 1L, 2L, 4L, 6L, 8L, 22L, 33L, 73L, 0L, 0L, \n0L, 1L, 2L, 7L, 7L, 15L, 27L, 21L, 56L, 1L, 2L, 2L, 0L, 2L, 9L, \n4L, 8L, 24L, 13L, 17L, 14L, 2L, 8L, 10L, 16L, 51L, 16L, 51L, \n69L, 29L, 99L, 44L, 18L, 25L, 34L, 19L, 49L, 26L, 43L, 63L, 15L, \n30L, 42L, 9L, 17L, 7L, 3L, 16L, 8L, 13L, 22L, 18L, 45L, 0L, 0L, \n1L, 3L, 0L, 7L, 4L, 14L, 15L, 20L, 47L, 0L, 1L, 0L, 1L, 1L, 3L, \n3L, 5L, 6L, 11L, 21L, 1L, 0L, 0L, 4L, 2L, 3L, 8L, 7L, 17L, 3L, \n13L, 5L, 2L, 6L, 13L, 15L, 34L, 19L, 42L, 62L, 37L, 83L, 52L, \n16L, 26L, 26L, 29L, 53L, 28L, 45L, 45L, 15L, 22L, 26L, 8L, 12L, \n11L, 5L, 12L, 5L, 7L, 17L, 10L, 28L), .Dim = c(11L, 6L, 5L), .Dimnames = structure(list(\n    Q9 = c(\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \n    \"10\"), c(\"I've changed for work/ a new job/ gone on a work plan\", \n    \"I want a phone that 2degrees doesn't offer\", \"I want Best Mates/ Favourites\", \n    \"I was offered or saw a better offer on another network\", \n    \"Issues with the 2degrees network (poor coverage)\", \"Other\"\n    ), YearQuarter = c(\"2011-09-01\", \"2011-12-01\", \"2012-03-01\", \n    \"2012-06-01\", \"2012-09-01\")), .Names = c(\"Q9\", \"\", \"YearQuarter\"\n)), class = \"table\")\n\nx10.p &lt;- round(prop.table(x10,c(3,2)),2)*100\n</code></pre>\n\n<p>Hi there</p>\n\n<p>x10.p is at three dimensional proportion table with three variables. I would like to find the percentage difference between (0,1,2) and (8,9,10). Basically the difference between the top end and the bottom.  For example, in YearQuarter =2012-03-01, the cateogory of\n'I've changed for work/a new job/gone on workplan', the culmulative percentage sum of 0,1,2 is 1+0+0=1% and the cumulative percentage sum of 8,9,10 is 17+14+50=81%, the difference is 80% and 1% is 80. I would like to get this number for all categories and all year quarters? Could anyone assit please?</p>\n\n<p>Cheers</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13187605,"title":"Error in tolower() invalid multibyte string","body":"<p>This is the error that I receive when I try to run tolower() on a character vector from a file that cannot be changed (at least, not manually - too large). </p>\n\n<p><code>Error in tolower(m) : invalid multibyte string X</code></p>\n\n<p>It seems to be French company names that are the problem with the <code>É</code> character. Although I have not investigated all of them (also not possible to do so manually). </p>\n\n<p>It's strange, because my thought was that encoding issues would have been identified during read.csv(), rather than during operations after the fact. </p>\n\n<p>Is there a quick way to remove these multibyte strings? Or, perhaps a way to identify and convert? Or even just ignore them entirely? </p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":84,"score":0,"question_id":13184460,"title":"How to convert For loop to apply","body":"<p>How do I convert the below nested For loop to an Apply?</p>\n\n<pre><code>for(i in 1:length(vList$Subgroup.Number))\n{\n  for(j in 1:length(viol_grp))\n   {\n    viol_List[[j]] &lt;- vList[which(vList$Subgroup.Number==viol_grp[j]), ]\n   }\n}\n</code></pre>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":36,"score":-1,"question_id":13189209,"title":"How to adjsut the x axis position in the bar chart in ggplot?","body":"<pre><code>x.4.1.m&lt;- structure(list(Var.1 = structure(c(1L, 2L, 3L, 4L, 5L, 6L, 1L, \n2L, 3L, 4L, 5L, 6L, 1L, 2L, 3L, 4L, 5L, 6L, 1L, 2L, 3L, 4L, 5L, \n6L, 1L, 2L, 3L, 4L, 5L, 6L), .Label = c(\"I've changed for work/ a new job/ gone on a work plan\", \n\"I want a phone that 2degrees doesn't offer\", \"I want Best Mates/ Favourites\", \n\"I was offered or saw a better offer on another network\", \"Issues with the 2degrees network (poor coverage)\", \n\"Other\"), class = \"factor\"), YearQuarter = structure(c(15218, \n15218, 15218, 15218, 15218, 15218, 15309, 15309, 15309, 15309, \n15309, 15309, 15400, 15400, 15400, 15400, 15400, 15400, 15492, \n15492, 15492, 15492, 15492, 15492, 15584, 15584, 15584, 15584, \n15584, 15584), class = \"Date\"), value = c(17, 7, 11, 25, 27, \n14, 9, 22, 5, 27, 25, 12, 9, 12, 8, 30, 30, 12, 12, 10, 6, 28, \n28, 15, 11, 5, 6, 31, 34, 14)), .Names = c(\"Var.1\", \"YearQuarter\", \n\"value\"), row.names = c(NA, -30L), class = \"data.frame\")\n\nx.4.1.m$YearQuarter &lt;- as.Date(x.4.1.m$YearQuarter)\nx.4.1.m$Var.1 &lt;- factor(x.4.1.m$Var.1 )\nlevels(x.4.1.m$YearQuarter)\n\np &lt;- ggplot(data=x.4.1.m, aes(x=YearQuarter, y=value)) +   \n    geom_bar(stat=\"identity\",position = \"dodge\",\n        fill=tourism.cols(3),ymax=50) +\n    facet_wrap(~Var.1)\n\np + labs(y=\"Percentage\",x=\"Year Quarter\") + \n    geom_text(aes(label = value),size = 3, vjust = -1) + \n    scale_y_continuous(limits = c(0,50))\n</code></pre>\n\n<p>I am struggling to adjust the x-axis to quarterly as it displays from July to Oct? However, if you look at the leves(YearQuarter), there is no Oct?</p>\n"},{"tags":["r","list","function","lm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13189012,"title":"How to create outputs in list form that aren't shown as lists & how to print only part of the result","body":"<p>Many functions' outputs come in the list structure - for example lm(). As a result, you can retrieve the separate section of the output using \"$\" or indexation with square brackets. My question is how I can create an output in list form, without overtly showing that it is a list. As you know, when a list is printed on the screen, it typically has the sub-list name or index indicated, such as below:</p>\n\n<pre><code>L1 = list(a=1:3, b=letters[1:3])\nL1\n\n$a\n[1] 1 2 3\n\n$b\n[1] \"a\" \"b\" \"c\"\n</code></pre>\n\n<p>However, lm() output never shows the different sub-lists using \"$\" and sub-list names - although you can extract these sub-lists using \"$\" and sub-list names.</p>\n\n<p>A second question pertains to the fact that some functions' outputs include much more than what is actually printed on the screen (e.g., lm(), again). If we use str() for the fitted model, we will see a whole bunch of content within the fitted model most of which is not printed. How is this achieved? Does the function print something and output something else (using invisible()) separately like below?</p>\n\n<pre><code>foo = function(x){\n   result = list(data=x, test.result=t.test(x))\n   print(result[[2]])\n   invisible(result)\n}\nfoo(1:10)$data\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["python","r","vim"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13188843,"title":"Best data munging resource for R, Python, or VIM?","body":"<p>I'm looking for the best data munging resource for R, Python, or VIM (or perhaps all of them). For Perl, there is the excellent <a href=\"http://rads.stackoverflow.com/amzn/click/1930110006\" rel=\"nofollow\">\"Data Munging with Perl\" by David Cross</a>. I'm looking for the equivalent for R, Python, or VIM.</p>\n"},{"tags":["r","devtools"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13182582,"title":"install_github not installing all folders in inst","body":"<p>I am not sure if I am doing something stupid, but for some reason, all folders in <code>inst</code> are not getting installed when I run <code>install_github('slidify', 'ramnathv', ref = 'dev')</code>. In particular the folder <code>inst/scaffold</code> is not getting installed.</p>\n\n<p>I ran <code>devtools::install</code> from the local git repo and everything works fine. I also checked the zipball to make sure that it contained inst\\scaffold and it does.</p>\n\n<p>Does anyone know what might be going on?</p>\n\n<p>NOTE. I am cross posting this issue at <a href=\"https://github.com/hadley/devtools/issues/185\" rel=\"nofollow\">https://github.com/hadley/devtools/issues/185</a></p>\n"},{"tags":["performance","r","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":13122882,"title":"a faster implementation of merge.data.frame() in R","body":"<p>Let's say <code>a</code> and <code>b</code> are two data frames. The goal is to write a function\n<code>f(a,b)</code> that produces a merged data frame, in the same way as merge\n<code>merge(a,b,all=TRUE)</code> would do, that is filling missing variables in <code>a</code> or <code>b</code> with NAs. (The problem is <code>merge()</code> appears to be very slow.)</p>\n\n<p>This can be done as follows (pseudo-code):</p>\n\n<pre><code>for each variable `var` found in either `a` or `b`, do:\n    unlist(list(a.srcvar, b.srcvar), recursive=FALSE, use.names=FALSE)\n\nwhere:\nx.srcvar is x$var if x$var exists, or else\n            rep(NA, nrow(x)) if y$var !is.factor, or else\n            as.factor(rep(NA, nrow(x)))\n</code></pre>\n\n<p>and then wrap everything in a data frame.</p>\n\n<p>Here's a \"naive\" implementation:</p>\n\n<pre><code>merge.datasets1 &lt;- function(a, b) {\n  a.fill &lt;- rep(NA, nrow(a))\n  b.fill &lt;- rep(NA, nrow(b))\n  a.fill.factor &lt;- as.factor(a.fill)\n  b.fill.factor &lt;- as.factor(b.fill)\n  out &lt;- list()\n  for (v in union(names(a), names(b))) {\n    if (!v %in% names(a)) {\n      b.srcvar &lt;- b[[v]]\n      if (is.factor(b.srcvar))\n        a.srcvar &lt;- a.fill.factor\n      else\n        a.srcvar &lt;- a.fill\n    } else {\n      a.srcvar &lt;- a[[v]]\n      if (v %in% names(b))\n        b.srcvar &lt;- b[[v]]\n      else if (is.factor(a.srcvar))\n        b.srcvar &lt;- b.fill.factor\n      else\n        b.srcvar &lt;- b.fill\n    }\n    out[[v]] &lt;- unlist(list(a.srcvar, b.srcvar),\n                       recursive=FALSE, use.names=FALSE)\n  }\n  data.frame(out)\n}\n</code></pre>\n\n<p>Here's a different implementation that uses \"vectorized\" functions:</p>\n\n<pre><code>merge.datasets2 &lt;- function(a, b) {\n  srcvar &lt;- within(list(var=union(names(a), names(b))), {\n    a.exists &lt;- var %in% names(a)\n    b.exists &lt;- var %in% names(b)\n    a.isfactor &lt;- unlist(lapply(var, function(v) is.factor(a[[v]])))\n    b.isfactor &lt;- unlist(lapply(var, function(v) is.factor(b[[v]])))\n    a &lt;- ifelse(a.exists, var, ifelse(b.isfactor, 'fill.factor', 'fill'))\n    b &lt;- ifelse(b.exists, var, ifelse(a.isfactor, 'fill.factor', 'fill'))\n  })\n  a &lt;- within(a, {\n    fill &lt;- NA\n    fill.factor &lt;- factor(fill)\n  })\n  b &lt;- within(b, {\n    fill &lt;- NA\n    fill.factor &lt;- factor(fill)\n  })\n  out &lt;- mapply(function(x,y) unlist(list(a[[x]], b[[y]]),\n                                     recursive=FALSE, use.names=FALSE),\n                srcvar$a, srcvar$b, SIMPLIFY=FALSE, USE.NAMES=FALSE)\n  out &lt;- data.frame(out)\n  names(out) &lt;- srcvar$var\n  out\n}\n</code></pre>\n\n<p>Now we can test:</p>\n\n<pre><code>sample.datasets &lt;- lapply(1:50, function(i) iris[,sample(names(iris), 4)])\n\nsystem.time(invisible(Reduce(merge.datasets1, sample.datasets)))\n&gt;&gt;   user  system elapsed \n&gt;&gt;  0.192   0.000   0.190 \nsystem.time(invisible(Reduce(merge.datasets2, sample.datasets)))\n&gt;&gt;   user  system elapsed \n&gt;&gt;  2.292   0.000   2.293 \n</code></pre>\n\n<p>So, the naive version is orders of magnitude faster than the other. How can\nthis be? I always thought that <code>for</code> loops are slow, and that one should\nrather use <code>lapply</code> and friends and steer clear of loops in R. I would welcome any idea on how to improve my function in terms of speed.</p>\n"},{"tags":["c++","r","rcpp","rinside"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13181331,"title":"RCpp/RInside C++ main method queries and limitations?","body":"<p>A couple question about RInside I could not find on the RCpp mailing list. Can you define the RInside() outside out the C++ main() method? Are there any examples of that? Or can I only have one R embedded session in each C++ application?  IS there a way I could use my C++ papp to call multiple R scripts at the same time through something like OpenMP?\nThanks </p>\n"},{"tags":["regex","r","grep"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":13187414,"title":"R grep: is there an AND operator?","body":"<p>Suppose I have the following data frame:</p>\n\n<pre><code>User.Id    Tags\n34234      imageUploaded,people.jpg,more,comma,separated,stuff\n34234      imageUploaded\n12345      people.jpg\n</code></pre>\n\n<p>How might I use grep (or some other tool) to only grab rows that include both \"imageUploaded\" and \"people\"? In other words, how might I create a subset that includes just the rows with the strings \"imageUploaded\" AND \"people.jpg\", regardless of order.</p>\n\n<p>I have tried:</p>\n\n<pre><code>data.people&lt;-data[grep(\"imageUploaded|people.jpg\",results$Tags),]\ndata.people&lt;-data[grep(\"imageUploaded?=people.jpg\",results$Tags),]\n</code></pre>\n\n<p>Is there an AND operator? Or perhaps another way to get the intended result? </p>\n"},{"tags":["r","quantmod"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13187415,"title":"quantmod ... unable to get OHLCV symbol data for current day","body":"<p>I am not able to get OHLCV data from yahoo for current day using Quantmod <code>getSymbols()</code> call. The data exists on yahoo and can also see today's OHLCV data in my charting platform. As workaround I got today's EOD quote from yahoo using <code>getQuote(..)</code> call. But when I tried to append this to the downloaded symbol data via rbind, the data object gets populated with NULLs. </p>\n\n<p>I appreciate any suggestions on either how to append the today's quote to the downloaded historic symbol data or any R API's I can call after market hours to get symbol EOD (OHLCV data) including for today. Thanks.</p>\n\n<pre><code>library(quantmod)\nlibrary(blotter) \nlibrary(PerformanceAnalytics)\n\ngetSymbols(\"SPY\")\nspy.quote = getQuote(\"SPY\", what = yahooQuote.EOD)\n\n&gt; tail(SPY, n=3)\n           SPY.Open SPY.High SPY.Low SPY.Close SPY.Volume SPY.Adjusted\n2012-10-25   142.02   142.28  140.57    141.43  134457400       141.43\n2012-10-26   141.30   141.84  140.39    141.35  146023500       141.35\n2012-10-31   141.85   142.03  140.68    141.35  103341300       141.35\n\n&gt; spy.quote\n             Trade Time   Open   High    Low  Close    Volume\nSPY 2012-11-01 04:00:00 141.65 143.01 141.52 142.83 100990760\n\n&gt; SPY = rbind(SPY, spy.quote)\n&gt; tail(SPY, n=3)\n          SPY.Open SPY.High SPY.Low SPY.Close SPY.Volume SPY.Adjusted\n          NULL     NULL     NULL    NULL      NULL       NULL               \n          NULL     NULL     NULL    NULL      NULL       NULL        \nspy.quote NULL     NULL     NULL    NULL      NULL       NULL  \n</code></pre>\n"},{"tags":["c++","r","rcpp"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13183390,"title":"RCpp : how to reload recompiled C++ code without restarting R","body":"<p>I'm experimenting with the rcpp_hello_world example generated by <code>Rcpp.package.skeleton()</code>.</p>\n\n<p>I made a small change to <code>rcpp_hello_world.cpp</code>, I would like to recompile the package and run the function with the modified code.</p>\n\n<p>However, in spite of clearing the namespace with <code>rm()</code>, detaching the library with <code>detach()</code>, removing the package with r<code>emove.packages()</code>, re-compiling and re-installing the package with <code>install.packages(.., repos=NULL, type = 'source')</code>, and reattaching the library with <code>library()</code>, R still runs the old version of the .cpp code. </p>\n\n<p>If I quit and restart R, <code>library()</code> will load the modified .cpp code and run it as intended, but I don't want to have to restart R everytime I make a change to the C++ code (if possible).</p>\n\n<p>How can I get R to properly refresh the C++ call without quitting R?</p>\n"},{"tags":["r","bioconductor"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13185564,"title":"R - XCMS package Error","body":"<p>I' ve the following problem : </p>\n\n<p><strong>Error in .C(\"NetCDFOpen\", as.character(filename), ncid = integer(1), status = integer(1),  : \n  C symbol name \"NetCDFOpen\" not in DLL for package \"xcms\"</strong></p>\n\n<p>How do you get this error : </p>\n\n<pre><code>nc     &lt;- xcms:::netCDFOpen(cdfFile)\nncData &lt;- xcms:::netCDFRawData(nc)\nxcms:::netCDFClose(nc)\n</code></pre>\n\n<p>I don't know why this don't works, although it should. For further info feel free to ask. Free .cdf files canf be found in the <em>TargetSearchData</em> package.</p>\n\n<p>Code example : </p>\n\n<pre><code>## The directory with the NetCDF GC-MS files\ncdfpath &lt;- file.path(.find.package(\"TargetSearchData\"), \"gc-ms-data\")\ncdfpath\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13187105,"title":"Removing similar characters from field","body":"<p>I have File1.csv contains 3000 records, from which I need to remove characters not related to address.</p>\n\n<p>Each record starts from \"&amp;\" or \"A/O\".\nI need to clean my \"Address1\" field, if it's no address related info in the field,\nI need to have empty record. </p>\n\n<p>Example:</p>\n\n<pre><code>File1.csv:\n\nAddress1\n&amp;&amp;2340 Clemb Street\n&amp;&amp;564 7th Street\n&amp;&amp;&amp;10th Street\nA/O11th Street\nA/ONorth Street\nA/O/OSouth Street\nA/Ocareof\nA/Otttt\nA/Oyuyuyu\nA/Ouiuiuiuiui\nA/O/yuyyuyuyuyugggh 4510th Street\n&amp;uhhhhhello 56 11th Street\n</code></pre>\n\n<p>I am expecting result in File1 -without A/O, A/O/O, A/Ouiuiuiui  etc.:</p>\n\n<p>File1.csv:</p>\n\n<pre><code>Address1\n2340 Clemb Street\n564 7th Street\n10th Street\n11th Street\nNorth Street\nSouth Street\n&lt;blank record&gt;\n&lt;blank record&gt;\n&lt;blank record&gt;\n&lt;blank record&gt;\n4510th Street\n56 11th Street\n</code></pre>\n\n<p>Thanx for help!</p>\n"},{"tags":["r","colors","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13175440,"title":"ggplot2 and RcolorBrewer with qualitative palettes of 2 values","body":"<p>I used RColorBrewer to set the colors in ggplot2. I wrote a function and on the same chart I superimpose from 1 to 4 lines. In order to set a color I use:</p>\n\n<pre><code>scale_color_brewer(type=\"qual\", palette=\"Set1\")\n</code></pre>\n\n<p>According to manual \"for qualitative palettes, the lowest number of distinct values available always is 3\" therefore when the number of lines equal to 1 or 2, I get warning messages. Is there any claver trick to cope with?</p>\n\n<p>Robert    </p>\n\n<p>@Ben Bolker: You are absolutely right that a reproducible example in many cases has to be submit although here is not necessary. Because my original function is long I prepared simple example showing the problem.</p>\n\n<pre><code>library(\"datasets\")\nlibrary(\"ggplot2\")\n\nset.seed(1367)\ny &lt;- log10(lynx)\ny.estim &lt;- y + rnorm(length(y), sd=0.2)\nmydf &lt;- data.frame(time=1:length(y), y, y.estim) \nmydf &lt;- melt(mydf, id=\"time\")\n\np &lt;- ggplot(mydf, aes(x=time, y=value, color=variable))\np + geom_line() + geom_point(size=2) + theme_bw() +\n   scale_color_brewer(type=\"qual\", palette=\"Set1\") #here is a problem\n</code></pre>\n\n<p>Maybe I could specify color directly. I know that</p>\n\n<pre><code>library(\"RColorBrewer\")\n&gt; brewer.pal(4, \"Set1\")\n[1] \"#E41A1C\" \"#377EB8\" \"#4DAF4A\" \"#984EA3\"\n</code></pre>\n\n<p>Is it possible to work with e.g. \"#E41A1C\" ?      </p>\n"},{"tags":["r","plyr","data.table"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":130,"score":4,"question_id":12290296,"title":"R: transpose a data set","body":"<p>I want to transpose data sets similar to <code>my.data</code> below and then sum the rows.</p>\n\n<pre><code>my.data &lt;- \"landuse units year county.a  county.b  county.c  county.d \n            apple   acres 2010     0         2         4         6 \n            pear    acres 2010    10        20        30        40\n            peach   acres 2010   500       400       300       200\"\n\nmy.data2 &lt;- read.table(textConnection(my.data), header = T)\nmy.data2\n</code></pre>\n\n<p>The desired output is:</p>\n\n<pre><code> counties all.fruit\n county.a       510\n county.b       422\n county.c       334\n county.d       246\n</code></pre>\n\n<p>I can do this with the code below.  However, the following code seems like it must be enormous overkill.  I am hoping there is a much simpler solution.</p>\n\n<pre><code># transpose the data set\n\ntmy.data2 &lt;- t(my.data2)\ntmy.data2 &lt;- as.data.frame(tmy.data2)\n\n# assign row names to the data set\n\nmy.rows &lt;- row.names(tmy.data2)\n\ntransposed.data &lt;- cbind(my.rows, tmy.data2)\ntransposed.data\n\n# extract numbers to obtain row sums\n\nfruit.data &lt;- as.data.frame(transposed.data[4:dim(transposed.data)[1], 2:dim(transposed.data)[2]])\n\nfruit.data2 &lt;- as.matrix(fruit.data)\n\nfruit.data3 &lt;- matrix(as.numeric(fruit.data2), nrow=( dim(fruit.data2)[1] ),  byrow=F)\n\n# sum fruit by county\n\nall.fruit &lt;- rowSums(fruit.data3, na.rm=T)\n\n# create row names for summed fruit data\n\ncounties &lt;- my.rows[4:length(my.rows)]\n\nalmost.final.data &lt;- cbind(counties, all.fruit)\n\nreally.final.data &lt;- as.data.frame(almost.final.data)\n\nreally.final.data[,2] &lt;- as.numeric(as.character(really.final.data[,2]))\nreally.final.data\n\nstr(really.final.data)\n</code></pre>\n\n<p>Thank you for any suggestions.  I can use the code above, but view this request as an opportunity to greatly improve my programming.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":9982445,"title":"configuration error when installing rJava package","body":"<p>During installing rJava package, I got the following error messages:</p>\n\n<blockquote>\n  <p>checking JNI data types... configure: error: One or more JNI types differ from the corresponding native type. You may need to use non-standard compiler flags or a different compiler in order to fix this.\n  ERROR: configuration failed for package ‘rJava’</p>\n</blockquote>\n\n<p>May I know what is the cause for this failure and how to fix this issue? Thanks.</p>\n"},{"tags":["r","cluster-analysis"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13177720,"title":"What is the meaning of \"Inf\" in S_Dbw output in R commander?","body":"<p>I have ran clv package which consists of S_Dbw and SD validity indexes for clustering purposes in R commander. (http://cran.r-project.org/web/packages/clv/index.html)</p>\n\n<p>I evaluated my clustering results from DBSCAN, K-Means, Kohonen algorithms with S_Dbw index. but for all these three algorithms S_Dbw is \"Inf\".</p>\n\n<p>Is it \"Infinite\" meaning? Why did i confront with \"Inf\". Is there any problem in my clustering results?</p>\n\n<p>In general, when is S_Dbw index result \"Inf\"?</p>\n"},{"tags":["r","bar-chart","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":45,"score":3,"question_id":13129580,"title":"Decrease number of x-axis ticks (labels) in barchart","body":"<p>I am using barchart from the lattice package.  I have time series data going back 10 years, and I would like the x-axis to be displayed in the format %b-%Y, in six month intervals.  This is trivially accomplished in xyplot (given vector of dates DateVector) with syntax such as:</p>\n\n<pre><code>scales=list(x=list(format = \"%b-%Y\",tick.number = length(DateVector)/2))\n</code></pre>\n\n<p>barchart ignores the tick.number option for factors by design, however, so the x axis becomes unreadable for large number of data labels.  How can I reduce the number of ticks and/or tick labels?</p>\n\n<p>Here is a simple example that reproduces my problem, with data following (save the data as Testrr.csv to run, apologies if this is the wrong format, it's my first time ;)</p>\n\n<pre><code>library(lattice)\n\ninptTrans &lt;- read.csv(\"Testrr.csv\")\ninptTrans$NotherTime &lt;- as.Date(as.character(inptTrans$TransDateS),\"%m/%d/%Y\")\nxyp2 &lt;- barchart (NumE+NumF~ NotherTime, data=inptTrans, main = sprintf(\"Total\")\n                  ,type='r',xlab = '',ylab='',col=c('red','black')\n                  ,horizontal=FALSE\n                  ,scales=list(x=list( rot=45,cex=1.0 ,\n                                 labels=format(inptTrans$NotherTime,\"%b-%Y\"),tick.number=2)\n                     )\n                  ,key=list(text = list(c(\"Num F\",\"Num E\"))\n                     ,rectangle=list(col=c('black','red') ),columns = 2\n                     ,corner = c(0.05,-0.11),lty = c(1),lwd=3)\n                  ,stack=TRUE\n                  )\n\npng(sprintf('Testrr.png'),width = 900, height = 750)\nprint(xyp2) \ndev.off()\n</code></pre>\n\n<p>Testrr.csv:</p>\n\n<pre><code>TransDateS,NumTot,NumF,NumE\n01/15/2003,339486,18478,293879\n02/15/2003,343761,16430,295272\n03/15/2003,413700,17924,356004\n04/15/2003,432741,18260,377046\n05/15/2003,465439,18721,406632\n06/15/2003,490699,18276,424773\n07/15/2003,507818,18354,440237\n08/15/2003,506530,17391,437386\n09/15/2003,481039,17809,411568\n10/15/2003,483364,19507,412902\n11/15/2003,392189,16308,329675\n12/15/2003,444249,18342,367489\n01/15/2004,364662,20009,308456\n02/15/2004,389718,16894,329946\n03/15/2004,511386,20207,434052\n04/15/2004,525563,19867,452646\n05/15/2004,538570,17557,463289\n06/15/2004,620868,20386,535523\n07/15/2004,581368,20844,500511\n08/15/2004,580773,19687,495930\n09/15/2004,523992,21322,442304\n10/15/2004,507288,18907,427265\n11/15/2004,489571,19135,409818\n12/15/2004,510904,21213,419328\n01/15/2005,419417,21930,351257\n02/15/2005,446402,19600,374778\n03/15/2005,581109,22655,486727\n04/15/2005,574275,21263,487661\n05/15/2005,617399,21033,524466\n06/15/2005,688876,26999,584782\n07/15/2005,610606,20712,516127\n08/15/2005,670746,23171,562919\n09/15/2005,601594,23769,499257\n10/15/2005,537107,21057,446620\n11/15/2005,517340,22378,421351\n12/15/2005,507610,22002,403392\n01/15/2006,409802,25032,334607\n02/15/2006,429196,23383,350498\n03/15/2006,567056,27528,461193\n04/15/2006,502403,24994,415797\n05/15/2006,578793,27765,480468\n06/15/2006,603134,31641,501012\n07/15/2006,507408,25796,423143\n08/15/2006,557500,31435,460225\n09/15/2006,475884,30448,386443\n10/15/2006,469092,31648,385751\n11/15/2006,432720,36363,349832\n12/15/2006,422369,30619,335706\n01/15/2007,365297,38993,302488\n02/15/2007,372276,34855,308599\n03/15/2007,455525,39038,377113\n04/15/2007,431043,36892,363764\n05/15/2007,473539,42371,401959\n06/15/2007,483341,44540,408415\n07/15/2007,441046,43735,373058\n08/15/2007,446111,48509,375242\n09/15/2007,341554,45252,283456\n10/15/2007,365869,55746,304820\n11/15/2007,333946,57399,274292\n12/15/2007,309551,51137,252391\n01/15/2008,270806,70554,229161\n02/15/2008,289606,66395,245970\n03/15/2008,328369,65904,279960\n04/15/2008,353531,78510,308293\n05/15/2008,375080,81284,328119\n06/15/2008,390034,80175,342170\n07/15/2008,378648,85689,334255\n08/15/2008,363756,83357,321556\n09/15/2008,350942,79301,309385\n10/15/2008,330164,75568,293867\n11/15/2008,252408,67388,222510\n12/15/2008,296037,65057,261619\n01/15/2009,222048,69380,201462\n02/15/2009,247591,77532,224236\n03/15/2009,305516,57897,277544\n04/15/2009,322308,65778,295160\n05/15/2009,335134,78854,305599\n06/15/2009,386702,93204,353285\n07/15/2009,391393,91153,358731\n08/15/2009,361150,77043,329656\n09/15/2009,360568,79893,327923\n10/15/2009,374886,90766,339969\n11/15/2009,342502,77895,305321\n12/15/2009,330770,81255,300899\n01/15/2010,238132,94309,220064\n02/15/2010,261558,81167,241123\n03/15/2010,363432,103052,335172\n04/15/2010,385535,100984,355852\n05/15/2010,381303,95408,350883\n06/15/2010,416893,94812,376190\n07/15/2010,297810,94574,278054\n08/15/2010,313494,98536,291501\n09/15/2010,301782,110154,280312\n10/15/2010,279117,80204,260114\n11/15/2010,270178,67700,250713\n12/15/2010,301323,67770,279877\n01/15/2011,232283,78998,219762\n02/15/2011,236917,64257,223213\n03/15/2011,312669,80275,295648\n04/15/2011,317720,77881,301463\n05/15/2011,332220,76017,315955\n06/15/2011,364962,79413,347253\n07/15/2011,320199,67812,305785\n08/15/2011,352555,74725,337283\n09/15/2011,316858,82664,303357\n10/15/2011,293425,69684,281407\n11/15/2011,279320,73735,267671\n12/15/2011,295369,70498,282722\n01/15/2012,238417,73051,229405\n02/15/2012,267105,65015,256719\n03/15/2012,328104,63709,315019\n04/15/2012,330508,58175,318258\n05/15/2012,369418,65886,356174\n06/15/2012,361304,59515,348708\n07/15/2012,305613,49700,295448\n08/15/2012,227541,35801,219883\n</code></pre>\n"},{"tags":["r","package"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13182634,"title":"Rbuildignore and Excluding Directories","body":"<p>I am interested in excluding two directories <code>inst\\docs</code> and <code>inst\\examples</code> while building and installing the package. I know that an easy way out is just to move <code>docs</code> and <code>examples</code> to the root directory and they won't get installed. However, I want to keep them in <code>inst</code> for other reasons.</p>\n\n<p>I tried adding the following lines to <code>.Rbuildignore</code></p>\n\n<pre><code>inst/docs\ninst/examples\n</code></pre>\n\n<p>I use RStudio v 0.97 and <code>devtools</code> to build and install the package from source. However, when I do that, I still see that <code>inst\\docs</code> and <code>inst\\examples</code> get installed. I tried different regexes, but nothing seemed to work.</p>\n\n<p>Am I doing something wrong?</p>\n"},{"tags":["r","data.frame","subset"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":117,"score":3,"question_id":13179792,"title":"Is there a better syntax for subsetting a data frame in R?","body":"<p>I want to conditionally subset a dataframe <em>without</em> referencing the dataframe.  For example if I have the following:</p>\n\n<pre><code>long_data_frame_name &lt;- data.frame(x=1:10, y=1:10)\n</code></pre>\n\n<p>I want to say:</p>\n\n<pre><code>subset &lt;- long_data_frame_name[x &lt; 5,]\n</code></pre>\n\n<p>But instead, I have to say:</p>\n\n<pre><code>subset &lt;- long_data_frame_name[long_data_frame_name$x &lt; 5,]\n</code></pre>\n\n<p>plyr and ggplot handle this so beautifully.  Is there any package that makes subsetting a data frame similarly beautiful?</p>\n"},{"tags":["arrays","r","append"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13183788,"title":"Multiple array items appending","body":"<p>This is the reproducible code:</p>\n\n<pre><code>a &lt;- rep(1, 20)\na[c(1, 12, 15)] &lt;- 0\nb &lt;- which(a == 0)\nset.seed(123)\nd &lt;- round(runif(17) * 100)\n</code></pre>\n\n<p>I would like to append <code>0</code>s to <code>d</code> to get the following result:</p>\n\n<pre><code>[1]  0 29 79 41 88 94  5 53 89 55 46  0 96 45  0 68 57 10 90 25\n</code></pre>\n\n<p>that is equal to <code>d</code> after appending <code>0</code>s to each element which has index equal to <code>b - 1</code>.</p>\n\n<p>I've seen <code>append()</code> accepts just one single \"after\" value, not more than one.</p>\n\n<p>How could I do?</p>\n\n<p>Please, keep in mind I cannot change the length of <code>d</code> because it is supposed it's the ouput of a quite long function, not a simple random sequence like in this example.</p>\n"},{"tags":["r","cluster-analysis"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":65,"score":-5,"question_id":13180162,"title":"Identify number of clusters?","body":"<p>I am doing a cluster analysis on a very large dataset of genes. I know that certain genes should be in the same cluster, but I don't know how many clusters there should be.</p>\n\n<p>Is there a way to figure out what the ideal number of clusters will be while making sure that all of those genes are in the same cluster? </p>\n\n<p>Is there sample code I can see that does that?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I am currently using hclust() to do the clustering. I am using sapply() to print out the clusters, but it requires a specified number:</p>\n\n<p><code>\n    group.5 = cutree(data,5)</p>\n\n<pre><code>sapply(unique(groups.5),function(g)data$DATAID[groups.5 == g])\n</code></pre>\n\n<p></code></p>\n\n<p>What I want is something like:</p>\n\n<p><code>\n    //x &lt;- some array containing a certain DATAID</p>\n\n<pre><code>//figure out the number of clusters required in order for x array to be in the same cluster\n\nsapply(unique(clusterNum), function(g)....\n</code></pre>\n\n<p></code></p>\n"}]}
{"total":19203,"page":5,"pagesize":100,"questions":[{"tags":["r","reshape"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13181764,"title":"reshape dataset r","body":"<p>I need to reshape from long into wide format. I do not have a times variable. What is the easiest way to create a time variable for each id in the following dataset for subsequent reshaping in base r (not the reshape package)?</p>\n\n<pre><code>h&lt;-seq(from=as.Date(\"2005-06-01\"), to=as.Date(\"2008-06-30\"), by=1)\n\na&lt;-data.frame(id=sample(c(1:100),300,replace=T),val=rnorm(n=300),date=sample(h,300,replace=T))\n</code></pre>\n\n<p>//M</p>\n"},{"tags":["r","plot","axis"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":37,"score":-1,"question_id":13170929,"title":"R: KM curves plot in survival package change x axis range","body":"<p>I'm using the survival package to generate the KM curves for two populations but when I tried to define the xmax parameter, I am unable to extend the x-axis range from 0-15 to 0 - 50.</p>\n\n<p>Here is my code:</p>\n\n<pre><code> library(sm)\nlibrary(survival)\ncomb = read.csv(\"S:/Novocure/ChemoSKTime2Resp.csv\", head = TRUE)\ncomb\nsurvobj = with(comb, Surv(SK.response.time,Censored))\nsurvobj\n\n# Compare the survival distributions of nonresponders(0) and responders(1)\n\nfitresp = survfit(survobj ~ response, data=comb)\nfitresp\nsummary(fitresp)\n\n# plot the survival distributions by response\n\nplot(fitresp, xlab=\"Tumor Progression Time in Months\", \n  ylab=\"% Progressed\", yscale=100, col=c(\"red\",\"blue\"),\n  main=\"Chemo Time to Tumor Progression Distribution\", xmax = 50) \n  legend(\"topright\", title=\"Chi-sq = 5.2, P = 0.0222\", \n  c(\"Non-responders\", \"Responders\"), fill=c(\"red\", \"blue\"))\n</code></pre>\n"},{"tags":["r","optimization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13181534,"title":"DEoptim constrained optimization","body":"<p>Please, put in R the following structure:</p>\n\n<pre><code>V &lt;- structure(c(0.000372915251173446, 0.000174993698566265, 2.51364741409009e-05, \n0.000180577506408041, 0.000197950601649502, 0.00024252995895814, \n0.000282290600775959, 0.000147125865755969, 0.000146710347741915, \n-5.66061381018562e-05, 0.000226244008675348, 0.000142553474669792, \n6.63002942042725e-05, 0.000155080023949311, 9.80028747821553e-05, \n0.000143282272924095, 0.000207369736836111, 0.000297731806147568, \n0.000124621917210815, 0.000267766498992599, 0.000153799120428984, \n0.000195103937942646, 0.000174993698566265, 0.000166044316210775, \n2.43014627071255e-05, 0.000140332869715824, 0.000155685234241873, \n0.000164261158297262, 0.000194454409646253, 0.00013589880593514, \n0.000107771571987156, -4.76593299307376e-05, 0.000147278867399957, \n0.000111205427802368, 7.52602214651672e-05, 0.000102145307502739, \n7.56861224442408e-05, 0.000104820101258196, 0.000155652911506252, \n0.000181503945734685, 0.000107426756971272, 0.000170271712199328, \n0.000113905033578485, 0.000139055587236099, 2.51364741409009e-05, \n2.43014627071255e-05, 8.93072100098236e-05, 4.70674171346693e-06, \n3.04567101954253e-05, -8.71200362370943e-06, 4.15355147729277e-05, \n0.00013928790212328, 3.6235965303507e-06, 1.06452611427422e-05, \n-1.88353523304693e-06, 2.89774404517243e-06, 0.000122526962916035, \n1.68995126689916e-05, 6.06367471834011e-07, 2.95954944919373e-06, \n-1.58144287775128e-05, 3.11613547384053e-05, 4.40395931927649e-05, \n2.95313003819625e-05, 4.00226081907724e-06, 1.96319853142469e-05, \n0.000180577506408041, 0.000140332869715824, 4.70674171346693e-06, \n0.000162783713175306, 0.000141354905894933, 0.00018421083936233, \n0.000179113405412722, 9.66696873958731e-05, 0.000115148963766767, \n-4.93107078128605e-05, 0.000168720641687171, 0.000119328320274739, \n4.03508274078649e-05, 0.000104059036316729, 8.0807422108246e-05, \n0.000108401536157872, 0.000183460239645819, 0.000181709980468073, \n8.49826191553647e-05, 0.000168578900720055, 0.000118448131615346, \n0.000137559348700539, 0.000197950601649502, 0.000155685234241873, \n3.04567101954253e-05, 0.000141354905894933, 0.000212121821262289, \n0.000165846759884124, 0.000221199982632349, 0.000158730965957489, \n0.000111961129971894, -4.98493717197938e-05, 0.000148793297696269, \n0.000111463591399974, 8.37964675359535e-05, 0.00011362301814202, \n7.4243976905467e-05, 0.000113290120139652, 0.000141556282542872, \n0.000203990164514258, 0.000153074352635329, 0.000191095047497186, \n0.000123155575045629, 0.000151459375477966, 0.00024252995895814, \n0.000164261158297262, -8.71200362370943e-06, 0.00018421083936233, \n0.000165846759884124, 0.000308080463002083, 0.000219312152506556, \n7.41216727161405e-05, 0.000144107569465758, -5.71966552557712e-05, \n0.000243739274051864, 0.000140525373524643, 1.16766610498181e-05, \n0.00012844082924081, 9.78038809218685e-05, 0.000142584433501527, \n0.00023731059121111, 0.000233235998928878, 9.54224602637671e-05, \n0.000214579465276058, 0.000153869443132198, 0.000175479608803503, \n0.000282290600775959, 0.000194454409646253, 4.15355147729277e-05, \n0.000179113405412722, 0.000221199982632349, 0.000219312152506556, \n0.000340172363198888, 0.000197251811705373, 0.00014246369190559, \n-5.64196036387654e-05, 0.000201666200034232, 0.000144625918227935, \n0.000105620785232652, 0.000143475210817127, 9.37352585698548e-05, \n0.000137878927599882, 0.000196304803117072, 0.000284375970324559, \n0.000159574311797965, 0.000267130390341946, 0.000151328122691471, \n0.000193699241209649, 0.000147125865755969, 0.00013589880593514, \n0.00013928790212328, 9.66696873958731e-05, 0.000158730965957489, \n7.41216727161405e-05, 0.000197251811705373, 0.000384189362324778, \n7.48362546483358e-05, -1.13665565793837e-05, 8.36348194806412e-05, \n7.80952014679747e-05, 0.000231576608313992, 8.94093494539307e-05, \n4.4556171209914e-05, 6.89645260011389e-05, 6.48096180918177e-05, \n0.000165592085194825, 0.000138112714116962, 0.000155091675337319, \n7.78497747259364e-05, 0.000115972047792599, 0.000146710347741915, \n0.000107771571987156, 3.6235965303507e-06, 0.000115148963766767, \n0.000111961129971894, 0.000144107569465758, 0.00014246369190559, \n7.48362546483358e-05, 0.000111016823207275, -3.55248428627661e-05, \n0.000126651783839427, 0.000105159671845642, 2.67467339855483e-05, \n8.68895853481706e-05, 6.25159554016808e-05, 9.19824152392006e-05, \n0.000126594422083492, 0.000149596718911468, 6.70696515604008e-05, \n0.000137811639608842, 9.71790814129398e-05, 0.000112922938606402, \n-5.66061381018562e-05, -4.76593299307376e-05, 1.06452611427422e-05, \n-4.93107078128605e-05, -4.98493717197938e-05, -5.71966552557712e-05, \n-5.64196036387653e-05, -1.13665565793837e-05, -3.55248428627661e-05, \n6.06367226790633e-05, -4.46446876631884e-05, -3.50054865104692e-05, \n-1.03052043544243e-06, -2.68063361050335e-05, -2.75980731191321e-05, \n-3.87574838978063e-05, -6.35491722174031e-05, -5.86742662933086e-05, \n-4.19180759717185e-05, -5.61549958412067e-05, -4.04640833282744e-05, \n-4.76275160701462e-05, 0.000226244008675348, 0.000147278867399957, \n-1.88353523304693e-06, 0.000168720641687171, 0.000148793297696269, \n0.000243739274051864, 0.000201666200034232, 8.36348194806412e-05, \n0.000126651783839427, -4.46446876631884e-05, 0.000268688316127702, \n0.000123511653045365, 1.52197128538357e-05, 0.000118530567431784, \n8.5755728315591e-05, 0.00012526539770804, 0.000217756873624335, \n0.000213917080215142, 8.34367915057592e-05, 0.000195828022784308, \n0.000133625153837552, 0.000154664459396347, 0.000142553474669792, \n0.000111205427802368, 2.89774404517242e-06, 0.000119328320274739, \n0.000111463591399974, 0.000140525373524643, 0.000144625918227935, \n7.80952014679747e-05, 0.000105159671845642, -3.50054865104692e-05, \n0.000123511653045365, 0.000111941560787855, 3.14572096887459e-05, \n8.44714385720271e-05, 6.48042244310421e-05, 8.92128054043352e-05, \n0.000129729269665673, 0.000147498291370891, 6.46251880635853e-05, \n0.000136941567249813, 9.60799341209197e-05, 0.000111072310210171, \n6.63002942042725e-05, 7.52602214651672e-05, 0.000122526962916035, \n4.03508274078649e-05, 8.37964675359535e-05, 1.16766610498181e-05, \n0.000105620785232652, 0.000231576608313992, 2.67467339855483e-05, \n-1.03052043544243e-06, 1.52197128538357e-05, 3.14572096887459e-05, \n0.000266185452601185, 4.8129481135575e-05, 1.99198062511132e-05, \n2.67329017664394e-05, 1.0868909233461e-05, 8.20444905469019e-05, \n0.00010528314461089, 6.49513829467519e-05, 3.25653800551025e-05, \n6.15675285048495e-05, 0.000155080023949311, 0.000102145307502739, \n1.68995126689915e-05, 0.000104059036316729, 0.00011362301814202, \n0.00012844082924081, 0.000143475210817127, 8.94093494539307e-05, \n8.68895853481706e-05, -2.68063361050335e-05, 0.000118530567431784, \n8.44714385720271e-05, 4.8129481135575e-05, 0.000125026036140063, \n5.7432414133145e-05, 8.26067251826108e-05, 0.000114545613906247, \n0.000149932054947798, 6.79698778250366e-05, 0.00013936455678004, \n8.76679105332147e-05, 0.000119899189816791, 9.80028747821553e-05, \n7.56861224442408e-05, 6.0636747183401e-07, 8.0807422108246e-05, \n7.4243976905467e-05, 9.78038809218685e-05, 9.37352585698548e-05, \n4.4556171209914e-05, 6.25159554016808e-05, -2.75980731191321e-05, \n8.5755728315591e-05, 6.48042244310421e-05, 1.99198062511132e-05, \n5.7432414133145e-05, 6.48502832212918e-05, 6.38519284355072e-05, \n9.3567427942096e-05, 9.77487819577415e-05, 4.0410958761323e-05, \n9.11689975310294e-05, 6.80483550276616e-05, 7.83105103687082e-05, \n0.000143282272924095, 0.000104820101258196, 2.95954944919373e-06, \n0.000108401536157872, 0.000113290120139652, 0.000142584433501527, \n0.000137878927599882, 6.89645260011389e-05, 9.19824152392006e-05, \n-3.87574838978063e-05, 0.00012526539770804, 8.92128054043352e-05, \n2.67329017664394e-05, 8.26067251826108e-05, 6.38519284355072e-05, \n9.19464755186028e-05, 0.000125252485343273, 0.000143730207726188, \n6.66679928283782e-05, 0.000132699324370659, 9.42921600168871e-05, \n0.000110069277290576, 0.000207369736836111, 0.000155652911506252, \n-1.58144287775128e-05, 0.000183460239645819, 0.000141556282542872, \n0.00023731059121111, 0.000196304803117072, 6.48096180918177e-05, \n0.000126594422083492, -6.35491722174031e-05, 0.000217756873624335, \n0.000129729269665673, 1.0868909233461e-05, 0.000114545613906247, \n9.3567427942096e-05, 0.000125252485343273, 0.000336705701668796, \n0.000203536922296651, 6.78943877030662e-05, 0.000190223492440507, \n0.000138531369138546, 0.000153973690444942, 0.000297731806147568, \n0.000181503945734685, 3.11613547384053e-05, 0.000181709980468073, \n0.000203990164514258, 0.000233235998928878, 0.000284375970324559, \n0.000165592085194825, 0.000149596718911468, -5.86742662933086e-05, \n0.000213917080215142, 0.000147498291370891, 8.20444905469019e-05, \n0.000149932054947798, 9.77487819577415e-05, 0.000143730207726188, \n0.000203536922296651, 0.000289658350706512, 0.000134502196975399, \n0.000258542568618984, 0.000153516806202476, 0.00019428596930782, \n0.000124621917210815, 0.000107426756971272, 4.40395931927649e-05, \n8.49826191553647e-05, 0.000153074352635329, 9.54224602637671e-05, \n0.000159574311797965, 0.000138112714116962, 6.70696515604008e-05, \n-4.19180759717185e-05, 8.34367915057592e-05, 6.46251880635853e-05, \n0.00010528314461089, 6.79698778250366e-05, 4.0410958761323e-05, \n6.66679928283781e-05, 6.78943877030662e-05, 0.000134502196975399, \n0.000237685003609677, 0.000128373158260838, 7.53449206992707e-05, \n0.000100976510698125, 0.000267766498992599, 0.000170271712199328, \n2.95313003819625e-05, 0.000168578900720055, 0.000191095047497186, \n0.000214579465276058, 0.000267130390341946, 0.000155091675337319, \n0.000137811639608842, -5.61549958412067e-05, 0.000195828022784308, \n0.000136941567249813, 6.49513829467519e-05, 0.00013936455678004, \n9.11689975310294e-05, 0.000132699324370659, 0.000190223492440507, \n0.000258542568618984, 0.000128373158260838, 0.000250708799408316, \n0.00014278310873997, 0.000181517598788132, 0.000153799120428984, \n0.000113905033578485, 4.00226081907724e-06, 0.000118448131615346, \n0.000123155575045629, 0.000153869443132198, 0.000151328122691471, \n7.78497747259364e-05, 9.71790814129398e-05, -4.04640833282744e-05, \n0.000133625153837552, 9.60799341209197e-05, 3.25653800551025e-05, \n8.76679105332147e-05, 6.80483550276616e-05, 9.42921600168871e-05, \n0.000138531369138546, 0.000153516806202476, 7.53449206992707e-05, \n0.00014278310873997, 0.00010102205079244, 0.000117513021904387, \n0.000195103937942646, 0.000139055587236099, 1.96319853142469e-05, \n0.000137559348700539, 0.000151459375477966, 0.000175479608803503, \n0.000193699241209649, 0.000115972047792599, 0.000112922938606402, \n-4.76275160701462e-05, 0.000154664459396347, 0.000111072310210171, \n6.15675285048495e-05, 0.000119899189816791, 7.83105103687082e-05, \n0.000110069277290576, 0.000153973690444942, 0.00019428596930782, \n0.000100976510698125, 0.000181517598788132, 0.000117513021904387, \n0.00015741739565688), .Dim = c(22L, 22L))\n</code></pre>\n\n<p>This is my R session:</p>\n\n<pre><code>&gt; sessionInfo()\nR version 2.15.0 Patched (2012-04-26 r59206)\nPlatform: i386-pc-mingw32/i386 (32-bit)\n\nlocale:\n[1] LC_COLLATE=Italian_Italy.1252  LC_CTYPE=Italian_Italy.1252   \n[3] LC_MONETARY=Italian_Italy.1252 LC_NUMERIC=C                  \n[5] LC_TIME=Italian_Italy.1252    \n\nattached base packages:\n[1] tcltk     stats     graphics  grDevices datasets  utils     methods  \n[8] base     \n\nother attached packages:\n [1] DEoptim_2.2-1         rmgarch_0.95          Matrix_1.0-6         \n [4] lattice_0.20-6        Kendall_2.2           mvtnorm_0.9-9992     \n [7] spd_1.7               KernSmooth_2.23-7     rugarch_1.0-11       \n[10] Rsolnp_1.12           truncnorm_1.0-5       chron_2.3-42         \n[13] numDeriv_2012.3-1     RcppArmadillo_0.3.0.3 Rcpp_0.9.10          \n[16] quantmod_0.3-19       TTR_0.21-1            xts_0.8-6            \n[19] zoo_1.7-7             Defaults_1.1-1        lavaan_0.4-13        \n[22] Rcmdr_1.8-4           car_2.0-12            nnet_7.3-1           \n[25] MASS_7.3-18           rscproxy_2.0-5       \n\nloaded via a namespace (and not attached):\n[1] boot_1.3-4    grid_2.15.0   stats4_2.15.0\n</code></pre>\n\n<p>Here's my code:</p>\n\n<pre><code>library(DEoptim)\nfun &lt;- function(w) {\n  wt &lt;- c(w, 1 - sum(w))\n  if(sum(wt) != 1) {\n    y &lt;- Inf\n  }\n  else {\n    y &lt;- t(wt) %*% V %*% wt\n  }\n  return(y)\n}\nopt &lt;- DEoptim(fn = fun, lower = rep(0, ncol(V) - 1), upper = rep(1, ncol(V) - 1), control = DEoptim.control(itermax = 500))\nsum(opt$optim$bestmem)\n</code></pre>\n\n<p>This returns to me a parameters' array whose sum is greater than 1 and a function value which is not equal to <code>Inf</code>: what's wrong in my function and/or in my use of <code>DEoptim</code>?</p>\n\n<p>Thanks,</p>\n"},{"tags":["r","package"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":97,"score":3,"question_id":13102149,"title":"extracting source code from r package","body":"<p>I am trying to install the <code>r</code> package sowas and unfortunately it is too old to implement in the new versions of <code>r</code>. </p>\n\n<p>According to the author you can use the package using the <code>source()</code> function to gain access to the code but I have not been able to figure out how to do that. </p>\n\n<p>Any help is appreciated. </p>\n\n<p>Here is a link to the package I described as it is not a CRAN package: <a href=\"http://tocsy.pik-potsdam.de/wavelets/\" rel=\"nofollow\">http://tocsy.pik-potsdam.de/wavelets/</a> </p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13181037,"title":"Constructing a matrix as function of row and column","body":"<p>The situation is pretty straightforward. I want to create a matrix <code>A</code> of n rows and m columns, where the value for each element is given by a predetermined function <code>f(i, j)</code>. What is the most elegant way to achieve this?</p>\n"},{"tags":["r","tk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13171121,"title":"Multiple listboxs and scrollbars tcl/tk and R","body":"<p>I have created 4 listboxes and 4 scrollbars to which they bind. However the scrollbars don't work as expected: they interfere with each other in scrolling listboxes and the last scroll does not work. I couldn't find any other option in the <code>tkyview</code> and <code>tkset</code> to fix this problem. What do you think is wrong here?</p>\n\n<pre><code>require(tcltk)\ntt &lt;- tktoplevel()\n\n#Scrollbars\nscr.d &lt;- tkscrollbar(tt, repeatinterval=4,command=function(...) tkyview(t.d,...))\nscr.m &lt;- tkscrollbar(tt, repeatinterval=4,command=function(...) tkyview(t.d,...))\nscr.s &lt;- tkscrollbar(tt, repeatinterval=4,command=function(...) tkyview(t.d,...))\nscr.a &lt;- tkscrollbar(tt, repeatinterval=4,command=function(...) tkyview(t.d,...))\n\n#Listboxes\nt.d &lt;- tklistbox(tt, selectmode=\"browse\",yscrollcommand=function(...) tkset(scr.d,...), width=20,background=\"white\", exportselection=0)\nt.m &lt;- tklistbox(tt, selectmode=\"Single\",\n                 yscrollcommand=function(...) tkset(scr.m,...), width=20, background=\"white\", exportselection=0)\nt.s &lt;- tklistbox(tt,selectmode=\"Single\",\n                 yscrollcommand=function(...) tkset(scr.s,...), width=30, background=\"white\", exportselection=0)\nt.a &lt;- tklistbox(tt,selectmode=\"Single\",\n                 yscrollcommand=function(...) tkset(scr.a,...), width=35, background=\"white\", exportselection=0)\n\n#Place them on the window\ntkgrid(tklabel(tt,text=\"Select subject property:\"))\ntkgrid(tklabel(tt,text=\"\"))\ntkgrid(t.d, scr.d,t.m, scr.m, t.s, scr.s, t.a, scr.a)\n\ntkgrid.configure(scr.d,rowspan=4,sticky=\"nsw\")\ntkgrid.configure(scr.m,rowspan=4,sticky=\"nsw\")\ntkgrid.configure(scr.s,rowspan=4,sticky=\"nsw\")\ntkgrid.configure(scr.a,rowspan=4,sticky=\"nsw\")\n\n#Filling up the listboxes\nfor (i in 1:100)\n{\n  tkinsert(t.d, \"end\", i)\n}\n\nfor (i in letters)\n{\n  tkinsert(t.m, \"end\", i)\n}\n\nfor (i in rnorm(100))\n{\n  tkinsert(t.s, \"end\", i)\n}\n\nfor (i in letters)\n{\n  tkinsert(t.a, \"end\", i)\n}\n</code></pre>\n\n<p>This code is the extension of the code tutorial compiles by James Wettenhall in <a href=\"http://bioinf.wehi.edu.au/~wettenhall/RTclTkExamples/listboxes.html\" rel=\"nofollow\">here</a> and I think is a little bit outdated. </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":24,"score":-1,"question_id":13175489,"title":"Create many shape file from a large shape file.","body":"<p>I have a shape file with two different region with 12 sub region each.I want separate shape file of these 24 sub region from that shape file.I have also tried by using package maptools and rgeos but could not figure it.Any logarithm would be very much appreciated. Thanks.</p>\n\n<p>sharif </p>\n"},{"tags":["r","sapply"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13179536,"title":"R: sapply printing results","body":"<p>I have code that is doing this:</p>\n\n<pre><code>sapply(unique(groups.50),function(g)data$SEQUENCE_ID[groups.50 == g])\n</code></pre>\n\n<p>But in the RGui window, I can only scroll up to see some of the results. The first 10 or so doesn't show in the window (probably because my data is so large). How do I get it to show all of it, or alternatively, how do I print the first 10 results?</p>\n\n<p>Thanks.</p>\n"},{"tags":["regex","r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13171778,"title":"R character string sourcing","body":"<p>Hopefully this shouldn't be too complicated....but I have the following character string in <code>x</code>, and would like it to to be programmatically sourced as a function such that I can type in </p>\n\n<pre><code>HW.R()\n</code></pre>\n\n<p>to generate 100 random normals....i.e. what operations do I need to perform on <code>x</code> for that to happen?</p>\n\n<p>below is the code to generate <code>x</code></p>\n\n<pre><code>require(RCurl)\nx &lt;- base64Decode(\"SFcuUiA8LSBmdW5jdGlvbigpewogIHJub3JtKDEwMCkKfQ==\\n\")\nx\n[1] \"HW.R &lt;- function(){\\n  rnorm(100)\\n}\"\n</code></pre>\n"},{"tags":["r","bash"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13178222,"title":"Binning decimal data and plotting an histogram","body":"<p>I have a dataset in a file, which looks like this:</p>\n\n<pre><code>0.0707526823\n0.4859753978\n0.0084166789\n0.0694709558\n0.0156410467\n0.3783259831\n0.8977261856\n0.7981824881\n0.2079852045\n0.9498437264\n0.9264972044\n0.1878358734\n0.0020816686\n0.0024611297\n0.4250464895\n0.0725748666\n0.0407962054\n0.8282363221\n0.8408343333\n0.7129760016\n0.2772250135\n0.3677588953\n0.4723908637\n0.9452814318\n</code></pre>\n\n<p>I want to bin this data with an interval of 0.1 and plot a histogram. </p>\n\n<p>I did try using R,</p>\n\n<p>and here what I was doing</p>\n\n<pre><code>x&lt;-read.table(\"filex\", header=T)\nbreaks=seq (min, max, step)\nhist (x$col1, breaks)\n</code></pre>\n\n<p>but this command is not working in my case :(  </p>\n\n<p>Any one liner in awk, or R is welcomed</p>\n\n<p>Thank you</p>\n"},{"tags":["r","global-variables","heatmap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13157662,"title":"R gplots vertical lines at varying positions in multiple heatmap.2's","body":"<p>I am currently working on a customised version of heatmap.2 that can draw a heatmap with vertical lines separating different groups of samples. Since I have different data sets with varying group sizes, the vertical lines need to be adjusted accordingly for the abline function. This is done by my function positionLines(), which takes groups as input and returns a vector of positions where the lines should be drawn in a heatmap (e.g. linePosition = c(10,20,30,40)).\nThe returned vector (linePosition) is then used by a function called genePlot.tID which prepares the data matrix for the geneHeatmap function, which in turn is a wrapper for heatmap.2.</p>\n\n<p>So shortly, this is my workflow:</p>\n\n<pre><code>main function\n    #for each data set:\n    runs  linePosition = positionLines(groups) \n    calls genePlot (linePosition + other parameters)\n          calls geneHeatmap (linePosition + other parameters)\n                calls heatmap.2 (which requires linePosition)\n</code></pre>\n\n<p>Now, if I execute my code by hand, it works properly since linePosition is defined as global variable. However, if I try by just running the main function, heatmap.2 gives me the following error message:</p>\n\n<p>\"Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...) : \n  object 'linePosition' not found\"</p>\n\n<p>Thus far, I could nail the problem to linePosition being vector which is belonging to the main function (I would call it \"private\") and hence will be erased after the function finishes. If I create a global variable called linePosition, then heatmap.2 will use it regardless of my private variable being created within the main function (which is handed to each sub-function as parameter).</p>\n\n<p>Here's some shortened version of my code.</p>\n\n<h3>In the main function</h3>\n\n<pre><code>source(\"~/bin/COPA_AS/HuEx_genePlot.R\")\n    uniqClust   = unique(Resultlist[,1])\n\n    for (i in 1:length(allDataSets)) {\n        source(paste(\"~/bin/COPA_AS/\",allDataSets[i],\"_settings.R\",sep=\"\"))  # contains \"data\", a list for the group information and other stuff\n        linePosition = positionLines(data$printGroups)\n        load(paste(allDataSets[i],\"full_FIRMA_trFit.RData\",sep=\"_\"))   # my actual data matrix\n        for (c in 1:length(uniqClust)) {\n            clusterList = Resultlist[which(Resultlist[,1]==uniqClust[c]),2]   # the various lists of samples genes I want to print in one heatmap\n            genePlot.tID(clusterList,ID,outputDir,data,linePosition,trFit)\n        }\n}\n</code></pre>\n\n<h3>genePlot.tID</h3>\n\n<p>This function prepares the general purpose data matrix for plotting. There should be no problem here, just included for completeness.</p>\n\n<pre><code>genePlot.tID = function (clusterList,clusterID,outputDir,dataset,linePosition,trFit) {\n    load(\"HuEx_FIRMA_full_affyIDs.RData\")\n\n    dataM           = as.matrix(trFit[match(clusterList,unique(affyIDs[,1])),-c(1:5)])\n    rownames(dataM) = unique(affyIDs[,1])[match(clusterList,unique(affyIDs[,1]))]\n    colnames(dataM) = dataset$groups\n    dataL           = log2(dataM)\n    medians         = apply(dataL,1,median)\n    dataC           = dataL - medians\n    rownames(dataC) = rownames(dataM)\n\n    #reorder data matrix and plot\n    printOrder = NULL\n    for (p in 1:length(unique(dataset$printGroups))) {              \n        printOrder = c(printOrder,which(dataset$groups==unique(dataset$printGroups)[p]))\n    }\n    dataC = dataC[,printOrder]\n    geneHeatmap(clusterID,dataset$datasetName,1,outputDir,\"PDF\",linePosition,dataC)\n}\n</code></pre>\n\n<h3>geneHeatmap</h3>\n\n<p>Now, this is where it goes wrong in my opinion. As long as linePosition is not globally defined, heatmap.2 is not able to find it.</p>\n\n<pre><code>geneHeatmap = function(gene,datasetID,geneRank,outputDir,format,linePosition,expressionMatrix) {\n\n    # create heatmap of raw expression values for each gene\n    print(\"Printing raw value heatmap...\")\n    fileName = paste(\"rank_\",geneRank,\"_\",gene,\"_\",datasetID,\"_heatmap_raw\",sep=\"\")\n    labelSize = 0.2 + 1/log10(nrow(expressionMatrix))\n    if(nrow(expressionMatrix) &lt;= 8) {\n        labelSize = 0.2 + 1/log10(8)\n    }\n    if (format == \"PDF\") {\n        pdf(file=paste(outputDir,fileName,\".pdf\",sep=\"\"),height=7,width=9,onefile=F)\n        heatmap.2(expressionMatrix,Rowv=NA,Colv=NA,col=bluered,dendrogram=\"none\",\n            trace=\"none\",margins=c(10,7),keysize=1,cexRow = labelSize,\n            add.expr={abline(v=(linePosition+0.5),lwd=1,col=\"black\")\n        })\n        title (main=gene, line = 2)\n        title (main=paste(datasetID,\"raw\",sep=\" \"),line = 1)\n        dev.off()\n        }\n    }\n</code></pre>\n\n<p>If anyone has recommendations, please share them with me, I am very frustrated because of this problem as my whole script crashes when encountering it. ANY help is greatly appreciated.</p>\n\n<p>Best regards</p>\n\n<h3>#</h3>\n\n<p>Edit:</p>\n\n<p>Here's the output of traceback() after the error message:</p>\n\n<pre><code>Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...) : \n  object 'linePosition' not found\n\n&gt; traceback()\n8: int_abline(a = a, b = b, h = h, v = v, untf = untf, ...)\n7: abline(v = (linePosition + 0.5), lwd = 1, col = \"black\") at HuEx_genePlot.R#324\n6: eval(expr, envir, enclos)\n5: eval(substitute(add.expr))\n4: heatmap.2(expressionMatrix, Rowv = NA, Colv = NA, col = bluered, \n       dendrogram = \"none\", trace = \"none\", margins = c(10, 7), \n       keysize = 1, cexRow = labelSize, add.expr = {\n           abline(v = (linePosition + 0.5), lwd = 1, col = \"black\")\n       }) at HuEx_genePlot.R#320\n3: geneHeatmap(clusterID, dataset$datasetName, 1, outputDir, \"PDF\", \n       linePosition, dataC) at HuEx_genePlot.R#230\n2: genePlot.tID(clusterList, ID, \"/home/rboettcher/Desktop/EPCATplot/unannotated/\", \n       data, linePosition, trFit) at EPCATfunctions.R#731\n1: meta.EPCATs(datasets, affyLevels, datashort)\n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13175736,"title":"Why does a PDF plot in ggplot2 not show title nor labels?","body":"<p>I'm creating a simple step plot using ggplot2. If I switch the file type from PNG to PDF the plot does not show labels, ticks nor a title or a legend. What I'm doing wrong?</p>\n\n<p>Data:</p>\n\n<pre><code>plotData &lt;- structure(list(iteration = c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L), time = c(0L, 10L, \n20L, 30L, 40L, 50L, 60L, 70L, 80L, 90L, 100L, 0L, 10L, 20L, 30L, \n40L, 50L, 60L, 70L), routes = c(6L, 6L, 5L, 3L, 3L, 3L, 3L, 3L, \n2L, 1L, 0L, 5L, 5L, 5L, 5L, 1L, 1L, 1L, 0L)), .Names = c(\"iteration\", \n\"time\", \"routes\"), class = \"data.frame\", row.names = c(NA, -19L\n))\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>    library(ggplot2)\n    x_axis_breaks &lt;- seq(10, 100, by = 10)\n\n    png(file=\"plot.png\",width=1280, height=1280)\n    ## pdf(file=\"plot.pdf\",width=6,height=6)\n    plot &lt;- ggplot(plotData) + geom_step(data=plotData, size = 5, \n         mapping=aes(x=time,    \n         y=routes, group=iteration, colour=factor(iteration)), direction=\"vh\")\n    plot &lt;- plot + scale_x_discrete(breaks=x_axis_breaks, name=\"time\") + \n                   scale_y_discrete(name=\"#routes\");\n    plot &lt;- plot + opts(axis.text.x=theme_text(size=36,face=\"bold\"), \n                        axis.text.y=theme_text(size=36,face=\"bold\")) +\n                        scale_colour_hue(name=\"iteration\")\n    plot &lt;- plot + opts(legend.title=theme_text(size=36,face=\"bold\"), \n                        legend.text=theme_text(size=36,face=\"bold\"))\n    plot &lt;- plot + opts(axis.title.x=theme_text(size=36,face=\"bold\"),\n                        axis.title.y=theme_text(size=36,face=\"bold\"))\n    plot &lt;- plot + opts(title=\"network lifetime\", \n             plot.title=theme_text(size=36, face=\"bold\"))\n    print(plot)\n    dev.off()\n</code></pre>\n\n<p>The problem occurs if I'm switching from 'png...' to 'pdf'. The data itself is plotted fine. Maybe I'm just missing some information on generating PDF plots in ggplot2?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13176508,"title":"recode NA in factors","body":"<p>I've got a data frame containing groups of sample points:</p>\n\n<pre><code>samplePoint&lt;-c(\"1\",\"1\",\"1\",\"1\",\"2\",\"2\",\"2\",\"2\",\"3\",\"3\",\"3\",\"3\")\ncategory&lt;-c(\"a\", \"a\", \"a\", NA, \"b\", \"b\", NA, \"b\", NA, \"a\", \"a\", \"a\")\nvalues&lt;-c(0.51, 0.21, 0.31, 0.22, 0.61, 0.71, 0.52, 0.32, 0.23, 0.1, 0.24, 0.33)\ndat&lt;-data.frame(samplePoint, category, values)\n</code></pre>\n\n<p>I need to recode the NAs in dat$category for something later on in the process. Each sample point will only have one category: 1 should all be \"a\", 2 = \"b\" and 3 =\"a\".</p>\n\n<p>I've tried aggregate using an ifelse function, intending to recode using a match or lookup type function:</p>\n\n<pre><code>codeList&lt;-aggregate(\ndat$category, by=list(dat$samplePoint),\nFUN=function(x){ifelse(length(which(x==\"a\")) &gt; length(which(x==\"b\")), \"a\", \"b\")}\n)\n</code></pre>\n\n<p>Question 1 is, how do I tackle the matching?\nQuestion 2 is have I totally overcomplicated the whole thing?</p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":192,"score":0,"question_id":8852038,"title":"VAR(1) with DLM package Maximum Likelihood estimation","body":"<p>I'm trying to write a VAR(1) in DLM form, and I'm using this code:</p>\n\n<p>y is a 200x3 matrix</p>\n\n<pre><code>build &lt;- function(u) {dlm(m0=c(y[1,]),\nC0=1*diag(3),\nFF=diag(3),V=diag(c(1e-3,1e-3,1e-3)), \nGG= matrix(c(u[1:9]), ncol=3), \nW=matrix(c (exp(u[10]),u[11],u[12],u[11], exp(u[13]),u[14],u[12],u[14], exp(u[15]) ),ncol=3))}\n\ninit &lt;- rep(0,15)\noutMLE &lt;- dlmMLE(y,init, build)\n</code></pre>\n\n<p>R can't calculate the dlmMLE and reports: \"W is not a valid variance matrix\". </p>\n\n<p>I would appreciate any suggestions, thanks.</p>\n"},{"tags":["r","knitr"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":13177030,"title":"Make output of *apply look pretty","body":"<p>I have the following line</p>\n\n<pre><code>apply(wrld_simpl@data, 1, FUN=function(x) sum(is.na(x)))\n</code></pre>\n\n<p>which gives the following output</p>\n\n<pre><code> ATG DZA AZE ALB ARM AGO ASM ARG AUS BHR BRB BMU BHS BGD BLZ BIH BOL MMR \n  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 \nBEN SLB BRA BGR BRN CAN KHM LKA COG COD BDI CHN AFG BTN CHL CYM CMR TCD \n 0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 \n</code></pre>\n\n<p>and so on. I know that counting the NA's for this data set doesn't make a whole lot of sense, but once I merged this data with a 'home grown' data set it it more meaningful and my challenge remains the same. The latter two questions arise as I want to put this into a report for which I use knitr:</p>\n\n<ol>\n<li><p>Can I produce this output in a cross table for all variables, meaning the countries in the left column and some variables (e.g. wrld_simpl@data[6:11]) as headers?</p></li>\n<li><p>How to exchange the country code with the country name (wrld_simpl@data$NAME) as not every reader knows the codes well?</p></li>\n<li><p>How can I put the output into a pretty table (borders, headers, label)?</p></li>\n</ol>\n\n<p>Any pointers are appreciated!</p>\n\n<p>Thank you!</p>\n"},{"tags":["r","timestamp","gregorian-calendar"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":13175345,"title":"Creating a single timestamp from separate DAY OF YEAR, Year and Time columns in R","body":"<p>I have a time series dataset for several meteorological variables. The time data is logged in three separate columns:</p>\n\n<ol>\n<li>Year (e.g. 2012) </li>\n<li>Day of year (e.g. 261 representing 17-September in a Leap Year) </li>\n<li>Hrs:Mins (e.g. 1610)</li>\n</ol>\n\n<p>Is there a way I can merge the three columns to create a single timestamp in R? I'm not very familiar with how R deals with the Day of Year variable. </p>\n\n<p>Thanks for any help with this!</p>\n"},{"tags":["r","deployment","usb","portable-applications"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":67,"score":4,"question_id":13168701,"title":"Deploy R script in a portable usb form","body":"<p>I have an R script which I want to deploy so that it's idiot-proof, one click runs it etc. Unfortunately I don't have the means to pay for a server, and the environment in which it needs to run does not allow the installation of new software, only portable style apps can be run. (School computers) My script also relies on several non-base packages.</p>\n\n<p>Is there any way to deploy R and my script in an easy to run way so it can be used off a usb stick?</p>\n"},{"tags":["r","genetic-algorithm","rbga"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13174729,"title":"\"subscript out of bounds\" using rbga in R","body":"<p>I am using rbga in R, and the following error occurs during what seems to be the part of the function that applies elitism. Here is the session leading up to the error:</p>\n\n<pre><code>Testing the sanity of parameters...\nThe start conditions:\nGA Settings\n  Type                  = \n  Population size       = 10\n  Number of Generations = 10\n  Elitism               = 2\n  Mutation Chance       = 0.00237529691211401\n\nSearch Domain\n  Var 1 = [-0.1,0.1]\n  Var 2 = [-0.1,0.1]\n  Var 3 = [-0.1,0.1]\n\nStarting with random values in the given domains...\nStarting iteration 1 \nCalucating evaluation values... .......... done.\nCreating next generation...\n  sorting results...\n  applying elitism...\nError: subscript out of bounds\n</code></pre>\n\n<p>Unfortunately, I can't provide a reproducible example as my code consists of around 300 lines, and I can't seem to create simplified version. Has anyone experienced a similar issue when using rbga, and can anyone give me any pointers on why this could be happening ?</p>\n\n<p><strong>Update</strong></p>\n\n<p>I have found the line of code in the rbga function that is causing the error:</p>\n\n<pre><code>newPopulation[1:elitism, ] = sortedPopulation[1:elitism, ]\n</code></pre>\n\n<p>The length of sortedPopulation at this point is 0, while elitism is 2 ... anyone have any ideas ?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":108,"score":8,"question_id":13123638,"title":"There is pmin and pmax each taking na.rm, why no psum?","body":"<p>It seems that R might be missing an obvious simple function: <code>psum</code>. Does it exist as a different name, or is it in a package somewhere?</p>\n\n<pre><code>x = c(1,3,NA,5)\ny = c(2,NA,4,1)\n\nmin(x,y,na.rm=TRUE)    # ok\n[1] 1\nmax(x,y,na.rm=TRUE)    # ok\n[1] 5\nsum(x,y,na.rm=TRUE)    # ok\n[1] 16\n\npmin(x,y,na.rm=TRUE)   # ok\n[1] 1 3 4 1\npmax(x,y,na.rm=TRUE)   # ok\n[1] 2 3 4 5\npsum(x,y,na.rm=TRUE)\n[1] 3 3 4 6                             # expected result\nError: could not find function \"psum\"   # actual result\n</code></pre>\n\n<p>I realise that <code>+</code> is already like <code>psum</code>, but what about <code>NA</code>?   </p>\n\n<pre><code>x+y                      \n[1]  3 NA NA  6        # can't supply `na.rm=TRUE` to `+`\n</code></pre>\n\n<p>Is there a case to add <code>psum</code>?  Or have I missed something.</p>\n\n<p>This question is a follow up from this question :<br>\n<a href=\"http://stackoverflow.com/questions/13106645/using-in-data-table-to-sum-the-values-of-two-columns-in-r-ignoring-nas\">Using <code>:=</code> in data.table to sum the values of two columns in R, ignoring NAs</a></p>\n"},{"tags":["r","logical-operators"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13175719,"title":"Combine Logical Operators","body":"<p>I'm quite new to R and I have a simple question I just can't figure out a simple problem. \nI want to combine two logical Statements  i.e. I want to exclude two Columns from my analysis\nTo exclude only one value the code works fine and looks like this:</p>\n\n<p><code>df[ colnames(df) != \"Total.Population\", function(x){ x/df$Total.Population *1000 }</code></p>\n\n<p>So besides the population I also want to exclude the column Geocodes from my analysis. I tried a lot of diffrent stuff like</p>\n\n<p><code>df[ colnames(df) != \"Total.Population\"&amp;&amp;\"Geocodes\", function(x){ x/df$Total.Population *1000 }</code> </p>\n\n<p>but I just can't get it done to work for me...\nso any help would be great. Thx</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13175596,"title":"column wise clustering in R","body":"<p>I have the data matrix in the following way:</p>\n\n<pre><code>ID_REF GSM362180    GSM362181  GSM362188    GSM362189  GSM362192\n244901 5.094871713 4.626623079 4.554272515 4.748604391 4.759221647\n244902 5.194528083 4.985930299 4.817426064 5.151654407 4.838741605\n244903 5.412329253 5.352970877 5.06250609  5.305709079 8.365082403\n244904 5.529220594 5.28134657  5.467445095 5.62968933  5.458388909\n244905 5.024052699 4.714631878 4.792865831 4.843975286 4.657188246\n244906 5.786557533 5.242403911 5.060605782 5.458148567 5.890061836\n</code></pre>\n\n<p>I would like to cluster it column-wise to find out the similar promoters( columns represent the promoters and the rows - the genes). I used pv clust to do it earlier but would like to have a more detailed clustering ( maybe with hierarchial type ?). I would like to know how far the columns cluster together. I have in total 20 columns and 22810 genes. </p>\n"},{"tags":["r","package","data.frame","analysis","edge"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13174846,"title":"R edgeR package error","body":"<p>I have a question about the edgeR package in R. I have a dataframe and design matrix like below and every time i get the same error. Can anyone help me with the follow code and error?  Many thanks :)</p>\n\n<p>Greetz Lisanne </p>\n\n<pre><code>&gt;data.frame \n                   WT_SHAM1 WT_SHAM2 WT_SHAM3 WT_SHAM4 WT_SHAM5 WT_SHAM6 WT_CSD1 WT_CSD2 WT_CSD3 WT_CSD4 WT_CSD5 WT_CSD6 RQ_SHAM1 RQ_SHAM2 RQ_SHAM3 RQ_SHAM4 RQ_SHAM5 RQ_SHAM6 RQ_CSD1 RQ_CSD2 RQ_CSD3 RQ_CSD4\nENSMUSG00000002012      553     1167      660     1736      365      760     971     961     974    1790    1458    2843      556      871     1263     1142     1043     1919     969     794     771     682\nENSMUSG00000028182        2       11        3        8        2        8       1      10       3      39       5      19        1        5       34       13        1        3       8      13       5       1\nENSMUSG00000002017       26       50       50       42      100      140      29      31      41      69     147      99       20       43       74      135       63       92      55      44      23      68\nENSMUSG00000028184      381      664      442      762      476      653     618     376     353     806    1271    1938      381      306      859      687      249     1596     773     635     240     562\nENSMUSG00000002015      399      956      531     1725     1217     1111     668     928     350     549     828    2199      480      702     1611     1448      331      678    1199    1014     652     913\n\n&gt;design\n   (Intercept) strain CSD\n1            1      0   0\n2            1      0   0\n3            1      0   0\n4            1      0   0\n5            1      0   0\n6            1      0   0\n7            1      0   1\n8            1      0   1\n9            1      0   1\n10           1      0   1\n11           1      0   1\n12           1      0   1\n13           1      1   0\n14           1      1   0\n15           1      1   0\n16           1      1   0\n17           1      1   0\n18           1      1   0\n19           1      1   1\n20           1      1   1\n21           1      1   1\n22           1      1   1\n\n\n&gt;d &lt;- DGEList(data_files, lib.size=colSums(data_files))\nAn object of class \"DGEList\"\n$samples\n         group lib.size norm.factors\nWT_SHAM1     1  6154923            1\nWT_SHAM2     1 12269537            1\nWT_SHAM3     1  8785094            1\nWT_SHAM4     1 19878567            1\nWT_SHAM5     1 13420516            1\n17 more rows ...\n\n$counts\n                   WT_SHAM1 WT_SHAM2 WT_SHAM3 WT_SHAM4 WT_SHAM5 WT_SHAM6 WT_CSD1 WT_CSD2 WT_CSD3 WT_CSD4 WT_CSD5 WT_CSD6 RQ_SHAM1 RQ_SHAM2 RQ_SHAM3 RQ_SHAM4 RQ_SHAM5 RQ_SHAM6 RQ_CSD1 RQ_CSD2 RQ_CSD3 RQ_CSD4\nENSMUSG00000002012      553     1167      660     1736      365      760     971     961     974    1790    1458    2843      556      871     1263     1142     1043     1919     969     794     771     682\nENSMUSG00000028182        2       11        3        8        2        8       1      10       3      39       5      19        1        5       34       13        1        3       8      13       5       1\nENSMUSG00000002017       26       50       50       42      100      140      29      31      41      69     147      99       20       43       74      135       63       92      55      44      23      68\nENSMUSG00000028184      381      664      442      762      476      653     618     376     353     806    1271    1938      381      306      859      687      249     1596     773     635     240     562\nENSMUSG00000002015      399      956      531     1725     1217     1111     668     928     350     549     828    2199      480      702     1611     1448      331      678    1199    1014     652     913\n23841 more rows ...\n\n$all.zeros\nENSMUSG00000002012 ENSMUSG00000028182 ENSMUSG00000002017 ENSMUSG00000028184 ENSMUSG00000002015 \n             FALSE              FALSE              FALSE              FALSE              FALSE \n23841 more elements ...\n\n&gt;d &lt;- calcNormFactors(d)\nAn object of class \"DGEList\"\n$samples\n         group lib.size norm.factors\nWT_SHAM1     1  6154923    0.9765708\nWT_SHAM2     1 12269537    0.9914651\nWT_SHAM3     1  8785094    0.9693995\nWT_SHAM4     1 19878567    0.9193010\nWT_SHAM5     1 13420516    1.0142604\n17 more rows ...\n\n$counts\n                   WT_SHAM1 WT_SHAM2 WT_SHAM3 WT_SHAM4 WT_SHAM5 WT_SHAM6 WT_CSD1 WT_CSD2 WT_CSD3 WT_CSD4 WT_CSD5 WT_CSD6 RQ_SHAM1 RQ_SHAM2 RQ_SHAM3 RQ_SHAM4 RQ_SHAM5 RQ_SHAM6 RQ_CSD1 RQ_CSD2 RQ_CSD3 RQ_CSD4\nENSMUSG00000002012      553     1167      660     1736      365      760     971     961     974    1790    1458    2843      556      871     1263     1142     1043     1919     969     794     771     682\nENSMUSG00000028182        2       11        3        8        2        8       1      10       3      39       5      19        1        5       34       13        1        3       8      13       5       1\nENSMUSG00000002017       26       50       50       42      100      140      29      31      41      69     147      99       20       43       74      135       63       92      55      44      23      68\nENSMUSG00000028184      381      664      442      762      476      653     618     376     353     806    1271    1938      381      306      859      687      249     1596     773     635     240     562\nENSMUSG00000002015      399      956      531     1725     1217     1111     668     928     350     549     828    2199      480      702     1611     1448      331      678    1199    1014     652     913\n23841 more rows ...\n\n$all.zeros\nENSMUSG00000002012 ENSMUSG00000028182 ENSMUSG00000002017 ENSMUSG00000028184 ENSMUSG00000002015 \n             FALSE              FALSE              FALSE              FALSE              FALSE \n23841 more elements ...\n\n\n&gt;d &lt;- estimateGLMCommonDisp(d, design=design)\n$common.dispersion\n[1] 0.2005023\n\n&gt; d &lt;- estimateGLMTrendedDisp(d, design=design)\nError in cutWithMinN(abundance[!all.zero], intervals = nbins, min.n = min.n) : \n  function has failed, perhaps because of too many tied values?\n</code></pre>\n"},{"tags":["r","github"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13173395,"title":"raw github token value in url R github api","body":"<p>How does one programatically get the <code>raw.github.com</code> token value in the url when looking at the raw option on the webste. I.e can you get that token value from the <code>api.github.com</code> api provided?</p>\n\n<p>What I am in reference to is the same as what was asked a long time ago in this question <a href=\"http://stackoverflow.com/questions/9088557/download-github-raw-source-file-by-url\">download github raw source file by url</a>\nhowever the token now seems to change daily and is different for each file.</p>\n\n<p>The other method I could use would be to directly use the api...however the content is that is downloaded is often encoded in bas64 and due to the original having some \"special characters\" its is difficult to decode...or it doesn't always decode correctly.</p>\n\n<p>I am currently using httr to access the github api...but do not seem to be able to access the actual content of the individual files/(not a whole package) i want to download...</p>\n"},{"tags":["r","data.frame","na"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13172711,"title":"Replace NA values from a column with 0 in data frame R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/10139284/set-na-to-0-in-r\">Set NA to 0 in R</a>  </p>\n</blockquote>\n\n\n\n<p>I have a data.frame with a column having <code>NA</code> values. I want to replace <code>NA</code> with <code>0</code> or any other value. I have tried a lot of threads and methods but it did not give me the result. I have tried the below methods.</p>\n\n<pre><code>a$x[a$x==NA]&lt;-0;\na[,c(\"x\")]&lt;-apply(a[,c(\"x\")],1,function(z){replace(z, is.na(z), 0)});\na$x[is.na(a$x),]&lt;-0;\n</code></pre>\n\n<p>None of the above methods replaced <code>NA</code> with 0 in column <code>x</code> for data.frame <code>a</code>. Why?</p>\n"},{"tags":["r","date","plot"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12006994,"title":"How to plot incidence over parts of a date in R?","body":"<p>I have data in a .csv file showing enquiries received by different teams on different dates. Enquiries are entered as follows:</p>\n\n<pre><code>Team,Date_received,Date_answered\nTeam 1,31/01/10,05/02/10\nTeam 3,05/03/10,17/04/10\n...\n</code></pre>\n\n<p>I want to plot a graph showing how many enquiries each team received over each of the last six months but I'm new to R and getting nowhere fast. I've looked up time series documentation (in O'Reilly's R in a Nutshell) but it seems to be much more complex than what I need.</p>\n\n<p>So far I've read in the data and converted the date strings into POSIXlt as follows:</p>\n\n<pre><code>c_data &lt;- read.table(\"~/data.csv\", header=T, sep=\",\")\nc_data$Date_received &lt;- as.Date(c_data$Date_received, \"%d/%m/%y\")\nc_data &lt;- as.POSIXlt(c_data$Date_received)\n...\n</code></pre>\n\n<p>but from there I'm lost. What I want to do is extract the month from the POSIXlt field, count the incidence of each 'Team' string in each month and plot them against each other, but I don't know which functions handle those things and I'm struggling with the docs.</p>\n\n<p>I know I'm at early stages here so even just a pointer to the function I should be reading about would be appreciated.</p>\n"},{"tags":["r","if-statement","syntactic-sugar","rcpp","which"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":124,"score":3,"question_id":11206085,"title":"Efficient subsetting in Rcpp (equivalent of the R \"which\" command)","body":"<p>In Rcpp, there are various \"Rcpp sugar\" commands that permit nice vectorised operations in the code. In the code below I move across a data frame, break it into vectors, then use the \"ifelse\" and \"sum\" sugar commands to compute the mean of v over the rows where x equals either y or y+1. All seems to work correctly.</p>\n\n<p><strong>Just wondering if there is a neater way than this - e.g. an equivalent of the \"which\" command that gives index points satisfying a particular condition?</strong> There seems to be a facility available as \"find\" in Armadillo but that means using incompatible object types (you can't use \"find\" and \"ifelse\" together).</p>\n\n<p>On the same topic, <strong>is it possible to get \"ifelse\" to accept a compound logical condition?</strong> In the example below, for instance, the definition of indic is formed of two \"ifelse\" commands, and it would obviously be cleaner as one. Any thoughts would be much appreciated.</p>\n\n<p>Look forward to hearing your responses :)</p>\n\n<pre><code>require(Rcpp)\nrequire(inline)\n\nset.seed(42)\ndf = data.frame(x = rpois(1000,3), y = rpois(1000,3), v = rnorm(1000),\n                stringsAsFactors=FALSE)\n\nmyfunc1 = cxxfunction(\n    signature(DF = \"data.frame\"),\n    plugin = \"Rcpp\",\n    body = '\n            using namespace Rcpp;\n            DataFrame df(DF);\n            IntegerVector x = df[\"x\"];\n            IntegerVector y = df[\"y\"];\n            NumericVector v = df[\"v\"];\n\n            LogicalVector indic = ifelse(x==y,true,ifelse(x==y+1,true,false));\n            double subsum = sum(ifelse(indic,v,0));\n            int subsize = sum(indic);\n            double mn = ((subsize&gt;0) ? subsum/subsize : 0.0);\n\n            return(Rcpp::List::create(_[\"subsize\"] = subsize, \n                                      _[\"submean\"] = mn\n                                     ));\n            '\n            )\n\nmyfunc1(df)\n\n### OUTPUT:\n# \n# $subsize\n# [1] 300\n# \n# $submean\n# [1] 0.1091555\n# \n</code></pre>\n"},{"tags":["r","tcl","tk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13172449,"title":"Adding a GIF image to a TclTk window","body":"<p>I wish to insert a 'loading' GIF image to my tcltk window but just can't get my head around it. Following is a reproducible example:-</p>\n\n<pre><code>backg &lt;- 'white'\npdlg &lt;- tktoplevel(background=backg)\ntcl('wm', 'geometry', pdlg, '500x100+450+350')\ntilg &lt;- 'Package installation in progress'\ntkwm.title(pdlg, tilg)\nfn &lt;- tkfont.create(family = 'helvetica', size = 12)\n\nnwlabel &lt;- \"    The requisite packages are being installed. This may take several    \\nminutes... \\n\"\ntllab &lt;- tklabel(pdlg, text = nwlabel, font = fn, pady = 0, background=backg)\n\nclickEv &lt;- tclVar(0)\n\nOK.but &lt;- tkbutton(pdlg, text=' Stop ', command=function() tclvalue(clickEv) &lt;- 1, font=fn, background='grey', pady=0)\n\ntkgrid(tllab, columnspan=1) \ntkgrid(OK.but, row=3)\n\ntkbind(pdlg, \"&lt;Destroy&gt;\", function() tclvalue(done) &lt;- 2)\ntkfocus(pdlg)\n\n#This allows me to insert a GIF image but the animation is lost. Also it would be convenient if the output can be obtained using 'tkgrid' instead of 'tkpack'\npdlg2 &lt;- tktoplevel(background='white')\nloading &lt;- tclVar()\ntcl('image', 'create', 'photo', loading,\nfile='file path to GIF file')\ntrial &lt;- tklabel(pdlg2, image=loading)\ntkpack(trial)\n</code></pre>\n\n<p>An example GIF file can be downloaded from here -http://www.dlfpramericalife.com/library/images/final_loading_big.gif</p>\n\n<p>Ideally, the GIF image should be placed above the 'Stop' button but below the text. Many thanks for your help!</p>\n"},{"tags":["r","time-series","zoo"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":44,"score":-1,"question_id":13164056,"title":"Performing calculations on a zoo time-series based on calculations of previous time-steps","body":"<p>I have a zoo object (\"depth_series\") like this:</p>\n\n<pre>\n\n    <code>\n                           m_t   depth20  depth10  \n    2008-02-24 17:20:00   50000 -125.368 -20.873 \n    2008-02-24 17:22:00   50002 -136.476 -20.983 \n    2008-02-24 17:24:00   50004 -145.583 -21.983 \n    2008-02-24 17:26:00   50006 -115.583 -27.983 \n    2008-02-24 17:28:00   50008 -175.583 -21.983 \n    2008-02-24 17:30:00   50010 -115.368 -24.763 \n    </code></pre>\n\n<p>I need to perform calculation on \"depth10\" and \"depth20\" columns to generate a zoo object with columns \"flux10\" and \"flux20\" such that: </p>\n\n<pre><code>flux10[t] = depth10*depth20 - flux10[t-1]\n</code></pre>\n\n<p>Where, t and t-1 represents values at adjacent time steps.  </p>\n\n<p>How do I perform calculations based on previous time-step from the same column. I am trying to convert this from an excel sheet to a R code.</p>\n"},{"tags":["r","inequality"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13170820,"title":"R inequality operator error?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2769510/numeric-comparison-difficulty-in-r\">Numeric comparison difficulty in R</a>  </p>\n</blockquote>\n\n\n\n<p>I'm using R 2.15.2 and found something like an unusual but serious error in R inequality operator.</p>\n\n<pre><code>&gt; 0.015 -0.005 \n[1] 0.01\n&gt; 0.015 - 0.005 == 0.01\n[1] FALSE\n&gt; 0.025 - 0.005 == 0.02\n[1] TRUE\n</code></pre>\n\n<p>Is this possible? </p>\n\n<p>it only happens when I compare <code>0.015 - 0.005</code> with <code>0.01</code>.</p>\n\n<p>Any ideas?</p>\n\n<p>Try this with your computer and see this really happens!</p>\n\n<p>Thanks, then what should I do wit inequality?</p>\n\n<pre><code>&gt; 0.015 - 0.005 &lt; 0.01 \n[1] TRUE \n&gt; 0.025 - 0.005 &lt; 0.02 \n[1] FALSE \n&gt; \n</code></pre>\n"},{"tags":["r","excel","import","merge","import-from-excel"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13169823,"title":"R - Import & Merge Multiple Excel Files And Add Filesource Variable","body":"<p>I have used R for various things over the past year but due to the number of packages and functions available, I am still sadly a beginner. I believe R would allow me to do what I want to do with minimal code, but I am struggling.</p>\n\n<h3>What I want to do:</h3>\n\n<p>I have roughly a hundred different excel files containing data on students. Each excel file represents a different school but contains the same variables. I need to:<br /></p>\n\n<blockquote>\n  <ol>\n  <li>Import the data into R from Excel<br /></li>\n  <li>Add a variable to each file containing the filename<br /></li>\n  <li>Merge all of the data <em>(add observations/rows - do not need to match on variables)</em></li>\n  </ol>\n</blockquote>\n\n<p>I will need to do this for multiple sets of data, so I am trying to make this as simple and easy to replicate as possible.</p>\n\n<h3>What the Data Look Like:</h3>\n\n<blockquote>\n  <p><strong>Row 1</strong>&nbsp; &nbsp; Title<br>\n  <strong>Row 2</strong>&nbsp; &nbsp; <em>StudentID&nbsp; &nbsp; Var1&nbsp; &nbsp; Var2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &nbsp; Var3&nbsp; &nbsp; &nbsp; Var4&nbsp; &nbsp; &nbsp; &nbsp; Var5</em><br />\n  <strong>Row 3</strong>&nbsp; &nbsp; 11234 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1&nbsp; &nbsp;  &nbsp; &nbsp; &nbsp;9/8/2011&nbsp; &nbsp; &nbsp; 343&nbsp; &nbsp; &nbsp; 159-167&nbsp; &nbsp; &nbsp; 32<br />\n  <strong>Row 4</strong>&nbsp; &nbsp; 11235 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9/16/2011&nbsp; &nbsp; 112&nbsp; &nbsp; &nbsp; 152-160&nbsp; &nbsp; &nbsp; 12<br />\n  <strong>Row 5</strong>&nbsp; &nbsp; 11236 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9/8/2011&nbsp; &nbsp; &nbsp; 325&nbsp; &nbsp; &nbsp; 164-171&nbsp; &nbsp; &nbsp; 44</p>\n</blockquote>\n\n<p>Row 1 is meaningless and Row 2 contains the variable names. The files have different numbers of rows.</p>\n\n<h3>What I have so far:</h3>\n\n<p>At first I simply tried to import data from excel. Using the XLSX package, this works nicely:</p>\n\n<pre><code>dat &lt;- read.xlsx2(\"FILENAME.xlsx\", sheetIndex=1, \n                  sheetName=NULL, startRow=2, \n                  endRow=NULL, as.data.frame=TRUE, \n                  header=TRUE)\n</code></pre>\n\n<p>Next, I focused on figuring out how to merge the files (also thought this is where I should add the filename variable to the datafiles). This is where I got stuck. </p>\n\n<pre><code>setwd(\"FILE_PATH_TO_EXCEL_DIRECTORY\")\nfilenames &lt;- list.files(pattern=\".xls\")\ndo.call(\"rbind\", lapply(filenames, read.xlsx2, sheetIndex=1, colIndex=6, header=TRUE, startrow=2, FILENAMEVAR=filenames));\n</code></pre>\n\n<p>I set my directory, make a list of all the excel file names in the folder, and then try to merge them in one statement using the a variable for the filenames.</p>\n\n<p>When I do this I get the following error:</p>\n\n<blockquote>\n  <p>Error in data.frame(res, ...) : \n   arguments imply differing number of rows: 616, 1, 5</p>\n</blockquote>\n\n<p>I know there is a problem with my application of lapply - the startrow is not being recognized as an option and the FILENAMEVAR is trying to merge the list of 5 sample filenames as opposed to adding a column containing the filename.</p>\n\n<h3>What next?</h3>\n\n<p>If anyone can refer me to a useful resource or function, critique what I have so far, or point me in a new direction, it would be GREATLY appreciated!</p>\n"},{"tags":["r","ggplot2","data-visualization","hexagonal-tiles"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":13167531,"title":"ggplot2 multiple stat_binhex() plots with different color gradients in one image","body":"<p>I'd like to use ggplot2's stat_binhex() to simultaneously plot two independent variables on the same chart, each with its own color gradient using scale_colour_gradientn(). </p>\n\n<p>If we disregard the fact that the x-axis units do not match, a reproducible example would be to plot the following in the same image while maintaining separate fill gradients.</p>\n\n<pre><code>d &lt;- ggplot(diamonds, aes(x=carat,y=price))+\n  stat_binhex(colour=\"white\",na.rm=TRUE)+\n  scale_fill_gradientn(colours=c(\"white\",\"blue\"),name = \"Frequency\",na.value=NA)\ntry(ggsave(plot=d,filename=&lt;some file&gt;,height=6,width=8))\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/GLq7G.png\" alt=\"enter image description here\"></p>\n\n<pre><code>d &lt;- ggplot(diamonds, aes(x=depth,y=price))+\n  stat_binhex(colour=\"white\",na.rm=TRUE)+\n  scale_fill_gradientn(colours=c(\"yellow\",\"black\"),name = \"Frequency\",na.value=NA)\ntry(ggsave(plot=d,filename=&lt;some other file&gt;,height=6,width=8))\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/pBKTP.png\" alt=\"enter image description here\"></p>\n\n<p>I found some conversation of a related issue in ggplot2 google groups <a href=\"https://github.com/hadley/ggplot2/issues/578\" rel=\"nofollow\">here</a>.</p>\n"},{"tags":["r","twitter"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13170279,"title":"twitteR cannot connect to host","body":"<p>I am using twitteR package to get data from twitter</p>\n\n<pre><code>delta.tweets=searchTwitter(\"@delta\",n=1500)\n</code></pre>\n\n<p>but it gives me the erro message:</p>\n\n<blockquote>\n  <p>couldn't connect to host</p>\n</blockquote>\n\n<p>Does anybody know how to solve this qusetion ?</p>\n"},{"tags":["r","time-series","zoo"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13170097,"title":"avoiding for loops when generating lagged variables in R (and using zoo)","body":"<p>I'm generating a large amount of lagged variables (365, actually) for a time series with 79,000 observations.  </p>\n\n<p>I currently have a column in a dataframe <code>OrdersData</code> called <code>prospectdrop</code>s.  I first convert it to <code>zoo</code> format to use the <code>lag()</code> function:</p>\n\n<pre><code>prospectdrops&lt;-zoo(OrdersData$prospectdrop)\n</code></pre>\n\n<p>then I execute the for loop:</p>\n\n<pre><code>for (i in 1:365){\n  prospectdrops[paste(\"lag\",i,\"day\",sep=\"\")] &lt;- lag(prospectdrops,i*24,na.pad=TRUE)\n}\n</code></pre>\n\n<p>then I'm forced to loop again using cbind to bind them to prepare them for data.frame()</p>\n\n<pre><code>for (i in 1:365){\ncbind(prospectdrops, prospectdrops[paste(\"lag\",i,\"day\",sep=\"\")])\n}\n</code></pre>\n\n<p>Understandably, this takes forever with the for loop function in R.  I know that \"apply\" could be the answer, but don't see a direct comparator in the descriptions of the functions.  Any ideas?</p>\n"},{"tags":["r","github","github-api","httr"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13169305,"title":"httr github-API callback URL issues","body":"<p>I am using the <code>httr</code> v0.2 package to use the github api as well now. But I am struggling to get past the <code>oauth2.0(...)</code> part in which I get to the browser page for my app, click on 'Allow' and then get redirected to the callback URL page. </p>\n\n<p>The httr github demo suggests using the callback URL as <code>http://localhost:1410</code> but when I get redirected to that page, google chrome suggests that it could not connect to the page and the page it is getting re-directed to is <code>http://localhost:1410/?error=redirect_uri_mismatch&amp;state=DZNFcm8tnq</code>...so I tried a bunch of other ports and overall URLS to no success...</p>\n\n<p>What would be another callback URL and URL that would work?</p>\n\n<p>below is the code I used</p>\n\n<pre><code>require(httr)\n## Loading required package: httr\ngithub.app &lt;- oauth_app(\"github\",\"xxxxx\", \"xxxxxxxxxxxxxxx\")\ngithub.urls &lt;- oauth_endpoint(NULL, \"authorize\", \"access_token\",base_url = \"https://github.com/login/oauth\")\ngithub.token &lt;- oauth2.0_token(github.urls,github.app)\n## Loading required package: Rook\n## Loading required package: tools\n## Loading required package: brew\n## starting httpd help server ... done\n## Waiting for authentication in browser...\n</code></pre>\n\n<p>which is when I get directed to a page that has the 'Allow' button whichIi click after which I get redirected to the page in google chrome that cannot connect to localhost :1410</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13169318,"title":"R: creating vectors of latin/greek expression for plot titles, axis labels, or legends","body":"<p>I would like to merge vectors of Latin and Greek text to generate plot titles, axis labels, legend entries, etc. I have provided a trivial example below. I cannot figure out how to render the Greek letters in their native form. I have tried various combinations of <code>expression</code>, <code>parse</code>, and <code>apply</code> to the <code>paste</code> command but I have not been able to vectorize the code that readily generates mixed Latin/Greek text for the case of a single expression (e.g., <code>expression(\"A (\"*alpha*\")\")</code> is suitable in the case of a single expression).</p>\n\n<pre><code>data&lt;-matrix(seq(20),nrow=5,ncol=4,byrow=TRUE)\ncolnames(data)&lt;-c(\"A\",\"B\",\"C\",\"D\")\ngreek&lt;-c(\" (alpha)\",\" (beta)\",\" (gamma)\",\" (delta)\")\nmatplot(data)\nlegend(1,max(data),fill=c(\"black\",\"red\",\"green\",\"blue\"),apply(matrix(paste(colnames(data),greek,sep=\"\"),nrow=4,ncol=1),1,expression))\n</code></pre>\n\n<p>Could you please help me with the <code>apply()</code> statement within the <code>legend()</code> statement? It requires some modification to produce the desired output (i.e., A (α), B(β), C(γ), D(δ)). Thanks in advance.</p>\n"},{"tags":["r","data.table"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":74,"score":4,"question_id":13076509,"title":"Why error from na.omit after running scale in R in data.table?","body":"<p>I had asked this question earlier and thought I might post an example that shows why I was seeing the effect, in the event that it might be helpful:</p>\n\n<pre><code>require(data.table)\nx &lt;- data.table(a=1:10)\nx[,a:=scale(a)]\n#    [,1]      \n# 1: -1.4863011\n# 2: -1.1560120\n# 3: -0.8257228\n# 4: -0.4954337\n# 5: -0.1651446\n# 6:  0.1651446\n# 7:  0.4954337\n# 8:  0.8257228\n# 9:  1.1560120\n#10:  1.4863011\nna.omit(x)\nError in `[.data.table`(object, !omit) : \n  i is invalid type (matrix). Perhaps in future a 2 column matrix could return a list     of elements of DT (in the spirit of A[B] in FAQ 2.14). Please let datatable-help know if     you'd like this, or add your comments to FR #1611.\n</code></pre>\n\n<p>The reason seems to be that <code>scale</code> does not return a <code>vector</code> and <code>data.table</code> did not complain.  Doing <code>x[,a:=as.vector(scale(a))]</code> instead appears to fix the issue. Have I missed something in the documentation?</p>\n"},{"tags":["r","plot","spatial","raster"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":123,"score":2,"question_id":13005181,"title":"R: how to set the display bounds of a raster::plot?","body":"<h1>summary</h1>\n\n<p>How to limit display of an R <code>raster::plot</code> to the bounds of a Raster* object? Why I ask:</p>\n\n<p>I'm an R beginner who must</p>\n\n<ol>\n<li>convert unprojected (lon-lat) global spatial data from ASCII to <a href=\"http://en.wikipedia.org/wiki/Netcdf\" rel=\"nofollow\">netCDF</a> (solved)</li>\n<li>\"regrid\" it: i.e., restricted the data to a region, project it, and downscale (decrease the size of the gridcells) it (mostly solved)</li>\n</ol>\n\n<p>Unfortunately, in scientific work, one mostly QAs data transformations such as this by visual inspection. Step 1 above looks good. But though step 2 now looks much better, I really want to plot <strong>only</strong> the bounds (or <code>extents</code>) of the regridded <code>RasterLayer</code>. I have R code driven by bash scripts in a public git repository (<a href=\"https://github.com/TomRoche/GEIA_to_netCDF\" rel=\"nofollow\">here</a>) that does the conversion step, and plots the converted output, <a href=\"http://i.stack.imgur.com/SOmvZ.png\" rel=\"nofollow\">apparently correctly</a>. However my attempts to plot the output of the regridding with <code>raster::plot</code> are not quite right (see first 3 pages of output <a href=\"https://github.com/downloads/TomRoche/GEIA_to_netCDF/GEIA_N2O_oceanic_regrid.pdf\" rel=\"nofollow\">here</a>).</p>\n\n<p>How to fix?</p>\n\n<h1>details</h1>\n\n<h2>background</h2>\n\n<p>I need to take some data (a global marine emissions inventory (EI)), combine it with other data (mostly other EIs), and input that to a model. The model wants to consume netCDF, and it wants that netCDF over a spatial domain slightly bigger than the contiguous US (CONUS). The borders of this image <img src=\"https://github.com/TomRoche/cornbeltN2O/wiki/images/Cmaq_aqmeii_domain.png\" alt=\"AQMEII-NA domain\"> are the boundaries of the domain. (Note that part, but only part, of the domain is oceanic.) The model also wants that netCDF projected a certain way (<a href=\"http://en.wikipedia.org/wiki/Lambert_conformal_conic\" rel=\"nofollow\">LCC</a> at 12-km resolution). I'm treating this as 2 independent problems:</p>\n\n<ol>\n<li>convert the global EI from its native ASCII format to netCDF</li>\n<li>\"regrid\" the netCDF from global/unprojected to the downscaled (finer-resolution), projected subdomain.</li>\n</ol>\n\n<p>I'm attempting to solve these problems with code I have archived at <a href=\"https://github.com/TomRoche/GEIA_to_NetCDF\" rel=\"nofollow\">this public git repository</a>. If you clone that git repo, and then configure/run the bash driver <code>GEIA_to_netCDF.sh</code> as described for the \"first example\" <a href=\"https://github.com/TomRoche/GEIA_to_netCDF/blob/master/README.md\" rel=\"nofollow\">in the README</a> (and presuming your R is appropriately configured, notably with packages=<code>raster</code>, <code>ncdf4</code>) it will output netCDF and plot (using <code>fields::image.plot</code>) that output to a <a href=\"https://github.com/downloads/TomRoche/GEIA_to_netCDF/GEIA_N2O_oceanic.pdf\" rel=\"nofollow\">PDF</a>, which should look like this: <img src=\"https://github.com/downloads/TomRoche/GEIA_to_netCDF/GEIA_N2O_oceanic.png\" alt=\"GEIA global marine emissions\">. The distribution of the output data appears correct, so problem 1 seems solved.</p>\n\n<h2>problem</h2>\n\n<p>Solving problem 2 (aka the \"second example\" <a href=\"https://github.com/TomRoche/GEIA_to_netCDF/blob/master/README.md\" rel=\"nofollow\">in the README</a>) seems to require R package=<code>raster</code>. My bash driver <a href=\"https://github.com/TomRoche/GEIA_to_netCDF/blob/master/regrid_GEIA_netCDF.sh\" rel=\"nofollow\"><code>regrid_GEIA_netCDF.sh</code></a> calls <a href=\"https://github.com/TomRoche/GEIA_to_netCDF/blob/master/regrid.global.to.AQMEII.r\" rel=\"nofollow\"><code>regrid.global.to.AQMEII.r</code></a> (both <a href=\"https://github.com/TomRoche/GEIA_to_NetCDF\" rel=\"nofollow\">in repository</a>), which runs without error, and displays a PDF of its output. <a href=\"https://github.com/downloads/TomRoche/GEIA_to_netCDF/GEIA_N2O_oceanic_regrid.pdf\" rel=\"nofollow\"><code>GEIA_N2O_oceanic_regrid.pdf</code></a> comprises 4 pages, corresponding to 4 blocks of code at the end of <code>regrid.global.to.AQMEII.r</code>. Only the first 3 pages are relevant here (the 4th page tries to use <code>fields::image.plot</code> and has bigger problems).</p>\n\n<p>Page=1/4 results from a simple <code>raster::plot</code> of the regridded output, plus a projected version of a CONUS map from <code>wrld_simpl</code>:</p>\n\n<pre><code>plot(out.raster)\nplot(map.us.proj, add=TRUE)\n</code></pre>\n\n<p>Unfortunately the output appears global, or nearly so: <img src=\"http://i.stack.imgur.com/XLIZk.png\" alt=\"raster::plot bounds problem\"> But the desired domain, to which the output was regridded, is much smaller: <img src=\"https://github.com/TomRoche/cornbeltN2O/wiki/images/Cmaq_aqmeii_domain.png\" alt=\"AQMEII-NA domain\">. So I have 3 questions (1 main question, 2 followups):</p>\n\n<ol>\n<li>Does the image displayed by <code>raster::plot</code> by default display <em>only</em> the extents of the <code>RasterLayer</code> given in its arguments?</li>\n<li>If so, what is wrong with my regrid? (more below)</li>\n<li>If not (i.e., if <code>raster::plot</code> by default displays <em>more</em> than the extents of its <code>RasterLayer</code>), how to make <code>raster::plot</code> display only the extents of that <code>RasterLayer</code>?</li>\n</ol>\n\n<p>The code in <code>regrid.global.to.AQMEII.r</code> (<a href=\"https://github.com/TomRoche/GEIA_to_netCDF/blob/master/regrid.global.to.AQMEII.r\" rel=\"nofollow\">here</a>) that does the regridding seems to get the correct output:</p>\n\n<pre><code>out.crs &lt;- '+proj=lcc +lat_1=33 +lat_2=45 +lat_0=40 +lon_0=-97 +x_0=-2556000 +y_0=-1728000'\n</code></pre>\n\n<p>Note that CRS appears to match the definition of the output domain given <a href=\"https://github.com/TomRoche/cornbeltN2O/wiki/AQMEII-North-American-domain#wiki-EPA\" rel=\"nofollow\">here</a>. (Once at the linked page, scroll past the map.)</p>\n\n<pre><code>out.raster &lt;-\n  projectRaster(\nfrom=in.raster, to=template.raster, method='bilinear', crs=out.crs,\noverwrite=TRUE, progress='window', format='CDF',\n# args from writeRaster\nNAflag=-999.0,  # match emi_n2o:missing_value,_FillValue (TODO: copy)\nvarname=data.var.name, \nvarunit='ton N2O-N/yr',\nlongname='N2O emissions',\nxname='COL',\nyname='ROW',\nfilename=out.fp)\nout.raster\n# made with CRS\n#&gt; class       : RasterLayer \n#&gt; dimensions  : 299, 459, 137241  (nrow, ncol, ncell)\n#&gt; resolution  : 53369.55, 56883.69  (x, y)\n#&gt; extent      : -14802449, 9694173, -6258782, 10749443  (xmin, xmax, ymin, ymax)\n# ??? why still proj=longlat ???\n#&gt; coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 \n#&gt; data source : /home/rtd/code/R/GEIA_to_netCDF/GEIA_N2O_oceanic_regrid.nc\n#&gt; names       : N2O.emissions \n#&gt; zvar        : emi_n2o \n</code></pre>\n\n<p>But, as noted, the regrid output (<code>out.raster</code>) shows itself to be lon-lat in its CRS: I'm not sure why that is, or if it implies <code>out.raster</code> is global in extents.</p>\n\n<p>I also tried to restrict the plot itself in two ways:</p>\n\n<p>Firstly, I tried adding an <code>extents</code> to the plot, i.e.,</p>\n\n<pre><code>plot(out.raster, ext=template.raster)\nplot(map.us.proj, add=TRUE)\n</code></pre>\n\n<p>which generates page=2/4 of <a href=\"https://github.com/downloads/TomRoche/GEIA_to_netCDF/GEIA_N2O_oceanic_regrid.pdf\" rel=\"nofollow\">the PDF</a>. Unfortunately, that does not change the output at all: AFAICS, it is completely identical to page=1/4 (above).</p>\n\n<p>Secondly, I tried using <code>raster::crop</code> to bound the regridded netCDF itself, before plotting that, using the same <code>RasterLayer</code> object (<code>template.raster</code>) that I used to bound the regrid:</p>\n\n<pre><code>template.raster.extent &lt;- extent(template.raster)\nout.raster.crop &lt;-\n  # overwrite the uncropped file\n  crop(out.raster, template.raster.extent, filename=out.fp, overwrite=TRUE)\n...\nplot(out.raster.crop)\nplot(map.us.proj, add=TRUE)\n</code></pre>\n\n<p>which generates page=3/4 of <a href=\"https://github.com/downloads/TomRoche/GEIA_to_netCDF/GEIA_N2O_oceanic_regrid.pdf\" rel=\"nofollow\">the PDF</a>. Unfortunately, that it is also apparently completely identical to page=1/4 (above).</p>\n\n<p>(In case you're wondering, page 4 of the PDF was generated using <code>fields::image.plot</code>, which has a different problem, described <a href=\"http://stackoverflow.com/questions/13022919/r-problems-visualizing-a-raster-with-fieldsimage-plot\">here</a>, unless StackOverflow whacks that link.)</p>\n\n<p>Your assistance to this R newbie is appreciated!</p>\n"},{"tags":["database","r","index","rmysql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":12376498,"title":"Is it possible to add index to database table through R(RMySQL)","body":"<p>I have created a table output and connected to database through RMySQL, and now I need to add index to the table, I searched around but didn't found what I need in R language, please help.</p>\n\n<p>A small example of the table would look like this:</p>\n\n<pre><code>mth &lt;- c(rep(1:2,5))  \nday &lt;- c(rep(10,5),rep(11,5))  \nhr &lt;- c(3,4,5,6,7,3,4,5,6,7)  \nv &lt;- c(3,4,5,4,3,3,4,5,4,3)  \nA &lt;- data.frame(cbind(mth,day,hr,v))   \n</code></pre>\n\n<p>The index I need should include: \"mth\" + \"day\" + \"hr\".\nThank you very much!</p>\n"},{"tags":["r","time-series","xts","zoo"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13144430,"title":"PerformanceAnalytics error in dealing with time-based object?","body":"<p>Please, put the following data structure into R:</p>\n\n<pre><code>ret.tot &lt;- structure(c(NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.0176629385269872, \n-0.00598540500471782, 0.000397233717450593, 0.0306832492016377, \n0.017489053560066, 0.00269955471373475, -0.0320201783372234, \n-0.0275430853903852, -0.000590271106063863, 0.0129459406811023, \n0.0149953072553982, -0.0129087888171287, -0.00130280102489988, \n-0.0377404713075129, 0.0236191282922097, -0.0119020468768697, \n-0.115096461748588, 0.100199681314344, 0.0911308738334283, -0.110863725885523, \n-0.0727448946117171, 0.0474370051015683, -0.0261582369412903, \n0.0555183596655775, 0.00860003940385565, 0.0346875742874423, \n0.0165600647484871, 0.0289458251073716, -0.0200260791601897, \n0.0762373770534174, -0.0221922758574445, -0.0462536669889334, \n0.0145014986918377, 0.00785273903343038, 0.0278941165111914, \n-0.0147065715501423, 0.0153730326847651, 0.0144617698521356, \n0.0197478508710501, 0.0251269321439706, -0.0103666325237731, \n-0.00157067125918319, 0.0115368085910558, -0.0200792001115183, \n0.0309994626763721, -0.00718247947811835, 0.0175666609422171, \n0.00657518046680547, -0.0281804455661145, 0.0239339965633073, \n-0.0040811434351766, -0.00861507762926691, 0.0492982380847687, \n0.0101687467126706, 0.0134748887393316, 0.0258425088138871, 0.00378545928098804, \n-0.0150120910386031, 0.00362726110322858, -0.00593835966763433, \n0.0312603603825787, 0.0111363934978518, 0.00793289404006547, \n0.00807089833865603, -0.0118743825996689), .Dim = c(78L, 1L), .Dimnames = list(\n    NULL, NULL), index = structure(c(1146441600, 1149120000, \n1151712000, 1154390400, 1157068800, 1159660800, 1162339200, 1164931200, \n1167609600, 1170288000, 1172707200, 1175385600, 1177977600, 1180656000, \n1183248000, 1185926400, 1188604800, 1191196800, 1193875200, 1196467200, \n1199145600, 1201824000, 1204329600, 1207008000, 1209600000, 1212278400, \n1214870400, 1217548800, 1220227200, 1222819200, 1225497600, 1228089600, \n1230768000, 1233446400, 1235865600, 1238544000, 1241136000, 1243814400, \n1246406400, 1249084800, 1251763200, 1254355200, 1257033600, 1259625600, \n1262304000, 1264982400, 1267401600, 1270080000, 1272672000, 1275350400, \n1277942400, 1280620800, 1283299200, 1285891200, 1288569600, 1291161600, \n1293840000, 1296518400, 1298937600, 1301616000, 1304208000, 1306886400, \n1309478400, 1312156800, 1314835200, 1317427200, 1320105600, 1322697600, \n1325376000, 1328054400, 1330560000, 1333238400, 1335830400, 1338508800, \n1341100800, 1343779200, 1346457600, 1349049600), tzone = \"\", tclass = \"yearmon\"), .indexCLASS = \"yearmon\", tclass = \"yearmon\", .indexTZ = \"\", tzone = \"\", class = c(\"xts\", \n\"zoo\"))\n</code></pre>\n\n<p>My R session:</p>\n\n<pre><code>R version 2.15.1 (2012-06-22)\nPlatform: i386-pc-mingw32/i386 (32-bit)\n\nlocale:\n[1] LC_COLLATE=English_Australia.1252  LC_CTYPE=English_Australia.1252   \n[3] LC_MONETARY=English_Australia.1252 LC_NUMERIC=C                      \n[5] LC_TIME=English_Australia.1252    \n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] quantmod_0.3-17       TTR_0.21-1            xts_0.8-6            \n [4] zoo_1.7-8             Defaults_1.1-1        rmgarch_0.97         \n [7] Matrix_1.0-9          lattice_0.20-10       Kendall_2.2          \n[10] spd_1.7               KernSmooth_2.23-8     rugarch_1.0-11       \n[13] Rsolnp_1.12           truncnorm_1.0-6       chron_2.3-42         \n[16] numDeriv_2012.3-1     MASS_7.3-18           RcppArmadillo_0.3.4.2\n[19] Rcpp_0.9.13           rcom_2.2-5            rscproxy_2.0-5       \n\nloaded via a namespace (and not attached):\n[1] boot_1.3-7                   grid_2.15.1                 \n[3] PerformanceAnalytics_1.0.4.4 timeDate_2160.95\n[5] timeSeries_2160.94           tools_2.15.1\n</code></pre>\n\n<p>The code which gives me issues:</p>\n\n<pre><code>op &lt;- par(no.readonly = TRUE)\nlibrary(PerformanceAnalytics)\ncharts.PerformanceSummary(R = ret.tot, Rf = .0)\ntable.AnnualizedReturns(R = ret.tot, scale = 12, Rf = 0)\ntable.Returns(R = ret.tot)\ndetach(package:PerformanceAnalytics)\npar(op)\n</code></pre>\n\n<p>The code above returns the following error:</p>\n\n<pre><code>&gt; table.AnnualizedReturns(R = ret.tot, scale = 12, Rf = 0)\nError in xts(rep(Rf, length(indexseries)), order.by = indexseries) : \n  order.by requires an appropriate time-based object\n&gt; table.Returns(R = ret.tot)\nError in matrix(unlist(value, recursive = FALSE, use.names = FALSE), nrow = nr,  : \n  'data' must be of a vector type\n</code></pre>\n\n<p>I guess some conflict between <code>PerformanceAnalytics</code> and other packages, but I do not understand who's the guilty...</p>\n\n<pre><code>ret.tot &lt;- xts(ret.tot, order.by = as.POSIXct(index(ret.tot)))\n</code></pre>\n\n<p>And so...</p>\n\n<pre><code>&gt; charts.PerformanceSummary(R = ret.tot, Rf = .0)\nError in UseMethod(\"first\") : \n  no applicable method for 'first' applied to an object of class \"c('xts', 'zoo')\"\n\n&gt; table.AnnualizedReturns(R = ret.tot, scale = 12, Rf = 0)\n                              NA\nAnnualized Return         0.0335\nAnnualized Std Dev        0.1144\nAnnualized Sharpe (Rf=0%) 0.2928\n\n&gt; table.Returns(R = ret.tot)\nError in matrix(unlist(value, recursive = FALSE, use.names = FALSE), nrow = nr,  : \n  'data' must be of a vector type\n</code></pre>\n\n<p>Argh!</p>\n\n<p>(The same with <code>as.Date()</code>).</p>\n"},{"tags":["mysql","r","rmysql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13076219,"title":"How to select all data but the last week in RMySQL with timestamp?","body":"<p>I have this column \"timestamp\" in table A, and I want to select all data but the last week, here is my R code but an error pop up saying \"Error in function (classes, fdef, mtable)  : \n  unable to find an inherited method for function \"dbWriteTable\", for signature \"MySQLConnection\", \"data.frame\", \"character\"\", any help would be appreciated? THANK YOU.</p>\n\n<pre><code>fun &lt;- function(con, dat.set, tbl.name) {\n\nif (dbExistsTable(con, tbl.name)) {     \nBFWeek = dbGetQuery(con, statement=paste(\"SELECT * FROM A\",\n\"WHERE timestamp &lt; timestampadd(day, -7, now())\"))   \ndbWriteTable(con, BFWeek, tbl.name, row.names=F, append=T);            \n\n} else { \ndbWriteTable(con, tbl.name, dat.set, row.names=F, append=T); \n  }\n} \n\nfun(conn_table, df, \"A\")\n</code></pre>\n"},{"tags":["mysql","sql","windows","r","rmysql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13165738,"title":"Missing mysql.h and trying to find mysql-devel","body":"<p>(I've been through four or five questions that are related to mine, but this sticking point I run into doesn't seem to be addressed in them.)</p>\n\n<p>In trying to run RMySQL on RStudio on a windows machine, I've been trying to follow the help given here: <a href=\"http://stackoverflow.com/questions/10292326/how-to-connect-r-with-mysql-or-how-to-install-rmysql-package\">How to Connect R with MySQL or how to install RMySQL package?</a> and here: <a href=\"http://stackoverflow.com/questions/5223113/using-mysql-in-r-for-windows\">Using MySQL in R for Windows</a></p>\n\n<p>I was able to complete steps 1,3,4,5 but not #2. </p>\n\n<p>I've tried searching for the missing header <strong>mysql.h</strong> itself, but everything I find is for a different platform, or else points toward <a href=\"http://dev.mysql.com/downloads/mysql/#downloads\" rel=\"nofollow\">http://dev.mysql.com/downloads/mysql/#downloads</a> , where I honestly cannot see any reference to the header at all. </p>\n\n<p>Another suggestion I saw was to install mysql-devel, but again, all the links I found for this pointed to nothing that worked. </p>\n\n<p>Thanks in advance for your help: I hope it's simple to resolve!</p>\n"},{"tags":["r","for-loop","return"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13168081,"title":"Returning multiple results from loop in R?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8216470/function-with-multiple-outputs\">function with multiple outputs</a><br>\n  <a href=\"http://stackoverflow.com/questions/12925063/numbering-rows-within-groups-in-a-data-frame\">numbering rows within groups in a data frame</a>  </p>\n</blockquote>\n\n\n\n<p>G'day, I have a list of individuals that are grouped by place. I want to produce a new variable that gives a number to each individual dependant on their place. What I would like my data to look like is:</p>\n\n<pre><code>place       individual\nhere        1\nhere        2\nhere        3\nthere       1\nthere       2\nsomewhere   1 \nsomewhere   2\n</code></pre>\n\n<p>I have written this:</p>\n\n<pre><code>    nest&lt;-data.frame(location=c(\"one\",\"one\",\"two\", \"three\", \"three\", \"three\"))\n    individual&lt;- function(x)\n      {\n        pp = 1\n        jj = 1\n        for (i in 2:length(x)){\n            if (x[i] == x[pp]){\n                res&lt;- jj+1\n                pp = pp + 1\n                jj = jj + 1\n            }\n            else{\n                res&lt;- 1\n                pp = pp + 1\n                jj = 1\n            }\n        }\n        return(res)\n      }\n\n    test&lt;- individual(nest$location)\n    test\n</code></pre>\n\n<p>I am pretty sure this does what I want, however, I can't figure out how to return more than one result value. How, do I change this function to return a result for each value of location? Or, is there an easier way to do this with a pre-existing R package?</p>\n\n<p>P.S. on a side note, I start the function from nest$individual[2] because when it starts the function from 1 and it tries to look for the previous value (which doesn't exist) it returns an error. If anyone has a thought on how to get around this I would love to hear it. Cheers.</p>\n"},{"tags":["r","knitr","rstudio"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":249,"score":1,"question_id":11155182,"title":"Is there a way to knitr markdown straight out of your workspace using RStudio?","body":"<p>I wonder whether I can use <code>knitr</code> markdown to just create a report on the fly with objects stemming from my current workspace. Reproducibility is not the issue here. I also read this very fine <a href=\"http://stackoverflow.com/questions/8434371/run-sweave-or-knitr-with-objects-from-existing-r-session\">thread here</a>. </p>\n\n<p>But still I get an error message complaining that the particular object could not be found. </p>\n\n<p>1) Suppose I open a fresh markdown document and save it. </p>\n\n<p>2) write a chunk that refers to some <code>lm</code> object in my workspace. call <code>summary(mylmobject)</code></p>\n\n<p>3) knitr it.</p>\n\n<p>Unfortunately the report is generated but the regression output cannot be shown because the object could not be found. Note, it works in general if i just save the object to .Rdata and then load it directly from the markdown file. </p>\n\n<p>Is there a way to use objects in R markdown that are in the current workspace?\nThis would be really nice to show non R people some output while still working.</p>\n"},{"tags":["r","finance","xts"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":47,"score":4,"question_id":13168545,"title":"xts::period.apply and cumprod","body":"<p>I am trying to calculate cumulative product for subsets of xts object. Here is an example of what I want and a question whether this can be done faster/more elegant using period.apply or some other c++ based fast function?</p>\n\n<pre><code># install.packages(\"qmao\", repos=\"http://R-Forge.R-project.org\")\nrequire(qmao) # for do.call.rbind()\n\n# I need something like cumprod over xts but by endpoints (subsets of xts)\ntest &lt;- xts(rep(0.01, length(as.Date(13514:13523, origin=\"1970-01-01\"))), as.Date(13514:13523, origin=\"1970-01-01\"))\nep &lt;- c(0, 5, NROW(test))\n# This does not do the trick\nperiod.prod(test, INDEX=ep)\n# So, try the obvious, but it does not do the trick\nperiod.apply(test, INDEX=ep, FUN=function(x) cumprod(1 + x))\n\n# Well, write your own\n# Hm, there is no split.xts that takes ep (endpoints) as parameter...\n# OK, split it manually\ntest.list &lt;- list(length(ep) - 1)\nk &lt;- 1:(length(ep) - 1)\ntest.list &lt;- lapply(k, function(x) test[(ep[x] + 1):ep[x + 1], ])\n# This is what I want...\ndo.call.rbind(lapply(test.list, function(x) cumprod(1 + x)))\n# Is there a better/faster way to do this?\n</code></pre>\n"},{"tags":["r","aggregate","plyr"],"answer_count":6,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":3536,"score":9,"question_id":6289538,"title":"Aggregate a dataframe on a given colum and display another column","body":"<p>I have a dataframe in R of the following form:</p>\n\n<pre><code>&gt; head(data)\n  Group Score Info\n1     1     1    a\n2     1     2    b\n3     1     3    c\n4     2     4    d\n5     2     3    e\n6     2     1    f\n</code></pre>\n\n<p>I would like to aggregate it following the <code>Score</code> column using the <code>max</code> function</p>\n\n<pre><code>&gt; aggregate(data$Score, list(data$Group), max)\n\n  Group.1         x\n1       1         3\n2       2         4\n</code></pre>\n\n<p>But I also would like to display the <code>Info</code> column associated to the maximum value of the <code>Score</code> column for each group. I have no idea how to do this. My desired output would be:</p>\n\n<pre><code>  Group.1         x        y\n1       1         3        c\n2       2         4        d\n</code></pre>\n\n<p>Any hint? Thanks a lot in advance!</p>\n"},{"tags":["r","oop","reference-class"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13165988,"title":"R reference classes as a field of a reference class","body":"<p>I would like to pass a reference class to a reference class constructor, and assign the passed reference class as a field. However, when I run the code below, I don't understand why I get an error. My questions are:</p>\n\n<p>1) Please can someone kindly explain why this error is occurring:</p>\n\n<pre><code>&gt; a &lt;- ClassA&amp;new()\nError in .getClassFromCache(Class, where) : \n  argument \"Class\" is missing, with no default\n&gt; b &lt;- ClassB$new(a)\nError in .Object$initialize(...) : object 'a' not found\n</code></pre>\n\n<p>2) I have declared <strong>class.a.container</strong> as class \"list\", however I want this to be a reference class. What do I need to put here instead of \"list\" ?</p>\n\n<pre><code>ClassA &lt;- setRefClass(\n  \"ClassA\",\n\n  fields = list(myVar = \"numeric\"),\n\n  methods = list(\n    someMethod = function(){\n      print(\"hi\")\n    }\n  )\n)\n\nClassB &lt;- setRefClass(\n  \"ClassB\",\n\n  fields = list(class.a.container = \"list\"),\n\n  methods = list(\n    initialize = function(class.a){\n      class.a.container &lt;&lt;- class.a\n  })\n)\n\na &lt;- ClassA&amp;new()\nb &lt;- ClassB$new(a)\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13167732,"title":"File writing behavior varies depending on OS in R?","body":"<p>I use R (2.15.1) scripts to pass variables to an externally compiled library function. During computation, the function (NOT the R script) creates a number of files which are written to and updated after each iteration of my algorithm.</p>\n\n<p>Now the strange part. Running on MacOS (Mountain Lion), the files are created and updated as expected. I can also view them (tail -f) during computation. On Windows and Linux the files are not written until the function completes. I prefer to monitor the output files during the computation.</p>\n\n<p>Does anyone have an explanation for this behavior (and a way to change it in Windows/Linux)?\nSeems like a great way to waste memory...</p>\n\n<p>Thanks. </p>\n"},{"tags":["r","date","time"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13165478,"title":"Time Calculation Between Specific Events","body":"<p>Here is a subset of my data:</p>\n\n<pre><code>Fr         Sig  Code NumDet    Date.Time          Aerial\n62  150102 102   15    195 2012-09-14 18:28:00      1\n63  150102 102   15    189 2012-09-14 18:32:00      1\n64  150102 106   15    213 2012-09-14 18:36:00      1\n65  150102 102   15    152 2012-09-14 18:40:00      1\n66  150102 105   15    190 2012-09-14 18:46:00      1\n67  150102  97   15      4 2012-09-14 18:51:00      2\n</code></pre>\n\n<p>I am trying to calculate time between first detection on Aerial 1 and first detection on Aerial 2. Hence in this data set it would be 23mins</p>\n\n<p>I have tried variations of <code>difftime</code> but can't seem to select specific times based on the Aerial number.</p>\n\n<p>I have tried:</p>\n\n<pre><code>a &lt;- difftime(table$Date.Time[2:length(table$Aerial == \"1\")], \n              table$Date.Time[2:length(table$Aerial == \"2\")])\n</code></pre>\n\n<p>but it's not even close. </p>\n"},{"tags":["r","repository","cran"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13156426,"title":"Did the subdirectory structure of package repositories change as of R 2.15.2?","body":"<p>Kind of embarrassing / a no-go, but since it hasn't been that long that I've moved from \"pure user\" to \"beginner-developer\", I've never actually read the CHANGELOG when a new R version came out - well until today (and I have the feeling I should make this a habbit) ;-)</p>\n\n<p>Yet I'm not sure if the supposed change actually occurred since I couldn't find anything about it at a first glimpse at the <a href=\"http://cran.at.r-project.org/bin/windows/base/NEWS.R-2.15.2.html\" rel=\"nofollow\">CHANGELOG</a> of R R 2.15.2:</p>\n\n<h2>Actual question</h2>\n\n<p>Is it possible that the (subdirectory) structure of package repositories changed from</p>\n\n<p><code>./bin/windows/contrib/2.xx/</code></p>\n\n<p>to </p>\n\n<p><code>./src/contrib/2.xx/</code> or even <code>./src/contrib</code>?</p>\n\n<p>Or at least that the <code>PACKAGES</code> file now needs to live here: <code>./src/contrib/PACKAGES</code>?</p>\n\n<h2>Background info</h2>\n\n<p>Up to version 2.15.1, the following path worked to install packages from my local package repository:</p>\n\n<pre><code>path.repos  &lt;- \"L:/R/packages\"\nrepos       &lt;- file.path(\"file://\", path.repos)\n</code></pre>\n\n<p>Function <code>contrib.url</code> would take <code>repos</code> and expand it to the right subdirectory:</p>\n\n<pre><code>&gt; contrib.url(repos)\n[1] \"file:///L:/R/packages/bin/windows/contrib/2.15\"\n</code></pre>\n\n<p>But when I try to run <code>install.packages()</code>, I get the following error for R 2.15.2:</p>\n\n<pre><code>&gt; install.packages(\"mypkg\", \n+     lib=file.path(R.home(), \"library\"),\n+     repos=repos,\n+     type=\"win.binary\"\n+ )\nError in read.dcf(file = tmpf) : cannot open the connection\nIn addition: Warning message:\nIn read.dcf(file = tmpf) :\n  cannot open compressed file 'L:/R/packages/src/contrib/PACKAGES', probable reason 'No such file or directory'\n&gt; \n</code></pre>\n\n<p>When I do the same with R 2.15.1, everything works smoothly.</p>\n\n<h2>Due dilligence</h2>\n\n<p>There are some references with respect to repositories in the <a href=\"http://cran.at.r-project.org/bin/windows/base/NEWS.R-2.15.2.html\" rel=\"nofollow\">CHANGELOG</a>, but the only section I found that gives me some evidence that the supposed change occurred is this:</p>\n\n<blockquote>\n  <p>PACKAGE INSTALLATION</p>\n  \n  <blockquote>\n    <p>For a Windows or Mac OS X binary package install, install.packages() will check if a source package is available on the same repositories, and report if it is a later version or there is a source package but no binary package available. </p>\n  </blockquote>\n</blockquote>\n\n<p>Just had a look at the <a href=\"http://cran.r-project.org/doc/manuals/R-admin.html#Setting-up-a-package-repository\" rel=\"nofollow\">official documentation</a> again and got the idea that maybe arg <code>type</code> is not passed along to <code>contrib.url()</code> correctly as it seems to me <code>install.package()</code> is looking at the place for <code>type=\"source\"</code> packages?</p>\n"},{"tags":["r","documentation","roxygen2"],"answer_count":1,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":73,"score":9,"question_id":13027799,"title":"Documenting function closures","body":"<p>Suppose I have a function closure in my package, for example</p>\n\n<pre><code>f = function(x) {\n    x = x\n    g = function(y) x &lt;&lt;- y\n    h = function() x\n    list(g=g, h=h)\n}\n\nl = f(5)\nl$g(10)\nl$h()\n</code></pre>\n\n<p>What's the best way of structuring the documentation for this function? In particular, </p>\n\n<ol>\n<li>I would like to use <code>roxygen2</code></li>\n<li>I would like to provide documentation for the functions <code>g</code> and <code>h</code></li>\n</ol>\n"},{"tags":["c++","r","stl","matrix"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":98,"score":-6,"question_id":13166239,"title":"Extract a column out of C++ STL deque?","body":"<p>Is there a way to to extract a column out of a deque with this C++ code? </p>\n\n<pre><code>for (data_t::record_iterator ri = this-&gt;begin(); ri != this-&gt;end(); ri++) {\n    cout &lt;&lt; \"contains:\" &lt;&lt; endl;\n    unsigned int i;\n    cout &lt;&lt; ri-&gt;at(5) &lt;&lt; endl; \n}\n</code></pre>\n\n<p>this would be a data type of deque. Here is the source of the content of it: </p>\n\n<pre><code>deque &lt;deque &lt;float&gt; &gt; {\ntypedef deque &lt;deque &lt;float&gt; &gt; ::iterator record_iterator;\ntypedef deque &lt;float&gt; ::iterator field_iterator;\nbool load(const string &amp; filename);\nbool save(const string &amp; filename);\nbool save(ostream &amp; outs);\n};\n</code></pre>\n\n<p>I would like to take all the values in the fifth column of ri and copy into it's own vector whatever container. The new container would be read only so what type should it be for being the fastest type for future use. Can all this be done in one method no different as if it was R:</p>\n\n<pre><code>x&lt;-matrx[,5]\n</code></pre>\n\n<p>where matrix is well uh a matrix. \nThanks </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13166104,"title":"making a stacked bar graph with 3 bars for each category","body":"<p>I have the following dataset:</p>\n\n<pre><code>      Marker   Method NAtype        Ratio\n1     CSF1PO      GEL     -9 3.623417e-01\n2     CSF1PO      GEL     -1 4.713273e-02\n3     CSF1PO      GEL     NA 0.000000e+00\n4     CSF1PO MegaBACE     -9 1.417205e-02\n5     CSF1PO MegaBACE     -1 8.312974e-03\n6     CSF1PO MegaBACE     NA 5.405026e-06\n7     CSF1PO      ABI     -9 4.714592e-02\n8     CSF1PO      ABI     -1 1.989925e-03\n9     CSF1PO      ABI     NA 4.174494e-05\n10  D10S1248      GEL     -9 9.999201e-01\n11  D10S1248      GEL     -1 7.098303e-05\n12  D10S1248      GEL     NA 0.000000e+00\n13  D10S1248 MegaBACE     -9 6.562637e-01\n14  D10S1248 MegaBACE     -1 2.518769e-03\n15  D10S1248 MegaBACE     NA 1.081005e-05\n16  D10S1248      ABI     -9 7.138484e-03\n17  D10S1248      ABI     -1 1.029723e-03\n18  D10S1248      ABI     NA 1.391498e-05\n</code></pre>\n\n<p>I want to make a stacked bar graph with these data. I'm not fluent in ggplot2 and I don't know how to create 3 bars for each category.</p>\n\n<p>For example, the 1st column has my categories, these are the names that go in the x axis of my graph. For each category (\"CSF1PO\" and \"D10S1248\"), I want 3 bars (\"GEL\", \"MegaBACE\", \"ABI\" in the 2nd column). Each bar should be divided in 3 subsets (\"-9\", \"-1\", \"NA\" in the 3rd column). And the 4th column (Ratio) has my values.</p>\n\n<p>I want something like </p>\n\n<pre><code>ggplot(data, aes(x=Marker, y=Ratio, fill=NAtype)) + geom_bar(stat=\"identity\") + facet_grid(~Method)\n</code></pre>\n\n<p>but with the bars for each category side-by-side, not in separated grids.\nCan anyone help please?\nThanks!</p>\n"},{"tags":["r","subscript"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13165973,"title":"Make R consider negative position searches as being out of bounds","body":"<p><code>vec&lt;-c(\"a\", \"b\", \"c\", \"d\")</code>\nmy task is to extract the second element from the right and left of the key string.</p>\n\n<p>If our key string is \"d\", if we do</p>\n\n<pre><code>i&lt;-c(\"d\")\nvec.1 &lt;- append(vec.1, vec[which(vec == i) + 2])\n</code></pre>\n\n<p>we get NA. But if we do</p>\n\n<pre><code>i&lt;-c(\"a\")    \nvec.1 &lt;- append(vec.1, vec[which(vec == i) - 2])\n</code></pre>\n\n<p>we get \"b\", \"c\", \"d\". Is it possible to consider negative values in subscripts as positions being out of the vector like a positive subscript that exceeds the length of the vector? That way the result will be a NA. </p>\n"},{"tags":["r","data.table"],"answer_count":3,"favorite_count":4,"up_vote_count":4,"down_vote_count":0,"view_count":160,"score":4,"question_id":12773822,"title":"Why does X[Y] join of data.tables not allow a full outer join, or a left join?","body":"<p>This is a bit of a philosophical question about data.table join syntax. I am finding more and more uses for data.tables, but still learning...</p>\n\n<p>The join format <code>X[Y]</code> for data.tables is very concise, handy and efficient, but as far as I can tell, it only supports inner joins and right outer joins. To get a left or full outer join, I need to use merge:</p>\n\n<ul>\n<li><code>X[Y,nomatch=NA]</code> -- all rows in Y -- right outer join  (default)</li>\n<li><code>X[Y,nomatch=0]</code> -- only rows with matches in both X and Y -- inner join</li>\n<li><code>merge(X,Y,all=TRUE)</code> -- all rows from both X and Y -- full outer join</li>\n<li><code>merge(X,Y,all.x=TRUE)</code> -- all rows in X -- left outer join</li>\n</ul>\n\n<p>It seems to me that it would be handy if the X[Y] join format supported all 4 types of joins. Is there a reason only two types of joins are supported?</p>\n\n<p>For me, the \"nomatch=0\" and \"nomatch=NA\" parameter values are not very intuitive for the actions being performed. It is easier for me to understand and remember the merge syntax: \"all=TRUE\", \"all.x=TRUE\" and \"all.y=TRUE\". Since the X[Y] operation resembles merge much more than match, why not use the merge syntax for joins rather than the match function's nomatch parameter?</p>\n\n<p>Here are code examples of the 4 join types:</p>\n\n<pre><code># sample X and Y data.tables\nlibrary(data.table)\nX &lt;- data.table(t=1:4,a=(1:4)^2)\nsetkey(X,t)\nX\n#   t  a\n# 1: 1  1\n# 2: 2  4\n# 3: 3  9\n# 4: 4 16\nY &lt;- data.table(t=3:6,b=(3:6)^2)\nsetkey(Y,t)\nY\n#    t  b\n# 1: 3  9\n# 2: 4 16\n# 3: 5 25\n# 4: 6 36\n\n# all rows from Y - right outer join\nX[Y]  # default\n#  t  a  b\n# 1: 3  9  9\n# 2: 4 16 16\n# 3: 5 NA 25\n# 4: 6 NA 36\nX[Y,nomatch=NA]  # same as above\n#    t  a  b\n# 1: 3  9  9\n# 2: 4 16 16\n# 3: 5 NA 25\n# 4: 6 NA 36\nmerge(X,Y,by=\"t\",all.y=TRUE)  # same as above\n#    t  a  b\n# 1: 3  9  9\n# 2: 4 16 16\n# 3: 5 NA 25\n# 4: 6 NA 36\nidentical( X[Y], merge(X,Y,by=\"t\",all.y=TRUE) )\n# [1] TRUE\n\n# only rows in both X and Y - inner join\nX[Y,nomatch=0]  \n#    t  a  b\n# 1: 3  9  9\n# 2: 4 16 16\nmerge(X,Y,by=\"t\")  # same as above\n#    t  a  b\n# 1: 3  9  9\n# 2: 4 16 16\nmerge(X,Y,by=\"t\",all=FALSE)  # same as above\n#    t  a  b\n# 1: 3  9  9\n# 2: 4 16 16\nidentical( X[Y,nomatch=0], merge(X,Y,by=\"t\",all=FALSE) )\n# [1] TRUE\n\n# all rows from X - left outer join\nmerge(X,Y,by=\"t\",all.x=TRUE)\n#    t  a  b\n# 1: 1  1 NA\n# 2: 2  4 NA\n# 3: 3  9  9\n# 4: 4 16 16\n\n# all rows from both X and Y - full outer join\nmerge(X,Y,by=\"t\",all=TRUE)\n#    t  a  b\n# 1: 1  1 NA\n# 2: 2  4 NA\n# 3: 3  9  9\n# 4: 4 16 16\n# 5: 5 NA 25\n# 6: 6 NA 36\n</code></pre>\n"},{"tags":["r","installation","package","override"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13163248,"title":"Possible to override the blocking of a package's (re-)installation after it has been required/loaded?","body":"<h2>Actual question</h2>\n\n<p>Is it possible to override the blocking of a package's (re-)installation after it has been required/loaded? </p>\n\n<p>I understand that blocking a \"true\" <strong>re-installation</strong> to the <strong>same</strong> library that the package was loaded from makes perfect sense once the package is in use. But my use case is a bit different</p>\n\n<h2>Background</h2>\n\n<p>I like the idea of having a \"sandbox library\" to test own packages. Besides the package(s) to test, those sandbox libraries contain all base packages of a clean base R installation <strong>plus</strong> some contrib packages necessary in order for my whole package building and testing framework to work (e.g. <code>digest</code>, <code>stringr</code> etc.). However, my framework loads the latter packages from the standard lib and <strong>then</strong> needs to install them to the sandbox lib - which is blocked. Hence my question if it is possible to override this as I'm not really doing what people had in mind when implementing the block.</p>\n\n<h2>Illustration</h2>\n\n<p>Specify paths to the two libraries</p>\n\n<pre><code>lib         &lt;- file.path(R.home(), \"library\")\nlib.sandbox &lt;- file.path(tempdir(), \"library\")\n</code></pre>\n\n<p>Create sandbox library </p>\n\n<pre><code>dir.create(lib.sandbox, showWarnings=FALSE)\n</code></pre>\n\n<p>Install a package to the standard library and load it</p>\n\n<pre><code>install.packages(\"digest\", lib=lib)\nrequire(\"digest\", lib.loc=lib)\n</code></pre>\n\n<p>Then also install it to the sandbox library</p>\n\n<pre><code>&gt; install.packages(\"digest\", lib=lib.sandbox)\nWarning: package 'digest' is in use and will not be installed\n</code></pre>\n\n<p>My framework figures certain stuff out <strong>after</strong> certain packages that should also be installed to the sandbox lib are loaded, so I can't put the \"install-to-sandbox-lib\" step before the initial loading step.</p>\n"},{"tags":["r","graphics","matrix","data-visualization","heatmap"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":151,"score":1,"question_id":13090675,"title":"Create multiple separate heatmaps from a single matrix","body":"<p>I want to visualize a 42x42 matrix as 28 separate heatmaps, each heatmap being 6x6 matrix with the values plotted on the top of colours. I only need lower half of he matrix, I don't want to plot anything that has been excluded. The subsequent 6x6 matrixes shouldn't overlap, as in the example below: </p>\n\n<pre><code>d = as.matrix(read.table(\"http://dl.dropbox.com/u/2505196/matrix_posthoc_tukey.dat\"))\nd[upper.tri(d)] &lt;- NA\nd1 &lt;- d[1:6, 1:6]\nd2 &lt;- d[1:6, 7:12]\nd3 &lt;- d[1:6, 13:18]\nd4 &lt;- d[1:6, 18:24]\n#...etc, up to d28 &lt;- d[37:42,37:42] \n</code></pre>\n\n<p>Code I used to create a single heatmap looks like this:</p>\n\n<pre><code>#baseline to create a separated space for all 28 plots\npar(mfrow=c(4,7), mar=c(2,2,4,1), oma=c(2,4,2,2))\n\n#using `image` to create heatmap, with color breaks defined by specific values\n#the code below create just single heatmap\nimage(x=1:6, y=1:6, axes = FALSE, ylab=\"\", xlab=\"\", d1, \n  breaks=c(min(d1,na.rm=TRUE), -5.45, -4.65, 4.65, 5.45, max(d1,na.rm=TRUE)),\n  col=c(\"red\",\"orange\",\"white\",\"orange\",\"red\"))\naxis(2, 1:6, cex.axis = 0.7, las=1, tick=F)\naxis(3, 1:6, cex.axis = 0.7, tick=F)\n#create vertical and forizontal lines\nabline(h=seq(0.5,6.5,1), v=seq(0.5,6.5,1))\n#plot values from the specific matrix subset\nfor (i in 1:6)\n   {\n     for (j in 1:6)\n       {\n         txt &lt;- sprintf(\"%0.1f\", d1[i,j])\n         text(i, j, txt, cex=0.7)\n        }\n   }\n</code></pre>\n\n<p>Three such heatmaps look like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/KSNKT.png\" alt=\"enter image description here\"></p>\n\n<p>That's where I'm stuck. I have to manually change <code>d</code> value every time I add another image to my single-page, multiple heatmap collection. I don't know how to create a nice loop to plot those specific subsets of matrix at the same time using the code above.</p>\n\n<p>Alternative solutions with ggplot2, lattice are also welcomed, although I believe the main question here is a good loop to make this series of heatmaps. </p>\n"},{"tags":["r","user-defined-functions"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13154266,"title":"How do I introduce row names to a function in R","body":"<p>Hi I have a utility function I've put together to insert rows into a dataframe below. If I was writing out the formula by hand I would put something like </p>\n\n<p><code>newframe=rbind(oldframe[1:rownum,],row_to_insert=row_to_insert,oldframe[(rownum+1:nrow(oldframe),]</code> to name <code>row_to_insert</code>. Could someone tell me how to do this in a function?</p>\n\n<p>Thanks</p>\n\n<pre><code>insertrows=function (x, y, rownum) \n{\n    newframe = rbind(y[1:rownum, ], x, y[(rownum + 1):nrow(y), \n        ])\n    return(data.frame(newframe))\n}\n</code></pre>\n\n<p>MWE of some underlying data added below</p>\n\n<pre><code>financials=data.frame(sales=c(100,150,200,250),some.direct.costs=c(25,30,35,40),other.direct.costs=c(15,25,25,35),indirect.costs=c(40,45,45,50))\n\noldframe=t(financials)\ncolnames(oldframe)=make.names(seq(2000,2003,1))\n\ntotal.direct.costs=oldframe['some.direct.costs',]+oldframe['other.direct.costs',]\nnewframe=total.direct.costs\n\nn=rownum=3\noldframe=insertrows(total.direct.costs=newframe,oldframe,n)\n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13162489,"title":"Arrange barcharts side by side with ggplot2 and R","body":"<p>I am struggling to  display two barcharts side by side with the same scale</p>\n\n<p>My code looks like this</p>\n\n<pre><code>library(ggplot2)\nlibrary(gridExtra)\n#dataframe definition\nrm(list=ls(all=TRUE))\nmydata &lt;- data.frame(a=1:10,b=c('yes','no'),c=seq(2,20,2))\n\nplot1&lt;- ggplot(mydata, aes(x=factor(mydata$b), y=100*a), order=f, fill=grey) + \n  stat_summary(fun.y=\"mean\", geo    m=\"bar\", colour=\"black\")+xlab(\"Factor b\") + \n  ylab(\"Value of a\")    \n\nplot2&lt;- ggplot(mydata, aes(x=factor(mydata$b), y=c), order=f) + \n  stat_summary(fun.y=\"mean\", geom=\"bar\", colour=\"black\")+xlab(\"Factor b\") + \n  ylab(\"Value of b\")    \n\ngrid.arrange(plot1, plot2, ncol=2)\n</code></pre>\n\n<p>That produces the following image. </p>\n\n<p><img src=\"http://i.stack.imgur.com/Rgns8.jpg\" alt=\"Image output from ggplot2\"></p>\n\n<p>I want to position them in a way the vertical axis has the same scale for both of the barcharts. \nI couldn't find any documentation on the gridExtra manual. </p>\n"},{"tags":["optimization","r"],"answer_count":1,"favorite_count":2,"up_vote_count":5,"down_vote_count":2,"view_count":1122,"score":3,"question_id":5436630,"title":"constrained optimization in R","body":"<p>I am trying to use <a href=\"http://rss.acs.unt.edu/Rdoc/library/stats/html/constrOptim.html\" rel=\"nofollow\">http://rss.acs.unt.edu/Rdoc/library/stats/html/constrOptim.html</a> in R to do optimization in R with some given linear constraints but not able to figure out how to set up the problem.</p>\n\n<p>For example, I need to maximize $f(x,y) = log(x) + \\frac{x^2}{y^2}$ subject to constraints $g_1(x,y) = x+y &lt; 1$, $g_2(x,y) = x > 0$ and $g_3(x,y) = y > 0$. How do I do this in R? This is just a hypothetical example. Do not worry about its structure, instead I am interested to know how to set this up in R.</p>\n\n<p>thanks!</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13161770,"title":"R strange apply returns","body":"<p>I use apply to a matrix in order to apply a function row by row.\nMy syntax is as follows :</p>\n\n<pre><code>res = apply(X,1,MyFunc)\n</code></pre>\n\n<p>The above function MyFunc returns a list of two values.\nBut the result of this apply application is a strange structure, where R seems to add some of its own (housekeeping?) data :</p>\n\n<pre><code>res = $`81`\n$`81`$a\n[1] 80.8078\n\n$`81`$b\n[1] 6247\n</code></pre>\n\n<p>Whereas the result I am waiting for is simply :</p>\n\n<pre><code>res = $a\n[1] 80.8078\n\n$b\n[1] 6247\n</code></pre>\n\n<p>I do not know why this strange <code>81</code> is inserted by R and how can I get rid of it.\nThanks for help</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13161851,"title":"Error in Minimisation using the nlminb R-function","body":"<p>I would like to estimate the 4-parameters that minimises the log-likelihood function LogL(\\theta). The first two parameters (a and sigma) are positive; the third one is unconstrained and the last one should be leas than the minimum value in the data. So, I tried to use nlminb function and write it as:</p>\n\n<pre><code>nlminb(start=c(a=0.13,mu=1,sigma=31,xi=0.01),f,lower=c(0.0001,0,0.123,0.01210),\nupper=c(2,18.21,50,0.95),control=list(eval.max=100, iter.max=100))\n</code></pre>\n\n<p>I got a good result, but there is still problem that the estimator of mu take the same value of the upper limit for all the values I try to use and for xi, it take the same lower value even If I change the starting values.</p>\n\n<p>The log likelihood function take form:</p>\n\n<pre><code>-loglik=-n*log(a)+n*log(1-exp(-1))+n*log(sigma) -(a-1)*sum(log(x-mu))+(1/xi+1)*sum(log(1+xi*((x-mu)**a)/sigma))+ sum((1+xi*((x-mu)**a)/sigma)*(-1/xi))\n</code></pre>\n\n<p>I have another condition that <code>x-mu</code> should be positive and <code>1+xi*((x-mu)*a)/sigma</code> as well</p>\n\n<p>Any suggestion will be appreciated</p>\n"},{"tags":["r","utf-8","iconv","text-mining"],"answer_count":4,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":746,"score":2,"question_id":9637278,"title":"R tm package invalid input in 'utf8towcs'","body":"<p>I'm trying to use the tm package in R to perform some text analysis. I tied the following:</p>\n\n<pre><code>require(tm)\ndataSet &lt;- Corpus(DirSource('tmp/'))\ndataSet &lt;- tm_map(dataSet, tolower)\nError in FUN(X[[6L]], ...) : invalid input 'RT @noXforU Erneut riesiger (Alt-)�lteppich im Golf von Mexiko (#pics vom Freitag) http://bit.ly/bw1hvU http://bit.ly/9R7JCf #oilspill #bp' in 'utf8towcs'\n</code></pre>\n\n<p>The problem is some characters are not valid. I'd like to exclude the invalid characters from analysis either from within R or before importing the files for processing.</p>\n\n<p>I tried using iconv to convert all files to utf-8 and exclude anything that can't be converted to that as follows:</p>\n\n<pre><code>find . -type f -exec iconv -t utf-8 \"{}\" -c -o tmpConverted/\"{}\" \\; \n</code></pre>\n\n<p>as pointed out here <a href=\"http://stackoverflow.com/questions/4544669/batch-convert-latin-1-files-to-utf-8-using-iconv\">Batch convert latin-1 files to utf-8 using iconv</a></p>\n\n<p>But I still get the same error.</p>\n\n<p>I'd appreciate any help.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":54,"score":0,"question_id":13161503,"title":"Optimize \"if\" function by row of data frame in R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4042413/r-if-with-vectorized-statements\">R if with vectorized statements</a>  </p>\n</blockquote>\n\n\n\n<p>there's some similar questions on how to best vectorize functions on here, but I can't yet find an example that applies an if-type function, by row for a data frame.</p>\n\n<p>Give a data frame, df, with column \"Year\", which holds year values from 1912 - 2010, I simply want to apply a test of whether a given year is before or after a test year (e.g 1948) and assign a character \"yes\" or \"no\" in another column. Should be easy...</p>\n\n<p>Currently, I have written the code as follows:</p>\n\n<pre><code>i = 1\nwhile (i &lt; nrow(df)) {\n     if (df$Year[i] &lt; 1948) {\n         df$Test[i] &lt;- \"Yes\"        \n     } else { df$Test[i] &lt;- \"No\"\n     }\n     i = i + 1\n }\n</code></pre>\n\n<p>The above works, but is slow with large datasets, and I know that there must be a more \"elegant\" solution for this in R. Would a better approach use apply? Or is there something even simpler?</p>\n\n<p>Thanks!</p>\n"},{"tags":["r","correlation","outliers"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":124,"score":4,"question_id":12851811,"title":"How do I tell R to remove the outlier from a correlation calculation?","body":"<p>How do I tell R to remove an outlier when calculating correlation? I identified a potential outlier from a scatter plot, and am trying to compare correlation with and without this value. This is for an intro stats course; I am just playing with this data to start understanding correlation and outliers.</p>\n\n<p>My data looks like this:</p>\n\n<pre><code>\"Australia\" 35.2 31794.13\n\"Austria\" 29.1 33699.6\n\"Canada\" 32.6 33375.5\n\"CzechRepublic\" 25.4 20538.5\n\"Denmark\" 24.7 33972.62\n...\n</code></pre>\n\n<p>and so on, for 26 lines of data. I am trying to find the correlation of the first and second numbers.</p>\n\n<p>I <em>did</em> read this <a href=\"http://stackoverflow.com/questions/4666590/remove-outliers-from-correlation-coefficient-calculation\">question</a>, however, I am only trying to remove a single point, not a percentage of points. Is there a command in R to do this? </p>\n"},{"tags":["r","table","statistics","publish","output"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":13153692,"title":"Create publishable tables from stat outputs","body":"<p>I'll cut right to the case. I wonder if anyone can point me towards something in which I can make nice publishable tables from outputs from different stat tests, either in R or from other software. </p>\n\n<p>Right know, I have an larger messy output in .txt (from a script using scipy/numpy) format and an output from the ks.test in R. \nI've looked some at xtable in R, for the output from the ks.test. But when assigning the output from the ks.test to a string, e.g. ks=ks.test(x,y) and then try to use xtable, Im getting the error;</p>\n\n<blockquote>\n  <p>no applicable method for 'xtable' applied to an object of class \"htest\"</p>\n</blockquote>\n\n<p>The format of the tables would preferably be in .pdf or .eps (not embedded).  </p>\n"},{"tags":["r","posixct"],"answer_count":1,"favorite_count":1,"up_vote_count":7,"down_vote_count":1,"view_count":71,"score":6,"question_id":13156836,"title":"Character POSIXct Conversion in R causes wrong timezone values on daylight saving time transition (CEST/CET))","body":"<p>I have a problem converting POSIXct to character and back in POSIXct in R. I run the following code:</p>\n\n<pre><code>time_seq_01 &lt;- seq(as.POSIXct(\"2012-10-28 02:00:00\"), by = 900, length.out = 10)\ntime_seq_02 &lt;- as.character(time_seq_01)\ntime_seq_03 &lt;- as.POSIXct(time_seq_02)\n</code></pre>\n\n<p>or equivalent:</p>\n\n<pre><code>time_seq_01 &lt;- seq(as.POSIXct(\"2012-10-28 02:00:00\"), by = 900, length.out = 10)\ntime_seq_02 &lt;- format(time_seq_01,usetz = TRUE)\ntime_seq_03 &lt;- as.POSIXct(time_seq_02)\n</code></pre>\n\n<p>This are the timestamps in 2012 when the daylight saving transition from <strong>Central European Summer Time (CEST)</strong> to <strong>Central European Time (CET)</strong> occurs (Last Sunday in October 02:00 - 03:00).</p>\n\n<p>When I call these elements I get</p>\n\n<pre><code>time_seq_01\n[1] \"2012-10-28 02:00:00 CEST\" \"2012-10-28 02:15:00 CEST\"\n[3] \"2012-10-28 02:30:00 CEST\" \"2012-10-28 02:45:00 CEST\"\n[5] \"2012-10-28 02:00:00 CET\"  \"2012-10-28 02:15:00 CET\" \n[7] \"2012-10-28 02:30:00 CET\"  \"2012-10-28 02:45:00 CET\" \n[9] \"2012-10-28 03:00:00 CET\"  \"2012-10-28 03:15:00 CET\" \ntime_seq_02\n[1] \"2012-10-28 02:00:00 CEST\" \"2012-10-28 02:15:00 CEST\"\n[3] \"2012-10-28 02:30:00 CEST\" \"2012-10-28 02:45:00 CEST\"\n[5] \"2012-10-28 02:00:00 CET\"  \"2012-10-28 02:15:00 CET\" \n[7] \"2012-10-28 02:30:00 CET\"  \"2012-10-28 02:45:00 CET\" \n[9] \"2012-10-28 03:00:00 CET\"  \"2012-10-28 03:15:00 CET\" \ntime_seq_03\n[1] \"2012-10-28 02:00:00 CEST\" \"2012-10-28 02:15:00 CEST\"\n[3] \"2012-10-28 02:30:00 CEST\" \"2012-10-28 02:45:00 CET\" \n[5] \"2012-10-28 02:00:00 CEST\" \"2012-10-28 02:15:00 CEST\"\n[7] \"2012-10-28 02:30:00 CEST\" \"2012-10-28 02:45:00 CET\" \n[9] \"2012-10-28 03:00:00 CET\"  \"2012-10-28 03:15:00 CET\" \n</code></pre>\n\n<p>The creation of a POSIXct sequence does work correctly (<code>time_seq_01</code>) the transition to character also (<code>time_seq_02</code>). However the transition back from character back to POSIXct produces wrong timezone (CET/CEST) values (<code>time_seq_03</code>). This can be clearly seen when those elements are sorted:</p>\n\n<pre><code>sort(time_seq_01)\n[1] \"2012-10-28 02:00:00 CEST\" \"2012-10-28 02:15:00 CEST\"\n[3] \"2012-10-28 02:30:00 CEST\" \"2012-10-28 02:45:00 CEST\"\n[5] \"2012-10-28 02:00:00 CET\"  \"2012-10-28 02:15:00 CET\" \n[7] \"2012-10-28 02:30:00 CET\"  \"2012-10-28 02:45:00 CET\" \n[9] \"2012-10-28 03:00:00 CET\"  \"2012-10-28 03:15:00 CET\" \nsort(time_seq_03)\n[1] \"2012-10-28 02:00:00 CEST\" \"2012-10-28 02:00:00 CEST\"\n[3] \"2012-10-28 02:15:00 CEST\" \"2012-10-28 02:15:00 CEST\"\n[5] \"2012-10-28 02:30:00 CEST\" \"2012-10-28 02:30:00 CEST\"\n[7] \"2012-10-28 02:45:00 CET\"  \"2012-10-28 02:45:00 CET\" \n[9] \"2012-10-28 03:00:00 CET\"  \"2012-10-28 03:15:00 CET\" \n</code></pre>\n\n<p>This causes a number of problems for instance when merging objects by those timestamps. Is there a way to overcome this problem?</p>\n\n<p>The system I use:</p>\n\n<pre><code>Windows 7 64bit\nR version 2.15.1 (2012-06-22)\nPlatform: x86_64-pc-mingw32/x64 (64-bit)\nlocale:\n[1] LC_COLLATE=German_Austria.1252  LC_CTYPE=German_Austria.1252   \n[3] LC_MONETARY=German_Austria.1252 LC_NUMERIC=C                   \n[5] LC_TIME=German_Austria.1252    \nattached base packages:\n[1] tools     stats     graphics  grDevices utils     datasets  methods \n[8] base     \nother attached packages:\n[1] pkgtools_0.1-3 roxygen2_2.2.2 digest_0.5.2   rj_1.1.0-4    \nloaded via a namespace (and not attached):\n[1] brew_1.0-6    plyr_1.7.1    rj.gd_1.1.0-1 stringr_0.6.1\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13159895,"title":"Finding the percentage of values that meet some criterion by columns of a matrix","body":"<p>I've created an 8 x 1000 matrix of Exp() variables.  This represents 1000 iterations (columns) of sampling 8 times from an exponential distribution.  I am trying to figure out how to get the percentage of values in each column that are less than a critical value. So I end up with a vector of 1000 percentages. I've tried a couple things but still being relatively new to R I'm having some difficulty.</p>\n\n<p>This is my current version of code that doesn't quite work. I've used the apply function (without the for loop) when I want the mean or variance of the samples, so I've been trying this approach but this percentage thing seems to require something different. Any thoughts?</p>\n\n<pre><code> m=1000\n n=8\n theta=4\n crit=3\n x=rexp(m*n,1/theta)\n\n Mxs=matrix(x,nrow=n)\n\n ltcrit=matrix(nrow=m,ncol=1)\n\n for(i in 1:m){\n    lt3=apply(Mxs,2,length(which(Mxs[,i]&lt;crit)/n))\n    }\n\n ltcrit\n</code></pre>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13155609,"title":"Returning above and below rows of specific rows in r dataframe","body":"<p>Consider any dataframe </p>\n\n<pre><code>            col1   col2    col3   col4\nrow.name11    A     23      x       y\nrow.name12    A     29      x       y\nrow.name13    B     17      x       y\nrow.name14    A     77      x       y\n</code></pre>\n\n<p>I have a list of rownames which I want to return from this dataframe. Lets say I have row.name12 and row.name13 in a list. I can easily return these rows from dataframe. But I also want to return 4 rows above and 4 rows below these rows. It means I want to return from row.name8 to row.name17. I think it is similar to <code>grep -A -B</code> in shell.</p>\n\n<p>Probable solution- Is there any way to return row number by row name? Because if I have row number than I can easily subtract 4 and add 4 in row number and return rows.</p>\n\n<p>Note: Here rownames are just examples. Rownames could be anything like RED, BLUE, BLACK, etc.</p>\n"},{"tags":["r","plot","rstudio"],"answer_count":6,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":853,"score":4,"question_id":8772630,"title":"Plotting during a loop in RStudio","body":"<p>I am implementing a solution to the Traveling Salesman Problem (TSP) in R (simulated Annealing) and I want to output the current best path periodically.  I have searched quite a bit for how to output plots during a <code>for</code> loop and have thus far failed.  </p>\n\n<p>I use RStudio, and want to see the graphs as they are generated.  If you have ever watched TSP solvers do their thing, you will understand how cool it is to watch.  Here is a sample of the graphics output I want to see <a href=\"http://www.staff.science.uu.nl/~beuke106/anneal/anneal.html\" rel=\"nofollow\">http://www.staff.science.uu.nl/~beuke106/anneal/anneal.html</a></p>\n\n<p>I don't think that the memory usage will be a problem (during about 500,000 iterations, I am only expecting 50-100 plots).  Here is a sample function, where we would expect to see 10 different plots during the time the function runs:</p>\n\n<pre><code>Plotz &lt;- function(iter = 1000000, interval = 100000) {\n  x &lt;- 1:10\n  for(i in 1:iter){\n    y &lt;- runif(10)\n    if(i %% interval == 0) {\n      plot(x, y)\n    }\n  }\n  return(c(x, y))\n}\nPlotz()\n</code></pre>\n\n<p>When I run this, all I see is the final plot produced (in RStudio).  How can I see the plots as they're generated?</p>\n\n<p>Also: I am on Ubuntu (whatever the newest stable release is).  Don't know if that is relevant.</p>\n\n<p>Thank you everyone in advance.</p>\n\n<p>EDIT: Per Captain Murphy's suggestion, I tried running this in the Linux terminal, and the graphics appeared.  I still think the question of \"How to do this in RStudio?\" Is still relevant, however.  It's such a good program, so maybe someone has an idea of what could be done to get this to work?</p>\n\n<p>EDIT2: As Thilo stated, this is a known bug in Rstudio.  If anyone has any other ideas to solve this without the software itself being fixed, then there is still something to discuss.  Otherwise, consider this question solved.</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":4,"up_vote_count":16,"down_vote_count":0,"view_count":3624,"score":16,"question_id":2751065,"title":"How can I manipulate the strip text of facet plots in ggplot2?","body":"<p>I'm wondering how I can manipulate the size of strip text in facetted plots. My question\nis similar to <a href=\"http://stackoverflow.com/questions/2631780/r-ggplot2-can-i-set-the-plot-title-to-wrap-around-and-shrink-the-text-to-fit-th\">a question on plot titles</a>, but I'm specifically concerned with\nmanipulating not the plot title but the text that appears in facet titles (strip_h).</p>\n\n<p>As an example, consider the mpg dataset.</p>\n\n<pre><code>    library(ggplot2) \n    qplot(hwy, cty, data = mpg) + facet_grid( . ~ manufacturer)\n</code></pre>\n\n<p>The resulting <a href=\"http://skitch.com/capbri/dbx1n/quartz-2\" rel=\"nofollow\">output</a> produces some facet titles that don't fit in the strip.</p>\n\n<p>I'm thinking there must be a way to use <code>grid</code> to deal with the strip text. But I'm\nstill a novice and wasn't sure from the <code>grid</code> appendix in <a href=\"http://rads.stackoverflow.com/amzn/click/0387981403\" rel=\"nofollow\">Hadley's book</a> how,\nprecisely, to do it. Also, I was afraid if I did it wrong it would break my washing\nmachine, since I believe all technology is connected through The Force :-(</p>\n\n<p>Many thanks in advance.</p>\n"},{"tags":["r","ode","threshold"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13154681,"title":"How to solve ODEs with an internal threshold?","body":"<p>I have the following function containing some odes:</p>\n\n<pre><code>myfunction &lt;- function(t, state, parameters) {\n    with(as.list(c(state, parameters)),{\n        if (X&gt;20) {           # this is an internal threshold!\n          Y &lt;- 35000\n          dY &lt;- 0\n        }else{\n          dY &lt;- b * (Y-Z) \n        }\n        dX &lt;- a*X^6 + Y*Z\n        dZ &lt;- -X*Y + c*Y - Z\n        # return the rate of change\n        list(c(dX, dY, dZ),Y,dY)\n    })\n}\n</code></pre>\n\n<p>Here are some results:</p>\n\n<pre><code>library(deSolve)\nparameters &lt;- c(a = -8/3, b = -10, c = 28)\nstate &lt;- c(X = 1, Y = 1, Z = 1)\ntimes &lt;- seq(0, 10, by = 0.1)\nout &lt;- ode(y = state, times = times, func = myfunction, parms = parameters)\nout\n     time         X            Y            Z            Y          dY\n 1    0.0  1.000000     1.000000     1.000000     1.000000     0.00000\n 2    0.1  1.104670     2.132728     4.470145     2.132728    23.37417\n 3    0.2  1.783117     6.598806    14.086158     6.598806    74.87351\n 4    0.3  2.620428    20.325966    42.957134    20.325966   226.31169\n 5    0.4  3.775597    60.969424   126.920014    60.969424   659.50590\n 6    0.5  5.358823   176.094907   358.726482   176.094907  1826.31575\n 7    0.6  7.460841   482.506706   953.270570   482.506706  4707.63864\n 8    0.7 10.122371  1230.831764  2330.599161  1230.831764 10997.67398\n 9    0.8 13.279052  2859.284114  5113.458479  2859.284114 22541.74365\n10    0.9 16.711405  5912.675147  9823.406760  5912.675147 39107.31613\n11    1.0 24.452867 10590.600567 16288.435139 35000.000000     0.00000\n12    1.1 25.988924 10590.600567 23476.343542 35000.000000     0.00000\n13    1.2 26.572411 10590.600567 26821.703961 35000.000000     0.00000\n14    1.3 26.844240 10590.600567 28510.668725 35000.000000     0.00000\n15    1.4 26.980647 10590.600567 29391.032472 35000.000000     0.00000\n...\n</code></pre>\n\n<p>States Y are different, can anybody explain me why please?</p>\n\n<p>I believe I haven't set my threshold correctly.\nIs there a way to that?</p>\n\n<p>Thanks! </p>\n"},{"tags":["r","inheritance","s4"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":37,"score":3,"question_id":13149517,"title":"R: Applying terms.formula on an S4 object inheriting data.frame","body":"<p>I'm trying to create a new class that inherits from data frame:</p>\n\n<pre><code>&gt; setClass('new.frame',\n    representation(colour='character'),\n    contains = 'data.frame')\n</code></pre>\n\n<p>This is an instance of that class, for testing:</p>\n\n<pre><code>&gt; test_data = data.frame(cbind(runif(5), runif(5)))\n&gt; names(test_data) = c('X', 'Y')\n&gt; test_frame = new('new.frame', test_data, colour='red')\n</code></pre>\n\n<p>Just to make sure it looks all right...</p>\n\n<pre><code>&gt; data.frame\nObject of class \"new.frame\"\n          X         Y\n1 0.8766306 0.4741213\n2 0.1221508 0.5117665\n3 0.4838761 0.4973627\n4 0.7858294 0.4064749\n5 0.5147703 0.9135304\nSlot \"colour\":\n[1] \"red\"\n</code></pre>\n\n<p>... and to make sure that the inheritance worked</p>\n\n<pre><code>&gt; is.data.frame(test_frame)\n[1] TRUE\n&gt; getClass(class(test_frame))\nClass \"new.frame\" [in \".GlobalEnv\"]\n\nSlots:\n\nName:                .Data              colour               names\nClass:                list           character           character\n\nName:            row.names            .S3Class\nClass: data.frameRowLabels           character\n\nExtends: \nClass \"data.frame\", directly\nClass \"list\", by class \"data.frame\", distance 2\nClass \"oldClass\", by class \"data.frame\", distance 2\nClass \"vector\", by class \"data.frame\", distance 3\n</code></pre>\n\n<p>Here is the problem I encountered when I tried to utilize the property of being a data frame:</p>\n\n<pre><code>&gt; terms.formula(Y ~ X, data = test_frame)\nError in terms.formula(Y ~ X, data = test_frame) : \n  'data' argument is of the wrong type\n</code></pre>\n\n<p>I might have missed something silly. If so, thanks in advance for pointing it out.</p>\n\n<p>If I'm correct about the problem here, is there anyway I can make terms.formula recognize the fact that I'm giving it a data.frame?</p>\n"},{"tags":["windows","r","cygwin","rcpp","rinside"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":87,"score":-1,"question_id":13137770,"title":"Fatal error: Unable to open the base package","body":"<p>So, now I have managed to compile the hello program of <strong>RInside</strong> on <strong>WindowsXP</strong> (VirtualBox). But, when I click on its executable, I get a dialogbox showing the above error.</p>\n\n<p>Searching Google led me to <a href=\"http://lists.r-forge.r-project.org/pipermail/rcpp-devel/2012-February/003476.html\" rel=\"nofollow\">this thread</a> where they were talking about the following settings.</p>\n\n<p><strong>R:</strong></p>\n\n<pre><code>&gt; Sys.getenv(\"R_LIBS\")\n[1] \"\"\n&gt; Sys.getenv(\"R_LIBS_USER\")\n[1] \"C:\\\\Documents and Settings\\\\admin\\\\My Documents/R/win-library/2.15\"\n&gt; Sys.getenv(\"R_HOME\")\n[1] \"C:/R-2.15.1\"\n&gt; sessionInfo ()\nR version 2.15.1 (2012-06-22)\nPlatform: i386-pc-mingw32/i386 (32-bit)\n\nlocale:\n[1] LC_COLLATE=English_United States.1252 \n[2] LC_CTYPE=English_United States.1252   \n[3] LC_MONETARY=English_United States.1252\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.1252    \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n&gt; \n</code></pre>\n\n<p>From here: <a href=\"http://cran.r-project.org/bin/windows/base/rw-FAQ.html#How-do-I-set-environment-variables_003f\" rel=\"nofollow\">http://cran.r-project.org/bin/windows/base/rw-FAQ.html#How-do-I-set-environment-variables_003f</a></p>\n\n<blockquote>\n  <p>The order of precedence for environmental variables is the order in which these options are listed, that is the command line then .Renviron then the inherited environment. </p>\n</blockquote>\n\n<p><strong>PATH:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/MpEwN.png\" alt=\"enter image description here\"></p>\n\n<p><strong>Rcmd_environ:</strong></p>\n\n<pre><code>## from R.sh\nR_SHARE_DIR=${R_HOME}/share\nR_INCLUDE_DIR=${R_HOME}/include\nR_DOC_DIR=${R_HOME}/doc\nR_ARCH=\n\n## from Rcmd\nR_OSTYPE=windows\nTEXINPUTS=.;${TEXINPUTS};${R_SHARE_DIR}/texmf/tex/latex;\nBIBINPUTS=.;${BIBINPUTS};${R_SHARE_DIR}/texmf/bibtex/bib;\nBSTINPUTS=.;${BSTINPUTS};${R_SHARE_DIR}/texmf/bibtex/bst;\n\n## from etc/Renviron\n# R_PLATFORM='i386-pc-mingw32'\nR_PAPERSIZE_USER=${R_PAPERSIZE}\nR_PAPERSIZE=${R_PAPERSIZE-'a4'}\n# for Rd2dpf, reference manual\nR_RD4PDF=${R_RD4PDF-'times,inconsolata,hyper'}\n## used for options(\"texi2dvi\")\n# R_TEXI2DVICMD=${R_TEXI2DVICMD-${TEXI2DVI-'texi2dvi'}}\n## used by INSTALL, check, build\nR_GZIPCMD=${R_GZIPCMD-'gzip'}\n## Default zip/unzip commands\nR_UNZIPCMD=${R_UNZIPCMD-'unzip'}\nR_ZIPCMD=${R_ZIPCMD-'zip'}\nR_BZIPCMD=${R_BZIPCMD-'bzip2'}\n## Default browser\n# R_BROWSER=${R_BROWSER-'open'}\n## Default editor\n# EDITOR=${EDITOR-${VISUAL-vi}}\n## Default pager\n# PAGER=${PAGER-''}\n## Default PDF viewer\n# R_PDFVIEWER=${R_PDFVIEWER-'open'}\n# MAKE=${MAKE-make}\nSED=${SED-sed}\n\nR_LIBS=c:/DOCUME~1/admin/MYDOCU~1/R/win-library/2.15;\n</code></pre>\n\n<p><strong>Rprofile:</strong></p>\n\n<pre><code># Things you might want to change\n\n# options(papersize=\"a4\")\n# options(editor=\"notepad\")\n# options(pager=\"internal\")\n\n# set the default help type\n# options(help_type=\"text\")\n  options(help_type=\"html\")\n\n# set a site library\n.Library.site &lt;- file.path(chartr(\"\\\\\", \"/\", R.home()), \"site-library\")\n\n\n# set a CRAN mirror\n# local({r &lt;- getOption(\"repos\")\n#       r[\"CRAN\"] &lt;- \"http://my.local.cran\"\n#       options(repos=r)})\n\n# Give a fortune cookie, but only to interactive sessions\n# (This would need the fortunes package to be installed.)\n#  if (interactive()) \n#    fortunes::fortune()\n</code></pre>\n\n<p>Please point out the point that I am missing.</p>\n"},{"tags":["r","function","data.frame","data.table","names"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12309098,"title":"R: Function to add names to data frame","body":"<p>I'm have a data frame without columns:</p>\n\n<pre><code>df&lt;-data.frame(v1=c(1:10), v2=seq(1, 100, length=10))\n</code></pre>\n\n<p>I want to change the header names to \"X\" and \"Y\"</p>\n\n<p>I know I can do this using:</p>\n\n<pre><code>names(df)&lt;-c(\"X\",\"Y\")\n</code></pre>\n\n<p>What I would like to do is write a function where I could pass a data frame as an argument, and place the headers with these header names.</p>\n\n<p>I've tried:</p>\n\n<pre><code>get.names&lt;- function(x)\n    {names(x)&lt;-c(\"X\", \"Y\")}\n</code></pre>\n\n<p>Thanks in advance for any help.</p>\n"},{"tags":["r","sorting","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13156448,"title":"How can I sort a data.frame with only one column, without losing rownames?","body":"<pre><code>data = c(1,2,3,4)\nnames = c(\"foo\", \"bar\", \"baz\", \"yak\")\nd = data.frame(data, row.names=names)\n</code></pre>\n\n<p>This returns:</p>\n\n<pre><code>    data\nfoo    1\nbar    2\nbaz    3\nyak    4\n</code></pre>\n\n<p>Now, I'd like to sort this dataframe by the column, without losing the row names attached. So, my result would be:</p>\n\n<pre><code>    data\nyak    4\nbaz    3\nbar    2\nfoo    1\n</code></pre>\n\n<hr>\n\n<p>I've already tried the following:</p>\n\n<ul>\n<li><p><code>d[order(-d$data),]</code>, which of course only gives me the one-dimensional list.</p></li>\n<li><p><code>arrange(d, desc(data))</code> from the <code>plyr</code> package, which drops the row names.</p></li>\n<li><p>Find out the order with <code>o = order(-d$data)</code>, then reconstruct the frame with </p>\n\n<pre><code>data.frame(d[o,], row.names=rownames(d)[o])\n</code></pre>\n\n<p>… which still leaves me with the wrong column name.</p></li>\n</ul>\n\n<p>Is there any sane way to do this?</p>\n"},{"tags":["r","list","data.frame"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13153672,"title":"Extracting a dataframe with unique elements from a list","body":"<p>Hi I got a list like that </p>\n\n<pre><code>$`2`\n  chr.pos  nt.pos CNV GRP\n      1  783605   1   2\n      1  888149   1   2\n      1  991311   1   2\n      1 1089305   1   2\n      1 1177669   1   2\n\n$`4`\n chr.pos  nt.pos CNV GRP\n      2 1670488   1   4\n      2 1758800   1   4\n\n$`6`\n chr.pos  nt.pos CNV GRP\n      2 1902924   1   6\n      2 1978088   1   6\n</code></pre>\n\n<p>and I want to extract for each element,  the unique chromosome, the CNV and the group and the highest and lowest nt.pos, so the output would be, I prefer a data frame</p>\n\n<pre><code>chr.pos  Start     End       GRP\n 1         783605    1177669   2\n 2         1670488   175880    4\n 2         1902924   1978088   6\n</code></pre>\n\n<p>I tried with this </p>\n\n<pre><code>results&lt;-lapply(mylist, function(x){\n\nreturn(as.data.frame(unique(x$chr.pos),range(x$nt.pos)[1],range(x$nt.pos)  [2],unique(x$GRP)))\n\n}\n) \n</code></pre>\n\n<p>But of course, what I got is a list.</p>\n\n<p>Could you help me please?</p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":2,"up_vote_count":6,"down_vote_count":1,"view_count":333,"score":5,"question_id":12850141,"title":"Programming-safe version of subset - to evaluate its condition while called from another function","body":"<p>As <code>subset()</code> manual states: </p>\n\n<blockquote>\n  <p><strong>Warning</strong>: This is a convenience function intended for use interactively</p>\n</blockquote>\n\n<p>I learned from <a href=\"https://github.com/hadley/devtools/wiki/Evaluation\" rel=\"nofollow\">this great article</a> not only the secret behind this warning, but a good understanding of <code>substitute()</code>, <code>match.call()</code>, <code>eval()</code>, <code>quote()</code>, ‍<code>call</code>, <code>promise</code> and other related R subjects, that are a little bit complicated.</p>\n\n<p>Now I understand what's the warning above for. A super-simple implementation of <code>subset()</code> could be as follows:</p>\n\n<pre><code>subset = function(x, condition) x[eval(substitute(condition), envir=x),]\n</code></pre>\n\n<p>While <code>subset(mtcars, cyl==4)</code> returns the table of rows in <code>mtcars</code> that satisfy <code>cyl==4</code>, enveloping <code>subset()</code> in another function fails:</p>\n\n<pre><code>sub = function(x, condition) subset(x, condition)\n\nsub(mtcars, cyl == 4)\n# Error in eval(expr, envir, enclos) : object 'cyl' not found\n</code></pre>\n\n<p>Using the original version of <code>subset()</code> also produces exactly the same error condition. This is due to the limitation of <code>substitute()-eval()</code> pair: It works fine while <code>condition</code> is <code>cyl==4</code>, but when the <code>condition</code> is passed through the enveloping function <code>sub()</code>, the <code>condition</code> argument of <code>subset()</code> will be no longer <code>cyl==4</code>, but the nested <code>condition</code> in the <code>sub()</code> body, and the <code>eval()</code> fails - it's a bit complicated.</p>\n\n<p>But does it exist any other implementation of <code>subset()</code> with <strong>exactly the same arguments</strong> that would be programming-safe - i.e. able to evaluate its condition while it's called by another function?</p>\n"},{"tags":["c++","r","tree","spatial","bulk-load"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13135026,"title":"BulkLoading the R* tree with spatialindex library","body":"<p>After successfully building the R* tree with spatial library inserting records one-by-one 2.5 million of times, I was trying to create the R* tree with bulkloading. I implemented the DBStream class to iteratively give the data to the BulkLoader. Essentially, it invokes the following method and prepared a Data (d variable in the code) object for the Bulkloader:</p>\n\n<pre><code>void DBStream::retrieveTuple() {\nif (query.next()) {\n    hasNextBool = true;\n\n    int gid = query.value(0).toInt();\n\n            // allocate memory for bounding box\n            // this streets[gid].first returns bbox[4]\n    double* bbox = streets[gid].first;\n\n            // filling the bounding box values\n    bbox[0] = query.value(1).toDouble();\n    bbox[1] = query.value(2).toDouble();\n    bbox[2] = query.value(3).toDouble();\n    bbox[3] = query.value(4).toDouble();\n\n    rowId++;\n\n    r = new SpatialIndex::Region();\n    d = new SpatialIndex::RTree::Data((size_t) 0, (byte*) 0, *r, gid);\n    r-&gt;m_dimension = 2;\n    d-&gt;m_pData = 0;\n    d-&gt;m_dataLength = 0;\n\n    r-&gt;m_pLow = bbox;\n    r-&gt;m_pHigh = bbox + 2;\n    d-&gt;m_id = gid;\n} else {\n    d = 0;\n    hasNextBool = false;\n    cout &lt;&lt; \"stream is finished d:\" &lt;&lt; d &lt;&lt; endl;\n}\n}\n</code></pre>\n\n<p>I initialize the DBStream object and invoke the bulk loading in the following way:</p>\n\n<pre><code>// creating a main memory RTree\nmemStorage = StorageManager::createNewMemoryStorageManager();\n\nsize_t capacity = 1000;\nbool bWriteThrough = false;\nfileInMem = StorageManager\n   ::createNewRandomEvictionsBuffer(*memStorage, capacity, bWriteThrough);\n\ndouble fillFactor = 0.7;\nsize_t indexCapacity = 100;\nsize_t leafCapacity = 100;\nsize_t dimension = 2;\nRTree::RTreeVariant rv = RTree::RV_RSTAR;\n\nDBStream dstream();\n\ntree = RTree::createAndBulkLoadNewRTree(SpatialIndex::RTree::BLM_STR, dstream,\n   *fileInMem,\n   fillFactor, indexCapacity,\n   leafCapacity, dimension, rv, indexIdentifier);\n\ncout &lt;&lt; \"BulkLoading done\" &lt;&lt; endl;\n</code></pre>\n\n<p>Bulk loading calls my next() and hasNext() functions, retrieved my data, sorts it and then seg faults in the building phase. Any clues way? Yeah, the error is:</p>\n\n<pre><code>    RTree::BulkLoader: Building level 0\n    terminate called after throwing an instance of 'Tools::IllegalArgumentException'\n</code></pre>\n"},{"tags":["r"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13124161,"title":"Dynamic panel data with plm. Error \"solve.default(Reduce(\"+\", A1)) \"","body":"<p>I have a df in <code>pdata.frame</code> format from plm library :</p>\n\n<p><code>library(plm)</code></p>\n\n<pre><code>   head(df) :  \n\n       Company Year Kapitalinkomster Bank.o.kassa\n3-1920       3 1920         1.388520    0.5520765\n3-1921       3 1921         1.251319    0.6952595\n3-1922       3 1922         1.001186    0.9812447\n3-1923       3 1923         1.056346    1.4212759\n3-1924       3 1924         1.451935    0.9596924\n3-1925       3 1925         1.435478    0.2283118\n\ndim(df) :\n[1] 1196    4\n\n\nstr(df) :\nClasses ‘pdata.frame’ and 'data.frame': 1196 obs. of  4 variables:\n $ Company         : Factor w/ 42 levels \"3\",\"4\",\"5\",\"6\",..: 1 1 1 1 1 1 1 1 1 1 ...\n  ..- attr(*, \"index\")='data.frame':    1196 obs. of  2 variables:\n  .. ..$ Company: Factor w/ 42 levels \"3\",\"4\",\"5\",\"6\",..: 1 1 1 1 1 1 1 1 1 1 ...\n  .. ..$ Year   : Factor w/ 62 levels \"1887\",\"1888\",..: 34 35 36 37 38 39 40 41 42 43 ...\n  ..- attr(*, \"names\")= chr  \"3-1920\" \"3-1921\" \"3-1922\" \"3-1923\" ...\n $ Year            : Factor w/ 62 levels \"1887\",\"1888\",..: 34 35 36 37 38 39 40 41 42 43 ...\n  ..- attr(*, \"index\")='data.frame':    1196 obs. of  2 variables:\n  .. ..$ Company: Factor w/ 42 levels \"3\",\"4\",\"5\",\"6\",..: 1 1 1 1 1 1 1 1 1 1 ...\n  .. ..$ Year   : Factor w/ 62 levels \"1887\",\"1888\",..: 34 35 36 37 38 39 40 41 42 43 ...\n  ..- attr(*, \"names\")= chr  \"3-1920\" \"3-1921\" \"3-1922\" \"3-1923\" ...\n $ Kapitalinkomster:Classes 'pseries', 'numeric'  atomic [1:1196] 1.39 1.25 1 1.06 1.45 ...\n  .. ..- attr(*, \"index\")='data.frame': 1196 obs. of  2 variables:\n  .. .. ..$ Company: Factor w/ 42 levels \"3\",\"4\",\"5\",\"6\",..: 1 1 1 1 1 1 1 1 1 1 ...\n  .. .. ..$ Year   : Factor w/ 62 levels \"1887\",\"1888\",..: 34 35 36 37 38 39 40 41 42 43 ...\n $ Bank.o.kassa    :Classes 'pseries', 'numeric'  atomic [1:1196] 0.552 0.695 0.981 1.421 0.96 ...\n  .. ..- attr(*, \"index\")='data.frame': 1196 obs. of  2 variables:\n  .. .. ..$ Company: Factor w/ 42 levels \"3\",\"4\",\"5\",\"6\",..: 1 1 1 1 1 1 1 1 1 1 ...\n  .. .. ..$ Year   : Factor w/ 62 levels \"1887\",\"1888\",..: 34 35 36 37 38 39 40 41 42 43 ...\n - attr(*, \"index\")='data.frame':   1196 obs. of  2 variables:\n  ..$ Company: Factor w/ 42 levels \"3\",\"4\",\"5\",\"6\",..: 1 1 1 1 1 1 1 1 1 1 ...\n  ..$ Year   : Factor w/ 62 levels \"1887\",\"1888\",..: 34 35 36 37 38 39 40 41 42 43 ...\n</code></pre>\n\n<p>I try to do a two-step dynamic random panel data model,as in plm tutorial pdf on page 23:\n<a href=\"ftp://mirror.cict.fr/cran/web/packages/plm/vignettes/plm.pdf\" rel=\"nofollow\">plm vignette</a></p>\n\n<pre><code>dynamicrandom=pgmm(Kapitalinkomster~lag(Kapitalinkomster,1)+Bank.o.kassa|lag(Kapitalinkomster,2:99),\n                   data=df,effect=\"twoways\",model=\"twosteps\")\n</code></pre>\n\n<p>Then I get this <code>error</code> :</p>\n\n<pre><code>Error in solve.default(Reduce(\"+\", A1)) : \n  system is computationally singular: reciprocal condition number = 8.46296e-2\n\ntraceback()\n3: solve.default(Reduce(\"+\", A1))\n2: solve(Reduce(\"+\", A1))\n1: pgmm(Kapitalinkomster ~ lag(Kapitalinkomster, 1) + Bank.o.kassa | \n       lag(Kapitalinkomster, 2:99), data = datapd, effect = \"individual\", \n       model = \"twosteps\")\n</code></pre>\n\n<p>I find it quite strange. </p>\n\n<p>If I try to run <code>pgmm</code> with a smaller data set, where all the \"unnecessary\" variables are dropped, </p>\n\n<pre><code>dim(ph)\n[1] 300   4\n\nrownames(ph)=NULL\n\nhead(ph)\n  Company Year Kapitalinkomster Bank.o.kassa\n1       3 1920         1.388520    0.5520765\n2       3 1921         1.251319    0.6952595\n3       3 1922         1.001186    0.9812447\n4       3 1923         1.056346    1.4212759\n5       3 1924         1.451935    0.9596924\n6       3 1925         1.435478    0.2283118\n</code></pre>\n\n<p>I get the error</p>\n\n<pre><code>Error in yX[[1]] : subscript out of bounds\nIn addition: Warning message:\nIn `[.data.frame`(index, as.numeric(rownames(mf)), ) :\n  NAs introduced by coercion\n</code></pre>\n\n<p>Does someone has any idea about why <code>pgmm</code> is not working for me?</p>\n\n<p>Here is </p>\n\n<pre><code>    dput(df[1:60,])\nstructure(list(Company = structure(c(1L, 1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, \n2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, \n2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, \n2L, 2L, 2L, 2L, 2L, 2L), .Names = c(\"3-1920\", \"3-1921\", \"3-1922\", \n\"3-1923\", \"3-1924\", \"3-1925\", \"3-1926\", \"3-1927\", \"3-1928\", \"3-1929\", \n\"3-1930\", \"3-1931\", \"3-1932\", \"3-1933\", \"3-1934\", \"3-1935\", \"3-1936\", \n\"4-1887\", \"4-1888\", \"4-1889\", \"4-1890\", \"4-1891\", \"4-1892\", \"4-1893\", \n\"4-1894\", \"4-1895\", \"4-1896\", \"4-1897\", \"4-1898\", \"4-1899\", \"4-1900\", \n\"4-1901\", \"4-1902\", \"4-1903\", \"4-1904\", \"4-1905\", \"4-1906\", \"4-1907\", \n\"4-1908\", \"4-1909\", \"4-1910\", \"4-1911\", \"4-1912\", \"4-1913\", \"4-1914\", \n\"4-1915\", \"4-1916\", \"4-1917\", \"4-1918\", \"4-1919\", \"4-1920\", \"4-1921\", \n\"4-1922\", \"4-1923\", \"4-1924\", \"4-1925\", \"4-1926\", \"4-1927\", \"4-1928\", \n\"4-1929\"), .Label = c(\"3\", \"4\", \"5\", \"6\", \"10\", \"12\", \"14\", \"19\", \n\"20\", \"21\", \"25\", \"26\", \"29\", \"33\", \"34\", \"35\", \"40\", \"43\", \"45\", \n\"46\", \"47\", \"48\", \"49\", \"57\", \"58\", \"59\", \"60\", \"62\", \"64\", \"65\", \n\"68\", \"69\", \"71\", \"72\", \"73\", \"74\", \"76\", \"77\", \"79\", \"80\", \"83\", \n\"84\"), class = c(\"pseries\", \"factor\")), Year = structure(c(34L, \n35L, 36L, 37L, 38L, 39L, 40L, 41L, 42L, 43L, 44L, 45L, 46L, 47L, \n48L, 49L, 50L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, \n12L, 13L, 14L, 15L, 16L, 17L, 18L, 19L, 20L, 21L, 22L, 23L, 24L, \n25L, 26L, 27L, 28L, 29L, 30L, 31L, 32L, 33L, 34L, 35L, 36L, 37L, \n38L, 39L, 40L, 41L, 42L, 43L), .Names = c(\"3-1920\", \"3-1921\", \n\"3-1922\", \"3-1923\", \"3-1924\", \"3-1925\", \"3-1926\", \"3-1927\", \"3-1928\", \n\"3-1929\", \"3-1930\", \"3-1931\", \"3-1932\", \"3-1933\", \"3-1934\", \"3-1935\", \n\"3-1936\", \"4-1887\", \"4-1888\", \"4-1889\", \"4-1890\", \"4-1891\", \"4-1892\", \n\"4-1893\", \"4-1894\", \"4-1895\", \"4-1896\", \"4-1897\", \"4-1898\", \"4-1899\", \n\"4-1900\", \"4-1901\", \"4-1902\", \"4-1903\", \"4-1904\", \"4-1905\", \"4-1906\", \n\"4-1907\", \"4-1908\", \"4-1909\", \"4-1910\", \"4-1911\", \"4-1912\", \"4-1913\", \n\"4-1914\", \"4-1915\", \"4-1916\", \"4-1917\", \"4-1918\", \"4-1919\", \"4-1920\", \n\"4-1921\", \"4-1922\", \"4-1923\", \"4-1924\", \"4-1925\", \"4-1926\", \"4-1927\", \n\"4-1928\", \"4-1929\"), .Label = c(\"1887\", \"1888\", \"1889\", \"1890\", \n\"1891\", \"1892\", \"1893\", \"1894\", \"1895\", \"1896\", \"1897\", \"1898\", \n\"1899\", \"1900\", \"1901\", \"1902\", \"1903\", \"1904\", \"1905\", \"1906\", \n\"1907\", \"1908\", \"1909\", \"1910\", \"1911\", \"1912\", \"1913\", \"1914\", \n\"1915\", \"1916\", \"1917\", \"1918\", \"1919\", \"1920\", \"1921\", \"1922\", \n\"1923\", \"1924\", \"1925\", \"1926\", \"1927\", \"1928\", \"1929\", \"1930\", \n\"1931\", \"1932\", \"1933\", \"1934\", \"1935\", \"1936\", \"1937\", \"1938\", \n\"1939\", \"1940\", \"1941\", \"1942\", \"1943\", \"1944\", \"1945\", \"1946\", \n\"1947\", \"1948\"), class = c(\"pseries\", \"factor\")), Kapitalinkomster = structure(c(1.3885195254922, \n1.25131942960191, 1.00118642574671, 1.05634611761787, 1.45193473728394, \n1.43547824494178, 1.38055601480859, 1.34933328550615, 1.28899624736276, \n0.76598077860797, 0.655935113492874, 0.774737637154851, 1.25108435851729, \n1.47671292146985, 1.34370424443801, 1.32632101821461, 1.51421133098558, \n1.26164769097955, 0.955087391528799, 1.12112930644918, 6.97097381553989, \n7.79692376727096, 6.75239407150735, 2.08849093781665, 2.59292961541875, \n3.11050340941574, 2.96014979405135, 5.52806493525727, 4.2921092782187, \n4.6719464983905, 3.83041286491572, 4.07770060833387, 4.25073315665221, \n4.3909964974014, 4.11259760549932, 4.28222569526617, 3.79412435277674, \n4.01135863256581, 4.3810637384393, 4.45988129747339, 4.44638766670966, \n4.09501035463032, 4.71990150360464, 4.67768296668679, 4.4802955128012, \n5.04020000347546, 5.12446555871404, 4.75796798559771, 7.5561386506949, \n4.88420437113848, 4.84541975371883, 5.18996412420159, 5.17554303094439, \n5.39663296271381, 5.61129389005161, 5.33778018090439, 5.49889317435039, \n5.24776724759386, 4.83822195731842, 4.90661955903865), .Names = c(\"3-1920\", \n\"3-1921\", \"3-1922\", \"3-1923\", \"3-1924\", \"3-1925\", \"3-1926\", \"3-1927\", \n\"3-1928\", \"3-1929\", \"3-1930\", \"3-1931\", \"3-1932\", \"3-1933\", \"3-1934\", \n\"3-1935\", \"3-1936\", \"4-1887\", \"4-1888\", \"4-1889\", \"4-1890\", \"4-1891\", \n\"4-1892\", \"4-1893\", \"4-1894\", \"4-1895\", \"4-1896\", \"4-1897\", \"4-1898\", \n\"4-1899\", \"4-1900\", \"4-1901\", \"4-1902\", \"4-1903\", \"4-1904\", \"4-1905\", \n\"4-1906\", \"4-1907\", \"4-1908\", \"4-1909\", \"4-1910\", \"4-1911\", \"4-1912\", \n\"4-1913\", \"4-1914\", \"4-1915\", \"4-1916\", \"4-1917\", \"4-1918\", \"4-1919\", \n\"4-1920\", \"4-1921\", \"4-1922\", \"4-1923\", \"4-1924\", \"4-1925\", \"4-1926\", \n\"4-1927\", \"4-1928\", \"4-1929\")), Aktiebolag = structure(c(0L, \n0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, \n0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, \n0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, \n0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L), .Names = c(\"3-1920\", \n\"3-1921\", \"3-1922\", \"3-1923\", \"3-1924\", \"3-1925\", \"3-1926\", \"3-1927\", \n\"3-1928\", \"3-1929\", \"3-1930\", \"3-1931\", \"3-1932\", \"3-1933\", \"3-1934\", \n\"3-1935\", \"3-1936\", \"4-1887\", \"4-1888\", \"4-1889\", \"4-1890\", \"4-1891\", \n\"4-1892\", \"4-1893\", \"4-1894\", \"4-1895\", \"4-1896\", \"4-1897\", \"4-1898\", \n\"4-1899\", \"4-1900\", \"4-1901\", \"4-1902\", \"4-1903\", \"4-1904\", \"4-1905\", \n\"4-1906\", \"4-1907\", \"4-1908\", \"4-1909\", \"4-1910\", \"4-1911\", \"4-1912\", \n\"4-1913\", \"4-1914\", \"4-1915\", \"4-1916\", \"4-1917\", \"4-1918\", \"4-1919\", \n\"4-1920\", \"4-1921\", \"4-1922\", \"4-1923\", \"4-1924\", \"4-1925\", \"4-1926\", \n\"4-1927\", \"4-1928\", \"4-1929\")), Bank.o.kassa = structure(c(0.552076466710613, \n0.695259455479398, 0.981244655715202, 1.42127589620433, 0.959692448821232, \n0.228311793009368, 0.30871924158571, 2.69943145432275, 3.04368302717424, \n3.05290552372935, 4.24442587875512, 2.43324032807521, 4.69502073549705, \n4.21425554491043, 3.43802415683905, 1.91228479124126, 0.183612711919672, \n1.93873324222939, 0.658324934241255, 1.65583430229754, 8.16610788753491, \n10.6696930067877, 6.20505938433427, 0.768959064173528, 2.47147653520727, \n1.4749677888885, 2.1905085760638, 10.4511636424978, 18.4910241070292, \n15.5739616534392, 11.4808752327392, 7.18593926102981, 4.79510448317011, \n2.85703955642673, 1.82405600468293, 1.14336459853929, 1.91224006506971, \n1.86664771087767, 3.29991106032535, 3.01042462888444, 6.84688859551067, \n4.5949838689742, 4.95776617931262, 6.01761059832527, 5.12621851069932, \n2.36515966545918, 2.50574176281981, 1.88913570646181, 2.12361708504312, \n1.70295644658185, 0.237788523257187, 3.94594260772663, 0.514660379058555, \n0.63723501085728, 0.163482237867645, 0.197324873476979, 0.692618649628274, \n0.316872042668265, 1.67508648494876, 0.142354356664425), .Names = c(\"3-1920\", \n\"3-1921\", \"3-1922\", \"3-1923\", \"3-1924\", \"3-1925\", \"3-1926\", \"3-1927\", \n\"3-1928\", \"3-1929\", \"3-1930\", \"3-1931\", \"3-1932\", \"3-1933\", \"3-1934\", \n\"3-1935\", \"3-1936\", \"4-1887\", \"4-1888\", \"4-1889\", \"4-1890\", \"4-1891\", \n\"4-1892\", \"4-1893\", \"4-1894\", \"4-1895\", \"4-1896\", \"4-1897\", \"4-1898\", \n\"4-1899\", \"4-1900\", \"4-1901\", \"4-1902\", \"4-1903\", \"4-1904\", \"4-1905\", \n\"4-1906\", \"4-1907\", \"4-1908\", \"4-1909\", \"4-1910\", \"4-1911\", \"4-1912\", \n\"4-1913\", \"4-1914\", \"4-1915\", \"4-1916\", \"4-1917\", \"4-1918\", \"4-1919\", \n\"4-1920\", \"4-1921\", \"4-1922\", \"4-1923\", \"4-1924\", \"4-1925\", \"4-1926\", \n\"4-1927\", \"4-1928\", \"4-1929\")), Obligationer = structure(c(0, \n0.710619775236431, 0.569764858043086, 0.663694337104649, 0.761033448298168, \n0.319840031930296, 0.312307395488807, 0.0346835018362475, 0.0330125633514856, \n0.0188647549138383, 0.0151764700315497, 0.018196428174861, 0.0300829419881919, \n9.20824963171287, 8.09476461975424, 7.33591599214263, 10.3237519153303, \n23.4587496564246, 8.34307628014455, 8.21105338961859, 19.3630967796124, \n18.5571303656964, 26.520466175308, 7.10867944326549, 6.98218342383004, \n6.27961874258339, 5.04505474511001, 6.80023508002221, 8.77338607338471, \n8.86362404959709, 7.75977758606352, 10.3435727294857, 9.89547857880742, \n9.53223792314849, 11.9082814125304, 12.8046506505709, 15.1592108784811, \n15.398922387006, 15.1136243789378, 14.6794808956586, 14.2827955517189, \n14.7029129176851, 15.5305565249781, 14.9495702592336, 13.5321062823358, \n16.9791185495982, 27.5452432427652, 35.5636383102538, 31.5779522681227, \n31.3394353672748, 38.0906430075851, 39.4360188809573, 40.2139304909776, \n40.592971239732, 37.6076781083026, 34.5895784054617, 31.8919927541514, \n29.1162189615666, 26.8061925543101, 27.0963897344843), .Names = c(\"3-1920\", \n\"3-1921\", \"3-1922\", \"3-1923\", \"3-1924\", \"3-1925\", \"3-1926\", \"3-1927\", \n\"3-1928\", \"3-1929\", \"3-1930\", \"3-1931\", \"3-1932\", \"3-1933\", \"3-1934\", \n\"3-1935\", \"3-1936\", \"4-1887\", \"4-1888\", \"4-1889\", \"4-1890\", \"4-1891\", \n\"4-1892\", \"4-1893\", \"4-1894\", \"4-1895\", \"4-1896\", \"4-1897\", \"4-1898\", \n\"4-1899\", \"4-1900\", \"4-1901\", \"4-1902\", \"4-1903\", \"4-1904\", \"4-1905\", \n\"4-1906\", \"4-1907\", \"4-1908\", \"4-1909\", \"4-1910\", \"4-1911\", \"4-1912\", \n\"4-1913\", \"4-1914\", \"4-1915\", \"4-1916\", \"4-1917\", \"4-1918\", \"4-1919\", \n\"4-1920\", \"4-1921\", \"4-1922\", \"4-1923\", \"4-1924\", \"4-1925\", \"4-1926\", \n\"4-1927\", \"4-1928\", \"4-1929\")), Lån = structure(c(21.8552046760463, \n16.9354631519048, 14.1079257359718, 16.7908540878211, 21.8125358015014, \n22.7049393024745, 22.9845270523343, 20.6327272995821, 20.2367766482934, \n9.0730433268189, 8.76280146788203, 8.45831605254012, 18.5583384882304, \n16.0227874442418, 14.4469141085505, 16.2948078954055, 18.4678621483242, \n34.8801647613554, 12.8718995058876, 26.2903301206017, 64.6032084887766, \n61.4639536152419, 57.7399633611202, 24.4863080781916, 27.8232438432077, \n30.3833412076318, 30.0677530506136, 65.1444741565493, 56.6516443429197, \n60.315684852254, 56.4199996064144, 60.1715597365204, 65.0667857507308, \n69.0349764486106, 66.422363861315, 67.6453246293749, 65.7992995302202, \n65.8377134866222, 70.3265356626504, 71.1633761722355, 67.0366584836927, \n68.6845898885332, 69.184192353293, 68.9082294008192, 67.774846884622, \n75.1563302426472, 63.307097388227, 55.885346238016, 56.7374120385912, \n56.4914905969678, 52.7731271340091, 48.12682459542, 49.3502034782439, \n49.1867624617933, 52.8503985776916, 55.3039715920661, 57.9145523998424, \n60.7339335739289, 59.9731465741533, 49.3913672299458), .Names = c(\"3-1920\", \n\"3-1921\", \"3-1922\", \"3-1923\", \"3-1924\", \"3-1925\", \"3-1926\", \"3-1927\", \n\"3-1928\", \"3-1929\", \"3-1930\", \"3-1931\", \"3-1932\", \"3-1933\", \"3-1934\", \n\"3-1935\", \"3-1936\", \"4-1887\", \"4-1888\", \"4-1889\", \"4-1890\", \"4-1891\", \n\"4-1892\", \"4-1893\", \"4-1894\", \"4-1895\", \"4-1896\", \"4-1897\", \"4-1898\", \n\"4-1899\", \"4-1900\", \"4-1901\", \"4-1902\", \"4-1903\", \"4-1904\", \"4-1905\", \n\"4-1906\", \"4-1907\", \"4-1908\", \"4-1909\", \"4-1910\", \"4-1911\", \"4-1912\", \n\"4-1913\", \"4-1914\", \"4-1915\", \"4-1916\", \"4-1917\", \"4-1918\", \"4-1919\", \n\"4-1920\", \"4-1921\", \"4-1922\", \"4-1923\", \"4-1924\", \"4-1925\", \"4-1926\", \n\"4-1927\", \"4-1928\", \"4-1929\")), Aktier = structure(c(3.07318204837309, \n2.07446311309404, 1.43295861797836, 0.510917006044213, 0.585849402603378, \n0.565762106856816, 0.276425856457835, 0.264148494973398, 0.251422678300478, \n58.0164377288786, 15.2785505467049, 52.7552822254383, 3.38621830653397, \n3.04972648885867, 0.847461182502024, 3.72584362278638, 0.214291913995251, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0.880242370615362, 0.782706137309241, 0.690115718443861, \n0.800097690345683, 1.06271791918577, 0.834468719186235, 0.0962303485314691, \n0.0884637193545766, 0.084862230936858, 0.0802494456090769, 0.0744384419445548, \n0.07795889974169, 0.0732881714498627, 0.064264352555926, 12.4266612039723\n), .Names = c(\"3-1920\", \"3-1921\", \"3-1922\", \"3-1923\", \"3-1924\", \n\"3-1925\", \"3-1926\", \"3-1927\", \"3-1928\", \"3-1929\", \"3-1930\", \"3-1931\", \n\"3-1932\", \"3-1933\", \"3-1934\", \"3-1935\", \"3-1936\", \"4-1887\", \"4-1888\", \n\"4-1889\", \"4-1890\", \"4-1891\", \"4-1892\", \"4-1893\", \"4-1894\", \"4-1895\", \n\"4-1896\", \"4-1897\", \"4-1898\", \"4-1899\", \"4-1900\", \"4-1901\", \"4-1902\", \n\"4-1903\", \"4-1904\", \"4-1905\", \"4-1906\", \"4-1907\", \"4-1908\", \"4-1909\", \n\"4-1910\", \"4-1911\", \"4-1912\", \"4-1913\", \"4-1914\", \"4-1915\", \"4-1916\", \n\"4-1917\", \"4-1918\", \"4-1919\", \"4-1920\", \"4-1921\", \"4-1922\", \"4-1923\", \n\"4-1924\", \"4-1925\", \"4-1926\", \"4-1927\", \"4-1928\", \"4-1929\")), \n    Placeringar.andra.ftg = structure(c(28.0431221549195, 25.9545126815565, \n    24.0242448095517, 31.3234881936435, 39.255978576323, 42.1621242692298, \n    43.6032738316212, 45.4357566594961, 46.598249907364, 28.4981460177937, \n    17.0504236197116, 23.836948841527, 48.4988040028843, 45.556077510276, \n    38.8496679378584, 38.6176234980822, 38.9963029248996, 0, \n    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n    0, 0, 0, 0, 0, 0, 0, 0, 0.74742599118763, 0.952114597368105, \n    0.911108175078138, 2.15433130730393, 2.22837176822736, 1.6965099678165, \n    2.01166483245572, 1.92960283356866, 1.89400279726231, 1.83065143079271, \n    1.8441365039718, 1.74778438036979, 1.70553412657279, 1.74014123634787, \n    1.57422476543071), .Names = c(\"3-1920\", \"3-1921\", \"3-1922\", \n    \"3-1923\", \"3-1924\", \"3-1925\", \"3-1926\", \"3-1927\", \"3-1928\", \n    \"3-1929\", \"3-1930\", \"3-1931\", \"3-1932\", \"3-1933\", \"3-1934\", \n    \"3-1935\", \"3-1936\", \"4-1887\", \"4-1888\", \"4-1889\", \"4-1890\", \n    \"4-1891\", \"4-1892\", \"4-1893\", \"4-1894\", \"4-1895\", \"4-1896\", \n    \"4-1897\", \"4-1898\", \"4-1899\", \"4-1900\", \"4-1901\", \"4-1902\", \n    \"4-1903\", \"4-1904\", \"4-1905\", \"4-1906\", \"4-1907\", \"4-1908\", \n    \"4-1909\", \"4-1910\", \"4-1911\", \"4-1912\", \"4-1913\", \"4-1914\", \n    \"4-1915\", \"4-1916\", \"4-1917\", \"4-1918\", \"4-1919\", \"4-1920\", \n    \"4-1921\", \"4-1922\", \"4-1923\", \"4-1924\", \"4-1925\", \"4-1926\", \n    \"4-1927\", \"4-1928\", \"4-1929\")), Fodringar = structure(c(13.4091880009393, \n    11.4007737009461, 8.85180109245837, 10.5207294715513, 11.8554668691406, \n    11.6406790162891, 10.8301249257183, 10.5342894550549, 10.2725808443785, \n    0.0712700398569951, 19.6151778087924, 4.08751075071719, 8.5369441404377, \n    7.22244542654346, 5.74211168867129, 5.00624411086692, 5.70750325407667, \n    11.7113734113266, 21.5391725460311, 17.601114228451, 3.05187896774013, \n    5.56912149567179, 5.47086167639443, 15.6851978435924, 14.9119890182211, \n    15.0092045884117, 12.6228928396926, 0.442201848780838, 0.662413501667926, \n    0.849732956673642, 1.47202590554835, 1.56431397609731, 1.65711491625151, \n    1.7323412708195, 1.85220571392917, 1.93390958786632, 1.84134615133785, \n    1.99887445786696, 1.83728108674151, 2.46597909355305, 3.73562846025962, \n    3.76713685012398, 1.96943185869625, 2.29567819454465, 2.17585138923596, \n    3.4385473363555, 4.04443383630046, 4.4787124078019, 5.91953337740812, \n    6.7714060177497, 1.06707862774494, 1.14746124710284, 1.05345153517615, \n    0.952153564360688, 0.945755278051777, 1.05282199902918, 1.32354993575186, \n    1.31741363057881, 1.29531376381482, 2.49542755736025), .Names = c(\"3-1920\", \n    \"3-1921\", \"3-1922\", \"3-1923\", \"3-1924\", \"3-1925\", \"3-1926\", \n    \"3-1927\", \"3-1928\", \"3-1929\", \"3-1930\", \"3-1931\", \"3-1932\", \n    \"3-1933\", \"3-1934\", \"3-1935\", \"3-1936\", \"4-1887\", \"4-1888\", \n    \"4-1889\", \"4-1890\", \"4-1891\", \"4-1892\", \"4-1893\", \"4-1894\", \n    \"4-1895\", \"4-1896\", \"4-1897\", \"4-1898\", \"4-1899\", \"4-1900\", \n    \"4-1901\", \"4-1902\", \"4-1903\", \"4-1904\", \"4-1905\", \"4-1906\", \n    \"4-1907\", \"4-1908\", \"4-1909\", \"4-1910\", \"4-1911\", \"4-1912\", \n    \"4-1913\", \"4-1914\", \"4-1915\", \"4-1916\", \"4-1917\", \"4-1918\", \n    \"4-1919\", \"4-1920\", \"4-1921\", \"4-1922\", \"4-1923\", \"4-1924\", \n    \"4-1925\", \"4-1926\", \"4-1927\", \"4-1928\", \"4-1929\")), Reala.tillgångar = structure(c(24.1236303297959, \n    37.4986675879214, 46.6429235423771, 35.4664214060824, 21.107906639929, \n    19.0801609856783, 18.4927931928856, 17.5395655673799, 17.1966584758689, \n    0, 34.7674001114172, 7.96457079858135, 15.6705819482217, \n    14.1133809273624, 28.0736200437156, 26.5998804921383, 25.6518212731437, \n    1.95963811345151, 56.5875267336955, 46.2416679590312, 0.482603187490813, \n    0.398935965859933, 0.307217480627311, 51.950855570777, 47.8111071795339, \n    46.8528676724846, 50.0737907885199, 15.4355247525754, 14.2093849840859, \n    13.3958115562226, 22.7149659643704, 20.7346142968668, 18.5855162710402, \n    16.8434048009947, 17.9930930075424, 16.4727505336486, 15.2879033748912, \n    14.8978419576271, 9.42264781134492, 8.68073920966838, 8.09802890881811, \n    8.2503764746835, 8.35805308372005, 7.82891154707734, 11.1718677682141, \n    0.0111751265820557, 0.00993685427215673, 0.00876137160323813, \n    0.009999421233499, 0.0321994407601129, 5.19895399696667, \n    5.06909968623497, 5.74993956248165, 5.65223190455595, 5.47608036625753, \n    5.80844475706357, 5.67763062110834, 5.30082678935982, 6.52809468404085, \n    6.31727899750595), .Names = c(\"3-1920\", \"3-1921\", \"3-1922\", \n    \"3-1923\", \"3-1924\", \"3-1925\", \"3-1926\", \"3-1927\", \"3-1928\", \n    \"3-1929\", \"3-1930\", \"3-1931\", \"3-1932\", \"3-1933\", \"3-1934\", \n    \"3-1935\", \"3-1936\", \"4-1887\", \"4-1888\", \"4-1889\", \"4-1890\", \n    \"4-1891\", \"4-1892\", \"4-1893\", \"4-1894\", \"4-1895\", \"4-1896\", \n    \"4-1897\", \"4-1898\", \"4-1899\", \"4-1900\", \"4-1901\", \"4-1902\", \n    \"4-1903\", \"4-1904\", \"4-1905\", \"4-1906\", \"4-1907\", \"4-1908\", \n    \"4-1909\", \"4-1910\", \"4-1911\", \"4-1912\", \"4-1913\", \"4-1914\", \n    \"4-1915\", \"4-1916\", \"4-1917\", \"4-1918\", \"4-1919\", \"4-1920\", \n    \"4-1921\", \"4-1922\", \"4-1923\", \"4-1924\", \"4-1925\", \"4-1926\", \n    \"4-1927\", \"4-1928\", \"4-1929\")), Övriga.tillgångar = structure(c(8.94359632321529, \n    4.73024053386131, 3.38913668790429, 3.30261960154855, 3.66153681338318, \n    3.29818249453177, 3.19182850390819, 2.85939756735457, 2.36761585526891, \n    1.26933260800861, 0.266044096705159, 0.445934574945972, 0.624009436206777, \n    0.613077026094302, 0.507436262108836, 0.507399597336736, \n    0.454853858310495, 26.0513408152126, 0, 0, 4.33310468884518, \n    3.34116555074217, 3.75643192221575, 0, 0, 0, 0, 1.72640051957453, \n    1.21214699091261, 1.00118493181342, 0.152355704864146, 0, \n    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.219109164892739, 0.422000717554878, \n    0.852726180937993, 0.573182072341244, 0.677056811951724, \n    0.371422443252653, 0.101430023434196, 0.166757801571104, \n    1.09974800113887, 0.999780790501637, 1.04570455542704, 1.12928342698615, \n    0.673912359406274, 1.43591270387502, 1.91776034982839, 0.556296154636263\n    ), .Names = c(\"3-1920\", \"3-1921\", \"3-1922\", \"3-1923\", \"3-1924\", \n    \"3-1925\", \"3-1926\", \"3-1927\", \"3-1928\", \"3-1929\", \"3-1930\", \n    \"3-1931\", \"3-1932\", \"3-1933\", \"3-1934\", \"3-1935\", \"3-1936\", \n    \"4-1887\", \"4-1888\", \"4-1889\", \"4-1890\", \"4-1891\", \"4-1892\", \n    \"4-1893\", \"4-1894\", \"4-1895\", \"4-1896\", \"4-1897\", \"4-1898\", \n    \"4-1899\", \"4-1900\", \"4-1901\", \"4-1902\", \"4-1903\", \"4-1904\", \n    \"4-1905\", \"4-1906\", \"4-1907\", \"4-1908\", \"4-1909\", \"4-1910\", \n    \"4-1911\", \"4-1912\", \"4-1913\", \"4-1914\", \"4-1915\", \"4-1916\", \n    \"4-1917\", \"4-1918\", \"4-1919\", \"4-1920\", \"4-1921\", \"4-1922\", \n    \"4-1923\", \"4-1924\", \"4-1925\", \"4-1926\", \"4-1927\", \"4-1928\", \n    \"4-1929\"))), .Names = c(\"Company\", \"Year\", \"Kapitalinkomster\", \n\"Aktiebolag\", \"Bank.o.kassa\", \"Obligationer\", \"Lån\", \"Aktier\", \n\"Placeringar.andra.ftg\", \"Fodringar\", \"Reala.tillgångar\", \"Övriga.tillgångar\"\n), index = structure(list(Company = structure(c(1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, \n2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, \n2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, \n2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L), .Label = c(\"3\", \"4\"), class = \"factor\"), \n    Year = structure(c(34L, 35L, 36L, 37L, 38L, 39L, 40L, 41L, \n    42L, 43L, 44L, 45L, 46L, 47L, 48L, 49L, 50L, 1L, 2L, 3L, \n    4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 16L, \n    17L, 18L, 19L, 20L, 21L, 22L, 23L, 24L, 25L, 26L, 27L, 28L, \n    29L, 30L, 31L, 32L, 33L, 34L, 35L, 36L, 37L, 38L, 39L, 40L, \n    41L, 42L, 43L), .Label = c(\"1887\", \"1888\", \"1889\", \"1890\", \n    \"1891\", \"1892\", \"1893\", \"1894\", \"1895\", \"1896\", \"1897\", \"1898\", \n    \"1899\", \"1900\", \"1901\", \"1902\", \"1903\", \"1904\", \"1905\", \"1906\", \n    \"1907\", \"1908\", \"1909\", \"1910\", \"1911\", \"1912\", \"1913\", \"1914\", \n    \"1915\", \"1916\", \"1917\", \"1918\", \"1919\", \"1920\", \"1921\", \"1922\", \n    \"1923\", \"1924\", \"1925\", \"1926\", \"1927\", \"1928\", \"1929\", \"1930\", \n    \"1931\", \"1932\", \"1933\", \"1934\", \"1935\", \"1936\"), class = \"factor\")), .Names = c(\"Company\", \n\"Year\"), row.names = c(NA, -60L), class = \"data.frame\"), row.names = c(\"3-1920\", \n\"3-1921\", \"3-1922\", \"3-1923\", \"3-1924\", \"3-1925\", \"3-1926\", \"3-1927\", \n\"3-1928\", \"3-1929\", \"3-1930\", \"3-1931\", \"3-1932\", \"3-1933\", \"3-1934\", \n\"3-1935\", \"3-1936\", \"4-1887\", \"4-1888\", \"4-1889\", \"4-1890\", \"4-1891\", \n\"4-1892\", \"4-1893\", \"4-1894\", \"4-1895\", \"4-1896\", \"4-1897\", \"4-1898\", \n\"4-1899\", \"4-1900\", \"4-1901\", \"4-1902\", \"4-1903\", \"4-1904\", \"4-1905\", \n\"4-1906\", \"4-1907\", \"4-1908\", \"4-1909\", \"4-1910\", \"4-1911\", \"4-1912\", \n\"4-1913\", \"4-1914\", \"4-1915\", \"4-1916\", \"4-1917\", \"4-1918\", \"4-1919\", \n\"4-1920\", \"4-1921\", \"4-1922\", \"4-1923\", \"4-1924\", \"4-1925\", \"4-1926\", \n\"4-1927\", \"4-1928\", \"4-1929\"), class = c(\"pdata.frame\", \"data.frame\"\n))\n</code></pre>\n\n<p>Best Regards</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13152067,"title":"Annote ggplot2 facets with images","body":"<p>Say I'm graphing data for 4 people: Alice, Bob, Chuck and Dana. I'm using ggplot2 to make a faceted plot with one facet per person. I also have 4 images on disk: Alice.png, Bob.png, Chuck.png and Dana.png. (obviously this is a synthetic example that would need to scale to more than 4 facets :)</p>\n\n<p>Is there a way I can annotate each facet with the corresponding image, ideally instead of the facet label (although I'd be happy with the image right below the label)? Perhaps something similar to the technique used here: <a href=\"http://stackoverflow.com/questions/13148404\">Use image instead of labels in ggplot2 legend</a> ? I've tried reading through the documentation for the various annotate methods but my R-fu is insufficient to the challenge!</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":86,"score":3,"question_id":13152476,"title":"what does '[[' mean in the function lapply(x, '[[', VarNames[[type]]) in R?","body":"<p>Can anyone tell me what does <code>[[</code>  mean in the function <code>lapply(x, '[[', VarNames[[type]])</code>  in R? Thanks a lot!</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13151394,"title":"How to create a prop.table() for a three dimension table?","body":"<p>Could you let know how I can get percentages in a <code>three dimensional</code> table. I know how to create percentages in a <code>two dimensional</code> table by runnin the following</p>\n\n<pre><code>p &lt;-with(mtcars,tapply(carb,list(cyl,vs),length))\nprop.table(p,2) # by column\n</code></pre>\n\n<p>However, if I can try to add another variable, I dont how to do?</p>\n\n<pre><code>p &lt;- with(mtcars,tapply(carb,list(cyl,vs,gear),length))\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13151033,"title":"title size for charts.PerformanceSummary","body":"<p>I'm not 100% sure if this is just a bug or some other issue but how do you change the font size of the title for outputs of <code>charts.PerformanceSummary()</code> from the <code>PerformanceAnalytics</code> package?</p>\n\n<p>Here is my reproducible example for what i would have hoped would have increased the font size by 6 times what it original was...</p>\n\n<pre><code>require(PerformanceAnalytics)\nv &lt;- rnorm(100,0.001,0.003)\ncharts.PerformanceSummary(xts(v,Sys.Date()-(100:1)),main=\"random title\")\ncharts.PerformanceSummary(xts(v,Sys.Date()-(100:1)),main=\"random title\", cex.main=6)\n</code></pre>\n\n<p>The outputs appear to be the same with no change in title size....</p>\n"},{"tags":["r","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":42,"score":-3,"question_id":13148168,"title":"Is there any way to calculate a Spearman's correlation between each matrix column?","body":"<p>Trying to calculate correlation between columns, but the cor() function only allows for comparison between two columns at a time. </p>\n\n<pre><code>&gt; mat &lt;- matrix(c(45,34,1,3,4325,23,1,2,5,7,3,4,32,734,2,53),ncol=4)\n&gt; mat\n     [,1] [,2] [,3] [,4]\n[1,]   45 4325    5   32\n[2,]   34   23    7  734\n[3,]    1    1    3    2\n[4,]    3    2    4   53\n</code></pre>\n"},{"tags":["r","symbols"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13148059,"title":"Chemical formula + Text in Gnu R plot title","body":"<p>How can i write H2o in the title of a plot?</p>\n\n<p>Thanks to this <a href=\"http://stackoverflow.com/q/13147591/1749675\">hint</a> I can include a plain chemical formula in the headline with</p>\n\n<pre><code>plot(main=expression(H[2]*O),0)\n</code></pre>\n\n<p>The real formulas here are a bit more complicate and i want to abbreviate them and add these to the text, where needed.\nBut this fails:</p>\n\n<pre><code>h2o &lt;- expression(H[2]*O)\nplot(main=paste(h2o, \"in the air\"),0) # paste fails here :(\n</code></pre>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":59,"score":4,"question_id":13149986,"title":"Survfit equivalent for coxme in R?","body":"<p>I am struggling with the coxme package in R. I would like to use a function like survfit() - the way it would ordinarily be used for a coxph() model - to plot adjusted survival curves and find the median survival at different parameter values. </p>\n\n<p>If I fit the model using coxph without random effects I can do the following:</p>\n\n<pre><code>library(KMsurv)\ndata(burn)\n\nmy.surv &lt;- with(burn, Surv(T1, D1))\n\ncox_nr = coxph(my.surv ~ Z1 , data = burn)\n\nsurvfit(cox_nr, newdata = data.frame(Z1 =1))\n</code></pre>\n\n<p>This provides survival estimates. But if I fit the same model with coxme:</p>\n\n<pre><code>library(coxme)\ncox_r = coxme(my.surv ~ Z1 + (1|Z11), data = burn)\n\nsurvfit(cox_r, newdata = data.frame(Z1 = 1))\n</code></pre>\n\n<blockquote>\n  <p>Error in UseMethod(\"survfit\", formula) : \n    no applicable method for 'survfit' applied to an object of class \"coxme\"</p>\n</blockquote>\n\n<p>So <code>survfit.coxme</code> doesn't seem to exist and from reading the <code>coxme</code> package documentation, I don't see an equivalent. Is there something fundamentally wrong about what I am attempting to do? If not, how can I get these estimates?</p>\n"},{"tags":["r","loops","for-loop"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":46,"score":-1,"question_id":13149335,"title":"Check if something is in each row (row length>1)","body":"<p>Basically I have a matrix and row with a in it I want to append a \"1\" to a list, otherwise append a \"0\" </p>\n\n<p>The code is as follows:</p>\n\n<pre><code>is.there.A &lt;- function(a,b,c,d,e) {\n\n  library(combinat)\n  x &lt;- c(a,b,c,d,e)  \n  matrix &lt;- matrix(combn(x,3), ncol=3, byrow=T) \n  row &lt;- nrow(matrix)\n  list &lt;- list()\n\n  for (i in seq(row)) {\n\n    if (matrix[i,] %in% \"A\") {c(list, \"1\")}\n\n    else {c(list, \"0\")} \n\n    print(list)\n\n    }\n\n}\n</code></pre>\n\n<p>But it doesn't work and this shows up.</p>\n\n<p>Warning messages:</p>\n\n<blockquote>\n  <p>1: In if (matrix[i, ] %in% \"A\") { :</p>\n  \n  <p>the condition has length > 1 and only the first element will be used</p>\n</blockquote>\n\n<p>The question is how to overcome this to achieve the objective  </p>\n"},{"tags":["performance","r","matlab"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":2,"view_count":118,"score":2,"question_id":13142273,"title":"Discrepancy between R and Matlab speed","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/7142767/why-are-loops-slow-in-r\">Why are loops slow in R?</a>  </p>\n</blockquote>\n\n\n\n<p>Consider the following task. A dataset has 40 variables for 20,000 \"users\". Each user has between 1 and 150 observations. All users are stacked in a matrix called data. The first column is the id of the user and identifies the user. All id are stored in a 20,000 X 1 matrix called userid.</p>\n\n<p>Consider the following R code</p>\n\n<pre><code>useridl = length(userid)\nitime=proc.time()[3]    \nfor (i in 1:useridl) {\ntemp =data[data[,1]==userid[i],]\n   }\n etime=proc.time()[3]\n etime-itime\n</code></pre>\n\n<p>This code just goes through the 20,000 users, creating the temp matrix every time. With the subset of observations belonging to userid[i]. It takes about 6 minutes in a MacPro.</p>\n\n<p>In MatLab, the same task </p>\n\n<pre><code>tic\nfor i=1:useridl\ntemp=data(data(:,1)==userid(i),:);\nend\ntoc\n</code></pre>\n\n<p>takes 1 minute. </p>\n\n<p>Why is R so much slower? This is standard task, I am using matrices in both cases. Any ideas?</p>\n"},{"tags":["r","twitter","oauth","handshake","rcurl"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":134,"score":1,"question_id":11728535,"title":"ROAuth handshake","body":"<p>I have been trying to authenticate through ROAuth using the following script:</p>\n\n<pre><code>    library(\"ROAuth\")\n    library(\"RCurl\")\n\nrequestURL &lt;- \"https://api.twitter.com/oauth/request_token\"\naccessURL = \"https://api.twitter.com/oauth/access_token\"\nauthURL = \"https://api.twitter.com/oauth/authorize\"\n\n\ncKey&lt;- \"Key\"\ncSecret&lt;- \"Secret\"\n\n\nCred &lt;- OAuthFactory$new(consumerKey=cKey,\n            consumerSecret=cSecret,\n            requestURL=requestURL,\n            accessURL=accessURL,\n            authURL=authURL)\n\nCred$handshake(cainfo = system.file(\"CurlSSL\", \"cacert.pem\", package = \"RCurl\"))\n</code></pre>\n\n<p>Every time I enter in this code, I get the error:</p>\n\n<pre><code>Error in Cred$handshake(cainfo = system.file(\"CurlSSL\", \"cacert.pem\",  : Invalid response from site, please check your consumerKey and consumerSecret and try again.\n</code></pre>\n\n<p>I am not sure what I am doing wrong. I have made sure every necessary package is up to date by re-installing ROauth and RCurl and checking their version information (ROAuth 0.9.1 and  RCurl_1.91-1.1(?) ). After installation, I restarted R (as a possible solution suggested by another post). I copy-pasted and double-checked the consumer key and consumer secret, and I am sure they are correct. Does anyone have any other ideas?  </p>\n\n<p>Thank you.</p>\n"},{"tags":["r","ggplot2","graphing"],"answer_count":1,"favorite_count":4,"up_vote_count":8,"down_vote_count":0,"view_count":283,"score":8,"question_id":13148404,"title":"Use image instead of labels in ggplot2 legend","body":"<p>I have a plot in ggplot2 with, say, 2 lines, and in the legend I have \"Sharks\" and \"Tigers\". Is there a way I could have shark/tiger images appear in the legend instead of that text?</p>\n"},{"tags":["r","variables","for-loop"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":13148348,"title":"How to create variables within dataframe in for loop?","body":"<p>I have an R dataframe called <code>mydata</code> with the counts of people with a certain age and certain height. So <em>within</em> the dataframe I have variables <code>mydata$ageto10</code> (=the number of people up to ten years of age), <code>mydata$ageto20</code> (=the number of people up to twenty years of age), and so on with the ages 35, 42, and 65. Same goes for height (and a couple of other variables).</p>\n\n<p>I want to create new variables which refer to the count of the number of people within the age range 10to25, the age range 25to35, 35to42, and 42to65. So for the first case, I want to do:</p>\n\n<pre><code>mydata$age10to25 &lt;- mydata$ageto25 - mydata$ageto10\n</code></pre>\n\n<p>This works, but I want to do this across all ranges, and do the same for height and the other variables. There must be an easier way than copy-pasting this 40 times and changing the variable names manually! :)</p>\n\n<p>I thought it should be something like this:</p>\n\n<pre><code>for (i in c(\"age\", \"height\"))\n{\n  for (k in c(10,20,35,42, 65))\n  {\n  assign(paste(\"mydata$\", i, k, \"to\", &lt;&lt;next k here&gt;&gt;, sep=\"\"), get(paste(\"mydata$\", i, &lt;&lt;next k here&gt;&gt;, , sep=\"\")) - get(paste(\"mydata$\", i, k, , sep=\"\"))\n  }\n}\n</code></pre>\n\n<p>But obviously this doesn't work (even if I fill in the k by manually, it seems the <code>assign</code> command is not meant for assigning variable names to the current data.</p>\n\n<p>What's the best way to do this?</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13148121,"title":"Updating ggplot2 code for new version","body":"<p>Since installing the latest version of ggplot2 (0.9.1), I have been getting messages from my old code including:</p>\n\n<pre><code>&gt; warnings()\nWarning messages:\n1: 'opts' is deprecated.\nUse 'theme' instead.\nSee help(\"Deprecated\")\n2: 'theme_text' is deprecated.\nUse 'element_text' instead.\nSee help(\"Deprecated\")\n8: In opts(title = trait axis.text.x = theme_text(size = fontsize$axis),  ... :\n  Setting the plot title with opts(title=\"...\") is deprecated. Use labs(title=\"...\") or ggtitle(\"...\") instead.\n9: 'opts' is deprecated.\n</code></pre>\n\n<p>I have a few questions:</p>\n\n<ol>\n<li>help(\"Depreciated\") returns <code>\"no documentation for 'Depreciated' in specified packages and libraries\"</code>; is this an error?</li>\n<li>Is there some time at which 'Depreciated' will turn to 'Obsolete' and my code will begin to throw errors?</li>\n<li>How can I update my code (to solve these specific issues and prevent others still waiting to be found)?</li>\n<li>Can I load two versions of ggplot2 and specify which version of each function I am using?</li>\n<li>On what timescale might updated syntax become obsolete?</li>\n</ol>\n\n<p>I accept that this is a common issue with software, but perhaps some contributors to SO have specific insight into the longer term plans and rationale of the package's author.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13147890,"title":"rollapply sliding window","body":"<p>I am very much a newbie in R. I am sorry for my naive question.</p>\n\n<p>Part of my data is as follows:</p>\n\n<pre><code>POS         Obs_FCT\n4345     0.10049191\n4484     0.08930793\n4515    -0.00468725\n4547    -0.00749802\n4628     0.01143598\n5347     0.05673895\n6071     0.01143598\n6449    -0.00070778\n6498    -0.0109962\n7320     0.00543984\n7457    -0.00206247\n7761     0.08018589\n7875    -0.00601304\n7988    -0.00070778\n9459     0.01447144\n9483     0.08269899\n9495    -0.03353229\n9552    -0.00206247\n9602    -0.0269909\n9701    -0.00206247\n11809   -0.01952417\n12593   -0.02173826\n16787    0.08930793\n17049   -0.06738125\n17058    0.01325792\n</code></pre>\n\n<p>I want to plot <code>Obs_FCT</code> (which is the Y-axis) VS <code>POS</code> (the X-axis), but it is not plotting at all. I also want to apply a sliding window on the <code>POS</code> column. The window is as follows (i.e. that the window size is 1000 and sliding by 200):</p>\n\n<pre><code>1--1000\n200 ---1200\n400 ---1400 \n600 ----1600\n--------\n</code></pre>\n\n<p>If the numbers in the <code>POS</code> column are located in each window, compute the mean value of <code>Obs_FCT</code>. (The X axis uses the midpoint of the window). </p>\n\n<p>Could someone please tell me how to use R code to achieve this? Generally I know that maybe I can get what I want through <code>rollapply</code>. But it seems like a function is needed.</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13146434,"title":"How do I load objects to the current environment from a function in R?","body":"<p>Instead of doing</p>\n\n<pre><code>a &lt;- loadBigObject(\"a\")\nb &lt;- loadBigObject(\"b\")\n</code></pre>\n\n<p>I'd like to call a function like</p>\n\n<pre><code>loadBigObjects(list(\"a\",\"b\"))\n</code></pre>\n\n<p>And be able to access the <code>a</code> and <code>b</code> objects.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":56,"score":5,"question_id":13131732,"title":"Number of Observations by Day in R","body":"<p>I am working with a dataframe that looks like this: </p>\n\n<pre><code>date&lt;-c(\"2012-02-01\", \"2012-02-01\", \"2012-02-03\", \"2012-02-04\", \"2012-02-04\", \"2012-02-05\", \"2012-02-09\", \"2012-02-12\", \"2012-02-12\")\nvar&lt;-c(\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\")\ndf1&lt;-data.frame(date,var)\n</code></pre>\n\n<p>I would like to create a second dataframe that will tabulate the number of observations I have each day. In that dataframe, the dates that are not mentioned would get a zero...resulting in something like this: </p>\n\n<pre><code>date&lt;-c(\"2012-02-01\",\"2012-02-02\",\"2012-02-03\",\"2012-02-04\",\"2012-02-05\",\"2012-02-06\",\"2012-02-07\",\"2012-02-08\",\"2012-02-09\",\"2012-02-10\",\"2012-02-11\",\"2012-02-12\")\nnum&lt;-c(2,0,1,2,1,0,0,0,1,0,0,2)\ndf2&lt;-data.frame(date,num)\n</code></pre>\n\n<p>I have tried a number of things with the aggregate function, but can't figure out how to include the dates with no observations (the zeros). </p>\n"},{"tags":["r","symbols"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13147591,"title":"Chemical formula in Gnu R plot title","body":"<p>How can i write H2o in the title of a plot?</p>\n\n<p>H2 works:</p>\n\n<pre><code>plot(main=expression(\"H\"[2]),0)\n</code></pre>\n\n<p>H2O fails:</p>\n\n<pre><code>plot(main=expression(\"H\"[2]\"O\"),0)\n</code></pre>\n\n<p>This solution will work only, if i have a space in front \" \"</p>\n\n<pre><code>plot(main=expression(\" \"*H[2]*\"O\"),0)\n</code></pre>\n"},{"tags":["linux","r","installation","install","redhat"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13146852,"title":"R 2.15 install in Redhat","body":"<p>I am trying to install a local copy of R on a server without admin privileges. I know <strong><em>almost nothing</em></strong> about servers, or linux. I can easily access a copy of R by typing \"R\", however the server I am working off of only has an old copy of R (v2.10.1). I need at least v2.14 to run my scripts, although I would prefer to install the most recent release. </p>\n\n<p>As far as I understand, my server runs Redhat e15 x86_64 GNU/Linux. I have the server mapped to my windows computer, and tried doing a regular install of Windows R onto the server, but when I try and run the R.exe file I get an error stating I \"cannot execute binary file\". </p>\n\n<p>I found on the CRAN website what I think I should download:</p>\n\n<p>Under the linux installation... redhat/e15/x86_64</p>\n\n<p>But the folder only contains v2.10. I found this thread about installing R on Redhat, but I am still at a loss for how (if possible) to install/build my own copy of R.</p>\n"},{"tags":["r","symbols"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13147116,"title":"Insert formula in plot with easy and pretty code","body":"<p>Gnu R ships with a very odd way to note formulas and symbols. It is often <a href=\"http://stackoverflow.com/a/5294214/1749675\">discussed here</a> and mentioned in the R helppage <code>?plotmath</code>. For anyone who ever wrote <code>LaTeX</code> the code for a simple formula in R looks unreadable and is errorprone to write.</p>\n\n<p>Is there a better way to annotate with formulas? Is there a function like <code>tex2r(\"x_2\")</code> that will generate the strange code?</p>\n"},{"tags":["r","neural-network","time-series"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13133500,"title":"Echo state network?","body":"<p>I've heard from a couple of people recently that echo state networks are good for time series modeling.  So I figure it's worth a try.</p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Echo_state_network\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Echo_state_network</a></p>\n\n<p>It's a type of recurrent network where only the weights in the output layer are learned, and the other weights are randomized.</p>\n\n<p>To what extent are their libraries/package in R that could be used to create an echo state network?</p>\n\n<p>(Note: there is this question: <a href=\"http://stackoverflow.com/questions/9521752/neural-net-package-in-r\">Neural net package in R</a> , which is possibly related, but it asks for 'recursive' networks, whereas I'm looking for 'recurrent' or 'echo state' networks).</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":51,"score":5,"question_id":13146849,"title":"How to load only specific functions from a package","body":"<p>I have a package that uses the trim() function in the gdata package. I literally use nothing else from the package and (as some of you may have seen) it overwrites some functionality of base R that I need. </p>\n\n<p>Is there a way to load only one function rather than the whole package? </p>\n"}]}
{"total":19203,"page":6,"pagesize":100,"questions":[{"tags":["r","regression","scatter-plot","mean"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13146718,"title":"How to add mean to scatter plot in R?","body":"<p>I have data in the form:  </p>\n\n<pre><code>Num Percent  \n5   9.44  \n4   19.7  \n4   10.64  \n4   10.81  \n4   10.97  \n4   11.35  \n3   13.18  \n3   24.54  \n3   24.99  \n3   12.95  \n3   13.17  \n3   24.29  \n3   13.81  \n3   13.93  \n3   27.87  \n3   13.26  \n2   41.41  \n2   34.19  \n2   41.6  \n2   19.31  \n2   34.4  \n2   38.72  \n2   18.16  \n2   36.28  \n2   18.95  \n2   18.49\n</code></pre>\n\n<p>I would like to plot the data such that, along with the plot of 'num'(x) and 'percent'(y), the mean at every point of the x axis (2,3,4,5) is added to the plot and a regression line based on the mean series is plotted.  </p>\n"},{"tags":["r","namespaces","scoping"],"answer_count":1,"favorite_count":6,"up_vote_count":16,"down_vote_count":0,"view_count":173,"score":16,"question_id":11004018,"title":"How can a non-imported method in a not-attached package be found by calls to functions not having it in their namespace?","body":"<p>An R namespace acts as the immediate environment for all functions in its associated package. In other words, when function <code>bar()</code> from package <strong>foo</strong> calls another function, the R evaluator first searches for the other function in <code>&lt;environment: namespace:foo&gt;</code>, then in <code>\"imports.foo\"</code>, <code>&lt;environment: namespace:base&gt;</code>, <code>&lt;environment: R_GlobalEnv&gt;</code>, and so on down the search list returned by typing <code>search()</code>.</p>\n\n<p>One nice aspect of namespaces is that they can make packages act like better citizens: unexported functions in <code>&lt;environment: namespace:foo&gt;</code> and functions in <code>imports:foo</code> are available only: (a) to functions in <strong>foo</strong>; (b) to other packages that import from <strong>foo</strong>; or (c) via fully qualified function calls like <code>foo:::bar()</code>. </p>\n\n<p>Or so I thought until recently...</p>\n\n<h2>The behavior</h2>\n\n<p><a href=\"http://stackoverflow.com/questions/10939516/data-frame-transformation-gives-different-results-when-same-code-is-run-before-a/10940237#10940237\">This recent SO question</a> highlighted a case in which a function well-hidden in its package's namespace was nonetheless found by a call to a seemingly unrelated function:</p>\n\n<pre><code>group &lt;- c(\"C\",\"F\",\"D\",\"B\",\"A\",\"E\")\nnum &lt;- c(12,11,7,7,2,1)\ndata &lt;- data.frame(group,num)\n\n## Evaluated **before** attaching 'gmodels' package\nT1 &lt;- transform(data, group = reorder(group,-num))\n\n## Evaluated **after** attaching 'gmodels\nlibrary(gmodels)\nT2 &lt;- transform(data, group = reorder(group,-num))\n\nidentical(T1, T2) \n# [1] FALSE\n</code></pre>\n\n<h2>Its immediate cause</h2>\n\n<p>@Andrie answered the original question by pointing out that <strong>gmodels</strong> imports from the the package <strong>gdata</strong>, which includes a function <code>reorder.factor</code> that gets dispatched to inside the second call to <code>transform()</code>. <code>T1</code> differs from <code>T2</code> because the first is calculated by <code>stats:::reorder.default()</code> and the second by <code>gdata:::reorder.factor()</code>.</p>\n\n<h2>My question</h2>\n\n<p>How is it that in the above call to <code>transform(data, group=reorder(...))</code>, the dispatching mechanism for <code>reorder</code> finds and then dispatches to <code>gdata:::reorder.factor()</code>?</p>\n\n<p>(An answer should include an explanation of the scoping rules that lead from a call involving functions in the <strong>stats</strong> and <strong>base</strong> packages to a seemingly well-hidden method in <strong>gdata</strong>.)</p>\n\n<hr>\n\n<h2>Further possibly helpful details</h2>\n\n<ol>\n<li><p>Neither <code>gdata:::reorder.factor</code>, nor the <strong>gdata</strong> package as a whole are explicitly imported by <strong>gmodels</strong>. Here are the <code>import*</code> directives in <strong>gmodels</strong>' <strong>NAMESPACE</strong> file:</p>\n\n<pre><code>importFrom(MASS, ginv)\nimportFrom(gdata, frameApply)\nimportFrom(gdata, nobs)\n</code></pre></li>\n<li><p>There are no methods for <code>reorder()</code> or <code>transform()</code> in <code>&lt;environment: namespace:gmodels&gt;</code>, nor in <code>\"imports:gmodels\"</code>:</p>\n\n<pre><code>ls(getNamespace(\"gmodels\"))\nls(parent.env(getNamespace(\"gmodels\")))\n</code></pre></li>\n<li><p>Detaching <strong>gmodels</strong> does not revert <code>reorder()</code>'s behavior: <code>gdata:::reorder.factor()</code> still gets dispatched:</p>\n\n<pre><code>detach(\"package:gmodels\")\nT3 &lt;- transform(data, group=reorder(group,-num))\nidentical(T3, T2)\n# [1] TRUE\n</code></pre></li>\n<li><p><code>reorder.factor()</code> is not stored in the list of S3 methods in the base environment: </p>\n\n<pre><code>grep(\"reorder\", ls(.__S3MethodsTable__.))\n# integer(0)\n</code></pre></li>\n</ol>\n\n<p>R chat threads from the last couple of days include some additional ideas. Thanks to Andrie, Brian Diggs, and Gavin Simpson who (with others) should feel free to edit or add possibly impt. details to this question.  </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13146567,"title":"Transform and Reorder","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/10939516/data-frame-transformation-gives-different-results-when-same-code-is-run-before-a\">Data frame transformation gives different results when same code is run before and after attaching (apparently) unrelated packages</a>  </p>\n</blockquote>\n\n\n\n<p>I'm having a bit of a problem. I used to use this method to quickly reorder factors for plotting with ggplot2. But it doesn't seem to be working: </p>\n\n<pre><code>tmp &lt;- data.frame(Letters=letters[1:26],values=rnorm(26))\ntmp &lt;- transform(tmp, Letters = reorder(Letters,values))\n\nidentical(levels(tmp$Letters),letters[1:26]) # True! but shouldn't it be reorderd?\n</code></pre>\n\n<p>What's going on here?</p>\n\n<p>SessionInfo()</p>\n\n<pre><code>R version 2.15.2 (2012-10-26)\nPlatform: i686-pc-linux-gnu (32-bit)\n\nlocale:\n [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C               LC_TIME=en_CA.UTF-8       \n [4] LC_COLLATE=en_CA.UTF-8     LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_CA.UTF-8   \n [7] LC_PAPER=C                 LC_NAME=C                  LC_ADDRESS=C              \n[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] tools     stats     graphics  grDevices utils     methods   base     \n\nother attached packages:\n[1] reshape_0.8.4   digest_0.5.2    plyr_1.7.1      ggplot2_0.9.2.1\n\nloaded via a namespace (and not attached):\n [1] brew_1.0-6         colorspace_1.2-0   dichromat_1.2-4    evaluate_0.4.2     grid_2.15.2       \n [6] gtable_0.1.1       gtools_2.7.0       httr_0.2           labeling_0.1       MASS_7.3-22       \n[11] memoise_0.1        munsell_0.4        parallel_2.15.2    proto_0.3-9.2      RColorBrewer_1.0-5\n[16] RCurl_1.95-1.1     reshape2_1.2.1     scales_0.2.2       stringr_0.6.1      whisker_0.1    \n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13146473,"title":"How do I manipulate the global environment inside a function in R?","body":"<p>I'd like to remove all the objects from my current environment except two of them, something like this</p>\n\n<pre><code>rm(list=setdiff(ls(),c(\"current_object_a\",\"current_object_b\")))\n</code></pre>\n\n<p>but I'd like to call it within a function. If I do it now, nothing happens because I'm deleting the environment variables inside the function, not the global environment.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13145465,"title":"read.table returning character matrix, would like numeric","body":"<p>I have a csv file with data that looks like this:</p>\n\n<pre><code>\"Date\",\"Time\",\"Open\",\"High\",\"Low\",\"Close\",\"Up\",\"Down\",\"Sell\",\"Buy\",\"Stop1\",\"Stop2\",\"Stop3\",\"Target1\",\"Target2\",\"Target3\"\n04/18/2012,1335,1365.25,1366.00,1365.00,1366.00,2855,1153,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00\n04/18/2012,1340,1366.00,1366.25,1365.50,1366.00,450,607,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00\n04/18/2012,1345,1366.00,1366.00,1365.75,1365.75,300,263,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00\n</code></pre>\n\n<p>If I read the file in using this command I'm getting a character matrix:</p>\n\n<pre><code>RawData = as.matrix(read.table(PathName,sep=\",\",header=TRUE))\n\ntypeof(RawData)\n[1] \"character\"\n</code></pre>\n\n<p>Best I can tell this is due to the date column. </p>\n\n<p>I need this to be a numeric array. What's a good alternative to the read.table command I'm using above?</p>\n"},{"tags":["r","generics","package","s4","roxygen2"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":40,"score":3,"question_id":13137912,"title":"Rd file name conflict when S4 generic and method(s) are not in the same package","body":"<h2>Actual question</h2>\n\n<p>How do I avoid Rd file name conflicts when </p>\n\n<ol>\n<li>a S4 generic and its method(s) are <strong>not</strong> necessarily all defined in the same package (package containing the method(s) depends on the package containing the generic) <strong>and</strong></li>\n<li>using <code>roxygenize()</code> from package <a href=\"http://cran.r-project.org/web/packages/roxygen2/index.html\" rel=\"nofollow\">roxygen2</a> to generate the actual Rd files?</li>\n</ol>\n\n<p>I'm not sure if this is a <code>roxygen2</code> problem or a common problem when generic and method(s) are scattered across packages (which IMHO in general definitely is a realistic use-case scenario if you follow a modular programming style). </p>\n\n<p><strong>What's the recommended way to handle these situations?</strong></p>\n\n<h2>Illustration</h2>\n\n<p>Suppose in package <code>pkga</code> you defined a generic method <code>foo</code> and that you've provided the respective roxygen code that <code>roxygenize()</code> picks up to generate the Rd file:</p>\n\n<pre><code>#' Test function\n#' \n#' Test function.\n#' \n#' @param ... Further arguments.\n#' @author Janko Thyson \\email{janko.thyson@@rappster.de}\n#' @example inst/examples/foo.R\n#' @docType methods\n#' @rdname foo-methods\n#' @export\n\nsetGeneric(\n    name=\"foo\",\n    signature=c(\"x\"),\n    def=function(\n         x,  \n        ...\n    ) {\n    standardGeneric(\"xFoo\")       \n    }\n)\n</code></pre>\n\n<p>When <code>roxygenizing()</code> your package, a file called <code>foo-methods.Rd</code> is created in the <code>man</code> subdirectory that serves as the reference Rd file for all methods that might be created for this generic method. So far so good. If all of the methods for this generic are also part of your package, everything's good. For example, this roxygen code would make sure that documentation is added to <code>foo-methods.Rd</code> for the <code>ANY</code>-method of <code>foo</code>:</p>\n\n<pre><code>#' @param x \\code{ANY}.\n#' @return \\code{TRUE}.\n#' @rdname foo-methods\n#' @aliases foo,ANY-method\n#' @export\n\nsetMethod(\n    f=\"foo\", \n    signature=signature(x=\"ANY\"), \n    definition=cmpfun(function(\n        x,\n        ...\n    ) {\n    return(TRUE)\n    }, options=list(suppressAll=TRUE))\n)\n</code></pre>\n\n<p>However, if package <code>pkga</code> provides the generic for <code>foo</code> and you decide in some other package (say <code>pkgb</code>) to add a <code>foo</code>-method for class <code>character</code>, then <code>R CMC check</code> will tell you that there is a name clash with respect to Rd file names and/or aliases:</p>\n\n<pre><code># Now where in package `pkgb`(!)\n#\n#' @param x \\code{character}.\n#' @return \\code{character}.\n#' @rdname foo-methods\n#' @aliases foo,character-method\n#' @export\n\nsetMethod(\n    f=\"foo\", \n    signature=signature(x=\"character\"), \n    definition=cmpfun(function(\n        x,\n        ...\n    ) {\n    return(x)\n    }, options=list(suppressAll=TRUE))\n)\n</code></pre>\n\n<p>To be more precise, this is the error that's thrown/written to file <code>00install.out</code></p>\n\n<pre><code>Error : Q:/pkgb/man/foo-methods.Rd: Sections \\title, and \\name must exist and be unique in Rd files\nERROR: installing Rd objects failed for package 'pkgb'\n</code></pre>\n\n<h2>Due dilligence</h2>\n\n<p>I tried to change the values for <code>@rdname</code> and <code>@aliases</code> to <code>foo_pkgb*</code> (instead of <code>foo*</code>), but <code>\\title</code> and <code>\\name</code> still are set to <code>foo</code> when roxygenizing and thus the error remains. Any ideas <strong>besides manually editing the Rd files</strong> generated by <code>roxygenize()</code>?</p>\n"},{"tags":["r","parallel-processing","hpc","qsub","torque"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":62,"score":4,"question_id":13142882,"title":"Submit jobs to a slave node from within an R script?","body":"<p>To get <code>myscript.R</code> to run on a cluster slave node using a job scheduler (specifically, <a href=\"http://en.wikipedia.org/wiki/Portable_Batch_System\" rel=\"nofollow\">PBS</a>)</p>\n\n<p>Currently, I submit an R script to a slave node using the following command</p>\n\n<pre><code>qsub -S /bin/bash -p -1 -cwd -pe mpich 1 -j y -o output.log ./myscript.R\n</code></pre>\n\n<p>Are there functions in R that would allow me to run myscript.R on the head node and send individual tasks to the slave nodes? Something like:</p>\n\n<pre><code>foreach(i=c('file1.csv', 'file2.csv', pbsoptions = list()) %do% read.csv(i)\n</code></pre>\n\n<hr>\n\n<p>Update: alternative solution to the qsub command is to remove <code>#/usr/bin/Rscript</code> from the first line of <code>myscript.R</code> and call it directly, as pointed out by @Josh</p>\n\n<pre><code>qsub -S /usr/bin/Rscript -p -1 -cwd -pe mpich 1 -j y -o output.log myscript.R\n</code></pre>\n"},{"tags":["r","shapefile","rgdal"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13135413,"title":"R spCbind error","body":"<p>I have successfully added information to shapefiles before (see my post on <a href=\"http://rusergroup.swansea.ac.uk/Healthmap.ashx?HL=map\" rel=\"nofollow\">http://rusergroup.swansea.ac.uk/Healthmap.ashx?HL=map</a> ).</p>\n\n<p>However, I just tried to do it again with a slightly different shapefile  (new local health boards for Wales) and the code fails at <code>spCbind</code> with a \"row names not identical error\"</p>\n\n<pre><code>o &lt;- match(wales.lonlat$NEW_LABEL, wds$HB_CD)\nwds.xtra &lt;- wds[o,]\nwales.ncchd &lt;- spCbind(wales.lonlat, wds.xtra)\n</code></pre>\n\n<p>My rows did have different names before and that didn't cause any problems. I relabeled the column in wds.xtra to match \"NEW_LABEL\" and that doesn't help.</p>\n\n<p>The labels and order of labels do match exactly between wales.lonlat and wds.xtra.</p>\n\n<p>(I'm using Revolution R 5.0, which is built on R 2.13.2)</p>\n"},{"tags":["sql","r","sas","sqldf"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":120,"score":3,"question_id":11784115,"title":"Difference between PROC SQL and sqldf","body":"<p>I am in the midst of re-writing a SAS program I normally use into R. Many statements in the SAS program are written with proc sql, so for ease of programming I am replicating those statements with sqldf in R. All of the sql code works the same with sqldf as it does in SAS, except for this statement:</p>\n\n<p>SAS:</p>\n\n<pre><code>proc sql;\ncreate table merged32 as\nselect max(ctf) as ctf,\n       max(ctms) as ctms,\n       max(site_name) as site_name,\n       provider_id, npi,\n       first_name, middle_name, last_name, specialty,\n       address_1, city, state, site_ct, zip, site_key\n    from merged2\n    group by 9,10,11,12,14,15;\nquit;\nrun;\n</code></pre>\n\n<p>sqldf:</p>\n\n<pre><code>sqldf(\"select max(ctf) as ctf,\n              max(ctms) as ctms,\n              max(site_name) as site_name,\n              provider_id, npi,\n              first_name, middle_name, last_name, specialty,\n              address_1, city, state, site_ct, zip, site_key\n       from merged2\n       group by 9,10,11,12,14,15\")\n</code></pre>\n\n<p>In SAS, it returns a dataset with 1878 rows; in sqldf, a dataframe with 1375. </p>\n\n<p>Are there any major differences between proc sql and sqldf that could be causing this, or in general that need to be considered? I didn't provide data because 1) the datasets are huge, and 2) I'm more just interested in knowing the differences between the two sql systems. </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13145678,"title":"Subsetting within a function","body":"<p>I'm trying to subset a dataframe within a function using a mixture of fixed variables and some  variables which are created within the function (I only know the variable names, but cannot vectorise them beforehand). Here is a simplified example:</p>\n\n<pre><code>a&lt;-c(1,2,3,4)\nb&lt;-c(2,2,3,5)\nc&lt;-c(1,1,2,2)\nD&lt;-data.frame(a,b,c)\n\nsubbing&lt;-function(Data,GroupVar,condition){\n  g=Data$c+3\n  h=Data$c+1\n  NewD&lt;-data.frame(a,b,g,h)\n  subset(NewD,select=c(a,b,GroupVar),GroupVar%in%condition)\n}\n</code></pre>\n\n<p>Keep in mind that in my application I cannot compute g and h outside of the function. Sometimes I'll want to make a selection according to the values of h (as above) and other times I'll want to use g. There's also the possibility I may want to use both, but even just being able to subset using 1 would be great.</p>\n\n<pre><code>subbing(D,GroupVar=h,condition=5)\n</code></pre>\n\n<p>This returns an error saying that the object h cannot be found. I've tried to amend subset using as.formula and all sorts of things but I've failed every single time.</p>\n\n<p>Besides the ease of the function there is a further reason why I'd like to use subset.</p>\n\n<p>In the function I'm actually working on I use subset twice. The first time it's the simple subset function. It's just been pointed out below that another blog explored how it's probably best to use the good old data[colnames()==\"g\",]. Thanks for the suggestion, I'll have a go. </p>\n\n<p>There is however another issue. I also use subset (or rather a variation) in my function because I'm dealing with several complex design surveys (see package survey), so subset.survey.design allows you to get the right variance estimation for subgroups. If I selected my group using [] I would get the wrong s.e. for my parameters, so I guess this is quite an important issue.</p>\n\n<p>Thank you</p>\n"},{"tags":["r","plot","rstudio"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13143801,"title":"Update plots during for loop from within Rstudio?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8772630/plotting-during-a-loop-in-rstudio\">Plotting during a loop in RStudio</a>  </p>\n</blockquote>\n\n\n\n<p>I'm trying to monitor the status of a convergence loop, and I can't seem to get it to update the graph each time it iterates.</p>\n\n<p>Here's some sample code:</p>\n\n<pre><code>print(plot(c(0,1)~c(0,100)))\nfor(i in seq(100)) {\n  Sys.sleep(.1)\n  print(points( runif(1)~i ))\n}\n</code></pre>\n\n<p>Note that the graph only updates <em>after</em> everything's been plotted.  I need it to update each loop iteration.  I thought <code>print</code> would do that, but it's not working.</p>\n\n<p><strong>Update</strong></p>\n\n<p>This is an RStudio-specific problem, as it works properly in base R.  Is there a way to force graphing in RStudio each loop iteration?</p>\n"},{"tags":["r","transformation","etl"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":57,"score":4,"question_id":13095519,"title":"How do I transform a single column list to item matrix in R?","body":"<p>I currently have data that is in the following format (note, this is 1 column, 4 row matrix):</p>\n\n<pre><code>aa|bb  \nbb|cc|ee|ee  \ncc  \ncc|ee\n</code></pre>\n\n<p>and I want it displayed so that the column names are: aa, bb, cc, dd, and ee.  And I want there to be 4 row such that each row counts the number of times each string was present in the matching row above.</p>\n\n<p>ie) </p>\n\n<pre><code>aa bb cc dd ee  \n 1  1  0  0  0  \n 0  1  1  0  2  \n 0  0  1  0  0   \n 0  0  1  0  1 \n</code></pre>\n\n<p>Does anyone know how to do this in R? I would post my attempt, but it is just getting ugly and complicated.  Any help would be much appreciated.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["r","import"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13145441,"title":"Why does import.wig function (rtracklayer package of bioconductor) not work on R v. 2.14.2 but work in R v. 2.15.2?","body":"<p>When I use import.wig function on R v.2.14.2:</p>\n\n<pre><code>library(\"rtracklayer\")\nwig_object &lt;- import.wig(filename, genome = \"g19\", asRangedData = FALSE)\n</code></pre>\n\n<p>I get an empty 'wig_object' with no error (file size of 'filename' is ~7Mb).</p>\n\n<p>However, when I perform the same command on R v.2.15.2 my file gets imported and my 'wig_object' now contains all the data from my 'filename'.</p>\n\n<p>Is this just a version problem or am I doing something wrong?</p>\n"},{"tags":["r","pdf","latex","sweave","rstudio"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":13115898,"title":"Making flattened pdfs in Sweave","body":"<p>So I am creating pdfs using Sweave that include some graphs that have a ton of points on them. I can get the pdf well enough, but it seems to have created it with a ton of layers, so it's hard to open the file in Acrobat or Reader. When I do, I literally can watch the points load on the document.</p>\n\n<p>Is there a way to flatten the pdf in Sweave so that it's not so bulky?</p>\n\n<p>(Note that I am using RStudio. I know I should probably be using something else, but I haven't found anything that has worked this smoothly yet.)</p>\n"},{"tags":["r","graphics","lattice","equivalence"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13139687,"title":"How to combine two equivalence plots (lattice) in R?","body":"<p>I would like to add two equivalence plots together for the following lattice graphics.  My usual trick for the <code>plot()</code> function <code>par(mfcol=c(1,2))</code> does not work with these lattice-based graphs.  I have looked at the related posts, although I cannot seem to extract the information I need from the solutions.  How can I combine the following equivalence plots so that they are adjacent (side by side) to each other in the output?  Or, in other words, what is the lattice equivalent to <code>par(mfcol=c(1,2))</code>?</p>\n\n<pre><code>require(equivalence)\n\n# Simplified data for equivalence plot 1\na = c(2,4,6,8,10,12,14,16,18)\nb = c(1,3,5,7,9,11,13,15,17)\nmydata1 = data.frame(a,b)\n\nequivalence.xyplot(mydata1$b ~ mydata1$a,\n                   alpha=0.05, b0.ii=0.25, b1.ii=0.25)\n\n\n# Simplified data for equivalence plot 2\nx = c(1,4,8,2,3,4,6,5,9)\ny = c(2,4,7,3,3,4,7,5,9)\nmydata2 = data.frame(x,y)\n\nequivalence.xyplot(mydata2$y ~ mydata2$x,\n                   alpha=0.05, b0.ii=0.25, b1.ii=0.25)\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13138949,"title":"Windowing functions in R?","body":"<p>I am trying to do something in R that is equivalent to a \"first value\" windowing function in SQL, such as:</p>\n\n<pre><code>select *, first_value(value3) over (partition by value1, value2 order by value5 desc)\nfrom df\n</code></pre>\n\n<p>Is there a good way to do this in R without having to create a database to use something like sqldf/RPostgreSQL?</p>\n\n<p>I've seen some other examples like the answers here: <a href=\"http://stackoverflow.com/questions/8559485/cumulative-sum-by-group-in-sqldf\">Cumulative sum by group in sqldf?</a></p>\n\n<p>but I'm having some trouble figuring out how to do it with a function where the order within the window matters.  Another thing is that I'm working with ~500K rows, and so performance is an concern.</p>\n\n<p>Edit: here's an example:</p>\n\n<pre><code>item_id  rental_date   customer_id\nI001     10/20/2012    1\nI002     10/05/2012    4 \nI001     10/15/2012    3\nI004     10/19/2012    1\nI001     10/11/2012    6\nI002     9/15/2012     5\nI004     10/13/2012    10\nI001     9/30/2012     4\n</code></pre>\n\n<p>How would I determine the first customer to rent a given item for each month?</p>\n"},{"tags":["eclipse","r","statet"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13143350,"title":"rj not installing for eclipse/R Statet","body":"<p>I realize there are several posts on this, so apologies if I'm breaching etiquette. In my case, I've tried several of them, and I just can't seem to get the rj issue (of having it installed properly) resolved.</p>\n\n<p>I tried the CMD INSTALL recommendation and literally copied the tar file to my R executable directory </p>\n\n<pre><code>R CMD INSTALL --no-test-load rj_*.tar.gz\n</code></pre>\n\n<p>I used a DOS cmd window to run it, and it failed using the * notation, so I substituted the exact rj tar file name by navigating to the path...\nC:\\Program Files\\R\\R-2.12.1\\bin\\x64\\rj_0.5.0-5.tar.gz\nand running</p>\n\n<pre><code>R CMD INSTALL --no-test-load rj_0.5.0-5.tar.gz\n</code></pre>\n\n<p>This seemed to work as R shows all Java packages installed (inc. Rjava)</p>\n\n<pre><code>&gt; (\"rj\" %in% installed.packages()[,\"Package\"])\n[1] TRUE\n&gt; (\"rJava\" %in% installed.packages()[,\"Package\"])\n[1] TRUE\n&gt; \n</code></pre>\n\n<p>Yet, in the eclipse environment, I'm still getting rj missing error.\nAny thoughts on what to try next? I really want to get the debug capability to work here and pulling my hair out over this.</p>\n\n<p>Oh, and also even though it shows installed in R. If I try to launch inside R, I get:</p>\n\n<pre><code>&gt; library(rj)\nError : .onLoad failed in loadNamespace() for 'rj', details:\n  call: .jcall(\"de/walware/rj/server/RJ\", \"Lde/walware/rj/server/RJ;\", \n  error: RcallMethod: cannot determine object class\nError: package/namespace load failed for 'rj'\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/TtbxO.jpg\" alt=\"enter image description here\"></p>\n\n<blockquote>\n  <p></p>\n</blockquote>\n\n<ul>\n<li>Using Eclipse SDK Version: 3.8.0\nStatET 3.01.02\nrj_0.5.0-5</li>\n</ul>\n"},{"tags":["r","glm"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13136660,"title":"Specification and interpretation of interaction terms using glm()","body":"<p>I am fitting a logistic model to data using the glm function in R.   I have attempted to specify interaction terms in two ways:</p>\n\n<pre><code>fit1 &lt;- glm(y ~ x*z, family = \"binomial\", data = myData) \nfit2 &lt;- glm(y ~ x/z, family = \"binomial\", data = myData) \n</code></pre>\n\n<p>I have 3 questions:</p>\n\n<p>1) What is the difference between specifying my interaction terms as x*z compared to x/d?</p>\n\n<p>When I call summary(fit1) the report includes results for the intercept, x, z, and x:z while summary(fit2) only includes results for intercept, x, and x:z.</p>\n\n<p>I did look at Section 11.1 in \"An Introduction to R\" but couldn't understand the meaning. </p>\n\n<p>2) How do I interpret the fit equation mathematically?  Specifically, how do I interpret the interaction terms formulaically?</p>\n\n<p>Moving to math instead of R, do I interpret the equation as:\nlogit(y) = (intercept) + (coeff_x)*x + (coeff_z)*x + (coeff_xz)*x*z\n?</p>\n\n<p>This interpration may differ in the two specifications fit1 and fit2.  What is the interpretation of each?</p>\n\n<p>3) Assuming the above interpretation is correct, how to I fit the model of x*(1/z) in R?  Do I need to just create another column with these values?</p>\n"},{"tags":["r","colors","conditional","igraph","vertex"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13130260,"title":"igraph plot conditional vertext color","body":"<p>I'm new to R and iGraph. I'm trying to make a vertex in column position #1, appear in a specific color.</p>\n\n<p>My data comes in from CSV and looks like this: </p>\n\n<pre><code>CL1920  202.80  V66.7   198.89  511.9   799.02  401.9   696.1   388.01  202.80                                                                                                                               \nRM119041 331.82 294.10                                                                                                                                                                                       \nRM38755 331.82  294.10  276.0   331.0   294.10                                                                                                                   \nHK54701 331.82  294.10  276.0   331.0   294.10  401.9   V10.51\n....\n</code></pre>\n\n<p>My plot script look looks something like this: </p>\n\n<pre><code>dat &lt;- read.csv(\"data.csv\", header =F)\ng &lt;- graph.data.frame(dat, directed = F)\ncolCount &lt;- 1+ count.fields(\"dat.csv\", sep = \",\")\nV(g)$label &lt;- NA\nset.seed(10)\npar &lt;- par()$mar; par(mar=rep(0, 4))\nplot (g, layout = layout.fruchterman.reingold,\n      vertex.frame.color = \"#FFFFFF\",\n      vertex.size = 5,\n      edge.width = 2.5+ (log(colCount)/max(log(colCount))),\n      edge.color = \"Grey60\")\n</code></pre>\n\n<p>I've tried unsuccessfully to set vertex.color. Examples like this seem to default to \"lightblue\"</p>\n\n<pre><code> V(g)$color &lt;- ifelse (V(g)$V1, \"red\", \"blue\")\n</code></pre>\n\n<p>Can someone point me in the right direction?</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13140606,"title":"Change composite legend title","body":"<p>If I have the following data and plot it using <code>ggplot2</code> I get:</p>\n\n<pre><code>a  &lt;-c(0.3,0.3,0.3,0.3,0.3)\nb  &lt;-c(1:5,0.9,0.9,0.9,0.9,0.9)\nc  &lt;-c(1:5,0.5,0.5,0.5,0.5,0.5)\nz  &lt;-rep(1:5,5)\ndf &lt;- data.frame(y=c(a,b,c),x=c(z),line=c(rep(\"1\",5),\nrep(\"2\",5),rep(\"3\",5),rep(\"2\",5),rep(\"3\",5)))\n\nlibrary(ggplot2)\n\na &lt;- ggplot(df,aes(x=x,y=y,fill=line,shape=line,group=line)) +       \n          geom_line(aes(linetype=line),size=1) +            \n     scale_linetype_manual(values=c(\"dashed\",\"solid\", \"dotdash\")) +\n          geom_point(size=3) + scale_shape_manual(values=c(25,23,21,25,23)) +    \n     scale_fill_manual(values=c(\"red\", \"blue\", \"yellow\",\"red\", \"blue\"))\n</code></pre>\n\n<p>If I want to specify the title of the legend I can do a number of things like </p>\n\n<pre><code>a + labs(shape = \"MY TITLE HERE\")   # or\n\na &lt;- ggplot(df,aes(x=x,y=y,fill=line,shape=line,group=line)) +       \n          geom_line(aes(linetype=line),size=1) +            \n     scale_linetype_manual(values=c(\"dashed\",\"solid\", \"dotdash\")) +\n          geom_point(size=3) + scale_shape_manual(values=c(25,23,21,25,23),name=\"MY \n          TITLE HERE\") +    \n     scale_fill_manual(values=c(\"red\", \"blue\", \"yellow\",\"red\", \"blue\"))\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/tOhs5.png\" alt=\"enter image description here\"></p>\n\n<p>However, all of these options break the composite legend up into their separate mapping paramters.  </p>\n\n<p>How do I maintain the composite legend with <code>linetype</code>,<code>shape</code> and <code>fill</code> and change the legend title?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":556,"score":1,"question_id":2126124,"title":"I can't print the mean value of survfit(...)","body":"<p>I used the data, aml in survival package in R and computed a survival function by\n\"survfit\". Since the result of survfit doesn't show the mean value,\nI used the following code to print the mean:</p>\n\n<blockquote>\n  <p>print(survfit(Surv(aml1$time,aml1$status)~1),show.rmean=T)</p>\n</blockquote>\n\n<p>(the data I used is, aml1 &lt;-aml[aml$x=\"Maintained\",])</p>\n\n<p>The code above worked in my friend pc, but not mine.\nSo, I thought about downloading  some extra package to use print(...show.rmean=T).\nBut, \"print\" is basic, so I don't need anything to run  print.\nThen why I can't get the mean value?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13143150,"title":"assigning random or automatized names for e.g. matrices in R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13058679/generate-variable-names-something-like-get\">generate variable names (something like get())</a>  </p>\n</blockquote>\n\n\n\n<p>If I want to create matrices with different names in an automatized way, I run into problems.</p>\n\n<p>For example, I want to create three matrices named a1,a2 and a3.</p>\n\n<pre><code> x&lt;-1:3\n a&lt;-\"a\"\n listofnames&lt;-paste(a,x)  ## a vector with the names that I want to use for my matrices\n</code></pre>\n\n<p>My problem is to assign a matrix the different names from the vector I created. \nFor example, to create a matrix called a1 (the first \"name\" in my vector), this will of course not work at all:</p>\n\n<pre><code> listofnames[1]&lt;-matrix(ncol=2,nrow=2)\n</code></pre>\n\n<p>But how would I do it? </p>\n\n<p>I've been looking on the internet but can't find any answer..\nThank you so much for your help</p>\n"},{"tags":["r","loops"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":13139256,"title":"Create and process several columns with loop in R","body":"<p>I'm quite new to R and I would like to learn how to write a Loop to create and process several columns.</p>\n\n<p>I imported a table into R that cointains data with 23 variables. For all of these variables I want to calculate the per capita valuem multiply this with 1000 and either write the data into a new table or in the same table as the old data. </p>\n\n<p>So to this for only one column my operation looked like this:</p>\n\n<pre><code>&lt;i&gt;agriculture&lt;-cbind(agriculture,\"Total_value_per_capita\"=agriculture$Total/agriculture$Total.Population*1000)&lt;/i&gt;\n</code></pre>\n\n<p>Now I'm asking how to do this in a Loop for the 23 variables so that I won't have to write 23 similar lines of code.</p>\n\n<p>I think the solution might look quite similar to the code pasted in this thread:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/4893232/loop-to-create-several-matrix-in-r-maybe-using-paste\">loop to create several matrix in R (maybe using paste)</a></p>\n\n<p>but I dind't got it working on my code. </p>\n\n<p>So any suggestion would be very helpful.</p>\n"},{"tags":["r","pruning"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13136683,"title":"Is rpart automatic pruning?","body":"<p>Is <strong>rpart</strong> automatic pruning?</p>\n\n<p>The decision tree produced by <strong>rpart</strong> is much more levels than that produced by Oracle Data Mining which has the automatic pruning.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":6,"view_count":86,"score":-5,"question_id":13141884,"title":"Need exercises for \"Art of R Programming\"","body":"<p>I am using the book \"The Art of R Programming\" by Norman Matloff to learn more about R. But the book doesn't have any exercises at the end of the chapters. I learn by doing exercises. \nIs there any source where I can test my knowledge of R which I am learning from this book ?\nI could not find any relevant thread here, so decided to ask</p>\n\n<p>Thanks</p>\n"},{"tags":["r","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13141790,"title":"Is there a way to fill in a matrix with extrapolated data?","body":"<p>Basically, I calculated the mean of each row of a matrix</p>\n\n<pre><code>&gt; mat &lt;- matrix(c(45,34,1,3,4325,23,1,2,5,7,3,4,32,734,2),ncol=3)\n&gt; mat\n     [,1] [,2] [,3]\n[1,]   45   23    3\n[2,]   34    1    4\n[3,]    1    2   32\n[4,]    3    5  734\n[5,] 4325    7    2\n\n&gt; mat2 &lt;-t(rowMeans(mat))\n&gt; mat2\n         [,1] [,2]     [,3]     [,4]     [,5]\n[1,] 23.66667   13 11.66667 247.3333 1444.667\n&gt; dim(mat2)\n[1] 1 5\n</code></pre>\n\n<p>What I'd like to do is fill an empty matrix with the calculated values so that it looks like 'mat3'</p>\n\n<pre><code>&gt; mat2 &lt;- matrix(numeric(0), 5,5)\n&gt; mat2\n     [,1] [,2] [,3] [,4] [,5]\n[1,]   NA   NA   NA   NA   NA\n[2,]   NA   NA   NA   NA   NA\n[3,]   NA   NA   NA   NA   NA\n[4,]   NA   NA   NA   NA   NA\n[5,]   NA   NA   NA   NA   NA\n\n\n&gt; mat3\n           [,1]     [,2]         [,5] \n[1,]   23.66667 23.66667  ....   23.66667 \n[2,]   13.00000 13.00000  ....   13.00000 \n[3,]   11.66667 11.66667  ....   11.66667\n[4,]   247.3333 247.3333  ....   247.3333\n[5,]   1444.667 1444.667  ....   1444.667\n</code></pre>\n\n<p>Is there any way to do this without filling each cell manually?</p>\n"},{"tags":["r","zoo"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13140983,"title":"Error convering character value to monthly data with as.yearmon (zoo)","body":"<p>Problem occurs when months' value are in the text form like \"Jan\" or \"January\".\nfor example, the following line </p>\n\n<pre><code>as.yearmon(\"Jan-2000\", \"%b-%Y\")\n</code></pre>\n\n<p>returns an error:</p>\n\n<pre><code>Error in charToDate(x) : &gt; character string is not in a standard unambiguous format\n</code></pre>\n\n<p>what's going wrong here?</p>\n\n<p>sessionInfo():</p>\n\n<p>R version 2.15.1 (2012-06-22)\nPlatform: x86_64-pc-mingw32/x64 (64-bit)</p>\n\n<p>locale:\n[1] LC_COLLATE=Russian_Russia.1251  LC_CTYPE=Russian_Russia.1251    LC_MONETARY=Russian_Russia.1251\n[4] LC_NUMERIC=C                    LC_TIME=Russian_Russia.1251    </p>\n\n<p>attached base packages:\n[1] grid      stats     graphics  grDevices utils     datasets  methods   base     </p>\n\n<p>other attached packages:\n [1] RODBC_1.3-6         latticeExtra_0.6-24 lattice_0.20-10     gplots_2.11.0       MASS_7.3-22<br>\n [6] KernSmooth_2.23-8   caTools_1.13        bitops_1.0-4.1      gdata_2.12.0        gtools_2.7.0<br>\n[11] RColorBrewer_1.0-5  xts_0.8-6           zoo_1.7-8          </p>\n\n<p>loaded via a namespace (and not attached):\n[1] tools_2.15.1</p>\n"},{"tags":["r","survey"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":112,"score":1,"question_id":10884051,"title":"Analysis of complex survey design with multiple plausible values","body":"<p>I am working with several large databases (e.g. PISA and NAEP) that use a complex survey design with replicate weights and multiple plausible values. I can address the former using the survey package. However, does there exist an R package/function to analyze the latter?</p>\n\n<p>For reference, I have found this article to provide a good overview of the issue: <a href=\"http://www.ierinstitute.org/fileadmin/Documents/IERI_Monograph/IERI_Monograph_Volume_02_Chapter_01.pdf\" rel=\"nofollow\">http://www.ierinstitute.org/fileadmin/Documents/IERI_Monograph/IERI_Monograph_Volume_02_Chapter_01.pdf</a></p>\n"},{"tags":["r","table","decimal"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13140996,"title":"How to put a decimal point in the contingency table in R?","body":"<h2>My initial data are as follow: </h2>\n\n<pre><code>birth &lt;- c(rep(1,50),rep(0,34))\nbirth &lt;- factor(birth, levels=c(1,0),\n         labels=c(\"Birth Complications\",\"No Birth Complications\")) \nmental.health &lt;- c(rep(1,30),rep(2,26),rep(3,28)) \nmental.health &lt;- factor(mental.health, levels=c(1,2,3), \nlabels=c(\"Normal\",\"Depressed\",\"Schizophrenic\")) \ntable(mental.health,birth) \n</code></pre>\n\n<hr>\n\n<p>But when I try to replace the numbers in each cell with the decimals(for instance, from 30 in the first cell to 30.5 and 6 to 6.5 in the bottom right cell), R says my rows and columns aren't equal length.</p>\n\n<p>Here's the code I'm trying but not working: </p>\n\n<pre><code>birth &lt;- c(rep(.5,101),rep(0.5,68))  \nbirth &lt;- factor(birth, levels=c(1,0), labels=c(\"Birth \nComplications\",\"No Birth Complications\")) \nmental.health &lt;- c(rep(2,120),rep(2,52),rep(3,56)) \nmental.health &lt;- factor(mental.health, levels=c(1,2,3), \nlabels=c(\"Normal\",\"Depressed\",\"Schizophrenic\")) \ntable(mental.health,birth)     \n</code></pre>\n\n<p></p>\n\n<p>What I did was to replace 1 with .5 then doubled the frequency of that number by changing from 50 to 101. Your help is greatly appreciated!! </p>\n"},{"tags":["r","data.table"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13139848,"title":"paste, by and data.table in r","body":"<p>I'm trying to paste strings from a reshaped dataset. I'm using the data.table package as follows:</p>\n\n<pre><code>m&lt;-data.frame(x=rep(c(\"a\",\"b\"),20),y=factor(sample(letters,40,replace=T)))\nDT&lt;-data.table(m)\nsetkey(DT,x)\nDT[,paste(y,sep=\",\"),by=x]\n</code></pre>\n\n<p>However, this only gives a new frame quite identical to the original one except for the variable name. I'd like the output to be two concatenated vectors where the variables are pasted together. How can I do this?</p>\n"},{"tags":["r","histogram"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13133297,"title":"Calculating peaks in histograms or density functions","body":"<p>There seem to be a lot of \"peaks in density function\" threads already, but I don't see one addressing this point specifically. Sorry to duplicate if I missed it.</p>\n\n<p>My problem: Given a vector of 1000 values (sample attached), I would like to identify the peaks in the histogram or density function of the data. From the image of the sample data below , I can see peaks in the histogram at ~0, 6200, and 8400. But I need the obtain the exact values of these peaks, preferably in a simple procedure as I have several thousand of these vectors to process.</p>\n\n<p><img src=\"http://i.stack.imgur.com/BmyXT.png\" alt=\"Hist and Density Function\"></p>\n\n<p>I originally started working with the histogram outputs themselves, but couldn't get any peak-finding command to work properly (like, not at all). I'm not even sure how it would get the <strong>peaks()</strong> command from the <strong>splus2R</strong> package to work on histogram object or on a density object. This would still be my preference, as I would like to identify the exact data value of the max frequency of each peak (as opposed to the density function value, which is slightly different), but I can't figure that one out either.</p>\n\n<p>I would post the sample data themselves, but I can't see a way to do that on here (sorry if I'm just missing it).</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13138945,"title":"How can I replacing a specific line by line number in a dat file?","body":"<p>I want to replace some specific lines  in a dat file by line number.\nWhich function in R can I use?</p>\n\n<p>For example,</p>\n\n<p>The file 'parameter.dat' has the following 6 lines.</p>\n\n<pre><code>start year    end year   no of stations     lag \n1990           2000             15           1 \ninput data file\nrain1960_2010.dat\noutput file\nrain_out.dat\n</code></pre>\n\n<p>I want to replace the numbers in the 2nd line with some new numbers.\nAlso replace the input file name with another file name?</p>\n"},{"tags":["r","file","twitter"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13140483,"title":"library twitteR issues when reading an external file","body":"<p>I have no internet connection and I just want to make a program using the library twitteR of R. For that purpose I have downloaded the file rdmTweets.RData that it is supposed to hold a collection of twitters. That file is available in: <a href=\"http://www.rdatamining.com/data\" rel=\"nofollow\">http://www.rdatamining.com/data</a></p>\n\n<p>I have try to read that file using:</p>\n\n<pre><code>  rdmTweets&lt;-userTimeline(\"rdmTweets.RData\",n=200)\n</code></pre>\n\n<p>also converting directly to a data frame:</p>\n\n<pre><code>  df&lt;-do.call(\"rbind\",lapply(\"rdmTweets.RData\",as.data.frame)\n</code></pre>\n\n<p>but, with no results at all. I mean it does not show any information of the twitters. I tried to read it like a file with:</p>\n\n<pre><code>  rdm&lt;-file(\"rdmTweets.RData\",\"r\")\n  lines&lt;-readLines(rdm)\n</code></pre>\n\n<p>also with no results. It seems the only way that I can access that file is when I have:</p>\n\n<pre><code>  rdmTweets&lt;-userTimeline(\"rdatamining\",n=200) \n</code></pre>\n\n<p>but that means to have an active internet connection. So the question that I have is how I can read that file in a way that I can get its contents like if I use userTimeline?\nThanks</p>\n"},{"tags":["r","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13140204,"title":"Is there any way to sort columns of a matrix independently in R?","body":"<p>I'm a newbie in R so, I really need some help here. I just want to sort each column independently. Any help is appreciated!</p>\n\n<pre><code> &gt; mat &lt;- matrix(c(45,34,1,3,4325,23,1,2,5,7,3,4,32,734,2),ncol=3)\n &gt; mat\n      [,1] [,2] [,3]\n [1,]   45   23    3\n [2,]   34    1    4\n [3,]    1    2   32\n [4,]    3    5  734\n [5,] 4325    7    2\n</code></pre>\n\n<p>to</p>\n\n<pre><code>      [,1] [,2] [,3]\n [1,]    1    1    2\n [2,]    3    2    3\n [3,]   34    5    4\n [4,]   45    7   32\n [5,] 4325    23 734\n</code></pre>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":47,"score":0,"question_id":13139085,"title":"writing to a tab-delimited file or a csv file","body":"<p>I have a RMA normalized data ( from the CEL files ) and would like to write it into a file that I could open in excel but have some problems.</p>\n\n<pre><code>library(affy)\ncel &lt;- ReadAffy()\npre&lt;-rma(cel)\nwrite.table(pre, file=\"norm.txt\", sep=\"\\t\")\nwrite.table(pre, file=\"norma.txt\")\n</code></pre>\n\n<p>The outut is arranged row-wise in the text file that is written using the above command and hence when exported to excel it is in a wrong form and many of the information is cut off as the maximum rows are used up .The output looks the following way :</p>\n\n<pre><code>GSM 133971.CEL 5.85302 3.54678 6.57648 9.45634\nGSM 133972.CEL 4.65784 3.64578 3.54213 7.89566\nGSM 133973.CEL 6.78543 3.54623 2.54345 7.89767   \n</code></pre>\n\n<p>How to write it in a proper format from CEL files in R to a notepad or  excel ?</p>\n"},{"tags":["r","lattice","rgl"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":21,"score":2,"question_id":13137443,"title":"3d plot or contourplot of 3-tuples where x&y are NOT in a grid and NOT equally spaced in R","body":"<p>I am trying to visualize 3-tuple points that are NOT in a grid, and x and y are NOT equally spaced. Thus I can not make a matrix as mostly required, nor can I meet the requirements of the lattice contourplot, which accepts vectors, but they have to be in a pretty restrictive form. (x,y must form a grid and be equally spaced...)</p>\n\n<p>I don't care, whether the result is a 3d surface or a 2D contourplot. But in some way I'ld like to visualize a (probably interpolated) surface of my 3-tuples.</p>\n\n<p>Data will look like this:</p>\n\n<pre><code>    myX myY myZ\n1   458 4   0.54\n2   101 5   0.46\n3   390 0   0.45\n4   186 2   0.84\n5   241 3   0.50\n6   495 2   0.67\n</code></pre>\n\n<p>I have tried several plotting functions from graphics, rgl and lattice packages.\nI understand that the connecting of x,y pairs at arbitrary positions is everything but trivial - but is there any plotting function in any package, which can handle this? Or can I fill (interpolate) my data beforehand easily in order to have a full matrix? (I have fitted models visualized, but I want to see the raw data...)</p>\n\n<p>Any help or hint is appreciated!</p>\n\n<p>Cheers,\nNiko</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":12002704,"title":"inverse X and Y axis using geom_ribbon in ggplot2","body":"<p>is it possible to use geom_ribbon from the package ggplot2, but with the range plotted horizontally and not vertically. This would be trivial if \"geom_ribbon\" proposed the options xmin/xmax, but this is not the case. </p>\n\n<p>Here is my data, a simplified plotting function for testing and the figure I obtain. So in this example, I would like to have the \"depth\" axis displayed vertically.</p>\n\n<pre><code>prof &lt;- read.table(text = \" depth prop mean error\n1 5 FALSE 2.12 0.035\n2 15 FALSE 2.06 0.035\n3 25 FALSE 1.54 0.035\n4 35 FALSE 0.92 0.033\n5 45 FALSE 0.71 0.028\n6 55 FALSE 0.60 0.026\n7 65 FALSE 0.54 0.024\n8 75 FALSE 0.49 0.023\n9 85 FALSE 0.46 0.022\n10 95 FALSE 0.43 0.022\n11 105 FALSE 0.41 0.022\n12 115 FALSE 0.39 0.021\n13 5 TRUE 2.18 0.061\n14 15 TRUE 2.11 0.061\n15 25 TRUE 1.58 0.054\n16 35 TRUE 0.97 0.047\n17 45 TRUE 0.76 0.042\n18 55 TRUE 0.67 0.043\n19 65 TRUE 0.61 0.040\n20 75 TRUE 0.54 0.033\n21 85 TRUE 0.48 0.028\n22 95 TRUE 0.45 0.027\n23 105 TRUE 0.43 0.025\n24 115 TRUE 0.40 0.022\", header=TRUE)\n\nggplot(prof, aes(colour = prop, fill = prop)) + \n  geom_ribbon(aes(x = depth, ymin = mean-error, ymax = mean+error), \n  alpha = 0.6, colour = NA)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/JS9Ia.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["graphics","r"],"answer_count":2,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":2205,"score":7,"question_id":2836513,"title":"How to create plots in multiple windows and keep them seperate in R","body":"<p>I'm sure this is an easy problem, but my google / help foo has failed me, so it's up to you.</p>\n\n<p>I have an R script that generates several plots, and I want to view all the plots on screen at once (in seperate windows), but I can't work out how to open multiple graphics windows.  I'm using ggplot2, but I feel this is a more basic problem, so I'm just using base grapics for this simple example</p>\n\n<pre><code>x&lt;-c(1:10)\ny&lt;-sin(x)\nz&lt;-cos(x)\ndev.new()\nplot(y=y,x=x)\ndev.off()\ndev.new()\nplot(x=x,y=z) \n</code></pre>\n\n<p>But this doesn't work.  I'm on Windows if this matters (Windows + Eclipse + StatEt)</p>\n"},{"tags":["r","hadoop"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13125263,"title":"Installing Rhbase package for RHadoop: missing \"libthrift\" error","body":"<p>I followed the instructions for installing Thrift pre-requisites on\n<a href=\"http://github.com/RevolutionAnalytics/RHadoop/wiki/rhbase\" rel=\"nofollow\">http://github.com/RevolutionAnalytics/RHadoop/wiki/rhbase</a></p>\n\n<p>And I updated the PKG_CONFIG_PATH</p>\n\n<pre><code>[root@localhost cloudera]# pkg-config --cflags thrift\n-I/usr/local/include/thrift \n</code></pre>\n\n<p>The only issue I may have had there was that you are supposed to copy the thrift library\n \"/usr/local/lib/libthrift.so.0 /usr/lib/ to /usr/lib/</p>\n\n<p>But there is no .0 file</p>\n\n<pre><code>[root@localhost cloudera]# cd /usr/local/lib\n[root@localhost lib]# ls\nlibthrift-0.9.0.so    libthriftnb.a   libthriftz-0.9.0.so  pkgconfig\nlibthrift.a           libthriftnb.la  libthriftz.a\nlibthrift.la          libthriftnb.so  libthriftz.la\nlibthriftnb-0.9.0.so  libthrift.so    libthriftz.so\n</code></pre>\n\n<p>...so I just copied libthrift.so</p>\n\n<p>I tried starting the Thrift server but I admit I don't know how to interpret the output...</p>\n\n<pre><code>[root@localhost bin]# /usr/bin/hbase thrift start\n12/10/29 15:51:54 INFO util.VersionInfo: HBase 0.92.1-cdh4.1.1\n12/10/29 15:51:54 INFO util.VersionInfo: Subversion file:///data/1/jenkins/workspace/generic-package-rhel64-6-0/topdir/BUILD/hbase-0.92.1-cdh4.1.1 -r Unknown\n12/10/29 15:51:54 INFO util.VersionInfo: Compiled by jenkins on Tue Oct 16 12:01:17 PDT 2012\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.3-cdh4.1.1--1, built on 10/16/2012 17:34 GMT\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Client environment:host.name=localhost.localdomain\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Client environment:java.version=1.6.0_31\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Client environment:java.vendor=Sun Microsystems Inc.\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Client environment:java.home=/usr/java/jdk1.6.0_31/jre\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Client environment:java.class.path=/usr/lib/hbase/bin/../conf:/usr/java/jdk1.6.0_31/lib/tools.jar:/usr/lib/hbase/bin/..:/usr/lib/hbase/bin/../hbase-0.92.1-cdh4.1.1-security.jar:/usr/lib/hbase/bin/../hbase-0.92.1-cdh4.1.1-security-tests.jar:/usr/lib/hbase/bin/../hbase.jar:/usr/lib/hbase/bin/../lib/activation-1.1.jar:/usr/lib/hbase/bin/../lib/aopalliance-1.0.jar:/usr/lib/hbase/bin/../lib/asm-3.2.jar:/usr/lib/hbase/bin/../lib/avro-1.7.1.cloudera.2.jar:/usr/lib/hbase/bin/../lib/commons-beanutils-1.7.0.jar:/usr/lib/hbase/bin/../lib/commons-beanutils-core-1.8.0.jar:/usr/lib/hbase/bin/../lib/commons-cli-1.2.jar:/usr/lib/hbase/bin/../lib/commons-codec-1.4.jar:/usr/lib/hbase/bin/../lib/commons-collections-3.2.1.jar:/usr/lib/hbase/bin/../lib/commons-configuration-1.6.jar:/usr/lib/hbase/bin/../lib/commons-daemon-1.0.3.jar:/usr/lib/hbase/bin/../lib/commons-digester-1.8.jar:/usr/lib/hbase/bin/../lib/commons-el-1.0.jar:/usr/lib/hbase/bin/../lib/commons-httpclient-3.1.jar:/usr/lib/hbase/bin/../lib/commons-io-2.1.jar:/usr/lib/hbase/bin/../lib/commons-lang-2.5.jar:/usr/lib/hbase/bin/../lib/commons-logging-1.1.1.jar:/usr/lib/hbase/bin/../lib/commons-net-3.1.jar:/usr/lib/hbase/bin/../lib/core-3.1.1.jar:/usr/lib/hbase/bin/../lib/gmbal-api-only-3.0.0-b023.jar:/usr/lib/hbase/bin/../lib/grizzly-framework-2.1.1.jar:/usr/lib/hbase/bin/../lib/grizzly-framework-2.1.1-tests.jar:/usr/lib/hbase/bin/../lib/grizzly-http-2.1.1.jar:/usr/lib/hbase/bin/../lib/grizzly-http-server-2.1.1.jar:/usr/lib/hbase/bin/../lib/grizzly-http-servlet-2.1.1.jar:/usr/lib/hbase/bin/../lib/grizzly-rcm-2.1.1.jar:/usr/lib/hbase/bin/../lib/guava-11.0.2.jar:/usr/lib/hbase/bin/../lib/guice-3.0.jar:/usr/lib/hbase/bin/../lib/guice-servlet-3.0.jar:/usr/lib/hbase/bin/../lib/high-scale-lib-1.1.1.jar:/usr/lib/hbase/bin/../lib/httpclient-4.0.1.jar:/usr/lib/hbase/bin/../lib/httpcore-4.0.1.jar:/usr/lib/hbase/bin/../lib/jackson-core-asl-1.8.8.jar:/usr/lib/hbase/bin/../lib/jackson-jaxrs-1.8.8.jar:/usr/lib/hbase/bin/../lib/jackson-mapper-asl-1.8.8.jar:/usr/lib/hbase/bin/../lib/jackson-xc-1.8.8.jar:/usr/lib/hbase/bin/../lib/jamon-runtime-2.3.1.jar:/usr/lib/hbase/bin/../lib/jasper-compiler-5.5.23.jar:/usr/lib/hbase/bin/../lib/jasper-runtime-5.5.23.jar:/usr/lib/hbase/bin/../lib/javax.inject-1.jar:/usr/lib/hbase/bin/../lib/javax.servlet-3.0.jar:/usr/lib/hbase/bin/../lib/jaxb-api-2.1.jar:/usr/lib/hbase/bin/../lib/jaxb-impl-2.2.3-1.jar:/usr/lib/hbase/bin/../lib/jersey-client-1.8.jar:/usr/lib/hbase/bin/../lib/jersey-core-1.8.jar:/usr/lib/hbase/bin/../lib/jersey-grizzly2-1.8.jar:/usr/lib/hbase/bin/../lib/jersey-guice-1.8.jar:/usr/lib/hbase/bin/../lib/jersey-json-1.8.jar:/usr/lib/hbase/bin/../lib/jersey-server-1.8.jar:/usr/lib/hbase/bin/../lib/jersey-test-framework-core-1.8.jar:/usr/lib/hbase/bin/../lib/jersey-test-framework-grizzly2-1.8.jar:/usr/lib/hbase/bin/../lib/jets3t-0.6.1.jar:/usr/lib/hbase/bin/../lib/jettison-1.1.jar:/usr/lib/hbase/bin/../lib/jetty-6.1.26.cloudera.2.jar:/usr/lib/hbase/bin/../lib/jetty-util-6.1.26.cloudera.2.jar:/usr/lib/hbase/bin/../lib/jruby-complete-1.6.5.jar:/usr/lib/hbase/bin/../lib/jsch-0.1.42.jar:/usr/lib/hbase/bin/../lib/jsp-2.1-6.1.14.jar:/usr/lib/hbase/bin/../lib/jsp-api-2.1-6.1.14.jar:/usr/lib/hbase/bin/../lib/jsp-api-2.1.jar:/usr/lib/hbase/bin/../lib/jsr305-1.3.9.jar:/usr/lib/hbase/bin/../lib/kfs-0.3.jar:/usr/lib/hbase/bin/../lib/libthrift-0.7.0.jar:/usr/lib/hbase/bin/../lib/log4j-1.2.17.jar:/usr/lib/hbase/bin/../lib/management-api-3.0.0-b012.jar:/usr/lib/hbase/bin/../lib/metrics-core-2.1.2.jar:/usr/lib/hbase/bin/../lib/netty-3.2.4.Final.jar:/usr/lib/hbase/bin/../lib/paranamer-2.3.jar:/usr/lib/hbase/bin/../lib/protobuf-java-2.4.0a.jar:/usr/lib/hbase/bin/../lib/servlet-api-2.5-6.1.14.jar:/usr/lib/hbase/bin/../lib/servlet-api-2.5.jar:/usr/lib/hbase/bin/../lib/slf4j-api-1.6.1.jar:/usr/lib/hbase/bin/../lib/snappy-java-1.0.4.1.jar:/usr/lib/hbase/bin/../lib/stax-api-1.0.1.jar:/usr/lib/hbase/bin/../lib/xmlenc-0.52.jar:/usr/lib/hbase/bin/../lib/zookeeper.jar:/etc/hadoop/conf:/*:/lib/*:/usr/lib/zookeeper/zookeeper.jar:/usr/lib/zookeeper/zookeeper-3.4.3-cdh4.1.1.jar:/usr/lib/zookeeper/lib/netty-3.2.2.Final.jar:/usr/lib/zookeeper/lib/jline-0.9.94.jar:/usr/lib/zookeeper/lib/log4j-1.2.15.jar:/usr/lib/zookeeper/lib/slf4j-log4j12-1.6.1.jar:/usr/lib/zookeeper/lib/slf4j-api-1.6.1.jar::/etc/hadoop/conf:/usr/lib/hadoop/lib/commons-io-2.1.jar:/usr/lib/hadoop/lib/xmlenc-0.52.jar:/usr/lib/hadoop/lib/commons-math-2.1.jar:/usr/lib/hadoop/lib/avro-1.7.1.cloudera.2.jar:/usr/lib/hadoop/lib/commons-logging-1.1.1.jar:/usr/lib/hadoop/lib/commons-beanutils-core-1.8.0.jar:/usr/lib/hadoop/lib/junit-4.8.2.jar:/usr/lib/hadoop/lib/kfs-0.3.jar:/usr/lib/hadoop/lib/jetty-util-6.1.26.cloudera.2.jar:/usr/lib/hadoop/lib/jets3t-0.6.1.jar:/usr/lib/hadoop/lib/commons-el-1.0.jar:/usr/lib/hadoop/lib/jaxb-api-2.2.2.jar:/usr/lib/hadoop/lib/jettison-1.1.jar:/usr/lib/hadoop/lib/log4j-1.2.17.jar:/usr/lib/hadoop/lib/commons-configuration-1.6.jar:/usr/lib/hadoop/lib/jasper-compiler-5.5.23.jar:/usr/lib/hadoop/lib/jaxb-impl-2.2.3-1.jar:/usr/lib/hadoop/lib/commons-codec-1.4.jar:/usr/lib/hadoop/lib/snappy-java-1.0.4.1.jar:/usr/lib/hadoop/lib/jline-0.9.94.jar:/usr/lib/hadoop/lib/activation-1.1.jar:/usr/lib/hadoop/lib/jasper-runtime-5.5.23.jar:/usr/lib/hadoop/lib/jersey-core-1.8.jar:/usr/lib/hadoop/lib/jsch-0.1.42.jar:/usr/lib/hadoop/lib/asm-3.2.jar:/usr/lib/hadoop/lib/commons-httpclient-3.1.jar:/usr/lib/hadoop/lib/commons-collections-3.2.1.jar:/usr/lib/hadoop/lib/stax-api-1.0.1.jar:/usr/lib/hadoop/lib/commons-beanutils-1.7.0.jar:/usr/lib/hadoop/lib/jsp-api-2.1.jar:/usr/lib/hadoop/lib/jackson-mapper-asl-1.8.8.jar:/usr/lib/hadoop/lib/jackson-xc-1.8.8.jar:/usr/lib/hadoop/lib/paranamer-2.3.jar:/usr/lib/hadoop/lib/jersey-json-1.8.jar:/usr/lib/hadoop/lib/guava-11.0.2.jar:/usr/lib/hadoop/lib/jsr305-1.3.9.jar:/usr/lib/hadoop/lib/slf4j-log4j12-1.6.1.jar:/usr/lib/hadoop/lib/jackson-core-asl-1.8.8.jar:/usr/lib/hadoop/lib/jetty-6.1.26.cloudera.2.jar:/usr/lib/hadoop/lib/mockito-all-1.8.5.jar:/usr/lib/hadoop/lib/commons-net-3.1.jar:/usr/lib/hadoop/lib/jackson-jaxrs-1.8.8.jar:/usr/lib/hadoop/lib/commons-lang-2.5.jar:/usr/lib/hadoop/lib/commons-digester-1.8.jar:/usr/lib/hadoop/lib/zookeeper-3.4.3-cdh4.1.1.jar:/usr/lib/hadoop/lib/commons-cli-1.2.jar:/usr/lib/hadoop/lib/slf4j-api-1.6.1.jar:/usr/lib/hadoop/lib/hue-plugins-2.1.0-cdh4.1.1.jar:/usr/lib/hadoop/lib/protobuf-java-2.4.0a.jar:/usr/lib/hadoop/lib/servlet-api-2.5.jar:/usr/lib/hadoop/lib/jersey-server-1.8.jar:/usr/lib/hadoop/.//hadoop-annotations-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop/.//hadoop-common-2.0.0-cdh4.1.1-tests.jar:/usr/lib/hadoop/.//hadoop-auth-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop/.//hadoop-common-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop/.//hadoop-auth.jar:/usr/lib/hadoop/.//hadoop-common.jar:/usr/lib/hadoop/.//hadoop-annotations.jar:/usr/lib/hadoop-hdfs/./:/usr/lib/hadoop-hdfs/lib/commons-io-2.1.jar:/usr/lib/hadoop-hdfs/lib/xmlenc-0.52.jar:/usr/lib/hadoop-hdfs/lib/commons-logging-1.1.1.jar:/usr/lib/hadoop-hdfs/lib/jetty-util-6.1.26.cloudera.2.jar:/usr/lib/hadoop-hdfs/lib/commons-el-1.0.jar:/usr/lib/hadoop-hdfs/lib/log4j-1.2.17.jar:/usr/lib/hadoop-hdfs/lib/commons-codec-1.4.jar:/usr/lib/hadoop-hdfs/lib/jline-0.9.94.jar:/usr/lib/hadoop-hdfs/lib/jasper-runtime-5.5.23.jar:/usr/lib/hadoop-hdfs/lib/jersey-core-1.8.jar:/usr/lib/hadoop-hdfs/lib/asm-3.2.jar:/usr/lib/hadoop-hdfs/lib/jsp-api-2.1.jar:/usr/lib/hadoop-hdfs/lib/jackson-mapper-asl-1.8.8.jar:/usr/lib/hadoop-hdfs/lib/guava-11.0.2.jar:/usr/lib/hadoop-hdfs/lib/jsr305-1.3.9.jar:/usr/lib/hadoop-hdfs/lib/jackson-core-asl-1.8.8.jar:/usr/lib/hadoop-hdfs/lib/jetty-6.1.26.cloudera.2.jar:/usr/lib/hadoop-hdfs/lib/commons-lang-2.5.jar:/usr/lib/hadoop-hdfs/lib/zookeeper-3.4.3-cdh4.1.1.jar:/usr/lib/hadoop-hdfs/lib/commons-cli-1.2.jar:/usr/lib/hadoop-hdfs/lib/protobuf-java-2.4.0a.jar:/usr/lib/hadoop-hdfs/lib/servlet-api-2.5.jar:/usr/lib/hadoop-hdfs/lib/commons-daemon-1.0.3.jar:/usr/lib/hadoop-hdfs/lib/jersey-server-1.8.jar:/usr/lib/hadoop-hdfs/.//hadoop-hdfs-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-hdfs/.//hadoop-hdfs.jar:/usr/lib/hadoop-hdfs/.//hadoop-hdfs-2.0.0-cdh4.1.1-tests.jar:/usr/lib/hadoop-yarn/lib/commons-io-2.1.jar:/usr/lib/hadoop-yarn/lib/avro-1.7.1.cloudera.2.jar:/usr/lib/hadoop-yarn/lib/log4j-1.2.17.jar:/usr/lib/hadoop-yarn/lib/jersey-guice-1.8.jar:/usr/lib/hadoop-yarn/lib/javax.inject-1.jar:/usr/lib/hadoop-yarn/lib/snappy-java-1.0.4.1.jar:/usr/lib/hadoop-yarn/lib/jersey-core-1.8.jar:/usr/lib/hadoop-yarn/lib/asm-3.2.jar:/usr/lib/hadoop-yarn/lib/aopalliance-1.0.jar:/usr/lib/hadoop-yarn/lib/jackson-mapper-asl-1.8.8.jar:/usr/lib/hadoop-yarn/lib/paranamer-2.3.jar:/usr/lib/hadoop-yarn/lib/guice-3.0.jar:/usr/lib/hadoop-yarn/lib/guice-servlet-3.0.jar:/usr/lib/hadoop-yarn/lib/jackson-core-asl-1.8.8.jar:/usr/lib/hadoop-yarn/lib/netty-3.2.4.Final.jar:/usr/lib/hadoop-yarn/lib/protobuf-java-2.4.0a.jar:/usr/lib/hadoop-yarn/lib/jersey-server-1.8.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-applications-distributedshell.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-nodemanager-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-resourcemanager-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-tests.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-tests-2.0.0-cdh4.1.1-tests.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-common-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-tests-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-applications-distributedshell-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-common.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-web-proxy-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-nodemanager.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-site-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-site.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-web-proxy.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-common-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-api.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-api-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-common.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-resourcemanager.jar:/usr/lib/hadoop-mapreduce/lib/commons-io-2.1.jar:/usr/lib/hadoop-mapreduce/lib/avro-1.7.1.cloudera.2.jar:/usr/lib/hadoop-mapreduce/lib/log4j-1.2.17.jar:/usr/lib/hadoop-mapreduce/lib/jersey-guice-1.8.jar:/usr/lib/hadoop-mapreduce/lib/javax.inject-1.jar:/usr/lib/hadoop-mapreduce/lib/snappy-java-1.0.4.1.jar:/usr/lib/hadoop-mapreduce/lib/jersey-core-1.8.jar:/usr/lib/hadoop-mapreduce/lib/asm-3.2.jar:/usr/lib/hadoop-mapreduce/lib/aopalliance-1.0.jar:/usr/lib/hadoop-mapreduce/lib/jackson-mapper-asl-1.8.8.jar:/usr/lib/hadoop-mapreduce/lib/paranamer-2.3.jar:/usr/lib/hadoop-mapreduce/lib/guice-3.0.jar:/usr/lib/hadoop-mapreduce/lib/guice-servlet-3.0.jar:/usr/lib/hadoop-mapreduce/lib/jackson-core-asl-1.8.8.jar:/usr/lib/hadoop-mapreduce/lib/netty-3.2.4.Final.jar:/usr/lib/hadoop-mapreduce/lib/protobuf-java-2.4.0a.jar:/usr/lib/hadoop-mapreduce/lib/jersey-server-1.8.jar:/usr/lib/hadoop-mapreduce/.//hadoop-rumen.jar:/usr/lib/hadoop-mapreduce/.//hadoop-distcp-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-mapreduce/.//hadoop-mapreduce-client-common.jar:/usr/lib/hadoop-mapreduce/.//hadoop-gridmix.jar:/usr/lib/hadoop-mapreduce/.//hadoop-streaming.jar:/usr/lib/hadoop-mapreduce/.//hadoop-rumen-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-mapreduce/.//hadoop-extras-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-mapreduce/.//hadoop-mapreduce-client-common-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-mapreduce/.//hadoop-distcp.jar:/usr/lib/hadoop-mapreduce/.//hadoop-mapreduce-client-core-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-mapreduce/.//hadoop-datajoin-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-mapreduce/.//hadoop-mapreduce-examples-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-mapreduce/.//hadoop-mapreduce-client-jobclient.jar:/usr/lib/hadoop-mapreduce/.//hadoop-mapreduce-client-hs.jar:/usr/lib/hadoop-mapreduce/.//hadoop-mapreduce-client-core.jar:/usr/lib/hadoop-mapreduce/.//hadoop-archives.jar:/usr/lib/hadoop-mapreduce/.//hadoop-mapreduce-client-jobclient-2.0.0-cdh4.1.1-tests.jar:/usr/lib/hadoop-mapreduce/.//hadoop-mapreduce-examples.jar:/usr/lib/hadoop-mapreduce/.//hadoop-mapreduce-client-hs-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-mapreduce/.//hadoop-mapreduce-client-jobclient-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-mapreduce/.//hadoop-mapreduce-client-shuffle.jar:/usr/lib/hadoop-mapreduce/.//hadoop-datajoin.jar:/usr/lib/hadoop-mapreduce/.//hadoop-mapreduce-client-shuffle-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-mapreduce/.//hadoop-mapreduce-client-app.jar:/usr/lib/hadoop-mapreduce/.//hadoop-archives-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-mapreduce/.//hadoop-gridmix-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-mapreduce/.//hadoop-mapreduce-client-app-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-mapreduce/.//hadoop-streaming-2.0.0-cdh4.1.1.jar:/usr/lib/hadoop-mapreduce/.//hadoop-extras.jar\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Client environment:java.library.path=//usr/lib/hadoop/lib/native:/usr/lib/hbase/bin/../lib/native/Linux-amd64-64\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Client environment:java.compiler=&lt;NA&gt;\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Client environment:os.name=Linux\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Client environment:os.arch=amd64\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Client environment:os.version=2.6.32-220.23.1.el6.x86_64\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Client environment:user.name=root\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Client environment:user.home=/root\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Client environment:user.dir=/usr/bin\n12/10/29 15:51:55 INFO zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=180000 watcher=hconnection\n12/10/29 15:51:55 INFO zookeeper.RecoverableZooKeeper: The identifier of this process is 15842@localhost.localdomain\n12/10/29 15:51:55 INFO zookeeper.ClientCnxn: Opening socket connection to server localhost.localdomain/127.0.0.1:2181. Will not attempt to authenticate using SASL (Unable to locate a login configuration)\n12/10/29 15:51:55 INFO zookeeper.ClientCnxn: Socket connection established to localhost.localdomain/127.0.0.1:2181, initiating session\n12/10/29 15:51:55 INFO zookeeper.ClientCnxn: Session establishment complete on server localhost.localdomain/127.0.0.1:2181, sessionid = 0x13aad9c16a60009, negotiated timeout = 40000\n12/10/29 15:51:56 WARN conf.Configuration: hadoop.native.lib is deprecated. Instead, use io.native.lib.available\nException in thread \"main\" org.apache.thrift.transport.TTransportException: Could not create ServerSocket on address /0.0.0.0:9090.\n    at org.apache.thrift.transport.TServerSocket.&lt;init&gt;(TServerSocket.java:93)\n    at org.apache.thrift.transport.TServerSocket.&lt;init&gt;(TServerSocket.java:79)\n    at org.apache.hadoop.hbase.thrift.ThriftServer.doMain(ThriftServer.java:1028)\n    at org.apache.hadoop.hbase.thrift.ThriftServer.main(ThriftServer.java:1066)\n</code></pre>\n\n<p>(Sorry for all that mess). And then finally I try to install rhbase and get that error...</p>\n\n<pre><code>[root@localhost cloudera]# sudo -E R CMD INSTALL rhbase_1.1.tar.gz\n* installing to library ‘/usr/lib64/R/library’\n* installing *source* package ‘rhbase’ ...\n** libs\ng++ -m64 -I/usr/include/R -DNDEBUG  -I/usr/local/include   -I. -g  -DHAVE_UINTPTR_T -DHAVE_NETDB_H=1 -fpermissive -DHAVE_INTTYPES_H -DHAVE_NETINET_IN_H -I./gen_cpp `pkg-config --cflags thrift` -Wall -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Hbase.cpp -o Hbase.o\ng++ -m64 -I/usr/include/R -DNDEBUG  -I/usr/local/include   -I. -g  -DHAVE_UINTPTR_T -DHAVE_NETDB_H=1 -fpermissive -DHAVE_INTTYPES_H -DHAVE_NETINET_IN_H -I./gen_cpp `pkg-config --cflags thrift` -Wall -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Hbase_constants.cpp -o Hbase_constants.o\ng++ -m64 -I/usr/include/R -DNDEBUG  -I/usr/local/include   -I. -g  -DHAVE_UINTPTR_T -DHAVE_NETDB_H=1 -fpermissive -DHAVE_INTTYPES_H -DHAVE_NETINET_IN_H -I./gen_cpp `pkg-config --cflags thrift` -Wall -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Hbase_types.cpp -o Hbase_types.o\ng++ -m64 -I/usr/include/R -DNDEBUG  -I/usr/local/include   -I. -g  -DHAVE_UINTPTR_T -DHAVE_NETDB_H=1 -fpermissive -DHAVE_INTTYPES_H -DHAVE_NETINET_IN_H -I./gen_cpp `pkg-config --cflags thrift` -Wall -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c tools.cc -o tools.o\ng++ -m64 -shared -L/usr/local/lib64 -o rhbase.so Hbase.o Hbase_constants.o Hbase_types.o tools.o -L/usr/local/lib -lthrift -L/usr/lib64/R/lib -lR\ninstalling to /usr/lib64/R/library/rhbase/libs\n** R\n** inst\n** preparing package for lazy loading\n** help\n*** installing help indices\n  converting help for package ‘rhbase’\n    finding HTML links ... done\n    admin                                   html \n    functions                               html \n    rhbase                                  html \n** building package indices\n** testing if installed package can be loaded\nError in dyn.load(file, DLLpath = DLLpath, ...) :\n  unable to load shared object '/usr/lib64/R/library/rhbase/libs/rhbase.so':\n  libthrift-0.9.0.so: cannot open shared object file: No such file or directory\nError: loading failed\nExecution halted\nERROR: loading failed\n* removing ‘/usr/lib64/R/library/rhbase’\n</code></pre>\n\n<p>Suggestions?</p>\n"},{"tags":["r","parallel-processing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13137166,"title":"R and parallelization","body":"<p>I am quite a newbie in parallel processing and I'd like some advices.</p>\n\n<p>My R program has a structure as follows :</p>\n\n<pre><code>Data reading\nPreliminary calculations\n\nvector1 &lt;- array(NA,sim=nsim)\nvector2 &lt;- array(NA,sim=nsim)\nfor (i in 1:nsim)\n{\nsome calculations involving some global variables and \nwhose results are saved in vector1 and vector2\n}\nFinal calculations using vector1 and vector2\n</code></pre>\n\n<p>This loop is really time consuming and I was wondering which R package could offer me the best way to parallelize it. Do u have any ideas ? Thanks in advance.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":149,"score":0,"question_id":9740247,"title":"Can I see Symbol Load Table of Rcpp on R?","body":"<p>Sometime I got a message on R</p>\n\n<pre><code>&gt; .Call(\"blablabla\")\nError in .Call(\"blablabla\") : C symbol name \"blablabla\" not in load table\n</code></pre>\n\n<p>Can I check what is loaded on the table of C symbol name?\nIs there R command showing the C symbol name on load table?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13126356,"title":"Changing column names in list elements","body":"<p>I have a huge list with data.frames (same number of columns, different number of rows).\nI succeeded to use apply - instead of the for loops I learned to avoid - to create a mean value over specific columns in each list element with </p>\n\n<pre><code>t2&lt;-lapply(t1, function(x) cbind(x,rowMeans(x[,c(\"ColumnX\",\"ColumnY\",\"ColumnZ\")])))\n</code></pre>\n\n<p>The problem I am stuck with now is the new columns name. It is \"rowMeans(x[,c(\"ColumnX\",\"ColumnY\",\"ColumnZ\")])\".</p>\n\n<p>How can I change this for all list elements? My poor \"lapply\"-knowledge was not sufficient for this task.</p>\n"},{"tags":["r","list","data.frame","intervals"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13137490,"title":"Splitting a data frame into a list using intervals","body":"<p>I want to split a data frame like this</p>\n\n<pre><code>chr.pos nt.pos  CNV\n1   74355   0\n1   431565  0\n1   675207  0\n1   783605  1\n1   888149  1\n1   991311  1\n1   1089305 1\n1   1177669 1\n1   1279886 0\n1   1406311 0\n1   1491385 0\n1   1579761 0\n2   1670488 1\n2   1758800 1\n2   1834256 0\n2   1902924 1\n2   1978088 1\n2   2063124 0 \n</code></pre>\n\n<p>The point is to get a list of intervals where the chr are the same and CNV=1 column, but taking into account the 0 inervals between them</p>\n\n<pre><code>[[1]]\n\n   1    783605  1\n   1    888149  1\n   1    991311  1\n   1    1089305 1\n   1    1177669 1\n[[2]]\n   2    1670488 1\n   2    1758800 1\n[[3]]\n   2    1902924 1\n   2    1978088 1\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["r","s4"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":161,"score":3,"question_id":12368439,"title":"Defining group generic functions in an R package","body":"<p>I'm having trouble defining a group generic within an R package that I'm writing.</p>\n\n<p>Here is a fairly minimal example:</p>\n\n<pre><code>setGroupGeneric('FooBarFunctions', function(x, y) NULL)\n\nsetGeneric('foo', group = 'FooBarFunctions', function(x, y) standardGeneric('foo'))\nsetGeneric('bar', group = 'FooBarFunctions', function(x, y) standardGeneric('bar'))\n\nsetMethod('foo', signature(x = 'ANY', y = 'ANY'),\nfunction(x, y)\n  cat(sprintf('foo,ANY (%s),ANY (%s)\\n', x, y)))\n\nsetMethod('bar', signature(x = 'ANY', y = 'ANY'),\nfunction(x, y)\n  cat(sprintf('bar,ANY (%s),ANY (%s)\\n', x, y)))\n\nsetMethod('FooBarFunctions', signature(x = 'character', y = 'ANY'),\nfunction(x, y)\n  cat(sprintf('FooBarFunctions,character (%s),ANY (%s)\\n', x, y)))\n</code></pre>\n\n<p>If I paste this code into an R terminal, then everything works as expected:</p>\n\n<pre><code>&gt; foo(1, 2)\nfoo,ANY (1),ANY (2)\n&gt; bar(1, 2)\nbar,ANY (1),ANY (2)\n&gt; foo('a', 2)\nFooBarFunctions,character (a),ANY (2)\n&gt; bar('a', 2)\nFooBarFunctions,character (a),ANY (2)\n</code></pre>\n\n<p>However, as soon as I try to build this into a package I run into the following error:</p>\n\n<pre><code>$ R CMD INSTALL .\n* installing to library ‘~/R/x86_64-pc-linux-gnu-library/2.15’\n* installing *source* package ‘anRpackage’ ...\n** R\n** preparing package for lazy loading\n** help\nNo man pages found in package  ‘anRpackage’ \n*** installing help indices\n** building package indices\n** testing if installed package can be loaded\n**Error in .setupMethodsTables(generic) : \n  trying to get slot \"group\" from an object of a basic class (\"NULL\") with no slots**\nError: loading failed\nExecution halted\nERROR: loading failed\n* removing ‘~/R/x86_64-pc-linux-gnu-library/2.15/anRpackage’\n</code></pre>\n\n<p>I'm using the default output from package.skeleton(), having added:</p>\n\n<pre><code>exportPattern(\"^[[:alpha:]]+\")\n</code></pre>\n\n<p>into the NAMESPACE file</p>\n\n<p>Any idea what I'm doing wrong?</p>\n"},{"tags":["r","data.frame","paste"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":49,"score":3,"question_id":13132172,"title":"Generating and naming powered transformations of variables in R","body":"<p>I'm a newbie with R (coming from the Stata world).  To save myself time, I'm trying to use the loop function to generate powers of an existing column of data within a data frame (that is roughly 70,000 rows long). The existing column is called OrdersData$timecount; I'm trying to automate making 9 powers of it, i.e. OrdersData$timecount2=OrdersData$timecount^2, OrdersData$timecount3=OrdersData$timecount^3, and so on.  I'm trying to do it all in one for command:</p>\n\n<pre><code>i&lt;-1;\nfor(i in 1:9){paste(OrdersData$timecount,\"[i+1]\",sep=\"\")&lt;-OrdersData$timecount^[i+1]}\n</code></pre>\n\n<p>I'm getting an error called \"text\".  What am I doing wrong?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":66,"score":7,"question_id":13118843,"title":"Compute counting variable in dataframe","body":"<p>I have an R data frame:</p>\n\n<pre><code>a &lt;- 1:12  \nlist &lt;- c(rep(\"x\",3),rep(\"y\",4),rep(\"z\",3),rep(\"x\",2))  \ndata &lt;- data.frame(a,list)\n\ndata  \n a list  \n 1    x  \n 2    x  \n 3    x  \n 4    y  \n 5    y  \n 6    y  \n 7    y  \n 8    z  \n 9    z  \n10    z  \n11    x  \n12    x\n</code></pre>\n\n<p>I want to create a new column which begins counting at 1 every time the value of \"list\" changes, i.e. in this example:</p>\n\n<pre><code>b &lt;- c(1:3,1:4,1:3,1:2)    \ndata &lt;- data.frame(a,list,b)  \n</code></pre>\n\n<p>I am far from being an expert in R and cannot for the life of me work out an efficient way of doing this. My main problem seems to be that\nany value of \"list\" can come back at any time, but there is no rule to the length of the blocks of one value.\nDoes anyone have any ideas? \nThanks!</p>\n"},{"tags":["r","random"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13127286,"title":"R GraphNEL: Result of adj function is a vector of length one. Access concatenated values separately?","body":"<p>Im working with a graphNEL object and need to extract the adjacent nodes of\na specified node. This is solvable with adj(nodes(graph),\"node123\"),\nhowever the nodes are returned as a vector of size 1. So I cant\naccess directly vertain nodes for it. </p>\n\n<p>Lets say:</p>\n\n<pre><code>&gt; adjacent &lt;- adj(subgraph,\"hsa:991\")\n&gt; adjacent\n$`hsa:991`\n[1] \"hsa:10744\" \"hsa:29945\" \"hsa:51433\" \"hsa:8881\" \n</code></pre>\n\n<p>For an algorithm I just need lets say \"hsa:29945\" but since this\nvector just is of size one, I have a problem. Is this possible? \nThe best thing would be that every node is recognized as a element.\nBtw.: maybe somebody can explain to me why they are even only one element\nI mean [1] \"hsa:10744 hsa:29945 hsa:51433 hsa:8881\" I could understand\nbut why are there quotes after every node? After all I just need to implement\na random walk on a graph. But I havent found any packages. So I will try to\nimplement it myself.</p>\n\n<p>Hope you can help me.\nThanks in advance.\nCheers \nRich</p>\n"},{"tags":["r","hadoop","svm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":27,"score":-2,"question_id":13135216,"title":"svm modeling in R with Hadoop","body":"<p>As started developing a predictive modeling in R, I thinking to forward towards Hadoop with R for SVM modeling. Can any one suggest me the related packages/techniques to perform predictive svm modeling With R and Hadoop.</p>\n"},{"tags":["r","rcurl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13132555,"title":"Installing R package from command line","body":"<p>I am having real trouble installing couple of packages but the root cause is mainly missing libraries. I will list one example here.</p>\n\n<p>inside R-2.15.2</p>\n\n<pre><code>install.packages(\"RCurl\")\n\n/usr/share/R/include/Rinternals.h:676: note: expected 'const char *' but argument is of type 'ucs_t *'\ngcc -std=gnu99 -shared -o RCurl.so base64.o curl.o curlInit.o curl_base64.o enums.o json.o memoryManagement.o myUTF8.o -L/jgi/local/Linux_x86_64/unixadm/curl/7.19.7/lib -lcurl -lidn -lssl -lcrypto -lrt -lssl -lcrypto -lz -lxml2 -L/usr/lib64/R/lib -lR\n/usr/bin/ld: cannot find -lidn\ncollect2: ld returned 1 exit status\nmake: *** [RCurl.so] Error 1\nERROR: compilation failed for package 'RCurl'\n* removing '/house/homedirs/a/apratap/lib/R/RCurl'\n</code></pre>\n\n<p>I have tried few things to supply library path but not successful.</p>\n\n<p>Also:</p>\n\n<pre><code>&lt;/scratch&gt;echo $LD_LIBRARY_PATH \n/usr/lib:/house/homedirs/a/apratap/lib:/jgi/tools/lib\n&lt;/scratch&gt;echo $R_LD_LIBRARY_PATH \n/usr/lib:/house/homedirs/a/apratap/lib:/jgi/tools/lib\n</code></pre>\n"},{"tags":["r","svm","bigdata"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13134188,"title":"SVM modeling with BIG DATA","body":"<p>For modeling with SVM in R, I have used kernlab package (ksvm method)with Windows Xp operating system and 2 GB RAM. But having more data rows as 201497, I can'nt able to provide more memory for processing of data modeling (getting issue : can not allocate vector size greater than 2.7 GB).</p>\n\n<p>Therefore, I have used Amazon micro and large instance for SCM modeling. But, it have same issue as local machine (can not allocate vector size greater than 2.7 GB).</p>\n\n<p>Can any one suggest me the solution of this problem with BIG DATA modeling or Is there something wrong with this.</p>\n"},{"tags":["r","factor"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13132250,"title":"Factor vs. ordered factor?","body":"<p>Here is the problem that I'm trying to solve. I'm using <code>burn</code> dataset from <code>KMsurv</code> library and I'm trying to fit a simple survival model with two simple covariates. One of these predictors is an ordered factor. Perhaps my question is a naive question, When I look at the result, I see the words <code>L</code> and <code>Q</code> in front of my estimated coefficients. Do <code>L</code> and <code>Q</code> refer to linear and quadratic? I expected to see the same number of estimated coefficients but with different estimates when I adjusted an ordered factor compared to adjusting the same factor which is not ordered. Could you guide me on what the result of my fit means (those coeff with <code>Q</code> and <code>L</code>) and how they should be interpreted? I appreciate if you could also refer me to a reference to learn more about adjusting ordered factors.\nHere is my code:</p>\n\n<pre><code>library(KMsurv)\ndata(burn)\nnames(burn) &lt;- c(\"Obs\", \"TRT\", \"Female\", \"White\", \"SurfBurned\", \"HeadBurned\",\n\"buttBurned\", \"TrunkBurned\", \"UpperLegBurned\", \"LowerLegBurned\", \"resp\", \n\"BurnType\", \"ExcisionTime\", \"ExcisionDelta\", \"prophylacticTime\",\n\"ProphylacticDelta\", \"straphylInfTime\", \"straphylInfDelta\")\n\nburn$SurfBurned_cat &lt;- factor(cut(burn$SurfBurned, c(0, 10, 25, 100), \nlabels = c(\"low\", \"medium\", \"high\")),  \n\nlevels = c(\"low\", \"medium\", \"high\"), ordered = TRUE)\nQ4PcCoxModel &lt;- coxph(Surv(straphylInfTime, straphylInfDelta) ~\n                       TRT*SurfBurned_cat, \n                      data = burn)\nsummary(Q4PcCoxModel)\n</code></pre>\n\n<p>Thanks for your help.</p>\n"},{"tags":["r","svm","prediction"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12931754,"title":"Svm modeling :: Error in which.max(votematrix[, x]) : subscript out of bounds","body":"<p>Having a classification problem, I am using SVM for prediction in R. In dataset, there are integer as well as categorical variables. I got error while predicting with predict method.  </p>\n\n<pre><code>    svp3c &lt;- ksvm(input_dataset3$isCRgt3~., data=input_dataset3,type=\"C-svc\")\n    p3&lt;-predict(svp3c,newdata=input_dataset_prediction[,-1],type=\"response\")\n\n    error :: Error in which.max(votematrix[, x]) : subscript out of bounds\n</code></pre>\n\n<p>For this modeling </p>\n\n<p>First : developed model with training dataset</p>\n\n<p>second : saved and Load model for prediction on testing dataset</p>\n\n<pre><code>Training Dataset sample\n\nHeadning :\nhead1(int),head2(character-url),head3(character-url),head4(character-url),head5(character),head6(character),haed7(int),head8(int),head9(int),head10(int),head11(int)\n\nData:    \n\"0\",\"10\",\"/\",\"/index.php?main_page=logoff\",\"(not set)\",\"rc317a\",\"organic\",\"0\",\"4\",\"20092\",\"5023\",\"0\"\n\"1\",\"11\",\"/\",\"/offwhite-churidar-kameez-set-p-17381.html\",\"(not set)\",\"rc317a\",\"organic\",\"0\",\"4\",\"20092\",\"5023\",\"0\"\n</code></pre>\n\n<p>[Download Sample Dataset] <a href=\"http://www.2shared.com/file/tQRapbBt/input_dataset3.html\" rel=\"nofollow\">http://www.2shared.com/file/tQRapbBt/input_dataset3.html</a></p>\n\n<p>[Reproduce R script] <a href=\"http://www.2shared.com/file/NpDs5V-9/data1_train.html\" rel=\"nofollow\">http://www.2shared.com/file/NpDs5V-9/data1_train.html</a></p>\n\n<p>Can any one give suggestion?</p>\n"},{"tags":["r","time-series","regression","linear-regression","polar-coordinates"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13106846,"title":"Appropriate ways to smooth a periodic time series?","body":"<p>I have a periodic time series, of air temperature over several years, and I want to be able to predict future values for it.</p>\n\n<p>I've calculated the average over the available years of the value at each hour of the year, which works ok, but it's clearly quite noisy, since I only have 4 years data.</p>\n\n<ul>\n<li>One way forward could be to do gaussian smoothing, but a better option might be to fit a spline to it.</li>\n<li>I searched and found <code>lm.circular</code>, which looks like a feasible solution candidate.<br>\n<ul>\n<li>It doesn't have any way of specifying a formula, so no way of asking it to fit a spline. </li>\n<li>I tried <code>lm.circular</code> using a 1-order polynomial, but a practical problem arose: it ran out of memory.  Note that a standard <code>lm</code> is almost instantaneous, and uses no noticeable memory, on the same data</li>\n<li>I also tried asking it to fit a Von Mises (type='c-l'), and it asked me for an 'init' parameter, and I couldn't really understand from the description what I was supposed to put into 'init'?</li>\n</ul></li>\n<li>Using the normal <code>lm</code> is not really an option, since it gives terrible results at either end of the period.</li>\n<li>I suppose another possibility is to use ets/HoltWinters, with a timeseries frequency equal to the number of hours in the year?</li>\n</ul>\n\n<p>I'm not quite sure which way is the best way forward, but I suspect that this is a pretty common problem, and there are probably very standard ways of dealing with it?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":55,"score":3,"question_id":13128557,"title":"How to put numbers between $$ in R?","body":"<p>I want to use <code>xtable</code> package for exporting R outputs to LaTex.</p>\n\n<p>Because I want to use a Persian font I should put the numbers between $$.\nHow can I do this in R?</p>\n\n<p>T tried <code>as.character</code>, but xtable doesn't work for it.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":985,"score":3,"question_id":7863906,"title":"Plot Regression Surface","body":"<p>I am reading a book by Cohen, Cohen, Aiken and West(2003) \"Applied Multiple Regression Correlation Analysis for the Behavioral Sciences\" and have come across a 3d plot of a Regression surface showing interaction and no interaction (p. 259).  The graphs look like they may have been created using R.  I like the graphs as a teaching tool and would like to reproduce them.  The plots look something like this:\n<img src=\"http://i.stack.imgur.com/FMz3p.gif\" alt=\"enter image description here\"></p>\n\n<p>The only addition to the Coehn et al. plots were lines across the planes at the mean, +1sd, and =1sd for x2.  This would be an excellent addition if possible (generally most things are possible with R)</p>\n\n<p>I have provided a sample data set below with an IV, 2 predictors and centered predictors.  How would I use R to generate the regression surface (plane) plot showing interaction and an additive model for both the centered and uncentered data (I assume the technique will be the same but want to make sure).  </p>\n\n<p>Total of 4 plots:\n1. uncentered no interaction\n2. uncentered interaction\n3. centered no interaction\n4. centered interaction</p>\n\n<pre><code>DF&lt;-structure(list(y = c(-1.22, -1.73, -2.64, -2.44, -1.11, 2.24, \n3.42, 0.67, 0.59, -0.61, -10.77, 0.93, -8.6, -6.99, -0.12, -2.29, \n-5.16, -3.35, -3.35, -2.51, 2.21, -1.18, -5.21, -7.74, -1.34), \n    x1 = c(39.5, 41, 34, 30.5, 31.5, 30, 41.5, 24, 43, 39, 25.5, \n    38.5, 33.5, 30, 41, 31, 25, 37, 37.5, 24.5, 38, 37, 41, 37, \n    36), x2 = c(61L, 53L, 53L, 44L, 49L, 44L, 57L, 47L, 54L, \n    48L, 46L, 59L, 46L, 61L, 55L, 57L, 59L, 59L, 55L, 50L, 62L, \n    55L, 55L, 52L, 55L), centered.x1 = c(5.49702380952381, 6.99702380952381, \n    -0.0029761904761898, -3.50297619047619, -2.50297619047619, \n    -4.00297619047619, 7.49702380952381, -10.0029761904762, 8.99702380952381, \n    4.99702380952381, -8.50297619047619, 4.49702380952381, -0.50297619047619, \n    -4.00297619047619, 6.99702380952381, -3.00297619047619, -9.00297619047619, \n    2.99702380952381, 3.49702380952381, -9.50297619047619, 3.99702380952381, \n    2.99702380952381, 6.99702380952381, 2.99702380952381, 1.99702380952381\n    ), centered.x2 = c(9.80357142857143, 1.80357142857143, 1.80357142857143, \n    -7.19642857142857, -2.19642857142857, -7.19642857142857, \n    5.80357142857143, -4.19642857142857, 2.80357142857143, -3.19642857142857, \n    -5.19642857142857, 7.80357142857143, -5.19642857142857, 9.80357142857143, \n    3.80357142857143, 5.80357142857143, 7.80357142857143, 7.80357142857143, \n    3.80357142857143, -1.19642857142857, 10.8035714285714, 3.80357142857143, \n    3.80357142857143, 0.803571428571431, 3.80357142857143)), .Names = c(\"y\", \n\"x1\", \"x2\", \"centered.x1\", \"centered.x2\"), row.names = c(NA, \n25L), class = \"data.frame\")\n</code></pre>\n\n<p>Thank you in advance.</p>\n\n<p>EDIT:  The following code plots the plane but will not work for when you have an interaction (which is really what I'm interested in).  Additionally, I don't know how to plot the high (+1sd), low(-1sd) and mean for x2 either.</p>\n\n<pre><code>x11(10,5)\n s3d &lt;- scatterplot3d(DF[,c(2,3,1)], type=\"n\", highlight.3d=TRUE,\n      angle=70, scale.y=1, pch=16, main=\"scatterplot3d\")\n\n   # Now adding a regression plane to the \"scatterplot3d\"\n    my.lm &lt;-  with(DF, lm(y ~ x1 + x2))\n s3d$plane3d(my.lm, lty.box = \"solid\")\n</code></pre>\n\n<p>An attempt to plot an interaction plane (Seen here):</p>\n\n<pre><code>s3d &lt;- scatterplot3d(DF[,c(2,3,1)], type=\"n\", highlight.3d=TRUE,\n      angle=70, scale.y=1, pch=16, main=\"scatterplot3d\")\n\n    my.lm &lt;-  with(DF, lm(y ~ x1 + x2 + x1:x2 ))\n s3d$plane3d(my.lm, lty.box = \"solid\")\n</code></pre>\n\n<p>Yielded the following error:</p>\n\n<pre><code>Error in segments(x, z1, x + y.max * yx.f, z2 + yz.f * y.max, lty = ltya,  : \n  cannot mix zero-length and non-zero-length coordinates\n</code></pre>\n"},{"tags":["r","gui","gwidgets"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13131687,"title":"gWidgets - adding event handlers in a loop","body":"<p>I am building a simple GUI to populate a small data frame (<code>mydf</code>) in R and I would like to create some of the repetitive widgets in a loop. Here's what I have so far:</p>\n\n<pre><code>mydf &lt;- data.frame(modnames = c('Mod1', 'Mod2', 'Mod3', 'Mod4', 'Mod5'), const1 = seq(1.5, 5.5, 1),const2 = seq(35, 55, 5))\n# Set up a window and add column labels\nwindow &lt;- gwindow ( \"My GUI\" , visible = T)\nnotebook &lt;- gnotebook ( cont = window )\nlyt &lt;- glayout ( cont = notebook , horizontal = T , label = \"Input\" )\nlyt[1, 1] &lt;- glabel(text = 'Enter Name')\nlyt[1, 2] &lt;- glabel(text = '1st Constraint')\nlyt[1, 3] &lt;- glabel(text = '2nd Constraint')\n# Use a loop to add spin buttons\nfor(i in 1:5){\n  # Names\n  lyt[i+1, 1] &lt;- gedit(text=mydf[i, 1], handler = function(h,...){\n    mydf[i,1] &lt;&lt;- svalue(h$obj)})\n  # 1st Constraint\n  lyt[i+1, 2] &lt;- gspinbutton(from=1, to=15, by=.5, value = mydf[i, 2], digits=0, handler=function(h,...){\n      mydf[i, 2] &lt;&lt;- svalue(h$obj)})\n  # 2nd Constraint\n  lyt[i+1, 3] &lt;- gspinbutton(from=10, to=100, by=5, value = mydf[i, 3], digits=0, handler=function(h,...){\n    mydf[i, 3] &lt;&lt;- svalue(h$obj)})\n}\n</code></pre>\n\n<p>This creates the widgets I want very nicely, but the handler functions are a little wonky. When I change the value in any of the created spin buttons, the value in the last row of the data frame changes. This comes from the <code>mydf[i, 3] &lt;&lt;- svalue(h$obj)</code> part of the handler function. I need a way to fix <code>i</code> inside the handler function and I can't figure it out. I'm sure this is kind of a rookie question, but any help would be appreciated.</p>\n"},{"tags":["r","margin","contingency"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13132186,"title":"How to add the total sums to the table and get proportion for each cell in R","body":"<p>I'm trying to get a proportion for each cell by dividing each row by the row sum, but R gives me an Error saying, </p>\n\n<blockquote>\n  <p>Error in data.table$Country : $ operator is invalid for atomic vectors</p>\n</blockquote>\n\n<p>How can I fix this? Also, how can add total sum values for the entire columns and rows to data.table? I get this values when I run <code>addmargins(data.table)</code>, but I'd like to attach the sums to my dataframe. </p>\n\n<hr>\n\n<p>Here's my code:</p>\n\n<pre><code>x = c(40,50,30,30,50)                \ny = c(40,20,30,40,45)                              \ndata.table = rbind(x,y)   \ndata.table\ndimnames(data.table)=list(\"Country\"=c(\"England\",\"Germany\"),\"Score\"=c(\"Q-Score\",\"T-score\",\"X-score\",\"Y-score\",\"Z-score\"))\naddmargins(data.table)\ntable(data.table$Country,data.table$Score/rowSums(table(data.table&amp;Country,data.table$Score)))\n</code></pre>\n"},{"tags":["r","cran","rapache","rserve","rapparmor"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13037082,"title":"R interactive and batch mode and the heIp browser","body":"<p>When running R in 'batch mode', the <code>interactive</code> flag is set to false, which prevents any sort of user prompts that would interrupt the process in the context of an embedded/batch setting. See:</p>\n\n<pre><code>R -e 'interactive()'\n</code></pre>\n\n<p>Some holds when using <code>Rscript</code>. The flag can also manually be set by using the <a href=\"http://cran.r-project.org/web/packages/interactivity/index.html\" rel=\"nofollow\">interactivity</a> package. To test, we can try:</p>\n\n<pre><code>R -e 'install.packages(\"anything\")\n</code></pre>\n\n<p>Assuming no CRAN mirror has been set yet, <code>install.packages</code> will not show some interactive mirror picker, but instead throw an error and exit.</p>\n\n<p>However, I noticed that the <code>help</code> or <code>?</code> command will still work. For example, the command below will show the help browser, and it does not continue until I press q. </p>\n\n<pre><code>R -e 'help(lm); 1+2'\n</code></pre>\n\n<p>However, when sending the output to a file, it does not show the interactive prompt and just dumps the complete help document in the output:</p>\n\n<pre><code>R -e 'help(lm); 1+2' &gt; output.txt\n</code></pre>\n\n<p>I'm a bit confused now about what is really going on when using <code>help</code>. Why do you get the interactive help browser even when R is running in batch mode? Is this a feature of <code>R</code>, or from the Debian/Ubuntu front-end? Is there a risk of <code>R</code> becoming unresponsive when the <code>help</code> function is called inside i.e. Rserve, RInside, JRI, etc, due to R waiting for using input?</p>\n"},{"tags":["r","table","contingency"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":13131743,"title":"how to make a contingency table in R","body":"<p>I'm trying to make a contingency table: </p>\n\n<pre><code>Area        School    Coffeshop    Hospitals    Parks    Totatl  \nWashington     142          120           20       20       302   \nSeattle        120          140           30       40       330 \nTotal          262          260           50       60       632\n</code></pre>\n\n<p>My code is this:</p>\n\n<pre><code>n&lt;-c(\"Area\",\"School\",\"Cofeeshop\",\"Hospitals\",\"Parks\",\"Total\") \nx&lt;-c(\"Washington\",142,120,20,20,302)\ny&lt;-c(\"Seattle\",120,140,30,40,330)\nz&lt;-c(\"Total\",262,260,50,60,631)\ndata&lt;-cbind(n,x,y,z)\ndata&lt;-data.frame(data)\n</code></pre>\n\n<p>I get an error message when I type in this code. Can someone please help me?<br/>\nThanks!! :-)</p>\n"},{"tags":["r","row"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":284,"score":2,"question_id":4272735,"title":"How do I perform a function on each row of a data frame and have just one element of the output inserted as a new column in that row","body":"<p>It is easy to do an Exact Binomial Test on two values but what happens if one wants to do the test on a whole bunch of number of successes and number of trials. I created a dataframe of test sensitivities, potential number of enrollees in a study and then for each row I calculate how may successes that would be. Here is the code.</p>\n\n<pre><code>sens &lt;-seq(from=.1, to=.5, by=0.05)\nenroll &lt;-seq(from=20, to=200, by=20)\ndf &lt;-expand.grid(sens=sens,enroll=enroll)\ndf &lt;-transform(df,succes=sens*enroll)\n</code></pre>\n\n<p>But now how do I use each row's combination of successes and number of trials to do the binomial test. </p>\n\n<p>I am only interested in the upper limit of the 95% confidence interval of the binomial test. I want that single number to be added to the data frame as a column called \"upper.limit\"</p>\n\n<p>I thought of something along the lines of </p>\n\n<pre><code>binom.test(succes,enroll)$conf.int    \n</code></pre>\n\n<p>alas, conf.int gives something such as</p>\n\n<p>[1] 0.1266556 0.2918427<br>\nattr(,\"conf.level\")<br>\n[1] 0.95  </p>\n\n<p>All I want is just 0.2918427</p>\n\n<p>Furthermore I have a feeling that there has to be do.call in there somewhere and maybe even an lapply but I do not know how that will go through the whole data frame. Or should I perhaps be using plyr?</p>\n\n<p>Clearly my head is spinning. Please make it stop.</p>\n"},{"tags":["r","data.table","knitr","gwidgets"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":72,"score":5,"question_id":13106018,"title":"data.table error when used through knitr, gWidgetsWWW","body":"<p>I'm experimenting with gWidgetsWWW and encountered a strange error. I created a button with a handler to knit2html a report which used the data.table assignment operator \":=\".  The report came back with this error: </p>\n\n<blockquote>\n  <p>Error: := is defined for use in j only, and (currently) only once; i.e.,\n  DT[i,col:=1L] and DT[,newcol:=sum(colB),by=colA] are ok, but not\n  DT[i,col]:=1L, not DT[i]$col:=1L and not DT[,{newcol1:=1L;newcol2:=2L}].\n  Please see help(\":=\"). Check is.data.table(DT) is TRUE.</p>\n</blockquote>\n\n<p>The report generates as expected using knit2html directly and also through RStudio's \"Knit HTML\" button, so I'm unsure why it fails when knit2html is called by the handler.</p>\n\n<p>Here is a gWidgetsWWW window \"test_gui.R\":</p>\n\n<pre><code>library(gWidgetsWWW)\nlibrary(knitr)\n\nw&lt;-gwindow(\"Test Window\")\ng&lt;-ggroup(horizontal=F,cont=w)\nb&lt;-gbutton(\"Report Button\",cont=g,handler=function(h,...){\n    knit2html(\"test_report.Rmd\")\n    localServerOpen(\"test_report.html\")\n})\n\nvisible(w)&lt;-T\n</code></pre>\n\n<p>Here is an example R Markdown Doc which produces the error:</p>\n\n<pre><code>Test Report\n===========\n\n```{r test_chunk}\nlibrary(data.table)\n\ndf&lt;-data.frame(State=rownames(USArrests),USArrests)\n\ndata.table(df)[,State:=tolower(State)]\n\n```\n</code></pre>\n\n<p>Not sure why, but when I call localServerOpen(\"test_gui.R\") and click the button, I get the error...</p>\n\n<p>Any ideas?</p>\n"},{"tags":["r","plot","histogram"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":48,"score":-2,"question_id":13131411,"title":"how are the intervals of histogram plot identified","body":"<p>I was trying out a simple histogram</p>\n\n<pre><code>hist(c(-2,-1,0,1,2))\n</code></pre>\n\n<p>the histogram has frequency equal to 2 for -2 to -1 for the above code.</p>\n\n<p>I am not quite getting how R places the values inside the interval in the plot that it gives. I mean, here shouldn't the frequency (y axis) be equal to 1 all the time, since there are no repetitions?</p>\n\n<p>Also, I didn't quite get how the range works, is it upper bound inclusive / lower bound inclusive or..?? [,) or (,] or [,] or (,) ..?</p>\n"},{"tags":["r","function","for-loop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13131207,"title":"Using for loop to output equations in R","body":"<p>I currently have a series of equations that I'm using to model compartments of a biological system. I want to be able to set a variable, n, outside of the for-loop for the number of compartments I want the model to have, then have the function output that many dn.dt's. I'm pretty sure I have to return them as a vector at the end of the function, but that's the only lead I have. Below is what I want my basic function to be for when n = 3. </p>\n\n<pre><code>rate &lt;- function(time, state, parms){\n  with(as.list(c(state,parms)),{\n    dX.dt &lt;- do stuff\n    d1.dt &lt;- do different stuff \n    d2.dt &lt;- do same stuff as d1.dt\n    d3.dt &lt;- do same stuff as d1.dt\n    return(list(c(dX.dt, d1.dt, d2.dt, d3.dt)))})}\n</code></pre>\n\n<p>How would I go about doing this?</p>\n"},{"tags":["r","permutation","data.table"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13130399,"title":"R change order of column values in a data.table according to a permutation","body":"<p>I have a data.table with a class column and a number of value columns, e.g.</p>\n\n<pre><code>     class  v1  v2  v3\n1:       1  10   3   8\n2:       2   2  24   7\n3:       1  70   3   9\n</code></pre>\n\n<p>Now, <strong>for a subset</strong> of data.table (say class=1), I need to change the order of values in each \nrow according to a permutation that I have. For instance, if the permutation is</p>\n\n<pre><code>3   1   2\n</code></pre>\n\n<p>The result should look like</p>\n\n<pre><code>     class  v1  v2  v3\n1:       1   8  10   3\n2:       2   2  24   7\n3:       1   9  70   3\n</code></pre>\n\n<p>What's the best way to achieve this using data.table? </p>\n\n<p>I can alternatively convert my data to matrix, if that's more efficient. Thanks!</p>\n"},{"tags":["r","csv"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13130818,"title":"Why is this not being read as numeric when I specify it?","body":"<p>I've narrowed it down to a very small example so I'm sure it's something very silly.</p>\n\n<p>I have the file <code>test.delete</code> with these contents:</p>\n\n<pre><code>Rock,bird\n1350909372121900000,55.20000\n1350909372318100000,55.30000\n1350909382020900000,55.20000\n1350909382029600000,55.20000\n1350909384311100000,55.20000\n</code></pre>\n\n<p>and then I do:</p>\n\n<pre><code>test = read.csv('test.delete', colClasses=c('character','numeric'))\n</code></pre>\n\n<p>but all columns seem to be read in as character:</p>\n\n<pre><code>&gt; apply(test, 2, class)\n       Rock        bird\n\"character\" \"character\"\n</code></pre>\n\n<p>Why is this?</p>\n"},{"tags":["r","packages"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13130838,"title":"Using rGtrends Returns error","body":"<p>I'm having some trouble using an API written to make Gtrends usable from within R. The package isn't available on the CRAN mirror sites, but is available on the creator's Github page:</p>\n\n<p><a href=\"https://github.com/emhart/rGtrends\" rel=\"nofollow\">https://github.com/emhart/rGtrends</a></p>\n\n<p>This is my first time using a package that I didn't get from the normal package downloader GUI in R, so here's what I did:</p>\n\n<ol>\n<li>Installed the <code>devtools</code> package.</li>\n<li><p>Used this to install the rGtrends package: </p>\n\n<pre><code>dev_mode()\ninstall_github(\"rGtrends\",\"emhart\")\n</code></pre></li>\n<li><p>Try to use it:</p>\n\n<pre><code>library(rGtrends)\nrGtrends(c(\"Stack Overflow\", \"Github\"))\n</code></pre></li>\n</ol>\n\n<p>And it returns the error:</p>\n\n<pre><code>Error in .jcall(\"RJavaTools\", \"Ljava/lang/Object;\", \"invokeMethod\", cl,  : \n  Traceback (most recent call last):\n  File \"&lt;string&gt;\", line 1, in &lt;module&gt;\n  File \"C:/Documents/R-dev/rGtrends/src/pyGTrends.py\", line 105, in csv\n    raise Exception(\"Could not find requested section\")\nException: Could not find requested section\n</code></pre>\n"},{"tags":["r","formatting"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":61,"score":4,"question_id":12941677,"title":"Merging two data frames","body":"<p>I have the following data frame:</p>\n\n<pre><code>Date,Year,Austria,Germany,...\n1969-12-31,1969,96.743,95.768,...\n1970-01-30,1970,95.515,95.091,...\n1970-02-27,1970,95.075,95.235,...\n</code></pre>\n\n<p>Ultimately, I would like to merge this data frame with another one that looks like this:</p>\n\n<pre><code>Year,Country,Exp,...\n1969,Austria,1,...\n1970,Austria,0,...\n1969,Germany,0,...\n1970,Germany,1,...\n</code></pre>\n\n<p>The way I see it, I would have to change the first data frame to the following format:</p>\n\n<pre><code>Date,Year,Country,Exp,…\n1969-12-31,1969,Austria,96.743,...\n1970-01-30,1970,Austria,95.515,...\n1970-02-27,1970,Austria,95.075,...\n1969-12-31,1969,Germany,95.768,...\n1970-01-30,1970,Germany,95.091,...\n1970-02-27,1970,Germany,95.235,...\n</code></pre>\n\n<p>Then, I can just use the merge function and merge them (one-to-many) using Year and Country.</p>\n\n<p>I have tried to transform the data frame as suggest above. However, the only way I can think of is to use a couple of complicated \"for\" loops. It would be greatly appreciated if someone had an easier approach. Also, if you think that merging those two data frames can be done in an easier fashion that would be great too.</p>\n"},{"tags":["r","minimize","solver"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":363,"score":0,"question_id":3496882,"title":"solve.QP require D to be symmetric positive definite in R","body":"<p>When I run solve.QP on my problem, I get the following error from R:</p>\n\n<pre><code>Error in solve.QP(sigma, rep(0, 5), t(Amat), bvec, meq = 2) : \n  matrix D in quadratic function is not positive definite!\n</code></pre>\n\n<p>My sigma matrix is symmetric but is not positive definite. Why is this needed? If I solve it myself using Lagrangian functions, I am able to get the solution. Then why is R imposing this requirement?</p>\n"},{"tags":["r","maps"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13129134,"title":"R equivalent of \"hold on\" for plotting maps","body":"<p>I want to add different colors to different states in the US. \nHowever when I run all my <code>map(\"state\",.\"insert coloring condition\"...)</code> commands sequentially, I don't get an overlay plot, it just updates the map but does not keep the coloring (as expected). When plotting graps you have acces to <code>lines()</code> and <code>points()</code> but it doesn't work with maps.. \nSo how do I do that?</p>\n"},{"tags":["r","data","machine-learning"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":80,"score":-1,"question_id":12978107,"title":"visualization approach for showing the differences between two vectors","body":"<p>I have two vectors, and want to compare their differences. Besides exactly compute their differences element-by-element, are there any visual approaches to show their differences in a graphical way?</p>\n"},{"tags":["r","github","oauth-2.0","opencpu","opencpu.org"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":17,"score":0,"question_id":13128375,"title":"opencpu server, how to implement OAuth2 interface?","body":"<p>I have installed an OpenCPU server and am trying to let users create their own logins but I  keep on getting the following error message:</p>\n\n<pre><code>GET /auth/login\nGithub secret file not found.\n</code></pre>\n\n<p>Any ideas as to what i'm doing wrong?</p>\n"},{"tags":["r","unique","data.frame"],"answer_count":2,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":59,"score":8,"question_id":13129642,"title":"unique / sort in data.frame","body":"<p>I have a data frame like this:</p>\n\n<pre><code>x=c(\"01\",\"01\",\"01\",\"22\",\"22\",\"03\",\"03\",\"03\",\"35\",\"35\")\ny=c(\"f\",\"f\",\"f\",\"m\",\"m\",\"m\",\"m\",\"m\",\"f\",\"f\")\ndf=data.frame(spn=x, sex=y)\n</code></pre>\n\n<p>seems like:</p>\n\n<pre><code>   spn sex\n1   01   f\n2   01   f\n3   01   f\n4   22   m\n5   22   m\n6   03   m\n7   03   m\n8   03   m\n9   35   f\n10  35   f\n</code></pre>\n\n<p>What I'd like to do is to sort the df$spn and let it appears only once. the appropriate df$sex as well, like:</p>\n\n<pre><code>   spn sex\n1  01   f\n2  03   m\n3  22   m\n4  35   f\n</code></pre>\n\n<p>How could I do that? many many thanks!</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13129243,"title":"intToBin with large numbers","body":"<p>I'm using the intToBin() function from \"R.utils\" package and am having trouble using it to convert large decimal numbers to binary. </p>\n\n<p>I get this error : NAs introduced by coercion.</p>\n\n<p>Is there another function out there that can handle big numbers/ is there an algorithm/ code to implement such a function?</p>\n\n<p>Thanks</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":36,"score":4,"question_id":13128928,"title":"Can I have R vignette with a pre-compiled PDF with manual index.html show up the vignette list?","body":"<p>I want to include a pre-compiled PDF as a vignette in a R package. The PDF is not generated via Sweave. Without a .Rnw to process, there is no <code>\\VignetteIndexEntry</code> to cause the usual automatic generation of index.html and <code>Meta/vignette.rds</code>. </p>\n\n<p>I created an index.html in <code>inst/doc</code> that is copied into <code>doc</code> during installation. This is corrected linked from the main package help page. However, when I load the package and execute <code>browseVignettes(\"MyPackage\")</code>, I get</p>\n\n<pre><code>No vignettes found by browseVignettes(\"MyPackage\")\n</code></pre>\n\n<p>This makes sense, because R apparently has no way to know that the package has a vignette. The installed package has no <code>Meta/vignette.rds</code> file. Can I somehow get my PDF to appear with <code>browseVignettes()</code>?</p>\n\n<h2><code>pdfpages</code></h2>\n\n<p>I'm familiar with the <a href=\"https://github.com/rpruim/mosaic/blob/master/inst/doc/MinimalR.Rnw\" rel=\"nofollow\">approach taken by the mosaic package</a>, which is to use <code>pdfpages</code> to include the entire PDF. While clever, I feel like there should be a better way that avoids the proliferation of files.</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13127195,"title":"Re-ordering by multi-dimensional data for ggplot2 plotting","body":"<p>I'm having some trouble producing what I think should be a fairly straightforward ggplot2 graph.</p>\n\n<p>I have some experimental data in a data frame.  Each data entry is identified by the system that was being measured, and the instance (problem) it was run on.  Each entry also has a value measured for the particular system and instance.</p>\n\n<p>For instance:</p>\n\n<pre><code>mydata &lt;- data.frame(System=c(\"a\",\"b\",\"a\",\"b\",\"a\",\"b\"), Instance=factor(c(1,1,2,2,3,3)), Value=c(10,5,4,2,7,8))\n</code></pre>\n\n<p>Now, I'd like to plot this data in a boxplot where the x-axis contains the instance identifier, and the color of the bar indicates which system the value is for.  The bar heights should be weighted by the value in the dataframe.</p>\n\n<p>This almost does what I want:</p>\n\n<pre><code>qplot(data=mydata, weight=Value, Instance, fill=System, position=\"dodge\")\n</code></pre>\n\n<p>The final thing that I would like to do is reorder the bars so they are sorted by the value of system A.  However, I can't figure out an elegant way to do this.</p>\n\n<p>My first instinct was to use <code>qplot(data=mydata, weight=Value, reorder(Instance, Value), fill=System, position=\"dodge\")</code>, but this will order by the <code>mean</code> value for each instance, and I just want to use the value from A.  I could use <code>qplot(data=mydata, weight=Value, reorder(Instance, Value, function(x) { x[1] } ), fill=System, position=\"dodge\")</code> to order the instances by \"the first value\", but this is dangerous (what if the order changes?) and unclear to a reader.</p>\n\n<p>What is a more elegant solution?</p>\n"},{"tags":["r","time-series","xts","zoo"],"answer_count":5,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":2486,"score":4,"question_id":3558988,"title":"Basic lag in R vector/dataframe","body":"<p>Will most likely expose that I am new to R, but in SPSS, running lags is very easy.  Obviously this is user error, but what I am missing?</p>\n\n<pre><code>x &lt;- sample(c(1:9), 10, replace = T)\ny &lt;- lag(x, 1)\nds &lt;- cbind(x, y)\nds\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code>      x y\n [1,] 4 4\n [2,] 6 6\n [3,] 3 3\n [4,] 4 4\n [5,] 3 3\n [6,] 5 5\n [7,] 8 8\n [8,] 9 9\n [9,] 3 3\n[10,] 7 7\n</code></pre>\n\n<p>I figured I would see:</p>\n\n<pre><code>     x y\n [1,] 4 \n [2,] 6 4\n [3,] 3 6\n [4,] 4 3\n [5,] 3 4\n [6,] 5 3\n [7,] 8 5\n [8,] 9 8\n [9,] 3 9\n[10,] 7 3\n</code></pre>\n\n<p>Any guidance will be much appreciated.</p>\n"},{"tags":["r","multicore"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":102,"score":4,"question_id":13126990,"title":"Why is R multicore only using one core?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12924698/parallel-processing-in-r-limited\">Parallel processing in R limited</a>  </p>\n</blockquote>\n\n\n\n<p>I've written some code in R multicore, and I'm running it on a 24-core machine.  In fact there are only 12 cores, but they are hyperthreaded, so it looks like there are 24.</p>\n\n<p>Here's what's strange: all the threads run on the same single core!  So they each only use a tiny amount of cpu, instead of each running on a single core, and chewing up all available cores.</p>\n\n<p>For simplicity, I'm just running 4 threads:</p>\n\n<pre><code>mclapply( 1:30, function(size) {\n    # time consuming stuff that is cpu bound (think \"forecast.ets\" et al)\n}, mc.cores = 4, mc.preschedule = F )\n</code></pre>\n\n<p>Prior to running this, there is already an R process running on one core, using 100% of that core's capacity:</p>\n\n<p><img src=\"http://i.stack.imgur.com/Ro14R.png\" alt=\"enter image description here\"></p>\n\n<p>Next, I launch the \"multicore process\", and 4 extra threads fight for the same core!:</p>\n\n<p><img src=\"http://i.stack.imgur.com/6OGAu.png\" alt=\"enter image description here\"></p>\n\n<p>... so, they each get 12%  of one core, or about 1% of the available processing power, when they should each be able to get 100% of one core.  Also, the other R process now only get 50% of the core.</p>\n\n<p>OS is Ubuntu 12.04 64-bit.  Hardware is Intel.  R is version 2.15.2 \"trick or treat\"</p>\n\n<p>Thoughts?  (I know I could just use snowfall, but I have a ton of variables, and I really don't want to have to <code>sfExport</code> all of them!)</p>\n\n<p>Edit: oh, I guess there's some global lock somewhere?  But still, why would there be a conflict between two completely separate R processes?  I can run two R processes in parallel just fine, with each taking 100% of a core's CPU.</p>\n\n<p>Edit2: Thanks to Dirk's pointer, I rebuilt openblas, and it's looking much healthier now!:</p>\n\n<p><img src=\"http://i.stack.imgur.com/GSt7H.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","unit-testing","autotest","s4","testthat"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":28,"score":3,"question_id":13128061,"title":"testthat::auto_test() seems to fail when S4 code is involved","body":"<p>Over the last couple of weeks, I've been integrating the unit-test functionality of the <a href=\"http://cran.r-project.org/web/packages/testthat/index.html\" rel=\"nofollow\">testthat</a> package more and more into my daily work and really have to say: this package rocks! </p>\n\n<p>I specifically like the autotest-feature which will automatically run all of your unit tests <strong>every time</strong> you make a change somewhere in your code. However, I think I came across a little bug or at least some undesired behavior when using <a href=\"http://cran.r-project.org/web/packages/testthat/index.html\" rel=\"nofollow\">testthat</a>'s <code>auto_test()</code> function in situations when your code directory contains S4 definitions (classes, generic methods, custom methods).</p>\n\n<h2>Question</h2>\n\n<p>Is this behavior illustrated below a bug or am I doing something wrong when using <code>auto_test()</code>?</p>\n\n<p>Below you'll find an illustration that requires to create some example files first</p>\n\n<h2>Preliminaries</h2>\n\n<p>Set working directory</p>\n\n<pre><code>setwd(\"testthat_autotest\")\n</code></pre>\n\n<p>Ensure directories</p>\n\n<pre><code>dir.create(\"src\", showWarnings=FALSE)\ndir.create(\"tests\", showWarnings=FALSE)\n</code></pre>\n\n<h2>Create S4 Reference Class Definition</h2>\n\n<p>Creates file <code>classes.R</code> in directory <code>src</code></p>\n\n<pre><code>def &lt;- c(\n    \"setRefClass(\",\n    \"   Class=\\\"MyClass\\\",\",\n    \"   fields=list(\",\n    \"       name=\\\"character\\\"\",\n    \"   ),\",\n    \"   methods=list(\",\n    \"       getName=function(...) {\",\n    \"           getName_ref(.self=.self, ...)\",\n    \"       },\",\n    \"       setName=function(...) {\",\n    \"           setName_ref(.self=.self, ...)\",\n    \"       }\",\n    \"   )\",\n    \")\"\n)\nwrite(def, file=\"src/classes.R\")\n</code></pre>\n\n<h2>Create Generic Method Definitions</h2>\n\n<p>Creates file <code>generics.R</code> in directory <code>src</code></p>\n\n<pre><code>def &lt;- c(\n    \"setGeneric(\",\n    \"    name=\\\"getName_ref\\\",\",\n    \"    signature=c(\\\".self\\\"),\",\n    \"    def=function(\",\n    \"        .self,\",\n    \"        ...\",\n    \"    ) {\",\n    \"standardGeneric(\\\"getName_ref\\\")\",    \n    \"   }\",\n    \")\",\n    \"\",\n    \"setGeneric(\",\n    \"   name=\\\"setName_ref\\\",\",\n    \"   signature=c(\\\".self\\\"),\",\n    \"   def=function(\",\n    \"       .self,\",\n    \"       value,\",\n    \"       ...\",\n    \"   ) {\",\n    \"   standardGeneric(\\\"setName_ref\\\")\",    \n    \"   }\",\n    \")\"\n)\nwrite(def, file=\"src/generics.R\")\n</code></pre>\n\n<h2>Create Custom Method Definitions</h2>\n\n<p>Creates file <code>methods.R</code> in directory <code>src</code></p>\n\n<pre><code>def &lt;- c(\n    \"require(\\\"compiler\\\")\",\n    \"\",\n    \"setMethod(\",\n    \"   f=\\\"getName_ref\\\",\", \n    \"   signature=signature(.self=\\\"MyClass\\\"),\", \n    \"   definition=cmpfun(function(\",\n    \"       .self,\",\n    \"       ...\",\n        \") {\",\n        \"out &lt;- .self$name\",\n        \"return(out)\",\n        \"}, options=list(suppressAll=TRUE))\",  \n    \")\",\n    \"setMethod(\",\n    \"   f=\\\"setName_ref\\\",\", \n    \"   signature=signature(.self=\\\"MyClass\\\"),\", \n    \"   definition=cmpfun(function(\",\n    \"       .self,\",\n    \"       ...\",\n    \"   ) {\",\n    \"   .self$field(name=\\\"name\\\", value=value)\",\n    \"   return(TRUE)\",\n    \"   }, options=list(suppressAll=TRUE))\",  \n    \")\"\n)\nwrite(def, file=\"src/methods.R\")\n</code></pre>\n\n<h2>Create Unit Tests</h2>\n\n<p>Creates files <code>test_getName_ref.R</code> and <code>test_setName_ref.R</code> in directory <code>tests</code></p>\n\n<pre><code>test &lt;- c(\n    \"require(\\\"testthat\\\")\",\n    \"\",\n    \"test_that(desc=\\\"test_getName_ref,.self=MyClass\\\",\",\n    \"   code={\",\n    \"       x.target &lt;- \\\"some value\\\"\",\n    \"       expect_that(\",\n    \"            .self &lt;- new(\\\"MyClass\\\", name=x.target),\",\n    \"            is_a(\\\"MyClass\\\")\",\n    \"        )\",\n    \"        expect_that(\",\n    \"            x.test &lt;- .self$getName(),\",\n    \"            is_a(\\\"character\\\")\",\n    \"        )\",\n    \"        expect_that(\",\n    \"            x.test,\",\n    \"            is_identical_to(x.target)\",\n    \"        )\",\n    \"    }\",\n    \")\"\n)\nwrite(test, file=\"tests/test_getName_ref.R\")\n\ntest &lt;- c(\n    \"require(\\\"testthat\\\")\",\n    \"\",\n    \"test_that(desc=\\\"test_setName_ref,.self=MyClass\\\",\",\n    \"   code={\",\n    \"       x.target &lt;- \\\"some value\\\"\",\n    \"       expect_that(\",\n    \"            .self &lt;- new(\\\"MyClass\\\"),\",\n    \"            is_a(\\\"MyClass\\\")\",\n    \"        )\",\n    \"        expect_that(\",\n    \"            .self$setName(value=x.target),\",\n    \"            is_identical_to(TRUE)\",\n    \"        )\",\n    \"        expect_that(\",\n    \"            .self$getName(),\",\n    \"            is_identical_to(x.target)\",\n    \"        )\",\n    \"    }\",\n    \")\"\n)\nwrite(test, file=\"tests/test_setName_ref.R\")\n</code></pre>\n\n<h2>Illustration</h2>\n\n<p>Running <code>auto_test()</code> will result in errors:</p>\n\n<pre><code>require(\"testthat\")\n\nauto_test(\n    code_path=\"src\",\n    test_path=\"tests\"\n)\nLoading required package: compiler\n.1.2\n\n1. Error: test_getName_ref,.self=MyClass ---------------------------------------\ncould not find function \"getName_ref\"\n1: expect_that(x.test &lt;- .self$getName(), is_a(\"character\"))\n2: condition(object)\n3: str_c(class(x), collapse = \", \")\n4: Filter(function(x) length(x) &gt; 0, list(...))\n5: sapply(x, f)\n6: lapply(X = X, FUN = FUN, ...)\n7: .self$getName()\n\n2. Error: test_setName_ref,.self=MyClass ---------------------------------------\ncould not find function \"setName_ref\"\n1: expect_that(.self$setName(value = x.target), is_identical_to(TRUE))\n2: condition(object)\n3: all.equal(expected, actual)\n4: all.equal.default(expected, actual)\n5: all.equal.raw(target, current, ...)\n6: attr.all.equal(target, current, ...)\n7: mode(current)\n8: .self$setName(value = x.target)\n</code></pre>\n\n<p>My first guess is that it might have something to do with the the way <code>testthat::source_dir()</code> handles the sourcing, maybe due to argument <code>env</code>?</p>\n\n<p>In order to continue, we need to turn off autotesting with CRTL + BREAK (on Windows; see <a href=\"http://journal.r-project.org/archive/2011-1/RJournal_2011-1_Wickham.pdf\" rel=\"nofollow\">section \"Autotest\" in this article</a> if you're on other platforms)</p>\n\n<p>Now, when we first source the code manually and run <code>test_dir()</code>, everything seems to work fine:</p>\n\n<pre><code>require(\"testthat\")\n\nsapply(list.files(\"src\", full.names=TRUE), source)\n\ntest_dir(\"tests\")\n\n......\nYou are a coding rockstar! \n&gt; \n</code></pre>\n"},{"tags":["r","map","pie-chart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13122273,"title":"How to add pie charts to a geographical map with r","body":"<p>After struggling with some maps I came to the point where I don't know any further. I want to add pie charts to a geographical map.</p>\n\n<p>Here is my data:</p>\n\n<pre><code>    zip city      state  latitude   longitude   plan_chosen\n  10001 New York    NY  40.75074    -73.99653   3\n  10001 New York    NY  40.75074    -73.99653   1\n  10001 New York    NY  40.75074    -73.99653   1\n  10017 New York    NY  40.75216    -73.97231   3\n</code></pre>\n\n<p>This is also for other locations.What I want to do is define a pie chart of plan_chosen. This consists of numbers 1 to 4, and I want to put this pie chart on the map of the states of course in the NY area and some other selected areas. \nI couldn't really find a tutorial on how to do this and I don't know which package to use best. Just for mapping I've been using the package maps</p>\n\n<p>I use this code to define the map</p>\n\n<pre><code>map('state', fill=FALSE, col=\"#cccccc\")\n</code></pre>\n\n<p>on this I want to add 3 to 4 pie charts. Do I have to modify the data any further or which package is useful?</p>\n\n<p>I've been trying the package rworldmap and this code</p>\n\n<pre><code>    mapPies( tel,nameX=\"longitude\", nameY=\"latitude\" , nameZs=plan_chosen,mapRegion='america' , add=TRUE)\n</code></pre>\n\n<p>but here my problem is it doesn't devide th pie in 4 parts it just colors it all black. Any suggestions or help?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c++","r","package","rcpp","rinside"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13126168,"title":"Rpp, Rinside support for R packages?","body":"<p>Does anyone have decent insight on certain R packages that can work with RInside out of box? I am looking for hopeful support with the R packages of:\nquantstrat,\nquantmod,\nPerformanceAnalytics,\nand TTR\nIn other words, can I call R functions directly within these R packages listed from my C++ if I used RInside. If not, do I have  extra coding or tweaking on the packages or my own R/C++ code to properly implement? \nBig thanks </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13084712,"title":"R: How to create an array of character arrays","body":"<p>I am fairly new to R and I have to following situation. I got a text file with contents like this:</p>\n\n<pre><code>[1] a b c d e f g\n[2] h i j k\n[3] l m n o\n[4] x y z\n</code></pre>\n\n<p>I want to group all characters, belonging to the same identifier ([x]) into an array. Since i want to access all characters of all identifiers, i will need to have a 2-dimensional array (an array of an array).\nThis is what i tried:</p>\n\n<pre><code>&gt; bigvector &lt;- vector()\n&gt; bigvector &lt;- append(bigvector, vector())\n&gt; bigvector[0][0] &lt;- \"Test\"\n&gt; &gt; bigvector[0][0]\nlogical(0)\n</code></pre>\n\n<p>So, no \"Test\" is returned. I also tried:</p>\n\n<pre><code>&gt; tmpvector &lt;- c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\")\n&gt; bigvector &lt;- vector()\n&gt; bigvector &lt;- append(bigvector, tmpvector)\n&gt; bigvector[0][0]\ncharacter(0)\n</code></pre>\n\n<p>This should be an easy task, however I am struggling to accomplish it.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13121443,"title":"Replacing the whole village name?","body":"<p>Im  trying to replace villages names in my big data frame (all_health) using gsub, sub and others ,but I keep getting some villages not correctly changed.\nfor example, \nI wanted first to standardise the spelling of all villages (vlg) in the data.\ne.g.:</p>\n\n<pre><code>all_health$vlg&lt;-gsub(\"FALAJALQBA\",\"FALAJALQABAIL\",all_health$vlg)\nall_health$vlg&lt;-gsub(\"FALAJALQ\",\"FALAJALQABAIL\",all_health$vlg)\nall_health$vlg&lt;-gsub(\"FALAJALQBA\",\"FALAJALQABAIL\",all_health$vlg)\nall_health$vlg&lt;-gsub(\"FALAJALQA\",\"FALAJALQABAIL\",all_health$vlg)\nall_health$vlg&lt;-gsub(\"FALAJALQBAEIL\",\"FALAJALQABAIL\",all_health$vlg)\nall_health$vlg&lt;-gsub(\"FALAJALQBAIL\",\"FALAJALQABAIL\",all_health$vlg)\nall_health$vlg&lt;-gsub(\"FALAJALQUBAIL\",\"FALAJALQABAIL\",all_health$vlg)\n</code></pre>\n\n<p>then I wanted to change the resulting village names to another name:</p>\n\n<pre><code> all_health$vlg&lt;-gsub(\"FALAJALQABAIL\",\"ALKHUWAYRIYAH\",all_health$vlg)\n</code></pre>\n\n<p>however, when I re-chaecked the names of the villages I noticed new different (missed up) villages such as (ALKHUWAYRIYAHBAILUBAIL) , which looks like a combination of the villages..</p>\n\n<p>I have many other villages behaved just the same.</p>\n\n<p>Am I using the correct function?\nwould anybody please help me?   </p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13125846,"title":"split dataframe in R by row","body":"<p>I have a long dataframe like this:</p>\n\n<pre><code>  Row  Conc   group\n  1     2.5    A\n  2     3.0    A\n  3     4.6    B\n  4     5.0    B\n  5     3.2    C\n  6     4.2    C\n  7     5.3    D\n  8     3.4    D\n</code></pre>\n\n<p>...</p>\n\n<p>The actual data have hundreds of row.  I would like to split A to C, and D. I looked up the web and found several solutions but not applicable to my case.</p>\n\n<p><a href=\"http://stackoverflow.com/questions/3302356/r-language-how-to-split-a-data-frame\">R language: how to split a data frame</a></p>\n\n<p>For example:\n     Case 1: </p>\n\n<pre><code>x = data.frame(num = 1:26, let = letters, LET = LETTERS)\nset.seed(10)\nsplit(x, sample(rep(1:2, 13)))\n</code></pre>\n\n<p>I don't want to split by arbitrary number</p>\n\n<p>Case 2: Split by level/factor</p>\n\n<pre><code>data2 &lt;- data[data$sum_points == 2500, ]\n</code></pre>\n\n<p>I don't want to split by a single factor either.  Sometimes I want to combine many levels together.</p>\n\n<p>Case 3: select by row number</p>\n\n<pre><code>newdf &lt;- mydf[1:3,]\n</code></pre>\n\n<p>The actual data have hundreds of rows. I don't know the row number.  I just know the level I would like to split at.</p>\n\n<p>Any help is greatly appreciated!</p>\n"},{"tags":["r","optimization","quadratic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13125957,"title":"solve.QP cannot maximize a positive definite quadratic function","body":"<p>I have an extremely simple quadratic problem that should in principle be solvable by solve.QP (quadprog): </p>\n\n<p><code>max x^2+3*y^2 subject to x&gt;=0, y&gt;=0, x+y &lt;=1</code> </p>\n\n<p>The problem is that turning the maximization into the required minimization, the matrix (obviously) becomes negative definite. It's not a problem related to small eigenvalues or roundoff.</p>\n\n<p>I thought that solve.QP was a general solver, but despite my efforts in reading online material, it looks as if you cannot maximize a positive definite quadratic form over a compact domain (defined by linear constraints) using solve.QP. </p>\n\n<p>Is that true? </p>\n\n<p>I know that I can solve this and similar problems with other functions (<code>constrOptim</code> works fine), but I would have loved to have Lagrange multipliers attached to the maximizer.</p>\n\n<p>Can you suggest any way to solve the above problem with (the very efficient) solve.QP, overcoming its asymmetric limitation related to positive definitness?</p>\n"},{"tags":["r","list","vector","match"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13120441,"title":"match() to list of vectors - of possibly different lengths","body":"<p>The <code>match(x, y)</code> function is perfect to search the elements of the vector <code>x</code> within the elements of vector <code>y</code>. But what is an efficient and easy way to do the similar job when <code>y</code> is a list of vectors - of possibly different lengths? </p>\n\n<p>I mean the result should be a vector of the same length as <code>x</code>, and the i-th element should be the first member of <code>y</code> that contains the i-th element of <code>x</code>, or <code>NA</code>.</p>\n"},{"tags":["r","boxplot"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13124827,"title":"multiple boxplots grouped by two conditions","body":"<p>I am having real trouble in making mutliple boxplots in single plot...\nI have five variables three are numeric and two are Factor. I want boxplot for all three numerical variables but grouped by the two Factor variable... The plot shoud have two groups each for Low and High with three boxes for MM, ND and BB. legends should contain the abbrevations for MM, ND and BB.</p>\n\n<pre><code>Group   Class   Sal Wal Daa\nMM  Low 21  34  4\nND  Low 23  65  3\nBB  High    21  34  2\nMM  High    25  23  4\nMM  High    23  23  5\nMM  High    13  54  6\nMM  High    56  32  4\nMM  Low 34  13  3\nND  Low 12  35  7\nND  Low 34  34  2\nND  Low 54  54  1\nND  High    32  34  6\nND  High    43  32  7\nBB  Low 54  13  3\nBB  Low 12  56  2\nBB  Low 45  34  6\nBB  High    32  32  3\nBB  High    13  12  2\nBB  High    54  12  5\n</code></pre>\n"},{"tags":["r","colors","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13123679,"title":"change textposition of colourbar in scale_color_discrete","body":"<p>I generate the legend in my ggplot2 plot with</p>\n\n<pre><code>scale_colour_discrete(name=textCF)\n</code></pre>\n\n<p>I like that i can see which colour belongs to which value, but it consumes to much space in the plot. </p>\n\n<p><img src=\"http://i.stack.imgur.com/wLjuA.png\" alt=\"legend does not fit\"></p>\n\n<p>I tried also the <code>scale_colour_gradientn</code> scheme, but this is so condensed, that i can not distiguish the values anymore. If i could only change the width of this colourbar.</p>\n\n<pre><code>scale_colour_gradientn(name=textCF,colours = rainbow(nrow(mydf), start=2/6), breaks=round(mydf$CF)) +\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/sUBXf.png\" alt=\"ticks are to close\"></p>\n\n<p>How can I improve the lookout?</p>\n"},{"tags":["r","plot","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13123869,"title":"Looping with qplot / ggplot2","body":"<p>I want to plot a bunch of variables against each other by using a loop and <code>par(ask=T)</code> to just update the plot after each mouse click.  </p>\n\n<p>The following code works fine using the <code>plot()</code> function:</p>\n\n<pre><code>require(ggplot2)\ndf1 &lt;- data.frame(id=seq(1,10,1)\n    ,col1 = runif(10)\n    ,col2 = runif(10)\n    ,col3 = runif(10)\n    ,col4 = runif(10)\n    ,col5 = runif(10)\n    ,col6 = runif(10)\n    ,col7 = runif(10)\n    ,col8 = runif(10)\n    ,col9 = runif(10)\n    ,col10 = runif(10)\n    )\n\npar(ask=TRUE)\nfor(i in 2:9){\ncolName2 &lt;- paste(\"col\",i,sep=\"\")\nplot(df1$col1, df1[,colName2])\nflush.console()\n}\npar(ask=FALSE)\n</code></pre>\n\n<p>However if I run the same code and use <code>qplot()</code> instead of <code>plot()</code>, the plot window never updates.</p>\n\n<p>Any ideas why or workarounds?</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":147,"score":2,"question_id":10330690,"title":"Error occured because ggplot2 was not upgraded in R 2.15","body":"<p>I need some help with ggplot2. I have got some meteorological data and want to plot the time series. I've tried using a R script it worked for this type of data with light modifications. But when try to ggplot I get an error I've never seen before (not so experienced as R user).</p>\n\n<p>The code I'm using</p>\n\n<pre><code>library(ggplot2)\nlibrary(zoo)\n\ndatos=read.csv(\"dat.txt\",header=TRUE,sep=\";\")\nfecha=as.POSIXct(datos[,1], format=\"%d/%m/%Y\")\ntmax = ggplot(data=datos,aes(x=fecha, y=TempMax)) + geom_line(colour=\"red\")\n</code></pre>\n\n<p>The error I get when writing <code>tmax</code> is </p>\n\n<pre><code>Error in cut.default(unclass(x), unclass(breaks), labels = labels, right = right,  : \n  a vector of length 1317420001 could not be assigned\n</code></pre>\n\n<p>Data structure for <code>dput</code> can be found at <a href=\"https://www.dropbox.com/s/rkh6db9aqdyfw7k/dputdatos.txt\" rel=\"nofollow\">https://www.dropbox.com/s/rkh6db9aqdyfw7k/dputdatos.txt</a>\nand original data at <a href=\"https://www.dropbox.com/s/ds5zp9jonznpuwb/dat.txt\" rel=\"nofollow\">https://www.dropbox.com/s/ds5zp9jonznpuwb/dat.txt</a></p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13119761,"title":"Calculating all possible combinations within a range in R","body":"<p>I'm trying to generate all combinations of four variables, where each variable is an integral between 0 and 10. Is there an easy way to do this in R?</p>\n\n<pre><code>X | Y | Z | W\n-------------\n0 | 0 | 0 | 0\n1 | 0 | 0 | 0\n1 | 1 | 0 | 0\n1 | 1 | 1 | 0\n.   .   .   .\n.   .   .   .\n.   .   .   .\n10|10 |10 |10\n</code></pre>\n"},{"tags":["r","layout","plot","heatmap"],"answer_count":0,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":113,"score":5,"question_id":13081310,"title":"Combining multiple complex plots as panels in a single figure","body":"<h3>Introduction by @backlin</h3>\n\n<p>Multiple simple plots can combined as panels in a single figure by using <code>layout</code> or <code>par(mfrow=...)</code>. However, more complex plots tend to setup their own panel layout internally disabling them from being used as panels. Is there a way to create a nested layout and encapsulating a complex plot into a single panel?</p>\n\n<p>I have a feeling the <code>grid</code> package can accomplish this, e.g. by ploting the panels in separate viewports, but haven't been able to figure out how. Here is a toy example to demonstrate the problem:</p>\n\n<pre><code>my.plot &lt;- function(){\n    a &lt;- matrix(rnorm(100), 10, 10)\n    plot.new()\n    par(mfrow=c(2,2))\n    plot(1:10, runif(10))\n    plot(hclust(dist(a)))\n    barplot(apply(a, 2, mean))\n    image(a)\n}\nlayout(matrix(1:4, 2, 2))\nfor(i in 1:4) my.plot()\n# How to avoid reseting the outer layout when calling `my.plot`?\n</code></pre>\n\n<h2>Original question by @alittleboy</h2>\n\n<p>I use the <code>heatmap.2</code> function in the <code>gplots</code> package to generate heatmaps. Here is a sample code for a single heatmap:</p>\n\n<pre><code>library(gplots)\nrow.scaled.expr &lt;- matrix(sample(1:10000),nrow=1000,ncol=10)\nheatmap.2(row.scaled.expr, dendrogram ='row',\n          Colv=FALSE, col=greenred(800), \n          key=FALSE, keysize=1.0, symkey=FALSE, density.info='none',\n          trace='none', colsep=1:10,\n          sepcolor='white', sepwidth=0.05,\n          scale=\"none\",cexRow=0.2,cexCol=2,\n          labCol = colnames(row.scaled.expr),                 \n          hclustfun=function(c){hclust(c, method='mcquitty')},\n          lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(0.25, 4, 0.25 ),                 \n)\n</code></pre>\n\n<p>However, since I want to compare multiple heatmaps in a single plot, I use <code>par(mfrow=c(2,2))</code> and then call <code>heatmap.2</code> four times, i.e.</p>\n\n<pre><code>row.scaled.expr &lt;- matrix(sample(1:10000),nrow=1000,ncol=10)\narr &lt;- array(data=row.scaled.expr, dim=c(dim(row.scaled.expr),4))\npar(mfrow=c(2,2))\nfor (i in 1:4)\nheatmap.2(arr[ , ,i], dendrogram ='row',\n          Colv=FALSE, col=greenred(800), \n          key=FALSE, keysize=1.0, symkey=FALSE, density.info='none',\n          trace='none', colsep=1:10,\n          sepcolor='white', sepwidth=0.05,\n          scale=\"none\",cexRow=0.2,cexCol=2,\n          labCol = colnames(arr[ , ,i]),                 \n          hclustfun=function(c){hclust(c, method='mcquitty')},\n          lmat=rbind( c(0, 3), c(2,1), c(0,4) ), lhei=c(0.25, 4, 0.25 ),                 \n)\n</code></pre>\n\n<p>However, the result is NOT four heatmaps in a single plot, but four separate heatmaps. In other words, if I use <code>pdf()</code> to output the result, the file is four pages instead of one. Do I need to change any parameters somewhere? Thank you so much!</p>\n"},{"tags":["r","data.table"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":111,"score":3,"question_id":9996523,"title":"How can I subset the negation of a key value using R's data.table package?","body":"<p>R's <code>data.table</code> package offers fast subsetting of values based on keys. </p>\n\n<p>So, for example: </p>\n\n<pre><code>set.seed(1342)\n\ndf1 &lt;- data.table(group = gl(10, 10, labels = letters[1:10]),\n                  value = sample(1:100))\nsetkey(df1, group)\n\ndf1[\"a\"]\n</code></pre>\n\n<p>will return all rows in df1 where group == \"a\".  </p>\n\n<p>What if I want all rows in <code>df1</code> where <code>group != \"a\"</code>.  Is there a concise syntax for that using <code>data.table</code>? </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13122465,"title":"Find unique portfolio combinations in R","body":"<p>Given a vector of stock ticker symbols:</p>\n\n<pre><code> sp500 &lt;- c(\"ABT\", \"ANF\", \"ADBE\", \"AMD\", \"AES\", \"AET\" .. ) \n</code></pre>\n\n<p>How do I find all unique combinations of these for a portfolio of N assets? So for example if N=3 I'd like to return a table/matrix:</p>\n\n<pre><code>  A1   |    A2    |    A3\n--------------------------\n\"ABT\"      \"ANF\"     \"ABDE\"\n\"ABT\"      \"AMD\"     \"ABDE\"\n\"ABT\"      \"AMD\"     \"AES\"\n  .          .          .\n  .          .          .\n\"YHOO\"    \"YUM\"      \"ZMH\"\n</code></pre>\n\n<p>The order does not matter, so it's a \"combination\" rather than a \"permutation\", I believe.. \nI'm attempting to use R for this.</p>\n\n<p>Advice on which function/method I might use for this would be much appreciated.</p>\n"},{"tags":["r","recursion"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":1526,"score":5,"question_id":5273857,"title":"Are recursive functions used in R?","body":"<p>The canonical function to demonstrate recursion is the factorial() function. I tried a simple implementation of it myself and came up with this:</p>\n\n<pre><code>factorial &lt;- function(x){\n\nif(x==1)\n    return( 1)\nelse\n    return(x*factorial(x-1))\n\n}\n</code></pre>\n\n<p>From my survey of the topic, there seems to be some debate about whether it's better to use recursion or simple iteration. I wanted to see how R implements it and found a factorial() function in the gregmisc package. I thought I'd find something like my implementation or instead a regular iteration. What I found this:</p>\n\n<pre><code>&gt; factorial\nfunction (x) \ngamma(x + 1)\n&lt;environment: namespace:base&gt;\n</code></pre>\n\n<p>So the answer to my question of whether R prefers recursion or iteration is \"neither\". At least in this implementation. Are recursive functions avoided in R for good reason?</p>\n\n<p>Update:</p>\n\n<p>gregmisc version:</p>\n\n<pre><code>&gt;ptm &lt;- proc.time()\n&gt; factorial(144)\n[1] 5.550294e+249\n&gt; proc.time() - ptm\n   user  system elapsed \n  0.001   0.000   0.001 \n</code></pre>\n\n<p>my version:</p>\n\n<pre><code>&gt; factorial(144)\n[1] 5.550294e+249\n&gt; proc.time() - ptm\n  user  system elapsed \n  0.002   0.001   0.006 \n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13121772,"title":"Get difference to previous date in R","body":"<p>I have a list of deals with trading day and market value. Every (Trading)day new positions come into the list but the old one never disappear (when positions expire the value stays just constant). The list looks like as follows:</p>\n\n<pre><code>Deal Trade_Date MktValue Desidered_Col\nDeal1 31.08.2012 10 +10\nDeal2 31.08.2012 21 +21\nDeal1 03.09.2012 12 +2\nDeal2 03.09.2012 19 -2\nDeal3 03.09.2012 2  +2\n</code></pre>\n\n<p>I would like for each deal to get the difference to the previous trade date (Desidered_Col in the above example). I would like to avoid looping just because I the list is quite long. I am using R. \nI would appreciate if anybody has any suggestion. Thanks!</p>\n"},{"tags":["r","plyr","read.table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13121393,"title":"Importing and reading multiple files R","body":"<p>I have numerous  tab delimited .txtfiles named as \"<em>abcd001.txt, abcd002.txt\"</em>.... stored in a directory.\nI was able to import them using the following code, (whereby default directory is sames as data files directory). Its three column, all numeric type data</p>\n\n<pre><code>filenames &lt;- list.files(path=\".\",pattern=\"abcd+.*txt\")\n\n#list of data in R\nnames &lt;-substr(filenames,1,6)\n\n\nfor(i in names){\n    filepath &lt;- file.path(\".\",paste(i,\".txt\",sep=\",\"))\n    assign(i, read.table(filepath,\n     colClasses=c(\"numeric\"),\n    sep = \"\\t\"))\n}\n</code></pre>\n\n<p>The code itself hasnt returned any error. My doubt is <em>How can I access data which is being loaded? How to access say the data of  the file abcd011.txt which should be three column data</em> </p>\n\n<p>The commands:names[3] just returns the file number 000002 But no data.</p>\n\n<p>The code here is similar to one here: <a href=\"http://stackoverflow.com/questions/5319839/read-multiple-csv-files-into-separate-data-frames/13090509#13090509\">Read multiple CSV files into separate data frames</a>.</p>\n"},{"tags":["r","generics","package","roxygen"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13120895,"title":"New method for plot - how to export?","body":"<p>I am making a package where I want to define a new method for plot. I am using roxygen in-source documentation. This question seems very similar to:\n<a href=\"http://stackoverflow.com/questions/6517222/roxygen-how-to-properly-document-a-s3-method-of-a-generic-in-a-different-packag\">Roxygen: How to properly document a S3 method of a generic in a different package?</a>\nand\n<a href=\"http://stackoverflow.com/questions/7198758/roxygen2-how-to-properly-document-s3-methods\">Roxygen2 - how to properly document S3 methods</a>\nbut I still cannot get it to work.</p>\n\n<p>The relevant parts that are causing me trouble are:</p>\n\n<pre><code>#' Generic plot method\n#'\n#' @param x \\dots\n#' @param ... \\dots\n#' @export\nplot &lt;- function(x, ...) UseMethod(\"plot\")\n\n#' Default plot method\n#'\n#' @param x \\dots\n#' @param ... \\dots\n#' @importFrom graphics plot\n#' @method plot default\n#' @S3method plot default\nplot.default &lt;- function(x, ...) graphics::plot(x, ...)\n\n#' Plotting function for ABI object\n#'\n#' Description.\n#' \n#' @param x ABI object as generated by newABI.\n#' @param base Character. Bases to look at.\n#' @param ... Other options passed to plot().\n#' @return Nothing. Side-effect: plots graphs.\n#' @method plot ABI\n#' @S3method plot ABI\nplot.ABI &lt;- function(x, base, ...) {\n#Overly simplified\nplot(1, 1, main = base)\n}\n</code></pre>\n\n<p>When I run this and investigate methods(plot), there is no method defined for ABI objects. Accessing the function by ABI:::plot (ABI is the name of the package) does work. Using :: does not.</p>\n\n<p>During the package build check, there is a warning:</p>\n\n<pre><code>* checking S3 generic/method consistency ... WARNING\nplot:\n  function(x)\nplot.ABI:\n  function(x, base, ...)\nSee section ‘Generic functions and methods’ of the ‘Writing R\nExtensions’ manual.\n</code></pre>\n\n<p>It seems that there is a disagreement in arguments. But I don't understand this, since the generic has arguments x and ... and so does my ABI method (in addition to base).</p>\n\n<p>So there are two problems, which I hope stem from the same issue: The plot.ABI method is not exported and the package check throws a warning.</p>\n\n<p>How do I solve this?</p>\n"},{"tags":["r","oauth","flickr","httr"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12971420,"title":"oauth flickr api using httr to retrieve token","body":"<p>I would like to use <code>httr</code> to link up/upload my R image outputs to flickr, but am having difficulty with the initial stages where i need to authenticate myself using OAuth 1.0.</p>\n\n<p>I previously created an app by going to the following link <a href=\"http://www.flickr.com/services/apps/create/apply/\" rel=\"nofollow\">http://www.flickr.com/services/apps/create/apply/</a></p>\n\n<p>and then got a secret and key string for that app...</p>\n\n<p>I then used it in the <code>httr</code> package function to get a token but to no avail. I have been trying to use the provided documentation on this link  <a href=\"http://www.flickr.com/services/api/auth.oauth.html\" rel=\"nofollow\">http://www.flickr.com/services/api/auth.oauth.html</a>  to help out but, I am struggling...</p>\n\n<p>The following is the code I used.</p>\n\n<pre><code>flickr.app &lt;- oauth_app(\"flickr\",key=\"xxxxxx\", secret=\"xxxxxxxx\")\nflickr.urls &lt;- oauth_endpoint(request=\"http://www.flickr.com/services/oauth/request_token\",\n                              authorize=\"http://www.flickr.com/services/oauth/authorize\",\n                              access=\"http://www.flickr.com/services/oauth/access_token\")\nflickr.token &lt;- oauth1.0_token(flickr.urls,flickr.app)\n</code></pre>\n\n<p>from which i get the error message </p>\n\n<pre><code>Error: http client error (400)\n</code></pre>\n\n<p>Not too sure where to go from here...any help would be much appreciated.</p>\n\n<p>N.B. Also I recognise that due to the nature of setting up api links, that there are secrets , api-keys, logins and passwords that need to be kept secret etc, but it does not take long to set up a dummy flickr account from www.flickr.com , to be able to reproduce the problem...in my opinion...perhaps others could try setting one up and letting me know if they got similar issues, and potential methods to work around the situation?</p>\n"},{"tags":["r","list","sapply"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12188439,"title":"R Combine mapply and sapply","body":"<p>I have a function in R that takes in 3 parameters, say <code>foo(x,y,z)</code>.</p>\n\n<p>When I call the function, I really have a list of elements for <code>x</code>, and a list for <code>y</code> but only one element for <code>z</code>. If <code>Z</code> was a list, and I wanted to apply <code>foo</code> to each element, <code>mapply(foo, x, y, z)</code> works.</p>\n\n<p>However, since <code>z</code> is not a list, <code>mapply(foo,x,y,z)</code> does not work. </p>\n\n<p>More specifically, if <code>x</code> and y are lists of 3 elements each, the following does work however: <code>mapply(foo, x, y, list(z, z, z))</code>. </p>\n\n<p>Is there a way I can perhaps combine <code>mapply</code> and <code>sapply</code> without me first making <code>z</code> into a list of 3 elements? I want <code>z</code> to just be reused!</p>\n\n<p><strong>Edit 1:</strong> I was asked for an example:</p>\n\n<pre><code>mylist1 &lt;- list(c(5,4), c(7,9), c(8,3))\nmylist2&lt;- list(c(2,3), c(6,7), c(10,11))\nitem3 &lt;- matrix(data = 15, nrow = 3, ncol = 3)\nfoo &lt;- function(x,y,z){\n       return(x[1]+y[2]+z[2,2])\n}\n</code></pre>\n\n<p>The following works:</p>\n\n<pre><code>&gt; mapply(foo, mylist1, mylist2, list(item3,item3, item3))\n[1] 23 29 34\n</code></pre>\n\n<p>The following does not work:</p>\n\n<pre><code>mapply(foo, mylist1, mylist2, item3)\nError in z[2, 2] : incorrect number of dimensions\n</code></pre>\n"},{"tags":["r","stat"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":37,"score":-3,"question_id":13120311,"title":"nonparametric regression method using R","body":"<p>I need to find the certain driver variables for unit sales &amp; their impact on sales. My data is such data the error does not follow normal distribution &amp; the unit sales is also not following any particular statistical distribution. Given such condition, it is difficult for me to use simple liner regression or GLM.</p>\n\n<p>Can any of you please suggest me some non parametric regression technique which I can use in R to model the relationship?</p>\n\n<p>Thanks,</p>\n"}]}
{"total":19203,"page":7,"pagesize":100,"questions":[{"tags":["r","memory","clear"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":13119688,"title":"How to clear memory used by R?","body":"<p>I'm executing my R code (under Windows Vista x32) and I have following problem. After some iterations I get such error:</p>\n\n<pre><code>Error: cannot allocate vector of size 801.1 Mb\n</code></pre>\n\n<p>Nevertheless, I try to use <code>rm(list=ls())</code> to clean up memory and execute rest part of the code but I still get the same error. Restarting of R doesn't help - to solve this problem I have to restart my PC. Is there any other solution to this problem?</p>\n\n<p>Furthermore, I have another question you may know the answer. How does the memory of R really work? I have the problem of lacking memory when launching a loop opereting each time on the same variables (values, vectors, etc). Each step is somehow randomized but each result is completely comparable. Why do I get an error after execution of some iteration of the loop not during the first iteration? If R overwrites its objects - there is no difference whether it's first, 10th or 100th iteration. Am I right?</p>\n"},{"tags":["r","rcpp"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12691710,"title":"How to export C++ object in R back to C++?","body":"<p>In the example below, I have no difficulty exporting some normal c++ method into R using <code>RCPP_MODULE</code> except the method <code>clone</code> that makes the compilation failed. </p>\n\n<pre><code>struct C\n{\n    void clone(C* other)\n    {\n         *this = *other;\n    }\n};\n\n#include &lt;Rcpp.h&gt;\nusing namespace Rcpp;\n\nRCPP_MODULE(mod){\n    class_&lt;C&gt;(\"C\")\n        .method(\"clone\", &amp;C::clone)\n        ;\n};\n</code></pre>\n\n<p>How to export the <code>clone</code> method so I can reference to other C++ class that is created in R?</p>\n"},{"tags":["r","plot","statistics"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":13114539,"title":"How to add RMSE, slope, intercept, r^2 to R plot?","body":"<p>How can I add RMSE, slope, intercept and r^2 to a plot using R?  I have attached a script with sample data, which is a similar format to my real dataset--unfortunately, I am at a stand-still.  Is there an easier way to add these statistics to the graph than to create an object from an equation and insert that into <code>text()</code>?  I would ideally like the statistics to be displayed stacked on the graph. How can I accomplish this?</p>\n\n<pre><code>## Generate Sample Data\nx = c(2,4,6,8,9,4,5,7,8,9,10)\ny = c(4,7,6,5,8,9,5,6,7,9,10)\n\n# Create a dataframe to resemble existing data\nmydata = data.frame(x,y)\n\n#Plot the data\nplot(mydata$x,mydata$y)\nabline(fit &lt;- lm(y~x))\n\n# Calculate RMSE\nmodel = sqrt(deviance(fit)/df.residual(fit))\n\n# Add RMSE value to plot\ntext(3,9,model)\n</code></pre>\n"},{"tags":["r","ide","cross-platform"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13119403,"title":"Which cross-platform IDEs are available for R?","body":"<p>I'm looking for an IDE for R, that runs on several platforms (At least Linux and Mac). At the moment I'm trying RStudio (http://www.rstudio.com), which seems to be quite nice.</p>\n\n<p>But what are the alternatives?</p>\n"},{"tags":["r","traceback"],"answer_count":1,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":79,"score":8,"question_id":13116099,"title":"traceback() for interactive and non-interactive R sessions","body":"<p>I observed a different between an interactive and non-interaction R session about <code>traceback()</code> which I do not understand. For the code below, it will produce an error, but in an interactive R session, I can see the traceback information, whereas if I save the code to <code>test.R</code> and call it via <code>Rscript test.R</code> or <code>R -f test.R</code>, I can no longer see the traceback:</p>\n\n<pre><code>f = function() {\n  on.exit(traceback())\n  1 + 'a'\n}\nf()\n</code></pre>\n\n<p>In an interactive R session:</p>\n\n<pre><code>&gt; f = function() {\n+   on.exit(traceback())\n+   1 + 'a'\n+ }\n&gt; f()\nError in 1 + \"a\" : non-numeric argument to binary operator\n1: f()\n</code></pre>\n\n<p>Non-interactive execution:</p>\n\n<pre><code>$ Rscript test.R \nError in 1 + \"a\" : non-numeric argument to binary operator\nCalls: f\nNo traceback available \nExecution halted\n</code></pre>\n\n<p>I did not see an explanation in <code>?traceback</code>, and I'm wondering if there is a way to enable traceback for non-interactive R sessions. Thanks!</p>\n"},{"tags":["java","r","path"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4513,"score":1,"question_id":2399027,"title":"Cannot load rJava because cannot load a shared library","body":"<p>I have been struggling to load the rJava package in R. </p>\n\n<p>I get the following messages</p>\n\n<pre><code>&gt; library(rJava)\nError in inDL(x, as.logical(local), as.logical(now), ...) : \n  unable to load shared library \\\n     'C:/PROGRA~1/R/R-210~1.1/library/rJava/libs/rJava.dll':\n  LoadLibrary failure:  The specified module could not be found.\n\n\nError : .onLoad failed in 'loadNamespace' for 'rJava'\nError: package/namespace load failed for 'rJava'\n</code></pre>\n\n<p>I have tried so many solutions that they are all bamboozeled in my head. \nAt some point I even got </p>\n\n<pre><code>&gt; R Console: Rgui.exe - System Error The\n&gt; program can't start because\n&gt; MSVCR71.dll is is missing from your\n&gt; computer. Try reinstalling the program\n&gt; to fix this problem.\n</code></pre>\n\n<p>I made sure everything I could think of was on the path</p>\n\n<pre><code>&gt; C:\\Program Files\\R\\Rtools\\bin;C:\\Program Files\\R\\Rtools\\perl\\bin;\n  C:\\Program Files\\R\\Rtools\\MinGW\\bin;%SystemRoot%\\system32;\n  %SystemRoot%;%SystemRoot%\\System32\\Wbem;\n  %SYSTEMROOT%\\System32\\WindowsPowerShell\\v1.0\\;\n  C:\\Program Files\\QuickTime\\QTSystem\\;\n  C:\\Program Files\\R\\R-2.10.1\\library\\rJava\\libs\\;\n  C:\\Program Files\\R;C:\\Program Files\\Java\\jre6\\bin\\client  \n</code></pre>\n\n<p>What should I try next?</p>\n\n<p>I am running R version 2.10.1 (2009-12-14) and I have also tried R version 2.10.1 Patched (2010-03-03 r51210). It is on a Windows machine running windows 7 enterprise</p>\n"},{"tags":["r","inf","na"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":398,"score":3,"question_id":8689760,"title":"R is there a way to find Inf/-Inf values?","body":"<p>I'm trying to run a randomForest on a large-ish data set (5000x300).  Unfortunately I'm getting an error message as follows:</p>\n\n<pre><code>&gt; RF &lt;- randomForest(prePrior1, postPrior1[,6]\n+                    ,,do.trace=TRUE,importance=TRUE,ntree=100,,forest=TRUE)\nError in randomForest.default(prePrior1, postPrior1[, 6], , do.trace = TRUE,  : \n  NA/NaN/Inf in foreign function call (arg 1)\n</code></pre>\n\n<p>So I try to find any NA's using :</p>\n\n<pre><code>&gt; df2 &lt;- prePrior1[is.na(prePrior1)]\n&gt; df2 \ncharacter(0)\n&gt; df2 &lt;- postPrior1[is.na(postPrior1[,6])]\n&gt; df2 \nnumeric(0)\n</code></pre>\n\n<p>which leads me to believe that it's Inf's that are the problem as there don't seem to be any NA's.  </p>\n\n<p>Any suggestions for how to root out Inf's?</p>\n"},{"tags":["r","pdf","save"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13114594,"title":"Problems saving several pdf files in R","body":"<p>I'm trying to save several xyplots created with a \"for\" loop in R and I'm not able to get complete pdf files (all files have the same size and I can't open them) if I execute the following loop: </p>\n\n<pre><code>for (i in 1:length(gases.names)) {\n   # Set ylim;\n   r_y &lt;- round(range(ratio.cal[,i][ratio.cal[,i]&lt;999], na.rm = T), digits = 1);\n   r_y &lt;- c(r_y[1]-0.1, r_y[2]+0.1);\n\n   outputfile &lt;- paste (path, \"/cal_ratio_\",gases.names[i], \".pdf\", sep=\"\");\n   dev.new();\n   xyplot(ratio.cal[,i] ~ data.GC.all$data.time, groups = data.vial, panel = \n      panel.superpose, xlab = \"Date\", ylab = gases.names[i], xaxt=\"n\", ylim = r_y);\n   savePlot(filename = outputfile, type = 'pdf', device = dev.cur());\n   dev.off();\n}\n</code></pre>\n\n<p>(a previous version was using <code>trellis.device()</code> instead of <code>dev.new() + savePlot()</code>)</p>\n\n<p>Do you know why I can't get good pdf files? If I do it \"manually\" it works... Any idea?</p>\n"},{"tags":["python","r","ggplot2","data-visualization"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":152,"score":6,"question_id":12926779,"title":"How to make a sunburst plot","body":"<p>So far I have been unable to find an R library that can create a sunburst plot like those by <a href=\"http://www.cc.gatech.edu/gvu/ii/sunburst/\" rel=\"nofollow\">John Stasko</a>. Anyone knows how to accomplish that in R or Python?</p>\n\n<p><img src=\"http://i.stack.imgur.com/q68SB.gif\" alt=\"Sunburst\"></p>\n"},{"tags":["r","random-forest","feature-selection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":155,"score":-1,"question_id":11412331,"title":"How to do feature selection with randomForest package?","body":"<p>I'm using randomForest in order to find out the most significant variables. I was expecting some output that defines the accuracy of the model and also ranks the variables based on their importance. But I am a bit confused now. I tried randomForest and then ran <code>importance()</code> to extract the importance of variables.\nBut then I saw another command <code>rfcv</code> (Random Forest Cross-Valdidation for feature selection), which should be the most appropriate for this purpose I suppose, but the question I have regarding this is: how to get the list of the most important variables? How to see the output after running it? Which command to use?</p>\n\n<p>Another thing: What is the difference between <code>randomForest</code> and <code>predict.randomForest</code>?</p>\n\n<p>I am not very familiar with randomforest and R therefore any help would be appreciated. </p>\n\n<p>Thank you in advance!</p>\n"},{"tags":["r","list","data.frame"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":141,"score":4,"question_id":9547518,"title":"creating a data.frame where a column is a list","body":"<p>I was curious to know why the following works:</p>\n\n<pre><code>df &lt;- data.frame(a=1:3)\n&gt; df$b &lt;- list(1:1, 1:2, 1:3)\n&gt; df\n  a       b\n1 1       1\n2 2    1, 2\n3 3 1, 2, 3\n</code></pre>\n\n<p>but not:</p>\n\n<pre><code>&gt; df &lt;- data.frame(a=1:3, b=list(1:1, 1:2, 1:3))\nError in data.frame(1L, 1:2, 1:3, check.names = FALSE, stringsAsFactors = TRUE) : \n  arguments imply differing number of rows: 1, 2, 3\n</code></pre>\n\n<p>Also, is there a way to create <code>df</code> in a single call to <code>data.frame</code>? Thank you.</p>\n"},{"tags":["r","merge","combine","factor","levels"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":102,"score":0,"question_id":10985149,"title":"Merging several factor variables.","body":"<p>This is a follow-up to an earlier question I had: <a href=\"http://stackoverflow.com/questions/4658538/combining-survey-items-in-r-recoding-nas\">Combining Survey Items in R/ Recoding NAs</a></p>\n\n<p>I have a data-frame that has multiple factor-variables that  I want to combine into one variable. </p>\n\n<pre><code>ID      REGIONA REGIONB REGIONC\nA        North     NA      NA\nA        South     NA      NA\nB        NA      East      NA\nB        NA      West      NA\nC        NA        NA     North\nC        NA        NA     East\n</code></pre>\n\n<p>I want the combined data-frame to look like this. </p>\n\n<pre><code>ID      REGION\nA        North    \nA        South     \nB        East      \nB        West      \nC        North       \nC        East     \n</code></pre>\n\n<p>Using the technique in the previous post   <code>within(df, x3 &lt;- ifelse(is.na(x1), x2, x1))</code>works for numbers, but does not seem to handle the factors well.</p>\n"},{"tags":["r","double","stackoverflow","loess"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13115241,"title":"plotting loess with standard errors in R causes integer overflow","body":"<p>I am attempting to use <code>predict</code> with a <code>loess</code> object in R.  There are 112406 observations.  There is one particular line inside <code>stats:::predLoess</code> which attempts to multiply <code>N*M1</code> where <code>N=M1=112406</code>.  This causes an integer overlow and the function bombs out.  The line of code that does this is the following (copied from <code>predLoess</code> source):</p>\n\n<pre><code>L &lt;- .C(R_loess_ise, as.double(y), as.double(x), as.double(x.evaluate[inside, \n]), as.double(weights), as.double(span), as.integer(degree), \nas.integer(nonparametric), as.integer(order.drop.sqr), as.integer(sum.drop.sqr), \nas.double(span * cell), as.integer(D), as.integer(N), as.integer(M1), \ndouble(M1), L = double(N * M1))$L\n</code></pre>\n\n<p>Has anyone solved this or found a solution to this problem? I am using R 2.13. The name of this forum is fitting for this problem.</p>\n"},{"tags":["multithreading","r","class","parallel-processing","s4"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13111003,"title":"Make parallel clusters within a S4 class","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13002200/s4-classes-multiple-types-per-slot\">S4 Classes: Multiple types per slot</a>  </p>\n</blockquote>\n\n\n\n<p>I am trying to make my first R package.\nI plan to create a S4 class \"test\" that contains data and some methods to process data.\nIn my case, the processing of data can be improved by multi-threading.\nI have tested <code>parLapply()</code> and it increases performance.</p>\n\n<p>The problem is that I do not want to call:</p>\n\n<pre><code>cl &lt;- makeCluster(N)\nparLapply(cl, x, FUN, ...)\nstopCluster(cl)\n</code></pre>\n\n<p>in each method I want to make parallel. This is because it is not elegant and, I presume, the repeated creation (and destruction) of the teams of thread costs.</p>\n\n<p>Therefore, I was thinking about (simply) having a <code>cluster</code> object within my class \"test\".\nThen I could, for instance, make a \"test\" object \"o\" and call a method of \"test\" <code>setNumbrOfThreads(o) &lt;- 4</code>.</p>\n\n<p>However, I have trouble with the implementation. Since <code>?makeCluster()</code> states the return value is '''An object of class 'c(\"SOCKcluster\", \"cluster\")''', I have tried :</p>\n\n<pre><code>setClass(\"test\",\n    representation(\n        data = \"list\",\n        nThreads = \"numeric\",\n        cluster = c(\"SOCKcluster\", \"cluster\") #This seems incorrect\n    ),\n    prototype(\n        data = NULL,\n        nThreads = 1,\n        cluster = makeCluster(1) # \"cluster = NULL\" does not help\n    )\n) \n</code></pre>\n\n<p>R complained that <code>element 3 of the representation was not a single character string\n</code>.\nSo I tried without more success: <code>cluster = \"cluster\"</code> or <code>cluster = \"SOCKcluster\"</code> (in representation).</p>\n\n<p>My question is:</p>\n\n<p><strong>How can I can I create an S4 class with a member object of class c(\"SOCKcluster\", \"cluster\") ?</strong></p>\n\n<p>Thank you,</p>\n"},{"tags":["r","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13115720,"title":"How do I combine the upper.tri of one matrix with the lower.tri of another in R?","body":"<p>I have two symmetrical matrices of the same lengths (one contains correlation coefficients and the other contains p-values).</p>\n\n<p>I'm trying to make a matrix such that the upper.tri contains correlation coefficients and the lower.tri contains the relevant p-values.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13115661,"title":"Merging tables of different length by common columns R","body":"<p>I've got two tables of different length and I need to merge them by two common columns (season and client), and fill cells with NAs when there isn't common elements. Below I'm showing a small fraction of the  two original tables and the final table that I need. I've tried many things with no success.</p>\n\n<pre><code>season  client.ID   qtty\n1998    13  30\n1999    13  30\n2000    13  29\n1998    28  18\n1999    28  18\n2000    28  18\n1998    35  21\n1999    35  21\n2000    35  21\n\nseason  client.ID   vessel.ID   overLength\n1998    28  29  17.1\n1998    28  1809    4.26\n1998    28  2215    9.45\n1998    28  4173    5.8\n1998    28  8151    4.5\n1999    28  29  17.1\n1999    28  1809    4.26\n1999    28  2215    9.45\n1999    28  4173    5.8\n1999    28  8151    4.5\n2000    28  29  17.1\n2000    28  1809    4.26\n2000    28  2215    9.45\n2000    28  4173    5.8\n2000    28  8151    4.5\n1998    35  36  9.91\n1999    35  36  9.91\n2000    35  36  9.91\n1998    35  40  9.91\n1999    35  40  9.91\n2000    35  40  9.91\n\n\nseason  client.ID   vessel.ID   overLength  qtty\n1998    13  NA  NA  30\n1999    13  NA  NA  30\n2000    13  NA  NA  29\n1998    28  29  17.1    18\n1998    28  1809    4.26    18\n1998    28  2215    9.45    18\n1998    28  4173    5.8 18\n1998    28  8151    4.5 18\n1999    28  29  17.1    18\n1999    28  1809    4.26    18\n1999    28  2215    9.45    18\n1999    28  4173    5.8 18\n1999    28  8151    4.5 18\n2000    28  29  17.1    18\n2000    28  1809    4.26    18\n2000    28  2215    9.45    18\n2000    28  4173    5.8 18\n2000    28  8151    4.5 18\n1998    35  36  9.91    21\n1999    35  36  9.91    21\n2000    35  36  9.91    21\n1998    35  40  9.91    21\n1999    35  40  9.91    21\n2000    35  40  9.91    21\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":43,"score":4,"question_id":13115040,"title":"Backfilling from another data.frame","body":"<p>I frequently have situations where I have to \"fill in\" information from another data source. </p>\n\n<p>For example: </p>\n\n<pre><code>x &lt;- data.frame(c1=letters[1:26],c2=letters[26:1])\nx[x$c1 == \"m\",\"c2\"] &lt;- NA\nx[x$c1 == \"a\",\"c2\"] &lt;- NA\n\n   c1   c2\n1   a &lt;NA&gt;\n2   b    y\n3   c    x\n4   d    w\n5   e    v\n6   f    u\n7   g    t\n8   h    s\n9   i    r\n10  j    q\n11  k    p\n12  l    o\n13  m &lt;NA&gt;\n...\n</code></pre>\n\n<p>Now, with that missing variable, I'd like to check and fill it in using a seperate data.frame, lets' call it <code>y</code></p>\n\n<pre><code>y &lt;- data.frame(c1=c(\"m\",\"a\"),c2=c(\"n\",\"z\"))\n</code></pre>\n\n<p>So, what I would like to happen is for x to be filled in with y. (row 13 should be c(\"m\",\"n\"), row 1 should be c(\"a\",\"z\"))</p>\n\n<p>The method I use to deal with this currently seems convoluted and indirect. What would your approach be? Keeping in mind that my data is not necessarily in a nice order like this one is but the order should be maintained in <code>x</code>. My preference would be for a solution that does not rely on anything but base R.</p>\n"},{"tags":["r","plot","polar-coordinates"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13106527,"title":"Change axis length in polar.plot?","body":"<p>I want to draw a polar graph in R.</p>\n\n<p>I found plotrix, which has polar.plot, but I'm open to any other solutions.</p>\n\n<p>It plots a polygon just fine, even though I have a few thousand points, so great!</p>\n\n<p>My question: how can I change the start value of the radial axis?  ie, how to do <code>ylim</code> in <code>polar.plot</code>?</p>\n"},{"tags":["r","correlation"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13112238,"title":"A matrix version of cor.test() in R","body":"<p>Cor.test() takes vectors x and y as arguments, but I have an entire matrix of data that I want to test, pairwise. Cor() takes this matrix as an argument just fine, and I'm hoping to find a way to do the same for cor.test().</p>\n\n<p>The common advice from other folks seems to be to use cor.prob():</p>\n\n<blockquote>\n  <p><a href=\"https://stat.ethz.ch/pipermail/r-help/2001-November/016201.html\" rel=\"nofollow\">https://stat.ethz.ch/pipermail/r-help/2001-November/016201.html</a></p>\n</blockquote>\n\n<p>But these p-values are not the same as those generated by cor.test()!!! Cor.test() also seems better equipped to handle pairwise deletion (I have quite a bit of missing data in my data set) than cor.prob().</p>\n\n<p>Does anybody have any alternatives to cor.prob()? If the solution involves nested for loops, so be it (I'm new enough to R for even this to be problematic for me).</p>\n\n<p>Thanks!</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":63,"score":0,"question_id":13114812,"title":"Imputation in R","body":"<p>I am new in R programming language. I just wanted to know is there any way to impute null values of <strong>just one column</strong> in our dataset. Because all of imputation commands and libraries that I have seen, impute null values of the whole dataset.</p>\n"},{"tags":["r","latex","sweave"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":88,"score":5,"question_id":13017200,"title":"workflow between Latex and R screwed","body":"<p>Trying to write my second Latex file</p>\n\n<pre><code>\\documentclass{article}\n\\title{simple Sweave script}\n\\usepackage{/Users/Brenden/Documents/R/R-2.15.1/share/texmf/tex/latex/Sweave}\n\\begin{document}\n\\maketitle\n This is a simple script to demonstrate Sweave. Let's\n begin by generating some results\n&lt;&lt;&gt;&gt;=\nx=rnorm(30)\ny=rnorm(30)\nmean(x)\ncor(x,y)\n@\nand follow that up with some random text\n\\end{document}\n</code></pre>\n\n<p>File saved with .Rnw as extension. I could then use Sweave under R to convert the file to tex. I then run pdflatex under cmd to get my .pdf file. R is stored under /Users/Brenden/Documents. MiKTex is stored under /Users/Brenden/Desktop.</p>\n\n<p>It is said that usually the line of \"usepackage\" is not needed, as when I run Sweave under R, a line of \"usepackage{Sweave}\" will be added to the tex file which is stored under /Users/Brenden/Documents. However, if I don't put in userpackage line, when I run pdflatex under cmd (either under /Documents or /Desktop), I got a messsage that says \"Sweave.sty not found\". So I have been through this trouble by always adding a line of usepackage with a detailed path to help circumvent the problem. Although the \"Sweave.sty not found\" problem is circumvented, I do notice that when I run pdflatex under cmd, I got the response</p>\n\n<pre><code>LaTeX Warning: You have requested package '/Users/Brenden/Documents/R/R- \n2.15.1/share/texmf/tex/latex/Sweave', but the package provides \"Sweave'.\n</code></pre>\n\n<p>Then it runs through several files with .sty under MiKTex</p>\n\n<pre><code>(C:\\Users\\Brenden\\Desktop\\MiKTex\\tex\\latex\\base\\ifthen.sty)\n(C:\\Users\\Brenden\\Desktop\\MiKTex\\tex\\latex\\graphics\\graphicx.sty)\n(C:\\Users\\Brenden\\Desktop\\MiKTex\\tex\\latex\\graphics\\keyval.sty)\n(C:\\Users\\Brenden\\Desktop\\MiKTex\\tex\\latex\\graphics\\graphics.sty)\n(C:\\Users\\Brenden\\Desktop\\MiKTex\\tex\\latex\\graphics\\trig.sty)\n...\n</code></pre>\n\n<p>to eventually create a .pdf</p>\n\n<p>From another post on Stackoverflow, it is said, \"That path is set automatically when you install LaTeX; it's your personal texmf tree and you can put any style or class files you want LaTeX to find there. The directory names don't matter, it searches recursively in them for Sweave.sty\". To me, however, clearly my MiKTex could not find the Sweave.sty unless I specify the path. And even with the path specification, LaTex still gives me a warning. Could someone explain to me where I screwed up (during installing MiKTex, perhaps? ) so that I could help MiKtex find its way to Sweave without my specifying the path? </p>\n\n<p>Thank you.</p>\n"},{"tags":["r","statet"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":9,"score":1,"question_id":13111608,"title":"View command in Eclipse/statET","body":"<p>R has a useful command (\"View\") that lets one see a table like a spreadsheet in a pop-up window. I used this command in the eclipse console while running statET and the spreadsheet popped up for a few milliseconds and then vanished. </p>\n\n<p>To be specific, I have a matrix called \"mat\" and I typed</p>\n\n<pre><code>View(mat)\n</code></pre>\n\n<p>Does anyone know how to fix this?</p>\n"},{"tags":["r","mapping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13100027,"title":"In R, how to include title when using \"plot(region)\"?","body":"<p>R's \"plot(region)\" command does not print out any title--how can I correct this?  The \"main\" command does not work in either of the \"plot\" lines below.</p>\n\n<pre><code>library(OpenStreetMap)\nlibrary(rJava)\nlibrary(rgdal)\nlibrary(UScensus2000)\n\ndata(louisiana.tract)\nm65 = na.omit(louisiana.tract@data$age.65.up)\na65 = cut(m65,breaks=c(min(m65),500,750,1000,3500))  \nlevels(a65) = c(\"0-500\",\"501-750\",\"751-1000\",\"&gt;1000\")\n\nla &lt;- spTransform(louisiana.tract,osm())\nlat &lt;- c(30.4, 29.5)\nlon &lt;- c(-90.7, -89.5)\nregion &lt;- openmap(c(lat[1],lon[1]),c(lat[2],lon[2]),zoom=10,'osm')\nwindows()\nplot(region, main = \"New Orleans area: \\n residents 65 and over by ZIP\")\nplot(la,add=TRUE,col=c(\"light cyan\",\"light blue\", \"cyan\" ,\"dodgerblue\"))\n  legend(locator(1), cex=.8, levels(a65), fill=c(\"light cyan\",\"light blue\", \"cyan\" ,\"dodgerblue\") )\n</code></pre>\n"},{"tags":["r","for-loop","statistics","subsampling"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13107333,"title":"forloop for random subsampling with taking means of test and training errors","body":"<p>I need to create a plot with mean values of training error and test error that are\naveraged over the repeated randomly sampled data four times. If dt is an original data set, I keep getting an error and have no clue how to create a forloop that works. The results from printcp() have different number of rows and I don't know how to resolve this</p>\n\n<p>For the plot, cp will be on the x-axis and averaged test and training errors will be on the y-axis.</p>\n\n<pre><code>for(i in 1:4){\n#take random sample from a data set\n  test.sample&lt;-  sample(nrow(dt), 50)\n  test.data = dt[test.sample,]\n  training.data = dt[-test.sample,]\n#fit test and training data sets\n  fit.test = rpart(dt ~ .,data = test.data)\n  fit.training = rpart(dt ~ .,data = training.data)\n#to calculate cp and errors/ cp = the first column and error = third column\n  training&lt;- data.frame(printcp(fit.training, digits=getOption(\"digits\") - 5)[,1:3])\n  test&lt;- data.frame(printcp(fit.test, digits=getOption(\"digits\") - 5)[,1:3]) \n#bind cp = the first column and error = third column\n  df&lt;- rbind(training[,1:3],test[,1:3])\n}\n</code></pre>\n\n<p>I need the compiled data set with results, which is called \"df\" from all four samples. Then, the next step for me is to calculate mean values of test and training errors (y-axis) from four samplings with respect to cp (x-axis).</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12135700,"title":"Finding the last transaction for each id","body":"<p>I have the following data frame:</p>\n\n<pre><code>id&lt;-c(1,1,1,1,1,3,3,3,3)\nperiod&lt;-c(\"calib\",\"calib\",\"calib\",\"valid\",\"valid\",\"calib\",\"calib\",\"calib\",\"valid\")\ndate&lt;-c(\"11-11-07\",\"11-11-07\",\"23-11-07\",\"12-12-08\",\"17-12-08\",\"11-11-07\",\"23-11-07\",\"23-11-07\",\"16-01-08\")\ntime&lt;-c(12,13,14,11,23,15,12,18,14)\ndf&lt;-data.frame(id,period,time,date)\ndf$date2&lt;-as.Date(as.character(df$date), format = \"%d-%m-%y\")\n\n\nid period time     date      date2\n 1  calib   12 11-11-07 2007-11-11\n 1  calib   13 11-11-07 2007-11-11\n 1  calib   14 23-11-07 2007-11-23\n 1  valid   11 12-12-08 2008-12-12\n 1  valid   23 17-12-08 2008-12-17\n 3  calib   15 11-11-07 2007-11-11\n 3  calib   12 23-11-07 2007-11-23\n 3  calib   18 23-11-07 2007-11-23\n 3  valid   14 16-01-08 2008-01-16\n</code></pre>\n\n<p>I need to extract the <code>date</code> of last transaction in the <code>calib</code> period, for each <code>id</code>, and put it in a new column. If two transactions have been made in one day (similar <code>date</code>) the last transaction should be chosen based on time of transaction.\nThe final table that I am looking for is as follows:</p>\n\n<pre><code>id period time     date      date2  last\n 1  calib   12 11-11-07 2007-11-11   NA\n 1  calib   13 11-11-07 2007-11-11   NA\n 1  calib   14 23-11-07 2007-11-23 2007-11-23\n 1  valid   11 12-12-08 2008-12-12   NA\n 1  valid   23 17-12-08 2008-12-17   NA \n 3  calib   15 11-11-07 2007-11-11   NA\n 3  calib   12 23-11-07 2007-11-23   NA\n 3  calib   18 23-11-07 2007-11-23 2007-11-23\n 3  valid   14 16-01-08 2008-01-16   NA\n</code></pre>\n\n<p>Can anyone help me with this, please?!</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13107339,"title":"In r, how would I remove strata from 3-dimensional contingency tables depending on the number of observations in the strata?","body":"<p>I'm building 3d contingency tables from 3 variables in a data frame.  Let's suppose I'm constructing these via</p>\n\n<pre><code>table(x,y,z)\n</code></pre>\n\n<p>Where z is the variable on which I'm stratifying.  I'd like to get rid of any <code>(,,z(i))</code> where the number of observations in that stratum is 1. </p>\n\n<p>How might I do this? I had trouble figuring out how to count observations in the first place, which I thought I'd be able to use, with subset, to pare down my contingency tables.</p>\n"},{"tags":["r","colors","bar-chart"],"answer_count":3,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":79,"score":5,"question_id":13112974,"title":"Change colours of particular bars in a bar chart","body":"<p>I've been creating some bar-charts and I was wondering is it possible to colour bars on a chart depending on whether they lie above or below the x-axis?</p>\n\n<p>For clarification, this is the type of bar-chart I mean:</p>\n\n<p><img src=\"http://i.stack.imgur.com/SfmeD.png\" alt=\"enter image description here\"></p>\n\n<p>Ideally I would like to be able to colour the bars above a separate colour to those below so the graph looks more appealing, I've been searching but I can't find any method of doing this, can anyone help?</p>\n\n<p>Thanks in advance. :)</p>\n"},{"tags":["r","charts","dataset","frequency"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13112468,"title":"Convert raw data to frequencies","body":"<p>I'm having a little trouble trying to plot certain graphs with this data set that I have, the data set is similar to:</p>\n\n<pre><code>        Year Count        ENSO          NAO\n1   1900     5  0.49063600 -0.073333333\n2   1901     7 -0.34351300 -0.461666667\n3   1902     5  1.43181000 -1.065000000\n4   1903     9 -0.48638500  0.335000000\n5   1904     5  0.66698600 -0.103333333\n6   1905     3  1.12753000 -0.818333333\n7   1906     8 -0.59783800 -0.040000000\n8   1907     2 -0.43226700  0.111666667\n9   1908     8 -0.48319500  0.421666667\n10  1909     8 -1.17421000  0.153333333\n11  1910     4 -0.68855800 -0.996666667\n12  1911     5  0.38084300  0.115000000\n13  1912     5 -0.06871800 -0.535000000\n</code></pre>\n\n<p>And what I would like to do is be able to take the \"count\" column and plot it as a bar chart of the frequencies of each value in \"count\", however I'm not really sure where to start, all the guides I am looking through are just showing how to plot the data as a bar chart when you already have the relevant frequencies.</p>\n\n<p>Can anyone help me out?</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":100,"score":1,"question_id":13072520,"title":"Plot various cases using R using ggplot2","body":"<p>I'm trying to visualize health insurance benefit options for my company to help others make a decision. I have a table like so:</p>\n\n<pre><code>| plan |        ded |  oop | exp_oop |\n|------+------------+------+---------|\n|    a |        400 | 2100 | 17400   |\n|    b |       1300 | 2600 | 14300   |\n|    c |       2600 | 5200 | 28600   |\n</code></pre>\n\n<ul>\n<li><code>ded</code> = deductible; expense level where 90% co-insurance kicks in</li>\n<li><code>oop</code> = out of pocket maximum</li>\n<li><code>exp_oop</code> = amount of medical expense at which <code>oop</code> is reached</li>\n</ul>\n\n<p>I want to plot cost to the employee vs. medical expenses incurred. Health insurance works in ranges...</p>\n\n<pre><code>cost = expenses for 0 &lt; expenses &lt; ded\ncost = deductible + (0.10 x (expenses - ded)) for ded &lt;= expenses &lt; exp_oop\ncost = oop for oop &lt;= expenses &lt;= infinity\n</code></pre>\n\n<p>How might I plot each of these ranges? Basically, one gets a line of slope = 1 for 0 to each plan's deductible, then a line of slope = 0.1 from x = deductible to x = oop, and then a line of slope = 0 from oop upward.</p>\n\n<p>I'm not sure how to conditionally plot with ggplot2. If you'd like to use the above, here's reproducible code for these cutoffs:</p>\n\n<pre><code>dat &lt;- data.frame(plan = c(\"a\", \"b\", \"c\"), ded = c(400, 1300, 2600), oop = c(2100, 2600, 5200), exp_oop = c(17400, 14300, 28600))\n</code></pre>\n\n<p>Do I have to create the x/y values myself? In other words an intermediate table like so?</p>\n\n<pre><code>| plan |     x |    y |\n|------+-------+------|\n|    1 |     0 |    0 |\n|    1 |   400 |  400 |\n|    1 | 17400 | 2100 |\n|    2 |     0 |    0 |\n|    2 |  1300 | 1300 |\n|    2 | 14300 | 2600 |\n|    3 |     0 |    0 |\n|    3 |  2600 | 2600 |\n|    3 | 28600 | 5200 |\n</code></pre>\n\n<p>I'm doing this for several variants (employee only, employee + spouse, etc.) so it would be great if I didn't need separate data tables for each plan but could just work with the already defined deductibles and out of pocket max values I already have in a data frame...</p>\n\n<p>Thanks for any suggestions!</p>\n"},{"tags":["r","benchmarking"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13112229,"title":"R: shell command time-out","body":"<p>I have an R script written to benchmark a shell command with a range of arguments.  The R script just subtracts the start time from the end time for each benchmark.  The problem is that some of these arguments cause the shell command (a Python script) to run endlessly.</p>\n\n<p>How can I script R to kill the shell command after a certain amount of time?  Fixing the underlying problem with the Python script is not something I can do at this point.</p>\n"},{"tags":["r","input","arabic"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":49,"score":3,"question_id":13112646,"title":"R input file arabic?","body":"<p>I am writing a program that reads arabic text from a text file in R, whenever i read the file i get the following errors:</p>\n\n<pre><code>Warning messages:\n1: In read.table(\"C:\\\\Users\\\\Mustafa\\\\Desktop\\\\arabic.txt\", sep = \"\\n\",  :\ninvalid input found on input connection 'C:\\Users\\Mustafa\\Desktop\\arabic.txt'\n2: In read.table(\"C:\\\\Users\\\\Mustafa\\\\Desktop\\\\arabic.txt\", sep = \"\\n\",  :\nincomplete final line found by readTableHeader on 'C:\\Users\\Mustafa\\Desktop\\arabic.txt'\n\n\nFile&lt;-read.table(\"C:\\\\Users\\\\Mustafa\\\\Desktop\\\\arabic.txt\",sep=\"    \\n\",col.names=\"ar\",fileEncoding=\"UTF-8\")\n</code></pre>\n\n<p>I have no idea where error is , the environment i am using is windows, on mac os it works file, however i must run it on windows! any help is appreciated.</p>\n\n<p>Thank you!</p>\n"},{"tags":["r","if-statement","lapply"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13112316,"title":"Using lapply with if to test each element in a list","body":"<p>Suppose I have a list:</p>\n\n<pre><code>alist&lt;- list(4,6,8,9)\n</code></pre>\n\n<p>I want test if each list element is greater than 7 and return a list of 1 if its true and  0 if false. </p>\n\n<p>However I must use lapply.</p>\n\n<pre><code>lapply(alist,if,&gt;7,1) or lapply(alist,if,cond&gt;7,1)\n</code></pre>\n\n<p>Of course none of these work and I keep getting the following error.</p>\n\n<pre><code>Error: unexpected ',' in \"lapply(alist, if,\"\n</code></pre>\n\n<p>I've tried every combination I can think of and looked for help.</p>\n\n<p>Thanks!</p>\n"},{"tags":["r","if-statement","plyr"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13112260,"title":"Defining different functions with R based on ifelse cases; object of type 'closure' error","body":"<p>I'm modifying some previous code I got thanks to @BrianDiggs: [](</p>\n\n<p>Here's my reproducible code, as my actual code uses a data file and is much more involved based on various ifelse cases. This produces the same error:</p>\n\n<p><strong>First, unmodified and working</strong></p>\n\n<pre><code>library(plyr)\n\ndf &lt;- data.frame(name = LETTERS[1:3], var1 = c(1,5,10), var2 = c(2, 4, 6))\n\ngenerator &lt;- function(name, var1, var2) {\n\nfunction(varA, varB) {\n\n  ifelse(varA + varB &lt; 10,\n    10,\n    100)\n}\n\n}\n\nfuns &lt;- mlply(df, generator)\n\ninteractions &lt;- expand.grid(one = seq(0, 20, by=5), two = seq(0, 20, by=5))\n\ntable &lt;- ldply(funs, function(f) {\n  data.frame(varA=interactions$one, varB=interactions$one,\n  result=f(interactions$one, interactions$two))\n})\n</code></pre>\n\n<p>I don't really understand <code>plyr</code> at all... but it's working. From my best guess, I create my input values and then plyr creates a sort of object with a function definition in it (<code>funs</code>). Then I create my second layer of values and run the second function on the whole table of combinations.</p>\n\n<hr>\n\n<p><strong>Modified, not working</strong><br>\nIn any case, I want to have two different functions depending on cases. Here's what I tried:</p>\n\n<pre><code>library(plyr)\n\ndf &lt;- data.frame(name = LETTERS[1:3], var1 = c(1,5,10), var2 = c(2, 4, 6))\n\ngenerator &lt;- function(name, var1, var2) {\n\nifelse(name == \"A\",\n\nfunction(varA, varB) {\n\n  ifelse(varA + varB &lt; 10,\n    10,\n    100)\n},\n\nfunction(varA, varB) {\n\n  varA + varB\n\n})\n\n}\n\nfuns &lt;- mlply(df, generator)\n\ninteractions &lt;- expand.grid(one = seq(0, 20, by=5), two = seq(0, 20, by=5))\n\ntable &lt;- ldply(funs, function(f) {\n  data.frame(varA=interactions$one, varB=interactions$one,\n  result=f(interactions$one, interactions$two))\n})\n</code></pre>\n\n<p>For this, I get, <code>Error: Object of type 'closure' is not subsettable</code></p>\n\n<hr>\n\n<p>I also tried doing the <code>ifelse()</code> split inside the second function:</p>\n\n<pre><code>library(plyr)\n\ndf &lt;- data.frame(name = LETTERS[1:3], var1 = c(1,5,10), var2 = c(2, 4, 6))\n\ngenerator &lt;- function(name, var1, var2) {\n\nfunction(varA, varB) {\n\nifelse(name == \"A\",\n\n  \"foo\",\n\n  ifelse(varA + varB &lt; 10,\n    10,\n    100))\n\n}\n\n}\n\nfuns &lt;- mlply(df, generator)\n\ninteractions &lt;- expand.grid(one = seq(0, 20, by=5), two = seq(0, 20, by=5))\n\ntable &lt;- ldply(funs, function(f) {\n  data.frame(varA=interactions$one, varB=interactions$one, result=f(interactions$one, interactions$two))\n})\n</code></pre>\n\n<p>For this, I get <code>In '[&lt;-.factor'('*tmp*', ... : invalid factor level, NAs generated</code>.</p>\n\n<hr>\n\n<p>If I replace <code>ifelse(name == \"A\")</code> with <code>ifelse(0 &lt; 1)</code>, I get, as expected all results as <code>foo</code>. If I replace with <code>ifelse(name == 1)</code>, I get all results of 10, which is odd because there's numerous cases where <code>varA + varB &gt; 10</code>.</p>\n\n<p>Interestingly, I added another column to <code>df</code> of <code>criteria = c(1, 5, 10)</code>. I can't do <code>ifelse(criteria &gt; 1)</code>, but I <em>can</em> do <code>ifelse(varA &gt; criteria)</code>. Why wouldn't it allow a comparison to a static number, but it would allow for a comparison between row variables?</p>\n\n<hr>\n\n<p>Anyway, my hope is to be able to do something like this:</p>\n\n<pre><code>generator &lt;- function(var1, var2, ... , varN) {\n\nfunction(varA, varB) {\n\nifelse(criteria based on any of var1 ... varN,\n\n   do a bunch of stuff,\n\ndo different stuff if criteria not met)\n\n}\n\n}\n</code></pre>\n"},{"tags":["r","graph","dataset","plot"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13111595,"title":"Attempt at scatterplot produces many vertical lines (Solved)","body":"<p>I'm trying to just create the most simple type of graph using data such as this:</p>\n\n<pre><code>1   Year  Count   Difference1   Difference2\n2   1900  5       0.490636     -0.0733333333333333\n3   1901  7      -0.343513     -0.461666666666667\n4   1902  5       1.43181      -1.065\n5   1903  9      -0.486385      0.335\n6   1904  5       0.666986     -0.103333333333333\n7   1905  3       1.12753      -0.818333333333333\n8   1906  8      -0.597838     -0.04\n9   1907  2      -0.432267      0.111666666666667\n10  1908  8      -0.483195      0.421666666666667\n11  1909  8      -1.17421       0.153333333333333\n</code></pre>\n\n<p>All I'm trying to do is plot, Year vs Count, Year vs Difference 1 and other graphs with this data, however using simply plot(year, count) for:</p>\n\n<pre><code>year = data[,1]\ncount = data[,2]\n</code></pre>\n\n<p>where data is the imported set of data shown above gives a graph just showing a huge amount of vertical lines. What am I doing wrong?</p>\n"},{"tags":["r","ggplot2","labels","lattice"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13098430,"title":"how to plot a picture with boxed x-labels in lattice?","body":"<p>How to add tow horizontal lines in the bar chart?</p>\n\n<p>and how to box my x-labels like this?</p>\n\n<p><a href=\"http://wego.genomics.org.cn/pubs/rice_indica.pdf\" rel=\"nofollow\">http://wego.genomics.org.cn/pubs/rice_indica.pdf</a></p>\n\n<p>Fig.9</p>\n\n<p>In addition, how to add a y-axis in the right with custom labels?</p>\n\n<pre><code>go=data.frame(number_of_Unigene=c(45,5328,30,30,119,3248,16594,244,4354,3547,917,429,3716,30,15726,4182,1673,877,30,30,640,4808,2462,2437,7812,190,2001,30,44,19852,1763,19852,31,30,686,30,3698,9829,3432,1439,15252,6024,1753,216,15917,15103,30,433,319,30,522,708,30,102,30,613,1039,30,2478),class=c(\"biological adhesion\",\"biological regulation\",\"carbon utilization\",\"cell killing\",\"cell proliferation\",\"cellular component organization or biogenesis\",\"cellular process\",\"death\",\"developmental process\",\"establishment of localization\",\"growth\",\"immune system process\",\"localization\",\"locomotion\",\"metabolic process\",\"multicellular organismal process\",\"multi-organism process\",\"negative regulation of biological process\",\"nitrogen utilization\",\"pigmentation\",\"positive regulation of biological process\",\"regulation of biological process\",\"reproduction\",\"reproductive process\",\"response to stimulus\",\"rhythmic process\",\"signaling\",\"sulfur utilization\",\"viral reproduction\",\"cell\",\"cell junction\",\"cell part\",\"extracellular matrix\",\"extracellular matrix part\",\"extracellular region\",\"extracellular region part\",\"macromolecular complex\",\"membrane\",\"membrane part\",\"membrane-enclosed lumen\",\"organelle\",\"organelle part\",\"symplast\",\"antioxidant activity\",\"binding\",\"catalytic activity\",\"channel regulator activity\",\"electron carrier activity\",\"enzyme regulator activity\",\"metallochaperone activity\",\"molecular transducer activity\",\"nucleic acid binding transcription factor activity\",\"nutrient reservoir activity\",\"protein binding transcription factor activity\",\"protein tag\",\"receptor activity\",\"structural molecule activity\",\"translation regulator activity\",\"transporter activity\"),Ontology=c(\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\"))\n\n\nlibrary(lattice)\nnewclass&lt;-factor(go[,2],levels=unique(go[,2]))\nbarchart(go[,1]~newclass,horiz=F,ylim=c(30,29666),layout=c(1,1),stack=F,\nauto.key=list(space='right'),ylab=\"Number of unigenes\",\nscales=list(x=list(rot=45),y=list(log=T)))\n</code></pre>\n"},{"tags":["r","loops","sum"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":90,"score":0,"question_id":13106457,"title":"R sum over infinite series loop?","body":"<p>I have this:</p>\n\n<pre><code>time=1:200\nm=1:1000\n\nsum[i]= sum(1/(1+2*m)^2)*exp( (-kappa*(1+2*m)^2 * pi^2 * time[i])/(z1^2))\n</code></pre>\n\n<p>I need to find the sum of the expression above for m=1:1000 and time=1:200</p>\n\n<p>I have tried many variety of loop and cannot make it stick. I am even having trouble expressing this here....</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":13106478,"title":"possible bug in geom_ribbon","body":"<p>i was hoping to plot two time series and shade the space between the series according to which series is larger at that time.</p>\n\n<p>here are the two series-- first in a data frame  with an indicator for whichever series is larger at that time</p>\n\n<pre><code>d1 &lt;- read.csv(\"https://dl.dropbox.com/s/0txm3f70msd3nm6/ribbon%20data.csv?dl=1\")\n</code></pre>\n\n<p>And this is the melted series.</p>\n\n<pre><code>d2 &lt;- read.csv(\"https://dl.dropbox.com/s/6ohwmtkhpsutpig/melted%20ribbon%20data.csv?dl=1\")\n</code></pre>\n\n<p>which I plot...</p>\n\n<pre><code>ggplot() + geom_line(data = d2,\n                 aes(x = time, y = value, group = variable, color = variable)) +\n         geom_hline(yintercept = 0, linetype = 2) +\n         geom_ribbon(data = d1[d1$big == \"B\",],\n                     aes(x = time, ymin = csa, \n                         ymax =  csb),\n                         alpha  = .25,\n                         fill = \"#9999CC\") +\n         geom_ribbon(data = d1[d1$big == \"A\",],\n                     aes(x = time, ymin = csb, \n                         ymax =  csa),\n                     alpha  = .25,\n                     fill = \"#CC6666\") +\n         scale_color_manual(values = c(\"#CC6666\" , \"#9999CC\"))\n</code></pre>\n\n<p>which results in...</p>\n\n<p><img src=\"http://i.stack.imgur.com/3ZCyD.png\" alt=\"the resulting plot\"></p>\n\n<p>why is there a superfluous blue band in the middle of the plot? </p>\n"},{"tags":["r","sorting","date","data.frame"],"answer_count":1,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":1943,"score":4,"question_id":6246159,"title":"How to sort a data frame by date in R","body":"<p>Hello\nI need to sort a data frame by date in R.  The dates are all in the form of  \"dd/mm/yyyy\". The dates are in the 3rd column.  The column header is V3.  I have seen how to sort a data frame by column and I have seen how to convert the string into a date value.  I can't combine the two in order to sort the data frame by date.</p>\n\n<p>Thank you\nJohn </p>\n"},{"tags":["r","path","concatenation"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13110076,"title":"Function to concatenate paths?","body":"<p>Is there an existing function to concatenate paths?</p>\n\n<p>I know it is not that difficult to implement, but still... besides taking care of trailing <code>/</code> (or <code>\\</code>) I would need to take care of proper OS path format detection (i.e. whether we write <code>C:\\dir\\file</code> or <code>/dir/file</code>). </p>\n\n<p>As I said, I believe I know how to implement it; the question is: should I do it? Does the functionality already exist in existing R package?</p>\n"},{"tags":["r","bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13109383,"title":"Bootstrap two-way large dataset","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13104339/bootstrap-a-large-data-set\">Bootstrap a large data set</a>  </p>\n</blockquote>\n\n\n\n<p>I would like to bootstrap a large two-way data set which contains multiple column and row variables. I have to preserve both row and column variables. The result should be a list containing a bootstrap of all column variables for each row variable. I am providing the required code to answer my question but i think it is not elegant. I would appreciate a better and faster code. The following is a simplified re-creation of the two-way data set:</p>\n\n<pre><code>rm(list=ls())\n\ndata &lt;- 1:72\n</code></pre>\n\n<p>Create a two way matrix data:</p>\n\n<pre><code>charDataDiff &lt;- matrix(data, nrow=9,ncol=8)\nvarNames &lt;- c(\"A\", \"B\", \"C\",\"A\", \"B\", \"C\",\"A\", \"B\", \"C\")\n</code></pre>\n\n<p>Add a character column to the charDataDiff matrix:</p>\n\n<pre><code>charDataDiff &lt;- cbind(varNames ,data.frame(charDataDiff))\n</code></pre>\n\n<p>Add column names:</p>\n\n<pre><code>colnames(charDataDiff) &lt;- c(\"patchId\",\"s380\",\"s390\",\"s400\",\"s410\",\"s420\",\"s430\",\"s440\",\"s450\")\n</code></pre>\n\n<p>Separate the data using the row-variable \"patchId\" as the criteria. This creates three lists: one for each Variable</p>\n\n<pre><code>idColor &lt;-  c(\"A\", \"B\", \"C\")\n\n(patchSpectrum &lt;- lapply(idColor, function(idColor) charDataDiff[charDataDiff$patchId==idColor,]))\n</code></pre>\n\n<p>Created the function sampleBoot to sample the patchSpectrum</p>\n\n<pre><code>sampleBoot &lt;-  function(nbootstrap=2, patch=3){\n    return(lapply(1:nbootstrap, function(i)\n             {patchSpectrum[[patch]][sample(1:nrow(patchSpectrum[[patch]]),replace=TRUE),]}))}\n</code></pre>\n\n<p>The list \"k\" answers my question. However, I think my code is slow for a large data set and large bootstrap. I am only bootstrapping 10 iteration for three row variables. A faster more elegant code is appreciated.</p>\n\n<pre><code>numBoots &lt;- 10\nfor (i in 1: numBoots)\n        k &lt;- lapply(1:3, function(n)\n                    do.call(rbind, lapply(sampleBoot(i, n), function(x) apply(x[-1], 2, median))))\nk\n</code></pre>\n"},{"tags":["r","formatting","output"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13109652,"title":"R output without [1], how to nicely format?","body":"<p>I know stuff has been posted, but not as complete as what I am looking for.</p>\n\n<p>Take any help function (i.e. <code>?mean</code>), and realise that it's output (or at least output should be able to be generated in the same manner). </p>\n\n<p>How do you get enters, alignment/intendation?</p>\n\n<p>Example:</p>\n\n<pre><code>strings &lt;- c(\"t\", \"df\", \"p-value\", \"mean of x\", \"mean of y\")\nvalues  &lt;- c(t, df, pvalue, mean1, mean2)\n</code></pre>\n\n<p>If this would be the things you'd want to output in R (when called from a function), how do you make the <code>[1]</code> disappear, and the values lined up?</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":89,"score":-3,"question_id":13107517,"title":"Error: cannot allocate vector of size 10.2 Mb","body":"<p>This is the code in R:</p>\n\n<pre><code>claimsMemdata &lt;- merge(claims, members, by=\"MemberID\")\n</code></pre>\n\n<p>I get the error: </p>\n\n<pre><code>cannot allocate vector of size 10.2 Mb.\n</code></pre>\n"},{"tags":["json","r"],"answer_count":4,"favorite_count":6,"up_vote_count":11,"down_vote_count":0,"view_count":2999,"score":11,"question_id":2061897,"title":"Parse JSON with R","body":"<p>I am fairly new to R, but the more use it, the more I see how powerful it really is over SAS or SPSS.  Just one of the major benefits, as I see them, is the ability to get and analyze data from the web.  I imagine this is possible (and maybe even straightforward), but I am looking to parse JSON data that is publicly available on the web.  I am not programmer by any stretch, so any help and instruction you can provide will be greatly appreciated.  Even if you point me to a basic working example, I probably can work through it.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13011496,"title":"split and root node from multiple vectors in rpart","body":"<p>How to find a split and root node in a regression tree, I made a regression tree from multiple vectors now I have to extract root node of rpart of multiple vectors.file contains numeric value of multiple vectors <code>A</code>,<code>B</code>,<code>C</code>,<code>D</code>,<code>E</code>,<code>F</code>,<code>G</code>,<code>H</code> ex. A vector contains 4,3,6,7,2,4,5,...and so on similarly others B,C,D,E,F,G,H .so want to extract <code>F</code> (which is a root node in my case) as an output from this input an after creating a tree .thank you.sorry unable to put any image :(</p>\n\n<p>Here's what I've done so far</p>\n\n<pre><code>log_data &lt;- read.csv(file=\"C:\\\\Users\\\\AASHU\\\\Desktop\\\\CART\\\\syn.csv\",\n                      header=T, as.is=T)\nlibrary(rpart)\n\nfit &lt;- rpart(A ~ B+C+D+E+F+G+H, log_data)\n# plot(fit)\nplot(fit, compress=TRUE, branch=0)\ntext(fit, xpd = NA, cex = 0.7)\n\nsummary(fit)\nCall:\nrpart(formula = A ~ B + C + D + E + F + G + H, data = log_data)\nn=52 (1 observation deleted due to missingness)\n\n          CP nsplit rel error   xerror      xstd\n1 0.09798662      0 1.0000000 1.065250 0.1888568\n\n2 0.09347624      1 0.9020134 1.198999 0.1842667\n\n3 0.03632980      2 0.8085371 1.154558 0.1859743\n\n4 0.02297130      3 0.7722073 1.254874 0.2029423\n\n5 0.01000000      4 0.7492360 1.274024 0.2118272\n\nNode number 1: 52 observations,    complexity param=0.09798662\n\n mean=4.403846, MSE=1.509985 \n\n left son=2 (7 obs) right son=3 (45 obs)\n\n Primary splits:\n\nF &lt; 5.5 to the right, improve=0.09798662, (0 missing)\n</code></pre>\n\n<p>...........\nNow I have to extract root node <code>F(F&gt;=5.5)</code> from fit (regression tree) and its split,can anyone help me?.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":75,"score":-1,"question_id":13107510,"title":"how to plot scatterplot and histogram using R","body":"<p>I have a dataset about maximum wind speed(cm) as below:</p>\n\n<pre><code>Year Jan Feb Mar Apr May June July Aug Sept Oct Nov Dec     \n2011 4.5 5.6 5.0 5.4 5.0 5.0  5.2  5.3 4.8  5.4 5.4 3.8     \n2010 4.6 5.0 5.8 5.0 5.2 4.5  4.4  4.3 4.9  5.2 5.2 4.6     \n2009 4.5 5.3 4.3 3.9 4.7 5.0  4.8  4.7 4.9  5.6 4.9 4.1     \n2008 3.8 1.9 5.6 4.7 4.7 4.3  5.9  4.9 4.9  5.6 5.2 4.4     \n2007 4.6 4.6 4.6 5.6 4.2 3.6  2.5  2.5 2.5  3.3 5.6 1.5     \n2006 4.3 4.8 5.0 5.2 4.7 4.6  3.2  3.4 3.6  3.9 5.9 4.4     \n2005 2.7 4.3 5.7 4.7 4.6 5.0  5.6  5.0 4.9  5.9 5.6 1.8     \n</code></pre>\n\n<p>How to create monthly max wind speed scatterplot (month in x-axis and wind speed in y-axis) and also the monthly max wind speed histogram by using R programming? </p>\n"},{"tags":["r","pie-chart"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13103416,"title":"Plot pie-chart in R","body":"<pre><code>totalReads=10000\nmappedReads=8000\nmappedTargetReads=6000\nunmappedReads=totalReads-mappedReads\nofftargetmappedReads=mappedReads-mappedTargetReads\ndata&lt;-c(mappedReads,unmappedReads,mappedTargetReads,offtargetmappedReads)\nround(data[1]/totalReads*100)-&gt;a\nround(data[2]/totalReads*100)-&gt;b\nround(data[3]/mappedReads*100)-&gt;c\nround(data[4]/mappedReads*100)-&gt;d\npct&lt;-c(a,b,c,d)\nlabels&lt;-c(\"MappedReads\",\"UnmappedReads\",\"On-exon\",\"Off-exon\")\nlabels&lt;-paste(labels,pct)\nlabels&lt;-paste(labels,\"%\", sep=\"\")\npie(c(mappedReads,unmappedReads,mappedTargetReads,offtargetmappedReads),labels=labels)\n</code></pre>\n\n<p>Which basically plots all the four slices independently. But here <code>mappedTargetReads</code>, <code>offtargetmappedReads</code> are calculated with respect to mapped reads and therefore, I would like to subdivide the <code>mappedReads</code> slice and represent <code>mappedTargetReads</code>, <code>offtargetmappedReads</code> within <code>mappedReads</code>.</p>\n\n<p>Or is it possible to plot two different piecharts next to each other in a single Rplot?</p>\n"},{"tags":["r","time-series","cross-correlation"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13107733,"title":"Cross Correlation Function in R for Different Size Time Series","body":"<p><a href=\"http://en.wikipedia.org/wiki/Cross-correlation#Time_series_analysis\" rel=\"nofollow\">Cross correlation function</a> is defined for same size time series. I wonder how R implements this definition in \"ccf\" function for different size of time series.</p>\n\n<p>Such as suppose that I have two time series:</p>\n\n<pre><code>at1,at2...at18\nbt1,bt2...bt18,bt19,bt20\n</code></pre>\n\n<p>How does R ccf function calculates cross correlation for lag value zero. Besides of same sized time series there are mismatch for different lag values. How does R handle this? Is there any formal definition for this? </p>\n"},{"tags":["r","xts","quantmod"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":13098888,"title":"Removing NA columns in xts","body":"<p>I have an xts in the following format</p>\n\n<pre><code>                   a        b     c        d       e        f   ......\n2011-01-03         11.40    NA    23.12    0.23    123.11   NA  ......\n2011-01-04         11.49    NA    23.15    1.11    111.11   NA  ......\n2011-01-05         NA       NA    23.11    1.23    142.32   NA  ......\n2011-01-06         11.64    NA    39.01    NA      124.21   NA  ......\n2011-01-07         13.84    NA    12.12    1.53    152.12   NA  ......\n</code></pre>\n\n<p>Is there a function I can apply to generate a new xts or data.frame missing the columns containing only NA? </p>\n\n<p>The position of the columns with the NAs isn't static so just removing those columns by name or position isn't possible</p>\n"},{"tags":["r","reference-class"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":13106897,"title":"Copying R5 reference classes with a locked variable","body":"<p>I can copy an R5 reference class when I have not locked one of the fields, but it does not copy if one of the fields is locked.  Example code follows (with the lock call commented out). My question: Why can't I make a copy of the instance with a locked field using the copy() method?</p>\n\n<pre><code>example &lt;- setRefClass('example',\n    fields = list(\n        count = 'numeric',\n        data = 'data.frame', \n        d.accessor = function(x) {\n            if ( !missing(x) ) \n                data &lt;&lt;- x\n            else\n                .self$data \n        }\n    ),\n    methods = list(\n        initialize = function( data ) {\n            if (!missing( data ))\n                d.accessor &lt;&lt;- data\n            count &lt;&lt;- 0\n        },\n        finalize = function()\n            print('Bye Bye'),\n        accumulate = function(x)\n            count &lt;&lt;- count + x\n    )\n)\n\n#example$lock('data') # write-1, read-many\ninstance &lt;- example$new() # instantiation\ndf &lt;- data.frame(x=1, y=2)# example df\ninstance$d.accessor &lt;- df # 1st set - okay!\ncopyInst &lt;- instance$copy()\n</code></pre>\n"},{"tags":["r","table","factor"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13106555,"title":"How to tabulate sums of factors from a dataframe, keeping labels","body":"<p>I have a dataframe of 11 variables x 60 rows; the entries are two-valued factor ('Male'/'Female') and contain NAs. (Each row is a single household, wih up to 11 members. Hence the column names 'A4M1'...'A4M11').</p>\n\n<p>What is the simplest paradigm to tabulate the total counts of 'Male','Female' so they can be barplot'ted? Ideally my output would be a length-2 named vector of numeric, i.e. <strong>directly operate on the factor as a factor, so we keep the labels</strong>.</p>\n\n<p>I've been trying reshape,melt,cast,stack,tabulate,table,colwise,sum,aggregate,summarise,by,plyr...</p>\n\n<p>My current working code is: </p>\n\n<pre><code>&gt; tabulate(stack(colwise(as.numeric)(myData), na.rm=TRUE)$values)\n[1] 162 151\n</code></pre>\n\n<p>which sucks since I don't want to coerce to numeric and lose the labels. </p>\n\n<p>See my answer below</p>\n\n<pre><code>table(as.matrix(myData))\n</code></pre>\n\n<p>is also not ideal since it loses the order of factor levels, and returns us alphabetical order of labels.</p>\n\n<p><code>tabulate()</code> seems to be the most suitable fn. To convert the dataframe to a list I use <code>stack(..., na.rm=TRUE)$values</code>, which is clunky but does the job.\nHowever <code>stack()</code> is not ideal since it won't work on factors, so I have to convert it with <code>colwise(as.numeric)(myData)</code>, which throws away the labels. \nI could reapply <code>factor(..., labels=c('Male','Female'))</code> to the output from <code>tabulate()</code>, but that's just clunky.\nSo, can you do better?\n(Using a standard paradigm, other than writing case-specific code)</p>\n\n<pre><code>&gt; head(myData)\n    A4M1 A4M2   A4M3   A4M4   A4M5 A4M6 A4M7 A4M8 A4M9 A4M10 A4M11\n1 Female Male   Male   &lt;NA&gt;   Male Male Male &lt;NA&gt; &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;\n2 Female Male   Male   &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;\n3 Female Male   Male   &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;\n4 Female Male Female   &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;\n5 Female Male   Male Female Female Male &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;\n6 Female Male   Male   &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;\n7 ...\n\n&gt; str(myData)\n'data.frame':   60 obs. of  11 variables:\n $ A4M1 : Factor w/ 2 levels \"Male\",\"Female\": 2 2 2 2 2 2 1 2 2 2 ...\n $ A4M2 : Factor w/ 2 levels \"Male\",\"Female\": 1 1 1 1 1 1 1 1 1 1 ...\n $ A4M3 : Factor w/ 2 levels \"Male\",\"Female\": 1 1 1 2 1 1 2 1 1 2 ...\n $ A4M4 : Factor w/ 2 levels \"Male\",\"Female\": NA NA NA NA 2 NA NA 1 NA 2 ...\n $ A4M5 : Factor w/ 2 levels \"Male\",\"Female\": 1 NA NA NA 2 NA NA 1 NA 2 ...\n $ A4M6 : Factor w/ 2 levels \"Male\",\"Female\": 1 NA NA NA 1 NA NA NA NA NA ...\n $ A4M7 : Factor w/ 2 levels \"Male\",\"Female\": 1 NA NA NA NA NA NA NA NA NA ...\n $ A4M8 : Factor w/ 2 levels \"Male\",\"Female\": NA NA NA NA NA NA NA NA NA NA ...\n $ A4M9 : Factor w/ 2 levels \"Male\",\"Female\": NA NA NA NA NA NA NA NA NA NA ...\n $ A4M10: Factor w/ 2 levels \"Male\",\"Female\": NA NA NA NA NA NA NA NA NA NA ...\n $ A4M11: Factor w/ 2 levels \"Male\",\"Female\": NA NA NA NA NA NA NA NA NA NA ...\n</code></pre>\n"},{"tags":["r","types","data.frame","factor"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":452,"score":1,"question_id":6706677,"title":"How to display numeric columns in an R dataframe without scientific notation ('e+07')","body":"<p>I have an R dataframe with one column containing a stringt of numbers but I would like to treat them as a factor (mainly to stop R shortening the numbers using e+04 etc...).  One way I have found to fix this problem is to edit the csv file the data is taken from, and add a dummy entry that has a word in the desired column and then reimporting it.  How do I get this effect using R functions without messing around with the csv?</p>\n\n<p>To clarify, my dataframe looks like this:</p>\n\n<pre><code>pNum,Condition,numberEntered\n1,2,5.0970304e+07\n</code></pre>\n\n<p>I want to change the data type of numberEntered from numeric to factor and get rid of the pesky e+07.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":56,"score":0,"question_id":13104339,"title":"Bootstrap a large data set","body":"<p>I would like to bootstrap a large data set which contains multiple column and row variables.  The following is a simplified re-creation of my data set:</p>\n\n<pre><code>charDataDiff &lt;- data.frame(c('A','B','C'), matrix(1:72, nrow=9))\ncolnames(charDataDiff) &lt;- c(\"patchId\",\"s380\",\"s390\",\"s400\",\"s410\",\"s420\",\"s430\",\"s440\",\"s450\")\n</code></pre>\n\n<p>Separate the data using the <code>patchId</code> as the criteria. This creates three lists: one for each Variable</p>\n\n<pre><code>idColor &lt;-  c(\"A\", \"B\", \"C\")\n(patchSpectrum &lt;- lapply(idColor, function(idColor) charDataDiff[charDataDiff$patchId==idColor,]))\n</code></pre>\n\n<p>Created the function <code>sampleBoot</code> to sample the <code>patchSpectrum</code> </p>\n\n<pre><code>sampleBoot &lt;-  function(nbootstrap=2, patch=3){\n    return(lapply(1:nbootstrap, function(i)\n             {patchSpectrum[[patch]][sample(1:nrow(patchSpectrum[[patch]]),replace=TRUE),]}))}\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>sampleBoot(5,3)\n</code></pre>\n\n<p>Here is where I am stuck: </p>\n\n<ol>\n<li>I need to sample each <code>patchId</code> list along with each column variable (which the above \"sampleBoot\" easily accomplish), </li>\n<li>Take the median of each <code>patchId</code> sampling list iteration, and </li>\n<li>Create a new population of the medians to calculate parametric parameters. I can do it manually but that would be silly.</li>\n</ol>\n"},{"tags":["r","vector","for-loop","data.frame"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13105888,"title":"In R, how to easily combine many vectors into a dataframe?","body":"<p>So, I know that I can use the data.frame command to combine multiple vectors into one dataframe, like so:</p>\n\n<pre><code>my.data &lt;- data.frame(name1, age1, name20, age20, name38, age38)\n</code></pre>\n\n<p>(I know, the variable names don't make much sense, why would I want name1, name20 and name38 in three different columns? Please ignore that: my actual variable names are different -- this is only for illustration purposes).</p>\n\n<p>Problem is, I have about 40 of such vectors, and I have to combine many vectors in other parts of my code as well. So it would be convenient for me not to copy-paste a huge chunk of code every time. So I thought of writing a for loop around this:</p>\n\n<pre><code>for (i in c(\"name\", \"age\", \"hgt\"))\n{\n    for (k in c(1,20,38))\n    {\n    my.data$i,as.character(k) &lt;- data.frame(get(paste(i,as.character(k),sep=\"\")))\n    }\n}\n</code></pre>\n\n<p>But this doesn't work. Is this because I should write \"paste()\" around some of this code, or is this simply a bad way to approach this problem? What is the correct way to loop through i and k and get a \"newdata\" dataframe as the final result with all the vectors as columns attached?</p>\n"},{"tags":["r","list","function","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13038740,"title":"How to apply different functions to different rows of each matrix in a list?","body":"<p>I have a list holding a couple of matrices with the same amount of rows (4). Now I want to apply a function like log2(row/something) to say rows 1 and 4 and a function like log2(row/something else) to rows 2 and 3.</p>\n\n<p>In code:</p>\n\n<pre><code># Create list with 2 matrices with 4 rows\nl&lt;-list(a=matrix(1:16,nrow=4),b=matrix(17:32,nrow=4))\n\n# Now I thought it might be possible to\nnl &lt;- lapply(l, function(x){\n  log2(x[c(1,4),]/14)\n  log2(x[2:3,]/23)\n})\n</code></pre>\n\n<p>But the result is that only the last function in the <code>lapply</code>is executed. Also I thought it might be possible to:</p>\n\n<pre><code>nl &lt;- l\nlapply(nl, function(x) x[c(1,4),]) &lt;- lapply(l, function(x) log2(x[c(1,4),]/14))\nlapply(nl, function(x) x[2:3,]) &lt;- lapply(l, function(x) log2(x[2:3,]/23))\n</code></pre>\n\n<p>But R really doesn't like that creative solution.</p>\n"},{"tags":["r","regression","linear-regression"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":125,"score":2,"question_id":13100532,"title":"Fast way of evaluating a formula?","body":"<p>I'm using either dyn or dynlm to predict time series using lagged variables.</p>\n\n<p>However, the predict function in either case only evaluates one time step at a time, taking a constant time of 24 milliseconds per step on my computer, or about 1.8 hours for my dataset, which is super long, given that the entire regression takes about 10 seconds.</p>\n\n<p>So, I'm thinking that perhaps the fastest thing might be just to evaluate the formula by hand?</p>\n\n<p>So, is there some way of evaluating a formula given values in a data.frame or the current envrironment or similar?</p>\n\n<p>I'm thinking of something along the lines of:</p>\n\n<pre><code>evalMagic( load ~ temperature + time, data.frame( temperature = 10, time = 4 ) )\n</code></pre>\n\n<p>I suppose, as I write this, that we need to handle the coefficients somehow, something like:</p>\n\n<pre><code>evalMagic( load ~ temperature + time, data.frame( temperature = 10, time = 4 ), model$coefficients )\n</code></pre>\n\n<p>.... so this raises the questions of:</p>\n\n<ul>\n<li>isn't this what predict is supposed to do?</li>\n<li>why is predict so slow?</li>\n<li>what options do I have to make the prediction a bit faster?  After all, it's not inverting any matrices or something, it's just a bit of arithmetic!</li>\n</ul>\n"},{"tags":["json","r","web-scraping"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":13004813,"title":"Downloading JSON data into R","body":"<p>I need to:</p>\n\n<ol>\n<li><p>Download a parsed file of all the company names provided by <a href=\"http://api.crunchbase.com/v/1/companies.js\" rel=\"nofollow\">http://api.crunchbase.com/v/1/companies.js</a></p></li>\n<li><p>Run a query using each company name to download a parsed file of each company's information (e.g. Founded_year, funder company name), using the syntax 'http://api.crunchbase.com/v/1/company/<em>permalink</em>.js'</p></li>\n</ol>\n\n<p>I would like to parse this data into a spreadsheet or some other format that I can then import into R for analysis.</p>\n\n<p>What is the best format to import this data into R? How can I download the data and organize it into a table-like structure? (e.g. Row = company, columns = profile information like funded_year) (with the ultimate goal of analyzing it in R)</p>\n"},{"tags":["performance","json","r"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":484,"score":4,"question_id":5185990,"title":"Efficient alternative to merge() when building dataframe from json files with R?","body":"<p>I have written the following code which works, but is painfully slow once I start executing it over thousands of records:</p>\n\n<pre><code>require(\"RJSONIO\")\npeople_data &lt;- data.frame(person_id=numeric(0))\n\njson_data &lt;- fromJSON(json_file)\nn_people &lt;- length(json_data)\nfor(person in 1:n_people) {\n        person_dataframe &lt;- as.data.frame(t(unlist(json_data[[person]])))\n        people_data &lt;- merge(people_data, person_dataframe, all=TRUE)\n    }\n\noutput_file &lt;- paste(\"people_data\",\".csv\")\nwrite.csv(people_data, file=output_file)\n</code></pre>\n\n<p>I am attempting to build a unified data table from a series of json-formated files. The <code>fromJSON()</code> function reads in the data as lists of lists. Each element of the list is a person, which then contains a list of the attributes for that person.</p>\n\n<p>For example:</p>\n\n<pre><code>[[1]]\n    person_id\n    name\n    gender\n    hair_color\n[[2]]\n    person_id\n    name\n    location\n    gender\n    height\n\n[[...]]\n\nstructure(list(person_id = \"Amy123\", name = \"Amy\", gender = \"F\",\n               hair_color = \"brown\"), \n          .Names = c(\"person_id\", \"name\", \"gender\", \"hair_color\"))\n\nstructure(list(person_id = \"matt53\", name = \"Matt\", \n               location = structure(c(47231, \"IN\"), \n                                    .Names = c(\"zip_code\", \"state\")), \n               gender = \"M\", height = 172), \n          .Names = c(\"person_id\", \"name\", \"location\", \"gender\", \"height\"))\n</code></pre>\n\n<p>The end result of the code above is matrix where the columns are every person-attribute that appears in the structure above, and the rows are the relevant values for each person. As you can see though, some data is missing for some of the people, so I need to ensure those show up as <code>NA</code> and make sure things end up in the right columns. Further, <code>location</code> itself is a vector with two components: <code>state</code> and <code>zip_code</code>, meaning it needs to be flattened to <code>location.state</code> and <code>location.zip_code</code> before it can be merged with another person record; this is what I use <code>unlist()</code> for. I then keep the running master table in <code>people_data</code>.</p>\n\n<p>The above code works, but do you know of a more efficient way to accomplish what I'm trying to do? It appears the <code>merge()</code> is slowing this to a crawl... I have hundreds of files with hundreds of people in each file.</p>\n\n<p>Thanks!\nBryan</p>\n\n<p>UPDATE:\nBased on the feedback below, I tried to build a list of all the people, and then convert it all at one time into a dataframe. I let it run overnight and still didn't finish making the dataframe. There are around 1/2 million people in the list. That codes looks like this:</p>\n\n<pre><code>require(\"RJSONIO\")\nrequire(\"plyr\")\npeople_data &lt;- data.frame(person_id=numeric(0))\npeople_list &lt;- list()\n\njson_data &lt;- fromJSON(json_file)\nn_people &lt;- length(json_data)\nfor(person in 1:n_people) {\n        people_list[[person]] &lt;- t(unlist(json_data[[person]]))\n    }\n\n#PROBLEM CODE, SLOW, 1/2 million records in people_list\npeople_data &lt;- rbind.fill(lapply(people_list, as.data.frame))\n\noutput_file &lt;- paste(\"people_data\",\".csv\")\nwrite.csv(people_data, file=output_file)\n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13104631,"title":"why can't I use element_text() in an ifelse()?","body":"<p>How come I can't return an element_text()</p>\n\n<pre><code>&gt; ifelse(TRUE,element_text(size=20),element_text(size=10))\n[[1]]\nNULL\n</code></pre>\n\n<p>but I can do this?</p>\n\n<pre><code>&gt; element_text(size=20)\nList of 8\n $ family    : NULL\n $ face      : NULL\n $ colour    : NULL\n $ size      : num 20\n $ hjust     : NULL\n $ vjust     : NULL\n $ angle     : NULL\n $ lineheight: NULL\n - attr(*, \"class\")= chr [1:2] \"element\" \"element_text\"\n</code></pre>\n"},{"tags":["r","bounds","ggplot"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":47,"score":4,"question_id":13103766,"title":"set minimum limit for violin plot ggplot","body":"<p>I'd like to set the minimum bounds for a violin plot, similar to this question: <a href=\"http://stackoverflow.com/questions/11214012/set-only-lower-bound-of-a-limit-for-ggplot\">set only lower bound of a limit for ggplot</a></p>\n\n<p>For this:</p>\n\n<pre><code>p &lt;- ggplot(somedf, aes(factor(user1), pq)) + aes(ymin = -50)\np + geom_violin(aes(fill = user1))+ aes(ymin=-50)\n</code></pre>\n\n<p>I've tried adding </p>\n\n<pre><code>+ expand_limits(y=-50)\n</code></pre>\n\n<p>and </p>\n\n<pre><code>+ aes(ymin = -50)\n</code></pre>\n\n<p>to set lower bounds with no effect. </p>\n\n<p>Here's a sample dataframe that results in the same problem:</p>\n\n<pre><code>structure(list(pq = c(-20L, -12L, 10L, -13L, 11L, -16L), time = c(1214.1333, \n1214.1833, 1214.2667, 1214.2833, 1214.35, 1214.5167), pq.1 = c(-20L, \n-12L, 10L, -13L, 11L, -16L), time.1 = c(1214.1333, 1214.1833, \n1214.2667, 1214.2833, 1214.35, 1214.5167), time.2 = c(1214.1333, \n1214.1833, 1214.2667, 1214.2833, 1214.35, 1214.5167), pq.2 = c(-20L, \n-12L, 10L, -13L, 11L, -16L), user1 = structure(c(1L, 1L, 2L, \n1L, 2L, 1L), .Label = c(\"someguy3\", \"someguy4\", \"someguy6\", \"someguy4\", \n\"someguy5\", \"someguy6\"), class = \"factor\"), pq.3 = c(-20L, -12L, 10L, \n-13L, 11L, -16L), time.3 = c(1214.1333, 1214.1833, 1214.2667, \n1214.2833, 1214.35, 1214.5167), user1.1 = structure(c(1L, 1L, \n2L, 1L, 2L, 1L), .Label = c(\"someguy3\", \"someguy4\", \"someguy6\", \n\"someguy4\", \"someguy5\", \"someguy6\"), class = \"factor\")), .Names = c(\"pq\", \n\"time\", \"pq.1\", \"time.1\", \"time.2\", \"pq.2\", \"user1\", \"pq.3\", \n\"time.3\", \"user1.1\"), row.names = c(565L, 566L, 568L, 569L, 570L, \n574L), class = \"data.frame\")\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":64,"score":4,"question_id":13103579,"title":"How can I restructure and collapse a data set?","body":"<p>I have a data set that looks something like this:</p>\n\n<pre><code>0 Var1 Var 2 Var3 Var4\n1 2|1\n2 1|2\n3            1|2\n4            2|1\n5                  2|1\n6                  2|1\n7       1|2\n8       1|2\n</code></pre>\n\n<p>I would like to collapse to the left so as to make it look something like this:</p>\n\n<pre><code>0 G.F  G.F.1\n1 2|1  Var1\n2 1|2  Var1\n3 1|2  Var2\n4 2|1  Var2\n5 2|1  Var3\n6 2|1  Var3\n7 1|2  Var4\n8 1|2  Var4\n</code></pre>\n\n<p>I have a general idea involving the reshape package, but as of yet have not found an elegant solution.</p>\n"},{"tags":["r","logging","webmin"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":47,"score":0,"question_id":13096418,"title":"How do I parse webserver log using R?","body":"<p>which is the best way to parse a log file like this using R?</p>\n\n<pre><code>- - - [20/Nov/2011:01:16:29 +0100] \"POST /csw/servlet/cswservlet HTTP/1.1\" 200 279\n- - - [20/Nov/2011:01:16:29 +0100] \"GET /DescargaFenomenos/index.jsp HTTP/1.1\" 200 11769\n- - - [20/Nov/2011:01:16:29 +0100] \"GET /IDEE-ServicesSearch/ServicesSearch.html?locale=es HTTP/1.1\" 200 1665\n- - - [20/Nov/2011:01:16:29 +0100] \"GET /search/indexLayout.jsp?PAGELANGUAGE=es HTTP/1.1\" 200 9874\n- - - [20/Nov/2011:01:16:29 +0100] \"GET /clientesIGN/wmsGenericClient/index.html?lang=ES HTTP/1.1\" 200 12058\n- - - [20/Nov/2011:01:16:30 +0100] \"POST /csw/servlet/cswservlet HTTP/1.1\" 200 258038\n- - - [20/Nov/2011:01:17:09 +0100] \"GET //DescargaFenomenos/index.jsp HTTP/1.1\" 200 11769\n- - - [20/Nov/2011:01:17:33 +0100] \"GET //DescargaFenomenos/index.jsp HTTP/1.1\" 200 11769\n- - - [20/Nov/2011:01:17:33 +0100] \"GET //show.do?to=pideep_pidee.ES HTTP/1.1\" 200 26647\n192.168.69.10, 62.97.81.202 - - [20/Nov/2011:01:17:34 +0100] \"POST /csw/?locale=es HTTP/1.0\" 200 2536\n192.168.69.10, 62.97.81.202 - - [20/Nov/2011:01:17:34 +0100] \"GET /DescargaFenomenos/index.jsp HTTP/1.0\" 200 11769\n192.168.69.10, 62.97.81.202 - - [20/Nov/2011:01:17:34 +0100] \"GET /clientesIGN/wmsGenericClient/index.html?lang=ES HTTP/1.0\" 200 12058\n- - - [20/Nov/2011:01:17:39 +0100] \"GET //csw/servlet/cswservlet?request=GetCapabilities&amp;service=CSW&amp;version=2.0.2 HTTP/1.1\" 200 8867\n- - - [20/Nov/2011:01:17:46 +0100] \"GET //csw/servlet/cswservlet?request=GetCapabilities&amp;service=CSW&amp;version=2.0.2 HTTP/1.1\" 200 8867\n- - - [20/Nov/2011:01:18:10 +0100] \"GET //show.do?to=pideep_pidee.ES HTTP/1.1\" 200 26647\n- - - [20/Nov/2011:01:19:01 +0100] \"GET //DescargaFenomenos/index.jsp HTTP/1.1\" 200 11769\n</code></pre>\n\n<p>I must consider border cases like having 2 IP's in a single line (internal and external).</p>\n\n<p>Thanks!</p>\n"},{"tags":["r","gis","plyr","shapefile"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13073362,"title":"Apply a function over many shapefiles","body":"<p>I want to apply a function, either one that I have written, or one from a package such as the <code>gArea</code> function (e.g. <code>gArea('shapefile')</code>) from the <code>rgeos</code> package, across a list of shapefiles that I have imported. </p>\n\n<p>I imported the files like this:</p>\n\n<pre><code>data &lt;- list.files (getwd() , pattern=\"shp\") \n</code></pre>\n\n<p>I have tried using methods using functions such as <code>lapply</code> etc once I have tried amalgamating the files by using <code>as.list</code>, <code>as.data.frame</code> etc but with no luck. Functions applied to single imported shapefiles work fine, but obviously no good for serioues throughput.</p>\n\n<p>Thoughts? </p>\n"},{"tags":["r","translation","knitr"],"answer_count":1,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":89,"score":9,"question_id":12931594,"title":"What is a good localization strategy for knitr reports?","body":"<p>I would like to create aggregation reports based on <code>ggplot2</code> and <code>knitr</code>. Unfortunately I want to do it in four languages, namely English, German, French, Italian. So far labels for plots and figures are basically coming from data itself, i.e. they are generated from <code>data.frame headers</code> or <code>factor levels</code>. </p>\n\n<p>Given that I have more than 100 categorical variables with different <code>levels</code> I wonder what an efficient translation strategy might be. There's .po files and <a href=\"http://www.poedit.net\">Portable Object editors</a> for other languages and even for R and its messages itself. Given that the number of languages might be increased it becomes more likely that other persons need to be involved for translation. Obviously these persons are typically no R users and might not even like text editors. </p>\n\n<p>Has anybody faced the same problem and has developed some good strategy or experience to share? Could you imagine something <a href=\"http://en.wikipedia.org/wiki/XLIFF\">xliff</a> like?</p>\n\n<p>EDIT: I have seen <a href=\"http://stackoverflow.com/questions/10765057/translation-of-r-script-using-gettext\">this thread</a> in the meantime but I believe gettext does only work for packages. I wonder if the domain in this post is really valid.</p>\n"},{"tags":["r","memory-management","row","extract","condition"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13103035,"title":"error when trying to extract row from a table with a condition in R","body":"<p>What I am trying to select the rows that have <strong>the same gene_id</strong>, but have the <strong>minimum value of the start coordinates: href_pos$start.</strong> Why do I get this error, even though I have a memory limit of ~ 16Gb?  Or what am I doing wrong?  I have the following code:<br/></p>\n\n<blockquote>\n  <p>head(href_pos, 5)<br/></p>\n</blockquote>\n\n<pre><code>    chr      region    start      end strand nu   gene_id\n1  chr1 start_codon 67000042 67000044      +  . NM_032291\n2  chr1         CDS 67000042 67000051      +  0 NM_032291\n3  chr1        exon 66999825 67000051      +  . NM_032291\n4  chr1         CDS 67091530 67091593      +  2 NM_032291\n5  chr1        exon 67091530 67091593      +  . NM_032291\n</code></pre>\n\n<blockquote>\n  <p>d1 &lt;- ddply(as.data.frame(href_pos), \"gene_id\", function(href_pos) href_pos[which.min(href_pos$start), ])<br/>\n      Error: cannot allocate vector of size 283 Kb \n      In addition: Warning messages:<br/>\n      1: In lapply(dfs, function(df) levels(df[[var]])) :\n        Reached total allocation of 16383Mb: see help(memory.size)<br/></p>\n</blockquote>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13103211,"title":"Default values for lambda in Sparse Group Lasso(SGL) in R?","body":"<p>How are lambdas chosen by the SGL package if left blank? I am referring to the comment below in the pdf manual.</p>\n\n<blockquote>\n  <p>\"A user speciﬁed sequence of lambda values for ﬁtting. We recommend\n  leaving this NULL and letting SGL self-select values.\"</p>\n</blockquote>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13103172,"title":"R throw NA on error","body":"<p>Supposing I want to turn the character \"6000\" into an integer. I could do it with</p>\n\n<pre><code>as.integer(6000)\n</code></pre>\n\n<p>However, let's say that the user input was \"6***\". This gives me an error. How do I convert </p>\n\n<pre><code>as.integer(6***) \n</code></pre>\n\n<p>into NA. </p>\n"},{"tags":["r","emacs","latex","dot-emacs"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":378,"score":5,"question_id":2738322,"title":"What is a simple way to combine two Emacs major modes, or to change an existing mode?","body":"<p>In Emacs, I'm working with a file that is a hybrid of two languages.</p>\n\n<p><strong>Question 1: Is there a simple way to write a major mode file that combines two major modes?</strong></p>\n\n<p>Details:</p>\n\n<ul>\n<li><p>The language is called \"brew\" (not the \"BREW\" of \"Binary Runtime Environment for Wireless\").</p></li>\n<li><p>brew is made up of the languages R and Latex, whose modes are R-mode and latex-mode.</p></li>\n<li><p>The R code appears between the tags &lt;% and %>. Everything else is Latex.</p></li>\n<li><p>How can I write a brew-mode.el file? (Or is one already available?)</p></li>\n</ul>\n\n<p>One idea, which I got from this <a href=\"http://mail-archives.apache.org/mod_mbox/perl-modperl/200002.mbox/%3CNDBBIDIMBKMLMLLCGCNAEEFPCBAA.jreid@ocireland.com%3E\" rel=\"nofollow\">posting</a>, is to use Latex mode, and treat the code of the form  &lt;% ... %> as a comment.</p>\n"},{"tags":["r","3d","scatter-plot"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13103099,"title":"saving rotatable graph in r function scatter3d","body":"<p>I have been using the r function scatter3d() to create graphs and can save them as snapshots for publishing purposes but was wondering if there is a way to save the interactive graph for presentation purposes. </p>\n\n<p>thanks</p>\n"},{"tags":["r","time-series","cross-correlation"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13102606,"title":"R with Lookup Table","body":"<p>I have two files which contain time series in this format:</p>\n\n<pre><code>Tag, T1, T2, ...  Tn\nStock-1, 2, 3, ..  6\nStock-2, 3, 2, ..  7\n.\n.\nStock-m, 2, 1, ..  9\n</code></pre>\n\n<p>In R, for any tag (ex. Stock-x) I want to take related arrays from both files and calculate cross correlation(ccf) for them. How I can do that ?</p>\n\n<p>Note: If it would be easier, I can change the file format.</p>\n\n<p>Update:</p>\n\n<p>I read from file into data.frames with this: </p>\n\n<pre><code>file1 = read.table(\"file1.txt\", header = TRUE, sep = \",\")\n</code></pre>\n\n<p>How will I reach to specific rows with Tag name such as \"Stock-5\" ?</p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":97,"score":4,"question_id":13096582,"title":"Zero divison in R","body":"<p>Is there an easy way of avoiding 0 division error in R. Specifically,</p>\n\n<pre><code>a &lt;- c(1,0,2,0)\nb &lt;- c(3,2,1,0)\nsum(b/a)\n</code></pre>\n\n<p>This code gives an error due to division by zero. \nI would like a way to define anything/0 = 0 so that this kind of operation would still be valid.</p>\n"},{"tags":["r","sample"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":234,"score":1,"question_id":2682514,"title":"mlbench example","body":"<p>I heard R is the \"de facto\" language amongst statistical software developers, and I'm giving it a try. I already know the basics, but it still looks \"weird\" to me (a C developer). I think it would be very useful to see a working example to see how a real R program is built.\nI thought that an R solution for any of the mlbench problems would be optimal, because I'm already familiar with it and it would allow me to compare it to other languages, but any other \"toy problem\" example is welcome.</p>\n\n<p>The <code>mlbench</code> package is pointed out in the answers below, but it seems that it provides only sample data and functions to generate sample data, with the exception of a generic bayes classifier. I'm searching for solutions of any of the mlbench data problems (DNA, Glass, Ionosphere, etc.). Maybe I'm missing something?</p>\n"},{"tags":["r","s4","slots","wavelet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13099780,"title":"How to access the slots of an S4 object in R","body":"<p>I'm working with wavelets on a program and I'm used the package <code>wavelets</code> to create the DWT of a time series using the function <code>dwt</code>. This function returns an object of class <code>dwt</code>, which is a S4 object with many slots: <code>W</code>, <code>V</code>, <code>levels</code>, <code>filter</code>, and so on.</p>\n\n<p>How can I access the <code>W</code>'s as a vector?</p>\n"},{"tags":["r","graph","cumulative-sum"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":13098551,"title":"Creating a cumulative step graph in R","body":"<p>Say I have this example data frame</p>\n\n<pre><code>set.seed(12345)\nn1 &lt;- 3\nn2 &lt;- 10\nn3 &lt;- 60\n\ntimes &lt;- seq(0, 100, 0.5)\n\nindividual &lt;- c(rep(1, n1), \n                rep(2, n2), \n                rep(3, n3))\n\nevents &lt;- c(sort(sample(times, n1)),\n            sort(sample(times, n2)),\n            sort(sample(times, n3)))\n\ndf &lt;- data.frame(individual = individual, events = events)\n</code></pre>\n\n<p>Which gives</p>\n\n<pre><code>&gt; head(df, 10)\n   individual events\n1           1   72.0\n2           1   75.5\n3           1   87.5\n4           2    3.0\n5           2   14.5\n6           2   16.5\n7           2   32.0\n8           2   45.5\n9           2   50.0\n10          2   70.5\n</code></pre>\n\n<p>I would like to plot a cumulative step graph of the events so that I get one line per individual which goes up by 1 each time an event is \"encountered\".</p>\n\n<p>So, for instance individual 1 will be 0 up to 72.0, then go up to 1, until 75.5 when it becomes 2 and up to 3 at 87.5 to the end of the graph.</p>\n\n<p>What would be the easiest way to do that? </p>\n"},{"tags":["r","ggplot2","ggplot"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":13096195,"title":"Plotting monthly data with ggplot","body":"<p>I was trying to use ggplot to plot monthly data that looks like this</p>\n\n<pre>\n  count     date\n      6 Oct 2010\n     23 Nov 2010\n     20 Dec 2010\n     16 Jan 2011\n     64 Oct 2011\n     ...\n    425 Jul 2012\n    436 Aug 2012\n    405 Sep 2012\n</pre>\n\n<p>where date is of yearmon class from the zoo package.</p>\n\n<p>This was my call:</p>\n\n<pre><code>ggplot(data, aes(x=date, y=count))+geom_line()\n</code></pre>\n\n<p>and this error came up: Error: Discrete value supplied to continuous scale.</p>\n\n<p>So ggplot doesn't support the yearmon class, which is fine.</p>\n\n<p>Then I tried to convert yearmon to Date. Now the data looks like this:</p>\n\n<pre>\n count       date\n     6 2010-10-01\n    23 2010-11-01\n    20 2010-12-01\n    16 2011-01-01\n    64 2011-10-01\n   ...\n   425 2012-07-01\n   436 2012-08-01\n   405 2012-09-01\n</pre>\n\n<p>and I made the same call, and this was <a href=\"http://i.stack.imgur.com/BcLTw.png\" rel=\"nofollow\"> the resulting plot </a> (sorry about the href... new users aren't allowed to post images)</p>\n\n<p>There is a drop at the end of the plot that shouldn't be there, because data$count had the similar values on the last few rows.</p>\n\n<p>Does anyone have a good solution to this?</p>\n\n<p>Thanks for reading,</p>\n\n<p>Bill</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":13096787,"title":"Adding lagged variables to an lm model?","body":"<p>I'm using lm on a time series, which works quite well actually, and it's super super fast.</p>\n\n<p>Let's say my model is:</p>\n\n<pre><code>&gt; formula &lt;- y ~ x\n</code></pre>\n\n<p>I train this on a training set:</p>\n\n<pre><code>&gt; train &lt;- data.frame( x = seq(1,3), y = c(2,1,4) )\n&gt; model &lt;- lm( formula, train )\n</code></pre>\n\n<p>... and I can make predictions for new data:</p>\n\n<pre><code>&gt; test &lt;- data.frame( x = seq(4,6) )\n&gt; test$y &lt;- predict( model, newdata = test )\n&gt; test\n  x        y\n1 4 4.333333\n2 5 5.333333\n3 6 6.333333\n</code></pre>\n\n<p>This works super nicely, and it's really speedy.</p>\n\n<p>I want to add lagged variables to the model.  Now, I could do this by augmenting my original training set:</p>\n\n<pre><code>&gt; train$y_1 &lt;- c(0,train$y[1:nrow(train)-1])\n&gt; train\n  x y y_1\n1 1 2   0\n2 2 1   2\n3 3 4   1\n</code></pre>\n\n<p>update the formula:</p>\n\n<pre><code>formula &lt;- y ~ x * y_1\n</code></pre>\n\n<p>... and training will work just fine:</p>\n\n<pre><code>&gt; model &lt;- lm( formula, train )\n&gt; # no errors here\n</code></pre>\n\n<p>However, the problem is that there is no way of using 'predict', because there is no way of populating y_1 in a test set in a batch manner.</p>\n\n<p>Now, for lots of other regression things, there are very convenient ways to express them in the formula, such as <code>poly(x,2)</code> and so on, and these work directly using the unmodified training and test data.</p>\n\n<p>So, I'm wondering if there is some way of expressing lagged variables in the formula, so that <code>predict</code> can be used?  Ideally:</p>\n\n<pre><code>formula &lt;- y ~ x * lag(y,-1)\nmodel &lt;- lm( formula, train )\ntest$y &lt;- predict( model, newdata = test )\n</code></pre>\n\n<p>... without having to augment (not sure if that's the right word) the training and test datasets, and just being able to use <code>predict</code> directly?</p>\n"},{"tags":["r","ls"],"answer_count":6,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":91,"score":4,"question_id":13094324,"title":"Hiding function names from ls() results - to find a variable name more quickly","body":"<p>When we have defined tens of functions - probably to develop a new package - it is hard to find out the name of a specific variable among many function names through <code>ls()</code> command. </p>\n\n<p>In most of cases we are not looking for a function name - we already know they exist - but we want to find what was the name we assigned to a variable. </p>\n\n<p>Any idea to solve it is highly appreciated.</p>\n"},{"tags":["r","selection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":58,"score":0,"question_id":13088011,"title":"How to select just first elements in a row of the same values in R?","body":"<p>i have two vectors</p>\n\n<pre><code> x&lt;-c(1,1,1,2,2,2,3,3,4,5,5,6)\n y&lt;-c(\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\",\"j\",\"k\",\"l\")\n</code></pre>\n\n<p>I'd like to choose only those in y, which coincide with the first element in a sequence of equal values in x\nSo, in my case the final solution should be like this:</p>\n\n<pre><code>    y x\n 1  a 1\n 4  d 2\n 7  g 3\n 9  i 4\n 10 j 5\n 12 l 6\n</code></pre>\n\n<p>We wrote a script and it works but need to add and delete additional rows (to use cbind later) which is mess for me.</p>\n\n<pre><code>aaa&lt;-data.frame(y,x)\ndf&lt;-NULL\nfor (i in 2:length(aaa$x)){   # you may see it stars from the second element because \n                               # of x[i-1]\n   bbb&lt;-ifelse((aaa$x[i]!= aaa$x[i-1]), aaa$x[i], NA)\n     df&lt;-rbind(df,bbb)\n}\ndf\ndf&lt;-rbind(1,df)\naaa$x&lt;-df[,1]\nbbb&lt;-na.omit(aaa)\nbbb\n</code></pre>\n\n<p>I have tried to apply rle() as it was recommended me earlier <a href=\"http://stackoverflow.com/questions/12790378/how-to-choose-non-interruped-numbers-only\">How to choose non-interruped numbers only?</a>\nbut failed in this case.</p>\n\n<p>would love to hear your recommendation,</p>\n\n<p>thank you.</p>\n"},{"tags":["regex","r"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":13099068,"title":"R regex matching","body":"<p>I'm stuck on a regex problem. I want to match things that are not a whitespace or a newline.</p>\n\n<p>Not whitespace is simply: </p>\n\n<pre><code>[^ ]\n</code></pre>\n\n<p>does not mean not whitespace or newline is:</p>\n\n<pre><code>[^( |\\n)]\n</code></pre>\n"},{"tags":["r","ggplot2","heatmap"],"answer_count":1,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":1744,"score":2,"question_id":8406394,"title":"How to produce a heatmap with ggplot2?","body":"<p>I am trying to produce a heat map using ggplot2. I found <a href=\"http://learnr.wordpress.com/2010/01/26/ggplot2-quick-heatmap-plotting/\" rel=\"nofollow\">this example</a>, which I am essentially trying to replicate with my data, but I am having difficulty. My data is a simple .csv file that looks like this:</p>\n\n<pre><code>people,apple,orange,peach\nmike,1,0,6\nsue,0,0,1\nbill,3,3,1\nted,1,1,0\n</code></pre>\n\n<p>I would like to produce a simple heat map where the name of the fruit is on the x-axis and the person is on the y-axis. The graph should depict squares where the color of each square is a representation of the number of fruit consumed. The square corresponding to <code>mike:peach</code> should be the darkest. </p>\n\n<p>Here is the code I am using to try to produce the heatmap:</p>\n\n<pre><code>data &lt;- read.csv(\"/Users/bunsen/Desktop/fruit.txt\", head=TRUE, sep=\",\")\nfruit &lt;- c(apple,orange,peach)\npeople &lt;- data[,1]\n(p &lt;- ggplot(data, aes(fruit, people)) + geom_tile(aes(fill = rescale), colour = \"white\") +    scale_fill_gradient(low = \"white\", high = \"steelblue\"))\n</code></pre>\n\n<p>When I plot this data I get the number of fruit on the x-axis and people on the y-axis. I also do not get color gradients representing number of fruit. How can I get the names of the fruits on the x-axis with the number of fruit eaten by a person displayed as a heat map?\nThe current output I am getting in R looks like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/WxKx5.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":54,"score":1,"question_id":13097976,"title":"Finding the max value for each id, grouped by date","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13081821/how-to-speed-up-cummulative-sum-within-group\">How to speed up cummulative sum within group?</a>  </p>\n</blockquote>\n\n\n\n<p>In the following data frame</p>\n\n<pre><code>id&lt;-c(1,1,1,1,1,3,3,3,3)\nspent&lt;-c(10,20,30,40,50,60,70,80,90)\ndate&lt;-c(\"11-11-07\",\"11-11-07\",\"23-11-07\",\"12-12-08\",\"17-12-08\",\"11-11-07\",\"23-11-07\",\"23-       11-07\",\"16-01-08\")\ndf&lt;-data.frame(id,date,spent)\ndf$date2&lt;-as.Date(as.character(df$date), format = \"%d-%m-%y\")\n\n  id     date spent      date2\n1  1 11-11-07    10 2007-11-11\n2  1 11-11-07    20 2007-11-11\n3  1 23-11-07    30 2007-11-23\n4  1 12-12-08    40 2008-12-12\n5  1 17-12-08    50 2008-12-17\n6  3 11-11-07    60 2007-11-11\n7  3 23-11-07    70 2007-11-23\n8  3 23-11-07    80 2007-11-23\n9  3 16-01-08    90 2008-01-16\n</code></pre>\n\n<p>I need to find the maximum of <code>spent</code> for each <code>id</code> in each day and record in in a separate column as follow:</p>\n\n<pre><code>  id     date spent      date2   sum.spent\n1  1 11-11-07    10 2007-11-11    20\n2  1 11-11-07    20 2007-11-11    20 \n3  1 23-11-07    30 2007-11-23    30\n4  1 12-12-08    40 2008-12-12    40\n5  1 17-12-08    50 2008-12-17    50\n6  3 11-11-07    60 2007-11-11    60\n7  3 23-11-07    70 2007-11-23    80\n8  3 23-11-07    80 2007-11-23    80\n9  3 16-01-08    90 2008-01-16    90 \n</code></pre>\n\n<p>Can anyone help me with this? </p>\n"},{"tags":["java","r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13089356,"title":"Assigning an multi-dimensional array from Java to R through Rserve","body":"<p>I am using Java/R/Rserve for a project. I am facing the problem of transferring a multi-dimensional array from Java into R workspace for calculation. So far, the <code>assign</code> method of the <code>RConnection</code> object only allows the following to be passed: <code>byte[], double[], int[], REXP, String,and String[]</code>. </p>\n\n<p>I sidestepped this by creating a loop in Java, and passed the variables individually. Although this works, it looks ugly and inefficient. </p>\n\n<pre><code>RConnection c = new RConnection();\nc.eval(\"x &lt;- matrix(0,nrow=dimX[1],ncol=dimX[2])\");\nfor (int i = 0; i &lt; dimX[0]; i++){\n  c.assign(\"i\",Integer.toString(i+1));\n  c.eval(\"i &lt;- as.numeric(i)\");\n  for (int j = 0; j &lt; dimX[1]; j++){\n    c.assign(\"j\",Integer.toString(j+1));\nc.eval(\"j &lt;- as.numeric(j)\");\nc.assign(\"tmp\", Double.toString(XOBS[i][j]));\nc.eval(\"x[i,j] &lt;- as.numeric(tmp)\");\n  }             \n}\n</code></pre>\n\n<p>The document for Rserve on <a href=\"http://www.rforge.net/Rserve/dist/JRclient/JavaDoc/org/rosuda/JRclient/REXP.html\" rel=\"nofollow\">http://www.rforge.net/Rserve/dist/JRclient/JavaDoc/org/rosuda/JRclient/REXP.html</a> seems to be outdated, and the examples for Rserve are rather limited. Could anyone give me a suggestion on how to improve on this code?</p>\n\n<p>Thank you</p>\n"},{"tags":["r","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":38,"score":-2,"question_id":13085135,"title":"how to plot a bar chart with non-sorted x-axis (lattice)","body":"<p>My code are showed as follows:</p>\n\n<pre><code>read.table(\"GO.txt\",header=T,sep=',')-&gt;go\nlibrary(lattice)\nbarchart(go[,1]~go[,2],horiz=F,ylim=c(30,29666),\nlayout=c(1,1),stack=F,\nauto.key=list(space='right'),\nylab=\"Yes\",\nscales=list(x=list(rot=45),y=list(log = T)))\n</code></pre>\n\n<p>However, I don't want to plot a chart with sorted x, what should I do?\nThe lattice sorted my data which I don't need.</p>\n\n<p>data:</p>\n\n<pre><code>    number_of_A-Unigene Class   Ontology\n    45  biological adhesion biological_process\n    5328    biological regulation   biological_process\n    8   carbon utilization  biological_process\n    6   cell killing    biological_process\n    119 cell proliferation  biological_process\n    3248    cellular component organization or biogenesis   biological_process\n    16594   cellular process    biological_process\n    244 death   biological_process\n    4354    developmental process   biological_process\n    3547    establishment of localization   biological_process\n    917 growth  biological_process\n    429 immune system process   biological_process\n    3716    localization    biological_process\n    30  locomotion  biological_process\n    15726   metabolic process   biological_process\n    4182    multicellular organismal process    biological_process\n    1673    multi-organism process  biological_process\n    877 negative regulation of biological process   biological_process\n    10  nitrogen utilization    biological_process\n    11  pigmentation    biological_process\n    640 positive regulation of biological process   biological_process\n    4808    regulation of biological process    biological_process\n    2462    reproduction    biological_process\n    2437    reproductive process    biological_process\n    7812    response to stimulus    biological_process\n    190 rhythmic process    biological_process\n    2001    signaling   biological_process\n    2   sulfur utilization  biological_process\n    44  viral reproduction  biological_process\n    19852   cell    cellular_component\n    1763    cell junction   cellular_component\n    19852   cell part   cellular_component\n    31  extracellular matrix    cellular_component\n    9   extracellular matrix part   cellular_component\n    686 extracellular region    cellular_component\n    30  extracellular region part   cellular_component\n    3698    macromolecular complex  cellular_component\n    9829    membrane    cellular_component\n    3432    membrane part   cellular_component\n    1439    membrane-enclosed lumen cellular_component\n    15252   organelle   cellular_component\n    6024    organelle part  cellular_component\n    1753    symplast    cellular_component\n    216 antioxidant activity    molecular_function\n    15917   binding molecular_function\n    15103   catalytic activity  molecular_function\n    2   channel regulator activity  molecular_function\n    433 electron carrier activity   molecular_function\n    319 enzyme regulator activity   molecular_function\n    8   metallochaperone activity   molecular_function\n    522 molecular transducer activity   molecular_function\n    708 nucleic acid binding transcription factor activity  molecular_function\n    26  nutrient reservoir activity molecular_function\n    102 protein binding transcription factor activity   molecular_function\n    6   protein tag molecular_function\n    613 receptor activity   molecular_function\n    1039    structural molecule activity    molecular_function\n</code></pre>\n\n<p>5   translation regulator activity  molecular_function\n2478    transporter activity    molecular_function</p>\n"},{"tags":["r","sorting","axis","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13097966,"title":"how to use lattice to plot a bar chart without sorted x-axis？","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13085135/how-to-plot-a-bar-chart-with-non-sorted-x-axis-lattice\">how to plot a bar chart with non-sorted x-axis (lattice)</a>  </p>\n</blockquote>\n\n\n\n<p>I want to plot a barchart. But I don't know how to plot it with unsorted x-axis in lattice. By default, the lattice will sort my x data which I am not expected.</p>\n\n<p>my code are showed as follows:</p>\n\n<p>code:</p>\n\n<pre><code>go=data.frame(number_of_Unigene=c(45,5328,30,30,119,3248,16594,244,4354,3547,917,429,3716,30,15726,4182,1673,877,30,30,640,4808,2462,2437,7812,190,2001,30,44,19852,1763,19852,31,30,686,30,3698,9829,3432,1439,15252,6024,1753,216,15917,15103,30,433,319,30,522,708,30,102,30,613,1039,30,2478),class=c(\"biological adhesion\",\"biological regulation\",\"carbon utilization\",\"cell killing\",\"cell proliferation\",\"cellular component organization or biogenesis\",\"cellular process\",\"death\",\"developmental process\",\"establishment of localization\",\"growth\",\"immune system process\",\"localization\",\"locomotion\",\"metabolic process\",\"multicellular organismal process\",\"multi-organism process\",\"negative regulation of biological process\",\"nitrogen utilization\",\"pigmentation\",\"positive regulation of biological process\",\"regulation of biological process\",\"reproduction\",\"reproductive process\",\"response to stimulus\",\"rhythmic process\",\"signaling\",\"sulfur utilization\",\"viral reproduction\",\"cell\",\"cell junction\",\"cell part\",\"extracellular matrix\",\"extracellular matrix part\",\"extracellular region\",\"extracellular region part\",\"macromolecular complex\",\"membrane\",\"membrane part\",\"membrane-enclosed lumen\",\"organelle\",\"organelle part\",\"symplast\",\"antioxidant activity\",\"binding\",\"catalytic activity\",\"channel regulator activity\",\"electron carrier activity\",\"enzyme regulator activity\",\"metallochaperone activity\",\"molecular transducer activity\",\"nucleic acid binding transcription factor activity\",\"nutrient reservoir activity\",\"protein binding transcription factor activity\",\"protein tag\",\"receptor activity\",\"structural molecule activity\",\"translation regulator activity\",\"transporter activity\"),Ontology=c(\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"biological_process\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"cellular_component\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\",\"molecular_function\"))\n</code></pre>\n\n<p>next</p>\n\n<pre><code>library(lattice)\nbarchart(go[,1]~go[,2],horiz=F,ylim=c(30,29666),layout=c(1,1),stack=F,\nauto.key=list(space='right'),ylab=\"Number of unigenes\",\nscales=list(x=list(rot=45),y=list(log=T)))\n</code></pre>\n\n<p>What else should I do?</p>\n"},{"tags":["r","markdown","knitr"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":47,"score":3,"question_id":13095045,"title":"Outputing HTML code from inside R markdown","body":"<p>In my code I am checking a condition and I'd like R markdown to show an image when that condidtion is TRUE. Here is what I have </p>\n\n<pre><code>```{r}\nif (LOGICAL.Condition)\n  {\n     cat(\"&lt;img src='http://imgc.allpostersimages.com/images/P-473-488-90/60/6071/B4XD100Z/posters/now-stop-and-hammer-time.jpg'&gt;\")\n  }\n```\n</code></pre>\n\n<p>The output of R that shows up on my HTML page is a text as bellow but I want it to be an image</p>\n\n<pre><code>## &lt;img src='http://imgc.allpostersimages.com/images/P-473-488-90/60/6071/B4XD100Z/posters/now-stop-and-hammer-time.jpg'&gt;\n</code></pre>\n"},{"tags":["r","timezone","posix"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":853,"score":3,"question_id":6071155,"title":"How to extract the correct timezones from POSIXct and POSIXlt objects?","body":"<pre><code>&gt;time1 = as.POSIXlt(\"2010-07-01 16:00:00\", tz=\"Europe/London\")\n&gt;time1\n\"2010-07-01 16:00:00 Europe/London\"\n</code></pre>\n\n<p>but</p>\n\n<pre><code>&gt;time2 = as.POSIXct(\"2010-07-01 16:00:00\", tz=\"Europe/London\")\n&gt;time2\n\"2010-07-01 16:00:00 BST\"\n</code></pre>\n\n<p>Why is the timezone presented differently? It is important for me because I need to extract the time zones from my date.</p>\n\n<pre><code>&gt;base::format(time1, format=\"%Z\")\n\"BST\"\n&gt;base::format(time2, format=\"%Z\")\n\"BST\"\n</code></pre>\n\n<p>both give the same \"BST\" for British Saving Time!</p>\n\n<p>The issue is that \"BST\" does not seam to be recognized by POSIXct/POSIXlt format:</p>\n\n<pre><code>&gt; as.POSIXlt(\"2010-07-01 16:00:00\", tz=\"BST\")\n[1] \"2010-07-01 16:00:00 BST\"\nWarning messages:\n1: In strptime(xx, f &lt;- \"%Y-%m-%d %H:%M:%OS\", tz = tz) :\n  unknown timezone 'BST'\n2: In structure(xx, class = c(\"POSIXct\", \"POSIXt\"), tzone = tz) :\n  unknown timezone 'BST'\n3: In strptime(x, f, tz = tz) : unknown timezone 'BST'\n&gt; as.POSIXct(\"2010-07-01 16:00:00\", tz=\"BST\")\n[1] \"2010-07-01 16:00:00 GMT\"\nWarning messages:\n1: In strptime(xx, f &lt;- \"%Y-%m-%d %H:%M:%OS\", tz = tz) :\n  unknown timezone 'BST'\n2: In structure(xx, class = c(\"POSIXct\", \"POSIXt\"), tzone = tz) :\n  unknown timezone 'BST'\n3: In strptime(x, f, tz = tz) : unknown timezone 'BST'\n4: In structure(xx, class = c(\"POSIXct\", \"POSIXt\"), tzone = tz) :\n  unknown timezone 'BST'\n5: In as.POSIXlt.POSIXct(x, tz) : unknown timezone 'BST'\n</code></pre>\n\n<p>I am really confused. \nI have 2 questions:</p>\n\n<p><strong>1/ What is the difference between POSIXct and POSIXlt formats</strong></p>\n\n<p><strong>2/ Any one knows what time zone I can use?</strong></p>\n\n<p><strong>\"Europe/London\"</strong> works with POSIXlt but not POSIXct. Plus it cannot be extracted from a time using base::format<br>\n<strong>\"BST\"</strong> is not recognized as a valid timezone in as.POSIXct or as.POSIXlt functions.</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":12831222,"title":"Trying to use gglocator in ggplot2: Error in vpPathFromVector(names)","body":"<p>I'm trying to use the gglocator function in <code>ggmap</code>. I get the following error:</p>\n\n<pre><code>Error in vpPathFromVector(names) : \nA viewport path must contain at least one viewport name\n</code></pre>\n\n<p>I found it when trying to use gglocator with ggmaps, but the same error happens with ggplot2 alone. Here is an example of how it would come up:</p>\n\n<pre><code>library(ggplot2)\nlibrary(ggmap)\ndf &lt;- data.frame(xvar = 1:10, yvar = 1:10)\nqplot(xvar, yvar, data = df) + annotate(geom = 'point', x = 3, y = 6)\ngglocator(4)\n\nError in vpPathFromVector(names) : \nA viewport path must contain at least one viewport name\n</code></pre>\n\n<p>I'm using RStudio v 0.96.331 on Windows 7. I have the latest version of ggplot2.</p>\n"},{"tags":["r","linear-regression"],"answer_count":1,"favorite_count":6,"up_vote_count":16,"down_vote_count":0,"view_count":155,"score":16,"question_id":12967797,"title":"Is there a better alternative than string manipulation to programmatically build formulas?","body":"<p>Everyone else's functions seem to take formula objects and then do dark magic to them somewhere deep inside and I'm jealous. </p>\n\n<p>I'm writing a function that fits multiple models. Parts of the formulas for these models remain the same and part change from one model to the next. The clumsy way would be to have the user input the formula parts as character strings, do some character manipulation on them, and then use <code>as.formula</code>.</p>\n\n<p>But before I go that route, I just want to make sure that I'm not overlooking some cleaner way of doing it that would allow the function to accept formulas in the standard R format (e.g. extracted from other formula-using objects).</p>\n\n<p>I want something like...</p>\n\n<pre><code>&gt; LHS &lt;- y~1; RHS &lt;- ~a+b; c(LHS,RHS);\ny ~ a + b\n&gt; RHS2 &lt;- ~c;\n&gt; c(LHS, RHS, RHS2);\ny ~ a + b + c\n</code></pre>\n\n<p>or...</p>\n\n<pre><code>&gt; LHS + RHS;\ny ~ a + b\n&gt; LHS + RHS + RHS2;\ny ~ a + b + c\n</code></pre>\n\n<p>...but unfortunately neither syntax works. Does anybody know if there is something that does? Thanks.</p>\n"},{"tags":["r","data.frame","data.table"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13092541,"title":"comparing mean to specific data value in R","body":"<p>I have a data frame like this:</p>\n\n<pre><code>Date     Process Duration\n1/1/2012 xnit     10\n1/1/2012 xnit     15\n1/1/2012 xnit     20\n1/2/2012 telnet   80\n1/2/2012 telnet   50\n1/2/2012 telnet   40\n8/1/2012 ftp      3\n8/1/2012 ftp      11\n8/1/2012 ftp     12\n</code></pre>\n\n<p>After converint to x&lt;-data.table(x): </p>\n\n<p>I can calculate the mean for each job as this:</p>\n\n<pre><code>x&lt;-x[, mean := mean(Duration), by = Process]\n</code></pre>\n\n<p>I like to compare the duration for a particular date Duration to the mean. I tried this:</p>\n\n<pre><code>x&lt;-x[, Aug1 := subset(x, Date==as.Date(c(\"2012-08-01\")))$Duration, by = Process]\n</code></pre>\n\n<p>Once I get this value, I was going to compare the Aug1 column against mean for each process to look at the outliers. However, this command is taking a very long time to complete. Is there a better way to do this?</p>\n"},{"tags":["perl","r"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":306,"score":5,"question_id":8721521,"title":"Perl Statistics::R generates blank plot image (jpeg)","body":"<p>I am currently using ActiveState Perl 5.14 and the R project version 2.13.2. Within Perl I am using Statistics::R version 0.08. According to ActiveState the more recent versions of <code>Statistics::R</code> (through 0.24) failed to pass scrutiny and are therefore not available through the PPM.</p>\n\n<p>History: I have been successfully using Perl to access R for some time to perform analysis. Now I want to generate JPEG images of the results of the analysis for easy visualization.</p>\n\n<p>Here's the problem: I can generate the images successfully from within the R console. However, when I run the same commands through Perl I only get a blank image. My console code includes (simplified, of course):</p>\n\n<pre><code>  x&lt;-c(1,2,3,4,5)\n  y&lt;-c(5,4,3,2,1)\n  jpeg(\"C:/temp.jpg\")\n  plot(x,y)\n  dev.off()\n</code></pre>\n\n<p>And my Perl commands include (also simplified):<BR></p>\n\n<pre><code>   $R = Statistics::R-&gt;new();\n   $R-&gt;start_sharedR\n   $R-&gt;send(\"x&lt;-c(1,2,3,4,5)\");\n   $R-&gt;send(\"y&lt;-c(5,4,3,2,1)\");\n   $R-&gt;send('jpeg(\"C:/temp.jpg\")');\n   $R-&gt;send(\"plot(x,y)\");\n   $R-&gt;send(\"dev.off()\");\n</code></pre>\n\n<p>Any suggestions? I know that there are other plotting options accessible to Perl. I have eliminated some (GD Graph) because X-axis data is not treated as numeric. I'd prefer to keep it in R if at all possible since I'm already interacting in that package for the analysis. Thanks!</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13093954,"title":"using ggpairs with NA-continaing data","body":"<p><code>ggpairs</code> in the <code>GGally</code> package seems pretty useful, but it appears to fail when there <code>NA</code> is present anywhere in the data set:</p>\n\n<pre><code>#require(GGally)\ndata(tips, package=\"reshape\")\npm &lt;- ggpairs(tips[,1:3]) #works just fine\n\n#introduce NA\ntips[1,1] &lt;- NA\nggpairs(tips[,1:3])\n&gt; Error in if (lims[1] &gt; lims[2]) { : missing value where TRUE/FALSE needed\n</code></pre>\n\n<p>I don't see any documentation for dealing with <code>NA</code> values, and solutions like <code>ggpairs(tips[,1:3], na.rm=TRUE)</code> (unsurprisingly) don't change the error message.</p>\n\n<p>I have a data set in which perhaps 10% of values are <code>NA</code>, randomly scattered throughout the dataset. Therefore <code>na.omit(myDataSet)</code> will remove much of the data. Is there any way around this?</p>\n"},{"tags":["r","terminal","customization","rprofile"],"answer_count":24,"favorite_count":85,"up_vote_count":79,"down_vote_count":0,"view_count":12178,"score":79,"question_id":1189759,"title":"Expert R users, what's in your .Rprofile?","body":"<p>This question is maybe a little too cute, but I have always found startup profile files of other people both useful and instructive about the language. Moreover, while I have some customization for bash and vim, I have nothing for R. For example, one thing I always wanted is different colors for input and output text in a window terminal, and maybe even syntax highlighting.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13092923,"title":"Looping Cox regression model over several predictor variables","body":"<p>I need to run cox regression model for several variables, so I want write a loop to realize it.\nBut it doesn't work anyway.\nBelow is my code used</p>\n\n<pre><code>names(Gen) \nvarlist &lt;- names(hsb2)[8:11]  ## get the variables i want to involve in loop\nmodels &lt;- lapply(varlist, function(x) {\n    coxph(substitute(Surv(Time, Status) ~ i, list(i = as.name(x))), data = Gen, ties=\"efron\")\n})\n</code></pre>\n\n<p>I got the error information as </p>\n\n<pre><code>errors in terms.default(formula, special, data = data) : \n  no terms component nor attribute\n</code></pre>\n\n<p>Any one has the idea of how to solve this problem or how to write the codes?</p>\n"},{"tags":["r","markdown","knitr"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":78,"score":2,"question_id":13095772,"title":"Custom CSS with knitr and markdown in R","body":"<p>I found this great tutorial on how to modify the css formatting of a HTML report created with markdown and knitr in Rstudio.  The post can be found <a href=\"http://nsaunders.wordpress.com/2012/08/27/custom-css-for-html-generated-using-rstudio/\" rel=\"nofollow\">here</a>.</p>\n\n<p>I was hoping to build on this concept and mimic the layout of the page <a href=\"http://www.seas.harvard.edu/courses/cs281/\" rel=\"nofollow\">here</a> by using the same css. I tried to simply copy/paste/combine the two css files I found when I viewed the page's source.</p>\n\n<p>Any help you can lend would be greatly appreciated!  This is my first attempt and doing anything CSS. </p>\n"},{"tags":["r","heatmap"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":66,"score":0,"question_id":13087555,"title":"heatmap in R how to resize columns labels?","body":"<p>I have a data.matrix that is approximately 4000 rows and 100 columns. I am doing a heatmap of the data like:</p>\n\n<pre><code>data&lt;-heatmap(data_matrix,Rowv=NA,Colv=NA,col=cm.colors(256),scale=\"column\",margins=c(5,10))\n</code></pre>\n\n<p>But the problem that I got is that the labels that appear in the column are too grouped, so it is impossible to visualize them correctly. How I can resize the heatmap so I can see the values of the labels of the column? I tried to print it in pdf, but it only appears a black stripe.\nThanks</p>\n\n<p>I am including a figure of the heatmap, the portion that I want to see are the labels that are in the right part, but they are too close together.\n<img src=\"http://i.stack.imgur.com/Hl47m.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["r","quantmod"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":13094689,"title":"Removing NULL objects from an environment","body":"<p>I have an environment of objects that are either xts or <code>NULL</code>. I would like to remove all the <code>NULL</code> from the environment. Is there a function I can use with <code>eapply</code> to achieve this? </p>\n"},{"tags":["r","vector"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":76,"score":3,"question_id":13093912,"title":"How to check if a sequence of numbers is monotonically increasing (or decreasing)?","body":"<p>We are given a sequence of numbers, as a vector <code>foo</code>. The task is to find is <code>foo</code> is <em>monotonically increasing</em> - every item is less than or equal to the next one - or <em>monotonically decreasing</em> - every item greater than or equal than the next one. </p>\n\n<p>For sure this can be found through a loop, but any more creative ideas?</p>\n"},{"tags":["r","linear-algebra","svd"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":320,"score":2,"question_id":9071020,"title":"R projection matrix with SVD or QR decomposition","body":"<p>I'm trying to calculate in R a projection matrix <code>P</code> of an arbitrary N x J matrix <code>S</code>:</p>\n\n<pre><code>P = S (S'S) ^ -1 S'\n</code></pre>\n\n<p>I've been trying to operationalize this with the following function:</p>\n\n<pre><code>P &lt;- function(S){\n  output &lt;- S %*% solve(t(S) %*% S) %*% t(S)\n  return(output)\n}\n</code></pre>\n\n<p>But when I use this I get errors that look like this:</p>\n\n<pre><code>Error in solve.default(t(S) %*% S, t(S), tol = 1e-07) : \n  system is computationally singular: reciprocal condition number = 2.26005e-28\n</code></pre>\n\n<p>I think that this is a result of numerical underflow and/or instability as discussed in numerous places like <a href=\"https://stat.ethz.ch/pipermail/r-help/2004-November/060131.html\" rel=\"nofollow\">r-help</a> and <a href=\"http://tolstoy.newcastle.edu.au/R/e2/help/06/11/4890.html\" rel=\"nofollow\">here</a>, but I'm not experienced enough using SVD or QR decomposition to fix the problem, or else put this existing code into action.  I've also tried the suggested code, which is to write solve as a system:</p>\n\n<pre><code>output &lt;- S %*% solve (t(S) %*% S, t(S), tol=1e-7)\n</code></pre>\n\n<p>But still it doesn't work.  Any suggestions would be appreciated.</p>\n\n<p>I'm pretty sure that my matrix should be invertible and does not have any collinearities, if only because I have tried testing this with a matrix of orthogonal dummy variables, and it still doesn't work.</p>\n\n<p>Also, I'd like to apply this to fairly large matrices, so I'm looking for a neat general solution.</p>\n"},{"tags":["r","knitr"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":13086275,"title":"R2HTML or knitr for dynamic report generation?","body":"<p>I want to write an R function which processes some data and then automatically outputs an html report. This report should contain some fixed text, some text changing according to the underlying data and some figures.</p>\n\n<p>What is the best way to go?\nR2HTML or knitr?\nWhat are the advantages of one over the other?</p>\n\n<p>As far as I understood R2HTML allows me to build the html file sequentially while knitr already operates on an predefined .Rhtml file.\nSo, either use R2HTML or stitch and spin from knitr for on the fly report generation.</p>\n\n<p>I would appreciate any suggestions or hints.</p>\n"},{"tags":["r","matrix"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13092285,"title":"How to remove columns with all elements zero in a sparse Matrix?","body":"<p>For example , M is a sparse Matrix , and track_list is the colnames of the matrix. </p>\n\n<pre><code>library(Matrix)\nM &lt;- Matrix(0,nrow = 3,ncol = 4)\nM[1,2] = 1\nM[2,3] = 1\nM[3,2] = 1 \ntrack_list = c('a','b','c','d')\ncolnames(M) = track_list\n\ncol_tmp &lt;- M@p[-1] - M@p[-length(M@p)]\nM &lt;- M[,col_tmp!=0]\ntrack_list = track_list[col_tmp!=0]\n</code></pre>\n\n<p>And the result will be :</p>\n\n<pre><code>&gt; M\n3 x 2 sparse Matrix of class \"dgCMatrix\"\n     b c\n[1,] 1 .\n[2,] . 1\n[3,] 1 .\n</code></pre>\n\n<p>However , the design is ugly . So How to do that ?</p>\n\n<p>Thank you . </p>\n"},{"tags":["string","r","grep"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":67,"score":4,"question_id":13093931,"title":"R remove last word from string","body":"<p>I'm trying to do something but can't remember/find the answer.  I have a list of city names from the Census Bureau and they put the city's type on the end which is messing up my <code>match()</code>.</p>\n\n<p>I'd like to make this:</p>\n\n<pre><code>Middletown Township\nSunny Valley Borough\nHillside Village\n</code></pre>\n\n<p>into this:</p>\n\n<pre><code>Middletown\nSunny Valley\nHillside\n</code></pre>\n\n<p>Any suggestions?  Ideally I'd also like to know if there's a <code>lastIndexOf()</code> function in R.</p>\n\n<p>Here's the dput:</p>\n\n<pre><code>&gt; dput(df1)\nstructure(list(id = c(1, 2, 3), city = structure(c(2L, 3L, 1L\n), .Label = c(\"Hillside Village\", \"Middletown Township\", \"Sunny Valley Borough\"\n), class = \"factor\")), .Names = c(\"id\", \"city\"), row.names = c(NA, \n-3L), class = \"data.frame\")\n</code></pre>\n"}]}
{"total":19203,"page":8,"pagesize":100,"questions":[{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":11340444,"title":"Is there an R function to format number using unit prefix","body":"<p>Is there a R function (or any package) allowing to format numbers (integer) using standard unit prefix (Kilo, Mega etc ...), so</p>\n\n<pre><code>10 -&gt; 10\n100 -&gt; 1K\n0.01 - &gt; 10m\n</code></pre>\n\n<p>etc ...\nI can do it myself but I would prefer to not reinvent the wheel.</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":87,"score":2,"question_id":13092452,"title":"What is the purpose of environments in R and when I need to use more than one?","body":"<p>This is a basic R question: R has the concept of environment. So what purpose does it have, when do I need to start more then one and how do I switch between them? What is the advantage of multiple environments (other then looking up content of .Rdata file)?</p>\n"},{"tags":["r","statistics","ggplot"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13092823,"title":"ggplot2 plotmatrix with free scales","body":"<p>I use plotmatrix to find correlations in a data frame:</p>\n\n<pre><code># Reduce dataset to 1000 to make things run faster\nd &lt;- diamonds[sample(nrow(diamonds), 1000),]\nplotmatrix(d[,-c(2:4)]) + geom_smooth(color=\"steelblue\", method=\"lm\")\n</code></pre>\n\n<p>This works fine, as long as the different columns are of the same scale.  If they are not, the columns with a small scale become useless. As you can see if you run the example above, price is the largest, and so it kills all the other columns.</p>\n\n<p>To solve this problem in a grid, I would usually ask ggplot draw each scale independently using:</p>\n\n<pre><code>scales=\"free_x\"\n</code></pre>\n\n<p>However, how can I pass that into plotmatrix, or make plotmatrix scale Independently somehow?</p>\n\n<p><img src=\"http://i.stack.imgur.com/5vR3I.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":35,"score":1,"question_id":13091279,"title":"Reading Chinese Language (GB2312) Data","body":"<p>I am trying to read a csv file with Chinese language text in it.  The file should look like this:</p>\n\n<pre><code>userid,jobid,Title,companyid,industryids1\n82497,1160,互联网产品经理,12\n96429,658,企划经理（商业公司）,24\n14471,95,产品运营经理,25,6\n14471,1708,产品营销高级经理,727,2\n14471,1558,产品总监,611,4\n14471,1777,产品总监,743,1\n14471,1697,产品经理,725,234\n14471,1716,度假产品总监 ,730,234\n14471,1717,产品经理,730,5\n</code></pre>\n\n<p>but when I read the data in using <code>read.csv()</code> it looks like this in the R console:</p>\n\n<pre><code>  userid jobid                Title companyid industryids1\n1  82497  1160       »¥ÁªÍø²úÆ·¾­Àí        12           NA\n2  96429   658 Æó»®¾­Àí£¨ÉÌÒµ¹«Ë¾£©        24           NA\n3  14471    95         ²úÆ·ÔËÓª¾­Àí        25            6\n4  14471  1708     ²úÆ·ÓªÏú¸ß¼¶¾­Àí       727            2\n5  14471  1558             ²úÆ·×Ü¼à       611            4\n6  14471  1777             ²úÆ·×Ü¼à       743            1\n7  14471  1697             ²úÆ·¾­Àí       725          234\n8  14471  1716        ¶È¼Ù²úÆ·×Ü¼à        730          234\n9  14471  1717             ²úÆ·¾­Àí       730            5\n</code></pre>\n\n<p>How can I read this in properly?</p>\n\n<p>Session info:</p>\n\n<pre><code>R version 2.14.1 (2011-12-22)\nPlatform: x86_64-pc-mingw32/x64 (64-bit)\nlocale:\n[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252   \n[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.1252    \nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \nloaded via a namespace (and not attached):\n[1] tools_2.14.1\n</code></pre>\n"},{"tags":["r","scatter-plot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13089282,"title":"Add lines indicating quartiles to a scatterplot","body":"<p>I have to plot  lines on a scatterplot at each quartile of a bivariate distribution. I plotted the scatterplot in this way:</p>\n\n<pre><code>plot (data1, data2, col = \"blue\") \n</code></pre>\n\n<p>Can anyone help me?</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13081696,"title":"How to prevent functions polluting global namespace?","body":"<p>My R project is getting increasingly complex, and I'm starting to look for some construct that's equivalent to classes in Java/C#, or modules in python, so that my global namespace doesn't become littered with functions that are never used outside of one particular .r file.</p>\n\n<p>So, I guess my question is: to what extent is it possible to limit the scope of functions to within a specific .r file, or similar?</p>\n\n<p>I think I can just make the entire .r file into one giant function, and put functions inside that, but that messes with the echoing:</p>\n\n<p>myfile.r:</p>\n\n<pre><code>myfile &lt;- function() {\n    somefunction &lt;- function(a,b,c){}\n    anotherfunction &lt;- function(a,b,c){}\n\n    # do some stuff here...\n    123\n    456\n    # ...\n}\nmyfile()\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&gt; source(\"myfile.r\",echo=T)\n\n&gt; myfile &lt;- function() {\n+     somefunction &lt;- function(a,b,c){}\n+     anotherfunction &lt;- function(a,b,c){}\n+ \n+     # do some stuff here...\n+     # . .... [TRUNCATED] \n\n&gt; myfile()\n&gt; \n</code></pre>\n\n<p>You can see that \"123\" is not printed, even though we used <code>echo=T</code> in the <code>source</code> command.</p>\n\n<p>I'm wondering if there is some other construct which is more standard, since putting everything inside a single function doesn't sound like something that is really standard?  But perhaps it is?  Also, if it means that <code>echo=T</code> works then that is a definite bonus for me.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13092711,"title":"R Extract all values of a dataframe and combine it to a single list","body":"<p>I have following data frame:</p>\n\n<pre><code>     PD4115a PD4088a  PD4192a      \n   1 ABCA8   ATRX     ADAM32      \n   2 ANK2    CDH9     C11orf30\n   3 ANO3    CKAP2L   CCBL2      \n</code></pre>\n\n<p>What I want is a list with all values combined:</p>\n\n<pre><code>     1 ABCA8 ATRX ADAM32 ANK2 CDH9 C11orf30 ANO3CKAP2L CCBL2\n</code></pre>\n\n<p>Please help me with that, I am a noob in R.</p>\n\n<p>Many Thanks</p>\n"},{"tags":["r","information-retrieval"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":37,"score":-2,"question_id":13092938,"title":"information retrieval in R","body":"<p>I would like to know if there is any package and tutorial for making Information Retrieval with R. I have only found packages for text mining, and as long as I know there is a relationship between both of them. Any kelp?\nThanks</p>\n"},{"tags":["r","data.table"],"answer_count":3,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":167,"score":6,"question_id":7920688,"title":"non-joins with data.tables","body":"<p>I have a question on the <code>data.table</code> idiom for \"non-joins\", inspired from Iterator's <a href=\"http://stackoverflow.com/q/7822138/986817\">question</a>. Here is an example:</p>\n\n<pre><code>library(data.table)\n\ndt1 &lt;- data.table(A1=letters[1:10], B1=sample(1:5,10, replace=TRUE))\ndt2 &lt;- data.table(A2=letters[c(1:5, 11:15)], B2=sample(1:5,10, replace=TRUE))\n\nsetkey(dt1, A1)\nsetkey(dt2, A2)\n</code></pre>\n\n<p>The <code>data.table</code>s look like this</p>\n\n<pre><code>&gt; dt1               &gt; dt2\n      A1 B1               A2 B2\n [1,]  a  1          [1,]  a  2\n [2,]  b  4          [2,]  b  5\n [3,]  c  2          [3,]  c  2\n [4,]  d  5          [4,]  d  1\n [5,]  e  1          [5,]  e  1\n [6,]  f  2          [6,]  k  5\n [7,]  g  3          [7,]  l  2\n [8,]  h  3          [8,]  m  4\n [9,]  i  2          [9,]  n  1\n[10,]  j  4         [10,]  o  1\n</code></pre>\n\n<p>To find which rows in <code>dt2</code> have the same key in <code>dt1</code>, set the <code>which</code> option to <code>TRUE</code>:</p>\n\n<pre><code>&gt; dt1[dt2, which=TRUE]\n[1]  1  2  3  4  5 NA NA NA NA NA\n</code></pre>\n\n<p>Matthew suggested in this <a href=\"http://stackoverflow.com/questions/7822138/porting-set-operations-from-data-frames-to-data-tables-how-to-identify-duplicat/7823030#7823030\">answer</a>, that a \"non join\" idiom</p>\n\n<pre><code>dt1[-dt1[dt2, which=TRUE]]\n</code></pre>\n\n<p>to subset <code>dt1</code> to those rows that have indexes that don't appear in <code>dt2</code>. On my machine with <code>data.table</code> v1.7.1 I get an error:</p>\n\n<pre><code>Error in `[.default`(x[[s]], irows): only 0's may be mixed with negative subscripts\n</code></pre>\n\n<p>Instead, with the option <code>nomatch=0</code>, the \"non join\" works</p>\n\n<pre><code>&gt; dt1[-dt1[dt2, which=TRUE, nomatch=0]]\n     A1 B1\n[1,]  f  2\n[2,]  g  3\n[3,]  h  3\n[4,]  i  2\n[5,]  j  4\n</code></pre>\n\n<p>Is this intended behavior?</p>\n"},{"tags":["arrays","r","data.frame","chi-squared"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13086599,"title":"R chisq.test() on dataframe using binary comparsion","body":"<p>I want to do a chisq.test on a dataframe of dimension (50x752). I want to get the pvalues (adjusted by multiple testing) for all possible paire-wise comparison for all columns. At the end I want to get back a matrix (50x50) to generate a heatmap of the adjusted chisq pvalues. Here is what I do at the moment but this is far beeing ideal.</p>\n\n<p>Step1: do the pairewise comparison</p>\n\n<pre><code>function(data,p.adjust.method=\"holm\")\n{\ncor.mat &lt;- cor(data)\nx&lt;-ncol(data)#nb of column in matrix here 50\ny&lt;-nrow(data)#nb of column in matrix here 758\nindex&lt;-t(combn(x, 2)) #create the matrix position of output for all possible combination\nnindex &lt;- nrow(index)\npvals &lt;- numeric(nindex)\n\nfor (i in 1:nindex)\n{\npvals[i]&lt;-chisq.test(data[, index[i, 1]], data[, index[i,2]])$p.value   \n}\npvals&lt;-p.adjust(pvals,method = p.adjust.method)\nout &lt;- as.data.frame(cbind(index, pvals))\n}\n</code></pre>\n\n<p>Step2: The output table is transform into a matrix using </p>\n\n<pre><code>   dcast(df,V2~V1,fill=1) # thanx to Roland for this function!\n</code></pre>\n\n<p>But this is not working well, as I do not mirror the pvalue in the final matrix and I have to manipulate the output of the 1st function to get the diagonal filled with 0 (when comparing a column to itself). Your help will be greatly appreciated!</p>\n"},{"tags":["r","loops","for-loop"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13089208,"title":"Constructing variables within a loop and using them","body":"<p>I'm trying to loop over variables (I'm still struggling to get my head around the apply() family, one day soon) and construct the variable names that I wish to obtain the labels for.</p>\n\n<p>A simplified example is perhaps easiest...</p>\n\n<pre><code>library(Hmisc)\nt &lt;- data.frame(matrix(1:100, 10))\nlabel(t$X1)  &lt;- \"This is my first variable\"\nlabel(t$X2)  &lt;- \"This is my second variable\"\nlabel(t$X3)  &lt;- \"This is my third variable\"\nlabel(t$X4)  &lt;- \"This is my fourth variable\"\nlabel(t$X5)  &lt;- \"This is my fifth variable\"\nlabel(t$X6)  &lt;- \"This is my sixth variable\"\nlabel(t$X7)  &lt;- \"This is my seventh variable\"\nlabel(t$X8)  &lt;- \"This is my eighth variable\"\nlabel(t$X9)  &lt;- \"This is my ninth variable\"\nlabel(t$X10) &lt;- \"This is my tenth variable\"\nfor(x in 1:10){\n  my.label &lt;- label(paste(\"t$X\", x, sep=\"\"))\n  print(my.label)\n}\n</code></pre>\n\n<p>When run this gives....</p>\n\n<pre><code>[1] \"\"\n[1] \"\"\n[1] \"\"\n[1] \"\"\n[1] \"\"\n[1] \"\"\n[1] \"\"\n[1] \"\"\n[1] \"\"\n[1] \"\"\n</code></pre>\n\n<p>When I'm expecting to see</p>\n\n<pre><code>[1] \"This is my first variable\"\n[1] \"This is my second variable\"\n[1] \"This is my third variable\"\n[1] \"This is my fourth variable\"\n[1] \"This is my fifth variable\"\n[1] \"This is my sixth variable\"\n[1] \"This is my seventh variable\"\n[1] \"This is my eighth variable\"\n[1] \"This is my ninth variable\"\n[1] \"This is my tenth variable\"\n</code></pre>\n\n<p>I know the paste() function is working correctly because...</p>\n\n<pre><code>for(x in 1:10){\n  print(paste(\"t$X\", x, sep=\"\"))\n}\n[1] \"X$1\"\n[1] \"X$2\"\n[1] \"X$3\"\n[1] \"X$4\"\n[1] \"X$5\"\n[1] \"X$6\"\n[1] \"X$7\"\n[1] \"X$8\"\n[1] \"X$9\"\n[1] \"X$10\"\n</code></pre>\n\n<p>I'm stumped, I've tried placing the paste() within eval() as in...</p>\n\n<pre><code>for(x in 1:10){\n  my.label &lt;- label(eval(paste(\"t$X\", x, sep=\"\")))\n  print(my.label)\n}\n</code></pre>\n\n<p>...but no joy.  It seems such a simple thing, and I've tried searching for solutions but clearly aren't describing it properly with phrases I'm trying hence asking here.</p>\n\n<p>Insights and pointers very much appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>slackline</p>\n\n<p>EDIT : The above is a simplified example to illustrate what I am trying to achieve which is a bit more complex, currently my code looks like...</p>\n\n<pre><code>for(type1 in c(\"bouldering\", \"routes\")){\n  if(type1 == \"bouldering\"){\n    part   &lt;- c(\"indoors\", \"outdoors\")\n    xlabel &lt;- \"Grade (Fontainebleau)\"\n  }\n  else if(type1 == \"routes\"){\n    part &lt;- c(\"onsight\", \"redpoint\")\n    xlabel &lt;- \"Grade (French Sports)\"\n  }\n  for(type2 in part){\n    for(training in c(\"pullup.rep\", \"pullup.weight\", \"hang.time\", \"hang.size\", \"bench.press\", \"bench.press.scaled\", \"dead.lift\", \"dead.lift.scaled\", \"front.lever\", \"height\", \"weight\", \"bmi\")){\n      ### Obtain the current variables label for using in the graph\n      ylabel &lt;- label(paste(\"clean.data\", training, sep=\"$\"))\n      ### Paste the bouldering/routes together with indoors/\n      ### outdoors or onsight/redpoint so variables and files can be constructed\n      file.stub &lt;- paste(type1, type2, sep=\"-\")\n      metric    &lt;- paste(type1, type2, sep=\".\")\n      file.out  &lt;- paste(\"latex/figures/\", gsub(\"\\\\.\", \"-\", training) , \"-\", file.stub, \".png\", sep=\"\")\n      png(file.out, width=1024, height=768)\n      t &lt;- qplot(metric, training,\n                 data     = clean.data,\n                 geom     = \"boxplot\",\n                 fill     = factor(metric),\n                 xlab     = xlabel,\n                 ylab     = ylabel)\n      t + opts(legend.position = \"none\")\n      dev.off()\n    }\n  }\n}\n</code></pre>\n\n<p>So currently I don't get a label, and I don't get graphs because the commands (<code>label()</code> and <code>qplot()</code>) don't know that I'm referring to column names with the data frame <code>clean.data</code></p>\n"},{"tags":["r","markdown","knitr"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13091112,"title":"Hiding the R code in Rmarkdown/knit and just showing the results","body":"<p>In my R markdown code I sometimes want to just generate a report without showing the actual code (specially when I send it to my boss). How can I hide the R code and just show the graph and results</p>\n\n<p>for example </p>\n\n<pre><code>```{r fig.width=7, fig.height=6}\na&lt;-as.numeric(some data)\n hist(a, breaks=24)\n\n```\n</code></pre>\n\n<p>Shows both the commands and a histogram. How can I remove the commands from my HTML report?</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13091138,"title":"How are R lists stored internally?","body":"<p>How is the list data structure stored internally? What are its properties with regard to accessing, inserting, deleting, and so on?</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13083671,"title":"plotGoogleMaps query for plotting maps with four columns","body":"<p>Helo All,</p>\n\n<p>I am using plotGoogleMaps package for plotting piecharts on world map. segmentgooglemap is the function in this package that does this. Here is the manual <a href=\"http://cran.r-project.org/web/packages/plotGoogleMaps/vignettes/plotGoogleMaps-intro.pdf\" rel=\"nofollow\">http://cran.r-project.org/web/packages/plotGoogleMaps/vignettes/plotGoogleMaps-intro.pdf</a>. if I try to plot piechart for 3 column it works fine like given in manual for zinc, lead, copper. But if I try to plot for 4 columns it doesnot work. Can anyone guide me why it is showing so. I have tried many options but didnt succeed. Looking forward for reply.</p>\n\n<p>Regards,\nGourja</p>\n"},{"tags":["r","lattice","raster"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13091107,"title":"Plotting two raster stacks at once with levelplot","body":"<p>I have two stacks, built in raster, with 12 layers each, comprising 1 and NA values. They are all the same extent, resolution, etc. They are two outcomes of similar calculations performed on the same stack (raw temperature values). \n I can plot each stack as a levelplot. \n I would like to plot both at once, such that the panels each contain information from, e.g. layer 1, stack 1,  and layer 1, stack 2. \n I don't mind if this involves creating a third stack, provided I can renumber one of the 1s in either stack, so that I can differentiate by color. \n this: \n stack3&lt;-stack(stack1, stack2)\n levelplot(stack3) </p>\n\n<p>is not the solution. \n I cannot give you more 'failed code' as an example, because I really don't know where to start. I think I'm missing something obvious. Adding the stacks does not work, due to NA values. </p>\n\n<p>Any thoughts? (as a new user I can't tag packages latticeExtra or rasterViz)</p>\n\n<p>Thank you</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":13086446,"title":"How to write a cached variable evaluator?","body":"<p>Edit:</p>\n\n<p>I have a kludgy piece of code that looks like this:</p>\n\n<pre><code>readcsvfile()\ndopreprocessingoncsvfile()\nreadanothercsvfile()\nmoreprocessing()\n# etc ...\n</code></pre>\n\n<p>Over a few days, this has gradually got longer and more complex, and therefore takes over a minute or two to run now, and I'm not very patient :-P .  Given that R is so great at saving the environment, I mean the variables in the R environment, an easy way to accelerate this is:</p>\n\n<pre><code>if( !exists(\"init.done\") {\nreadcsvfile()\ndopreprocessingoncsvfile()\nreadanothercsvfile()\nmoreprocessing()\ninit.done = T\n}\n</code></pre>\n\n<p>However, I like it to be a bit more fine-grained, not least because sometimes I might tweak a function in the processing, so I want to rerun it, without watching the whole world reload, so I've changed it to:</p>\n\n<pre><code>if( !exists(\"somedata\" ) ) {\n    somedata &lt;- readcsvfile()\n}\n# ... etc ... same for the others\n</code></pre>\n\n<p>However, sometimes I make one of the following mistakes, and let's face it, I'm also just plain lazy, so why write a big long if statement if there is a more concise way?  I make the following mistakes often:</p>\n\n<ul>\n<li>mistype the name of the variable in the if, which 'detects' itself by my noticing that it keeps running every time I run the script</li>\n<li>miss off the second bracket in the if clause, which takes 10-15 seconds to detect, modify, and rerun, which is annoying :-P</li>\n</ul>\n\n<p>Sooo.... my proposd solution is to write a function <code>cacheVar</code> whose definition looks a bit like:</p>\n\n<pre><code>cacheVar &lt;- function( varname, expression ) {\n    if( !exists(varname ) {\n        setValueMagic( varname, evalMagic(expression) )\n    }\n}\n\n... and whose usage looks like:\n\ncacheVar(\"foo\", {\n    # some expression that calculates the value of foo\n})\n</code></pre>\n\n<p>... where the expression is evaluated only if value 'varname' doesn't already exist.</p>\n\n<p>I guess the missing information to flesh this out is:</p>\n\n<ul>\n<li>does this exist already?</li>\n<li>how to write <code>setValueMagic</code> in R?</li>\n<li>how to write <code>evalMagic</code> in R?</li>\n</ul>\n\n<p>Edit: a bit more complicated, since we need to assign into the parent frame, possibly using <code>parent.env</code> or <code>parent.frame</code>, something like that.</p>\n"},{"tags":["r","markdown","knitr","rstudio","rmarkdown"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13090838,"title":"R - Markdown avoiding package loading messages","body":"<p>I have been using Knitr via R-Studio, and think it is pretty neat. I have a minor issue though. When I source a file in an R-Chunk, the knitr output includes external comments as follows: </p>\n\n<pre><code>+ FALSE Loading required package: ggplot2\n+ FALSE Loading required package: gridExtra\n+ FALSE Loading required package: grid\n+ FALSE Loading required package: VGAM\n+ FALSE Loading required package: splines\n+ FALSE Loading required package: stats4\n+ FALSE Attaching package: 'VGAM'\n+ FALSE The following object(s) are masked from 'package:stats4':\n</code></pre>\n\n<p>I have tried to set R-chunk options in various ways but still didn't seem to avoid the problem: </p>\n\n<pre><code>```{r echo=FALSE, cache=FALSE, results=FALSE, warning=FALSE, comment=FALSE, warning=FALSE} \nsource(\"C:/Rscripts/source.R\");\n\n```\n</code></pre>\n\n<p>Is there any way to comment out these messages?</p>\n"},{"tags":["r","plot","visualization"],"answer_count":2,"favorite_count":1,"up_vote_count":11,"down_vote_count":0,"view_count":151,"score":11,"question_id":13084998,"title":"Streamgraphs in R?","body":"<p>Are there any implementations of Streamgraphs in R?</p>\n\n<blockquote>\n  <p>Streamgraphs are a variant of stacked graphs and an improvement on\n  Havre et al.'s ThemeRiver in the way the baseline is chosen, layer\n  ordering, and color choice.</p>\n</blockquote>\n\n<p>Example: </p>\n\n<p><img src=\"http://i.stack.imgur.com/qMSmz.jpg\" alt=\"enter image description here\"></p>\n\n<p>Reference: <a href=\"http://www.leebyron.com/else/streamgraph/\">http://www.leebyron.com/else/streamgraph/</a></p>\n"},{"tags":["r","gnuplot","contour"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13090133,"title":"Plotting different contour plots with similar scales in R or gnuplot","body":"<p>I am new to R for plotting, and I wish to do contour plots for several files. and here is what I have got so far. My file has 3 columns, X,Y,Z, and with some nan values. Since lattice does not allow Inf/NaN values, I had to remove them prior, and do some interpolation.<br></p>\n\n<pre><code>data &lt;- read.table(\"file\", sep=\",\", header=T)\nmydata &lt;- na.omit(data)\nlibrary(akima)\nlibrary(lattice)\ns = interp(mydata$X, mydata$Y, mydata$Z)\nfilled.contour(s, xlim= c(5,25), ylim=c(40,180))\n</code></pre>\n\n<p>This does gives some results, but there are things I am not able to do:</p>\n\n<ol>\n<li>To get contour lines on the graph.</li>\n<li>Also there are like 3 files with different z ranges, say one from (0-18), (0-20), (0-25). I wish to adjust and rescale them to provide similar color scale on graph, for instance, the '15' value should be similar color on all three.</li>\n</ol>\n\n<p>I am more familiar with gnuplot, but there also the problem is with the ranges, as the range always autoscale to color, and it seems difficult to control the range. Any help with that is also deeply appreciated.<br> \nI may be doing something wrong, so in case anybody could help me out, and provide to right direction, or right software, I will be grateful. </p>\n"},{"tags":["r","data.table","igraph"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13090299,"title":"How to perform aggregate function two times with two different criteria to a data.table","body":"<p>I like to use igraph to display relation ship between Switch and the Impacted Networks as a result of problem with the switch. Since there are lots of incidents, I would like to show the top 10 switches are that most problematic and as a result impacted Networks.</p>\n\n<p>df</p>\n\n<pre><code>Incident    Date        Switch ImpactedNetwork\n123        1/1/2012       A     Wireless\n455        1/2/2012       B     LocalLan\n460        1/3/2012       A     LocalLan\n465        1/4/2012       A     Production\n</code></pre>\n\n<p>etc</p>\n\n<p>to assing 1 everytime an incident happens with a swithc:</p>\n\n<pre><code>df$count&lt;-c(1)\n</code></pre>\n\n<p>To come up with the top 10 most problematic switches:</p>\n\n<pre><code>library(data.table)\ndf&lt;-df[, total := sum(count), by = Switch]\n</code></pre>\n\n<p>df</p>\n\n<pre><code>Incident    Date        Switch ImpactedNetwork  count   Total\n123        1/1/2012       A     Wireless         1        3\n455        1/2/2012       B     LocalLan         1        1\n460        1/3/2012       A     LocalLan         1        3\n465        1/4/2012       A     Production       1        3\n</code></pre>\n\n<p>from this df, how do I get the top 10 highest incident based on Total?</p>\n\n<p>Once I determine, the top ten switches, I need aggregate count of ImpactedNetwork for the top then problematic switch.</p>\n\n<pre><code>t&lt;-aggregate(count~ImpactedNetwork+Switch, df, sum)\n</code></pre>\n\n<p>t</p>\n\n<pre><code>ImpactedNework   Switch   count\nProduction       A         1\nWireless         A         1\n\nplot(t, layout = layout.kamada.kawai,  vertex.label = V(g)$name,  vertex.label.color= \"darkblue\",  edge.arrow.size=0.9,  edge.curved=T, edge.label=t$count, edge.label.color=\"#F900F9\", edge.label.font=10,vertex.shape=\"rectangle\",edge.color=\"darkgreen\", main=\"Top 10 Problematic Switches and Impacted Network\"))\n</code></pre>\n\n<p>The ideas is this:</p>\n\n<ol>\n<li>calculate the most incident generated switches</li>\n<li>calculate count of impacted network give the Switch\n3.Igraph the the result.</li>\n</ol>\n\n<p>Should I do this in two separate data frames to first calculate the most incident generated switches? And, anthor data frame to calucate the count of impacted network? Any ideas is appreciated.</p>\n"},{"tags":["r","csv","file","lapply"],"answer_count":5,"favorite_count":3,"up_vote_count":8,"down_vote_count":3,"view_count":4382,"score":5,"question_id":5319839,"title":"Read multiple CSV files into separate data frames","body":"<p>Suppose we have files <em>file1.csv</em>, <em>file2.csv</em>, ... , and <em>file100.csv</em> in directory <em>C:\\R\\Data</em> and we want to read them all into separate data frames (e.g. <em>file1</em>, <em>file2</em>, ... , and <em>file100</em>).  </p>\n\n<p>The reason for this is that, despite having similar names they have different file structures, so it is not that useful to have them in a list.</p>\n\n<p>I could use <code>lapply</code> but that returns a single list containing 100 data frames.  Instead I want these data frames in the Global Environment.</p>\n\n<p>How do I read multiple files directly into the global environment? Or, alternatively, How do I unpack the contents of a list of data frames into it? </p>\n"},{"tags":["linux","r","pipe","exit-code"],"answer_count":1,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":85,"score":6,"question_id":13074372,"title":"capturing pipe exit status in R","body":"<p>I am using R's <code>pipe()</code> function to capture output from a shell command, but I would also like to get the exit code from the command.</p>\n\n<p>I know that I could use <code>system2</code> here, but I need the advantage of a pipe i.e. the ability to process output in a streaming fashion.</p>\n\n<p>I am considering writing my own library to wrap the <code>popen()</code> and <code>pclose()</code> C functions to take advantage of the fact that <code>pclose()</code> returns the exit status, but maybe this can be avoided.</p>\n\n<p>Any suggestions? Thanks!</p>\n\n<p><strong>Note</strong></p>\n\n<p>There are certainly ways to do this with temporary files, named pipes, etc but I would ideally like to avoid these workarounds. I am willing to compile a shared library with an R->C function in it (and I'm even willing to copy-paste part of the R source code), but I'm not willing to rebuild R.</p>\n\n<p><strong>Update</strong></p>\n\n<p>I started reading through the R source code and found the unchecked pclose call:</p>\n\n<p>in <code>src/main/connections.c</code>:</p>\n\n<pre><code>static void pipe_close(Rconnection con)\n{\n    pclose(((Rfileconn)(con-&gt;private))-&gt;fp);\n    con-&gt;isopen = FALSE;\n}\n</code></pre>\n\n<p>I tried going forward with the approach of implementing an <code>R_pclose</code> C function that duplicates the R code for <code>close()</code> but saves this return value. I unfortunately ran into this static variable in <code>src/main/connections.c</code></p>\n\n<pre><code>static Rconnection Connections[NCONNECTIONS];\n</code></pre>\n\n<p>Since I'd have to run <code>objcopy --globalize-symbol=Connections libR.so /path/to/my/libR.so</code> anyway to access the variable, it looks like my best solution is to rebuild R with my own patch to capture the pclose return value.</p>\n"},{"tags":["r","matrix","linear-algebra"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":42,"score":4,"question_id":13088770,"title":"How to write linearly dependent column in a matrix in terms of linearly independent columns?","body":"<p>I have a large mxn matrix, and I have identified the linearly dependent columns. However, I want to know if there's a way in R to write the linearly dependent columns in terms of the linearly independent ones. Since it's a large matrix, it's not possible to do based on inspection.</p>\n\n<p>Here's a toy example of the type of matrix I have.</p>\n\n<pre><code>&gt; mat &lt;- matrix(c(1,1,0,1,0,1,1,0,0,1,1,0,1,1,0,1,0,1,0,1), byrow=TRUE, ncol=5, nrow=4)\n&gt; mat\n      [,1] [,2] [,3] [,4] [,5]\n[1,]    1    1    0    1    0\n[2,]    1    1    0    0    1\n[3,]    1    0    1    1    0\n[4,]    1    0    1    0    1\n</code></pre>\n\n<p>Here it's obvious that x3 = x1-x2, x5=x1-x4. I want to know if there's an automated way to get that for a larger matrix.</p>\n\n<p>Thanks!</p>\n"},{"tags":["c++","r","lapack","gsl","rinside"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13089243,"title":"C++ with a math library like GSL, LAPACK, or CBLAS performance vs C++ with Rinside with an R function?","body":"<p>Has anyone ever done a straight up apple to apple comparison between:</p>\n\n<ol>\n<li>A C++ application calling an algorithm done in a R functions using RInside </li>\n<li>A C++ application calling the equivelant algorithm but using a one of the math libraries like GSL, LAPACK, or CBLAS? </li>\n</ol>\n\n<p>I am trying to get benchmarks which would be faster. I am also interested in what kind of parallalzation/multithreading designs that might make the calculate faster within C++?</p>\n"},{"tags":["r","function"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":124,"score":1,"question_id":10945718,"title":"R function works with some dataframes but not others?","body":"<p>I've a data frame that summarises the number of missing and non-missing observations in a data frame that is passed to it[1].  I then have been asked to test for differences between two treatment arms in the data I have (personally I disagree with the need or utility of doing so, but its what I've been asked to do).  So I've written a small function to do this...</p>\n\n<pre><code>quick.test &lt;- function(x, y){\n  chisq   &lt;- chisq.test(x = x,  y = y)\n  fisher  &lt;- fisher.test(x = x, y = y)\n  results &lt;- cbind(chisq  = chisq$statistic,\n                   df     = chisq$parameter,\n                   p      = chisq$p.value,\n                   fisher = fisher$p.value)\n  results\n}\n</code></pre>\n\n<p>I then use apply() to pass the relevant columns to this function as follows...</p>\n\n<pre><code>apply(miss.t1, 1, function(x) quick.test(x[2:3], x[4:5]))\n</code></pre>\n\n<p>This is fine for the above specified miss.t1 data frame, but I'm working with time-series data and have three time-points I wish to summarise so have miss.t2 and miss.t3 (each of which is summarising the number of present/missing data for each time point, and have been created in the same manner using the function described in [1]).</p>\n\n<p>miss.t2 fails with the following error...</p>\n\n<pre><code>apply(miss.t2, 1, function(x) quick.test(x[2:3], x[4:5]))\nError in chisq.test(x = x, y = y) : \n  'x' and 'y' must have at least 2 levels\n</code></pre>\n\n<p>My initial thought was that one of the columns had a missing value for some reason, but this doesn't appear to be the case...</p>\n\n<pre><code>&gt; describe(miss.t2)\nmiss.t2 \n\n 5  Variables      171  Observations\n--------------------------------------------------------------------------------\nvariable \n      n missing  unique \n    171       0     171 \n\nlowest : Abtotal   Abyn      agg_ment  agg_phys  All.score\nhighest: z_pf      z_re      z_rp      z_sf      z_vt      \n--------------------------------------------------------------------------------\nnmiss.1 \n      n missing  unique    Mean \n    171       0       4   8.649 \n\n0 (6, 4%), 8 (9, 5%), 9 (153, 89%), 10 (3, 2%) \n--------------------------------------------------------------------------------\nnpresent.1 \n      n missing  unique    Mean \n    171       0       4   9.351 \n\n8 (3, 2%), 9 (153, 89%), 10 (9, 5%), 18 (6, 4%) \n--------------------------------------------------------------------------------\nnmiss.2 \n      n missing  unique    Mean \n    171       0       4   10.65 \n\n0 (6, 4%), 11 (160, 94%), 12 (4, 2%), 13 (1, 1%) \n--------------------------------------------------------------------------------\nnpresent.2 \n      n missing  unique    Mean \n    171       0       4   14.35 \n\n12 (1, 1%), 13 (4, 2%), 14 (160, 94%), 25 (6, 4%) \n--------------------------------------------------------------------------------\n</code></pre>\n\n<p>Next thing I tried was trying subsets of miss.t2 by taking head(miss.t2, n=XX) and it works fine upto row 54...</p>\n\n<pre><code>&gt; apply(head(miss.t2, n=53), 1, function(x) quick.test(x[2:3], x[4:5]))\n     1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28\n[1,] 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0\n[2,] 1 1 1 1 1 1 1 1 1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1\n[3,] 1 1 1 1 1 1 1 1 1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1\n[4,] 1 1 1 1 1 1 1 1 1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1\n     29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53\n[1,]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0\n[2,]  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1\n[3,]  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1\n[4,]  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1\nThere were 50 or more warnings (use warnings() to see the first 50)\n&gt; apply(head(miss.t2, n=54), 1, function(x) quick.test(x[2:3], x[4:5]))\nError in chisq.test(x = x, y = y) : \n  'x' and 'y' must have at least 2 levels\n&gt; miss.t2[54,]\n   variable nmiss.1 npresent.1 nmiss.2 npresent.2\n54      psq      10          8      11         14\n&gt; traceback()\n5: stop(\"'x' and 'y' must have at least 2 levels\") at #2\n4: chisq.test(x = x, y = y) at #2\n3: quick.test(x[2:3], x[4:5])\n2: FUN(newX[, i], ...)\n1: apply(head(miss.t2, n = 54), 1, function(x) quick.test(x[2:3], \n       x[4:5]))\n</code></pre>\n\n<p>Similarly with the 'bottom' of the data frame the last 26 rows are parsed fine, but not the 27th from last...</p>\n\n<pre><code>&gt; apply(tail(miss.t2, n=26), 1, function(x) quick.test(x[2:3], x[4:5]))\n     146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163\n[1,]   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0\n[2,]   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1\n[3,]   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1\n[4,]   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1\n     164 165 166 167 168 169 170 171\n[1,]   0   0   0   0   0   0   0   0\n[2,]   1   1   1   1   1   1   1   1\n[3,]   1   1   1   1   1   1   1   1\n[4,]   1   1   1   1   1   1   1   1\nThere were 26 warnings (use warnings() to see them)\n&gt; apply(tail(miss.t2, n=27), 1, function(x) quick.test(x[2:3], x[4:5]))\nError in chisq.test(x = x, y = y) : \n  'x' and 'y' must have at least 2 levels\nIn addition: Warning message:\nIn chisq.test(x = x, y = y) : Chi-squared approximation may be incorrect\n\n&gt; miss.t2[118,]\n    variable nmiss.1 npresent.1 nmiss.2 npresent.2\n118     sf16       9          9      11         14\n</code></pre>\n\n<p>I can't see anything wrong with these two lines that means they should fail and the traceback() shown above doesn't reveal anything useful (to my mind).</p>\n\n<p>Can anyone offer any suggestions as to why or where things are going wrong?</p>\n\n<p>Many thanks in advance,</p>\n\n<p>Neil</p>\n\n<p>EDIT : Formatted reply to Vincent Zoonekynd ...</p>\n\n<p>I opted for the chisq.test(x = x, y = y) version described in ?chisq.test(), using cbind() as you suggest to produce a matrix results in \n    Error in sum(x) : invalid 'type' (character) of argument. </p>\n\n<p>Putting print statements and showing the length of x and y results in the same error, but shows the values and lenghts as being... </p>\n\n<pre><code>&gt; miss.t2.res &lt;- data.frame(t(apply(miss.t2, 1, function(x) quick.test(x[2:3], x[4:5])))) \n[1] \"Your x is : 9\" \"Your x is : 9\" \n[1] 2    ### &lt; Length of x\n[1] \"Your y is : 11\" \"Your y is : 14\"\n[1] 2    ### &lt; Length of y\nError in chisq.test(x = x, y = y) : 'x' and 'y' must have at least 2 levels\n</code></pre>\n\n<p>EDIT 2 : Thanks to Vincent Zoonekynd pointers the problem was that because the counts were identical for two cells the call to chisq.test() treats these as factors and collapses them.  The solution was to modify the quick.test() function and coerce the arguments that are being passed into a matrix, so the function that worked is now....</p>\n\n<pre><code>quick.test &lt;- function(x, y){\n  chisq   &lt;- chisq.test(rbind(as.numeric(x), as.numeric(y)))\n  fisher  &lt;- fisher.test(rbind(as.numeric(x), as.numeric(y)))\n  results &lt;- cbind(chisq  = chisq$statistic,\n                   df     = chisq$parameter,\n                   p      = chisq$p.value,\n                   fisher = fisher$p.value)\n  results\n}\n</code></pre>\n\n<p>Many thanks for the help &amp; pointers Vincent, very much appreciated.</p>\n\n<p>[1] <a href=\"http://gettinggeneticsdone.blogspot.co.uk/2011/02/summarize-missing-data-for-all.html\" rel=\"nofollow\">http://gettinggeneticsdone.blogspot.co.uk/2011/02/summarize-missing-data-for-all.html</a></p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":20,"score":-1,"question_id":13088586,"title":"Zelig is not displaying the predicted values","body":"<p>I would like to be able to use ggplot to plot Zelig output. I need to make the Zelig plots easy to understand for some viewers. As mentioned the Zelig documentation, I performed the following:</p>\n\n<p>Data frame x:</p>\n\n<pre><code>  Records cpu\n1 1699992   4\n2 2625941  28\n3 4685483  44\n4 3160694  12\n5 2627816  28\n6 2430273   4\n\nz.out&lt;-zelig(cpu ~ Records, model=\"ls\", data=x)\nx.out&lt;-setx(z.out, Records=20000000)\ns.out&lt;-sim(z.out, x=x.out)\n\nsummary(s.out)\n\nModel:  ls \nNumber of simulations:  1000 \n\nValues of X\n  (Intercept) Records\n1           1 1699992\nattr(,\"assign\")\n[1] 0 1\n\nExpected Values: E(Y|X) \n    mean    sd    50%  2.5%  97.5%\n1 12.378 2.689 12.361 6.998 17.517\n</code></pre>\n\n<ol>\n<li><p>Not getting predicted values. Does anybod worked with Zelig to tell me this.</p></li>\n<li><p>Not getting results from these commands: s.out$ev. I get NULL values. What does that mean? Does this mean that the model was unable to predict?</p></li>\n</ol>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13088332,"title":"Pearson’s correlation test","body":"<p>I have a situation like this:</p>\n\n<pre><code>Gene       SAMPLE1   SAMPLE2 \n G1         0.33      0.21  \n G2         0.45      0.324 \n G3         0.765     0.654 \n G4         0.98      0.543 \n G5         0.565     0.13\n G6         0.123     0.943\n G7         0.321     0.572\n....       ...       ......\n</code></pre>\n\n<p>data are not real data.\ni need to: compute the p-values of a two sided Pearson’s correlation test.</p>\n\n<p>Can anyone help me please? I'm quite new in R.</p>\n"},{"tags":["r","cluster-analysis","hclust"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":34,"score":-1,"question_id":13077476,"title":"hclust size limit?","body":"<p>I'm new to R. I'm trying to run hclust() on about 50K items. I have 10 columns to compare and 50K rows of data. When I tried assigning the distance matrix, I get: \"Cannot allocate vector of 5GB\".</p>\n\n<p>Is there a size limit to this? If so, how do I go about doing a cluster of something this large?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I ended up increasing the max.limit and increased the machine's memory to 8GB and that seems to have fixed it.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":54,"score":4,"question_id":13079431,"title":"How to convert a vector of strings to a dataframe or matrix","body":"<p>I have a vector of n-length strings of numerals that looks like this (in this case, n=3):</p>\n\n<pre><code>[1] \"111\" \"111\" \"111\" \"111\" \"111\" \"111\" \"111\" \"111\" \"111\" \"111\" \"111\" \"111\"\n[13] \"111\" \"111\" \"111\" \"111\" \"111\" \"111\" \"111\" \"111\" \"111\" \"111\" \"111\" \"111\"\n[25] \"111\" \"111\" \"111\" \"111\" \"111\" \"111\" \"111\" \"1 1\" \"111\" \"  1\" \"111\" \"112\"\n[37] \"121\" \"111\" \"111\" \"111\" \"11 \" \"111\" \"   \" \"111\" \"111\" \"221\" \"111\" \"111\"\n[49] \"   \" \"111\" \"111\"\n</code></pre>\n\n<p>I want to convert it into a matrix (or dataframe) that looks like this:</p>\n\n<pre><code>V1   V2   V3\n1    1    1\n1    1    1\n1    1    1\n...\n1   NA    1\n1    1    1\nNA   NA   1\n</code></pre>\n\n<p>etc.</p>\n\n<p>I know I can do it in a doubly-nested loop with substring() and as.numeric(), but there must be a more R-like way to accomplish this. Can anyone offer a clue?</p>\n\n<p>TIA.</p>\n"},{"tags":["r","scoping"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13083055,"title":"Model fitting functions and environemnts","body":"<p>Here is a kind of minimal example for a problem I stumbled upon:</p>\n\n<pre><code>mylm &lt;- function(formula,data,subset=NULL){\n  mysubset &lt;- subset # some other clever manipulation\n  lm(formula,data,mysubset)\n}\nmydata &lt;- data.frame(x=rnorm(10),y=rnorm(10))\nmylm(y~x,mydata) # this fails!\n</code></pre>\n\n<p>The reason why the last line fails is, that <code>lm</code> contains a call to <code>model.frame</code>, which is evaluated in the <code>parent.frame</code>, i.e. <code>lm</code> contains the line of code</p>\n\n<pre><code>mf &lt;- eval(mf, parent.frame())\n</code></pre>\n\n<p>Here the <code>mf</code> on the right side is a cleverly constructed call to <code>model.frame</code>. I am passing on <code>mysubset</code>, but <code>eval</code> looks for it (I believe, but correct me if I am wrong) in the basic environment and doesn't find it. I know that I could probably use <code>lm.fit</code>, but is there a way to make the environment inside <code>mylm</code> the <code>parent.frame</code> for <code>lm</code>?</p>\n"},{"tags":["r"],"answer_count":9,"favorite_count":13,"up_vote_count":32,"down_vote_count":0,"view_count":28583,"score":32,"question_id":2436688,"title":"Append an object to a list in R in amortized constant time?","body":"<p>If I have some R list <code>mylist</code>, you can append an item <code>obj</code> to it like so:</p>\n\n<pre><code>mylist[[length(mylist)+1]] &lt;- obj\n</code></pre>\n\n<p>But surely there is some more compact way.  When I was new at R, I  tried writing <code>lappend()</code> like so:</p>\n\n<pre><code>lappend &lt;- function(lst, obj) {\n    lst[[length(lst)+1]] &lt;- obj\n    return(lst)\n}\n</code></pre>\n\n<p>but of course that doesn't work due to R's call-by-name semantics (<code>lst</code> is effectively copied upon call, so changes to <code>lst</code> are not visible outside the scope of <code>lappend()</code>.  I know you can do environment hacking in an R function to reach outside the scope of your function and mutate the calling environment, but that seems like a large hammer to write a simple append function.</p>\n\n<p>Can anyone suggest a more beautiful way of doing this? Bonus points if it works for both vectors and lists.</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":407,"score":1,"question_id":7787902,"title":"loop over dataframes in ggplot2","body":"<p>I would like to make a series of plots using ggplot from multiple different dataframes. I was planning on using a list and iterating over the list as follows:</p>\n\n<pre><code>libraries &lt;- objects() #make a list of the dataframes we want to graph\nfor(i in libraries) {\n  # create initial plots\n  x1 &lt;- qplot(data= i, V1, reorder(V2,V3), color = V3) + coord_flip()\n  x2 &lt;- ggplot(i, aes(x=reorder(V2,V3), group=V3, color=V3)) + geom_bar() \n  x3 &lt;- ggplot(i, aes(x=V1, group=V3, color=V3)) + coord_flip() + geom_bar()\n}\n</code></pre>\n\n<p>however I get the error message:</p>\n\n<pre><code>Error: ggplot2 doesn't know how to deal with data of class factor\n</code></pre>\n\n<p>presumably because 'libraries' is now a character variable and not a data frame. Any one have another suggestion on how to iterate through the dataframes? I suppose I could merge them with plyr and then ggplot a subset of the data but that seems to add more work. </p>\n"},{"tags":["r","variables","data","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13038992,"title":"Time-series data: How to code t-1 and t+1 based on value of specific variable in t0?","body":"<p>I am interested in learning how a specific factor such as foreign investments behaves 5 years before and after change, e.g. outbreak of civil war. </p>\n\n<p>This is the <em>structure of my data</em> (the factor is not included here):</p>\n\n<pre><code>year country   change  time  \n2001 A         0       ? (-1)\n2002 A         1       0     \n2003 A         0       ? (+1)\n2004 A         0       ? (+2)    \n2002 B         0       ? (-2)\n2003 B         0       ? (-1)\n2004 B         1       0\n...\n</code></pre>\n\n<p>I am seeking to replace the question marks by the respective values in brackets, e.g., \"-1\" for the year prior to change (t-1) and \"+1\" for the year following change (t+1). The presence of change is coded with 1.</p>\n\n<p>How would you do this? I am grateful for any suggestions. Many thanks!</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":2,"view_count":37,"score":-2,"question_id":13077648,"title":"Spectrum wind data","body":"<p>I have a time series vel of 72000 registers. I want to calculate the spectrum of this series but I use <strong>spectrum</strong> and <strong>fft</strong> functions but I think it is not the correct result. Let's see: </p>\n\n<pre><code>filetext &lt;- read.table('Sonic1u10Hz.dat');\nvel &lt;- filetext[,1];\nindexs &lt;- which(vel&gt;33)\nvel[c(indexs)] &lt;- NaN;\nvel &lt;- na.omit(vel);\nmean_value &lt;- mean(vel)\nsd_value &lt;- sd(vel)\n#spectrum\nvel_spec&lt;- spectrum(vel,log=\"yes\")\n#fourier transform\nfs=10;\nTime=1/fs;\nN=length(vel)\nNFFT= 2^ceiling(log2(N))\nvel_spec=fft(vel,NFFT)/N;\nf= fs/2*seq(0,1,length=NFFT/2+1)\nz=2*abs(vel_spec[1:(NFFT/2+1)])\nplot(f,z,log=\"xy\",type=\"l\")\ngrid()\n</code></pre>\n\n<p>First I need to obtain the spectra of the data. With these commmands I obtian something that it is not correct. Both graphics differ from each other why? \n<img src=\"http://i.stack.imgur.com/6xBS1.png\" alt=\"Spectrum function\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/NkI2Z.png\" alt=\"Fourier transfrom\"></p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1031,"score":4,"question_id":6202667,"title":"How to use subscripts in ggplot2 legends [R]","body":"<p>Can I use subscripts in ggplot2 legends? I see <a href=\"http://stackoverflow.com/questions/5293715/how-to-use-greek-symbols-in-ggplot2\">this question</a> on greek letters in legends and elsewhere, but I can't figure out how to adapt it.</p>\n\n<p>I thought that using <code>expression()</code>, which works in axis labels, would do the trick. But my attempt below fails. Thanks!</p>\n\n<pre><code>library(ggplot2)\ntemp &lt;- data.frame(a = rep(1:4, each = 100), b = rnorm(4 * 100), c = 1 + rnorm(4 * 100))\nnames(temp)[2:3] &lt;- c(\"expression(b[1])\", \"expression(c[1])\")\ntemp.m &lt;- melt(temp, id.vars = \"a\")\nggplot(temp.m, aes(x = value, linetype = variable)) + geom_density() + facet_wrap(~ a)\n</code></pre>\n"},{"tags":["arrays","r","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13083566,"title":"R generate matrix from linear table with column and row numbers","body":"<p>I am new in R and struggle with arrays.My question is very simple but I didnt find easy answer on the web or in R documentation.</p>\n\n<p>I have a table with column and row number that I want to use to generate a new matrix</p>\n\n<p>Original table:</p>\n\n<pre><code>    V1  V2     pval\n1    1    2    5.914384e-13\n2    1    3    8.143390e-01\n3    1    4    7.587818e-01\n4    1    5    9.734698e-12\n5    1    6    7.812521e-19\n</code></pre>\n\n<p>I want to use:</p>\n\n<ul>\n<li><code>V1</code> as the column number for the new matrix; </li>\n<li><code>V2</code> as the row number</li>\n<li><code>pvals</code> as the value</li>\n</ul>\n\n<p>Targeted matrix:</p>\n\n<pre><code>     1         2       3       4\n1    0         5e-1    8e-1    7e-1\n2    5e-13     0\n3    8e-1              0\n4    7e-1                      0\n</code></pre>\n"},{"tags":["java","r","rmysql","jri"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":162,"score":0,"question_id":6946131,"title":"RMySQL package doesn't load through JRI interface","body":"<p>I've managed to install RMySQL in R, and it runs fine (I also installed its required dependency, DBI, and it works fine too). I'm building a java application that interacts with R through the JRI package (which also works fine). Currently my application queries a MySQL database, writes the query results to file, and loads these files in R (by using the load.csv() function in R). However, the program would run more efficiently if R were to interact directly with MySQL (hence the RMySQL package).\n The problem that I'm having is that the RMySQL package will not load in R if I try to load it by using the Rengine.eval() JRI function. However, the Rengine.eval() function will load any other library that I've tried loading.\nHere's a snippet of the code:</p>\n\n<pre><code>Rengine re;\n\nre.eval(\"library(\\\"DBI\\\")\"); // this works, DBI will load\nre.eval(\"library(\\\"RMySQL\\\")\"); // this will not work, RMySQL fails to load\n</code></pre>\n\n<p>To verify that RMySQL is failing to load I did this:</p>\n\n<pre><code>REXP x;\nSystem.out.println(x=re.eval(\"library(\\\"DBI\\\")\"));\nSystem.out.println(x=re.eval(\"library(\\\"RMySQL\\\")\"));\n</code></pre>\n\n<p>I get the following output:</p>\n\n<p>[STRING* (\"DBI\", \"stats\", \"graphics\", \"grDevices\", \"utils\", \"datasets\", \"methods\", \"base\")]</p>\n\n<p>null</p>\n\n<p>As can be clearly seen, the second println command is returning a null which means that the RMySQL is failing to load (and of course none of the RMySQL functions work either). I have no idea why this is the case.</p>\n\n<p>I don't know what it is I'm doing wrong, but if someone can tell me what the problem is, or if there is a better way of loading libraries through JRI I would much appreciate it.</p>\n\n<p>Note that I am using R version 2.13.0 on sparc-sun-solaris2.10, and the RMySQL_0.8-0 build.</p>\n"},{"tags":["r","data.table"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13081821,"title":"How to speed up cummulative sum within group?","body":"<p>I have the following data frame:</p>\n\n<pre><code>id&lt;-c(1,1,1,1,1,3,3,3,3)\nspent&lt;-c(10,20,30,40,50,60,70,80,90)\ndate&lt;-c(\"11-11-07\",\"11-11-07\",\"23-11-07\",\"12-12-08\",\"17-12-08\",\"11-11-07\",\"23-11-07\",\"23-   11-07\",\"16-01-08\")\ndf&lt;-data.frame(id,date,spent)\ndf$date2&lt;-as.Date(as.character(df$date), format = \"%d-%m-%y\")\n\n\n id     date spent      date2\n1  1 11-11-07    10 2007-11-11\n2  1 11-11-07    20 2007-11-11\n3  1 23-11-07    30 2007-11-23\n4  1 12-12-08    40 2008-12-12\n5  1 17-12-08    50 2008-12-17\n6  3 11-11-07    60 2007-11-11\n7  3 23-11-07    70 2007-11-23\n8  3 23-11-07    80 2007-11-23\n9  3 16-01-08    90 2008-01-16\n</code></pre>\n\n<p>I need to calculate the sum <code>spent</code> by each <code>id</code> per day and include it in the frame work as follow:</p>\n\n<pre><code> id     date spent      date2    sum.spent\n1  1 11-11-07    10 2007-11-11    10\n2  1 11-11-07    20 2007-11-11    30 \n3  1 23-11-07    30 2007-11-23    30\n4  1 12-12-08    40 2008-12-12    40\n5  1 17-12-08    50 2008-12-17    50\n6  3 11-11-07    60 2007-11-11    60\n7  3 23-11-07    70 2007-11-23    70\n8  3 23-11-07    80 2007-11-23    150\n9  3 16-01-08    90 2008-01-16    90 \n</code></pre>\n\n<p>The following script works well (except for the first row which is not a big deal):</p>\n\n<pre><code>df$spent2&lt;-NA\nfor (a in 2:9)\nif (df[a,1]==df[a-1,1]&amp;&amp; df[a,4]==df[a-1,4])\n(df[a,5]=df[a,3]+df[a-1,3])else(df[a,5]=df[a,3])\n</code></pre>\n\n<p>However since the number of rows in my actual dataset is around 1.5 million, the above script takes around 5 days to be executed. I wonder if you can suggest a more efficient way to write this code and achieve the same objective. </p>\n"},{"tags":["r","integration"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":3684,"score":4,"question_id":4954507,"title":"Calculate the Area under a Curve in R","body":"<p>I would like to calculate the area under a curve to do integration without defining a function such as in integrate().</p>\n\n<p>My data looks as this:</p>\n\n<pre><code>Date          Strike     Volatility\n2003-01-01    20         0.2\n2003-01-01    30         0.3\n2003-01-01    40         0.4\netc.\n</code></pre>\n\n<p>I plotted plot(strike, volatility) to look at the volatility smile. Is there a way to integrate this plotted \"curve\"?</p>\n\n<p>Thanks for help\nDani</p>\n"},{"tags":["arrays","r","matrix","matrix-multiplication"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":5951,"score":2,"question_id":3823211,"title":"How to convert a matrix to a 1 dimensional array in R","body":"<p>Hi I have a matrix file that is 32X48 and I want to put all of the values into a single dimensional array in R.  Right now I am only able to get the last row of data.  </p>\n\n<pre><code>trgtFN_intensity &lt;- \"1074_B09_1- 4_5mM_Xgal_7d_W.cropped.resized.grey.png.red.median.colony.txt\";\n\nread.table(trgtFN_intensity, sep=\"\\t\") -&gt; tmp_int\n\nmaxrow_int &lt;- nrow(tmp_int);\nmaxcol_int &lt;- ncol(tmp_int);\n\nElts_int &lt;- -10;\nfor (row in 1:maxrow_int){rbind(Elts_int, tmp_int[row,]) -&gt; Elts_int;}\nav_int &lt;- mean(Elts_int[Elts_int!=-10]);\nsd_int &lt;- sd(Elts_int[Elts_int!=-10]);\n\npenalty_Matrix &lt;- matrix(0, nrow=1536, ncol=1);\nfor (row in 1:maxrow_int)\n{\n    for (col in 1:maxcol_int)\n{ \n    penalty_Matrix[col] &lt;- tmp_int[row, col];\n\n}\n}\n\noutFN &lt;- paste(trgtFN_intensity, \"array\", sep=\".\");\nwrite.table(penalty_Matrix, file = outFN, col.names=F, row.names=F, sep =\"\\t\")\n</code></pre>\n\n<p>Any help would be greatly appreciated.  Thank you</p>\n"},{"tags":["r","sampling","simulation","matrix"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13083089,"title":"How to replace an element of a symmetric matrix randomly?","body":"<p>Suppose I have a matrix like so:</p>\n\n<pre><code>data=matrix(c(1,0,0,0,0,0,1,0,0.6583,0,0,0,1,0,0,0,0.6583,0,1,0,0,0,0,0,1),nrow=5,ncol=5)\n\n     [,1]   [,2] [,3]   [,4] [,5]\n[1,]    1 0.0000    0 0.0000    0\n[2,]    0 1.0000    0 0.6583    0\n[3,]    0 0.0000    1 0.0000    0\n[4,]    0 0.6583    0 1.0000    0\n[5,]    0 0.0000    0 0.0000    1\n</code></pre>\n\n<p>How do I create another matrix, say \"data2\", such that it has the same number of off-diagonal nonzero elements as \"data\" but in another location other than the one in data? The randomly simulated data will be uniform (so runif).</p>\n"},{"tags":["r","rotation","plot"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2434,"score":2,"question_id":3792803,"title":"Is it possible to rotate a plot in R (base graphics)?","body":"<p>I searched for this and found that with {grid} there are ways to rotate an image, and that for some plots you can play with their rotation (for example plot(x,y) instead of plot(y,x)). </p>\n\n<p>However, I want to know if there is <strong>a generic method to rotate a plot in R</strong> (one that would work for ANY plot generated in base graphics) ?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13082638,"title":"Why merge produces unexpected result when the rows of the matching columns have only one unique value?","body":"<p>When I say unexpected, I mean unexpected for me. Allow me to illustrate. We have the two data.frames:</p>\n\n<pre><code>b1&lt;-data.frame(a=c(\"a\",\"b\"),b=1:2)\nb2&lt;-data.frame(a=c(\"a\",\"b\"),c=1:2)\n</code></pre>\n\n<p>Merge produces the following</p>\n\n<pre><code>&gt; merge(b1,b2)\n  a b c\n1 a 1 1\n2 b 2 2\n</code></pre>\n\n<p>But when we have the data.frames </p>\n\n<pre><code>b1&lt;-data.frame(a=c(\"a\",\"a\"),b=1:2)\nb2&lt;-data.frame(a=c(\"a\",\"a\"),c=1:2)\n</code></pre>\n\n<p>merge produces the </p>\n\n<pre><code>&gt; merge(b1,b2)\n  a b c\n1 a 1 1\n2 a 1 2\n3 a 2 1\n4 a 2 2\n</code></pre>\n\n<p>when I expect</p>\n\n<pre><code>  a b c\n  a 1 1\n  a 2 2\n</code></pre>\n\n<p>Why the two different results? </p>\n"},{"tags":["r","plot","xts"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1956,"score":3,"question_id":6165239,"title":"Remove y-axis label from plot of an xts object","body":"<p>Here is the code generating a plot of an xts object:</p>\n\n<pre><code>require(\"quantmod\")\ngetSymbols(\"SPY\")\nplot(Cl(SPY))\n</code></pre>\n\n<p>Which yields the following plot:</p>\n\n<p><img src=\"http://i.stack.imgur.com/gCoSH.png\" alt=\"graph\"></p>\n\n<p>Can you remove the y-axis values (the prices) from a plot of an xts object? </p>\n\n<p><em>Hint</em>: <em>passing</em> <code>yaxt='n'</code> <em>doesn't work</em>.</p>\n"},{"tags":["r","duplicates","data.frame"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1098,"score":0,"question_id":6986657,"title":"Find duplicated Column pairs in Data Frame in R","body":"<p>I have a data frame in R which looks like:</p>\n\n<pre><code>RIC     Date                    Open\n\nS1A.PA, 2011-06-30 20:00:00,    23.7\n\nABC.PA, 2011-07-03 20:00:00,    24.31\n\nEFG.PA, 2011-07-04 20:00:00,    24.495\n\nS1A.PA, 2011-07-05 20:00:00,    24.23\n</code></pre>\n\n<p>.........</p>\n\n<p>I want to know if there's any duplicates regarding to the combination of RIC and Date. Is there a function for that in R?</p>\n"},{"tags":["mysql","r","odbc"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":785,"score":1,"question_id":4653430,"title":"How to set charset for MySQL in RODBC?","body":"<p>I have a data with chinese characters as field names and data, I have imported them from xls to access 2007 and export them to ODBC. Then I use RODBC to read them in R, the field names is OK, but for the data, all of the chinese characters are shown as <code>?</code>.</p>\n\n<p>I have read the <a href=\"http://hosho.ees.hokudai.ac.jp/~kubo/Rdoc/library/RODBC/html/odbcConnect.html\" rel=\"nofollow\">RODBC manual</a> and it said: </p>\n\n<p><code>If it is possible to set the DBMS or ODBC driver to communicate in the character set of the R session then this should be done. For example, MySQL can set the communication character set via SQL, e.g. SET NAMES 'utf8'.</code></p>\n\n<p>I guess this is the problem, but how can I provide this command to MySQL via RODBC? Thanks!</p>\n"},{"tags":["r","xts","quantmod"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13082196,"title":"monthlyReturn for multivariate XTS","body":"<p>I have an XTS called AUM which has 5 columns</p>\n\n<pre><code>head(AUM)\n             FXI.Adjusted X2823.HK.Adjusted HSCE.Adjusted X3049.HK.Adjusted HSI.Adjusted\n2010-04-08     100.0000          100.0000      100.0000          100.0000     100.0000\n2010-04-09     100.9009          100.9009      100.9009          100.9009     100.9009\n2010-04-12     100.4474          100.6022      100.1916          100.1448     100.0890\n2010-04-13     101.7668          101.8123      101.6008          101.4299     101.4111\n2010-04-14     102.1177          102.3792      101.9873          101.7272     101.7813\n2010-04-15     102.0445          102.1387      101.7266          101.5462     101.4893\n</code></pre>\n\n<p>I want to calculate monthly returns for each column.  I can do it for one column by calling <code>monthlyReturn(AUM[,1])</code> but I cannot get it calculate monthly returns for all five columns and return a multivariate XTS.</p>\n\n<p>I tried this <code>apply(AUM, 2, monthlyReturn)</code> but I get the error </p>\n\n<pre><code>Error in array(r, dim = d, dimnames = if (!(is.null(n1 &lt;- names(x[[1L]])) &amp;  : \n  length of 'dimnames' [1] not equal to array extent\n</code></pre>\n\n<p>Any help much appreciated.  Thanks in advanced.</p>\n"},{"tags":["arrays","performance","r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13081611,"title":"Most efficient way to fill out a matrix of elements given by function f(i,j) in R?","body":"<p>I have a function of two scalar values <code>x_i</code>, <code>y_j</code>.  I have a vector of n <code>x_i</code> values, X and n <code>y_j</code> values, e.g.</p>\n\n<pre><code>myfunction &lt;- function(x,y) min(x,y)\nX &lt;- 1:3\nY &lt;- 2:4\n</code></pre>\n\n<p>I want to fill out the $n$ by $n$ matrix whose elements <code>(i,j)</code> are given by <code>myfunction(x_i, y_j)</code>.  There's a lot of ways to do this in <code>R</code>, and I'm curious about their relative performance.</p>\n\n<p>For instance, this seems like a task for <code>outer</code>, but it seems to get confused whether it is passing a vector or scalar to <code>myfunction</code>.  First consider: </p>\n\n<p><code>r\n    outer(X, Y, paste)\n</code></p>\n\n<p>gives me each of the pairs</p>\n\n<pre><code>     [,1]  [,2]  [,3] \n[1,] \"1 2\" \"1 3\" \"1 4\"\n[2,] \"2 2\" \"2 3\" \"2 4\"\n[3,] \"3 2\" \"3 3\" \"3 4\"\n</code></pre>\n\n<p>Looks good.  But </p>\n\n<pre><code>outer(X, Y, myfunction)\n</code></pre>\n\n<p>throws the error:</p>\n\n<pre><code>Error: dims [product 9] do not match the length of object [1]\n</code></pre>\n\n<p>Meanwhile other possible functions seem to behave as I expected with scalars, such as:</p>\n\n<pre><code>myfunction &lt;- function(x,y) exp((x-y)^2)\n</code></pre>\n\n<p>which works fine</p>\n\n<pre><code>outer(X, Y, myfunction)\n\n\n         [,1]      [,2]        [,3]\n[1,] 2.718282 54.598150 8103.083928\n[2,] 1.000000  2.718282   54.598150\n[3,] 2.718282  1.000000    2.718282\n</code></pre>\n\n<p>In a few quick numerical experiments, it seems this is slightly faster than <code>expand.grid</code>, and the function call more compact, but I don't seem to understand why some functions appear to work as I anticipate and others do not.  </p>\n\n<p>The classic <code>expand.grid</code> solution also requires the function to work with vector arguments, which means a very different thing for my example with <code>min</code>; a different version of the same problem.  Is there a way to enforce the fact that the arguments to my function must be scalars rather than vectors?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":2,"view_count":65,"score":-1,"question_id":13080184,"title":"How could I force R to show 0.000 instead of 0?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2287616/controlling-digits-in-r\">Controlling digits in R</a>  </p>\n</blockquote>\n\n\n\n<p>Is there way to show up to the 3rd decimal place of every number in a matrix in R for numbers like 0.12 or 0?  I want to force R to show 0.120 and 0.000 instead of 0.12 or 0.</p>\n\n<p>I want to do this because my ultimate goal is to export an R matrix to latex as a table.</p>\n"},{"tags":["r","comments"],"answer_count":6,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":3656,"score":8,"question_id":4131338,"title":"Is it possible to have a multi-line comments in R?","body":"<p>I found this <a href=\"http://r.789695.n4.nabble.com/How-to-comment-in-R-tt882882.html#none\" rel=\"nofollow\">old thread</a> (from over a year ago), which explains how come R doesn't support a multi-line comments (like /*  comment */ of PHP, for example).</p>\n\n<p>I am wondering if this has been resolved in the past year, or if there are other alternatives?  (For example, in notepad++ with npptor, you can mark a bunch of lines and press ctrl+q to mark them all as comments, are there similar solutions for other IDE's ?)</p>\n"},{"tags":["r","plyr"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":1,"view_count":76,"score":4,"question_id":13065904,"title":"R aggregate with multiple arguments in function","body":"<p>Im tryng to avoid a time consuming for loop by using an aggregate on a data.frame. But I need that the values of one of the columns enters in the final computation.</p>\n\n<pre><code>dat &lt;- data.frame(key = c('a', 'b', 'a','b'), \nrate = c(0.5,0.4,1,0.6), \nv1 = c(4,0,3,1), \nv2 = c(2,0,9,4))\n\n&gt;dat\n  key rate v1 v2\n1   a  0.5  4  2\n2   b  0.4  0  0\n3   a  1.0  3  9\n4   b  0.6  1  4\n\naggregate(dat[,-1], list(key=dat$key),  \n    function(x, y=dat$rate){\n        rates &lt;- as.numeric(y)\n        values &lt;- as.numeric(x)\n        return(sum(values*rates)/sum(rates))\n    })\n</code></pre>\n\n<p>Note: The function is just an example!<br>\nThe problem of this implementation is that <code>y=dat$rate</code> gives all 4 rates on dat, when what I want is just the 2 aggregated rates!\nAnny sugestion on how I could do this?\nThanks!</p>\n"},{"tags":["r","date","vector","unique"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12829306,"title":"When counting unique factors in a data frame, how do I retain a value from another vector?","body":"<p>The data from my data frame \"lotsadates\" looks like this:</p>\n\n<pre><code>&gt;Date\n\n1 2012-09-26\n2 2012-09-26\n3 2012-09-26\n4 2012-09-27\n5 2012-09-28\n6 2012-09-28\n</code></pre>\n\n<p>There is a day_of_week vector of the same length:<br /></p>\n\n<pre><code>&gt; day_of_week\n\n1 3\n2 3\n3 3\n4 4\n5 5\n6 5\n</code></pre>\n\n<p>I am using the following to count the number of observations by date:<br/></p>\n\n<pre><code>ndist &lt;-tapply(1:NROW(lotsadates), \n               lotsadates$Date, \n               function(x) length(unique(x)))\n</code></pre>\n\n<p>So ndist looks like this:<br /></p>\n\n<blockquote>\n  <p>Obs / Date / ndist<br > \n  1 / 2012-09-26 / 3<br/>\n  2 / 2012-09-27 / 1<br/>\n  3 / 2012-09-28 / 2<br /></p>\n</blockquote>\n\n<p>But I want ndist to look like this:</p>\n\n<blockquote>\n  <p>Date / ndist / day_of_week <br > \n  1 / 2012-09-26 / 3 / 3<br/>\n  2 / 2012-09-27 / 1 / 4<br />\n  3 / 2012-09-28 / 2 / 5<br /></p>\n</blockquote>\n\n<p>I think there is a fairly simple solution but I can't figure it out.  Your suggestions are much appreciated!</p>\n"},{"tags":["r","bioconductor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12881174,"title":"R reading annotation columns by read.ilmn of package limma","body":"<p>Package <a href=\"http://bioconductor.org/packages/release/bioc/html/limma.html\" rel=\"nofollow\">limma</a> is one of the best - or even the best - package for reading microarray - and recently RNA-seq - experiment results and doing other process like normalization, fitting linear models, finding top differentially expressed genes, making plots and so on.</p>\n\n<p>I have a minor problem in <code>read.ilmn()</code> function for reading illumina results: Suppose there are some annotation columns - i.e. ENTREZ_GENE_ID, REFSEQ_ID, and so on. These columns are needed to be read in addition to the expression columns - i.e. PROBE_ID, SYMBOL, AVG_Signal and Detection.Pval - for later analysis. </p>\n\n<p>I have tried to pass the names of these columns as the <code>annotation</code> and <code>other.columns</code> arguments of <code>read.ilmn()</code> informing this command to read these columns also, resulting in failure of <code>read.ilmn()</code>. Finally I had to read these columns separately by a <code>read.table()</code> command and merging them manually with <code>read.ilmn()</code> results.</p>\n\n<p>Is there any better way to perform the mission?</p>\n"},{"tags":["r","venn-diagram"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":50,"score":5,"question_id":13079274,"title":"Unexpected venneuler output","body":"<p>I'm trying to understand how <code>venneuler</code> works and it outputs a venn diagram I wouldn't expect.  I like to work with simple examples when I'm trying to understand something.  I'm supplying the matrix below which I believe is :</p>\n\n<blockquote>\n  <p>a logical or numeric matrix whose columns represent sets and\n  co-occurrence is \n      defined by non-zero (rep. TRUE) values in rows (weight for a row being 1 for \n      logical matrices or the row sum for numeric matrices). -venneular manual-</p>\n</blockquote>\n\n<p>I would expect if two things both have 1's or 0's in the same row they'd have overlap in their venn.  So in this matrix w and z have no 1's or 0's in common.  I'd expect their venn's not to overlap but they do (see figure 1 below).  Why?  If I'm supplying wrong information or it needs to be reformatted please explain.  If it's in the calculations of <code>venneular</code> please explain that.</p>\n\n<pre><code>     w x y z\n[1,] 1 0 1 0\n[2,] 0 0 1 1\n[3,] 0 0 1 1\n[4,] 1 1 0 0\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/KAUZ8.png\" alt=\"https://dl.dropbox.com/u/61803503/venn.1.png\"></p>\n\n<p>The code for the above:</p>\n\n<pre><code>library(venneuler)\nw &lt;- c(1,0,0,1)\nx &lt;- c(0, 0, 0, 1)\ny &lt;- c(1, 1, 1,0)\nz &lt;- c(0, 1, 1,0)\na &lt;- cbind(w, x, y, z)       \nv &lt;- venneuler(a)\nplot(v)\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":36,"score":-3,"question_id":13080160,"title":"Role of vetctor after applying sort function to a matrix in R","body":"<p>What's the role of vector <code>I</code>after applying sort to column of matrix <code>s</code>?</p>\n\n<pre><code>    n = 10\n    I = c(2, 8)\n    s = matrix(runif(n*20), nrow=20)\n    M  = apply(s, 2, sort)[I,]\n</code></pre>\n\n<p>Could we write this code in another eaiser way?</p>\n"},{"tags":["r","gcc","hadoop","cloudera","rcpp"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13080053,"title":"GCC in error when compiling R package on Cloudera CDH4","body":"<p>I am trying to install RHadoop on Cloudera's CDH4 Hadoop VM.  RHadoop is a framework for using Hadoop via an R programming interface.  One of the prerequisites to installing the RHadoop R package \"rmr\" is another R package called Rcpp, which is for calling C++ code from R.  When I attempt to install the package, I get the following error.  I contacted both the Rcpp and RHadoop communities and both say its a GCC problem.  When I try to update or reinstall GCC, I get\n\"Package gcc-4.4.6-4.e16.x86_64 already installed and latest version, nothing to do.\"  Any suggestions?</p>\n\n<p>Here is the error (from the R command line).</p>\n\n<pre><code>&gt; install.packages(\"Rcpp\")\nInstalling package(s) into ‘/usr/lib64/R/library’\n(as ‘lib’ is unspecified)\n--- Please select a CRAN mirror for use in this session ---\nLoading Tcl/Tk interface ... done\n trying URL 'http://cran.csdb.cn/src/contrib/Rcpp_0.9.15.tar.gz'\nContent type 'application/x-gzip' length 2119769 bytes (2.0 Mb)\nopened URL\n ==============================\n====================\ndownloaded 2.0 Mb\n\n* installing *source* package ‘Rcpp’ ...\n** package ‘Rcpp’ successfully unpacked and MD5 sums checked\n** libs\ng++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Date.cpp -o Date.o\n g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c DateVector.cpp -o DateVector.o\n g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Datetime.cpp -o Datetime.o\n g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c DatetimeVector.cpp -o DatetimeVector.o\n g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Dimension.cpp -o Dimension.o\n g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c DottedPair.cpp -o DottedPair.o\n g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Environment.cpp -o Environment.o\n g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Evaluator.cpp -o Evaluator.o\n g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Formula.cpp -o Formula.o\n g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Function.cpp -o Function.o\n g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Language.cpp -o Language.o\n g++ -m64 -I/usr/include/R -DNDEBUG -I../inst/include/ -I/usr/local/include    -fpic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic  -c Module.cpp -o Module.o\n {standard input}: Assembler messages:\n{standard input}:10671: Warning: end of file not at end of a line; newline inserted\n{standard input}:11544: Error: bad register name `%'\n{standard input}:11544: Error: open CFI at the end of file; missing .cfi_endproc directive\n g++: Internal error: Killed (program cc1plus)\nPlease submit a full bug report.\nSee &lt;http://bugzilla.redhat.com/bugzilla&gt; for instructions.\nmake: *** [Module.o] Error 1\n ERROR: compilation failed for package ‘Rcpp’\n* removing ‘/usr/lib64/R/library/Rcpp’\n\nThe downloaded source packages are in\n    ‘/tmp/RtmpGdXO9h/downloaded_packages’\nUpdating HTML index of packages in '.Library'\n Making packages.html  ... done\nWarning message:\nIn install.packages(\"Rcpp\") :\n  installation of package ‘Rcpp’ had non-zero exit status\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13061702,"title":"save failing: unable to initialise lzma encoder","body":"<p>I've been frustrated by this problem for the last few days and can't solve it. </p>\n\n<p>Here's what I am doing. I've got a data frame, <code>foo</code> and I'm trying to save it to a <code>rda</code> file for the purposes of including it in a package I am developing. Using <code>save(foo, file=\"foo.rda\", compress=TRUE)</code> works fine. However, when I use <code>save(foo, file=\"foo.rda\", compress=\"xz\")</code> it doesn't work and I get an error message:</p>\n\n<pre><code>Error in xzfile(file, \"wb\", compression = 9) : cannot open the connection\nIn addition: Warning message:\nIn xzfile(file, \"wb\", compression = 9) :\n  cannot initialize lzma encoder, error 5\n</code></pre>\n\n<p>I've tried tracing this back through <code>xzfile</code> and its <code>.Internal</code> C code and been unable to figure out what is causing this.  I understand that using \"xz\" compression is the preferred option for packages (and has yielded a smaller file when this was working for me). I have both WinZip and 7-zip 9.20 installed, doesn't R have a binary for lzma compression baked into the build?</p>\n\n<p>I thought it might be an R 2.15.1 issue. So I rolled back to 2.14.2, but this didn't help. I can't see anything wrong with my PATH environment variable.</p>\n\n<p>Obligatory <code>sessionInfo()</code> dump:</p>\n\n<pre><code>R version 2.15.1 (2012-06-22)\nPlatform: i386-pc-mingw32/i386 (32-bit)\n\nlocale:\n[1] LC_COLLATE=English_Australia.1252  LC_CTYPE=English_Australia.1252   \n[3] LC_MONETARY=English_Australia.1252 LC_NUMERIC=C                      \n[5] LC_TIME=English_Australia.1252    \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] stringr_0.6.1   lubridate_1.2.0 wbctools_0.8.6  testthat_0.7    devtools_0.8   \n\nloaded via a namespace (and not attached):\n[1] digest_0.5.2    evaluate_0.4.2  httr_0.2        memoise_0.1     parallel_2.15.1\n[6] plyr_1.7.1      RCurl_1.95-1.1  tools_2.15.1    whisker_0.1\n</code></pre>\n\n<p>Many thanks.    </p>\n"},{"tags":["r","list","for-loop","lapply"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13079449,"title":"use a for loop or lapply to iterate through different dataframes in a list in R","body":"<p>I apologize if this question seems rudimentary. I'm a bit unclear on if it's possible / how to use for loops with a list of data frames in R.</p>\n\n<p>I have dataframes that are subsets of a larger dataframe:</p>\n\n<pre><code>billysuzy &lt;- subset(userlist,user1 %in% c(\"billy\",\"suzy\"))\njoefrank&lt;- subset(userlist,user1 %in% c(\"joe\",\"frank\"))\ngeorgelenny &lt;- subset(userlist,user1 %in% c(\"george\",\"lenny\"))\n</code></pre>\n\n<p>I would like to loop through and find correlation values for the same variables (time and simscore) for each subset.</p>\n\n<pre><code>cor(time, simscore)\n</code></pre>\n\n<p>However, I am quite uncertain how to structure such a for loop and unsure how to structure a function to attach and detach within lapply. </p>\n\n<p>I was thinking:</p>\n\n<pre><code>somelist &lt;- list(billysuzy, joefrank, georgelenny)\n</code></pre>\n\n<p>with lapply:</p>\n\n<pre><code>corz &lt;-  lapply(somelist, function(df)  detach(), attach(df),cor(time, simscore))\nlapply(corz, print)    \n</code></pre>\n\n<p>or with for:</p>\n\n<pre><code>for (i in 1:length(somelist)){\n      detach()\n     attach(somelist[i])\n    cor(time, simscore)\n    }\n</code></pre>\n\n<p>I apologize for offending anyone's R sensibilities or if the seems like two questions - the answer is any which describes how to do the one thing i.e. loop through the dfs in the list and find there corr values.</p>\n"},{"tags":["r","csv","append"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13079387,"title":"How to add data by columns in csv file using R?","body":"<p>I have information that is contained in vectors, for example:</p>\n\n<pre><code>sequence1&lt;-seq(1:20)\nsequence2&lt;-seq(21:40)\n...\n</code></pre>\n\n<p>I want to append that data to a file, so I am using:</p>\n\n<pre><code>write.table(sequence1,file=\"test.csv\",sep=\",\",append=TRUE,row.names=FALSE,col.names=FALSE)\nwrite.table(sequence2,file=\"test.csv\",sep=\",\",append=TRUE,row.names=FALSE,col.names=FALSE)\n</code></pre>\n\n<p>But the issue is that this is added all in one column like:</p>\n\n<pre><code>1\n2\n3\n...\n21\n22\n...\n40\n</code></pre>\n\n<p>I want to add that data in columns so that it ends up like:</p>\n\n<pre><code>1         21\n2         22\n3         23\n...       ...\n20        40\n</code></pre>\n\n<p>How I can do that using R?</p>\n"},{"tags":["r","singular"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":39,"score":4,"question_id":13078909,"title":"system is computationally singular: reciprocal condition number","body":"<p>I know, this is a fairly common question and I am really disappointed that I could not find a solution. \nI am trying to calculate Mahalanobis distances in a data frame, where I have several hundreds groups and several hundreds of variables. </p>\n\n<p>Whatever I do, however I subset it I get the \"system is computationally singular: reciprocal condition number\" error. \nI know what it means and I know what should be the problem, but there is no way this is a singular matrix. </p>\n\n<p>I have uploaded the input file to my ftp:  <a href=\"http://mkk.szie.hu/dep/talt/lv/CentInpDuplNoHeader.txt\" rel=\"nofollow\">http://mkk.szie.hu/dep/talt/lv/CentInpDuplNoHeader.txt</a>\nIt is a tab delimited txt file with no headers. </p>\n\n<p>I was working with the StatMatch Mahalanobis function.\nI have a deadline for this project (not a homework:)), and I could always use this funct, so I thought I will be able to quit the calculations short, but now I am just lost. </p>\n\n<p>I would really appreciate any help. </p>\n\n<p>Thanks for any help</p>\n"},{"tags":["r","matlab","gis","area","polygons"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":13038602,"title":"areaint in Matlab vs. areaPolygon or areapl in R","body":"<p>I am getting two different sets of values when I try to calculate the polygon area in Matlab vs. R. In Matlab, I used areaint (with the reference ellipsoid set to WGS84). In R, I tried both geosphere::areaPolygon on lat-lon or splancs::areapl on grid-converted Euclidean coordinates. The R results agree with each other, but not with the Matlab calculation. The two sets are on average 25% different (Matlab lower). What am I missing?</p>\n"},{"tags":["r","nlp","corpus","lda"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":11485344,"title":"Better to learn Latent Dirichlet Allocation on single corpus or multiple corpora when word usage may differ?","body":"<p>I am using Jonathan Chang's <code>lda</code> package for R comparing news stories from both state-friendly and independent media outlets in a non-democracy (for a similar approach, see Hall, Jurafsky, and Manning's piece on studying the history of ideas in linguistics). </p>\n\n<p>I am interested in the extent to which they cover the same topics and how they cover them. I can't figure out, however, if I should estimate one model across all corpora or if I should estimate different models for the different kinds of sources. On the one hand, I expect them to cover mostly the same <em>topics</em> (in the colloquial sense), but I also expect their word choices to be different, which would generate different \"topics\" (in the LDA/word-grouping sense).</p>\n\n<p>Does anyone have any experience with this or advice?</p>\n"},{"tags":["linux","r","ubuntu","rgdal"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13079050,"title":"How to install rgdal on Ubuntu 12.10?","body":"<p>I'm strugling to install <code>rgdal</code> library on Ubuntu 12.10.</p>\n\n<p>Installation from within R results in error:</p>\n\n<blockquote>\n  <p>Error: gdal-config not found The gdal-config script distributed with\n  GDAL could not be found. If you have not installed the GDAL libraries,\n  you can download the source from  <a href=\"http://www.gdal.org/\" rel=\"nofollow\">http://www.gdal.org/</a> If you have\n  installed the GDAL libraries, then make sure that gdal-config is in\n  your path. Try typing gdal-config at a shell prompt and see if it\n  runs. If not, use: \n  --configure-args='--with-gdal-config=/usr/local/bin/gdal-config' with appropriate values for your installation.</p>\n  \n  <p>ERROR: configuration failed for package ‘rgdal’\n  * removing ‘/home/rdk/R/x86_64-pc-linux-gnu-library/2.15/rgdal’ Warning in install.packages :   installation of package ‘rgdal’ had\n  non-zero exit status</p>\n</blockquote>\n\n<p><a href=\"https://stat.ethz.ch/pipermail/r-sig-geo/2010-June/008464.html\" rel=\"nofollow\">R-sig-Geo</a>, <a href=\"http://stackoverflow.com/questions/12141422/error-gdal-config-not-found\">this</a> <a href=\"http://stackoverflow.com/questions/12141422/error-gdal-config-not-found\">two</a> SE questions and other websites pointed me to the requirements of <code>libgdal1-dev</code>.</p>\n\n<p>But when I tried </p>\n\n<blockquote>\n  <p>sudo apt-get install libgdal1-dev</p>\n</blockquote>\n\n<p>I end up with another error message</p>\n\n<blockquote>\n  <p>Some packages could not be installed. This may mean that you have\n  requested an impossible situation or if you are using the unstable\n  distribution that some required packages have not yet been created or\n  been moved out of Incoming. The following information may help to\n  resolve the situation:</p>\n  \n  <p>The following packages have unmet dependencies:  libgdal1-dev :\n  Depends: libgdal-dev but it is not going to be installed E: Unable to\n  correct problems, you have held broken packages.</p>\n</blockquote>\n\n<p>Again - when I try to install <code>libgdal-dev</code> another dependencies error shows up</p>\n\n<blockquote>\n  <p>The following packages have unmet dependencies:  libgdal-dev :\n  Depends: libgeos-dev but it is not going to be installed\n                 Depends: libspatialite-dev but it is not going to be installed</p>\n</blockquote>\n\n<p>Again trying  <code>libgeos-dev</code> gives message:</p>\n\n<pre><code>Depends: libgeos-c1 (= 3.3.3-1.1) but 3.3.3-2~precise2 is to be installed\nE: Unable to correct problems, you have held broken packages.\n</code></pre>\n\n<p>and <code>libspatialite-dev</code>:</p>\n\n<pre><code>Depends: libspatialite3 (= 3.1.0~rc2-1ubuntu1) but\n3.1.0~rc2-2~precise1 is to be installed\n</code></pre>\n\n<p>Is there any way to tame those dependencies and have <code>rgdal</code> running in Ubuntu?</p>\n\n<p>My <code>sessionInfo()</code></p>\n\n<blockquote>\n  <p>R version 2.15.1 (2012-06-22) \n  Platform: x86_64-pc-linux-gnu (64-bit)</p>\n</blockquote>\n"},{"tags":["r","reshape"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":50,"score":4,"question_id":13061737,"title":"reshaping a data frame into long format in R","body":"<p>I'm struggling with a reshape in R.  I have 2 types of error (err and rel_err) that have been calculated for 3 different models.  This gives me a total of 6 error variables (i.e. err_1, err_2, err_3, rel_err_1, rel_err_2, and rel_err_3).  For each of these types of error I have 3 different types of predivtive validity tests (ie random holdouts, backcast, forecast).  I would like to make my data set long so I keep the 4 types of test long while also making the two error measurements long.  So in the end I will have one variable called err and one called rel_err as well as an id variable for what model the error corresponds to (1,2,or 3)</p>\n\n<p>Here is my data right now:</p>\n\n<pre><code>iter       err_1  rel_err_1      err_2  rel_err_2      err_3  rel_err_3 test_type\n1 -0.09385732 -0.2235443 -0.1216982 -0.2898543 -0.1058366 -0.2520759    random\n1  0.16141630  0.8575728  0.1418732  0.7537442  0.1584816  0.8419816    back\n1  0.16376930  0.8700738  0.1431505  0.7605302  0.1596502  0.8481901    front\n1  0.14345986  0.6765194  0.1213689  0.5723444  0.1374676  0.6482615    random\n1  0.15890059  0.7435382  0.1589823  0.7439204  0.1608709  0.7527580    back\n1  0.14412360  0.6743928  0.1442039  0.6747684  0.1463520  0.6848202    front\n</code></pre>\n\n<p>and here is what I would like it to look like:</p>\n\n<pre><code>iter     model    err           rel_err    test_type\n1        1        -0.09385732    (#'s)     random\n1        2        -0.1216982     (#'s)     random\n1        3        -0.1216982     (#'s)     random\n</code></pre>\n\n<p>and on...</p>\n\n<p>I've tried playing around with the syntax but can't quite figure out what to put for the time.varying argument</p>\n\n<p>Thanks very much for any help you can offer.</p>\n"},{"tags":["r","plot","mcmc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13078242,"title":"R code mcmcplots function","body":"<p>Is there a way to make the R <code>mcmcplot()</code> function not open a browser when it's called? I need to run my R code on a cluster and if <code>mcmcplot()</code> tries to open a browser, it will puke. </p>\n\n<p>Can the output be dumped to a file maybe? </p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13078416,"title":"Speed up read.table in R?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1727772/quickly-reading-very-large-tables-as-dataframes-in-r\">Quickly reading very large tables as dataframes in R</a>  </p>\n</blockquote>\n\n\n\n<p>I need to repeatedly read different sections of data from a big (more than 50MB) text file. Currently, my code is working, but it will take 30 seconds to finish 1 iteration. Can anyone help me to improve the efficiency of my code?</p>\n\n<p>My code:</p>\n\n<pre><code>Skip_s=c(88334, 92244, 92635, 96154, 96545, 100455, 100846, 104365, 104756, \n         112967, 123524, 134081, 145929, 156877, 170171, 183856, 194804, 206143,\n         217482, 230385, 245243, 255800)   #starting number of rows\n\nnrows_s=c(380) #the length of code I will read\nfor (k in 1:length(Skip_s)){\n    bb = read.table(\"file\",skip=Skip_s[k]-1, nrows=nrows_s, colClasses = c(\"character\",rep(\"numeric\",6)))\n    #I use read.table is because it can break the loaded information into columns\n    TOT_s[k,1,Ite] = mean(bb$V4[1:105])  \n    TOT_s[]..... #I have 20 this statements \n}\n</code></pre>\n\n<p>The complete version of the above code will take 30 seconds. Most of the time are spent on <code>read.table</code>. I am thinking is there a way to optimize it?</p>\n\n<p>Here is an example of data read by read.table function</p>\n\n<pre><code> CNC HORIZON     COMPARTMENT      TOTAL      ADSORBED   DISSOLVED  GAS CONC.\n CNC                              (MG/KG)    (MG/KG)    (MG/L)     (MG/L)\n CNC --------------------------------------------------------------------------\n CNC\n CNC\n CNC   1            1             0.4062     0.3737      1.210     0.2419E-05\n CNC   1            2             0.4942     0.4547      1.472     0.2943E-05\n CNC   1            3             0.4930     0.4536      1.468     0.2936E-05\n CNC   1            4             0.4812     0.4427      1.433     0.2865E-05\n CNC   1            5             0.4682     0.4307      1.394     0.2788E-05\n CNC   1            6             0.4550     0.4186      1.355     0.2710E-05\n CNC   1            7             0.4418     0.4065      1.315     0.2631E-05\n CNC   1            8             0.4286     0.3944      1.276     0.2552E-05\n CNC   1            9             0.4154     0.3822      1.237     0.2474E-05\n CNC   1           10             0.4022     0.3701      1.198     0.2395E-05\n</code></pre>\n"},{"tags":["r","indexing","combinations","tapply"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":65,"score":5,"question_id":13071669,"title":"How to assign a counter to a specific subset of a data.frame which is defined by a factor combination?","body":"<p>My question is: I have a data frame with some factor variables. I now want to assign a new vector to this data frame, which creates an index for each subset of those factor variables.</p>\n\n<pre><code>   data &lt;-data.frame(fac1=factor(rep(1:2,5)), fac2=sample(letters[1:3],10,rep=T))\n</code></pre>\n\n<p>Gives me something like:</p>\n\n<pre><code>        fac1 fac2\n     1     1    a\n     2     2    c\n     3     1    b\n     4     2    a\n     5     1    c\n     6     2    b\n     7     1    a\n     8     2    a\n     9     1    b\n     10    2    c\n</code></pre>\n\n<p>And what I want is a combination counter which counts the occurrence of each factor combination. Like this</p>\n\n<pre><code>        fac1 fac2  counter\n     1     1    a        1\n     2     2    c        1\n     3     1    b        1\n     4     2    a        1\n     5     1    c        1\n     6     2    b        1\n     7     1    a        2\n     8     2    a        2\n     9     1    b        2\n     10    1    a        3\n</code></pre>\n\n<p>So far I thought about using tapply to get the counter over all factor-combinations, which works fine</p>\n\n<pre><code>counter &lt;-tapply(data$fac1, list(data$fac1,data$fac2), function(x) 1:length(x))\n</code></pre>\n\n<p>But I do not know how I can assign the counter list (e.g. unlisted) to the combinations in the data-frame without using inefficient looping :)</p>\n"},{"tags":["r","calloc"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":41,"score":1,"question_id":13077976,"title":"Trying to use C files in R package to implement in a standalone C program","body":"<p>I recently downloaded this R package (<a href=\"http://cran.r-project.org/web/packages/energy/index.html\" rel=\"nofollow\">http://cran.r-project.org/web/packages/energy/index.html</a>) and was able to successfully install it and run it on my system and calculate distance correlation. </p>\n\n<p>The problem is for loops in R takes forever and I am an R newbie. The source code is actually written in some files in C, which R uses to evaluate. I have these two files in <code>src</code> folder in the package <code>utilities.c</code> and <code>dcov.c</code> Which has functions I need to implement. </p>\n\n<p>I tried to compile <code>dcov.c</code> which uses <code>rmath.h</code> and <code>r.h</code> apparently and I got a bunch of errors about Calloc/Free used in the program. </p>\n\n<p>Any idea how I can just compile the C programs? </p>\n"},{"tags":["r","subset","apply"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13076333,"title":"apply function on all subsets of dataframe","body":"<p>how can i normalize the values of Sepal.Length by Species?</p>\n\n<pre><code>    iris\n    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species\n1            5.1         3.5          1.4         0.2     setosa\n...\n\n# i have to divide by \ntapply(iris$Sepal.Length, iris$Species, max)\n    setosa versicolor  virginica \n       5.8        7.0        7.9 \n</code></pre>\n\n<p>in other words i want to divide all values where <code>Species==\"setosa\"</code> by 5.8 and so on\nfinally i want to have a data frame with normalized values 0..1 in the Sepal.Length column.</p>\n\n<p>Finally it should return</p>\n\n<pre><code>    iris\n    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species\n1      0.8793103         3.5          1.4         0.2     setosa\n...\n</code></pre>\n"},{"tags":["r","octave"],"answer_count":3,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":451,"score":5,"question_id":6223349,"title":"Interface between Octave and R","body":"<p>Could anyone kindly update the status on the interface between <code>Octave and R</code>? <code>ROctave</code> package was developed in 2002, but no new updates after that. I like to call some functions from Octave in R such as \"roots\". How to do it?</p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["r","data.frame","groups","apply"],"answer_count":3,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":167,"score":4,"question_id":10645100,"title":"Apply a function to groups within a data.frame in R","body":"<p>I am trying to get the cumulative sum of a variable (v) for groups (\"a\" and \"b\") within a dataframe. How can I get the result at the bottom -- whose rows are even numbered properly -- into column cs of my dataframe?</p>\n\n<pre><code>&gt; library(nlme)\n&gt; g &lt;- factor(c(\"a\",\"b\",\"a\",\"b\",\"a\",\"b\",\"a\",\"b\",\"a\",\"b\",\"a\",\"b\"))\n&gt; v &lt;- c(1,4,1,4,1,4,2,8,2,8,2,8)\n&gt; cs &lt;- rep(0,12)\n&gt; d &lt;- data.frame(g,v,cs)\n\n&gt; d\n   g v cs\n1  a 1 0\n2  b 4 0\n3  a 1 0\n4  b 4 0\n5  a 1 0\n6  b 4 0\n7  a 2 0\n8  b 8 0\n9  a 2 0\n10 b 8 0\n11 a 2 0\n12 b 8 0\n\n&gt; r=gapply(d,FUN=\"cumsum\",form=~g, which=\"v\")\n&gt;r\n\n$a     \n   v   \n1  1   \n3  2   \n5  3  \n7  5  \n9  7  \n11 9  \n\n$b    \n    v \n2   4 \n4   8 \n6  12 \n8  20 \n10 28 \n12 36 \n\n&gt; str(r)\nList of 2\n $ a:'data.frame':  6 obs. of  1 variable:\n  ..$ v: num [1:6] 1 2 3 5 7 9\n $ b:'data.frame':  6 obs. of  1 variable:\n  ..$ v: num [1:6] 4 8 12 20 28 36\n</code></pre>\n\n<p>I guess I could figure out some laborious way to get the data from those dataframes into d$cs, but there's got to be some easy tweak I'm missing.</p>\n"},{"tags":["r","data.frame","apply"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":369,"score":2,"question_id":5442101,"title":"R code that applies a function to subsection of variables of a dataframe and saves it to original dataframe","body":"<p>I have a dataframe like mtcars</p>\n\n<p>I want to program a function that searches for all variables of mtcars that start with \"c\", converts them to character and saves them back to mtcars.</p>\n"},{"tags":["r","class","null","learn"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13075357,"title":"Repercussions of a NULL classed object from `obj <- {}` in R?","body":"<p>The syntax <code>obj &lt;- {}</code> caught my eye in this post <a href=\"http://stackoverflow.com/a/3417894/168689\">http://stackoverflow.com/a/3417894/168689</a>.  I'm fairly new to <code>R</code> and hadn't seen it before so I fired up my console: </p>\n\n<pre><code>obj &lt;- {}\nclass(obj)\n</code></pre>\n\n<p>and found an object of class <code>NULL</code>. </p>\n\n<pre><code>class(obj) \n[1] \"NULL\"\n</code></pre>\n\n<p>I'd like to know the opinions on this technique in the R community.  Is there merit in it? Do the possible downsides (really, no class?) outweigh those?</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13075631,"title":"Modifing a graph generated using scatterplot3d","body":"<p>I use <code>scatterplot3d</code> to generate the following graph. Currently, all of the lines are plotted by starting from the bottom surface, which is associated with <code>value=-1</code>. </p>\n\n<p>I would like to remove the top surface (associated with <code>value=5</code>) and the bottom surface (associated with <code>value=-1</code>). In addition, I would like those lines are plotted by starting from the surface associated with <code>value=0</code>.  Are there any approaches to help me achieve this?</p>\n\n<p><img src=\"http://i.stack.imgur.com/lu7ps.jpg\" alt=\"enter image description here\"></p>\n\n<p>The data and code for generating this graph are as follows:</p>\n\n<pre><code>s3d.dat &lt;- read.table(text=\"\n   V1 V2 V3\n   1  2 -1\n   2  1  0\n   1  1  2\n   1  5 -1\n   5  1  0\",header=TRUE)\n\nlibrary(scatterplot3d)\n\ns3d&lt;-scatterplot3d(s3d.dat,type=\"h\",pch=8,color=\"red\")\ns3d$plane3d(0,0,0)\n</code></pre>\n"},{"tags":["regex","r","edit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13054308,"title":"Properly eliminating duplicates from overlapping strings in R?","body":"<p>I'd like to ask a follow-up question to <a href=\"http://stackoverflow.com/questions/13009761/proper-use-of-gsub-regular-expressions-in-r\">this issue</a>, please, because an additional problem arose: I discovered subjects (Cultural Studies, e.g.) which belong to more than one category (Arts &amp; Humanities and Social Sciences), i.e. there is overlap which has to be considered.  </p>\n\n<p>I have long lists of categories such as this machine readable example:  </p>\n\n<pre><code>AB &lt;- c(\"Science\",\"Arts &amp; Humanities\",\"Arts &amp; Humanities; Social Sciences\",\"Science\",\"Arts &amp; Humanities; Arts &amp; Humanities; Social Sciences\",\"Science\",\"Science; Social Sciences\",\"Social Sciences; Science\")  \n</code></pre>\n\n<p>So it looks like this:  </p>\n\n<pre><code>&gt; AB  \n[1] \"Science\"                                               \"Arts &amp; Humanities\"  \n[3] \"Arts &amp; Humanities; Social Sciences\"                    \"Science\"  \n[5] \"Arts &amp; Humanities; Arts &amp; Humanities; Social Sciences\" \"Science\"  \n[7] \"Science; Social Sciences\"                              \"Social Sciences; Science\"  \n</code></pre>\n\n<p>I would like to edit these terms and eliminate duplicates in order to get this result:  </p>\n\n<pre><code>[1] \"Science\"                                    \"Arts &amp; Humanities\"  \n[3] \"Arts &amp; Humanities; Social Sciences\"         \"Science\"  \n[5] \"Arts &amp; Humanities; Social Sciences\"         \"Science\"  \n[7] \"Science; Social Sciences\"                   \"Science; Social Sciences\"  \n</code></pre>\n\n<p>So I'm looking for another loop to eliminate the duplicate in #5. I tried using <em>strsplit()</em> and <em>unique()</em> but this didn't work:  </p>\n\n<pre><code>&gt; unique(strsplit(AB, \"; *\"))  \n[[1]]  \n[1] \"Science\"  \n\n[[2]]  \n[1] \"Arts &amp; Humanities\"  \n\n[[3]]  \n[1] \"Arts &amp; Humanities\" \"Social Sciences\"  \n\n[[4]]  \n[1] \"Arts &amp; Humanities\" \"Arts &amp; Humanities\" \"Social Sciences\"  \n\n[[5]]  \n[1] \"Social Sciences\" \"Science\"  \n</code></pre>\n\n<p>So I would like to ask you again, please: How can I achieve the correct output mentioned above?\nThank you very much in advance for your consideration!  </p>\n"},{"tags":["r","timezone","maps"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13072571,"title":"Plot timezones over the world map in R","body":"<p>Hi folks: could anyone give me some hints about plotting timezones grid using polygons over the world map in R? I use maps to get the world layout, but where to get coordinates of timezones polygons? </p>\n\n<p>Ultimately, I would love to get something <a href=\"http://www.timeanddate.com/time/map/about.html\" rel=\"nofollow\">like this</a>, coloring timezones according to some values from my analyses. Thank you!</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13075421,"title":"script for interactive plot in R","body":"<p>I wrote a script for interactive zoom and drag in R. It works similar to playwith, but it is less good looking and more light weight. I find it very useful.</p>\n\n<p>The script is available for download on <a href=\"http://bit.ly/TIuuzX\" rel=\"nofollow\">http://bit.ly/TIuuzX</a></p>\n\n<p>Do you know of any good place where I could post this code and get some feedback ?</p>\n\n<p>Thanks,\nPetr</p>\n"},{"tags":["r","statistics","graph","cluster-analysis","modularity"],"answer_count":2,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":984,"score":7,"question_id":3523641,"title":"Newman's modularity clustering for graphs","body":"<p>I am interested in running Newman's <a href=\"http://www.ncbi.nlm.nih.gov/pmc/articles/PMC1482622/\" rel=\"nofollow\">modularity</a> clustering algorithm on a large graph. If you can point me to a library (or R package, etc) that implements it I would be most grateful.</p>\n\n<p>best\n~lara</p>\n"},{"tags":["r","cox-regression"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13073136,"title":"generate data table of \"coxph\" object in a similar way as for \"survfit\" object","body":"<p>When I use <code>summary()</code> for a <code>survfit</code> object, I get a nice data.frame with columns for </p>\n\n<pre><code>time n.risk n.event survival std.err lower 95% CI upper 95% CI\n</code></pre>\n\n<p>But <code>summary()</code> on a <code>coxph</code> object gives a different result. I realize functions work differently on different object classes, but is there a command that works on <code>coxph</code> in a similar way that <code>summary()</code> works on <code>survfit</code>? I haven't been able to find answers so far in the documentation.</p>\n\n<p>Thanks!\nTom</p>\n"},{"tags":["r","time-series","linear-interpolation"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":57,"score":4,"question_id":13073686,"title":"Interpolating timeseries","body":"<p>I have a time series problem which I hope someone can help with!</p>\n\n<p>The problem revolves around two sets of data with different time stamps. One set of data contains calibration data, the other contains sample data. The calibration is much less frequent than the samples. </p>\n\n<p>What I would like to do is interpolate the calibration data (low freq) onto the sample time series (high freq). </p>\n\n<pre><code>sam &lt;- textConnection(\"time, value\n01:00:52, 256\n01:03:02, 254\n01:05:23, 255\n01:07:42, 257\n01:10:12, 256\")\n\ncal &lt;- textConnection(\"time, value\n01:01:02, 252.3\n01:05:15, 249.8\n01:10:02, 255.6\")\n\nsample &lt;- read.csv(sam)\n\nsample$time &lt;- as.POSIXct(sample$time, format=\"%H:%M:%S\")\n\ncalib &lt;- read.csv(cal)\n\ncalib$time &lt;- as.POSIXct(calib$time, format=\"%H:%M:%S\")\n</code></pre>\n\n<p>The big problem (that I see) is that the freq of the data changes randomly. </p>\n\n<p>Have any of you had to do similar things? Is there a chron or zoo function which would do what I want (interpolate low freq data onto higher freq data where both ts are random)?</p>\n"},{"tags":["r","date","plot","zoo"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":142,"score":0,"question_id":13067012,"title":"Date format for plotting x axis ticks of time series data","body":"<p>The data files have date is the format i.e. 1975M1, 1975M2, ... 2011M12 for time series data. when plotting this data using R, I want the x-axis to display the months on tick axis. </p>\n\n<p>For the dates to be read properly, I have tried replacing the M by - to get %Y-%m format but that doesnt seem good for drawTimeAxis from hydroTSM package which perhaps requires %Y-%M-%d format. It gives error that incorrect number of dimensions for ticks dimension.</p>\n\n<p>Another method of parsing and formatting the data as in <code>x$newdate &lt;- strptime(as.character(x$date), \"%Y-%m\")</code> and then <code>format(x$newdate,\"\"%Y-%m\")</code>\nalso doesnt read the date and gives error... all NA.</p>\n\n<p>date &lt;- as.Date(data[,1] the error that character string is not in a standard unambiguous format and ts &lt;- read.zoo(xts, as.yearmon(x[,1])) gives bad enries at data rows. </p>\n\n<p>Please give solution of how this data can be read with the date information.</p>\n\n<p>A small subset of the data file </p>\n\n<pre><code>date    x   x2\n1975M1  112.44  113.12\n1975M2  113.1   114.36\n1975M3  115.04  114.81\n1975M4  117.65  115.35\n1975M5  119.5   116.92\n1975M6  121.4   118.56\n1975M7  120.64  118.97\n1975M8  119.12  119.84\n1975M9  118.91  120.59\n1975M10 120.58  122.3\n1975M11 121.26  123.35\n1975M12 122.34  123.33\n</code></pre>\n\n<p>Update: The answers so far solve the problem of reading the date correctly by using %YM%m in the xts package or adding the day for getting standard format. The customizing of tick axis is still a problem. The drawTimeAxis is giving dimension error and plot commands are not showing monthly labels for more than one year of data or otherwise . Any methods of customizing tick axis ?</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":69,"score":5,"question_id":13069949,"title":"Remove rows of a data set belonging to a factor of specified length","body":"<p>I have a data.frame similar to the following:</p>\n\n<pre><code>df &lt;- data.frame(population = c(\"AA\",\"AA\",\"AA\",\"BB\",\"BB\",\"CC\",\"CC\",\"CC\"),\n                 individual = c(\"A1\",\"A2\",\"A3\",\"B1\",\"B2\",\"C1\",\"C2\",\"C3\"),\n                 Haplotype1 = rep(1:4,2),\n                 Haplotype2 = rep(5:8,2))\n &gt; df\n  population individual Haplotype1 Haplotype2\n1         AA         A1          1          5\n2         AA         A2          2          6\n3         AA         A3          3          7\n4         BB         B1          4          8\n5         BB         B2          1          5\n6         CC         C1          2          6\n7         CC         C2          3          7\n8         CC         C3          4          8\n</code></pre>\n\n<p>I want to create a new dataset where any population consisting of less than a\nspecified number of individuals is omitted from the dataset.  For example, I\nwant to reanalyze the data for only populations with greater than three or\nmore individuals.  This following is the dataset I want:</p>\n\n<pre><code>&gt; df &lt;- df[!df$population==\"BB\",]\n&gt; df\n  population individual Haplotype1 Haplotype2\n1         AA         A1          1          5\n2         AA         A2          2          6\n3         AA         A3          3          7\n6         CC         C1          2          6\n7         CC         C2          3          7\n8         CC         C3          4          8\n</code></pre>\n\n<p>However, I have 400 populations ranging in size from 5 to 155 individuals, and\nmanually picking populations out by name is not feasible. I want to write a\nfunction where I say in essence \"give me a dataset with all populations\nconsisting of X number of individuals or more and delete those with less than\nX.\" Any help or feedback is appreciated.</p>\n"},{"tags":["r","text"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":105,"score":4,"question_id":13059083,"title":"Why and where are \\n newline characters getting introduced to c()?","body":"<p>Hoping someone can help me understand why errant \\n characters are showing up in a vector of strings that I'm creating in R.</p>\n\n<p>Trying to import and clean up a very wide data file that's in fixed width format\n(<a href=\"http://www.state.nj.us/education/schools/achievement/2012/njask6/\" rel=\"nofollow\">http://www.state.nj.us/education/schools/achievement/2012/njask6/</a>, 'Text file for data runs').  Followed the <a href=\"http://www.ats.ucla.edu/STAT/r/modules/raw_data.htm\" rel=\"nofollow\">UCLA tutorial</a> on using read.fwf and <a href=\"http://stackoverflow.com/questions/8815075/fixing-dimnamesx-of-xts-objects-in-r-via-loop\">this</a> excellent SO question to give the columns names after import.</p>\n\n<p>Because the file is really wide, the column headers are LONG - all together, just under 29,800 characters.  I'm passing them in as a simple vector of strings:</p>\n\n<pre><code>column_names &lt;- c(...)\n</code></pre>\n\n<p>I'll spare you the ugly dump here but I dropped the whole thing on <a href=\"http://pastebin.com/FbkNvqGt\" rel=\"nofollow\">pastebin</a>.</p>\n\n<p>Was cleaning up and transforming some of the variables for analysis when I noticed that some of my subsets were returning 0 rows.  After puzzling over it (did I misspell something?) it realized that somehow a bunch of '\\n' newline characters had been introduced into my column headers.</p>\n\n<p>If I loop over the column_names vector that I created </p>\n\n<pre><code>for (i in 1:length(column_names)) {\n  print(column_names[i])\n}\n</code></pre>\n\n<p>I see the first newline character in the middle of the 81st line - </p>\n\n<p>SPECIAL\\nEDUCATION SCIENCE Number Enrolled Science</p>\n\n<p>Avenues that I tried to resolve this:</p>\n\n<p>1) Is it something about my environment?  I'm using the regular script editor in R, and my lines <em>do</em> wrap - but the breaks on my screen don't match the placement of the \\n characters, which to me suggests that it's not the R script editor.</p>\n\n<p>2) Is there a GUI setting?  Did some <a href=\"https://www.google.com/search?q=r%20GUI%20settings%20word%20wrap\" rel=\"nofollow\">searching</a>, but couldn't find anything.</p>\n\n<p>3) Is there a pattern?  Seems like the newline characters get inserted about every 4000 characters.  Did some reading on R/S primitives to try to figure out if this had something to do with basic R data structures, but was pretty quickly in over my head.</p>\n\n<p>I tried breaking up the long string into <a href=\"http://pastebin.com/k51JHjNw\" rel=\"nofollow\">shorter chunks</a>, and then subsequently combining them, and that seemed to solve the problem.</p>\n\n<pre><code>column_names.1 &lt;- c(...)\ncolumn_names.2 &lt;- c(...)\ncolumn_names_combined &lt;- c(column_names.1, column_names.2)\n</code></pre>\n\n<p>so I have an immediate workaround, but would love to know what's actually going on here.</p>\n\n<p>Some of the <a href=\"https://stat.ethz.ch/pipermail/r-help/2008-January/151380.html\" rel=\"nofollow\">posts</a> that had to do with problems with character vectors suggested that I run memory profile:</p>\n\n<pre><code>  memory.profile()\n        NULL      symbol    pairlist     closure environment     promise \n           1        9572      220717        4734        1379        5764 \n    language     special     builtin        char     logical     integer \n       63932         165        1550       18935       10302       30428 \n      double     complex   character         ...         any        list \n        2039           1       60058           0           0       20059 \n  expression    bytecode externalptr     weakref         raw          S4 \n           1       16553         725         150         151        1162 \n</code></pre>\n\n<p>I'm running R 2.15.1 (64-bit) R on Windows 7 (Enterprise, SP 1, 8 gigs RAM).\nThanks!</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13062164,"title":"repeat a matrix many times and get a vector of matrix names","body":"<p>I have a basic matrix <code>mat</code> and I hope to get an R object <code>x = (mat, mat, ...)</code> where <code>mat</code> is repeated for 100 times. If this is possible, then I can pass <code>x</code> to a function which takes a vector of matrix names. I tried <code>rep(mat, 100)</code> but it seems that the matrix class is no longer maintained. Any suggestions? Thanks!</p>\n\n<p>Update: Basically I plan to use </p>\n\n<pre><code>grp.ids &lt;- as.factor(c(rep(1,8), rep(2,4), rep(3,2)))\nx &lt;- model.matrix(~grp.ids)\ndo.call(blockMatrixDiagonal,\n             replicate(100, x, simplify=FALSE))\n</code></pre>\n\n<p>where the <code>blockMatrixDiagonal</code> function can be found <a href=\"http://www.r-bloggers.com/block-diagonal-matrices-in-r/\" rel=\"nofollow\">here</a>. Then R gives an error: number of items to replace is not a multiple of replacement length. What I really hope to get via these coding is a block diagonal matrix. Thanks :)</p>\n"},{"tags":["r","statistics","data-mining"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13073061,"title":"Filtering values out of two dimensional data in R, comparing themselves","body":"<p>I'm analyzing USA election data, candidates contribution, etc.  So I got raw data from internet and trying to learn some R executing some exercises in it.  This is a CSV file that I successfully loaded and analyzed with <code>?summary</code>.</p>\n\n<p>I also used <code>?tapply</code> successfully, to separate candidates money contribution by state:</p>\n\n<pre><code>data_amt_st = tapply(data$contb_receipt_amt, data[c('cand_nm', 'contbr_st')], sum)\n</code></pre>\n\n<p><code>?str</code> (for a small sample) tells me the format of this data:</p>\n\n<pre><code>&gt; str(data_amt_st)\n num [1:3, 1:21] NA NA 451 NA NA 201 NA NA 200 NA ...\n - attr(*, \"dimnames\")=List of 2\n  ..$ cand_nm  : chr [1:3] \"Bachmann, Michele\" \"Obama, Barack\" \"Romney, Mitt\"\n  ..$ contbr_st: chr [1:21] \"33\" \"46\" \"48\" \"7\" ...\n</code></pre>\n\n<p>Now I need to filter out values from data_amt_st.  I need states that \"Obama, Barack\" had more contributions than other candidates, but don't know how to do. Something with <code>?subset</code>?</p>\n\n<p>Thank you very much.</p>\n\n<hr>\n\n<p>EDIT 1: Attending what guys told me, about making a more concrete question:  I need a list of the states where Barack Obama achieved a higher contribution level (more money) than other candidates.</p>\n\n<hr>\n\n<p>EDIT 2: Trying to give you a reproducible example (is it correct?):</p>\n\n<pre><code>x = c(\"a\", \"b\", \"c\")\ny0 = c(3, 5, 1)\ny1 = c(2, 1, 6)\ny2 = c(4, 2, 3)\nm = cbind(x, y0, y1, y2)\nm\n#      x   y0  y1  y2 \n# [1,] \"a\" \"3\" \"2\" \"4\"\n# [2,] \"b\" \"5\" \"1\" \"2\"\n# [3,] \"c\" \"1\" \"6\" \"3\"\n</code></pre>\n\n<p>Now, I need to know, for what y values, <code>a</code> is higher than <code>b</code> and <code>c</code>.</p>\n"},{"tags":["r","plot"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":59,"score":1,"question_id":13065609,"title":"Chernoff faces extended in R","body":"<p>The <code>aplpack</code> library contains the possibility to plot beautiful Chernoff faces with <code>faces</code>. <code>symbols</code> and <code>TeachingDemos</code> also offer the possibility to plot variations of these faces. But none of them allows to plot more than 15 dimensions (<code>symbols</code> allows two more dimensions for colours, but they are defined in an inconvenient way so that some faces turn out to be completely black, hiding other parts of the face). Is there a way in <code>R</code> (perhaps with another library) to plot more dimensions, e.g. by adding a body with limbs of different lengths or by using colours to visualise some of the dimensions? Maybe I've overseen something and the colours in <code>aplpack</code> can be mapped to variables as well?</p>\n"},{"tags":["r","replace","design-patterns","matching","gsub"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":172,"score":-2,"question_id":10038650,"title":"How to exclude something from being replaced by gsub()","body":"<p>Sorry if this is a dumb question, I'm really new to R. What I'm wondering is, is there any way to specify exclusions within gsub or a similar function? \nMy data will look something like this: (15: .0234 , 12: .0151), and I want to replace the leading 15 with another item matching this (a: .b , c: .d) pattern. However, just calling gsub replaces both the leading 15 with the new pattern, and the 15 following the decimal point. It wouldn't work to simply tell it to replace only the first occurence, because there a lot of these patterns nested. What I'm thinking is to exclude numbers following a decimal point and followed by a whitespace from the gsub - is this even possible?</p>\n"},{"tags":["r","data.table"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":13067849,"title":"Number equal rows in data.frame","body":"<p>I have a data frame that looks like this:</p>\n\n<pre><code>df &lt;- data.frame(\n  Logical = c(TRUE,FALSE,FALSE,FALSE,FALSE,FALSE),\n  A = c(1,2,3,2,3,1),\n  B = c(1,0.05,0.80,0.05,0.80,1),\n  C = c(1,10.80,15,10.80,15,1))\n</code></pre>\n\n<p>Which looks like:</p>\n\n<pre><code>  Logical A    B    C\n1    TRUE 1 1.00  1.0\n2   FALSE 2 0.05 10.8\n3   FALSE 3 0.80 15.0\n4   FALSE 2 0.05 10.8\n5   FALSE 3 0.80 15.0\n6   FALSE 1 1.00  1.0\n</code></pre>\n\n<p>I want to add a new variable, <code>D</code>, which is an integer based on the following rules: either a <code>0</code> if <code>df$Logical</code> is <code>TRUE</code>, or an integer that is the same for all rows of variables <code>A</code>, <code>B</code> and <code>C</code> that are approximately (because they are doubles, so within a floating point margin of error) equal, starting at <code>1</code>.</p>\n\n<p>The expected output here:</p>\n\n<pre><code>  Logical A    B    C D\n1    TRUE 1 1.00  1.0 0\n2   FALSE 2 0.05 10.8 1\n3   FALSE 3 0.80 15.0 2\n4   FALSE 2 0.05 10.8 1\n5   FALSE 3 0.80 15.0 2\n6   FALSE 1 1.00  1.0 3\n</code></pre>\n\n<p>First row gets <code>0</code> because <code>Logical</code> is <code>TRUE</code>, second and fourth row get <code>1</code> because the variables <code>A</code>, <code>B</code> and <code>C</code> are approximately equal there, same for second and fifth row. Row six gets a <code>3</code> because it is the next unique row. Note that the order of integers assigned in <code>D</code> is irrelevant except for the <code>0</code>. e.g., rows 2 and 4 could also be assigned <code>2</code> as long as this integer is unique in the other cases of <code>D</code>.</p>\n\n<hr>\n\n<p>I have considered using aggregating functions. For example using <code>ddply</code>:</p>\n\n<pre><code>library(\"plyr\")\ndf$foo &lt;- 1:nrow(df)\nfoo &lt;- dlply(df,.(A,B,C),'[[',\"foo\")\ndf$D &lt;- 0\nfor (i in 1:length(foo)) df$D[foo[[i]]] &lt;- i\ndf$D[df$Logical] &lt;- 0\n</code></pre>\n\n<p>works, but I am not sure how well this will do with floating point errors (I guess I could round the values here before this call and it should be quite stable though). With a loop it is quite easy:</p>\n\n<pre><code>df$D &lt;- 0\nc &lt;- 1\nfor (i in 1:nrow(df))\n{\n  if (!isTRUE(df$Logical[i]) &amp; df$D[i]==0)\n  {\n    par &lt;- sapply(1:nrow(df),function(j)!df$Logical[j]&amp;isTRUE(all.equal(unlist(df[j,c(\"A\" ,\"B\", \"C\")]),unlist(df[i,c(\"A\" ,\"B\", \"C\")]))))\n    df$D[par] &lt;- c\n    c &lt;- c+1\n  }\n}\n</code></pre>\n\n<p>but this is very slow for larger data frames.</p>\n"},{"tags":["r","plot","gnu","output"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":13063246,"title":"Formatting output of R","body":"<p>I want to plot the output of R on GNU plot. E.g., I have a matrix <code>x</code> storing integers, and I make matrix <code>y</code> as <code>y&lt;- x^2</code>.</p>\n\n<p>Now GNU plot requires input in input data file in following format:</p>\n\n<pre><code>x1 y1\nx2 y2\nx3 y3\n... and so on...\n</code></pre>\n\n<p>How can I produce this output file from R?</p>\n\n<p>Specifically, how do I remove indices that are shown in output of R and arrange the elements of a matrix vertically?</p>\n"},{"tags":["r","time-series","interpolation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":150,"score":0,"question_id":11388940,"title":"How do I resample and interpolate timeseries data in R?","body":"<p>I have measurements that have been recorded approximately every 5 minutes:</p>\n\n<pre><code>2012-07-09T05:30:01+02:00   1906.1  1069.2  1093.2  3   1071.0  1905.7  \n2012-07-09T05:35:02+02:00   1905.7  1069.2  1093.0  0   1071.5  1905.7  \n2012-07-09T05:40:02+02:00   1906.1  1068.7  1093.2  0   1069.4  1905.7  \n2012-07-09T05:45:02+02:00   1905.7  1068.4  1093.0  1   1069.6  1905.7  \n2012-07-09T05:50:02+02:00   1905.7  1068.2  1093.0  4   1073.3  1905.7  \n</code></pre>\n\n<p>The first column is the data's timestamp. The remaining columns are the recorded data.</p>\n\n<p>I need to resample my data so that I have one row every 15 minutes, e.g. something like:</p>\n\n<pre><code>2012-07-09T05:15:00 XX XX XX XX XX XX\n2012-07-09T05:30:00 XX XX XX XX XX XX\n....\n</code></pre>\n\n<p>(In addition, there may be gaps in the recorded data and I would like gaps of more than, say, one hour to be replaced with a row of <code>NA</code> values.)</p>\n\n<p>I can think of several ways to program this by hand, but is there built-in support for doing that kind of stuff in R? I've looked at the different libraries for dealing with timeseries data (<code>zoo</code>, <code>chron</code> etc) but couldn't find anything satisfactory.</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13071390,"title":"How to remove extra legend after adding statistics to stacked barplot?","body":"<p>I want to create stacked bar plot with absolute values for variables in the axis but add the percentages on each bar. This is what my data looks like:</p>\n\n<pre><code>BAM  Mapping    Reads   fraction\nbam1   Mapped 22493091 0.88940452\nbam1 Unmapped  2796966 0.11059548\nbam2   Mapped 27018375 0.88256156\nbam3 Unmapped  3595212 0.11743844\nbam3   Mapped 27238774 0.89441821\nbam4 Unmapped  3215407 0.10558179\nbam4   Mapped 19791746 0.82984107\nbam4 Unmapped  4058298 0.17015893\nbam5   Mapped 23298155 0.83144569\nbam5 Unmapped  4723104 0.16855431\nbam6   Mapped 22563538 0.83990722\nbam6 Unmapped  4300784 0.16009278\nbam7   Mapped 23940480 0.88134856\nbam7 Unmapped  3222984 0.11865144\n</code></pre>\n\n<p>I am nearly there (nevermind the x-labels - I'm using long names here):</p>\n\n<pre><code>gp &lt;- ggplot(data=to_graph, aes(x=BAM, y=Reads, fill=Mapping, label=paste(round(fraction*100),\"%\", sep=\"\"), size = 3,vjust=0, position = \"stack\")) +\n     geom_bar(stat=\"identity\") + \n    geom_text(position=\"stack\")\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/w1Oit.png\" alt=\"enter image description here\"></p>\n\n<p>But there a little niggling square on top of the legend that I want to get rid of. How to do that importantly why does it appear in the 1st place?</p>\n\n<p>Cheers.</p>\n"},{"tags":["r","ms-access","rodbc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13070706,"title":"How to connect R with Access database in 64-bit Window?","body":"<p>When I tried to connect R with Access database I get an error </p>\n\n<pre><code>odbcConnectAccess is only usable with 32-bit Windows\n</code></pre>\n\n<p>Does anyone has an idea how to solve this?</p>\n\n<pre><code>library(RODBC) \nmdbConnect&lt;-odbcConnectAccess(\"D:/SampleDB1/sampleDB1.mdb\")\n</code></pre>\n"},{"tags":["r","matlab","math"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13069777,"title":"Peak to Gaussian function estimation","body":"<p>I have a continuous flow of input data : more than 100.000. There are two values a time and an intensity. The data contains many peaks. Let se part of the data.</p>\n\n<p><img src=\"http://i.stack.imgur.com/pIThO.png\" alt=\"This is part of the data that needs to be analized\"></p>\n\n<p>Objectives : Search for peaks -> identify them -> calculate area.</p>\n\n<p>Problem : a huge peak (like the one betwen 8.0 and 8.5) could be contain multiple Gaussian (this is just one \"normal\", there are other type of estimation functions also) peaks for example. </p>\n\n<p>Question : How can I \"deconvolute\" this peaks in order to measure the area of them.</p>\n\n<p>Example : I want to do something similar like the following matlab code : </p>\n\n<p><a href=\"http://terpconnect.umd.edu/~toh/spectrum/InteractivePeakFitter.htm\" rel=\"nofollow\">iPeak</a></p>\n"},{"tags":["r","time-series","zoo"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":94,"score":1,"question_id":12623027,"title":"How to analyse irregular time-series in R","body":"<p>I have a <code>zoo</code> time series in R:</p>\n\n<pre><code>d &lt;- structure(c(50912, 50912, 50912, 50912, 50913, 50913, 50914, \n50914, 50914, 50915, 50915, 50915, 50916, 50916, 50916, 50917, \n50917, 50917, 50918, 50918, 2293.8, 2302.64, 2310.5, 2324.02, \n2312.25, 2323.93, 2323.83, 2338.67, 2323.1, 2320.77, 2329.73, \n2319.63, 2330.86, 2323.38, 2322.92, 2317.71, 2322.76, 2286.64, \n2294.83, 2305.06, 55.9, 62.8, 66.4, 71.9, 59.8, 65.7, 61.9, 67.9, \n38.5, 36.7, 43.2, 30.3, 42.4, 33.5, 48.8, 52.7, 61.2, 30, 41.7, \n50, 8.6, 9.7, 10.3, 11.1, 9.2, 10.1, 9.6, 10.4, 5.9, 5.6, 6.6, \n4.7, 6.5, 5.2, 7.5, 8.1, 9.5, 4.6, 6.4, 7.7, 9.29591864400155, \n10.6585128174944, 10.4386464748912, 11.5738448647708, 10.9486074772952, \n10.9546547052814, 10.3733963771546, 9.15627378048238, 8.22993822910891, \n5.69045896511178, 6.95269658370746, 7.78781665368086, 7.20089569039135, \n4.9759716583555, 8.99378907920762, 10.0924594632635, 10.3909638115674, \n6.28203685114275, 9.16021859457356, 7.56829801052175, 0.695918644001553, \n0.9585128174944, 0.138646474891241, 0.473844864770827, 1.74860747729523, \n0.854654705281426, 0.773396377154565, -1.24372621951762, 2.32993822910891, \n0.0904589651117833, 0.352696583707458, 3.08781665368086, 0.700895690391349, \n-0.224028341644497, 1.49378907920762, 1.99245946326349, 0.890963811567351, \n1.68203685114275, 2.76021859457356, -0.131701989478247), .Dim = c(20L, \n6L), .Dimnames = list(NULL, c(\"station_id\", \"ztd\", \"zwd\", \"iwv\", \n\"radiosonde\", \"error\")), index = structure(c(892094400, 892116000, \n892137600, 892159200, 892180800, 892245600, 892267200, 892288800, \n892332000, 892353600, 892375200, 892418400, 892440000, 892461600, \n892504800, 892526400, 892548000, 892591200, 892612800, 892634400\n), class = c(\"POSIXct\", \"POSIXt\")), class = \"zoo\")\n</code></pre>\n\n<p>I want to perform some of the analyses that the <code>ts</code> package allows me to do, such as decomposing the time-series into the trend and seasonality, and looking at the auto-correlation function. However, trying to do any of these gives an error of: <code>Error in na.fail.default(as.ts(x)) : missing values in object</code>.</p>\n\n<p>Looking into this in more depth, it seems that all of these functions work on <code>ts</code> objects that have, by definition, regularly-spaced observations. My observations aren't, so I end up with a lot of <code>NA</code>s and everything fails.</p>\n\n<p>Is there a way to analyse the irregular time-series in R? Or do I need to convert them to be regular somehow? If so, is there a simple way to do this?</p>\n"},{"tags":["r","ggplot2","data-visualization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13068135,"title":"displaying stat_summary accurately on violin plots","body":"<p>I just started using ggplot2 on R and have a violin plot question.</p>\n\n<p>I have a data set that can be accessed here: <a href=\"https://github.com/bgurcay/GJT-/blob/master/data.csv\" rel=\"nofollow\">data</a>.</p>\n\n<p>The data comes from a study of making estimations. The variables of interest are the question.no (questions), condition, estimate.no (tr.est1 or tr.est2) and  estimate.</p>\n\n<p>The code below makes the plot look almost the way I want it to look at least for one question, yet the median dots generated by stat_summary() are displayed in between the \"violins.\" </p>\n\n<pre><code> v.data&lt;-read.csv(\"data.csv\")\n\n # loop through each question number\n d_ply(v.data, c(\"question.no\"), function(d.plot){\n q.no &lt;- v.data$question.no\n\n plot.q &lt;- ggplot(d.plot,aes(condition, estimate, fill=estimate.no)) + \n   geom_violin() + \n   stat_summary(fun.y=\"median\", geom=\"point\") + \n   scale_y_continuous('Change Scores') + \n   scale_x_discrete(\"Conditions\")\n\nggsave(filename=paste(q.no,\".png\",sep=\"\"))\n\n})\n</code></pre>\n\n<p><strong>My Question:</strong> How can I make the median dots display correctly on the \"violins\" rather than in between them?</p>\n\n<p>I searched the previous questions asked on ggplot2 on this site and looked at the ggplot2 documentation as well as other R forums but have not been able to find anything relevant. </p>\n\n<p>I would appreciate any comments and suggestions as to how I can fix it. Also, if the questions I ask are already answered somewhere else, I would appreciate the links to the threads,too. Many thanks in advance.   </p>\n"},{"tags":["r","loops","data.frame","anonymous-function"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":13070128,"title":"using anonymous functions in R with multiple arguments","body":"<p>I'm attempting to generate new variables in a data frame that are conditional on two (or more) other variables in the data frame. I believe that the looping functions in R (i.e., lapply, sapply, etc.) are useful and efficient for this purpose. Something is not right, however, with my approach, and I can't figure out what.</p>\n\n<pre><code>M &lt;- data.frame(x=c(\"A\", \"A\", \"B\", \"B\"), y=c(1,2,1,2))\n</code></pre>\n\n<p>Using this data frame, I would like to generate a new column z, containing logicals that are TRUE iff both <code>x == \"A\"</code> and <code>y == 1</code>. The following code is the best I can come up with here, but only seems to evaluate my first condition. </p>\n\n<pre><code>M$z &lt;- sapply(M$x, function(x,y) if((x == \"A\") &amp;&amp; (y == 1)) T else F, M$y)\n</code></pre>\n\n<ul>\n<li>Can this code be fixed for my purpose?</li>\n<li>Is there a better way of doing this in R, perhaps using other looping functions?</li>\n</ul>\n"},{"tags":["git","r","github","rstudio","gist"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":94,"score":4,"question_id":13058782,"title":"Download, Revise, Upload Github Gists with R","body":"<p>I often find myself writing my R code in Rstudio and manually copying/pasting the code to a gist at <a href=\"http://gist.github.com\" rel=\"nofollow\">gist.github.com</a>. </p>\n\n<p>I think Rstudio is great and they recently incorporated version control capabilities.  I haven't quite graduated to this level just yet, but I am hoping that I could link my github account and manage my gists in the same way. This would remove the manual actions that I take to save and retrieve my code snippets. </p>\n\n<p>The key is that I want to be able to access my code across multiple locations and need to keep some of my code private.</p>\n\n<p>Is this possible? Any help is greatly appreciated.</p>\n"},{"tags":["linux","r","x11"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":74,"score":3,"question_id":13067751,"title":"How to run R scripts on servers without X11","body":"<p>I want to run R scripts and save the plots using png(). X11 is not supported on the Unix servers and I get the following error message:</p>\n\n<pre><code>Error in X11(paste(\"png::\", filename, sep = \"\"), g$width, g$height, pointsize,  : \n  unable to start device PNG\nCalls: png\nIn addition: Warning message:\nIn png(\"test.png\", width = 900, height = 400) :\n  unable to open connection to X11 display ''\nExecution halted\n</code></pre>\n\n<p>Setting environment variables</p>\n\n<pre><code>Sys.setenv(\"DISPLAY\"=\":0.0\")\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Sys.setenv(\"DISPLAY\"=\":0\")\n</code></pre>\n\n<p>in the R scripts didn't solve the problem. </p>\n\n<p>This code example produces the error above:</p>\n\n<pre><code>library(ggplot2)\nlibrary(grid)\n\n# Some data\ndf = data.frame(x = c(1.2,5,3,5.3,2,9,4,6,8,0), y = c(1.5,6,2.5,5.1,2.3,8.7,4.1,6,8,0))\n\n\n# Base plot\np &lt;- ggplot(df, aes(x,y)) + geom_point() +\n   scale_x_continuous(limits = c(0, 8), expand = c(0,0)) +\n   scale_y_continuous(limits = c(0, 8), expand = c(0,0)) +\n   geom_smooth(method=\"lm\", se=FALSE, formula=y~x, aes(colour=\"2\"), show_guide=TRUE, fill=NA, size=1.2) +\n   geom_vline(xintercept = 3) + geom_vline(xintercept = 7) +\n   opts(plot.margin = unit(c(1,1,4,1), \"lines\"))\n\n# Create the text Grobs\nText1 = textGrob(\"Part 1\")\nText2 = textGrob(\"Part 2\")\nText3 = textGrob(\"Part 3\")\n\n# Add the annotations\n# Segment 1\np1 = p +\n     annotation_custom(grob = linesGrob(), xmin = 0, xmax = 0, ymin = \n-1, ymax = -.75) +\n     annotation_custom(grob = linesGrob(), xmin = 0, xmax = 3, ymin = \n-1, ymax = -1) +\n     annotation_custom(grob = linesGrob(), xmin = 3, xmax = 3, ymin = \n-1, ymax = -.75) +\n     annotation_custom(grob = Text1,  xmin = 0, xmax = 3, ymin = -1.25, \nymax = -1.25)\n\n# Segment 2\np1 = p1 +\n     annotation_custom(grob = linesGrob(), xmin = 3, xmax = 7, ymin = \n-1, ymax = -1) +\n     annotation_custom(grob = linesGrob(), xmin = 7, xmax = 7, ymin = \n-1, ymax = -.75) +\n     annotation_custom(grob = Text2,   xmin = 3, xmax = 7, ymin = -1.25, \nymax = -1.25)\n\n# Segment 3\np1 = p1 +\n     annotation_custom(grob = linesGrob(), xmin = 7, xmax = 8, ymin = \n-1, ymax = -1) +\n     annotation_custom(grob = linesGrob(), xmin = 8, xmax = 8, ymin = \n-1, ymax = -.75) +\n     annotation_custom(grob = Text3,  xmin = 7, xmax = 8, ymin = -1.25, \nymax = -1.25)\n\npng(\"test.png\", width=900, height=400)\n\n# Code to override clipping\ngt &lt;- ggplot_gtable(ggplot_build(p1))\ngt$layout$clip[gt$layout$name==\"panel\"] &lt;- \"off\"\ngrid.draw(gt)\n\ndev.off()\n</code></pre>\n\n<p>The outcome of capabilites() is</p>\n\n<p>jpeg      png     tiff    tcltk      X11     aqua http/ftp  sockets \n   FALSE    FALSE    FALSE     TRUE    FALSE    FALSE     TRUE     TRUE \n  libxml     fifo   cledit    iconv      NLS  profmem    cairo \n    TRUE     TRUE    FALSE     TRUE     TRUE    FALSE    FALSE</p>\n\n<p>I am running the scripts via a sun grid engine.</p>\n"},{"tags":["c++","r","rcpp"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":540,"score":3,"question_id":5158219,"title":"Find minimum of vector in Rcpp","body":"<p>Since last night I have been trying out <code>Rcpp</code> and <code>inline</code>, and so far I am really enjoying it. But I am kinda new to <code>C</code> in general and can only do basic stuff yet, and I am having a hard time finding help online on things like functions.</p>\n\n<p>Something I was working on was a function that finds the minimum of a vector in the global environment. I came up with:</p>\n\n<pre><code>library(\"inline\")\nlibrary(\"Rcpp\")\n\nfoo &lt;- rnorm(100)\n\nbar &lt;- cxxfunction( signature(),\n'\nEnvironment e = Environment::global_env();  \nNumericVector foo = e[\"foo\"];\nint min;\n\nfor (int i = 0; i &lt; foo.size(); i++)\n{\n    if ( foo[i] &lt; foo[min] ) min = i;\n}\nreturn wrap(min+1);\n', plugin = \"Rcpp\")\n\nbar()\n</code></pre>\n\n<p>But it seems like there should be an easier way to do this, and it is quite slower than <code>which.max()</code></p>\n\n<pre><code>system.time(replicate(100000,bar()))\n   user  system elapsed \n   0.27    0.00    0.26 \nsystem.time(replicate(100000,which.min(foo)))\n   user  system elapsed \n    0.2     0.0     0.2 \n</code></pre>\n\n<p>Am I overlooking a basic <code>c++</code> or <code>Rcpp</code> function that does this? And if so, where could I find a list of such functions?</p>\n\n<p>I guess this question is related to:\n<a href=\"http://stackoverflow.com/questions/4106174/where-can-i-learn-to-how-to-write-c-code-to-speed-up-slow-r-functions\">Where can I learn to how to write C code to speed up slow R functions?</a></p>\n\n<p>but different in that I am not really interested in how to incorporate <code>c++</code> in <code>R</code>, but more on how and where to learn basic <code>c++</code> code that is usable in <code>R</code>.</p>\n"},{"tags":["web-services","r","soap"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13065622,"title":"Web-service acess with R and SSOAP from cbr.ru","body":"<p>I'm trying to retrievie data to R from CBR (Russia's Central Bank - cbr.ru) via their web-servive platform. Basically, I was inspired by a code from <a href=\"http://arademaker.github.com/blog/2012/01/02/package-SSOAP.html\" rel=\"nofollow\">this example</a> using SSOAP package for R.  </p>\n\n<pre><code>wsdl &lt;- 'http://www.cbr.ru/secinfo/secinfo.asmx?WSDL'\ndoc  &lt;- xmlInternalTreeParse(wsdl)\ndef &lt;- processWSDL(doc)\nff  &lt;- genSOAPClientInterface(def = def) \nxmlstr.f &lt;- ff@functions #gives the list of functions that can be accessed \n# just an example of retrieval attempt \nt1 &lt;- new('dateTime',as.POSIXct('2012-10-10') #creating an object of dateTime class as requested \nxmlstr.f$GCurve(t1) #trying to call SOAP server with GCurve function \n</code></pre>\n\n<p>and I recieve the following error: </p>\n\n<pre><code>Error in .SOAP(server, .operation@name, parameters = as(parameters, \"dateTime\"),  : object '.operation' not found \n</code></pre>\n\n<p>Can anyone give me suggestions on what's going wrong here? </p>\n"}]}
{"total":19203,"page":9,"pagesize":100,"questions":[{"tags":["r"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":69,"score":5,"question_id":13068217,"title":"Add greek letters to axis tick labels in R","body":"<p>I have my axis ticks:</p>\n\n<pre><code>axis(4,at=c(1.6526,1.9720,2.6009,3.3403),las=1)\n</code></pre>\n\n<p>now I want to label them. The text should be something like this:</p>\n\n<pre><code>labels=c(\"alpha=0.1\",\"alpha=0.05\",\"alpha=0.01\",\"alpha=.001\")\n</code></pre>\n\n<p>But I want alpha to look like the greek character.\nThanks!</p>\n"},{"tags":["r","count"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13068355,"title":"How to count values in an array","body":"<p>How to count values in a multiset?\nI have a dataset and i want to write a function for a frequency table. So that i now which abnormalities are present in my data. The data is an array and looks like this:</p>\n\n<pre><code>             GSM288217   GSM288219 GSM288221\nch1_500001   NA          NA        NA       \nch1_1500001  \"Imbalance\" \"Balance\" \"Balance\"\nch1_2500001  \"Imbalance\" \"Balance\" \"Balance\"\nch1_3500001  \"Imbalance\" \"LOH\"     \"Balance\"\nch1_4500001  \"Imbalance\" \"LOH\"     \"Balance\"\nch1_5500001  \"Imbalance\" \"LOH\"     \"Balance\"\nch1_6500001  \"Imbalance\" \"LOH\"     \"Balance\"\nch1_7500001  \"Imbalance\" \"LOH\"     \"Balance\"\nch1_8500001  \"Imbalance\" \"LOH\"     \"Balance\"\nch1_9500001  \"Imbalance\" \"LOH\"     \"Balance\"\nch1_10500001 \"Imbalance\" \"LOH\"     \"Balance\"\nch1_11500001 \"Imbalance\" \"LOH\"     \"Balance\"\nch1_12500001 \"Imbalance\" \"LOH\"     \"Balance\"\nch1_13500001 \"Imbalance\" \"LOH\"     \"Balance\"\nch1_14500001 \"Imbalance\" \"LOH\"     \"Balance\"\nch1_15500001 \"Imbalance\" \"LOH\"     \"Balance\"\nch1_16500001 \"Imbalance\" \"LOH\"     \"Balance\"\nch1_17500001 \"Imbalance\" \"LOH\"     \"Balance\"\nch1_18500001 \"Imbalance\" \"LOH\"     \"Balance\"\nch1_19500001 \"Imbalance\" \"LOH\"     \"Balance\"\n</code></pre>\n\n<p>Now i want the function to check per ROW how much a certain abnormality is present in the data.  I started with:</p>\n\n<pre><code>detection&lt;- function(abnormality) {\n  freqcount&lt;-rep(0,nrow(abnormality))\n  if(assayDataElement(abnormality, 1)==\"LOH\")#TRUE &amp; FALSE?? Need frequency\n    {freqcount&lt;-freqcount+1\n     }          \n  return(freqcount)\n\n}\n</code></pre>\n\n<p>So every time there is LOH present on the rows of the data it should give the numbers of LOH present in that row.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13066457,"title":"Cannot view graphic output properly (forest plot)","body":"<p>I am running a meta analysis in R using the meta package. The only problem is that I am combinining a large number of studies, so when I try to view the forest plot, I cannot see the entirety of it. If I try export it it also cuts off parts of the plot.</p>\n\n<p>An example of my data is as follows</p>\n\n<pre><code>title&lt;-c(\"study1\",\"study2\",\"study3\",\"study4\",\"study5\",\"study6\",\"study7\",\"study8\",\"study9\",\"study10\",\"study11\",\"study12\",\"study13\",\"study14\",\"study15\",\"study16\",\"study17\",\"study18\",\"study19\",\"study20\")\nES&lt;-c(45,47,108,76,-9.5,16,25.1,36.4,44,34,65.5,45,53,31.4,26,-10,45,19.1,28.8,36)\nseES&lt;-c(104.5,6.4,31.8,32.3,15.3,5.9,11.8,7.6,11.7,7.6,14.7,5.1,2.5,13.2,15.3,-5.1,7.6,9.7,7.6,8.1)\nindtreat&lt;-c(\"drug 1\",\"drug 1\",\"drug 1\",\"drug 2\",\"drug 3\",\"drug 4\",\"drug 5\",\"drug 6\",\"drug 2\",\"drug 7\",\"drug 8\",\"drug 8\",\"drug 2\",\"drug 7\",\"drug 6\",\"drug 6\",\"drug 9\",\"drug 2\",\"drug 8\",\"drug 10\")\n\ndata&lt;-cbind(title,ES,seES,indtreat)\ndata&lt;-as.data.frame(data)\n\nalltreat_meta&lt;-metagen(data$ES,data$seES,studlab=data$title,sm=\"MD\",label.e=\"Active treatment\",\nlabel.c=\"placebo\",byvar=data$indtreat, print.byvar=FALSE)\nforest(alltreat_meta)\n</code></pre>\n\n<p>(This is giving me the error \"non-numeric value for TE or seTE\", which I'm not too sure why?)</p>\n\n<p>The problem is that when I run the line</p>\n\n<pre><code>forest(alltreat_meta)\n</code></pre>\n\n<p>I cannot see the full forest plot, and am not sure how to zoom out or scroll up and down this plot. Does anyone know how to work around this problem?</p>\n"},{"tags":["r","data.table","plyr","mean"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13065918,"title":"Handling Data in long format in R","body":"<p>I created a data frame in longformat which has 5 variables( company name, key item, country of origin, year and value) What I want to do is create a table with the means of the values of one key item for each year. Here is what I managed so far: </p>\n\n<pre><code>for(i in dat$Year) {\n  dat[dat$KeyItem == \"Total Assets\" &amp; dat$Year == i, ]\n  FUN1 &lt;- mean(dat$Value, na.rm = TRUE)\n\n\n}\n</code></pre>\n\n<p>I have hardly any experience in R and I am sorry if this question is too easy.\nThank you guys in advance for your help. </p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":52,"score":5,"question_id":13065617,"title":"append list to a list","body":"<p>I know this is a really noob question, but how do I append a list of dataframes to a dataframe to form a new list, with all the data.frames at the same level in the list?</p>\n\n<p>Some of my attempts:</p>\n\n<pre><code>&gt; df &lt;- data.frame(time=1:5)\n&gt; df\n  time\n1    1\n2    2\n3    3\n4    4\n5    5\n&gt; innerlist &lt;- list(df,df,df)\n&gt; innerlist\n[[1]]\n  time\n1    1\n2    2\n3    3\n4    4\n5    5\n\n[[2]]\n  time\n1    1\n2    2\n3    3\n4    4\n5    5\n\n[[3]]\n  time\n1    1\n2    2\n3    3\n4    4\n5    5\n\n&gt; outerlist &lt;- list(df,innerlist)\n&gt; outerlist\n[[1]]\n  time\n1    1\n2    2\n3    3\n4    4\n5    5\n\n[[2]]\n[[2]][[1]]\n  time\n1    1\n2    2\n3    3\n4    4\n5    5\n\n[[2]][[2]]\n  time\n1    1\n2    2\n3    3\n4    4\n5    5\n\n[[2]][[3]]\n  time\n1    1\n2    2\n3    3\n4    4\n5    5\n\n\n&gt; outerlist2 &lt;- c(df,innerlist)\n&gt; outerlist2\n$time\n[1] 1 2 3 4 5\n\n[[2]]\n  time\n1    1\n2    2\n3    3\n4    4\n5    5\n\n[[3]]\n  time\n1    1\n2    2\n3    3\n4    4\n5    5\n\n[[4]]\n  time\n1    1\n2    2\n3    3\n4    4\n5    5\n\n&gt; outerlist3 &lt;- cbind(df,innerlist)\n&gt; outerlist3\n  time time time time\n1    1    1    1    1\n2    2    2    2    2\n3    3    3    3    3\n4    4    4    4    4\n5    5    5    5    5\n</code></pre>\n\n<p>Pretend that all the <code>df</code>s are different data-frames.</p>\n\n<p>I want to append df to innnerlist, and get a list with 4 dfs, like:</p>\n\n<pre><code>&gt; outerlistmagic &lt;- magic( df, innerlist )\n&gt; outerlistmagic\n[[1]]\n  time\n1    1\n2    2\n3    3\n4    4\n5    5\n\n[[2]]\n  time\n1    1\n2    2\n3    3\n4    4\n5    5\n\n[[3]]\n  time\n1    1\n2    2\n3    3\n4    4\n5    5\n\n[[4]]\n  time\n1    1\n2    2\n3    3\n4    4\n5    5\n</code></pre>\n"},{"tags":["r","statistics","glm"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13063762,"title":"How to obtain a LM object from regsubsets","body":"<p>Let's imagine we want to model the US State Public-School Expenditures (education) using income, young, urban and region as regressors. For more info: <code>?Anscombe</code>\nModel: education ~ (income+young+urban)*region</p>\n\n<pre><code>library(car)\nlibrary(leaps)\n\n#Loading Data\ndata(Anscombe)\ndata(state)\nstateinfo &lt;- data.frame(region=state.region,row.names=state.abb)\ndatamodel &lt;- data.frame(merge(stateinfo,Anscombe,by=\"row.names\"),row.names=1)\nhead(datamodel)\n   region education income young urban\nAK   West       372   4146 439.7   484\nAL  South       112   2337 362.2   584\nAR  South       134   2322 351.9   500\nAZ   West       207   3027 387.5   796\nCA   West       273   3968 348.4   909\nCO   West       192   3340 358.1   785\n\n#Saturated Model\nMOD1 &lt;- lm(education~(.-region)*region,datamodel)\nsummary(MOD1)\n#anova(MOD1)\n\n#Look for the \"best\" model\nMOD1.subset &lt;- regsubsets(education~(.-region)*region,datamodel,nvmax=15)\nplot(MOD1.subset) \n</code></pre>\n\n<p>The model with 3 variables and 1 interaction (education~income+young+urban+RegionWest:young) seems to be the best in terms of BIC. </p>\n\n<pre><code>coef(MOD1.subset,4)\n</code></pre>\n\n<p>The questions is, <em>how do I obtain the ML object from that model without writing the formula by hand</em>? </p>\n\n<p>Before posting, I found the package HH which has some interesting functions for regsubsets objects such as <code>summaryHH</code> and <code>lm.regsubsets</code>. </p>\n\n<pre><code>library(HH)\nsummaryHH(MOD1.subset)[4,]\nlm.regsubsets(MOD1.subset,4)\n</code></pre>\n\n<p><code>lm.regsubsets</code> does what I want but I think that has some problems parsing interactions, <em>any alternatives</em>?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13063273,"title":"in R Forecasted values","body":"<p>I have few questions regarding the forecast time series model in R. </p>\n\n<p>The forecast values which i got for this is::</p>\n\n<p><strong>Want to take these values: <code>40,60,67,80,87</code> as the percentage values.</strong></p>\n\n<p>So, How to consider Y-axis of the plot in percenatge</p>\n\n<pre><code>YrTimeSeries &lt;- c(40,60,67,80,87);\n\ntsValue&lt;-ts(YrTimeSeries,frequency=1,start=2006)\nlibrary(forecast)\n(forecast(tsValue,h=5))\n    Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95\n2011        86.9993 72.19680 101.8018 64.36083 109.6378\n2012        86.9993 66.06645 107.9321 54.98528 119.0133\n2013        86.9993 61.36233 112.6363 47.79094 126.2077\n2014        86.9993 57.39653 116.6021 41.72576 132.2728\n2015        86.9993 53.90256 120.0960 36.38220 137.6164\n</code></pre>\n\n<ol>\n<li>The values for Forecasted value(blue line) for each year is same. Can someone please explain me why? </li>\n<li>The 95 % predictive interval is <code>(36.38220,137.62)</code>. What does it infer?</li>\n</ol>\n"},{"tags":["c++","r","module","rcpp"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":12405655,"title":"returning a custom object from a wrapped methon in Rcpp","body":"<p>I have the following problem with the Rcpp module:\nlet's assume I've two classes in a Rcpp module</p>\n\n<pre><code>class A {\n  public:\n    int x;\n};\n\nclass B\n  public:\n    A get_an_a(){\n      A an_a();\n      an_a.x=3;\n      return an_a;\n    }\n};\n\nRCPP_MODULE(mod){\n  using namespace Rcpp ;\n  class_&lt;A&gt;(\"A\")\n   .constructor()\n   .property(\"x\",&amp;A::get_x)\n  ;\n  class_&lt;B&gt;(\"B)\n   .constructor()\n   .method(\"get_an_A\",&amp;get_an_a)\n  ;\n}\n</code></pre>\n\n<p>.</p>\n\n<p>Right now compilation fails as it does not know what to do with the return type of A. </p>\n\n<p>I figured I could do something with Rcpp::Xptr, however, then I can't connect it to the S4 structure that Rcpp generated for the class A. I actually get an external pointer object from the method in R.</p>\n\n<p>Is there any possiblity to get a correctly wrapped object back from a method of the second class?</p>\n\n<p>Thanks,\nThomas</p>\n\n<p>[edit]</p>\n\n<p>According to Dirk's answer I constructed a wrapper that can create the wrapped S4 object:</p>\n\n<pre><code>template &lt;&gt; SEXP wrap(const A &amp;obj) { // insprired from \"make_new_object\" from Rcpp/Module.h\n  Rcpp::XPtr&lt;A&gt; xp( new A(obj), true ) ; // copy and mark as finalizable\n  Function maker=Environment::Rcpp_namespace()[ \"cpp_object_maker\"];\n  return maker ( typeid(A).name() , xp );\n}\n</code></pre>\n\n<p>Still, I don't know how to get the object back in as an parameter to a method/function. The following is not working:</p>\n\n<pre><code>template &lt;&gt; A* as( SEXP obj){\n  Rcpp::List l(obj);\n  Rcpp::XPtr&lt;A&gt; xp( (SEXP) l[\".pointer\"] );\n  return (A*) xp;\n}\n</code></pre>\n\n<p>So how could I get the external pointer to the C++ object from the S4 object provided as SEXP in the parameter list?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13063605,"title":"In R how to make the Y-axis values in percenatge","body":"<p>I am plotting time series graph with forecasting. I need to take the Y-axis values as in percentage. How to proceed for this. Please specify. </p>\n\n<pre><code>val &lt;- sqlQuery(dbhandle, 'select COUNT(*) from Admission where YEAR(YearOFRegistration)=2006 and YEAR(Admission)=2006); \nTtl &lt;- sqlQuery(dbhandle, 'select COUNT(*) from Admission where YEAR(YearOFRegistration)=2006');\n firstyr&lt;-(val/Ttl)*100\n</code></pre>\n\n<p>Same way I am calculating for each year. </p>\n\n<pre><code>&gt;  YrTimeSeries &lt;- c(firstyrs,secyr,thirdyr,forthyr,fifthyr)\ntsValue&lt;-ts(YrTimeSeries,frequency=1,start=2006)\nlibrary(forecast)\nplot(forecast(tsValue,h=5))\n</code></pre>\n\n<p><strong>Forecast values are</strong></p>\n\n<pre><code>Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95\n2011        86.9993 72.19680 101.8018 64.36083 109.6378\n2012        86.9993 66.06645 107.9321 54.98528 119.0133\n2013        86.9993 61.36233 112.6363 47.79094 126.2077\n2014        86.9993 57.39653 116.6021 41.72576 132.2728\n2015        86.9993 53.90256 120.0960 36.38220 137.6164\n</code></pre>\n\n<p>I am doing forecasting for next 6 years. I have included 2006 to 2010 years data and calculated in percentages. What I am worried about is I want to take predictive values in percentage of children taken addmision.Please elaborate where I am going wrong.</p>\n"},{"tags":["r","cut"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13061738,"title":"Cut and labels/breaks length conflict","body":"<p>I am working with the cut function to prep data for a barplot histogram but keep running into a seeming inconsistency between my labels and breaks:</p>\n\n<p><code>Error in cut.default(sample(1:1e+05, 500, T), breaks = sq, labels = sprintf(\"$%.0f\",  : \n  labels/breaks length conflict</code></p>\n\n<p>Here is an example. I pretend that it is income data, using a sequence of 0 to $100,000 in bins of $10,000. I use the same variable to generate both breaks and labels, with minor formating on the label side. I thought they might for some reason have different lengths when comparing to a character vector, but they appear to have the same length, still.</p>\n\n<pre><code>&gt; sq&lt;-seq(0,100000,10000)\n&gt; cut(sample(1:100000, 500, T),breaks=sq,labels=sprintf(\"$%.0f\",sq))\n&gt; length(sprintf(\"$%.0f\",sq))\n[1] [11]\n&gt; length(sq)\n[1] [11]\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Per @thelatemail and @Josh O'Brien's suggestions, I changed the code to this and things are in working order. \n<code>cut(sample(1:100000, 500, T),breaks=sq,labels=sprintf(\"$%.0f\",sq[-1]))</code></p>\n"},{"tags":["r","data.frame"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13062402,"title":"Find the index of the column in data frame that contains the string as value","body":"<p>I have data frame like this :</p>\n\n<pre><code>df &lt;- data.frame(col1 = c(letters[1:4],\"a\"),col2 = 1:5,col3 = letters[10:14])\n df\n  col1 col2 col3\n1    a    1    j\n2    b    2    k\n3    c    3    l\n4    d    4    m\n5    a    5    n\n</code></pre>\n\n<p>I want to find the index of the column of <code>df</code> that has values matching to string \"a\".\ni.e. it should give me <code>1</code> as result.\nI tried using which in sapply but its not working.\nAnybody knows how to do it without a loop ??  </p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13062470,"title":"Sort one column while keeping the other one fixed (within the other)","body":"<p>With</p>\n\n<pre><code>df &lt;- data.frame(x = rep(1:3, each = 3)\n        , y = rep(1:3, 3)\n        , z = round(rnorm(9), 2))\n\ndf\n  x y     z\n1 1 1  0.55\n2 1 2  0.99\n3 1 3 -2.32\n4 2 1 -0.25\n5 2 2  1.20\n6 2 3 -0.38\n7 3 1  1.07\n8 3 2 -0.98\n9 3 3 -1.09\n</code></pre>\n\n<p>Is there a way to sort <code>z</code> within each <code>x</code> so that:</p>\n\n<pre><code>df.sort\n  x y     z\n1 1 3 -2.32\n2 1 1  0.55\n3 1 2  0.99\n4 2 3 -0.38\n5 2 1 -0.25\n6 2 2  1.20\n7 3 3 -1.09\n8 3 2 -0.98\n9 3 1  1.07\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["r","filtering","code-efficiency"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":71,"score":4,"question_id":13058614,"title":"R efficient filtering of dataframe (varying filters defined by user)","body":"<p>I wish to filter a dataframe, original.data, in R. The dataframe could have around 1-2 million observations. The dataframe has several fields and the names may vary. The user can select which fields to filter by. These field names are stored in names(all.filters), where all.filters is a list of variable length. The user may then choose the levels for each of the fields in names(all.filters). For example, this list may look something like:</p>\n\n<pre><code>&gt; all.filters\n$Period\n[1] \"2010-12-31\" \"2011-03-31\" \"2011-06-30\" \"2011-09-30\" \"2011-12-31\"\n[6] \"2012-03-31\" \"2012-06-30\" \"2012-09-30\"\n\n$Size\n[1] \"L\"  \"VL\"\n\n$Number\n[1] \"11\" \"21\" \"35\" \"42\" \"45\" \"47\" \"49\" \"52\" \"57\"\n</code></pre>\n\n<p>I am using the following code to apply the chosen filters:</p>\n\n<pre><code>attach(original.data)    \nfilter.names &lt;- names(all.filters)\nflag &lt;- 1\nfor(filter in filter.names){\n   flag &lt;- flag*(is.element(get(filter),all.filters[[filter]]))\n}\nfiltered.data &lt;- original.data[flag==1,]\n</code></pre>\n\n<p>This works, but it feels a little slow. Note that get(filter) retrieves the column of original.data with column name equal to filter. I'm not sure if this is a good way to filter the data, but the variable nature of all.filters limits my choices a bit - I wanted to use subset, but I'm not sure what to put as the select argument. I would like to make this filtering step as fast as possible so that when the user updates a filter selection, the data can be plotted quickly.</p>\n\n<p>Once the data is filtered, I use reshape2 to summarise the data before plotting it with ggplot2. I am thinking that it may be more efficient to apply the filters at one of these steps if possible.</p>\n\n<p>Any suggestions would be greatly appreciated.</p>\n"},{"tags":["android","r"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":146,"score":2,"question_id":13047994,"title":"Are there any Android version of R (without rooting the device)?","body":"<p>Are there any version/equivalent of <a href=\"http://www.r-project.org/\" rel=\"nofollow\">R</a> for android platform, specifically a <code>.apk</code> file? </p>\n\n<p>If not, how do one build it from the <a href=\"http://cran.r-project.org/sources.html\" rel=\"nofollow\">source</a>, without <em>rooting</em> the device?</p>\n\n<p>(R is a free software environment for statistical computing and graphics. It compiles and runs on a wide variety of UNIX platforms, Windows and MacOS.) </p>\n"},{"tags":["r","callstack"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":65,"score":4,"question_id":13058062,"title":"Show special primitive functions in call stack","body":"<p><a href=\"http://stackoverflow.com/q/13056392\">This question</a> prompted the following question: Is there a way to view the <a href=\"http://cran.r-project.org/doc/manuals/R-ints.html#Special-primitives\" rel=\"nofollow\">special primitive</a> functions that are in the call stack?</p>\n\n<p>For example, create a function that returns the call stack on exit:</p>\n\n<pre><code>myFun &lt;- function(obj){\n  on.exit(print(sys.calls()))\n  return(obj)\n}\n</code></pre>\n\n<p>Calling this function and assigning its result to an object using <code>assign</code> avoids using special primitive functions:</p>\n\n<pre><code>&gt; assign(\"myObj\",myFun(4))\n[[1]]\nassign(\"myObj\", myFun(4))\n\n[[2]]\nmyFun(4)\n</code></pre>\n\n<p>But using the assignment operator, this gets left out of the stack</p>\n\n<pre><code>&gt; `&lt;-`(myObj, myFun(6))\n[[1]]\nmyFun(6)\n</code></pre>\n\n<p>Granted, it might not be all that common to want to see the assignment operator in the call stack, but other functions such as <code>rep</code> and <code>log</code> also get hidden</p>\n"},{"tags":["r","data.frame","data.table"],"answer_count":4,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":200,"score":8,"question_id":12164897,"title":"Quickly view an R data.frame, vector, or data.table in Excel","body":"<p>How do you quickly open small R table / vector objects in Excel?</p>\n\n<p>For example suppose you have the following three objects that you want to view in Excel:</p>\n\n<pre><code>## A data frame with commas and quotes\ndf = data.frame(\n  area = unname(state.x77[,'Area']),\n  frost = unname(state.x77[,'Frost']),\n  comments = \"Ok for a visit, but don't want to live there\",\n  challengeComments = c('\"', '\"\"'))\nrow.names(df) = state.name\ndf = df[1:10, ]\ndf['California', 'comments'] = \"Would like to live here\"\n\n## A Matrix\nmat = matrix(rnorm(100), 10)\n\n## A Vector\nv = 1:10\n</code></pre>\n"},{"tags":["r","unix","replace","sed","awk"],"answer_count":6,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":140,"score":6,"question_id":12297859,"title":"find and replace characters before \":\"","body":"<p>I have a file containing a certain number of lines. Each line looks like this:</p>\n\n<blockquote>\n  <p>TF_list_to_test10004/Nus_k0.345_t0.1_e0.1.adj:PKMYT1</p>\n</blockquote>\n\n<p>I would like to remove all before \":\" character in order  to retain only PKMYT1 that is a gene name. \nSince I'm not an expert in regex scripting can anyone help me to do this using Unix (sed or awk) or in R?\nThanks a lot</p>\n\n<p>Eleonora</p>\n"},{"tags":["r","group","aggregate","plyr"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":177,"score":2,"question_id":10037823,"title":"How to group by sum of measurement variables without explicitly naming them?","body":"<p>I want to write a function to analyze a data set where I need to aggregate/group by/split on each combination of identification variables. Unfortunately the measurement variable are numerous, often change and enumerating them leads to brittle code and bugs in the inputs. </p>\n\n<pre><code>dat &lt;- data.frame(id.a=c('aa','bb','aa','bb'),id.b=c('x','y','x','x'),m.c=c(1:4),m.d=c(5:8)) \nid.vars &lt;- c('id.a', 'id.b')\nmeasure.vars &lt;- setdiff(names(dat),id.vars)\n</code></pre>\n\n<p>I would like to sum up my measurment variables.  I have found ways but they are all hacky. The result would be </p>\n\n<pre><code>id.a id.b m.c m.d\n1   aa    x   4  12\n2   bb    y   2   6\n3   bb    x   4   8\n</code></pre>\n\n<p>I think that reshape2 or ddply is likely to be a solution.</p>\n"},{"tags":["function","r","parameters","ellipsis"],"answer_count":4,"favorite_count":19,"up_vote_count":23,"down_vote_count":0,"view_count":2492,"score":23,"question_id":3057341,"title":"How to use R's ellipsis feature when writing your own function?","body":"<p>The R language has a nifty feature for defining functions that can take a variable number of arguments. For example, the function <code>data.frame</code> takes any number of arguments, and each argument becomes the data for a column in the resulting data table. Example usage:</p>\n\n<pre><code>&gt; data.frame(letters=c(\"a\", \"b\", \"c\"), numbers=c(1,2,3), notes=c(\"do\", \"re\", \"mi\"))\n  letters numbers notes\n1       a       1    do\n2       b       2    re\n3       c       3    mi\n</code></pre>\n\n<p>The function's signature includes an ellipsis, like this:</p>\n\n<pre><code>function (..., row.names = NULL, check.rows = FALSE, check.names = TRUE, \n    stringsAsFactors = default.stringsAsFactors()) \n{\n    [FUNCTION DEFINITION HERE]\n}\n</code></pre>\n\n<p>I would like to write a function that does something similar, taking multiple values and consolidating them into a single return value (as well as doing some other processing). In order to do this, I need to figure out how to \"unpack\" the <code>...</code> from the function's arguments within the function. I don't know how to do this. The relevant line in the function definition of <code>data.frame</code> is <code>object &lt;- as.list(substitute(list(...)))[-1L]</code>, which I can't make any sense of.</p>\n\n<p>So how can I convert the ellipsis from the function's signature into, for example, a list?</p>\n\n<p>To be more specific, how can I write <code>get_list_from_ellipsis</code> in the code below?</p>\n\n<pre><code>my_ellipsis_function(...) {\n    input_list &lt;- get_list_from_ellipsis(...)\n    output_list &lt;- lapply(X=input_list, FUN=do_something_interesting)\n    return(output_list)\n}\n\nmy_ellipsis_function(a=1:10,b=11:20,c=21:30)\n</code></pre>\n\n<hr>\n\n<h2>Edit</h2>\n\n<p>It seems there are two possible ways to do this. They are <code>as.list(substitute(list(...)))[-1L]</code> and <code>list(...)</code>. However, these two do not do exactly the same thing. (For differences, see examples in the answers.) Can anyone tell me what the practical difference between them is, and which one I should use?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":118,"score":5,"question_id":13024167,"title":"How to make 'head' be applied automatically to output?","body":"<p>I have a bunch of large dataframes, so every time I want to display them, I have to use <code>head</code>:</p>\n\n<pre><code>head( blahblah(somedata) )\n</code></pre>\n\n<p>Typing head all the time gets old after the first few hundred times, so I'd like an easy way to do this if possible.  One of the cool things about R compared to java that things like this are often really easy, if you know the secret incantation.</p>\n\n<p>I searched in options, and found <code>max.print</code>, which almost works, except there is now a time delay.</p>\n\n<pre><code>head( blahblah(somedata) )\n</code></pre>\n\n<p>.... is instantaneous (to within the limits of my perception)</p>\n\n<pre><code>options(max.print=100)\nblahblah(somedata)\n</code></pre>\n\n<p>.... takes about 3 seconds, so longer than typing <code>head</code></p>\n\n<p>Is there some way of making <code>head</code> be applied automatically when printing large data structures?  </p>\n\n<p>An piece of code which reproduces this behavior:</p>\n\n<pre><code>long_dataset = data.frame(a = runif(10e5), \n                          b = runif(10e5), \n                          c = runif(10e5))\nsystem.time(head(long_dataset))\noptions(max.print = 6)\nsystem.time(print(long_dataset))\n</code></pre>\n"},{"tags":["r","aggregate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":12371947,"title":"aggregate ddply by factor or character?","body":"<p>How do you use aggregate if your unique column ID is a character?  </p>\n\n<pre><code>aggregate(data, list(data$colID), sum)\nError in Summary.factor(c(1L, 1L), na.rm = FALSE) : \n  sum not meaningful for factors\n</code></pre>\n\n<p>Change to character..</p>\n\n<pre><code>data$colID&lt;-as.character(data$colID)\n\naggregate(data, list(data$colID), sum)\nError in FUN(X[[1L]], ...) : invalid 'type' (character) of argument\n\nddply I get a similar error.  \nError in FUN(X[[1L]], ...) : \n  only defined on a data frame with all numeric variables\n</code></pre>\n\n<p>I only want to aggregate by the colID, I dont want to sum it.  I want all the other columns to sum.</p>\n\n<pre><code>dput(data)\nstructure(list(colID = structure(c(1L, 1L, 1L, 2L, 2L), .Label = c(\"a\", \n\"b\"), class = \"factor\"), col1 = c(1, 0, 0, 0, 2), col2 = c(0, \n1, 0, 2, 0), col3 = c(0, 0, 1, 0, 0), col4 = c(5, 5, 5, 7, 7)), .Names = c(\"colID\", \n\"col1\", \"col2\", \"col3\", \"col4\"), row.names = c(NA, -5L), class = \"data.frame\")\n</code></pre>\n"},{"tags":["r","aggregate","plyr","reshape2"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":207,"score":4,"question_id":8186133,"title":"Aggregate in R by week taking long time","body":"<p>I must be doing something wrong because this function is not finishing. </p>\n\n<p>I am trying to aggregate some data by week. The data is broken up into id and weeknumber. I'd like the result to have the id's as rows, the weeks as columns, and the totals as the values.</p>\n\n<p>Example of what I've tried so far (tried a bunch of other things, including adding a dummy variable = 1 and then fun.aggregating=sum over that): </p>\n\n<pre><code>ddply(data, .(id), dcast, id~weeknumber, value_var=\"id\", \n        fun.aggregate=length, fill=0, .parallel=TRUE)\n</code></pre>\n\n<p>Is there a better way to do this?</p>\n\n<p>Input:</p>\n\n<pre><code>id      week\n1       1\n1       2\n1       3\n1       1\n2       3\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>  1  2  3\n1 2  1  1\n2 0  0  1\n</code></pre>\n"},{"tags":["r","matrix"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":13060000,"title":"How can I separate a matrix into smaller ones in R?","body":"<p>I have the following matrix</p>\n\n<pre><code>2    4    1\n6    32   1\n4    2    1\n5    3    2\n4    2    2\n</code></pre>\n\n<p>I want to make the following two matrices based on 3rd column</p>\n\n<p>first</p>\n\n<pre><code>2    4\n6    32\n4    2\n</code></pre>\n\n<p>second</p>\n\n<pre><code>5    3\n4    2\n</code></pre>\n\n<p>Best I can come up with, but I get an error</p>\n\n<blockquote>\n  <p>x &lt;- cbind(mat[,1], mat[,2]) if mat[,3]=1 </p>\n  \n  <p>y &lt;- cbind(mat[,1], mat[,2]) if mat[,3]=2</p>\n</blockquote>\n"},{"tags":["linux","r","centos"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1882,"score":2,"question_id":9468164,"title":"Problems installing R on Linux CentOS 6.2","body":"<p>When installing R on Linux CentOS 6.2 I get the following:</p>\n\n<pre><code>Error: Package: R-core-2.10.0-2.el5.x86_64 (/R-core-2.10.0-2.el5.x86_64)\n           Requires: libtk8.4.so()(64bit)\nError: Package: R-core-2.10.0-2.el5.x86_64 (/R-core-2.10.0-2.el5.x86_64)\n           Requires: libtcl8.4.so()(64bit)\n</code></pre>\n\n<p>There are several helps out there for this type of error when using CentOS 4 or 5, but not for 6.2.  Has anyone found a solution with this OS version?  Thanks!</p>\n"},{"tags":["r","data.frame","data.table","set-operations"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":259,"score":3,"question_id":7822138,"title":"Porting set operations from R's data frames to data tables: How to identify duplicated rows?","body":"<p>[Update 1: As Matthew Dowle noted, I'm using <code>data.table</code> version 1.6.7 on R-Forge, not CRAN.  You won't see the same behavior with an earlier version of <code>data.table</code>.]</p>\n\n<p>As background: I am porting some little utility functions to do set operations on rows of  a data frame or pairs of data frames (i.e. each row is an element in a set), e.g. unique - to create a set from a list, union, intersection, set difference, etc.  These mimic Matlab's <code>intersect(...,'rows')</code>, <code>setdiff(...,'rows')</code>, etc., which don't appear to have counterparts in R (R's set operations are limited to vectors and lists, but not rows of matrices or data frames).  Examples of these little functions are below.  If this functionality for data frames already exists in some package or base R, I'm open to suggestions.</p>\n\n<p>I have been migrating these to data tables and one necessary step in the current approach is to find duplicated rows.  When <code>duplicated()</code> is executed an error is returned stating that data tables must have keys.  This is an unfortunate roadblock - other than setting keys, which isn't a universal solution and adds to computational costs, is there some other way to find duplicated objects?</p>\n\n<p>Here is a reproducible example:</p>\n\n<pre><code>library(data.table)\nset.seed(0)\nx   &lt;- as.data.table(matrix(sample(2, 100, replace = TRUE), ncol = 4))\ny   &lt;- as.data.table(matrix(sample(2, 100, replace = TRUE), ncol = 4))\n\nres3    &lt;- dt_intersect(x,y)\n</code></pre>\n\n<p>Yielding this error message:</p>\n\n<pre><code>Error in duplicated.data.table(z_rbind) : data table must have keys\n</code></pre>\n\n<p>The code works as-is for data frames, though I've named each function with the pattern <code>dt_operation</code>.</p>\n\n<p>Is there some way to get around this issue?  Setting keys only works for integers, which is a constraint I can't assume for the input data.  So, perhaps I'm missing a clever way to use data tables?</p>\n\n<hr>\n\n<p>Example set operation functions, where the elements of the sets are rows of data:</p>\n\n<pre><code>dt_unique       &lt;- function(x){\n    return(unique(x))\n}\n\ndt_union        &lt;- function(x,y){\n    z_rbind     &lt;- rbind(x,y)\n    z_unique    &lt;- dt_unique(z_rbind)\n    return(z_unique)\n}\n\ndt_intersect    &lt;- function(x,y){\n    zx          &lt;- dt_unique(x)\n    zy          &lt;- dt_unique(y)\n\n    z_rbind     &lt;- rbind(zy,zx)\n    ixDupe      &lt;- which(duplicated(z_rbind))\n    z           &lt;- z_rbind[ixDupe,]\n    return(z)\n}\n\ndt_setdiff      &lt;- function(x,y){\n    zx          &lt;- dt_unique(x)\n    zy          &lt;- dt_unique(y)\n\n    z_rbind     &lt;- rbind(zy,zx)\n    ixRangeX    &lt;- (nrow(zy) + 1):nrow(z_rbind)\n    ixNotDupe   &lt;- which(!duplicated(z_rbind))\n    ixDiff      &lt;- intersect(ixNotDupe, ixRangeX)\n    diffX       &lt;- z_rbind[ixDiff,]\n    return(diffX)\n}\n</code></pre>\n\n<hr>\n\n<p>Note 1:  One intended use for these helper functions is to find rows where key values in x are not among the key values in y.  This way, I can find where NAs may appear when calculating <code>x[y]</code> or <code>y[x]</code>. Although this usage allows for setting of keys for the <code>z_rbind</code> object, I'd prefer not to constrain myself to just this use case.</p>\n\n<p>Note 2:  For related posts, <a href=\"http://stackoverflow.com/questions/7809570/why-is-running-unique-faster-on-a-data-frame-than-a-matrix-in-r\">here is a post</a> on running <code>unique</code> on data frames, with excellent results for running it with the updated <code>data.table</code> package.\n  And <a href=\"http://stackoverflow.com/questions/7562284/extracting-unique-rows-from-a-data-table-in-r\">this is an earlier post</a> on running <code>unique</code> on data tables.</p>\n"},{"tags":["r","select","data.table"],"answer_count":2,"favorite_count":1,"up_vote_count":12,"down_vote_count":0,"view_count":134,"score":12,"question_id":12319083,"title":"How do I do a negative / nomatch / inverse search in data.table?","body":"<p>What happens if I want to select all the rows in a data.table that do not contain a particular value in the key variable using binary search? By the way, what is the correct jargon for what I want to do? Is it \"nojoin\"? Is it \"negative selection\"?</p>\n\n<pre><code>DT = data.table(x=rep(c(\"a\",\"b\",\"c\"),each=3), y=c(1,3,6), v=1:9)\nsetkey(DT,x)\n</code></pre>\n\n<p>Lets do a positive selection for all rows where x==\"a\" but using binary search</p>\n\n<pre><code>DT[\"a\"]\n</code></pre>\n\n<p>That's beautiful but I want the opposite of that. I want all the rows that are not \"a\" in other words where x!=\"a\"</p>\n\n<pre><code>DT[x!=\"a\"]\n</code></pre>\n\n<p>That is a vector scanning. The above line works but is uses vector scanning. I want to use binary. I was expecting the following to work, but alas...</p>\n\n<pre><code>DT[!\"a\"]\nDT[-\"a\"]\n</code></pre>\n\n<p>The above two do not work and trying to play with nomatch got me nowhere.</p>\n"},{"tags":["r","function","variable-assignment"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":13058679,"title":"generate variable names (something like get())","body":"<p>How can i substitute this code with a loop?</p>\n\n<pre><code>m1 &lt;- ggplot(foo)\nm2 &lt;- ggplot(foo)\n...\nm9 &lt;- ggplot(foo)\n</code></pre>\n\n<p>I guess i need something like <code>get()</code> to replace magic(), But get did not work here.</p>\n\n<pre><code>for (i in 1:9){\n  magic(i) &lt;- ggplot(foo)\n}\n</code></pre>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13058515,"title":"Function to identify problematic datatypes","body":"<p>I just spent several hours debugging some R code, only to discover that the error was due to an <code>Inf</code> that had sneaked in during my calculations.  I had checked for <code>NA</code>, but hadn't thought to check for <code>Inf</code>.</p>\n\n<p>I wrote the following function to help prevent this situation in the future:</p>\n\n<pre><code>is.bad &lt;- function(x){\n  is.na(x) | is.nan(x) | is.infinite(x)\n}\n\n&gt;     is.bad(c(NA, NaN, Inf, -Inf, 0, 1, 1000, 1e6))\n[1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE\n</code></pre>\n\n<p>Are there any other special data types in R I should be aware of?</p>\n"},{"tags":["r","heatmap"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13057777,"title":"How to change the color key value in heatmap.2?","body":"<p><img src=\"http://i.stack.imgur.com/PLdKd.png\" alt=\"enter image description here\"></p>\n\n<p>As the above screenshot showed, I used the function <code>heatmap.2()</code> here.</p>\n\n<p>how can I change '<strong>Value</strong>' in the color coded bar to <strong>any other name</strong>?</p>\n\n<p>One can just use the data from gplots package:</p>\n\n<pre><code> library(gplots)\n\n data(mtcars)\n\n x  &lt;- as.matrix(mtcars)\n\n rc &lt;- rainbow(nrow(x), start=0, end=.3)\n\n cc &lt;- rainbow(ncol(x), start=0, end=.3)\n\n heatmap.2(x, key=TRUE)\n</code></pre>\n\n<p>Many thanks :-)</p>\n"},{"tags":["r","emacs","rstudio","roxygen2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13059319,"title":"RStudio for making R package documentation similar to Emacs C-c C-o","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/10825058/can-rstudio-automatically-generate-an-roxygen-template-for-a-function\">Can RStudio automatically generate an roxygen template for a function?</a>  </p>\n</blockquote>\n\n\n\n<p>I use Emacs for developing R packages (using roxygen2) and find the C-c C-o over a function to generate comments extremely useful. Is there any similar key binds in RStudio that will achieve the same results, i.e. generating</p>\n\n<pre><code>##' .. content for \\description{} (no empty lines) ..\n##'\n##' .. content for \\details{} ..\n##' @title \n##' @param x \n##' @param y \n##' @return \n##' @author authors\n</code></pre>\n\n<p>The question has been asked <a href=\"http://stackoverflow.com/questions/10825058/can-rstudio-automatically-generate-an-roxygen-template-for-a-function\">here</a>, and I just wanna know if there is any updates on this issue. Thanks!</p>\n"},{"tags":["r","histogram","mean","bin","standard-deviation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13058996,"title":"mean and standard deviation per bin in histogram","body":"<p>I have some code in R that produces a histogram in R about the frequency of different power(watts) values for a machine at different points in time.  </p>\n\n<p>The histogram is divided in \"n\" number of bins or cells. </p>\n\n<p>Is there an easy way to calculate the mean value and the standard deviation IN EACH bin? </p>\n\n<p>So for example,</p>\n\n<pre><code>bin 1, mean = 0.5, sd=0.01\nbin 2, mean = 3.5, sd=0.23\nbin 3, mean = 4.5, sd=0.35\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":44,"score":-1,"question_id":13058978,"title":"Mean on the third dimension in R","body":"<p>Is there any quick way or build-in function in R to calculation the mean values based on the third dimension?</p>\n\n<p>For example my array is:</p>\n\n<pre><code>, , 1\n     [,1] [,2]\n[1,]    1    3\n[2,]    2    4\n\n, , 2\n    [,1] [,2]\n[1,]   11   13\n[2,]   12   14\n\n, , 3\n     [,1] [,2]\n[1,]   21   23\n[2,]   22   24\n</code></pre>\n\n<p>My output would be:</p>\n\n<pre><code>            [,1]        [,2]\n[1,]   mean(1,11,21)   mean(3,13,23)\n[2,]   mean(2,12,22)   mean(4,14,24)\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["r","io"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13058048,"title":"Faster way to import text file in R?","body":"<p>I am calling a FORTRAN program in R and analyzing FORTRAN's output file, which is a little big (around 50M per iteration). For each iteration, it takes about 50 seconds, in which the <code>read.table</code> command needs 42 seconds. Since I need to repeat this program 100,000 times, I am wondering if there are better ways to speed it up? </p>\n\n<p>For example, is it possible to let FORTRAN save everything into memory and pass it to R?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c++","r","memory-management"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":229,"score":6,"question_id":11687316,"title":"Modifying package gbm of R","body":"<p>We are trying to experiment using the gbm package on a quite large dataset (~140 million rows) and we have ran into a problem with the memory requirements of R. </p>\n\n<p>We have tried combining the packages 'gbm' and 'bigmemory' with no success and our next thought was to modify the C++ source code to draw data from a local database where we have stored our dataset.</p>\n\n<p>So, we were wondering if there is a more appropriate or well-known practice in order to change the allocation inside the C++ code of gbm. Has anyone tried something similar?</p>\n"},{"tags":["r","table"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":48,"score":3,"question_id":13049624,"title":"table() with rows all zeros","body":"<p>This seems simple enough but I could not find an easy answer anywhere.</p>\n\n<p>If we have the following data and use <code>table()</code>:</p>\n\n<pre><code>df &lt;- data.frame(x=c(\"a\",\"b\",\"a\"),y=c(\"b\",\"a\",\"c\"))\n\ntable(df)\n   y\nx   a b c\n  a 0 1 1\n  b 1 0 0\n</code></pre>\n\n<p>whats the easiest way to get:</p>\n\n<pre><code>   y\nx   a b c\n  a 0 1 1\n  b 1 0 0\n  C 0 0 0\n</code></pre>\n\n<p>without adding the <code>c</code> row manually after</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13058024,"title":"Reset the dgCMatrix's value","body":"<p>In R, I want to set dgCMatrix non-zero value to a vector.</p>\n\n<p>For example:</p>\n\n<p>Here is a dgCMatrix:</p>\n\n<pre><code>M\n3 x 4 sparse Matrix of class \"dgCMatrix\"\n\n[1,] . 1 . 1\n[2,] . . 1 .\n[3,] . . 1 .\n</code></pre>\n\n<p>And here is a vector:</p>\n\n<pre><code>a &lt;- c(1,2,3,4)\n</code></pre>\n\n<p>And then , I want to set the non-zero value to the vector by column . The result will be :</p>\n\n<pre><code>[1,] . 2 . 4\n[2,] . . 3 .\n[3,] . . 3 .\n</code></pre>\n\n<p>Thanks . </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13047411,"title":"call answer from a previous function","body":"<p>I'm trying to write a function in R that will return as its output, an one output from a previous function. The previous function returns a list of 3 different things. </p>\n\n<p>So far the only way I've worked out how to do this is completely copy and paste the original function, and get it to return only one answer, but surely there is a shorter way in which to do this?</p>\n"},{"tags":["r","s4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13055353,"title":"S4 object in R cannot be passed to Fortran","body":"<p>I use the <code>bdiag</code> function in the <code>Matrix</code> package in R to generate diagonal matrix, and then I pass the resultant matrix (called <code>mat</code>) into a self-written function but R fails to execute due to the following error:</p>\n\n<p><code>Error: invalid mode (S4) to pass to Fortran (arg 1)</code></p>\n\n<p>I checked <code>isS4(mat)</code> and it's <code>TRUE</code>. Thus, I guess there is a way to convert the S4 object somehow in order to be passed to the function. Any advice will be greatly appreciated!</p>\n\n<p>UPDATE: I use the following codes for constructing the block diagonal matrix:</p>\n\n<pre><code>grp.ids &lt;- as.factor(c(rep(1,8), rep(2,4), rep(3,2)))\nx &lt;- model.matrix(~grp.ids)\nX &lt;- do.call(bdiag, replicate(238, x, simplify=FALSE))\n</code></pre>\n\n<p>Is there any other way to get a S3 matrix without using the <code>bdiag</code> function? Thanks!</p>\n"},{"tags":["r","statistics"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13057189,"title":"What is most efficient way to plot a domain of convergence?","body":"<p>Say, you have a Newton Method algorithms with 2 parameters of interest(a,b).\nAnd I would like to plot their domain of convergence with x-axis = a, y-axis = b. Is there a really fast and simple to do this??? Any suggestions?</p>\n\n<p>My algorithm will basically converge for some values of a &amp; b. If I input (a,b), it will return (the number of iterations , value of a that it converge to, value of b that it converge to). Right now, I am thinking of setting up a  for loop within another for loop, which run through all possible values of b first holding a fixed, and all possible values that a will converge holding b fixed. </p>\n\n<p>However, my trouble is: how to identify whether a &amp; b is converging or not. And is there a better way than using nested for loops????</p>\n"},{"tags":["r","pdf","fonts","typeface"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":120,"score":4,"question_id":13047889,"title":"pdf device and font family \"Arial\" / Or: Change font name (not font) in PDF","body":"<p>I have a problem with typefaces and PDF-Output in R. On this windows machine there is no <em>Helvetica</em> and the Font used by the device seems to be <em>Arial</em> as you can see below.\nThe simple problem is, that Arial is used (as I want it to be) but editing the PDF-File it says <em>Helvetica</em> is used. How can I get R to write the correct Name into the PDF-file. <code>pdf(...,family=\"Arial\")</code> won't work, as this family is not known (grDevices version 2.15.1).</p>\n\n<p>Or can I substitude this font in the PDF afterwards, creating a file with the font I want?</p>\n\n<p>R-PDF-Output\n<img src=\"http://i.stack.imgur.com/GHv78.png\" alt=\"R Output: Arial Typeface\"></p>\n\n<p>Comparision from this Article:<a href=\"http://ilovetypography.com/2007/10/06/arial-versus-helvetica/\" rel=\"nofollow\">Arial vs. Helvetica</a>\n<img src=\"http://i.stack.imgur.com/B8JSG.gif\" alt=\"enter image description here\"></p>\n"},{"tags":["r","iterate","paste","complex-numbers","column"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13056539,"title":"How to iterate over pairs of columns in a data table to create a new column in R","body":"<p>I currently have data of complex numbers in the form:</p>\n\n<pre><code>r1,i1,r2,i2,...\n-1.74550E-0001,5.04828E-0002,7.37643E-0002,-1.70416E-0001,...\n...\n</code></pre>\n\n<p>And wish to make new columns from the modulus of these complex numbers, I attempted to do this via:</p>\n\n<pre><code>data=read.table(\"umatrix.txt\", header=T, sep=\",\")\n\nfor (i in 1:43){\n  data$paste(\"m\",toString(i), sep = \"\") = sqrt((data$paste(\"r\",toString(i), sep = \"\")^2)+(data$paste(\"i\",toString(i), sep = \"\")^2))\n  }\n</code></pre>\n\n<p>But this obtains the error:</p>\n\n<blockquote>\n  <p>Error: attempt to apply non-function</p>\n</blockquote>\n\n<p>Presumably because paste() cannot be used in this manner with the datatable$column syntax. How would one achieve this? </p>\n\n<p>EDIT: Nevermind, fixed using the other syntax, as follows:</p>\n\n<pre><code>for (i in 1:43){\n    data[1:43,paste(\"m\",toString(i), sep = \"\")] = sqrt((data[1:43,paste(\"r\",toString(i), sep = \"\")]^2)+(data[1:43,paste(\"i\",toString(i), sep = \"\")]^2))\n}\n</code></pre>\n"},{"tags":["r"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":74,"score":6,"question_id":13053797,"title":"Don't drop zero in unquoted string as argument","body":"<p>I'm attempting to make a function for a package that allows the user to read in data without quotation marks.  It works almost as expected except the function turns 3.30 into 3.3 even though the final output is character.  How can I get my function to read in elements that are numbers but not to drop trailing zeros.  The big picture idea is:</p>\n\n<ol>\n<li>function that reads elements without using quotation marks</li>\n<li>function will not discard what R considers non significant zeros</li>\n<li>though the elements may look numeric I want them to be outputted as character elements</li>\n</ol>\n\n<p>Here are two attempts and what they out put (one attempt with <code>substitute(...())</code> and the other with <code>match.call(expand.dots = FALSE)</code>:</p>\n\n<pre><code>#attempt #1 \nfun &lt;- \nfunction(...){ \n    substitute(...())\n}\n\nfun(3.30, 5.05)\n\n#dropped zero on 3:30 (not what I want)\n&gt; fun(3.30, 5.05)\n[1] \"3.3\"  \"5.05\"\n\n#attempt #2 \nfun &lt;- \nfunction(...){ \n    x &lt;- match.call(expand.dots = FALSE)\n    as.character(x[[2]])\n}\n\nfun(3.30, 5.05)\n\n#again dropped zero on 3:30 (not what I want)    \n&gt; fun(3.30, 5.05)\n[1] \"3.3\"  \"5.05\"\n</code></pre>\n\n<p>With quotation marks it outputs what I want but this defeats the purpose of not having to provide quotation marks:</p>\n\n<pre><code>fun('3.30', '5.05')\n\n&gt; fun('3.30', '5.05')\n[1] \"3.30\" \"5.05\"\n</code></pre>\n\n<p>PS if someone has a better title for this thread feel free to edit</p>\n"},{"tags":["r","random-forest"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13055076,"title":"R randomForest subsetting can't get rid of factor levels","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1195826/dropping-factor-levels-in-a-subsetted-data-frame-in-r\">dropping factor levels in a subsetted data frame in R</a>  </p>\n</blockquote>\n\n\n\n<p>I'm trying to use a randomForest to predict sales.  I have 3 variables, one of which is a factor variable for storeId.  I know that there are levels in the test set that are NOT in the training set.  I'm trying to get a prediction for only levels present in the training set but can't get it to look past the new factor levels. </p>\n\n<p>Here's what I've tried so far:</p>\n\n<pre><code>require(randomForest)\ntrain &lt;- data.frame(sales = runif(10)*1000, storeId = factor(seq(1,10,1)), dat1 =runif(10), dat2 = runif(10)*10)\ntest &lt;- data.frame(storeId = factor(seq(2,11,1)), dat1 =runif(10), dat2 = runif(10)*10)\n\n\n&gt; train \n      sales storeId      dat1     dat2\n1  414.7791       1 0.7830092 7.178577\n2  719.5965       2 0.9512138 6.153049\n3  887.3197       3 0.6879827 5.413556\n4  706.5828       4 0.4486214 4.955400\n5  326.8189       5 0.0944885 6.900802\n6  840.5920       6 0.1917165 8.044636\n7  936.2206       7 0.2173074 4.835064\n8  244.6947       8 0.6526765 6.516790\n9  818.8747       9 0.3317644 9.651675\n10 631.6104      10 0.6998037 8.443972\n&gt; test \n   storeId      dat1     dat2\n1        2 0.7513645 3.442052\n2        3 0.2862487 3.196189\n3        4 0.4971865 6.074281\n4        5 0.8631945 8.766129\n5        6 0.3848105 5.001426\n6        7 0.9032262 7.018274\n7        8 0.1560501 4.523618\n8        9 0.3461597 5.551672\n9       10 0.1318464 3.092640\n10      11 0.6587270 1.348623\n\n\n&gt; RF1 &lt;- randomForest(train[,c(\"storeId\",\"dat1\",\"dat2\")], train$sales, do.trace=TRUE,\n+ importance=TRUE,ntree=5,,forest=TRUE)\n     |      Out-of-bag   |\nTree |      MSE  %Var(y) |\n   1 | 2.915e+05   544.44 |\n   2 | 1.825e+05   340.84 |\n   3 |  2.1e+05   392.19 |\n   4 | 1.914e+05   357.38 |\n   5 | 1.809e+05   337.78 |\n&gt; pred &lt;- predict(RF1, test)\nError in predict.randomForest(RF1, test) : \n  New factor levels not present in the training data\n</code></pre>\n\n<p>This part makes sense.</p>\n\n<p>So I try this:</p>\n\n<pre><code>&gt; test2 &lt;- test[test$storeId != 11,]\n&gt; pred &lt;- predict(RF1, test2)\nError in predict.randomForest(RF1, test2) : \n  New factor levels not present in the training data\n</code></pre>\n\n<p>So I try this:</p>\n\n<pre><code>&gt; levels(test2$storeId)\n [1] \"2\"  \"3\"  \"4\"  \"5\"  \"6\"  \"7\"  \"8\"  \"9\"  \"10\" \"11\"\n</code></pre>\n\n<p>And the \"11\" level is still in there.</p>\n\n<p>Next I try this:</p>\n\n<pre><code>&gt; test2$storeId &lt;- as.numeric(as.character(test2$storeId))\n&gt; test2$storeId &lt;- factor(test2$storeId)\n&gt; pred &lt;- predict(RF1, test2)\nError in predict.randomForest(RF1, test2) : \n  Type of predictors in new data do not match that of the training data.\n</code></pre>\n\n<p>despite the fact that things look ok here:</p>\n\n<pre><code>&gt; levels(test2$storeId)\n[1] \"2\"  \"3\"  \"4\"  \"5\"  \"6\"  \"7\"  \"8\"  \"9\"  \"10\"\n</code></pre>\n\n<p>Any suggestions for getting it to predict on just stores without the \"11\" level?</p>\n\n<p>EDIT:</p>\n\n<pre><code>&gt; test2$storeId &lt;- as.factor(as.character(test2$storeId))\n&gt; pred &lt;- predict(RF1, test2)\nError in predict.randomForest(RF1, test2) : \n  Type of predictors in new data do not match that of the training data.\n&gt; \n&gt; test2$storeId &lt;- drop.levels(test2$storeId)\n&gt; pred &lt;- predict(RF1, test2)\nError in predict.randomForest(RF1, test2) : \n  Type of predictors in new data do not match that of the training data.\n\n\n&gt; str(train)\n'data.frame':   10 obs. of  4 variables:\n $ sales  : num  800 679 589 812 384 ...\n $ storeId: Factor w/ 10 levels \"1\",\"2\",\"3\",\"4\",..: 1 2 3 4 5 6 7 8 9 10\n $ dat1   : num  0.5148 0.5567 0.9871 0.0071 0.736 ...\n $ dat2   : num  8.501 2.994 2.948 0.519 1.746 ...\n&gt; str(test)\n'data.frame':   10 obs. of  3 variables:\n $ storeId: Factor w/ 10 levels \"2\",\"3\",\"4\",\"5\",..: 1 2 3 4 5 6 7 8 9 10\n $ dat1   : num  0.0975 0.7435 0.7055 0.2085 0.2944 ...\n $ dat2   : num  5.96 6.84 3.96 8.93 8.62 ...\n&gt; str(test2)\n'data.frame':   9 obs. of  3 variables:\n $ storeId: Factor w/ 9 levels \"2\",\"3\",\"4\",\"5\",..: 1 2 3 4 5 6 7 8 9\n $ dat1   : num  0.0975 0.7435 0.7055 0.2085 0.2944 ...\n $ dat2   : num  5.96 6.84 3.96 8.93 8.62 ...\n</code></pre>\n"},{"tags":["r","multidimensional-array"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":66,"score":5,"question_id":13054912,"title":"Finding dimensional index in a multi-dimensional array in R","body":"<p>Am looking at say 3-dimensional array M: <code>M&lt;-dim(3,3,3)</code></p>\n\n<p>I want to find an efficient way to populate M with the following rule: \n    <em>M[i,j,k] = i/10 + j^2 + sqrt(k)</em>, \nideally without having to write a loop with a <code>for</code> statemenet. </p>\n\n<p>For clarification, there is a simple way to accomplishing this if M were 2-dimensional. If i wanted to have \n    <em>M[i,j] = i/10 + j^2</em>, \nthen i could just do\n    <code>M&lt;-row(M)/10 + col(M)*col(M)</code></p>\n\n<p>Is there something equivalent for 3-or-higher dimensional arrays?</p>\n"},{"tags":["r","hadoop","cloud"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12742584,"title":"Is there any cloud service that offers RHadoop framework rather than just Hadoop?","body":"<p>Since, I am developing a POC application as of now so, I would prefer a free service as it makes no sense to spend money on an idea if concept doesn't work out finally.</p>\n\n<p>PS: I did a google check but, mostly services are currently just offering Hadoop rather than RHadoop</p>\n"},{"tags":["r","vectorization","glm","tapply"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13055726,"title":"Vectorize glm and extract all information","body":"<p>I have a data set \"keywords\" with several groups.  I want to apply glm to each group individually to create a list of glm fits with one fit for each group.</p>\n\n<p>I could do this with a <strong>for</strong> loop, but thats not in the R spirit.  Instead, I tried to do it with a <strong>by</strong> function:</p>\n\n<pre><code>CTR.glm &lt;- by(keywords,keywordsInSample,\n          function(x) ifelse(nlevels(factor(x$AveragePosition))&gt;20, # only these keywords will be fit\n                             glm(Clicks ~ poly(log(AveragePosition),2) + offset(log(Impressions)),\n                                 family = poisson,data = x),\n                             NA)) # for functions that can't be fit\n</code></pre>\n\n<p>The problem is that whereas <strong>glm</strong> normally returns a glm-class object from which I can extract all sorts of goodies, <strong>by</strong> returns a list</p>\n\n<pre><code>&gt; CTR.glm[2]\n$`text of second keyword`\n               (Intercept) poly(log(AveragePosition), 2)1 poly(log(AveragePosition), 2)2 \n                 -3.626237                      -5.108795                      -1.751032 \n&gt; class(CTR.glm[2])\n[1] \"list\"\n</code></pre>\n\n<p>All information has been lost except for the parameters of the fit.  Is there a way to force by to keep all the information about the list?</p>\n\n<p>p.s., I tried using the <strong>plyr</strong> toolbox, but it got stuck because my keywords have spaces in them.</p>\n\n<p>p.p.s., this post should have the tag \"by\", but I can't create that tag (new to stackoverflow), could someone retag it?</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13056125,"title":"strange error when creating a model with zelig","body":"<pre><code>dput(t)\nstructure(list(Volume = c(2625941L, 4685483L, 3160694L, 2627816L, \n2430273L, 2498011L, 2632445L, 3224434L, 2531941L, 5043867L, 2788003L, \n3278796L, 3273977L, 3192613L, 3456297L, 2668175L, 2805861L, 2689392L, \n2733510L, 3285889L, 2957370L, 3420479L, 3868692L, 4353776L, 3134759L, \n2914727L, 3160491L, 3803716L, 3427911L, 2646258L, 3616962L, 3071943L, \n3013008L, 4024996L, 4357129L, 3110560L, 3063334L, 4537971L, 1902002L, \n2618413L, 2473005L, 2844029L, 2398462L, 3406776L, 3071573L, 3714231L, \n4276458L, 3825187L, 2652650L, 3040994L, 2695117L, 3038566L, 2695652L, \n2919113L, 2840214L, 2768958L, 5246649L, 3023172L, 3565584L, 2928450L, \n3503840L, 2948165L, 3512192L, 3409995L, 3511665L, 3155152L, 3020401L, \n2758133L, 2548245L, 3033309L, 2740213L, 2851881L, 3134557L, 4445879L, \n3173913L, 3720477L, 3753070L, 3609973L, 3826284L, 4864280L, 4159588L, \n3095322L, 3138732L, 3591433L, 3063357L, 3215559L, 3258059L, 3559727L, \n4886550L, 4025763L, 4108614L, 5720774L, 4075195L, 3322352L, 3048940L, \n3249172L, 3148053L, 3321660L, 3159642L, 3976820L, 3848960L, 3466783L, \n3811408L, 6033563L, 4114751L, 3181385L, 2926695L, 2866148L, 2692198L, \n3400891L, 2922295L, 3912049L, 3079066L, 2833293L, 3560196L, 3317644L, \n3151086L, 3776538L, 5479510L, 3954497L, 3594429L, 3088262L, 2778180L, \n3532457L), SLA = c(28L, 44L, 12L, 28L, 4L, 28L, 4L, 4L, 8L, 12L, \n8L, 4L, 8L, 4L, 8L, 8L, 32L, 4L, 36L, 8L, 4L, 8L, 20L, 8L, 32L, \n12L, 32L, 8L, 16L, 40L, 8L, 20L, 4L, 4L, 8L, 20L, 16L, 4L, 12L, \n8L, 4L, 8L, 4L, 4L, 8L, 12L, 12L, 16L, 28L, 28L, 12L, 16L, 16L, \n8L, 20L, 20L, 24L, 44L, 12L, 24L, 24L, 24L, 20L, 24L, 36L, 16L, \n40L, 24L, 4L, 44L, 8L, 16L, 12L, 8L, 32L, 12L, 20L, 16L, 28L, \n8L, 24L, 24L, 4L, 4L, 8L, 8L, 4L, 12L, 8L, 44L, 12L, 24L, 40L, \n8L, 4L, 8L, 12L, 12L, 8L, 16L, 24L, 8L, 36L, 48L, 36L, 12L, 36L, \n28L, 20L, 12L, 20L, 32L, 24L, 4L, 12L, 16L, 8L, 24L, 16L, 36L, \n44L, 12L, 8L, 4L), Duration = c(21L, 25L, 15L, 13L, 15L, 20L, \n17L, 20L, 12L, 15L, 31L, 12L, 24L, 16L, 25L, 13L, 13L, 20L, 21L, \n20L, 26L, 15L, 26L, 21L, 27L, 20L, 34L, 29L, 74L, 62L, 33L, 27L, \n26L, 23L, 30L, 26L, 26L, 18L, 19L, 13L, 25L, 18L, 20L, 18L, 37L, \n20L, 22L, 25L, 24L, 22L, 42L, 17L, 18L, 18L, 28L, 18L, 28L, 32L, \n23L, 31L, 12L, 30L, 40L, 30L, 18L, 18L, 19L, 27L, 21L, 31L, 23L, \n26L, 14L, 22L, 21L, 21L, 26L, 30L, 21L, 23L, 12L, 22L, 24L, 29L, \n36L, 19L, 21L, 25L, 24L, 29L, 26L, 34L, 33L, 17L, 17L, 24L, 19L, \n18L, 12L, 18L, 11L, 19L, 22L, 48L, 49L, 25L, 16L, 43L, 18L, 18L, \n19L, 15L, 38L, 19L, 22L, 28L, 28L, 34L, 16L, 53L, 38L, 23L, 27L, \n17L)), .Names = c(\"Volume\", \"SLA\", \"Duration\"), class = \"data.frame\", row.names = c(2L, \n3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 16L, \n17L, 18L, 19L, 20L, 21L, 22L, 23L, 24L, 25L, 26L, 27L, 28L, 29L, \n30L, 31L, 32L, 33L, 34L, 35L, 36L, 37L, 38L, 39L, 40L, 41L, 42L, \n43L, 44L, 45L, 46L, 47L, 48L, 49L, 50L, 51L, 52L, 53L, 54L, 55L, \n56L, 57L, 58L, 59L, 60L, 61L, 62L, 63L, 64L, 65L, 66L, 67L, 68L, \n69L, 70L, 71L, 72L, 73L, 75L, 76L, 77L, 79L, 80L, 81L, 82L, 84L, \n85L, 86L, 87L, 88L, 89L, 90L, 91L, 92L, 93L, 94L, 95L, 96L, 97L, \n98L, 99L, 100L, 101L, 102L, 103L, 105L, 106L, 107L, 108L, 110L, \n111L, 112L, 113L, 115L, 116L, 117L, 118L, 119L, 120L, 121L, 122L, \n123L, 124L, 125L, 126L, 127L, 128L, 129L, 130L, 131L))\n</code></pre>\n\n<p>when I do this:</p>\n\n<pre><code>z.out1 &lt;- zelig(Duration ~ Volume, model = \"logit\", data = t)\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>Error in `rownames&lt;-`(`*tmp*`, value = c(1L, 0L)) : \n  attempt to set rownames on object with no dimensions\n</code></pre>\n\n<p>any ideas?</p>\n"},{"tags":["r","graph","base"],"answer_count":2,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":58,"score":6,"question_id":13052543,"title":"shading certain area in graph - a combination of lines and point plots in base R","body":"<p>I have following question:</p>\n\n<pre><code>set.seed(1234)\ndis = seq(1, 800, 10)\n yvar = rnorm(length (dis), 50, 10)\nmyd &lt;- data.frame (xvar = dis, yvar = yvar, yvarL = \nyvar - rnorm (length (yvar),5, 1), yvarU = yvar + rnorm (length (yvar), 5, 1))\nplot(myd$xvar,myd$yvar,pch=19,cex=.75,col=\"blue\")\npoints(myd$xvar,myd$yvarL,col=\"gray\", pch=19,cex=.5)\npoints(myd$xvar,myd$yvarU,col=\"gray\", pch=19,cex=.5)\n</code></pre>\n\n<p>Y has three values - Y, upper and lower confidence. I would like to shade between two intervals in axis. Rest of graph would be point only. The hypothesized product graph should be similar (not exactly). </p>\n\n<p><img src=\"http://i.stack.imgur.com/VxSZA.jpg\" alt=\"enter image description here\"></p>\n\n<p>How can I shade and produce line plot between two intervals say between 650 to 690 and 210 to 280 in myd$xvar. I tried to do some polygot fitting based on this post ( <a href=\"http://stackoverflow.com/questions/9449597/shading-within-xy-curve-plot-in-r\">shading within xy curve plot in R</a>), but not successful.</p>\n\n<pre><code>polygon(c(myd$xvar[1:200], myd$xvar[200:1]), c(myd$xvar[1:200],\n   myd$yvar[200:1]), col=\"gray\")\n</code></pre>\n"},{"tags":["r","bootstrapping"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":49,"score":3,"question_id":13053336,"title":"Bootstrapping confidence intervals and mean values for Log Response Ratio","body":"<p>I am trying to bootstrap 95% CIs and mean values for measurements in order to examine the effect size of a treatment. The method I want to use is called LnRR or Logarithmic Response Ratio (<a href=\"http://onlinelibrary.wiley.com/doi/10.1111/j.1469-185X.2007.00027.x/abstract?systemMessage=Wiley%20Online%20Library%20will%20be%20disrupted%20on%2027%20October%20from%2010:00-12:00%20BST%20%2805:00-07:00%20EDT%29%20for%20essential%20maintenance\" rel=\"nofollow\">1</a>, <a href=\"http://www.esajournals.org/doi/abs/10.1890/0012-9658%281999%29080%5B1150%3aTMAORR%5D2.0.CO;2\" rel=\"nofollow\">2</a>, <a href=\"http://www.plosone.org/article/info%3adoi/10.1371/journal.pone.0002400\" rel=\"nofollow\">3</a>). It's calculated simply by <code>Log(Response to treatment / Response to control)</code>. If the 95% CIs are not overlapping with 0, there is more than 95% probability for an effect naturally. Negative LnRR means that treatment has a negative effect. </p>\n\n<p>The bootstrapping function in boot package is kind of confusing and I am struggling to calculate 95%  CI's and mean values. I have tried following:</p>\n\n<pre><code>library(boot)\nset.seed(2)\ndat &lt;- data.frame(treatment = rnorm(10, 1.2, 0.4), control = rnorm(10, 1.5, 0.3))\n\nboot(dat, function(x) log(x[,1]/x[,2]), R = 999) # Because LnRR = log(dat[,1]/dat[,2])\n</code></pre>\n\n<p>I am clearly doing something wrong. How can I bootstrap confidence intervals (boot.ci) for this type of function? I am sure that the answer is <a href=\"http://www.statmethods.net/advstats/bootstrapping.html\" rel=\"nofollow\">here</a>, but for some reason, I just can't understand how to do this.</p>\n"},{"tags":["r","utf-8","locale"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":286,"score":3,"question_id":10955582,"title":"Displaying UTF-8 encoded Chinese characters in R","body":"<p>I try to open a UTF-8 encoded .csv file that contains (traditional) Chinese characters in R. For some reason, R displays the information sometimes as Chinese characters, sometimes as unicode characters.</p>\n\n<p>For instance:</p>\n\n<pre><code>data &lt;-read.csv(\"mydata.csv\", encoding=\"UTF-8\")\n\ndata\n</code></pre>\n\n<p>will produce unicode characters, while:</p>\n\n<pre><code>data &lt;-read.csv(\"mydata.csv\", encoding=\"UTF-8\")\n\ndata[,1]\n</code></pre>\n\n<p>will actually display Chinese characters.</p>\n\n<p>If I turn it into a matrix, it will also display Chinese characters, but if I try to look at the data (command View(data) or fix(data)) it is in unicode again.</p>\n\n<p>I've asked for advice from people who use a Mac (I'm using a PC, Windows 7), and some of them got Chinese characters throughout, others didn't. I tried to save the original data as a table instead and read it into R this way - same result. I tried running the script in RStudio, Revolution R, and RGui. I tried to adjust the locale (e.g. to chinese), but either R didn't let me change it or else the result was gibberish instead of unicode characters.</p>\n\n<p>My current locale is:</p>\n\n<blockquote>\n  <p>\"LC_COLLATE=French_Switzerland.1252;LC_CTYPE=French_Switzerland.1252;LC_MONETARY=French_Switzerland.1252;LC_NUMERIC=C;LC_TIME=French_Switzerland.1252\"</p>\n</blockquote>\n\n<p>Any help to get R to consistently display Chinese characters would be greatly appreciated... </p>\n"},{"tags":["r","rstudio"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":30,"score":-2,"question_id":13054255,"title":"How to re-save imported Stata dta file into a CSV file in R Studio","body":"<p>I've imported Stata data set into R by:</p>\n\n<pre><code>library(foreign) \nabcdata &lt;- read.dta(\"abc.dta\")\n</code></pre>\n\n<p>How to re-save \"abcdata\" into a CSV file? Thank you.</p>\n"},{"tags":["r","plot"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13052058,"title":"Plotting distribution of differences in R","body":"<p>I have a dataset with numbers indicating daily difference in some measure. </p>\n\n<p><a href=\"https://dl.dropbox.com/u/22681355/diff.csv\" rel=\"nofollow\">https://dl.dropbox.com/u/22681355/diff.csv</a></p>\n\n<p>I would like to create a plot of the distribution of the differences with special emphasis on the rare large changes.</p>\n\n<p>I tried plotting each column using the hist() function but it doesn't really provide a detailed picture of the data.</p>\n\n<p>For example plotting the first column of the dataset produces the following plot:</p>\n\n<p><a href=\"https://dl.dropbox.com/u/22681355/Rplot.pdf\" rel=\"nofollow\">https://dl.dropbox.com/u/22681355/Rplot.pdf</a></p>\n\n<p>My problem is that this gives very little detail to the infrequent large deviations.</p>\n\n<p>What is the easiest way to do this? </p>\n\n<p>Also any suggestions on how to summarize this data in a table? For example besides showing the min, max and mean values, would you look at quantiles? Any other ideas?</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13055070,"title":"is it possible to predict timeseries data with zelig package","body":"<p>I am trying to use zelig r package to do some predictive and simulated graphs:</p>\n\n<pre><code>dput(x)\nstructure(list(Date = structure(c(14640, 14668, 14699, 14729, \n14760, 14790, 14821, 14852, 14882, 14913, 14943, 14974, 15005, \n15033, 15064, 15094, 15125, 15155, 15186, 15217, 15247, 15278, \n15308, 15339, 15370, 15399, 15430, 15460, 15491, 15521, 15551, \n15582, 15611), class = \"Date\"), Records = c(44560938, 40227158, \n46674885, 45379535, 47051792, 51301979, 47659151, 50002855, 47952955, \n49681927, 51569764, 58513754, 62200793, 54645673, 61465915, 57829119, \n58410815, 64874812, 59066293, 71056318, 67101651, 62214988, 63183320, \n66750198, 61483322, 67546775, 75290893, 60713372, 77879142, 70290302, \n83201853, 83837301, 68110825)), .Names = c(\"Date\", \"Records\"), class = \"data.frame\", row.names = c(NA, \n33L))\n</code></pre>\n\n<p>When I do this:</p>\n\n<pre><code>z.out1 &lt;- zelig(Records~Date, model = \"logit\", data = x)\n</code></pre>\n\n<p>I get all these errors:</p>\n\n<pre><code>The following object(s) are masked from 'env (position 4)':\n\n    ..., data, formula, robust, w, weights\nThe following object(s) are masked from 'env (position 6)':\n\n    ..., data, formula, robust, w, weights\nThe following object(s) are masked from 'env (position 8)':\n\n    ..., data, formula, robust, w, weights\nThe following object(s) are masked from 'env (position 10)':\n\n    ..., data, formula, robust, w, weights\nThe following object(s) are masked from 'env (position 12)':\n\n    ..., data, formula, robust, w, weights\nThe following object(s) are masked from 'd.f (position 4)':\n\n    Date, Records\nThe following object(s) are masked from 'd.f (position 6)':\n\n    Date, Records\nThe following object(s) are masked from 'd.f (position 8)':\n\n    Date, Records\nThe following object(s) are masked from 'd.f (position 10)':\n\n    Date, Records\nThe following object(s) are masked from 'd.f (position 12)':\n\n    Date, Records\nError in eval(expr, envir, enclos) : y values must be 0 &lt;= y &lt;= 1\n</code></pre>\n\n<p>has anyone used zelig with timeseries data?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13053062,"title":"Data transformation based on the combination of numbers of subjects","body":"<p>I have a big dataset and want to transform it based on the combination of numbers of subjects. Here is a simplified sample dataframe:</p>\n\n<pre><code>data &lt;- read.table(textConnection(\"\ngroup subject status v1 v2\n    1       1      1  4 21\n    1       2      0  7 10\n    1       3      1  3  9\n2       1      0  8 75\n2       2      1  5  7\n2       3      1  2 11\n2       4      1  6  1\n3       1      1  9 37\"), header = TRUE) \n</code></pre>\n\n<p>In the first group, there are three subjects with the first and third ones having status = 1. The combinations of two possible subjects with status = 1 from three subjects are {(1, 2), (1, 3), (2, 3)}. The new data for the first group looks like this after transformed:</p>\n\n<pre><code>newgroup newsubject newstatus newv1 newv2\n       1          1         0    11    31\n       1          2         1     7    30\n       1          3         0    10    19\n</code></pre>\n\n<p>where only the second new subject takes 1 at newstatus because it is transformed from the first and third subjects they both take 1 at status in the original data. newv1 and newv2 are transformed from the summation of <code>v1</code> and <code>v2</code>: <code>v1_1 + v1_2 = 4 + 7 = 11, v1_1 + v1_3 = 4 + 3 = 7,  v1_2 + v1_3 = 7 + 3 = 10 ……</code></p>\n\n<p>In the fourth group, there are four subjects with the second to fourth ones having status = 1. The combinations of three possible subjects with <code>status = 1</code> from four subjects are {(1, 2, 3), (1, 2, 4), (1, 3, 4), (2, 3, 4)}. The new data for the second group looks like this after transformed:</p>\n\n<pre><code>newgroup newsubject newstatus newv1 newv2\n       2          1         0    15    93\n       2          2         0    19    83\n       2          3         0    16    87\n       2          4         1    13    19\n</code></pre>\n\n<p>The new data for the three groups looks like this:</p>\n\n<pre><code>data &lt;- read.table(textConnection(\"\nnewgroup newsubject newstatus newv1 newv2\n       1          1         0    11    31\n       1          2         1     7    30\n       1          3         0    10    19\n       2          1         0    15    93\n       2          2         0    19    83\n       2          3         0    16    87\n       2          4         1    13    19\n       3          1         1     9    37\"), header = TRUE) \n</code></pre>\n\n<p>Can anyone offer some help?</p>\n"},{"tags":["r","binary"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13054675,"title":"How to specify the number of days in each month for year 2000 using R?","body":"<p>I am trying to calculate the annual total of monthly product(binary files) <a href=\"https://echange-fichiers.inra.fr/get?k=Jr3tvgeKnWUiC1B0MMY\" rel=\"nofollow\">https://echange-fichiers.inra.fr/get?k=Jr3tvgeKnWUiC1B0MMY</a>. So I have 12 files and I have to calculate the total sum. The code given below worked fine but what I need is to multiply each file by the number of days which correspond to that month in that year then calculate the total sum. For my case, those data are for the year 2000 (a leap year), so I want to multiply the results for file number 1 by 31 and file number 2 by 29 and so on....</p>\n\n<pre><code> files&lt;- list.files(\"C:\\\\jung file_2000_img\", \"*.img\", full.names = TRUE)\nx&lt;- do.call(rbind,(lapply(files, readBin  , double() , size = 4 , n=360 * 720 , signed =TRUE)))\nresults &lt;- colSums(x)\nfileName &lt;- sprintf(\"C:\\\\annual_ET2000_without999_1.img\")\nwriteBin(as.double(results), fileName, size = 4)\n</code></pre>\n\n<p>From Jame's answer, this will calculate the number of days:</p>\n\n<pre><code>    numDays &lt;- function(month,year){\nas.numeric(strftime(as.Date(paste(year+month%/%12,month%%12+1,\"01\",sep=\"-\"))-1,\"%d\"))\n         }\n</code></pre>\n\n<p>So now how to apply that to my code above? By that I mean that I want to take the result for each file and multiply it by the number of days like:</p>\n\n<pre><code>    file1*numDays(1,2000)+file2*numDays(2,2000)+file3*numDays(3,2000)\n             .............file12*numDays(12,2000)\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13054209,"title":"R Studio Error: \"Unexpected Symbol\"","body":"<p>I'm in a statistics and data analysis class that recently started using R Studio. I'm getting an error message and so far I haven't been able to determine exactly what the error is or how to fix it.</p>\n\n<p>We were given instructions to plot this function:</p>\n\n<pre><code>y=0.1x^4-0.5x^3-x^2+3x-2\n</code></pre>\n\n<p>The next instruction asks to follow this coding and enter the above function:</p>\n\n<pre><code>&gt; x&lt;-seq(-5,5,by=2)\n&gt; y&lt;-enter the function, here\n&gt; plot(y~x)\n&gt; lines(y~x)\n</code></pre>\n\n<p>This is what I get when I enter the function in y:</p>\n\n<pre><code>&gt; x&lt;-seq(-5, 5, by=2)\n&gt; y&lt;-0.1x^4-0.5x^3-x^2+3x-2\nError: unexpected symbol in \"y&lt;-0.1x\"\n</code></pre>\n\n<p>Is the unexpected symbol the x? I tried removing the decimals in the function to test it out but get the same error message:</p>\n\n<pre><code>&gt; y&lt;-x^4-5x^3-x^2+3x-2\nError: unexpected symbol in \"y&lt;-x^4-5x\"\n</code></pre>\n\n<p>So I'm thinking it's the x that is the problem, but how do I fix it? I ran the x sequence code with no problem. </p>\n"},{"tags":["c++","r","rcpp"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13038256,"title":"Subset of a Rcpp Matrix that matches a logical statement","body":"<p>In R, if we have a data matrix, say a 100 by 10 matrix X, and a 100-elements vector t with possible values (0, 1, 2, 3), we can easily find a submatrix y of X using a simple syntax:</p>\n\n<pre><code>y = X[t == 1, ]\n</code></pre>\n\n<p>But, the problem is, how can I do that with Rcpp's NumericMatrix ?<br>\n(Or, more generally, how can I do that in C++'s any containers ?)</p>\n\n<p>Thanks to Dirk's hint, it seems that </p>\n\n<pre><code>NumericMatrix X(dataX);\nIntegerVector T(dataT);\nmat Xmat(X.begin(), X.nrow(), X.ncol(), false);\nvec tIdx(T.begin(), T.size(), false); \nmat y = X.rows(find(tIdx == 1));\n</code></pre>\n\n<p>Can do what I want, but that seems too lengthy. </p>\n"},{"tags":["r","statistics"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":46,"score":-4,"question_id":13053866,"title":"R: is quasi-newton method meant to be quicker than newton method?","body":"<p>The question above says it all. Please give me some of your thoughts</p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":182,"score":4,"question_id":10433223,"title":"is there any tool or IDE to debug R packages and run it step by step?","body":"<p>I am interested in some R packages, and want to understand how it works, is there any tool to run the method in package step by step and print the intermediate output?</p>\n"},{"tags":["r","statistics"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13052522,"title":"How to leave the R browser() mode in the console window?","body":"<p>I was trying to use the browser() command to debug earlier\nRight now, I kept getting the following in the console input window:</p>\n\n<pre><code>Browse[13]&gt;\n</code></pre>\n\n<p>is it possible to get out of this situation and just get back to  the normal console window.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13052274,"title":"R computed percentages do not sum up to one - precision issue","body":"<p>I am trying to deal with percentages in R and I am getting strange issue. When I convert values of vector to percentages of the <code>sum</code> of the vector, it often happens, that they do not add up to one.</p>\n\n<p>Minimal example:</p>\n\n<pre><code>data &lt;- rnorm(1000)*100\nmax &lt;- 50\nunlist(lapply(0:(1000/max-1), \n     function(i) \n        sum(\n            data[(i*max+1):(i*(max+1))]\n            /\n            sum(data[(i*max+1):(i*(max+1))])\n           )\n        ))-1 \n</code></pre>\n\n<p>It should give vector of zeros, however I am getting this:</p>\n\n<pre><code>[1]  0.000000e+00  0.000000e+00 -1.110223e-16 -1.110223e-16  0.000000e+00 -1.110223e-16  0.000000e+00  0.000000e+00  0.000000e+00\n[10]  0.000000e+00  0.000000e+00  2.220446e-16  0.000000e+00 -4.440892e-16  0.000000e+00  0.000000e+00  0.000000e+00  4.440892e-16\n[19] -1.110223e-16  0.000000e+00\n</code></pre>\n\n<p>Any idea for remedy?</p>\n"},{"tags":["python","r","rpy2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13045714,"title":"Plotting graphs with several lines rpython2 - additional lines won't show","body":"<p>I have the following simple code that attempts to show three graphs in the same plot. The two last graphs I ask for with the \"lines\"-function won't show and I am at my wits end. Is this a bug or am I doing something stupid?</p>\n\n<p>Workarounds, or ways of doing this not using \"lines\" also appreciated.</p>\n\n<p>No error messages, but won't show the lines I ask for (see the <code>r.lines()</code> calls below).</p>\n\n<pre><code>from rpy2.robjects import r\nfrom rpy2.robjects.packages import importr\ngrdevices = importr('grDevices')\n\nd = {0: {0: 5669, 800: 1001, 100: 2240, 200: 1606, 300: 1366, 400: 1236, 500: 1146, 600: 1083, 900: 964, 700: 1037}, 10: {0: 0, 800: 155, 100: 229, 200: 218, 300: 194, 400: 178, 500: 171, 600: 165, 900: 150, 700: 160}, 5: {0: 0, 800: 195, 100: 415, 200: 330, 300: 279, 400: 258, 500: 241, 600: 219, 900: 185, 700: 201}}\nx = range(0,1000,100)\ny = [d[0][i] for i in x]\nz = [d[5][i] for i in x]\nae  = [d[10][i] for i in x]\n\n#grdevices.pdf(file = 'reads_per_slackvalue_and_cluster_size.pdf')\n\nr.plot(x,y, main='Reads per slack value', xlab='slack value',ylab='number of reads', type='l', col='blue')\nr.lines(x, z, col='red')\nr.lines(x, ae, col='green')\n\n#r.legend(\"topleft\", ['0','5','10'], ['blue','red','green'])\n\n#grdevices.dev_off()\n\nshow_image = raw_input()\n</code></pre>\n\n<p>This is the result:</p>\n\n<p><img src=\"http://i.stack.imgur.com/3Z7AU.png\" alt=\"enter image description here\"></p>\n\n<p>This is what I get doing the same stuff interactively in R (more correct):</p>\n\n<p><img src=\"http://i.stack.imgur.com/3YixC.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","documentation"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":103,"score":4,"question_id":13048876,"title":"How do you write good R documentation?","body":"<p>I am not sure if the following is more suited for crossvalidated, but I believe more people writing documentation are found here. So here's my question:</p>\n\n<p>One of the things that's unique about R is, that most functions are motivated by an application in statistics, so the documentaiton necessarily at least includes references to scientific papers or books. Trying to develop an R package myself (aimed at users which are not familiar with, say, S3 classes), I wondered what balance to seek between technical documentation, statistical background and examples.</p>\n\n<p>I would also be grateful to be hinted at examples of good documentation (I know that awful ones are easier to point at).</p>\n"},{"tags":["r","sum","mean"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":66,"score":-1,"question_id":13049575,"title":"R - min, max and mean of off-diagonal elements in a matrix","body":"<p>I have like a matrix in R and I want to get:</p>\n\n<pre><code>Max off - diagonal elements\nMin off – diagonal elements\nMean off –diagonal elements\n</code></pre>\n\n<p>With diagonal I used max(diag(A)) , min(diag(A)) , mean(diag(A)) and worked just fine </p>\n\n<p>But for off-diagonal I tried </p>\n\n<pre><code>dataD &lt;- subset(A, V1!=V2)\n\nError in subset.matrix(A, V1 != V2) : object 'V1' not found\n</code></pre>\n\n<p>to use:</p>\n\n<pre><code>colMeans(dataD) # get the mean for columns\n</code></pre>\n\n<p>but I cannot get dataD b/c it says object 'V1' not found</p>\n\n<p>Thanks!</p>\n"},{"tags":["r","row"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":47,"score":4,"question_id":13047582,"title":"Adding values in a row to the previous one in R","body":"<p>I would like to perform a simple operation in R that is easily done in excel:</p>\n\n<p>I have a col consisting of 5045 entries called K. I would like to create a second col L where the first value is L1=100+K[1] the second is L2=L1+K[2], the third is L3=L2+K[3] and so on.</p>\n\n<p>Is there a simple way to do this in R? in Excel one just has to pull down the col.</p>\n"},{"tags":["r","mean"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13050751,"title":"Error using effects package in R; wrong variable type","body":"<p>While investigating some fundamentals of multiple regression, I decided to try and compare my manual efforts to those of the \"effects\" package, by John Fox. I've generated variables with some relationships, and want to get adjusted means for a factor when controlling for the influence of a continuous variable. </p>\n\n<p>I have become stalled, however, as the effect function in the effects package returns an error \"invalid type (builtin) for variable 'c'\"</p>\n\n<p>When I check the type of variable 'c' using <code>typeof(c)</code>, I'm told it is of type double, as I constructed it to be. </p>\n\n<ul>\n<li>What could be the cause of this error?</li>\n<li>Is the variable 'c' being coerced for some reason to type 'builtin'?</li>\n</ul>\n\n<p>Here is my code:</p>\n\n<pre><code>set.seed(1986)\ny &lt;- rnorm(100)\nf &lt;- sapply(y, function(x) if(x &lt; 0) 1 else 2)\nf.f &lt;- as.factor(f)\nset.seed(1987)\nc &lt;- rnorm(100, 0, .1) + y + f\n\nan3 &lt;- lm(y ~ f.f + c); summary(an3)\n\nef &lt;- effect(\"f.f\", an3)\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13050934,"title":"In R, how do I append a new field (or column name) to an existing array?","body":"<p>And when I initialize the new array, would I need every value in this field to be initialized with an actual numerical value?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":84,"score":0,"question_id":13023274,"title":"How to do printf in r?","body":"<p>I'm looking for how to do printf in r, ie I want to type:</p>\n\n<pre><code>printf(\"hello %d\\n\", 56 )\n</code></pre>\n\n<p>and get the same output as typing:</p>\n\n<pre><code>print(sprintf(\"hello %d\\n\", 56 )\n</code></pre>\n\n<p>I've read the following links:</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/4071586/printing-newlines-with-print-in-r\">Printing newlines with print() in R</a></li>\n<li><a href=\"http://stackoverflow.com/questions/3102643/whats-a-prettier-way-to-print-info-with-r\">what&#39;s a prettier way to print info with R?</a></li>\n</ul>\n\n<p>... so I'm aware I could use <code>cat(\"hello\", 56)</code> , and that's probably what I will do, but just wondering if there is some shortcut way of writing <code>print(sprintf(...))</code>?</p>\n\n<p>Sorry if this question is a duplicate (I dont know).  It's awfully hard to search for 'printf r', since it returns results for php, c, ...</p>\n"},{"tags":["c","r","theory"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":158,"score":0,"question_id":13050896,"title":"C : explain theory behind","body":"<p>I have minimal experience with C, but have been asked to convert a C program into R. There is one bit troubling me:</p>\n\n<p>I have a function that takes an int</p>\n\n<pre><code>int a\n</code></pre>\n\n<p>and within the function i have an array:</p>\n\n<pre><code>double b[3] = {\n\n       1.8293,\n       -0.592,\n       2.3330,\n}\n</code></pre>\n\n<p>and later on in the function i have:</p>\n\n<pre><code>c = b[a];\n</code></pre>\n\n<p>can someone tell me what this line is doing? what is being assigned to c? is it simply an array of size b, where all the values of b have been multiplied by a?</p>\n\n<p>Thanks.</p>\n"},{"tags":["r","ms-access","rodbc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13049106,"title":"Selecting a specific table in microsoft access 2007 with R code","body":"<p>I have an Access database with a couple of tables and I want to work in just one of them. I am using library <code>RODBC</code>. Let's say the table that I want to work it called <code>dtsample</code>. And my Access database is called <code>database.accdb</code></p>\n\n<p>Here is my code:</p>\n\n<pre><code>library(RODBC) \ndataconnect &lt;- odbcConnectAccess2007(\"database.accdb\")\ndata &lt;- sqlQuery(dataconnect,\"SELECT*dtsample columb1, columb2...) \n</code></pre>\n\n<p>but it does not work. How can I define the table in Access that I want to work with?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":69,"score":7,"question_id":13050330,"title":"How to search for equal variables in rows (in a smart way) and store according rows as subsets?","body":"<p>I have a huge data frame. One column is an integer ranging from 1 to 2.\nWhat I need is a way to look for continous rows with a number of certain values in this column, subset these rows and process them later into graphs.</p>\n\n<p>I attached a small example, which does at least some of the desired work:\nI am able to print out the subsets I am looking for. But two questions remain:</p>\n\n<ul>\n<li>I guess there are way smarter methods in R then to apply a \"for\" loop over the complete data.frame. Any hints?</li>\n<li>Which command do I have to put in where now the \"print\" command is to store the temporary data.frame? I guess I need a list due to the differing length of the subsets...</li>\n</ul>\n\n<p>I already had a look at aggregate or ddply, but could not come up with a solution.</p>\n\n<p>Any help is highly appreciated.</p>\n\n<pre><code>test&lt;-c(rep(1,3),rep(2,5),rep(1,3),rep(2,3),rep(1,3),rep(2,8),rep(1,3)) \nletters&lt;-c(\"a\",\"b\",\"c\",\"d\")\na1&lt;-as.data.frame(cbind(test,letters))\n\nBZ&lt;-2   #The variable to look for\nn_BZ=4  #The number of minimum appearences\n\nk&lt;-1  # A variable to be used as a list item index in which the subset will be stored\n\nfor (i in 2:nrow(a1)){\n  if (a1$test[i-1]!=BZ &amp; a1$test[i]==BZ)      # When \"test\" BECOMES \"2\"\n    {t_temp&lt;-a1[i,]}                            #... start writing a temporary array\n  else if (a1$test[i-1]==BZ &amp; a1$test[i]==BZ) # When \"test\" REMAINS \"2\"\n    {t_temp&lt;-rbind(t_temp,a1[i,])}              #... continue writing a temporary array \n  else if (a1$test[i-1]==BZ &amp; a1$test[i]!=BZ) # When \"test\" ENDS BEING \"2\"\n    {if (nrow(t_temp)&gt;n_BZ)                     #... check if the temporary array has more rows then demanded\n      {print(t_temp)                              #... print the array (desired: put the array to a list item k)\n       k&lt;-k+1}}                                   #... increase k\n    else                                      # If array too small\n    {t_temp&lt;-NULL}                              # reset\n}\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13046959,"title":"How do I find the smallest number in an array that's immediately larger than a given number in another array?","body":"<pre><code>larger1temp = wbd663$mbsf[which(wbd663$mbsf &gt; carb663$mbsf[i])]\n\nlarger1 = larger1temp[1]\n</code></pre>\n\n<p>^this is how I do it now, but there must be a far better way. it's a while loop, explaining the i.</p>\n\n<p>Basically, <code>wbd663$mbsf</code> is an array of depths, as is <code>carb663$mbsf</code> also is an array of depths. i want to find the smallest depth value in <code>wbd663$mbsf</code> that's larger than a given <code>carb663$mbsf[i]</code> value.</p>\n"},{"tags":["r","plot","data-visualization","lattice"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13049009,"title":"Plot xyplot lines correctly after re-ordering factors","body":"<p>When I make <code>xyplot</code> with line connections before reordering factors, it gives me a nice, sequential connections between data points:</p>\n\n<pre><code>library(lattice)\nfin &lt;- read.csv(\"http://dl.dropbox.com/u/2505196/unc_vall.csv\", header=T)\nxyplot(acceptability ~ character | motion, data=fin, col=1, \n       aspect=\"xy\", layout=c(6,1), type=\"o\", scales = list(x = list(rot = 90)))\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/lED46.png\" alt=\"enter image description here\"></p>\n\n<p>Then I reorder factors, and everything gets screwed:</p>\n\n<pre><code>fin$character &lt;- factor(fin$character, levels = c(\"battle\",\"klank\",\"manny\",\n                        \"skelly\",\"zombie\",\"loman\",\"himan\"))\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/GtNU9.png\" alt=\"enter image description here\"></p>\n\n<p>Reordering factors' levels works fine, the values go where they should, but somehow the order of line connections stays the same. It doesn't occur to me how I could change my reordering to make it work.</p>\n\n<p>EDIT: I should add that solution should be universal enough to work for both <code>xyplot</code> and <code>xYplot</code> from the package <code>Hmisc</code>.</p>\n"},{"tags":["r","bootstrap","nonlinear-functions"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":70,"score":6,"question_id":13032900,"title":"Singular gradient error during bootstrapped nls fit to bad data","body":"<p>I have a dataset containing an independent variable and a set of dependent variables. I'd like to fit a function to each set of independent variables, using a bootstrapped nonlinear least squares procedure. In some cases, the independent variables are 'good quality', i.e. fit the function reasonably well. In other cases, they're noisy.</p>\n\n<p>In all cases, I can use <code>nls()</code> to get an estimate of the parameters. However, when the data are noisy, a bootstrap throws the error <code>Error in nls(...) : singular gradient</code>.  I can understand why <code>nls</code> fitting to noisy data would fail, e.g. by failing to converge after too many iterations, but I don't understand why it is a singular gradient error, and why I only get it resampled datasets of poor quality.</p>\n\n<p>Code:</p>\n\n<pre><code>require(ggplot2)\nrequire(plyr)\nrequire(boot)\n\n# Data are in long form: columns are 'enzyme', 'x', and 'y'\nenz &lt;- read.table(\"http://dl.dropbox.com/s/ts3ruh91kpr47sj/SE.txt\", header=TRUE)\n\n# Nonlinear formula to fit to data\nmmFormula &lt;- formula(y ~ (x*Vmax) / (x + Km))\n</code></pre>\n\n<p><code>nls</code> is perfectly capable of fitting the data (even if in some cases, like <code>a</code>, I doubt the model fits the data. </p>\n\n<pre><code># Use nls to fit mmFormula to the data - this works well enough\nfitDf &lt;- ddply(enz, .(enzyme), function(x) coefficients(nls(mmFormula, x, start=list(Km=100, Vmax=0.5))))\n\n# Create points to plot for the simulated fits\nxGrid &lt;- 0:200\nsimFits &lt;- dlply(fitDf, .(enzyme), function(x) data.frame(x=xGrid, y=(xGrid * x$Vmax)/(xGrid + x$Km)))\nsimFits &lt;- ldply(simFits, identity) \n\nggplot() + geom_point(data=enz, aes(x=x, y=y)) + geom_line(data=simFits, aes(x=x, y=y)) + \n  facet_wrap(~enzyme, scales=\"free_y\") + aes(ymin=0)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/TkH0n.png\" alt=\"NLS fits of mmFormula to data\"></p>\n\n<p>Bootstrapping works fine for the good quality data:</p>\n\n<pre><code># Function to pass to bootstrap; returns coefficients of nls fit to formula\nnlsCoef &lt;- function(df, i) {\n  KmGuess &lt;- median(df$x)\n  VmaxGuess &lt;- max(df$y)\n  dfSamp &lt;- df[i,]\n  nlsCoef &lt;- coefficients(nls(mmFormula, dfSamp, start=list(Km=100, Vmax=0.5)))\n}\n\neBoot &lt;- boot(subset(enz, enzyme==\"e\"), nlsCoef, R=1000) #No error\n</code></pre>\n\n<p>But not for the poor quality data</p>\n\n<pre><code>dBoot &lt;- boot(subset(enz, enzyme==\"d\"), nlsCoef, R=10)\n&gt; Error in nls(mmFormula, dfSamp, start = list(Km = KmGuess, Vmax = VmaxGuess)) : \n   singular gradient\n</code></pre>\n\n<p>What is causing this error? And what should I do about it, given that I'd like to use <code>plyr</code> to simultaneously perform lots of bootstrap simulations?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13048797,"title":"Stop before RAM-swap to disk","body":"<p>I'm troubleshooting why my R-script uses too much RAM, and need to find where it occurs so I can start looking for a solution. The problem is that whenever the RAM is exceeded, the computer starts to swap to disk followed by 20 minutes of frustrating computer-freezings, R-restart, and need for reloading everything.</p>\n\n<p>Can I make the script stop before the RAM is full? I suppose a code like this is what I need. But I can't figure out the \"not sure 1\" and \"not sure 2\" functions needed to get the actual situation.</p>\n\n<pre><code>installed.RAM &lt;- notsure1()\nused.RAM &lt;- notsure2()\nstopifnot(used.RAM &lt; 0.9*installed.RAM)\n</code></pre>\n\n<p>What could notsure1() and notsure2() be?</p>\n\n<p>I use R on Ubuntu (with RStudio Server). 16GB of RAM.</p>\n"},{"tags":["r","packages"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13048543,"title":"Unable to install and run a package in R (windows)","body":"<p>I am working on a 64 bit windows system. And I have a 64 bit, 2.15.1 version of R installed in it. I am trying to install a package called \"MethLAB\" from the package menu, by selecting its local zip file from the \"Packages\" menu. However I am running into an error show below.</p>\n\n<pre><code>&gt; utils: : :menuInstallLocal ()\npackage 'MethLAB' successfully unpacked and MDS sums checked\n\n&gt; library(MethLAB)\n&gt; MethLAB()\nWarning message:\nIn file (filename, \"r\", encoding =encoding) :\n  unable to resolve 'bioconductor.org'\n</code></pre>\n\n<p>So the above is what i get when i try to run it. Can anyone help me with its proper installation and running ?</p>\n"},{"tags":["r","plot","dendrogram","hierarchical-clustering"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13046323,"title":"How to change the label size of an R plot","body":"<p>I`m making a cluster plot from my data. I have the entire plot finished but my label text is to large to be able to properly read the plot. Anyone any idea how to make labels smaller.</p>\n\n<p>I am using the package \"sparcl\", and my function is:</p>\n\n<pre><code>ColorDendrogram(fit,y=col.int, main = \"Clusters from 216 samples\",\n                branchlength = 0.20, labels = fit$labels, xlab = NULL,\n                sub = NULL, ylab = \"\", cex.main = NULL)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/s9A0C.jpg\" alt=\"enter image description here\"></p>\n\n<p>as you can see the branch text is to big and they fall over each other. I want the text of the leaves to be 25% smaller. I already looked at the documentation of the Sparcl package but that doesn't seem to work.</p>\n"},{"tags":["r","indexing"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":58,"score":-3,"question_id":13047532,"title":"starting index vector from 0 instead by 1 in R","body":"<p>I know this question has already been asked several times, but I haven't found nothing about this in R language. So, is it possible in R to change the starting index vector from 1 to 0? Because if it's possible, it will simplify a lot a program.</p>\n"},{"tags":["r","lattice"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":76,"score":6,"question_id":13026196,"title":"How to nicely rescale lattice figures?","body":"<p>When preparing figures for printing I often need to make them much smaller than they appear on screen. It is not uncommon to have figures down to just a few cm across. With the standard graphics package <code>par(cex=...)</code> can be used to scale down the entire plot to fit such a small area and still look proportional. Is there an equivalent to that in the lattice package?</p>\n\n<p>Basically, how do plot the figure below in the size of the right panel, but preserving the proportions of the left panel?</p>\n\n<p><img src=\"http://i.stack.imgur.com/MXZIY.png\" alt=\"enter image description here\">\n<img src=\"http://i.stack.imgur.com/n4OeQ.png\" alt=\"enter image description here\"></p>\n\n<p>This problem occurs to me every now and then, and it usually have me experimenting like mad with <code>trellis.par.get</code> and <code>trellis.par.set</code> before giving up and redrawing the entire figure using the standard graphics (which is <em>very</em> tedious). When discovering <code>trellis.par.set(simpleTheme(cex=...))</code> I thought I had hit gold, but it doesn't seem to do anything.</p>\n\n<h3>Clarifications</h3>\n\n<p>I want to rescale everything in the plot, including fontsizes, margins and tick sizes. The lot. I know I could simply adjust <code>pdf(height=..., width=...)</code> to get the proportions I like and then rescale it in the typesetting, e.g. InDesign or a word processor, but I feel I get better control if each pdf has its intended dimensions embedded in the file.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13048202,"title":"Error with panel data (plm) Error in crossprod(t(X), beta)","body":"<p>I have a df (a <code>pdata.frame</code> object):</p>\n\n<pre><code>head(df) :\n        Company Year Kapitalinkomster Bank.o.kassa Obligationer      Lån       Aktier Placeringar.andra.ftg   Fodringar Reala.tillgångar\n5-1948        5 1948         4.009780    0.8677505     40.12268 54.80897 1.4630271422           0.049855191 0.633959879     1.581139e+00\n6-1948        6 1948         3.221688    0.9311173     71.16401 26.39038 0.4678139417           0.000000000 0.437931676     4.931845e-01\n12-1948      12 1948         3.136025    0.7628832     46.10452 44.85120 4.1966304368           0.003740003 1.020092197     2.683785e+00\n19-1948      19 1948         1.862666    0.1865510     16.82441 31.67412 0.7308074302          46.245334945 3.459693951     6.213455e-01\n20-1948      20 1948         3.724516    1.7719721     70.98456 27.18631 0.0004305687           0.056565968 0.000165769     4.305687e-07\n21-1948      21 1948        11.288744    1.1572048     64.21109 33.42962 0.2890377378           0.000000000 0.912175552     1.150518e-06\n        Övriga.tillgångar\n5-1948       0.4726258998\n6-1948       0.1155685107\n12-1948      0.3771504323\n19-1948      0.2577362013\n20-1948      0.0000000000\n21-1948      0.0008697916\n</code></pre>\n\n<p>I then try to do a <code>random</code> model with <code>plm</code> package (Kapitalinkomster variable is regressed on the remaining variabler):</p>\n\n<pre><code>library(plm)\nrandom &lt;- plm(formula=Kapitalinkomster~ Bank.o.kassa+Obligationer+Lån+\n  Aktier+Placeringar.andra.ftg+Fodringar+Reala.tillgångar+Övriga.tillgångar,data=df,index=c(\"Company\",\"Year\"), model=\"random\")\n</code></pre>\n\n<p>I can get the output :</p>\n\n<pre><code>random\n\nModel Formula: Kapitalinkomster ~ Bank.o.kassa + Obligationer + Obligationer + \n    Lån + Aktier + Placeringar.andra.ftg + Fodringar + Reala.tillgångar + \n    Övriga.tillgångar\n\nCoefficients:\n          (Intercept)          Bank.o.kassa          Obligationer                   Lån                Aktier Placeringar.andra.ftg \n            0.7204962             0.0441635             0.0297014             0.0618975             0.0023219             0.0142085 \n            Fodringar      Reala.tillgångar \n            0.0341745            -0.0104192 \n</code></pre>\n\n<p>Above I can see the  <code>Övriga.tillgångar</code> variable in <code>Model Formula</code> but not in <code>Coefficients</code>..</p>\n\n<p>The problem is also that I cant get the <code>summary</code> when <code>Övriga.tillgångar</code> variable is included:</p>\n\n<pre><code>summary(random) :\nError in crossprod(t(X), beta) : non-conformable arguments\n</code></pre>\n\n<p>If I exclude it, the <code>summary(random)</code> works. </p>\n\n<p>Any suggestions?</p>\n"},{"tags":["r","stata","table"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":13043817,"title":"Command tabulate STATA in R","body":"<p>I'm trying to get a 2 way table in R similar to this one from STATA, I was trying to use CrossTable from gmodels package, but the table are not the same, do you known how can this be done in R</p>\n\n<p>I'm hope at least to get the value for the frequencies from </p>\n\n<p>when cursmoke1 == \"Yes\" &amp; cursmoke2 == \"No\" and reversed</p>\n\n<p>In R I'm only getting totals from yes, no and NA.</p>\n\n<p>Here is the Output </p>\n\n<p>STATA</p>\n\n<pre><code>. tabulate cursmoke1 cursmoke2, cell column miss row\n\n\n+-------------------+\n| Key               |\n|-------------------|\n|     frequency     |\n|  row percentage   |\n| column percentage |\n|  cell percentage  |\n+-------------------+\n\n   Current |\n   smoker, |      Current smoker, exam 2\n    exam 1 |        No        Yes          . |     Total\n-----------+---------------------------------+----------\n        No |     1,898        131        224 |     2,253 \n           |     84.24       5.81       9.94 |    100.00 \n           |     86.16       7.59      44.44 |     50.81 \n           |     42.81       2.95       5.05 |     50.81 \n-----------+---------------------------------+----------\n       Yes |       305      1,596        280 |     2,181 \n           |     13.98      73.18      12.84 |    100.00 \n           |     13.84      92.41      55.56 |     49.19 \n           |      6.88      35.99       6.31 |     49.19 \n-----------+---------------------------------+----------\n     Total |     2,203      1,727        504 |     4,434 \n           |     49.68      38.95      11.37 |    100.00 \n           |    100.00     100.00     100.00 |    100.00 \n           |     49.68      38.95      11.37 |    100.00 \n</code></pre>\n\n<p>R </p>\n\n<pre><code>&gt; CrossTable(cursmoke2, cursmoke1, missing.include = T, format=\"SAS\")\n\n\n   Cell Contents\n|-------------------------|\n|                       N |\n| Chi-square contribution |\n|           N / Row Total |\n|           N / Col Total |\n|         N / Table Total |\n|-------------------------|\n\n\nTotal Observations in Table:  4434 \n\n\n             | cursmoke1 \n   cursmoke2 |        No |       Yes |        NA | Row Total | \n-------------|-----------|-----------|-----------|-----------|\n          No |      2203 |         0 |         0 |      2203 | \n             |  1122.544 |   858.047 |   250.409 |           | \n             |     1.000 |     0.000 |     0.000 |     0.497 | \n             |     1.000 |     0.000 |     0.000 |           | \n             |     0.497 |     0.000 |     0.000 |           | \n-------------|-----------|-----------|-----------|-----------|\n         Yes |         0 |      1727 |         0 |      1727 | \n             |   858.047 |  1652.650 |   196.303 |           | \n             |     0.000 |     1.000 |     0.000 |     0.389 | \n             |     0.000 |     1.000 |     0.000 |           | \n             |     0.000 |     0.389 |     0.000 |           | \n-------------|-----------|-----------|-----------|-----------|\n          NA |         0 |         0 |       504 |       504 | \n             |   250.409 |   196.303 |  3483.288 |           | \n             |     0.000 |     0.000 |     1.000 |     0.114 | \n             |     0.000 |     0.000 |     1.000 |           | \n             |     0.000 |     0.000 |     0.114 |           | \n-------------|-----------|-----------|-----------|-----------|\nColumn Total |      2203 |      1727 |       504 |      4434 | \n             |     0.497 |     0.389 |     0.114 |           | \n-------------|-----------|-----------|-----------|-----------|\n</code></pre>\n"},{"tags":["python","r","numpy","pandas","data.table"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":747,"score":4,"question_id":7577546,"title":"Using pandas, how do I subsample a large DataFrame by group in an efficient manner?","body":"<p>I am trying to subsample rows of a DataFrame according to a grouping.  Here is an example.  Say I define the following data:</p>\n\n<pre><code>from pandas import *\ndf = DataFrame({'group1' : [\"a\",\"b\",\"a\",\"a\",\"b\",\"c\",\"c\",\"c\",\"c\",\n                            \"c\",\"a\",\"a\",\"a\",\"b\",\"b\",\"b\",\"b\"],\n                'group2' : [1,2,3,4,1,3,5,6,5,4,1,2,3,4,3,2,1],\n                'value'  : [\"apple\",\"pear\",\"orange\",\"apple\",\n                            \"banana\",\"durian\",\"lemon\",\"lime\",\n                            \"raspberry\",\"durian\",\"peach\",\"nectarine\",\n                            \"banana\",\"lemon\",\"guava\",\"blackberry\",\"grape\"]})\n</code></pre>\n\n<p>If I group by <code>group1</code> and <code>group2</code>, then the number of rows in each group is here:</p>\n\n<pre><code>In [190]: df.groupby(['group1','group2'])['value'].agg({'count':len})\nOut[190]: \n      count\na  1  2    \n   2  1    \n   3  2    \n   4  1    \nb  1  2    \n   2  2    \n   3  1    \n   4  1    \nc  3  1    \n   4  1    \n   5  2    \n   6  1    \n</code></pre>\n\n<p>(If there is an even more concise way to compute that, please tell.)</p>\n\n<p>I now want to construct a DataFrame that has one randomly selected row from each group.  My proposal is to do it like so:</p>\n\n<pre><code>In [215]: from random import choice\nIn [216]: grouped = df.groupby(['group1','group2'])\nIn [217]: subsampled = grouped.apply(lambda x: df.reindex(index=[choice(range(len(x)))]))\nIn [218]: subsampled.index = range(len(subsampled))\nIn [219]: subsampled\nOut[219]: \n    group1  group2  value\n0   b       2       pear \n1   a       1       apple\n2   b       2       pear \n3   a       1       apple\n4   a       1       apple\n5   a       1       apple\n6   a       1       apple\n7   a       1       apple\n8   a       1       apple\n9   a       1       apple\n10  a       1       apple\n11  a       1       apple\n</code></pre>\n\n<p>which works.  However, my real data has about 2.5 million rows and 12 columns.  If I do this the dirty way by building my own data structures, I can complete this operation in a matter of seconds.  However, my implementation above does not finish within 30 minutes (and does not appear to be memory-limited).  As a side note, when I tried implementing this in R, I first tried <code>plyr</code>, which also did not finish in a reasonable amount of time; however, a solution using <code>data.table</code> finished very rapidly.</p>\n\n<p>How do I get this to work rapidly with <code>pandas</code>?  I want to love this package, so please help!</p>\n\n<p>Thanks!</p>\n\n<p>Uri</p>\n"},{"tags":["r","function","vector","matrix","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13039997,"title":"Writing generic function for tables that works when the input happens to be vector","body":"<p>The automatic conversion of 2D <code>data.frame</code> or <code>matrix</code> to 1D vectors, also good, makes some problems while writing generic functions. For example trying to filter some columns of the input <code>foo</code> with a command like <code>foo[,1:3]</code> works fine for a <code>data.frame</code> or <code>matrix</code>:</p>\n\n<pre><code>foo=matrix(1:9,nrow=3)\nbar = function(x) print(x[,1])\nbar(foo) # [1] 1 2 3\n</code></pre>\n\n<p>But consider we first want to filter some rows of <code>foo</code>, and it happens that only a single row remains:</p>\n\n<pre><code>bar(foo[1,]) # Error in x[, 1] : incorrect number of dimensions\n</code></pre>\n\n<p>This problem may be solved by a simple trick:</p>\n\n<pre><code>bar = function(x) {\n    if (is.null(dim(x))) x = t(data.frame(x))\n    print(x[,1])\n}\n</code></pre>\n\n<p>But the problem would be much more complicated if we have other filters on <code>x</code> in the body of <code>bar()</code> that may convert it again to a vector. Then for every filtering we should check and do the same to ensure what we have is still a table.</p>\n\n<p>The other problems are: missing row names and/or column names if the filtered part of a matrix is only a single row/column. It needs further manipulation to re-organize the filtered part as a matrix, retrieve the original row/column names and assign them to the resulting matrix.</p>\n\n<p>The question is that: How to <em>simply</em> convert a function that works for tables a generic one, that if the input happens to be vector it still works?</p>\n"},{"tags":["r","project-management","project"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":98,"score":2,"question_id":13036472,"title":"project organization with R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1429907/workflow-for-statistical-analysis-and-report-writing\">Workflow for statistical analysis and report writing</a>  </p>\n</blockquote>\n\n\n\n<p>I have been programming with R for not too long but am running into a project organization question that I was hoping somebody could give me some tips on.  I am finding that a lot of the analysis I do is ad hoc: that is, I run something, think about the results, tweek it and run some more.  This is conceptually different than in a language like C++ where you think about the entire thing you want to run before coding.  It is a huge benefit of interpreted languages.  However, the issue that comes up is I end up having a lot of .RData files that I save so I don't have to <code>source</code> my script every time.  Does anyone have any good ideas about how to organize my project so I can return to it a month later and have a good idea of what each file is associated with?</p>\n\n<p>This is sort of a documentation question I guess. Should I document my entire project at each leg and be vigorous about cleaning up files that will no longer be necessary but were a byproduct of the research? This is my current system but it is a bit cumbersome.  Does anyone else have any other suggestions?</p>\n\n<p>Per the comment below: One of the key things that I am trying to avoid is the proliferation of .R analysis files and .RData sets that go along with them.</p>\n"},{"tags":["r"],"answer_count":5,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":1207,"score":2,"question_id":3875608,"title":"Grouping/recoding factors in the same data.frame","body":"<p>Let's say I have a data frame like this: </p>\n\n<pre><code>df &lt;- data.frame(a=letters[1:26],1:26)\n</code></pre>\n\n<p>And I would like to \"re\" factor a, b, and c as \"a\".</p>\n\n<p>How do I do that?</p>\n"},{"tags":["r","integer","data.frame","text-files","factor"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":742,"score":1,"question_id":9480408,"title":"Convert factor to integer in a data frame","body":"<p>I have the following code</p>\n\n<pre><code>anna.table&lt;-data.frame (anna1,anna2)\nwrite.table&lt;-(anna.table, file=\"anna.file.txt\",sep='\\t', quote=FALSE) \n</code></pre>\n\n<p>my table in the end contains numbers such as the following</p>\n\n<pre><code>chr         start    end      score\nchr2      41237927  41238801    151\nchr1      36976262  36977889    226\nchr8      83023623  83025129    185\n</code></pre>\n\n<p>and so on......</p>\n\n<p>after that i am trying to to get only the values which fit some criteria such as score less than a specific value</p>\n\n<p>so i am doing the following</p>\n\n<pre><code>anna3&lt;-\"data/anna/anna.file.txt\"\nanna.total&lt;-read.table(anna3,header=TRUE)\nsignificant.anna&lt;-subset(anna.total,score &lt;=0.001)\n\nError: In Ops.factor(score, 0.001) &lt;= not meaningful for factors\n</code></pre>\n\n<p>so i guess the problem is that my table has factors and not integers</p>\n\n<p>I guess that my anna.total$score is a factor and i must make it an integer</p>\n\n<p>If i read correctly the as.numeric might solve my problem</p>\n\n<p>i am reading about the as.numeric function but i cannot understand how i can use it</p>\n\n<p>Hence could you please give me some advices?</p>\n\n<p>thank you in advance</p>\n\n<p>best regards\nAnna</p>\n\n<p>PS : i tried the following</p>\n\n<pre><code>anna3&lt;-\"data/anna/anna.file.txt\"\nanna.total&lt;-read.table(anna3,header=TRUE)\nanna.total$score.new&lt;-as.numeric (as.character(anna.total$score))\nwrite.table(anna.total,file=\"peak.list.numeric.v3.txt\",append = FALSE ,quote = FALSE,col.names =TRUE,row.names=FALSE, sep=\"\\t\")\n\nanna.peaks&lt;-subset(anna.total,fdr.new &lt;=0.001)\nWarning messages:\n1: In Ops.factor(score, 0.001) : &lt;= not meaningful for factors\n</code></pre>\n\n<p>again i have the same problem......</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13045726,"title":"Normalization in R","body":"<pre><code>ID_REF           GSM133971          GSM133972               GSM13397\n244901_at   5.95461158752441E+001   1.88836498260498E+001   1.9821\n244902_at   7.25400314331055E+001   2.65250205993652E+001   1.9532\n244903_at   2.23291015625000E+002   1.78133636474609E+002   5.3816\n244904_at   3.65505447387695E+001   3.04016351699829E+000   6.8046\n244905_at   4.07523269653320E+001   2.58869285583496E+001   1.1808\n244906_at   1.50184860229492E+002   5.39840278625488E+001   4.1491\n244907_at   2.65190029144287E+001   1.39808797836304E+000   2.0866\n244908_at   3.50156021118164E+000   1.05003893375397E+000   4.5765\n</code></pre>\n\n<p>In the above dataset the first two columns are MAS5.0 normalized and the last column is RMA normalized. Would it be be possible to denormalize the dataset so that I can perform RMA normaliztion throughout ? The last column was from a different experiment which I needed to append. SO the normaliztions are different.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13043928,"title":"Selecting rows where a column has a string like 'hsa..'","body":"<p>I have a 371MB text file containing micro RNA data. Essentially, I would like to only select those rows that have information about human microRNA.</p>\n\n<p>I have read in the file using a read.table. Usually, I'd accomplish what I'd want with sqldf - if it had a 'like' syntax (select * from &lt;> where miRNA like 'hsa'). Unfortunately - sqldf does not support that syntax.</p>\n\n<p>How can I do this in R? I have looked around stackoverflow and do not see an example of how I can do a partial string match. I even installed the stringr package - but it does not quite have what I need.</p>\n\n<p>What I would like to do, is something like this - where all rows where hsa-<em>*</em> are selected.</p>\n\n<p><code>selectedRows &lt;- conservedData[, conservedData$miRNA %like% \"hsa-\"]</code> - which of course, is not correct syntax.</p>\n\n<p>Can somebody please help me with this. </p>\n\n<p>Thanks a lot for reading this,</p>\n\n<p>Asda</p>\n"},{"tags":["r","syntax"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13045032,"title":"extract all standard errors of coefficients from list of logistic regressions","body":"<p>I want to extract the standard errors from a list of logistic regression models.</p>\n\n<h3>This is the logistic regression function, designed this way so i can run more than one analysis at once:</h3>\n\n<pre><code>glmfunk &lt;- function(x) glm(  ldata$DFREE ~  x , family=binomial)\n</code></pre>\n\n<h3>I run it on a subset of the variables in the dataframe ldata:</h3>\n\n<pre><code>glmkort &lt;- lapply(ldata[,c(2,3,5,6,7,8)],glmfunk)\n</code></pre>\n\n<h3>I can extract the coefficients like this:</h3>\n\n<pre><code>sapply(glmkørt, \"[[\", \"coefficients\")\n</code></pre>\n\n<p><strong>But how do i extract the standard error of the coefficients? I can't seem to find it in the str(glmkort)?</strong></p>\n\n<p>Here is the str(glmkort) for AGE where i am looking for the standard error:</p>\n\n<pre><code>str(glmkort)\nList of 6\n $ AGE    :List of 30\n  ..$ coefficients     : Named num [1:2] -1.17201 -0.00199\n  .. ..- attr(*, \"names\")= chr [1:2] \"(Intercept)\" \"x\"\n  ..$ residuals        : Named num [1:40] -1.29 -1.29 -1.29 -1.29 4.39 ...\n  .. ..- attr(*, \"names\")= chr [1:40] \"1\" \"2\" \"3\" \"4\" ...\n  ..$ fitted.values    : Named num [1:40] 0.223 0.225 0.225 0.225 0.228 ...\n  .. ..- attr(*, \"names\")= chr [1:40] \"1\" \"2\" \"3\" \"4\" ...\n  ..$ effects          : Named num [1:40] 3.2662 -0.0282 -0.4595 -0.4464 2.042 ...\n  .. ..- attr(*, \"names\")= chr [1:40] \"(Intercept)\" \"x\" \"\" \"\" ...\n  ..$ R                : num [1:2, 1:2] -2.64 0 -86.01 14.18\n  .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. ..$ : chr [1:2] \"(Intercept)\" \"x\"\n  .. .. ..$ : chr [1:2] \"(Intercept)\" \"x\"\n  ..$ rank             : int 2\n  ..$ qr               :List of 5\n  .. ..$ qr   : num [1:40, 1:2] -2.641 0.158 0.158 0.158 0.159 ...\n  .. .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. .. ..$ : chr [1:40] \"1\" \"2\" \"3\" \"4\" ...\n  .. .. .. ..$ : chr [1:2] \"(Intercept)\" \"x\"\n  .. ..$ rank : int 2\n  .. ..$ qraux: num [1:2] 1.16 1.01\n  .. ..$ pivot: int [1:2] 1 2\n  .. ..$ tol  : num 1e-11\n  .. ..- attr(*, \"class\")= chr \"qr\"\n  ..$ family           :List of 12\n  .. ..$ family    : chr \"binomial\"\n  .. ..$ link      : chr \"logit\"\n  .. ..$ linkfun   :function (mu)  \n  .. ..$ linkinv   :function (eta)  \n  .. ..$ variance  :function (mu)  \n  .. ..$ dev.resids:function (y, mu, wt)  \n  .. ..$ aic       :function (y, n, mu, wt, dev)  \n  .. ..$ mu.eta    :function (eta)  \n  .. ..$ initialize:  expression({     if (NCOL(y) == 1) {         if (is.factor(y))              y &lt;- y != levels(y)[1L]         n &lt;- rep.int(1, nobs)         y[weights == 0] &lt;- 0         if (any(y &lt; 0 | y &gt; 1))              stop(\"y values must be 0 &lt;= y &lt;= 1\")         mustart &lt;- (weights * y + 0.5)/(weights + 1)         m &lt;- weights * y         if (any(abs(m - round(m)) &gt; 0.001))              warning(\"non-integer #successes in a binomial glm!\")     }     else if (NCOL(y) == 2) {         if (any(abs(y - round(y)) &gt; 0.001))              warning(\"non-integer counts in a binomial glm!\")         n &lt;- y[, 1] + y[, 2]         y &lt;- ifelse(n == 0, 0, y[, 1]/n)         weights &lt;- weights * n         mustart &lt;- (n * y + 0.5)/(n + 1)     }     else stop(\"for the binomial family, y must be a vector of 0 and 1's\\n\", \"or a 2 column matrix where col 1 is no. successes and col 2 is no. failures\") })\n  .. ..$ validmu   :function (mu)  \n  .. ..$ valideta  :function (eta)  \n  .. ..$ simulate  :function (object, nsim)  \n  .. ..- attr(*, \"class\")= chr \"family\"\n  ..$ linear.predictors: Named num [1:40] -1.25 -1.24 -1.24 -1.24 -1.22 ...\n  .. ..- attr(*, \"names\")= chr [1:40] \"1\" \"2\" \"3\" \"4\" ...\n  ..$ deviance         : num 42.7\n  ..$ aic              : num 46.7\n  ..$ null.deviance    : num 42.7\n  ..$ iter             : int 4\n  ..$ weights          : Named num [1:40] 0.173 0.174 0.174 0.174 0.176 ...\n  .. ..- attr(*, \"names\")= chr [1:40] \"1\" \"2\" \"3\" \"4\" ...\n  ..$ prior.weights    : Named num [1:40] 1 1 1 1 1 1 1 1 1 1 ...\n  .. ..- attr(*, \"names\")= chr [1:40] \"1\" \"2\" \"3\" \"4\" ...\n  ..$ df.residual      : int 38\n  ..$ df.null          : int 39\n  ..$ y                : Named num [1:40] 0 0 0 0 1 0 1 0 0 0 ...\n  .. ..- attr(*, \"names\")= chr [1:40] \"1\" \"2\" \"3\" \"4\" ...\n  ..$ converged        : logi TRUE\n  ..$ boundary         : logi FALSE\n  ..$ model            :'data.frame':   40 obs. of  2 variables:\n  .. ..$ ldata$DFREE: int [1:40] 0 0 0 0 1 0 1 0 0 0 ...\n  .. ..$ x          : int [1:40] 39 33 33 32 24 30 39 27 40 36 ...\n  .. ..- attr(*, \"terms\")=Classes 'terms', 'formula' length 3 ldata$DFREE ~ x\n  .. .. .. ..- attr(*, \"variables\")= language list(ldata$DFREE, x)\n  .. .. .. ..- attr(*, \"factors\")= int [1:2, 1] 0 1\n  .. .. .. .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. .. .. .. ..$ : chr [1:2] \"ldata$DFREE\" \"x\"\n  .. .. .. .. .. ..$ : chr \"x\"\n  .. .. .. ..- attr(*, \"term.labels\")= chr \"x\"\n  .. .. .. ..- attr(*, \"order\")= int 1\n  .. .. .. ..- attr(*, \"intercept\")= int 1\n  .. .. .. ..- attr(*, \"response\")= int 1\n  .. .. .. ..- attr(*, \".Environment\")=&lt;environment: 0x017a5674&gt; \n  .. .. .. ..- attr(*, \"predvars\")= language list(ldata$DFREE, x)\n  .. .. .. ..- attr(*, \"dataClasses\")= Named chr [1:2] \"numeric\" \"numeric\"\n  .. .. .. .. ..- attr(*, \"names\")= chr [1:2] \"ldata$DFREE\" \"x\"\n  ..$ call             : language glm(formula = ldata$DFREE ~ x, family = binomial)\n  ..$ formula          :Class 'formula' length 3 ldata$DFREE ~ x\n  .. .. ..- attr(*, \".Environment\")=&lt;environment: 0x017a5674&gt; \n  ..$ terms            :Classes 'terms', 'formula' length 3 ldata$DFREE ~ x\n  .. .. ..- attr(*, \"variables\")= language list(ldata$DFREE, x)\n  .. .. ..- attr(*, \"factors\")= int [1:2, 1] 0 1\n  .. .. .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. .. .. ..$ : chr [1:2] \"ldata$DFREE\" \"x\"\n  .. .. .. .. ..$ : chr \"x\"\n  .. .. ..- attr(*, \"term.labels\")= chr \"x\"\n  .. .. ..- attr(*, \"order\")= int 1\n  .. .. ..- attr(*, \"intercept\")= int 1\n  .. .. ..- attr(*, \"response\")= int 1\n  .. .. ..- attr(*, \".Environment\")=&lt;environment: 0x017a5674&gt; \n  .. .. ..- attr(*, \"predvars\")= language list(ldata$DFREE, x)\n  .. .. ..- attr(*, \"dataClasses\")= Named chr [1:2] \"numeric\" \"numeric\"\n  .. .. .. ..- attr(*, \"names\")= chr [1:2] \"ldata$DFREE\" \"x\"\n  ..$ data             :&lt;environment: 0x017a5674&gt; \n  ..$ offset           : NULL\n  ..$ control          :List of 3\n  .. ..$ epsilon: num 1e-08\n  .. ..$ maxit  : num 25\n  .. ..$ trace  : logi FALSE\n  ..$ method           : chr \"glm.fit\"\n  ..$ contrasts        : NULL\n  ..$ xlevels          : Named list()\n  ..- attr(*, \"class\")= chr [1:2] \"glm\" \"lm\"\n $ BECK   :List of 30\n</code></pre>\n\n<h3>Here is the data i have used for the example. I shortened it for the purporse of this question:</h3>\n\n<pre><code>&gt; ldata\n   ID AGE   BECK IVHX NDRUGTX RACE TREAT SITE DFREE\n1   1  39  9.000    3       1    0     1    0     0\n2   2  33 34.000    2       8    0     1    0     0\n3   3  33 10.000    3       3    0     1    0     0\n4   4  32 20.000    3       1    0     0    0     0\n5   5  24  5.000    1       5    1     1    0     1\n6   6  30 32.550    3       1    0     1    0     0\n7   7  39 19.000    3      34    0     1    0     1\n8   8  27 10.000    3       2    0     1    0     0\n9   9  40 29.000    3       3    0     1    0     0\n10 10  36 25.000    3       7    0     1    0     0\n11 11  38 18.900    3       8    0     1    0     0\n12 12  29 16.000    1       1    0     1    0     0\n13 13  32 36.000    3       2    1     1    0     1\n14 14  41 19.000    3       8    0     1    0     0\n15 15  31 18.000    3       1    0     1    0     0\n16 16  27 12.000    3       3    0     1    0     0\n17 17  28 34.000    3       6    0     1    0     0\n18 18  28 23.000    2       1    0     1    0     0\n19 19  36 26.000    1      15    1     1    0     1\n20 20  32 18.900    3       5    0     1    0     1\n21 21  33 15.000    1       1    0     0    0     1\n22 22  28 25.200    3       8    0     0    0     0\n23 23  29  6.632    2       0    0     0    0     0\n24 24  35  2.100    3       9    0     0    0     0\n25 25  45 26.000    3       6    0     0    0     0\n26 26  35 39.789    3       5    0     0    0     0\n27 27  24 20.000    1       3    0     0    0     0\n28 28  36 16.000    3       7    0     0    0     0\n29 29  39 22.000    3       9    0     0    0     1\n30 30  36  9.947    2      10    0     0    0     0\n31 31  37  9.450    3       1    0     0    0     0\n32 32  30 39.000    3       1    0     0    0     0\n33 33  44 41.000    3       5    0     0    0     0\n34 34  28 31.000    1       6    1     0    0     1\n35 35  25 20.000    1       3    1     0    0     0\n36 36  30  8.000    3       7    0     1    0     0\n37 37  24  9.000    1       1    0     0    0     0\n38 38  27 20.000    1       1    0     0    0     0\n39 39  30  8.000    1       2    1     0    0     1\n40 40  34  8.000    3       0    0     1    0     0\n</code></pre>\n"},{"tags":["r","regression"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":54,"score":-1,"question_id":13016011,"title":"R package to do modal regression","body":"<p>Are there any R packages to do modal linear regression? </p>\n\n<p>Modal linear regression is described for example <a href=\"http://math.usask.ca/~longhai/doc/modlin.pdf\" rel=\"nofollow\">here</a></p>\n\n<p>I've asked this question on stats.stackoverflow and it has been closed there.</p>\n\n<hr>\n\n<p>The question was closed by a mistake! The quote about <code>np</code> package in the introduction refers to the <strong>nonparametric</strong> modal linear regression. The whole article is about <strong>parametric</strong> modal linear regression. The <code>np</code> package can NOT estimate <strong>parametric</strong> modal linear regression. I have obtained matlab code from the author of the article. But I am still interested in the R code to implement <strong>parametric</strong> modal linear regression.</p>\n"},{"tags":["r","postgresql"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13045278,"title":"Minimum variability check in R or PostgreSQL","body":"<p>My Data-set contains temperature values. I want to preform minimum variability check. I would like to check if 3 successive temperature values do not changed with respect to a per-defined threshold (.05), then replacing them with mean value of last three observations.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13044747,"title":"how to insert many rows","body":"<p>I have this data:</p>\n\n<pre><code>hhid    perid actNo thisAct from   to tripTime  \n8019450     1     1    home  180 1051       NA  \n8019450     1     2  school 1075 1245       24  \n8019450     1     3  socrec 1255 1260       10  \n8019450     1     4    home 1280 1619       20\n</code></pre>\n\n<p>Now, I want to insert three rows in which </p>\n\n<pre><code>thisAct=travel\nfrom=(from-tripTime-1)\nto=(from-1)\n</code></pre>\n\n<p>Then, the expected data look like this:</p>\n\n<pre><code>hhid    perid actNo thisAct from   to tripTime  \n8019450     1     1    home  180 1051       NA  \n*8019450    1     2  travel 1052 1074         \n8019450     1     3  school 1075 1245       24  \n*8019450    1     4  travel 1246 1254         \n8019450     1     5  socrec 1255 1260       10  \n*8019450    1     6  travel 1261 1279         \n8019450     1     7    home 1280 1619       20  \n</code></pre>\n\n<p>Could you please how to insert those rows with asterisks?</p>\n\n<p>Thank you.</p>\n"},{"tags":["r","machine-learning","random-forest","feature-selection"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13044174,"title":"Number of trees for Random Forest optimization using recursive feature elimination","body":"<p>How many trees would you suggest to pick to perform recursive feature elimination (RFE) in order to optimize Random Forest classifier (for binary classification problem). My dataset is very high-dimensional (> 200 000 features), and I usually select ~ 10 000 trees while running a classification without feature selection. But I am just wondering whether it is enough to set it as ~ 500-1000 for RFE in order to save time and RAM.</p>\n\n<p>P.S.:\nI use <a href=\"http://cran.r-project.org/web/packages/randomForest/index.html\" rel=\"nofollow\">'randomForest'</a> and <a href=\"http://cran.r-project.org/web/packages/caret/index.html\" rel=\"nofollow\">'caret'</a> R-packages if it makes any difference.</p>\n"},{"tags":["r","function","loops","simplification"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":133,"score":2,"question_id":13042176,"title":"More efficient loops thru unique values in R","body":"<p>I am relatively new to R and all its wisdom and I am trying to be more efficient with my script. I am using a loop to simulate how an animal moves among different sites. The problem that I have is that when I increase the number of sites or change the initial parameters (based on fixed probability of moving or staying in the same site) then I end with a very complicated loop. If I have to run several different simulations with different parameters, I prefer a more efficient loop or function that could adjust to different situations. The first loop will fill a matrix according to the initial probabilities and the second loop will compared the cumulative probability matrix against a random number from a list of values (10 in this example) and will decide the fate of that individual (either stay or go to a new site)</p>\n\n<p>Here is a simplification of my code:</p>\n\n<pre><code>N&lt;-4 # number of sites\nsites&lt;-LETTERS[seq(from=1,to=N)]\n\np.stay&lt;-0.45\np.move&lt;-0.4\n\nmove&lt;-matrix(c(0),nrow=N,ncol=N,dimnames=list(c(sites),c(sites)))\nfrom&lt;-array(0,c(N,N),dimnames=list(c(sites),c(sites)))\nto&lt;-array(0,c(N,N),dimnames=list(c(sites),c(sites)))\n</code></pre>\n\n<p># Filling matrix with fixed probability #</p>\n\n<pre><code>for(from in 1:N){\n  for(to in 1:N){\n     if(from==to){move[from,to]&lt;-p.stay} else {move[from,to]&lt;-p.move/(N-1)}\n     }\n }\n\nmove\ncumsum.move&lt;-cumsum(data.frame(move))\n\nsteps&lt;-100\nresult&lt;-as.character(\"\") # for storing results\nrand&lt;-sample(random,steps,replace=TRUE) \ntime.step&lt;-data.frame(rand)\ncolnames(time.step)&lt;-c(\"time.step\")\ntime.step$event&lt;-\"\"\nto.r&lt;-(rbind(sites))\nj&lt;-sample(1:N,1,replace=T) # first column to select (random number)\nk&lt;-sample(1:N,1,replace=T) # site selected after leaving and coming back\n</code></pre>\n\n<p># Beginning of the longer loop #</p>\n\n<pre><code>for(i in 1:steps){\n   if (time.step$time.step[i]&lt;cumsum.move[1,j]){time.step$event[i]&lt;-to.r[1]} else \n     if (time.step$time.step[i]&lt;cumsum.move[2,j]){time.step$event[i]&lt;-to.r[2]} else\n        if (time.step$time.step[i]&lt;cumsum.move[3,j]){time.step$event[i]&lt;-to.r[3]} else\n           if (time.step$time.step[i]&lt;cumsum.move[4,j]){time.step$event[i]&lt;-to.r[4]} else\n              if (time.step$time.step[i]&lt;(0.95)){time.step$event[i]&lt;-NA} else\n                 if (time.step$time.step[i]&lt;1.0) break # break the loop             \n\n result[i]&lt;-time.step$event[i]\n j&lt;-which(to.r==result[i])\n if(length(j)==0){j&lt;-k} # for individuals the leave and come back later\n\n }\n\n time.step\n\n result\n</code></pre>\n\n<p>This loop is part of a bigger loop that will simulate and store the result after a series of simulations. Any ideas or comments on how I can improve the efficiency of this loop so that I can easily modify the number of sites or change the initial probability parameters without repeating or having to do major edits of the loop will be appreciated.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13033835,"title":"How can I plot svm graph in R by using these data?","body":"<p>I used package <code>kernlab</code> and installed a function called <code>ksvm</code>. I built a ksvm model using data with 12x33 matrix. The first column of the matrix is the class (ie. 0 and 1). Other columns are numbers that used for classification. </p>\n\n<p>How can I plot the graph of this svm model? I would like to plot a graph including support vectors and the margins.</p>\n"},{"tags":["r","parallel-processing","random-forest","feature-selection"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":12801108,"title":"Parallelize rfcv() function for feature selection in randomForest package","body":"<p>I wonder if anyone knows how to parallelize <strong>rfcv()</strong> function implemented in R-package <a href=\"http://cran.r-project.org/web/packages/randomForest/index.html\" rel=\"nofollow\">'randomForest'</a>. Sorry if the question sounds very basic, but I tried to do this using <a href=\"http://cran.r-project.org/web/packages/foreach/index.html\" rel=\"nofollow\">'foreach'</a> without any results.</p>\n"},{"tags":["r","ssh","remote-server"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":65,"score":3,"question_id":13038603,"title":"working on a remote R session","body":"<p>The R session that I am working on is on a remote cluster due to memory contraints and the data is stored remotely.  I am therefore using notepad++ to edit my files and just paste them into my SSH session as I go along.  What is the best way to integrate with the remote session to take advantage of code completion and other things available in editors like RStudio.  Any best practice suggestions about working on remote connections?  I imagine this must be the case for most R users who work with large data sets.</p>\n"},{"tags":["r","distribution","sample","sampling","mean"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":77,"score":2,"question_id":13033914,"title":"Sampling distribution of the sample mean","body":"<p>I have a simple question, although I cant find an answer anywhere. \nI have the following dataset:</p>\n\n<pre><code>data.set &lt;- c(7,7,8,8,7,8,9)\n</code></pre>\n\n<p>The question from the Basic Stats book is: \nWhat is the sampling distribution of the sample mean for samples of size 2?\nIs there a possibility to calculate this in R commander (or using command line). </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4065,"score":0,"question_id":2500431,"title":"R error message about variable lengths","body":"<p>I ran the following code in order to recode the variable. Unfortunately, when I move to run an logit model (using the Zelig package), I get an error message that the variable length differ for this variable.</p>\n\n<pre><code>## Independent Variable - Partisanship (ANES 2004)\ndata04$V043114\npart &lt;- data04$V043114\nattributes(part)\nsummary(part)\n\npartb &lt; part\npartb[part %in% levels(part)[4]] &lt;- NA\npartb[part %in% levels(part)[5]] &lt;- NA\npartb[part %in% levels(part)[6]] &lt;- NA\npartb[part %in% levels(part)[7]] &lt;- NA\npartb &lt;- factor(partb)\n\nattributes(partb)\nsummary(partb)\ntable(partb)\ntable(part, partb)\ncbind(part, partb)\n\npartisan041 &lt;- partb\npartisan042 &lt;- as.numeric(partb)\n\nsummary(partisan041)\nsummary(partisan042)\n\n\n  ## Regression Model - ANES 2004 ##\n    anes04one &lt;- zelig(trade041a ~ age042 + education042 + personal042 + economy042 + partisan042 + employment042 + union042 + home042 + market042 + race042 + income042 + gender042, model=\"logit\", data=data04)\n    summary(anes04one)\n\n    #Error in model.frame.default(formula = trade041a ~ age042 + education042 +  :\n    #  variable lengths differ (found for 'partisan042')\n</code></pre>\n"},{"tags":["linux","r","centos"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13043888,"title":"Memory usage in Linux R","body":"<p>I am loading a 6 GB dataset in R running over Centos Linux 6.3, 128 GB RAM, 16 Core machine.\nSimultaneously I am monitoring the RAM usage with top command. After about 104 minutes, in the  output of the top command, the VIRT column shows 189 GB. </p>\n\n<p>Now, I am not able to understand how the VIRT column shows more than 128GB (which is the limit). Is there some kind of shared memory that is being used?</p>\n"}]}
{"total":19203,"page":10,"pagesize":100,"questions":[{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":43,"score":3,"question_id":13043146,"title":"How to make q('yes') the default quitting behavior in R using .Rprofile?","body":"<p>I'd like to be able to type <code>q()</code> in R and have R quit rather than be prompted as to whether I want to quit.</p>\n\n<p><strong>Is there some code that I could put into my <code>.Rprofile</code> file to make this happen?</strong></p>\n\n<p>I'd prefer if I didn't have to have a custom function floating around in my workspace. </p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13043030,"title":"increment leading zero in R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8266915/format-number-as-fixed-width-with-leading-zeros\">Format number as fixed width, with leading zeros</a><br>\n  <a href=\"http://stackoverflow.com/questions/12379767/sprintf-use-without-gsub\">sprintf use without gsub</a>  </p>\n</blockquote>\n\n\n\n<p>This has probably been done before but I couldn't find a thread for R.</p>\n\n<p>How would I increment leading zeroes in R?</p>\n\n<p>For example have a <strong>vector</strong> called x with elements: 0001, 0002, 0003....9999</p>\n"},{"tags":["r","f#","statistical-analysis"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":13043314,"title":"F# feature parity with R","body":"<p>How does F# compare to R language in terms of feature parity? Are there some areas where F# does not compare well with R in terms of statistical computing? Any experiences with both?</p>\n"},{"tags":["r","list"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":68,"score":3,"question_id":13040543,"title":"Elements within lists.","body":"<p>I'm relatively new in R (~3 months), and so I'm just getting the hang of all the different data types. While lists are a super useful way of holding dissimilar data all in one place, they are also extremely inflexible for function calls, and riddle me with angst.</p>\n\n<p>For the work I'm doing, I often uses lists because I need to hold a bunch of vectors of different lengths. For example, I'm tracking performance statistics of about 10,000 different vehicles, and there are certain vehicles which are so similar they can essentially be treated as the same vehicles for certain analyses. </p>\n\n<p>So let's say we have this list of vehicle ID's:</p>\n\n<pre><code>List &lt;- list(a=1, b=c(2,3,4), c=5)\n</code></pre>\n\n<p>For simplicity's sake. </p>\n\n<p>I want to do two things:</p>\n\n<ol>\n<li><p>Tell me which element of a list a particular vehicle is in. So when I tell R I'm working with vehicle <code>2</code>, it should tell me <code>b</code> or <code>[2]</code>. I feel like it should be something simple like how you can do</p>\n\n<pre><code>match(3,b)\n&gt; 2\n</code></pre></li>\n<li><p>Convert it into a data frame or something similar so that it can be saved as a CSV. Unused rows could be blank or <code>NA</code>. What I've had to do so far is:</p>\n\n<pre><code>for(i in length(List)) {\nlength(List[[i]]) &lt;- max(as.numeric(as.matrix(summary(List)[,1])))\n}\nDF &lt;- as.data.frame(List)\n</code></pre></li>\n</ol>\n\n<p>Which seems dumb.</p>\n"},{"tags":["r","hierarchical-clustering"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13042728,"title":"R hclust( dist ), which dist method I should use if I want to cluster some equations?","body":"<p>R hclust uses a method called \"dist\" to show the distance between different elements, dist is a method to get the distance, and then be used in the hclust to do the clustering. But in the dist, there are several method to use, what are the different usage of them. Which one should I use if I want to cluster some equations(cubic equation, quadratic equation and linear equation) into different clusters. And in each cluster, those equation has linear correlation and coefficients to each other. Thank you.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":56,"score":-6,"question_id":13040364,"title":"R dist, there are several method to use, what are the usage. Which one should I use","body":"<p>R dist, dist is a method to get the distance, and then used in the hclust to do the clustering. But in the dist, there are several method to use, what are the usage of them. Which one should I use if I want to cluster some equations(cubic equation, quadratic equation and linear equation) into different clusters. And in each cluster, those equation has linear correlation and coefficients to each other.\nThank you.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13042441,"title":"How do I calculate NRMSE using \"missForest\" package?","body":"<p>How do I calculate NRMSE by the following?</p>\n\n<pre><code>pro.imp &lt;- missForest(pr.mis, xtrue = prdat, verbose=TRUE)\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>  missForest iteration 1 in progress...\nError in `rownames&lt;-`(`*tmp*`, value = row.names(x)) : \n  attempt to set rownames on object with no dimensions\nIn addition: Warning message:\nIn randomForest.default(x = obsX, y = obsY, ntree = ntree, mtry = mtry,  :\n  invalid mtry: reset to within valid range\n</code></pre>\n\n<p>Also, how do I import my own data sets into R's default location of data sets?</p>\n"},{"tags":["r","na"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":76,"score":3,"question_id":13022234,"title":"Avoiding NAs in as.numeric()","body":"<p>If I did this, I get correct result:</p>\n\n<pre><code>a &lt;- c(\"10\",\"28\",\"3\")\nwhich(as.numeric(a) == min(as.numeric(a)))\n[1] 3\n</code></pre>\n\n<p>But if there is NAs in the vector, then there is a problem</p>\n\n<pre><code>a &lt;- c(\"10\",\"28\",\"3\",\"NA\")\nwhich(as.numeric(a) == min(as.numeric(a)))\ninteger(0)\nWarning messages:\n1: In which(as.numeric(a) == min(as.numeric(a))) :\n  NAs introduced by coercion\n2: In which(as.numeric(a) == min(as.numeric(a))) :\n  NAs introduced by coercion\n</code></pre>\n"},{"tags":["r","file","line"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":49,"score":3,"question_id":13041641,"title":"reading a specific line of a text file in R","body":"<p>I have a file in txt format separated by tabs. \nThe question that I have is that if its possible to jump to an specific line, but without using a for loop, for example if I want to jump to the second line I have done this:</p>\n\n<pre><code>  fileName=\"table.txt\"\n  con=file(fileName,open=\"r\")\n  for (i in 1:2){\n      ctable&lt;-readLines(con,n=1)\n  }\n</code></pre>\n\n<p>but I dont want to use a for loop, how I can do that?\nThanks</p>\n"},{"tags":["r","statistics"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":13040856,"title":"Is it possible to define a function as an argument of another function in R?","body":"<p>for example:</p>\n\n<pre><code>method1 &lt;- function(alpha,beta,ff)\n</code></pre>\n\n<p>Does R allow this ???</p>\n\n<p>What I am try to achieve is that: I have a general method, <code>method1</code>. And I have other methods: <code>f2,f3,f4</code>. I want it to be like <code>method1 &lt;- function(a,b, ff)</code>, where <code>a</code> &amp; <code>b</code> are constants and most importantly, <code>ff</code> can be either <code>f2</code> or <code>f3</code> or <code>f4</code>, depending on how i call the function on the console. Ideally <code>f2, f3, f4</code> computes a matrix. </p>\n\n<p>Using the example in your answer below, I was wondering why cant I have this instead??</p>\n\n<pre><code>f1 &lt;- function(a,b,ff(a,b))\n{\n    solve(ff(a,b))\n}\nf2 &lt;- function (x,y){\n    Diag(x*y)\n}\n</code></pre>\n\n<p>This is a really bad example. But I would like to know why cant I include the ff(a,b) in the argument ??? What is the logic of writing ?</p>\n\n<p>f1 &lt;- function(a,b,ff){\nff(a,b)\n}</p>\n"},{"tags":["r","input","console"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13041207,"title":"How to read user input in the console window?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3454969/command-line-questions-in-r\">Command line Questions in R</a>  </p>\n</blockquote>\n\n\n\n<p>Say, if I enter a string into the console, how can I get R to recognise that it is a string (or whatever type of data I entered) and store it into <code>x</code>?</p>\n\n<p>Because what I want to do is: if the user inputs 'hungry', then R should recognise this string 'hungry' and run a particular function. Is that possible? </p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13039886,"title":"Split lines and create new dataframe","body":"<p>I have a file, file.txt, with data that looks like as follows,</p>\n\n<pre><code>&lt;z:row ows_Req_Name1='John' ows_ReqPriority='High' ows_ReqDate='2012-10-10' /&gt;\n&lt;z:row ows_Req_Name1='Jack' ows_ReqPriority='Low' ows_ReqDate='2012-11-10' /&gt;\n&lt;z:row ows_Req_Name1='John' ows_ReqDate='2012-12-10' /&gt;\n</code></pre>\n\n<p>Not all lines contain all the required information. For eg., the last line above does not have  an entry for ReqPriority like the other lines. I split the data into a dataframe using,</p>\n\n<pre><code>data.frame(do.call(rbind,strsplit(readLines('file.txt'),'ows_',fixed=T)))\n</code></pre>\n\n<p>but due to the missing entries in some of the lines the dataframe does not come out properly.</p>\n\n<p>Any suggestions on how I can export this into a df and fill in the missing values with NA.</p>\n\n<pre><code>Req_Name1   ReqPriority    ReqDate\nJohn        High           2012-10-10\nJack        Low            2012-11-10\nJohn        NA             2012-10-10\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13040854,"title":"Calculating occurrences in R","body":"<p>I want to calculate the number of occurrences of a character in a string,</p>\n\n<p>I've tried</p>\n\n<pre><code>length(grep(\"3\", \"987654332\")[[1]])\n</code></pre>\n\n<p><code>[1] 1</code></p>\n\n<p>It doesn't calculate the second occurrence of \"3\".</p>\n\n<p>I also tried</p>\n\n<pre><code>length(gregexpr(\"0\", \"98765432\")[[1]])\n</code></pre>\n\n<p><code>[1] 1</code></p>\n\n<p>This calculate the multiple occurrences fine, but returns 1 for non occurring values.</p>\n\n<p>Thank you!</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":54,"score":-3,"question_id":13040199,"title":"how can i calculate mean by groups without outliers?","body":"<p>I have data of two groups, for example</p>\n\n<pre><code>&gt; data.frame(group=rep(1:2,each=4),value=c(102,104,107,45,204,199,217,77))\n\n  group value\n1     1   102\n2     1   104\n3     1   107\n4     1    45\n5     2   204\n6     2   199\n7     2   217\n8     2    77\n</code></pre>\n\n<p>and i´d like to obtain the mean of both groups without outliers (mean of group 1 for values > 50 and mean of group 2 for values > 100) </p>\n"},{"tags":["r","function","text","character","quotes"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13040120,"title":"How to take in text/character argument without quotes","body":"<p>Sorry if the question is unclear. Feel free to change it.</p>\n\n<p>So basically I am trying to find a way so that text/character string arguments for a function don't require quotes.</p>\n\n<pre><code>foo  = function(x, y, data){\n    n1 = length(data[,x])\n    n2 = length(data[,y])\n    cat(n1, n1)\n }\n</code></pre>\n\n<p>If I use the following code</p>\n\n<pre><code>data(survey)\nfoo(Sex, Fold, survey)\n</code></pre>\n\n<p>I will get an error message. But if I use the following:</p>\n\n<pre><code>foo(\"Sex\", \"Fold\", survey)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>foo(1, 5, survey)\n</code></pre>\n\n<p>the function will give me what I want. So I wonder if there is any way to construct the function such that I won't need to use quotes around the column names. Thanks!</p>\n"},{"tags":["r","call","expression","eval"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":38,"score":3,"question_id":13040206,"title":"How can I use list/vector elements as objects arguments to a function in R?","body":"<p>I programmatically evaluated several models, whose names are in a vector <code>models</code>. How can I then use the function <code>mtable</code> with them, calling them programmatically?</p>\n\n<p>Here is an example :</p>\n\n<pre><code>library(memisc)\na &lt;- rnorm(100,0,1)\nb &lt;- rnorm(100,0,1)\nc &lt;- rnorm(100,0,1)\nd &lt;- rnorm(100,0,1)\nmod1 &lt;- lm(a ~ b)\nmod2 &lt;- lm(c ~ d)\nmodels &lt;- c(\"mod1\", \"mod2\")\nmtable(mget(models,envir=globalenv()))\n</code></pre>\n\n<p>I then get an error: <code>\"no method available for 'getSummary' for an object of class 'list'\"</code>.</p>\n\n<p>What can I do? I tried <code>call</code> and <code>do.call</code> but without success.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13039766,"title":"R making a matrix of logical matrices","body":"<p>I've been trying to make a 1 row matrix that has logical matrices in each of the columns, but haven't been having very much luck.  I tried a for loop:</p>\n\n<pre><code>mat&lt;-matrix(NULL,nrow=1,ncol=60)\nfor(i in 1:60){mat&lt;-list(mat,matrix(FALSE,nrow=4,ncol=4))}\n</code></pre>\n\n<p>That produced a 4x4 matrix with weird sized submatrices.</p>\n\n<pre><code>mat&lt;-matrix(NULL,n=row=1,ncol=60)\nfor(i in 1:60){mat[i]&lt;-matrix(FALSE,nrow=4,ncol=4)}\n</code></pre>\n\n<p>That produced a NULLxNULL matrix with 60 FALSEs.</p>\n"},{"tags":["html","r"],"answer_count":1,"favorite_count":2,"up_vote_count":14,"down_vote_count":0,"view_count":151,"score":14,"question_id":13018570,"title":"Convert character to html in R","body":"<p>What's the prefered way in R to convert a character (vector) containing non-ASCII characters to html? I would for example like to convert</p>\n\n<pre><code>  \"ü\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code>  \"&amp;uuml;\"\n</code></pre>\n\n<p>I am aware that this is possible by a clever use of <code>gsub</code> (but has anyone doen it once and for all?) and I thought that the package R2HTML would do that, but it doesn't.</p>\n\n<p>EDIT: Here is what I ended up using; it can obviously be extended by modifying the dictionary:</p>\n\n<pre><code>char2html &lt;- function(x){\n  dictionary &lt;- data.frame(\n    symbol = c(\"ä\",\"ö\",\"ü\",\"Ä\", \"Ö\", \"Ü\", \"ß\"),\n    html = c(\"&amp;auml;\",\"&amp;ouml;\", \"&amp;uuml;\",\"&amp;Auml;\",\n             \"&amp;Ouml;\", \"&amp;Uuml;\",\"&amp;szlig;\"))\n  for(i in 1:dim(dictionary)[1]){\n    x &lt;- gsub(dictionary$symbol[i],dictionary$html[i],x)\n  }\n  x\n}\n\nx &lt;- c(\"Buschwindröschen\", \"Weißdorn\")\nchar2html(x)\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13038294,"title":"about generating an image for a random matrix with large dimensions","body":"<p>I have a matrix, whose entries can be -1, 0, or 1. I am trying to use the color to differentiate these different values, since most of them are 0. I use the following code</p>\n\n<pre><code> x&lt;-y&lt;-seq(1:10)\n xcolor&lt;-c(\"purple3\", \"green\" , \"red\")\n image(x,y,DiffMatrix,col=xcolor)\n</code></pre>\n\n<p>For illustration purposes, the DiffMatrix is a 10*10 matrix, </p>\n\n<blockquote>\n  <p>[1,] 1   0  0   0        0     1     1      -1        0      0</p>\n  \n  <p>[2,] 1   0  0   0       -1     1     1       1        0      0</p>\n  \n  <p>[3,] 1   0  0   0        0     1     0       0        0      0</p>\n  \n  <p>[4,] 1   0  0   0        0     1     0       0        0      0</p>\n  \n  <p>[5,] 1   0  0   0        0     0     0       0        0      0</p>\n  \n  <p>[6,] 1   0  0   0       -1     1     0       1        0      0</p>\n  \n  <p>[7,] 1   0  0   0        0     0     0       0        0      0</p>\n  \n  <p>[8,] 1   0  1   0        0     1     0       0        0      0</p>\n  \n  <p>[9,] 1   0  0   0        0     0     0       0        0      0</p>\n  \n  <p>[10,] 0   0  0   0        0     0     0       0        0      0</p>\n</blockquote>\n\n<p>The generated image is this</p>\n\n<p><img src=\"http://i.stack.imgur.com/o77By.jpg\" alt=\"enter image description here\"></p>\n\n<p>My question is, if the matrix becomes very big, like 2000*3000. The resolution of the generated figure using the above approach will be very low. Are there any graphical approaches for showing the distributions of these different values: I want to see how many “1” are occurred in the matrix, and which positions are associated with “1”; which positions are associated with “0”,etc.</p>\n"},{"tags":["r","data.table"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":74,"score":2,"question_id":13035609,"title":"How to do efficient vectorized update on multiple columns using data.tables?","body":"<p>I have the following code using data.frames, and I'm wondering how to write this using data.tables, using the most efficient, most vectorized code?</p>\n\n<p>data.frame code:</p>\n\n<pre><code>set.seed(1)\nto &lt;- cbind(data.frame(time=seq(1:5),bananas=sample(100,5),apples=sample(100,5)),setNames(data.frame(matrix(sample(100,90,replace=T),nrow=5)),paste0(1:18)))\nfrom &lt;- cbind(data.frame(time=seq(1:5),blah=sample(100,5),foo=sample(100,5)),setNames(data.frame(matrix(sample(100,90,replace=T),nrow=5)),paste0(1:18)))\nfrom\nto\n\nrownames(to) &lt;- to$time\nto[as.character(from$time),paste0(1:18)] &lt;- from[,paste0(1:18)]\nto\n</code></pre>\n\n<p>Running this:</p>\n\n<pre><code>&gt;     set.seed(1)\n&gt;     to &lt;- cbind(data.frame(time=seq(1:5),bananas=sample(100,5),apples=sample(100,5)),setNames(data.frame(matrix(sample(100,90,replace=T),nrow=5)),paste0(1:18)))\n&gt;     from &lt;- cbind(data.frame(time=seq(1:5),blah=sample(100,5),foo=sample(100,5)),setNames(data.frame(matrix(sample(100,90,replace=T),nrow=5)),paste0(1:18)))\n&gt;     from\n  time blah foo  1  2   3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18\n1    1   66  22 98  2 100 46 58 60 69 46 62 19 29 42 64 90 30 19 72 60\n2    2   35  13 74 72  50 52  8 57 61 18 56 53 90  7 85 65 20 76 39 12\n3    3   27  47 36 11  49 21  4 53 24 75 33  8 45 34 86 75 89 73 11 85\n4    4   97  90 44 45  18 23 65 99 26 11 46 28 78 73 40 61 51 95 93 32\n5    5   61  58 15 65  76 60 93 51 73 87 51 22 89 34 39 91 88 55 29 79\n&gt;     to\n  time bananas apples  1   2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18\n1    1      27     90 21  50 94 39 49 67 83 79 48 10 92 26 34 90 44 21 24 80\n2    2      37     94 18  72 22  2 60 80 65  3 87 32 30 48 84 87 72 72  6 46\n3    3      57     65 69 100 66 39 50 11 79 48 44 52 46 77 35 39 40 13 65 42\n4    4      89     62 39  39 13 87 19 73 56 74 25 67 34  9 34 78 33 25 88 82\n5    5      20      6 77  78 27 35 83 42 53 70  8 41 66 88 48 97 76 15 78 61\n&gt; \n&gt;     rownames(to) &lt;- to$time\n&gt;     to[as.character(from$time),paste0(1:18)] &lt;- from[,paste0(1:18)]\n&gt;     to\n  time bananas apples  1  2   3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18\n1    1      27     90 98  2 100 46 58 60 69 46 62 19 29 42 64 90 30 19 72 60\n2    2      37     94 74 72  50 52  8 57 61 18 56 53 90  7 85 65 20 76 39 12\n3    3      57     65 36 11  49 21  4 53 24 75 33  8 45 34 86 75 89 73 11 85\n4    4      89     62 44 45  18 23 65 99 26 11 46 28 78 73 40 61 51 95 93 32\n5    5      20      6 15 65  76 60 93 51 73 87 51 22 89 34 39 91 88 55 29 79\n</code></pre>\n\n<p>Basically, we update columns <code>paste0(1:18)</code> of <code>to</code> from columns <code>paste0(1:18)</code> of <code>from</code>, matching up the <code>time</code>s.</p>\n\n<p><code>data.table</code>s apparently have some advantages, such as not needing head when printing them at the console, so I'm thinking about using them.</p>\n\n<p>However I'd like not to have to write the <code>:=</code> expressions by hand, ie try to avoid:</p>\n\n<pre><code>to[from,`1`:=i.`1`,`2`:=i.`2`, ..]\n</code></pre>\n\n<p>I'd also prefer to use vectorized syntax if possible, rather than some kind of for loop, ie try to avoid something like:</p>\n\n<pre><code>for( i in 1:18 ) {\n    to[from, sprintf(\"%d\",i) := i.sprintf(\"%d\",i)]\n}\n</code></pre>\n\n<p>I read through the faq vignette, and the datatable-intro vignette, though I admit I probably haven't understood everything 100%.</p>\n\n<p>I looked at <a href=\"http://stackoverflow.com/questions/8374816/loop-through-columns-in-a-data-table-and-transform-those-columns\">Loop through columns in a data.table and transform those columns</a> , but I can't say I understand it 100%, and it seems to say that I need to use a for loop?</p>\n\n<p>There does seem to be some kind of a hint at the bottom of 8374816 that it might be possible to just use data frame syntax, adding <code>with=FALSE</code>?  But since the data.frame procedure is hacking on the row names, I'm not sure how well / if that will work, and I wonder to what extent that makes use of the efficiencies of data.table?</p>\n"},{"tags":["r","matlab","computer-vision"],"answer_count":4,"favorite_count":2,"up_vote_count":11,"down_vote_count":0,"view_count":302,"score":11,"question_id":13033614,"title":"How to draw a crystal ball with two-color particles inside","body":"<p>I am just throwing an idea with possibility of closing. I need to draw a crystal ball in which red and blue particles randomly locate. I guess I have to go with photoshop, and even tried to make the ball in an image but as this is for research paper and does not have to be fancy, I wonder if there is any way to program with R, matlab, or any other language.</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13037449,"title":"frequencies counting","body":"<p>I have a situation like this:<br>\ndf</p>\n\n<pre><code>List      Count \nR472        1   \nR472        1   \nR472        2 \nR472        2       \nR845        1   \nR845        2   \nR845        2\n....       ...\n</code></pre>\n\n<p>I would like the following output:</p>\n\n<p>df</p>\n\n<pre><code>List           freq_of_number1   freq_of_number2 \nR472                  2                 2   \nR845                  1                 2\n....\n</code></pre>\n\n<p>Any idea about?\nThnks.</p>\n"},{"tags":["r","curl","rcurl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13039175,"title":"Curl command works in OS X, authentication error using RCurl","body":"<p>Having a hard time debugging this one as I'm not super familiar with RCurl, though I have used it successfully in the past when passing a username:password combination.\nCan anyone suggest better ways of debugging RCurl problems like this, or even better, a solution?</p>\n\n<p>Command using Curl on OS X (works and returns desired results in XML format):</p>\n\n<pre><code>curl -H 'Content-Type: application/xml' -H 'Accept: application/xml' -u email@test.com:password https://test.testapp.com/clients\n</code></pre>\n\n<p>Command using RCurl (does not work, returns \"You must be authenticated to complete this request.\")</p>\n\n<pre><code>getURL(\"https://test.testapp.com/clients\", .opts=list(userpwd=\"email@test.com:password\"), ssl.verifypeer=FALSE, curl=curl, httpheader=c(Accept='application/xml', 'Content-Type' = 'application/xml'), verbose=TRUE )\n</code></pre>\n\n<p>Verbose output:</p>\n\n<pre><code>* Connection #0 seems to be dead!\n* Closing connection #0\n* About to connect() to test.testapp.com port 443 (#0)\n*   Trying 72.251.221.123... * connected\n* Connected to test.testapp.com (72.251.221.123) port 443 (#0)\n* SSL re-using session ID\n* SSL connection using DHE-RSA-AES256-SHA\n* old SSL session ID is stale, removing\n* Server certificate:\n*    subject: serialNumber=4-F4BJmWN-U-hWTfQnuIdTEN-QBf4jr4; C=US; O=*.testapp.com; OU=GT71452989; OU=See www.rapidssl.com/resources/cps (c)10; OU=Domain Control Validated - RapidSSL(R); CN=*.testapp.com\n*    start date: 2010-01-10 19:29:14 GMT\n*    expire date: 2013-03-12 22:44:52 GMT\n*    common name: *.testapp.com (matched)\n*    issuer: C=US; O=Equifax; OU=Equifax Secure Certificate Authority\n*    SSL certificate verify result: unable to get local issuer certificate (20), continuing anyway.\nGET /clients HTTP/1.1\nHost: test.testapp.com\nAccept: application/xml\nContent-Type: application/xml\n* HTTP/1.1 401 Unauthorized\n* Server: nginx\n* Date: Tue, 23 Oct 2012 20:38:36 GMT\n* Content-Type: text/html; charset=utf-8\n* Transfer-Encoding: chunked\n* Connection: keep-alive\n* Status: 401\n&lt; X-Powered-By: Phusion Passenger (mod_rails/mod_rack)\n&lt; Cache-Control: no-cache\n&lt; X-Frame-Options: SAMEORIGIN\n&lt; X-Served-From: http://test.testapp.com/clients\n&lt; X-UA-Compatible: IE=Edge,chrome=1\n&lt; Set-Cookie: _test_sess=BAh7BkkiD3Nlc3Npb25faWQGOgZFRiIlMGExYzYyNzk3MjljZWExZjY3NzgxMjg2MDBkYjlkZmU%3D--fdd7cd8d4aff553ca04c3d492ff85c79cb5cb7de; domain=.testapp.com; path=/; HttpOnly\n&lt; X-Runtime: 0.007637\n&lt; \n* Connection #0 to host test.testapp.com left intact\n\n[1] \"You must be authenticated with TestApp to complete this request.\"\n</code></pre>\n"},{"tags":["r","large-data","pca"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":12630807,"title":"what could be the best tool or package to perform PCA on very large datasets ?","body":"<p>This might seem like a similar question which was asked in this URL (http://stackoverflow.com/questions/10718455/apply-pca-on-very-large-sparse-matrix).</p>\n\n<p>But I am still not able to get my answer for which i need some help. I am trying to perform a PCA for a very large dataset of about 700 samples (columns) and > 4,00,000 locus (rows). I wish to plot ¨samples¨ in the biplot and hence want to consider all of the 4,00,000 locus to calculate the principal components. </p>\n\n<p>I did try using <code>princomp()</code>, but I get the following error which says, </p>\n\n<pre><code>Error in princomp.default(transposed.data, cor = TRUE) : \n'`princomp`' can only be used with more units than variables\n</code></pre>\n\n<p>I checked with the forums and i saw that in the cases where there are less units than variables, it is better to use <code>prcomp()</code> than <code>princomp()</code>, so i tried that as well, but i again get the following error,</p>\n\n<pre><code>Error in cor(transposed.data) : allocMatrix: too many elements specified\n</code></pre>\n\n<p>So I want to know if any of you could suggest me any other good option which could be best suited for my very large data. I am a beginner for statistics, but i did read about how PCA works. I want to know if there are any other easy-to-use R packages or tools to perform this?</p>\n"},{"tags":["git","r","github","rstudio"],"answer_count":1,"favorite_count":3,"up_vote_count":13,"down_vote_count":0,"view_count":589,"score":13,"question_id":8511176,"title":"Pushing to Github from RStudio","body":"<p>What's your git workflow look like when you're working with RStudio?</p>\n\n<p>I want to start using github for source control of my scripts.  I know you can use the command line/terminal to push a repository, but have been unable to find a package for git.  Any suggestion for one?</p>\n\n<p>Alternatively, I could use the <code>system</code> command: <code>system(\"git push\")</code></p>\n\n<p>Can anyone suggest a better/more elegant way to do this?  </p>\n"},{"tags":["r","duplicates","data.frame","duplicate-removal","rbind"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":13038401,"title":"rbind data frames, duplicated rownames issue","body":"<p>While duplicated row (and column) names are allowed in a <code>matrix</code>, they are not allowed in a <code>data.frame</code>. Trying to <code>rbind()</code> some data frames having row names in common highlights this problem. Consider two data frames below:</p>\n\n<pre><code>foo = data.frame(a=1:3, b=5:7)\nrownames(foo)=c(\"w\",\"x\",\"y\")\nbar = data.frame(a=c(2,4), b=c(6,8))\nrownames(bar)=c(\"x\",\"z\")\n# foo               bar\n#   a b               a b\n# w 1 5             x 2 6\n# x 2 6             y 4 8\n# y 3 7\n</code></pre>\n\n<p>Now trying to <code>rbind()</code> them (Pay attention to the row names):</p>\n\n<pre><code>rbind(foo, bar)\n#    a b\n# w  1 5\n# x  2 6\n# y  3 7\n# x1 2 6\n# z  4 8\n</code></pre>\n\n<p>But for the case of <code>matrix</code>:</p>\n\n<pre><code>rbind(as.matrix(foo), as.matrix(bar))\n#   a b\n# w 1 5\n# x 2 6\n# y 3 7\n# x 2 6\n# z 4 8\n</code></pre>\n\n<p>Here is the problem: How to <code>rbind()</code> two data frames, having duplicated rows (with the same row name) removed? </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13037034,"title":"Counting number of conditions that have been run","body":"<p>I have some data from an experiment where each subject was run with one of 18 different lists. I need to find out how many times each list was run.</p>\n\n<p>The data.frame is structured as follows:</p>\n\n<pre><code>Subject1    List1    Trial1 stuff  \nSubject1    List1    Trial2 stuff  \nSubject2    List2    Trial1 stuff  \n...\nSubject22   List1    Trial1 stuff\nSubject22   List1    Trial2 stuff\n</code></pre>\n\n<p>Though List1 shows up lots isn the data.set, I only want to count it if it's with a new subject. If, for instance, the above is all the subjects that were run in List1, I would have run List1 twice. </p>\n\n<p>I've already written something that gets what I want, but it uses loops. I was wondering if there is some better way to go about this. Thanks.</p>\n\n<p>Edit: Here is (basically) the code that I already used:</p>\n\n<pre><code>Lists &lt;= matrix(nrow=22,ncol=2)  \nfor (i in seq(1,22)) { \n    Lists[i,1] &lt;= i  \n    Lists[i,2] &lt;= unique(data$List[which(data$subject==i)])  \n    }\n</code></pre>\n"},{"tags":["r","matlab","machine-learning","pca"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":7,"view_count":73,"score":-7,"question_id":13038174,"title":"Is there anyway to compute 2D PCA in R/Matlab?","body":"<p>I have thousands of image patterns with different dimensions. Is there any R-package to compute the 2D eigen patterns for them?</p>\n"},{"tags":["performance","algorithm","r","index","sets"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13037560,"title":"What is an efficient way to convert sets to a column index in R?","body":"<p><strong>Overview</strong></p>\n\n<p>Give a large (nrows > 5,000,000+) data frame, <strong>A</strong>, with string row names and a list of disjoint sets (n = 20,000+), <strong>B</strong>, where each set consists of row names from <strong>A</strong>, what is the best way to create a vector representing the sets in <strong>B</strong> via a unique value?</p>\n\n<p><strong>Illustration</strong></p>\n\n<p>Below is an example illustrating this problem:</p>\n\n<pre><code># Input\nA &lt;- data.frame(d = rep(\"A\", 5e6), row.names = as.character(sample(1:5e6)))\nB &lt;- list(c(\"4655297\", \"3177816\", \"3328423\"), c(\"2911946\", \"2829484\"), ...) # Size 20,000+\n</code></pre>\n\n<p>The desired result would be:</p>\n\n<pre><code># An index of NA represents that the row is not part of any set in B.\n&gt; A[,\"index\", drop = F]\n        d index\n4655297 A     1\n3328423 A     1\n2911946 A     2\n2829484 A     2\n3871770 A    NA\n2702914 A    NA\n2581677 A    NA\n4106410 A    NA\n3755846 A    NA\n3177816 A     1\n</code></pre>\n\n<p><strong>Naive Attempt</strong></p>\n\n<p>Something like this can be achieved using the following method.</p>\n\n<pre><code>n &lt;- 0\nA$index &lt;- NA\nlapply(B, function(x){\n  n &lt;&lt;- n + 1\n  A[x, \"index\"] &lt;&lt;- n\n})\n</code></pre>\n\n<p><strong>Problem</strong></p>\n\n<p>However this is unreasonably slow (several hours) due to indexing A multiple times and is not very R-esque or elegant.</p>\n\n<p>How can the desired result be generated in a quick and efficient manner?</p>\n"},{"tags":["r","statistics"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":69,"score":3,"question_id":13036649,"title":"How do I concatenate String and an output evaluated from a function in R?","body":"<p>Basically, I have the following say:</p>\n\n<pre><code>counter &lt;- 3\nk &lt;- 9999\n</code></pre>\n\n<p>I would like to get R to print the following:</p>\n\n<pre><code>on the 3rd count: 9999 \n</code></pre>\n\n<p>Does anyone what command should I use to do this? Please spell it out for me ,as I am completely new to R. </p>\n"},{"tags":["r","lag"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13037389,"title":"Lagging Forward in plm","body":"<p>This is a very simple question, but I haven't been able to find a definitive answer, so I thought I would ask it.  I use the <code>plm</code> package for dealing with panel data.  I am attempting to use the <code>lag</code> function to lag a variable FORWARD in time (the default is to retrieve the value from the previous period, and I want the value from the NEXT).  I found a number of old articles/questions (circa 2009) suggesting that this is possible by using <code>k=-1</code> as an argument.  However, when I attempt this, I get an error.</p>\n\n<p>Sample code:</p>\n\n<pre><code>library(plm)\ndf&lt;-as.data.frame(matrix(c(1,1,1,2,2,3,20101231,20111231,20121231,20111231,20121231,20121231,50,60,70,120,130,210),nrow=6,ncol=3))\nnames(df)&lt;-c(\"individual\",\"date\",\"data\")\ndf$date&lt;-as.Date(as.character(df$date),format=\"%Y%m%d\")\ndf.plm&lt;-pdata.frame(df,index=c(\"individual\",\"date\"))\n</code></pre>\n\n<p>Lagging:</p>\n\n<pre><code>lag(df.plm$data,0)\n##returns\n1-2010-12-31 1-2011-12-31 1-2012-12-31 2-2011-12-31 2-2012-12-31 3-2012-12-31 \n         50           60           70          120          130          210\n\nlag(df.plm$data,1)\n##returns\n1-2010-12-31 1-2011-12-31 1-2012-12-31 2-2011-12-31 2-2012-12-31 3-2012-12-31 \n         NA           50           60           NA          120           NA\n\nlag(df.plm$data,-1)\n##returns\nError in rep(1, ak) : invalid 'times' argument\n</code></pre>\n\n<p>I've also read that <code>plm.data</code> has replaced <code>pdata.frame</code> for some applications in <code>plm</code>.  However, <code>plm.data</code> doesn't seem to work with the <code>lag</code> function at all:</p>\n\n<pre><code>df.plm&lt;-plm.data(df,indexes=c(\"individual\",\"date\"))\nlag(df.plm$data,1)\n##returns\n[1]  50  60  70 120 130 210\nattr(,\"tsp\")\n[1] 0 5 1\n</code></pre>\n\n<p>I would appreciate any help.  If anyone has another suggestion for a package to use for lagging, I'm all ears.  However, I do love <code>plm</code> because it automagically deals with lagging across multiple individuals and skips gaps in the time series.</p>\n"},{"tags":["r","hash","data.frame","vectorization","cumulative-frequency"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":49,"score":5,"question_id":13037111,"title":"efficiently replacing data frame with cumulative frequency","body":"<p>I'm trying to write a program that takes a large data frame and replaces each column of values by the cumulative frequency of those values (sorted ascending). For instance, if the column of values are: 5, 8, 3, 5, 4, 3, 8, 5, 5, 1. Then the relative and cumulative frequencies are:</p>\n\n<ul>\n<li>1: rel_freq=0.1, cum_freq = 0.1</li>\n<li>3: rel_freq=0.2, cum_freq = 0.3</li>\n<li>4: rel_freq=0.1, cum_freq = 0.4</li>\n<li>5: rel_freq=0.4, cum_freq = 0.8</li>\n<li>8: rel_freq=0.2, cum_freq = 1.0</li>\n</ul>\n\n<p>Then the original column becomes: 0.8, 1.0, 0.3, 0.8, 0.4, 0.3, 1.0, 0.8, 0.8, 0.1</p>\n\n<p>The following code performs this operation correctly, but it scales poorly probably due to the nested loop. Any idea how to perform this task more efficiently?</p>\n\n<pre><code>mydata = read.table(.....)\n\ntotalcols = ncol(mydata)\ntotalrows = nrow(mydata)\n\nfor (i in 1:totalcols) {\n    freqtable = data.frame(table(mydata[,i])/totalrows)  # create freq table\n    freqtable$CumSum = cumsum(freqtable$Freq)   # calc cumulative freq\n\n    hashtable = new.env(hash=TRUE)\n    nrows = nrow(freqtable)\n\n    # store cum freq in hash\n    for (x in 1:nrows) {\n        dummy = toString(freqtable$Var1[x])\n        hashtable[[dummy]] = freqtable$CumSum[x]\n    }\n\n    # replace original data with cum freq\n    for (j in 1:totalrows) {\n        dummy = toString(mydata[j,i])\n        mydata[j,i] = hashtable[[dummy]]\n    }\n}\n</code></pre>\n"},{"tags":["r","matrix","replication"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13034861,"title":"Efficiently replicate matrices in R","body":"<p>I have a matrix and look for an efficient way to replicate it n times (where n is the number of observations in the dataset). For example, if I have a matrix A</p>\n\n<p><code>A &lt;- matrix(1:15, nrow=3)</code></p>\n\n<p>then I want an output of the form</p>\n\n<p><code>rbind(A, A, A, ...)   #n times</code>.</p>\n\n<p>Obviously, there are many ways to construct such a large matrix, for example using a <code>for</code> loop or <code>apply</code> or similar functions. However, the call to the \"matrix-replication-function\" takes place in the very core of my optimization algorithm where it is called tens of thousands of times during one run of my program. Therefore, loops, apply-type of functions and anything similar to that are not efficient enough. (Such a solution would basically mean that a loop over n is performed tens of thousands of times, which is obviously inefficient.) I already tried to use the ordinary <code>rep</code> function, but haven't found a way to arrange the output of <code>rep</code> in a matrix of the desired format. </p>\n\n<p>The solution \n<code>do.call(\"rbind\", replicate(n, A, simplify=F))</code>\nis also too inefficient because <code>rbind</code> is used too often in this case. (Then, about 30% of the total runtime of my program are spent performing the rbinds.)</p>\n\n<p>Does anyone know a better solution?</p>\n"},{"tags":["r","ontology","bioconductor"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13037409,"title":"How to get Gene ontology (GO) terms per probe","body":"<p>I am new to R/BioC. I am trying to do GO-based clustering of genes. The input needs to be gene name and GO terms in each row. \nExample:</p>\n\n<pre><code>AP4B1 GO:0005215 GO:0005488 GO:0005515 GO:0005625 GO:0005802 GO:0005905\nBCAS2 GO:0005515 GO:0005634 GO:0005681 GO:0008380 GO:0031202\n</code></pre>\n\n<p>I tried using annotate in bioconductor:</p>\n\n<pre><code>library(\"rat2302.db\") \nlibrary(annotate)\ntestid&lt;-c(\"1367462_at\",\"1380262_at\", \"1392516_a_at\", \"1396521_at\")\ngoid1 &lt;- rat2302GO[testid]\n</code></pre>\n\n<p>But I get only each GO term in seperate row:</p>\n\n<pre><code>toTable(goid1)\n\nprobe_id      go_id Evidence Ontology\n1  1367462_at GO:0008152      IEA       BP\n2  1367462_at GO:0008152      ISO       BP\n3  1367462_at GO:0006508      IMP       BP\n4  1367462_at GO:0005886      IEA       CC\n5  1367462_at GO:0005737      IEA       CC\n6  1380262_at GO:0005575       ND       CC\n7  1380262_at GO:0005634      IEA       CC\n8  1380262_at GO:0005737      IEA       CC\n9  1367462_at GO:0005509      IEA       MF\n10 1367462_at GO:0005509      TAS       MF\n11 1367462_at GO:0004198      IDA       MF\n12 1367462_at GO:0004198      IEA       MF\n13 1367462_at GO:0004198      ISO       MF\n14 1367462_at GO:0046982      IPI       MF\n15 1380262_at GO:0000166      IEA       MF\n</code></pre>\n\n<p>Maybe there is an easier way to get all GO terms per gene. Unfortunately, I could not find it. </p>\n\n<p>Any help is greatly appreciated.</p>\n\n<p>Thanks\nR</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13036557,"title":"Read space (Tab) separated text files into a matrix (vector)","body":"<p>I need to post process some FORTRAN output files in R. For example, I need to read 20 lines from the output files and ignore spaces. Then convert them to vectors or matrices. I am wondering is there a better way to ignore the spaces and keep the values? Thanks! \nHere is my Out.txt file (all I need is the last four columns):</p>\n\n<pre><code> CNC HORIZON     COMPARTMENT      TOTAL      ADSORBED   DISSOLVED  GAS CONC.\n CNC                              (MG/KG)    (MG/KG)    (MG/L)     (MG/L)\n CNC --------------------------------------------------------------------------\n CNC\n CNC\n CNC   1            1             0.4062     0.3737      1.210     0.2419E-05\n CNC   1            2             0.4942     0.4547      1.472     0.2943E-05\n CNC   1            3             0.4930     0.4536      1.468     0.2936E-05\n CNC   1            4             0.4812     0.4427      1.433     0.2865E-05\n CNC   1            5             0.4682     0.4307      1.394     0.2788E-05\n CNC   1            6             0.4550     0.4186      1.355     0.2710E-05\n CNC   1            7             0.4418     0.4065      1.315     0.2631E-05\n CNC   1            8             0.4286     0.3944      1.276     0.2552E-05\n CNC   1            9             0.4154     0.3822      1.237     0.2474E-05\n CNC   1           10             0.4022     0.3701      1.198     0.2395E-05\n</code></pre>\n\n<p>Below is my approach:</p>\n\n<pre><code>TOT={}\nfile_out &lt;- file(paste(pth,'/Out.txt', sep=\"\"))\nb=readLines(file_out)\ndd=as.numeric(ldply(strsplit(b[88334],\"   \"))) # I have to adjust the amount of spaces in\n                                               # order to separate numbers out\nTOT[1]=dd[10]                                  # It is not always 10\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13036606,"title":"Double strsplit","body":"<p>I have a situation like this:<br>\ndf</p>\n\n<pre><code>List           Count \nR472_21:345     1   \nR47_2:90        1   \nR844_21:98      2   \nR845_54:123     2   \nR975_12:1       2   \n</code></pre>\n\n<p>I would like to split the elements of the column \"List\" in the following way:</p>\n\n<pre><code>R472 21 345      \nR47  2  90      \n..........  \n</code></pre>\n\n<p>I tried this code to split according to <code>:</code> but I'm not able to split according <code>_</code> at the same time.</p>\n\n<pre><code>test &lt;- unlist(strsplit(as.character(df$List), \"\\\\:\"))\n</code></pre>\n\n<p>Any suggestion about?</p>\n"},{"tags":["r","list","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13036571,"title":"Access specific line of every matrix in list","body":"<p>This might be very trivial, but I haven't found an answer yet (and I'm quite new to R).</p>\n\n<p>I have a list containing a bunch of matrices. Each matrix in the list has the same number of rows and rownames. </p>\n\n<p>How to I access say, the second row of each matrix in the list?</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13034833,"title":"Align two plots in R (plot + image.plot)","body":"<p>I have a figure composed of two plots, a line plot and an image plot. <a href=\"http://ubuntuone.com/7YYXEzDs9tkIsh9UoD5XNW\" rel=\"nofollow\">Here</a> is an example </p>\n\n<p>My problem is that the image (bottom) is not aligned with the x axis in the top plot. Given that the image is a projection of the line, i would like to align them. </p>\n\n<p>Any ideas?</p>\n\n<p>EDIT: I am using basic stuff, here is the simplified code,</p>\n\n<pre><code>layout(matrix(seq(1,2), ncol = 1, byrow=T)) #,heights=c(0.5,0.25,0.25))\npar(mar=c(5, 5, 3, 3), cex=mycex)\n\nplot.default(X,Y,type=typ,pch=pc,col=\"black\",axes=F,xlab=\"\",ylab=\"\",main=\"\",xlim=c(0,P),ylim=c(0,max(Y)))\n#other lines and polygons of top plot\naxis(1); axis(2); title(xlab=xtitle,ylab=\"mean Y\",main=\"\")\nimage.plot(t(as.matrix(Y1)), col=jet.colors, axes=F, main=\"\")\n</code></pre>\n"},{"tags":["r","format"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13026572,"title":"How to preserve NAs when using format in R?","body":"<p>I have a matrix with some <code>NA</code> that I'd like to format and then write to a CSV file, replacing each <code>NA</code> with two dashes. However, all of the <code>NA</code> get converted to characters by <code>format</code>, and <code>write.csv</code> then fails to detect and replace them. </p>\n\n<p>After reading through the help file for <code>format</code>, setting  <code>na.encode=FALSE</code> seemed like the logical thing to do, but that didn't fix the problem. I've also searched with Google and on this site for other people having this problem, but couldn't find any. This seems like it should have a simple answer, and has me beating my head against the wall.</p>\n\n<p>A minimal example of my code looks like this:</p>\n\n<pre><code>data = matrix(c(pi, NA, pi*100, NA), 2, 2)\ndata.f = format(data, digits=4, nsmall=2)\nwrite.csv(data.f, file=\"data.csv\", na=\"--\")\n</code></pre>\n\n<p>I'm using R 2.15.1. What is the correct way to do this?</p>\n\n<p><em>Edit: Can anyone explain why this even requires a workaround?</em></p>\n"},{"tags":["r","gui","x11","cran"],"answer_count":3,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":362,"score":6,"question_id":7430452,"title":"Disable/suppress tcltk prompt in R","body":"<p>My question is similar to a question previously posted but never really answered here:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/3339630/disable-gui-graphics-devices-in-r\">Disable GUI, graphics devices in R</a></p>\n\n<p>I do not like the R tcltk popups for CRAN mirror selection. They also pop up to choose a package when searching for help on a function in two packages.</p>\n\n<p>Is there any way to disable these windows without disabling X11 completely? I still want plot() commands to work as normal, but disable the little select menus that take forever to load over a remote connection.</p>\n\n<p>For example, if you use ssh, but don't use -X, then the mirror select is just text within R, you type a number. It's fast. This is what I want, but maintaining X11 for plots b.</p>\n\n<p>Anyone know how to maintain graphics windows but disable the \"choice\" tcltk windows?</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":13035834,"title":"Plot every column in a data frame as a histogram on one page using ggplot","body":"<p>I would like to plot each column of a data.frame using a histogram on one page.  Here is an example using the sample \"diamonds\" data set which comes with R:</p>\n\n<pre><code>p = list()\nfor (i in 1:ncol(diamonds)) p[[i]] &lt;- qplot(diamonds[,i], xlab=names(diamonds)[[i]])\ndo.call(grid.arrange, p)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/VJLp7.png\" alt=\"enter image description here\"></p>\n\n<p>This does plot all the columns, but the data looks the same in each one.  So, something is clearly wrong.</p>\n\n<p>Is this the right approach for this task?  I'm sure I have some silly syntax somewhere that is assigning the same column data set to each element in the list, but I'm not sure what it is.</p>\n\n<p>Thank you</p>\n"},{"tags":["r","plot"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13032777,"title":"Scatter plot with error bars","body":"<p>How can I generate the following plot in R? Points, shown in the plot are the averages, and their ranges correspond to minimal and maximal values.\nI have data in two files (below is an example). </p>\n\n<pre><code>x   y\n1   0.8773\n1   0.8722\n1   0.8816\n1   0.8834\n1   0.8759\n1   0.8890\n1   0.8727\n2   0.9047\n2   0.9062\n2   0.8998\n2   0.9044\n2   0.8960\n..  ...\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/SMqIx.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":13035295,"title":"Overlay bar graphs in ggplot2","body":"<p>I'm trying to overlay bar graphs in <code>ggplot2</code></p>\n\n<p>My current code produces a bar plot but they are stacked on top of each other. I dont want this, I would like them overlaid so I can see the differences in each bar height.</p>\n\n<p>Code:</p>\n\n<pre><code>library(ggplot2)\nlibrary(reshape)\n\n\nx = c(\"Band 1\", \"Band 2\", \"Band 3\")\ny1 = c(\"1\",\"2\",\"3\")\ny2 = c(\"2\",\"3\",\"4\")\n\nto_plot &lt;- data.frame(x=x,y1=y1,y2=y2)\nmelted&lt;-melt(to_plot, id=\"x\")\n\nprint(ggplot(melted,aes(x=x,y=value,fill=variable)) + geom_bar(stat=\"identity\", alpha=.3))\n</code></pre>\n\n<p>Stacked output:</p>\n\n<p><img src=\"http://i.stack.imgur.com/dXVTA.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","statistics"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":13021456,"title":"using ns() for spline prediction","body":"<p>I am trying to reproduce the upper left plot of Figure 5.4(page 147) of \"Elements of Statistical Learning\" of Hastie et al (2008).</p>\n\n<p>It is easy enough to do it this way:</p>\n\n<pre><code>library(splines)\nlibrary(gam)\nsa=read.table(\"http://www-stat.stanford.edu/~tibs/ElemStatLearn/datasets/SAheart.data\",\n    sep=\",\",head=T,row.names=1)\nmdl=glm(chd~ns(sbp,4)+ns(tobacco,4)+ns(ldl,4)+famhist+ns(obesity,4)+ns(age,4),data=sa,family=binomial())\nplot.gam(mdl,terms=\"ns(sbp, 4)\")\n</code></pre>\n\n<p>which gives the desired plot.</p>\n\n<p>However, if I try to apply my crude understanding of the approach directly:</p>\n\n<pre><code>xvar=seq(min(sa$sbp),max(sa$sbp),length.out=200)\nbasis=ns(xvar,4)\nsbpnames=c(\"ns(sbp, 4)1\",  \"ns(sbp, 4)2\",  \"ns(sbp, 4)3\",  \"ns(sbp, 4)4\")\nplot(xvar,basis%*%mdl$coef[sbpnames],type=\"l\")\n</code></pre>\n\n<p>the plot is not the same.  Would anyone know why this is?  All feedback much appreciated. </p>\n"},{"tags":["r","plot","convenience-methods"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13027189,"title":"Convenient wrapper for plots, lines, and points","body":"<p>One of the things that most bugs me about R is the separation of the plot, points, and lines commands. It's somewhat irritating to have to change plot to whatever variant for the first plot done, and to have to replot from scratch if you failed to have set the correct the ylim and xlim initially. Wouldn't it be nice to have one command that:</p>\n\n<ol>\n<li><p>Picks lines, points or both via an argument, as in <code>plot(..., type = \"l\")</code> ?</p></li>\n<li><p>By default, chooses whether to create a new plot, or add to an existing one according to whether the current device is empty or not.</p></li>\n<li><p>Rescales axes automatically if the added elements to the plot exceed the current bounds.</p></li>\n</ol>\n\n<p>Has anyone done anything like this? If not, and there's no strong reason why this isn't possible, I'll answer this myself in a bit...</p>\n"},{"tags":["r","lattice"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13033389,"title":"Add superscript to lattice graph labels R","body":"<p>I need to add superscript to my R lattice graph labels, specifically with \"m^2\".   </p>\n\n<pre><code>equivalence.xyplot(mydata$IsoCanopyArea ~ mydata$ControlCanopyArea,\n                   alpha=0.05, b0.ii=0.25, b1.ii=0.25,\n                   xlab= \"ISODATA (m^2)\",\n                   ylab= \"Measured (m^2)\") \n</code></pre>\n\n<p>This function uses lattice graphics, so the typical commands do not seem to work:</p>\n\n<pre><code>plot(0, ylab = ~ \"AddTextHere\" (m^2))\n</code></pre>\n\n<p>I have looked at several examples on this site with no success: <a href=\"http://stackoverflow.com/a/10628662/1446289\">example1</a> and <a href=\"http://stackoverflow.com/a/9507009/1446289\">example2</a> (<em>Note</em> I am a different Aaron than the OP in example2)</p>\n\n<p>How can accomplish superscripts in lattice graph labels?</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":81,"score":4,"question_id":13033284,"title":"repeat ggplot using different data without typing out the whole code","body":"<p>Is a way to re-plot something but using a subsetted dataset without writing the entire code out again?</p>\n\n<p>maybe something like last_plot() but allow one to specific the data.frame to use?</p>\n"},{"tags":["sql","r","passwords","rstudio-server"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":51,"score":3,"question_id":13033573,"title":"How to handle DB passwords in R connection strings?","body":"<p>Though I don't know what the SO quorum would be, the question itself is simple:\nHow do y'all handle passwords in db connection string when you connect to a database from R?</p>\n\n<p>Tutorials often show an example like this. </p>\n\n<pre><code>con &lt;- dbConnect(MySQL(), user=\"root\", password=\"test\", \n             dbname=\"research_db\", host=\"localhost\",\n             client.flag=CLIENT_MULTI_STATEMENTS)\n</code></pre>\n\n<p>If the database is indeed your experimental localhost, this might be somewhat realistic. However if you use it with multiple users on a server you might not want to expose the db credentials like this. Particularly when combining RStudio Server with a SQL database you might want to do something encrypted. What is your experience?</p>\n"},{"tags":["r","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":73,"score":-3,"question_id":13020394,"title":"How to change labels in bwplot","body":"<p>Can I change the labels Soprano 1, Alto 1 etc. in the second row independently from the first row of the following plot</p>\n\n<pre><code> require(lattice)\n singer2&lt;-rbind(cbind(singer,frame=1),cbind(singer,frame=2))\n singer2&lt;-rbind(cbind(singer2,var=1),cbind(singer2,var=2))\n bwplot(voice.part ~ height|factor(frame)+factor(var), data = singer2,\n     xlab = \"Height (inches)\",\n     panel = function(...) {\n        panel.grid(v = -1, h = 0)\n        panel.bwplot(...)\n     },\n     par.settings = list(plot.symbol = list(pch = 4)))\n</code></pre>\n\n<p>If I would change the levels and labels of factor voice.part, it effects both rows in the plot. Still there any problem with the data record singer. I think it is reproducible.</p>\n"},{"tags":["sql","r","select"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":66,"score":1,"question_id":13029370,"title":"Error in using variables in SQL statements","body":"<p>Im extracting some data from a table using sql select statment in R, </p>\n\n<pre><code>query &lt;- \"select * from MyTable where TimeCol='6/29/2012 21:05' \";\nresult &lt;- fn$sqldf(query);\n</code></pre>\n\n<p>The above code gives correct results, but when the time value is saved in variable, it doesn't works </p>\n\n<pre><code>mytime &lt;- \"6/29/2012 21:05\";\n\nquery &lt;- \"select * from MyTable where TimeCol = $mytime\";     # OR\n\nquery &lt;- \"select * from MyTable where TimeCol = $[mytime]\";   # OR\n\nquery &lt;- \"select * from MyTable where TimeCol = '$[mytime]' \";\n\nresult &lt;- fn$sqldf(query);\n</code></pre>\n\n<p>None of the above three lines is working</p>\n\n<p><code>View(result)</code>   it gives the error:  invalid 'x' argument</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13029587,"title":"Setting the title of the R console","body":"<p>One quick question to which I could not find answer. </p>\n\n<p>I want to know if it is possible to set the title of the R console to something else (using RGui, on Windows).</p>\n\n<p>The main use I'm thinking of is to show some kind of progress information when running a script which takes a long time to complete.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["r","command-line"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13033068,"title":"Error when running R file from command line","body":"<p>I have an R file which imports a file, does some data manipulation, and performs a logistic regression model, and then saves those results to a txt file. However, when I run the file from the command line, I get the following error message and don't know what's going on.</p>\n\n<pre><code>anonymous@anonymous-Latitude-E6520:~/Downloads$ R --no-save &lt; Auto_Model.r &gt; out.txt\nWarning message:\nNAs introduced by coercion \nError in if (x == \"\\\\N\") NA else if (x &gt; 1 &amp; x &lt; 6999) \"1:6999\" else if (x &gt;  : \n  missing value where TRUE/FALSE needed\nCalls: bin.value -&gt; do.call -&gt; mapply -&gt; .Call -&gt; &lt;Anonymous&gt;\nExecution halted\nanonymous@anonymous-Latitude-E6520:~/Downloads$ R --no-save &lt; Auto_Model.r\n</code></pre>\n\n<p>The R script which results in the error is below = </p>\n\n<pre><code>&gt; ## IMPORT DATA:\n&gt; #setwd(\"~/Desktop\")\n&gt; library(foreign)\n&gt; dat = read.csv(\"dat.csv\", stringsAsFactors=FALSE)\n&gt; \n&gt; ## zipcode = \n&gt; dat$zipcode = as.character(dat$zipcode)\n&gt; \n&gt; bin.value = Vectorize(function(x) {\n+   if (x == \"\\\\N\") NA\n+   else if (x &gt; 1 &amp; x &lt; 6999) \"1:6999\"\n+   else if (x &gt; 7000 &amp; x &lt; 9999) \"7000:9999\"\n+   else if (x &gt; 10000 &amp; x &lt; 14849) \"10000:14849\"\n+   else if (x &gt; 14850 &amp; x &lt; 19699) \"14850:19699\"\n+   else if (x &gt; 19700 &amp; x &lt; 29999) \"19700:29999\"\n+   else if (x &gt; 30000 &amp; x &lt; 31999) \"30000:31999\"\n+   else if (x &gt; 32000 &amp; x &lt; 34999) \"32000:34999\"\n+   else if (x &gt; 35000 &amp; x &lt; 42999) \"35000:42999\"\n+   else if (x &gt; 43000 &amp; x &lt; 49999) \"43000:49999\"\n+   else if (x &gt; 50000 &amp; x &lt; 59999) \"50000:59999\"\n+   else if (x &gt; 60000 &amp; x &lt; 69999) \"60000:69999\"\n+   else if (x &gt; 70000 &amp; x &lt; 79999) \"70000:79999\"\n+   else if (x &gt; 80000 &amp; x &lt; 89999) \"80000:89999\"\n+   else if (x &gt; 90000 &amp; x &lt; 96999) \"90000:96999\"\n+   else if (x &gt; 97000 &amp; x &lt; 99820) \"97000:99820\"\n+   else NA \n+ })\n&gt; \n&gt; dat$zipcode2 = as.character(bin.value(as.integer(dat$zipcode)))\nError in if (x == \"\\\\N\") NA else if (x &gt; 1 &amp; x &lt; 6999) \"1:6999\" else if (x &gt;  : \n  missing value where TRUE/FALSE needed\nCalls: bin.value -&gt; do.call -&gt; mapply -&gt; .Call -&gt; &lt;Anonymous&gt;\nExecution halted\n</code></pre>\n\n<p>I assume some is wrong in how I am trying to manipulate the mode of the zipcode variable but nothing I've tried seems to fix the issue.</p>\n\n<pre><code>&gt; str(dat$zipcode)\n int [1:12635] 76148 33825 61832 11368 98290 92078 44104 62052 55106 20861 ...\n&gt; \n</code></pre>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13033584,"title":"Identifying Comparisons in Output of SVM Using e1071 libSVM interface","body":"<p>I have a trained SVM using 87 support vectors, 171 features and 14 classes.  </p>\n\n<p>If the trained model is <code>svm</code>, then <code>svm$coefs</code> is <code>87 x 13</code>, not <code>87 x 14</code>.  </p>\n\n<p>Why is this?  And is there a way I can get the weight vector from each class' comparison (i.e. <code>w1</code> for the comparison between class 1 and each of the other classes)?</p>\n\n<p>To be clear, I am not looking for the equation that actually calculates the weight vector.  That can be found <a href=\"http://stackoverflow.com/questions/7390173/svm-equations-from-e1071-r-package\">here</a>, in which my question is raised but not answered.</p>\n\n<p>Thank you!</p>\n"},{"tags":["python","r","pandas","data.table"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":70,"score":3,"question_id":13031803,"title":"Create a column which increments based on another column in Python","body":"<p>I've currently switched my focus from R to Python. I work with data.table in R a lot, and I find it sometimes quite difficult to find an equivalent for some functions in Python.  </p>\n\n<p>I have a pandas data frame that looks like this:</p>\n\n<blockquote>\n  <p>df = pd.DataFrame({'A':['abc','def', 'def', 'abc', 'def', 'def','abc'],'B':[13123,45,1231,463,142131,4839, 4341]})  </p>\n  \n  <blockquote>\n<pre><code>     A       B  \n0  abc   13123    \n1  def      45  \n2  def    1231  \n3  abc     463  \n4  def  142131  \n5  def    4839\n6  abc    4341\n</code></pre>\n  </blockquote>\n</blockquote>\n\n<p>I need to create a column that increments from 1 based on A and B, so that it indicates the increasing order of B. So I first create the sorted data frame, and the column I'm interested in creating is C as below:</p>\n\n<blockquote>\n<pre><code>    A       B   C\n1  abc     463  1\n6  abc    4341  2\n0  abc   13123  3\n3  def      45  1\n2  def    1231  2\n5  def    4839  3\n4  def  142131  4\n</code></pre>\n</blockquote>\n\n<p>In R, using the library(data.table), this can be easily done in one line and creates a column within the original data table:</p>\n\n<blockquote>\n  <p>df[, C := 1:.N, by=A]</p>\n</blockquote>\n\n<p>I've looked around and I think I might be able to make use of something like this:</p>\n\n<blockquote>\n  <p>df.groupby('A').size()<br>\n  or<br>\n  df['B'].argsort()</p>\n</blockquote>\n\n<p>but not sure how to proceed from here, and how to join the new column back to the original data frame. It would be very helpful if anyone could give me any pointer.  </p>\n\n<p>Many thanks!</p>\n"},{"tags":["sql","r","oracle11g","regression"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13033127,"title":"Mapping keystrokes on a keyboard using R","body":"<p>I want to create a log of all key strokes on my laptop for a day. I am using R and have an oracle database installed. Could someone suggest a way forward?</p>\n"},{"tags":["r","unique","data.frame"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":2,"view_count":89,"score":2,"question_id":13017511,"title":"Find unique combinations based on two columns and calculate the mean","body":"<p>I have a problem in R, which I can't seem to solve.</p>\n\n<p>I have the following dataframe:</p>\n\n<p><a href=\"https://docs.google.com/open?id=0B_v_3frEDiceRkppWHhaOUM4LTA\" rel=\"nofollow\">Image 1</a></p>\n\n<p>I would like to:</p>\n\n<ol>\n<li>Find the unique combinations of the columns 'Species' and 'Effects'</li>\n<li>Report the concentration belonging to this unique combination</li>\n<li>If this unique combination is present more than one time, calculate the <strong>mean</strong> concentration </li>\n</ol>\n\n<p>And would like to get the following dataframe:</p>\n\n<p><a href=\"https://docs.google.com/open?id=0B_v_3frEDiced3dpZ1p0ZG1JWWs\" rel=\"nofollow\">Image 2</a></p>\n\n<p>I have tried next script to get the unique combinations:</p>\n\n<p>UniqueCombinations &lt;- Data[!duplicated(Data[,1:2]),]</p>\n\n<p>but don't know how to proceed from there.</p>\n\n<p>Thanks in advance for your answers!</p>\n\n<p>Tina</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13032978,"title":"R parallel CPU affinity on Windows","body":"<p><strong>R</strong> 2.14.0 or higher includes <a href=\"http://stat.ethz.ch/R-manual/R-devel/library/parallel/doc/parallel.pdf\" rel=\"nofollow\">R package <strong>parallel</strong></a> which provides support for parallel computation.</p>\n\n<p>Under <strong>Unix-likes</strong>, this package provides a <a href=\"http://stat.ethz.ch/R-manual/R-devel/library/parallel/html/mcaffinity.html\" rel=\"nofollow\">facility for setting CPU affinity of child processes</a>.</p>\n\n<p>Is there a means of setting CPU affinity of child processes when using the <strong>R</strong> package <strong>parallel</strong> on <strong>Windows</strong>?</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":13031432,"title":"Sex Ratio at birth simulation in R","body":"<p><strong>My problem:</strong></p>\n\n<p>If the sex ratio at birth (male to female) is 1.1, but people adopt the following\nstrategy: have children until you have one son, and then stop, unless you have 12\ndaughters (in which case you stop, too). What would be the average sex ratio in the\npopulation? (Calculate by simulation. Suppose you randomly select 10,000 families.)</p>\n\n<p><strong>My code</strong></p>\n\n<pre><code>  pm=0.5238095 # Probability of Male\n  pw=0.4761905 #                Female\n  w=0          # initial number of Female\n  n=1          # loop\n  p=0          # count of number \n  for(i in 1:n){\n  s=rbinom(1,1,0.4761905)\n  if(s==1){\n  w=w+1\n  }\n   p=p+1\n while(w&lt;=12){ ####1. How to count the number of female? ###\n while(s==1){\n s=rbinom(1,1,0.4761905)\n if(s==1){\n  w=w+1\n }\n  p=p+1\n }\n }\n  f[i]=p\n }\n w/p\n</code></pre>\n\n<p><strong>My question</strong></p>\n\n<ol>\n<li><p>How to count the number of female? I'm using loop to count the number of women$(if(s==1){\n  w=w+1\n }). $It seems inefficient.I think MAYBE counting true or false is more efficient.</p></li>\n<li><p>How to write the code more concise?</p></li>\n</ol>\n"},{"tags":["r","count","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13032014,"title":"R count values larger than zero in data frame columns","body":"<p>I have the data frame: </p>\n\n<pre><code>mat=data.frame(A=c(12,10,0,14,0,60),B=c(0,0,0,0,13,65))\n</code></pre>\n\n<p>The question is: how do I filter out columns with an excessive amount of zeros [e.g. > 50%]? \nE.g. column B would have to be removed. </p>\n\n<p>It would be great to set a threshold with nrow(mat) * 0.5 and then remove columns that have a zero count above that threshold value.</p>\n"},{"tags":["r","hierarchical-clustering"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13030031,"title":"match a pattern to choose the right color for a plot","body":"<p>While i was clustering my data i ran into a problem. I want to color the branches of the cluster by disease type. So i wrote a little script that should do this for me.</p>\n\n<pre><code>col.int&lt;-c(\"green\",\"red\",\"blue\",\"deeppink\")[match(fit$labels,c(\".SPORADIC\",\".HNPCC_UV\",\".NA_FAM\",\".MUTYH\"))]\n</code></pre>\n\n<p>But the problem is that <code>fit$labels</code> consists of more than only the disease type namely the patient id`s. So if i try to match SPORADIC to my label names i only get NA values.\nSo i want to know how to tell the script it should look for a pattern in the label instead of matching the entire label name. </p>\n\n<p>Mydata looks as follows:</p>\n\n<pre><code>structure(list(merge = structure(c(-1L, -2L, -26L, -32L, -40L, \n-50L, -76L, -81L, -84L, -96L, -3L, -55L, -56L, -72L, -5L, -17L, \n-19L, -27L, -36L, -37L, -42L, -44L, -54L, -67L, -85L, -87L, -90L, \n-185L, -6L, -33L, -38L, -58L, -63L, -69L, -94L, -115L, -7L, -35L, \n-75L, -83L, -10L, -14L, -112L, -15L, -20L, -49L, -65L, -68L, \n-105L, -22L, -60L, -78L, -206L, -24L, -64L, -80L, -118L, -29L, \n-30L, -77L, -163L, -31L, -86L, -97L, -98L, -103L, -109L, -141L, \n-187L, -198L, -204L, -41L, -43L, -52L, -70L, -79L, -101L, -116L, \n-92L, -95L, -121L, -161L, -125L, -145L, -193L, -216L, -127L, \n-162L, -181L, -133L, -140L, -164L, -167L, -174L, -188L, -102L, \n-214L, -12L, -170L, -156L, -104L, -11L, -142L, -202L, -53L, -51L, \n-155L, -89L, -180L, -34L, -113L, -46L, -120L, 89L, -136L, 41L, \n71L, -173L, -93L, -23L, -154L, -137L, 36L, 78L, -74L, -194L, \n79L, -111L, 86L, -28L, 61L, -110L, -178L, 10L, -117L, -4L, -150L, \n115L, 93L, 58L, 108L, -138L, -114L, 113L, -168L, -39L, -186L, \n80L, 82L, -130L, -82L, -147L, -191L, 138L, 124L, 122L, -132L, \n-200L, -106L, -189L, 92L, -176L, 120L, -160L, -48L, 106L, -124L, \n126L, -165L, -171L, -179L, 129L, 148L, -100L, 1L, 98L, -131L, \n-158L, -196L, -182L, -9L, 137L, -159L, 157L, 149L, -152L, 152L, \n-126L, -128L, 153L, 150L, 163L, 180L, 156L, 160L, -157L, 107L, \n162L, 164L, 182L, 112L, 195L, 196L, 159L, 183L, 181L, 202L, 199L, \n191L, 206L, 200L, 204L, 184L, 203L, 212L, -177L, -21L, 2L, 3L, \n4L, 5L, 6L, 7L, 8L, 9L, -25L, 11L, 12L, 13L, -8L, 15L, 16L, 17L, \n18L, 19L, 20L, 21L, 22L, 23L, 24L, 25L, 26L, 27L, -18L, 29L, \n30L, 31L, 32L, 33L, 34L, 35L, -13L, 37L, 38L, 39L, -88L, -73L, \n42L, -16L, -45L, 45L, 46L, 47L, 48L, -59L, 50L, 51L, 52L, -47L, \n54L, 55L, 56L, -99L, -62L, 59L, 60L, -66L, 62L, 63L, 64L, 65L, \n66L, 67L, 68L, 69L, 70L, -57L, -61L, -108L, -203L, -91L, 76L, \n77L, -119L, -212L, -122L, 81L, -144L, 83L, 84L, 85L, -134L, 87L, \n88L, -148L, -143L, -169L, -197L, -213L, -201L, 49L, 44L, -135L, \n94L, 53L, 28L, -192L, 72L, 75L, -215L, -183L, 14L, -153L, 57L, \n-71L, -172L, -139L, 40L, 95L, -184L, 74L, 91L, -175L, -107L, \n-211L, 97L, 102L, 109L, 101L, -149L, 90L, 116L, 110L, 99L, -208L, \n121L, 103L, 118L, 73L, -123L, 131L, -207L, 117L, 123L, 96L, 136L, \n114L, 43L, 127L, -205L, -210L, 133L, 104L, 139L, 143L, 134L, \n-195L, 132L, 142L, 125L, 130L, 145L, 146L, 140L, -190L, 100L, \n-199L, 141L, -166L, -151L, 144L, 135L, 147L, 111L, 165L, 119L, \n154L, 151L, 128L, 105L, 166L, 171L, 176L, 169L, -209L, 174L, \n161L, 167L, 172L, 155L, 158L, 170L, -129L, -146L, 168L, 173L, \n185L, 186L, 192L, 188L, 177L, 178L, 179L, 189L, 190L, 175L, 198L, \n201L, 197L, 187L, 193L, 205L, 207L, 194L, 209L, 208L, 210L, 211L, \n213L, 214L), .Dim = c(215L, 2L)), height = c(0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0.00359389038634323, 0.00406394236181465, 0.00649350649350644, \n0.00912375832219081, 0.00925925925925927, 0.0118483412322275, \n0.0145454545454545, 0.0152885509601333, 0.0166566286517327, 0.0186046511627908, \n0.0208333333333334, 0.0209267563527653, 0.0214132762312634, 0.0224057413681743, \n0.0228571428571429, 0.0256410256410257, 0.025974025974026, 0.0294117647058824, \n0.0327645443307275, 0.0328947368421053, 0.0331603326665965, 0.0356567259715686, \n0.0443686006825939, 0.0475, 0.0484094052558783, 0.0518796353224032, \n0.0534487053706255, 0.0547077905882575, 0.0563718734450903, 0.0578231292517006, \n0.0613830613830613, 0.0622751723057615, 0.0634920634920635, 0.0644327567295862, \n0.0658682634730539, 0.0668128430870732, 0.0705853974392098, 0.0751236471810454, \n0.0791918615118165, 0.0814814814814815, 0.0840010548320977, 0.0875912408759124, \n0.0936648591902225, 0.0952071705226908, 0.0975452599352908, 0.101868037484979, \n0.107997171744147, 0.109056860742254, 0.11559433104575, 0.119804400977995, \n0.124629080118694, 0.140933816340968, 0.14179814636445, 0.163254725744272, \n0.163300668687379, 0.164550876331996, 0.17258883248731, 0.1728731431966, \n0.181699994974325, 0.183783241609719, 0.189923527478743, 0.193719375296218, \n0.197832447740333, 0.211200790020614, 0.211416490486258, 0.213745390488226, \n0.214849921011058, 0.215913282172105, 0.234806629834254, 0.242424242424242, \n0.246066211608438, 0.246427111438149, 0.24999095127792, 0.252724927051683, \n0.255913595401057, 0.274475840696771, 0.286483762400918, 0.287176198199807, \n0.303808873276086, 0.306025671419987, 0.328412033190212, 0.332126921889894, \n0.341734154210338, 0.34176559352234, 0.37150466045273, 0.376790317416398, \n0.381977523157772, 0.382997925922382, 0.384551895299024, 0.386213122564166, \n0.393014885652478, 0.400243405117492, 0.406593406593407, 0.432671081677704, \n0.44812132458409, 0.46358985724391, 0.513662061556124, 0.536640659139735, \n0.550285636317328, 0.602127569602188, 0.631010533104603, 0.698728773010427, \n0.72360776175643, 0.787536353244465, 0.7988812719814, 0.814115072824207, \n0.853874433030377, 0.917561212603516, 0.940247780670057, 0.943630213146685, \n1.07562939731944, 1.21827776986843, 1.34271282928207, 1.55806846198326, \n1.81384209156158, 2.12412215470848, 2.89211680358764, 3.37020319658011, \n10.5520617141179, 59.8855594110458), order = c(106L, 29L, 99L, \n102L, 105L, 68L, 65L, 49L, 20L, 45L, 155L, 72L, 56L, 55L, 3L, \n25L, 158L, 12L, 135L, 51L, 183L, 120L, 83L, 75L, 35L, 7L, 13L, \n92L, 119L, 10L, 88L, 52L, 108L, 9L, 100L, 111L, 34L, 71L, 182L, \n209L, 152L, 200L, 39L, 210L, 130L, 114L, 112L, 14L, 73L, 95L, \n212L, 202L, 70L, 203L, 82L, 96L, 84L, 81L, 76L, 50L, 40L, 32L, \n26L, 2L, 21L, 43L, 61L, 137L, 11L, 192L, 28L, 208L, 23L, 211L, \n89L, 153L, 4L, 163L, 77L, 30L, 62L, 154L, 214L, 15L, 16L, 161L, \n121L, 122L, 167L, 197L, 115L, 94L, 69L, 63L, 58L, 38L, 33L, 6L, \n18L, 180L, 118L, 80L, 64L, 24L, 47L, 116L, 101L, 79L, 91L, 104L, \n185L, 90L, 87L, 85L, 67L, 54L, 44L, 42L, 37L, 36L, 27L, 19L, \n17L, 5L, 8L, 74L, 149L, 157L, 131L, 179L, 93L, 107L, 46L, 139L, \n1L, 177L, 53L, 215L, 132L, 168L, 205L, 216L, 193L, 145L, 125L, \n144L, 170L, 174L, 213L, 136L, 184L, 204L, 198L, 187L, 141L, 109L, \n103L, 98L, 97L, 86L, 31L, 66L, 140L, 143L, 138L, 181L, 162L, \n127L, 134L, 188L, 201L, 150L, 207L, 164L, 169L, 156L, 206L, 78L, \n60L, 22L, 59L, 191L, 110L, 142L, 41L, 57L, 194L, 133L, 148L, \n186L, 178L, 173L, 175L, 160L, 166L, 128L, 146L, 189L, 190L, 126L, \n129L, 176L, 199L, 196L, 165L, 113L, 172L, 159L, 124L, 117L, 123L, \n147L, 195L, 171L, 48L, 151L), labels = c(\"00_11242T1 MUTYH\", \n\"01_677T HNPCC_UV\", \"106T SPORADIC\", \"106TV SPORADIC\", \"108T SPORADIC\", \n\"108TV SPORADIC\", \"124T SPORADIC\", \"124TV SPORADIC\", \"40T SPORADIC\", \n\"44T SPORADIC\", \"44TV SPORADIC\", \"511T SPORADIC\", \"511TV SPORADIC\", \n\"514T SPORADIC\", \"514TV SPORADIC\", \"56T SPORADIC\", \"92_11145T HNPCC_UV\", \n\"95_549T HNPCC_UV\", \"97_12714T1 MUTYH\", \"97_7999T HNPCC_UV\", \n\"97_8073T2 MUTYH\", \"99_2221T HNPCC_UV\", \"R01_80418T2 NA_FAM\", \n\"R01_81197T HNPCC_UV\", \"R02_80456T2 MUTYH\", \"R03_80586T HNPCC_UV\", \n\"R04_80227T NA_FAM\", \"R04_80577T NA_FAM\", \"R04_80584T HNPCC_UV\", \n\"R04_81371T NA_FAM\", \"R04_81372T1 NA_FAM\", \"R04_81449T NA_FAM\", \n\"R05_80481T NA_FAM\", \"R05_80611T NA_FAM\", \"00-04193T HNPCC_UV\", \n\"00-06583T HNPCC_UV\", \"00-06969T HNPCC_UV\", \"00-09107T HNPCC_UV\", \n\"00-10221T HNPCC_UV\", \"00-11063T HNPCC_UV\", \"00-11960T HNPCC_UV\", \n\"00-11963T HNPCC_UV\", \"00134T HNPCC_UV\", \"01-01171T HNPCC_UV\", \n\"03-05270T HNPCC_UV\", \"16924T1 MUTYH\", \"08731T6 MUTYH\", \"18250T1 MUTYH\", \n\"20699T1 MUTYH\", \"20699T2 MUTYH\", \"4497T1 MUTYH\", \"4497T4 MUTYH\", \n\"6103T MUTYH\", \"80-4124T1 MUTYH\", \"80456T1 MUTYH\", \"80456T2 MUTYH\", \n\"90-5023T1 MUTYH\", \"90-5023T2 MUTYH\", \"90-5023T3 MUTYH\", \"90-5023T4 MUTYH\", \n\"93-03554T HNPCC_UV\", \"93-7083T MUTYH\", \"95-16316T HNPCC_UV\", \n\"95-5959T HNPCC_UV\", \"97_8073T1 MUTYH\", \"97-07999T HNPCC_UV\", \n\"97-4772T2 MUTYH\", \"97-4772T8 MUTYH\", \"97-5332T1 MUTYH\", \"97-5332T2 MUTYH\", \n\"98-04559T HNPCC_UV\", \"98-11489T HNPCC_UV\", \"99-01796T HNPCC_UV\", \n\"99-02872T1 HNPCC_UV\", \"99-02872T2 HNPCC_UV\", \"99-10411T HNPCC_UV\", \n\"99-10647T2 HNPCC_UV\", \"H04-00107T HNPCC_UV\", \"R01-80145T HNPCC_UV\", \n\"R01-80242T HNPCC_UV\", \"R01-80377T HNPCC_UV\", \"R01-80499T HNPCC_UV\", \n\"R01-80748T HNPCC_UV\", \"R02-80670T HNPCC_UV\", \"R02-80744T HNPCC_UV\", \n\"R02-80813T HNPCC_UV\", \"R02-81415T1 HNPCC_UV\", \"R02-81415T2 HNPCC_UV\", \n\"R02-81709T HNPCC_UV\", \"R03-80064T HNPCC_UV\", \"R03-80732T HNPCC_UV\", \n\"R04-80248T1 NA_FAM\", \"R04-80248T2 NA_FAM\", \"R04-80575T NA_FAM\", \n\"R04-80576T1 NA_FAM\", \"R04-80576T2 NA_FAM\", \"R04-80599T2 NA_FAM\", \n\"R04-80599T3 NA_FAM\", \"R04-80599T4 NA_FAM\", \"R04-81767T1 NA_FAM\", \n\"R05-80533T NA_FAM\", \"R05-80546T NA_FAM\", \"R05-80824T HNPCC_UV\", \n\"t00-21127C2 SPORADIC\", \"t01-11711A3 SPORADIC\", \"t01-11711C2 SPORADIC\", \n\"t01-12237A3C1 SPORADIC\", \"t01-12237C2 SPORADIC\", \"t02-10005A1 SPORADIC\", \n\"t02-10005C2 SPORADIC\", \"t02-15497A2A3 SPORADIC\", \"t02-15497C2 SPORADIC\", \n\"t02-16230A1/2/3 SPORADIC\", \"t02-16230C2 SPORADIC\", \"t02-29970A3 SPORADIC\", \n\"t02-29970C2 SPORADIC\", \"t03-07016A1A2 SPORADIC\", \"t03-07016C1 SPORADIC\", \n\"t03-26385A3 SPORADIC\", \"t03-26385C1C2 SPORADIC\", \"t05-26388A2A3 SPORADIC\", \n\"t05-26388C2 SPORADIC\", \"t05-35275A2 SPORADIC\", \"t05-35275C2 SPORADIC\", \n\"GSM288035 SPORADIC\", \"GSM288037 SPORADIC\", \"GSM288039 SPORADIC\", \n\"GSM288041 SPORADIC\", \"GSM288043 SPORADIC\", \"GSM288045 SPORADIC\", \n\"GSM288047 SPORADIC\", \"GSM288049 SPORADIC\", \"GSM288051 SPORADIC\", \n\"GSM288053 SPORADIC\", \"GSM288055 SPORADIC\", \"GSM288057 SPORADIC\", \n\"GSM288059 SPORADIC\", \"GSM288061 SPORADIC\", \"GSM288063 SPORADIC\", \n\"GSM288065 SPORADIC\", \"GSM288067 SPORADIC\", \"GSM288069 SPORADIC\", \n\"GSM288071 SPORADIC\", \"GSM288073 SPORADIC\", \"GSM288075 SPORADIC\", \n\"GSM288077 SPORADIC\", \"GSM288079 SPORADIC\", \"GSM288081 SPORADIC\", \n\"GSM288083 SPORADIC\", \"GSM288085 SPORADIC\", \"GSM288089 SPORADIC\", \n\"GSM288091 SPORADIC\", \"GSM288093 SPORADIC\", \"GSM288095 SPORADIC\", \n\"GSM288097 SPORADIC\", \"GSM288099 SPORADIC\", \"GSM288101 SPORADIC\", \n\"GSM288103 SPORADIC\", \"GSM288105 SPORADIC\", \"GSM288107 SPORADIC\", \n\"GSM288109 SPORADIC\", \"GSM288111 SPORADIC\", \"GSM288113 SPORADIC\", \n\"GSM288115 SPORADIC\", \"GSM288117 SPORADIC\", \"GSM288119 SPORADIC\", \n\"GSM288121 SPORADIC\", \"GSM288123 SPORADIC\", \"GSM288125 SPORADIC\", \n\"GSM288127 SPORADIC\", \"GSM288129 SPORADIC\", \"GSM288131 SPORADIC\", \n\"GSM288133 SPORADIC\", \"GSM288135 SPORADIC\", \"GSM288137 SPORADIC\", \n\"GSM288139 SPORADIC\", \"GSM288141 SPORADIC\", \"GSM288143 SPORADIC\", \n\"GSM288145 SPORADIC\", \"GSM288147 SPORADIC\", \"GSM288149 SPORADIC\", \n\"GSM288151 SPORADIC\", \"GSM288153 SPORADIC\", \"GSM288155 SPORADIC\", \n\"GSM288157 SPORADIC\", \"GSM288159 SPORADIC\", \"GSM288161 SPORADIC\", \n\"GSM288163 SPORADIC\", \"GSM288165 SPORADIC\", \"GSM288167 SPORADIC\", \n\"GSM288169 SPORADIC\", \"GSM288171 SPORADIC\", \"GSM288173 SPORADIC\", \n\"GSM288175 SPORADIC\", \"GSM288177 SPORADIC\", \"GSM288179 SPORADIC\", \n\"GSM288181 SPORADIC\", \"GSM288183 SPORADIC\", \"GSM288185 SPORADIC\", \n\"GSM288189 SPORADIC\", \"GSM288191 SPORADIC\", \"GSM288193 SPORADIC\", \n\"GSM288195 SPORADIC\", \"GSM288197 SPORADIC\", \"GSM288199 SPORADIC\", \n\"GSM288201 SPORADIC\", \"GSM288203 SPORADIC\", \"GSM288205 SPORADIC\", \n\"GSM288207 SPORADIC\", \"GSM288209 SPORADIC\", \"GSM288211 SPORADIC\", \n\"GSM288213 SPORADIC\", \"GSM288215 SPORADIC\", \"GSM288217 SPORADIC\", \n\"GSM288219 SPORADIC\", \"GSM288221 SPORADIC\"), method = \"ward\", \n    call = hclust(d = a, method = \"ward\"), dist.method = NULL), .Names = c(\"merge\", \n\"height\", \"order\", \"labels\", \"method\", \"call\", \"dist.method\"), class = \"hclust\")\n</code></pre>\n"},{"tags":["r","rstudio"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":13029975,"title":"Automatically run R code when RStudio project is opened","body":"<p>I wrote an R function that updates the version number of a package in <a href=\"http://stackoverflow.com/a/13029847/567015\">another question</a>. I work a lot with GitHub and RStudio, and it would safe me quite some time (plus be much more precise) if this function was automatically run every time I opened a certain project (or better yet, make a git commit/push, but I assume that is harder to do). But I don't know how to do this or if this is even possible. </p>\n\n<p>I could use <code>.Rprofile</code> to run R codes every time I start <code>R</code>, so I could just update versions whenever I start R (or build in that it only updates the version if the date is not today or something) but that seems overdoing it.</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12944365,"title":"Error when installing ggthemes r-package developer version from github","body":"<p>I encounter an error when installing <a href=\"http://www.jrnold.me/\" rel=\"nofollow\">Jeffrey Arnold</a> package from <a href=\"https://github.com/jrnold/ggthemes\" rel=\"nofollow\">github</a>. </p>\n\n<pre><code>library(\"devtools\")\ninstall_github(\"ggthemes\", \"jrnold\")\nInstalling github repo(s) ggthemes/master from jrnold\nInstalling ggthemes.zip from https://api.github.com/repos/jrnold/ggthemes/zipball/master\nError as.list(param_pieces[, 2]) : Index out of bounds\n</code></pre>\n\n<p>Does anybody know how to solve it?</p>\n"},{"tags":["r","ggplot2"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13021158,"title":"ggplot2 add legend for each geom_point manually","body":"<p>I created a plot using 2 separate data sets so that I could create different errorbars.  The first data set has error bars that go down only whereas the second data set has error bars that go up only.  This prevents unnecessary overlap in the plot. I also used a compound shape for one of the groups.</p>\n\n<p>I want to create a legend based on these shapes (not a colour), but I can't seem to figure it out.  Here is the plot code. </p>\n\n<pre><code>p &lt;-ggplot()\np + geom_point(data=df.figure.1a, aes(x=Hour, y=Mean), shape=5, size=4) +\n    geom_point(data=df.figure.1a, aes(x=Hour, y=Mean), shape=18, size=3) +\n    geom_errorbar(data=df.figure.1a, aes(x=Hour, y=Mean, ymin = Mean - SD, ymax = Mean), size=0.7, width = 0.4) +\n    geom_point(data=df.figure.1b, aes(x=Hour, y=Mean), shape=17, size=4) +\n    geom_errorbar(data=df.figure.1b, aes(x=Hour, y=Mean, ymin = Mean, ymax = Mean + SD), size=0.7, width = 0.4) \n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":49,"score":-1,"question_id":13024941,"title":"hierarchial clustering for gene expression in r","body":"<p>I have a RMA normalized genes expression datset with 22810 rows and 9 columns( types of promoters) and a subset of the data is as follows:</p>\n\n<pre><code>ID_REF GSM362180    GSM362181  GSM362188    GSM362189  GSM362192\n244901 5.094871713 4.626623079 4.554272515 4.748604391 4.759221647\n244902 5.194528083 4.985930299 4.817426064 5.151654407 4.838741605\n244903 5.412329253 5.352970877 5.06250609  5.305709079 8.365082403\n244904 5.529220594 5.28134657  5.467445095 5.62968933  5.458388909\n244905 5.024052699 4.714631878 4.792865831 4.843975286 4.657188246\n244906 5.786557533 5.242403911 5.060605782 5.458148567 5.890061836\n</code></pre>\n\n<p>I want to do a clustering of the above and tried the hierarchical clustering:</p>\n\n<pre><code>d &lt;- dist(as.matrix(deg), method = \"euclidean\")\n</code></pre>\n\n<p>where deg is the a matrix of the differentially expressed genes ( 4300 in number ).And I get the following warning:</p>\n\n<pre><code>  Warning message:\n In dist(as.matrix(deg), method = \"euclidean\") : NAs introduced by coercion\n</code></pre>\n\n<p>Is it allright to proceed with the clustering inspite of the warning ?</p>\n\n<pre><code>hc &lt;- hclust(d)\nplot(hc, hang = -0.01, cex = 0.7)\n</code></pre>\n\n<p>I get a dendrogram which is very dense and the labels are not clear: Also I do not know which of the 9 promoters are classified in the tree for the several genes: How would it be possible to label the tree with the promoters and also how to visualize the genes into a clearer dendrogram? Iam not sure how I have to add the dendrogram here else I would .</p>\n"},{"tags":["r","automation","versioning","packages"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":69,"score":5,"question_id":13028093,"title":"Is it possible to parameterize a r package version?","body":"<p>I'm finding myself updating a the version and date of the r-packages that I maintain quite often. Both the version and date exists in DESCRIPTION, packageName-package.Rd and also man/packageName-package.Rd. I've forgotten to update in one file several times. These were originally generated by the package.skeleton command. Is there a similar command/utility script to update the version?</p>\n\n<p><strong>EDIT:</strong> Upon closer inspection the automatically generated versions and dates in the Rd files are not needed. The correct date and version still appears in the generated manual. So obviously this leave only one place to update this information.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13030399,"title":"error in inputting the data","body":"<pre><code>ID_REF           GSM133971          GSM133972               GSM133973\n244901_at   5.95461158752441E+001   1.88836498260498E+001   1.98215045928955E+001\n244902_at   7.25400314331055E+001   2.65250205993652E+001   1.95321922302246E+001\n244903_at   2.23291015625000E+002   1.78133636474609E+002   5.38166885375977E+001\n244904_at   3.65505447387695E+001   3.04016351699829E+000   6.80462265014648E+000\n244905_at   4.07523269653320E+001   2.58869285583496E+001   1.18088026046753E+001\n244906_at   1.50184860229492E+002   5.39840278625488E+001   4.14917945861816E+001\n244907_at   2.65190029144287E+001   1.39808797836304E+000   2.08662915229797E+000\n244908_at   3.50156021118164E+000   1.05003893375397E+000   4.57657009363174E-001\n244909_at   1.02663551330566E+002   1.42618169784546E+001   1.61735534667969E+001\n244910_s_at 7.20161895751953E+001   1.57578134536743E+001   1.31729679107666E+001\n244911_at   3.26349411010742E+001   7.23858451843262E+000   6.47778940200806E+000\n</code></pre>\n\n<p>The above is the MAS5.0 normalized data and I need to read the data in R but getthe following error:</p>\n\n<pre><code> mydat=read.csv(\"trans.csv\",header=T)\n Error in make.names(col.names, unique = TRUE) :invalid multibyte string at '&lt;ff&gt;&lt;fe&gt;I'\n</code></pre>\n"},{"tags":["r"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":13019003,"title":"multiply columns of data frames","body":"<p>I have been scratching my head over this. I have two data frames: <code>df</code></p>\n\n<pre><code>df &lt;- data.frame(group = 1:3,\n                 age = seq(30, 50, length.out = 3),\n                 income = seq(100, 500, length.out = 3),\n                 assets = seq(500, 800, length.out = 3))\n</code></pre>\n\n<p>and <code>weights</code></p>\n\n<pre><code>weights &lt;- data.frame(age = 5, income = 10)\n</code></pre>\n\n<p>I would like to multiply these two data frames only for the same column names. I tried something like this:</p>\n\n<pre><code>colwise(function(x) {x * weights[names(x)]})(df)\n</code></pre>\n\n<p>but that obviously didn't work as <code>colwise</code> does not keep the column name inside the function. I looked at various <code>mapply</code> solutions (<a href=\"https://stat.ethz.ch/pipermail/r-help/2007-November/145917.html\" rel=\"nofollow\">example</a>), but I am unable to come up with an answer.</p>\n\n<p>The resulting <code>data.frame</code> should look like this:</p>\n\n<pre><code>structure(list(group = 1:3, age = c(150, 200, 250), income = c(1000, \n3000, 5000), assets = c(500, 650, 800)), .Names = c(\"group\", \n\"age\", \"income\", \"assets\"), row.names = c(NA, -3L), class = \"data.frame\")\n\n  group age income assets\n1     1 150   1000    500\n2     2 200   3000    650\n3     3 250   5000    800\n</code></pre>\n"},{"tags":["mysql","r","statistics"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":1140,"score":3,"question_id":3985333,"title":"How to select standard deviation within a row? (in SQL - or R :)","body":"<p>I wonder whether there is a way to select the standard deviation from several integer fields in MySQL within the same row. Obviously, if I use</p>\n\n<pre><code>SELECT STDDEV(col1) FROM mytable\n</code></pre>\n\n<p>I just get the standard deviation of that particular column. Let´s assume I have a table like:\n<code>id,somefield1,somefield2, integerfield1,integerfield2,integerfield3, ... ,integerfield30</code> .\nNow I´d like to select the standard deviation of integerfield 1-30 within a row and save it AS sdfield . Of course I could use statistical software for this, but I just wonder if there is a way to do it directly in MySQL. </p>\n\n<p>thx in advance for any suggestions.</p>\n"},{"tags":["r","data-visualization","bar-chart","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":102,"score":0,"question_id":12986502,"title":"Combine / overlay different types of graphs with \"lattice\" and \"latticeExtra\"","body":"<p>I'm trying to combine or that is to say overlay a barchart with a xyplot (with regression line) with two variables whose values are quite different. </p>\n\n<p>Here's my data: <a href=\"https://www.dropbox.com/s/aacbkmo577uagjs/example.csv\" rel=\"nofollow\">https://www.dropbox.com/s/aacbkmo577uagjs/example.csv</a></p>\n\n<p>There are the two numeric variables \"rb\" and \"rae\" and several factor variables (sample.size, effect.size, allocation.design, true.dose) that are to be displayed in panels according to the code below. The variable \"rae\" should be displayed in a barchart (ideally in faint colors in the background), whereas the variable \"rb\" is to be displayed in a xyplot with a regression line. There are two main questions:</p>\n\n<p>(1) How to combine / overlay both types of graphs?\n(2) How to customize axes labels (different scales for y-scale)</p>\n\n<p>For (1), I know how to combine different types of graphs with ggplot2, but it should be also possible with lattice, am I right? I tried \"doubleYScale\", which doesn't seem to work.</p>\n\n<p>For (2), I only accomplished to use \"relation='free'\" for the y-scale in the \"scales\"-option (see code). This is nice since the focus is on the important range of the values. However, it would be more appropriate if axes-labels are additionally drawn on the left and right outside (for \"rae\" and \"rb\", respectively).</p>\n\n<p>Here's the code so far (modified by Dieter Menne to be self-contained)</p>\n\n<pre><code>library(lattice)\nlibrary(latticeExtra)\ndf.dose &lt;- read.table(\"example.csv\", header=TRUE, sep=\",\")\ndf.dose &lt;- transform(df.dose, \n                    sample.size=as.factor(sample.size),\n                    true.dose = as.factor(true.dose))\n\nrae.plot &lt;- xyplot(\n  rae ~ sample.size | allocation.design*true.dose,                \n  df.dose, as.table=TRUE, \n  groups = type, \n  lty = 1, jitter.x=TRUE, \n  main=\"RAE\", \n  scales=list(y=list(draw=F, relation=\"free\", tck=.5)), \n  panel = function(x,y) { \n    panel.xyplot(x,y,jitter.x=TRUE)\n    panel.lmline(x,y, col=\"darkgrey\", lwd=1.5) \n  })\n\nuseOuterStrips(rae.plot)\n\nrb.plot &lt;- barchart(\n  rb ~ sample.size | allocation.design*as.factor(true.dose), \n  df.dose, as.table=TRUE, \n  groups = type, \n  key=list(\n    text=list(levels(as.factor(df.dose$type))), \n    scales=list(y=list(draw=F, relation=\"free\", tck=.5)), \n    main=\"RB\"))\n\nuseOuterStrips(rb.plot)\n</code></pre>\n"},{"tags":["r","binary"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":84,"score":1,"question_id":12977504,"title":"How to specify the number of days in each month for specific year using R?","body":"<p>I am trying to calculate the annual total of monthly product(binary files)  <a href=\"https://echange-fichiers.inra.fr/get?k=Jr3tvgeKnWUiC1B0MMY\" rel=\"nofollow\">https://echange-fichiers.inra.fr/get?k=Jr3tvgeKnWUiC1B0MMY</a>. So I have 12 files and I have to calculate the total sum. The code given below worked fine but what I need is to multiply each file by the number of days which correspond to that month in that year then calculate the total sum. For my case, those data are for the year 2000 (a leap year), so I want to multiply the results for file number 1 by 31 and file number 2 by 29 and so on....</p>\n\n<pre><code>files&lt;- list.files(\"C:\\\\jung file_2000_img\", \"*.img\", full.names = TRUE)\nx&lt;- do.call(rbind,(lapply(files, readBin  , double() , size = 4 , n=360 * 720 , signed =TRUE)))\nresults &lt;- colSums(x)\nfileName &lt;- sprintf(\"C:\\\\annual_ET2000_without999_1.img\")\nwriteBin(as.double(results), fileName, size = 4)\n</code></pre>\n\n<p>From Jame's answer, this will calculate the number of days:</p>\n\n<pre><code>numDays &lt;- function(month,year){\n    as.numeric(strftime(as.Date(paste(year+month%/%12,month%%12+1,\"01\",sep=\"-\"))-1,\"%d\"))\n}\n</code></pre>\n\n<p>So now how to apply that to my code above? By that I mean that I want to take the result for each file and multiply it by the number of days like:</p>\n\n<pre><code>file1*numDays(1,2000)+file2*numDays(2,2000)+file3*numDays(3,2000)\n   .............file12*numDays(12,2000) \n</code></pre>\n"},{"tags":["r","ascii"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":128,"score":4,"question_id":13011383,"title":"How to create a MySQL style ascii tables as output in R?","body":"<p>I'm trying to find a function for R which outputs <code>data.frame</code> objects in MySQL style ascii tables like this</p>\n\n<pre><code>+----+------+------+\n| id | var1 | var2 |\n+----+------+------+\n|  1 | asdf | g    |\n|  2 | asdf | h    |\n|  3 | asdf | j    |\n+----+------+------+\n</code></pre>\n\n<p>Is there such function available? There is at least two tools for this</p>\n\n<ul>\n<li><a href=\"http://csvfix.byethost5.com/csvfix13/csvfix.html?ascii_table.html\" rel=\"nofollow\">csvfix asctii_table</a> </li>\n<li><a href=\"http://www.sensefulsolutions.com/2010/10/format-text-as-table.html\" rel=\"nofollow\">Format Text as a Table</a></li>\n</ul>\n\n<p>but is there a way to do this directly from R?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13028076,"title":"How to read in space seperated strings and turn them into hex > binary values?","body":"<p>i am totally new to R and want to accomplish the following task:</p>\n\n<p>I want to read in a file with data similar to this:</p>\n\n<pre><code>0xD4 0x04 0x46 0x00 0x36 0x40 0x64 0x00 0x00 0x1E 0x00 0x04 0x00 0x26 0x00 0x27 0xB1 0x00\n</code></pre>\n\n<p>Subsequently I want to store the seperated strings in some kind of array. Afterwards these strings shall be turned into their hexidecimal representation. So the string 0xD4 becomes the value 0xd4. In another step I want to output the binary representation of each hex value, e.g.:</p>\n\n<pre><code>0xD4: 11010100\n</code></pre>\n\n<p>I struggle reading in the data. I only know of read.table and tried:</p>\n\n<pre><code>values = read.table(\"file\", sep=\" \", headers=FALSE)\n</code></pre>\n\n<p>But the representation of values seems strange. And I do not know how to proceed from there.</p>\n\n<p>Any help would be appreciated!</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":91,"score":2,"question_id":13020892,"title":"Efficiencies for nested for loop","body":"<p>I've created the following code that nests a for loop inside of a for loop in R.  It is a simulation to calculate Power.  I've read that R isn't great for doing for loops but I was wondering if there are any efficiencies I could apply to make this run a bit faster.  I'm fairly new to R as well as programming of any sort.  Right now the run times I'm seeing are:</p>\n\n<p>m=10 I get .17 sec</p>\n\n<p>m=100 I get 3.95 sec</p>\n\n<p>m=1000 I get 246.26 sec</p>\n\n<p>m=2000 I get 1003.55 sec</p>\n\n<p>I was hoping to set the number of times to sample, m, upwards of 100K but I'm afraid to even set this at 10K</p>\n\n<p>Here is the code:</p>\n\n<pre><code>m = 1000                        # number of times we are going to  take samples\npopmean=120                     # set population mean at 120\npopvar=225                      # set known/established population \nvariance at 225\nnewvar=144                      # variance of new methodology \nalpha=.01                       # set alpha\nteststatvect = matrix(nrow=m,ncol=1)    # empty vector to populate with test statistics\npower = matrix(nrow=200,ncol=1)     # empty vector to populate with power\n\nsystem.time(                    # not needed - using to gauge how long this takes\n    for (n in 1:length(power))          # begin for loop for different sample sizes\n      for(i in 1:m){                # begin for loop to take \"m\" samples\n      y=rnorm(n,popmean,sqrt(newvar))   # sample of size n with mean 120 and var=144\n      ts=sum((y-popmean)^2/popvar)      # calculate test statistic for each sample\n      teststatvect[i]=ts            # loop and populate the vector to hold test statistics\n      vecpvals=pchisq(teststatvect,n)   # calculate the pval of each statistic\n      power[n]=length(which(vecpvals&lt;=alpha))/length(vecpvals) # loop to populate      power vector. Power is the proportion lessthan ot equal to alpha\n        }\n   }\n )\n</code></pre>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13028923,"title":"Error while reading data as transactions","body":"<p>I'm trying to find out association rules from my transactions data. </p>\n\n<p>The format of file looks like: </p>\n\n<pre><code>TransactionID |  ProductID\n----------------------------\n3716280          337\n3716280          1512\n3714018          963\n</code></pre>\n\n<p>I imported the data using RCmdr and saved it as a dataset. I tried reading it as transactions again by using the command:</p>\n\n<pre><code>txn &lt;- read.transactions(transactions, rm.duplicates= FALSE, format=”single”,sep=””,cols=c(1,2));\n</code></pre>\n\n<p>I get an error as: <code>ERROR: &lt; text&gt;</code></p>\n\n<p>I have just started to learn R, Can somebody help ?</p>\n\n<p>Thanks! \nVinoth </p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13023659,"title":"Build R package with C Code for Linux and Windows","body":"<p>I have been doing research and I can't quite figure out how to build my R package, that calls C functions, in order for it to work in both Windows and Linux environments.  I am building the package on a Linux machine.</p>\n\n<p>I have two C files, one.C and two.C, I place the two files in the src directory after using package.skeleton(...).  In the namespace file I use the command: useDynLib(one,two).  Is this correct?  Or do I need to put the actual function names instead of the file names?  Do I need to export the function names?</p>\n\n<p>Do I need to put the .so files in the src directory or will these be created automatically?  I am worried then it won't work on a windows machine which needs a .dll file.</p>\n\n<p>As you can see I'm a little confused, thanks for the help.</p>\n"},{"tags":["r","glm","significance"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13027845,"title":"Generalized linear model glm()","body":"<p>I have two test for significance two sets of data using <code>glm()</code> function in R. </p>\n\n<p>The data are</p>\n\n<pre><code>conb&lt;-c(73.5726644, 74.805847, 78.4194529, 68.3893902)  \nconf&lt;-c(93.7066173, 97.3659746, 94.1356139, 94.79768786)\n</code></pre>\n\n<p>As anyone knows how to use the generalized linear model to test for significance.</p>\n"},{"tags":["r","time-series","xts","zoo"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":1,"view_count":164,"score":1,"question_id":10556450,"title":"Rolling window over irregular time series","body":"<p>I have an irregular time series of events (posts) using <code>xts</code>, and I want to calculate the number of events that occur over a rolling weekly window (or biweekly, or 3 day, etc). The data looks like this:</p>\n\n<pre><code>                    postid\n2010-08-04 22:28:07    867\n2010-08-04 23:31:12    891\n2010-08-04 23:58:05    901\n2010-08-05 08:35:50    991\n2010-08-05 13:28:02   1085\n2010-08-05 14:14:47   1114\n2010-08-05 14:21:46   1117\n2010-08-05 15:46:24   1151\n2010-08-05 16:25:29   1174\n2010-08-05 23:19:29   1268\n2010-08-06 12:15:42   1384\n2010-08-06 15:22:06   1403\n2010-08-07 10:25:49   1550\n2010-08-07 18:58:16   1596\n2010-08-07 21:15:44   1608\n</code></pre>\n\n<p>which should produce something like</p>\n\n<pre><code>                    nposts\n2010-08-05 00:00:00     10\n2010-08-06 00:00:00      9\n2010-08-07 00:00:00      5\n</code></pre>\n\n<p>for a 2-day window. I have looked into <code>rollapply</code>, <code>apply.rolling</code> from <code>PerformanceAnalytics</code>, etc, and they all assume regular time series data. I tried changing all of the times to just the day the the post occurred and using something like <code>ddply</code> to group on each day, which gets me close. However, a user might not post every day, so the time series will still be irregular. I could fill in the gaps with 0s, but that might inflate my data a lot and it's already quite large.</p>\n\n<p>What should I do?</p>\n"},{"tags":["r","string-matching","fuzzy","agrep"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":12999772,"title":"Create a unique ID by fuzzy matching of names (via agrep using R)","body":"<p>Using R, I am trying match on people's names in a dataset structured by year and city. Due to some spelling mistakes, exact matching is not possible, so I am trying to use agrep() to fuzzy match names.</p>\n\n<p>A sample chunk of the dataset is structured as follows:</p>\n\n<pre><code>df &lt;- data.frame(matrix( c(\"1200013\",\"1200013\",\"1200013\",\"1200013\",\"1200013\",\"1200013\",\"1200013\",\"1200013\",                             \"1996\",\"1996\",\"1996\",\"1996\",\"2000\",\"2000\",\"2004\",\"2004\",\"AGUSTINHO FORTUNATO FILHO\",\"ANTONIO PEREIRA NETO\",\"FERNANDO JOSE DA COSTA\",\"PAULO CEZAR FERREIRA DE ARAUJO\",\"PAULO CESAR FERREIRA DE ARAUJO\",\"SEBASTIAO BOCALOM RODRIGUES\",\"JOAO DE ALMEIDA\",\"PAULO CESAR FERREIRA DE ARAUJO\"), ncol=3,dimnames=list(seq(1:8),c(\"citycode\",\"year\",\"candidate\")) ))\n</code></pre>\n\n<p>The neat version:</p>\n\n<pre><code>  citycode year                      candidate\n1  1200013 1996      AGUSTINHO FORTUNATO FILHO\n2  1200013 1996           ANTONIO PEREIRA NETO\n3  1200013 1996         FERNANDO JOSE DA COSTA\n4  1200013 1996 PAULO CEZAR FERREIRA DE ARAUJO\n5  1200013 2000 PAULO CESAR FERREIRA DE ARAUJO\n6  1200013 2000    SEBASTIAO BOCALOM RODRIGUES\n7  1200013 2004                JOAO DE ALMEIDA\n8  1200013 2004 PAULO CESAR FERREIRA DE ARAUJO\n</code></pre>\n\n<p>I'd like to check in each city separately, whether there are candidates appearing in several years. E.g. in the example, </p>\n\n<blockquote>\n  <p>PAULO CEZAR FERREIRA DE ARAUJO</p>\n  \n  <p>PAULO CESAR FERREIRA DE ARAUJO</p>\n</blockquote>\n\n<p>appears twice (with a spelling mistake). Each candidate across the entire data set should be assigned a unique numeric candidate ID. The dataset is fairly large (5500 cities, approx. 100K entries) so a somewhat efficient coding would be helpful. Any suggestions as to how to implement this?</p>\n\n<p>EDIT: Here is my attempt (with help from the comments thus far) that is very slow (inefficient) in achieving the task at hand. Any suggestions as to improvements to this?</p>\n\n<pre><code>f &lt;- function(x) {matches &lt;- lapply(levels(x), agrep, x=levels(x),fixed=TRUE, value=FALSE)\n                  levels(x) &lt;- levels(x)[unlist(lapply(matches, function(x) x[1]))]\n                  x\n                }\n\ntemp &lt;- tapply(df$candidate, df$citycode, f, simplify=TRUE)\ndf$candidatenew &lt;- unlist(temp)\ndf$spellerror &lt;- ifelse(as.character(df$candidate)==as.character(df$candidatenew), 0, 1)\n</code></pre>\n\n<p>EDIT 2: Now running at good speed. Problem was the comparison to many factors at every step (Thanks for pointing that out, Blue Magister). Reducing the comparison to only the candidates in one group (i.e. a city) runs the command in 5 seconds for 80,000 lines - a speed I can live with. </p>\n\n<pre><code>df$candidate &lt;- as.character(df$candidate)\n\nf &lt;- function(x) {x &lt;- as.factor(x)\n                  matches &lt;- lapply(levels(x), agrep, x=levels(x),fixed=TRUE, value=FALSE)\n                  levels(x) &lt;- levels(x)[unlist(lapply(matches, function(x) x[1]))]\n                  as.character(x)\n                }\n\ntemp &lt;- tapply(df$candidate, df$citycode, f, simplify=TRUE)\ndf$candidatenew &lt;- unlist(temp)\ndf$spellerror &lt;- ifelse(as.character(df$candidate)==as.character(df$candidatenew), 0, 1)\n</code></pre>\n"},{"tags":["r","documentation"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":13025327,"title":"R - get help in browser instead of the in-build R helper","body":"<p>I've seen two different behaviours of R help (when you type <code>?density</code> for example):</p>\n\n<ul>\n<li>help is open in your default browser</li>\n<li>help is open in in-build R helper (window within R)</li>\n</ul>\n\n<p>I currently have the second behaviour, but I would like to open the help in the browser. Can I somehow easily switch between these two behaviours? Without re-installation. Ideally, setting some R option.</p>\n"},{"tags":["r","igraph"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13016311,"title":"Calculating connectivity with igraph 0.5.4","body":"<p>I have problems calculating  <code>vertex.connectivity(g)</code>of a network by using igraph 0.5.4. I have eliminated the <code>isolated.vertices</code>. I am also sure that there is just one component.<br>\nIs there a bug?, I always obtain:   </p>\n\n<pre><code>vertex.connectivity(g9)  \n[1] 0  \n</code></pre>\n\n<p>by definition there should be a connectivity <code>k &gt;=1</code>. Does someone have any experience calculating that with the old version of igraph?</p>\n"},{"tags":["r","data.table"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":91,"score":6,"question_id":13018696,"title":"data.table \"key indices\" or \"group counter\"","body":"<p>After creating a key on a data.table:</p>\n\n<pre><code>set.seed(12345)\nDT &lt;- data.table(x = sample(LETTERS[1:3], 10, replace = TRUE),\n                 y = sample(LETTERS[1:3], 10, replace = TRUE))\nsetkey(DT, x, y)\nDT\n#       x y\n#  [1,] A B\n#  [2,] A B\n#  [3,] B B\n#  [4,] B B\n#  [5,] C A\n#  [6,] C A\n#  [7,] C A\n#  [8,] C A\n#  [9,] C C\n# [10,] C C\n</code></pre>\n\n<p>I would like to get an integer vector giving for each row the corresponding \"key index\". I hope the expected output (column <code>i</code>) below will help clarify what I mean:</p>\n\n<pre><code>#       x y i\n#  [1,] A B 1\n#  [2,] A B 1\n#  [3,] B B 2\n#  [4,] B B 2\n#  [5,] C A 3\n#  [6,] C A 3\n#  [7,] C A 3\n#  [8,] C A 3\n#  [9,] C C 4\n# [10,] C C 4\n</code></pre>\n\n<p>I thought about using something like <code>cumsum(!duplicated(DT[, key(DT), with = FALSE]))</code> but am hoping there is a better solution. I feel this vector could be part of the table's internal representation, and maybe there is a way to access it? Even if it is not the case, what would you suggest?</p>\n"},{"tags":["image","r","matrix","grid","plot"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":1,"view_count":64,"score":1,"question_id":13021557,"title":"image plot in R too large","body":"<p>I have a 65,000 by 160 matrix, that I then transform into an image using image(X) in R.</p>\n\n<p>I also use the option useRaster = TRUE, and this makes the plotting lots faster, and less large of a file.  </p>\n\n<p>However, the file size is still rather large ~ 60 Mb.  Is there anyway to control the file size of an image in R?  If so I'd love to hear how, and also how much resolution one would lose by constraining the file size.</p>\n\n<p>The file is created as a pdf file, code below:</p>\n\n<pre><code># ----- Define a function for plotting a matrix ----- #\nmyImagePlot &lt;- function(x, filename, ...){\n  dev = \"pdf\"\n  #filename = '/home/dnaiel/test.pdf'\n  if(dev == \"pdf\") { pdf(filename, version = \"1.4\") } else{}\n     min &lt;- min(x)\n     max &lt;- max(x)\n     yLabels &lt;- rownames(x)\n     xLabels &lt;- colnames(x)\n     title &lt;-c()\n  # check for additional function arguments\n  if( length(list(...)) ){\n    Lst &lt;- list(...)\n    if( !is.null(Lst$zlim) ){\n       min &lt;- Lst$zlim[1]\n       max &lt;- Lst$zlim[2]\n    }\n    if( !is.null(Lst$yLabels) ){\n       yLabels &lt;- c(Lst$yLabels)\n    }\n    if( !is.null(Lst$xLabels) ){\n       xLabels &lt;- c(Lst$xLabels)\n    }\n    if( !is.null(Lst$title) ){\n       title &lt;- Lst$title\n    }\n  }\n# check for null values\nif( is.null(xLabels) ){\n   xLabels &lt;- c(1:ncol(x))\n}\nif( is.null(yLabels) ){\n   yLabels &lt;- c(1:nrow(x))\n}\n\nlayout(matrix(data=c(1,2), nrow=1, ncol=2), widths=c(4,1), heights=c(1,1))\n\n # Red and green range from 0 to 1 while Blue ranges from 1 to 0\n ColorRamp &lt;- rgb( seq(0,1,length=256),  # Red\n                   seq(0,1,length=256),  # Green\n                   seq(1,0,length=256))  # Blue\n ColorLevels &lt;- seq(min, max, length=length(ColorRamp))\n\n # Reverse Y axis\n reverse &lt;- nrow(x) : 1\n yLabels &lt;- yLabels[reverse]\n x &lt;- x[reverse,]\n\n # Data Map\n par(mar = c(3,5,2.5,2))\n image(1:length(xLabels), 1:length(yLabels), t(x), col=ColorRamp, xlab=\"\",\n ylab=\"\", axes=FALSE, zlim=c(min,max), useRaster=TRUE)\n if( !is.null(title) ){\n    title(main=title)\n }\n# Here we define the axis, left of the plot, clustering trees....\n#axis(BELOW&lt;-1, at=1:length(xLabels), labels=xLabels, cex.axis=0.7)\n# axis(LEFT &lt;-2, at=1:length(yLabels), labels=yLabels, las= HORIZONTAL&lt;-1,\n# cex.axis=0.7)\n\n # Color Scale (right side of the image plot)\n par(mar = c(3,2.5,2.5,2))\n image(1, ColorLevels,\n      matrix(data=ColorLevels, ncol=length(ColorLevels),nrow=1),\n      col=ColorRamp,\n      xlab=\"\",ylab=\"\",\n      xaxt=\"n\", useRaster=TRUE)\n\n layout(1)\n  if( dev == \"pdf\") {\n    dev.off() }\n}\n# ----- END plot function ----- #\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["r","map"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":120,"score":1,"question_id":13010642,"title":"GoogleVis, Geomap Plot error","body":"<p>When I want to create the map using the gvisGeoMap() from googleVis, I get error:</p>\n\n<pre><code>## Using the google visualization API with R\nlibrary(googleVis)\ninput&lt;- read.csv(\"data.csv\")\n\nselect&lt;- input[which(input$Subgroup==\"Total 5-14\"),]\nselect&lt;- input[which(input$Subgroup==\"Total 5-14 yr\"),]\n\nMap&lt;- data.frame(select$Country.or.Area, select$Value)\nnames(Map)&lt;- c(\"Country\", \"Percentage\")\nGeo=gvisGeoMap(Map, locationvar=\"Country\", numvar=\"Percentage\",\noptions=list(height=350, dataMode='regions'))\n\nplot(Geo)\n#starting httpd help server ... done\n#Error in ifelse(interactive(), getOption(\"browser\"), \"false\") : \n#replacement has length zero\n</code></pre>\n\n<p>The above is the error in the \"RGui\". The error message in \"RStudio\" is differet:</p>\n\n<pre><code>#object of type 'closure' is not subsettable\n</code></pre>\n\n<p>and the browser does not fire at all. The HTTP server works fine since I can simply call help pages.( for example ?googleVis will fire up the browser and give the help page). The \"Geo\" object in the code above is fine and contains the html code only that the plot() does not do what it is supposed to do (I can manually run the html file in the temp folder and see the results). The example above is available <a href=\"http://spatialanalysis.co.uk/2011/02/using-r-to-map-with-google-chart-tools/\" rel=\"nofollow\">here</a>. </p>\n\n<p>I would appreciate your clues. </p>\n\n<p>Thank you </p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12916189,"title":"history search backward in R","body":"<p>Normally in my machine I can search R's history backwards by typing the desired first characters of the command I want to backward-search and then use the PageUp or PageDown keys to go through all the entries in the R history.</p>\n\n<p>I am working as a guest in a remote cluster now and this option is not available in this machine. </p>\n\n<p>Does anyone have an idea of where can I add this function to R?</p>\n\n<p>EDIT: I am interested on key bindings rather than how to reproduce this function.</p>\n\n<p>EDIT2: I am locally on a Fedora 16 machine; remotely CentOS release 5.3 (Final)</p>\n"},{"tags":["r","rows"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":93,"score":1,"question_id":13012509,"title":"How to delete rows from a data table, based on an external list, using R?","body":"<p>This might be an easy question but i still need some help for using R.</p>\n\n<p>I have a data (main_data), lets say..</p>\n\n<pre><code>NAMES   AGE     LOC\nJyo     23      Hyd\nAbid    27      Kar\nRas     24      Pun\nPoo     25      Goa\nSus     28      Kar\n</code></pre>\n\n<p>I wish to remove a few rows based on a list of names. So lets say i have another list of table as follows:</p>\n\n<pre><code>NAMES_list\nJyo\nRas\nPoo\n</code></pre>\n\n<p>So based on this list, if any of the names match to my above \"main_data\" table, then I would like to remove the whole row contianing them, so the result should be as follows</p>\n\n<pre><code>NAMES   AGE     LOC\nAbid    27      Kar\nSus     28      Kar\n</code></pre>\n\n<p>Can anyone help me how to achive this using R? \nThanks in advance.. :)</p>\n"},{"tags":["r","ggplot2","labels","scatter-plot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":117,"score":0,"question_id":13022940,"title":"Adding text labels to ggplot2 scatterplot","body":"<p>Is there a good way easy way to add text labels to the circles on the graph?  I haven't able to do it using the directlabels package because I get the error:</p>\n\n<p>Error in direct.label.ggplot(p, \"first.qp\") : Need colour aesthetic to infer default direct labels.\"</p>\n\n<p>Here is the graph:\n<img src=\"http://i.stack.imgur.com/IbY5B.jpg\" alt=\"What I have at the moment\"></p>\n\n<p>And here is the code that I've been using:</p>\n\n<pre><code>library(ggplot2)\nlibrary(directlabels)\n#my data set:\noc &lt;- read.csv(\"http://www.columbia.edu/~mad2200/oc.csv\")\noc$percent_women &lt;- oc$W_employment/(oc$M_employment+oc$W_employment)\noc$size &lt;- oc$W_employment+oc$M_employment\np &lt;- ggplot(oc, aes(M_w_earnings, W_w_earnings, label = as.character(Occupational.Group)))\np + geom_point(aes(size = size, colour=percent_women)) + scale_size_continuous(range=c(0,30)) + #scale_area()+\n#geom_point(aes(colour = oc$percent_women)) + \ncoord_equal() +\nscale_colour_gradient(high = \"red\")+\nylim(700, 1700) +\nxlim(700, 1700) +\ngeom_abline(slope=1) +\nlabs(title = \"Income Disparity by Occupation and Gender\") +\nylab(\"Women's Weekly Earnings in $\") +\nxlab(\"Men's Weekly Earnings in $\")\n</code></pre>\n"},{"tags":["debugging","r"],"answer_count":3,"favorite_count":9,"up_vote_count":11,"down_vote_count":0,"view_count":2857,"score":11,"question_id":1445964,"title":"R script line numbers at error?","body":"<p>If I am running a long R script from the command line (R --slave script.R), how can I get it to give line numbers at errors?  </p>\n\n<p>I don't want to add debug commands to the script if at all possible -- I just want R to behave like most other scripting languages ...</p>\n"},{"tags":["r","plot","fields","spatial","raster"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13022919,"title":"R: problems visualizing a Raster with fields::image.plot","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13005181/rasterplot-problems-unwanted-rotation-extents\">raster::plot problems: unwanted rotation, extents</a>  </p>\n</blockquote>\n\n\n\n<h1>summary</h1>\n\n<p>R beginner must</p>\n\n<ol>\n<li>convert unprojected (lon-lat) global spatial data from ASCII to <a href=\"http://en.wikipedia.org/wiki/Netcdf\" rel=\"nofollow\">netCDF</a>.</li>\n<li>\"regrid\" it: i.e., restricted the data to a region, project it, and downscale it (i.e., decrease the size of the gridcells).</li>\n</ol>\n\n<p>In this <a href=\"https://github.com/TomRoche/GEIA_to_netCDF\" rel=\"nofollow\">public git repository</a> I have R code driven by bash scripts that does the conversion step, and plots the converted output, <a href=\"https://github.com/downloads/TomRoche/GEIA_to_netCDF/GEIA_N2O_oceanic.pdf\" rel=\"nofollow\">apparently correctly</a>, so the first task appears accomplished. My code may also be accomplishing the second task correctly, but I can't really know until I visualize it. However my attempt to plot the output of the regridding with <code>fields::image.plot</code> is incorrect in 2 ways (data/map orientation, and image extents): see 4th page of output <a href=\"https://github.com/downloads/TomRoche/GEIA_to_netCDF/GEIA_N2O_oceanic_regrid.pdf\" rel=\"nofollow\">here</a>), or section=<code>problem</code> below.</p>\n\n<p>How to fix?</p>\n\n<h1>details</h1>\n\n<h2>background</h2>\n\n<p>(Much of the following section is taken from <a href=\"http://stackoverflow.com/questions/13005181/rasterplot-problems-unwanted-rotation-extents\">this question</a> on <code>raster::plot</code>; if you've already read that, skip to section=<code>problem</code> below.)</p>\n\n<p>I need to take some data (a global marine emissions inventory (EI)), combine it with other data (mostly other EIs), and input that to a model. The model wants to consume netCDF, and it wants that netCDF over a region slightly bigger than the contiguous US (CONUS). The borders of this image <img src=\"http://i.stack.imgur.com/gRtHJ.png\" alt=\"AQMEII-NA domain\"> are the boundaries of the domain. (Note that part, but only part, of the domain is oceanic.) The model also wants that netCDF projected a certain way (<a href=\"http://en.wikipedia.org/wiki/Lambert_conformal_conic\" rel=\"nofollow\">LCC</a> at 12-km resolution). I'm treating this as 2 independent problems:</p>\n\n<ol>\n<li>convert the global EI from its native ASCII format to netCDF</li>\n<li>\"regrid\" the netCDF from global/unprojected to the downscaled (finer-resolution), projected subdomain.</li>\n</ol>\n\n<p>I'm attempting to solve these problems with code I have archived at <a href=\"https://github.com/TomRoche/GEIA_to_NetCDF\" rel=\"nofollow\">this public git repository</a>. If you clone that git repo, and then configure/run the bash driver <code>GEIA_to_netCDF.sh</code> as described for the \"first example\" <a href=\"https://github.com/TomRoche/GEIA_to_netCDF/blob/master/README.md\" rel=\"nofollow\">in the README</a> (and presuming your R is appropriately configured, notably with packages=<code>fields</code>, <code>ncdf4</code>) it will output netCDF and plot (using <code>fields::image.plot</code>) that output to a <a href=\"https://github.com/downloads/TomRoche/GEIA_to_netCDF/GEIA_N2O_oceanic.pdf\" rel=\"nofollow\">PDF</a>, which should look like this: <img src=\"http://i.stack.imgur.com/SOmvZ.png\" alt=\"GEIA global marine emissions\">. The distribution of the output data appears correct, so problem 1 seems solved.</p>\n\n<h2>problem</h2>\n\n<p>Problem 2 (aka the \"second example\" <a href=\"https://github.com/TomRoche/GEIA_to_netCDF/blob/master/README.md\" rel=\"nofollow\">in the README</a>) is somewhat more difficult, and seems to require R package=<code>raster</code>. My bash driver <a href=\"https://github.com/TomRoche/GEIA_to_netCDF/blob/master/regrid_GEIA_netCDF.sh\" rel=\"nofollow\"><code>regrid_GEIA_netCDF.sh</code></a> calls <a href=\"https://github.com/TomRoche/GEIA_to_netCDF/blob/master/regrid.global.to.AQMEII.r\" rel=\"nofollow\"><code>regrid.global.to.AQMEII.r</code></a> (both <a href=\"https://github.com/TomRoche/GEIA_to_NetCDF\" rel=\"nofollow\">in repository</a>), which runs without error. <code>regrid.global.to.AQMEII.r</code> also <em>seems</em> to regrid properly, in the sense that (AFAICS) all the API rules have been followed, and no errors throw:</p>\n\n<pre><code>out.raster &lt;- projectRaster(\n    from=in.raster, to=template.raster, method='bilinear',\n    overwrite=TRUE, progress='window', format='CDF',\n    # args from raster::writeRaster\n    NAflag=-999.0,\n    varname=data.var.name,\n    varunit='ton N2O-N/yr',\n    longname='N2O emissions',\n    xname='COL',\n    yname='ROW',\n    filename=out.fp)\n</code></pre>\n\n<p>But something is very wrong with my attempt to visualize it (again to PDF). <a href=\"https://github.com/downloads/TomRoche/GEIA_to_netCDF/GEIA_N2O_oceanic_regrid.pdf\" rel=\"nofollow\"><code>GEIA_N2O_oceanic_regrid.pdf</code></a> comprises 4 pages, corresponding to 4 blocks of code at the end of <code>regrid.global.to.AQMEII.r</code>. Only the final/4th page is relevant here--the first 3 pages try to use <code>raster::plot</code> and <a href=\"http://stackoverflow.com/questions/13005181/rasterplot-problems-unwanted-rotation-extents\">have their own problems</a>.</p>\n\n<p>Page=4/4 results from my attempt to plot the regridded output, plus a CONUS map from <a href=\"http://cran.r-project.org/web/packages/M3/\" rel=\"nofollow\">R package=M3</a> (which I have previously used successfully), using <code>fields::image.plot</code></p>\n\n<pre><code>title &lt;- \"foo\"\nsubtitle &lt;- \"bar\"\nq.vec &lt;- probabilities.vec # c(0.0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0)\n# functions in regrid.global.to.AQMEII.r (in repo)\nx.centers &lt;- raster.centers.x(out.raster)\ny.centers &lt;- raster.centers.y(out.raster)\n# fails to set dimensions correctly! -&gt; [1] 137241      1\nout.data &lt;- as.matrix(values(out.raster))\ndim(out.data) &lt;- c(length(x.centers), length(y.centers)) # cols, rows\nquantiles &lt;- quantile(c(out.data), q.vec, na.rm=TRUE)\nquantiles.formatted &lt;- format(as.numeric(quantiles), digits=3)\n\n# plot.data(out.data, title, subtitle,\n#   x.centers, y.centers, q.vec, colors, map.cmaq)\n# step through plot.data\nplot.list &lt;- list(x=x.centers, y=y.centers, z=out.data)\nimage.plot(plot.list, xlab=\"\", ylab=\"\", axes=F, col=colors(100),\n  axis.args=list(at=quantiles, labels=quantiles.formatted), main=title)\n# map(add=TRUE) # not defined here\nlines(map.cmaq)\n</code></pre>\n\n<p>Unfortunately the output image\n<img src=\"http://i.stack.imgur.com/ykfnW.png\" alt=\"regrid output p4\">\nis close, but incorrect, in two ways:</p>\n\n<ol>\n<li>If you visualize a horizontal axis dividing the top half of the image from the bottom half, you may notice that the data and the map are mirrored around that axis. E.g., if you look at the top half of the image, you can clearly see a reversed (north/south) white \"shadow\" in the data where North and Central America, and the northern part of South America, should go. (Those spaces are white because they are <code>NA</code>, and they are <code>NA</code> because they are continents and the data is marine.) Since I want to keep the CONUS map in the current orientation, my first question is, how to \"flip the data\" so that it matches the map?</li>\n<li><p>How to restrict the image extents to the desired domain? I.e., <img src=\"http://i.stack.imgur.com/gRtHJ.png\" alt=\"AQMEII-NA domain\">, which I believe corresponds to the extents set in <a href=\"https://github.com/TomRoche/GEIA_to_netCDF/blob/master/regrid.global.to.AQMEII.r\" rel=\"nofollow\"><code>regrid.global.to.AQMEII.r</code></a>:</p>\n\n<pre><code>out.crs &lt;- '+proj=lcc +lat_1=33 +lat_2=45 +lat_0=40 +lon_0=-97 +x=_0=-2556 +y_0=-1728'\n...\ntemplate.in.raster &lt;- raster(template.in.fp, varname=data.var.name, band=template.band)\ntemplate.raster &lt;- projectExtent(template.in.raster, out.crs)\n...\ntemplate.raster\n# class : RasterLayer\n# dimensions : 299, 459, 137241 (nrow, ncol, ncell)\n# resolution : 53369.55, 56883.69 (x, y)\n# extent : -12246449, 12250173, -4532510, 12475715 (xmin, xmax, ymin, ymax)\n# coord. ref. : +proj=lcc +lat_1=33 +lat_2=45 +lat_0=40 +lon_0=-97 +y_0=-1728 +ellps=WGS84\n</code></pre></li>\n</ol>\n\n<p>which matches the domain definition <a href=\"https://github.com/TomRoche/cornbeltN2O/wiki/AQMEII-North-American-domain#wiki-EPA\" rel=\"nofollow\">here</a> (scroll past the map). How to fix the plot extents?</p>\n\n<p>Your assistance to this R newbie is appreciated!</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":591,"score":0,"question_id":6129585,"title":"ticks and text - facet_grid ggplot","body":"<p>I want to plot a group of time series with ggplot, to be printed on a B5 paper.</p>\n\n<p>Are able to make this plot:</p>\n\n<pre><code>qplot(trade.date, value, data = meltreg2, geom='line', group = variable) + \n  facet_grid(variable ~ ., scale = 'free_y')  +\n  scale_x_date(expand=c(0,0), name='') +\n  opts(strip.text.y = theme_blank(), strip.background = theme_blank(), panel.background = \n    theme_rect(), panel.grid.major=theme_blank(), panel.grid.minor=theme_blank(), axis.title.x =\n    theme_blank(), axis.title.y = theme_blank(), panel.margin = unit(0.5, 'line')\n  ) \n</code></pre>\n\n<p>but is there any way I can get ticks and text on all graphs (three graphs)?</p>\n\n<p>and how should I save the plot to best suit a B5 (landscape) page?</p>\n\n<hr>\n\n<p>I would like to have ticks and text on all x axis, not to hide them with theme_blank().\n(the default for the plot above is only ticks and text on the graph that is plotted \"last\", but I need on all)</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":143,"score":0,"question_id":11613951,"title":"Mulitple lines from single column using ggplot","body":"<p>I'm have a dataframe as like below. I need to graph based on region, date as x Axis and AveElapsedTime as y axis.</p>\n\n<pre><code>     &gt;avg_data\n             date  region AveElapsedTime\n    1  2012-05-19 betasol           1372\n    2  2012-05-22  atpTax           1652\n    3  2012-06-02 betasol           1630\n    4  2012-06-02  atpTax           1552\n    5  2012-06-02     Tax           1552\n    6  2012-06-07 betasol           1408\n    7  2012-06-12 betasol           1471\n    8  2012-06-15 betasol           1384\n    9  2012-06-21 betasol           1390\n    10 2012-06-22  atpTax           1252\n    11 2012-06-23 betasol           1442\n</code></pre>\n\n<p>If I rearrage the above one based on region, it will be as like below. It should not plot if there is no value(NA) for particular date.</p>\n\n<pre><code>            date atpTax betasol  Tax\n    1 2012-05-19     NA    1372   NA\n    2 2012-05-22   1652      NA   NA\n    3 2012-06-02   1552    1630 1552\n    4 2012-06-07     NA    1408   NA\n    5 2012-06-12     NA    1471   NA\n    6 2012-06-15     NA    1384   NA\n    7 2012-06-21     NA    1390   NA\n    8 2012-06-22   1252      NA   NA\n    9 2012-06-23     NA    1442   NA\n</code></pre>\n\n<p>I tried using the below ggplot command, I'm getting geom_path error. </p>\n\n<pre><code>    ggplot(avg_data, aes(date, AveElapsedTime)) + geom_line(aes(col=region)) + opts(axis.text.x = theme_text(angle=90, hjust=1))\n    geom_path: Each group consist of only one observation. Do you need to adjust the group aesthetic?\n\n    &gt; str(avg_data)\n    'data.frame':   11 obs. of  3 variables:\n     $ date          : Factor w/ 9 levels \"2012-05-19\",\"2012-05-22\",..: 1 2 3 3 3 4 5 6 7 8 ...\n     $ region        : Factor w/ 3 levels \"atpTax\",\"betasol\",..: 2 1 2 1 3 2 2 2 2 1 ...\n     $ AveElapsedTime: int  1372 1652 1630 1552 1552 1408 1471 1384 1390 1252 ...\n</code></pre>\n\n<p>Please advise on this..</p>\n"},{"tags":["r","ggplot2","reshape2"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":11960352,"title":"ggplot, facets, and changing color in a series","body":"<p>I've got sensor data that looks like this: </p>\n\n<pre><code>tm &lt;- seq(1,17)\nchg &lt;-    c(13.6,13.7,13.8,13.9,14.1,14.2,14.4,14.6,14.7,14.9,14.9,15.0,15.0,13.7,13.7,13.6,13.7)\nbatt_A &lt;- c(   1,   1,   1,   1,   1,   1,   1,   1,   1,   2,   2,   2,   2,   3,   3,   0,   0)\nbatt_B &lt;- c(   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   1)\nbus    &lt;- c(12.4,12.5,12.4,11.7,11.6,12.2,12.4,11.8,11.7,11.5,12.1,12.0,11.6,11.5,11.4,12.6,12.5)\npwr &lt;- data.frame(tm,batt_A,batt_B,chg,bus)\n</code></pre>\n\n<p>I want to create two line graphs (chg and bus against tm) in separate facet panels. The twist is that I want also to have each line colored to represent which battery it's tracking. So if batt_A>0, it's charging and I want the charge line to be green; and if batt_A==0, it's on the bus, and I want the bus line to be green. Same for batt_B, except the lines would be blue (or whatever color). </p>\n\n<p>I get the melt + facet combination, but how to add the coloring? </p>\n\n<p>(ps: I'm using facets because there are 6 more sensors varying on the same timescale and I want to watch them all)</p>\n\n<p>With Andrie's answer below, I got to this solution, but the recode is horrible: </p>\n\n<pre><code>mpwr &lt;- melt(pwr, id.vars=1:3)\n\nmpwr$batt &lt;- ''\nmpwr$batt &lt;- ifelse(mpwr$batt_A&gt;0 &amp; mpwr$variable==\"chg\", \"A\", mpwr$batt)\nmpwr$batt &lt;- ifelse(mpwr$batt_B&gt;0 &amp; mpwr$variable==\"chg\", \"B\", mpwr$batt)\nmpwr$batt &lt;- ifelse(mpwr$batt_A==0 &amp; mpwr$variable==\"bus\", \"A\", mpwr$batt)\nmpwr$batt &lt;- ifelse(mpwr$batt_B==0 &amp; mpwr$variable==\"bus\", \"B\", mpwr$batt)\nmpwr$batt &lt;- as.factor(mpwr$batt)\n\nggplot(mpwr, aes(x=tm, group=1)) + \n   geom_line(aes(y=value, colour=batt)) +\n   geom_line(aes(y=value, colour=batt)) +\n   facet_grid(~variable) +\n   scale_colour_discrete(\"Charging\")\n</code></pre>\n\n<p>The data processing could be cleaned up, but I think I'm there!</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":2,"up_vote_count":11,"down_vote_count":0,"view_count":2663,"score":11,"question_id":3472980,"title":"ggplot: How to change facet labels?","body":"<p>I have used the following ggplot command:</p>\n\n<pre><code>ggplot(survey,aes(x=age))+stat_bin(aes(n=nrow(h3),y=..count../n), binwidth=10)\n  +scale_y_continuous(formatter = \"percent\", breaks=c(0, 0.1, 0.2)) \n  + facet_grid(hospital ~ .) \n  + opts(panel.background = theme_blank()) \n</code></pre>\n\n<p>to produce</p>\n\n<p><img src=\"http://imgur.com/lXK7C.png\" alt=\"alt text\"></p>\n\n<p>I'd like to change the <em>facet</em> labels, however, to something shorter (like Hosp 1, Hosp 2...) because they are too long now and look cramped (increasing the height of the graph is not an option, it would take too much space in the document). I looked at the <a href=\"http://had.co.nz/ggplot2/facet_grid.html\">facet_grid</a> help page but cannot figure out how.</p>\n\n<p>Thanks in advance for any pointers.</p>\n"},{"tags":["r","ggplot2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":11755827,"title":"write dataframe and ggplot in the same pdf","body":"<p>How to write dataframe output in the same pdf where I'm having ggplot output ?</p>\n\n<p>Is there a way to print the output of dataframe in same ggplot pdf?</p>\n\n<p>How to \"cat\"(system command) a particular text file and redirect the output to ggplot pdf ? Please help..</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":67,"score":7,"question_id":13022503,"title":"R: Selectively Modify Indices","body":"<p>Is there a shorter way to select elements and modify them? For example, in</p>\n\n<pre><code>y[y &lt; 1] &lt;- y[y &lt; 1]*2\n</code></pre>\n\n<p>the object <em>y</em> is referenced 4 times in one line. Is it possible to reduce this repetition?</p>\n"},{"tags":["r","plot","ggplot2","par"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":109,"score":5,"question_id":13021863,"title":"plots generated by 'plot' and 'ggplot' side-by-side","body":"<p>Is there a way to put the plot generated by <code>plot</code> function and the plot by <code>ggplot</code> function in R in one page side-by-side?</p>\n\n<p>It is easy to put plots created by the same function into one page using <code>par</code> or <code>multiplot</code> function, but I can't figure out the above question.</p>\n"},{"tags":["r","factor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13022470,"title":"How to clean/reconstruct factor in R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1195826/dropping-factor-levels-in-a-subsetted-data-frame-in-r\">dropping factor levels in a subsetted data frame in R</a>  </p>\n</blockquote>\n\n\n\n<p>I have a data frame which has a factor column, then I would like to use subset to extract only part of its data. But the extracted data frame's factor column still has the same levels even some levels has no value. This would impact my following actions (like visualization using ggplot).</p>\n\n<p>The following is a sample code.</p>\n\n<pre><code>d&lt;-data.frame(c1=factor(c(1,1,2,3)),c2=c(\"a\",\"b\",\"c\",\"d\"))\nd&lt;-subset(d,c1 %in% c(1,2))\nd$c1\n</code></pre>\n\n<p>The column c1 still have 3 levels (1,2,3), but actually I'd like to it to be (1,2), because these's no value for level 3. Then in visualization, I won't draw any graph for level 3.</p>\n\n<p>How can I achieve that ? Thanks</p>\n"},{"tags":["r","charts","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":147,"score":2,"question_id":11714564,"title":"Passing variable with line types to ggplot linetype","body":"<p>I am new to ggplot so bear with me. I am charting out growth projections for 35 small-area geographies which is an unhealthy amount for one plot even with use of the fantastic <code>directlabels</code> library. However I need all the series for initial screening.</p>\n\n<p>The challenge is to make it readable. I found a fix by @Ben Bolker for using <a href=\"http://stackoverflow.com/questions/6075140/in-r-how-do-i-change-the-color-value-of-just-one-value-in-ggplot2s-scale-fill-b\">large numbers of distinct colors</a> but am having trouble varying the linetype. The 35 series don't need to be unique, but I would like to use the 12 different types to make individual series easier to read.</p>\n\n<p>My plan was to create a random list with 35 elements of the 12 possible types and pass that as the linetype argument, but I am having trouble getting it to work, with the error:</p>\n\n<pre><code>Error: Aesthetics must either be length one, or the same length as the dataProblems:lty\n</code></pre>\n\n<p>I have 35 values in the linetype list. Of course I would like for the types, colors and all to be reflected in the legend.</p>\n\n<p>The melted data looks like this; 9 years' observations for each of 35 series:</p>\n\n<pre><code>&gt; simulation_long_index[16:24,]    \n      year    geography    value\n16    2018    sfr_2    101.1871\n17    2019    sfr_2    101.1678\n18    2020    sfr_2    101.2044\n19    2012    sfr_3    100.0000\n20    2013    sfr_3    100.1038\n21    2014    sfr_3    100.2561\n22    2015    sfr_3    100.0631\n23    2016    sfr_3    100.8071\n24    2017    sfr_3    101.2405    \n</code></pre>\n\n<p>Here is my code so far:</p>\n\n<pre><code>lty &lt;- data.frame(lty=letters[1:12][sample(1:12, 35,replace=T)])\n\ng3&lt;-ggplot(data=simulation_long_index,\n   aes(\n     x=as.factor(year), \n     y=value, \n     colour=geography,\n     group=geography,\n     linetype=lty$lty))+\n       geom_line(size=.65) + \n       scale_colour_manual(values=manyColors(35)) +\n     geom_point(size=2.5) +\n     opts(title=\"growth\")+\n     xlab(\"Year\") + \n     ylab(paste(\"Indexed Value (Rel. to 2012\")) + \n     opts(axis.text.x=theme_text(angle=90, hjust=0))\n\nprint(g3)\n</code></pre>\n\n<p>adding</p>\n\n<pre><code>    scale_linetype_manual(\"\",values=lty$lty) +\n</code></pre>\n\n<p>after scale_color_manual instead of the linetype argument produces the chart, but lines are all the same. How, then, do I get the lines to vary for large series counts?</p>\n\n<p><img src=\"http://i.stack.imgur.com/9e5qZ.png\" alt=\"example plot\"></p>\n"},{"tags":["r","ggplot2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12504721,"title":"Connect mean points of error bars","body":"<p>In ggplot2 I'm attempting a simple thing that I just can't get for some reason.  I have adjusted means and SE in a data frame and want to plot the means, error bars and then connect the means with points.  Here's the code and the error (it does everything except connect the means with <code>geom_line</code> (working with <a href=\"http://wiki.stdout.org/rcookbook/Graphs/Plotting%20means%20and%20error%20bars%20%28ggplot2%29/\" rel=\"nofollow\">RCookbook</a>:</p>\n\n<pre><code>library(ggplot2)\n#data set\ndata1 &lt;- structure(list(group = structure(1:3, .Label = c(\"1\", \"2\", \"3\"\n), class = \"factor\"), estimate = c(55.7466654122763, 65.0480954172939, \n61.9552391704298), SE = c(2.33944612149257, 2.33243565412438, \n2.33754952927041), t.ratio = c(23.8290016171476, 27.8884844271143, \n26.5043535525714)), .Names = c(\"group\", \"estimate\", \"SE\", \"t.ratio\"\n), row.names = c(NA, 3L), class = \"data.frame\")\n\n#the attempted plot\npd &lt;- position_dodge(.1)\nggplot(data1, aes(x=group, y=estimate, group=group)) + \n    geom_errorbar(aes(ymin=estimate-SE, ymax=estimate+SE), \n        colour=\"black\", width=.1, position=pd) +\n    geom_line(data=data1, aes(x=group, y=estimate)) + \n    geom_point(position=pd, size=4)\n</code></pre>\n\n<p>the error:</p>\n\n<pre><code>ymax not defined: adjusting position using y instead\ngeom_path: Each group consist of only one observation. Do you need to adjust the group aesthetic?\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13022102,"title":"Arules Sequence Mining in R","body":"<p>I am looking to use the <code>arulesSequences</code> package in R.  However, I have no idea as to how to coerce my dataframe into an object that can leverage this package.  </p>\n\n<p>Here is a toy dataset that replicates my data structure:</p>\n\n<pre><code>ids &lt;- c(rep(\"X\", 5), rep(\"Y\", 5), rep(\"Z\", 5))\nseq &lt;- rep(1:5,3)\nval &lt;- sample(LETTERS, 15, replace=T)\ndf &lt;- data.frame(ids, seq, val)\ndf\n\n   ids seq val\n1    X   1   T\n2    X   2   H\n3    X   3   V\n4    X   4   A\n5    X   5   X\n6    Y   1   D\n7    Y   2   B\n8    Y   3   A\n9    Y   4   D\n10   Y   5   P\n11   Z   1   Q\n12   Z   2   R\n13   Z   3   W\n14   Z   4   W\n15   Z   5   P\n</code></pre>\n\n<p>Any help will be greatly appreciated.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":105,"score":9,"question_id":13022299,"title":"Specify Date format for colClasses argument in read.table/read.csv","body":"<h2>Question:</h2>\n\n<p><strong>Is there a way to specify the Date format when using the colClasses argument in read.table/read.csv?</strong></p>\n\n<p>(I realise I can convert after importing, but with many date columns like this, it would be easier to do it in the import step)</p>\n\n<hr>\n\n<h2>Example:</h2>\n\n<p>I have a .csv with date columns in the format <code>%d/%m/%Y</code>. </p>\n\n<pre><code>dataImport &lt;- read.csv(\"data.csv\", colClasses = c(\"factor\",\"factor\",\"Date\"))\n</code></pre>\n\n<p>This gets the conversion wrong. For example, <code>15/07/2008</code> becomes <code>0015-07-20</code>. </p>\n\n<hr>\n\n<h2>Reproducible code:</h2>\n\n<pre><code>data &lt;- \nstructure(list(func_loc = structure(c(1L, 2L, 3L, 3L, 3L, 3L, \n3L, 4L, 4L, 5L), .Label = c(\"3076WAG0003\", \"3076WAG0004\", \"3076WAG0007\", \n\"3076WAG0009\", \"3076WAG0010\"), class = \"factor\"), order_type = structure(c(3L, \n3L, 1L, 1L, 1L, 1L, 2L, 2L, 3L, 1L), .Label = c(\"PM01\", \"PM02\", \n\"PM03\"), class = \"factor\"), actual_finish = structure(c(4L, 6L, \n1L, 2L, 3L, 7L, 1L, 8L, 1L, 5L), .Label = c(\"\", \"11/03/2008\", \n\"14/08/2008\", \"15/07/2008\", \"17/03/2008\", \"19/01/2009\", \"22/09/2008\", \n\"6/09/2007\"), class = \"factor\")), .Names = c(\"func_loc\", \"order_type\", \n\"actual_finish\"), row.names = c(NA, 10L), class = \"data.frame\")\n\n\nwrite.csv(data,\"data.csv\", row.names = F)                                                        \n\ndataImport &lt;- read.csv(\"data.csv\")\nstr(dataImport)\ndataImport\n\ndataImport &lt;- read.csv(\"data.csv\", colClasses = c(\"factor\",\"factor\",\"Date\"))\nstr(dataImport)\ndataImport\n</code></pre>\n\n<p>And here's what the output looks like:</p>\n\n<p><img src=\"http://i.stack.imgur.com/QM1bM.png\" alt=\"code output\"></p>\n"}]}
{"total":19203,"page":11,"pagesize":100,"questions":[{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":84,"score":3,"question_id":11801511,"title":"Using Time Diary Data with TraMineR","body":"<p>I am trying to do sequence analysis using time-diary data (American Time Use Survey) using TraMineR in R. I have the data as SPELL data (id, start time, stop time, event) but I receive the following error when trying to convert it to STS or SPS data: </p>\n\n<blockquote>\n  <p>Error in as.matrix.data.frame(subset(data, , 2)) : dims [product 0] do not match the length of object [9]</p>\n</blockquote>\n\n<p>I believe it has something to do with how I convert my time (as character) to date/time types. I believe TraMineR requires an POSIXlt format?</p>\n\n<p>Here is a snippet of my raw data (trcode is the event)</p>\n\n<blockquote>\n  <p>head(atus.act.short)</p>\n</blockquote>\n\n<pre><code>     tucaseid tustarttim tustoptime trcode\n1 2.00701e+13   04:00:00   08:00:00  10101\n2 2.00701e+13   08:00:00   08:20:00 110101\n3 2.00701e+13   08:20:00   08:50:00  10201\n4 2.00701e+13   08:50:00   09:30:00  20102\n5 2.00701e+13   09:30:00   09:40:00 180201\n6 2.00701e+13   09:40:00   11:40:00  20102\n</code></pre>\n\n<p>I use strptime to convert the character strings to POSIXlt:</p>\n\n<pre><code>atus.act.short$starttime.new &lt;- strptime(atus.act.short$tustarttim, format=\"%X\")\natus.act.short$stoptime.new  &lt;- strptime(atus.act.short$tustoptime, format=\"%X\")\n</code></pre>\n\n<p>I also cut the ID down to only two digits</p>\n\n<pre><code>  atus.act.short$id &lt;- atus.act.short$tucaseid-20070101070000\n</code></pre>\n\n<p>I end up with a new data frame as follows:</p>\n\n<pre><code>   id       starttime.new        stoptime.new trcode\n1  44 2012-08-03 04:00:00 2012-08-03 08:00:00  10101\n2  44 2012-08-03 08:00:00 2012-08-03 08:20:00 110101\n3  44 2012-08-03 08:20:00 2012-08-03 08:50:00  10201\n4  44 2012-08-03 08:50:00 2012-08-03 09:30:00  20102\n5  44 2012-08-03 09:30:00 2012-08-03 09:40:00 180201\n6  44 2012-08-03 09:40:00 2012-08-03 11:40:00  20102\n7  44 2012-08-03 11:40:00 2012-08-03 11:50:00 180201\n8  44 2012-08-03 11:50:00 2012-08-03 12:05:00  20102\n9  44 2012-08-03 12:05:00 2012-08-03 13:05:00 120303\n10 44 2012-08-03 13:05:00 2012-08-03 13:20:00 180704\n11 44 2012-08-03 13:20:00 2012-08-03 15:20:00  70104\n12 44 2012-08-03 15:20:00 2012-08-03 15:35:00 180704\n13 44 2012-08-03 15:35:00 2012-08-03 17:00:00 120303\n14 44 2012-08-03 17:00:00 2012-08-03 17:20:00 180701\n15 44 2012-08-03 17:20:00 2012-08-03 17:25:00 180701\n16 44 2012-08-03 17:25:00 2012-08-03 17:55:00  70101\n17 44 2012-08-03 17:55:00 2012-08-03 18:00:00 181203\n18 44 2012-08-03 18:00:00 2012-08-03 19:00:00 120303\n19 44 2012-08-03 19:00:00 2012-08-03 19:30:00 110101\n20 44 2012-08-03 19:30:00 2012-08-03 21:30:00 120303\n21 44 2012-08-03 21:30:00 2012-08-03 23:00:00  10101\n22 44 2012-08-03 23:00:00 2012-08-03 23:03:00  10201\n26 48 2012-08-03 06:45:00 2012-08-03 08:15:00  10201\n27 48 2012-08-03 08:15:00 2012-08-03 08:45:00 180209\n28 48 2012-08-03 08:45:00 2012-08-03 09:00:00  20902\n29 48 2012-08-03 09:00:00 2012-08-03 11:00:00  50101\n30 48 2012-08-03 11:00:00 2012-08-03 11:45:00 120312\n</code></pre>\n\n<p>Then I try to create a sequence object [using library(TraMineR)]</p>\n\n<pre><code>atus.seq &lt;- seqdef(atus.act.short, informat = \"SPELL\", id=\"id\")\n</code></pre>\n\n<p>And I get the following error:</p>\n\n<blockquote>\n  <p>Error in as.matrix.data.frame(subset(data, , 2)) : dims [product 0] do not match the length of object [9]</p>\n</blockquote>\n\n<p>Thoughts?</p>\n"},{"tags":["r","time-series","data.table"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":64,"score":4,"question_id":13021401,"title":"lagging panel data with data.table","body":"<p>I currently lag panel data using <code>data.table</code> in the following manner:</p>\n\n<pre><code>require(data.table)\nx &lt;- data.table(id=1:10, t=rep(1:10, each=10), v=1:100)\nsetkey(x, id, t) #so that things are in increasing order\nx[,lag_v:=c(NA, v[1:(length(v)-1)]),by=id]\n</code></pre>\n\n<p>I am wondering if there is a better way to do this?  I had found something online about cross-join, which makes sense.  However, a cross-join would generate a fairly large <code>data.table</code> for a large dataset so I am hesitant to use it.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":4,"view_count":39,"score":-4,"question_id":13021940,"title":"How to update data from one table to another in R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/9812679/populate-a-new-column-in-a-dataframe-with-a-lookup-from-a-double-matrix\">Populate a new column in a dataframe with a lookup from a double matrix</a><br>\n  <a href=\"http://stackoverflow.com/questions/13007078/partial-merge-in-r\">Partial merge in R</a>  </p>\n</blockquote>\n\n\n\n<p>I have 2 files: </p>\n\n<pre><code>Table1.csv:\n**City**           **County**\nLos Angeles        LA \nSan Francisco      SF \nNew York           NY\nNew Jersey         NJ \n\nTable2.csv:\n**City**          **County**\nSan Francisco\nSan Francisco\nLos Angeles\nNew York\nNew York\nNew Jersey\n</code></pre>\n\n<p>I want to update Table2 with county info from Table1.</p>\n\n<p>How do I write it using R language?</p>\n\n<p>Thank you for help</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":73,"score":3,"question_id":13007078,"title":"Partial merge in R","body":"<p>Before I end up at -7 like <a href=\"http://stackoverflow.com/questions/12123013/two-by-two-matching-between-dataframes-in-r\">Two by two matching between dataframes in r</a> did, let me say I've already read the following pages:</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/10013985/how-to-copy-row-from-one-data-frame-in-to-another-r\">How to copy row from one data.frame in to another [R]</a></li>\n<li><a href=\"http://stackoverflow.com/questions/12427043/r-how-to-update-a-column-in-data-frame-using-values-from-another-data-frame\">R How to update a column in data.frame using values from another data.frame</a></li>\n<li><a href=\"http://stackoverflow.com/questions/7971513/using-one-data-frame-to-update-another?rq=1\">Using one data.frame to update another</a></li>\n</ul>\n\n<p>Actually, the last one is really similar to what I want, but not the same, because my columns are different</p>\n\n<p>I have two dataframes, let's say:</p>\n\n<pre><code>&gt; d &lt;- data.frame(year=c(2004,2004,2006),month = c(1,5,3), height = c(1000,2000,3000) )\n&gt; d\n  year month height\n1 2004     1   1000\n2 2004     5   2000\n3 2006     3   3000\n\n&gt; e &lt;- data.frame(year=c(2004),month=c(5), height = c(9999))\n&gt; e\n  year month height\n1 2004     5   9999\n</code></pre>\n\n<p>Obviously the real data is longer than this.</p>\n\n<p>I want to merge the values from e into d</p>\n\n<p>Try raw merge:</p>\n\n<pre><code>&gt; merge(d,e)\n[1] year   month  height\n&lt;0 rows&gt; (or 0-length row.names)\n</code></pre>\n\n<p>Ok.  So add \"by\":</p>\n\n<pre><code>&gt; merge(d,e,by=c(\"year\",\"month\"))\n  year month height.x height.y\n1 2004     5     2000     9999\n</code></pre>\n\n<p>Ok, it did an inner join, and got rid of all the original data in d.  So try left outer join:</p>\n\n<pre><code>&gt; merge(d,e,by=c(\"year\",\"month\"),all.x = T)\n  year month height.x height.y\n1 2004     1     1000       NA\n2 2004     5     2000     9999\n3 2006     3     3000       NA\n</code></pre>\n\n<p>It did a join, and it's correct as per outer-join definition, but it didn't do what I want, which is to update the values in d from the values in e.  What I really want is more like an sql update:</p>\n\n<pre><code>for (year,month,height) in e:\n    update d set d.height=e.height where d.year = e.year and d.month = e.month\n</code></pre>\n\n<p>ie the results I want would be:</p>\n\n<pre><code>&gt; magic(d,e)\n  year month height\n1 2004     1   1000\n2 2004     5   9999\n3 2006     3   3000\n</code></pre>\n\n<p>Of course, I could just write a bunch of <code>for</code> loops, but I'm hoping there is some vectorized way of doing this?</p>\n\n<p>Edit: my example had only one key column, but my real problem has two.  Updated the example to reflect this.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":12988472,"title":"which strings are not repeated in other data frame in R?","body":"<p>I have two dataframes, looking sort of like: </p>\n\n<pre><code>Source_name &lt;- c(\"name1\", \"name2\", \"name3\", \"name4\", \"name5\")\nTarget_name &lt;- c(\"name10\", \"name11\", \"name12\", \"name13\", \"name14\")\nvalues &lt;- c(\"asd\", \"213\", \"kahsd\", \"a9u\", \"oau92\")\nvalues2 &lt;- c(\"asdd\", \"oau892\", \"kahsd\", \"213\", \"213\")\ndat &lt;- cbind(Source_name, values)\ndaf &lt;- cbind(Target_name, values2)\n\ndat\nSource_name     values \n[1,] \"name1\"     \"asd\"  \n[2,] \"name2\"     \"213\"  \n[3,] \"name3\"     \"kahsd\"\n[4,] \"name4\"     \"a9u\"  \n[5,] \"name5\"     \"oau92\"\n\ndaf\nTarget_name     values2  \n[1,] \"name10\"    \"asdd\"   \n[2,] \"name11\"    \"oau892\"  \n[3,] \"name12\"    \"kahsd\"\n[4,] \"name13\"    \"213\"   \n[5,] \"name14\"    \"213\"    \n</code></pre>\n\n<p>Each value only occurs once in dat, but may occur more than once in daf (or not at all). I would like to record those values in dat that occur at most once in daf, as per the desired_output data.frame. </p>\n\n<pre><code>unique_values &lt;- c( \"asd\", \"kahsd\", \"a9u\", \"oau92\")\nSource_name &lt;- c( \"name1\", \"name3\", \"name4\", \"name5\")\nTarget_name &lt;- c( \"NA\", \"name12\", \"NA\", \"NA\")\ndesired_output &lt;- data.frame(cbind(unique_values, Source_name, Target_name))\n\ndesired_output\n     unique_values    Source_name Target_name   \n 1         asd         name1       \n 3         kahsd       name3       name12   \n 2         a9u         name4    \n 4         oau92       name5   \n</code></pre>\n\n<p>I imagine there's an easy way to do this using apply or something, but Im stumped. </p>\n"},{"tags":["regex","r","list","gsub"],"answer_count":3,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":111,"score":6,"question_id":13009761,"title":"Proper use of gsub / regular expressions in R?","body":"<p>I have long lists of strings such as this machine readable example:  </p>\n\n<pre><code>A &lt;- list(c(\"Biology\",\"Cell Biology\",\"Art\",\"Humanities, Multidisciplinary; Psychology, Experimental\",\"Astronomy &amp; Astrophysics; Physics, Particles &amp; Fields\",\"Economics; Mathematics, Interdisciplinary Applications; Social Sciences, Mathematical Methods\",\"Geriatrics &amp; Gerontology\",\"Gerontology\",\"Management\",\"Operations Research &amp; Management Science\",\"Computer Science, Artificial Intelligence; Computer Science, Information Systems; Engineering, Electrical &amp; Electronic\",\"Economics; Mathematics, Interdisciplinary Applications; Social Sciences, Mathematical Methods; Statistics &amp; Probability\"))  \n</code></pre>\n\n<p>So it looks like this:  </p>\n\n<pre><code>&gt; A  \n[[1]]  \n [1] \"Biology\"  \n [2] \"Cell Biology\"  \n [3] \"Art\"  \n [4] \"Humanities, Multidisciplinary; Psychology, Experimental\"  \n [5] \"Astronomy &amp; Astrophysics; Physics, Particles &amp; Fields\"  \n [6] \"Economics; Mathematics, Interdisciplinary Applications; Social Sciences, Mathematical Methods\"  \n [7] \"Geriatrics &amp; Gerontology\"  \n [8] \"Gerontology\"  \n [9] \"Management\"  \n[10] \"Operations Research &amp; Management Science\"  \n[11] \"Computer Science, Artificial Intelligence; Computer Science, Information Systems; Engineering, Electrical &amp; Electronic\"  \n[12] \"Economics; Mathematics, Interdisciplinary Applications; Social Sciences, Mathematical Methods; Statistics &amp; Probability\"  \n</code></pre>\n\n<p>I would like to edit these terms and eliminate duplicates in order to get this result:  </p>\n\n<pre><code> [1] \"Science\"  \n [2] \"Science\"  \n [3] \"Arts &amp; Humanities\"  \n [4] \"Arts &amp; Humanities; Social Sciences\"  \n [5] \"Science\"  \n [6] \"Social Sciences; Science\"  \n [7] \"Science\"  \n [8] \"Social Sciences\"  \n [9] \"Social Sciences\"  \n[10] \"Science\"  \n[11] \"Science\"  \n[12] \"Social Sciences; Science\"  \n</code></pre>\n\n<p>So far I only got this:  </p>\n\n<pre><code>stringedit &lt;- function(A)  \n{  \n  A &lt;-gsub(\"Biology\", \"Science\", A)  \n  A &lt;-gsub(\"Cell Biology\", \"Science\", A)  \n  A &lt;-gsub(\"Art\", \"Arts &amp; Humanities\", A)  \n  A &lt;-gsub(\"Humanities, Multidisciplinary\", \"Arts &amp; Humanities\", A)  \n  A &lt;-gsub(\"Psychology, Experimental\", \"Social Sciences\", A)  \n  A &lt;-gsub(\"Astronomy &amp; Astrophysics\", \"Science\", A)  \n  A &lt;-gsub(\"Physics, Particles &amp; Fields\", \"Science\", A)  \n  A &lt;-gsub(\"Economics\", \"Social Sciences\", A)  \n  A &lt;-gsub(\"Mathematics\", \"Science\", A)  \n  A &lt;-gsub(\"Mathematics, Applied\", \"Science\", A)  \n  A &lt;-gsub(\"Mathematics, Interdisciplinary Applications\", \"Science\", A)  \n  A &lt;-gsub(\"Social Sciences, Mathematical Methods\", \"Social Sciences\", A)  \n  A &lt;-gsub(\"Geriatrics &amp; Gerontology\", \"Science\", A)  \n  A &lt;-gsub(\"Gerontology\", \"Social Sciences\", A)  \n  A &lt;-gsub(\"Management\", \"Social Sciences\", A)  \n  A &lt;-gsub(\"Operations Research &amp; Management Science\", \"Science\", A)  \n  A &lt;-gsub(\"Computer Science, Artificial Intelligence\", \"Science\", A)  \n  A &lt;-gsub(\"Computer Science, Information Systems\", \"Science\", A)  \n  A &lt;-gsub(\"Engineering, Electrical &amp; Electronic\", \"Science\", A)  \n  A &lt;-gsub(\"Statistics &amp; Probability\", \"Science\", A)  \n}  \nB &lt;- lapply(A, stringedit)  \n</code></pre>\n\n<p>But it does not work properly:  </p>\n\n<pre><code>&gt; B  \n[[1]]  \n [1] \"Science\"  \n [2] \"Cell Science\"  \n [3] \"Arts &amp; Humanities\"  \n [4] \"Arts &amp; Humanities; Social Sciences\"  \n [5] \"Science; Science\"  \n [6] \"Social Sciences; Science, Interdisciplinary Applications; Social Sciences\"  \n [7] \"Science\"  \n [8] \"Social Sciences\"  \n [9] \"Social Sciences\"  \n[10] \"Operations Research &amp; Social Sciences Science\"  \n[11] \"Computer Science, Arts &amp; Humanitiesificial Intelligence; Science; Science\"  \n[12] \"Social Sciences; Science, Interdisciplinary Applications; Social Sciences; Science\"  \n</code></pre>\n\n<p>How can I achieve the correct output mentioned above?<br>\nThank you very much in advance for your consideration!  </p>\n"},{"tags":["r","gridlayout","grid-layout"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":12982270,"title":"grid: How to force sizes of grid.layout when unit is \"npc\" instead of \"inch\"?","body":"<p>Why are the sizes (for the regions (2,2), (2,4), (4,2), (4,4)) in the following plot not respected by <code>grid.rect()</code>? In other words, why do the the drawn rectangles not perfectly match these regions? With the units being \"inch\", this works (but I would like to use \"relative\" coordinates).</p>\n\n<pre><code>require(grid)\n\ninch &lt;- FALSE # TRUE\n\nd &lt;- if(inch) 5 else 1\npspc &lt;- d*c(0.3, 0.3) # width, height of panels\nspc &lt;- d*c(0.05, 0.05) # width, height of space\naxlabspc &lt;- d*c(0.1, 0.1) # width y label, height x label\nlabspc &lt;- d*c(0.05, 0.05) # width label boxes, height label boxes\n\npar. &lt;- par(no.readonly=TRUE)\ngl &lt;- grid.layout(5, 5, default.units=if(inch) \"inches\" else \"npc\",\n                  widths=c(axlabspc[1], pspc[1], spc[1], pspc[1], labspc[1]),\n                  heights=c(labspc[2], pspc[2], spc[2], pspc[2], axlabspc[2]))\ngrid.show.layout(gl)\npushViewport(viewport(layout=gl))\nfor(i in 1:2) {\n    for(j in 1:2) {\n        pushViewport(viewport(layout.pos.row=2*i, layout.pos.col=2*j, name=\"foo\"))\n        grid.rect()\n        upViewport()\n    }\n}\npar(par.)\n</code></pre>\n"},{"tags":["string","r","paste"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":60,"score":3,"question_id":13020591,"title":"How to paste two vectors together and pad at the end?","body":"<p>I would like to <code>paste</code> two character strings together and pad at the end with another character to make the combination a certain length.  I was wondering if there was an option to <code>paste</code> that one can pass or another trick that I am missing? I can do this in multiple lines by figuring out the length of each and then calling <code>paste</code> with <code>rep(my_pad_character,N)</code> but I would like to do this in one line.</p>\n\n<p>Ex: pad together <code>\"hi\"</code>, and <code>\"hello\"</code> and pad with an <code>\"a\"</code> to make the sequence length 10. the result would be <code>\"hihelloaaa\"</code></p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":67,"score":3,"question_id":12984991,"title":"Stop lapply from printing to console","body":"<p>When I use <code>lapply</code> and print to the console it prints unwanted <code>[[i]]NULL</code> though I want the intended message to print to the console.  I've tried <code>suppressWarnings</code> and <code>suppressMessages</code> but these do not remove the unwanted offender.  I searched <code>lapply</code> and don't see an argument to silence it.  This is more aesthetic as it doesn't interfere with the function.  I'm not opposed to allternative printing to the console so long as the user can turn it off if they wish.</p>\n\n<p>Here's an example function, the output and what I'd like to get: </p>\n\n<p><strong>Sample function:</strong></p>\n\n<pre><code>FUN &lt;- function(x) {\n    FUN2 &lt;- function(z) message(z)\n    lapply(1:3, function(i) FUN2(paste(x, i)))\n}\n\nFUN(\"hello\")\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>hello 1\nhello 2\nhello 3\n[[1]]\nNULL\n\n[[2]]\nNULL\n\n[[3]]\nNULL\n</code></pre>\n\n<p><strong>Desired Output:</strong></p>\n\n<pre><code>hello 1\nhello 2\nhello 3\n</code></pre>\n"},{"tags":["r","circle"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":74,"score":4,"question_id":13015110,"title":"Color a designated area?","body":"<p>I am trying to figure out if there is a way to color only half of a circle that I created using grid.circle.</p>\n\n<pre><code>    library(grid)\n    grid.circle(x=.5, y=.5, r=.25,gp=gpar(lwd=10))\n</code></pre>\n\n<p>I want to make the top half blue, and the bottom half leave white.</p>\n\n<p>Thank you for your help!</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":3797,"score":5,"question_id":1395147,"title":"Best way to plot interaction effects from a linear model","body":"<p>In an effort to help populate the R tag here, I am posting a few questions I have often received from students. I have developed my own answers to these over the years, but perhaps there are better ways floating around that I don't know about.</p>\n\n<p>The question: I just ran a regression with continuous y and x but factor f (where levels(f) produces c(\"level1\",\"level2\"))</p>\n\n<pre><code> thelm&lt;-lm(y~x*f,data=thedata)\n</code></pre>\n\n<p>Now I would like to plot the predicted values of y by x broken down by groups defined by f. All of the plots I get are ugly and show too many lines.</p>\n\n<p>My answer: Try the predict() function.</p>\n\n<pre><code>##restrict prediction to the valid data \n##from the model by using thelm$model rather than thedata\n\n thedata$yhat&lt;-predict(thelm,newdata=expand.grid(x=range(thelm$model$x),\n                                                 f=levels(thelm$model$f)))\n\n plot(yhat~x,data=thethedata,subset=f==\"level1\")\n lines(yhat~x,data=thedata,subset=f==\"level2\")\n</code></pre>\n\n<p>Are there other ideas out there that are (1) easier to understand for a newcomer and/or (2) better from some other perspective?</p>\n\n<p>Best,</p>\n\n<p>Jake</p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":13018173,"title":"elementwise combination of two lists in R","body":"<p>Say, I have two lists:</p>\n\n<pre><code>list.a &lt;- as.list(c(\"a\", \"b\", \"c\"))\n\nlist.b &lt;- as.list(c(\"d\", \"e\", \"f\"))\n</code></pre>\n\n<p>I would like to combine these lists recursively, such that the result would be a list of combined elements as a vector like the following:</p>\n\n<pre><code>[[1]]\n[1] a d\n\n[[2]]\n[1] a e\n\n[[3]]\n[1] a f\n\n[[4]]\n[1] b d\n</code></pre>\n\n<p>and so on. I feel like I'm missing something relatively simple here. Any help?</p>\n\n<p>Cheers.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":52,"score":-1,"question_id":13018325,"title":"Using lapply with an equation","body":"<p>I have two datasets:</p>\n\n<p>1) a dataset of temperature record (O77), and<br>\n2) a dataset of some precise (time) points of the preceding dataset I want to look at (enrO77) </p>\n\n<p>Into the temperature record, I can detect some drops and using another script I detected two important points for every drop: Time at the beginning of the drop (tA) and time at the end of the drop (tB) that I reported in the second dataset (enrO77). I want to isolate those drops and calculate the area under the curve for every drop.</p>\n\n<p>So, here is what I tried, attempting to put all the individual drops within a list</p>\n\n<pre><code>ind.tA &lt;- unique(enrO77$tA)\nind.tC &lt;- unique(enrO77$tC)\nind.list&lt;-lapply(1:length(ind.tA), function(i){subset(O77, O77$V1&gt;=ind.tA[i] &amp; O77$V1&lt;=ind.tC[i])})\n</code></pre>\n\n<p>Now I would like to calculate the area under the curve of these drops which can be estimated using the equation AUC = sum(diff(x)*(y[-1]+y[-length(y)]))/2:</p>\n\n<pre><code> AUC &lt;- sum(diff(ind.list[[1]]$time)*(ind.list[[1]]$temperature[-1]+ind.list[[1]]$temperature[-length(ind.list[[1]]$temperature)]))/2\n</code></pre>\n\n<p>but I would like to apply this equation to all the drops within the list at a time. Does anyone have an idea how to write that?</p>\n\n<p>Thank you!</p>\n"},{"tags":["r","optimization","multiple"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13018520,"title":"Searching for the right optimizer in R","body":"<p>Am looking for the right optimizer in R which maximizes <code>F(X)</code> subject to multiple constraints <code>G1(X)=0</code>, <code>G2(X)=0</code>, <code>G3(X)=0</code>, <code>G4(X)=0</code>, where <code>G1(X)</code> is non-linear while <code>F(X</code>), <code>G2(X)</code>, <code>G3(X)</code>, <code>G4(X)</code> are all linear...   <code>X</code> will have dimensionality of about 5-10..</p>\n"},{"tags":["r","random-forest"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":77,"score":2,"question_id":13016772,"title":"Increasing the size of the sample data - R","body":"<p>One of my colleagues indicated that <code>randomForest()</code> does not perform well with very large data sets. Now, I am just trying to figure out if that really is the case, but since the data set cannot be shared (sensitive information), I thought I might as well try to come up with a large data set. I have tried following, but cannot make sense of the error message:</p>\n\n<pre><code>library(randomForest)\ndata(iris)\ndataFile &lt;- iris\nnewdataFile &lt;- dataFile[sample(dataFile, size= 1:1000000000, replace=T),]\n</code></pre>\n\n<p>Error message:</p>\n\n<pre><code>Error in xj[i] : invalid subscript type 'list'\n</code></pre>\n\n<p>Can anyone please guide me here ?</p>\n"},{"tags":["r","dataset","bioinformatics","dna-sequence"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":361,"score":0,"question_id":2428645,"title":"How (and where) to get aligned tRNA sequences (and import it into R)","body":"<p>I wish (for my thesis work), to import tRNA data into R and have it aligned.</p>\n\n<p>My questions are:</p>\n\n<ol>\n<li>What resources can I use for the data?</li>\n<li>What commands might help me with the import/alignment?</li>\n</ol>\n\n<p>So far, I found two nice repositories that holds such data:</p>\n\n<ul>\n<li><a href=\"http://trnadb.bioinf.uni-leipzig.de/Search\" rel=\"nofollow\"><strong>tRNAdb at the University of Leipzig</strong></a></li>\n<li><a href=\"http://gtrnadb.ucsc.edu/download.html\" rel=\"nofollow\"><strong>Genomic tRNA database at UCSC</strong></a></li>\n</ul>\n\n<p>And also the <em>readFASTA</em> command of the <a href=\"http://www.bioconductor.org/packages/2.2/bioc/html/Biostrings.html\" rel=\"nofollow\">Biostrings R Package</a>, that does basic importing of the data into R.</p>\n\n<p>My problem still remains with how to handle the alignment of the tRNA.</p>\n\n<p>Since I am not from the field, I might be missing a very basic answer (like where I should download the data from, or what command to use).\nIf you might be willing to advice me, that would be most helpful.</p>\n"},{"tags":["r","bioinformatics"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13019984,"title":"Using genefilter on miRNA expression data","body":"<p>I am using genefilter as a step 1 to do differential expression analysis on R.</p>\n\n<p>I am using the <code>pOverA</code> function as well as setting a filterfunction before using <code>genefilter()</code> (I have looked at the tutorials on Bioconductor).</p>\n\n<p>My miRNA Expression data has no <code>NA</code>s or <code>NaN</code>s. It consists of normalized, log data and has <code>0</code> values sprinkled in-between.</p>\n\n<p>I create an eset of the expression data and then:</p>\n\n<pre><code>ff1&lt;-pOverA(0.2,-3.2,na.rm=TRUE)\nff2&lt;-function(x) IQR(x) &gt; 0.2\nff&lt;-filterfun(ff1,ff2)\n</code></pre>\n\n<p>I now run <code>genefilter( exprs(miREset), ff)</code> and get an error message:</p>\n\n<blockquote>\n  <p>Error in quantile.default(as.numeric(x), c(0.25, 0.75), na.rm = na.rm,\n  :    missing values and NaN's not allowed if 'na.rm' is FALSE In\n  addition: Warning message: In quantile(as.numeric(x), c(0.25, 0.75),\n  na.rm = na.rm, names = FALSE,  :   NAs introduced by coercion</p>\n</blockquote>\n\n<p>I have spent a lot of time trying to understand why this is happening. I am fairly new to R.</p>\n"},{"tags":["r","data.table"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":80,"score":5,"question_id":13017521,"title":"Remove a range in data.table","body":"<p>I am trying to exclude some rows from a datatable based on, let's say, days and month - excluding for example summer holidays, that always begin for example 15th of June and end the 15th of next month. I can extract those days based on Date, but as as.Date function is awfully slow to operate with, I have separate integer columns for Month and Day and I want to do it using only them.</p>\n\n<p>It is easy to select the given entries by</p>\n\n<pre><code>DT[Month==6][Day&gt;=15]\nDT[Month==7][Day&lt;=15]\n</code></pre>\n\n<p>Is there any way how to make \"difference\" of the two <code>data.tables</code> (the original ones and the ones I selected). (Why not subset? Maybe I am missing something simple, but I don't want to exclude days like 10/6, 31/7.)</p>\n\n<p>I am aware of a way to do it with join, but only day by day</p>\n\n<pre><code>setkey(DT, Month, Day)\nDT[-DT[J(Month,Day), which= TRUE]]\n</code></pre>\n\n<p>Can anyone help how to solve it in more general way?</p>\n"},{"tags":["r","web-scraping"],"answer_count":3,"favorite_count":12,"up_vote_count":6,"down_vote_count":0,"view_count":2263,"score":6,"question_id":2443127,"title":"How can I use R (Rcurl/XML packages ?!) to scrape this webpage?","body":"<p>I have a (somewhat complex) web scraping challenge that I wish to accomplish and would love for some direction (to whatever level you feel like sharing) here goes:</p>\n\n<p>I would like to go through all the \"species pages\" present in this link:</p>\n\n<p><a href=\"http://gtrnadb.ucsc.edu/\" rel=\"nofollow\">http://gtrnadb.ucsc.edu/</a></p>\n\n<p>So for each of them I will go to:</p>\n\n<ol>\n<li>The species page link (for example: <a href=\"http://gtrnadb.ucsc.edu/Aero_pern/\" rel=\"nofollow\">http://gtrnadb.ucsc.edu/Aero_pern/</a>)</li>\n<li>And then to the \"Secondary Structures\" page link (for example: <a href=\"http://gtrnadb.ucsc.edu/Aero_pern/Aero_pern-structs.html\" rel=\"nofollow\">http://gtrnadb.ucsc.edu/Aero_pern/Aero_pern-structs.html</a>)</li>\n</ol>\n\n<p>Inside that link I wish to scrap the data in the page so that I will have a long list containing this data (for example):</p>\n\n<pre><code>chr.trna3 (1-77)    Length: 77 bp\nType: Ala   Anticodon: CGC at 35-37 (35-37) Score: 93.45\nSeq: GGGCCGGTAGCTCAGCCtGGAAGAGCGCCGCCCTCGCACGGCGGAGGcCCCGGGTTCAAATCCCGGCCGGTCCACCA\nStr: &gt;&gt;&gt;&gt;&gt;&gt;&gt;..&gt;&gt;&gt;&gt;.........&lt;&lt;&lt;&lt;.&gt;&gt;&gt;&gt;&gt;.......&lt;&lt;&lt;&lt;&lt;.....&gt;&gt;&gt;&gt;&gt;.......&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;....\n</code></pre>\n\n<p>Where each line will have it's own list (inside the list for each \"trna\" inside the list for each animal)</p>\n\n<p>I remember coming across the packages Rcurl and XML (in R) that can allow for such a task.  But I don't know how to use them.  So what I would love to have is:\n1. Some suggestion on how to build such a code.\n2. And recommendation for how to learn the knowledge needed for performing such a task.</p>\n\n<p>Thanks for any help,</p>\n\n<p>Tal</p>\n"},{"tags":["c++","xcode","r","compiler","stan"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":141,"score":1,"question_id":12755180,"title":"Error in compiling when installing Stan for R and when using Rcpp","body":"<p>I need to install Rstan for a data analysis class. The instructions are posted here <a href=\"http://code.google.com/p/stan/wiki/RStanGettingStarted\" rel=\"nofollow\">http://code.google.com/p/stan/wiki/RStanGettingStarted</a>. I'm running Mac OS 10.5.8 and R 2.15.1 GUI 1.52 Leopard build 32-bit (6188). I just installed Xcode version 3.1.4, the Xcode c++ compiler that is compatible with leopard (I had to get a mac developer account to do this). </p>\n\n<p>Per the Stan installation instruction, I entered the following code to see if my compiler was working:</p>\n\n<pre><code>library(inline) \nlibrary(Rcpp)\nsrc &lt;- ' \n  std::vector&lt;std::string&gt; s; \n  s.push_back(\"hello\");\n  s.push_back(\"world\");\n  return Rcpp::wrap(s);\n'\nhellofun &lt;- cxxfunction(body = src, includes = '', plugin = 'Rcpp', verbose = FALSE)\ncat(hellofun(), '\\n') \n</code></pre>\n\n<p>It returns the following error: </p>\n\n<pre><code>Error in compileCode(f, code, language = language, verbose = verbose) :\nCompilation ERROR, function(s)/method(s) not created! \nLibrary/Frameworks/R.framework/Versions/2.15/Resources/library/\nRcpp/include/Rcpp/internal/export.h: In function ‘void\nRcpp::internal::export_range__dispatch(SEXPREC*, InputIterator,\nRcpp::traits::r_type_primitive_tag)’:\n/Library/Frameworks/R.framework/Versions/2.15/Resources/\nlibrary/Rcpp/include/Rcpp/internal/export.h:56: internal\ncompiler error: Bus error\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nSee &lt;URL:http://developer.apple.com/bugreporter&gt; for\ninstructions.\nmake: *** [file795214e66510.o] Error 1\nIn addition: Warning message:\nrunning command '/Library/Frameworks/R.framework/Resources/bin/\nR CMD SHLIB file795214e66510.cpp 2&gt;\nfile795214e66510.cpp.err.txt' had status 1\n</code></pre>\n\n<p>When I try to install stan:</p>\n\n<pre><code> install.packages('rstan', type = 'source') ] \n</code></pre>\n\n<p>I get this warning:\n    Warning message:\n    In install.packages(\"rstan\", type = \"source\") :\n      installation of package ‘rstan’ had non-zero exit status</p>\n\n<p>I have no idea how C++ works. All of my coding experience is in R and has not before required compiling into C++. I've been trying really hard to figure out what's wrong for the last 4 hours or so, googling these error messages over and over without much luck. Any help would be greatly appreciated and would also help about 10 other students in my class who are having identical or analogous problems. Thank you very, very much.  </p>\n"},{"tags":["r","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":48,"score":-1,"question_id":13019567,"title":"what kind of files is suitable to be read in R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6099243/read-an-excel-file-directly-from-a-r-script\">Read an Excel file directly from a R script</a>  </p>\n</blockquote>\n\n\n\n<p>I made an Excel file, I named it <code>test.xlsx</code>. I wanted to read the file in R.  </p>\n\n<pre><code>date    price  \n1   34  \n2   34.5  \n3   34  \n4   34  \n5   35  \n6   34.5  \n7   36  \n</code></pre>\n\n<p>Now, when I used  </p>\n\n<pre><code>x = read.csv(\"test.xlsx\")  \n</code></pre>\n\n<p>didn't work. Also I used  </p>\n\n<pre><code>x = read.table(\"test.xlsx\")\n</code></pre>\n\n<p>I got the warning</p>\n\n<pre><code>Warning message:\nIn read.table(\"test.xlsx\") :\n  incomplete final line found by readTableHeader on 'test.xlsx'  \n</code></pre>\n\n<p>and the result:</p>\n\n<pre><code> V1\n1                         PK\\003\\004\\024\n2 PˆTز\\005›DQ4ï½ùfىé|[™d\\003\\001µ³9\\033g\n</code></pre>\n\n<p>So, do I need to make a special file in order to read it in R?</p>\n"},{"tags":["excel","r","r-faq"],"answer_count":5,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":3378,"score":6,"question_id":6099243,"title":"Read an Excel file directly from a R script","body":"<p>How can I read an Excel file directly into R? Or should I first export the data to a text- or CSV file and import that file into R?</p>\n"},{"tags":["r","bioconductor"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13012210,"title":"Find transcription start sites with biomaRt","body":"<p>I am using <code>biomaRt</code> in R to query ensembl's <code>hsapiens</code> database of human genes. I am using the function <code>getBM</code> to get all genes' name, start position and stop position, but I cannot find the right attribute for retrieving the TSS (transcription start site). Is it maybe because it is considered the same as the <code>seqType= c(\"3utr\", \"5utr\")</code>?</p>\n"},{"tags":["r"],"answer_count":7,"favorite_count":6,"up_vote_count":13,"down_vote_count":0,"view_count":361,"score":13,"question_id":6216968,"title":"R force local scope","body":"<p>This is probably not correct terminology, but hopefully I can get my point across.</p>\n\n<p>I frequently end up doing something like:</p>\n\n<pre><code>myVar = 1\nf &lt;- function(myvar) { return(myVar); }\n# f(2) = 1 now\n</code></pre>\n\n<p>R happily uses the variable outside of the function's scope, which leaves me scratching my head, wondering how I could possibly be getting the results I am.</p>\n\n<p>Is there any option which says \"force me to only use variables which have previously been assigned values in this function's scope\"? Perl's <code>use strict</code> does something like this, for example. But I don't know that R has an equivalent of <code>my</code>. </p>\n\n<hr>\n\n<p>EDIT: Thank you, I am aware of that I capitalized them differently. Indeed, the example was created specifically to illustrate this problem!</p>\n\n<p>I want to know if there is a way that R can automatically warn me when I do this.</p>\n\n<p>EDIT 2: Also, if Rkward or another IDE offers this functionality I'd like to know that too.</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":13006909,"title":"Export a list of matrices nicely to the same worksheet in Excel","body":"<p>I have a list of 4 matrices. The first two of them: </p>\n\n<pre><code>$`1857-1903`\n                      Bank.o.kassa Obligationer       Lån    Aktier Placeringar.andra.ftg Fodringar Reala.tillgångar Övriga.tillgångar\nBank.o.kassa             1.0000000    0.8014382 0.8079718 0.4421687                    NA 0.8395201        0.9144023         0.7995480\nObligationer             0.8014382    1.0000000 0.8422192 0.4590398                    NA 0.7871074        0.8815054         0.7003110\nLån                      0.8079718    0.8422192 1.0000000 0.5476716                    NA 0.8932723        0.9295665         0.7846206\nAktier                   0.4421687    0.4590398 0.5476716 1.0000000                    NA 0.7203681        0.4221815         0.6281095\nPlaceringar.andra.ftg           NA           NA        NA        NA                     1        NA               NA                NA\nFodringar                0.8395201    0.7871074 0.8932723 0.7203681                    NA 1.0000000        0.8869905         0.9395209\nReala.tillgångar         0.9144023    0.8815054 0.9295665 0.4221815                    NA 0.8869905        1.0000000         0.8158413\nÖvriga.tillgångar        0.7995480    0.7003110 0.7846206 0.6281095                    NA 0.9395209        0.8158413         1.0000000\nKapitalinkomster         0.9163688    0.8960790 0.9318508 0.4985449                    NA 0.9277740        0.9821501         0.8755644\n                      Kapitalinkomster\nBank.o.kassa                 0.9163688\nObligationer                 0.8960790\nLån                          0.9318508\nAktier                       0.4985449\nPlaceringar.andra.ftg               NA\nFodringar                    0.9277740\nReala.tillgångar             0.9821501\nÖvriga.tillgångar            0.8755644\nKapitalinkomster             1.0000000\n\n$`1904-1948`\n                      Bank.o.kassa Obligationer         Lån       Aktier Placeringar.andra.ftg   Fodringar Reala.tillgångar Övriga.tillgångar\nBank.o.kassa             1.0000000   -0.5636371  0.12902979 -0.658883574          -0.202688601  0.76474140       0.81544129         0.4642105\nObligationer            -0.5636371    1.0000000  0.23820065  0.369712399           0.649156560 -0.69097442      -0.67090178        -0.3108845\nLån                      0.1290298    0.2382006  1.00000000 -0.301682319           0.663984986 -0.07873989       0.00901089         0.2894697\nAktier                  -0.6588836    0.3697124 -0.30168232  1.000000000          -0.005049947 -0.69634496      -0.77966741        -0.7496402\nPlaceringar.andra.ftg   -0.2026886    0.6491566  0.66398499 -0.005049947           1.000000000 -0.44833419      -0.31431360         0.1089602\nFodringar                0.7647414   -0.6909744 -0.07873989 -0.696344963          -0.448334185  1.00000000       0.84590718         0.5765548\nReala.tillgångar         0.8154413   -0.6709018  0.00901089 -0.779667406          -0.314313596  0.84590718       1.00000000         0.5367746\nÖvriga.tillgångar        0.4642105   -0.3108845  0.28946968 -0.749640198           0.108960190  0.57655477       0.53677459         1.0000000\nKapitalinkomster        -0.1114329    0.3693150  0.38160001 -0.125296598           0.720230427 -0.17280772      -0.13946215         0.3720201\n                      Kapitalinkomster\nBank.o.kassa                -0.1114329\nObligationer                 0.3693150\nLån                          0.3816000\nAktier                      -0.1252966\nPlaceringar.andra.ftg        0.7202304\nFodringar                   -0.1728077\nReala.tillgångar            -0.1394622\nÖvriga.tillgångar            0.3720201\nKapitalinkomster             1.0000000\n</code></pre>\n\n<p>I would like to export them to the <strong>same</strong> worksheet in Excel. The problem is that if I, example, do \n<code>write.csv2(my.list,file=\"my.list.csv2\")</code>\nthe matrices are not separated, there is no spacing between them. On the other hand I know how to use XLConnect to export my list to a workbook with several sheets (4 in this case). But I want my matrices to be in the <strong>same worksheet</strong>, separated by some spacing, with listnames (i.e. $<code>1857-1903</code>) present. And it also would be nice if rownames would be present... Is it possible? Could not find any answer.\nBest Regards!</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I accepted @January answer. Thanks! But if I use <code>write.csv2</code> instead of <code>write.table</code> (in order to get the desired output) I get a warning message:</p>\n\n<p><code>In write.csv2(export, file = \"funkcorr.csv\", quote = F, sep = \",\") :\n  attempt to set 'sep' ignored</code>. \nThen, the numbers in Excel are with . instead of ,. So, I need to manually convert . to , in Excel. Any idea why <code>sep</code> is ignored?</p>\n"},{"tags":["r","data.table","na"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":57,"score":-1,"question_id":13017551,"title":"na.omit in data.table, R","body":"<p>This could be a potential bug and I'm having difficulty reproducing it using a standalone example, however, maybe the error message might be helpful to digging to the bottom of it. <code>miv</code> is a <code>data.table</code>:</p>\n\n<pre><code>&gt; str(miv)\nClasses ‘data.table’ and 'data.frame':  113534 obs. of  21 variables:\n $ ym            : num  1980 1980 1980 1980 1980 ...\n $ dte           : Date, format: \"1980-03-31\" \"1980-03-31\" ...\n $ xs_ret        : num  -16.3 -16.3 -16.3 14.3 14.3 ...\n $ xs_mkt        : num  -8.85 -8.85 -8.85 12.77 12.77 ...\n $ smb           : num  -7.23 -7.23 -7.23 3.62 3.62 ...\n $ hml           : num  0.966 0.966 0.966 0.318 0.318 ...\n $ umd           : num  3.713 3.713 3.713 -0.762 -0.762 ...\n $ wficn         : num  100567 101394 102565 100010 100019 ...\n $ iv_w          : num [1:113534, 1] -1.039 -0.571 -0.831 -0.357 -0.263 ...\n\n&gt; miv &lt;- na.omit(miv)\nError in `[.data.table`(object, !omit) : \n   i is invalid type (matrix). Perhaps in future a 2 column matrix could return a list of     elements of DT (in the spirit of A[B] in FAQ 2.14). Please let datatable-help know if you'd     like this, or add your comments to FR #1611.\n</code></pre>\n"},{"tags":["windows","r","directory"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":47,"score":3,"question_id":13016907,"title":"setting the home directory in windows R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/11004531/change-path-expand-location-win-7\">Change path.expand location (Win 7)</a>  </p>\n</blockquote>\n\n\n\n<p>I would like to change the directory that <code>path.expand(\"~/\")</code> references on a windows system.  Currently this goes to \"C:/Users/home/Documents/\" by default.  How does one change this?   Note that this is distinct from the working directory that is set with <code>setwd()</code></p>\n"},{"tags":["r","nested-lists"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13016359,"title":"How to directly select the same column from all nested lists within a list?","body":"<p>is it possible to directly select a column of all nested lists within a list?<br>\nMy list is created using aggregate() with table():</p>\n\n<pre><code>AgN=aggregate(data,by=list(d$date),FUN=table,useNA=\"no\")\n</code></pre>\n\n<p><code>AgN$x</code> looks like:</p>\n\n<pre><code>$`0`\n\n      1           2           3           9          11 \n0.447204969 0.438509317 0.096894410 0.009937888 0.007453416 \n\n$`1`\n\n          1           2           4           8          11 \n0.489974937 0.389724311 0.102756892 0.006265664 0.011278195 \n\n…\n\n$n\n</code></pre>\n\n<p>I want to get a vector of a specific column of each table, e.g. a vector containing the values of all columns named \"1\".\nI am still a R beginner, but even after searching and trying for a long time I found no nice solution. If I want to get the field of a list, I can simply index it with brackets, e.g. [i,j].<br>\nOnline I found some examples for matrices, so I tried to do the same, at first only selecting one nested list’s column with <code>AgN$x[1][1]</code>, but that is still selecting a whole list:</p>\n\n<blockquote>\n  <p>$<code>0</code></p>\n\n<pre><code>     1           2           3           8          11 \n</code></pre>\n  \n  <p>0.447204969 0.438509317 0.096894410 0.009937888 0.007453416 </p>\n</blockquote>\n\n<p>My next try was <code>AgN$x[[1]][1]</code>, and it was working: </p>\n\n<blockquote>\n<pre><code>  1 \n</code></pre>\n  \n  <p>0.447205 </p>\n</blockquote>\n\n<p>So I tried to to the same to select the value of each first column of all nested lists:</p>\n\n<pre><code>AgN$x[[1:length(AgN$x]][1]\nRecursive indexing failed at level 2\n</code></pre>\n\n<p>Appearently the problem is that it is forbidden to select a range if you use a double brackets.</p>\n\n<p>My last try was to use an for loop: </p>\n\n<pre><code>cduR=NULL \nfor (i in 1:length(AgN$x)){\nt=AgN$x[[i]]\ncduR=c(cduR,as.vector(t[\"1\"]))\n}\n</code></pre>\n\n<p>Finally, so far that seems to working. But that way I had to build a loop each time when I want to select columns. Is there no direct way?</p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["r","grid","ggplot2","annotate","qplot"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":82,"score":4,"question_id":13009135,"title":"How to annotate ggplot2 qplot outside of legend and plotarea? (similar to mtext())","body":"<p>I would like to annotate my plots with a filename. With <code>plot()</code> I used <code>mtext</code>:</p>\n\n<pre><code>plot(1:10)\nmtext(\"File xy-12-34-56.csv\", 4)\n</code></pre>\n\n<p>How can I do that with ggplot2 and qplot or ggplot? It should not collide with the legend.\nI found the commands <code>annotate</code> and <code>grid</code>, but I could not get an annotation similar to <code>mtext</code> with these.</p>\n\n<p>As a workaround I could try <a href=\"http://blog.ggplot2.org/post/23537012922/adding-watermarks-to-plots\" rel=\"nofollow\">watermarks</a>, but perhaps you have a good hint for me. \nKind regards, Jonas</p>\n"},{"tags":["r","vectorization","lookup-tables"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":13014854,"title":"Efficient function to return varying length vector from lookup table","body":"<p>I have three data sources:</p>\n\n<pre><code>types&lt;-c(1,3,3)\nplaces&lt;-list(c(1,2,3),1,c(2,3))\nlookup.counts&lt;-as.data.frame(matrix(runif(9,min=0,max=10),nrow=3,ncol=3))\nassigned.places&lt;-rep.int(0,length(types))\n</code></pre>\n\n<p>the numbers in the \"types\" vector tell me what 'type' a given observation is. The vectors in the places list tell me which places the observation can be found in (some observations are found in only one place, others in all places). By definition there is one entry in types and one list in places for each observation. Lookup.counts tells me how many observations of each type are located in each place (generated from another data source).</p>\n\n<p>I want to randomly assign each observation to a place based on a probability generated from lookup.counts. Using for loops it looks something like\"</p>\n\n<pre><code>for (i in 1:length(types)){\n  row&lt;-types[i]\n  columns&lt;-places[[i]]\n  this.obs&lt;-lookup.counts[row,columns] #the counts of this type in each place\n  total&lt;-sum(this.obs)\n  this.obs&lt;-this.obs/total #the share of observations of this type in these places\n  pick&lt;-runif(1,min=0,max=1)\n\n  #the following should really be a 'while' loop, but regardless it needs help\n  for(j in 1:length(this.obs[])){\n    if(this.obs[j] &gt; pick){\n      #pick is less than this county so assign\n      pick&lt;- 100 #just a way of making sure an observation doesn't get assigned twice\n      assigned.places[i]&lt;-colnames(lookup.counts)[j]\n    }else{\n      #pick is greater, move to the next category\n      pick&lt;- pick-this.obs[j]\n    }\n  }\n}\n</code></pre>\n\n<p>I have been trying to vectorize this somehow, but am getting hung up on the variable length of 'places' and of 'this.obs'</p>\n\n<p>In practice, of course, the lookup.counts table is quite a bit bigger (500 x 40) and I have some 900K observations with places lists of length 1 through length 39.</p>\n"},{"tags":["regex","string","r","character","data.frame"],"answer_count":3,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13012275,"title":"Select rows from data.frame ending with a specific character string in R","body":"<p>I'm using R and I have a data.frame with nearly 2,000 entries that looks as follows:</p>\n\n<pre><code>&gt; head(PVs,15)\n     LogFreq   Word PhonCV  FreqDev\n1593     140    was    CVC 5.480774\n482      139    had    CVC 5.438114\n1681     138    zou   CVVC 5.395454\n1662     137    zei    CVV 5.352794\n1619     136   werd   CVCC 5.310134\n1592     135  waren CVV-CV 5.267474\n620      134    kon    CVC 5.224814\n646      133   kwam   CCVC 5.182154\n483      132 hadden CVC-CV 5.139494\n436      131   ging    CVC 5.096834\n734      130  moest  CVVCC 5.054174\n1171     129  stond  CCVCC 5.011514\n1654     128    zag    CVC 4.968854\n1620     127 werden CVC-CV 4.926194\n1683     126 zouden CVV-CV 4.883534\n</code></pre>\n\n<p>What I want to do is to create a new data.frame that is equal to PVs, except that all entries having as a member of the \"Word\" column a string of character that does NOT end in either \"te\" or \"de\" removed. i.e. All words not ending in either \"de\" or \"te\" should be removed from the data.frame. </p>\n\n<p>I know how to slectively remove entries from data.frames using logical operators, but those work when you're setting numeric criteria. I think to do this I need to use regular expressions, but sadly R is the only programming language I \"know\", so I'm far from knowing what type of code to use here. </p>\n\n<p>I appreciate your help. \nThanks in advance. </p>\n"},{"tags":["r","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":66,"score":4,"question_id":13015014,"title":"delete rows that contain NAs in certain columns R","body":"<p>I have a data.frame that contains many columns. I want to keep the rows that have no NAs in 4 of these columns. The complication arises from the fact that I have other rows that are allowed have NAs in them so I can't use complete.cases or is.na. What's the most efficient way to do this? </p>\n"},{"tags":["r","plyr","reshape2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":86,"score":1,"question_id":12979841,"title":"Issues with dcast function (reshape2) - three variable combination","body":"<p>I am using reshape2 package to shape my data and use it for t-test. For me it is easier to visualize the data in separate columns. I have three treatment combinations where \"wat\" is nested within \"spp\" and \"ins\" is nested within water. My demo table contains 3 response variable namely \"tyr\", \"esc\" and \"esc_R\". I would be interested in seeing how ins influence response -> \"tyr\" in \"spp\" -> Bl, with treatment \"wat\" -> High (just an example).</p>\n\n<p>Here is my data:\n<a href=\"http://pastebin.com/sR2MvBBA\" rel=\"nofollow\">demo.data</a></p>\n\n<pre><code>## Use orderBy function to sort data\nlibrary(doBy)\ndemo &lt;- orderBy(~spp+wat+ins, data = demo)\n## Create an unique data frame for a specific variable\ndf.bl.ins.1 &lt;- demo[demo$spp == \"Bl\", c(1:3, 4)]\ndf.bl.ins.2 &lt;- df.bl.ins.1[df.bl.ins.1$wat == \"High\", ]\n</code></pre>\n\n<p>And then I am having trouble executing dcast function.</p>\n\n<pre><code>df.bl.ins.tmp &lt;- dcast(df.bl.ins.2, spp + wat ~ ins, value.var = \"tyr\")\n</code></pre>\n\n<p>I have found interesting information in the following threads</p>\n\n<ol>\n<li><a href=\"http://stackoverflow.com/questions/12831524/can-dcast-be-used-without-an-aggregate-function\">Dason's suggestion</a> - which works really well with ToothGrowth demo dataset. Unfortunately, when the table has multiple treatments (more than 2) the solution did not remain simple. I agree with Maiasaura's suggestions that creating an unique variable is the key to this problem. However, I am having hard time understanding what function(x) does or how to use it in my table. </li>\n</ol>\n\n<p>Any help in this regard is much appreciated.</p>\n\n<p>In addition, if you have alternative suggestions to do t-test without manipulating the original data frame (demo), I will be excited to hear about it.</p>\n\n<p>Thanks in advance.</p>\n\n<p><strong>Edit</strong>\nHere is what I am expecting, for \"tyr\". In the following format I desire to compare \"No\" vs. \"Yes\" using a t-test.</p>\n\n<pre><code>spp wat ins No  Yes\nBl  High    No  0.3036  0.1987\nBl  High    No  0.2577  0.1112\nBl  High    No  NA  0.199\nBl  High    No  0.3299  0.1886\nBl  High    No  0.3301  0.2332\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":4,"up_vote_count":8,"down_vote_count":0,"view_count":6042,"score":8,"question_id":2315601,"title":"Understanding the order() function in R","body":"<p>I'm trying to understand how the order() function works in R.  I was under the impression that it returned a permutation of indices, which when sorted, would sort the original vector.</p>\n\n<p>For instance,</p>\n\n<blockquote>\n  <p>&gt; a &lt;- c(45,50,10,96)<br>\n  &gt; order(a)<br>\n  [1] 3 1 2 4</p>\n</blockquote>\n\n<p>I would have expected this to return 2 3 1 4, since the list sorted would be 10 45 50 96.  Can someone help me understand the return value of this function?</p>\n\n<p>Thank you.</p>\n"},{"tags":["r","plot","neural-network"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13013136,"title":"Unable to generate PDF with neural network graph","body":"<p>I'm trying to create a hard-copy image of a neural network graph and it keeps failing. If I try to create a PNG, nothing is generated, and if I try to generate a PDF I get a small file output that refuses to open with \"file may be damaged\" errors. If I just let it display in a graphics window, the image comes up fine.</p>\n\n<p>I'm using 2.15.1 on OS X (10.7.4), built by Macports. The code I'm working with at the moment:</p>\n\n<pre><code>library(ALL)\nlibrary(neuralnet)\ndata(ALL)\n\nALL.pdat &lt;- pData(ALL)\nbt &lt;- factor(substring(ALL.pdat$BT,1,1))\nall.sds &lt;- apply(exprs(ALL),1,sd)\ntop.10.sds &lt;- rank(all.sds)&gt;length(all.sds)-10\nexprs.top.10 &lt;- as.data.frame(t(exprs(ALL)[top.10.sds,]))\nnn.data &lt;- cbind(exprs.top.10, as.numeric(bt))\n##  Gene names start with a number, and that causes problems when trying to set up the\n##  formula for neuralnet.\ncol.names &lt;- paste(\"g\", colnames(nn.data), sep = '')\ncol.names[11] &lt;- \"bt\"\ncolnames(nn.data) &lt;- col.names\nmy.nn &lt;- neuralnet(bt ~ g36108_at + g36638_at + g37006_at + g38096_f_at + g38319_at + g38355_at + g38514_at + g38585_at + g39318_at + g41214_at, nn.data,  hidden = 10, threshold = 0.01)\nsummary(my.nn)\npdf(\"./nn-all.pdf\")\nplot.nn(my.nn)\ndev.off()\npng(\"./nn-all.png\")\nplot.nn(my.nn)\ndev.off()\n</code></pre>\n\n<p>I've even rebooted the machine to make sure that all the memory is cleared up, and that didn't help any.</p>\n"},{"tags":["r","count","two-columns"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":13013231,"title":"How can I divide one column of a data frame through another?","body":"<p>I wanted to divide one column by another to get the per person time how can I do this?I couldn't find anything on how you can devide using R\nhere is some data that I want to use</p>\n\n<pre><code>     min    count2.freq\n263807.0    1582\n196190.5    1016\n586689.0    3479\n</code></pre>\n\n<p>in the end I want to add a third column like this that has the number from<code>min / count2.freq</code>\ne.g 263808.0/1582 = 166.75</p>\n\n<p>thanks for your help</p>\n"},{"tags":["r","matrix","replace"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13013283,"title":"Replace values in df/matrix based on another matrix/df in R","body":"<p>I have two data frames, one contains numbers, and the second is binary, both are the same size. I would now like to replace all numbers in data frame A with <code>NA</code> if the corresponding variable in data frame B is 0 and not 1. If it is 1 the number should remain unchanged.\nHow do I go about that?</p>\n\n<p>df A</p>\n\n<pre><code>   A  B  C\n1  34 32 12\n2  52 23 34\n</code></pre>\n\n<p>df B</p>\n\n<pre><code>   A  B  C\n1  1  1  1\n2  0  0  1\n</code></pre>\n\n<p>desired result</p>\n\n<pre><code>   A  B  C\n1  34 32 12\n2  na na 34\n</code></pre>\n"},{"tags":["r","matlab"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13013016,"title":"Is it possible to add script breaking line in R, like the cell break in Matlab","body":"<p>I have been using R for a while. Sometimes it is quite annoying that when the script gets long, then you have to add a break line to separate the code. Is it possible to add script breaking line automatically, like the cell break in Matlab.</p>\n\n<p>something like this:</p>\n\n<p>code 1</p>\n\n<hr>\n\n<p>code 2</p>\n\n<p>Thanks:)</p>\n\n<p>Best, Qin</p>\n"},{"tags":["r","igraph"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13006656,"title":"igraph nonreciprocal edges after converting to undirected graph using mutual","body":"<p>I'm working on a directed graph in igraph for R. I'm trying to convert it to an undirected graph where just reciprocal edges of the former persist. Should be easy but I'm getting strange results.</p>\n\n<p>first I did it like that</p>\n\n<pre><code>    library(igraph)\n    load(\"dmNet.Rdata\")\n    #http://www.unet.univie.ac.at/~a0406222/dmNet.Rdata\n\n    recNet &lt;- as.undirected(net, mode = \"mutual\",edge.attr.comb=\"sum\")\n</code></pre>\n\n<p>when I check E(recNet)$weight there are a lot of edges with a weight of 1, which should not be possible since the sum of two reciprocal edges has to be at least 2. Then I did it like that</p>\n\n<pre><code>    recNet &lt;- as.undirected(net, mode = \"mutual\",edge.attr.comb=\"c\")\n</code></pre>\n\n<p>now I can see that there are actually some edges containing just one value. My new graph recNet seems to contain nonreciprocal edges of net. What am I doing wrong, or am I missunderstandig the \"mutual option\"?</p>\n"},{"tags":["arrays","r","interface","multidimensional"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":70,"score":3,"question_id":13004475,"title":"R .C interface: Passing multidimensional arrays","body":"<p>I've written up a function \"foo\" in C that I want to call from an R program. The function takes in as input a matrix and does some operations on it, (say add 1 to each element). While it is easy to a single vector as</p>\n\n<pre><code>.C(\"foo\", n=as.integer(5), x=as.double(rnorm(5)))\n</code></pre>\n\n<p>with foo implemented as </p>\n\n<pre><code>void foo(int *nin, double *x)\n{\nint n = nin[0];\n\nint i;\n\nfor (i=0; i&lt;n; i++)\n    x[i] = x[i] * x[i];\n} \n</code></pre>\n\n<p>How do I pass in a two dimensional array? If I change the \"double *x\" to \"double **x\" it gives a segmentation fault. Any pointers appreciated.</p>\n"},{"tags":["r","xts"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":60,"score":3,"question_id":13005663,"title":"Pull nth Day of Month in XTS in R","body":"<p>My questions is closely related to the one asked here - <a href=\"http://stackoverflow.com/questions/10994496/pull-return-from-first-business-day-of-the-month-from-xts-object-using-r\">Pull Return from first business day of the month from XTS object using R</a></p>\n\n<p>Instead of extracting the first day of each month, I want to extract say the 10th data point of each month.  How can I do this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["r","spatial"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13010900,"title":"Dynamically change data slot in 'SpatialGridDataFrame'","body":"<p>Let's say I have 'SpatialGridDataFrame'.</p>\n\n<pre><code>grd &lt;- GridTopology(c(0,0), c(10,10), c(10,20))\n\ngrdx = SpatialGridDataFrame(grd, d=data.frame(www))\n</code></pre>\n\n<p>where 'www' is num [1:200] 1010 1010 1010 1009 1009 ... (200 obs. of 1 variable)</p>\n\n<p>I would like to change g$www and remember all realizations with different name.<br>\nFor example, if I make</p>\n\n<pre><code>r &lt;- replicate(15,rnorm(10*20,mean=0,sd=3))   # matrix 200x15 with random numbers\nm &lt;-(matrix(nrow=200,ncol=15))\nfor (i in 1:15){\nm [,i] &lt;-  g[[1]] + r[,i]}    # matrix 200x15 with INPUT values for g$www\n</code></pre>\n\n<p>At the end I would like to have:</p>\n\n<p>'SpatialGridDataFrame' g_1 with g$www = m[,1];</p>\n\n<p>'SpatialGridDataFrame' g_2 with g$www = m[,2];</p>\n\n<p>'SpatialGridDataFrame' g_3 with g$www = m[,3]; etc.</p>\n\n<p>Thanks!</p>\n"},{"tags":["r","error-handling"],"answer_count":3,"favorite_count":0,"up_vote_count":9,"down_vote_count":0,"view_count":121,"score":9,"question_id":13003834,"title":"Bailing out from error in large `sapply`","body":"<p>This question may or may not be inspired by my losing an entire 3-hour geocoding run because one of the values returned an error.  Cue the pity (down)votes.</p>\n\n<p>Basically there was an error returned inside a function called by <code>sapply</code>.  I had <code>options(error=recover)</code> on, but despite browsing through every level available to me, I could not find any place where the results of the (thousands of successful) calls to FUN were stored in memory.  </p>\n\n<p>Some of the objects I found while browsing around themselves gave errors when I attempted to examine them, claiming the references were no longer valid.  Unfortunately I lost the particular error message.</p>\n\n<p>Here's a quick example which, while it does not replicate the reference error (which I suspect is related to disappearing environments and is probably immaterial), does demonstrate that I cannot see a way to save the data that has already been processed.</p>\n\n<p>Is there such a technique?</p>\n\n<p>Note that I have since realized my error and inserted even more robust error handling than existed before via <code>try</code>, but I am looking for a way to recover the contents <strong>ex post</strong> rather than ex ante.</p>\n\n<p><strong>Test function</strong></p>\n\n<pre><code>sapply( seq(10), function(x) {\n  if(x==5) stop(\"Error!\")\n  return( \"important data\" )\n} )\n</code></pre>\n\n<p><strong>Interactive exploration</strong></p>\n\n<pre><code>&gt; sapply( seq(10), function(x) {\n+   if(x==5) stop(\"Error!\")\n+   return( \"important data\" )\n+ } )\nError in FUN(1:10[[5L]], ...) : Error!\n\nEnter a frame number, or 0 to exit   \n\n1: sapply(seq(10), function(x) {\n    if (x == 5) \n        stop(\"Error!\")\n    return(\"important data\")\n})\n2: lapply(X = X, FUN = FUN, ...)\n3: FUN(1:10[[5]], ...)\n\nSelection: 3\nCalled from: FUN(1:10[[5L]], ...)\nBrowse[1]&gt; ls()\n[1] \"x\"\nBrowse[1]&gt; x\n[1] 5\nBrowse[1]&gt; \nEnter a frame number, or 0 to exit   \n\n1: sapply(seq(10), function(x) {\n    if (x == 5) \n        stop(\"Error!\")\n    return(\"important data\")\n})\n2: lapply(X = X, FUN = FUN, ...)\n3: FUN(1:10[[5]], ...)\n\nSelection: 2\nCalled from: lapply(X = X, FUN = FUN, ...)\nBrowse[1]&gt; ls()\n[1] \"FUN\" \"X\"  \nBrowse[1]&gt; X\n [1]  1  2  3  4  5  6  7  8  9 10\nBrowse[1]&gt; FUN\nfunction(x) {\n  if(x==5) stop(\"Error!\")\n  return( \"important data\" )\n}\nBrowse[1]&gt; \nEnter a frame number, or 0 to exit   \n\n1: sapply(seq(10), function(x) {\n    if (x == 5) \n        stop(\"Error!\")\n    return(\"important data\")\n})\n2: lapply(X = X, FUN = FUN, ...)\n3: FUN(1:10[[5]], ...)\n\nSelection: 1\nCalled from: sapply(seq(10), function(x) {\n    if (x == 5) \n        stop(\"Error!\")\n    return(\"important data\")\n})\nBrowse[1]&gt; ls()\n[1] \"FUN\"       \"simplify\"  \"USE.NAMES\" \"X\"        \nBrowse[1]&gt; X\n [1]  1  2  3  4  5  6  7  8  9 10\nBrowse[1]&gt; USE.NAMES\n[1] TRUE\nBrowse[1]&gt; simplify\n[1] TRUE\nBrowse[1]&gt; FUN\nfunction(x) {\n  if(x==5) stop(\"Error!\")\n  return( \"important data\" )\n}\nBrowser[1]&gt; Q\n</code></pre>\n\n<p>To be clear, what I was hoping to find was the vector:</p>\n\n<pre><code>[1] \"important data\" \"important data\" \"important data\" \"important data\"\n</code></pre>\n\n<p>In other words, the results of the internal loop that had been completed to this point.</p>\n\n<p><strong>Edit: Update with C code</strong></p>\n\n<p>Inside <code>.Internal(lapply())</code> is the <a href=\"https://github.com/wch/r-source/blob/trunk/src/main/apply.c#L45\" rel=\"nofollow\">following code</a>:</p>\n\n<pre><code>PROTECT(ans = allocVector(VECSXP, n));\n...\nfor(i = 0; i &lt; n; i++) {\n   ...\n   tmp = eval(R_fcall, rho);\n   ...\n   SET_VECTOR_ELT(ans, i, tmp);\n}\n</code></pre>\n\n<p>I want to get at <code>ans</code> when any call to <code>lapply</code> fails.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":217,"score":0,"question_id":9945775,"title":"issues in installing Rstem package","body":"<p>I was trying to install \"sentiment\" package, which requires the \"Rstem\" package. But the installation process failed due to the following error message,</p>\n\n<blockquote>\n  <blockquote>\n    <p>install.packages(\"Rstem\")\n    Installing package(s) into ‘/home/user/R/x86_64-redhat-linux-gnu-library/2.14’\n    (as ‘lib’ is unspecified)\n    Warning message:\n    In getDependencies(pkgs, dependencies, available, lib) :\n      package ‘Rstem’ is not available (for R version 2.14.1)</p>\n  </blockquote>\n</blockquote>\n\n<p>May I know how to solve this issue? Thanks.</p>\n"},{"tags":["r","vector","plot","character","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13009203,"title":"Plot a character vector against a numeric vector in R","body":"<p>I have the following data frame in R: </p>\n\n<pre><code>&gt;AcceptData\n  Mean.Rank Sentence.Type\n1       2.5       An+Sp+a\n2       2.6      An+Nsp+a\n3       2.1       An+Sp-a\n4       3.1      An+Nsp-a\n5       2.4       In+Sp+a\n6       1.7      In+Nsp+a\n7       3.1       In+Sp-a\n8       3.0      In+Nsp-a\n</code></pre>\n\n<p>Which I want to plot, with the Sentence.Type column in the x axis, with the actual name of each cell as a point in the x axis. I want the y axis to go from 1 to 4 in steps of .5</p>\n\n<p>So far I haven't been able to plot this, neither with plot() not with hist(). I keep getting different types of errors, mainly because of the nature of the character column in the data.frame. </p>\n\n<p>I know this should be easy for most, but I'm sort of noob with R still and after hours I can't get the plot right. Any help is much appreciated. </p>\n\n<p>Edit: </p>\n\n<p>Some of the errors I've gotten: </p>\n\n<pre><code>&gt; hist(AcceptData$Sentence.Type,AcceptData$Mean.Rank)\nError in hist.default(AcceptData$Sentence.Type, AcceptData$Mean.Rank) : \n  'x' must be numeric\n</code></pre>\n\n<p>Or: (this doesn't give an error, but definitely not the graph I want. It has all the x values cramped to the left of the x axis)</p>\n\n<pre><code>  plot(AcceptData$Sentence.Type,AcceptData$Mean.Rank,lty=5,lwd=2,xlim=c(1,16),ylim=c(1,4),xla b=\"Sentence Type\",ylab=\"Mean Ranking\",main=\"Mean Acceptability Ranking per Sentence\")\n</code></pre>\n"},{"tags":["web-services","r","analytics"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":13008711,"title":"How to integrate R in a web application","body":"<p>I am developing a web application and I would like to perform two kind of statistical/modeling operations.</p>\n\n<p>(1) Batch analysis  from data stored in the backend of my app (HBase cluster). Typically, this operation needs to be performed on regular basis, say every night. The size of the data may exceed what can be stored in local memory, so this might need the invocation of some package supporting parallel computing.\n(2) On the fly R execution triggered by a user request in the front-end. Typical use case include forecasting of small time series. Users may place requests in the same time so there should be some support for concurrency. The performance is of paramount importance because the user can't wait indefinitely for the response to come.</p>\n\n<p>My question is : what would be the best combination of technologies/CRAN package to address those two problems ?\nMy idea for the moment is :</p>\n\n<ul>\n<li>Using Rserver in combination with a Ruby client. Alternatively, I am thinking about writing myself the server in Java and using existing R/Java bindings.</li>\n<li>Using RHadoop to handle jobs on big datasets.</li>\n</ul>\n\n<p>I saw RevoDeployR is a great tool but is not open source, isn't it ?</p>\n\n<p>Thank you for your help </p>\n"},{"tags":["r","panel","logistics"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13008877,"title":"How to analyze panel data using nested logit model in R","body":"<p>So after a week's research into R I still can't find a solution to my problem.. Here it goes:</p>\n\n<p>I have a panel data set, which has 10 countries, and each country has 5 time series variables. I want to estimate the status for each country at each particular time. The status are nested.</p>\n\n<p>Therefore I'm considering using mlogit() in R to adopt this analysis. However I can't convert my dataset into the mlogit.data() format...</p>\n\n<p>So I'd like to ask if anyone knows how to do the conversion? Particularly how to deal with the time series variables??</p>\n\n<p>Many thanks!!</p>\n"},{"tags":["r","math"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":12998405,"title":"Drawing the Zipf distribution","body":"<p>I have a dataset with zipf law distribution, and now i want compare it with standard <code>zipf</code> diagram, this is my <code>R</code> code:</p>\n\n<pre><code>f &lt;- read.table('/myfile.txt',sep='\\t',header=T)\nattach(f)\nfs &lt;- f[order(cnt), ]\ndetach(f)\nn = 1:dim(fs)[1]\nplot(fs[,2]~n)\n</code></pre>\n\n<p>Now i want to compare it with <code>zipf</code> in the same plot, How can i do this in <code>R</code>?</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":13006409,"title":"ggplot2 - flipping ordering of levels in stacked bar chart","body":"<p>This code is fairly minimal and should be able to be tweaked to a solution.</p>\n\n<pre><code>blah &lt;- data.frame(X1=c(\"Decrease Risk\",\"Don't Know\",\"Increase Risk\",\"No Effect\",\"Decrease Risk\",\"Don't Know\",\"Increase Risk\",\"No Effect\"),\n                   X2=c(\"Red Meat\",\"Red Meat\",\"Red Meat\",\"Red Meat\",\"Red Meat\",\"Red Meat\",\"Red Meat\",\"Red Meat\"),\n                   value=c(1.98,31.19,64.38,2.43,4.65,24.55,35.88,34.90),\n                   status=c(\"Case\",\"Case\",\"Case\",\"Case\",\"Control\",\"Control\",\"Control\",\"Control\")\n                   )\n\nggplot(blah, aes(X2, value, fill=X1)) + geom_bar() + coord_flip() + facet_wrap(~status) + \n    labs(x=\"Perceived Risk Factors\", y=\"Percentage (%)\", tilte=\"Some Title\", fill=\"Responses\")\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/9gNxi.png\" alt=\"enter image description here\"></p>\n\n<p>What I'd like is that the 'controls' on the right have the order of the levels of 'Responses' reversed. The point being so that for the controls the purple is on the inside, then the bluey one, then green with pink on the outside. It semi common to do this in a plot like this, and I can think of ways to do it that involve some fairly dirty duping of variables and changing of ordered factor levels but thought someone might have an elegant solution/idea?</p>\n"},{"tags":["r","random","package","distribution"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":9,"view_count":149,"score":-9,"question_id":12967114,"title":"R: random number generation (iid draws) commands","body":"<p>Only <strong>R language</strong> is of interest for this question</p>\n\n<ol>\n<li><p>What are the options/packages to <strong>generate random numbers</strong> (sample of <strong>iid draws</strong>) in R? \nDistributions not in the list (below) are of interest. \nNB: see the <em>djhurio</em>'s link below to generate from the list.</p></li>\n<li><p>Is there a package that implements advanced statistical techniques like Metropolis–Hastings algorithm/accept-reject algorithm/other sampling methods where one only needs to <strong>input pdf as a command argument</strong> (rather than code the whole algorithm) to generate from a pdf with no closed-form cdf when a distribution is not one of the frequently used? </p></li>\n</ol>\n\n<p>List={<br>\nbeta,<br>\nbinomial,<br>\nCauchy,<br>\nchi-squared,<br>\nexponential,<br>\nF,<br>\ngamma,<br>\ngeometric,<br>\nhypergeometric,<br>\nlog-normal,<br>\nmultinomial,<br>\nnegative binomial,<br>\nnormal,<br>\nPoisson,<br>\nStudent's t,<br>\nuniform,<br>\nWeibull }.  </p>\n"},{"tags":["r","na"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":13004609,"title":"getting error in [R] - missing value where TRUE/FALSE needed","body":"<p>I am trying to step through a vector to find the outliers using IQR to calculate a range. When I run this script looking for values to the right of the IQR I get results and when I run to the left I get the error: missing value where TRUE/FALSE needed. How can I scrub out the true and false in my dataset?\nhere is my script:</p>\n\n<pre><code>data = c(100, 120, 121, 123, 125, 124, 123, 123, 123, 124, 125, 167, 180, 123, 156)\nQ3 &lt;- quantile(data, 0.75) ##gets the third quantile from the list of vectors\nQ1 &lt;- quantile(data, 0.25) ## gets the first quantile from the list of vectors\noutliers_left &lt;-(Q1-1.5*IQR(data)) \noutliers_right &lt;-(Q3+1.5*IQR(data))\nIQR &lt;- IQR(data)\npaste(\"the innner quantile range is\", IQR)\nQ1 # quantil at 0.25\nQ3 # quantile at 0.75\n# show the range of numbers we have\npaste(\"your range is\", outliers_left, \"through\", outliers_right, \"to determine outliers\")\n# count ho many vectors there are and then we will pass this value into a loop to look for \n# anything above and below the Q1-Q3 values\nvectorCount &lt;- sum(!is.na(data))\ni &lt;- 1\nwhile( i &lt; vectorCount ){\ni &lt;- i + 1\nx &lt;- data[i]\n# if(x &lt; outliers_left) {print(x)} # uncomment this to run and test for the left\nif(x &gt; outliers_right) {print(x)}\n}\n</code></pre>\n\n<p>and the error I get is</p>\n\n<pre><code>[1] 167\n[1] 180\n[1] 156\nError in if (x &gt; outliers_right) { : \nmissing value where TRUE/FALSE needed\n</code></pre>\n\n<p>as you can see if you run this script, it is finding my 3 outliers on the right and also throws the error, but when I run this again on the left of my IQR, and I do have an outlier of 100 in the vector, I just get the error without other results being displayed.\nHow can I fix this script? any help greatly appreciated. I've been scouring the web and my books for days on how to fix this.</p>\n"},{"tags":["r","ggplot2"],"answer_count":4,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":3550,"score":5,"question_id":2684966,"title":"How can I suppress the vertical gridlines in a ggplot2 plot while retaining the x-axis labels?","body":"<p>This is a follow-on from <a href=\"http://stackoverflow.com/questions/2678141/how-can-i-suppress-the-vertical-gridlines-in-a-ggplot2-plot\">this question, in which I was trying to suppress the vertical gridlines</a>.</p>\n\n<p>The solution, as provided by learnr, was to add scale_x_continuous(breaks = NA), but this had the side effect of also suppressing the x-axis labels, as well.  I am totally happy to write the labels back in by hand, but it's not clear to me how to figure out where the labels should go.</p>\n\n<p>The other option is to suppress all gridlines (using opts( panel.grid.major = theme_blank()) or some such) and then drawing back in just the major horizontal gridlines.  Again, the problem here is how to figure out what the breaks are in the plot to supply to geom_hline().</p>\n\n<p>So, essentially, my options are:</p>\n\n<ol>\n<li>Suppress vertical gridlines and x-axis labels (using scale_x_continuous(breaks = NA) ) and add the x-axis labels back in.</li>\n<li>Suppress all gridlines (using opts( panel.grid.major = theme_blank()) ) and add the major horizontal gridlines back in using geom_hline().</li>\n</ol>\n\n<p>Here are the two options:</p>\n\n<pre><code>library(ggplot2)\n\ndata &lt;- data.frame(x = 1:10, y = c(3,5,2,5,6,2,7,6,5,4))\n\n# suppressing vertical gridlines and x-axis labels\n# need to re-draw x-axis labels\nggplot(data, aes(x, y)) +\n  geom_bar(stat = 'identity') +\n  scale_x_continuous(breaks = NA) +\n  opts(\n    panel.grid.major = theme_line(size = 0.5, colour = '#1391FF'),\n    panel.grid.minor = theme_blank(),\n    panel.background = theme_blank(),\n    axis.ticks = theme_blank()\n  )\n\n# suppressing all gridlines\n# need to re-draw horizontal gridlines, probably with geom_hbar() \nggplot(data, aes(x, y)) +\n  geom_bar(stat = 'identity') +\n  scale_x_continuous(breaks = NA) +\n  opts(\n    panel.grid.major = theme_blank(),\n    panel.grid.minor = theme_blank(),\n    panel.background = theme_blank(),\n    axis.ticks = theme_blank()\n  )\n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":2483,"score":7,"question_id":2678141,"title":"How can I suppress the vertical gridlines in a ggplot2 plot?","body":"<p>I am building a bar chart for which bars suffice as indications of horizontal (x) placement, so I'd like to avoid drawing the superfluous vertical gridlines.</p>\n\n<p>I understand how to style the minor and major gridlines in opts(), but I can't for the life of me figure out how to suppress just the vertical gridlines.</p>\n\n<pre><code>library(ggplot2)\n\ndata &lt;- data.frame(x = 1:10, y = c(3,5,2,5,6,2,7,6,5,4))\n\nggplot(data, aes(x, y)) +\n  geom_bar(stat = 'identity') +\n  opts(\n    panel.grid.major = theme_line(size = 0.5, colour = '#1391FF'),\n    panel.grid.minor = theme_line(colour = NA),\n    panel.background = theme_rect(colour = NA),\n    axis.ticks = theme_segment(colour = NA)\n  )\n</code></pre>\n\n<p>At this point, it's looking like I'm going to have to suppress all of the gridlines and then draw them back in with geom_hline(), which seems like kind of a pain (also, it's not entirely clear how I can find the tick/major gridline positions to feed to geom_hline().)</p>\n\n<p>Any thoughts would be appreciated!</p>\n"},{"tags":["r","finance","xts"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12938901,"title":"Calculate Option Prices from a Multivariate XTS of Volatilities and Spot Prices","body":"<p>Here is my code for downloading spot prices and calculating realized volatilities for a bunch of indices.</p>\n\n<pre><code>library(quantmod)\nlibrary(PerformanceAnalytics)\nlibrary(RQuantLib)\n\ntickers.index = c(\"^RUT\",\"^STOXX50E\",\"^HSI\")\nmyEnv &lt;- new.env()\ngetSymbols(tickers.index, src='yahoo', from = \"2004-03-26\", to = \"2012-10-10\", env = myEnv, adjust=TRUE)\nindex &lt;- do.call(merge, c(eapply(myEnv, Ad), all=TRUE))\nindex &lt;-na.locf(index)\n\n#Calculate daily returns for all indices and convert to arithmetic returns\nindex.ret &lt;- exp(CalculateReturns(index,method=\"compound\")) - 1\nindex.ret[1,] &lt;- 0\n\n#Calculate realized vol for all the indices\nindex.realized &lt;- xts(apply(index.ret,2,runSD,n=20), index(index.ret))*sqrt(252)\nindex.realized[1:19,] &lt;- 1\n</code></pre>\n\n<p>What I would like to do now is to calculate a series of Put prices with the function EuropeanOption for every index, every day with the following parameters:</p>\n\n<ul>\n<li>Underlying Price - Today's close from the index XTS</li>\n<li>Strike Price - Yesterday's close from the index XTS</li>\n<li>Implied Vol - Yesterday's realized vol from the index.realized XTS</li>\n<li>All other parameters will just be constants</li>\n</ul>\n\n<p>I have tried to implement this with various attempts using apply and etc but couldn't get it to work.  I don't have to use the RQuantLib - if other functions to calculate the price of an European option can make this easier, I am fine with it.  Would greatly appreciate any help.  </p>\n\n<p>Thank you.</p>\n"},{"tags":["r","loops","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":12981299,"title":"How to create summary tables and graphs in R by looping through the response variables (in columns)","body":"<p>I have a dataset with multiple response variables and three treatments. Treatment2 is nested within treatment1 and treatment3 is nested within treatment 2. I have shown only three response variables for the sake of simplicity. I would like to run this over 22 response variable of which 3 are shown in the demo table.</p>\n\n<p>My objective:</p>\n\n<ol>\n<li>To visualize how the response variable(s) change based on the treatment combination. I have created a script to perform this on one response variable. I am copy pasting this code to run through other columns which to me is an extremely crude way to do it. Which leads to my second objective.</li>\n<li>Automate or modify the following script so that it can automatically loops through the column and produce desired table and graphs.</li>\n</ol>\n\n<p>Demo data:\n<a href=\"http://pastebin.com/sR2MvBBA\" rel=\"nofollow\">demo.table</a></p>\n\n<p>Here is my script:</p>\n\n<pre><code>library(doBy)\nlength2 &lt;- function (x, na.rm=FALSE) {\n    if (na.rm) sum(!is.na(x))\n    else       length(x)\n}\n attach (demo)\ncdataNA &lt;- summaryBy(tyr ~ spp + wat + ins, data=demo, FUN=c(length2,mean,sd), na.rm=TRUE)\n# Rename column change.length to just N\nnames(cdataNA)[names(cdataNA)==\"tyr.length2\"] &lt;- \"N\"\n# Calculate standard error of the mean\ncdataNA$tyr.SE &lt;- cdataNA$tyr.sd / sqrt(cdataNA$N)\ncdataNA\n# Now create a barplot using ggplot2\nlibrary(ggplot2)\na &lt;- ggplot(cdataNA, aes(x = wat, y = tyr.mean, fill = ins))\nb &lt;- a + geom_bar(stat = \"identity\", position = \"dodge\") + facet_grid (~ spp)\n# Now put errorbars.\nc &lt;- b + geom_errorbar(aes(ymin=tyr.mean-tyr.SE, ymax=tyr.mean+tyr.SE), \n                  width=.2,                    # Width of the error bars\n                  position=position_dodge(.9)) + \nxlab (\"wat\") + \nylab (\"tyr (PA/PA std)\")\nc\n\n## esc\nlibrary(doBy)\nlength2 &lt;- function (x, na.rm=FALSE) {\n    if (na.rm) sum(!is.na(x))\n    else       length(x)\n}\ncdataNA1 &lt;- summaryBy(esc ~ spp + wat + ins, data=demo, FUN=c(length2,mean,sd), na.rm=TRUE)\n# Rename column change.length to just N\nnames(cdataNA1)[names(cdataNA1)==\"esc.length2\"] &lt;- \"N\"\n# Calculate standard error of the mean\ncdataNA1$esc.SE &lt;- cdataNA1$esc.sd / sqrt(cdataNA1$N)\ncdataNA1\n# Now create a barplot using ggplot2\nlibrary(ggplot2)\na1 &lt;- ggplot(cdataNA1, aes(x = wat, y = esc.mean, fill = ins))\nb1 &lt;- a1 + geom_bar(stat = \"identity\", position = \"dodge\") + facet_grid (~ spp)\n# Now put errorbars.\nc1 &lt;- b1 + geom_errorbar(aes(ymin=esc.mean-esc.SE, ymax=esc.mean+esc.SE), \n                  width=.2,                    # Width of the error bars\n                  position=position_dodge(.9)) + \nxlab (\"wat\") + \nylab (\"esc (PA/PA std)\")\nc1\n</code></pre>\n\n<p>Resulting table for tyr:</p>\n\n<pre><code>  spp  wat ins N tyr.mean      tyr.sd      tyr.SE\n1  Bl High  No 4 0.305325 0.034102041 0.017051020\n2  Bl High Yes 5 0.186140 0.045165894 0.020198802\n3  Bl  Low  No 5 0.310540 0.061810096 0.027642315\n4  Bl  Low Yes 5 0.202840 0.029034944 0.012984822\n5 Man High  No 4 0.122725 0.075867005 0.037933503\n6 Man High Yes 5 0.081800 0.013463469 0.006021046\n7 Man  Low  No 5 0.079880 0.009569587 0.004279650\n8 Man  Low Yes 4 0.083550 0.018431947 0.009215973\n</code></pre>\n\n<p>Resulting graph for esc:\n<a href=\"http://imageshack.us/photo/my-images/827/escdemo.png/\" rel=\"nofollow\">demo figure for esc</a></p>\n\n<p>So the whole thing works but still requires considerable manual labor which impedes the work-flow. it would be great to achieve automation.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["r","script"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":106,"score":0,"question_id":12993871,"title":"R scripts load automatically","body":"<p>I have gotten an old package from CRAN that contains some R scripts, the question that I have is how I can load those scripts automatically without the need to open and run them line by line, is there any way possible?\nThe package was called knnflex and it was deprecated from CRAN. There is a zip available for R for windows in:</p>\n\n<p><a href=\"http://cran.uvigo.es/web/packages/knnflex/index.html\" rel=\"nofollow\">http://cran.uvigo.es/web/packages/knnflex/index.html</a></p>\n\n<p>but when one installs the package, it occurs a problem with the namespace, due to lack of compatibility (I dont put the problem or the solution here, because it was solved before in a thread in SO). I have included the namespace in the zip file with a trick that I found in this page, but some functions like predict are not recognized at all.</p>\n\n<p>One turnaround that I make it was to download the tar.gz file, uncompress it and inside the R folder there are the scripts that make it possible to work. So actually I am loading those scripts one by one and then make it run separately line by line and it works.</p>\n\n<p>So that is why I was asking if there is a way to call those scripts automatically.</p>\n\n<p>Long story, but I think it can be helpful to other people also.\nThanks</p>\n"},{"tags":["r","graphics","ggplot2"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":254,"score":3,"question_id":10547487,"title":"R: removing facet_wrap labels completely in ggplot2","body":"<p>I'd like to remove the labels for the facets completely to create a sort of sparkline effect, as for the audience the labels are irrelevant, the best I can come up with is:</p>\n\n<pre><code>library(MASS)\nlibrary(ggplot2)\nqplot(week,y,data=bacteria,group=ID, geom=c('point','line'), xlab='', ylab='') + \n     facet_wrap(~ID) + \n     opts(strip.text.x = theme_text(size=0))\n</code></pre>\n\n<p>So can I get rid of the (now blank) strip.background completely to allow more space for the \"sparklines\"?</p>\n\n<p>Or alternatively is there a better way to get this \"sparkline\" effect for a large number of binary valued time-series like this?</p>\n"},{"tags":["r","plot","ggplot2","alpha"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":141,"score":2,"question_id":12995683,"title":"Any way to make plot points in scatterplot more transparent in R?","body":"<p>I have a 3 column matrix; plots are made by points based on column 1 and column 2 values, but colored based on column 2 (6 different groups). I can successfully plot all points, however, the last plot group (group 6) which was assigned the color purple, masks the plots of the other groups. Is there a way to make the plot points more transparent?</p>\n\n<pre><code>s &lt;- read.table(\"/.../parse-output.txt\", sep=\"\\t\") \ndim(s) \n[1] 67124     3\nx &lt;- s[,1] \ny &lt;- s[,2]\nz &lt;- s[,3] \ncols &lt;- cut(z, 6, labels = c(\"pink\", \"red\", \"yellow\", \"blue\", \"green\", \"purple\"))\nplot(x, y, main= \"Fragment recruitment plot - FR-HIT\", ylab = \"Percent identity\", xlab = \"Base pair position\", col = as.character(cols), pch=16) \n</code></pre>\n"},{"tags":["r","plot","ggplot2","heatmap"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":124,"score":4,"question_id":12998372,"title":"heatmap-like plot, but for categorical variables","body":"<p>I have three factors (set1, set2, and set3) for each of about 50 individuals.  The values for set1, set2, and set3 are \"A\",\"B\",\"C\".  I'd like to make a heatmap-like plot of these data but have the legend show the color associated with the values (eg., A='red', B='blue', C='black').  Any suggestions?</p>\n\n<p>Thanks.</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1211,"score":1,"question_id":3427457,"title":"ggplot and R: Two variables over time","body":"<p>I'd like to know how to make it so that x and y, in the following example data set are plotted on the vertical axis for each element of frame in the horizontal axis. How do I do this with ggplot2?</p>\n\n<p>x, y = variables, frame = YYYYMM</p>\n\n<p>Example Data: </p>\n\n<pre><code>df &lt;- structure(list(x = c(0.000892333625290767, 0.0161153931761482, \n0.0188150880795816, 0.0268699106638318, 0.018657330651898, 0.0101065034206662, \n0.00154410447630379), y = c(1.35172948829027, 0.59654026447333, \n0.685835030118683, 0.741545898152761, 1.09653338596292, 0.119448208345102, \n0.104092642854814), frame = c(200912, 201001, 201002, 201003, \n201004, 201005, 201006)), .Names = c(\"x\", \"y\", \"frame\"), row.names = c(\"1\", \n\"2\", \"3\", \"4\", \"5\", \"6\", \"7\"), class = \"data.frame\")\n</code></pre>\n\n<p>I've been able to get one plotted in a line, but it seems that it's not recognizing my frame as categorical (not that it is, nor do I know how to change it to such). </p>\n\n<pre><code>p &lt;- ggplot(df, aes(x=frame, y=x))\np + geom_line()\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":102,"score":7,"question_id":13002200,"title":"S4 Classes: Multiple types per slot","body":"<p>Is it possible to create an S4 class, where one or more of the slots can be of multiple classes? For example. Let's say that you had a situation where data could be either a vector, or a data.frame. </p>\n\n<pre><code>exampleClass &lt;- setClass(\"exampleClass\",\n    representation(raw=c(\"data.frame\",\"numeric\",\"character\"),\n    anotherSlot=c(\"data.frame\",\"numeric\")) \n</code></pre>\n\n<p>Or, is this the type of situation where defining a sub-class / super-class becomes necessary? </p>\n\n<p>PS: Searching for a useful tutorial on S4 classes produces limited results. Links to a good tutorial on S4 class creation/usage/documentation would be greatly appreciated. </p>\n"},{"tags":["r","data.frame"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13003018,"title":"Wide tally dataframe to tall indicator dataframe","body":"<p>This is not a complicated problem, and I have a solution, but I can't shake the feeling that there is a better way:</p>\n\n<p>I have a data.frame with a tally of successes and opportunities by category, like this:</p>\n\n<pre><code>testFrame &lt;- data.frame(successes = c(100, 150, 18),\n                        opportunities = c(215, 194, 40),\n                        category = LETTERS[1:3])\ntestFrame$category &lt;- as.character(testFrame$category)\n</code></pre>\n\n<p>I want to convert this to a \"tall\" data.frame, with one column of 1s and 0s indicating success/failure and a second with category labels. I can do this with the following code:</p>\n\n<pre><code>tallFrame &lt;- lapply(1:nrow(testFrame), function(rr){\n  cbind(rep(c(1, 0), c(testFrame[rr, \"successes\"], testFrame[rr, \"opportunities\"]-testFrame[rr, \"successes\"])), testFrame[rr, \"category\"])\n  })\ntallFrame &lt;- data.frame(do.call(rbind, tallFrame))\n</code></pre>\n\n<p>The resulting <code>tallFrame</code> is a matrix which I can then convert to a data.frame without any issues, but this seems like a lot of code for a simple task. Surely there is a way to do this more code-efficiently, perhaps with <code>plyr</code> or <code>reshape</code>, or maybe I'm just looking for some code golf.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["r","ggplot2","boxplot"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":126,"score":1,"question_id":12993545,"title":"How to put whisker ends on ggplot2 boxplot","body":"<p>I would like to put perpindicular lines at the ends of the whiskers like the boxplot command automatically gives.</p>\n\n<p>Thank you</p>\n"},{"tags":["r","stan"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":164,"score":1,"question_id":12848168,"title":"Will RStan run on a supercomputer?","body":"<p>Stan is a new Bayesian analysis software by Gelman et al.</p>\n\n<p><a href=\"http://andrewgelman.com/category/stan/\" rel=\"nofollow\">http://andrewgelman.com/category/stan/</a></p>\n\n<p>RStan is I, am guessing, a way to call Stan from within R.</p>\n\n<p>Will Stan / RStan run on a supercomputer with a Linux operating system, and if so can it take advantage of the super-computer's multi-processors?  I have been told that WinBUGS will not run on a Linux machine and/or cannot take advantage of a supercomputer's multi-processors.</p>\n\n<p>I am looking for a way to speed up Bayesian analyses... ...from weeks to days / hours.</p>\n\n<p>I realize these questions are not typical for Stackoverflow.  </p>\n\n<p>Hopefully, these questions are appropriate for one of the StackExchange sites and this post will be migrated instead of just closed.</p>\n\n<p>Alternatively, perhaps someone will email the answers to me personally if this post is closed.  I suppose I could email Gelman, but I thought I would try here first.  My email is provided on my StackExchange page.</p>\n\n<p>Thank you for any help.</p>\n"},{"tags":["r","igraph","weight","edges"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12998456,"title":"R igraph convert parallel edges to weight attribute","body":"<p>I'm working with igraph for R. My graph is based on an edgelist which includes parallel edges (more than one edge with the same source and target). I would like to convert these parallel edges to an edge attribute weight. Is there an eay way to do this?</p>\n\n<p>If there is no easy way. how can I identify these parallel edges? </p>\n\n<pre><code>    duplicated(E(net))\n</code></pre>\n\n<p>does not return a single duplicate. I suppose its looking for duplicated edge ids.</p>\n"},{"tags":["r","loops","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":165,"score":3,"question_id":12169289,"title":"ggplot2 - fail to apply color with scale_fill_manual inside a loop","body":"<p>I'm running a loop to get, at each sub setting of my data set, a map and apply a given palette (and respective legend) accordingly.</p>\n\n<p>People tend to dislike the use of for() loops and maximize vectorization of their approaches. I don't know the best way to vectorize processes with this particular data set.</p>\n\n<p>In this particular case, I'm handling a relatively large data set (distribution species Atlas) that is particularly complex since different methodologies were used and different options must be passed for each species, considering a particular season, different set of observations, etc.\nSpecies may be present at one season and missed into another (They may be a breeder, a resident or a migrant). Maps should be created for all cases (seasons), empty when absent. Additional data (besides those from field work) may be available and used.\nMap Legend must accommodate all variations, besides presenting variable in interest (abundances) in a custom discrete scale.</p>\n\n<p>By running a loop I feel (to my limited expertise) I can more easily retain and control the several needed objects, while stepping into the flux I created to produce the pieces of interest and finally create sets of species distributions maps.</p>\n\n<blockquote>\n  <p><strong>My Problem</strong> is that I'm storing each resulting ggplot in a list() object. Each species at each season will be stored in a list. The\n  issue I'm facing is related to <strong>scale_fill_manual</strong> when used\n  <strong>inside</strong> a <strong>loop</strong>.</p>\n</blockquote>\n\n<p>The behavior is strange since I get the maps done but with colors applied only to the last ggplot output. Nonetheless all values still being correctly identified in the legend.</p>\n\n<p>to exemplify:</p>\n\n<h2>Packages</h2>\n\n<pre><code>if (!require(ggplot2)) install.packages(\"ggplot2\",\n    repos = \"http://cran.r-project.org\"); library(ggplot2)\nif (!require(grid)) install.packages(\"grid\",\n    repos = \"http://cran.r-project.org\"); library(grid)\nif (!require(RColorBrewer)) install.packages(\"RColorBrewer\",\n    repos = \"http://cran.r-project.org\"); library(RColorBrewer)\nif (!require(reshape)) install.packages(\"reshape\",\n    repos = \"http://cran.r-project.org\"); library(reshape)\n</code></pre>\n\n<h1>A simple example first</h1>\n\n<pre><code>#Create a list of colors to be used with scale_manual\npalette.l &lt;- list()\npalette.l[[1]] &lt;- c('red', 'blue', 'green')\npalette.l[[2]] &lt;- c('pink', 'blue', 'yellow')\n# Store each ggplot in a list object\nplot.l &lt;- list()\n#Loop it\nfor(i in 1:2){\n  plot.l[[i]] &lt;- qplot(mpg, wt, data = mtcars, colour = factor(cyl)) +\n    scale_colour_manual(values = palette.l[[i]])\n}\n</code></pre>\n\n<blockquote>\n  <p>In my session plot.l[<a href=\"https://docs.google.com/open?id=0BxSZDr4eTnb9R09iSndzZjBMS28\" rel=\"nofollow\">1</a>] will be painted with colors from palette.l[<a href=\"http://i.stack.imgur.com/ymZOc.png\" rel=\"nofollow\">2</a>].</p>\n</blockquote>\n\n<h1>My particular case</h1>\n\n<h2>Functions</h2>\n\n<h3>Arrange Plots</h3>\n\n<pre><code>ArrangeGraph &lt;- function(..., nrow=NULL, ncol=NULL, as.table=FALSE) {\n  dots &lt;- list(...)\n  n &lt;- length(dots)\n  if(is.null(nrow) &amp; is.null(ncol)) { nrow = floor(n/2) ; ncol = ceiling(n/nrow)}\n  if(is.null(nrow)) { nrow = ceiling(n/ncol)}\n  if(is.null(ncol)) { ncol = ceiling(n/nrow)}\n  ## NOTE see n2mfrow in grDevices for possible alternative\n  grid.newpage()\n  pushViewport(viewport(layout=grid.layout(nrow,ncol)))\n  ii.p &lt;- 1\n  for(ii.row in seq(1, nrow)) {\n    ii.table.row &lt;- ii.row\n    if(as.table) {ii.table.row &lt;- nrow - ii.table.row + 1}\n    for(ii.col in seq(1, ncol)) {\n      ii.table &lt;- ii.p\n      if(ii.p &gt; n) break\n      print(dots[[ii.table]], vp=VPortLayout(ii.table.row, ii.col))\n      ii.p &lt;- ii.p + 1\n    }\n  }\n}\n</code></pre>\n\n<h3>ViewPort</h3>\n\n<pre><code>VPortLayout &lt;- function(x, y) viewport(layout.pos.row=x, layout.pos.col=y)\n</code></pre>\n\n<h2>Species data sets</h2>\n\n<pre><code>bd.aves.1 &lt;- structure(list(quad = c(\"K113\", \"K114\", \"K114\", \"K114\", \"K114\",...\ndue to limited body character number limit, please download entire code from\nhttps://docs.google.com/open?id=0BxSZDr4eTnb9R09iSndzZjBMS28\n</code></pre>\n\n<h3>Species list</h3>\n\n<pre><code>list.esp.1 &lt;- c(\"Sylv mela\", \"Saxi rube\",\"Ocea leuc\")#\n# download from the above link\n</code></pre>\n\n<h3>Some taxonomy and other data</h3>\n\n<pre><code>txcon.1 &lt;- structure(list(id = c(156L, 359L, 387L), grupo = c(\"Aves\", \"Aves\",# \n# download from the above link\n</code></pre>\n\n<h3>Seasons</h3>\n\n<pre><code>kSeason.1 &lt;- c(\"Inverno\", \"Primavera\", \"Outono\")\n</code></pre>\n\n<h2>A Sample Grid</h2>\n\n<pre><code>grid500.df.1 &lt;- structure(list(id = c(\"K113\", \"K113\", \"K113\", \"K113\", \"K113\",#... \n# download from the above link\n</code></pre>\n\n<h2>Additional Mapping elements</h2>\n\n<h3>Shoreline</h3>\n\n<pre><code>coastline.df.1 &lt;- structure(list(long = c(182554.963670234, 180518, 178865.39,#...\n# download from the above link\n</code></pre>\n\n<h3>Labels placement adjustments</h3>\n\n<pre><code>kFacx1 &lt;- c(9000, -13000, -10000, -12000)\n</code></pre>\n\n<h2>The R Code</h2>\n\n<pre><code>for(i in listsp.1) { # LOOP 1 - Species\n  # Set up objects \n  sist.i &lt;- list() # Sistematic observations\n  nsist.i &lt;- list() # Non-Sistematic observations\n  breaks.nind.1 &lt;- list() # Breaks on abundances\n  ## Grid and merged dataframe\n  spij.1 &lt;- list() # Stores a dataframe for sp i at season j\n  ## Palette build\n  classes.1 &lt;- list()\n  cllevels.1 &lt;- list()\n  palette.nind.1 &lt;- list() # Color palette\n  ## Maps\n  grid500ij.1 &lt;- list() # Grid for species i at season j\n  map.dist.ij.1 &lt;- NULL\n  for(j in 1:length(kSeason.1)) { # LOOP 2 - Seasons\n    # j assume each season: Inverno, Primavera, Outono\n    # Sistematic occurences ===================================================\n    sist.i.tmp &lt;- nrow(subset(bd.aves.1, esp == i &amp; cod_tipo %in% sistematica &amp;\n      periodo == kSeason.1[j]))\n    if (sist.i.tmp!= 0) { # There is sistematic entries, Then:\n      sist.i[[j]]&lt;- ddply(subset(bd.aves.1,\n                                 esp == i &amp; cod_tipo %in% sistematica &amp; \n                                   periodo == kSeason.1[j]),\n                          .(periodo, quad), summarise, nind = sum(n_ind),\n                          codnid = max(cod_nidi))\n    } else { # No Sistematic entries, Then: \n      sist.i[[j]] &lt;- data.frame('quad' = NA, 'periodo' = NA, 'nind' = NA, \n                                'codnid' = NA, stringsAsFactors = F)\n    }\n    # Additional Entries (RS1) e other non-sistematic entries  (biblio) =======\n    nsist.tmp.i = nrow(subset(bd.aves.1, esp == i &amp; !cod_tipo %in% sistematica &amp;\n      periodo == kSeason.1[j]))\n    if (nsist.tmp.i != 0) { # RS1 and biblio entries, Then:\n      nsist.i[[j]] &lt;- subset(bd.aves.1,\n                             esp == i &amp; !cod_tipo %in% sistematica &amp;\n                               periodo == kSeason.1[j] &amp; \n                               !quad %in% if (nrow(sist.i[[j]]) != 0) {\n                                            subset(sist.i[[j]],\n                                                   select = quad)$quad\n                                          } else NA,\n                             select = c(quad, periodo, cod_tipo, cod_nidi)\n                             )\n      names(nsist.i[[j]])[4] &lt;- 'codnid'\n    } else { # No RS1 and biblio entries, Then:      \n        nsist.i[[j]] = data.frame('quad' = NA, 'periodo' = NA, 'cod_tipo' = NA,\n                                'codnid' = NA, stringsAsFactors = F)\n      }\n    # Quantile breaks =========================================================\n    if (!is.na(sist.i[[j]]$nind[1])) {\n      breaks.nind.1[[j]] &lt;- c(0,\n                            unique(\n                              ceiling(\n                                quantile(unique(\n                                  subset(sist.i[[j]], is.na(nind) == F)$nind), \n                                         q = seq(0, 1, by = 0.25)))))\n    } else {\n        breaks.nind.1[[j]] &lt;- 0\n      }\n    # =========================================================================\n    # Build Species dataframe and merge to grid\n    # =========================================================================\n    if (!is.na(sist.i[[j]]$nind[1])) { # There are Sistematic entries, Then:\n      spij.1[[j]] &lt;- merge(unique(subset(grid500df.1, select = id)),\n                         sist.i[[j]],\n                         by.x = 'id', by.y = 'quad', all.x = T)\n      # Adjust abundances when equals to NA ===================================\n      spij.1[[j]]$nind[is.na(spij.1[[j]]$nind) == T] &lt;- 0\n      # Break abundances to create discrete variable ==========================\n      spij.1[[j]]$cln &lt;- if (length(breaks.nind.1[[j]]) &gt; 2) {\n        cut(spij.1[[j]]$nind, breaks = breaks.nind.1[[j]], \n            include.lowest = T, right = F)\n        } else {\n            cut2(spij.1[[j]]$nind, g = 2)\n          }\n      # Variable Abundance ====================================================\n      classes.1[[j]] = nlevels(spij.1[[j]]$cln)\n      cllevels.1[[j]] = levels(spij.1[[j]]$cln)\n      # Color Palette for abundances - isolated Zero class (color #FFFFFF) ====\n      if (length(breaks.nind.1[[j]]) &gt; 2) {\n        palette.nind.1[[paste(kSeason.1[j])]] = c(\"#FFFFFF\", brewer.pal(length(\n          cllevels.1[[j]]) - 1, \"YlOrRd\"))\n      } else {\n          palette.nind.1[[paste(kSeason.1[j])]] = c(\n            \"#FFFFFF\",  brewer.pal(3, \"YlOrRd\"))[1:classes.1[[j]]]\n        }\n        names(palette.nind.1[[paste(kSeason.1[j])]])[1 : length(\n          palette.nind.1[[paste(kSeason.1[j])]])] &lt;- cllevels.1[[j]]\n      # Add RS1 and bilbio values to palette ==================================\n      palette.nind.1[[paste(kSeason.1[j])]][length(\n        palette.nind.1[[paste(kSeason.1[j])]]) + 1] &lt;- '#CCC5AF'\n      names(palette.nind.1[[paste(kSeason.1[j])]])[length(\n        palette.nind.1[[paste(kSeason.1[j])]])] &lt;- 'Suplementar'\n      palette.nind.1[[paste(kSeason.1[j])]][length(\n        palette.nind.1[[paste(kSeason.1[j])]]) + 1] &lt;- '#ADCCD7'\n      names(palette.nind.1[[paste(kSeason.1[j])]])[length(\n        palette.nind.1[[paste(kSeason.1[j])]])] &lt;- 'Bibliografia'\n      # Merge species i dataframe to grid map =================================\n      grid500ij.1[[j]] &lt;- subset(grid500df.1, select = c(id, long, lat, order))\n      grid500ij.1[[j]]$cln = merge(grid500ij.1[[j]],\n                                 spij.1[[j]],\n                                 by.x = 'id', by.y = 'id', all.x = T)$cln\n      # Adjust factor levels of cln variable - Non-Sistematic data ============\n      levels(grid500ij.1[[j]]$cln) &lt;- c(levels(grid500ij.1[[j]]$cln), 'Suplementar',\n                                      'Bibliografia')\n      if (!is.na(nsist.i[[j]]$quad[1])) {\n        grid500ij.1[[j]]$cln[grid500ij.1[[j]]$id %in% subset(\n          nsist.i[[j]], cod_tipo == 'RS1', select = quad)$quad] &lt;- 'Suplementar'\n        grid500ij.1[[j]]$cln[grid500ij.1[[j]]$id %in% subset(\n          nsist.i[[j]], cod_tipo == 'biblio', select = quad)$quad] &lt;- 'Bibliografia'\n      }\n    } else { # No Sistematic entries, Then:\n        if (!is.na(nsist.i[[j]]$quad[1])) { # RS1 or Biblio entries, Then:\n          grid500ij.1[[j]] &lt;- grid500df\n          grid500ij.1[[j]]$cln &lt;- '0'\n          grid500ij.1[[j]]$cln &lt;- factor(grid500ij.1[[j]]$cln)\n          levels(grid500ij.1[[j]]$cln) &lt;- c(levels(grid500ij.1[[j]]$cln),\n                                          'Suplementar', 'Bibliografia')\n          grid500ij.1[[j]]$cln[grid500ij.1[[j]]$id %in% subset(\n            nsist.i[[j]], cod_tipo == 'RS1', \n            select = quad)$quad] &lt;- 'Suplementar'\n          grid500ij.1[[j]]$cln[grid500ij.1[[j]]$id %in% subset(\n            nsist.i[[j]],cod_tipo == 'biblio', \n            select = quad)$quad] &lt;- 'Bibliografia'\n        } else { # No entries, Then:\n            grid500ij.1[[j]] &lt;- grid500df\n            grid500ij.1[[j]]$cln &lt;- '0' \n            grid500ij.1[[j]]$cln &lt;- factor(grid500ij.1[[j]]$cln)\n            levels(grid500ij.1[[j]]$cln) &lt;- c(levels(grid500ij.1[[j]]$cln),\n                                            'Suplementar', 'Bibliografia')      \n          }\n      } # End of Species dataframe build\n    # Distribution Map for  species i at season j =============================    \n    if (!is.na(sist.i[[j]]$nind[1])) { # There is sistematic entries, Then:\n      map.dist.ij.1[[paste(kSeason.1[j])]] &lt;- ggplot(grid500ij.1[[j]],\n                                                  aes(x = long, y = lat)) +\n        geom_polygon(aes(group = id, fill = cln), colour = 'grey80') +\n        coord_equal() +\n        scale_x_continuous(limits = c(100000, 180000)) +\n        scale_y_continuous(limits = c(-4000, 50000)) +\n        scale_fill_manual(\n          name = paste(\"LEGEND\",\n                       '\\nSeason: ', kSeason.1[j],\n                       '\\n% of Occupied Cells : ',\n                         sprintf(\"%.1f%%\", (length(unique(\n                           grid500ij.1[[j]]$id[grid500ij.1[[j]]$cln != levels(\n                           grid500ij.1[[j]]$cln)[1]]))/12)*100), # percent \n                        sep = \"\"\n                       ),\n          # Set Limits\n          limits = names(palette.nind.1[[j]])[2:length(names(palette.nind.1[[j]]))],\n          values = palette.nind.1[[j]][2:length(names(palette.nind.1[[j]]))],\n          drop = F) +\n          opts(\n            panel.background = theme_rect(),\n            panel.grid.major = theme_blank(),\n            panel.grid.minor = theme_blank(),\n            axis.ticks = theme_blank(),\n            title = txcon.1$especie[txcon.1$esp == i],\n            plot.title = theme_text(size = 10, face = 'italic'),\n            axis.text.x = theme_blank(),\n            axis.text.y = theme_blank(),\n            axis.title.x = theme_blank(),\n            axis.title.y = theme_blank(),\n            legend.title = theme_text(hjust = 0,size = 10.5),\n            legend.text = theme_text(hjust = -0.2, size = 10.5)\n          ) +\n          # Shoreline\n          geom_path(inherit.aes = F, aes(x = long, y = lat),\n                    data = coastline.df.1, colour = \"#997744\") +\n          # Add localities\n          geom_point(inherit.aes = F, aes(x = x, y = y),  colour = 'grey20',\n                     data = localidades, size = 2) +\n          # Add labels\n          geom_text(inherit.aes = F, aes(x = x, y = y, label = c('Burgau',\n                                                                 'Sagres')),\n                    colour = \"black\",\n                    data = data.frame(x = c(142817 + kFacx1[1], 127337 + kFacx1[4]),\n                                      y = c(11886, 3962), size = 3))\n    } else { # NO sistematic entries,then:\n        map.dist.ij.1[[paste(kSeason.1[j])]] &lt;- ggplot(grid500ij.1[[j]],\n                                                    aes(x = long, y = lat)) +\n          geom_polygon(aes.inherit = F, aes(group = id, fill = cln),\n                       colour = 'grey80') +\n          #scale_color_manual(values = kCorLimiteGrid) +\n          coord_equal() +\n          scale_x_continuous(limits = c(100000, 40000)) +\n          scale_y_continuous(limits = c(-4000, 180000)) +\n          scale_fill_manual(\n            name = paste('LEGENDA',\n                         '\\nSeason: ', kSeason.1[j],\n                         '\\n% of Occupied Cells :',\n                         sprintf(\"%.1f%%\", (length(unique(\n                           grid500ij.1[[j]]$id[grid500ij.1[[j]]$cln != levels(\n                           grid500ij.1[[j]]$cln)[1]]))/12 * 100)), # percent \n                         sep = ''),\n            limits = names(kPaletaNsis)[2:length(names(kPaletaNsis))],\n            values = kPaletaNsis[2:length(names(kPaletaNsis))],\n            drop = F) +\n            opts(\n              panel.background = theme_rect(),\n              panel.grid.major = theme_blank(),\n              panel.grid.minor = theme_blank(),\n              title = txcon.1$especie[txcon.1$esp == i],\n              plot.title = theme_text(size = 10, face = 'italic'),\n              axis.ticks = theme_blank(),\n              axis.text.x = theme_blank(),\n              axis.text.y = theme_blank(),\n              axis.title.x = theme_blank(),\n              axis.title.y = theme_blank(),\n              legend.title = theme_text(hjust = 0,size = 10.5),\n              legend.text = theme_text(hjust = -0.2, size = 10.5)\n            ) +\n            # Add Shoreline\n            geom_path(inherit.aes = F, data = coastline.df.1,\n                      aes(x = long, y = lat),\n                      colour = \"#997744\") +\n            # Add Localities\n            geom_point(inherit.aes = F, aes(x = x, y = y),\n                       colour = 'grey20',\n                       data = localidades, size = 2) +\n            # Add labels\n            geom_text(inherit.aes = F, aes(x = x, y = y,\n                                           label = c('Burgau', 'Sagres')),\n                      colour = \"black\",\n                      data = data.frame(x = c(142817 + kFacx1[1],\n                                              127337 + kFacx1[4],),\n                                        y = c(11886, 3962)),\n                      size = 3)\n      } # End of Distribution map building for esp i and j seasons\n  } # Fim do LOOP 2: j Estacoes\n  # Print Maps\n  png(file = paste('panel_species',i,'.png', sep = ''), res = 96, \n      width = 800, height = 800)\n  ArrangeGraph(map.dist.ij.1[[paste(kSeason.1[3])]],\n               map.dist.ij.1[[paste(kSeason.1[2])]],\n               map.dist.ij.1[[paste(kSeason.1[1])]],\n               ncol = 2, nrow = 2)\n  dev.off()\n  graphics.off()\n} # End of LOOP 1\n</code></pre>\n\n<p>map.dist.ij.1[[paste(kSeason.1[3])]] is the only with color palette applied to polygons, but the legend items is well defined for each j map.</p>\n\n<h2>Output using R Code</h2>\n\n<p><img src=\"http://i.stack.imgur.com/ymZOc.png\" alt=\"enter image description here\"></p>\n\n<blockquote>\n  <p>As we see, Legends are OK but <strong>not colored</strong>.</p>\n</blockquote>\n\n<p>Hope not missing anything. Sorry for some lost Portuguese terminology.</p>\n"},{"tags":["r","forecasting","hierarchical-clustering","hclust"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":145,"score":0,"question_id":11127843,"title":"Extracting the tree structure in text from hclust in R","body":"<p>In the scope of a demand forecasting project, I would like to determine the best way to group time series that have similarity with each other so I can apply a Top Down forecasting algorithm. At the moment, my key question is to determine what are the appropriate groups and what is the appropriate hierarchy of those groups. After doing some reading, I believe that Dynamic Time Warping might help. In order to test this, I have created a little test case but I am facing one problem and that is how I can extract the hierarchy in for example a text tree or something similar. I am hoping that maybe one of you will be able to help me further. </p>\n\n<p>I have created the following case to demonstrate what I get to.</p>\n\n<pre><code>sc2 &lt;- read.table(\"http://dl.dropbox.com/u/9641130/R/hclust.data\", header=F, sep=\"\")\nSampleLabels &lt;- c(\"ID1\", \"ID2\", \"ID3\", \"ID4\", \"ID5\", \"ID6\", \"ID7\", \"ID8\", \"ID9\", \"ID10\", \"ID11\", \"ID12\", \"ID13\", \"ID14\", \"ID15\")\ndistMatrix2 &lt;- dist(sc2, method=\"DTW\")\nhc2 &lt;- hclust(distMatrix2, method=\"average\")\n# show the visual tree\nplot(hc2, labels=SampleLabels)\n</code></pre>\n\n<p>Somehow, I would like to get the names and members of the clusters out in text so that I can continue to work with it. Anybody an idea? </p>\n\n<p>Thanks!</p>\n"},{"tags":["r","reshape","reshape2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12998864,"title":"reshape function gives \"subscript out of bounds\" error","body":"<p>I have a ROC.Value data frame that looks like this:</p>\n\n<pre><code>Years   1           2   3       4   5\n2002    3.000000    NA  0.22    NA      0\n2003    2.988000    NA  0.22    NA      0\n2004    2.993976    NA  0.22    NA      0\n2005    3.071819    NA  0.22    NA      NA\n2006    3.314493    NA  0.22    NA      NA\n2007    3.526621    NA  0.22    NA      NA\n2008    3.583047    NA  0.22    NA      NA\n2009    4.109754    NA  0.22    NA      NA\n2010    4.085096    NA  0.22    3.00    NA\n2011    3.885096    NA  0.22    2.85    NA\n2012    3.685096    NA  0.22    2.70    NA\n2013    3.485096    NA  0.22    2.55    NA\n2014    3.285096    NA  0.22    2.40    NA\n2015    3.085096    NA  0.22    2.25    NA\n2016    2.885096    NA  0.22    2.10    NA\n2017    2.685096    NA  0.22    1.95    NA\n2018    2.485096    NA  0.22    1.80    NA\n2019    2.285096    NA  0.22    1.65    NA\n2020    2.085096    NA  0.22    1.50    NA\n2021    1.885096    NA  0.22    1.50    NA\n</code></pre>\n\n<p>The NA values will be replaced, when i get the correct data.</p>\n\n<p>When i with the following code try and converting it into long format (so i can make a stacked boxplot):</p>\n\n<pre><code>m.ROC.Value = reshape(ROC.Value, \n                  idvar=\"Years\", \n                  direction=\"long\", \n                  varying=list(colnames(ROC.Value[2:6])),\n                  timevar=\"Characteristic\"\n                  )\n</code></pre>\n\n<p>I get this error <code>Error in reshapeLong(data, idvar = idvar, timevar = timevar, varying = varying, : subscript out of bounds</code>.</p>\n\n<p>Any suggesting? Everything I tried didn't work out (gave a new error).</p>\n"},{"tags":["r","statistics","glm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13000839,"title":"Logistic regression error","body":"<pre><code>Test &lt;- read.table(\"C:/Users/ARAB/Documents/user_table.csv\", header=T)\ntestlog &lt;- glm(Conv ~ active_days, family=binomial(\"logit\"))\n</code></pre>\n\n<p>this is a code i am trying to run in R but am getting error</p>\n\n<pre><code>\"Error in eval(expr, envir, enclos) : object 'Conv' not found\"\n</code></pre>\n\n<p>This is my first day in R. Please help me. \nAlso I can see <code>Conv</code> in data when i am using <code>view()</code> command. <code>Conv</code> is the outcome variable containing 1/0. Also in sas or spss we have the option of modelling 1 or 0 in a binary logit model. How can we use that in R or does this error have something to do with that.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":70,"score":3,"question_id":13000506,"title":"Construct a transform statement on the fly","body":"<p>I've got a dataframe with several (numeric) columns, and want to make a new dataframe whose columns are the ranks of the originals.</p>\n\n<pre><code>&gt; df &lt;- data.frame(cbind(id=LETTERS[1:10],  \nwheat=c(123,234,345,456,678,987,876,654,432,321),barley=c(135,975,246,864,357,753,468,642,579,531)))\n&gt; df\n   id wheat barley\n1   A   123    135\n2   B   234    975\n3   C   345    246\n4   D   456    864\n5   E   678    357\n6   F   987    753\n7   G   876    468\n8   H   654    642\n9   I   432    579\n10  J   321    531\n&gt; rankeddf &lt;- transform(df, wheat=rank(wheat), barley=rank(barley))\n&gt; rankeddf\n   id wheat barley\n1   A     1      1\n2   B     2     10\n3   C     4      2\n4   D     6      9\n5   E     8      3\n6   F    10      8\n7   G     9      4\n8   H     7      7\n9   I     5      6\n10  J     3      5\n</code></pre>\n\n<p>The thing is, the number and names of the columns vary. I have a vector that specifies them:</p>\n\n<pre><code>cols &lt;- c(\"wheat\", \"barley\")\n</code></pre>\n\n<p>How can I construct the <code>transform</code> statement on the fly? Or even loop through the <code>cols</code> vector, applying a <code>transform</code> statement once on each iteration? I'm guessing the answer is going to have something to do with <code>eval</code> or <code>evalq</code>, but I haven't quite got my head around them yet. For instance,</p>\n\n<pre><code>&gt; rankeddf2 &lt;- df\n&gt; for (col in cols) {rankeddf2 &lt;- transform(rankeddf2, evalq(paste(col,\"=rank(\",col,\")\",sep=\"\")))}\n&gt; rankeddf2\n   id wheat barley\n1   A   123    135\n2   B   234    975\n3   C   345    246\n4   D   456    864\n5   E   678    357\n6   F   987    753\n7   G   876    468\n8   H   654    642\n9   I   432    579\n10  J   321    531\n</code></pre>\n\n<p>doesn't do the trick.</p>\n\n<p>Alternatively, is there another way of doing this?</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13000602,"title":"Multiple Imputation in R: mice vs. mi package","body":"<p>what are the advantages and disadvantages of these two packages for multiple imputation?</p>\n\n<p>Here is my motivation for asking this question: I have used the <code>mi</code> package so far but I am unable to get convergence. My dataset is about 10,231x28. Four variables have 18-20% missing values, one has 14% and the rest is around 5% (or below). No convergence even after running on a server for 18 hours. Now I am wondering whether <code>mice</code> might work better.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":12999498,"title":"Substitute values (for specific dates) from a second data frame to the first data frame","body":"<p>I have two time series data frames: </p>\n\n<p>The first one:</p>\n\n<pre><code>head(df1) :\n\n            MSCI ACWI    DJGlbl Russell 1000 Russell Dev S&amp;P GSCI Industrial  S&amp;P GSCI Precious\n1999-03-01 -0.7000000 0.2000000   -0.1000000  -1.5000000           -1.0000000        -0.4000000\n1999-03-02 -0.5035247 0.0998004   -0.7007007  -0.2030457            0.4040404        -0.3012048\n1999-03-03 -0.2024291 0.2991027    0.0000000  -0.6103764            0.1006036        -0.1007049\n1999-03-04  0.7099391 0.2982107    1.5120968  -0.1023541            0.5025126         0.4032258\n1999-03-05  2.4169184 0.8919722    2.1847071   2.7663934           -1.2000000         0.0000000\n1999-03-08  0.3933137 0.3929273    0.5830904  -0.0997009           -0.2024291         1.1044177\n\n\ntail(df1) : \n\n             MSCI ACWI      DJGlbl Russell 1000 Russell Dev S&amp;P GSCI Industrial  S&amp;P GSCI Precious\n2011-12-23  0.68241470  0.84790673    0.9441385   0.6116208            0.5822862        -0.2345300\n2011-12-26 -0.05213764  0.00000000    0.0000000   0.0000000            0.0000000         0.0000000\n2011-12-27  0.20865936  0.05254861    0.3117693   0.2431611            0.0000000        -0.7233273\n2011-12-28 -0.62467465 -1.20798319   -1.1655012  -0.9702850           -2.0414381        -2.4043716\n2011-12-29  0.52383447  0.47846890    0.8647799   0.5511329           -0.0933126        -1.2504666\n2011-12-30  0.26055237  1.03174603   -0.4676539   1.2180268            1.9613948         1.7388017\n</code></pre>\n\n<p>The second one:</p>\n\n<pre><code>    head(df2) :\n                 MSCI.ACWI     DJGlbl Russell.1000 Russell.Dev S.P.GSCI.Industrial S.P.GSCI.Precious\n     1999-06-01  0.00000000 0.24438520    0.0000000           0         -0.88465521       0.008522842\n     1999-07-01  0.12630441 0.06755621    0.0000000           0          0.29394697       0.000000000\n     1999-08-02  0.07441812 0.18922829    0.0000000           0          0.02697299      -0.107155063\n     1999-09-01 -0.36952701 0.08684107    0.1117509           0          0.24520976       0.000000000\n     1999-10-01  0.00000000 0.00000000    0.0000000           0          0.00000000       1.941266205\n     1999-11-01  0.41879925 0.00000000    0.0000000           0          0.00000000      -0.197897901\n\n\n    tail(df2) :\n                 MSCI.ACWI    DJGlbl  Russell.1000 Russell.Dev S.P.GSCI.Industrial S.P.GSCI.Precious\n     2011-07-01  0.00000000 0.0000000    0.0000000   0.0000000          0.00000000        -0.1141162\n     2011-08-01  0.00000000 0.0000000    0.0000000   0.0000000          0.02627347         0.0000000\n     2011-09-01 -0.02470873 0.2977585   -0.0911891   0.6367605          0.00000000         0.2830977\n     2011-10-03  0.42495188 0.0000000    0.4200743  -0.4420027         -0.41012646         0.0000000\n     2011-11-01  0.00000000 0.0000000    0.0000000  -0.6597739          0.00000000         0.0000000\n     2011-12-01  0.50273034 0.0000000    0.0000000   0.6476393          0.00000000         0.0000000\n</code></pre>\n\n<p>The first df cointains daily observations. The second df contains <strong>only</strong> the \"first day of each month\" forecasted values.\nI would like to substitute the values from the second df into the first one. In other words, the \"first day of each month\" values in the first df will be substituted for the \"first day of each month\" values from the second df. \nI tried to write an lapply loop that substitutes the values and was only trying to use match function. But I failed. I could not find the similar question at StackOverflow either...</p>\n\n<p>Greatful for any suggestions!</p>\n\n<p>P.S.</p>\n\n<p>The thing is that the above df's are time series. Namely I convert the df's to time series :</p>\n\n<pre><code>library(fPortfolio)\ncharvec=dfnottimeseries[,1]\ndf1=as.timeSeries(dfnottimeseries,charvec)\n</code></pre>\n\n<p>and the same for the second df (df2). For example:</p>\n\n<pre><code>dput(head(df1)) :\nnew(\"timeSeries\"\n    , .Data = structure(c(-0.700000000000003, -0.503524672708963, -0.202429149797574, \n0.709939148073025, 2.41691842900303, 0.393313667649942, 0.200000000000003, \n0.0998003992015911, 0.299102691924224, 0.298210735586492, 0.891972249752221, \n0.392927308447943, -0.0999999999999943, -0.700700700700703, 0, \n1.51209677419355, 2.18470705064548, 0.583090379008741, -1.5, \n-0.203045685279191, -0.610376398779241, -0.102354145342895, 2.76639344262295, \n-0.0997008973080701, -1, 0.40404040404041, 0.100603621730377, \n0.50251256281407, -1.2, -0.202429149797574, -0.400000000000006, \n-0.301204819277106, -0.100704934541787, 0.403225806451604, 0, \n1.10441767068274, 0.0999999999999943, 1.59840159840161, 2.94985250737463, \n3.15186246418338, 0.55555555555555, 2.30202578268877, -0.0999999999999943, \n0.800800800800798, 0.496524329692155, 0.691699604743086, 0.196270853778203, \n0.685602350636634, -0.0999999999999943, 0, -0.100100100100109, \n-0.100200400801598, 0.100300902708119, 0.300601202404807, -0.799999999999997, \n0, -0.302419354838707, 0, 0.707785642062678, -0.200803212851394, \n-0.200000000000003, -0.200400801603209, -0.100401606425697, -0.201005025125631, \n0.201409869083588, 0.100502512562808, -0.200000000000003, -0.200400801603209, \n-0.100401606425697, -0.201005025125631, 0.201409869083588, 0.100502512562808, \n0, -0.299999999999997, -1.00300902708124, -0.303951367781152, \n0.711382113821127, 0.40363269424824, -0.00938085999999316, 0.00938174008789637, \n-0.196998120000003, -0.0751950428206875, 0.0470322689501711, \n0.047010148983195, -0.00938085999999316, 0.00938174008789637, \n-0.196998120000003, -0.0751950428206875, 0.0470322689501711, \n0.047010148983195), .Dim = c(6L, 15L), .Dimnames = list(c(\"1999-03-01\", \n\"1999-03-02\", \"1999-03-03\", \"1999-03-04\", \"1999-03-05\", \"1999-03-08\"\n), c(\"MSCI ACWI\", \"DJGlbl\", \"Russell 1000\", \"Russell Dev\", \"S&amp;P GSCI Industrial \", \n\"S&amp;P GSCI Precious\", \"S&amp;P GSCI Energy\", \"UBS Bloomberg\", \"iBoxx $ Liquid\", \n\"IBOXX ??? LQD\", \"iBoxx $ Liquid High Yield\", \"Markit IBOXX\", \n\"DBIQ Emerging\", \"Barclays US\", \"iBoxx Sov Euro IL\")))\n    , units = c(\"MSCI ACWI\", \"DJGlbl\", \"Russell 1000\", \"Russell Dev\", \"S&amp;P GSCI Industrial \", \n\"S&amp;P GSCI Precious\", \"S&amp;P GSCI Energy\", \"UBS Bloomberg\", \"iBoxx $ Liquid\", \n\"IBOXX ??? LQD\", \"iBoxx $ Liquid High Yield\", \"Markit IBOXX\", \n\"DBIQ Emerging\", \"Barclays US\", \"iBoxx Sov Euro IL\")\n    , positions = c(920246400, 920332800, 920419200, 920505600, 920592000, 920851200\n)\n    , format = \"%Y-%m-%d\"\n    , FinCenter = \"GMT\"\n    , recordIDs = structure(list(), .Names = character(0), row.names = integer(0), class = \"data.frame\")\n    , title = \"Time Series Object\"\n    , documentation = \"Sun Oct 21 16:13:25 2012\"\n)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>dput(head(df2))\nnew(\"timeSeries\"\n    , .Data = structure(c(0, 0.126304409, 0.074418121, -0.369527006, 0, 0.41879925, \n0.244385197, 0.067556211, 0.189228292, 0.086841066, 0, 0, 0, \n0, 0, 0.111750885, 0, 0, 0, 0, 0, 0, 0, 0, -0.88465521, 0.293946971, \n0.026972992, 0.245209764, 0, 0, 0.008522842, 0, -0.107155063, \n0, 1.941266205, -0.197897901, -0.013096887, 0, 0, 0.388013092, \n0.372488895, 0, -0.19041112, 0.136631233, 0, 0.183846748, 0.197612269, \n0, -0.002248848, 0.274449827, -0.143453619, -0.128428882, 0, \n0.144213551, -0.044105244, 0, -0.137138837, -0.074970085, 0, \n0, -0.128433675, 0.141883192, -0.052900591, -0.062071483, 0.062037765, \n0, -0.128433675, 0.141883192, -0.052900591, -0.062071483, 0.062037765, \n0, -0.133904169, 0.360826639, -0.040831396, -0.060762388, 0, \n0.129691732, 0.050392981, 0.020081642, 0.01978185, 0.030688482, \n0, 0.012962734, 0.050392981, 0.020081642, 0.01978185, 0.030688482, \n0, 0.012962734), .Dim = c(6L, 15L), .Dimnames = list(NULL, c(\"MSCI ACWI\", \n\"DJGlbl\", \"Russell 1000\", \"Russell Dev\", \"S&amp;P GSCI Industrial \", \n\"S&amp;P GSCI Precious\", \"S&amp;P GSCI Energy\", \"UBS Bloomberg\", \"iBoxx $ Liquid\", \n\"IBOXX ??? LQD\", \"iBoxx $ Liquid High Yield\", \"Markit IBOXX\", \n\"DBIQ Emerging\", \"Barclays US\", \"iBoxx Sov Euro IL\")))\n    , units = c(\"MSCI ACWI\", \"DJGlbl\", \"Russell 1000\", \"Russell Dev\", \"S&amp;P GSCI Industrial \", \n\"S&amp;P GSCI Precious\", \"S&amp;P GSCI Energy\", \"UBS Bloomberg\", \"iBoxx $ Liquid\", \n\"IBOXX ??? LQD\", \"iBoxx $ Liquid High Yield\", \"Markit IBOXX\", \n\"DBIQ Emerging\", \"Barclays US\", \"iBoxx Sov Euro IL\")\n    , positions = c(928195200, 930787200, 933552000, 936144000, 938736000, 941414400\n)\n    , format = \"%Y-%m-%d\"\n    , FinCenter = \"GMT\"\n    , recordIDs = structure(list(), .Names = character(0), row.names = integer(0), class = \"data.frame\")\n    , title = \"Time Series Object\"\n    , documentation = \"Sun Oct 21 19:10:08 2012\"\n)\n</code></pre>\n"},{"tags":["r","signal-processing","http-live-streaming"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12999827,"title":"Importing M3U stream in R","body":"<p>This is the link for the live audio stream from a VLF receiver</p>\n\n<pre><code>http://67.207.143.181/vlf19.m3u\n</code></pre>\n\n<p>I need to know the method for importing this live stream. If R is not suitable for such kind of signal processing, Please to suggest alternatives for processing and visualizing live data.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":12999576,"title":"Dynamically load functions","body":"<p>If I define a function in an external file, I have to use <code>source</code> to load it in. So if I'm modifying a function, my process looks like:</p>\n\n<ol>\n<li>Make changes in file</li>\n<li>Source</li>\n<li>Test changes</li>\n<li>Back to 1</li>\n</ol>\n\n<p>Is there any way to remove #2? E.g. in Octave it just dynamically searches your path to find the appropriate file every time you call a function.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":127,"score":2,"question_id":12985653,"title":"What does 'length of 'dimnames' [1] not equal to array extent' mean?","body":"<p>I have a data.frame, which I can plot using matplot:</p>\n\n<pre><code>&gt; dim(lhbyzone)\n[1] 38070    21\n&gt; matplot(lhbyzone)\n(no error occurs here)\n</code></pre>\n\n<p>But if I take the head of lh, and try, it gives me a strange error:</p>\n\n<pre><code>&gt; foo &lt;- head(lhbyzone,1000)\n&gt; matplot(foo)\nError in `rownames&lt;-`(`*tmp*`, value = c(\"1\", \"2\", \"3\", \"4\", \"5\", \"6\",  : \n  length of 'dimnames' [1] not equal to array extent\n</code></pre>\n\n<p>So, maybe something to do with the names? </p>\n\n<pre><code>&gt; dimnames(foo)\n[[1]]\n   [1] \"1\"    \"2\"    \"3\"    \"4\"    \"5\"    \"6\"    \"7\"    \"8\"    \"9\"    \"10\"  \n  [11] \"11\"   \"12\"   \"13\"   \"14\"   \"15\"   \"16\"   \"17\"   \"18\"   \"19\"   \"20\"  \n  [21] \"21\"   \"22\"   \"23\"   \"24\"   \"25\"   \"26\"   \"27\"   \"28\"   \"29\"   \"30\"  \n  [31] \"31\"   \"32\"   \"33\"   \"34\"   \"35\"   \"36\"   \"37\"   \"38\"   \"39\"   \"40\"  \n...\n [951] \"951\"  \"952\"  \"953\"  \"954\"  \"955\"  \"956\"  \"957\"  \"958\"  \"959\"  \"960\" \n [961] \"961\"  \"962\"  \"963\"  \"964\"  \"965\"  \"966\"  \"967\"  \"968\"  \"969\"  \"970\" \n [971] \"971\"  \"972\"  \"973\"  \"974\"  \"975\"  \"976\"  \"977\"  \"978\"  \"979\"  \"980\" \n [981] \"981\"  \"982\"  \"983\"  \"984\"  \"985\"  \"986\"  \"987\"  \"988\"  \"989\"  \"990\" \n [991] \"991\"  \"992\"  \"993\"  \"994\"  \"995\"  \"996\"  \"997\"  \"998\"  \"999\"  \"1000\"\n\n[[2]]\n [1] \"time\" \"z1\"   \"z2\"   \"z3\"   \"z4\"   \"z5\"   \"z6\"   \"z7\"   \"z8\"   \"z9\"  \n[11] \"z10\"  \"z11\"  \"z12\"  \"z13\"  \"z14\"  \"z15\"  \"z16\"  \"z17\"  \"z18\"  \"z19\" \n[21] \"z20\" \n\n&gt; dim(foo)\n[1] 1000   21\n\n&gt; names(foo)\n [1] \"time\" \"1\"    \"2\"    \"3\"    \"4\"    \"5\"    \"6\"    \"7\"    \"8\"    \"9\"   \n[11] \"10\"   \"11\"   \"12\"   \"13\"   \"14\"   \"15\"   \"16\"   \"17\"   \"18\"   \"19\"  \n[21] \"20\" \n</code></pre>\n\n<p>The dimensions look the same?  It's odd, since matplot on the original frame works, but not on the head of the frame.  What could be happening here?</p>\n\n<p>Edit, ok, so to answer some questions, and let's use thbyzone instead of lhbyzone, because it's smaller, and let's use head instead of head(..,1000) to make the data smaller</p>\n\n<pre><code>&gt; head(thbyzone)\n  time  1  2  3  4  5  6  7  8  9 10 11\n1    1 46 38 44 45 42 44 45 43 41 42 36\n2    2 46 36 42 43 42 43 44 44 39 43 32\n3    3 45 35 40 41 40 42 41 42 36 43 31\n4    4 41 30 36 37 39 38 40 34 35 39 30\n5    5 39 30 34 33 40 38 35 30 33 35 34\n6    6 35 29 32 32 41 37 35 35 36 35 35\n\n&gt; dimnames(head(thbyzone))\n[[1]]\n[1] \"1\" \"2\" \"3\" \"4\" \"5\" \"6\"\n\n[[2]]\n [1] \"time\" \"1\"    \"2\"    \"3\"    \"4\"    \"5\"    \"6\"    \"7\"    \"8\"    \"9\"   \n[11] \"10\"   \"11\" \n\n&gt; matplot(head(thbyzone))\nError in `rownames&lt;-`(`*tmp*`, value = c(\"1\", \"2\", \"3\", \"4\", \"5\", \"6\",  : \n  length of 'dimnames' [1] not equal to array extent\n\n&gt; matplot(as.matrix(head(thbyzone)))\nError in `rownames&lt;-`(`*tmp*`, value = c(\"1\", \"2\", \"3\", \"4\", \"5\", \"6\",  : \n  length of 'dimnames' [1] not equal to array extent\n\n&gt; matplot(thbyzone[1:6,])\nError in `rownames&lt;-`(`*tmp*`, value = c(\"1\", \"2\", \"3\", \"4\", \"5\", \"6\",  : \n  length of 'dimnames' [1] not equal to array extent\n\n&gt; class(thbyzone)\n[1] \"cast_df\"    \"data.frame\"\n\n&gt; str(thbyzone)\nList of 12\n $ time: num [1:39432] 1 2 3 4 5 6 7 8 9 10 ...\n $ 1   : int [1:39432] 46 46 45 41 39 35 33 33 36 47 ...\n $ 2   : int [1:39432] 38 36 35 30 30 29 28 28 28 33 ...\n $ 3   : int [1:39432] 44 42 40 36 34 32 30 30 30 32 ...\n $ 4   : int [1:39432] 45 43 41 37 33 32 30 29 30 41 ...\n $ 5   : int [1:39432] 42 42 40 39 40 41 38 33 36 43 ...\n $ 6   : int [1:39432] 44 43 42 38 38 37 36 36 38 44 ...\n $ 7   : int [1:39432] 45 44 41 40 35 35 33 30 31 39 ...\n $ 8   : int [1:39432] 43 44 42 34 30 35 34 33 34 41 ...\n $ 9   : int [1:39432] 41 39 36 35 33 36 32 31 31 35 ...\n $ 10  : int [1:39432] 42 43 43 39 35 35 33 33 35 42 ...\n $ 11  : int [1:39432] 36 32 31 30 34 35 32 30 28 30 ...\n - attr(*, \"row.names\")= int [1:39432] 1 2 3 4 5 6 7 8 9 10 ...\n - attr(*, \"idvars\")= chr \"time\"\n - attr(*, \"rdimnames\")=List of 2\n  ..$ :'data.frame':    39432 obs. of  1 variable:\n  .. ..$ time: num [1:39432] 1 2 3 4 5 6 7 8 9 10 ...\n  ..$ :'data.frame':    11 obs. of  1 variable:\n  .. ..$ station_id: int [1:11] 1 2 3 4 5 6 7 8 9 10 ...\n\n&gt; traceback()\n.... lots of lines ...\n   \"39405\", \"39406\", \"39407\", \"39408\", \"39409\", \"39410\", \"39411\", \n   \"39412\", \"39413\", \"39414\", \"39415\", \"39416\", \"39417\", \"39418\", \n   \"39419\", \"39420\", \"39421\", \"39422\", \"39423\", \"39424\", \"39425\", \n   \"39426\", \"39427\", \"39428\", \"39429\", \"39430\", \"39431\", \"39432\"\n   ))\n4: as.matrix.cast_df(y)\n3: as.matrix(y)\n2: ncol(y &lt;- as.matrix(y))\n1: matplot(thbyzone[1:6, ])\n</code></pre>\n\n<p>Some more attempts:</p>\n\n<pre><code>&gt; foo &lt;- head(thbyzone)\n&gt; foo$time &lt;- NULL\n&gt; matplot(foo)\nError in `rownames&lt;-`(`*tmp*`, value = c(\"1\", \"2\", \"3\", \"4\", \"5\", \"6\",  : \n  length of 'dimnames' [1] not equal to array extent\n&gt; head(foo)\n   1  2  3  4  5  6  7  8  9 10 11\n1 46 38 44 45 42 44 45 43 41 42 36\n2 46 36 42 43 42 43 44 44 39 43 32\n3 45 35 40 41 40 42 41 42 36 43 31\n4 41 30 36 37 39 38 40 34 35 39 30\n5 39 30 34 33 40 38 35 30 33 35 34\n6 35 29 32 32 41 37 35 35 36 35 35\n</code></pre>\n\n<p>Edit:</p>\n\n<pre><code>&gt; options(error=recover)\n&gt; matplot(thbyzone[1:6,])\nError in `rownames&lt;-`(`*tmp*`, value = c(\"1\", \"2\", \"3\", \"4\", \"5\", \"6\",  : \n  length of 'dimnames' [1] not equal to array extent\n\nEnter a frame number, or 0 to exit   \n\n1: matplot(thbyzone[1:6, ])\n2: ncol(y &lt;- as.matrix(y))\n3: as.matrix(y)\n4: as.matrix.cast_df(y)\n5: `rownames&lt;-`(`*tmp*`, value = c(\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\"\n</code></pre>\n"},{"tags":["r","statistics","boolean","numeric","correlation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12993195,"title":"Correlation between numeric and boolean variables","body":"<p>I am creating a plot in R, using:</p>\n\n<pre><code>plot(IQ, isAtheist)\nabline(lm(isAtheist~IQ))\n</code></pre>\n\n<p>IQ is <code>numeric</code> and <code>isAtheist</code> is boolean, having values <code>TRUE</code> or <code>FALSE</code>.</p>\n\n<p><img src=\"http://i.stack.imgur.com/BZJOJ.png\" alt=\"enter image description here\"></p>\n\n<p>I have tried to write:</p>\n\n<pre><code>cor(IQ, isAtheist)\n</code></pre>\n\n<p>But it is gives me an error:</p>\n\n<pre><code>Error in cor(IQ, isAtheist) : 'x' must be numeric\n</code></pre>\n\n<p>How can I determine the correlation between these two variables?</p>\n"},{"tags":["r","data.frame","rbind"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":12998917,"title":"overfloating row indicator in dataframe","body":"<p>I'm trying to append a row to an existing dataframe in R. The dataframe represents a subject and I want to update this with newly (generated) data. When I run this, the index numbers of the dataframe become strange: </p>\n\n<p>1, \n2, \n21, \n211, \n2111, \n21111, etc.</p>\n\n<p>These are not practicle to read. \nHow to get 'normal' index numbers? (1, 2, 3, 4, etc.).</p>\n\n<pre><code>x &lt;- 10\ny &lt;- 463\ndat &lt;- data.frame(x,y)\n\nfor (i in 1:10) {\ndat.sub &lt;- dat[nrow(dat),]       # select the last row from 'dat'\ndat.sub &lt;- within(dat.sub, {     # within that selection update the objects\n    x &lt;- x+1\n    y &lt;- y+1\n})\ndat &lt;- rbind(dat, dat.sub, deparse.level = 2)   # attach updated row to the 'dat'\n}\n\ndat\ndat[3,]\n</code></pre>\n"},{"tags":["r","sorting","data.frame","r-faq"],"answer_count":9,"favorite_count":74,"up_vote_count":99,"down_vote_count":0,"view_count":67321,"score":99,"question_id":1296646,"title":"How to sort a dataframe by column(s) in R","body":"<p>I want to sort a <code>data.frame</code> by multiple columns in R.  For example, with the <code>data.frame</code> below I would like to sort by column <code>z</code> (descending) then by column <code>b</code> (ascending): </p>\n\n<pre><code>dd &lt;- data.frame(b = factor(c(\"Hi\", \"Med\", \"Hi\", \"Low\"), \n      levels = c(\"Low\", \"Med\", \"Hi\"), ordered = TRUE),\n      x = c(\"A\", \"D\", \"A\", \"C\"), y = c(8, 3, 9, 9),\n      z = c(1, 1, 1, 2))\ndd\n    b x y z\n1  Hi A 8 1\n2 Med D 3 1\n3  Hi A 9 1\n4 Low C 9 2\n</code></pre>\n"},{"tags":["r","winbugs14","stan"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":99,"score":5,"question_id":12268220,"title":"How to obtain the full marginal distribution of a parameter in stan","body":"<p>when starting a standard example from the <code>stan</code> <a href=\"http://mc-stan.org\">webpage</a> like the following:</p>\n\n<pre><code>schools_code &lt;- '\n  data {\n   int&lt;lower=0&gt; J; // number of schools \n   real y[J]; // estimated treatment effects\n   real&lt;lower=0&gt; sigma[J]; // s.e. of effect estimates \n } \n parameters {\n   real theta[J]; \n   real mu; \n   real&lt;lower=0&gt; tau; \n } \n model {\n   theta ~ normal(mu, tau); \n   y ~ normal(theta, sigma);\n } \n '\n\n  schools_dat &lt;- list(J = 8, \n                 y = c(28,  8, -3,  7, -1,  1, 18, 12),\n                 sigma = c(15, 10, 16, 11,  9, 11, 10, 18))\n\n fit &lt;- stan(model_code = schools_code, data = schools_dat, \n           iter = 1000, n_chains = 4)\n</code></pre>\n\n<p>(this has been obtained from <a href=\"http://code.google.com/p/stan/wiki/RStanGettingStarted\">here</a>)</p>\n\n<p>however this does only provide me with the quantiles of the posterior of the parameters. so my question is: how to obtain other percentiles? i <em>guess</em> it should be similar to bugs(?)</p>\n\n<p><strong>remark:</strong> i tried to introduce the tag <code>stan</code> however, i have too little reputation ;) sorry for that</p>\n"},{"tags":["r","svm","libsvm","predict"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1501,"score":4,"question_id":4462118,"title":"predict.svm does not predict new data","body":"<p>unfortunately I have problems using predict() in the following simple example:</p>\n\n<pre><code>library(e1071)\n\nx &lt;- c(1:10)\ny &lt;- c(0,0,0,0,1,0,1,1,1,1)\ntest &lt;- c(11:15)\n\nmod &lt;- svm(y ~ x, kernel = \"linear\", gamma = 1, cost = 2, type=\"C-classification\")\n\npredict(mod, newdata = test)\n</code></pre>\n\n<p>The result is as follows:</p>\n\n<pre><code>&gt; predict(mod, newdata = test)\n   1    2    3    4 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; \n   0    0    0    0    0    1    1    1    1    1 \n</code></pre>\n\n<p>Can anybody explain why predict() only gives the fitted values of the training sample (x,y) and does not care about the test-data?</p>\n\n<p>Thank you very much for your help!</p>\n\n<p>Richard</p>\n"},{"tags":["r","matrix"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":2,"view_count":104,"score":0,"question_id":12928080,"title":"hierarchical clustering based on the similarity of different matrices","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5648383/how-to-apply-a-hierarchical-or-k-means-cluster-analysis-using-r\">How to apply a hierarchical or k-means cluster analysis using R?</a>  </p>\n</blockquote>\n\n\n\n<p>Consider these four matrices with the same number of columns but different numbers of rows</p>\n\n<pre><code>library(gtools)\n\nm1 &lt;- matrix(sample(c(-1, 0, 1), 15, replace=T), 3)\nm2 &lt;- matrix(sample(c(-1, 0, 1), 25, replace=T), 5)\nm3 &lt;- matrix(sample(c(-1, 0, 1), 25, replace=T), 5)\nm4 &lt;- matrix(sample(c(-1, 0, 1), 30, replace=T), 6)   \nrownames(m1) &lt;- c(1:3)\nrownames(m2) &lt;- c(4:8)\nrownames(m3) &lt;- c(9:13)\nrownames(m4) &lt;- c(14:19)\n</code></pre>\n\n<p>I want to apply <code>hclust()</code> to these four matrices when arranged in the following format:</p>\n\n<pre><code>mat &lt;- list(m1, m2, m3, m4)\n\nunite &lt;- rbind(m1,m2,m3, m4)\nrownames(unite) &lt;- c(1:19)\ndistUnite &lt;- as.matrix(dist(unite, method=\"manhattan\"))\n\n## empty matrix for storing the distance between pairwise matrices\ndist4m &lt;- matrix(0, nrow=4, ncol=4)\nindices &lt;- combinations(4,2)\ndistance &lt;- apply(indices, 1,\n                  function(pair){\n                      print(pair)\n                      s1=pair[1]\n                      s2=pair[2] \n                      pairmean &lt;- mean(distReads[which(m$Sample==samples[s1]), which(m$Sample==samples[s2])])\n\n                      dist4m[s1,s2] &lt;&lt;- pairmean\n                      dist4m[s2,s1] &lt;&lt;- pairmean\n                  })\n\nprint(dist4m)\n## then use hclust(), and plot()     \n</code></pre>\n\n<p>The above script should work, but I am wondering whether there is more efficient and reliable method to solve?   </p>\n\n<p>Thank you for your advices.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":52,"score":3,"question_id":12997377,"title":"How to rename element's list indexed by a loop in R","body":"<p>I'm new on R language and I still have a lot to learn.\nI've a list <code>W</code> of J elements and I would like to rename its elements <code>W[[i]]</code> with <code>Wi</code>, that  is <code>W[[1]]</code> with <code>W1</code> and so on, using a loop. How can I do?</p>\n"},{"tags":["r","latex","sweave","xtable"],"answer_count":6,"favorite_count":4,"up_vote_count":8,"down_vote_count":0,"view_count":2261,"score":8,"question_id":3444440,"title":"Counts & Percentages in xTable, Sweave, R, cross tabulations","body":"<p><strong>Edit: Building off of aL3xa's answer below, I've modified his syntax below. Not perfect, but getting closer. I still haven't found a way to make xtable accept \\multicolumn{} arguments for columns or rows. It also appears that Hmisc handles some of these type of tasks behind the scenes, but it looks like a bit of an undertaking to understand what's going on there. Does anyone have experience with the latex function in Hmisc?</strong></p>\n\n<pre><code>ctab &lt;- function(tab, dec = 2, margin = NULL) {\n    tab &lt;- as.table(tab)\n    ptab &lt;- paste(round(prop.table(tab, margin = margin) * 100, dec), \"%\", sep = \"\")\n    res &lt;- matrix(NA, nrow = nrow(tab) , ncol = ncol(tab) * 2, byrow = TRUE)\n    oddc &lt;- 1:ncol(tab) %% 2 == 1\n    evenc &lt;- 1:ncol(tab) %% 2 == 0\n    res[,oddc ] &lt;- tab\n    res[,evenc ] &lt;- ptab\n    res &lt;- as.table(res)\n    colnames(res) &lt;- rep(colnames(tab), each = 2)\n    rownames(res) &lt;- rownames(tab)\n    return(res)\n}\n</code></pre>\n\n<p>I would like to create a table formatted for LaTeX output that contains both the counts and percentages for each column or variable. I have not found a ready made solution to this problem, but feel I must be recreating the wheel to some extent. </p>\n\n<p>I have developed a solution for straight tabulations, but am struggling with adopting something for a cross tabulation.</p>\n\n<p>First some sample data:</p>\n\n<pre><code>#Generate sample data\ndow &lt;- sample(1:7, 100, replace=TRUE)\npurp &lt;- sample(1:4, 100, replace=TRUE)\ndow &lt;- factor(dow, 1:7, c(\"Mon\", \"Tues\", \"Wed\", \"Thurs\", \"Fri\", \"Sat\", \"Sun\"))\npurp &lt;- factor(purp, 1:4, c(\"Business\", \"Commute\", \"Vacation\", \"Other\"))\n</code></pre>\n\n<p>And now the working straight tab function:</p>\n\n<pre><code>customTable &lt;- function(var, capt = NULL){\n    counts &lt;- table(var)\n    percs &lt;- 100 * prop.table(counts)       \n\n    print(\n        xtable(\n            cbind(\n                Count = counts\n                , Percent = percs\n            )\n        , caption = capt\n        , digits = c(0,0,2)\n        )\n    , caption.placement=\"top\"\n    )\n}\n\n#Usage\ncustomTable(dow, capt=\"Day of Week\")\ncustomTable(purp, capt=\"Trip Pupose\")\n</code></pre>\n\n<p>Does anyone have any suggestions for adopting this for cross tabulations (i.e. day of week BY trip purpose)? Here is what I've currently written, which does NOT use the xtable library and ALMOST works, but is not dynamic and is quite ugly to work with:</p>\n\n<pre><code>#Create table and percentages\na &lt;- table(dow, purp)\nb &lt;- round(prop.table(a, 1),2)\n\n#Column bind all of the counts &amp; percentages together, this SHOULD become dynamic in future\nd &lt;- cbind( cbind(Count = a[,1],Percent =  b[,1])\n        , cbind(Count = a[,2], Percent = b[,2])\n        , cbind(Count = a[,3], Percent = b[,3])\n        , cbind(Count = a[,4], Percent = b[,4])\n)\n\n#Ugly function that needs help, or scrapped for something else\ncrossTab &lt;- function(title){\n    cat(\"\\\\begin{table}[ht]\\n\")\n    cat(\"\\\\begin{center}\\n\")\n    cat(\"\\\\caption{\", title, \"}\\n\", sep=\"\") \n\n    cat(\"\\\\begin{tabular}{rllllllll}\\n\")\n    cat(\"\\\\hline\\n\")\n\n    cat(\"\", cat(\"\", paste(\"&amp;\\\\multicolumn{2}{c}{\",colnames(a), \"}\"), sep = \"\"), \"\\\\\\\\\\n\", sep=\"\")\n    c(\"&amp;\", cat(\"\", colnames(d), \"\\\\\\\\\\n\", sep=\" &amp; \"))\n    cat(\"\\\\hline\\n\")\n    c(\"&amp;\", write.table(d, sep = \" &amp; \", eol=\"\\\\\\\\\\n\", quote=FALSE, col.names=FALSE))\n\n    cat(\"\\\\hline\\n\")\n    cat(\"\\\\end{tabular}\\n\")\n    cat(\"\\\\end{center}\\n\")\n    cat(\"\\\\end{table}\\n\")   \n}   \n\ncrossTab(title = \"Day of week BY Trip Purpose\")\n</code></pre>\n"},{"tags":["r","statistics"],"answer_count":5,"favorite_count":8,"up_vote_count":5,"down_vote_count":0,"view_count":4776,"score":5,"question_id":3701170,"title":"Stepwise Regression using P-Value","body":"<p>I want to use R to perform a <strong>stepwise linear Regression</strong> using <strong>p-values</strong> as a selection criterion e.g. at each step dropping variables that have the highest i.e. the most insignificant p-values, stopping when all values are significant defined by some treshold alpha.</p>\n\n<p>I am totally aware that I should use the AIC (e.g. command step or stepAIC) or some other criterion instead, but my boss has no grasp of statistics and insist on using p-values.</p>\n\n<p>If nesseary I could program my own routine, but I am wondering if there is an already implemented version of this.</p>\n\n<p>Thanks a lot,\nDainis </p>\n"},{"tags":["r","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12988736,"title":"Get a list/vector of values from a data.frame by passing a list/vector of indices","body":"<pre><code>indices &lt;- c(2,5,9)\n</code></pre>\n\n<p>customer is a data.frame.</p>\n\n<p>I want a list of values from column 2 of customer in the index position of indices.</p>\n\n<pre><code>names &lt;- as.list(customer[,2] &lt;&lt; indices)\n</code></pre>\n"},{"tags":["r","matrix"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12995440,"title":"Any way to edit values in a matrix in R?","body":"<p>I've parsed through a file to extract certain values. A column contains a percentage with the symbol. Is there any way to remove that \"%\" character?</p>\n\n<p>From this: </p>\n\n<pre><code>98.9%   23    43\n92.2%   342   34\n98.9%   53    53\n82.2%   32    76\n97.9%   83    45\n92.9%   92    23\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>98.9   23    43\n92.2   342   34\n98.9   53    53\n82.2   32    76\n97.9   83    45\n92.9   92    23\n</code></pre>\n"},{"tags":["r","plot"],"answer_count":5,"favorite_count":9,"up_vote_count":47,"down_vote_count":0,"view_count":55423,"score":47,"question_id":2564258,"title":"Plot 2 graphs in same plot in R?","body":"<p>I would like to plot y1 and y2 in the same plot.</p>\n\n<pre><code>x  &lt;- seq(-2, 2, 0.05)\ny1 &lt;- pnorm(x)\ny2 &lt;- pnorm(x,1,1)\nplot(x,y1,type=\"l\",col=\"red\")\nplot(x,y2,type=\"l\",col=\"green\")\n</code></pre>\n\n<p>But when I do it like this, they are not plotted in the same plot together.</p>\n\n<p>In Matlab one can do <code>hold on</code>, but does anyone know how to do this in R?</p>\n"},{"tags":["r","output","snowfall"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":12994063,"title":"R parallel computing with snowfall - writing to files from separate workers","body":"<p>I am using the snowfall 1.84 package for parallel computing and would like each worker to write data to its own separate file during the computation. Is this possible ? if so how ?</p>\n\n<p>I am using the \"SOCK\" type connection e.g., sfInit( parallel=TRUE, ...,type=\"SOCK\" ) and would like the code to be platform independent (unix/windows).  </p>\n\n<p>I know it is possible to Use the \"slaveOutfile\" option in sfInit to define a file where to write the log files. But this is intended for debugging purposes and all slaves/workers must use the same file. I need each worker to have its OWN output file !!! </p>\n\n<p>The data i need to write are large dataframes, and NOT simple diagnostic messages. These dataframes need be output by the slaves and could not be sent back to the master process.\nAnyone knows how i can get this done?</p>\n\n<p>Thanks</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":92,"score":-4,"question_id":12989620,"title":"Round(x,2) have not effect at all?","body":"<p>please download the file in the<br>\n<a href=\"https://www.box.com/s/z3tldpdykhppmivfexjl\" rel=\"nofollow\">https://www.box.com/s/z3tldpdykhppmivfexjl</a></p>\n\n<p>,save it as  '/tmp/mydata'<br>\nand run the following code  </p>\n\n<pre><code>datafile=\"/tmp/mydata\"\ntotalsize=file.info(datafile)$size\nlines=totalsize/32\ncon=file(datafile,\"rb\")\ndate&lt;-c()\ndata&lt;-c()\nfor (i in 1:lines){\n    result1&lt;-readBin(con,integer(),n=1,size=4,endian=\"little\")\n    date&lt;-c(date,result1)\n    result2&lt;-round(readBin(con,double(),n=7,size=4,endian=\"little\"),2)\n    data&lt;-c(data,result2)\n}\ndate=data.frame(matrix(date,nrow=lines,ncol=1,byrow=TRUE))\ndata=data.frame(matrix(round(data,2),nrow=lines,ncol=7,byrow=TRUE))\ndata=cbind(date,data)\nnames(data)&lt;-c(\"date\",\"open\",\"high\",\"low\",\"close\",\"volume\",\"amount\",\"reserved\")\ndata&lt;-data[-c(1:2),]\n</code></pre>\n\n<p>when you finish ,please input <code>data</code> in R console,<br>\nyou can see long digits, \n<a href=\"https://www.box.com/s/lxkbs96vk02p6ekdflbe\" rel=\"nofollow\">https://www.box.com/s/lxkbs96vk02p6ekdflbe</a><br>\n<img src=\"http://i.stack.imgur.com/Ko3gR.png\" alt=\"enter image description here\"> \nwhy <code>round(data,2)</code> can not round  2 digits?<br>\nit is so strange ,when i write the data into a csv file,open the csv file,i found it has only 2 digits!</p>\n\n<pre><code>write.csv(file=\"/tmp/test\",data)\n</code></pre>\n\n<p>Joris Meys say it is bad way to grow vector in for-loops,but i find maybe in my case it is good way to do that ,if not ,how to revise it?let me see the better codes.</p>\n"},{"tags":["r","plot","xts","zoo"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":59,"score":3,"question_id":12992831,"title":"plotting multple xts objects in one window","body":"<p>I have found some answers to this online but for some reason am interpreting incorrectly because I cannot get it to work. My goal is to simply use the <code>xts</code> plotting feature (with the the way it creates the axis, gridlines,etc.) to plot multiple plots:</p>\n\n<pre><code>x &lt;- xts(data.frame(a=1:100, b=100:1),seq(from=as.Date(\"2010-01-01\"), by=\"days\", len=100))\n&gt; plot(x, screens=1)\nWarning messages:\n1: In plot.xts(x, screens = 1) :\n  only the univariate series will be plotted\n2: In plot.window(...) : \"screens\" is not a graphical parameter\n3: In plot.xy(xy, type, ...) : \"screens\" is not a graphical parameter\n4: In axis(1, at = xycoords$x, labels = FALSE, col = \"#BBBBBB\", ...) :\n  \"screens\" is not a graphical parameter\n5: In axis(1, at = xycoords$x[ep], labels = names(ep), las = 1, lwd = 1,  :\n  \"screens\" is not a graphical parameter\n6: In axis(2, ...) : \"screens\" is not a graphical parameter\n7: In title(screens = 1) : \"screens\" is not a graphical parameter\n</code></pre>\n\n<p>Another try:</p>\n\n<pre><code>&gt; plot(x, plot.type=\"single\")\nWarning messages:\n1: In plot.xts(x, plot.type = \"single\") :\n   only the univariate series will be plotted\n2: In plot.window(...) : \"plot.type\" is not a graphical parameter\n3: In plot.xy(xy, type, ...) : \"plot.type\" is not a graphical parameter\n4: In axis(1, at = xycoords$x, labels = FALSE, col = \"#BBBBBB\", ...) :\n  \"plot.type\" is not a graphical parameter\n5: In axis(1, at = xycoords$x[ep], labels = names(ep), las = 1, lwd = 1,  :\n  \"plot.type\" is not a graphical parameter\n6: In axis(2, ...) : \"plot.type\" is not a graphical parameter\n7: In title(plot.type = \"single\") :\n  \"plot.type\" is not a graphical parameter\n</code></pre>\n\n<p>To be clear: I can do this using <code>lines</code> but I wonder if there is a way to do this all at once.</p>\n"},{"tags":["r","which","sapply"],"answer_count":1,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":88,"score":7,"question_id":12982152,"title":"Speeding up function that uses which within a sapply call in R","body":"<p>I have two vector <code>e</code> and <code>g</code>. I want to know for each element in <code>e</code> the percentage of elements in <code>g</code> that are smaller. One way to implement this in R is:</p>\n\n<pre><code>set.seed(21)\ne &lt;- rnorm(1e4)\ng &lt;- rnorm(1e4)\nmf &lt;- function(p,v) {100*length(which(v&lt;=p))/length(v)}\nmf.out &lt;- sapply(X=e, FUN=mf, v=g)\n</code></pre>\n\n<p>With large <code>e</code> or <code>g</code>, this takes a lot of time to run. How can I change or adapt this code to make this run faster?</p>\n\n<p>Note: The <code>mf</code> function above is based on code from the <code>mess</code> function in the dismo package.</p>\n"},{"tags":["r","knn","predict"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12993044,"title":"issue with k nearest neighbour regression and knn.pred","body":"<p>In the package knnflex there used to be a k nearest neighbour prediction function. Because that package is no longer available I am using the package FNN, to convert one all program from knnflex to this new package. I got a problem with the following line:</p>\n\n<pre><code>    lines(seq(from=0,to=1,length.out=100),all.nn1.predict,col=\"blue\")\n</code></pre>\n\n<p>The message that appears is:</p>\n\n<pre><code>    Error in xy.coords(x, y) : 'x' and 'y' lengths differ\n</code></pre>\n\n<p>The predict function in the old package was like this:</p>\n\n<pre><code>    all.dist = knn.dist(c(all.x,seq(from=0,to=1,length.out=100)))\n    all.nn1.predict = knn.predict(1:110,111:210,all.y,all.dist,k=1)\n</code></pre>\n\n<p>and according to the manual this function what it does is:</p>\n\n<pre><code>     K-Nearest Neighbor prediction method which uses the distances calculated by\n     knn.dist.\n</code></pre>\n\n<p>The manual is in: <a href=\"http://rgm2.lab.nig.ac.jp/RGM2/func.php?rd_id=knnflex:knn.predict\" rel=\"nofollow\">http://rgm2.lab.nig.ac.jp/RGM2/func.php?rd_id=knnflex:knn.predict</a></p>\n\n<p>The new package has the knn.dist function, but no prediction function, the closer that I got is the knn.reg function that in the manual is:\n<a href=\"http://cran.r-project.org/web/packages/FNN/FNN.pdf\" rel=\"nofollow\">http://cran.r-project.org/web/packages/FNN/FNN.pdf</a></p>\n\n<p>Is there any solution to this issue, another library that is near to knnflex?</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":73,"score":3,"question_id":12985602,"title":"In R, is there a way to color plot points on a gradient based on a range of numbers?","body":"<p>I'm new to R, and I've been able to plot points, but wondering if there is a way to apply a color gradient to the scatterplot.</p>\n\n<p>I have a 3 column matrix, where the first two will be used as coordinates, and the third has range of numbers between 0 and .0001. Is there a way to color the plot points based on where they fall in the range of numbers?</p>\n\n<pre><code> x   y   z\n 15  3   6e-4\n 34  22  1e-10\n 24  1   5e-2\n ...\n\nplot(x, y, main= \"Title\", ylab = \"column y\", xlab = \"column x\", col = rgb(0,100,0,50,maxColorValue=255), pch=16) \n</code></pre>\n"},{"tags":["r","sweave"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12672835,"title":"Inverted Question(¿) in Sweave/tikZ Generated R Plot","body":"<p>I am relatively new to Sweave, and R in general and have been having issues trying to render basic math symbols in my plot labels. I believe the problem may be cause by either Sweave or tikzDevice package as I am able to render the math symbols perfectly fine if I use either a png or pdf device.</p>\n\n<p>Writing this code to either a png or pdf device gives expected output --the > symbol</p>\n\n<pre><code>qplot(factor(cyl), data=mtcars, geom=\"bar\", colour=factor(cyl)) + scale_x_discrete(paste(\"\",\"&gt;\",\"6k\"))\n</code></pre>\n\n<p>Using .tex output file resulting from running Sweave on file below replaces > symbol with ¿ symbol</p>\n\n<pre><code>&lt;&lt;fig=FALSE, echo=FALSE&gt;&gt;=\nrequire(tikzDevice)\nrequire(ggplot2)\nrequire(reshape2)\ntikz('sweave-math-symbols.tex', width=5.9, height=2.7)\n\nqplot(factor(cyl), data=mtcars, geom=\"bar\", colour=factor(cyl)) + scale_x_discrete(paste(\"\",\"&gt;\",\"6k\"))\n@\n</code></pre>\n\n<p>LaTeX document that uses output file from Sweave is below</p>\n\n<pre><code>\\documentclass[a4paper,10pt]{article}\n\\usepackage[utf8]{inputenc}\n\\usepackage{tikz}\n\n%opening\n\\title{Sweave Math Symbols}\n\\author{Phiri}\n\n    \\begin{document}\n\n    \\maketitle\n\n    \\begin{abstract}\n\n    \\end{abstract}\n\n    \\section{Illustration}\n    \\input{sweave-math-symbols.tex}\n\n    \\end{document}\n</code></pre>\n\n<p>Where is this problem stemming from and how do I go about fixing it?</p>\n"},{"tags":["r","order","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":12992397,"title":"Numeric data frame columns order incorrectly as string","body":"<p>I have some hospital data in a dataframe, read in from a csv. I tried to order the dataframe by a user-defined column <code>col</code> and then by the hospital's name like so:</p>\n\n<pre><code>col &lt;- 'Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia'\nhospitals.sorted &lt;- hospitals[order(hospitals[,col], hospitals$Hospital.Name),]\n</code></pre>\n\n<p>But I think I'm missing something; it seems to sort <code>col</code> like strings:</p>\n\n<pre><code>&gt; hospitals.sorted\n... # so far so good # ...\n2749                                                   10.0\n2831                                                   10.0\n2891                                                   10.0\n2837                                                   10.1\n2824                                                   10.1\n2774                                                   10.1\n... # not so good # ...\n2856                                                   15.7\n2834                                                   15.9\n2797                                                   16.0\n2835                                                    7.4\n2850                                                    7.7\n2789                                                    8.1\n... # there are some non-numeric values at the very bottom # ...\n2806                                                    9.9\n2867                                                    9.9\n2884                                                    9.9\n2808                                          Not Available\n2913                                          Not Available\n2911                                          Not Available\n</code></pre>\n\n<p>Just to confirm the column is in fact numeric:</p>\n\n<pre><code>&gt; sapply(hospitals, mode)\nHospital.30.Day.Death..Mortality..Rates.from.Pneumonia \n\"numeric\" \nHospital.Name \n\"numeric\"\n</code></pre>\n\n<p>I don't know why <code>Hospital.Name</code> is numeric when it's clearly not.</p>\n\n<p>Other things I tried to no avail: </p>\n\n<ul>\n<li>using <code>as.numeric(hospitals[,col])</code> inside of <code>order</code></li>\n<li>removing the \"Not Available\" values before sorting</li>\n</ul>\n\n<p>I may be missing something fundamental. Halp!</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":47,"score":3,"question_id":12991795,"title":"Topicmodels transposes the term document matrix","body":"<p>I am trying to run an LDA using the topicmodels package in R. The example given in the manual uses Associated Press data and works nicely. However, when I try it on my own data I get topics whose terms are the document names. I have traced the problem to the fact that my term document matrix is the transpose of the way is should be (rows -> columns).</p>\n\n<p>The example TDM:</p>\n\n<pre><code>str(AssociatedPress)\nList of 6\n$ i       : int [1:302031] 1 1 1 1 1 1 1 1 1 1 ...\n\n$ j       : int [1:302031] 116 153 218 272 299 302 447 455 548 597 ...\n$ v       : int [1:302031] 1 2 1 1 1 1 2 1 1 1 ...\n$ nrow    : int 2246\n$ ncol    : int 10473\n$ dimnames:List of 2\n..$ Docs : NULL\n..$ Terms: chr [1:10473] \"aaron\" \"abandon\" \"abandoned\" \"abandoning\" ...\n- attr(*, \"Weighting\")= chr [1:2] \"term frequency\" \"tf\"\n- attr(*, \"class\")= chr [1:2] \"DocumentTermMatrix\" \"simple_triplet_matrix\"\n</code></pre>\n\n<p>Whereas,my TDM has Terms as rows, and Docs as columns:</p>\n\n<pre><code>List of 6\n$ i       : int [1:10489] 1 3 4 13 20 24 25 26 27 28 ...\n$ j       : int [1:10489] 1 1 1 1 1 1 1 1 1 1 ...\n$ v       : num [1:10489] 1 1 1 1 2 1 67 1 44 3 ...\n$ nrow    : int 5903\n$ ncol    : int 9\n$ dimnames:List of 2\n..$ Terms: chr [1:5903] \"\\u2439aa\" \"aars\" \"\\u2439ab\" \"\\u242dab\" ...\n..$ Docs : chr [1:9] \"art111130.txt\" \"art111131.txt\" \"art111132.txt\" \"art111133.txt\" ...\n- attr(*, \"class\")= chr [1:2] \"TermDocumentMatrix\" \"simple_triplet_matrix\"\n- attr(*, \"Weighting\")= chr [1:2] \"term frequency\" \"tf\"\n</code></pre>\n\n<p>Which is causing <code>LDA(art_tdm,3)</code> to build topics based on doc names, not terms within docs. Is this a change in the codebase of the tm package? I can't imagine what I would be doing to cause this transposition in my code: </p>\n\n<pre><code>art_cor&lt;-Corpus(DirSource(directory = \"tmptxts\"))\nart_tdm&lt;-TermDocumentMatrix(art_cor)\n</code></pre>\n\n<p>Any help would be appreciated. </p>\n"},{"tags":["r","reshape2"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":78,"score":3,"question_id":12990398,"title":"Why does reshape2 melt return value = NA for me?","body":"<p>Why does reshape2 <code>melt</code> return <code>value</code> = <code>NA</code> for me?</p>\n\n<p>It works for me with reshape, but not with reshape2:</p>\n\n<p>Here is an example datafile:</p>\n\n<pre><code>\"\",\"station_id\",\"year\",\"month\",\"day\",\"h1\",\"h2\",\"h3\",\"h4\",\"h5\",\"h6\",\"h7\",\"h8\",\"h9\",\"h10\",\"h11\",\"h12\",\"h13\",\"h14\",\"h15\",\"h16\",\"h17\",\"h18\",\"h19\",\"h20\",\"h21\",\"h22\",\"h23\",\"h24\"\n\"1\",1,2004,1,1,46,46,45,41,39,35,33,33,36,47,53,54,55,55,55,55,52,46,40,40,39,38,40,41\n\"2\",1,2004,1,2,43,44,46,46,47,47,47,47,47,47,47,49,52,56,54,56,57,53,50,47,46,45,45,45\n\"3\",1,2004,1,3,45,46,46,44,43,46,46,47,51,55,56,59,65,68,69,68,68,65,64,63,62,63,63,62\n\"4\",1,2004,1,4,63,62,62,62,60,60,60,62,60,64,64,66,71,70,71,72,71,68,67,67,65,64,65,64\n\"5\",1,2004,1,5,64,63,65,64,64,64,64,64,65,66,66,67,68,68,66,66,66,66,63,54,52,49,47,47\n\"6\",1,2004,1,6,47,46,45,43,41,41,39,39,40,43,45,44,45,46,46,46,45,39,39,39,38,36,32,32\n</code></pre>\n\n<p>Let's say it is saved as <code>/tmp/foo.csv</code>, then:</p>\n\n<p>Using reshape:</p>\n\n<pre><code>$ R\n...\nType 'q()' to quit R.\n\n&gt; library(\"reshape\")\nLoading required package: plyr\n\nAttaching package: ‘reshape’\n\nThe following object(s) are masked from ‘package:plyr’:\n\n    rename, round_any\n\n&gt; hlist &lt;- NULL; for(z in 1:24) { hlist &lt;- cbind(hlist, sprintf(\"h%d\",z)) }\n&gt; \n&gt; thh &lt;- read.csv('/tmp/foo.csv')\n&gt; thm &lt;- melt(thh,measure.vars=hlist,variable=\"hour\")\n&gt; head(thm)\n  station_id year month day hour value\n1          1 2004     1   1   h1    46\n2          1 2004     1   2   h1    43\n3          1 2004     1   3   h1    45\n4          1 2004     1   4   h1    63\n5          1 2004     1   5   h1    64\n6          1 2004     1   6   h1    47\n&gt; q()\n</code></pre>\n\n<p>Using reshape2:</p>\n\n<pre><code>$ R\n...\nType 'q()' to quit R.\n\n&gt; library(\"reshape2\")\n&gt; hlist &lt;- NULL; for(z in 1:24) { hlist &lt;- cbind(hlist, sprintf(\"h%d\",z)) }\n&gt; \n&gt; thh &lt;- read.csv('/tmp/foo.csv')\n&gt; thm &lt;- melt(thh,measure.vars=hlist,variable=\"hour\")\n&gt; head(thm)\n  station_id year month day hour value\n1          1 2004     1   1   h1    NA\n2          1 2004     1   2   h1    NA\n3          1 2004     1   3   h1    NA\n4          1 2004     1   4   h1    NA\n5          1 2004     1   5   h1    NA\n6          1 2004     1   6   h1    NA\n&gt; q()\n</code></pre>\n\n<p>You can see that using <code>library(\"reshape\")</code>, the <code>value</code> column has numbers, but for <code>libary(\"reshape2\")</code>, it has <code>NA</code>, for the same data.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":66,"score":-1,"question_id":12989456,"title":"Can the results of summary() be 'piped' or used as is to generate a boxplot?","body":"<p>Is there a way to generate a boxplot directly from summary()'s results (box for each column) or must the values be extracted and plot composed manually?\nThanks</p>\n"},{"tags":["r","spatial-interpolation"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":12990298,"title":"Expanding my interpolation grid for kriging in R","body":"<p>I want to create an interpolation grid consisting of spatial data points to later use for kriging in R. I have been working in the sp and gstat packages. The code I am working with works, but my grid does not include all of the points and I want to expand it, but I can't seem to get it right.</p>\n\n<p>The code I am working with is here (my data.frame is kr.data):</p>\n\n<pre><code>x.range &lt;- as.integer(range(kr.data@coords[,1]))\ny.range &lt;- as.integer(range(kr.data@coords[,2]))\ndata.grd &lt;- expand.grid(x=seq(from=x.range[1], to=x.range[2], by=0.5),  \ny=seq(from=y.range[1], to=y.range[2], by=0.5))\n\ncoordinates(data.grd) &lt;- ~x+y\ngridded(data.grd) &lt;- TRUE\nplot(data.grd, cex=0.5)\npoints(kr.data, pch=1, col='red', cex=0.7)\n</code></pre>\n\n<p>I wanted to add the output to show the points concentrated in the lower right corner, off the grid, but I am new and not sure how to add this. Can anyone offer a suggestion on where to find help making a grid with spatial data or where to change my code? When I alter my code to expand the grid, my data points are no longer visible.  I am new at working with spatial data in R. </p>\n"},{"tags":["r","panel","stata"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":94,"score":2,"question_id":12989925,"title":"Hausman type test in R","body":"<p>I have been using \"<strong>plm</strong>\" package of <strong>R</strong> to do the analysis of panel data. One of the important test in this package for choosing between \"fixed effect\" or \"random effect\" model is called <strong>Hausman type</strong>. A similar test is also available for the Stata. The point here is that <strong>Stata</strong> requires fixed effect to be estimated first followed by random effect. However, I didn't see any such restriction in the \"plm\" package. So, I was wondering whether \"<strong>plm</strong>\" package has the default \"fixed effect\" first and then \"random effect\" second. For your reference, I mention below the steps in Stata and R that I followed for the analysis. </p>\n\n<pre><code>*\n\nStata Steps: (data=mydata, y=dependent variable,X1:X4: explanatory variables)\n    *step 1 : Estimate the FE model\n    xtreg y X1 X2 X3 X4 ,fe\n    *step 2: store the estimator \n    est store fixed\n    *step 3 : Estimate the RE model\n    xtreg y X1 X2 X3 X4,re\n   * step 4: store the estimator \n    est store random\n    *step 5: run Hausman test\n    hausman fixed random\n\n#R steps (data=mydata, y=dependent variable,X1:X4: explanatory variables)\n#step 1 : Estimate the FE model\n fe &lt;- plm(y~X1+X2+X3+X4,data=mydata,model=\"within\")\nsummary(model.fe)\n#step 2 : Estimate the RE model\n re &lt;- pggls(y~X1+X2+X3+X4,data=mydata,model=\"random\")\nsummary(model.re)\n#step 3 : Run Hausman test\nphtest(fe, re)\n</code></pre>\n"}]}
{"total":19203,"page":12,"pagesize":100,"questions":[{"tags":["r","parallel-processing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":12962530,"title":"How to register linux computing cluster as parallel backend from Windows in R","body":"<p>First off, although I'm pretty well versed in R programming, I'm fairly new to both *nix environments + parallel computing, so I appreciate your bearing with me. I'm familiar with the 'parallel', 'foreach', and different 'do_' packages in R, but only for utilizing multiple cores on a local machine.</p>\n\n<p>I have a local Linux cluster of computers (running on OpenSUSE) available to me, with a number of nodes. These nodes all have R installed. Typically, if I'm trying to work on just one of the nodes, I'll use PuTTY to ssh first to the head node (with username + pwd), then to one of the (internal?) nodes. However, what I'd like to be able to do is, run R on a local Windows workstation, and send jobs to the cluster of computers.</p>\n\n<p>Is it possible to set this cluster of nodes as a parallel back-end for my Windows machine? And if so, what's the most expedient way of going about this?</p>\n\n<p>EDIT:</p>\n\n<p>Perhaps I can narrow down the question a bit. It's easy enough to open an R process on the head node and run something like,</p>\n\n<pre><code>library( parallel )\nnodes &lt;- c(\"n01\", \"n02\", \"n03\") ## the nodes\ncl &lt;- makePSOCKcluster( nodes )\nsetDefaultCluster( cl )\n</code></pre>\n\n<p>Now, is it possible for me to interface a local R session with this R session running on the head node in an easy way? Eg, ideally I'd like to write code on my computer of the form (pseudo-code):</p>\n\n<pre><code>clusterConnection &lt;- connect(\"&lt;cluster&gt;\")\nf &lt;- function() { clusterApply( cl, 1:10, sum( rnorm(1E7) ) ) }\nresults &lt;- evaluate( f, clusterConnection )\n</code></pre>\n\n<p>whereby 'evaluate' performs some magic to send the function 'f' to the head node, then evaluate it, and returns the results back to the local computer and stores it in 'results'.</p>\n\n<p>Is there an R function, package or otherwise that handles this sort of interfacing?</p>\n"},{"tags":["r","regression","quantmod"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12989483,"title":"R quantmod data merge regression error","body":"<p>This R code throws an error,namely-\n \"Error in .xts(e, .index(e1), .indexCLASS = indexClass(e1), .indexFORMAT = indexFormat(e1),  : \n  index length must match number of observations</p>\n\n<p>Code:</p>\n\n<pre><code>library('quantmod')\nlibrary('foreach')\n\n\nJNK &lt;- getSymbols('JNK', from='2010-01-01',auto.assign=FALSE)[,6]\nGSPC &lt;- getSymbols('^GSPC', from='2010-01-01',auto.assign=FALSE)[,6]\n\n\nJNK &lt;- diff(log(JNK))\nGSPC &lt;- diff(log(GSPC))\n\nData &lt;- na.omit(merge(JNK,GSPC, all=FALSE))\nm &lt;- lm(JNK ~ GSPC, data=Data)\nplot(m)\n</code></pre>\n\n<p>Could anyone help me figure out what I'm doing wrong?</p>\n"},{"tags":["r","map","colors","legend"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12989147,"title":"map with wrong colors but right assigned on legend?","body":"<p>I've been mapping a choropleth map and when I compare the colours drawn to the numbers they re assigned to it doesn't fit.</p>\n\n<p>so here is my data</p>\n\n<pre><code>    zip latitude    longitude   count2.x  count2.freq   reg   colorBuckets  colma\n99501   61.21680    -149.87828    AK          67      Alaska     1         #EDF8FB\n35010  32.90343      -85.92669    AL        1582      Alabama    3         #99D8C9\n90001   33.97291    -118.24878    CA       20970    California   6         #006D2C\n20001   38.90771    -77.01732     DC         952         NA      2         #CCECE6\n</code></pre>\n\n<p>so the code from the beginning that I've been using is the following</p>\n\n<pre><code>    library(\"zipcode\")\nlibrary(\"maps\")\nlibrary(\"plyr\")\nlibrary(\"RColorBrewer\")\ncolors=brewer.pal(6, \"BuGn\")\ndata(zipcode)\nmerge1&lt;-merge(zipcode, tel2, by.x='zip', by.y='zip_code', all.y=TRUE)\nresult&lt;- ddply(merge1, .(state), transform, count2 = count(state))\n#remove NA's#\nfinal&lt;- result[complete.cases(result),]\n#remove duplicates#\nnodupl &lt;- final[!duplicated(final$state),]\n#add state to abbreviations#\nnodupl$reg&lt;-state.name[match(nodupl$count2.x, state.abb)]\n#intervalle bestimmen#\nnodupl$colorBuckets&lt;- as.numeric(cut(nodupl$count2.freq, c(0,500,1000,5000,10000,15000,22000)))\n#intervall legend#\ntext&lt;- c(\"&lt; 500\", \"500 - 999\", \"1000 - 4999\",\"5000 - 9999\", \"10000 - 14999\", \"15000 - 22000\")\n#see what color is assign to where#\nnodupl$colma&lt;- colors[nodupl$colorBuckets]\nmap(\"state\",regions=nodupl$reg, exact=FALSE, col = colors[nodupl$colorBuckets],  fill = TRUE,resolution = 0,lty = 0)\nmap(\"state\",col = \"black\",fill=FALSE,add=TRUE,lty=1,lwd=1)\n#legend plotten#\npar(xpd=TRUE)\nlegend(\"bottomleft\", text, horiz=FALSE, fill=colors)\n</code></pre>\n\n<p>so the problem is again if I see the legend the colours are assigned right but if I double check the numbers in my column (row count2.freq) with the colours on the map they don't fit. e.g california is really light colored but it should be dark. does anyone see what has been done wrong. plus I have some trouble with positioning the legend the way I have it is right on the map so Idon't see the map anymore. what could I do about that?\nthanks for your help even though its saturday</p>\n"},{"tags":["r","sequence","condition","rows","blank"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":76,"score":3,"question_id":12984339,"title":"Assigning values in a sequence to a group of consecutive rows leaving some rows empty","body":"<p>I'm trying to group several consecutives rows (and assigning them the same value) while leaving some of the rows empty (when a certain condition is not fulfilled).</p>\n\n<p>My data are locations (xy coordinates), the date/time at which they were measured, and the time span between measures. Somehow simplified, they look like this:</p>\n\n<pre><code>ID   X     Y      Time    Span\n1    3445  7671   0:00    -\n2    3312  7677   4:00    4\n3    3309  7680   12:00   8\n4    3299  7681   16:00   4\n5    3243  7655   20:00   4\n6    3222  7612   4:00    8\n7    3260  7633   0:00    4\n8    3254  7641   8:00    8\n9    3230  7612   0:00    16\n10   3203  7656   4:00    4\n11   3202  7678   8:00    4\n12   3159  7609   20:00   12\n...\n</code></pre>\n\n<p>I'd like to assign a value to every sequence of locations that are measured within a time span of 4 hours, and make my data look like this:</p>\n\n<pre><code>ID   X     Y      Time    Span  Sequence\n1    3445  7671   0:00    -     -\n2    3312  7677   4:00    4     1\n3    3309  7680   12:00   8     NA\n4    3299  7681   16:00   4     2\n5    3243  7655   20:00   4     2\n6    3222  7612   4:00    8     NA\n7    3260  7633   0:00    4     3\n8    3254  7641   8:00    8     NA\n9    3230  7612   0:00    16    NA\n10   3203  7656   4:00    4     4\n11   3202  7678   8:00    4     4\n12   3159  7609   20:00   12    NA\n</code></pre>\n\n<p>I've tried several algorithms with a loop \"for\" plus \"ifelse\" condition like: </p>\n\n<pre><code>Sequence &lt;- for (i in 1:max(ID)) {\nifelse (Span &lt;= 4, i+1, \"NA\")\n}\n</code></pre>\n\n<p>without any luck. I know my attempt is incorrect, but my programming skills are really basic and I haven't found any similar problem in the web.</p>\n\n<p>Any ideas would be very appreciated!</p>\n"},{"tags":["r","string-literals"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12988367,"title":"Extracting value from a list by name","body":"<p>I have a list:</p>\n\n<pre><code>&gt;data&lt;- list(\"Apple\"=12,\"orange\"=4,\"pear\"=5)\n&gt;fruit&lt;- \"Apple\"\n</code></pre>\n\n<p>Now I extract the value for the Apple.</p>\n\n<pre><code>&gt;data$fruit\n</code></pre>\n\n<p>I get NULL.</p>\n"},{"tags":["r","table","latex"],"answer_count":7,"favorite_count":46,"up_vote_count":53,"down_vote_count":0,"view_count":5730,"score":53,"question_id":5465314,"title":"Tools for making latex tables in R","body":"<p>On general request, a community wiki on producing latex tables in R. In this post I'll give an overview of the most commonly used packages and blogs with code for producing latex tables from less straight-forward objects. Please feel free to add any I missed, and/or give tips, hints and little tricks on how to produce nicely formatted latex tables with R.</p>\n\n<h2>Packages :</h2>\n\n<ul>\n<li><a href=\"http://cran.r-project.org/web/packages/xtable/index.html\">xtable</a> : for standard tables of most simple objects. A nice gallery with examples can be found <a href=\"http://cran.r-project.org/web/packages/xtable/vignettes/xtableGallery.pdf\">here</a>.</li>\n<li><a href=\"http://cran.r-project.org/web/packages/memisc/index.html\">memisc</a> : tool for management of survey data, contains some tools for latex tables of (basic) regression model estimates.</li>\n<li><a href=\"http://cran.r-project.org/web/packages/Hmisc/index.html\">Hmisc</a> contains a function <code>latex()</code> that creates a tex file containing the object of choice. It is pretty flexible, and can also output <code>longtable</code> latex tables. There's a lot of info in the help file <code>?latex</code></li>\n<li><a href=\"http://cran.r-project.org/web/packages/miscFuncs/index.html\">miscFuncs</a> has a neat function 'latextable' that converts matrix data with mixed alphabetic and numeric entries into a LaTeX table and prints them to the console, so they can be copied and pasted into a LaTeX document.</li>\n<li><a href=\"http://cran.r-project.org/web/packages/texreg/index.html\">texreg</a> converts statistical model output into LaTeX tables. Merges multiple models. Can cope with almost 30 different model types, including network models and multilevel models (lme and lme4).</li>\n</ul>\n\n<h2>Blogs and code snippets</h2>\n\n<ul>\n<li>There is the <a href=\"http://ryouready.files.wordpress.com/2009/06/outreg_code_by_paul_johnson.pdf\">outreg function of Paul Johnson</a> that gives Stata-like tables in Latex for the output of regressions. This one works great.</li>\n<li>As given in an earlier question, there's a code snippet to <a href=\"http://leftcensored.skepsi.net/2011/03/13/code-latex-tables-for-lme4-models/\">adapt the memisc package for lme4 objects</a>. </li>\n</ul>\n\n<h2>Related questions :</h2>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/2978784/suggestion-for-r-latex-table-creation-package\">Suggestion for R/LaTeX table creation package</a></li>\n<li><a href=\"http://stackoverflow.com/questions/2438486/rreport-latex-quality-output-package\">Rreport/LaTeX quality output package</a></li>\n<li><a href=\"http://stackoverflow.com/questions/3661451/sorting-a-table-for-latex-output-with-xtable\">sorting a table for latex output with xtable</a></li>\n<li><a href=\"http://stackoverflow.com/questions/5461196/any-way-to-produce-a-latex-table-from-an-lme4-mer-model-fit-object\">Any way to produce a LaTeX table from an lme4 mer model fit object?</a></li>\n<li><a href=\"http://stackoverflow.com/questions/8251306/r-data-frame-with-stacked-specified-titles-for-latex-output-with-xtable\">R data.frame with stacked specified titles for latex output with xtable</a></li>\n<li><a href=\"http://tex.stackexchange.com/questions/34788/automating-adding-tables-fast-to-latex-from-r\">Automating adding tables fast to latex from R</a></li>\n</ul>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12988168,"title":"Is there a function that, given a column of data.frame returns a list of all column indices that match the condition?","body":"<p>I have a column of numeric data. </p>\n\n<p>I run:</p>\n\n<pre><code>which.min(xdata[,5])\n</code></pre>\n\n<p>I get the index where the min value is found.</p>\n\n<pre><code>[1] 20\n</code></pre>\n\n<p>Now, how do I extract all the indices of the column that meet the same condition? Perhaps as a list.</p>\n"},{"tags":["r","quantmod"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":81,"score":-3,"question_id":12987903,"title":"R getsymbols from csv file","body":"<p>I am trying to use getSymbols (quantmod) package in R to download stock prices from a list of stocks that I have in a .csv file.</p>\n\n<p>I have the .csv file imported into R but unsure on how to use getSymbols to read from a .csv file</p>\n\n<p>So I have my list of stock symbols and I want getSymbols to download the price data for each symbol in the list.</p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":7141,"score":3,"question_id":4236368,"title":"how to apply a function to every row of a matrix (or a data frame) in R","body":"<p>Suppose I have a n by 2 matrix and a function that takes a 2-vector as one of its arguments. I would like to apply the function to each row of the matrix and get a n-vector. How to do this in R?</p>\n\n<p>For example, I would like to compute the density of a 2D standard Normal distribution on three points:</p>\n\n<pre><code>bivariate.density(x=c(0,0),mu=c(0,0), sigma=c(1,1), rho=0){\n    exp(-1/(2*(1-rho^2))*(x[1]^2/sigma[1]^2+x[2]^2/sigma[2]^2-2*rho*x[1]*x[2]/(sigma[1]*sigma[2]))) * 1/(2*pi*sigma[1]*sigma[2]*sqrt(1-rho^2))\n}\n\nout=rbind(c(1,2),c(3,4),c(5,6));\n</code></pre>\n\n<p>How to apply the function to each row of <code>out</code>?</p>\n\n<p>How to pass values for the other arguments besides the points to the function in the way you specify? </p>\n\n<p>Thanks!</p>\n"},{"tags":["r","data.frame","sapply"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1991,"score":4,"question_id":5330146,"title":"Apply a function to each row in a data frame in R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4236368/how-to-apply-a-function-to-every-row-of-a-matrix-or-a-data-frame-in-r\">how to apply a function to every row of a matrix (or a data frame) in R</a>  </p>\n</blockquote>\n\n\n\n<p>I want to apply a function to each row in a data frame, however, R applies it to each column by default. How do I force it otherwise?</p>\n\n<pre><code>&gt; a = as.data.frame(list(c(1,2,3),c(10,0,6)),header=T)\n&gt; a\n  c.1..2..3. c.10..0..6.\n1          1          10\n2          2           0\n3          3           6\n&gt; sapply(a,min)\n c.1..2..3. c.10..0..6. \n          1           0 \n</code></pre>\n\n<p>I wanted something like</p>\n\n<pre><code>1   2\n2   0\n3   3\n</code></pre>\n"},{"tags":["r","install"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12984271,"title":"how to install k nearest neighbour in R","body":"<p>There used to be a package called knnflex for language R, but it is not any longer available from CRAN. I have got the tar files, but how I can install it under R?\nalso is there any other package that can support knn.dist or knn.predict?</p>\n"},{"tags":["r","resampling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12983038,"title":"bootstrap resampling for hierarchical/multilevel data","body":"<p>I am attempting to do bootstrap resampling on a multilevel/hierarchical dataset.\nThe observations are (unique) patients clustered within hospitals.</p>\n\n<p>My strategy is to sample with replacement from the patients within each hospital in turn, which will ensure that all hospitals are represented in the sample and that when repeated all the samples sizes will be the same. This is method 2 <a href=\"http://mlrv.ua.edu/2004/vol30_n1_a5.pdf\" rel=\"nofollow\">here</a>.</p>\n\n<p>My code is like this:</p>\n\n<pre><code>hv &lt;- na.omit(unique(dt$hospital))\n\nsamp.out &lt;- NULL\n\nfor (hosp in hv ) {\n    ss1 &lt;- dt[dt$hospital==hosp &amp; !is.na(dt$hospital),]\n    ss2 &lt;- ss1[sample(1:nrow(ss1),nrow(ss1), replace=T),]\n    samp.out &lt;- rbind(samp.out,ss2)\n}\n</code></pre>\n\n<p>This seems to work (though if anyone can see any problem I would be grateful).</p>\n\n<p>The issue is that it is slow, so I would like to know if there are ways to speed this up.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>I have tried to implement Ari B. Friedman's answer but without success - so I have modified it slightly, with the aim of constructing a vector which then indexes the original dataframe. Here is my new code:</p>\n\n<pre><code># this is a vector that will hold unique IDs\nv.samp &lt;- rep(NA, nrow(dt))\n\n#entry to fill next\ni &lt;- 1\n\nfor (hosp in hv ) {\n    ss1 &lt;- dt[dt$hospital==hosp &amp; !is.na(dt$hospital),]\n\n    # column 1 contains a unique ID\n    ss2 &lt;- ss1[sample(1:nrow(ss1),nrow(ss1), replace=T),1]\n    N.fill &lt;- length(ss2)\n    v.samp[ seq(i,i+N.fill-1) ] &lt;- ss2\n\n    # update entry to fill next\n    i &lt;- i + N.fill\n}\n\nsamp.out &lt;- dt[dt$unid %in% v.samp,]\n</code></pre>\n\n<p>This is fast ! BUT, it fails to work properly because it only selects the unique IDs of <code>v.samp</code> in the final line, but the sampling is with replacement so there are repeated IDs in <code>v.samp</code>. Any further help will be much appreciated</p>\n"},{"tags":["r","cuda","cula"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":58,"score":-1,"question_id":12984881,"title":"Any luck installing gputools for R?","body":"<p>Does anyone know which CULA library is compatible with this package? The newest CULA libraries appear not to have a library gputools calls for. </p>\n\n<p><a href=\"http://cran.r-project.org/web/packages/gputools/index.html\" rel=\"nofollow\">http://cran.r-project.org/web/packages/gputools/index.html</a></p>\n\n<p><a href=\"http://www.culatools.com/downloads/dense/\" rel=\"nofollow\">http://www.culatools.com/downloads/dense/</a></p>\n\n<p>Anyone know of some SVD cuda source or OpenCL SVD?</p>\n"},{"tags":["r","numerical-integration"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":79,"score":-5,"question_id":12964484,"title":"R: integral calculation commands","body":"<p>What commands exist in R for numerical integration? \nSmth like quad or integral in Matlab. </p>\n\n<p>Any for multivariate functions?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12985091,"title":"Print Data Frame with Columns Center Aligned in R","body":"<p>I would like to print a data frame where the columns are center aligned.  Below is what I have I tried, I thought printing the data frame test1 would result in the columns being aligned in the center but this is not the case.  Any thoughts on how I can do this?</p>\n\n<pre><code>test=data.frame(x=c(1,2,3),y=c(5,6,7))\nnames(test)=c('Variable 1','Variable 2')\ntest[,1]=as.character(test[,1])\ntest[,2]=as.character(test[,2])\ntest1=format(test,justify='centre')\nprint(test,row.names=FALSE,quote=FALSE)\n Variable 1 Variable 2\n          1          5\n          2          6\n          3          7\nprint(test1,row.names=FALSE,quote=FALSE)\n Variable 1 Variable 2\n          1          5\n          2          6\n          3          7\n</code></pre>\n"},{"tags":["r","character","data.frame"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":12982896,"title":"Data frame and the very common mistake while using character columns","body":"<p>A very unexpected behavior of the useful <code>data.frame</code> in R arises from keeping <code>character</code> columns as factor. This causes many problems if it is not considered. For example suppose the following code:</p>\n\n<pre><code>foo=data.frame(name=c(\"c\",\"a\"),value=1:2)\n#   name val\n# 1    c   1\n# 2    a   2\n\nbar=matrix(1:6,nrow=3)\nrownames(bar)=c(\"a\",\"b\",\"c\")\n#   [,1] [,2]\n# a    1    4\n# b    2    5\n# c    3    6\n</code></pre>\n\n<p>Then what do you expect of running <code>bar[foo$name,]</code>? It normally should return the rows of <code>bar</code> that are named according to the <code>foo$name</code> that means rows 'c' and 'a'. But the result is different:</p>\n\n<pre><code>bar[foo$name,]\n#   [,1] [,2]\n# b    2    5\n# a    1    4\n</code></pre>\n\n<p>The reason is here: <code>foo$name</code> is not a character vector, but an integer vector.</p>\n\n<pre><code>foo$name\n# [1] c a\n# Levels: a c\n</code></pre>\n\n<p>To have the expected behavior, I manually convert it to character vector:</p>\n\n<pre><code>foo$name = as.character(foo$name)\nbar[foo$name,]\n#   [,1] [,2]\n# c    3    6\n# a    1    4\n</code></pre>\n\n<p>But the problem is that we may easily miss to perform this, and have hidden bugs in our codes. Is there any better solution?</p>\n"},{"tags":["r","latex","ggplot2","sweave","knitr"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":117,"score":2,"question_id":12935882,"title":"add latex to knitr multiple graphs","body":"<p>Hi I have some code producing multiple graphs with knitr mocked up below. The graphics grid that is produced is quite small and I'd like to add a <code>\\adjustbox{scale=1.25}{\\includegraphic{**}}</code> to the knitr includegraphic code but the obvious attempt to cat(\\includegrahics) hasn't worked. is there a simple way to add latex commands before and after the includegraphic that is produced?</p>\n\n<pre><code>\\documentclass{article}\n\\usepackage{adjustbox}\n\\begin{document}\n\\SweaveOpts{echo=FALSE, warning=FALSE,message=FALSE,error=FALSE}\n\n&lt;&lt;results='hide'&gt;&gt;=\nrequire(gdata)\nrequire(xtable)\nsource('~/Dropbox/Programming/R Resources/defs.R')\nrequire(grid)\nrequire(ggplot2)\nrequire(reshape2)\n@\n\n&lt;&lt;results='hide'&gt;&gt;=\nflows=structure(list(Fund.Domicile = c(\"A\", \"A\", \"A\", \"A\", \"A\", \"B\", \n\"B\", \"B\", \"B\", \"B\", \"C\", \"C\", \"C\", \"C\", \"C\", \"D\", \"D\", \"D\", \"D\", \n\"D\"), Fund.Investment.Type = c(\"W\", \"W\", \"W\", \"W\", \"W\", \"X\", \n\"X\", \"X\", \"X\", \"X\", \"Y\", \"Y\", \"Y\", \"Y\", \"Y\", \"Z\", \"Z\", \"Z\", \"Z\", \n\"Z\"), `2002` = c(-0.529898540845281, 0.772054875993179, -20.0331761409875, \n18.1013558280681, 5.24105768030327, -0.103737945556193, -21.1814709681659, \n-17.5440978426109, -15.5829977118454, -20.2260315293908, 40.1011996671901, \n31.7827753364134, 10.3285781074177, -0.439416156872641, 10.0561291484258, \n28.6005484483324, -0.78786653287941, -13.3541087171504, -23.2187998341653, \n-31.0039436462572), `2003` = c(14.7492468042958, -0.0275963287375104, \n-17.7708887712113, -21.6767106833672, 40.1833625101162, 11.123046653849, \n-7.75903264645413, -32.8999860636484, 2.08949747258285, -20.5043265068236, \n-1.36220948683688, -43.666119989502, 49.8895881388731, -6.77098667217137, \n-1.14679926989166, 1.95491694361459, -19.2996405333482, -27.7844292459854, \n-31.2344881507997, -19.5546235912165), `2004` = c(-23.7147297386606, \n-16.3947580155831, -26.2668449875697, 7.44336777160022, 10.5589478002836, \n-8.75005070668023, -1.86641790420448, 16.1977001332142, -22.1050631845402, \n-39.3516451994645, -49.0769487782368, -3.35924808913687, -24.4704066120435, \n-37.2442867971211, 0.683587234461294, -18.2706752984679, 41.5870386956072, \n-13.0489657114237, 15.9378239971014, 7.67697910507204), `2005` = c(-4.55959797613669, \n5.88565456256252, -1.69072856589651, 10.5241870675827, -14.6862822775804, \n17.5177606053963, -20.8386082504429, -19.4972967013319, -10.511857263532, \n-41.2074075438929, 24.5654545251262, 8.55786318066587, 5.44738422527871, \n0.634623938079709, 8.12292371061514, 23.4632529622168, 24.4070063548887, \n-11.0915520114019, 12.135207142526, 20.4497798625889), `2006` = c(9.75226025251804, \n-4.29865061171953, -2.09724392048597, 44.6666722837138, 30.661418933677, \n31.4006593587462, 7.81193825433631, 6.67455195559533, -21.4061513950816, \n-10.9347694700455, 21.679512353103, 3.00620296764385, -28.8652577925736, \n-2.40500496458537, -34.2999700917406, 4.16424846748192, 12.8570962420172, \n14.2386144440232, 24.8251023510994, -8.43426647739114), `2007` = c(5.63097110819688, \n24.5618516506043, -12.1851875872125, 1.47169500868284, -2.06314306074233, \n49.3156076715943, 22.1496090994165, -5.66968824427377, 19.0180156274722, \n9.60066029597923, -17.3853484334746, -20.3244695486896, 19.2245352517759, \n-27.0714138354969, -10.2816030397085, -32.7428648340247, -6.91534782810891, \n-22.5738223368588, -4.90194082412061, 4.5930516250516), `2008` = c(17.6132975354028, \n13.2825751589442, 10.9526114709831, 54.5347419688899, 10.2168636887397, \n22.7675434698984, 21.2966040483597, -5.48726279410465, -5.74273553195292, \n-15.9585829721537, -13.7289712451739, 7.30295584751816, -34.1484269522794, \n1.99774293039047, 20.1873723311578, -5.64271685865591, -15.2492762599638, \n14.8885666471535, -0.667785495902541, 25.3487149747655), `2009` = c(12.6895026843362, \n8.79135905052476, -31.1013615485344, 53.2336276071583, 0.850127605357284, \n-25.4230346228574, 0.685229220802603, 2.17685117184943, 22.9033401966985, \n4.99033888685287, -6.73959582268601, 1.64262497691941, -7.97937067923302, \n2.08671946596528, -1.49959272604534, -56.053302546395, -26.9877635637831, \n10.70792214362, 20.767800895652, 5.56759212862765), `2010` = c(9.12519719158834, \n56.4458682158794, 10.0924010459392, -26.1685287160829, 0.383729796176608, \n8.46399630560169, 13.9961555521805, 2.08243592536891, 9.30857371730836, \n-5.68931159712071, -1.90329476168925, 4.63803550621013, -9.6622478328383, \n38.2174244916787, -34.31334333628, -31.8687230108344, 22.2571919461198, \n18.0507770996133, -29.9436511641762, -5.15424637861403), `2011` = c(0.293475666658379, \n-37.6498026750657, 12.2168994671778, 35.4799718156936, -19.3929280696092, \n9.32638067918487, -29.0199397818446, -37.9432273617349, 2.94421967337048, \n-24.7995737867905, 27.0860382001494, 34.7688415979825, -6.63377573201861, \n14.2519054923501, 13.4697104157147, -7.33188207017677, 5.13471816288466, \n-5.04112561270486, -13.8230485866696, 44.0005209380284), `2012` = c(-1.46548181648837, \n11.469059790123, 21.0839248832524, 3.00780109149884, -32.9185824569684, \n22.120980240766, -3.46899628596499, 5.52026948842546, -10.1622646453992, \n-8.09625643479651, 1.20491472685827, 35.7200647592221, -25.2214669973592, \n27.114933346277, 4.11392575746633, -16.1856657167321, 22.0260776979833, \n-38.0714290042188, 23.4976820652487, 47.7740524641717)), .Names = c(\"Fund.Domicile\", \n\"Fund.Investment.Type\", \"2002\", \"2003\", \"2004\", \"2005\", \"2006\", \n\"2007\", \"2008\", \"2009\", \"2010\", \"2011\", \"2012\"), class = \"data.frame\", row.names = c(NA, \n-20L))\n@\n\n&lt;&lt;results='hide'&gt;&gt;=\ncountries=unique(flows[['Fund.Domicile']])\nff=melt(flows,id.vars=c(1:2))\nff[['sign']]&lt;-ifelse(ff[['value']] &gt;= 0, 'positive', 'negative')\n@\n\n&lt;&lt;results='asis',fig.height=11,fig.width=9&gt;&gt;=\nfor(c in countries){\n  ctry &lt;- subset(ff,subset=(Fund.Domicile == c))\n  grid.newpage()\n  pushViewport(viewport(layout=grid.layout(4,3)))\n  n=matrix(1:12,ncol=3,byrow=T)\n  strats=unique(ctry[['Fund.Investment.Type']])\n  k=length(strats)\n  for(i in 1:12){\n    if(i&lt;=k){\n      tmp2=subset(ctry,subset=(Fund.Investment.Type == strats[i]))\n      xco=which(n == i,arr.ind=T)[1]\n      yco=which(n == i,arr.ind=T)[2]\n      xx=ggplot(tmp2,aes(variable,value,fill=sign)) +\n        geom_bar(stat='identity') +\n        xlab(\"Year\") +\n        ylab(bquote(\"US$ Millions\")) +\n        ggtitle(paste(c,'\\n',strats[i])) +\n        guides(fill=F) +\n        theme(axis.title.x=element_text(size=6,colour='dark blue'),\n              axis.title.y=element_text(size=6,colour='dark blue'),\n              axis.text.x=element_text(size=4,angle=90),\n              axis.text.y=element_text(size=4),\n              plot.title=element_text(size=7,face='bold',colour='dark blue')) +\n        scale_fill_manual(values=c('positive' = 'dark blue','negative' = 'red'))\n          cat('\\\\adjustbox{scale=1.2}{',\n  print(xx,vp=viewport(layout.pos.row=xco,layout.pos.col=yco)),\"}\")\n    }\n  }\n}\n@\n\n\n\\end{document}\n</code></pre>\n\n<p>tex output added below</p>\n\n<pre><code>\\documentclass{article}\\usepackage{graphicx, color}\n%% maxwidth is the original width if it is less than linewidth\n%% otherwise use linewidth (to make sure the graphics do not exceed the margin)\n\\makeatletter\n\\def\\maxwidth{ %\n  \\ifdim\\Gin@nat@width&gt;\\linewidth\n    \\linewidth\n  \\else\n    \\Gin@nat@width\n  \\fi\n}\n\\makeatother\n\n\\IfFileExists{upquote.sty}{\\usepackage{upquote}}{}\n\\definecolor{fgcolor}{rgb}{0.2, 0.2, 0.2}\n\\newcommand{\\hlnumber}[1]{\\textcolor[rgb]{0,0,0}{#1}}%\n\\newcommand{\\hlfunctioncall}[1]{\\textcolor[rgb]{0.501960784313725,0,0.329411764705882}{\\textbf{#1}}}%\n\\newcommand{\\hlstring}[1]{\\textcolor[rgb]{0.6,0.6,1}{#1}}%\n\\newcommand{\\hlkeyword}[1]{\\textcolor[rgb]{0,0,0}{\\textbf{#1}}}%\n\\newcommand{\\hlargument}[1]{\\textcolor[rgb]{0.690196078431373,0.250980392156863,0.0196078431372549}{#1}}%\n\\newcommand{\\hlcomment}[1]{\\textcolor[rgb]{0.180392156862745,0.6,0.341176470588235}{#1}}%\n\\newcommand{\\hlroxygencomment}[1]{\\textcolor[rgb]{0.43921568627451,0.47843137254902,0.701960784313725}{#1}}%\n\\newcommand{\\hlformalargs}[1]{\\textcolor[rgb]{0.690196078431373,0.250980392156863,0.0196078431372549}{#1}}%\n\\newcommand{\\hleqformalargs}[1]{\\textcolor[rgb]{0.690196078431373,0.250980392156863,0.0196078431372549}{#1}}%\n\\newcommand{\\hlassignement}[1]{\\textcolor[rgb]{0,0,0}{\\textbf{#1}}}%\n\\newcommand{\\hlpackage}[1]{\\textcolor[rgb]{0.588235294117647,0.709803921568627,0.145098039215686}{#1}}%\n\\newcommand{\\hlslot}[1]{\\textit{#1}}%\n\\newcommand{\\hlsymbol}[1]{\\textcolor[rgb]{0,0,0}{#1}}%\n\\newcommand{\\hlprompt}[1]{\\textcolor[rgb]{0.2,0.2,0.2}{#1}}%\n\n\\usepackage{framed}\n\\makeatletter\n\\newenvironment{kframe}{%\n \\def\\at@end@of@kframe{}%\n \\ifinner\\ifhmode%\n  \\def\\at@end@of@kframe{\\end{minipage}}%\n  \\begin{minipage}{\\columnwidth}%\n \\fi\\fi%\n \\def\\FrameCommand##1{\\hskip\\@totalleftmargin \\hskip-\\fboxsep\n \\colorbox{shadecolor}{##1}\\hskip-\\fboxsep\n     % There is no \\\\@totalrightmargin, so:\n     \\hskip-\\linewidth \\hskip-\\@totalleftmargin \\hskip\\columnwidth}%\n \\MakeFramed {\\advance\\hsize-\\width\n   \\@totalleftmargin\\z@ \\linewidth\\hsize\n   \\@setminipage}}%\n {\\par\\unskip\\endMakeFramed%\n \\at@end@of@kframe}\n\\makeatother\n\n\\definecolor{shadecolor}{rgb}{.97, .97, .97}\n\\definecolor{messagecolor}{rgb}{0, 0, 0}\n\\definecolor{warningcolor}{rgb}{1, 0, 1}\n\\definecolor{errorcolor}{rgb}{1, 0, 0}\n\\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX\n\n\\usepackage{alltt}\n\\usepackage{adjustbox}\n\\begin{document}\n\n\n\\adjustbox{scale=1.2}{ \n\\includegraphics[width=\\maxwidth]{figure/unnamed-chunk-4} \n\n\n\\end{document}\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12985066,"title":"Gsub puzzle in R:the match pattern","body":"<pre><code>gsub(\"([a-z]+)([0-9]+)\",\"\\\\2\",\"ytu678yu\")\n[1] \"678yu\"\ngsub(\"([a-z]+)([0-9]+)(.*)\",\"\\\\2\",\"ytu678yu\")\n[1] \"678\"\n</code></pre>\n\n<p>I wonder why  <code>gsub(\"([a-z]+)([0-9]+)\",\"\\\\2\",\"ytu678yu\")</code>  can not get <code>678</code>? </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12984889,"title":"R bindings for SLEPC / PETSC?","body":"<p>Anyone have much luck within bindings for R and SLEPC? Looking for a faster SVD and eigenvalue algorithm in R.</p>\n\n<p>update: I'm generally interested in both scenarios(speed vs scale)</p>\n"},{"tags":["r","datetime","type-conversion"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":112,"score":0,"question_id":12976542,"title":"How to convert in both directions between year,month,day and dates in R?","body":"<p>How to convert between year,month,day and dates in R?</p>\n\n<p>I know one can do this via strings, but I would prefer to avoid converting to strings, partly because maybe there is a performance hit?, and partly because I worry about regionalization issues, where some of the world uses \"year-month-day\" and some uses \"year-day-month\".</p>\n\n<p>It looks like ISODate provides the direction year,month,day -> DateTime , although it does first converts the number to a string, so if there is a way that doesn't go via a string then I prefer.</p>\n\n<p>I couldn't find anything that goes the other way, from datetimes to numerical values?  I would prefer not needing to use strsplit or things like that.</p>\n\n<p>Edit: just to be clear, what I have is, a data frame which looks like:</p>\n\n<pre><code>year month day hour somevalue\n2004 1     1   1   1515353\n2004 1     1   2   3513535\n....\n</code></pre>\n\n<p>I want to be able to freely convert to this format:</p>\n\n<pre><code>time(hour units) somevalue\n1             1515353\n2             3513535\n....\n</code></pre>\n\n<p>... and also be able to go back again.</p>\n\n<p>Edit: to clear up some confusion on what 'time' (hour units) means, ultimately what I did was, and using information from <a href=\"http://stackoverflow.com/questions/12977073/how-to-find-the-difference-between-two-dates-in-hours-in-r\">How to find the difference between two dates in hours in R?</a>:</p>\n\n<p><strong>forwards direction:</strong></p>\n\n<pre><code>lh$time &lt;- as.numeric( difftime(ISOdate(lh$year,lh$month,lh$day,lh$hour), ISOdate(2004,1,1,0), units=\"hours\"))\nlh$year &lt;- NULL; lh$month &lt;- NULL; lh$day &lt;- NULL; lh$hour &lt;- NULL\n</code></pre>\n\n<p><strong>backwards direction:</strong></p>\n\n<p>... well, I didnt do backwards yet, but I imagine something like:</p>\n\n<ul>\n<li>create difftime object out of lh$time (somehow...)</li>\n<li>add ISOdate(2004,1,1,0) to difftime object</li>\n<li>use one of the solution below to get the year,month,day, hour back</li>\n</ul>\n\n<p>I suppose in the future, I could ask the exact problem I'm trying to solve, but I was trying to factorize my specific problem into generic reusable questions, but maybe that was a mistake?</p>\n"},{"tags":["r","labels","dendrogram","tree-nodes"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":47,"score":0,"question_id":12966392,"title":"How to get children for each internal node in R?","body":"<p>For the dendrogram object how can I get children of the internal nodes? Ideally I would like to extract children with their labels.</p>\n\n<p>thank you</p>\n"},{"tags":["r","logical-operators","boolean-operations","or-operator","and-operator"],"answer_count":3,"favorite_count":9,"up_vote_count":16,"down_vote_count":0,"view_count":5847,"score":16,"question_id":6558921,"title":"R - boolean operators && and ||","body":"<p>According to the R language definition the difference between &amp; and &amp;&amp; (correspondingly | and ||) is that the former is vectorized while the later is not.</p>\n\n<p>According to this site:\n<a href=\"http://www.stat.psu.edu/~dhunter/R/html/base/html/Logic.html\" rel=\"nofollow\">http://www.stat.psu.edu/~dhunter/R/html/base/html/Logic.html</a>\nI read the difference akin to the difference between an \"And\" and \"AndAlso\" (correspondingly \"Or\" and \"OrElse\")...meaning that not all evaluations if they don't have to be (i.e. A or B or C is always true if A is true, so stop evaluating if A is true)</p>\n\n<p>Could someone shed light here? Also, is there an AndAlso and OrElse in R?</p>\n"},{"tags":["r","plot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12984000,"title":"plotting data from a dat file in R","body":"<p>I am reading a manual of R that contains the following data in a file:</p>\n\n<pre><code>0.319132782  0.808869293\n0.612725533  0.932766104\n0.205770354  0.695866667\n0.395410972  1.044069042\n0.449560874  0.932377679\n0.532886257  1.009741399\n</code></pre>\n\n<p>data is delimited by a couple of blank spaces between each number. It is a .dat file\nIn one part of the example the author wants to plot the data and puts:</p>\n\n<pre><code>plot(all.x,all.y,xlab=\"x\",ylab=\"y\")\n</code></pre>\n\n<p>I have read the file with:</p>\n\n<pre><code>all&lt;-read.table(\"examples.dat\",header=F)\n</code></pre>\n\n<p>for the references to all.x and all.y I use</p>\n\n<pre><code>all.x&lt;-all[1]\nall.y&lt;-all[2]\n</code></pre>\n\n<p>the problem is that when I plot I got an error of stripchart, why is that?</p>\n"},{"tags":["r","web","text-mining"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":12982925,"title":"How to download article from WSJ with RCurl","body":"<p>I am trying to use RCurl along with XML package to download and mine article from the WSJ (wall street journal). However, whenever i use getURL from RCurl, i do get the version of the article which is available for public viewer.</p>\n\n<p>What i would like to be able to do is to download the full version of the article - as i am paying member. I imagine i have to pass the login credential, when i call the function getURL, however, i am not sure how to do so..</p>\n\n<ol>\n<li>Is this information stored in cookies?</li>\n<li>Do i need be \"authenticated\" - whatever the difference (in purpose maybe) is?</li>\n</ol>\n\n<p>I would appreciate if someone could explain how do website such as WSJ, uses login-info to fetch data, and how can i tweak RCurl in order to take such information into account. A very simple example will go a long way in explaining the different concept of setting cookies (files, jar, ..) etc</p>\n\n<p>Thank you in advance</p>\n"},{"tags":["r","function"],"answer_count":1,"favorite_count":1,"up_vote_count":12,"down_vote_count":1,"view_count":118,"score":11,"question_id":12982528,"title":"How to create an R function programmatically?","body":"<p><a href=\"http://stackoverflow.com/users/16632/hadley\">Hadley Wickham</a> recently asked an interesting question on the <a href=\"https://stat.ethz.ch/pipermail/r-devel/2012-October/064946.html\">r-devel mailing</a> list, and being unable to find an existing question on the topic on StackOverflow, I thought it might be useful for it exist here as well.</p>\n\n<p>To paraphrase:</p>\n\n<p><strong>An R function consists of three elements: an argument list, a body and an environment. Can we construct a function programmatically from these three elements?</strong></p>\n\n<p>(A fairly comprehensive answer is reached at the end of the thread in the r-devel link above. I will leave this open for others to recreate the benchmarking of the various solutions themselves and supply it as an answer, but be sure to cite Hadley if you do. If no one steps up in a few hours I'll do it myself.)</p>\n"},{"tags":["r","subset","logical-operators"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":1,"view_count":629,"score":4,"question_id":6933598,"title":"R: subset() logical-and operator for combining conditions should be & not &&","body":"<p>Why doesn't <code>subset()</code> work with a logical and <code>&amp;&amp;</code> operator combining two conditions?</p>\n\n<pre><code>&gt; subset(tt, (customer_id==177 &amp;&amp; visit_date==\"2010-08-26\"))\n&lt;0 rows&gt; (or 0-length row.names)\n</code></pre>\n\n<p>but they each work individually:</p>\n\n<pre><code>&gt; subset(tt, customer_id==177)\n\n&gt; subset(tt, visit_date==\"2010-08-26\")\n</code></pre>\n\n<p>(Want to avoid using large temporary variables - my dataset is huge)</p>\n"},{"tags":["r","google-docs"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12831246,"title":"Is there a way to read columns with strings as strings when using RGoogleDcos","body":"<p>I use RGoogleDocs a lot. I use it to read in data that is private or only shared with a few people. I know that <code>read.table</code> and <code>read.csv</code> allow one to use <code>stringsAsFactors=FALSE</code>.</p>\n\n<p>I want to do something similar in RGoogleDocs. Here is my typical code</p>\n\n<pre><code>sheets.con &lt;- getGoogleDocsConnection(getGoogleAuth(\"fjb@gmail.com\", ps, service =\"wise\"))\nspreadsheet &lt;- getWorksheets(\"private spreadsheet\",sheets.con)\nfirst &lt;- sheetAsMatrix(spreadsheet$\"Sheet 1\",header=TRUE, as.data.frame=TRUE, trim=TRUE) #Get one sheet\n</code></pre>\n\n<p>That almost always reads the character values as factors. I have been using data.table a lot lately and factors seem to make my data munging in data.table a bit bothersome. Is there an easy way to read the non-numeric columns as character vectors rather than as factors?</p>\n"},{"tags":["r","statistics"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12982991,"title":"Subsetting from a file-stored dataframe (ffdf) exceeds memory","body":"<p>I am working with a dataset of about 17M x 4 values on a 32bit Windows machine. This requires ~700 MB in GNU R - so when I try to do some enhanced operations, the 2 GB limit is easily reached and I receive an out-of-memory error (cannot allocate vector ...).</p>\n\n<p>No problem - there is package \"ff\" to store such data on disk. However my first subset rund in the same error. According to the ff documentation I expected that \"[\" would subset directly into another ffdf without loading two copies of the data into memory. Where am I exactly wrong?</p>\n\n<pre><code>ffshares = read.table.ffdf(\n  file=tmpFilename, header = FALSE, sep = \",\", quote = \"\\\"\",\n  dec = \".\",\n  col.names = c(\"articleID\", \"measure\", \"time\", \"value\"),\n  na.strings = c(\"\",\"-1\",\"\\\\N\"),\n  colClasses = c(\"integer\",\"factor\",\"POSIXct\",\"integer\"),\n  check.names = TRUE, fill = TRUE,\n  strip.white = FALSE, blank.lines.skip = TRUE,\n  comment.char = \"\",\n  allowEscapes = F, flush = F #, nrow=1000\n)\n# Until here, the R process requires about 200M\n\nffshares = ffshares[ffshares[,\"articleID\"] %in% articles[,\"articleID\"],]\n# As I try this, memory consumption exceeds 1.7G and the available limits\n</code></pre>\n\n<p>Note: articles is a dataframe with ~30K rows. The articleID is a simple integer.</p>\n\n<p>Bonus question: ffshares[,\"articleID\"] works but ffshares$articleID does not. According to the documentation the dollar ($) should work like in a dataframe?!</p>\n\n<p>Thanks for any advice :)</p>\n"},{"tags":["r","ggplot2","plyr"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12982734,"title":"Plot multivalue (one to many) data with ggplot2","body":"<p>I have data which shows who is in a photo stored as CSV in a file:</p>\n\n<pre><code>|------------+---------------------------|\n| image      | people                    |\n|------------+---------------------------|\n| image1.png | John, Paul                |\n| image2.png | John                      |\n| image3.png |                           |\n| image4.png | George, Paul, John, Ringo |\n| ...        |                           |\n|------------+---------------------------|\n</code></pre>\n\n<p>I would like to load it into R, and plot this in various ways, but let's say I'd like to get a bar graph that shows how many appearances each person makes.</p>\n\n<p>I can restructure the data if that helps.</p>\n\n<p>Thank you</p>\n"},{"tags":["r","shapefile","raster"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":12982282,"title":"average raster file value in shapefile area returns multiple outputs - interpreting results","body":"<p>So I have my raster file</p>\n\n<pre><code>r &lt;- raster('ras')\n</code></pre>\n\n<p>and a shapefile</p>\n\n<pre><code>abys &lt;- readShapeSpatial('abys')\n</code></pre>\n\n<p>I calculated the mean values defined by the shapefile by the following method:</p>\n\n<pre><code>r.vals&lt;- extract(r,abys)\nr.mean &lt;- lapply(r.vals,FUN=mean)\n</code></pre>\n\n<p>However, when using a couple of shapefiles when I return the output I get multiple results, e.g.:</p>\n\n<pre><code>[[1]]\n[1] 9321\n\n[[2]]\n[1] 6616\n\n[[3]]\n[1] 8348\n</code></pre>\n\n<p>It should just return one which is what I usually get. Is this because of some characterestic of my shapefile or a problem with my methodology?</p>\n\n<p>Thanks for your input</p>\n"},{"tags":["facebook","r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12982830,"title":"recoding facebook timestamp in R","body":"<p>How do I recode of vector of timestamps from a facebook api pull that is a factored looking like the following to a time/date variable? </p>\n\n<pre><code>[[1] 2012-10-19T19:52:43+0000\n</code></pre>\n\n<p>I tried the following, but I only get NAs:</p>\n\n<pre><code>strptime(as.character(time), \"%Y-%b-%dT%H:%M:%S+0000\")\n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12982743,"title":"R ggplot2 wrap long x-axis labels over multiple rows","body":"<p>I have a bar chart (I used ggplot2, geom_bar), but the labels for x-axis are too long and overlap. I would like to keep them as long as they are, but I also would like them to be horizontally (not vertically, nor with an angle). Is there some way to wrap the long labels over multiple (at least two) rows?</p>\n"},{"tags":["r","data.frame","quantmod"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12981793,"title":"R data frame with dates","body":"<p>I have a data frame in the following form</p>\n\n<pre><code>           SPY.Open SPY.High SPY.Low SPY.Close SPY.Volume SPY.Adjusted\n2007-01-03   142.25   142.86  140.57    141.37   94807600       125.38\n2007-01-04   141.23   142.05  140.61    141.67   69620600       125.65\n2007-01-05   141.33   141.40  140.38    140.54   76645300       124.64\n2007-01-08   140.82   141.41  140.25    141.19   71655000       125.22\n2007-01-09   141.31   141.60  140.40    141.07   75680100       125.11\n2007-01-10   140.58   141.57  140.30    141.54   72428000       125.53\n</code></pre>\n\n<p>however the command <code>index(DATA.FRAME)</code> return integers rather than dates. What function should I use to get a list of dates instead of integers?</p>\n\n<p>EDIT: </p>\n\n<p>The output of dput(DATA.FRAME) is</p>\n\n<pre><code>structure(list(SPY.Open = c(142.25, 141.23, 141.33, 140.82, 141.31, \n140.58), SPY.High = c(142.86, 142.05, 141.4, 141.41, 141.6, 141.57\n), SPY.Low = c(140.57, 140.61, 140.38, 140.25, 140.4, 140.3), \n    SPY.Close = c(141.37, 141.67, 140.54, 141.19, 141.07, 141.54\n    ), SPY.Volume = c(94807600, 69620600, 76645300, 71655000, \n    75680100, 72428000), SPY.Adjusted = c(125.38, 125.65, 124.64, \n    125.22, 125.11, 125.53)), .Names = c(\"SPY.Open\", \"SPY.High\", \n\"SPY.Low\", \"SPY.Close\", \"SPY.Volume\", \"SPY.Adjusted\"), row.names = c(\"2007-01-03\", \n\"2007-01-04\", \"2007-01-05\", \"2007-01-08\", \"2007-01-09\", \"2007-01-10\"\n), class = \"data.frame\")\n</code></pre>\n"},{"tags":["r","sum","matching","fuzzy","approximate"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":118,"score":3,"question_id":12903368,"title":"Pulling information from the first approximate match of a text string in R (and summing the total number of matches)","body":"<p>I'm having trouble summing approximate matches of text strings, as well as pulling information from the string that was matched\nfirst in time. </p>\n\n<p>I have data that look like this:</p>\n\n<pre><code>text&lt;-c(\"THEN it goes West\",\"AT it falls East\",\"it goes West\", \"it falls East\", \"AT it goes West\")\ndate&lt;-c(2008,2009,2003,2006,2011)\nID&lt;-c(1,2,3,4,5)\ndata&lt;-cbind(text,date,ID)\ndata&lt;-as.data.frame(data)\n</code></pre>\n\n<p>Notice that the latest text strings have all-caps \"THEN\" and \"AT\" added to the earlier text strings. </p>\n\n<p>I would like a table that looks like this: </p>\n\n<pre><code>     ID  Sum Originaltext     Originaldate\n[1,] \"4\" \"3\" \"it goes West\"      \"2003\"      \n[2,] \"2\" \"2\" \"it falls East\"     \"2006\" \n</code></pre>\n\n<p>This includes:</p>\n\n<p>The <strong>ID</strong> number corresponding with the text with the earliest date (the \"original\" text that the others were derived from). \n<strong>Sums</strong> of all approximate matches for each. \nThe <strong>text</strong> corresponding with the earliest date. \nAnd the <strong>date</strong> of the text corresponding with the earliest date. </p>\n\n<p>I have tens of millions of cases, so I'm having trouble automating the process. </p>\n\n<p>I run Windows 7, and have access to fast-computing servers. </p>\n\n<p><strong>IDEAS</strong></p>\n\n<pre><code>#order them backwards in time\ndata&lt;-data[order(data$date, decreasing = TRUE),]\n\n#find the strings with the latest date\n\npattern&lt;-\"AT|THEN\"\n\nk &lt;- vector(\"list\", length(data$text))\n\n for (j in 1:length(data$text)){\n     k[[j]]&lt;- grep(pattern,data$text[[j]], ignore.case=FALSE)\n}\n\nk&lt;-subset(data$text, k==1)\n\nk&lt;-unique(k)\n\n#this is a problem, because case nos. 1 and 5 are still in the dataset, but they derive from the same tweet. \n</code></pre>\n\n<p>From here, I can use \"agrep\", but I'm not sure in what context. Any help would be greatly appreciated!</p>\n\n<p>NOTE: While the three answers below do answer my question the way I originally asked it, I have not mentioned that my text cases do vary even without the words \"AT\" and \"THEN\". In fact, most of them do not match exactly. I should have put this in the original question. However, I would still love an answer. </p>\n\n<p>Thanks!</p>\n"},{"tags":["r","sparse-matrix"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":12009078,"title":"Cluster Analysis in R on large sparse matrix","body":"<p>I have a transaction dataset with  250000 transactions (rows) and 2183 items (columns). I wanna transform it to a sparse matrix and then do hierarchical cluster on it. I tried package 'sparcl', but it seems it doesn't work on sparse matrix. Any suggestion about how to solve this problem? Or any other package I can use to do cluster analysis on sparse matrix?  Thanks!</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12980081,"title":"Create a stacked density graph in ggplot2","body":"<p>I'm trying to create a stacked density graph in ggplot2, and I am also trying to understand how qplot works relative to ggplot.</p>\n\n<p>I found the following example online:</p>\n\n<pre><code>qplot(depth, ..density.., data=diamonds, geom=\"density\", \n  fill=cut, position=\"stack\")\n</code></pre>\n\n<p>I tried translating this into a call to ggplot because I want to understand how it works:</p>\n\n<pre><code>ggplot(diamonds, aes(x=depth, y=..density..)) + \n  geom_density(aes(fill=cut, position=\"stack\"))\n</code></pre>\n\n<p>This creates a density graph, but does <strong>not</strong> stack it.</p>\n\n<p>What is the different between what qplot is creating and what ggplot is creating?</p>\n\n<p>Here is a stacked density graph:</p>\n\n<p><img src=\"http://i.stack.imgur.com/quzkI.png\" alt=\"stacked density\"></p>\n\n<p>Non-stacked density graph:</p>\n\n<p><img src=\"http://i.stack.imgur.com/cwRFc.png\" alt=\"enter image description here\"></p>\n\n<p>Original example is <a href=\"http://docs.ggplot2.org/0.9.2.1/stat_density.html\" rel=\"nofollow\">here</a></p>\n"},{"tags":["r","ggplot2","legend"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12980039,"title":"Add geom with its own scales and legend","body":"<p>This is arguable a follow up to these questions:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/10349206/add-legend-to-ggplot2-line-plot\">Add legend to ggplot2 line plot</a></p>\n\n<p><a href=\"http://stackoverflow.com/questions/12545322/add-vline-to-existing-plot-and-have-it-appear-in-ggplot2-legend\">Add vline to existing plot and have it appear in ggplot2 legend?</a></p>\n\n<p>I wish to add a geom to a plot that would have its own independent data, scale and legend elements.</p>\n\n<p>I realize this may violate some of the grammar of graphics principles but I often find myself wanting such elements as vertical or horizontal lines, single points, arrows etc that would appear in the legend.</p>\n\n<p>There seems to be added difficulty when scales are already used in other geom mappings.</p>\n\n<p>Here is not so pretty example using iris:</p>\n\n<pre><code>p&lt;-qplot(data=iris, x=Petal.Width,\n         y=Sepal.Width,\n         colour=Species,\n         shape=as.factor(round(Petal.Length)),\n         linetype=as.factor(round(Sepal.Length)),\n         geom=c(\"line\", \"point\"))\n\np&lt;-p+geom_vline(xintercept=0.75, aes(linetype=\"Setosa vs Versicolor\"))\np&lt;-p+geom_vline(xintercept=1.75, aes(linetype=\"Versicolor vs Virginica\"))\n\nprint(p) \n</code></pre>\n\n<p>Which currently produces, missing linetype of vline and associate legend.</p>\n\n<p><img src=\"http://i.stack.imgur.com/juTsC.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":12980095,"title":"is.nan() behavior","body":"<p>Created a data frame:</p>\n\n<pre><code>simpleDF&lt;- structure(list(vals = c(NA, NaN, 2)), .Names = \"vals\", row.names = c(NA, \n-3L), class = \"data.frame\")\n\n\n&gt; is.na(simpleDF$vals)\n[1]  TRUE  TRUE FALSE\n&gt; is.nan(simpleDF$vals)\n[1] FALSE  TRUE FALSE\n</code></pre>\n\n<p>Now, when I change the data frame to include a string value:</p>\n\n<pre><code>simpleDF &lt;- structure(list(vals = structure(c(NA, 2L, 1L, 3L), .Label = c(\"2\", \n\"NaN\", \"test\"), class = \"factor\")), .Names = \"vals\", row.names = c(NA, \n-4L), class = \"data.frame\")\n\n&gt; is.na(simpleDF$vals)\n[1]  TRUE FALSE FALSE FALSE\n&gt; is.nan(simpleDF$vals)\n[1] FALSE FALSE FALSE FALSE\n</code></pre>\n\n<p>I did not understand why <code>NaN</code> is no longer recognized by <code>is.nan()</code>? Sure there would be an explanation .. </p>\n"},{"tags":["r","graph","igraph","social-graph","sna"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12964332,"title":"igraph edge between two vertices","body":"<p>I'm new to R and igraph and I was wondering if anybody can help me with the following.</p>\n\n<p>I want to find the edge weight between two vertices in a graph. My graph structure is defined by the normal  ego (node1), alter (node2) and the weight of the edge between them.</p>\n\n<p>I know that I can get the weight for each of the edges in the list of edges that originate from node number 5 using <strong>E(igraph_friendship) [ from(5) ]$weight</strong>\nAnd that I can find the weight for each of the edges in the list of edges that end onto node number 10 using <strong>E(igraph_friendship) [ to(10) ]$weight</strong></p>\n\n<p>But what if I simply want to find the weight of the edge that simple connects just node 5 and node 10? </p>\n\n<p>Alternatively, if I can get the identifier of the edge that connects node 5 and 10 in the list of all edges, <strong>E(igraph_friendship)</strong>, that would work too.</p>\n\n<p>Thanks a lot for your help, I've been looking around a lot for it and I really appreciate your help!</p>\n"},{"tags":["r","functional-programming","plyr"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":78,"score":3,"question_id":12949683,"title":"Avoiding for-loops when aggregating timeseries","body":"<p>I get why vectorised functions are better than for-loops. </p>\n\n<p>But there are some problems where I can't see the vectorised functional programming solution. One of those is summing monthly data to get quarterly data. Any suggestions to replace this code ...</p>\n\n<pre><code>month &lt;- 1:100\nA422072L &lt;- c(rep(NA, 4), rnorm(96, 100, 5) ) + 2 * month\nA422070J &lt;- c(NA, NA, rnorm(96, 100, 5), NA, NA) + 2 * month\nAu.approvals &lt;- data.frame(month=month, A422072L=A422072L, A422070J=A422070J)\n\nAu.approvals$trend.sum.A422072L.qtr &lt;- NA\nAu.approvals$sa.sum.A422070J.qtr &lt;- NA\nfor(i in seq_len(nrow(Au.approvals)))\n{\n    if(i &lt; 3) next\n    if(all(!is.na(Au.approvals$A422072L[(i-2):i])))\n        Au.approvals$trend.sum.A422072L.qtr[i] &lt;- sum(Au.approvals$A422072L[(i-2):i])\n    if(all(!is.na(Au.approvals$A422070J[(i-2):i])))\n        Au.approvals$sa.sum.A422070J.qtr[i]    &lt;- sum(Au.approvals$A422070J[(i-2):i])\n}\n\nprint(Au.approvals)\n</code></pre>\n\n<p>Now with enough data to run as an example.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":37,"score":-1,"question_id":12975433,"title":"makeActiveBinding symbol executes when used as argument to function?","body":"<p>I have the following binding defined (and it works fine):\n<code>invisible(makeActiveBinding('newdev', function(...) {  windows(4.5,4.5,restoreConsole=T)},.GlobalEnv))</code></p>\n\n<p>What I can't figure out is why it executes when, for example I do something like\n<code>get('newdev')</code>  or <code>sqrt(newdev)</code>   (silly, but just to show what happens), a new graphics window is created.    For that matter,   <code>save.image()</code> causes \"newdev\" to execute as well.</p>\n\n<p>Any ideas?</p>\n\n<p>Edit: Yes, I'm lazy and wish that there were a simple way in R to execute zero-argument commands without requiring \"()\" to be appended.  Shame on me -- that is my actual question, i.e. is it possible to do so in a more appropriate way?</p>\n\n<p>edit number two:</p>\n\n<p>I suppose I could just create <code>'%$%' &lt;- function(x,y) dev.new()</code> and call it with arbitrary args, e.g. <code>a%$%b</code> which looks silly but gets the job done.   Too bad R doesn't allow (so far as I can tell) me to create my own unary or \"none-ary\" operators. </p>\n"},{"tags":["r","datetime"],"answer_count":2,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":555,"score":9,"question_id":7958298,"title":"How do you convert POSIX date to day of year in R?","body":"<p>The title has it: how do you convert a POSIX date to day-of-year?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":12979622,"title":"Vertically combine many matrices in R","body":"<p>I have a design matrix generated by</p>\n\n<pre><code> grp.ids &lt;- as.factor(c(rep(1,8), rep(2,4), rep(3,2)))\n x &lt;- model.matrix(~grp.ids)\n</code></pre>\n\n<p>Now I hope to vertically concatenate the matrix <code>x</code> for 100 times. If for 2 times, then a call to <code>rbind(x,x)</code> will work. How to repeat the process for 100 times? Or is there any other function available for directly generating such big design matrix (based on this small matrix block)? Thanks a lot!</p>\n"},{"tags":["algorithm","r","sorting","metric"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":98,"score":2,"question_id":12883296,"title":"R implementation of sorting by reversals","body":"<p>I was wondering if there is an implementation in R where it sorts a permutation of n numbers into the original 1...n sequence and provides the number of reversals needed. Eg an implementation of the \"sorting by reversals\" or \"sorting by translocation\" as outlined in this <a href=\"http://www.cs.ucr.edu/~stelo/cpm/cpm04/01_Tannier.ppt\" rel=\"nofollow\">ppt</a>. </p>\n\n<p>Specifically, I have a permutation of a sequence of n elements, pi(n), and I want to figure out how close it is to the original sequence. The number of reversals seems a good metric.</p>\n\n<p>Thanks!</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":12978810,"title":"How to calculate the percentage of data points belonging to a range of values?","body":"<p>Given a table of values (say between 0 to 100) and the attached plot, what would be the simplest way using R to calculate how many of the data points fall between values 20 - 60 (the red box in the image)?</p>\n\n<p>And is there a way to create that red box using R's plotting functions (I did it using a image editor...)? </p>\n\n<p>Thanks for the help.\n<img src=\"http://i.stack.imgur.com/BQkXK.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","namespaces","makefile","package","shared-libraries"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":12976036,"title":"How to use useDynLib() correctly in an R package namespace file","body":"<p>Although a few solutions exist on the internet, I found none of those suitable for the problem I'm curerntly facing (though maybe I'm simply too dumb):</p>\n\n<p>I'm trying to build an R package which makes extensive use of a shared object compiled by a Makefile (yes, bad practice, I know, but a Makevars file just can't be told to compile C and Fortran code into one shared object) from code in the package's <code>src</code> directory. No matter where I compile that .so to (I tried the <code>src</code>, <code>libs</code> and package base folders) or how I name it (as one of the solutions mentioned above states it must be named like the package it's contained in), <code>R CMD check</code> exits with</p>\n\n<pre><code>** testing if installed package can be loaded\nError in library.dynam(lib, package, package.lib) : \nshared object ‘SoMNibEN.R.so’ not found\n</code></pre>\n\n<p>due to the <code>useDynLib(SoMNibEN.R)</code> instruction in my NAMESPACE file (where <code>SoMNibEN.R</code> is my package's name, but it didn't work with the original name, either)</p>\n\n<p>My assumption is that I'm either using that <code>useDynLib()</code> command wrong or I'm doing something wrong with my Makefile (although the compilation works pretty well and the shared object is created in my project folder - I just don't know whether it gets copied to the package installation directory successfully).</p>\n\n<p>So, if anyone knows what I might be doing wrong here, please let me know!</p>\n"},{"tags":["r","categorization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12979456,"title":"R code to categorize age into group?","body":"<p>I am trying to categorize age into group so it will not be continuous. I have this code: </p>\n\n<pre><code>data$agegrp(data$age&gt;=40 &amp; data$age&lt;=49) &lt;- 3\ndata$agegrp(data$age&gt;=30 &amp; data$age&lt;=39) &lt;- 2\ndata$agegrp(data$age&gt;=20 &amp; data$age&lt;=29) &lt;- 1\n</code></pre>\n\n<p>the above code is not working under survival package. It's giving me:</p>\n\n<pre><code>invalid function in complex assignment\n</code></pre>\n\n<p>Can you point me where the error is? <code>data</code> is the filename I am using. </p>\n"},{"tags":["r","bioinformatics"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12975967,"title":"R + SNOW for Computational Biology/ Biology","body":"<p>I am interested in looking at sample R scripts using SNOW for any bioinformatics or computational biology applications. Wondering if anybody knows a repository or anybody would be able to help? Many thanks.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":52,"score":0,"question_id":12978326,"title":"factor() command in R is for categorical variables with hierarchy level only?","body":"<p>I'm quite confused on when to use<blockquote>\nfactor(educ)    or     factor(agegroup)   </blockquote>\n in R. Is it used for categorical ordered data? or can I just use to it a simple categorical data with no hierarchy?</p>\n\n<p>I know this is so basic. I really need some clarification. </p>\n"},{"tags":["r","colors"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":12976069,"title":"why do I not find a LAB color cube?","body":"<p>I use the R <code>colorspace</code> package to convert a three-dimensional point into a LAB color. The LAB color is defined with three coordinates, the first one ranges from 0 to 100 and the two other ones range from -100 to 100. </p>\n\n<p>But searching with Google I do not find a cuboidal representation of the LAB color space. Why ?</p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":331,"score":6,"question_id":9031819,"title":"Add named vector to a list","body":"<p>This is horribly basic but I can't seem to figure it out</p>\n\n<p>Suppose I have a list of variable entries:</p>\n\n<pre><code>lst &lt;- list(a=1:4, b=rep('k', 5), c=3)\n</code></pre>\n\n<p>If I want to add a vector to this with a specified name I should be able to do so by:</p>\n\n<pre><code>c(f=1:5, lst)\n</code></pre>\n\n<p>But instead of creating an entry called 'f' containing 1 2 3 4 5 it creates five entries (f1 - f5) containing one of the numbers each.</p>\n\n<p>How do I supress this behavior?</p>\n\n<p>I know I can use</p>\n\n<pre><code>lst$f &lt;- 1:5\n</code></pre>\n\n<p>but I would like to append the list within a function call...</p>\n"},{"tags":["r","datetime"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":71,"score":1,"question_id":12977073,"title":"How to find the difference between two dates in hours in R?","body":"<p>At the extreme risk of being modded down for asking \"obvious\" questions, how do I find the difference between two dates in hours in R?</p>\n\n<pre><code>&gt; ISOdate(2004,1,6) - ISOdate(2004,1,1)\nTime difference of 5 days\n&gt; as.POSIXlt(ISOdate(2004,1,6) - ISOdate(2004,1,1))\nError in as.POSIXlt.default(ISOdate(2004, 1, 6) - ISOdate(2004, 1, 1)) : \n  do not know how to convert 'ISOdate(2004, 1, 6) - ISOdate(2004, 1, 1)' to class \"POSIXlt\"\n &gt; (ISOdate(2004,1,6) - ISOdate(2004,1,1))$year\nError in (ISOdate(2004, 1, 6) - ISOdate(2004, 1, 1))$year : \n  $ operator is invalid for atomic vectors\n&gt; (ISOdate(2004,1,6) - ISOdate(2004,1,1))$mon\nError in (ISOdate(2004, 1, 6) - ISOdate(2004, 1, 1))$mon : \n  $ operator is invalid for atomic vectors\n</code></pre>\n"},{"tags":["regex","r"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":12966207,"title":"Gsub to get part matched strings in R regular expression?","body":"<pre><code>gsub('[a-zA-Z]+([0-9]{5})','\\\\1','htf84756.iuy')\n[1] \"84756.iuy\"\n</code></pre>\n\n<p>I want to get 84756,how can i do?</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":74,"score":4,"question_id":12965170,"title":"ggplot2 binwidth not responding in facet_wrap histogram plot","body":"<p>Would appreciate any thoughts on how to make my code or binwidth behave.  My dataset contains timestamped data points collected every few hours \"4\", and daily \"24\".  I am trying to plot the 4 hour stacked histograms on the left and the 24 hour stacked histograms on the right.  Therefore, I want the binwidth on the right to be 6x wider than the left binwidth.  But everything I've tried with binwidth has not worked.  The x axis data, data3$dts appears to be continuous and not discrete but maybe I'm not doing that right.</p>\n\n<p>Important note about the data:  Data that gets graphed on the right side, the hours=24 data, has a dts value that is always an integer.  Data on the left, the hours=4 data, has non-integer dts values. </p>\n\n<pre><code>             \"dts\"  \"Yes\" \"No\" \"Maybe\" \"hours\"  \"days\"\n\"258\"   15627.668   8       0   1       4   \"7 Days\"\n\"259\"   15627.832   13      11  18      4   \"7 Days\"\n\"260\"   15628       34      47  89      4   \"7 Days\"\n\"261\"   15628       37      47  90      24  \"7 Days\"\n\"262\"   15628.168   3       0   1       4   \"7 Days\"\n\"40\"    15571       345     419 674     24  \"90 Days\"\n\"41\"    15571.5     91      145 130     4   \"90 Days\"\n\"42\"    15571.668   158     149 284     4   \"90 Days\"\n\"43\"    15571.832   96      125 260     4   \"90 Days\"\n\"44\"    15572       55      33  137     4   \"90 Days\"\n\"45\"    15572       1050    1119 2660   24  \"90 Days\"\n</code></pre>\n\n<p>Code with data pulled from pastebin:</p>\n\n<pre><code>library (ggplot2)\nlibrary (scales)\nlibrary(grid)\nlibrary(gridExtra)\n\ncolor3 &lt;- c(\"mediumspringgreen\",\"red\",\"grey44\")\ntitles.days &lt;-  c( \"7 Days\", \"90 Days\") \nnames.facetby &lt;- c (\"dts\", \"hours\", \"days\")\n\ndata3 &lt;- read.table (\"http://pastebin.com/download.php?i=wUQQUXP4\", header=TRUE)\ndata3.melt &lt;- melt (data3 , id = names.facetby )   \ndata3.melt$days &lt;- factor (data3.melt$days, levels = titles.days)   #  put the factor in the right order, so the graphs are in the right order\n\n a &lt;- ggplot     ( data3.melt \n        , aes (       x =  dts  #as.Date( dts , date1970) \n                , y =  value \n                , fill = variable)) +\n        opts (axis.text.x=theme_text(angle=0, hjust=1)) +\n        scale_fill_manual(values = color3) +\n        scale_x_date(labels = date_format(\"%m/%d\\n    %a\") ) +\n        geom_histogram (stat = \"identity\", position = \"stack\", binwidth=6.2) +  \n        facet_wrap( days ~ hours, ncol=2, scales=\"free\")            \n\nprint(a)        \n</code></pre>\n\n<p>Current results, showing the right sided graphs with binwidth way too narrow:</p>\n\n<p><img src=\"http://i.stack.imgur.com/XIhv0.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12976569,"title":"Variable Length Core Name Identification","body":"<p>I have a data set with the following row-naming scheme:</p>\n\n<pre><code>a.X.V\nwhere:\na is a fixed-length core ID\nX is a variable-length string that subsets a, which means I should keep X\nV is a variable-length ID which specifies the individual elements of a.X to be averaged\n. is one of {-,_}\n</code></pre>\n\n<p>What I am trying to do is take column averages of all the <code>a.X's</code>.  A sample:</p>\n\n<pre><code>sampleList &lt;- list(\"a.12.1\"=c(1,2,3,4,5), \"b.1.23\"=c(3,4,1,4,5), \"a.12.21\"=c(5,7,2,8,9), \"b.1.555\"=c(6,8,9,0,6))\nsampleList\n$a.12.1\n[1] 1 2 3 4 5\n\n$b.1.23\n[1] 3 4 1 4 5\n\n$a.12.21\n[1] 5 7 2 8 9\n\n$b.1.555\n[1] 6 8 9 0 6\n</code></pre>\n\n<p>Currently I am manually gsubbing out the <code>.Vs</code> to get a list of general :</p>\n\n<pre><code>sampleList &lt;- t(as.data.frame(sampleList))\ny &lt;- rowNames(sampleList)\ny &lt;- gsub(\"(\\\\w\\\\.\\\\d+)\\\\.d+\", \"\\\\1\", y)\n</code></pre>\n\n<p>Is there a faster way to do this?</p>\n\n<p>This is one half of 2 issues I've encountered in a workflow.  The other half was answered <a href=\"http://stackoverflow.com/questions/12975794/easy-way-to-get-averages-based-on-names-in-list\">here</a>.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12975794,"title":"Easy Way to Get Averages Based on Names in List","body":"<p>Is there any easy way to get the averages of items in a list based on their names?  Example dataset:</p>\n\n<pre><code>sampleList &lt;- list(\"a.1\"=c(1,2,3,4,5), \"b.1\"=c(3,4,1,4,5), \"a.2\"=c(5,7,2,8,9), \"b.2\"=c(6,8,9,0,6))\nsampleList\n$a.1\n[1] 1 2 3 4 5\n\n$b.1\n[1] 3 4 1 4 5\n\n$a.2\n[1] 5 7 2 8 9\n\n$b.2\n[1] 6 8 9 0 6\n</code></pre>\n\n<p>What I am trying to do is get column averages between similarly but not identically named rows, outputting a list with the column averages for the <code>a's</code> and <code>b's</code>. Currently I can do the following:</p>\n\n<pre><code>y &lt;- names(sampleList)\ny &lt;- gsub(\"\\\\.1\", \"\", y)\ny &lt;- gsub(\"\\\\.2\", \"\", y)\ny &lt;- sort(unique(y))\nsampleList &lt;- t(as.matrix(as.data.frame(sampleList)))\nt &lt;- list()\nfor (i in 1:length(y)){\n   temp &lt;- sampleList[grep(y[i], rownames(sampleList)),]\n   t[[i]] &lt;- apply(temp, 2, mean)\n}\n\nt\n[[1]]\n[1] 3.0 4.5 2.5 6.0 7.0\n\n[[2]]\n[1] 4.5 6.0 5.0 2.0 5.5\n</code></pre>\n\n<p>A I have a large dataset with a large number of sets of similar names, is there an easier way to go about this?</p>\n\n<p>EDIT:  I've broken out the name issue into a separate question.  It can be found <a href=\"http://stackoverflow.com/questions/12976569/variable-length-core-name-identification\">here</a></p>\n"},{"tags":["r","pdf","plot"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":108,"score":4,"question_id":12888225,"title":"automatically adjust R plot size in a PDF output","body":"<p>When using the <code>pdf()</code> function in R for saving a plot in an external file, we can specify <code>width</code> and/or <code>height</code> to adjust the size of the plot. However, there are situations when we obtain multiple plot (say using <code>par(mfrow=c(2,4))</code>). In this situation, it's kind of difficult to determine what is the best <code>width</code> and <code>height</code> for the PDF file in order to have all plots displayed properly. Is there a way to let R automatically \"fit the plots\" in the PDF file? I searched the arguments in <code>pdf()</code> and tried some, but the results are not satisfactory. Thank you very much!</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12976012,"title":"How to apply function over components of a list in R","body":"<p>I thought this would be trivial...</p>\n\n<p>Here's the two first components of my list :  </p>\n\n<pre><code>foo &lt;- structure(list(vv = structure(list(`0` = c(\"C RR\", \"G RR\", \"nil\",\n\"C AA\", \"G AA\", \"nil\", \"C RV\", \"G RV\", \"nil\", \"C VB\", \"G VB\",\n\"nil\", \"C RV\", \"C AA\", \"G AA\", \"nil\", \"G AA\", \"nil\", \"C VB\",\n\"G VB\", \"nil\", \"C RJ\"), `1` = c(\"G RJ\", \"nil\", \"G RJ\", \"nil\",\n\"G RJ\", \"C RV\", \"G RV\", \"nil\", \"C AJ\", \"G AJ\", \"nil\", \"C BB\",\n\"G BB\", \"C BB\", \"G BB\", \"nil\", \"C BV\", \"G BV\", \"nil\", \"C JA\",\n\"G JA\", \"nil\", \"C AJ\", \"G AJ\", \"C AJ\", \"G AJ\", \"nil\", \"C RJ\",\n\"G RJ\", \"nil\", \"C RJ\", \"G RJ\", \"nil\"), `2` = c(\"nil\", \"C JA\",\n\"G JA\", \"C JR\", \"G JR\", \"nil\", \"C JR\", \"G JR\", \"nil\", \"C BB\",\n\"G BB\", \"nil\", \"C VV\", \"nil\", \"C AJ\", \"G AJ\", \"nil\", \"C AJ\",\n\"G AJ\", \"nil\", \"C AJ\", \"nil\", \"C BV\", \"G BV\", \"nil\", \"C BV\",\n\"nil\", \"C BV\", \"G BV\", \"nil\"), `3` = c(\"nil\", \"C RJ\", \"G RJ\",\n\"C RJ\", \"G RJ\", \"nil\", \"C JA\", \"G JA\", \"nil\", \"C VR\", \"G VR\",\n\"nil\", \"C BV\", \"G BV\", \"nil\", \"C BV\", \"G BV\", \"nil\", \"C AA\",\n\"G AA\", \"C AA\", \"G AA\", \"nil\", \"C AA\", \"G AA\", \"nil\", \"C AJ\",\n\"G AJ\", \"nil\", \"C AJ\", \"G AJ\", \"nil\", \"C JA\", \"G JA\", \"nil\",\n\"C JA\", \"G JA\", \"nil\", \"C BV\", \"nil\"), `4` = c(\"nil\", \"C VB\",\n\"G VB\", \"nil\", \"C VB\", \"G VB\", \"nil\", \"C BV\", \"G BV\", \"nil\",\n\"C RJ\", \"G RJ\", \"nil\", \"C RJ\", \"G RJ\", \"nil\", \"C RR\", \"G RR\",\n\"nil\", \"C RV\", \"nil\", \"C JA\", \"G JA\", \"nil\", \"C AA\", \"C JA\",\n\"nil\", \"C RV\", \"G RV\", \"nil\", \"C RV\", \"nil\", \"C VV\", \"C BB\",\n\"G BB\", \"nil\", \"C RV\", \"G RV\", \"nil\", \"C VB\", \"nil\", \"C JA\",\n\"G JA\", \"nil\", \"C BB\", \"nil\", \"C RR\", \"nil\", \"C RR\", \"nil\", \"C JA\",\n\"nil\", \"C RR\", \"nil\", \"C RR\", \"nil\", \"C JA\", \"nil\"), `5` = c(\"nil\",\n\"C BB\", \"G BB\", \"nil\", \"C RR\", \"nil\", \"C VB\", \"nil\", \"C AA\",\n\"nil\", \"C VB\", \"nil\", \"C VB\", \"nil\", \"C VB\", \"nil\", \"C VB\", \"nil\",\n\"C VB\", \"nil\", \"C JA\", \"nil\", \"C VB\", \"G VB\", \"nil\", \"C AJ\",\n\"nil\", \"C VB\", \"C BB\", \"nil\", \"C AJ\", \"G AJ\", \"nil\", \"C RR\",\n\"nil\", \"C AJ\", \"nil\", \"C AJ\", \"nil\", \"C JA\", \"G JA\", \"nil\"),\n    `6` = c(\"nil\", \"C BB\", \"nil\", \"C AA\", \"nil\", \"C AA\", \"nil\",\n    \"C AA\", \"nil\", \"C RR\", \"nil\", \"C VB\", \"G VB\", \"C RV\", \"G RV\",\n    \"nil\", \"C VB\", \"G VB\", \"nil\", \"C BB\", \"nil\", \"C BB\", \"nil\",\n    \"C BV\", \"nil\", \"C RV\", \"nil\", \"C BV\", \"nil\", \"C BV\", \"nil\",\n    \"C JA\", \"nil\")), .Names = c(\"0\", \"1\", \"2\", \"3\", \"4\", \"5\",\n\"6\")), rv = structure(list(`0` = c(\"nil\", \"C VB\", \"G VB\", \"nil\",\n\"G VB\", \"nil\", \"C RR\", \"G RR\", \"nil\", \"C RV\", \"C AA\", \"G AA\",\n\"nil\", \"G RR\", \"C RR\", \"G RR\", \"C RR\", \"G RR\"), `1` = c(\"nil\",\n\"C RV\", \"G RV\", \"C RV\", \"G RV\", \"nil\", \"G JR\", \"nil\", \"C AJ\",\n\"G AJ\", \"C AJ\", \"G AJ\", \"C AJ\", \"G AJ\", \"nil\", \"C AJ\", \"nil\",\n\"C JA\", \"G JA\", \"C RV\", \"G RV\", \"C RV\", \"G RV\", \"C RV\", \"G RV\",\n\"nil\"), `2` = c(\"nil\", \"C JR\", \"G JR\", \"nil\", \"C BB\", \"G BB\",\n\"nil\", \"C BV\", \"G BV\", \"nil\", \"C VV\", \"G VV\", \"C VV\", \"G VV\",\n\"nil\"), `3` = c(\"nil\", \"C AA\", \"G AA\", \"C AA\", \"G AA\", \"nil\",\n\"C JA\", \"nil\", \"C BV\", \"G BV\", \"C BV\", \"G BV\", \"nil\", \"C BV\",\n\"G BV\", \"nil\", \"C RJ\", \"G RJ\"), `4` = c(\"nil\", \"C VV\", \"G VV\",\n\"nil\", \"C VR\", \"G VR\", \"nil\", \"C RJ\", \"G RJ\", \"C RJ\", \"G RJ\",\n\"nil\", \"C VB\", \"G VB\", \"nil\", \"C JA\", \"G JA\", \"C JA\", \"G JA\",\n\"nil\", \"C VB\", \"G VB\", \"C VB\", \"G VB\"), `5` = c(\"nil\", \"C RR\",\n\"G RR\", \"nil\", \"C BB\", \"G BB\", \"nil\", \"G BB\", \"nil\", \"C JA\",\n\"G JA\", \"nil\"), `6` = c(\"nil\", \"C BV\", \"G BV\", \"nil\", \"G BV\",\n\"nil\", \"C RJ\", \"nil\", \"C BB\", \"nil\", \"C BB\", \"nil\", \"C AJ\", \"nil\",\n\"C BB\", \"G BB\", \"nil\", \"C RV\", \"nil\")), .Names = c(\"0\", \"1\",\n\"2\", \"3\", \"4\", \"5\", \"6\"))), .Names = c(\"vv\", \"rv\"), class = \"data.frame\", row.names = c(NA,\n-7L))\n</code></pre>\n\n<p>I can mapply to a specific component :  </p>\n\n<pre><code> &gt; mapply(function(x) sum(substr(x,1,1)==\"C\"),foo[[1]])\n 0  1  2  3  4  5  6\n 8 10 11 14 24 19 15\n</code></pre>\n\n<p>or</p>\n\n<pre><code>&gt; mapply(function(x) sum(substr(x,1,1)==\"C\"),foo[[2]])\n 0  1  2  3  4  5  6\n 6 10  5  7  9  3  7\n</code></pre>\n\n<p>Which is the expected output. But how to apply this function to every component of the list ?  I can't seem to find a solution to this. I don't understand why there doesn't seem to be way to mapply over every component at once. Maybe my list could be structured differently ? This list seems strange but the infos in it are right.</p>\n\n<p>Ideally, the expected output would be a matrix, with ne name of the component, something like :  </p>\n\n<pre><code>structure(c(8L, 10L, 11L, 14L, 24L, 19L, 15L, 6L, 10L, 5L, 7L,\n9L, 3L, 7L), .Dim = c(7L, 2L), .Dimnames = list(c(\"0\", \"1\", \"2\",\n\"3\", \"4\", \"5\", \"6\"), c(\"vv\", \"rv\")))\n</code></pre>\n"},{"tags":["r","equivalence"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":103,"score":2,"question_id":12971348,"title":"How do I find equal columns in R?","body":"<p>Given the following:</p>\n\n<pre><code>a &lt;- c(1,2,3)\nb &lt;- c(1,2,3)\nc &lt;- c(4,5,6)\nA &lt;- cbind(a,b,c)\n</code></pre>\n\n<p>I want to find which columns in A are equal to for example my vector a.</p>\n\n<p>My first attempt would be:</p>\n\n<pre><code>&gt; which(a==A)\n[1] 1 2 3 4 5 6\n</code></pre>\n\n<p>Which did not do that. (Too be honest I don't even understand what that did)\nSecond attempt was:</p>\n\n<pre><code>a==A\n        a    b     c\n[1,] TRUE TRUE FALSE\n[2,] TRUE TRUE FALSE\n[3,] TRUE TRUE FALSE\n</code></pre>\n\n<p>which definitely is a step in the right direction but it seems extended into a matrix. What I would have preferred is something like just one of the rows. How do I compare a vector to columns and how do I find columns in a matrix that are equal to a vector?</p>\n"},{"tags":["performance","r"],"answer_count":4,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":110,"score":6,"question_id":12973963,"title":"Using sapply vs. for to efficiently write to preallocated data structures","body":"<p>Assume I have a preallocated data structure that I want to write into for the sake of performance vs. growing the data structure over time. First I tried this using sapply:</p>\n\n<pre><code>set.seed(1)\ncount &lt;- 5\npre &lt;- numeric(count)\n\nsapply(1:count, function(i) {\n  pre[i] &lt;- rnorm(1)\n})\npre\n# [1] 0 0 0 0 0\n\n\nfor(i in 1:count) {\n  pre[i] &lt;- rnorm(1)\n}\npre\n# [1] -0.8204684  0.4874291  0.7383247  0.5757814 -0.3053884\n</code></pre>\n\n<p>I assume this is because the anonymous function in <code>sapply</code> is in a different scope (or is it environment in R?) and as a result the <code>pre</code> object isn't the same. The for loop exists in the same scope/environment and so it works as expected.</p>\n\n<p>I've generally tried to adopt the R mechanisms for iteration with apply functions vs. for, but I don't see a way around it here. Is there something different I should be doing or a better idiom for this type of operation?</p>\n\n<p>As noted, my example is highly contrived, I have no interested in generaring normal deviates. Instead my actual code is dealing with a 4 column 1.5 million row dataframe. Previously I was relying on growing and merging to get a final dataframe and decided to try to avoid merges and preallocate based on benchmarking.</p>\n"},{"tags":["r","rgl"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":82,"score":3,"question_id":12967082,"title":"rgl plot: point size does not change when saving as postscript","body":"<p>I'm trying to generate a 3d scatterplot using rgl. It looks great on my screen, but whenever I export it as a PDF (or any other postscript format) it completely ignores any size specifications I use. </p>\n\n<p>(I'm running RGui v.2.15.1 and rgl v.0.92.892 on a Macbook under Mountain Lion.)</p>\n\n<p>For example:</p>\n\n<pre><code>library(rgl) \nset.seed(1982) \npoints3d(runif(5),runif(5),runif(5), size=20)\n# points look huge\nrgl.postscript('testplot.pdf', fmt='pdf')\n# points look tiny\n</code></pre>\n\n<p>Does anyone have an idea for a way to get this to work? The resolution of the images I get using <code>rgl.snapshot</code> don't look so good, and I would really like to get a vector image for this plot. </p>\n\n<p>Also, I followed <a href=\"http://stackoverflow.com/questions/9214298/cannot-change-text-size-in-rgl-plot\">this thread</a> and I got text to resize just fine, but not points. So I thought one way to work around this would be to plot my points as text using a circle as my character, but I couldn't get rgl to accept symbols or expressions either...</p>\n"},{"tags":["r","data-analysis"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":64,"score":-1,"question_id":12975550,"title":"trouble making a decision on where to invest my time with big data analyses in R","body":"<p>I know R, I know SQL, I use Windows, I have a budget of $0, I have a terabyte of data, I have twelve processors, I have 96GB of RAM, I am motivated to learn new software if the speed gains will pay off in the long term.</p>\n\n<p>I need to run descriptive statistics and regressions.</p>\n\n<p>I have too many options.  Where should I devote all of my energy? Thanks.</p>\n"},{"tags":["r","for-loop","iteration"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":99,"score":2,"question_id":12972890,"title":"R prevent \"for\" loop from reverse iteration","body":"<p>Consider the code below:</p>\n\n<pre><code>foo = list(\"First List\", 1, 2, 3)\nbar = function(x) {\n    cat(\"The list name is:\", x[[1]], \"\\nThe items are:\\n\")\n    for (i in 2:length(x))\n        cat(x[[i]], \"\\n\")\n}\nbar(foo)\n</code></pre>\n\n<p>The result will be:</p>\n\n<pre><code>The list name is: First List \nThe items are:\n1 \n2 \n3 \n</code></pre>\n\n<p>Now consider passing a list with no items, but a name:</p>\n\n<pre><code>baz = list(\"Second List\")\nbar(baz)\n</code></pre>\n\n<p>The result would be:</p>\n\n<pre><code>The list name is: Second List \nThe items are:\nError in x[[i]] : subscript out of bounds\n</code></pre>\n\n<p>The error is because <code>2:length(x)</code> will produce a sequence of <code>c(2, 1)</code> for the latter case <code>bar(baz)</code>, so it tries to access <code>baz[2]</code> and it does not exist.</p>\n\n<p>How to simply prevent this unwanted reverse iteration in a <code>for</code> loop in R?</p>\n"},{"tags":["r","graphics","ggplot2","gis"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":517,"score":3,"question_id":11508902,"title":"Plotting discrete and continuous scales in same ggplot","body":"<p>I would like to plot some different data items using ggplot2, using two different colour scales (one continuous and one discrete from two different df's). I can plot either exactly how I would like individually, but I cannot make them work together. It seems like you cannot have two different colour scales operating in the same plot? I have seen similar questions <a href=\"http://stackoverflow.com/questions/9232331/ggplot2-multiple-color-scales-or-shift-colors-systematically-on-different-layer\">here</a> and <a href=\"http://stackoverflow.com/questions/9916194/two-color-scales-for-geom-line-in-ggplot2\">here</a>, and this had led me to believe that what I would like to achieve is simply not possible in ggplot2, but just in case I am wrong I would like to illustrate my problem to see if there is a work-around.</p>\n\n<p>I have some GIS stream data which has some categorical attributes attached to it, which I can plot (<code>p1</code> in code below) to get:\n<img src=\"http://i.stack.imgur.com/MoP8h.jpg\" alt=\"enter image description here\"></p>\n\n<p>I also have a set of locations which have a continuous response, which I can also plot (<code>p2</code> in code below) to get:\n<img src=\"http://i.stack.imgur.com/6ZREr.jpg\" alt=\"enter image description here\">\nHowever I can't combine the two (<code>p3</code> in code below). I get this error</p>\n\n<blockquote>\n  <p>Error in scales[[prev_aes]] : attempt to select less than one element</p>\n</blockquote>\n\n<p>Commenting out the line <code>scale_colour_hue(\"Strahler order\") +</code> changes the error to</p>\n\n<blockquote>\n  <p>Error: Discrete value supplied to continuous scale</p>\n</blockquote>\n\n<p>Basically it seems that ggplot2 uses the same scale type (continuous or discrete) for the <code>geom_path</code> call and the <code>geom_point</code> calls. So when I pass the discrete variable,  <code>factor(Strahler)</code>, to the <code>scale_colour_gradientn</code> scale, the plot fails. </p>\n\n<p>Is there a way around this? It would be amazing if there was a <code>data</code> argument to a scales function to tell it where it should be mapping or setting attributes from. Is this even possible?</p>\n\n<p>Many thanks and reproducible code below:</p>\n\n<pre><code>library(ggplot2)\n\n### Download df's   ###\noldwd &lt;- getwd(); tmp &lt;- tempdir(); setwd(tmp)\nurl &lt;- \"http://dl.dropbox.com/u/44829974/Data.zip\"\nf &lt;- paste(tmp,\"\\\\tmp.zip\",sep=\"\")\ndownload.file(url,f)\nunzip(f)\n\n\n### Read in data    ###\nriv_df &lt;- read.table(\"riv_df.csv\", sep=\",\",h=T)\nafr_df &lt;- read.table(\"afr_df.csv\", sep=\",\",h=T)\nvil_df &lt;- read.table(\"vil_df.csv\", sep=\",\",h=T)\n\n\n### Min and max for plot area   ###\nxmin &lt;- -18; xmax &lt;- 3; ymin &lt;- 4; ymax &lt;- 15\n\n\n### Plot river data ###\np1 &lt;-   ggplot(riv_df, aes(long, lat)) + \n    geom_map( mapping = aes( long , lat , map_id = id ) , fill = \"white\" , data = afr_df , map = afr_df ) +\n    geom_path( colour = \"grey95\" , mapping = aes( long , lat , group = group , size = 1 ) , data = afr_df ) +\n    geom_path( aes( group = id , alpha = I(Strahler/6) , colour = factor(Strahler) , size = Strahler/6 ) ) +\n    scale_alpha( guide = \"none\" ) +\n    scale_colour_hue(\"Strahler order\") +\n    scale_x_continuous( limits = c( xmin , xmax ) , expand = c( 0 , 0 ) ) +\n    scale_y_continuous( limits = c( ymin , ymax ) , expand = c( 0 , 0 ) ) +\n    coord_map()\nprint(p1) # This may take a little while depending on computer speed...\n\n\n\n### Plot response data  ###\np2 &lt;- ggplot( NULL ) +\n    geom_point( aes( X , Y , colour = Z) , size = 2 , shape = 19 , data = vil_df ) +\n    scale_colour_gradientn( colours = rev(heat.colors(25)) , guide=\"colourbar\" ) +\n    coord_equal()\nprint(p2)\n\n\n\n### Plot both together  ###\np3 &lt;-   ggplot(riv_df, aes(long, lat)) + \n    geom_map( mapping = aes( long , lat , map_id = id ) , fill = \"white\" , data = afr_df , map = afr_df ) +\n    geom_path( colour = \"grey95\" , mapping = aes( long , lat , group = group , size = 1 ) , data = afr_df ) +\n    geom_path( aes( group = id , alpha = I(Strahler/6) , colour = factor(Strahler) , size = Strahler/6 ) ) +\n    scale_colour_hue(\"Strahler order\") +\n    scale_alpha( guide = \"none\" ) +\n    scale_x_continuous( limits = c( xmin , xmax ) , expand = c( 0 , 0 ) ) +\n    scale_y_continuous( limits = c( ymin , ymax ) , expand = c( 0 , 0 ) ) +\n    geom_point( aes( X , Y , colour = Z) , size = 2 , shape = 19 , data = vil_df ) +\n    scale_colour_gradientn( colours = rev(heat.colors(25)) , guide=\"colourbar\" ) +\n    coord_map()\nprint(p3)\n#Error in scales[[prev_aes]] : attempt to select less than one element\n\n### Clear-up downloaded files   ###\nunlink(tmp,recursive=T)\nsetwd(oldwd)\n</code></pre>\n\n<p>Cheers,</p>\n\n<p>Simon</p>\n"},{"tags":["r","logical-operators"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":60,"score":0,"question_id":12967215,"title":"r logical condition for \"any of\" opperation","body":"<p>This is probably a very basic R question...and feel a bit bad about asking...but is there a bit of code like <code>==</code> or <code>|</code> or <code>!</code> or <code>&amp;</code> etc that carries out the following logical function?</p>\n\n<p>if</p>\n\n<p><code>x</code> == any of the value of the elements/contained in vector <code>y</code></p>\n\n<p>then TRUE</p>\n\n<p>else</p>\n\n<p>FLASE</p>\n"},{"tags":["r","panel","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":96,"score":2,"question_id":12972039,"title":"Plotting xyplot with regression line on lattice graphics","body":"<p>I have loaded the lattice package. \nThen I run:</p>\n\n<pre><code>&gt; xyplot(yyy ~ xxx | zzz, panel = function(x,y) { panel.lmline(x,y)}\n</code></pre>\n\n<p>This produces panels of plot, showing the regression line, without the xyplots. \nI am doing the panel.lmline without fully understanding how it is done. I know there is a data argument, what is the data, knowing that I have the 3 variables <code>xxx</code>, <code>yyy</code>, <code>zzz</code>?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12973151,"title":"How to subset a table object in R?","body":"<p>How can I subset a table based on values and return those values? This returns just indices:</p>\n\n<pre><code>with(chickwts, table(feed))\nwith(chickwts, table(feed)) &gt; 11\nwhich(with(chickwts, table(feed)) &gt; 11)\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>&gt; with(chickwts, table(feed))\nfeed\n   casein horsebean   linseed  meatmeal   soybean sunflower \n       12        10        12        11        14        12 \n&gt; with(chickwts, table(feed)) &gt; 11\nfeed\n   casein horsebean   linseed  meatmeal   soybean sunflower \n     TRUE     FALSE      TRUE     FALSE      TRUE      TRUE \n&gt; which(with(chickwts, table(feed)) &gt; 11)\n   casein   linseed   soybean sunflower \n        1         3         5         6 \n</code></pre>\n"},{"tags":["r","statistics"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":12972443,"title":"Adaptive regression splines in earth package R","body":"<p>I am using earth package for the following data.</p>\n\n<pre><code>x &lt;- c(127, 128, 255, 256, 511, 512, 600, 700, 800, 900, 1000, 1023, 1100,\n       1200, 1300, 1400, 1500, 1600, 2047, 2048, 2100, 2200, 2300, 2400, 2500,\n       2600, 2700, 2800, 3000, 3100, 3200, 3300, 3500, 4063, 4064, 4100, 4200,\n       5200, 5400)\n\ny &lt;- c(0.59, 0.61, 0.59, 1.55, 1.33, 3.50, 1.00, 1.22, 2.50, 3.00, 3.79,\n       3.98, 4.33, 4.45, 4.59, 4.72, 4.82, 4.90, 4.96, 7.92, 5.01, 5.01,\n       4.94, 5.05, 5.04, 5.03, 5.06, 5.10, 5.04, 5.06, 7.77, 5.07, 5.08,\n       5.08, 5.12, 5.12, 5.08, 5.17, 5.18) \n</code></pre>\n\n<p>After building the model, </p>\n\n<pre><code>model&lt;-earth(y~x)\n</code></pre>\n\n<p>I get following regression model. </p>\n\n<pre><code>summary(model)\nCall: earth(x=x, y=y)\ncoefficients\n(Intercept)  5.225822553\nh(1400-x)   -0.003820087\n</code></pre>\n\n<p>Is there any possibility that I can increase somehow the number of knots or regression splines?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":574,"score":2,"question_id":7767184,"title":"Spearman correlation loop in R","body":"<p>A previous post explained how to do a Chi-squared loop in R on all your data-pairs: <a href=\"http://stackoverflow.com/questions/7382039/chi-square-analysis-using-for-loop-in-r\">Chi Square Analysis using for loop in R</a>. \nI wanted to use this code to do the same thing for a Spearman correlation.</p>\n\n<p>I've already tried altering a few of the variables and I was able to calculate the pearson correlation variables using this code:</p>\n\n<pre><code>library(plyr)\n\ncombos &lt;- combn(ncol(fullngodata),2)\n\nadply(combos, 2, function(x) {\n  test &lt;- cor.test(fullngodata[, x[1]], fullngodata[, x[2]])\n\n  out &lt;- data.frame(\"Row\" = colnames(fullngodata)[x[1]]\n                , \"Column\" = colnames(fullngodata[x[2]])\n                , \"cor\" = round(test$statistic,3)\n                ,  \"df\"= test$parameter\n                ,  \"p.value\" = round(test$p.value, 3)\n                )\n return(out)\n\n})  \n</code></pre>\n\n<p>But since I work with data on an ordinal scale, I need to use the Spearman correlation.</p>\n\n<p>I thought I could get this data by just adding the method=\"spearman\" command but this does not seem to work. If I use the code:</p>\n\n<pre><code>library(plyr)\n\ncombos &lt;- combn(ncol(fullngodata),2)\n\nadply(combos, 2, function(x) {\n  test &lt;- cor.test(fullngodata[, x[1]], fullngodata[, x[2]], method=\"spearman\")\n\n  out &lt;- data.frame(\"Row\" = colnames(fullngodata)[x[1]]\n                , \"Column\" = colnames(fullngodata[x[2]])\n                , \"Chi.Square\" = round(test$statistic,3)\n                ,  \"df\"= test$parameter\n                ,  \"p.value\" = round(test$p.value, 3)\n                )\n  return(out)\n\n})  \n</code></pre>\n\n<p>I get the response:</p>\n\n<pre><code>Error in data.frame(Row = colnames(fullngodata)[x[1]], Column =    \ncolnames(fullngodata[x[2]]),  : \narguments imply differing number of rows: 1, 0\nIn addition: Warning message:\nIn cor.test.default(fullngodata[, x[1]], fullngodata[, x[2]], method = \"spearman\") :\nCannot compute exact p-values with ties\n</code></pre>\n\n<p>what am I doing wrong?</p>\n"},{"tags":["r","github","httr"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":12375603,"title":"R Package devtools Install Error for HTTR Package","body":"<p>I got the following error when trying to install Hadley's HTTR package from Github in R.</p>\n\n<pre><code>&gt; library(devtools)\n&gt; install_github(\"httr\")\nInstalling github repo(s) httr/master from hadley\nInstalling httr.zip from https://github.com/hadley/httr/zipball\nInstalling httr\n* checking for file 'C:\\Users\\btibert\\AppData\\Local\\Temp\\RtmpSGjjYA\\hadley-httr-ee0eafb/DESCRIPTION' ... OK\n* preparing 'httr':\n* checking DESCRIPTION meta-information ... OK\n* checking for LF line-endings in source and make files\n* checking for empty or unneeded directories\n* looking to see if a 'data/datalist' file should be added\nError in if (any(update)) { : missing value where TRUE/FALSE needed\nExecution halted\nError: Command failed (1)\nIn addition: Warning message:\nrunning command '\"C:/PROGRA~1/R/R-215~1.0/bin/i386/R\" CMD build \"C:\\Users\\btibert\\AppData\\Local\\Temp\\RtmpSGjjYA\\hadley-httr-ee0eafb\" --no-manual --no-vignettes' had status 1 \n</code></pre>\n\n<p>Not sure what the issue is on my end.  Here is my version info on Windows 7:</p>\n\n<pre><code>$platform\n[1] \"i386-pc-mingw32\"\n\n$arch\n[1] \"i386\"\n\n$os\n[1] \"mingw32\"\n\n$system\n[1] \"i386, mingw32\"\n\n$status\n[1] \"\"\n\n$major\n[1] \"2\"\n\n$minor\n[1] \"15.0\"\n\n$year\n[1] \"2012\"\n\n$month\n[1] \"03\"\n\n$day\n[1] \"30\"\n\n$`svn rev`\n[1] \"58871\"\n\n$language\n[1] \"R\"\n\n$version.string\n[1] \"R version 2.15.0 (2012-03-30)\"\n\n$nickname\n[1] \"\"\n</code></pre>\n\n<p>UPDATE:  It was suggested that try to install the dev version of devtools.  I got this error:</p>\n\n<pre><code>&gt; library(devtools)\n&gt; install_github(\"devtools\")\nInstalling github repo(s) devtools/master from hadley\nInstalling devtools.zip from https://github.com/hadley/devtools/zipball\nInstalling devtools\n* checking for file 'C:\\Users\\btibert\\AppData\\Local\\Temp\\RtmpsbYABm\\hadley-devtools-77011a6/DESCRIPTION' ... OK\n* preparing 'devtools':\n* checking DESCRIPTION meta-information ... OK\n* checking for LF line-endings in source and make files\n* checking for empty or unneeded directories\n* building 'devtools_0.8.tar.gz'\ncygwin warning:\n  MS-DOS style path detected: C:/Users/btibert/AppData/Local/Temp/RtmpsbYABm/devtools_0.8.tar.gz\n  Preferred POSIX equivalent is: /cygdrive/c/Users/btibert/AppData/Local/Temp/RtmpsbYABm/devtools_0.8.tar.gz\n  CYGWIN environment variable option \"nodosfilewarning\" turns off this warning.\n  Consult the user's guide for more details about POSIX paths:\n    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames\n\nWarning: invalid package 'Files/R/R-2.15.0/library'\nError: ERROR: cannot cd to directory 'C:/Program'\nError: Command failed (1)\nIn addition: Warning message:\nrunning command '\"C:/PROGRA~1/R/R-215~1.0/bin/i386/R\" CMD INSTALL C:\\Users\\btibert\\AppData\\Local\\Temp\\RtmpsbYABm/devtools_0.8.tar.gz --library=C:/Program Files/R/R-2.15.0/library' had status 1 \n</code></pre>\n"},{"tags":["r","oauth","fitbit","httr"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":82,"score":1,"question_id":12212958,"title":"Oauth authentification to Fitbit using httr","body":"<p>I'm trying to connect to the fitbit api using the <a href=\"https://github.com/hadley/httr/\" rel=\"nofollow\">httr library</a>.</p>\n\n<p>Using the examples provided, I came up with the following code:</p>\n\n<pre><code>library(httr)\n\nkey &lt;- '&lt;edited&gt;'\nsecret &lt;- '&lt;edited&gt;'\ntokenURL &lt;- 'http://api.fitbit.com/oauth/request_token'\naccessTokenURL &lt;- 'http://api.fitbit.com/oauth/access_token'\nauthorizeURL &lt;- 'https://www.fitbit.com/oauth/authorize'\n\nfbr &lt;- oauth_app('fitbitR',key,secret)\nfitbit &lt;- oauth_endpoint(tokenURL,authorizeURL,accessTokenURL)\n\ntoken &lt;- oauth1.0_token(fitbit,fbr)\nsig &lt;- sign_oauth1.0(fbr,\n    token=token$oauth_token,\n    token_secret=token$oauth_token_secret\n)\n</code></pre>\n\n<p>I get the <em>Authentication complete.</em> message from httr, but trying to access the api then throws an error message</p>\n\n<pre><code>GET(\"http://api.fitbit.com/1/user/-/activities/date/2012-08-29.json\", sig)\nResponse [http://api.fitbit.com/1/user/-/activities/date/2012-08-29.json]\n  Status: 401\n  Content-type: application/x-www-form-urlencoded;charset=UTF-8\n{\"errors\":[{\"errorType\":\"oauth\",\"fieldName\":\"oauth_access_token\",\"message\":\"Invalid signature or token '&lt;edited&gt;' or token '&lt;edited&gt;'\"}]} \n</code></pre>\n\n<p>Any clue about what the problem might be?</p>\n"},{"tags":["r","makefile"],"answer_count":2,"favorite_count":0,"up_vote_count":10,"down_vote_count":0,"view_count":111,"score":10,"question_id":12967955,"title":"Makefile with multiple inputs and outputs","body":"<p>I'm wanting to use a makefile to update figure files generated by R code. The R code is in various files in the directory <code>../R</code> and all ending in <code>.R</code>. The figure files are in the directory <code>../figs</code> and all ending in <code>.pdf</code> or <code>.png</code>. If an R file has a later date than any of the figure files, I want to process the R file with the command</p>\n\n<pre><code>R --no-save &lt; file.R\n</code></pre>\n\n<p>I've looked a various example makefiles but couldn't find anything I could adapt.</p>\n\n<p>My current effort (not working) is as follows:</p>\n\n<pre><code>PLOTDIR= ../figs\nRDIR= ../R\nRFILES= $(RDIR)/*.R\nPLOTS= *.pdf *.png\nFIGURES= $(PLOTDIR)/$(PLOTS)\n$(FIGURES): $(RFILES)\n    R --no-save &lt; $&lt;\n</code></pre>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":74,"score":2,"question_id":12969398,"title":"Post Hoc tests for ANOVA","body":"<p>I was trying to figure out how to do  post-hoc tests for Two Way ANOVAs and found the following 2 approaches:</p>\n\n<ol>\n<li>Do pairwise t-tests (bonferroni corrected) if one finds significance with the ANOVA.\nLink- <a href=\"http://rtutorialseries.blogspot.com/2011/01/r-tutorial-series-two-way-anova-with.html\" rel=\"nofollow\">http://rtutorialseries.blogspot.com/2011/01/r-tutorial-series-two-way-anova-with.html</a></li>\n<li>Do TukeyHSD  on an aov model\nLink- <a href=\"http://www.r-bloggers.com/post-hoc-pairwise-comparisons-of-two-way-anova/\" rel=\"nofollow\">http://www.r-bloggers.com/post-hoc-pairwise-comparisons-of-two-way-anova/</a></li>\n</ol>\n\n<p>Running the data set given in the first example in SPSS gives significant pairwise difference for Treatment and Age (Treatmen and Age were the independent variables) , while using the directions given in the first link didn't give me significant pairwise different for Treatment (only gave for Age).</p>\n\n<p>I have a few questions:</p>\n\n<ol>\n<li>Is the first method completely incorrect as hinted in the second link?</li>\n<li>What is the right way to do Bonferroni corrected post hoc tests for Two Way ANOVA in R?</li>\n<li>Does anyone know how post hoc tests for SPSS work in the case of Two Way ANOVAs (Univariate analysis)? Especially for Bonferroni corrected tests.</li>\n</ol>\n\n<p>I am new to R, so please let me know if I made a mistake in framing the question; I will try to elucidate as much as I personally can. Thanks for your help. </p>\n"},{"tags":["r","normalization","max","min"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":12969623,"title":"Normalisation of a two column data using min and max values","body":"<p>I am trying to find an R code for normalisation of my values using min and max value for a two column matrix. </p>\n\n<p>My matrix looks like this: Column one (C1) and C2 I.D not to be calculated,\nC3; Heading row 1 then 407 numbers and NA´s, C4;heading row 1 then numbers and NA´s. </p>\n\n<p>I was thinking of something like:</p>\n\n<p>Min value for C3 = x, Max value for same column x,</p>\n\n<pre><code>If(x=\"\",\"NA\",(x-Min value)/(Max value-Min value))\n</code></pre>\n\n<p>This would give a column with values from 0 to 1. \nThe same should be done for column 4 (would that be y or is this confusing for R?)</p>\n\n<p>I am not skilled enough in programming or in R to generate this code, is there a specific code for this or can anyone help me write one?</p>\n"},{"tags":["r","data.table","sequences"],"answer_count":1,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":90,"score":7,"question_id":12969819,"title":"number rows by variable, but start over when condition is hit","body":"<p>I want to number certain combinations of row in a dataframe (which is ordered on ID and on Time)</p>\n\n<pre><code>tc &lt;- textConnection('\nid              time       end_yn\nabc             10         0\nabc             11         0\nabc             12         1\nabc             13         0\ndef             10         0\ndef             15         1\ndef             16         0\ndef             17         0\ndef             18         1\n')\n\ntest &lt;- read.table(tc, header=TRUE)\n</code></pre>\n\n<p>The goal is to create a new column (\"<code>number</code>\") that numbers each row per <code>id</code> from <code>1 to n</code> until <code>end_yn == 1</code> is hit. After <code>end_yn == 1</code>, the numbering should start over. </p>\n\n<p>Without taking the <code>end_yn == 1</code> condition into account the rows can be numbered using:</p>\n\n<pre><code>DT &lt;- data.table(test)\nDT[, id := seq_len(.N), by = id]\n</code></pre>\n\n<p>However the expected outcome should be:</p>\n\n<pre><code>id              time       end_yn   number\nabc             10         0        1\nabc             11         0        2\nabc             12         1        3 \nabc             13         0        1 \ndef             10         0        1\ndef             15         1        2\ndef             16         0        1\ndef             17         0        2\ndef             18         1        3\n</code></pre>\n\n<p>How to incorporate the <code>end_yn == 1</code> condition?</p>\n"},{"tags":["r","linear-regression","posixct"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12683052,"title":"cor(x,y) when x is POSIXct","body":"<p>I am calculating a linear regression between an age (numeric) vector and a date (POSIXct) vector. What is the most convenient way to transform the date so that <em>cor</em> is happy with it?</p>\n"},{"tags":["r","aggregate","reshape"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1220,"score":0,"question_id":5251249,"title":"How to transform Columns to rows in R?","body":"<p>I kind of have the same problem. I have data in this kind of order: ;=column</p>\n\n<pre><code>D1 ;hurs\n\n1  ;0.12\n\n1  ;0.23\n\n1  ;0.34\n\n1  ;0.01\n\n2  ;0.24\n\n2  ;0.67\n\n2  ;0.78\n\n2  ;0.98\n</code></pre>\n\n<p>and I like to have it like this:</p>\n\n<pre><code>D1; X; X; X; X    \n1;0.12; 0.23; 0.34; 0.01; \n2;0.24; 0.67; 0.78; 0.98;\n</code></pre>\n\n<p>I would like to sort it with respect to D1 and like to reshape it? Does anyone have an idea? I need to do this for 7603 values of D1.</p>\n"},{"tags":["r","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12967798,"title":"How to change Lattice graphics default groups colors?","body":"<p>When using <code>groups</code>, Lattice gives each group a different color.  Example:</p>\n\n<pre><code>df &lt;- data.frame(x=1:56, y=rnorm(56), class=1:14) # create some data\nxyplot(y ~ x, groups=class, data=df, type=\"l\", auto.key=list(space=\"right\"))\n</code></pre>\n\n<p>However, by default Lattice only uses seven colors, as running the example above will show.  If you have more than seven groups, Lattice cycles through the colors again in order, causing data from distinct groups to have the same color.  I learned from another Stackoverflow article that these colors are stored in <code>trellis.par.get()$superpose.symbol$col</code>.  I want to make the list of groups colors longer (without having to specify colors explicitly in plotting calls).  I can't figure out how to change this list of colors, however.  (This might be due to ignorance about some basic facts about Lattice syntax or semantics.)  This illustrates the problem:</p>\n\n<pre><code>&gt; trellis.par.get()$superpose.symbol$col\n[1] \"#0080ff\"   \"#ff00ff\"   \"darkgreen\" \"#ff0000\"   \"orange\"    \"#00ff00\"   \"brown\"    \n&gt; class(trellis.par.get()$superpose.symbol$col)\n[1] \"character\"\n&gt; mycolors &lt;- c(trellis.par.get()$superpose.symbol$col, \"navyblue\", \"purple\", \"gold\")\n&gt; trellis.par.get()$superpose.symbol$col[1:10] &lt;- mycolors\nError in trellis.par.get()$superpose.symbol$col[1:10] &lt;- mycolors : \n  invalid (NULL) left side of assignment\n</code></pre>\n\n<p>I don't understand what that error message is telling me. </p>\n"},{"tags":["r","profiling","knitr","evaluate"],"answer_count":1,"favorite_count":2,"up_vote_count":10,"down_vote_count":1,"view_count":102,"score":9,"question_id":12310161,"title":"How do I profile code when using knitr?","body":"<p>I am trying to institute a  workflow to answer SO questions using <code>knitr</code> and\n<code>render_markdown(strict = T )</code> to format my answers and / questions. </p>\n\n<p>Recently I was trying to run profiling on some code using <code>profr</code> and due to the implementation of <code>knitr</code>, the profiling picks up all the calls to <code>evaluate</code> etc that underpin <code>knitr</code></p>\n\n<p>For example</p>\n\n<h1>Not in knitr</h1>\n\n<p>If I run in plain <code>R</code></p>\n\n<pre><code>library(profr)\nquantile_ex &lt;- profr({Sys.sleep(1); example(quantile, setRNG = TRUE)}, 0.01)\nquantile_ex\n##                      f level time start  end  leaf source\n## 9       Sys.sleep     1 0.64  0.01 0.65  TRUE   base\n## 10        example     1 0.05  0.65 0.70 FALSE  utils\n## 11   index.search     2 0.01  0.65 0.66 FALSE   &lt;NA&gt;\n## 12    &lt;Anonymous&gt;     2 0.02  0.66 0.68 FALSE   &lt;NA&gt;\n## 13         source     2 0.01  0.68 0.69 FALSE   base\n## 14         unlink     2 0.01  0.69 0.70  TRUE   base\n## 15    file.exists     3 0.01  0.65 0.66  TRUE   base\n## 16     prepare_Rd     3 0.01  0.66 0.67 FALSE   &lt;NA&gt;\n## 17            of0     3 0.01  0.67 0.68 FALSE   &lt;NA&gt;\n## 18           file     3 0.01  0.68 0.69  TRUE   base\n## 19   .getHelpFile     4 0.01  0.66 0.67 FALSE   &lt;NA&gt;\n## 20            of1     4 0.01  0.67 0.68 FALSE   &lt;NA&gt;\n## 21    &lt;Anonymous&gt;     5 0.01  0.66 0.67 FALSE   &lt;NA&gt;\n## 22     WriteLines     5 0.01  0.67 0.68 FALSE   &lt;NA&gt;\n## 23 lazyLoadDBexec     6 0.01  0.66 0.67 FALSE   base\n## 24     writeLines     6 0.01  0.67 0.68 FALSE   base\n## 25            fun     7 0.01  0.66 0.67 FALSE   &lt;NA&gt;\n## 26         paste0     7 0.01  0.67 0.68 FALSE   base\n## 27       basename     8 0.01  0.66 0.67  TRUE   base\n## 28             wr     8 0.01  0.67 0.68 FALSE   &lt;NA&gt;\n## 29         paste0     9 0.01  0.67 0.68 FALSE   base\n## 30        strwrap    10 0.01  0.67 0.68 FALSE   base\n## 31         lapply    11 0.01  0.67 0.68 FALSE   base\n## 32       strsplit    12 0.01  0.67 0.68  TRUE   base\n</code></pre>\n\n<h1>Using knitr + profr</h1>\n\n<pre><code>render_markdown(strict = T)\nlibrary(profr)\nquantile_ex &lt;- profr({\n    Sys.sleep(1)\n    example(quantile, setRNG = TRUE)\n}, 0.01)\nquantile_ex\n\n##                      f level time start  end  leaf source\n## 8          &lt;Anonymous&gt;     1 0.80  0.00 0.80 FALSE   &lt;NA&gt;\n## 9  process_group.block     2 0.80  0.00 0.80 FALSE   &lt;NA&gt;\n## 10          call_block     3 0.80  0.00 0.80 FALSE   &lt;NA&gt;\n## 11          block_exec     4 0.80  0.00 0.80 FALSE   &lt;NA&gt;\n## 12            evaluate     5 0.80  0.00 0.80 FALSE   &lt;NA&gt;\n## 13              unlist     6 0.80  0.00 0.80 FALSE   base\n## 14              mapply     7 0.80  0.00 0.80 FALSE   base\n## 15         &lt;Anonymous&gt;     8 0.80  0.00 0.80 FALSE   &lt;NA&gt;\n## 16                 try     9 0.80  0.00 0.80 FALSE   base\n## 17            tryCatch    10 0.80  0.00 0.80 FALSE   base\n## 18        tryCatchList    11 0.80  0.00 0.80 FALSE   &lt;NA&gt;\n## 19         tryCatchOne    12 0.80  0.00 0.80 FALSE   &lt;NA&gt;\n## 20          doTryCatch    13 0.80  0.00 0.80 FALSE   &lt;NA&gt;\n## 21 withCallingHandlers    14 0.80  0.00 0.80 FALSE   base\n## 22         withVisible    15 0.80  0.00 0.80 FALSE   base\n## 23                eval    16 0.80  0.00 0.80 FALSE   base\n## 24                eval    17 0.80  0.00 0.80 FALSE   base\n## 25               profr    18 0.80  0.00 0.80 FALSE  profr\n## 26                 try    19 0.80  0.00 0.80 FALSE   base\n## 27            tryCatch    20 0.80  0.00 0.80 FALSE   base\n## 28        tryCatchList    21 0.80  0.00 0.80 FALSE   &lt;NA&gt;\n## 29         tryCatchOne    22 0.80  0.00 0.80 FALSE   &lt;NA&gt;\n## 30          doTryCatch    23 0.80  0.00 0.80 FALSE   &lt;NA&gt;\n## 31               force    24 0.80  0.00 0.80 FALSE   base\n## 32           Sys.sleep    25 0.77  0.00 0.77  TRUE   base\n## 33             example    25 0.03  0.77 0.80 FALSE  utils\n## 34         &lt;Anonymous&gt;    26 0.02  0.77 0.79 FALSE   &lt;NA&gt;\n## 35              source    26 0.01  0.79 0.80 FALSE   base\n## 36          prepare_Rd    27 0.01  0.77 0.78 FALSE   &lt;NA&gt;\n## 37              render    27 0.01  0.78 0.79 FALSE   &lt;NA&gt;\n## 38         withVisible    27 0.01  0.79 0.80 FALSE   base\n## 39        .getHelpFile    28 0.01  0.77 0.78 FALSE   &lt;NA&gt;\n## 40                 of0    28 0.01  0.78 0.79 FALSE   &lt;NA&gt;\n## 41                eval    28 0.01  0.79 0.80 FALSE   base\n## 42         &lt;Anonymous&gt;    29 0.01  0.77 0.78 FALSE   &lt;NA&gt;\n## 43                 of1    29 0.01  0.78 0.79 FALSE   &lt;NA&gt;\n## 44                eval    29 0.01  0.79 0.80 FALSE   base\n## 45      lazyLoadDBexec    30 0.01  0.77 0.78 FALSE   base\n## 46          WriteLines    30 0.01  0.78 0.79 FALSE   &lt;NA&gt;\n## 47            quantile    30 0.01  0.79 0.80 FALSE  stats\n## 48                 fun    31 0.01  0.77 0.78 FALSE   &lt;NA&gt;\n## 49          writeLines    31 0.01  0.78 0.79  TRUE   base\n## 50    quantile.default    31 0.01  0.79 0.80 FALSE  stats\n## 51               fetch    32 0.01  0.77 0.78 FALSE   &lt;NA&gt;\n## 52               paste    32 0.01  0.79 0.80  TRUE   base\n## 53         &lt;Anonymous&gt;    33 0.01  0.77 0.78 FALSE   &lt;NA&gt;\n## 54       existsInFrame    34 0.01  0.77 0.78  TRUE   &lt;NA&gt;\n</code></pre>\n\n<h1>using knitr + Rprof + profr::parse_rprof</h1>\n\n<pre><code>tmp &lt;- tempfile()\nRprof(tmp, interval = 0.01)\ntry(force(quantile_ex &lt;- profr({\n    Sys.sleep(1)\n    example(quantile, setRNG = TRUE)\n}, 0.01)))\nRprof(NULL)\nparsed &lt;- parse_rprof(tmp, interval = 0.01)\n\n## Error: invalid 'envir' argument\n</code></pre>\n\n<p><code>parse_rprof</code> won't run due to environment issues</p>\n\n<h1>knitr + Rprof + summaryRprof</h1>\n\n<p>Using the <code>utils::summaryRprof</code>  will read and summarize</p>\n\n<pre><code>summaryRprof(tmp)\n\n## $by.self\n##       self.time self.pct total.time total.pct\n## Rprof      0.01      100       0.01       100\n## \n## $by.total\n##                     total.time total.pct self.time self.pct\n## Rprof                     0.01       100      0.01      100\n## &lt;Anonymous&gt;               0.01       100      0.00        0\n## block_exec                0.01       100      0.00        0\n## call_block                0.01       100      0.00        0\n## doTryCatch                0.01       100      0.00        0\n## eval                      0.01       100      0.00        0\n## evaluate                  0.01       100      0.00        0\n## knit                      0.01       100      0.00        0\n## mapply                    0.01       100      0.00        0\n## process_file              0.01       100      0.00        0\n## process_group.block       0.01       100      0.00        0\n## try                       0.01       100      0.00        0\n## tryCatch                  0.01       100      0.00        0\n## tryCatchList              0.01       100      0.00        0\n## tryCatchOne               0.01       100      0.00        0\n## unlist                    0.01       100      0.00        0\n## withCallingHandlers       0.01       100      0.00        0\n## withVisible               0.01       100      0.00        0\n## \n## $sample.interval\n## [1] 0.01\n## \n## $sampling.time\n## [1] 0.01\n## \n</code></pre>\n\n<p>It doesn't seem to actually profile the code that was run, only the <code>knitr</code> / <code>evaluate</code> details.</p>\n\n<h1>Question and possible solution</h1>\n\n<p>My current work flow is to just run profiling outside knitr, but the automatic formatting (commenting out output with <code>##</code>) I find really useful.</p>\n\n<p>Has anyone come across a neat solution to this, or is it something to take up with the package developers?</p>\n\n<p>My current idea is to rewrite <code>parse_rprof</code> to limit itself to calls above the first call to <code>force</code> (not the default level 7)</p>\n\n<h1>Example rewrite of profr</h1>\n\n<p>Here is a rewrite of <code>profr</code> that <em>almost</em> works</p>\n\n<pre><code>library(profr)\nprofr &lt;- function(expr, interval = 0.02, quiet = TRUE) {\n    tmp &lt;- tempfile()\n    on.exit(unlink(tmp))\n    on.exit(unlink(\"Rprof.out\"), add = T)\n    if (quiet) {\n        tc &lt;- textConnection(NULL, \"w\")\n        sink(tc)\n        on.exit(sink(), add = TRUE)\n        on.exit(close(tc), add = TRUE)\n    }\n    Rprof(tmp, append = TRUE, interval = interval)\n    try(force(expr))\n    Rprof(NULL)\n    parsed &lt;- parse_rprof(tmp, interval)\n    which_force &lt;- min(which(parsed$f == \"force\"))\n\n    parsed &lt;- parsed[parsed$level &gt; parsed$level[which_force], ]\n    parsed$level &lt;- parsed$level - parsed$level[which_force]\n    parsed\n}\n\nquantile_ex &lt;- profr({\n    Sys.sleep(1)\n    example(quantile, setRNG = TRUE)\n}, 0.01)\nquantile_ex\n\n\n##                 f level time start  end  leaf source\n## 32      Sys.sleep    NA 0.90  0.00 0.90  TRUE   base\n## 33        example    NA 0.03  0.90 0.93 FALSE  utils\n## 34    &lt;Anonymous&gt;    NA 0.03  0.90 0.93 FALSE   &lt;NA&gt;\n## 35     prepare_Rd    NA 0.01  0.90 0.91 FALSE   &lt;NA&gt;\n## 36         render    NA 0.02  0.91 0.93 FALSE   &lt;NA&gt;\n## 37   .getHelpFile    NA 0.01  0.90 0.91 FALSE   &lt;NA&gt;\n## 38           %in%    NA 0.01  0.91 0.92  TRUE   base\n## 39            of0    NA 0.01  0.92 0.93 FALSE   &lt;NA&gt;\n## 40    &lt;Anonymous&gt;    NA 0.01  0.90 0.91 FALSE   &lt;NA&gt;\n## 41            of1    NA 0.01  0.92 0.93 FALSE   &lt;NA&gt;\n## 42 lazyLoadDBexec    NA 0.01  0.90 0.91 FALSE   base\n## 43     WriteLines    NA 0.01  0.92 0.93 FALSE   &lt;NA&gt;\n## 44            fun    NA 0.01  0.90 0.91 FALSE   &lt;NA&gt;\n## 45     writeLines    NA 0.01  0.92 0.93 FALSE   base\n## 46          fetch    NA 0.01  0.90 0.91  TRUE   &lt;NA&gt;\n## 47         paste0    NA 0.01  0.92 0.93 FALSE   base\n## 48          remap    NA 0.01  0.92 0.93 FALSE   &lt;NA&gt;\n## 49           psub    NA 0.01  0.92 0.93  TRUE   &lt;NA&gt;\n</code></pre>\n\n<p>The results, are however not the same as from plain <code>R</code></p>\n"},{"tags":["r","sorting","loops"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":76,"score":-2,"question_id":12966942,"title":"How to sort data by using for loop?","body":"<p>I am wondering that how to use a loop (may be a for loop) to sort data like following.</p>\n\n<pre><code>      [,1]\n [1,]  179\n [2,]  160\n [3,]  136\n [4,]  227\n [5,]  217\n [6,]  168\n [7,]  108\n [8,]  124\n [9,]  143\n[10,]  140\n</code></pre>\n\n<p>I tried to use a loop like this:</p>\n\n<pre><code>for (i in 1:nrow(v)) {\nfor (j in i+1:nrow(v)) {\nif (v[i] &gt; v[j]) {\nv[i] &lt;- v[j]\n}\nelse {\nv[i] &lt;- v[i]\n}\n}\n}\nv\n</code></pre>\n\n<p>But finally a error message turned out :/</p>\n\n<pre><code>Error in if (chickwts[i, 1] &gt; chickwts[j, 1]) { : \n  missing value where TRUE/FALSE needed\n</code></pre>\n\n<p>I know that this is very simple by using order to do it, but as a beginner of R, I am curious how to do this by loop.  Hope someone can help.  Thank you!</p>\n"},{"tags":["r","lattice"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12939518,"title":"Shift labels left/right in lattice graphics?","body":"<p>In lattice graphics, I am putting x axis ticks and labels on each plot box using scales=(alternating=3).  Is there a parameter that will shift labels left/right (or up/down, for that matter)?  For example, my x axis labels are time step numbers.  When the last (rightmost) label has more than 3 characters (e.g. \"1500\"), the rightmost characters extend over the next plot box unless I add a lot of space between boxes (which I'd rather avoid).  I'm keeping lots of space between ticks using the 'at' parameter of scales, so there is space to shift \"1500\" left, e.g. putting the last \"0\" over the tick mark.</p>\n"},{"tags":["r","matrix"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":80,"score":6,"question_id":12965618,"title":"Pairwise interaction matrix in R","body":"<p>I am trying to compute a pairwise matrix in R that counts the number of times individuals interact with other individuals (so the matrix will include N number of rows and columns corresponding to number of individuals). I have a dataframe that lists \"actors\" and \"partners\" in separate columns.</p>\n\n<pre class=\"lang-r prettyprint-override\"><code>nn &lt;- data.frame(actors=c('DOL','DOL','DOL','DOL','DOL','NOR','NOR','NOR','NIN','JOJ'),partners=c('JOJ','JOJ','NOR','NOR','NIN','NIN','DOL','JOJ','NOR','NOR'))\n</code></pre>\n\n<p>The data are such that direction of the interaction is irrelevant, so each cell should count the number of times individual X acts on Y plus the number of times Y acts on X. Ideally, the data frame above should give a matrix that looks like this:\n</p>\n\n<pre><code>     DOL JOJ NOR NIN\nDOL    0   2   3   1\nJOJ    2   0   2   0\nNOR    3   2   0   2\nNIN    1   0   2   0\n</code></pre>\n\n<p>I started writing a loop to cycle through each individual in my dataset and to count his/her interactions both from actor->partner and partner->actor. I'm sure this would work, but is not ideal as the full dataset is quite large. Is there a better way?</p>\n\n<hr>\n\n<p>Update:\nThanks for the responses! Both solutions work great! I'm posting my implementation of Josh's suggestion, which was very helpful.</p>\n\n<pre><code>x &lt;- with(nn, table(actors, partners))\ny &lt;- t(x)\n\n# unique individuals\nu &lt;- unique(c(rownames(x),colnames(x)))\n\nm &lt;- matrix(0,ncol=length(u),nrow=length(u),dimnames=list(u,u))\n\ni1 &lt;- as.matrix(expand.grid(rownames(x),colnames(x)))\ni2 &lt;- as.matrix(expand.grid(rownames(y),colnames(y)))\n\nm[i1] &lt;- x[i1]\nm[i2] &lt;- m[i2] + y[i2]\n</code></pre>\n"},{"tags":["r","devtools"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12966600,"title":"install_bitbucket in devtools: case-sensitive?","body":"<pre><code>library(devtools)\ninstall_bitbucket(\"readlicor\",\"remkoduursma\")\n</code></pre>\n\n<p>works fine! However:</p>\n\n<pre><code>install_bitbucket(\"GasExchangeR\",\"remkoduursma\")\n</code></pre>\n\n<p>does not, it appears to be looking for:</p>\n\n<pre><code>bitbucket.org/remkoduursma/GasExchangeR/get/master.zip\n</code></pre>\n\n<p>but that page does not exist, instead:</p>\n\n<pre><code>bitbucket.org/remkoduursma/gasexchanger/get/master.zip\n</code></pre>\n\n<p>does exist.</p>\n\n<p>Is there a workaround (besides renaming all my packages to lower case names), or is this a bug?</p>\n\n<p>thanks\nremko</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":258,"score":8,"question_id":12236160,"title":"ggplot: sum percentages for each facet - respect \"fill\"","body":"<p>I am trying to create a faceted barplot, with percentages adding up to 100 for each facet. The solution to this seems to be a combination of <code>group</code> and <code>..density..</code>. How ever - it seems to me that <code>group</code>is conflicting with <code>fill</code>.</p>\n\n<p>Data:</p>\n\n<pre><code>test &lt;- data.frame(\n     test1 = sample(letters[1:2], 100, replace = TRUE), \n     test2 = sample(letters[3:8], 100, replace = TRUE)\n )\n</code></pre>\n\n<p>This gets the percentages right:</p>\n\n<pre><code>ggplot(test, aes(test2)) +\n     geom_bar(aes(y = ..density.., fill=test2,group=test1)) + \n     facet_grid(~test1)\n</code></pre>\n\n<p>Bus as you can see, <code>fill</code>is overwritten:\n<img src=\"http://i.stack.imgur.com/SWEEU.png\" alt=\"percentage sums to 100 for each facet\"></p>\n\n<p>However, the code below respects <code>fill</code> but gives me the wrong percentages (sums to 100 for the whole chart)(using ..density..):</p>\n\n<pre><code>ggplot(test, aes(test2)) +\n     geom_bar(aes(y = ..count../sum(..count..), fill=test2)) + \n     facet_grid(~test1)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/kExZv.png\" alt=\"percentage sums to 100 for the total chart\"></p>\n\n<p>Related: This old question of mine: <a href=\"http://stackoverflow.com/questions/4725339/percentage-on-y-lab-in-a-faceted-ggplot-barchart\">percentage on y lab in a faceted ggplot barchart?</a>.</p>\n\n<p>And yes - I could create additional data, but I feel this belongs in the presentation layer. Actually this feels like a bug?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":12966109,"title":"How to exclude some variables from dot in formula when used with aggregate() in R, i.e. all but some?","body":"<p>I have quite many variables to feed like to <code>aggregate</code> and apparently I'm lazy to explicitly type all especially they change once in a while but those I'd like to exclude are mostly the same. I tried to write</p>\n\n<pre><code>hru.mean &lt;-\n    aggregate(.-LULC~GIS, hru.annual, \"mean\")\n</code></pre>\n\n<p>but apparently it is not quite right as it says</p>\n\n<pre><code>Error in aggregate.data.frame(mf[1L], mf[-1L], FUN = FUN, ...) : \n  no rows to aggregate\nIn addition: Warning message:\nIn Ops.factor(., LULC) : - not meaningful for factors\n</code></pre>\n\n<p>I just saw <a href=\"http://stackoverflow.com/a/5251676/673826\">this</a>, so it looks like it works for <code>lm</code> but does not work for <code>aggregate</code>. Are there any alternatives?</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":185,"score":1,"question_id":12234248,"title":"Printing multiple ggplots into a single pdf, multiple plots per page","body":"<p>I have a list, <code>p</code>, where each element of <code>p</code> is a list of ggplot2 plotting objects.</p>\n\n<p>I would like to output a single pdf containing all the plots in <code>p</code> such that the plots in <code>p[[1]]</code> are on page 1, the plots in <code>p[[2]]</code> are on page 2, etc. How might I do this?</p>\n\n<p>Here's some example code to provide you with the data structure I'm working with--apologies for the boring plots, I picked variables at random.</p>\n\n<pre><code>require(ggplot2)\np &lt;- list()\n\ncuts &lt;- unique(diamonds$cut)\nfor(i in 1:length(cuts)){\n    p[[i]] &lt;- list()\n    dat &lt;- subset(diamonds, cut==cuts[i])\n    p[[i]][[1]] &lt;- ggplot(dat, aes(price,table)) + geom_point() + \n        opts(title=cuts[i])\n    p[[i]][[2]] &lt;- ggplot(dat, aes(price,depth)) + geom_point() + \n        opts(title=cuts[i])\n}\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12964349,"title":"Combine aggregated variables into one variable in R","body":"<p>I am using this code to combine 100s of dates into their respective months:</p>\n\n<pre><code>cpkmonthly &lt;- aggregate(mydf$AVG, na.rm=TRUE, list(month=months(as.Date(mydf$DATETIME))), mean)\n</code></pre>\n\n<p>This is the output in R:</p>\n\n<pre><code>&gt; cpkmonthly\n   month         x\n1  April 0.4583167\n2 August 0.4416660\n3   July 0.4436665\n4   June 0.4435551\n5  March 0.4654443\n6    May 0.4523338\n</code></pre>\n\n<p>I am looking for a way to combine certian months into quarters instead.</p>\n\n<pre><code>Jan-March = q1\nApril-June = q2\nJuly-Sep = q3\nOct-Dec = q4\n</code></pre>\n\n<p>Is there a way to do this?</p>\n\n<p>The output should look something like this:</p>\n\n<pre><code>&gt; cpkquarterly\n   quarter         x\n1       q1 0.4583167\n2       q2 0.4416660\n3       q3 0.4436665\n4       q4 0.4435551\n</code></pre>\n"},{"tags":["r","plot","par"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":57,"score":4,"question_id":12964720,"title":"Named character vectors and par() in R plots","body":"<p>I'm trying to use a named character vector to hold a custom color palette, so I can say, e.g. palette['red'] instead of repeating \"#dc322f\" all over the place.</p>\n\n<p>However, I don't seem to be able to use an element of that vector as an argument to <code>par()</code> (though it can be used elsewhere).</p>\n\n<p>Here's an example. It'll create a graph with green dots, but the par() call fails and the background is white. Note that I <em>can</em> set parameters using the palette vector from within the <code>plot()</code> call:</p>\n\n<pre><code>&gt; palette &lt;- c('#002b36','#dc322f','#859900')\n&gt; names(palette) &lt;- c('black','red','green')\n&gt; par(bg=palette['red'])                                                                                                                                \nWarning message:\nIn par(bg = palette[\"red\"]) : \"bg.red\" is not a graphical parameter\n&gt; plot(1:10,1:10,col=palette['green'])\n&gt; # (White graph with green dots appears) \n</code></pre>\n\n<p>When I use a named <em>numeric</em> vector, however, it works:</p>\n\n<pre><code>&gt; palette &lt;- 1:3                                                                                                                                          \n&gt; names(palette) &lt;- c('black','red','green')                                                                                                              \n&gt; par(bg=palette['red'])                                                                                                                             \n&gt; # (no error here -- it worked.)\n&gt; plot(1:10,1:10,col=palette['green'])\n&gt; # (Red graph with green dots appears)\n</code></pre>\n\n<p>I am fairly new to R, and it seems that I might be missing something fundamental. Any idea what's happening here?</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":87,"score":5,"question_id":12958170,"title":"Cut function split by factor levels","body":"<p>I have a problem with the cut function. I have this situation:</p>\n\n<pre><code> codice\n1 11GP2-0016\n2 11GP2-0016\n3 11GP2-0016\n4  11OL2-074\n5  11OL2-074\n</code></pre>\n\n<p>and I would like to have a new variable \"campione\" splitted by variable \"codice\" like this:</p>\n\n<pre><code>    codice campione\n1 11GP2-0016    [1,3]\n2 11GP2-0016    [1,3]\n3 11GP2-0016    [1,3]\n4  11OL2-074    (4,5]\n5  11OL2-074    (4,5]\n</code></pre>\n\n<p>How can I use the cut function to split the \"codice\" creating a variabile showing that from 1 to 3 i have the same code, from 4 to 5 same code and so on?</p>\n\n<p>I really appreciate your help\nthank you so much\nNik</p>\n"},{"tags":["r","data-manipulation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":60,"score":-1,"question_id":12964566,"title":"How to write a \"find and replace all BUT\" function in R?","body":"<p>I have a dataframe that looks roughly like below (meaning that it is an approximation made for illustration, and not an exact replica of the dataframe you can download through the link below, or get from the dput() I pasted below):</p>\n\n<pre><code>March_created_at    March_email March_type  April_created_at April_email    April_type\n3/11/12 7:28    jeremy@asynk.ch PushEvent   4/1/12 4:03                     PushEvent\n3/11/12 7:28    jeremy@asynk.ch PushEvent   4/1/12 4:03                     PushEvent\n3/11/12 7:28    jeremy@asynk.ch PushEvent   4/1/12 4:03                     PushEvent\n3/11/12 7:28    jeremy@asynk.ch PushEvent   4/1/12 7:03     high            IssuesEvent\n3/11/12 11:06   medium          PushEvent   4/1/12 13:57    medium          PushEvent\n3/11/12 11:06   medium          PushEvent   4/1/12 13:57    medium          PushEvent\n3/11/12 11:06   medium          PushEvent   4/1/12 13:57    medium          PushEvent\n3/11/12 12:46                   PushEvent   \n3/11/12 12:46                   PushEvent   \n3/11/12 12:46                   PushEvent   \n</code></pre>\n\n<p>The full dataset can be found <a href=\"https://github.com/aronlindberg/VOSS-Sequencing-Toolkit/blob/master/rubinius_rubinius_sequencing/output.csv\" rel=\"nofollow\">here</a> as a CSV file</p>\n\n<p>I'm looking to write a function that takes the following inputs:</p>\n\n<ol>\n<li>A dataframe</li>\n<li>Certain columns of that dataframe</li>\n<li>A list of strings (e.g. a set of email addresses)</li>\n<li>A replacement string (e.g. \"low\")</li>\n</ol>\n\n<p>Now, I want the function to go through only the specified columns of that dataframe and replace all of the strings (as well as empty cells) that <em>do not</em> match the list of strings specified in point 3 above with the replacement string in point 4. However, this should only be done if the following condition holds:</p>\n\n<p><em>The cell under consideration needs to have a timestamp for the same month.</em> </p>\n\n<p>For example, let's say we are about to replace the empty cell on row 8 in column \"March_email\". I can see that on row 8 in the column \"March_created_at\" there is a timestamp, so I can go ahead and replace this empty cell with the specified string (e.g. \"low\"). However, look at row 8 in the column \"April_email\". This cell is also empty, and so is the cell on row 8 in column \"April_created_at\". In this case, nothing should be done (i.e. no string inserted).</p>\n\n<p>The reason I want to do this is that certain cells are just empty because there is no data, so nothing should be inserted. Other cells are empty because the data is missing, so I need to impute the data based on the function I specified above.</p>\n\n<p>How can I accomplish this in R?</p>\n\n<p><strong>Appendix:</strong> Here is a dput() of the head of the dataset:</p>\n\n<pre><code>structure(list(March_created_at = c(\"2012-03-11 07:28:04\", \"2012-03-11 07:28:04\", \n\"2012-03-11 07:28:04\", \"2012-03-11 07:28:19\", \"2012-03-11 07:28:19\", \n\"2012-03-11 07:28:19\"), March_actor_attributes_email = c(\"jeremy@asynk.ch\", \n\"jeremy@asynk.ch\", \"jeremy@asynk.ch\", \"jeremy@asynk.ch\", \"jeremy@asynk.ch\", \n\"jeremy@asynk.ch\"), March_type = c(\"PushEvent\", \"PushEvent\", \n\"PushEvent\", \"PushEvent\", \"PushEvent\", \"PushEvent\"), April_created_at = c(\"2012-04-01     04:03:13\", \n\"2012-04-01 04:03:13\", \"2012-04-01 04:03:13\", \"2012-04-01 07:03:11\", \n\"2012-04-01 07:03:11\", \"2012-04-01 07:03:11\"), April_actor_attributes_email = c(\"\", \n\"\", \"\", \"high\", \"high\", \"high\"), April_type = c(\"PushEvent\", \n\"PushEvent\", \"PushEvent\", \"IssuesEvent\", \"IssuesEvent\", \"IssuesEvent\"\n), May_created_at = c(\"2012-05-01 00:16:05\", \"2012-05-01 00:16:05\", \n\"2012-05-01 00:16:05\", \"2012-05-01 01:03:19\", \"2012-05-01 01:03:19\", \n\"2012-05-01 01:03:19\"), May_actor_attributes_email = c(\"john.firebaugh@gmail.com\", \n\"john.firebaugh@gmail.com\", \"john.firebaugh@gmail.com\", \"mitch.tishmack@gmail.com\", \n\"mitch.tishmack@gmail.com\", \"mitch.tishmack@gmail.com\"), May_type = c(\"PushEvent\", \n\"PushEvent\", \"PushEvent\", \"IssueCommentEvent\", \"IssueCommentEvent\", \n\"IssueCommentEvent\"), June_created_at = c(\"2012-06-01 00:25:05\", \n\"2012-06-01 00:25:05\", \"2012-06-01 00:25:05\", \"2012-06-01 00:42:29\", \n\"2012-06-01 00:42:29\", \"2012-06-01 00:42:29\"), June_actor_attributes_email =     c(\"michaelklishin@me.com\", \n\"michaelklishin@me.com\", \"michaelklishin@me.com\", \"\", \"\", \"\"), \n    June_type = c(\"IssueCommentEvent\", \"IssueCommentEvent\", \"IssueCommentEvent\", \n    \"PushEvent\", \"PushEvent\", \"PushEvent\"), July_created_at = c(\"2012-07-01 13:46:20\", \n    \"2012-07-01 13:46:20\", \"2012-07-02 11:53:37\", \"2012-07-02 11:53:37\", \n    \"2012-07-02 12:27:30\", \"2012-07-02 12:27:30\"), July_actor_attributes_email = c(\"medium\", \n    \"medium\", \"ryoqun@gmail.com\", \"ryoqun@gmail.com\", \"ryoqun@gmail.com\", \n    \"ryoqun@gmail.com\"), July_type = c(\"PushEvent\", \"PushEvent\", \n    \"CreateEvent\", \"CreateEvent\", \"PushEvent\", \"PushEvent\"), \n    August_created_at = c(\"2012-08-01 00:04:09\", \"2012-08-01 00:04:09\", \n    \"2012-08-01 00:04:42\", \"2012-08-01 00:04:42\", \"2012-08-01 00:05:04\", \n    \"2012-08-01 00:05:04\"), August_actor_attributes_email = c(\"jeremy@asynk.ch\", \n    \"jeremy@asynk.ch\", \"jeremy@asynk.ch\", \"jeremy@asynk.ch\", \n    \"jeremy@asynk.ch\", \"jeremy@asynk.ch\"), August_type = c(\"IssueCommentEvent\", \n    \"IssueCommentEvent\", \"IssuesEvent\", \"IssuesEvent\", \"IssueCommentEvent\", \n    \"IssueCommentEvent\"), September_created_at = c(\"2012-09-01 18:12:24\", \n    \"2012-09-01 18:12:24\", \"2012-09-01 23:51:18\", \"2012-09-01 23:51:18\", \n    \"2012-09-02 00:34:54\", \"2012-09-02 00:34:54\"), September_actor_attributes_email = c(\"ryoqun@gmail.com\", \n    \"ryoqun@gmail.com\", \"ryoqun@gmail.com\", \"ryoqun@gmail.com\", \n    \"ryoqun@gmail.com\", \"ryoqun@gmail.com\"), September_type = c(\"CommitCommentEvent\", \n    \"CommitCommentEvent\", \"CreateEvent\", \"CreateEvent\", \"PushEvent\", \n    \"PushEvent\"), October_created_at = c(\"2012-10-01 07:48:38\", \n    \"2012-10-01 10:01:40\", \"2012-10-01 10:01:43\", \"2012-10-01 10:17:00\", \n    \"2012-10-01 16:08:29\", \"2012-10-01 18:06:46\"), October_actor_attributes_email = c(\"medium\", \n    \"medium\", \"medium\", \"medium\", \"\", \"core\"), October_type = c(\"PushEvent\", \n    \"IssuesEvent\", \"PushEvent\", \"PushEvent\", \"ForkEvent\", \"PullRequestEvent\"\n    )), .Names = c(\"March_created_at\", \"March_actor_attributes_email\", \n\"March_type\", \"April_created_at\", \"April_actor_attributes_email\", \n\"April_type\", \"May_created_at\", \"May_actor_attributes_email\", \n\"May_type\", \"June_created_at\", \"June_actor_attributes_email\", \n\"June_type\", \"July_created_at\", \"July_actor_attributes_email\", \n\"July_type\", \"August_created_at\", \"August_actor_attributes_email\", \n\"August_type\", \"September_created_at\", \"September_actor_attributes_email\", \n\"September_type\", \"October_created_at\", \"October_actor_attributes_email\", \n\"October_type\"), row.names = c(NA, 6L), class = \"data.frame\") \n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12964651,"title":"If statement- diagonal of matrix","body":"<p>Im trying to put -5 in the diagonal of my matrix. I am using if statements. But my if statment is wrong. Can anyone give me some help?</p>\n\n<pre><code>X= rbind(c(1.2,3.4,10.3),c(2,8,78),c(45,-36,8))\narray(X,dim=c(3,3))\nif (X != (1.2,8.0)){\n    cat(X)\n} else {\n    cat(-5)\n}\n</code></pre>\n"},{"tags":["r","plyr"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":12964025,"title":"How do I preserve list names when working with nested lists?","body":"<p>The advantage of using <code>plyr</code>'s <code>llply</code> over <code>lapply</code> is that it preserves list names. See <code>?llply</code> for an explanation. I love that feature but cannot seem to get it to work in the case of a nested list. Example:</p>\n\n<pre><code>library(plyr) \nm &lt;- as.list(1:2)\nnames(m) &lt;- c('M1', 'M2')\nfoo &lt;- list(m, m)\nnames(foo) &lt;- paste0(\"R\", 1:2)\n\n\nresult &lt;- ldply(foo, function(x){\n        ldply(x, function(z) { data.frame(a=z, b= z^2)})\n})\n&gt; result\n  .id a b\n1  M1 1 1\n2  M2 2 4\n3  M1 1 1\n4  M2 2 4\n\n# if I don't operate on the inner list, I can preserve the outer list's names\nresult2 &lt;- ldply(foo, function(x){\n     data.frame(a = x[[1]], b = x[[1]]^2)\n    })\n&gt; result2\n  .id a b\n1  R1 1 1\n2  R2 1 1\n</code></pre>\n\n<p>Note that <code>result</code> does not contain <code>R1</code> and <code>R2</code> (which would get added in as <code>.id</code> if I didn't operate on the nested list inside each element of <code>foo</code> as is the case with <code>result2</code>). How do I make sure I get the outer list names added in when working on nested lists? </p>\n"},{"tags":["r","paste"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":12962984,"title":"R prevent repeated items while using paste() for vectors","body":"<p>Consider the following:</p>\n\n<pre><code>a = 1:10\npaste(\"The list is:\", a)\n</code></pre>\n\n<p>And the result would be:</p>\n\n<pre><code> [1] \"The list is: 1\"  \"The list is: 2\"  \"The list is: 3\"  \"The list is: 4\" \n [5] \"The list is: 5\"  \"The list is: 6\"  \"The list is: 7\"  \"The list is: 8\" \n [9] \"The list is: 9\"  \"The list is: 10\"\n</code></pre>\n\n<p>I have solved it by:</p>\n\n<pre><code>paste(\"The list is:\", paste(a, collapse=\", \"))\n# \"The list is: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10\"\n</code></pre>\n\n<p>Is there any better idea?</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":166,"score":-1,"question_id":8417540,"title":"Table like dotplot in R","body":"<p>I want to create a table like dotplot with ggplot but haven't found the right way to do it. I am using code like the following to plot p-values for different groups across a number of covariates:</p>\n\n<pre><code>library(ggplot2) \n\ny &lt;- rep(c(\"a\",\"b\",\"c\",\"d\"),2) \np &lt;-  abs(rnorm(n=8)) \ngroup &lt;- rep(c(\"1\",\"2\"),4) \nn &lt;-c(10, 20, 30, 10, 15, 12, 18, 22)\ndf &lt;- data.frame(p, y, group, n) \n\nggplot(data = df, mapping = aes(x = p, y= y \n    ))+ geom_point(mapping=aes(y=y, x=p), stat=\"identity\")\n</code></pre>\n\n<p>I want the covariates to be on the y-axis and the p-values on the x-axis.</p>\n\n<p>The specific problems I find are two:</p>\n\n<ol>\n<li><p>First, there are different subsets (\"groups\" in this data) for each combination of y and x, as reflected in different dots located on the same rows. Therefore, I would like the p-values to be plotted on separate rows. While faceting would offer a solution, it is not what I am looking for. I want the different groups to be identified within the same facet/panel (I am also avoiding colors because I am using that for something else).</p></li>\n<li><p>Second, I would like a column showing the number of observations (\"n\" in this data) on the left-hand side. The end result would have three columns on the left of the graph: one with the y labels spanning over different groups, another with the groups, and the last with the number of observations.</p></li>\n</ol>\n"},{"tags":["r","package"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":49,"score":0,"question_id":12958689,"title":"instaling texreg package in R","body":"<p>I tried to install the <code>texreg</code> package in R and am getting the following error: </p>\n\n<pre><code>&gt; install.packages(\"texreg\", \"~/R/x86_64-unknown-linux-gnu-library/2.13/\")\n--- Please select a CRAN mirror for use in this session ---\nLoading Tcl/Tk interface ... done\ntrying URL 'http://cran.wustl.edu/src/contrib/texreg_1.06.tar.gz'\nContent type 'application/x-gzip' length 204278 bytes (199 Kb)\nopened URL\n==================================================\ndownloaded 199 Kb\ninstalling *source* package ‘texreg’ ...\n** R\n** inst\n** preparing package for lazy loading\nError in is(signature, \"list\") : could not find function \"className\"\nError : unable to load R code in package 'texreg'\nERROR: lazy loading failed for package ‘texreg’\n</code></pre>\n\n<p>Is this a problem with my R installation? I am running 2.13 and am unfortunately unable to upgrade because I'm on a cluster.</p>\n"},{"tags":["r","legend"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12961775,"title":"Truncate data frame column characters and update legend based on result in R","body":"<p>I am writing an R script that incoorporates a data frame.\nThe data frame has the following look:</p>\n\n<pre><code>mydf &lt;= read.csv('file', header = TRUE, sep=\",\")\n\nmydf\n....Prod  Date                   AVG\n189 CA123 2012/07/24 14:32:35   0.2424     0.22     0.25     0.27\n190 JK489 2012/08/25 18:29:08   0.2402     0.22     0.25     0.27\n191 CA15K 2012/07/24 13:49:07   0.2427     0.22     0.25     0.27\n192 JA45A 2012/07/22 02:32:40   0.2455     0.22     0.25     0.27\n193 JA3HS 2012/07/24 22:26:25   0.2410     0.22     0.25     0.27\n194 CA429 2012/08/28 10:36:16   0.2351     0.22     0.25     0.27\n195 JK345 2012/07/25 07:11:24   0.2419     0.22     0.25     0.27\n...\n</code></pre>\n\n<p>I am using this code to plot the data:</p>\n\n<pre><code>plot(Date,mydf$AVG,xlab='Date',ylab='AVG',main='title')\nlegend(\"topright\", legend = c(\" \",\" \"), text.width = strwidth(\"1,000,000\"), lty = 1:2, xjust = 1, yjust = 1, title = \"Prods\")\n</code></pre>\n\n<p>The plot is working fine, but I am unable to get the Legend formatting down. What I want to do is place a legend in the top right that will display each Prod as a different color data point on the graph; however, Prod also needs to be trucated and only count as the first two characters in the column.</p>\n\n<p>I know I can access all the variables by running: `mydf$Prod', but is there a way to truncate each item in that frame reference to just two characters. I tried using round, but I am unable to perform any math operations, which makes sense. </p>\n\n<p>Is there a way to truncate these variables and then paste them into the legend keeping the truncated format. The legend will need to be dynamic, because the Prod's are constantly changing, and I run the script on different files.</p>\n\n<p><strong>One additional item:</strong> Ideally, I would like this to be done with just the standard librarys. Im not currently using ggplot, or any other graphing library, as the graphs I am creating are simple.</p>\n"},{"tags":["r","latex","knitr","subfigure"],"answer_count":1,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":125,"score":7,"question_id":12546365,"title":"Subfigures or Subcaptions with knitr?","body":"<p>Is it possible to produce subfigures (with associated subcaptions) using knitr? Here is a minimal working example:</p>\n\n<pre><code>\\documentclass{article}\n\n\\begin{document}\n\n&lt;&lt;echo = FALSE, fig.cap = c(\"Some numbers.\", \"Some more numbers.\"), out.width = \"0.5\\\\textwidth\", fig.align = \"center\"&gt;&gt;=\n\nplot(1:10)\nplot(30:100)\n\n@\n\n\\end{document}\n</code></pre>\n\n<p>This results in two figures labelled Figure 1 and Figure 2 with captions as defined (respectively).  But I want them to be labelled \"Figure 1a\" and \"Figure 1b\", as you can do with the subcaption LaTeX package.</p>\n\n<p>I know there is a knitr options \"fig.env\", but this doesn't solve it (at least not using, for example, \"fig.env = 'subfigure'\").  There is a similar post here regarding Sweave, but the solution is an inelegant hack: <a href=\"http://texblog.org/2011/12/01/sweave-subfig-controlling-figure-size-and-placement/\">http://texblog.org/2011/12/01/sweave-subfig-controlling-figure-size-and-placement/</a></p>\n"},{"tags":["r","for-loop","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":96,"score":2,"question_id":12957284,"title":"R for loop and a series of plots: obtaining always the same plot","body":"<p>I'm trying to get a series of plots from the following dataset and for loop:</p>\n\n<pre><code>&gt; head(all5new[c(6,70,22:23)])#This is a snapshot of my dataset. There is more species, see below.\n   setID         fishery blackdog smoothdog\n11     1 TRAWL-PAND.BOR.        0         0\n12     1 TRAWL-PAND.BOR.        0         0\n13     1   TRAWL-REDFISH        0         0\n14     1 TRAWL-PAND.BOR.        0         0\n21    10 TRAWL-PAND.BOR.        0         0\n22    10 TRAWL-PAND.BOR.        0         0\n\n&gt; elasmo #This is the list of the species for which I would like to have individual barplots\n [1] \"blackdog\"     \"smoothdog\"    \"spinydog\"     \"mako\"         \"porbeagle\"   \n [6] \"blue\"         \"greenland\"    \"portuguese\"   \"greatwhite\"   \"mackerelNS\"  \n[11] \"dogfish\"      \"basking\"      \"thresher\"     \"deepseacat\"   \"atlsharp\"    \n[16] \"oceanicwt\"    \"roughsagre\"   \"dusky\"        \"sharkNS\"      \"sand\"        \n[21] \"sandbar\"      \"smoothhammer\" \"tiger\"        \"wintersk\"     \"abyssalsk\"   \n[26] \"arcticsk\"     \"barndoorsk\"   \"roundsk\"      \"jensensk\"     \"littlesk\"    \n[31] \"richardsk\"    \"smoothsk\"     \"softsk\"       \"spinysk\"      \"thorny\"      \n[36] \"whitesk\"      \"stingrays\"    \"skateNS\"      \"manta\"        \"briersk\"     \n[41] \"pelsting\"     \"roughsting\"   \"raysNS\"       \"skateraysNS\"  \"allSHARK\"    \n[46] \"allSKATE\"     \"PELAGIC\"     \n</code></pre>\n\n<p>This is my for loop. The code works fine when I run it for one species, however when I run it for all, I always get the same barplot. I know it must be just a quick fix adding for example [[i]] somewhere in the code, but I tried different things without any success. </p>\n\n<pre><code>for (i in elasmo) {\n\n  # CALUCLATE THE CATCH PER UNIT OF EFFORT (KG/SET) FOR ALL SPECIES FOR EACH FISHERY\n  test&lt;-ddply(all5new,.(fishery),summarize, sets=length(as.factor(setID)),LOGcpue=log((sum(i)/length(as.factor(setID)))))\n\n  #TAKE THE FIRST 10 FISHERY WITH THE HIGHEST LOGcpue\n  x&lt;-test[order(-test$LOGcpue)[1:10],]\n\n  #REORDER THE FISHERY FACTOR ACCORDINGLY (FOR GGPLOT2, TO HAVE EACH LEVEL IN ORDER)\n  list&lt;-x$fishery\n  x$fishery &lt;- factor(x$fishery, levels =list)\n\n  #BAR PLOT\n  graph&lt;-ggplot(x, aes(fishery,LOGcpue)) + geom_bar() + coord_flip() +\n  geom_text(aes(label=sets,hjust=0.5,vjust=-1),size=4,angle = 270)\n\n  #SAVE GRAPH IN NEW DIR\n  ggsave(graph,filename=paste(\"barplot\",i,\".png\",sep=\"\"))\n}\n</code></pre>\n\n<p>Here's a subset of my dataset after melting: <a href=\"https://www.dropbox.com/s/7814js3po36jf48/data.RData\" rel=\"nofollow\">mydata</a>.  </p>\n\n<pre><code>&gt; data.melt&lt;-melt(all5new, id.vars=c(\"tripID\",\"setID\",\"fishery\"), measure.vars = c(22:23))\n&gt; head(data.melt);dim(data.melt)\n  tripID setID         fishery variable value\n1      1     1 TRAWL-PAND.BOR. blackdog     0\n2      1     1 TRAWL-PAND.BOR. blackdog     0\n3      1     1   TRAWL-REDFISH blackdog     0\n4      1     1 TRAWL-PAND.BOR. blackdog     0\n5      1    10 TRAWL-PAND.BOR. blackdog     0\n6      1    10 TRAWL-PAND.BOR. blackdog     0\n[1] 350100      5\n</code></pre>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":12962431,"title":"Constructing an object using the genoset package in R","body":"<p>The genoset R package has a function for building a GenoSet by putting together several matrices and a RangedData object that specifies co-ordinates.</p>\n\n<p>I have the following objects - three matrices, all with the same name, and a RangedData object of the following format (called locData).</p>\n\n<pre><code>               space                 ranges |\n            &lt;factor&gt;              &lt;IRanges&gt; |\n cg00000957        1 [  5937253,   5937253] |\n cg00001349        1 [166958439, 166958439] |\n cg00001583        1 [200011786, 200011786] |\n cg00002028        1 [ 20960010,  20960010] |\n cg00002719        1 [169396706, 169396706] |\n cg00002837        1 [ 44513358,  44513358] |\n</code></pre>\n\n<p>When I try to create a GenoSet, though, I get the following error.</p>\n\n<pre><code> DMRSet=GenoSet(locData,Exprs,meth,unmeth,universe=NULL)\n</code></pre>\n\n<p>Error in .Call2(\"IRanges_from_integer\", from, PACKAGE = \"IRanges\") : \n  cannot create an IRanges object from an integer vector with missing values.</p>\n\n<p>What am I doing wrong? all the objects I'm putting together have the same rownames, except for the IRanges object itself, which I don't think has rownames since it isn't a matrix.\nAdditionally, the  \"column\" of locData has non-integer characters. </p>\n\n<p>Thank you! </p>\n"},{"tags":["r","integer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":9104868,"title":"Random integers in R","body":"<p>What code in R will do the following:</p>\n\n<p>Given a list 1, 2, ..., M create a list of N random entries from that list. Furthermore, obtain the complement list.</p>\n\n<pre><code>example:\nN = 5\nM = 10\nlist = [1,4,3,9,2]\ncomplement = [5,6,7,8,10]\n</code></pre>\n"}]}
{"total":19203,"page":13,"pagesize":100,"questions":[{"tags":["r","emacs","knitr","ess"],"answer_count":0,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":71,"score":6,"question_id":12961497,"title":"Return Emacs buffer focus to R after compiling with knitr","body":"<p>When compiling an *.Rnw file with the commands <code>M-n r</code> and <code>M-n P</code> my open R buffer is swapped for a buffer that appears to shows knitr compilation information. Is there a way to automatically switch back to the R buffer if knitr compiles without any errors?  </p>\n"},{"tags":["html","r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12850241,"title":"Assign each aggregate value to seperate variable in R and display it in HTML","body":"<p>I am using the following R script to calculate a monthly CpK number:</p>\n\n<pre><code>mydf &lt;- read.csv('file.csv', header = TRUE, sep=\",\")\ndate &lt;- strptime(mydf$PDATETIME, \"%Y/%m/%d %H:%M:%S\")\nplot(date,mydf$MEAS_AVG,xlab='Date',ylab='MEAS_AVG',main='year')\nabline(h=mydf$TARG_MIN,col=3,lty=1)\nabline(h=mydf$TARG_MAX,col=3,lty=1)\ngrid(NULL,NULL,col=\"black\")\nlegend(\"topright\", legend = c(\" \", \" \"), text.width = strwidth(\"1,000,000\"), lty = 1:2, xjust = 1, yjust = 1, title = \"Data\")\nmyavg &lt;-mean(mydf$MEAS_AVG, na.rm=TRUE)\nnewds &lt;- (mydf$MEAS_AVG - myavg)^2\nnewsum &lt;- sum(newds, na.rm=TRUE)\nN &lt;- length(mydf$MEAS_AVG) - 1\nnewN &lt;- 1/N\ntotal &lt;- newN*newsum\nsigma &lt;- total^(1/2)\nUSL &lt;- mean(mydf$TARG_MAX, na.rm=TRUE)\nLSL &lt;- mean(mydf$TARG_MIN, na.rm=TRUE)\ncpk &lt;- min(((USL-myavg)/(3*sigma)),((myavg-LSL)/(3*sigma)))\ncpkmonthly &lt;- aggregate(mydf$MEAS_AVG, na.rm=TRUE, list(month=months(as.Date(mydf$PDATETIME))), mean)\nmonthlycpk &lt;- by(mydf$MEAS_AVG, na.rm=TRUE, list(month=months(as.Date(mydf$PDATETIME))), mean)\ncpk 'variable to store the entire year's CpK number\ncpkmonthly 'variable to store the each month's mean CpK number\n</code></pre>\n\n<p>So far, the above script correctly goes through all the code assigns values to the cpkmonthly and cpk variables. Their outputs are as follows:</p>\n\n<pre><code>&gt; cpk\n[1] 0.5892231\n\n&gt; cpkmonthly\nmonth         x\n1  April 0.2456467\n2 August 0.2415564\n3   July 0.2456895\n4   June 0.2541071\n5  March 0.1234333\n6    May 0.4321418\n</code></pre>\n\n<p><strong>Question:</strong> How to I break apart the appregated \"cpkmonthly\" variable and assign a seperate variable for each entry? Ideally, I would like each to go into an array, because I would like to have the final output variable be in a HTML display string.</p>\n\n<pre><code>SudoCode:\ncpkmonth[1] = April\ncpkvalue[1] = .245...\ncpkmonth[2] = August\ncpkvalue[2] = .2415...\n...\n</code></pre>\n\n<p>I would like the final table in HTML to look like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/FSJj6.png\" alt=\"Ideal HTML\"></p>\n\n<p>So the final output variable would need to be in this format:</p>\n\n<pre><code>&lt;tr&gt;&lt;td&gt;\"Total Cpk\"&lt;/td&gt;&lt;tdcpkmonth[0]&lt;/td&gt;&lt;td&gt;cpkmonth[1]&lt;/td&gt;&lt;td&gt;...&lt;/td&gt;&lt;/tr&gt;\n&lt;tr&gt;&lt;td&gt;\"cpk\"&lt;/td&gt;&lt;tdcpkvalue[0]&lt;/td&gt;&lt;td&gt;cpkvalue[1]&lt;/td&gt;&lt;td&gt;...&lt;/td&gt;&lt;/tr&gt;\n</code></pre>\n\n<p>For the HTML, I have tried using toJSON/RJSON,R2HTML,HTMLUtil, and a few others, but I am simply looking for one output variable. Is this possible?</p>\n"},{"tags":["r","data.table","plyr"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":105,"score":2,"question_id":12956185,"title":"How can I extract the rows from a large data set by common IDs and take the means of these rows and make a column having these IDs","body":"<p>I know it is a very silly question but I could not sort it out that is why asking...\nHow can I extract the rows from a large data set by common IDs and take the means of these rows and make a column having these IDs as rownames.\ne.g.</p>\n\n<pre><code>IDs Var2    \nAe4 2       \nAe4 4\nAe4 6\nBc3 3   \nBc3 5   \nAd2 8\nAd2 7\n\nOutPut\nVar(x)\nAe4 4\nBc3 4\nAd2 7.5\n</code></pre>\n"},{"tags":["r","unicode","utf-8","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":149,"score":1,"question_id":12768176,"title":"Unicode Characters in ggplot2 PDF Output","body":"<p>How can I use Unicode characters for labels, titles and similar things in a PDF plot created with ggplot2?</p>\n\n<p>Consider the following example:</p>\n\n<pre><code>library(ggplot2)\nqplot(Sepal.Length, Petal.Length, data=iris, main=\"Aʙᴄᴅᴇғɢʜɪᴊᴋʟᴍɴᴏᴘǫʀsᴛᴜᴠᴡxʏᴢ\")\nggsave(\"t.pdf\")\n</code></pre>\n\n<p>The title of the plot uses Unicode characters (small caps), which in the output appear as <code>...</code>.  The problem occurs only with pdf plots; if I replace the last line with <code>ggsave(\"t.png\")</code>, then the output is as expected.</p>\n\n<p>What am I doing wrong?  The R script I have is in UTF-8 encoding.  Some system information:</p>\n\n<pre><code>R version 2.14.1 (2011-12-22)\nPlatform: x86_64-pc-linux-gnu (64-bit)\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=C                 LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base\n</code></pre>\n\n<p>When searching for a solution for this problem, I found some <a href=\"http://cran.r-project.org/doc/Rnews/Rnews_2006-2.pdf\" rel=\"nofollow\">evidence</a> that R uses a single-byte encoding for mutli-byte encodigns such as UTF-8 for PDF or postscript output.  I also found suggestions to, for instance, be able to get the <a href=\"http://stackoverflow.com/questions/6706226/plotting-euro-symbol-in-ggplot2\">Euro sign working</a>, but no general solution.</p>\n"},{"tags":["r","regression"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12960356,"title":"SigmaE for fRegress in Functional Data Analysis (FDA)","body":"<p>So, I'm using package <code>fda</code> for functional data analysis, and regression with functional responses specifically. Now, the fRegress function mentions an argument, SigmaE, which controls the covariance of the error model. Which I suspect might be very important in what I'm doing. However, the argument doesn't seem to be documented at all. There's only the line:</p>\n\n<pre><code>SigmaE: Estimate of the covariances among the residuals.  This can\n      only be estimated after a preliminary analysis with\n      ‘fRegress’.\n</code></pre>\n\n<p>Which doesn't explain much about the expected format of this matrix, how it might be estimated, etc etc.</p>\n\n<p>Has anyone done much work with functional data analysis? Can someone shine a bit of light on this feature? I've been reading the book, <em>Functional Data Analysis with R and Matlab</em> and it too doesn't say anything about this.</p>\n"},{"tags":["r","time","utc","xts","zoo"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12951646,"title":"zoo and utc time with microseconds","body":"<p>The dataset has utc time with microseconds</p>\n\n<pre><code>TIME,DATA1,DATA2\n1350359123.325330,661.00,765.00\n1350359123.491836,661.00,765.50\n</code></pre>\n\n<p>However, I am unable to do the utc format conversion and microseconds at the same time.</p>\n\n<p>I have already asked a <a href=\"http://stackoverflow.com/questions/11136340/r-zoo-xts-microsecond-read-issue\">similar question</a> but that had a different time format.</p>\n"},{"tags":["r","time-series","xts","zoo","strptime"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":149,"score":3,"question_id":11136340,"title":"zoo/xts microsecond read issue","body":"<p>The data looks like </p>\n\n<pre><code>           Time  Set1    Set2   \n10:19:38.551629 16234   16236   \n10:19:41.408010 16234   16236   \n10:19:47.264204 16234   16236   \n</code></pre>\n\n<p>I am trying to load this into zoo. </p>\n\n<pre><code>orig &lt;- read.zoo(\"~/sample.txt\",sep=\"\",header=TRUE,index.column=1,format=\"%H:%M:%S.%6f\")\n\nError in read.zoo(\"~/sample.txt\", sep = \"\", header = TRUE, index.column = 1,  : \n  index has 3 bad entries at data rows: 1 2 3 ...\n</code></pre>\n\n<p>I have checked all the relevant posts \n1. <a href=\"http://stackoverflow.com/questions/10931972/r-issue-with-rounding-milliseconds\">R issue with rounding milliseconds</a>\n2. <a href=\"http://stackoverflow.com/questions/8889554/milliseconds-puzzle-when-calling-strptime-in-r?lq=1\">Milliseconds puzzle when calling strptime in R</a>\n3. <a href=\"http://stackoverflow.com/questions/2150138/how-to-parse-milliseconds-in-r?rq=1\">How to parse milliseconds in R?</a></p>\n\n<p>However this does not help.\nAny Suggestions</p>\n"},{"tags":["r","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12959493,"title":"Extract rows according to consecutive value pattern from data.frame","body":"<p>I have a data.frame, d:</p>\n\n<pre><code>d&lt;-data.frame(id=c(1,1,1,1,2,2,3,3,3,3), var=c(\"no\", \"no\", \"no\", \"yes\", \"no\", \"yes\", \"no\", \"yes\", \"yes\", \"yes\"))\n</code></pre>\n\n<p>I'd like to return all \"no\" rows for each ID leading up to a \"yes\" and including the first \"yes\". </p>\n\n<p>desired result:</p>\n\n<pre><code>id var\n1  no\n1  no\n1  no\n1 yes\n2  no\n2 yes\n3  no\n3 yes\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12958780,"title":"R Aggregate with rle function","body":"<p>struggling with this one :<br>\nSample data :  </p>\n\n<pre><code>    foo &lt;- structure(c(\"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"2\", \"2\", \"2\", \"2\",\n\"2\", \"2\", \"2\", \"2\", \"2\", \"C\", \"C\", \"C\", NA, NA, NA, NA, \"C\",\nNA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, \"C\",\n\"C\", NA, NA, NA, NA, NA, \"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\",\n\"C\", \"C\", \"C\", NA, NA, NA, NA, \"C\", \"C\", \"C\", \"C\", \"C\", \"C\",\n\"C\", \"C\", NA, NA, NA, NA, NA, NA, NA, NA, \"C\", \"C\", \"C\", NA,\nNA, NA, NA, NA, NA, NA, NA, NA, NA, NA, \"C\", \"C\", \"C\", NA, NA,\nNA, NA, NA, \"C\", \"C\", NA, NA, NA, NA, NA, \"C\", \"C\", \"C\", NA,\nNA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, \"C\", \"C\", NA, NA,\nNA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, \"C\", \"C\", \"C\", \"C\",\n\"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\",\n\"C\", NA, NA, \"C\", \"C\", \"C\", \"C\", \"C\", NA, \"C\", \"C\", \"C\", \"C\",\n\"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\", \"C\",\n\"C\", \"C\", NA, NA, \"C\", \"C\", NA, NA, NA, NA, NA, NA, NA, NA, NA,\nNA, NA), .Dim = c(15L, 13L), .Dimnames = list(NULL, c(\"weeks\",\n\"vv\", \"rv\", \"ja\", \"aa\", \"bv\", \"aj\", \"vb\", \"rj\", \"rr\", \"vr\", \"bb\",\n\"jr\")))\n</code></pre>\n\n<p>How to group theses datas by weeks and apply rle function ? Expected output would be :  </p>\n\n<pre><code>out &lt;- structure(c(\"weeks\", \"1\", \"2\", \"vv\", \"1\", \"1\", \"rv\", \"0\", \"1\",\n\"ja\", \"1\", \"1\", \"aa\", \"1\", \"1\", \"bv\", \"1\", \"0\", \"aj\", \"1\", \"1\",\n\"vb\", \"1\", \"0\", \"rj\", \"1\", \"0\", \"rr\", \"1\", \"1\", \"vr\", \"2\", \"2\",\n\"bb\", \"1\", \"1\", \"jr\", \"1\", \"0\"), .Dim = c(3L, 13L), .Dimnames = list(\n    NULL, NULL))\n</code></pre>\n\n<p>Tried so far :</p>\n\n<pre><code>test &lt;- aggregate(foo, by=data.frame(foo[,1]), function(x,na.rm=T) rle(as.numeric(x))$values)\n</code></pre>\n\n<p>Gives me a list (as expected with rle) which I could then compute and try to get the expected output. But I'm sure there is a cleaner way to accomplish that... Any ideas ?</p>\n\n<p>Thanks for looking !</p>\n"},{"tags":["r","function","for-loop"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12959351,"title":"Making function with for loops in R","body":"<p>can you help me code this. Here's the equation below that I wish to have a function of it in R.</p>\n\n<p><img src=\"http://i.stack.imgur.com/I76w0.png\" alt=\"enter image description here\"></p>\n\n<p>Also, here's the two matrix where wij and zj(t) are taken from,</p>\n\n<p><img src=\"http://i.stack.imgur.com/FwW6b.png\" alt=\"enter image description here\"></p>\n\n<p>Hence, wij = w12 is equal to w1,2 in wmatrix. Similarly, zj(t) = z2(1) is equal to a2,1 in datamat matrix.</p>\n\n<p>Now, here's the for loop I made for this equation,</p>\n\n<pre><code>st.acf &lt;- function(datamat, wmatrix,timelag){\n          a = dim(datamat)[1]\n          b = dim(datamat)[2]\n          sumda &lt;- 0 \n          for(i in 1:a){\n              for(t in 1:b){\n                  for(j in 1:a){\n                     sumda &lt;- sumda + wmatrix[i,j]*datamat[j,t]\n                 }\n                 sumdaa &lt;- (sumda+wmatrix[i,j]*datamat[j,t])^2\n              }\n           }\n           print(sumdaa)\n}\n</code></pre>\n\n<p>This question is related to another question I asked <a href=\"http://stackoverflow.com/questions/12955413/making-function-for-the-equation-in-r\">here</a></p>\n\n<p>The equation above is a portion on the denominator of the linked question I mentioned.</p>\n\n<p>My problem here is that, I don't know what is the proper for loop for the equation, because if the above equation is expanded for N = 2, and T = 2, it would then become like this,</p>\n\n<p><img src=\"http://i.stack.imgur.com/ZatfE.png\" alt=\"enter image description here\"></p>\n\n<p>I should obtain a for loops that calculates the above expansion.</p>\n\n<p><strong>Edit: I used this code <code>sum((wmatrix%*%datamat)^2)</code> previously for this equation,</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/PcUM8.png\" alt=\"enter image description here\"></p>\n\n<p>But if this is expanded using N=2, and T=2, we have\n<img src=\"http://i.stack.imgur.com/EeBMe.png\" alt=\"enter image description here\"></p>\n\n<p>Which is different from the first expansion.\nAny help is appreciated! Thanks in advance!</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":69,"score":3,"question_id":12938867,"title":"Trying to calculate running team statistics in R - Calculate Avg Offensive yardage before this game as well as that of the opponent","body":"<p><strong>I've been asked to make the distinct problems more clear, so here they are at the top:</strong></p>\n\n<ul>\n<li>How to compute the rolling average for a team, excluding the current week</li>\n<li>How to add columns containing similar stats for the opponent team</li>\n</ul>\n\n<p><em>Here's the original text:</em></p>\n\n<p>I'm learning R to do some armchair analysis of sports.  Right now, I'm stuck on a problem where I have a list of every game played in an NFL season, and I'm trying to calculate what the AvgTotalYds of offense was in the weeks leading up to this game.  Eventually, I'd like to be able to do an average for the season-to-date, as well as a moving average of the past X periods.  </p>\n\n<p>Further complicating it is that I'd like to also get the same info for the opponent leading up to the week in question.  I've searched a lot for a similar problem, but couldn't find any solutions.</p>\n\n<p>Below is a sample of the data.  The database I was given has some unfortunate column names.  ScoreOff actually refers to the total points scored by the team in the TeamName field, whether they were offensive, defensive, or special teams plays.  *Def, likewise, refer to the Opponent.  Code examples are using a data frame labeled \"df2.\"</p>\n\n<pre><code>dput(head(df2))\n\nstructure(list(Date = structure(c(14126, 14126, 14129, 14129, \n14129, 14129), class = \"Date\"), TeamName = structure(c(21L, 32L, \n1L, 2L, 3L, 4L), .Label = c(\"Arizona Cardinals\", \"Atlanta Falcons\", \n\"Baltimore Ravens\", \"Buffalo Bills\", \"Carolina Panthers\", \"Chicago Bears\", \n\"Cincinnati Bengals\", \"Cleveland Browns\", \"Dallas Cowboys\", \"Denver Broncos\", \n\"Detroit Lions\", \"Green Bay Packers\", \"Houston Texans\", \"Indianapolis Colts\", \n\"Jacksonville Jaguars\", \"Kansas City Chiefs\", \"Miami Dolphins\", \n\"Minnesota Vikings\", \"New England Patriots\", \"New Orleans Saints\", \n\"New York Giants\", \"New York Jets\", \"Oakland Raiders\", \"Philadelphia Eagles\", \n\"Pittsburgh Steelers\", \"San Diego Chargers\", \"San Francisco 49ers\", \n\"Seattle Seahawks\", \"St Louis Rams\", \"Tampa Bay Buccaneers\", \n\"Tennessee Titans\", \"Washington Redskins\"), class = \"factor\"), \n    ScoreOff = c(16L, 7L, 23L, 34L, 17L, 34L), FirstDownOff = c(21L, \n    11L, 18L, 23L, 21L, 13L), ThirdDownPctOff = structure(c(34L, \n    14L, 20L, 21L, 35L, 16L), .Label = c(\"0%\", \"10%\", \"11%\", \n    \"12%\", \"13%\", \"14%\", \"15%\", \"17%\", \"18%\", \"19%\", \"20%\", \"21%\", \n    \"22%\", \"23%\", \"24%\", \"25%\", \"27%\", \"29%\", \"30%\", \"31%\", \"33%\", \n    \"35%\", \"36%\", \"37%\", \"38%\", \"40%\", \"41%\", \"42%\", \"43%\", \"44%\", \n    \"45%\", \"46%\", \"47%\", \"50%\", \"53%\", \"54%\", \"55%\", \"56%\", \"57%\", \n    \"58%\", \"59%\", \"60%\", \"61%\", \"62%\", \"63%\", \"64%\", \"65%\", \"67%\", \n    \"69%\", \"73%\", \"77%\", \"8%\", \"80%\", \"9%\", \"92%\"), class = \"factor\"), \n    RushAttOff = c(32L, 24L, 39L, 42L, 46L, 29L), RushYdsOff = c(154L, \n    84L, 109L, 318L, 229L, 106L), PassAttOff = c(35L, 27L, 30L, \n    13L, 29L, 31L), PassCompOff = c(19L, 15L, 19L, 9L, 15L, 20L\n    ), PassYdsOff = c(216L, 133L, 197L, 161L, 129L, 234L), PassIntOff = c(1L, \n    0L, 0L, 0L, 0L, 0L), FumblesOff = c(0L, 0L, 0L, 0L, 2L, 0L\n    ), SackYdsOff = c(16L, 8L, 21L, 5L, 0L, 2L), PenYdsOff = c(70L, \n    35L, 40L, 68L, 64L, 14L), TimePossOff = structure(c(348L, \n    52L, 368L, 175L, 354L, 239L), .Label = c(\"14:45\", \"18:15\", \n    \"18:27\", \"19:31\", \"19:56\", \"20:11\", \"20:12\", \"20:26\", \"20:48\", \n    \"21:03\", \"21:08\", \"21:16\", \"21:26\", \"21:28\", \"21:35\", \"21:44\", \n    \"21:45\", \"21:52\", \"21:54\", \"22:03\", \"22:08\", \"22:12\", \"22:16\", \n    \"22:25\", \"22:30\", \"22:31\", \"22:33\", \"22:34\", \"22:38\", \"22:39\", \n    \"22:53\", \"22:55\", \"22:59\", \"23:09\", \"23:10\", \"23:12\", \"23:15\", \n    \"23:23\", \"23:28\", \"23:30\", \"23:33\", \"23:37\", \"23:38\", \"23:42\", \n    \"23:43\", \"23:45\", \"23:48\", \"23:49\", \"23:56\", \"24:06\", \"24:13\", \n    \"24:17\", \"24:18\", \"24:21\", \"24:33\", \"24:34\", \"24:35\", \"24:41\", \n    \"24:43\", \"24:49\", \"24:50\", \"24:54\", \"24:58\", \"24:59\", \"25:01\", \n    \"25:02\", \"25:05\", \"25:11\", \"25:14\", \"25:16\", \"25:19\", \"25:25\", \n    \"25:29\", \"25:31\", \"25:32\", \"25:34\", \"25:36\", \"25:37\", \"25:38\", \n    \"25:40\", \"25:41\", \"25:46\", \"25:47\", \"25:53\", \"25:55\", \"25:57\", \n    \"25:58\", \"26:00\", \"26:04\", \"26:09\", \"26:10\", \"26:11\", \"26:12\", \n    \"26:13\", \"26:16\", \"26:20\", \"26:27\", \"26:32\", \"26:36\", \"26:37\", \n    \"26:38\", \"26:39\", \"26:40\", \"26:41\", \"26:44\", \"26:46\", \"26:49\", \n    \"26:53\", \"26:56\", \"26:59\", \"27:01\", \"27:04\", \"27:10\", \"27:12\", \n    \"27:13\", \"27:15\", \"27:18\", \"27:20\", \"27:24\", \"27:25\", \"27:26\", \n    \"27:27\", \"27:28\", \"27:30\", \"27:32\", \"27:37\", \"27:40\", \"27:44\", \n    \"27:46\", \"27:47\", \"27:48\", \"27:50\", \"27:51\", \"27:52\", \"27:53\", \n    \"27:55\", \"27:57\", \"27:58\", \"27:59\", \"28:00\", \"28:01\", \"28:03\", \n    \"28:05\", \"28:06\", \"28:07\", \"28:13\", \"28:14\", \"28:16\", \"28:17\", \n    \"28:18\", \"28:19\", \"28:21\", \"28:22\", \"28:24\", \"28:25\", \"28:28\", \n    \"28:29\", \"28:32\", \"28:38\", \"28:40\", \"28:41\", \"28:45\", \"28:47\", \n    \"28:49\", \"28:51\", \"28:53\", \"28:55\", \"28:57\", \"28:58\", \"28:59\", \n    \"29:00\", \"29:02\", \"29:04\", \"29:05\", \"29:07\", \"29:08\", \"29:11\", \n    \"29:13\", \"29:14\", \"29:18\", \"29:19\", \"29:20\", \"29:26\", \"29:27\", \n    \"29:29\", \"29:31\", \"29:32\", \"29:33\", \"29:34\", \"29:36\", \"29:37\", \n    \"29:38\", \"29:41\", \"29:42\", \"29:43\", \"29:49\", \"29:50\", \"29:55\", \n    \"29:56\", \"29:59\", \"30:01\", \"30:04\", \"30:05\", \"30:10\", \"30:11\", \n    \"30:17\", \"30:18\", \"30:19\", \"30:22\", \"30:23\", \"30:24\", \"30:26\", \n    \"30:27\", \"30:28\", \"30:29\", \"30:31\", \"30:33\", \"30:34\", \"30:40\", \n    \"30:41\", \"30:42\", \"30:46\", \"30:47\", \"30:49\", \"30:52\", \"30:53\", \n    \"30:55\", \"30:58\", \"31:00\", \"31:01\", \"31:02\", \"31:03\", \"31:05\", \n    \"31:07\", \"31:09\", \"31:11\", \"31:13\", \"31:15\", \"31:19\", \"31:20\", \n    \"31:22\", \"31:28\", \"31:31\", \"31:32\", \"31:35\", \"31:36\", \"31:38\", \n    \"31:39\", \"31:41\", \"31:42\", \"31:43\", \"31:44\", \"31:46\", \"31:47\", \n    \"31:53\", \"31:54\", \"31:55\", \"31:57\", \"31:59\", \"32:00\", \"32:01\", \n    \"32:02\", \"32:03\", \"32:05\", \"32:07\", \"32:08\", \"32:09\", \"32:10\", \n    \"32:12\", \"32:13\", \"32:14\", \"32:16\", \"32:20\", \"32:23\", \"32:28\", \n    \"32:30\", \"32:32\", \"32:33\", \"32:34\", \"32:35\", \"32:36\", \"32:40\", \n    \"32:42\", \"32:45\", \"32:47\", \"32:48\", \"32:50\", \"32:56\", \"32:59\", \n    \"33:01\", \"33:04\", \"33:07\", \"33:11\", \"33:14\", \"33:16\", \"33:19\", \n    \"33:20\", \"33:21\", \"33:22\", \"33:23\", \"33:24\", \"33:28\", \"33:33\", \n    \"33:40\", \"33:44\", \"33:47\", \"33:48\", \"33:49\", \"33:50\", \"33:51\", \n    \"33:56\", \"34:00\", \"34:02\", \"34:03\", \"34:05\", \"34:07\", \"34:13\", \n    \"34:14\", \"34:19\", \"34:20\", \"34:22\", \"34:23\", \"34:24\", \"34:26\", \n    \"34:28\", \"34:29\", \"34:31\", \"34:35\", \"34:41\", \"34:44\", \"34:46\", \n    \"34:49\", \"34:55\", \"34:58\", \"34:59\", \"35:01\", \"35:02\", \"35:06\", \n    \"35:10\", \"35:11\", \"35:17\", \"35:19\", \"35:25\", \"35:26\", \"35:27\", \n    \"35:39\", \"35:42\", \"35:43\", \"35:47\", \"35:54\", \"36:04\", \"36:11\", \n    \"36:12\", \"36:15\", \"36:17\", \"36:18\", \"36:22\", \"36:23\", \"36:27\", \n    \"36:30\", \"36:32\", \"36:37\", \"36:45\", \"36:48\", \"36:50\", \"36:51\", \n    \"37:01\", \"37:05\", \"37:07\", \"37:21\", \"37:22\", \"37:26\", \"37:27\", \n    \"37:29\", \"37:30\", \"37:35\", \"37:42\", \"37:44\", \"37:48\", \"37:52\", \n    \"37:57\", \"38:08\", \"38:15\", \"38:16\", \"38:23\", \"38:25\", \"38:32\", \n    \"38:34\", \"38:44\", \"38:52\", \"38:57\", \"39:12\", \"39:34\", \"39:48\", \n    \"39:49\", \"40:04\", \"40:29\", \"41:33\", \"41:45\", \"45:15\"), class = \"factor\"), \n    PuntAvgOff = c(36.3, 37.9, 45, 38.3, 48.2, 46.6), Opponent = structure(c(32L, \n    21L, 27L, 11L, 7L, 28L), .Label = c(\"Arizona Cardinals\", \n    \"Atlanta Falcons\", \"Baltimore Ravens\", \"Buffalo Bills\", \"Carolina Panthers\", \n    \"Chicago Bears\", \"Cincinnati Bengals\", \"Cleveland Browns\", \n    \"Dallas Cowboys\", \"Denver Broncos\", \"Detroit Lions\", \"Green Bay Packers\", \n    \"Houston Texans\", \"Indianapolis Colts\", \"Jacksonville Jaguars\", \n    \"Kansas City Chiefs\", \"Miami Dolphins\", \"Minnesota Vikings\", \n    \"New England Patriots\", \"New Orleans Saints\", \"New York Giants\", \n    \"New York Jets\", \"Oakland Raiders\", \"Philadelphia Eagles\", \n    \"Pittsburgh Steelers\", \"San Diego Chargers\", \"San Francisco 49ers\", \n    \"Seattle Seahawks\", \"St Louis Rams\", \"Tampa Bay Buccaneers\", \n    \"Tennessee Titans\", \"Washington Redskins\"), class = \"factor\"), \n    ScoreDef = c(7L, 16L, 13L, 21L, 10L, 10L), FirstDownDef = c(11L, \n    21L, 13L, 21L, 8L, 16L), ThirdDownPctDef = structure(c(14L, \n    34L, 25L, 13L, 7L, 10L), .Label = c(\"0%\", \"10%\", \"11%\", \"12%\", \n    \"13%\", \"14%\", \"15%\", \"17%\", \"18%\", \"19%\", \"20%\", \"21%\", \"22%\", \n    \"23%\", \"24%\", \"25%\", \"27%\", \"29%\", \"30%\", \"31%\", \"33%\", \"35%\", \n    \"36%\", \"37%\", \"38%\", \"40%\", \"41%\", \"42%\", \"43%\", \"44%\", \"45%\", \n    \"46%\", \"47%\", \"50%\", \"53%\", \"54%\", \"55%\", \"56%\", \"57%\", \"58%\", \n    \"59%\", \"60%\", \"61%\", \"62%\", \"63%\", \"64%\", \"65%\", \"67%\", \"69%\", \n    \"73%\", \"77%\", \"8%\", \"80%\", \"9%\", \"92%\"), class = \"factor\"), \n    RushAttDef = c(24L, 32L, 20L, 21L, 23L, 21L), RushYdsDef = c(84L, \n    154L, 108L, 62L, 65L, 85L), PassAttDef = c(27L, 35L, 20L, \n    33L, 25L, 41L), PassCompDef = c(15L, 19L, 14L, 24L, 10L, \n    17L), PassYdsDef = c(133L, 216L, 195L, 262L, 99L, 190L), \n    PassIntDef = c(0L, 1L, 1L, 1L, 1L, 1L), FumblesDef = c(0L, \n    0L, 4L, 0L, 1L, 1L), SackYdsDef = c(8L, 16L, 12L, 16L, 10L, \n    23L), PenYdsDef = c(35L, 70L, 20L, 30L, 40L, 30L), TimePossDef = structure(c(52L, \n    348L, 32L, 225L, 46L, 161L), .Label = c(\"14:45\", \"18:15\", \n    \"18:27\", \"19:31\", \"19:56\", \"20:11\", \"20:12\", \"20:26\", \"20:48\", \n    \"21:03\", \"21:08\", \"21:16\", \"21:26\", \"21:28\", \"21:35\", \"21:44\", \n    \"21:45\", \"21:52\", \"21:54\", \"22:03\", \"22:08\", \"22:12\", \"22:16\", \n    \"22:25\", \"22:30\", \"22:31\", \"22:33\", \"22:34\", \"22:38\", \"22:39\", \n    \"22:53\", \"22:55\", \"22:59\", \"23:09\", \"23:10\", \"23:12\", \"23:15\", \n    \"23:23\", \"23:28\", \"23:30\", \"23:33\", \"23:37\", \"23:38\", \"23:42\", \n    \"23:43\", \"23:45\", \"23:48\", \"23:49\", \"23:56\", \"24:06\", \"24:13\", \n    \"24:17\", \"24:18\", \"24:21\", \"24:33\", \"24:34\", \"24:35\", \"24:41\", \n    \"24:43\", \"24:49\", \"24:50\", \"24:54\", \"24:58\", \"24:59\", \"25:01\", \n    \"25:02\", \"25:05\", \"25:11\", \"25:14\", \"25:16\", \"25:19\", \"25:25\", \n    \"25:29\", \"25:31\", \"25:32\", \"25:34\", \"25:36\", \"25:37\", \"25:38\", \n    \"25:40\", \"25:41\", \"25:46\", \"25:47\", \"25:53\", \"25:55\", \"25:57\", \n    \"25:58\", \"26:00\", \"26:04\", \"26:09\", \"26:10\", \"26:11\", \"26:12\", \n    \"26:13\", \"26:16\", \"26:20\", \"26:27\", \"26:32\", \"26:36\", \"26:37\", \n    \"26:38\", \"26:39\", \"26:40\", \"26:41\", \"26:44\", \"26:46\", \"26:49\", \n    \"26:53\", \"26:56\", \"26:59\", \"27:01\", \"27:04\", \"27:10\", \"27:12\", \n    \"27:13\", \"27:15\", \"27:18\", \"27:20\", \"27:24\", \"27:25\", \"27:26\", \n    \"27:27\", \"27:28\", \"27:30\", \"27:32\", \"27:37\", \"27:40\", \"27:44\", \n    \"27:46\", \"27:47\", \"27:48\", \"27:50\", \"27:51\", \"27:52\", \"27:53\", \n    \"27:55\", \"27:57\", \"27:58\", \"27:59\", \"28:00\", \"28:01\", \"28:03\", \n    \"28:05\", \"28:06\", \"28:07\", \"28:13\", \"28:14\", \"28:16\", \"28:17\", \n    \"28:18\", \"28:19\", \"28:21\", \"28:22\", \"28:24\", \"28:25\", \"28:28\", \n    \"28:29\", \"28:32\", \"28:38\", \"28:40\", \"28:41\", \"28:45\", \"28:47\", \n    \"28:49\", \"28:51\", \"28:53\", \"28:55\", \"28:57\", \"28:58\", \"28:59\", \n    \"29:00\", \"29:02\", \"29:05\", \"29:07\", \"29:08\", \"29:11\", \"29:13\", \n    \"29:14\", \"29:18\", \"29:19\", \"29:20\", \"29:26\", \"29:27\", \"29:29\", \n    \"29:31\", \"29:32\", \"29:33\", \"29:34\", \"29:36\", \"29:37\", \"29:38\", \n    \"29:41\", \"29:42\", \"29:43\", \"29:49\", \"29:50\", \"29:55\", \"29:56\", \n    \"29:59\", \"30:01\", \"30:04\", \"30:05\", \"30:10\", \"30:11\", \"30:17\", \n    \"30:18\", \"30:19\", \"30:22\", \"30:23\", \"30:24\", \"30:26\", \"30:27\", \n    \"30:28\", \"30:29\", \"30:31\", \"30:33\", \"30:34\", \"30:40\", \"30:41\", \n    \"30:42\", \"30:46\", \"30:47\", \"30:49\", \"30:52\", \"30:53\", \"30:55\", \n    \"30:56\", \"30:58\", \"31:00\", \"31:01\", \"31:02\", \"31:03\", \"31:05\", \n    \"31:07\", \"31:09\", \"31:11\", \"31:13\", \"31:15\", \"31:19\", \"31:20\", \n    \"31:22\", \"31:28\", \"31:31\", \"31:32\", \"31:35\", \"31:36\", \"31:38\", \n    \"31:39\", \"31:41\", \"31:42\", \"31:43\", \"31:44\", \"31:46\", \"31:47\", \n    \"31:53\", \"31:54\", \"31:55\", \"31:57\", \"31:59\", \"32:00\", \"32:01\", \n    \"32:02\", \"32:03\", \"32:05\", \"32:07\", \"32:08\", \"32:09\", \"32:10\", \n    \"32:12\", \"32:13\", \"32:14\", \"32:16\", \"32:20\", \"32:23\", \"32:28\", \n    \"32:30\", \"32:32\", \"32:33\", \"32:34\", \"32:35\", \"32:36\", \"32:40\", \n    \"32:42\", \"32:45\", \"32:47\", \"32:48\", \"32:50\", \"32:56\", \"32:59\", \n    \"33:01\", \"33:04\", \"33:07\", \"33:11\", \"33:14\", \"33:16\", \"33:19\", \n    \"33:20\", \"33:21\", \"33:22\", \"33:23\", \"33:24\", \"33:28\", \"33:33\", \n    \"33:40\", \"33:44\", \"33:47\", \"33:48\", \"33:49\", \"33:50\", \"33:51\", \n    \"33:56\", \"34:00\", \"34:02\", \"34:03\", \"34:05\", \"34:07\", \"34:13\", \n    \"34:14\", \"34:19\", \"34:20\", \"34:22\", \"34:23\", \"34:24\", \"34:26\", \n    \"34:28\", \"34:29\", \"34:31\", \"34:35\", \"34:41\", \"34:44\", \"34:46\", \n    \"34:49\", \"34:55\", \"34:58\", \"34:59\", \"35:01\", \"35:02\", \"35:06\", \n    \"35:10\", \"35:11\", \"35:17\", \"35:19\", \"35:25\", \"35:26\", \"35:27\", \n    \"35:39\", \"35:42\", \"35:43\", \"35:47\", \"35:54\", \"36:04\", \"36:11\", \n    \"36:12\", \"36:15\", \"36:17\", \"36:18\", \"36:22\", \"36:23\", \"36:27\", \n    \"36:30\", \"36:32\", \"36:37\", \"36:45\", \"36:48\", \"36:50\", \"36:51\", \n    \"37:01\", \"37:05\", \"37:07\", \"37:21\", \"37:22\", \"37:26\", \"37:27\", \n    \"37:29\", \"37:30\", \"37:35\", \"37:42\", \"37:44\", \"37:48\", \"37:52\", \n    \"37:57\", \"38:08\", \"38:15\", \"38:16\", \"38:23\", \"38:25\", \"38:32\", \n    \"38:34\", \"38:44\", \"38:52\", \"38:57\", \"39:12\", \"39:34\", \"39:48\", \n    \"39:49\", \"40:04\", \"40:29\", \"41:33\", \"41:45\", \"45:15\"), class = \"factor\"), \n    Site = structure(c(1L, 3L, 3L, 1L, 1L, 1L), .Label = c(\"H\", \n    \"N\", \"V\"), class = \"factor\"), Line = c(4.5, -4.5, 2.5, -3, \n    -2, 1), Totalline = c(41.5, 41.5, 42, 41, 37.5, 38.5), TotalYdsOff = c(370L, \n    217L, 306L, 479L, 358L, 340L), TotalYdsDef = c(217L, 370L, \n    303L, 324L, 164L, 275L), ActualLine = c(-9L, 9L, -10L, -13L, \n    -7L, -24L)), .Names = c(\"Date\", \"TeamName\", \"ScoreOff\", \"FirstDownOff\", \n\"ThirdDownPctOff\", \"RushAttOff\", \"RushYdsOff\", \"PassAttOff\", \n\"PassCompOff\", \"PassYdsOff\", \"PassIntOff\", \"FumblesOff\", \"SackYdsOff\", \n\"PenYdsOff\", \"TimePossOff\", \"PuntAvgOff\", \"Opponent\", \"ScoreDef\", \n\"FirstDownDef\", \"ThirdDownPctDef\", \"RushAttDef\", \"RushYdsDef\", \n\"PassAttDef\", \"PassCompDef\", \"PassYdsDef\", \"PassIntDef\", \"FumblesDef\", \n\"SackYdsDef\", \"PenYdsDef\", \"TimePossDef\", \"Site\", \"Line\", \"Totalline\", \n\"TotalYdsOff\", \"TotalYdsDef\", \"ActualLine\"), row.names = c(NA, \n6L), class = \"data.frame\")\n</code></pre>\n\n<p>I added the TotalYds[Off|Def] columns as that was trivial to do.  The closest thing to the properly calculating a moving average was accomplished with the zoo and plyr libraries, and the following command:</p>\n\n<pre><code>ddply(df2, .(TeamName), summarise, rollmean(TotalYdsOff, k=4, fill=0, align=\"right\"))\n</code></pre>\n\n<p>Which <em>almost</em> does what I want, except that it will use the information for the current week in the average.  </p>\n\n<p>As far as getting the matching information for the opponent, I was thinking there'd be a way to pull out the same data from the row where \"TeamName\" and \"Date\" both match to the current row's \"Opponent\" and \"Date.\"  This is because the database has two entries on a given game, one for the home team and one for the away (and *Off and *Def are swapped).  Look at lines 1 and 2 in the example data, specifically Date, TeamName, and Opponent and you'll understand what I'm trying to say.  </p>\n\n<p>Any guidance here?  I imagine this is relatively trivial for someone with more than a few days tinkering in R, who would know of some function or library that does this.  I, however, am only a few days in, and thus am having some trouble.  </p>\n"},{"tags":["r","map","colors","zipcode"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12950713,"title":"choropleth of states with zips of counties?","body":"<p>I'm trying to make choropleth map with a bunch of different codes. my problem is that I have longitude, latitude and zipcode. So many zipcodes combine to 1 state.\nWhat I want to show is how often is a state present in my data. e.g I have 10 customers so every customer is 1 row. and the 10 customers spread in the states. but 2 customers have the same zipcode  and a third one has a different zipcode but the state is the same as customer 1 and 2 have. so therefore I used this formula to count the number of customers in 1 state</p>\n\n<pre><code>    result&lt;- ddply(df, .(state), transform, count2 = count(state))\n</code></pre>\n\n<p>my data looks like this after applying the code(before it's just been the first 3 columns):</p>\n\n<pre><code>    state   longitude   latitude    count2.x    count2.freq\n1   AK  -149.87828  61.21680        AK           67\n2   AK  -149.87828  61.21680        AK           67\n3   AK  -131.67620  55.36864        AK           67\n4   AL  -85.92669   32.90343        AL           1582\n5   AL  -85.92669   32.90343        AL           1582\n</code></pre>\n\n<p>now I want to colour the numbers in count2.freq the darker the higher the number is.\ntherefore I tried out this different ways</p>\n\n<pre><code>    count&lt;-c(unique$count2.freq)\n&gt; unique$count2freq &lt;- as.numeric(count)\n&gt; col = rainbow(length(levels(unique$count2freq)))\n&gt; spplot(unique, \"count2.freq\", col.regions=col, main=\"count of states\")\n\n    select&lt;- result[(result$count2.freq),]\n&gt; Map&lt;- data.frame(select$longitude, select$latitude, select$count2.freq)\n&gt; names(Map)&lt;- c(\"longitude\", \"latitude\", \"count\")\n&gt; Geo=gvisGeoMap(Map, locationvar=c(\"longitude\",\"latitude\"), numvar=\"count\", options=list(height=350, dataMode='regions'))\n\n    colors=c(\"#F1EEF6\", \"#D4B9DA\", \"#C994C7\", \"#DF65B0\", \"#DD1C77\", \"#980043\")\n&gt;count$colorBuckets&lt;- as.numeric(cut(result$count2, c(round(seq(from=0, to=21023, length=8), digits=0))))\n&gt;colorsmatch&lt;- count$colorBuckets[match(zipcode$state, result$state)]\n&gt;map(\"county\", col=colors[colorsmatched], fill=TRUE, resolution=0, lty=0, projection=\"polyconic\")\n&gt;map(\"state\", col=\"white\", fill=FALSE, add=TRUE, lty=1, lwd=0.2, projection=\"polyconic\")\n</code></pre>\n\n<p>but none of them works the way I wanted or lets say I didn't even get a map out of there.\nAny suggestions?I hope you could understand what I'm trying to do</p>\n\n<p>UPDATE</p>\n\n<p>ok so I'm starting from the beginning my dataset is </p>\n\n<pre><code>   zip_code churn   plan_chosen total_minute_qty_sum    bill_month2\n1   605     0           1              10                 01.01.2002\n2   605     1           1              98                 01.01.2003\n3   612     0           1              8                  01.01.2002\n4   623     0           1              3                  01.01.2002\n5   32806   0          1              409                 01.12.2002 \n6   32806   0          1              324                 01.01.2003\n7   68124   0          1              118                 01.09.2002\n8   86413   0          1              148                 01.03.2002\n9   99901   0          1              123                 01.05.2003\n</code></pre>\n\n<p>since as you can see there are no zipcodes or anything that I could map I'm merging this dataset with the dataset of the zipcode package</p>\n\n<pre><code>merge1&lt;-merge(zipcode, stack, by.x='zip', by.y='zip_code', all.y=TRUE)\n</code></pre>\n\n<p>what I get is this </p>\n\n<pre><code>zip city    state   latitude    longitude   churn   plan_chosen total_minute_qty_sum    bill_month2\n</code></pre>\n\n<p>the six hundreds dropping out. that I use the plyr package and this code to count the number of states available in my data</p>\n\n<pre><code>result&lt;- ddply(merge1, .(state), transform, count2 = count(state))\n</code></pre>\n\n<p>than my data looks like this</p>\n\n<pre><code>     zip    city    state     latitude  longitude   churn   plan_chosen total_minute_qty_sum    bill_month2 count2.x    count2.freq\n1   99901   Ketchikan     AK    55.36864    -131.67620  0      1        123                     01.05.2003        AK    1\n2   86413   Golden Valley AZ    35.19090    -114.24036  0      1        148                     01.03.2002        AZ    1\n3   32806   Orlando      FL     28.51483    -81.36054   0      1        409                     01.12.2002        FL    2\n</code></pre>\n\n<p>I've just cut out a few data, but thats actually the dataset I want to map. In my bigger dataset I tried to drop the duplicates because I just wanted to colour the state 1 time. So my problem is now to tell R that I want different colour for different number s of count2.freq eventhough I don't know in what range it's gonna be I want R to split my data into different intervals and colour them different.  in the last of my examples above I already get stuck on the line</p>\n\n<pre><code>&gt;count$colorBuckets&lt;- as.numeric(cut(result$count2.freq, c(round(seq(from=0, to=21023, length=8), digits=0))))\n</code></pre>\n\n<p>there a warning comes up telling me it turn the left side into a list.\nI hope I could provide some information that is useful for you, so that you can help me out and understand.\nthanks for helping</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":12946070,"title":"assign a value, if a number is in between two numbers","body":"<p>Im trying to assign the value of -1, to every number in my vector that is inbetween 2 and 5.\nI thought an if - then statement would work. I am having some trouble. I dont think (2\n\n<pre><code>x &lt;- c(3.2,6,7.8,1,3,2.5)\nif (2&lt;x&lt;5){\n    cat(-1)\n} else {\n    cat (x)\n}\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":12958335,"title":"Compare two character vectors matching names","body":"<p>I have two character vectors with the different set of names and values:</p>\n\n<pre><code>x &lt;- c(\"a\", \"b\", \"c\", \"d\", \"e\")\nnames(x) &lt;- c(\"foo\", \"bar\", \"baz\", \"qux\", \"grault\")\n\ny &lt;- c(\"c\", \"a\", \"d\", \"b\")\nnames(y) &lt;- c(\"bar\", \"foo\", \"qux\", \"corge\")\n</code></pre>\n\n<p>Is there a way to compare <code>x</code> and <code>y</code> so that we know their values corresponding to the name <code>bar</code> are different because here <code>x.bar = \"b\"</code> and <code>y.bar = \"c\"</code>? Please note the names are not ordered. I tried <code>setdiff</code> and <code>which(x != y)</code> but neither one gives me the correct answer. Thanks!</p>\n"},{"tags":["r","loops"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":129,"score":1,"question_id":12953781,"title":"Faster solution to looped grouped RLE calculation","body":"<p>I have a <a href=\"http://stackoverflow.com/q/12892985/429846\">working solution</a> to my problem, but I will not be able to use it because it is so slow (my calculations predict that the whole simulation will take 2-3 years!). Thus I am looking for a better (faster) solution. This is (in essence) the code I am working with:</p>\n\n<pre><code>N=4\nx &lt;-NULL\nfor (i in 1:N) { #first loop\n  v &lt;-sample(0:1, 1000000, 1/2) #generate data\n  v &lt;-as.data.frame(v) #convert to dataframe\n  v$t &lt;-rep(1:2, each=250) #group\n  v$p &lt;-rep(1:2000, each=500) #p.number\n  # second loop\n  for (j in 1:2000) { #second loop\n    #count rle for group 1 for each pnumber\n    x &lt;- rbind(x, table(rle(v$v[v$t==1&amp;v$p==j])))\n    #count rle for group 2 for each pnumber\n    x &lt;- rbind(x, table(rle(v$v[v$t==2&amp;v$p==j])))\n  } #end second loop\n} #end first loop\n#total rle counts for both group 1 &amp; 2\ny &lt;-aggregate(x, list(as.numeric(rownames(x))), sum)\n</code></pre>\n\n<p>In words: The code generates a coin-flip simulation (<code>v</code>). A group factor is generated (1 &amp; 2). A p.number factor is generated (1:2000). The run lengths are recorded for each p.number (1:2000) for both groups 1 &amp; group 2 (each p.number has runs in both groups). After <code>N</code> loops (the first loop), the total run lengths are presented as a table (aggregate) (that is, the run lengths for each group, for each p.number, over <code>N</code> loops as a total).</p>\n\n<p>I need the first loop because the data that I am working with comes in individual files (so I'm loading the file, calculating various statistics etc and then loading the next file and doing the same). I am much less attached to the second loop, but can't figure out how to replace it with something faster.</p>\n\n<p>What can be done to the second loop to make it (hopefully, a lot) faster?</p>\n"},{"tags":["r","date","lubridate"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":140,"score":6,"question_id":12323693,"title":"Is there a more elegant way to convert two-digit years to four-digit years with lubridate?","body":"<p>If a date vector has two-digit years, <code>mdy()</code> turns years between 00 and 68 into 21st Century years and years between 69 and 99 into 20th Century years. For example:</p>\n\n<pre><code>library(lubridate)    \nmdy(c(\"1/2/54\",\"1/2/68\",\"1/2/69\",\"1/2/99\",\"1/2/04\"))\n</code></pre>\n\n<p>gives the following output:</p>\n\n<pre><code>Multiple format matches with 5 successes: %m/%d/%y, %m/%d/%Y.\nUsing date format %m/%d/%y.\n[1] \"2054-01-02 UTC\" \"2068-01-02 UTC\" \"1969-01-02 UTC\" \"1999-01-02 UTC\" \"2004-01-02 UTC\"\n</code></pre>\n\n<p>I can fix this after the fact by subtracting 100 from the incorrect dates to turn 2054 and 2068 into 1954 and 1968. But is there a more elegant and less error-prone method of parsing two-digit dates so that they get handled correctly in the parsing process itself?</p>\n\n<p><strong>Update:</strong> After @JoshuaUlrich pointed me to <code>strptime</code> I found <a href=\"http://stackoverflow.com/questions/9508747/r-adding-century-to-year\">this question</a>, which deals with an issue similar to mine, but using base R. </p>\n\n<p>It seems like a nice addition to date handling in R would be some way to handle century selection cutoffs for two-digit dates within the date parsing functions. </p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":11476849,"title":"creating ggplot stack bar and trend line","body":"<p>I am working with data frame called <code>df</code>:</p>\n\n<pre><code>    Date    variable   Value\n    1/1/2012 teamA     10\n    1/1/2012 teamA     10\n\n\n    1/1/2012 teamB    10\n\n    1/1/2012 teamC     15\n\n    1/2/2012 teamA    25\n\n    1/2/2012 teamB     30\n\n    1/2/2012 teamC     20\n</code></pre>\n\n<p>And a second data frame called <code>total</code></p>\n\n<pre><code>     Date      Total\n    1/1/2012   50\n    1/2/2012   70\n</code></pre>\n\n<p>I am trying to create a ggplot stack var and draw a trend line for the total on the same graph like this:</p>\n\n<pre><code>ggplot(df,aes(x=Date, y=Value, fill=(variable))) +\n       geom_bar(stat=\"identity\") + \n       theme_bw() + \n       opts(title = \"Team Performance\") + \n       xlab(\"Date\") + ylab(\"Score\") + \n       geom_smooth(data=Total,\n                   aes(Date,Total,group=1), \n                   method=\"lm\", size=2, color=\"darkblue\")\n</code></pre>\n\n<p>I get this error:  </p>\n\n<pre><code>Error in eval(expr, envir, enclos) : object 'variable' not found\n</code></pre>\n\n<p>When I do this by itself:</p>\n\n<pre><code>ggplot(df,aes(x=Date, y=Value, fill=(variable))) +  \ngeom_bar(stat=\"identity\") + theme_bw() \n</code></pre>\n\n<p>it works</p>\n\n<p><code>variable</code> object is definitely there, any ideas, what I am doing wrong here?</p>\n"},{"tags":["r","list","date","data.frame","match"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":12947592,"title":"Percent calculation with matching dates over a list-data frame class","body":"<p>I have my list <code>MF</code> wich contains <code>105</code> lists. Every list, <code>MF[[1]] MF[[2]]</code> .... <code>MF[[105]]</code> contains different number of data frames. Thus, <code>MF[[1]][[1]]</code> exists but <code>MF[[1]][[2]]</code> is <code>NULL</code> because there is just one data frame for <code>MF[[1]]</code>. In the other hand <code>MF[[2]]</code> contains 15 different data frames, so <code>MF[[2]][[1]]</code> to <code>MF[[2]][[15]]</code> exists.</p>\n\n<p>The <code>colnames</code> of all the data frames in every 105 list is:</p>\n\n<pre><code>[1] \"Run\"             \"Fecha\"           \"Serie\"           \"Patrimonio\"      \"Ret Log Pat\"     \"Percentil 5%\"    \"Percentil Monto\"\n</code></pre>\n\n<p>I'm gonna ask my question with a concrete example. Let's use MF[[2]] wich contains 15 different data frames. Here are some headers of those data frames:</p>\n\n<pre><code>head(MF[[2]][[1]]):\n Run      Fecha Serie Patrimonio  Ret Log Pat Percentil 5% Percentil Monto\n31 8011 2002-08-18     1 4191689227 -0.456258862   -0.1973659      1305605031\n32 8011 2002-08-19     1 4749171865  0.124866449   -0.2179453       913558775\n33 8011 2002-08-20     1 5132656241  0.077653052   -0.2179453      1035059470\n34 8011 2002-08-21     1 5088469783 -0.008646158   -0.2179453      1118638070\n35 8011 2002-08-22     1 4998945148 -0.017750234   -0.2179453      1109007841\n36 8011 2002-08-23     1 5449454077  0.086288515   -0.2179453      1089496372\n\nhead(MF[[2]][[2]])\n    Run      Fecha Serie Patrimonio   Ret Log Pat Percentil 5% Percentil Monto\n31 8011 2006-05-09   100 6413583009 -0.0076314490  -0.07046562       455399234\n32 8011 2006-05-10   100 6412446421 -0.0001772315  -0.07046562       451937105\n33 8011 2006-05-11   100 6380254435 -0.0050328784  -0.07046562       451857014\n34 8011 2006-05-12   100 6381112038  0.0001344061  -0.07046562       449588586\n35 8011 2006-05-13   100 6381970402  0.0001345073  -0.07046562       449649018\n36 8011 2006-05-14   100 6315827940 -0.0104180360  -0.07046562       449709503\n\nhead(MF[[2]][[3]])\n    Run      Fecha Serie Patrimonio   Ret Log Pat Percentil 5% Percentil Monto\n31 8011 2002-08-18     2 3147993667 -0.0395416467  -0.03216529       105340167\n32 8011 2002-08-19     2 3065335420 -0.0266083198  -0.03778848       118957901\n33 8011 2002-08-20     2 3044946268 -0.0066737439  -0.03778848       115834372\n34 8011 2002-08-21     2 3089802537  0.0146239300  -0.03778848       115063897\n35 8011 2002-08-22     2 3090714960  0.0002952578  -0.03778848       116758947\n36 8011 2002-08-23     2 3230667973  0.0442864759  -0.03778848       116793426\n</code></pre>\n\n<p>What I want is an iteration or whatever, that matches the column <code>\"Fecha\"</code> ( which means <code>\"Date\"</code>  by the way), and if the Date matches, calculates the percent which represent each row of the column <code>\"Patrimonio\"</code> over the total sum of <code>\"Patrimonio\"</code> in which date matches.</p>\n\n<p>Example given:</p>\n\n<p>In this case we got:</p>\n\n<pre><code>head(MF[[2]][[1]]):\n     Run      Fecha Serie Patrimonio  Ret Log Pat Percentil 5% Percentil Monto\n    31 8011 2002-08-18     1 4191689227 -0.456258862   -0.1973659      1305605031\n\n head(MF[[2]][[3]])\n        Run      Fecha Serie Patrimonio   Ret Log Pat Percentil 5% Percentil Monto\n    31 8011 2002-08-18     2 3147993667 -0.0395416467  -0.03216529       105340167\n</code></pre>\n\n<p>So, <code>MF[[2]][[1]][1,2]==MF[[2]][[3]][1,2]</code> ( Dates matches ), then I want a new column over each data frame like this:</p>\n\n<pre><code>  New column for MF[[2]][[1]] = MF[[2]][[1]][1,4]/(MF[[2]][[1]][1,4]+MF[[2]][[3]][1,4]) =  4191689227/( 4191689227+ 3147993667) ( Percent Calculation over \"Patrimonio\" column )\n\n New column for MF[[2]][[3]] = MF[[2]][[3]][1,4]/(MF[[2]][[1]][1,4]+MF[[2]][[3]][1,4]) =  3147993667/( 4191689227+ 3147993667) ( Percent Calculation over \"Patrimonio\" column )\n</code></pre>\n\n<p>The thing is that I must match all the 15 data frames to calculate the <code>\"Patrimonio\"</code> percent by the variable <code>\"Fecha\"</code> and so on for all the 105 lists. Hope my doubt is clear enough.</p>\n"},{"tags":["r","data.table"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":102,"score":1,"question_id":12630521,"title":"Grouping a many-to-many relationship from a two-column map","body":"<p>I have a SQL table that maps, say, authors and books. I would like to group linked authors and books (books written by the same author, and authors who co-wrote a book) together and ascertain how big these groups get. For example, if J.K. Rowling co-wrote with Junot Diaz, and Junot Diaz co-wrote a book with Zadie Smith, then I would want all three authors in the same group.</p>\n\n<p>Here's a toy data set (h/t Matthew Dowle) with some of the relationships I am talking about:</p>\n\n<pre><code>set.seed(1)\nauthors &lt;- replicate(100,sample(1:3,1))\nbook_id &lt;- rep(1:100,times=authors)\nauthor_id &lt;- c(lapply(authors,sample,x=1:100,replace=FALSE),recursive=TRUE)\naubk &lt;- data.table(author_id = author_id,book_id = book_id)\naubk[order(book_id,author_id),]\n</code></pre>\n\n<p>Here one sees that authors 27 and 36 co-wrote book 2, so they should be in the same group. The same for authors 63 and 100 for 3; and D, F and L for 4. And so on.</p>\n\n<p>I can't think of a good way to do this other than a for-loop, which (as you can guess) is slow. I tried a bit of <code>data.table</code> to avoid unnecessary copying. Is there a better way of doing it?</p>\n\n<pre><code>aubk$group &lt;- integer(dim(aubk)[1])\nlibrary(data.table)\naubk &lt;- data.table(aubk)\n#system.time({\nfor (x in 1:dim(aubk)[1]) {\n    if(identical(x,1)) {\n        value &lt;- 1L\n    } else {\n        sb &lt;- aubk[1:(x-1),]\n        index &lt;- match(aubk[x,author_id],sb[,author_id])\n        if (identical(index,NA_integer_)) {\n            index &lt;- match(aubk[x,book_id],sb[,book_id])\n            if (identical(index,NA_integer_)) {\n                value &lt;- x\n            } else {\n                value &lt;- aubk[index,group]\n            }\n        } else {\n            value &lt;- aubk[index,group]\n        }\n    }\n    aubk[x,group:=value]\n}\n#})\n</code></pre>\n\n<p><strong>EDIT:</strong> As mentioned by @Josh O'Brien and @thelatemail, my problem can also be worded as looking for the connected components of a graph from a two-column list where every edge is a row, and the two columns are the nodes connected.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":56,"score":-1,"question_id":12898566,"title":"subseting data set based on date calculations","body":"<p>I have this data frame. I would like to create another data frame from this which will include Trade_Date, Trades and Rejected. The rejected field needs to have the values from Closing_Date which will have to meet this criteria - Trade_Date + 1 day.</p>\n\n<p>x</p>\n\n<pre><code>Trade_Date   Trades   Closing_Date   Rejected\n9/16/2011   4126528     9/16/2011   15\n9/19/2011   2565282     9/17/2011   33\n9/20/2011   2953963     9/20/2011   30\n9/21/2011   3255800     9/21/2011   6\n9/22/2011   2862185     9/22/2011   21\n9/23/2011   2405590     9/23/2011   30\n9/26/2011   3196284     9/24/2011   30\n9/27/2011   3761367     9/27/2011   15\n9/28/2011   3198177     9/28/2011   9\n9/29/2011   3255345     9/29/2011   6\n9/30/2011   3810356     9/30/2011   12\n10/3/2011   3817093     10/1/2011   21\n</code></pre>\n\n<p>for example, my next df will need to be like this:</p>\n\n<pre><code>Trade_Date      Trades    Rejected\n9/16/2011       4126528   33\n9/19/2011       2565282   30\n9/20/2011       2953963   6\n</code></pre>\n\n<p>etc</p>\n\n<p>Since there are many many rows, I need to do this programatically. Can any help?</p>\n"},{"tags":["python","r","matplotlib"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":259,"score":3,"question_id":2682144,"title":"matplotlib analog of R's `pairs`","body":"<p>R has a useful function <code>pairs</code> that provides nice matrix of plots of pairwise connections between variables in a data set. The resulting plot looks similar to the following figure, copied from <a href=\"http://statisticsr.blogspot.com/2009/12/r-pairs-plot.html\" rel=\"nofollow\">this blog post</a>:</p>\n\n<p><img src=\"http://2.bp.blogspot.com/_xLDEmoNB_RM/SzRINMDPNbI/AAAAAAAAFDc/N5gUwj7JHWA/s640/screenshot_001.png\" alt=\"pairs\"></p>\n\n<p>Is there any ready to use function based on python's matplolib? I have searched its <a href=\"http://matplotlib.sourceforge.net/gallery.html\" rel=\"nofollow\">gallery</a>, but couldn't find anything that resembles what I need.  Technically, this should be a simple task, but proper handling of all the possible cases, labels, titles, etc is very tedious.</p>\n\n<p><strong>UPDATE</strong> see below my answer with a quick and dirty approximation.</p>\n"},{"tags":["r","genetic-algorithm","genetic-programming"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":201,"score":0,"question_id":10674115,"title":"R: Find function minimum with genetic programming","body":"<p>I am currently using <a href=\"https://rsymbolic.org/projects/rgp/\" rel=\"nofollow\" title=\"RGP\">RGP</a> as a genetic programming library. If anyone has an idea for another library  (better documentation, more active development, etc.) I would like to hear your suggestions.</p>\n\n<p>The question is rather simple: given a function with n parameters in R, how can i find the global minimum using genetic programming. I tried modifying one of the <a href=\"https://rsymbolic.org/projects/rgp/wiki/Getting_Started\" rel=\"nofollow\" title=\"example programs\">example programs </a> but it seems this example uses linear regression which I don't think is appropriate in my situation.</p>\n\n<p>Does anyone have any example code i could use?</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":2386,"score":8,"question_id":5911567,"title":"How can I change the title of a ggplot2 legend?","body":"<p>I was looking <a href=\"https://github.com/hadley/ggplot2/wiki/Legend-Attributes\">here</a> but I can't figure it out. </p>\n\n<p>How can I change the word \"type\" to something else?</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":12877319,"title":"Adding an arbitrary function to a ggplot histogram","body":"<p>Context:\nI have some data, and I wish to:</p>\n\n<ol>\n<li>plot a histogram of them</li>\n<li>add a kernel density</li>\n<li>add a \"theoretical density\"</li>\n<li>add a legend to distinguish between 2. and 3.</li>\n</ol>\n\n<p>Consider:</p>\n\n<pre><code>X &lt;- rnorm(1000,0,1)\nY &lt;- (X^2-1)/2\nggplot(as.data.frame(Y), aes(x=Y)) + \n    geom_histogram(aes(y=..density..),      \n                   binwidth=.2,\n                   colour=\"black\", fill=\"white\") +\n    geom_density(alpha=.2, fill=\"#FF6666\") \n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/XXiXm.jpg\" alt=\"enter image description here\"></p>\n\n<p>This accomplishes 1. and 2., but how can I achieve 3. and 4.? I have written the function I wish to plot:</p>\n\n<pre><code>myfunc &lt;- function(x) {\n    2*exp(-x-0.5)/(sqrt(2*x+1)*sqrt(2*pi))\n}\n</code></pre>\n\n<p>Any other comments/critiques are welcome (I am learning)</p>\n"},{"tags":["r","ggplot2","visualization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":8615536,"title":"axis.text.y - fixed width possible?","body":"<p>I have two graphs in a row, both should have the same width since I want to share one legend. The data of the y axis are different, though and since one is quite high, the other quite low, the width is different:</p>\n\n<p><img src=\"http://i.stack.imgur.com/H9JQJ.png\" alt=\"enter image description here\"></p>\n\n<p>Is there a possibility to set something like this:</p>\n\n<p><code>axis.text.y = theme_text( width = 10 )</code></p>\n\n<p>or so? Any other suggestions? Any resources I might have missed?</p>\n\n<p>Thanks a lot in advance! And pre-XMAS greetings from Germany :)</p>\n\n<p>Till</p>\n"},{"tags":["r","gis","spatial"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":1,"view_count":665,"score":5,"question_id":6037999,"title":"Export R plot to shapefile","body":"<p>I am fairly new to R, but not to ArcView.  I am plotting some two-mode data, and want to convert the plot to a shapefile.  Specifically, I would like to convert the vertices and the edges, if possible, so that I can get the same plot to display in ArcView, along with the attributes.</p>\n\n<p>I've installed the package \"shapefiles\", and I see the convert.to.shapefile command, but the help doesn't talk about how to assign XY coords to the vertices.</p>\n\n<p>Thank you,</p>\n\n<p>Tim</p>\n"},{"tags":["r","lme4","mixed-models"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12955454,"title":"Understanding the random effect in linear mixed models (lme4, R)","body":"<p>I am familiar with linear regression models but the random section of linear mixed models just melts my mind. I did find an excellent guide that could have helped me but the languageR package is not compatible with newer versions of lme4 so I've been unable to implement it in my work.</p>\n\n<p>For me the fixed effects are very understandable (below lactation and a higher yr2 value both contribute to a higher weight but the lactation effect is more consistent which results in a higher t-value).</p>\n\n<p>The first problem is to understand what I am actually putting in. To a certain extent I understand that <code>(1|P$grupp)</code> means that the mixed model add to the base line (intercept) while <code>(P$grupp|P$lweek)</code> mean that belong to a group is expected to affect the average weight increase (or decrease) while P$lweek adds to the baseline value. But why does all tutorials seem to favor write ups like <code>(1+P$fgrupp|P$lweek)</code> rather than <code>(P$grupp|P$lweek)</code>?</p>\n\n<p>Now on to the actual output (see below for full output). I've used the following models (sorry for the Swenglish but the sample is the weight of cows <code>P$vikt</code> is the weight at certain time points and P$lweek is the time since a calf was born, P$fgrupp is a factor telling if the cow belongs to feed group 1,2 or 3):</p>\n\n<pre><code>Formula: P$vikt ~ P$lweek + P$laktation + P$yr + (1 | P$fgrupp) \nFormula: P$vikt ~ P$lweek + P$laktation + P$yr + (1 + P$fgrupp | P$lweek)\n</code></pre>\n\n<p>Where I understand it as the first one being rather useless (essentially it tells us that the average weight of the cows isn't affected of which feed group it belongs too). This is reflected by fgrupp having variance 0 in the first formula below. The second is more interesting as the <code>P$fgrupp|P$lweek</code> as I understand it should show if different feed groups affect the weight increase of cows as function of the time. But I am really not competent enough to understand the input. I understand that variance somehow mean that belonging to group2 or 3 explain some of the variation in the growth curves but I really don't understand how to interpret this.</p>\n\n<pre><code>Random effects:\n Groups   Name        Variance Std.Dev. Corr        \n P$lweek  (Intercept)   13.068  3.6149              \n          P$fgrupp2     77.230  8.7881  1.000       \n          P$fgrupp3     81.188  9.0104  1.000 1.000 \n Residual             4031.831 63.4967              \nNumber of obs: 1048, groups: P$lweek, 84\n</code></pre>\n\n<p><strong>Full output</strong></p>\n\n<pre><code>#First model#\nLinear mixed model fit by REML \nFormula: P$vikt ~ P$lweek + P$laktation + P$yr + (1 | P$fgrupp) \n   AIC   BIC logLik deviance REMLdev\n 11703 11732  -5845    11698   11691\nRandom effects:\n Groups   Name        Variance Std.Dev.\n P$fgrupp (Intercept)    0.0    0.000  \n Residual             4139.9   64.342  \nNumber of obs: 1048, groups: P$fgrupp, 3\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  509.593      4.683  108.82\nP$lweek        1.028      0.105    9.79\nP$laktation   22.789      1.454   15.67\nP$yr2         35.294      4.093    8.62\n\nCorrelation of Fixed Effects:\n            (Intr) P$lwek P$lktt\nP$lweek     -0.560              \nP$laktation -0.636  0.030       \nP$yr2       -0.240 -0.034 -0.141\n\n\n#Second model#\n\nLinear mixed model fit by REML \nFormula: P$vikt ~ P$lweek + P$laktation + P$yr + (1 + P$fgrupp | P$lweek) \n   AIC   BIC logLik deviance REMLdev\n 11707 11761  -5842    11693   11685\nRandom effects:\n Groups   Name        Variance Std.Dev. Corr        \n P$lweek  (Intercept)   13.068  3.6149              \n          P$fgrupp2     77.230  8.7881  1.000       \n          P$fgrupp3     81.188  9.0104  1.000 1.000 \n Residual             4031.831 63.4967              \nNumber of obs: 1048, groups: P$lweek, 84\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept) 508.2291     5.1770   98.17\nP$lweek       1.0662     0.1192    8.94\nP$laktation  22.6525     1.4459   15.67\nP$yr2        35.6343     4.0848    8.72\n\nCorrelation of Fixed Effects:\n            (Intr) P$lwek P$lktt\nP$lweek     -0.627              \nP$laktation -0.570  0.025       \nP$yr2       -0.224 -0.018 -0.136\n</code></pre>\n"},{"tags":["r","function","for-loop","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12955413,"title":"Making function for the equation in R","body":"<p>After trying several variations of coding from the function I'm trying to make, still I'm not success. Here's the equation below that I wish to make a function of it in R,</p>\n\n<p><img src=\"http://i.stack.imgur.com/NXcOk.png\" alt=\"enter image description here\"></p>\n\n<p><strong>Edit: <em>s</em> here is of course less than <em>T</em></strong>.</p>\n\n<p>Also, here's the two matrix that shows where the wij, zj(t), and zi(t+s) be taken from.</p>\n\n<p><img src=\"http://i.stack.imgur.com/Gqdst.png\" alt=\"enter image description here\"></p>\n\n<p>Hence, wij = w12 is equal to w1,2 in wmatrix. Similarly, zj(t) = z2(1) is equal to a2,1 in datamat. Again, i=j. Thus if i=1, t=1 and s = 1, then we have zi(t+s) = z1(1+1) = z1(2) which is equal to a1,2 in datamat matrix. </p>\n\n<p>Now, Here's the code that I ended up with,</p>\n\n<pre><code>st.acf &lt;- function(datamat, wmatrix,ss){\n          a = dim(datamat)[1]\n          b = dim(datamat)[2]\n          sumn &lt;- 0 \n          for(i in 1:a){\n             for(j in 1:a){\n                for(t in 1:b-ss){\n                    sumn &lt;- sumn + wmatrix[i,j]*datamat[j,t]*datamat[i,t+ss]\n                }\n             }\n          }\n          print(sumn/sqrt(sum((wmatrix%*%datamat)^2)*sum(datamat^2)))\n      }\n</code></pre>\n\n<p>I used an example which I computed manually, and here's the data of it,</p>\n\n<pre><code>DataMatrix &lt;- rbind(c(54, 55, 51), c(52, 51, 57))\nWeightsMatrix &lt;- rbind(c(0, 1), c(1, 0)) \n</code></pre>\n\n<p>The answer of this should be 0.66389. But, when I use my function, the output of it says <code>numeric(0)</code>.</p>\n\n<pre><code>st.acf(DataMatrix, WeightsMatrix, 1)\nnumeric(0)\n</code></pre>\n\n<p>I can't understand this, all the codes in my function is correct, when I run the loop, and the\nsqrt(sum((wmatrix%*%datamat)^2)*sum(datamat^2)) separately, I got the correct answer. But, when I try to merge them and make a function, I always got <code>numeric(0)</code>. Anyone can help me on this.</p>\n\n<p>I'll appreciate it very much!</p>\n"},{"tags":["r","emacs","ess"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":84,"score":3,"question_id":10487118,"title":"ESS cannot find documentations in specified packages","body":"<p>I am using ESS(12.04), emacs(23.3.1) and R(2.14.1). It works very well except that I cannot open a help from R if the function is inside an package. For example:</p>\n\n<p>In R(iESS mode)</p>\n\n<pre><code>&gt; ?ls\n</code></pre>\n\n<p>I will get the help file, but if I run</p>\n\n<pre><code>&gt; ?caTools::runmean\n</code></pre>\n\n<p>I will get \"No documentation for 'caTools::runmean' in specified packages and libraries:\nyou could try '??caTools::runmean'\".</p>\n\n<p>I am sure that this is a problem of ESS because that if I run the command in R Console, it works perfectly fine. The following is the part of my .emacs file that relevant to ESS:</p>\n\n<pre><code>;; ESS mode\n(require 'ess-tracebug)\n(add-hook 'ess-post-run-hook 'ess-tracebug)\n;; Set to open help in a webbrowser\n;;(setq inferior-ess-r-help-command \"help(\\\"%s\\\", help_type=\\\"html\\\")\\n\")\n;;(setq ess-help-own-frame t)\n;; ESS-R_object-tooltip\n;(require 'ess-R-object-tooltip)\n;; Auto completion for R\n;;(require 'ac-R)\n;;(make-local-variable ac-ignore-case)\n</code></pre>\n\n<p>I have comment out most of my customization trying to identify the problem without luck. If anyone have any comments or suspects, please kindly point it to me. It has been bothering me for a while. Thanks a lot.</p>\n"},{"tags":["r","data.table"],"answer_count":4,"favorite_count":0,"up_vote_count":11,"down_vote_count":0,"view_count":145,"score":11,"question_id":12707368,"title":"finding the index of a max value in R","body":"<p>I have the following data frame called <code>surge</code>:</p>\n\n<pre><code>MeshID    StormID Rate Surge Wind\n1         1412 1.0000E-01   0.01 0.0\n2         1412 1.0000E-01   0.03 0.0\n3         1412 1.0000E-01   0.09 0.0\n4         1412 1.0000E-01   0.12 0.0\n5         1412 1.0000E-01   0.02 0.0\n6         1412 1.0000E-01   0.02 0.0\n7         1412 1.0000E-01   0.07 0.0\n1         1413 1.0000E-01   0.06 0.0\n2         1413 1.0000E-01   0.02 0.0\n3         1413 1.0000E-01   0.05 0.0\n</code></pre>\n\n<p>I used the following code to find the max value of surge per storm:</p>\n\n<pre><code>MaxSurge &lt;- data.frame(tapply(surge[,4], surge[,2], max))\n</code></pre>\n\n<p>It returns:</p>\n\n<pre><code>1412 0.12\n1413 0.06\n</code></pre>\n\n<p>This is great, except I'd also like it to include the <code>MeshID</code> value at the point where the surge is the maximum.  I know I can probably use <code>which.max</code>, but I can't quite figure out how to put this in action.  I'm VERY new to R programming.</p>\n"},{"tags":["r","glm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12953045,"title":"Warning: non-integer #successes in a binomial glm! (survey packages)","body":"<p>I am using the <code>twang</code> package to create propensity scores, which are used as weigtings in a binomial glm using <code>survey::svyglm</code>. The code looks something like this:</p>\n\n<pre><code>pscore &lt;- ps(ppci ~ var1+var2+.........., data=dt....)\n\ndt$w &lt;- get.weights(pscore, stop.method=\"es.mean\")\n\ndesign.ps &lt;- svydesign(ids=~1, weights=~w, data=dt,)\n\nglm1 &lt;- svyglm(m30 ~ ppci, design=design.ps,family=binomial)\n</code></pre>\n\n<p>This produces the following warning:</p>\n\n<pre><code>Warning message:\n   In eval(expr, envir, enclos) : non-integer #successes in a binomial glm!\n</code></pre>\n\n<p>Does anyone know what I could be doing wrong ?</p>\n\n<p>I wasn't sure if this message would be better on stats.SE, but on balance I thought I would try here first.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":78,"score":2,"question_id":12931979,"title":"Reading binary files in R","body":"<p>On the following code its possible to import part of the LAS files version 1.1 with those properties:</p>\n\n<p>List. Item  Format  Size  Required</p>\n\n<ol>\n<li>X  long  4 bytes  * </li>\n<li>Y  long  4 bytes  * </li>\n<li>Z  long  4 bytes  * </li>\n<li>intensity  unsigned short  2 bytes</li>\n<li>Return Number  3 bits (bits 0, 1, 2)  3 bits  *     </li>\n<li>Number of Returns (given pulse)  3 bits (bits 3, 4, 5)  3 bits  *    </li>\n<li>Scan Direction Flag  1 bit (bit 6)  1 bit  *</li>\n<li>Edge of Flight Line  1 bit (bit 7)  1 bit  *</li>\n<li>Classification  unsigned char  1 byte  * </li>\n<li>Scan Angle Rank (-90 to +90) – Left side  unsigned char  1 byte  * </li>\n<li>User Data  unsigned char  1 byte </li>\n<li>Point Source ID  unsigned short  2 bytes  * </li>\n<li>GPS Time  double  8 bytes  *</li>\n</ol>\n\n<p>and return x, y, z and intensity (lines 1 to 4 of list above):</p>\n\n<pre><code>allbytes &lt;- matrix(readBin(con, \"raw\", n = pointDataRecordLength * numberPointRecords, size = 1, endian = \"little\"),\n                   ncol= pointDataRecordLength, nrow = numberPointRecords, byrow = TRUE)    \nclose(con)\nmm &lt;- matrix(readBin(t(allbytes[,1:(3*4)]), \"integer\", size = 4, n = 3 * numberPointRecords, endian = \"little\"), ncol = 3, byrow = TRUE)\n\nmm[,1] &lt;- mm[ ,1] * xyzScaleOffset[1,1] + xyzScaleOffset[1, 2]\nmm[,2] &lt;- mm[ ,2] * xyzScaleOffset[2,1] + xyzScaleOffset[2, 2]\nmm[,3] &lt;- mm[ ,3] * xyzScaleOffset[3,1] + xyzScaleOffset[3, 2]\ncolnames(mm) &lt;- c(\"x\", \"y\", \"z\")\n\nintensity &lt;- readBin(t(allbytes[, 13:14]), \"double\", size = 2, n = numberPointRecords, signed = FALSE, endian = \"little\")\n</code></pre>\n\n<p>I would like to extend the code to read also the \"return number\" and the \"number of return\" (line 5 and 6 of table).  What i'm doing wrong?  </p>\n\n<pre><code>returnNumber &lt;- readBin(t(allbytes[, 15]), \"integer\", size = 1, n = numberPointRecords, signed = FALSE, endian = \"little\")\n</code></pre>\n\n<p>The expected return should be integers between 1 and 5. Thanks in advance!</p>\n\n<p>Example file:</p>\n\n<p><a href=\"http://www.filefactory.com/file/68sdgepk12pd/n/lidar_las\" rel=\"nofollow\">link</a></p>\n\n<p>full code:</p>\n\n<pre><code>    publicHeaderDescription &lt;- function() {\n  hd &lt;- structure(list(Item = c(\"File Signature (\\\"LASF\\\")\",\n                                \"(1.1) File Source ID\", \"(1.1) Global Encoding\",\n                                \"(1.1) Project ID - GUID data 1\", \"(1.1) Project ID - GUID data 2\",\n                                \"(1.1) Project ID - GUID data 3\", \"(1.1) Project ID - GUID data 4\",\n                                \"Version Major\", \"Version Minor\", \"(1.1) System Identifier\",\n                                \"Generating Software\", \"(1.1) File Creation Day of Year\",\n                                \"(1.1) File Creation Year\", \"Header Size\", \"Offset to point data\",\n                                \"Number of variable length records\",\n                                \"Point Data Format ID (0-99 for spec)\", \"Point Data Record Length\",\n                                \"Number of point records\", \"Number of points by return\",\n                                \"X scale factor\", \"Y scale factor\", \"Z scale factor\", \"X offset\",\n                                \"Y offset\", \"Z offset\", \"Max X\", \"Min X\", \"Max Y\", \"Min Y\", \"Max Z\",\n                                \"Min Z\"), Format = c(\"char[4]\", \"unsigned short\", \"unsigned short\",\n                                                     \"unsigned long\", \"unsigned short\", \"unsigned short\",\n                                                     \"unsigned char[8]\", \"unsigned char\", \"unsigned char\", \"char[32]\",\n                                                     \"char[32]\", \"unsigned short\", \"unsigned short\", \"unsigned short\",\n                                                     \"unsigned long\", \"unsigned long\", \"unsigned char\", \"unsigned short\",\n                                                     \"unsigned long\", \"unsigned long[5]\", \"double\", \"double\", \"double\",\n                                                     \"double\", \"double\", \"double\", \"double\", \"double\", \"double\", \"double\",\n                                                     \"double\", \"double\"), Size = c(\"4 bytes\", \"2 bytes\", \"2 bytes\",\n                                                                                   \"4 bytes\", \"2 byte\", \"2 byte\", \"8 bytes\", \"1 byte\", \"1 byte\",\n                                                                                   \"32 bytes\", \"32 bytes\", \"2 bytes\", \"2 bytes\", \"2 bytes\", \"4 bytes\",\n                                                                                   \"4 bytes\", \"1 byte\", \"2 bytes\", \"4 bytes\", \"20 bytes\", \"8 bytes\",\n                                                                                   \"8 bytes\", \"8 bytes\", \"8 bytes\", \"8 bytes\", \"8 bytes\", \"8 bytes\",\n                                                                                   \"8 bytes\", \"8 bytes\", \"8 bytes\", \"8 bytes\", \"8 bytes\"), Required =\n                                                                                     c(\"*\", \"*\", \"*\", \"*\", \"*\", \"*\", \"*\", \"*\", \"*\", \"*\", \"*\", \"*\", \"*\",\n                                                                                       \"*\", \"*\", \"*\", \"*\", \"*\", \"*\", \"*\", \"*\", \"*\", \"*\", \"*\", \"*\", \"*\", \"*\",\n                                                                                       \"*\", \"*\", \"*\", \"*\", \"*\")), .Names = c(\"Item\", \"Format\", \"Size\",\n                                                                                                                             \"Required\"), row.names = 2:33, class = \"data.frame\")\n  hd$what &lt;- \"\"\n  hd$what[grep(\"unsigned\", hd$Format)] &lt;- \"integer\"\n  hd$what[grep(\"char\", hd$Format)] &lt;- \"raw\"\n  hd$what[grep(\"short\", hd$Format)] &lt;- \"integer\"\n  hd$what[grep(\"long\", hd$Format)] &lt;- \"integer\"\n  hd$what[grep(\"double\", hd$Format)] &lt;- \"numeric\"\n  hd$signed &lt;- TRUE\n  hd$signed[grep(\"unsigned\", hd$Format)] &lt;- FALSE\n  ## number of values in record\n  hd$n &lt;- as.numeric(gsub(\"[[:alpha:][:punct:]]\", \"\", hd$Format))\n  hd$n[hd$what == \"character\"] &lt;- 1\n  hd$n[is.na(hd$n)] &lt;- 1\n  ## size of record\n  hd$Hsize &lt;- as.numeric(gsub(\"[[:alpha:]]\", \"\", hd$Size))\n  ## size of each value in record\n  hd$Rsize &lt;- hd$Hsize / hd$n\n  hd$Rsize[hd$what == \"raw\"] &lt;- 1\n  hd$n[hd$what == \"raw\"] &lt;- hd$Hsize[hd$what == \"raw\"]\n  hd\n}\n\nreadLAS &lt;-\n  function(lasfile, skip = 0, nrows = NULL, returnSP = FALSE, returnHeaderOnly = FALSE) {\n\n    hd &lt;- publicHeaderDescription()\n    pheader &lt;- vector(\"list\", nrow(hd))\n    names(pheader) &lt;- hd$Item\n    con &lt;- file(lasfile, open = \"rb\")\n    isLASFbytes &lt;- readBin(con, \"raw\", size = 1, n = 4, endian = \"little\")\n    pheader[[hd$Item[1]]] &lt;- readBin(isLASFbytes, \"character\", size = 4, endian = \"little\")\n    if (! pheader[[hd$Item[1]]] == \"LASF\") {\n      stop(\"Not a valid LAS file\")\n    }\n    for (i in 2:nrow(hd)) {\n      pheader[[hd$Item[i]]] &lt;- readBin(con, what = hd$what[i], signed = hd$signed[i], size = hd$Rsize[i], endian = \"little\", n = hd$n[i])\n      #print(names(pheader)[i])\n      #print(pheader[[hd$Item[i]]])\n    }\n    close(con)\n    ## read the data\n    numberPointRecords &lt;- pheader[[\"Number of point records\"]]\n    offsetToPointData &lt;- pheader[[\"Offset to point data\"]]\n    pointDataRecordLength &lt;-pheader[[\"Point Data Record Length\"]]\n    xyzScaleOffset &lt;- cbind(unlist(pheader[c(\"X scale factor\", \"Y scale factor\", \"Z scale factor\")]),\n                            unlist(pheader[c(\"X offset\", \"Y offset\", \"Z offset\")]))\n\n\n    if (returnHeaderOnly) return(pheader)\n\n    con &lt;- file(lasfile, open = \"rb\")\n    junk &lt;- readBin(con, \"raw\", size = 1, n = offsetToPointData)\n\n    ## deal with rows to skip and max rows to be read\n    if (skip &gt; 0) {\n      ## seek is unreliable on windows, or I'm using it incorrectly\n      ## so we junk the bytes to skip\n      junk &lt;- readBin(con, \"raw\", size = 1, n = pointDataRecordLength * skip)\n      numberPointRecords &lt;- numberPointRecords - skip\n      #pos &lt;- seek(con, where = pointDataRecordLength * skip)\n      # print(c(pos = seek(con), skip = skip, where = pointDataRecordLength * skip))\n    }\n    if (!is.null(nrows)) {\n      if (numberPointRecords &gt; nrows) numberPointRecords &lt;- nrows\n    }\n\n    if (numberPointRecords &lt; 1) stop(\"no records left to read\")\n\n\n    # include a loop to read just points inside the x and y coordinates\n\n    allbytes &lt;- matrix(readBin(con, \"raw\", n = pointDataRecordLength * numberPointRecords, size = 1, endian = \"little\"),\n                       ncol= pointDataRecordLength, nrow = numberPointRecords, byrow = TRUE)\n\n\n    close(con)\n    mm &lt;- matrix(readBin(t(allbytes[,1:(3*4)]), \"integer\", size = 4, n = 3 * numberPointRecords, endian = \"little\"), ncol = 3, byrow = TRUE)\n    gpstime &lt;- NULL\n    if (ncol(allbytes) == 28) gpstime &lt;- readBin(t(allbytes[ , 21:28]), \"numeric\", size = 8, n = numberPointRecords, endian = \"little\")\n\n    intensity &lt;- readBin(t(allbytes[, 13:14]), \"double\", size = 2, n = numberPointRecords, signed = FALSE, endian = \"little\")\n    mm[,1] &lt;- mm[ ,1] * xyzScaleOffset[1,1] + xyzScaleOffset[1, 2]\n    mm[,2] &lt;- mm[ ,2] * xyzScaleOffset[2,1] + xyzScaleOffset[2, 2]\n    mm[,3] &lt;- mm[ ,3] * xyzScaleOffset[3,1] + xyzScaleOffset[3, 2]\n    colnames(mm) &lt;- c(\"x\", \"y\", \"z\")\n\n    returnNumber &lt;- readBin(t(allbytes[,15]), \"integer\", size = 1, n = numberPointRecords, signed = FALSE, endian = \"little\")\n    require(bitops)\n\n\n    if (returnSP) {\n      require(sp)\n      SpatialPoints(cbind(mm, gpstime, intensity))\n    } else {\n      cbind(mm, gpstime, intensity)\n    }\n  }\n</code></pre>\n"},{"tags":["r","table","merge"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":105,"score":2,"question_id":12897220,"title":"How to merge tables in R?","body":"<p>I think this will have a simple answer, but I can't work it out! Here is an example using the <code>iris</code> dataset:</p>\n\n<pre><code>a &lt;- table(iris[,2])\nb &lt;- table(iris[,3]) \n</code></pre>\n\n<p>How do I add these two tables together? For example, the variable 3 would have a value of 27 (26+1) and variable 3.3 a value of 8 (6+2) in the new output table.</p>\n\n<p>Any help much appreciated. </p>\n"},{"tags":["r","ggplot2","word-cloud"],"answer_count":1,"favorite_count":1,"up_vote_count":10,"down_vote_count":0,"view_count":256,"score":10,"question_id":11253765,"title":"geom_wordcloud : is this a pipe dream","body":"<p>I deal a bit with textual data across various grouping variables.  I'm thinking of creating a method to make faceted wordcloud plots using Ian Fellows' <code>wordcloud</code> package.  I like the way <code>ggplot2</code> facets social variables.  I'm deciding how to approach this problem (faceted wordcloud plot).  </p>\n\n<p>Is it possible to use Fellows' work as a geom (I've never made a geom but may learn if this is doable) or will ggplot not play nicely because one is grid and one is base (and wordcloud also uses some C coding) or some other problem?  How difficult is this (I know this is dependent on my abilities but would like some ball park answer)?  Please advise if using base graphics may be the more sensible approach to this problem.  I foresee this may be approached using <code>panes</code> from the <code>plotrix</code> package to give it the aesthetic feel that ggplot's faceting gives.</p>\n\n<p>Maybe this is a foolish concept considering the size of word clouds and the way faceting quickly limits the available space.</p>\n"},{"tags":["r","ggplot2","boundary"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":48,"score":3,"question_id":12603006,"title":"Placing a boundary around a series of points in ggplot2","body":"<p>I have a series of points that I want to place a boundary around. How can I go about this? </p>\n\n<p>These are my points:\n<img src=\"http://i.stack.imgur.com/GHUfA.png\" alt=\"enter image description here\"></p>\n\n<p>I tried geom_line but that was obviously wrong since it produced this!</p>\n\n<p><img src=\"http://i.stack.imgur.com/llWqR.png\" alt=\"enter image description here\"></p>\n\n<p>Thanks</p>\n"},{"tags":["performance","r","mean"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":82,"score":1,"question_id":12759937,"title":"Why are `colMeans()` and `rowMeans()` functions faster than using the mean function with `lapply()`?","body":"<p>What I want to ask is, algorithmically, what do the <code>rowMeans()</code> and <code>colMeans()</code> functions do to optimize speed?</p>\n"},{"tags":["r","ggplot2"],"answer_count":0,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":421,"score":5,"question_id":7688275,"title":"save yaxis legends as a seperate grob?","body":"<p>I have a very large scatterplot of two categories where a dot is a \"hit.\" I wanted to make histograms across the top and side of the plot to represent the hits as seen on the following website: <a href=\"http://blog.mckuhn.de/2009/09/learning-ggplot2-2d-plot-with.html\" rel=\"nofollow\">http://blog.mckuhn.de/2009/09/learning-ggplot2-2d-plot-with.html</a></p>\n\n<p>I can arrange the plots as a 2-by-two grid however I run into a problem: The yaxis of my primary scatterplot has very long titles (important for the project) and in 2x2 grid the top histogram stretches to the full width and is no longer aligned along the x-axis. </p>\n\n<p>My thought was to make a 3x3 grid where I use the leftmost grid for titles. However this requires saving the Y-axis text as \"grob.\" Iin the above blog-post this is achieved as follows:</p>\n\n<pre><code>p &lt;- qplot(data = mtcars, mpg, hp, geom = \"point\", colour = cyl)\nlegend &lt;- p + opts(keep= \"legend_box\")\n</code></pre>\n\n<p>this allows \"legend\" to be placed into the 2x2 grid layout. If I could use the same logic to make a seperate grob for the Yaxis labels I would be all good. I have tried at leastthe following:</p>\n\n<pre><code>legend &lt;- p +opts(keep=\"Yaxis\")\nlegend &lt;- p +opts(keep=\"axis_text_y\")\nlegend &lt;- p +opts(keep=\"axis_text\")\n..... and many others\n</code></pre>\n\n<p>Is it possible to make a grob from things besides the Legend Box? If so - please let me know. If not, I'll take any suggestions on how to arrange the three plots while keeping them aligned and preserving the Y Labels.</p>\n\n<p>thanks</p>\n\n<p><img src=\"http://i.stack.imgur.com/Nf5YP.png\" alt=\"Image showing how labels is affecting vertical alignment and why I want to capture the yaxis text\"></p>\n"},{"tags":["r","zoo","lubridate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":12947904,"title":"Any method to populate (pad) monthly zoo objects with signals on lower time-scale?","body":"<p>Suppose I have a monthly series of zoo data with signals from the set {0,1}.</p>\n\n<p>e.g.</p>\n\n<pre><code>         a b c\nOct 2005 1 0 1\nNov 2005 0 1 1\nDec 2005 0 1 0\nJan 2006 1 0 0\nFeb 2006 1 1 0\nMar 2006 0 0 1\nApr 2006 0 0 1\nMay 2006 0 1 1\nJun 2006 1 1 0\nJul 2006 0 1 1\nAug 2006 1 0 0\nSep 2006 0 1 1\nOct 2006 0 1 1\nNov 2006 1 0 0\nDec 2006 0 0 1\nJan 2007 1 1 1\nFeb 2007 0 1 0\nMar 2007 1 1 0\nApr 2007 0 0 0\nMay 2007 1 0 0\n</code></pre>\n\n<p>Is there a clever vectorized approach to populate the daily data in-between months with the signal values? Also, it needs to be lag shifted by one. So for Row 1, Oct,2005. a,b,c= c(1,0,1), I would like to populate all of Nov 2005 with that set {1,0,1}. Next, would be Nov, 2005 = {0,1,1} and all of December would be populated with these values...\nand so on until the nth month. </p>\n\n<p>I would prefer to start on a monthly scale to generate, but have the populated daily values to analyze.  I'm thinking about something like auto-filtering or pivot-tables in excel.</p>\n"},{"tags":["r","regression","dataset"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":91,"score":1,"question_id":12951595,"title":"How to use subset to get only the first xx observations from the data set in R?","body":"<p>If I have a data set containing 4137 observations and I want to do a regression of colga on hsperc and sat using only the first 2070 observations, how do I do?</p>\n\n<p>I have tried something like:</p>\n\n<pre><code># loading data\nGPA2 &lt;- read.table(\"GPA2.raw\", header=TRUE, na.strings=\".\")\n\n# fitting model \nmfit1 &lt;- lm( formula = colgpa ~ hsperc + sat, data=GPA2, subset=(rownum&lt;2071) )\n</code></pre>\n\n<p>But the <code>subset</code> using <code>rownum</code> fails. Any suggestions??</p>\n\n<p>I don't have a variable that counts the number of rows, shoud I have that? In that case, how do i do that?</p>\n"},{"tags":["r","roxygen2","rd"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":293,"score":4,"question_id":9561684,"title":"documenting dataset with roxygen2","body":"<p>I'm trying to document some datasets in an R package using roxygen2. Considering just one of these:</p>\n\n<ul>\n<li>I have <code>mypkg/data/CpG.human.GRCh37.RDa</code></li>\n<li>which contains an object called <code>CpG.human.GRCh37</code></li>\n<li><p>and a file called: <code>mypkg/R/cpg-data.R</code>, which contains:</p>\n\n<pre><code>#' @name CpG.human.GRCh37\n#' @title CpG islands - human - genome build: GRCh37/hg19\n#' @description This data set list the genomic locations of human CpG islands,\n#' with coordinates based on the GRCh37 / hg19 genome build.\n#' @docType data\n#' @usage CpG.human.GRCh37\n#' @format a \\code{RangedData} instance, 1 row per CpG island.\n#' @source UCSC Table Browser\n#' @author Mark Cowley, 2012-03-05\n#' @export\nNULL\n</code></pre></li>\n</ul>\n\n<p>When I roxygenize, this gets created <code>mypkg/man/CpG.human.GRCh37.Rd</code>, containing:</p>\n\n<pre><code>    \\docType{data}\n    \\name{CpG.human.GRCh37}\n    \\alias{CpG.human.GRCh37}\n    \\title{CpG islands - human - genome build: GRCh37/hg19}\n    \\format{a \\code{RangedData} instance, 1 row per CpG island.}\n    \\source{\n      UCSC Table Browser\n    }\n    \\description{\n      This data set list the genomic locations of human CpG\n      islands, with coordinates based on the GRCh37 / hg19\n      genome build.\n    }\n    \\author{\n      Mark Cowley, 2012-03-05\n    }\n    \\usage{CpG.human.GRCh37}\n    \\keyword{datasets}\n</code></pre>\n\n<p>and <code>export(CpG.human.GRCh37)</code> gets added the <code>NAMESPACE</code> file.</p>\n\n<p>but when I <code>R CMD CHECK</code> I get:</p>\n\n<pre><code>...\n** testing if installed package can be loaded\nError in namespaceExport(ns, exports) : \n  undefined exports: CpG.human.GRCh37\nError: loading failed\n...\n</code></pre>\n\n<p>Nowhere have I told R where to find this dataset, though I would assume that the <code>mypkg/data/&lt;name&gt;.RDa</code> would be a good first guess.\nAny hints would be awesome.</p>\n\n<p>If Hadley's watching, I notice that an \\usage section is not created and the @usage directive is ignored.</p>\n\n<p>i'm using roxygen-2.2.2, on R 2.13.1</p>\n"},{"tags":["r","ggplot2"],"answer_count":5,"favorite_count":10,"up_vote_count":30,"down_vote_count":0,"view_count":3032,"score":30,"question_id":5322836,"title":"Choosing between qplot() and ggplot() in ggplot2","body":"<p>I'm starting to use the great <code>ggplot2</code> package for plotting in R, and one of the first things I ask myself before each plot is <em>\"well, will I use <code>qplot</code> or <code>ggplot</code> ?\"</em></p>\n\n<p>I understand that <code>qplot</code> provides a simpler syntax while <code>ggplot</code> allows maximum features and flexibility, but what is the function you use the most, and do you have some precise use cases for each one ? Do you use mostly <code>qplot</code> and <code>ggplot</code> only for complex plots, or do you use <code>ggplot</code> everytime ?</p>\n\n<p>Thanks for your feedback !</p>\n"},{"tags":["r","data.table","strsplit"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12946883,"title":"strsplit by row and distribute results by column in data.frame","body":"<p>So I have the data.frame</p>\n\n<pre><code>dat = data.frame(x = c('Sir Lancelot the Brave', 'King Arthur',  \n                       'The Black Knight', 'The Rabbit'), stringsAsFactors=F)\n\n&gt; dat\n                       x\n1 Sir Lancelot the Brave\n2            King Arthur\n3       The Black Knight\n4             The Rabbit\n</code></pre>\n\n<p>And I want to transform it into the data frame</p>\n\n<pre><code>&gt; dat2\n                       x    1            2       3      4\n1 Sir Lancelot the Brave    Sir   Lancelot     the  Brave\n2            King Arthur    King    Arthur\n3       The Black Knight    The      Black  Knight \n4             The Rabbit    The     Rabbit\n</code></pre>\n\n<p>strsplit returns the data as a list</p>\n\n<pre><code>sbt &lt;- strsplit(dat$x, \" \")\n&gt; sbt\n[[1]]\n[1] \"Sir\"      \"Lancelot\" \"the\"      \"Brave\"   \n\n[[2]]\n[1] \"King\"   \"Arthur\"\n\n[[3]]\n[1] \"The\"    \"Black\"  \"Knight\"\n\n[[4]]\n[1] \"The\"    \"Rabbit\"\n</code></pre>\n\n<p>and as.data.table does not create NULL values where it should, but repeats values</p>\n\n<pre><code>&gt; t(as.data.table(sbt))\n   [,1]   [,2]       [,3]     [,4]    \nV1 \"Sir\"  \"Lancelot\" \"the\"    \"Brave\" \nV2 \"King\" \"Arthur\"   \"King\"   \"Arthur\"\nV3 \"The\"  \"Black\"    \"Knight\" \"The\"   \nV4 \"The\"  \"Rabbit\"   \"The\"    \"Rabbit\"\n</code></pre>\n\n<p>I guess I really would like an argument to as.data.table(x, repeat=FALSE), else how can I accomplish this job?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":94,"score":2,"question_id":12460938,"title":"R Reading in a zip data file without unzipping it","body":"<p>I have a very large zip file and i am trying to read it into R without unzipping it like so:</p>\n\n<pre><code>temp &lt;- tempfile(\"Sales\", fileext=c(\"zip\"))\ndata &lt;- read.table(unz(temp, \"Sales.dat\"), nrows=10, header=T, quote=\"\\\"\", sep=\",\")\n\nError in open.connection(file, \"rt\") : cannot open the connection\nIn addition: Warning message:\nIn open.connection(file, \"rt\") :\n  cannot open zip file 'C:\\Users\\xxx\\AppData\\Local\\Temp\\RtmpyAM9jH\\Sales13041760345azip'\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":62,"score":0,"question_id":12950482,"title":"Programming> Extract Rows where the list items match the column values","body":"<pre><code>l &lt;- c(\"a\",\"b\",\"c\")\n</code></pre>\n\n<p><code>m</code> is a 5x2 data frame. <code>C1</code> is <code>1:5</code>, <code>C2</code> is <code>a:e</code>:</p>\n\n<pre><code>m &lt;- data.frame(C1 = 1:5, C2 = letters[1:5], stringsAsFactors = FALSE)\n</code></pre>\n\n<p>I want to find <code>n</code>, where it contains only those rows of <code>m</code> where <code>m$C2</code> is in the values stated in <code>l</code></p>\n\n<p>The resulting <code>n</code> is a 3x2 such that C2 is <code>a:c</code>, i.e.</p>\n\n<pre><code>  C1 C2\n1  1  a\n2  2  b\n3  3  c\n</code></pre>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":111,"score":0,"question_id":12605925,"title":"How to use formatR","body":"<p>How to use formatR to get an output like</p>\n\n<pre><code>data&lt;-data.frame(response=c(48,31,24,29,46,34,25,31,45,37,27,35,37,39,30,38,45,34,29,32,\n                             28,17,19,20,32,18,20,22,35,19,22,24,39,16,19,22,31,15,20,22)\n                  ,treatment=rep(c(\"A\",\"B\",\"C\",\"D\"),10)\n                  ,subject=rep(c(\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"G\",\"H\",\"I\",\"J\"),each=4)\n                  ,group=rep(c(\"A\",\"B\"),each=20)\n                  )\n</code></pre>\n\n<p>from a arbitrary input like </p>\n\n<pre><code>data &lt;- data.frame(response = c(48, 31, 24, 29, 46, \n   34, 25, 31, 45, 37, 27, 35, 37, 39, 30, 38, 45, \n   34, 29, 32, 28, 17, 19, 20, 32, 18, 20, 22, 35, \n   19, 22, 24, 39, 16, 19, 22, 31, 15, 20, 22), treatment = rep(c(\"A\", \n   \"B\", \"C\", \"D\"), 10), subject = rep(c(\"A\", \"B\", \n   \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\"), each = 4), \n   group = rep(c(\"A\", \"B\"), each = 20))\n</code></pre>\n\n<p>what I want,\n- take the 2nd data.frame\n- execute  tidy.source(filename, file = filename) and\n- get a data.frame in a form like the first data.frame.</p>\n\n<p>If I could choose that formatR ignores these datas, would be also fine by me.</p>\n"},{"tags":["string","r","variables","load"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12945250,"title":"Loading a string in a variable instead of the name of the variable (R)","body":"<p>I am trying to load data frames that are saved in a certain folder. I have a bash script that loops along all <code>*.gzip</code> files in the folder and passes the file names as arguments to an R script (<code>blah.r $file_name</code>). Now, in the R script, the file name is saved as</p>\n\n<pre><code>file_name = commandArgs(TRUE)[1]\n</code></pre>\n\n<p>and it prints the correct file name. However, when I try to load the file</p>\n\n<pre><code>data(file_name)\n</code></pre>\n\n<p>R thinks that file_name is a string, not a variable, so it says that it can't find <code>\"file_name\"</code>.</p>\n\n<p>How can I get R to recognize this variable as a variable and not a literal string?</p>\n"},{"tags":["r","unicode","utf-8"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":95,"score":0,"question_id":12892335,"title":"How to plot bar plot with Chinese names in input file?","body":"<p>I want to plot a barplot from an input file having Chinese characters. </p>\n\n<pre><code>木材   2   2 \n表     3   4\n笔     4   2 \n垃圾桶  5   6 \n杯     6   3  \n</code></pre>\n\n<p>I expect the output like Excel with Chinese names as y labels and legends. How can I implement it in R?\n<img src=\"http://i.stack.imgur.com/oP2mF.png\" alt=\"enter image description here\"></p>\n\n<p>After changing locale to simplified chinese i get the following graph.</p>\n\n<pre><code>sessionInfo()\nR version 2.14.1 (2011-12-22)\nPlatform: x86_64-unknown-linux-gnu (64-bit)\n\nlocale:\n [1] LC_CTYPE=zh_CN.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=zh_CN.UTF-8        LC_COLLATE=zh_CN.UTF-8    \n [5] LC_MONETARY=zh_CN.UTF-8    LC_MESSAGES=zh_CN.UTF-8   \n [7] LC_PAPER=C                 LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=zh_CN.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nloaded via a namespace (and not attached):\n[1] XML_3.9-4\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/IwM8U.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","pdf","unicode","plot"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12948701,"title":"How to plot chinese characters on pdf?","body":"<p>My question is related to my previous question. </p>\n\n<p><a href=\"http://stackoverflow.com/questions/12892335/how-to-plot-bar-plot-with-chinese-names-in-input-file\">How to plot bar plot with Chinese names in input file?</a></p>\n\n<p>I need to plot now chinese characters on pdf. </p>\n\n<pre><code>mydata = matrix( c( 2:6, c( 2,4,2,6,3 ) ), nrow= 2 )\nmylabs = c( \"木材\", \"表\", \"笔\", \"垃圾桶\", \"杯\" )\nbarplot( mydata, beside=T, horiz= \"T\", names.arg= mylabs, las= 1, col= c( \"red\", \"blue\" ) )\n\npdf( \"plotname.pdf\" )\nbarplot( mydata, beside=T, horiz= \"T\", names.arg= mylabs, las= 1, col= c( \"red\", \"blue\" ) )\ndev.off()\n</code></pre>\n\n<p>But on pdf only .... gets printed instead of Chinese names. </p>\n\n<p>Regards</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12948243,"title":"Reshape an odd list","body":"<p>This is a very specific task but I believe the learning from it may be general enough to be of use.  I have an oddly designed data set of time stamps that I need to reshape and I need to operate out of the packages that come with a base install.  I think seeing is easier than explaining.</p>\n\n<p>The list of named vectors with time stamps:</p>\n\n<pre><code>x &lt;- structure(list(A = c(\"2.40\", \":\", \"3.00\", \"5.01\", \"6.62\", \":\", \n    \"7.00\", \"9.00\"), B = c(\"2.40\", \"5.01\", \"6.62\", \":\", \"7.00\", \"9.00\"\n    ), C = c(\"2.40\", \":\", \"3.00\", \"5.01\", \"6.62\", \":\", \"7.00\", \"9.00\"\n    )), .Names = c(\"A\", \"B\", \"C\"))\n</code></pre>\n\n<p>What the list looks like:</p>\n\n<pre><code>&gt; x\n[[1]]\n[1] \"2.40\" \":\"    \"3.00\" \"5.01\" \"6.62\" \":\"    \"7.00\" \"9.00\"\n\n[[2]]\n[1] \"2.40\" \"5.01\" \"6.62\" \":\"    \"7.00\" \"9.00\"\n\n[[3]]\n[1] \"2.40\" \":\"    \"3.00\" \"5.01\" \"6.62\" \":\"    \"7.00\" \"9.00\"\n</code></pre>\n\n<p>What I'd like:</p>\n\n<pre><code>$A\n     start      end  \n1   \"2.40\"   \"3.00\"   \n2   \"5.01\"   \"5.01\"    \n3   \"6.62\"   \"7.00\"   \n4   \"9.00\"   \"9.00\"  \n\n$B\n     start      end \n1   \"2.40\"   \"2.40\"   \n2   \"5.01\"   \"5.01\"  \n3   \"6.62\"   \"7:00\"   \n4   \"9.00\"   \"9.00\"   \n\n$C\n     start      end \n1   \"2.40\"   \"3.00\"\n2   \"5.01\"   \"5.01\" \n3   \"6.62\"   \"7.00\"\n4   \"9.00\"   \"9.00\"\n</code></pre>\n\n<p>Where there's a colon (:) the element on the left is a start value and the element on the right is an end value.  If an element is not touching a colon it needs to be repeated and is both the start and end value.  </p>\n\n<p><em>Note: the outcome wouldn't have quotes if it's a dataframe vs. a matrix</em></p>\n"},{"tags":["r","data.table"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":54,"score":2,"question_id":12948686,"title":"Why is expand.grid faster than CJ?","body":"<pre><code>&gt; system.time(expand.grid(1:1000,1:10000))\n   user  system elapsed \n   1.65    0.34    2.03 \n&gt; system.time(CJ(1:1000,1:10000))\n   user  system elapsed \n   3.48    0.32    3.79 \n</code></pre>\n"},{"tags":["c#","visual-studio-2010","r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12948772,"title":"Saving an R plot Image while integrating it with C#:The server threw an exception. (Exception from HRESULT: 0x80010105 (RPC_E_SERVERFAULT))","body":"<p>Hi I am facing a problem while taking path to save an Image file in R by integrating with C#\nI want to save the png file in a folder in the project. But i am getting an error : <strong>The server threw an exception. (Exception from HRESULT: 0x80010105 (RPC_E_SERVERFAULT))</strong></p>\n\n<pre><code>string value = Path.Combine(System.AppDomain.CurrentDomain.BaseDirectory, \"Images\", \"Image1.png\");\n            string pathname = \"png('\"+value+\"');\";\n rconn.EvaluateNoReturn(pathname);\n</code></pre>\n\n<p>Where I am going wrong. Please suggest. </p>\n"},{"tags":["r","excel"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":91,"score":3,"question_id":12945687,"title":"How to read all worksheets in an Excel Workbook into an R list with data.frame elements using XLConnect?","body":"<p>I understand that <code>XLConnect</code> can be used to read an Excel worksheet into R. For example, this would read the first worksheet in a workbook called <code>test.xls</code> into R.</p>\n\n<pre><code>library(XLConnect)\nreadWorksheetFromFile('test.xls', sheet=1)\n</code></pre>\n\n<p>I have an Excel Workbook with multiple worksheets. </p>\n\n<p><strong>How can all worksheets in a workbook be imported into a list in R where each element of the list is a data.frame for a given sheet, and where the name of each element corresponds to the name of the worksheet in Excel?</strong></p>\n"},{"tags":["r","filtering","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":12947318,"title":"Filtering a dataframe in row names from a column values","body":"<p>Basically I have dataframe with two columns (<code>target_id</code> and <code>fpkm</code>). I want to keep only those row names in first column that are not duplicated.<br>\nFor example in the below dataframe you can see there are two row names with the same name (almost) <code>comp267138_c0_seq1</code> <code>comp267138_c0_seq2</code> and from both and I want to keep only one <code>comp267138_c0_seq2</code> based of high value in column 2.</p>\n\n<pre><code>       target_id        fpkm\ncomp247393_c0_seq1    3.197885\ncomp257058_c0_seq4    1.624577\ncomp242590_c0_seq1    1.750319\ncomp77911_c0_seq1     1.293059\ncomp241426_c0_seq1    1.626589\ncomp288413_c0_seq1   14.828853\ncomp294436_c0_seq1   11.555596\ncomp63603_c0_seq1     1.982386\ncomp267138_c0_seq1    8.594494\ncomp267138_c0_seq2   11.134958\ncomp321623_c0_seq1    6.934149\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":44,"score":-1,"question_id":12946371,"title":"Error in R apply() function with lubridate","body":"<p>I have a simple function like this:</p>\n\n<pre><code>f&lt;-function(x){ ymd_h(x[1]) + (x[2] )}\n</code></pre>\n\n<p>Here I use <code>ymd_h(), hours()</code> from the <code>lubridate</code> package. But when I try to call this function from <code>apply</code> method like this:</p>\n\n<pre><code>result&lt;-apply(wind.new[,c(\"date\",\"hors\")],1,f)\n</code></pre>\n\n<p>... where <code>*wind.new</code> is a data frame with <code>date</code>, <code>hors</code> and other columns,\nI get the following error:</p>\n\n<pre><code>Error in FUN(newX[, i], ...) : could not find function \"ymd_h\"\n</code></pre>\n\n<p>Obviously <code>ymd_h</code> is not visible inside <code>apply()</code>. How would I fix this?\nUPDATE:\n Actually I have the data frame showed below and want to convert <strong>date</strong> column to YYYYMMDDHH format and add <strong>hors</strong> column to it as hours. I thought the best approach will be to use lubridate package and I used above mentioned function for that. But the execution took very long time and the output was not correct. Any hints, please?</p>\n\n<pre><code>   date    hors   u      v        ws    wd\n2009070100  1   2.34    -0.79   2.47    108.68\n2009070100  2   2.18    -0.99   2.4     114.31\n2009070100  3   2.2     -1.21   2.51    118.71\n............\n2009070100  47  2.3     -2.18   3.17    133.5\n2009070100  48  1.93    -1.87   2.69    134.12\n2009070112  1   2.77    -0.65   2.85    103.17\n</code></pre>\n\n<p>.........</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":221,"score":0,"question_id":9476475,"title":"How to produce leverage stats?","body":"<p>I know how to produce the plots using leveragePlot(), but I can not find a way to produce a statistic for leverage for each observation like in megastat output.</p>\n"},{"tags":["r","datetime"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":11707703,"title":"date objects in month day format","body":"<p>I was wondering if there is a way for R to turn this format into any date object. The format is 'month [space] day'. For example: <code>Jan 1</code> or <code>Jul 29</code> or <code>Jul 30</code>. I just want those examples to be read as a date object so I can manipulate them. </p>\n"},{"tags":["xml","r","install","rcurl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12921187,"title":"Error installing RCurl and XML packages on Windows","body":"<p>I am trying to install the RCurl and XML packages and getting an error on Windows. I have tried R 2.15.0 and 2.15.1, cran.r-project.org and www.omegahat.org/R, and binary and source. Any suggestions? Thanks.</p>\n\n<pre><code>install.packages('RCurl',repos='http://www.omegahat.org/R', type='source')\nInstalling package(s) into ‘C:/R/R-2.15.0/library’\n(as ‘lib’ is unspecified)\ntrying URL 'http://www.omegahat.org/R/src/contrib/RCurl_1.95-1.tar.gz'\nContent type 'application/x-gzip' length 862526 bytes (842 Kb)\nopened URL\ndownloaded 842 Kb\n\n* installing *source* package 'RCurl' ...\nPlease set LIB_CURL\ncygwin warning:\n  MS-DOS style path detected: C:/R/R-2.15.0/library/RCurl/libs\n  Preferred POSIX equivalent is: /cygdrive/c/R/R-2.15.0/library/RCurl/libs\n  CYGWIN environment variable option \"nodosfilewarning\" turns off this warning.\n  Consult the user's guide for more details about POSIX paths:\n    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames\n** libs\nWarning: this package has a non-empty 'configure.win' file,\nso building only the main architecture\n\ncygwin warning:\n  MS-DOS style path detected: C:/R/R-215~1.0/etc/i386/Makeconf\n  Preferred POSIX equivalent is: /cygdrive/c/R/R-215~1.0/etc/i386/Makeconf\n  CYGWIN environment variable option \"nodosfilewarning\" turns off this warning.\n  Consult the user's guide for more details about POSIX paths:\n    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames\ngcc  -I\"C:/R/R-215~1.0/include\" -DNDEBUG -Wall -I/include -DHAVE_LIBIDN_FIELD=1 -DHAVE_CURLOPT_URL=1 -DHAVE_CURLINFO_EFFECTIVE_URL=1 -DHAVE_CURLINFO_RESPONSE_CODE=1 -DHAVE_CURLINFO_TOTAL_TIME=1 -DHAVE_CURLINFO_NAMELOOKUP_TIME=1 -DHAVE_CURLINFO_CONNECT_TIME=1 -DHAVE_CURLINFO_PRETRANSFER_TIME=1 -DHAVE_CURLINFO_SIZE_UPLOAD=1 -DHAVE_CURLINFO_SIZE_DOWNLOAD=1 -DHAVE_CURLINFO_SPEED_DOWNLOAD=1 -DHAVE_CURLINFO_SPEED_UPLOAD=1 -DHAVE_CURLINFO_HEADER_SIZE=1 -DHAVE_CURLINFO_REQUEST_SIZE=1 -DHAVE_CURLINFO_SSL_VERIFYRESULT=1 -DHAVE_CURLINFO_FILETIME=1 -DHAVE_CURLINFO_CONTENT_LENGTH_DOWNLOAD=1 -DHAVE_CURLINFO_CONTENT_LENGTH_UPLOAD=1 -DHAVE_CURLINFO_STARTTRANSFER_TIME=1 -DHAVE_CURLINFO_CONTENT_TYPE=1 -DHAVE_CURLINFO_REDIRECT_TIME=1 -DHAVE_CURLINFO_REDIRECT_COUNT=1 -DHAVE_CURLINFO_PRIVATE=1 -DHAVE_CURLINFO_HTTP_CONNECTCODE=1 -DHAVE_CURLINFO_HTTPAUTH_AVAIL=1 -DHAVE_CURLINFO_PROXYAUTH_AVAIL=1 -DHAVE_CURLINFO_OS_ERRNO=1 -DHAVE_CURLINFO_NUM_CONNECTS=1 -DHAVE_CURLINFO_SSL_ENGINES=1 -DHAVE_CURLINFO_COOKIELIST=1 -DHAVE_CURLINFO_LASTSOCKET=1 -DHAVE_CURLINFO_FTP_ENTRY_PATH=1 -DHAVE_CURLINFO_REDIRECT_URL=1 -DHAVE_CURLINFO_PRIMARY_IP=1 -DHAVE_CURLINFO_APPCONNECT_TIME=1 -DHAVE_CURLINFO_CERTINFO=1 -DHAVE_CURLINFO_CONDITION_UNMET=1 -DHAVE_CURLOPT_KEYPASSWD=1 -DHAVE_CURLOPT_DIRLISTONLY=1 -DHAVE_CURLOPT_APPEND=1 -DHAVE_CURLOPT_KRBLEVEL=1 -DHAVE_CURLOPT_USE_SSL=1 -DHAVE_CURLOPT_TIMEOUT_MS=1 -DHAVE_CURLOPT_CONNECTTIMEOUT_MS=1 -DHAVE_CURLOPT_HTTP_TRANSFER_DECODING=1 -DHAVE_CURLOPT_HTTP_CONTENT_DECODING=1 -DHAVE_CURLOPT_NEW_FILE_PERMS=1 -DHAVE_CURLOPT_NEW_DIRECTORY_PERMS=1 -DHAVE_CURLOPT_POSTREDIR=1 -DHAVE_CURLOPT_OPENSOCKETFUNCTION=1 -DHAVE_CURLOPT_OPENSOCKETDATA=1 -DHAVE_CURLOPT_COPYPOSTFIELDS=1 -DHAVE_CURLOPT_PROXY_TRANSFER_MODE=1 -DHAVE_CURLOPT_SEEKFUNCTION=1 -DHAVE_CURLOPT_SEEKDATA=1 -DHAVE_CURLOPT_CRLFILE=1 -DHAVE_CURLOPT_ISSUERCERT=1 -DHAVE_CURLOPT_ADDRESS_SCOPE=1 -DHAVE_CURLOPT_CERTINFO=1 -DHAVE_CURLOPT_USERNAME=1 -DHAVE_CURLOPT_PASSWORD=1 -DHAVE_CURLOPT_PROXYUSERNAME=1 -DHAVE_CURLOPT_PROXYPASSWORD=1 -DHAVE_CURLOPT_SSH_HOST_PUBLIC_KEY_MD5=1 -DHAVE_CURLOPT_NOPROXY=1 -DHAVE_CURLOPT_TFTP_BLKSIZE=1 -DHAVE_CURLOPT_SOCKS5_GSSAPI_SERVICE=1 -DHAVE_CURLOPT_SOCKS5_GSSAPI_NEC=1 -DHAVE_CURLOPT_PROTOCOLS=1 -DHAVE_CURLOPT_REDIR_PROTOCOLS=1 -DHAVE_CURLOPT_SSH_AUTH_TYPES=1 -DHAVE_CURLOPT_SSH_PUBLIC_KEYFILE=1 -DHAVE_CURLOPT_SSH_PRIVATE_KEYFILE=1 -DHAVE_CURLOPT_FTP_SSL_CCC=1 -DHAVE_CURLOPT_COOKIELIST=1 -DHAVE_CURLOPT_IGNORE_CONTENT_LENGTH=1 -DHAVE_CURLOPT_FTP_SKIP_PASV_IP=1 -DHAVE_CURLOPT_FTP_FILEMETHOD=1 -DHAVE_CURLOPT_LOCALPORT=1 -DHAVE_CURLOPT_LOCALPORTRANGE=1 -DHAVE_CURLOPT_CONNECT_ONLY=1 -DHAVE_CURLOPT_CONV_FROM_NETWORK_FUNCTION=1 -DHAVE_CURLOPT_CONV_TO_NETWORK_FUNCTION=1 -DHAVE_CURLOPT_CONV_FROM_UTF8_FUNCTION=1 -DHAVE_CURLOPT_MAX_SEND_SPEED_LARGE=1 -DHAVE_CURLOPT_MAX_RECV_SPEED_LARGE=1 -DHAVE_CURLOPT_FTP_ALTERNATIVE_TO_USER=1 -DHAVE_CURLOPT_SOCKOPTFUNCTION=1 \n-DHAVE_CURLOPT_SOCKOPTDATA=1 -DHAVE_CURLOPT_SSL_SESSIONID_CACHE=1         -O3 -Wall  -std=gnu99 -mtune=core2 -c base64.c -o base64.o\nIn file included from base64.c:1:0:\nRcurl.h:4:23: fatal error: curl/curl.h: No such file or directory\ncompilation terminated.\nmake: *** [base64.o] Error 1\nERROR: compilation failed for package 'RCurl'\n* removing 'C:/R/R-2.15.0/library/RCurl'\nWarning in q(\"no\", status = 1, runLast = FALSE) :\n  cannot get info on 'C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\Rtmp2fO9aA/R.INSTALL4245e223b81/RCurl', reason 'Access is denied'\nWarning in install.packages :\n  running command 'C:/R/R-215~1.0/bin/i386/R CMD INSTALL -l \"C:/R/R-2.15.0/library\"   C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\RtmpclrXFX/downloaded_packages/RCurl_1.95-1.tar.gz' had status 1\nWarning in install.packages :\n  installation of package ‘RCurl’ had non-zero exit status\n</code></pre>\n\n<p>The downloaded source packages are in</p>\n\n<blockquote>\n  <p>C:\\Documents and Settings\\Administrator\\Local Settings\\Temp\\RtmpclrXFX\\downloaded_packages</p>\n</blockquote>\n"},{"tags":["r","plot"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":1,"view_count":3346,"score":2,"question_id":8774002,"title":"Setting the color for an individual data point","body":"<p>How can I set the colour for  a single data point in  a scatter plot in <code>R</code>? </p>\n\n<p>I am using <code>plot</code> </p>\n"},{"tags":["r","colors","plot","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":106,"score":3,"question_id":11838278,"title":"Plot with conditional colors based on values in R","body":"<p>I want to plot a graph with different colors based on values. I wrote the below code, </p>\n\n<pre><code>np_graph &lt;- data.frame(C1 = -5:5, C2 = -5:5)\nx=np_graph2$C1\ny=np_graph2$C2\nplot(x,y,xlab=\"PC1\",ylab=\"PC2\")\n</code></pre>\n\n<p>Now, if the value of X is >0, then that value should be in green (in the graph). if the value of Y is >0, then that value should be in red (in the graph).</p>\n\n<p>Can some one help me in this?</p>\n"},{"tags":["r","plot","ggplot2","bar-chart"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":94,"score":4,"question_id":12312189,"title":"R floating barchart","body":"<p>I want to make bar charts where the bar minimum can be specified (much like the box in a box and whisker plot). Can barplot do that? I suspect the answer's in ggplot, but I can't find an example.\nHere's some data:</p>\n\n<blockquote>\n<pre><code>                    X  Jan  Feb  Mar  Apr  May  Jun  Jul  Aug  Sep  Oct  Nov  Dec\n1      Highest recorded 31.5 31.8 30.3 28.0 24.9 24.4 21.7 20.9 24.5 25.4 26.0 28.7\n2  Mean monthly maximum 27.8 28.6 27.0 24.8 22.0 20.0 18.9 18.8 20.4 22.4 23.9 26.8\n3    Mean daily maximum 24.2 24.8 23.1 20.9 18.4 16.3 15.5 15.7 16.9 18.3 20.0 22.4\n4                  Mean 19.1 19.8 18.1 16.2 13.8 11.9 11.2 11.6 12.7 14.1 15.7 17.7\n5    Mean daily minimum 14.0 14.7 13.1 11.4  9.2  7.5  6.9  7.4  8.4 10.0 11.4 13.0\n6  Mean monthly minimum  7.6  9.1  6.8  3.8  2.3 -0.5 -0.2  1.0  2.3  3.7  5.3  6.7\n7       Lowest recorded  4.0  5.6  4.1 -1.3  0.0 -3.1 -2.6 -1.4 -0.8  2.0  2.7  4.1\n</code></pre>\n  \n  <p>xaxis =c(\"J\" ,\"F\" ,\"M\" ,\"A\" ,\"M\" ,\"J\",\"J\",\"A\", \"S\", \"O\",\"N\",\"D\")</p>\n</blockquote>\n\n<p>So ideally, I end up with a stacked bar for each month, that starts at the 'Lowest recorded' value, rather than at zero. </p>\n\n<p>I've also had a try with superbarplot from the UsingR package. I can get the bars to start where I want, but can't move the x axis down out of the centre of the plot. Thanks in advance.</p>\n"},{"tags":["r","statistics"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":11804994,"title":"adehabitatHS compana test returns lambda = NaN?","body":"<p>I'm getting bad test results using the R package <strong>adehabitatHS</strong>, and the function <code>compana()</code>.</p>\n\n<p>The compana test compares habitat availability with habitat usage by animals. The test performs a compositional analysis, yielding a Wilk's lambda and p-value. </p>\n\n<p>I'm running the test on empirical data (16 animals, 8 habitat categories) that meets the stated format and content requirements of the compana test, but the test returns: <code>lambda = NaN, p-value = 1.0</code>.</p>\n\n<p>I've examined my data for the standard causes of NaNs, and I don't see any problems, such as missing values (<code>NA</code>s), negative proportions, or row sums > 100 percent. Moreover, the error arises when I use the full data set (16 rows, 8 columns), but not when I use a subset (missing one column). It does not seem to matter which columns are excluded, so long as only 7 or less are included.</p>\n\n<p>Details of my data are below. Any help or suggestions would be greatly appreciated. </p>\n\n<p>Platform: OSX 10.7.4 (Lion)\nR Version: R 2.15.1 GUI 1.52 Leopard build 64-bit (6188)</p>\n\n<p>R CODE:</p>\n\n<p>proportions for habitat used (matrix):</p>\n\n<pre><code>used.m\n    Atr   Cre    DW  Dist  Gra   Mar   Mes   Opn\n1   2.76 19.31  4.14 17.24 0.00 28.28  0.00  0.00\n2  15.12  1.16  3.49  5.81 2.33 32.56 25.58  3.49\n3  57.35 13.24  1.47  0.00 6.62  0.00  8.09 12.50\n4  41.18  0.98  2.94  0.00 3.92  0.00 29.41 18.63\n5   9.52 17.01 23.13  0.00 0.00 37.41  3.40  0.00\n6   2.54 67.01  0.00  0.51 0.51  6.09  3.05  0.00\n7  10.45 15.67  5.22  5.97 0.00  0.00 33.58 10.45\n8   6.34  0.00  0.00  4.23 0.00  0.00  0.00 21.83\n9   0.66 18.54  1.32 39.74 0.00  8.61  2.65  0.66\n10 20.75  0.00  0.00  0.00 0.00  0.00  0.00 49.06\n11 20.14 18.06 12.50  8.33 0.00  5.56 22.22  9.72\n12  0.00  0.00  0.00 58.04 0.00  0.00 13.99  0.00\n13 44.23  4.81  0.00  0.00 0.00  0.00 28.85 19.23\n14 13.04  2.61  1.74  2.61 0.00 19.13  6.09 25.22\n15 35.96  3.51  0.00  2.63 0.00  1.75 25.44  0.88\n16  0.00  0.00  0.00 35.14 0.00  7.21  0.00  8.11\n</code></pre>\n\n<p>proportions for habitat available (matrix):</p>\n\n<pre><code>avail.m\n    Atr   Cre    DW  Dist   Gra   Mar   Mes   Opn\n1   1.11 39.18 15.50  0.29  0.00 30.18  4.15  3.43\n2  18.96  1.02  0.87  7.40  4.36 37.80  6.17 10.56\n3  65.75  3.85  0.57  0.00 12.36  0.00  9.97  3.43\n4  20.52  5.44  2.01  0.00  0.08  0.00 10.99 44.22\n5  11.16 43.55 10.34  0.00  0.00 18.11  9.60  3.17\n6  25.24  9.88  2.77  2.44  4.95 12.90 11.44  2.19\n7   5.47 21.13  6.67  0.57  0.00  0.10 30.73  9.59\n8   6.23  0.00  0.00  4.85  0.00  0.00  0.00  5.72\n9   0.85  1.97  0.09 33.52  0.00  5.58  1.73  0.84\n10 18.97  0.00  0.00  0.00  0.00  0.00  0.00  5.59\n11  0.16 44.41 19.16  3.53  0.00  1.28 21.65  4.13\n12  6.67  3.89  0.31 13.63  0.00  0.00 20.56  0.00\n13 21.40  2.38  2.66  0.00  0.00  0.00 21.23 46.96\n14 42.62  9.36  1.49  3.89  0.43  3.61 20.79  5.80\n15 33.32 12.90  4.17  4.09  0.15  3.96 12.32  4.94\n16  5.65  0.00  0.00  1.36  0.00  0.59  0.00  9.71\n</code></pre>\n\n<p>load the adehabitatHS package</p>\n\n<pre><code>library(adehabitatHS)\n</code></pre>\n\n<p>run the compana test on full data set (all rows, all 8 columns)</p>\n\n<pre><code>fulldata.comp &lt;- compana(used.m, avail.m)\n</code></pre>\n\n<p>check result</p>\n\n<pre><code>fulldata.comp$test\nLambda      P \n   NaN      1 \n</code></pre>\n\n<p>run compana on partial data (all rows, columns 1-7)</p>\n\n<pre><code>partdata.comp &lt;- compana(used.m[, 1:7], avail.m[, 1:7])\n</code></pre>\n\n<p>check result</p>\n\n<pre><code>partdata.comp$test\n   Lambda         P \n 0.3319731 0.6280000 \n</code></pre>\n"},{"tags":["r","data.frame","aggregate"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":467,"score":3,"question_id":7560671,"title":"Aggregate data in one column based on values in another column","body":"<p>I know there is an easy way to do this...but, I can't figure it out.</p>\n\n<p>I have a dataframe in my R script that looks something like this:</p>\n\n<pre><code>A      B    C\n1.2    4    8\n2.3    4    9\n2.3    6    0\n1.2    3    3\n3.4    2    1 \n1.2    5    1\n</code></pre>\n\n<p>Note that A, B, and C are column names. And I'm trying to get variables like this:</p>\n\n<pre><code>sum1 &lt;- [the sum of all B values such that A is 1.2]\nnum1 &lt;- [the number of times A is 1.2]\n</code></pre>\n\n<p>Any easy way to do this?\nI basically want to end up with a data frame that looks like this:</p>\n\n<pre><code>    A     num     totalB\n   1.2    3       12\n   etc    etc     etc\n</code></pre>\n\n<p>Where \"num\" is the number of times that particular A value appeared, and \"totalB\" is the sum of the B values given the A value.</p>\n"},{"tags":["r","aggregate","data.table"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":290,"score":4,"question_id":4998846,"title":"Applying an aggregate function over multiple different slices","body":"<p>I have a data array that contains some information about people and projects as such:</p>\n\n<pre><code>person_id | project_id | action | time\n--------------------------------------\n        1 |          1 |      w |    1\n        1 |          2 |      w |    2\n        1 |          3 |      w |    2\n        1 |          3 |      r |    3\n        1 |          3 |      w |    4\n        1 |          4 |      w |    4\n        2 |          2 |      r |    2\n        2 |          2 |      w |    3\n</code></pre>\n\n<p>I'd like to augment this data with a couple of more fields called \"first_time\" and \"first_time_project\" that collectively identify first time any action by that person was seen and the first time that developer saw any action on the project. In the end, the data should look like this:</p>\n\n<pre><code>person_id | project_id | action | time | first_time | first_time_project\n------------------------------------------------------------------------\n        1 |          1 |      w |    1 |          1 |                  1\n        1 |          2 |      w |    2 |          1 |                  2\n        1 |          3 |      w |    2 |          1 |                  2\n        1 |          3 |      r |    3 |          1 |                  2\n        1 |          3 |      w |    4 |          1 |                  2\n        1 |          4 |      w |    4 |          1 |                  4\n        2 |          2 |      r |    2 |          2 |                  2\n        2 |          2 |      w |    3 |          2 |                  2\n</code></pre>\n\n<p>My naive way of doing this to write a couple of loops:</p>\n\n<pre><code>for (pid in unique(data$person_id)) {\n    data[data$pid==pid, \"first_time\"] = min(data[data$pid==pid, \"time\"])\n    for (projid in unique(data[data$pid==pid, \"project_id\"])) {\n        data[data$pid==pid &amp; data$project_id==projid, \"first_time_project\"] = min(data[data$pid==pid &amp; data$project_id==projid, \"time\"]\n    }\n}\n</code></pre>\n\n<p>Now, it doesn't take a genius to see that this is going to be glacially slow with the doubly nested loops. However, I can't figure out a way to handle this in R. I'm kinda emulating the group by option for SQL. I know that by might be able to help, but I can't figure out how to do multiple slices.</p>\n\n<p>Any hints on how to take my code from glacially slow to something a bit faster? I'd be happy with a snail right now.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":49,"score":-1,"question_id":12943685,"title":"Stacked time series plot using R","body":"<p>I have .csv file containing 34K lines, I would like to plot using stacked time series approach.Below shown sample of data and plot which I required given as hyperlink. Are there any R package to do this? As I am new to R, any tutorial link will be helpful.</p>\n\n<pre><code>bp     Total  Depth  place\n500      5      5      1\n5000     12     11     10\n50000    24     22      4\n500000   22     2       3\n5000000  28     26      2\n</code></pre>\n\n<p><a href=\"http://www.cam.cornell.edu/~sc932/ALE/doc/_images/Ecoli_first350k.ale.pdf.png\" rel=\"nofollow\">Example of plot</a></p>\n"},{"tags":["r","histogram","kernel-density"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12945951,"title":"R Programming: How to plot a density estimate on top of the histogram?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1497539/fitting-a-density-curve-to-a-histogram-in-r\">Fitting a density curve to a histogram in R</a>  </p>\n</blockquote>\n\n\n\n<p>x is a NAs free numeric vector.</p>\n\n<p>I run:</p>\n\n<blockquote>\n  <p>hist(x,density(x), prob=TRUE)</p>\n</blockquote>\n\n<p>Error Message I get:\nError in rank(x, ties.method = \"min\", na.last = \"keep\") : \n  unimplemented type 'list' in 'greater'</p>\n\n<p>It was suggested that I set prob =TRUE when calling hist. If you can explain that as well, it will be great. Thank you.</p>\n"},{"tags":["r","escaping","cat"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12945654,"title":"cat and \"\\b\"funky character in external file","body":"<p>I am attempting to cat homegrown LATEX output from R using cat but run into this snag that I suspect has to do with Encoding which I know nothing about or even where to start.</p>\n\n<p>Using cat like this:</p>\n\n<pre><code>cat(paste0(\"\\b\", paste0(1, 2, \"r\")))\n</code></pre>\n\n<p>Produces exactly what I expect in the console.  But:</p>\n\n<pre><code>cat(paste0(\"\\b\", paste0(1, 2, \"r\")), file=\"foo.txt\")\n</code></pre>\n\n<p>gives an odd square character where the \"\\b\" was (<a href=\"https://dl.dropbox.com/u/61803503/foo.txt\" rel=\"nofollow\">as seen HERE</a>).  I doubt this is a new problem for R/LATEX users creating home grown stuff but am obviously not searching with the right key words to find out an answer.</p>\n\n<ol>\n<li>What is happening?</li>\n<li>How do I fix it?</li>\n</ol>\n\n<p>EDIT: Per Dason's suggestion:</p>\n\n<pre><code>&gt; readLines(\"foo.txt\")\n[1] \"\\b 1 2 r\"\n</code></pre>\n"},{"tags":["r","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12824569,"title":"RSQLite typecasting issue","body":"<p>I'm trying to write a table from a SQLite database into an R data frame and have hit upon a problem that has me stumped. Here are the three first entries in the SQLite table I would like to import:</p>\n\n<pre><code>1|10|0|0|0|0|10|10|0|0|0|6|8|6|20000|30000|2012-02-29 21:27:07.239091|2012-02-29 21:28:24.815385|6|80.67.28.161|||||||||||||||||||||||||||||||33|13.4936||t|t|f||||||||||||||||||4|0|0|7|7|2\n2|10|0|0|0|0|0|0|0|2|2|4|5|4|20000|30000|2012-02-29 22:00:30.618726|2012-02-29 22:04:09.629942|5|80.67.28.161|3|7||0|1|3|0|||4|3|4|5|5|5|5|4|5|4|4|0|0|0|0|0|9|9|9|9|9|||1|f|t|f|||||||||||||k|text|l|||-13|0|3|10||2\n3|13|2|4|4|4|4|1|1|2|5|6|3|2|40000|10000|2012-03-01 09:07:52.310033|2012-03-01 09:21:13.097303|6|80.67.28.161|2|2||30|1|1|0|||4|2|1|6|8|3|5|6|6|7|6|||||||||||26|13.6336|4|f|t|f|t|f|f|f|f|||||||||some text||||10|1|1|3|2|3\n</code></pre>\n\n<p>What I'm interested in are columns 53 through 60, which, to save you the trouble of counting in the above, look like this:</p>\n\n<pre><code>|t|t|f||||||\n|f|t|f||||||\n|f|t|f|t|f|f|f|f|\n</code></pre>\n\n<p>As you can see for the first two entries only the first three of those columns are not NULL while for the third entry all eight columns have values assigned to them.</p>\n\n<p>Here's the SQLite table info for those columns</p>\n\n<pre><code>sqlite&gt; PRAGMA table_info(observations);\n0|id|INTEGER|1||1\n** snip **\n53|understanding1|boolean|0||0\n54|understanding2|boolean|0||0\n55|understanding3|boolean|0||0\n56|understanding4|boolean|0||0\n57|understanding5|boolean|0||0\n58|understanding6|boolean|0||0\n59|understanding7|boolean|0||0\n60|understanding8|boolean|0||0\n** snip **\n</code></pre>\n\n<p>Now, when I try to read this into R here's what those same columns end up becoming:</p>\n\n<pre><code>&gt; library('RSQLite')\n&gt; con &lt;- dbConnect(\"SQLite\", dbname = 'db.sqlite3))\n&gt; obs &lt;- dbReadTable(con,'observations')\n&gt; obs[1:3,names(obs) %in% paste0('understanding',1:8)]\n  understanding1 understanding2 understanding3 understanding4 understanding5 understanding6 understanding7\n1              t              t              f             NA             NA             NA             NA\n2              f              t              f             NA             NA             NA             NA\n3              f              t              f              0              0              0              0\n  understanding8\n1             NA\n2             NA\n3              0\n</code></pre>\n\n<p>As you can see, while the first three columns contain values that are either <code>'t'</code> or <code>'f'</code> the other columns are <code>NA</code> where the corresponding values in the SQLite table are NULL and <em><code>0</code></em> where they are not - irrespective of whether the corresponding values in the SQLite table are <code>t</code> or <code>f</code>. Needless to say this is not the behavior I expected. The problem is, I think, that these columns are typecasted incorrectly:</p>\n\n<pre><code>&gt; sapply(obs[1:3,names(obs) %in% paste0('understanding',1:8)], class)\nunderstanding1 understanding2 understanding3 understanding4 understanding5 understanding6 understanding7 \n   \"character\"    \"character\"    \"character\"      \"numeric\"      \"numeric\"      \"numeric\"      \"numeric\" \nunderstanding8 \n     \"numeric\" \n</code></pre>\n\n<p>Could it be that RSQLite sets the first three columns to the <code>character</code> type upon seeing <code>t</code> and <code>f</code> as values in the corresponding columns in the first entry but goes with <code>numeric</code> because in these columns the first entry just happens to be NULL?</p>\n\n<p>If this is indeed what's happening is there any way of working around this and casting all these columns into <code>character</code> (or, even better, <code>logical</code>)?</p>\n"},{"tags":["python","r","rpy2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":12944250,"title":"handing Null return in rpy2","body":"<p>I am using rpy2 to call R function from python. </p>\n\n<pre><code>from rpy2.robjects import *\nresult=r.someFunctioninR()   #someFunctioninR is a R function written by myself\nif result==r('as.null()'):\n     do something\nelse:\n     do something else\n</code></pre>\n\n<p>The \"result\" returned by someFunctioninR() can be either NULL or other format. result==r('as.null()') does not work. Is there any other way I can get a True when result is NULL?</p>\n"},{"tags":["r","list"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":159,"score":4,"question_id":11641701,"title":"Sum a list of matrices","body":"<p>I have a list where each element is a 5*5 matrix. Eg</p>\n\n<pre><code>[[1]]   \n           V1          V2          V3          V4          V5      \n      [1,]   0.000000   46.973700   21.453500  338.547000   10.401600 \n      [2,]  43.020500    0.000000  130.652000  840.526000   56.363700 \n      [3,]  12.605600  173.238000    0.000000  642.075000   19.628100 \n      [4,] 217.946000  626.368000  481.329000    0.000000  642.341000 \n      [5,] 217.946000  626.368000  481.329000    0.000000  642.341000 \n[[2]]   \n           V1          V2          V3          V4          V5      \n      [1,]   0.000000   47.973700   21.453500  338.547000   10.401600 \n      [2,]  143.020500    0.000000  130.652000  840.526000   56.363700 \n      [3,]  312.605600  17.238000    0.000000  642.075000   19.628100 \n      [4,]  17.946000  126.368000  481.329000    0.000000  642.341000\n      [5,] 217.946000  626.368000  481.329000    0.000000  642.341000  \n...\n</code></pre>\n\n<p>How can I use an apply-like function to sum matrix [1] to [n],  and return a 5*5 matrix as a result (each element is a sum of the corresponding elements in each of the matrix in the list) ?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":12945113,"title":"Finding peaks in vector","body":"<p>I'm trying to find \"peaks\" in a vector, i.e. elements for which the nearest neighboring elements on both sides that do not have the same value have <strong>lower</strong> values.</p>\n\n<p>So, e.g. in the vector</p>\n\n<pre><code>c(0,1,1,2,3,3,3,2,3,4,5,6,5,7)\n</code></pre>\n\n<p>there are peaks at positions 5,6,7,12 and 14</p>\n\n<p><a href=\"http://stackoverflow.com/questions/6836409/finding-local-maxima-and-minima-in-r\">Finding local maxima and minima in R</a> comes close, but doesn't quite fit.</p>\n"},{"tags":["list","r","dictionary","lookup"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":911,"score":2,"question_id":3737194,"title":"Dictionary data structure in R","body":"<p>In R, I have, for example:</p>\n\n<pre><code>&gt; foo &lt;- list(a=1,b=2,c=3)\n</code></pre>\n\n<p>If I type <code>foo</code>, I get:</p>\n\n<pre><code>$a\n[1] 1\n\n$b\n[1] 2\n\n$c\n[1] 3\n</code></pre>\n\n<p>How can I look through <code>foo</code> to get a list of \"keys\" only? In this case, (a, b, c).</p>\n"},{"tags":["r","table","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12944921,"title":"From table to data.frame","body":"<p>I have a table that looks like:</p>\n\n<pre><code>dat = data.frame(expand.grid(x = 1:10, y = 1:10),\n             z = sample(LETTERS[1:3], size = 100, replace = TRUE))\ntabl &lt;- with(dat, table(z, y))\n\ntabl\n   y\nz   1 2 3 4 5 6 7 8 9 10\n  A 5 3 1 1 3 6 3 7 2  4\n  B 4 5 3 6 5 1 3 1 4  4\n  C 1 2 6 3 2 3 4 2 4  2\n</code></pre>\n\n<p>Now how do I transform it into a data.frame that looks like</p>\n\n<pre><code>    1 2 3 4 5 6 7 8 9 10\n  A 5 3 1 1 3 6 3 7 2  4\n  B 4 5 3 6 5 1 3 1 4  4\n  C 1 2 6 3 2 3 4 2 4  2\n</code></pre>\n"},{"tags":["r","reshape"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":164,"score":4,"question_id":11076626,"title":"How to suppress warning messages from cast()","body":"<p>I use <code>cast()</code> from the <code>reshape</code> package quite frequently. Almost every time, this warning pops up: </p>\n\n<p><code>Aggregation requires fun.aggregate: length used as default</code></p>\n\n<p>I've tried to set <code>options( warn =-1)</code>, to no avail. How does one suppress these warnings? </p>\n"},{"tags":["r","emacs","ess"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":52,"score":3,"question_id":12861261,"title":"emacs ess crashes when trying to access h_elp","body":"<p>My emacs/ess session crashes when I try to access help. This happens if I have two packages loaded with the same functions; for example:</p>\n\n<pre><code>library(lubridate)\nlibrary(data.table)\n?month\n</code></pre>\n\n<p>In Rgui interface pops out and asks to choose from which packages I want help. Emacs just crashes. Similar issues happens with install.packages, but there is a way to specify mirror <a href=\"http://stackoverflow.com/questions/6630246/is-there-a-way-to-install-r-packages-using-emacs\">Is there a way to install R packages using emacs?</a>\nIs there a similar trick with help?</p>\n"},{"tags":["r","ggplot2","color-scheme","kernel-density"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":112,"score":4,"question_id":12944357,"title":"Overlay 10 density plots in R with colour proportional to number of overlapping plots","body":"<p>I have a dataset with 224900 observations and 10 variables which are the result of different Taylor series back transformations to original data values. I wish to overlay the density plots of each of these 10 variables to show the level of robustness of the Taylor series back transformation on the data estimates. Rather than having just 10 lines,  I thought it would be good to have a colour apply, so that each density plot contributes 10% of a grey scale. Where there is data that just relates to one of the plots, there would be 10% grey, two plots would be twice as dark at 20%, up to where all the density plots overlap, which would be 100%.</p>\n\n<p>I have used <code>melt</code> to get a dataframe that is 2249000 rows long. There are three columns, the first is the person ID, the second is the grouping variable (<code>variable</code>), and the third is the value of daily kJ intake (<code>value</code>).</p>\n\n<p>I have used the following code to overlay the density plots in <code>ggplot2</code> but it uses different colours for the groups. How can I change this code to get my grey scale? I want all 10 groups to have the same colour and colour density; the purpose of the plot is simply to to visually show the amount of overlap on the density plot using greyscale.</p>\n\n<pre><code>ggplot(Energy, aes(x=value, fill=variable)) + geom_density(alpha = 0.5)\n</code></pre>\n\n<p>Some test data to play with for those wishing to help, using 5 groups and not 10:</p>\n\n<pre><code>variable &lt;- c(rep(\"A\",100), rep(\"B\",100), rep(\"C\",100), rep(\"D\",100), rep(\"E\",100))\nvalue &lt;- c(rnorm(100,5000,200), rnorm(100,5050,210), rnorm(100,5100,215), \n           rnorm(100,5150,220), rnorm(100,5200,225))\nMyData &lt;- cbind.data.frame(value, variable)\nggplot(MyData, aes(x=value, fill=variable)) + geom_density(alpha = 0.5)\n</code></pre>\n\n<p>I think the answer may be associated with modifying <code>scale_colour_grey</code> and/or <code>scale_manual</code> but I don't understand enough to work this out myself.</p>\n"},{"tags":["r","loops","scatter"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12934655,"title":"loop pdf from similar datasets","body":"<p>I have sixty datasets labled dataset1 to dataset 60\nAll datasets are structured in the same way but have different data.\nI want to get a scatterplot of 2 variables from these datasets and exported to 60 different pdf files.\nI tried the code below, and I get 60 pdf files, but they are all the same</p>\n\n<pre><code> for (i in 1:60)\n {\n pdf(sprintf(\"C:/Users/ME/Desktop/WWD/WWD-Excel/Print/myout[%d].pdf\", i))\n dataset&lt;-read.csv(sprintf(\"C:/Users/ME/Desktop/WWD/WWD-Excel/CSV/dataset[%d].csv\", i), header = T, sep = \",\", na.strings = \"NA\")\n plot(dataset$hhexppc, dataset$foodshare)\n dev.off()\n }\n</code></pre>\n"},{"tags":["r","quantmod"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":12943303,"title":"Error in getSymbols, must use auto.assign=TRUE for multiple symbol requests","body":"<p>I'm trying to write a program that would take a .csv file of stock symbols and test them against each other for things like cointegration. However, when I run the following code quatnmod gives me something about having to use auto.assign = TRUE for multiple symbol requests. </p>\n\n<pre><code>getprices&lt;-function(sym){\n  #get prices from last 7 years\n  prices&lt;-getSymbols(sym, from = Sys.Date() - (365*7), auto.assign=FALSE)\n  #exract closing prices\n  prices&lt;-Cl(prices)\n\n  return(prices)}\n\n\nsymbols1 &lt;- c('TSN', 'MSFT')\nsymbols2 &lt;- c('AAPL', 'NFLX')\n\ncontainer&lt;-c()\naddprices &lt;- function(symbols1, symbols2){\n   for (i in symbols1){\n    for (g in symbols2){\n      i&lt;-getprices(i)\n      g&lt;-getprices(g)\n      container &lt;- i+g\n      }\n     }\n    return(container)\n    }\n</code></pre>\n\n<p>When I run addprices(symbols1, symbols2) I get this error:</p>\n\n<pre><code>Error in getSymbols(sym, from = Sys.Date() - (365 * 7), auto.assign = FALSE) : \n  must use auto.assign=TRUE for multiple Symbols requests\nCalls: addprices -&gt; getprices -&gt; getSymbols\n</code></pre>\n\n<p>I know when I do this I should get that error, and I believe this is what the error is referring to:</p>\n\n<pre><code>getSymbols(sym, from = Sys.Date() - (365 * 7), auto.assign = FALSE)\n</code></pre>\n\n<p>However, what I'm doing isn't that, so what gives? Any advice? Is there a work around? </p>\n\n<p>I googled this and there really weren't any relevant questions/answers. </p>\n"},{"tags":["r","xts"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12836424,"title":"Intraday high/low clustering","body":"<p>I am attempting to perform a study on the clustering of high/low points based on time. I managed to achieve the above by using <code>to.daily</code> on intraday data and merging the two using:</p>\n\n<pre><code>intraday.merge &lt;- merge(intraday,daily)\nintraday.merge &lt;- na.locf(intraday.merge)\nintraday.merge &lt;- intraday.merge[\"T08:30:00/T16:30:00\"] # remove record at 00:00:00\n</code></pre>\n\n<p>Next, I tried to obtain the records where the high == daily.high/low == daily.low using:</p>\n\n<pre><code>intradayhi &lt;- test[test$High == test$Daily.High]\nintradaylo &lt;- test[test$Low == test$Daily.Low]\n</code></pre>\n\n<p>Resulting data resembles the following:</p>\n\n<pre><code>                     Open  High   Low Close Volume Daily.Open Daily.High Daily.Low Daily.Close Daily.Volume\n2012-06-19 08:45:00 258.9 259.1 258.5 258.7   1424      258.9      259.1     257.7       258.7        31523\n2012-06-20 13:30:00 260.8 260.9 260.6 260.6   1616      260.4      260.9     259.2       260.8        35358\n2012-06-21 08:40:00 260.7 260.8 260.4 260.5    493      260.7      260.8     257.4       258.3        31360\n2012-06-22 12:10:00 255.9 256.2 255.9 256.1    626      254.5      256.2     253.9       255.3        50515\n2012-06-22 12:15:00 256.1 256.2 255.9 255.9    779      254.5      256.2     253.9       255.3        50515\n2012-06-25 11:55:00 254.5 254.7 254.4 254.6   1589      253.8      254.7     251.5       253.9        65621\n2012-06-26 08:45:00 253.4 254.2 253.2 253.7   5849      253.8      254.2     252.4       253.1        70635\n2012-06-27 11:25:00 255.6 256.0 255.5 255.9    973      251.8      256.0     251.8       255.2        53335\n2012-06-28 09:00:00 257.0 257.3 256.9 257.1    601      255.3      257.3     255.0       255.1        23978\n2012-06-29 13:45:00 253.0 253.4 253.0 253.4    451      247.3      253.4     246.9       253.4        52539\n</code></pre>\n\n<p>There are duplicated results using the subset, how do I achieve only the first record of the day? I would then be able to plot the count of records for periods in the day.</p>\n\n<p>Also, are there alternate methods to get the results I want? Thanks in advance.</p>\n\n<p>Edit:</p>\n\n<p>Sample output should look like this, count could either be 1st result for day or aggregated (more than 1 occurrence in that day):</p>\n\n<pre><code>Time        Count\n08:40:00    60\n08:45:00    54\n08:50:00    60\n...\n14:00:00    20\n14:05:00    12\n14:10:00    30\n</code></pre>\n"},{"tags":["regex","r"],"answer_count":2,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":114,"score":7,"question_id":12940851,"title":"escaping pipe (\"|\") in a regex","body":"<p>I have a need to split on words and end marks (punctuation of certain types).  Oddly pipe (\"|\") can count as an end mark.  I have code that words on end marks until I try to add the pipe.  Adding the pipe makes the <code>strsplit</code> every character.  Escaping it causes and error.  How can I include the pipe int he regular expression?</p>\n\n<pre><code>x &lt;- \"I like the dog|.\"\n\nstrsplit(x, \"[[:space:]]|(?=[.!?*-])\", perl=TRUE)\n#[[1]]\n#[1] \"I\"    \"like\" \"the\"  \"dog|\" \".\"   \n\nstrsplit(x, \"[[:space:]]|(?=[.!?*-\\|])\", perl=TRUE)\n#Error: '\\|' is an unrecognized escape in character string starting \"[[:space:]]|(?=[.!?*-\\|\"\n</code></pre>\n\n<p>The outcome I'd like:</p>\n\n<pre><code>#[[1]]\n#[1] \"I\"    \"like\" \"the\"  \"dog\"  \"|\"  \".\"  #pipe is an element\n</code></pre>\n"},{"tags":["r","xts"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":12903606,"title":"How to handle 'Series contains non-leading NAs' in TTR library with xts objects?","body":"<p>I often run into the same issue of how to handle NA values when modelling quantitative trading models. The example below is about a stock with EOD data since 1997-01-01 stored in a xts object with four columns named \"High\",\"Low\",\"Close\",\"Volume\". The data is from Bloomberg. When I want to calculate rolling 20-day volume the error message occurs:</p>\n\n<pre><code>SMA(stock$Volume, 20)\nError in runSum(x, n) : Series contains non-leading NAs  \n</code></pre>\n\n<p>I quickly located the problem (which I knew was NA values since I have tried this a 1000 times) and found the two days where volume data is missing. I have reproduced those days' data below. As a quick observation the <code>SMA</code>, <code>EMA</code> etc. functions in TTR cannot handle NAs if they are preceded by numbers and followed by numbers.</p>\n\n<pre><code>stock &lt;- as.xts(matrix(c(94.46,92.377,94.204,NA,71.501,70.457,70.979,NA), 2, 4,\n  byrow = TRUE, dimnames = list(NULL, c(\"High\",\"Low\",\"Close\",\"Volume\"))),\n  as.Date(c(\"1998-07-07\", \"1999-02-22\")))\n</code></pre>\n\n<p>What is the best way to handle this issue? Is it to store the <code>stock$Volume</code> as a temporary object where NA values are removed and then calculate the rolling volume and the merge it back in with <code>merge.xts</code> while adding the <code>fill = NA</code> so NA values are inserted again? But is that correct since you take the last 20 trading days and not just the 19 available in the 20-day window?</p>\n\n<p>It is my hope that some sort of \"best practice\" can be the outcome of this post as I assume this issue also happens for other R-users in finance whether they get their data from Bloomberg, Yahoo Finance or another source.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":49,"score":1,"question_id":12941972,"title":"Sample Covariance for 2 vectors","body":"<p>Im trying to caclulate sample covariance between these two vecotrs. I defined a function with two input variables. I dont know if it is correct? Also my formula for sample covariance wont run. Can anyone help me write it out in R?</p>\n\n<pre><code>  xv = c(1., 5.5, 7.8, 4.2, -2.7, -5.4, 8.9)\n  yv = c(0.1, 1.5, 0.8, -4.2, 2.7, -9.4, -1.9)\n  sampleCov= function(x,y){ \n    cov(xv,yv) = frac{sum_{i=1}^{n}(x_i-\\mu_x)(y_i-\\mu_y)}{n-1}].\n    return (Cov(xv,yv)\n</code></pre>\n\n<p>}</p>\n"},{"tags":["r","grouping"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12941956,"title":"In R, how to return the observation groups, not the number of observations?","body":"<p>I have a large data frame that I am attempting to run a <code>for loop</code>, but need to get all the different observations first.  The process that I am currently trying to approach is this:</p>\n\n<ol>\n<li>Create a list/vector/data frame of the observation</li>\n<li>Use each observation in a <code>for loop</code></li>\n</ol>\n\n<p>Here is how I tackled it: </p>\n\n<p>Generate some data:</p>\n\n<pre><code>x &lt;- gl(12,5)\n</code></pre>\n\n<p>The result I am looking for is a list of all the different observations:</p>\n\n<pre><code>1 2 3 4 5 6 7 8 9 10 11 12\n</code></pre>\n\n<p>I could create a <code>data frame</code>, then drop the number columns like this:</p>\n\n<pre><code>list &lt;- data.frame(table(x))\n\nlist[,2] &lt;- NULL\n\nprint(list)\n</code></pre>\n\n<p>From this list/vector/dataframe, I would run through the <code>for loop</code> like so:</p>\n\n<pre><code>for (i in list) print(i)\n</code></pre>\n\n<p>There must be a more efficient way to get the list for the <code>for loop</code>.  Can someone suggest one?</p>\n"},{"tags":["r","gnuplot","timeline"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":89,"score":1,"question_id":12941949,"title":"How to plot timelines with R or Gnuplot","body":"<p>What is the best and easy way to plot, with R or Gnuplot, timelines like in this picture:</p>\n\n<p><img src=\"http://i.stack.imgur.com/ojETX.gif\" alt=\"enter image description here\"></p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":80,"score":3,"question_id":12940343,"title":"Can I write to and access a file in memory in R?","body":"<p>I am writing tests for an R function that imports an xml file, <code>settings.xml</code>.</p>\n\n<p>Currently, when I write a test for functions that depend on the contents of <code>foo.xml</code>, including the function <code>read.settings</code> in the following example:</p>\n\n<pre><code>writeLines(\"&lt;fee&gt;&lt;fi&gt;&lt;\\fi&gt;\\fee&gt;\", con = \"/tmp/foo.xml\")\nsettings &lt;- read.settings(\"/tmp/foo.xml\")\nfile.remove(\"/tmp/foo.xml\")\n</code></pre>\n\n<p>But a number of issues have come up related to making the test system-independent. For example, <code>/tmp/</code> may not be writeable or an error in <code>read.settings()</code> leaves an orphaned file in the test directory, etc. This is a trivial example and I can think of ways around these issues, but I recall such a solution in an answer to a previous question, which I now can not find, in which the <code>con</code> is not a file but an object in memory. I am sure that there are many situations in which it would be useful not to actually write a file.</p>\n\n<ul>\n<li>Is there a way to write and access a pseudo-file that only exists in memory?</li>\n<li>where is the feature documented?<br>\n<code>?connections</code> appears to be a good lead, but it is not clear to me how to use the information provided</li>\n</ul>\n\n<p>As follow up (but not to be too open-ended)</p>\n\n<ul>\n<li>What are the primary uses of such a feature beyond what I described above?</li>\n<li>Are situations in which this feature should not be used?</li>\n</ul>\n"},{"tags":["r","plyr"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":81,"score":4,"question_id":12938765,"title":"Efficient way to apply a function to a list of lists","body":"<p>I have 80 lists for the project in question. Each list is a list of length 1000. I'd like to run a function on each one (each of the 1000), and assign the results back to the original object. The total data is over 150 gigs so I want to make sure this is most efficient before running it on the actual data. Is this trivial example the best way to do what I need?</p>\n\n<pre><code># my actual function is obviously more complicated.\n# But let's say the goal is to keep 2/5 items in each list\ntrivial &lt;- function(foo) {\nkeep &lt;- c(\"S1\", \"S2\")\nfoo[which(keep %in% names(foo))]\n}\n\nsublist &lt;- replicate(5, as.list(1:5), simplify=FALSE)\nnames(sublist) &lt;- paste0(\"S\", 1:5)\neachlist &lt;- replicate(5, sublist, simplify = F)\na1 &lt;- a2 &lt;- a3 &lt;- a4 &lt;- a5 &lt;- eachlist\n\n# To clarify the layout\nlength(a1)\n[1] 5\n&gt; length(a1[[1]])\n[1] 5\n&gt; names(a1[[1]])\n[1] \"S1\" \"S2\" \"S3\" \"S4\" \"S5\"\n# I need to drop S3-S5 from each of 5 sublists of a1.\n# Now I'd like to repeat this for all 80 lists named a[0-9].\n\n\n# all the objects have a pattern sometextNUMBER. This list is \n# just the names of all the lists.\nlistz &lt;-  as.list(ls(pattern=\"[a-z][0-9]\"))\n&gt; listz\n[[1]]\n[1] \"a1\"\n\n[[2]]\n[1] \"a2\"\n\n[[3]]\n[1] \"a3\"\n\n[[4]]\n[1] \"a4\"\n\n[[5]]\n[1] \"a5\"\n# I don't need anything returned, just for a1-a80 updated such that\n# in each sublist, 3 of 5 items are dropped.\n\n# This works fine, but my concern now is just scaling this up.\nl_ply(listz, function(x){\n     assign(as.character(x), llply(get(x), trivial), envir = .GlobalEnv)\n    })\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":67,"score":-1,"question_id":12931262,"title":"Split and compare the splitted elements","body":"<p>I have a data.frame (9 columns and 5 rows) that looks like:   </p>\n\n<blockquote>\n<pre><code> List    Count \n  R472    1   RAP1GDS1    AKT1    ERC1    ZRSR2   SMAD4   ASXL1   NA\n  R47     1   TCF12       DICER1  OLIG2   GATA3   CLP1    SMAD4   NA\n  R844    2   RNF213      LHFP    MLLT6   TTL    SMARCA4   AKT2   TSC2\n  R845    2   MLL         MYH9    FBXW7   VTI1A   CLP1     NF2    PIK3CA\n  R975    2   TCF12       ELK4    PDE4DIP FANCG   ZRSR2   FAM123B FCRL4\n</code></pre>\n</blockquote>\n\n<p>I would like to split the data into groups according to column \"Count\" and then make a comparison of the corresponding elements to find the differences (and to annotate them) and the similarities. \nEx:\nDesired output:    </p>\n\n<blockquote>\n<pre><code> Count1      Common   How_many_similar   Differences   How_many_different\n             SMAD4           1            RAP1GDS1             10  \n                                            AKT1\n                                            ERC1\n                                            ....\n</code></pre>\n</blockquote>\n\n<p>Can anyone help me?</p>\n\n<p>Thanks.</p>\n"},{"tags":["performance","r","matrix","sparse-matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12937043,"title":"Efficiency problems building a \"signature matrix\" using data from two (sparse) matrices in R","body":"<p>I don't know if the \"signature matrix\" I am trying to build has a proper pre-existing name or definition in any fields, but the following code appears to generate the correct result on some toy matrices. I have trouble explaining what exactly I am trying to do without causing confusion, but if the code I have provided isn't sufficient to deduce what I am trying to do, I'd be happy to give it a shot.</p>\n\n<p>When I run this code with my actual data (two integer matrices that are both approximately 300 by 20,000 elements in size) it appears to be working, but after hours and hours it still doesn't finish.</p>\n\n<p>I understand that the iteration might be the biggest problem here, but I haven't been able to work out how to remove it.</p>\n\n<p>The code:</p>\n\n<pre><code># Load required library\nlibrary(Matrix)\n\n# Load in the test data\nmut &lt;- matrix(data=c(1,1,1,0,0,0,0,1,0,1,1,0,0,1,1,0,0,0,1,0),\n              nrow=5,ncol=4,\n              dimnames=list(c(\"p1\",\"p2\",\"p3\",\"p4\",\"p5\"),c(\"GA\",\"GB\",\"GC\",\"GD\")))\n\noute &lt;- matrix(data=c(1,1,0,1,0,1,0,0,1,1,1,1,1,0,0,1,1,0,0,1),\n              nrow=5,ncol=4,\n              dimnames=list(c(\"p1\",\"p2\",\"p3\",\"p4\",\"p5\"),c(\"GQ\",\"GW\",\"GE\",\"GR\")))\n\npatOutMatrix &lt;- Matrix(data=oute,sparse=TRUE)\npatMutMatrix &lt;- Matrix(data=mut,sparse=TRUE)\n\ntransposePatMutMatrix &lt;- t(patMutMatrix)\n\n# Build the empty matrix (with row and col names)\nsigMatrix &lt;- Matrix(0,nrow=ncol(patMutMatrix), ncol=ncol(patOutMatrix),sparse=TRUE)\nrownames(sigMatrix) &lt;- colnames(patMutMatrix)\ncolnames(sigMatrix) &lt;- colnames(patOutMatrix)\n\n# Populate sigMatrix\nfor (mgene in rownames(transposePatMutMatrix))\n{\n  a &lt;- patOutMatrix[which(transposePatMutMatrix[mgene, ] == 1, arr.ind = T), ]\n\n  # Using an IF here to get around a problem with colSums() not working on single rows\n  sigMatrix[mgene,] &lt;- if (dim(as.matrix(a))[2] == 1) {\n    a\n  } else {\n    colSums(patOutMatrix[which(transposePatMutMatrix[mgene, ] == 1, arr.ind = T), ])\n  }\n}\n</code></pre>\n\n<p>Does anyone know how I could change anything here to make this perform faster?</p>\n"},{"tags":["regex","r"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":12940451,"title":"How to parse html string using R?","body":"<p>How to grep data item from this html string</p>\n\n<pre><code>a &lt;- \"&lt;div class=\\\"tst-10\\\"&gt;100%&lt;/div&gt;\"\n</code></pre>\n\n<p>so that the result is 100%? The main idea is to get data between > &lt;.</p>\n"},{"tags":["r","table","latex","data.frame","xtable"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":96,"score":1,"question_id":12766379,"title":"xtable: Removing rownames but keeping &","body":"<p>In xtable, is there any way to print a latex table without rownames, but while keeping <code>&amp;</code> on the left hand side?</p>\n\n<p>I also don't want to set the rownames to NA in my data matrix to achieve this feat. </p>\n\n<p>Example:</p>\n\n<pre><code>require(xtable)\no &lt;- do.call(cbind,lapply(1:10,function(i) matrix(rnorm(10)) ))\nprint(xtable(o))\n</code></pre>\n\n<p>We can see on the LHS of this output, there's <code>1,2,3,4,...,10</code>. This is bad. I don't want this.</p>\n\n<p>However</p>\n\n<p><code>print(xtable(o),include.rownames=FALSE)</code></p>\n\n<p>doesn't give me what I want because it deletes the <code>&amp;</code> at the LHS of the matrix.</p>\n"},{"tags":["r","modeling","svm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12934582,"title":"Svm modeling :: Error in which.max(votematrix[, x]) : subscript out of bounds","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12931754/svm-modeling-error-in-which-maxvotematrix-x-subscript-out-of-bounds\">Svm modeling :: Error in which.max(votematrix[, x]) : subscript out of bounds</a>  </p>\n</blockquote>\n\n\n\n<p>Having a classification problem, I am using SVM for prediction in R. In dataset, there are integer as well as categorical variables. I got error while predicting with predict method.</p>\n\n<pre><code>svp3c &lt;- ksvm(input_dataset3$isCRgt3~., data=input_dataset3,type=\"C-svc\")\np3&lt;-predict(svp3c,newdata=input_dataset_prediction[,-1],type=\"response\")\nerror :: Error in which.max(votematrix[, x]) : subscript out of bounds\n</code></pre>\n\n<p>For this modeling</p>\n\n<p>First : developed model with training dataset</p>\n\n<p>second : saved and Load model for prediction on testing dataset</p>\n\n<p>Training Dataset sample</p>\n\n<pre><code>Headning :\nhead1(int),head2(character-url),head3(character-url),head4(character-url),head5(character),head6(character),haed7(int),head8(int),head9(int),head10(int),head11(int)\n\nData:    \n\"0\",\"10\",\"/\",\"/index.php?main_page=logoff\",\"(not set)\",\"rc317a\",\"organic\",\"0\",\"4\",\"20092\",\"5023\",\"0\"\n\"1\",\"11\",\"/\",\"/offwhite-churidar-kameez-set-p-17381.html\",\"(not set)\",\"rc317a\",\"organic\",\"0\",\"4\",\"20092\",\"5023\",\"0\"\n</code></pre>\n\n<p>Can any one give suggestion?</p>\n"},{"tags":["r","pattern-matching","data.frame"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12938798,"title":"How to reference values in one data frame according to those in another data frame?","body":"<p>I am new to R and am puzzled by this problem when manipulating some environmental monitoring data.</p>\n\n<p>I have two datasets recording the actual monitoring time-series and the monitoring site information, respectively. I stored them in two data frames <code>monitoring</code> and <code>sites</code>:</p>\n\n<p><code>monitoring:</code></p>\n\n<pre><code>                  date       site obs\n 1 2001-01-01 10:00:00  riverside  NA\n 2 2001-01-01 11:00:00  riverside  52\n 3 2001-01-01 12:00:00  riverside  52\n 4 2001-01-01 13:00:00  riverside  56\n 5 2001-01-01 10:00:00       dorm  52\n 6 2001-01-01 11:00:00       dorm  64\n 7 2001-01-01 12:00:00       dorm  76\n 8 2001-01-01 13:00:00       dorm  80\n 9 2001-01-01 10:00:00        kfc  78\n10 2001-01-01 11:00:00        kfc  74\n11 2001-01-01 12:00:00        kfc  66\n12 2001-01-01 13:00:00        kfc  68\n</code></pre>\n\n<p><code>sites:</code></p>\n\n<pre><code>        site       type\n 1      DORM   suburban\n 2       KFC      urban\n 3 RIVERSIDE      rural\n</code></pre>\n\n<p>I want to add a <code>site.type</code> column in <code>monitoring</code> with information extracted from <code>sites</code> as shown below:</p>\n\n<pre><code>                  date       site obs site.type\n 1 2001-01-01 10:00:00  riverside  NA     rural\n 2 2001-01-01 11:00:00  riverside  52     rural\n 3 2001-01-01 12:00:00  riverside  52     rural\n 4 2001-01-01 13:00:00  riverside  56     rural\n 5 2001-01-01 10:00:00       dorm  52  suburban\n 6 2001-01-01 11:00:00       dorm  64  suburban\n 7 2001-01-01 12:00:00       dorm  76  suburban\n 8 2001-01-01 13:00:00       dorm  80  suburban\n 9 2001-01-01 10:00:00        kfc  78     urban\n10 2001-01-01 11:00:00        kfc  74     urban\n11 2001-01-01 12:00:00        kfc  66     urban\n12 2001-01-01 13:00:00        kfc  68     urban\n</code></pre>\n\n<p>I tried <code>grep()</code> in the following command:</p>\n\n<pre><code>for (i in 1:nrow(monitoring)) {\n  monitoring$site.type[i] &lt;- as.character(sites$type[grep(monitoring$site[i], sites$site, ignore.case = T)])\n}\n</code></pre>\n\n<p>It worked OK on this small example set of <code>monitoring</code>. However, when I applied it to my real dataset with 654,525 records, it never stopped running on my i5-2400 computer with 16 GB RAM...</p>\n\n<p>I tried to search for existing questions on stackoverflow and did find some answers offering the same solution to similar scenarios, so was even more confused why it did not work in my case. Therefore,</p>\n\n<ol>\n<li>Could someone kindly point out where the problem is?</li>\n<li>May I ask how to avoid <code>for</code> looping in this case, as it may\nnot be as \"fashionable\" and efficient? :)</li>\n</ol>\n\n<p>Many thanks in advance.</p>\n"},{"tags":["r","correlation"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":12925213,"title":"Prevent cex from scaling with the correlation coefficient in chart.Correlation()","body":"<p>I'm trying to plot a huge matrix of correlation coefficients, and currently, my plot looks like this:\n<img src=\"http://i.stack.imgur.com/cZLfl.png\" alt=\"Notice that some cells are missing correlation coefficients\"></p>\n\n<p>Notice that some cells are missing correlation coefficients (ignore for now that lack of symmetry of the plot, unless you happen know why that's the case, too). I believe that the values are not, in fact, missing, but simply too small to appear, because they are scaled by the value of their correlation coefficient.</p>\n\n<p>Looking at the documentation for chart.Correlation(), I was able to find a function from which much of the content of chart.Correlation() was modeled:</p>\n\n<pre><code>panel.cor &lt;- function(x, y, digits=2, prefix=\"\", cex.cor)\n{\n    usr &lt;- par(\"usr\"); on.exit(par(usr))\n    par(usr = c(0, 1, 0, 1))\n    r &lt;- abs(cor(x, y))\n    txt &lt;- format(c(r, 0.123456789), digits=digits)[1]\n    txt &lt;- paste(prefix, txt, sep=\"\")\n    if(missing(cex.cor)) cex &lt;- 0.8/strwidth(txt)    \n    test &lt;- cor.test(x,y)\n    # borrowed from printCoefmat\n    Signif &lt;- symnum(test$p.value, corr = FALSE, na = FALSE,\n                  cutpoints = c(0, 0.001, 0.01, 0.05, 0.1, 1),\n                  symbols = c(\"***\", \"**\", \"*\", \".\", \" \"))\n\n    text(0.5, 0.5, txt, cex = cex * r)\n    text(.8, .8, Signif, cex=cex, col=2)\n}\npairs(USJudgeRatings[,c(2:3,6,1,7)], lower.panel=panel.smooth, upper.panel=panel.cor)\n</code></pre>\n\n<p>If I change:</p>\n\n<pre><code>text(0.5, 0.5, txt, cex = cex * r)\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>text(0.5, 0.5, txt, cex = 0.8)\n</code></pre>\n\n<p>I get roughly the effect I'm looking for. The problem is that I have no idea how to change this parameter using chart.Correlation() itself. Does issue this make sense?</p>\n"},{"tags":["r","regression"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":18,"score":0,"question_id":12939808,"title":"vif() output in r","body":"<p>I am running a logistic regression in R and am attempting to determine if multicollinearity is a problem with my model. When I run vif() on my final model, I get GVIF and GVIF^1/(2*Df) columns. From what I have read GVIF^1/(2*Df) is what I should use to assess muticollinearity, but I have been unable to determine what values I should use as a cut-off point. Any help would be greatly appreciated.</p>\n"},{"tags":["r","multi-dimensional-scaling"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":33,"score":-2,"question_id":12939674,"title":"R: Parallel multidimensional scaling","body":"<p>I would like to visualize a big data set with R's MDS.\nComputing the pairwise distances is done with distmc() from the package Rlof, which is the multicore version of the original dist(). </p>\n\n<p>Now I am looking for a multicore version of cmdscale().</p>\n\n<p>Thanks,\nArmin</p>\n"},{"tags":["r","charts","scrolling"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":51,"score":0,"question_id":12938256,"title":"Scrolling chart window in R","body":"<p>I want to  create charts from R that will be larger than the display area. ie several thousand data points (like stock charts). I want to be able to scroll left and right through the charts.  Are there any functions or packages known where this can be done?</p>\n\n<p>I have various seraches here and also across the net but I can find nothing for R withough having to go and code something fairly serious myself.</p>\n\n<p>Not looking for anything fancy beyond that.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12925533,"title":"Quadratic spline","body":"<p>Is it there a way to adjust a quadratic spline (instead of a cubic one) to some data?</p>\n\n<p>I have this data and I don't seem to find the appropiate function in R to do this.</p>\n"},{"tags":["r","legend"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12937250,"title":"Legend not showing from K-Means clustering","body":"<p>I've clustered some values using K-means clustering. I plot three graphs and I would like a legend for the 3rd graph. I used the <code>lengend()</code> function to plot a legend, but the legend does not appear in the plot (see image) and no errors are reported.</p>\n\n<pre><code>library(cluster) \nlibrary(MASS)\n\npar(mfrow=c(1,3))\npar(oma=c(5,0,3,0))\n\ndat &lt;- read.table(\"representative_for_r.txt\", header=TRUE)\n\n\ndata.p &lt;- as.matrix(dat$Average_RMSD)\n\n# Determine number of clusters\nwss &lt;- (nrow(data.p)-1)*sum(apply(data.p,2,var))\nfor (i in 2:15) wss[i] &lt;- sum(kmeans(data.p,centers=i)$withinss)\nplot(1:15, wss, type=\"b\", xlab=\"Number of Clusters\",ylab=\"Within groups sum of squares\")\n\n\n\n# K-Means Cluster Analysis\nfit &lt;- kmeans(data.p, 6) # 6 cluster solution\n\n# get cluster means \naggregate(data.p,by=list(fit$cluster),FUN=mean)\n\n# append cluster assignment\ndata.p &lt;- data.frame(data.p, fit$cluster)\n\n\n# PLot Clusters\nclusplot(data.p, fit$cluster, color=TRUE, shade=TRUE, labels=2, lines=0)\n\ndata.p &lt;- data.frame(dat$PDB, data.p)\n#print(data.p)\n\nplot(data.p[,2],col=data.p$fit.cluster) # takes the RMSD column of data.p(by indexing) then colours the points defined by the clustering\npar(xpd=NA)\nlegend(0,0, c(\"Group 1\",\"Group 2\", \"Group 3\", \"Group 4\", \"Group 5\", \"Group 6\", \"Group 7\"), pch=1, col=1:7)\n\nwrite.matrix(data.p, file = \"kmeans_output.txt\", sep = \" \")\n</code></pre>\n\n<p>The output looks like:</p>\n\n<p><img src=\"http://i.stack.imgur.com/5F78H.png\" alt=\"enter image description here\"></p>\n\n<p>I have tried the changing the X and Y values with the following:</p>\n\n<pre><code>200,200\n-200,200\n200,-200\n-200,-200\n</code></pre>\n"},{"tags":["r","data-visualization","heatmap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12934145,"title":"How to reduce the height of the heatmap itself while increasing the height of the horizontal side bar?","body":"<p>In the <code>heatmap.2</code> function in the <code>gplots</code> package, how can I reduce the height of the rows in the heatmap itself while increasing the height of the horizontal side bar (denoted by <code>ColSideColors</code> argument)?</p>\n\n<pre><code>library('gplots')\nprob_matrix=replicate(100, rnorm(20)) \nids=paste(\"patient\",c(1:100),sep=\"_\")\ntype_colors=sample(c(\"red\",\"blue\",\"cyan\",\"pink\",\"yellow\",\"green\"), length(ids), replace = TRUE, prob = NULL)\nheatmap.2(prob_matrix, ColSideColors=type_colors,RowV=NULL,trace=\"none\")\n</code></pre>\n\n<p>I would like the horizontal side bar generated by <code>ColSideColors=subtype_colors</code> to be increased in height, and the rows of the heatmap reduced in height.</p>\n\n<p>For extension, how can I also edit the width of each column <strong>independent</strong> of the size of the width of the pdf or graphics device to which I output the plot? So, in the above, I would want to make the width of the columns of the <code>prob_matrix</code> heatmap greater.</p>\n"},{"tags":["r","loops","for-loop"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":12935393,"title":"Taking the sum in for loop in R","body":"<p>This question may sound to be similar to other questions, but when I check them they are a bit different from what I'm looking for. Here's my code below,</p>\n\n<pre><code>Data &lt;- rbind(c(54, 55, 51), c(52, 51, 57))\nWMatrix &lt;- rbind(c(0, 1), c(1, 0)) \n\nfor(i in 1:2){\n   for(j in 1:2){\n      for(t in 1:2){\n      print(WMatrix[i,j]*Data[j,t]*Data[i,t+1])\n      }\n   }\n}\n</code></pre>\n\n<p>The output of this codes is,</p>\n\n<pre><code>[1] 0\n[1] 0\n[1] 2860\n[1] 2601\n[1] 2754\n[1] 3135\n[1] 0\n[1] 0\n</code></pre>\n\n<p>Now, <strong><em>I want to have the sum of this output generated immediately from the loop (without listing it). That is, the output of the loop should be 11350, which is the sum of all generated outputs in the loop</em></strong>. I know this problem could be very simple, but I'm still learning basic programming. I tried this,</p>\n\n<pre><code>for(i in 1:2){\n   for(j in 1:2){\n      for(t in 1:2){\n      print(sum(WMatrix[i,j]*Data[j,t]*Data[i,t+1]))\n      }\n   }\n}\n</code></pre>\n\n<p>But, the output is still the same, can someone help me on this?</p>\n\n<p>Thanks :)</p>\n"},{"tags":["r","glm","glmnet"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12937331,"title":"R glmnet output to glm","body":"<p>I have a regression model with binary outcome. I fitted the model with glmnet and got the selected variables and their coefficients.</p>\n\n<p>Since glmnet doesn't calculate variable importance, I would like to feed the exact output (selected variables and their coefficients) to glm to get the information (Standard errors, etc).</p>\n\n<p>I searched r documents, it seems I can use \"method\" option in glm to specify user defined function.\nBut I failed to do so, could someone help me with this?</p>\n"}]}
{"total":19203,"page":14,"pagesize":100,"questions":[{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":123,"score":5,"question_id":12924455,"title":"How can I multiply vectors without a loop?","body":"<p>I have two vectors:</p>\n\n<pre><code>x = c(1,2,3)\ny = c(4,5,2)\n</code></pre>\n\n<p>and I want to multiply each element of <code>x</code> with each element in <code>y</code> and then sum it all up. So what I want to do is something along the lines of:</p>\n\n<pre><code>1*(4 + 5 + 2) + 2*(4 + 5 + 2) + 3*(4 + 5 + 2) = 11 + 22 + 33 = 66\n</code></pre>\n\n<p>Is there a way to do it without loops? Thanks in advance</p>\n"},{"tags":["r","merge","duplicates"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":12936556,"title":"merging data and receiving a big loss of data","body":"<p>I've been preparing my data and somehow I have way less data after merging my data sets. </p>\n\n<p>Since I don't have the longitude and latitude in my data I've been using the following code after I downloaded the package <strong>zipcode</strong> (<code>tel1</code> is my data containing zipcodes)</p>\n\n<pre><code>merge &lt;- merge(zipcode,tel1,by.x=c('zip'),by.y=c('zip_code'))\n</code></pre>\n\n<p>Before merging I had 195956 observations, while after merging it dropped down to 180090, but I don't understand why. </p>\n\n<p>In my opinion I just merged them where <code>zip</code> was equal to <code>zip_code</code> and I added the information from the dataset zipcode to my folder tel1</p>\n\n<p>Afterward I wanted to remove the rows that contain NA because the merge couldn't define any numbers or whatever. I used this code</p>\n\n<pre><code>final &lt;- result[complete.cases(result),]\n</code></pre>\n\n<p>Then my number of observations dropped down to 51006 which I just can't believe. There can't be so many mismatches in my data.</p>\n\n<p>Is there any other code that I should use? </p>\n\n<p>Afterwards I've been trying to delete the duplicates with the code</p>\n\n<pre><code> last &lt;- with(final,final[order(state,latitude,longitude),])\n</code></pre>\n\n<p>but the number of observations was consistent (51006).</p>\n\n<p>What did I do wrong or is there a way to get my data into an excel file again after merging the data so I could manually check if there are really so many mismatches?\nThanks</p>\n"},{"tags":["r","machine-learning","classification"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":12835515,"title":"Classification with naiveBayes (e1071) does not work ($levels returns NULL)","body":"<p>I use naiveBayes (e1071 <a href=\"http://en.wikibooks.org/wiki/Data_Mining_Algorithms_In_R/Classification/Na%C3%AFve_Bayes\" rel=\"nofollow\">http://en.wikibooks.org/wiki/Data_Mining_Algorithms_In_R/Classification/Na%C3%AFve_Bayes</a>) for classifying my data set (Classification class: \"class\" 0/1). Here is what I do:</p>\n\n<pre><code>library(e1071)\narrhythmia &lt;- read.csv(file=\"/home/.../arrhythmia.csv\", head=TRUE, sep=\",\")\n\n#devide into training and test data 70:30\ntrainingIndex &lt;- createDataPartition(arrhythmia$class, p=.7, list=F)\narrhythmia.training &lt;- arrhythmia[trainingIndex,]\narrhythmia.testing &lt;- arrhythmia[-trainingIndex,]\n\nnb.classifier &lt;- naiveBayes(class ~ ., data = arrhythmia.training)\npredict(nb.classifier,arrhythmia.testing[,-260])\n</code></pre>\n\n<p>The classifier does not work, here is what I get:</p>\n\n<pre><code>&gt; predict(nb.classifier,arrhythmia.testing[,-260])\nfactor(0)\nLevels: \n\n&gt; str(arrhythmia.training)\n'data.frame':   293 obs. of  260 variables:\n $ age                         : int  75 55 13 40 44 50 62 54 30 46 ...\n $ sex                         : int  0 0 0 1 0 1 0 1 0 1 ...\n $ height                      : int  190 175 169 160 168 167 170 172 170 158 ...\n $ weight                      : int  80 94 51 52 56 67 72 58 73 58 ...\n $ QRSduration                 : int  91 100 100 77 84 89 102 78 91 70 ...\n $ PRinterval                  : int  193 202 167 129 118 130 135 155 180 120 ...\n # and so on (260 attributes)\n\n&gt; str(arrhythmia.training[260])\n'data.frame':   293 obs. of  1 variable:\n $ class: int  1 0 1 0 0 1 1 1 1 0 ...\n\n\n&gt; nb.classifier$levels\nNULL\n</code></pre>\n\n<p>I tried to use the included the data set (iris) and everything works fine. \nWhat's wrong with my approach?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":43,"score":3,"question_id":12936246,"title":"aggregating and ifelse functions in R","body":"<p>Attached is some R code:</p>\n\n<pre><code>temp_df &lt;- data.frame(c(\"A\",\"A\",\"A\",\"G\",\"G\",\"Z\",\"Z\"),\n                    c(\"B\",\"D\",\"E\",\"R\",\"S\",\"Y\",\"U\"),\n                    c(1.5,1.1,0.8,0.2,0.8,0.9,0.1),\n                    c(0.8,0.4,1.5,1.2,1.2,0.2,0.3),\n                    c(2.7,2.7,2.7,2.4,2.4,0.5,0.5),\n                    c(\"YES\",\"NO\",\"NO\",\"NO\",\"NO\",\"YES\",\"YES\"))\n\ncolnames(temp_df) &lt;- c(\"PERSON_1\",\"PERSON_2\",\"VALUE_1\",\n                     \"VALUE_2\",\"TOTAL_2\",\"DECISION_2\")\n</code></pre>\n\n<p>What I am trying to do is create a new column called \"NEW_DECISION_1\" based on the following rules:</p>\n\n<p>For the people in column 1 (\"PERSON_1\"), if the value of the corresponding values in column 5 (\"TOTAL_2\") is greater than or equal to 2.0 and there is a least one \"YES\" in the corresponding values in column 6 (\"DECISION_2\"), then the value for the \"NEW_DECISION_1\" column will be \"YES\", and if these criteria are not satisfied, then they will get a \"NO\" value.</p>\n\n<p>So for the A person in column 1, since the values in column 5 is 2.7 and there is at least one \"YES\" in the corresponding values in column 6 then the value in the new column will be \"YES\".</p>\n\n<p>For the G person in column 1, since the values in column 5 is 2.4 but since there are no \"YES\" values in the corresponding values in column 6, the value in the new column will be \"NO\".</p>\n\n<p>For the Z person in column 1, since the values in column 5 is 1.0 and there is at least one \"YES\" in the corresponding values in column 6, the value in the new column will be \"NO\".\nSo the new table will be:</p>\n\n<pre><code>temp_df$NEW_DECISION_1 &lt;- c(\"YES\",\"YES\",\"YES\",\"NO\",\"NO\",\"NO\",\"NO\")\ntemp_df\n</code></pre>\n\n<p>I am thinking of some sort of aggregation rule but I am not sure what function to use to search for \"least one \"YES\"\".</p>\n\n<p>If you need any more information or clarification, please let me know.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12936179,"title":"Limma package for gene expression","body":"<p>I have the rma normalized matrix in the following format :</p>\n\n<pre><code>ID_REF GSM362180    GSM362181  GSM362188    GSM362189  GSM362192\n244901 5.094871713 4.626623079 4.554272515 4.748604391 4.759221647\n244902 5.194528083 4.985930299 4.817426064 5.151654407 4.838741605\n244903 5.412329253 5.352970877 5.06250609  5.305709079 8.365082403\n244904 5.529220594 5.28134657  5.467445095 5.62968933  5.458388909\n244905 5.024052699 4.714631878 4.792865831 4.843975286 4.657188246\n244906 5.786557533 5.242403911 5.060605782 5.458148567 5.890061836\n</code></pre>\n\n<p>where the different columns correspond to four different types of promoters and each of the four promoters has a biological replicate so totally there are 8 columns.</p>\n\n<p>I tried using the Limma package to find the differentially expressed genes across several promoters ( with replicates) and I always get an error as Iam new to r and unable to understand it fully .</p>\n\n<p>This is the code that I used:</p>\n\n<pre><code>Group &lt;- factor(c(\"p1\", \"p1\", \"p2\", \"p2\", \"p3\",\"p3\",\"p3\",\"p4\",\"p4\"), levels = c(\"GSM362180\",\"GSM362181\",\"GSM362188\",\"GSM362189\",\"GSM362192\",\"GSM362193\",\"GSM362194\",\"GSM362197\",\"GSM362198\"))\n\ndesign &lt;- model.matrix(~0 + Group)\n\ncolnames(design) &lt;- c(\"GSM362180\",\"GSM362181\",\"GSM362188\",\"GSM362189\",\"GSM362192\",\"GSM362193\",\"GSM362194\",\"GSM362197\",\"GSM362198\")\nfit &lt;- lmFit(modified, design)\n</code></pre>\n\n<p>where modified is the rma normalized data matrix as inputted in the above format.\nI get the following error:</p>\n\n<pre><code>Coefficients not estimable: GSM362180 GSM362181 GSM362188 GSM362189 GSM362192 GSM362193 GSM362194 GSM362197 GSM362198 \n</code></pre>\n\n<p>Error in lmfit(design, t(M)) : 0 (non-NA) cases</p>\n"},{"tags":["regex","r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":42,"score":1,"question_id":12935643,"title":"how to replace parts of search string in R","body":"<pre><code>string &lt;- c(\"tyuynmklabcwsqzp\")\n</code></pre>\n\n<p>If my task is to substitute every \"abc\" with \"abc123\", the code is,</p>\n\n<pre><code>gsub(\"abc\", \"\\\\1123\", string)\n</code></pre>\n\n<p>But, if I have to search for \"abc\" and then replace it with \"c123\", then how should I do it? Is there a way to divide the regular expression into parts so that I can have \\2 like \\1?\nIf it's possible, then my command would be, </p>\n\n<pre><code>gsub(\"abc\", \"\\\\2123\", string).\n</code></pre>\n\n<p>Please help.</p>\n"},{"tags":["c#","visual-studio-2010","r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12834704,"title":"Exception from HRESULT: 0x80040013: when Intregating R with C#:","body":"<p>I am trying to interface R with C# web application.I tried many solutions being provided but couldn't get it through.Error I am getting is : Exception from HRESULT: 0x80040013</p>\n\n<h1>Steps I followed were:</h1>\n\n<ol>\n<li>Installing R.15.1 for windows xp (32 bit) </li>\n<li>Installed R_Scilab_DCOM3.0-1B5 </li>\n<li>Loaded rscproxy_1.3-1 package in the R/R.15.1/library</li>\n<li>Set the System Variable path to C:/Program Files/R/R.15.1/bin</li>\n<li>Added 3 COM references-STATCONNECTORCLNTLib,StatConnectorCommonLib,STATCONNECTORSRVLib\nCode: </li>\n</ol>\n\n<p>private StatConnectorClass _statconnector = new STATCONNECTORSRVLib.StatConnectorClass();\n_statconnector.Init(\"R\");--> Line shows the <strong>Exception from HRESULT: 0x80040013</strong></p>\n\n<p>Please Help to figure me out where i am going wrong!!</p>\n"},{"tags":["r","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":61,"score":4,"question_id":12090896,"title":"Filtering single-column data frames","body":"<p>I am attempting to filter data frames that have only one column. This results in a vector being returned like so:</p>\n\n<pre><code>single.c &lt;- data.frame(col1=c(1,2,3,4,5), row.names=C(\"r1\",\"r2\",\"r3\",\"r4\",\"r5\"))\nsingle.c[single.c$col1 &gt; 2,]\n\n[1] 3 4 5\n</code></pre>\n\n<p>What I actually want is the data returned like it is for multi-column dataframes:</p>\n\n<pre><code>multi.c &lt;- data.frame(col1=c(1,2,3,4,5), col2=c(1,2,3,4,5), row.names=c(\"r1\",\"r2\",\"r3\",\"r4\",\"r5\"))\nmulti.c[multi.c$col2 &gt; 2,]\n\n   col1 col2\nr3    3    3\nr4    4    4\nr5    5    5\n</code></pre>\n\n<p>I can see it makes sense to return a vector if there are no other columns, but generally I want see what rows have given that result too. Why does this happen, and is there an easy way to keep the data frame shape in the result, including the rownames?</p>\n"},{"tags":["r","logic"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":63,"score":0,"question_id":12896031,"title":"Logical combinations the Java-way: Don't test second case if first is already false","body":"<p>I know that in Java it is often quite handy to do things like that</p>\n\n<pre><code>if(a!=0 &amp;&amp; b/a&gt;1){\n  ...;\n}\n</code></pre>\n\n<p>Java stops when the first part is already false. R does not do that, producing errors sometimes. So: Is there a possibility to make this code shorter:</p>\n\n<pre><code>if(exists(\"user_set_variable\")){\n   if(user_set_variable &lt; 3){\n      ...\n   }\n}\n</code></pre>\n"},{"tags":["r","documentation","s4"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12933301,"title":"How is S4 class definition done in a package and how is it documented properly?","body":"<p>Once I defined a class I wonder where to out in a package. Should just create a file <code>classDefintions.R</code> containing my S4 class definition and put it to the R folder? If so, how can I document it properly? Is there a <code>.rd</code> file template for S4 classes around? </p>\n\n<p>I found this <a href=\"http://stackoverflow.com/questions/7368262/how-to-properly-document-s4-class-slots-using-roxygen2\">post on Roxygen2</a> but I might be a few step behind here. How is it basically done and located? </p>\n"},{"tags":["windows","r","make","rinside"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":12928863,"title":"Compiling RInside programs on Windows","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5650063/problem-with-compiling-rinside-examples-under-windows\">Problem with compiling RInside examples under Windows</a>  </p>\n</blockquote>\n\n\n\n<p><strong>On Windows XP:</strong></p>\n\n<pre><code>&gt; sessionInfo()\nR version 2.15.1 (2012-06-22)\nPlatform: i386-pc-mingw32/i386 (32-bit)\n\nlocale:\n[1] LC_COLLATE=English_United States.1252 \n[2] LC_CTYPE=English_United States.1252   \n[3] LC_MONETARY=English_United States.1252\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.1252    \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n&gt; \n</code></pre>\n\n<p><strong>I attempted to compile the simplest program written by Dirk:</strong></p>\n\n<pre><code>#include &lt;RInside.h&gt;                    // for the embedded R via RInside\n\nint main(int argc, char *argv[]) {\n\n    RInside R(argc, argv);              // create an embedded R instance\n\n    R[\"txt\"] = \"Hello, world!\\n\";   // assign a char* (string) to 'txt'\n\n    R.parseEvalQ(\"cat(txt)\");           // eval the init string, ignoring any returns\n\n    exit(0);\n}\n</code></pre>\n\n<p><strong>The environment variable PATH in all contains this:</strong><br>\n<code>%SystemRoot%\\system32;%SystemRoot%;%SystemRoot%\\System32\\Wbem;C:\\R\\batchfiles_0.6-6;C:\\R\\Rtools\\bin;C:\\R\\Rtools\\MinGW\\bin;C:\\Program Files\\GnuWin32;C:\\\"Program Files\"\\R\\R-2.15.1\\;</code></p>\n\n<p><strong>I copied this Makefile from a existing R example of RInside in Windows XP.</strong></p>\n\n<pre><code>## -*- mode: make; tab-width: 8; -*-\n##\n## Simple Makefile\n##\n## TODO: \n##  proper configure for non-Debian file locations,   [ Done ]\n##  allow RHOME to be set for non-default R etc\n\n## comment this out if you need a different version of R, \n## and set set R_HOME accordingly as an environment variable\nR_HOME :=       C:\\\"Program Files\"\\R\\R-2.15.1\\\n\nsources :=      $(wildcard *.cpp)\nprograms :=         $(sources:.cpp=)\n\n\n## include headers and libraries for R \nRCPPFLAGS :=        $(shell $(R_HOME)/bin/R CMD config --cppflags)\nRLDFLAGS :=         $(shell $(R_HOME)/bin/R CMD config --ldflags)\nRBLAS :=        $(shell $(R_HOME)/bin/R CMD config BLAS_LIBS)\nRLAPACK :=      $(shell $(R_HOME)/bin/R CMD config LAPACK_LIBS)\n\n## if you need to set an rpath to R itself, also uncomment\n#RRPATH :=      -Wl,-rpath,$(R_HOME)/lib\n\n## include headers and libraries for Rcpp interface classes\nRCPPINCL :=         $(shell echo 'Rcpp:::CxxFlags()' | $(R_HOME)/bin/R --vanilla --slave)\nRCPPLIBS :=         $(shell echo 'Rcpp:::LdFlags()'  | $(R_HOME)/bin/R --vanilla --slave)\n\n\n## include headers and libraries for RInside embedding classes\nRINSIDEINCL :=      $(shell echo 'RInside:::CxxFlags()' | $(R_HOME)/bin/R --vanilla --slave)\nRINSIDELIBS :=      $(shell echo 'RInside:::LdFlags()'  | $(R_HOME)/bin/R --vanilla --slave)\n\n## compiler etc settings used in default make rules\nCXX :=          $(shell $(R_HOME)/bin/R CMD config CXX)\nCPPFLAGS :=         -Wall $(shell $(R_HOME)/bin/R CMD config CPPFLAGS)\nCXXFLAGS :=         $(RCPPFLAGS) $(RCPPINCL) $(RINSIDEINCL) $(shell $(R_HOME)/bin/R CMD config CXXFLAGS)\nLDLIBS :=       $(RLDFLAGS) $(RRPATH) $(RBLAS) $(RLAPACK) $(RCPPLIBS) $(RINSIDELIBS)\n\nall:            $(programs)\n            @test -x /usr/bin/strip &amp;&amp; strip $^\n\nrun:            $(programs)\n            @for p in $(programs); do echo; echo \"Running $$p:\"; ./$$p; done\n\nclean:\n            rm -vf $(programs)\n            rm -vrf *.dSYM\n\nrunAll:\n            for p in $(programs); do echo \"Running $$p\"; ./$$p; done\n</code></pre>\n\n<p>This is my R folder in C drive:\n<img src=\"http://i.stack.imgur.com/kFzwr.png\" alt=\"enter image description here\"></p>\n\n<p>I saw <a href=\"http://stackoverflow.com/a/5650694/462608\">this thread</a> but I don't have anything like <code>site-library</code> in the R folder.</p>\n\n<p>I changed the <code>R_HOME</code> to <code>C:\\\"Program Files\"\\R\\R-2.15.1</code>, that resulted in the following errors:</p>\n\n<p><img src=\"http://i.stack.imgur.com/i6CsW.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","binary","netcdf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12918506,"title":"How to write multiple bands from netcdf to a binary file?","body":"<p>I have <a href=\"https://echange-fichiers.inra.fr/get?k=ipQeKHLsYu82sNIa8bO\" rel=\"nofollow\">this</a> netcdf file\nI opened it and read one variable:</p>\n\n<pre><code> K=open.ncdf(\"C:\\\\hiba_history.nc\")\nSmonthly= get.var.ncdf(nc=K,varid=\"evap\",verbose=TRUE)\n\n[1] \"vobjtodimname: is a character type varid.  This file has 9 dims\"\n[1] \"vobjtodimname: no cases found, returning FALSE\"\n[1] \"get.var.ncdf: isdimvar: FALSE\"\n[1] \"vobjtovarid: entering with varid=evap\"\n[1] \"Variable named evap found in file with varid= 10\"\n[1] \"vobjtovarid: returning with varid deduced from name; varid= 10\"\n[1] \"get.var.ncdf: ending up using varid= 10\"\n[1] \"ndims: 3\"\n[1] \"get.var.ncdf: varsize:\"\n[1] 34 30 12\n[1] \"get.var.ncdf: start:\"\n[1] 1 1 1\n[1] \"get.var.ncdf: count:\"\n[1] 34 30 12\n[1] \"get.var.ncdf: totvarsize: 12240\"\n[1] \"Getting var of type 3  (1=short, 2=int, 3=float, 4=double, 5=char, 6=byte)\"\n[1] \"get.var.ncdf: C call returned 0\"\n[1] \"count.nodegen: 34    Length of data: 12240\" \"count.nodegen: 30    Length of data: 12240\"\n[3] \"count.nodegen: 12    Length of data: 12240\"\n[1] \"get.var.ncdf: final dims of returned array:\"\n[1] 34 30 12\n[1] \"varid: 10\"\n</code></pre>\n\n<p>As you can see, this variable has 30 pixel and 34 lines and 12 band(months)\nI would like to just write the sum of the 12 so I finally got one file which calculate the sum of all the 12 months(to be annual)</p>\n\n<pre><code>      apply(Smonthly, c(1,2), sum) -&gt; Sannual \n  to.write = file(paste(\"C:\\\\annual.bin\",sep=\"\"),\"wb\")\n\n   writeBin(as.double(Sannual),to.write,size=4)\n</code></pre>\n\n<p>When I opend the file thru another program,I found that the map(file)was upside-down\n         I then transposed the file as:</p>\n\n<pre><code>        t(Sannual) but this didn't work either\n</code></pre>\n"},{"tags":["r","transform"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":12932362,"title":"Transform table to 0 and 1 for a given threshold","body":"<p>I have a table (t1) as follows:</p>\n\n<pre><code>t1 &lt;- array(1:20, dim=c(10,10))\n\n      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]\n [1,]    1   11    1   11    1   11    1   11    1    11\n [2,]    2   12    2   12    2   12    2   12    2    12\n [3,]    3   13    3   13    3   13    3   13    3    13\n [4,]    4   14    4   14    4   14    4   14    4    14\n [5,]    5   15    5   15    5   15    5   15    5    15\n [6,]    6   16    6   16    6   16    6   16    6    16\n [7,]    7   17    7   17    7   17    7   17    7    17\n [8,]    8   18    8   18    8   18    8   18    8    18\n [9,]    9   19    9   19    9   19    9   19    9    19\n[10,]   10   20   10   20   10   20   10   20   10    20\n</code></pre>\n\n<p>I want to transform this table to either 1 or 0.  If the cells number is >5, we give it a 1, if the cells number is &lt;5 or = 5, we give it a 0.  Thus after transformation, table t1 will become the followings:</p>\n\n<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]\n [1,]    0   1    0   1    0    1    0    1    0    1\n [2,]    0   1    0   1    0    1    0    1    0    1\n [3,]    0   1    0   1    0    1    0    1    0    1\n [4,]    0   1    0   1    0    1    0    1    0    1\n [5,]    0   1    0   1    0    1    0    1    0    1\n [6,]    1   1    1   1    1    1    1    1    1    1\n [7,]    1   1    1   1    1    1    1    1    1    1\n [8,]    1   1    1   1    1    1    1    1    1    1\n [9,]    1   1    1   1    1    1    1    1    1    1\n[10,]    1   1    1   1    1    1    1    1    1    1\n</code></pre>\n\n<p>Which commands should I used?  </p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":46,"score":-5,"question_id":12933066,"title":"Differentially expressed genes for multiple variables","body":"<p>Could anyone please tell me the right package in R or the best option in Limma for calculating the differential expressed genes in a dataset ??? which has more than two variables ( four to be exact ).</p>\n\n<pre><code>       I have the matrix in the following format :\n\n\n ID_REF      GSM362180    GSM362181  GSM362188    GSM362189  GSM362192\n244901_at   5.094871713 4.626623079 4.554272515 4.748604391 4.759221647\n244902_at   5.194528083 4.985930299 4.817426064 5.151654407 4.838741605\n244903_at   5.412329253 5.352970877 5.06250609  5.305709079 8.365082403\n244904_at   5.529220594 5.28134657  5.467445095 5.62968933  5.458388909\n244905_at   5.024052699 4.714631878 4.792865831 4.843975286 4.657188246\n</code></pre>\n\n<p>244906_at   5.786557533 5.242403911 5.060605782 5.458148567 5.890061836</p>\n\n<p>In the above matrix the first column is the list of genes ( 22810) and the corresponding columns correspond to the different promoters ( totally 4 different types( with replicates) totally 8 colums are there) . How would it be possible to find the differentially expressed genes in such a case ??</p>\n"},{"tags":["r","svm","kernlab"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12932106,"title":"How can I perfrom novelty detection with ksvm in R?","body":"<p>I am trying to implement a novelty detector using the kernlab library (ksvm function) in R. Here is a simple example of what I am trying to do:</p>\n\n<pre><code># Training data\nxxTrain &lt;- matrix(rnorm(2000), nrow=1000, ncol=2, byrow=TRUE)\ny &lt;- rep(1,1000)\nclassifier &lt;- ksvm(xxTrain, y, type=\"one-svc\", kernel=\"rbfdot\", kpar=\"automatic\")\n# Test data\nx1 &lt;- rnorm(1000)\nscale &lt;- c(rep(1,500), rep(10,100), rep(1,400))\nx2 &lt;- rnorm(1000)*scale\nxxTest &lt;- matrix(c(x1,x2), nrow=1000, ncol=2, byrow=TRUE)\n# Prediction\np &lt;- predict(classifier, xxTest, type=\"response\")\n# Visualization\nplot(x2, type='l')\nlines(x1, col=\"red\")\npoints(5*as.integer(p), type='l', col=\"blue\")\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/iHugv.png\" alt=\"enter image description here\"></p>\n\n<p>The figure above is the result I get. The blue trace is the prediction, and it clearly shows a period where its consitently 0. But it does not match in time or width with the outlier in the black trace. There are 100 points (black line) which are of larger amplitude, and the output I get in the blue does not match with the black line.</p>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["r","parsing","syntax"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12929504,"title":"Explicitly parse part of R code in a script","body":"<p>My usecase is as follows:</p>\n\n<ul>\n<li>Display GUI to collect some R expressions</li>\n<li>Generate a single source file containing my simulation framework, intermixed with the R expressions provided by the user</li>\n<li>Allow the user to generate the single source file. If any of the expressions specified by the user contain errors (syntax or runtime), I want to display these in a user-friendly way.</li>\n</ul>\n\n<p>In short, I want to do something as follows:</p>\n\n<pre><code>myExpression &lt;- \"3 * 5\"\nmyExprParsed &lt;- tryCatch( parse(myExpression), .... )\n</code></pre>\n\n<p>My question is very simple: does R have some construct like <code>\\Q \\E</code> in regex, fully quoting a text string from beginning to end ? It is not unlikely that myExpression will contain the <code>\"</code> character, thereby introducing a syntax error. I do not want to write the text contents to a separate text file and use <code>source()</code>.</p>\n\n<p>=Example=</p>\n\n<pre><code>myExpression &lt;- \" XXXXXXX \"\n</code></pre>\n\n<p>where XXXXXX is <code>paste(\"my random value is \", runif(3))</code> would amount to</p>\n\n<pre><code>myExpression &lt;- \" paste(\"my random value is \", runif(3)) \"\n</code></pre>\n\n<p>which would give a syntax error. I want something like</p>\n\n<pre><code>myExpression &lt;- verbatim@   paste(\"my random value is \", runif(3))   @\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12930630,"title":"Is there a simple way to get substring in R?","body":"<p>i  get the substring of word in the following way:</p>\n\n<pre><code> word=\"xyz9874\"\n pattern=\"[0-9]+\"\n x=gregexpr(pattern,word)\n substr(word,start=x[[1]],stop=x[[1]]+attr(x[[1]],\"match.length\")-1)\n[1] \"9874\"\n</code></pre>\n\n<p>Is there a more simple way to get the result in R?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12931500,"title":"Sort a list or objects containing different types in R","body":"<p>It probably easier explain myself using an example.\nLet's say I have a list s:</p>\n\n<blockquote>\n  <p>s &lt;- list( c(5,3,4,3,6),c(\"A\",\"B\",\"C\",\"D\",\"E\"))</p>\n</blockquote>\n\n<p>s has always the same number of object for all sub-vectors. NA value are not allowed. The vectors contain different types.</p>\n\n<p>What I want to achieve is:</p>\n\n<pre><code>rank  v1   v2\n1     3    \"B\"\n2     3    \"D\"\n3     4    \"C\"\n4     5    \"A\"\n5     6    \"E\"\n</code></pre>\n\n<p>Basically, to sort the list based on the first vector (in ascending order) and then (in case on tie) look to the second vector using the lexicological order. In C++ world the only thing that I need to do is to define the operator&lt; for my object, however I am pretty new of R and I am running out ideas.</p>\n\n<p>The best strategy that I have found is to loop over the elements and calculate a rank value (double) for each couple (eg. 3 \"B\" will result with the highest rank and 6 \"E\" with the lowest), store the results in another vector and sort it. However the solution is not great because find a good ranking function can be tricky and it is not very easy to generalize. </p>\n\n<p>It seems to me such a common problem that it has to be a better way. Can anyone point me in the right direction? </p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12930933,"title":"Retrieve the list of files from a URL","body":"<p>I would like to get a list of all the files available at this address: <a href=\"http://www1.ncdc.noaa.gov/pub/data/cmb/drought/weekly-palmers/2005/\" rel=\"nofollow\">http://www1.ncdc.noaa.gov/pub/data/cmb/drought/weekly-palmers/2005/</a>\n(publicly available data from the NOAA).</p>\n\n<p>It would be some sort of \"list.files\" for the a specific URL.\nI started to take a look at RCurl but all I could get was the HTML code of the URL.</p>\n"},{"tags":["xml","r","flickr","rcurl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12929079,"title":"Rflickr invalid signature","body":"<p>I am using R and the Rflickr package from <a href=\"http://www.omegahat.org/Rflickr/\" rel=\"nofollow\">http://www.omegahat.org/Rflickr/</a> and had it working perfectly for a long time until recently. From which I get <code>Error: Invalid signature</code> as an error I seem to be able to initiate a session but just not upload...</p>\n\n<p>This was the code I was using...</p>\n\n<pre><code>file &lt;- \"~/path.to.pic/pic.png\"\nsecret &lt;- \"xxxxxxx\"\ntok &lt;- \"xxxxxxxxxxxxxxxxxxxx\"\napi_key &lt;- \"xxxxxxxxxxxxxxxxxxxx\"\ns &lt;- flickrSession(secret, tok, api_key)\nx &lt;- s$upload(image=file)\n</code></pre>\n\n<p>leads to the result of:</p>\n\n<pre><code>Error: Invalid signature\n</code></pre>\n\n<p>I thought perhaps it might have been a token issues so I re-authenticated and got a new token but to the same error message...when running the basic example from the help file for upload i get the following...</p>\n\n<pre><code> f = tempfile()\n png(f)\n plot(1:10)\n dev.off()\n\n o = flickr.upload(secret, tok, api_key,\n               f, # the name of the file containing the picture\n               title = \"A sample plot from R\",\n               description = \"Created in R via plot(1:10)\",\n               content_type = \"1\",\n               is_family = \"0\",\n               is_friend = \"0\",\n               is_public = \"0\",\n               safety_level = \"1\",\n               tags = 'other',\n               .opts = list(verbose = TRUE, followlocation = TRUE))\n\n* About to connect() to api.flickr.com port 80 (#0)\n*   Trying 68.142.214.24... * connected\n* Connected to api.flickr.com (68.142.214.24) port 80 (#0)\nPOST /services/upload/ HTTP/1.1\nHost: api.flickr.com\nAccept: */*\nContent-Length: 1659\nExpect: 100-continue\nContent-Type: multipart/form-data; boundary=----------------------------9a0d04197452\n\n&lt; HTTP/1.1 100 Continue\n&lt; HTTP/1.1 200 OK\n&lt; Date: Wed, 17 Oct 2012 06:34:23 GMT\n&lt; P3P: policyref=\"http://info.yahoo.com/w3c/p3p.xml\", CP=\"CAO DSP COR CUR ADM DEV TAI PSA PSD IVAi IVDi CONi TELo OTPi OUR DELi SAMi OTRi UNRi PUBi IND PHY ONL UNI PUR FIN COM NAV INT DEM CNT STA POL HEA PRE LOC GOV\"\n&lt; Connection: close\n&lt; Content-Length: 108\n&lt; Cache-Control: private\n&lt; X-Served-By: www221.flickr.mud.yahoo.com\n&lt; Vary: Accept-Encoding\n&lt; Content-Type: text/xml; charset=utf-8\n&lt; \n* Closing connection #0\nError: Invalid signature\n</code></pre>\n\n<p>Any idea what the problem might be? I used to use it regularly without any problems...but now all of a sudden it seems to have issues?</p>\n\n<p>Thanks</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":128,"score":4,"question_id":9062525,"title":"A bug in creating dynamic functions in R","body":"<p>I have found a very subtle bug in my R code just now. The following code takes a list of objects as input and create new fields for each of the objects. </p>\n\n<p>Each object originally has two fields (w, p, s, u), and then I create more, beta, phi, etc.. The normal variables are OK. However the dynamic functions (Q, K, K1, K2) are not correct.  Suppose I have two nigs, nigs[[1]] and nigs[[2]], <strong>the functions Q, K, K1 and K2 for nigs[[1]] would be the same as nigs[[2]]</strong>! </p>\n\n<p>I just found this bug and would consult on how to get this code correct (while keeping its elegance:) Thanks!</p>\n\n<pre><code>  D &lt;- length(nigs)\n\n  for (i in 1:D) {\n    w &lt;- nigs[[i]]$w\n    p &lt;- nigs[[i]]$p\n    s &lt;- nigs[[i]]$s\n    u &lt;- nigs[[i]]$u\n\n    nigs[[i]]$beta &lt;- beta &lt;- w / s * p * (1-p^2)^(-1/2);\n    nigs[[i]]$phi &lt;- phi &lt;- w^2 / s^2;\n\n    nigs[[i]]$z &lt;- z &lt;- (x-u)/s;\n    nigs[[i]]$alpha_bar &lt;- alpha_bar &lt;- w * (1-p^2)^(-1/2);\n    nigs[[i]]$y_bar &lt;- y_bar &lt;- sqrt(1+z^2);\n\n    nigs[[i]]$Q &lt;- Q &lt;- function(t) { sqrt(1 - (2*beta*t+t^2)/phi) }\n    nigs[[i]]$K &lt;- K &lt;- function(t) { u*t - w*Q(t) + w }\n    nigs[[i]]$K1 &lt;- K1 &lt;- function(t) { (u + w * (beta+t) / (Q(t)*phi)) }\n    nigs[[i]]$K2 &lt;- K2 &lt;- function(t) { qt = Q(t); (w/(qt * phi) + w * (beta+t)^2 / (qt^3 * phi^2)); }\n  }\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>The primary error I made is that I assumed that <code>for { }</code> introduced new scopes, in that case, <code>w,p,s,u</code> are different <code>w,p,s,u</code> every time, actually not. Only functions in R introduce new scopes. And this scoping rule is different from C/Java. </p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":104,"score":0,"question_id":12910841,"title":"Custom spacing between x axis labels in ggplot","body":"<p>I have a df:</p>\n\n<pre><code>   Year          Ratio       N    Mean        sd        se        ci\n97  1867 TILLBANK...PLACTILL 2  3.861999  4.082170  2.886530  36.67685\n98  1867   TILLOBL..PLACTILL 2 21.848833 17.859532 12.628596 160.46153\n99  1867   TILLLOAN.PLACTILL 2 54.197044 23.309360 16.482207 209.42629\n100 1867   TILLEQUI.PLACTILL 2  0.000000  0.000000  0.000000   0.00000\n101 1867   TILLCONT.PLACTILL 2  0.000000  0.000000  0.000000   0.00000\n102 1867   TILLRECI.PLACTILL 2 10.772286  5.110514  3.613679  45.91615\n\n\nstr(df) :\n\n     'data.frame':  1152 obs. of  7 variables:\n $ Year : Factor w/ 156 levels \"1855\",\"1856\",..: 13 13 13 13 13 13 13 13 14 14 ...\n $ Ratio: Factor w/ 8 levels \"TILLBANK...PLACTILL\",..: 1 2 3 4 5 6 7 8 1 2 ...\n $ N    : num  2 2 2 2 2 2 2 2 2 2 ...\n $ Mean : num  3.86 21.85 54.2 0 0 ...\n $ sd   : num  4.08 17.86 23.31 0 0 ...\n $ se   : num  2.89 12.63 16.48 0 0 ...\n $ ci   : num  36.7 160.5 209.4 0 0 ...\n</code></pre>\n\n<p><strong>1)</strong> I am doing a <code>ggplot</code>:</p>\n\n<pre><code>qqs&lt;-ggplot(dfccomp, aes(x=Year, y=sd,colour=Ratio))+geom_point()+\n    facet_grid(Ratio~.)+\n    theme(axis.text.x  = element_text(angle=-90, hjust=0.5, size=11,colour=\"black\"))\n</code></pre>\n\n<p>This plot works with <code>geom_point()</code> but now with <code>geom_line()</code>. If I use <code>geom_point()</code> I then get very messy x-axis with all the years (from 1867 to 2010): \n<img src=\"http://i.stack.imgur.com/vNEh0.png\" alt=\"enter image description here\"></p>\n\n<p>And if I use <code>geom_line()</code>,which does not work, I get:\n<img src=\"http://i.stack.imgur.com/EiFt4.png\" alt=\"enter image description here\"></p>\n\n<p>So, I wonder how it is possible to only pick some certain years to be present on the x axis?</p>\n\n<p><strong>2)</strong> The other strange thing that I dont understand is if I convert the <code>df$Year</code> above to numeric, </p>\n\n<pre><code>df$Year=as.numeric(as.character(df$Year))\n</code></pre>\n\n<p>Plot is then:\n<img src=\"http://i.stack.imgur.com/dc2B5.png\" alt=\"enter image description here\"></p>\n\n<p>Now, only 3 years are present on the x-axis. Which is better but still not what I want...</p>\n\n<p>why does both <code>geom_point()</code> and <code>geom_line()</code> works?</p>\n\n<p>Updated:\nOn the answer below I read that \"Year is a factor and as such ggplot() will interpret that accordingly and produce a dotplot. The reason geom_line() doesn't do anything as this geom doesn't make sense for the data supplied; the factor nature indicates to ggplot() that the x-axis is not continuous and there is nothing to draw between points on that axis, hence no lines.\". </p>\n\n<p>But I have a different plot where <code>geom_line()</code> works with a factor. Why is it so?</p>\n\n<pre><code>qq&lt;-ggplot(df, aes(x=Year, y=Mean,colour=Ratio)) + \n    geom_errorbar(aes(ymin=Mean-sd, ymax=Mean+sd), colour=\"black\", width=.1, position=position_dodge(.1)) +\n    geom_line(position=position_dodge(.1)) +\n    geom_point(position=position_dodge(.1), size=3, shape=21, fill=\"white\") + # 21 is filled circle\n    xlab(\"Year\") +\n    ylab(\"Mean (%)\")+ggtitle(\"Ratios\")+facet_grid(Ratio~.)+theme(axis.text.x  = element_text(angle=-90, hjust=0.5, size=11,colour=\"black\"))\n</code></pre>\n\n<p>The picture:\n<img src=\"http://i.stack.imgur.com/jzH42.png\" alt=\"enter image description here\"></p>\n"},{"tags":["string","r","character","data.frame"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12927703,"title":"Adding a space between two characters in a data frame in R","body":"<p>I have a data frame where each cell are 2 character strings (ie: \"AA\" , \"BC\" , \"CD\")  where I am trying to put spaces between each of the two characters, and where NA values remain as is.  I can't seem to figure this out.  Any help????</p>\n\n<p>Here is an example data frame:</p>\n\n<pre><code> df &lt;- data.frame(col1=c(\"AB\", \"CD\", \"EF\"), col2=c(\"AA\", \"BB\", \"CC\"), col3=c(\"XX\", \"YY\", NA))\n</code></pre>\n\n<p>And this is what the example data frame looks like:</p>\n\n<pre><code>   col1 col2 col3\n1   AB   AA   XX\n2   CD   BB   YY\n3   EF   CC &lt;NA&gt;\n</code></pre>\n\n<p>This is what i want my data frame to look like:</p>\n\n<pre><code>   col1  col2  col3\n1   A B   A A   X X\n2   C D   B B   Y Y\n3   E F   C C   &lt;NA&gt;\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12927514,"title":"write function in R","body":"<p>I'm using the write function right now in R with a matrix, and this is what I have</p>\n\n<pre><code>write(my_mtx,file='mtx.tsv',sep='\\t')\n</code></pre>\n\n<p>But this gives me a file with one column? I've also tried adding an 'ncolumns' argument </p>\n\n<pre><code>write(mt_mtx,ncolumns=length(colnames(my_mtx)),file='mtx.tsv',sep='\\t')\n</code></pre>\n\n<p>But this just gives me a repeat of the one columns as opposed to actual separated columns as it appears in the matrix. a little help?</p>\n"},{"tags":["r","ggplot2","line","regression"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12927527,"title":"Regression line for the entire dataset together with regression lines based on groups in R ggplot2 ?","body":"<p>I am new to ggplot2 and have problem displaying the regression line for the entire data-set together with the regression lines for groups. So far i can plot regression line based on the group but I have no success in getting the regression line for the entire data-set on the same plot. I want all the regression lines with different line style so that they can be easily identified in black and white print. Any help would be highly appreciated. here is my code so far: </p>\n\n<pre><code>ggplot(alldata,aes(y = y, x = x, colour= group, shape= group )) +\ngeom_point(size = 3, alpha = .8) + geom_smooth(method=\"lm\", fill=NA , size = 1) \n</code></pre>\n"},{"tags":["r","plyr"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12927468,"title":"Parameterize ddply in R","body":"<p>For the data frame:</p>\n\n<pre><code>exampleDF &lt;- structure(list(val1 = structure(c(1L, 2L, 1L, 3L), .Label = c(\"MX\", \n\"SS\", \"VF\"), class = \"factor\"), var2 = c(1, 2, 3, 4)), .Names = c(\"val1\", \n\"var2\"), row.names = c(NA, -4L), class = \"data.frame\")\n</code></pre>\n\n<p>instead of doing:</p>\n\n<pre><code>ddply(exampleDF, .(val1), summarize, sum(as.numeric(var2)))\n</code></pre>\n\n<p>Is it possible to parameterize the <code>ddply</code> call (something as follows, though I tried it and didn't work):</p>\n\n<pre><code>colname &lt;- 'var2'\nddply(exampleDF, .(val1), summarize, sum(as.numeric(colname)))\n</code></pre>\n\n<p>which results in ..</p>\n\n<pre><code>  val1 ..1\n1   MX  NA\n2   SS  NA\n3   VF  NA\nWarning messages:\n1: In eval(expr, envir, enclos) : NAs introduced by coercion\n2: In eval(expr, envir, enclos) : NAs introduced by coercion\n3: In eval(expr, envir, enclos) : NAs introduced by coercion\n</code></pre>\n\n<p>We have to call <code>ddply</code> for a set of columns in the data frame and generate plots for each result of <code>ddply</code>. Hence we wanted to parameterize the <code>ddply</code> call instead of repeating the same line for n number of columns</p>\n"},{"tags":["osx","r","excel","csv","end-of-line"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":12925968,"title":"Incomplete final line when trying to read csv in R","body":"<p>I've got R v.2.15.1 running on Mac OS 10.8.2 . Earlier today, R started throwing errors at me every time I try to import ANY recently created (today) csv files. Older (before today) csv files work fine, but anything I create that's new will not read in without a warning.</p>\n\n<p>I'm creating the csv's the same way -- saving the spreadsheet as .csv in MS Excel (Office for Mac 2011). </p>\n\n<p>Even with a dummy file ('test.csv'), I get this: \n\"Warning message:\nIn read.table(file = file, header = header, sep = sep, quote = quote,  :\n  incomplete final line found by readTableHeader on 'test.csv'\"</p>\n\n<p>in TextEdit, test.csv is:</p>\n\n<pre><code>cat,stuff\n1,1\n2,2\n</code></pre>\n\n<p>I have tried hitting enter at the end of every line (as suggested here: <a href=\"http://stackoverflow.com/questions/5990654/incomplete-final-line-warning-when-trying-to-read-a-csv-file-into-r\">&#39;Incomplete final line&#39; warning when trying to read a .csv file into R</a> ) , but this doesn't work.</p>\n\n<p>I've re-installed R and Microsoft Excel. Weirdly, I was able to read in the csv file without a warning on a Windows machine with R. On another Mac with R and also with RStudio, I get the same warning...</p>\n\n<p>I know this is \"just\" a warning, but it makes me a bit nervous and seems to have the potential to cause problems in the future.</p>\n"},{"tags":["r","list","data-structures","lapply"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":10792060,"title":"Storing output of read.table in a data structure","body":"<p>I have tried using vectors, arrays, lists and collections. When I go to access the data later it seems that the data is cast into some one dimensional structure. For example.</p>\n\n<p>This:</p>\n\n<pre><code>for (i in 1:length(argv)){\n    temp= read.csv(file=argv[i], header= TRUE)   \n    print( temp )\n    input_tables[i]= temp\n    print(input_tables[i])\n</code></pre>\n\n<p>Yields this:</p>\n\n<pre><code>     V1 V2 V3 V4\n1  1  5  9 13\n2  2  6 10 14\n3  3  7 11 15\n4  4  8 12 16\n[[1]]\n[1] 1 2 3 4\n\n  V1 V2 V3 V4\n1  2 10 18 26\n2  4 12 20 28\n3  6 14 22 30\n4  8 16 24 32\n[[1]]\n[1] 2 4 6 8\n\n  V1 V2 V3 V4\n1  4 20 36 52\n2  8 24 40 56\n3 12 28 44 60\n4 16 32 48 64\n[[1]]\n[1]  4  8 12 16\n</code></pre>\n\n<p>I have looked through the documentation for R (a bit of googling and the help function) and I cant determine what sort of object read.table returns. From my previous experience, I believe that is a dataframe or a matrix.</p>\n\n<p>In any case, how can i store these outputs in some structure and not cast it? Or at least not discard the data. It may be there as it is now. Thanks for your time. I have a workaround in my current situation, but it seems like this should be easily possible.</p>\n"},{"tags":["r","sorting","plyr","top-n"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12187891,"title":"How to get top n companies from a data frame in decreasing order","body":"<p>I am trying to get the top 'n' companies from a data frame.Here is my code below.</p>\n\n<pre><code>data(\"Forbes2000\", package = \"HSAUR\")\nsort(Forbes2000$profits,decreasing=TRUE)\n</code></pre>\n\n<p>Now I would like to get the top 50 observations from this sorted vector.</p>\n"},{"tags":["r","data.table","plyr"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12379043,"title":"how to create a column including the maximum value of another column in R?","body":"<p>Using R, I would like to create a new column (MaxAct) showing the maximum numbers of a different column (ActNo) while grouping by two factors (HHID and PERID)</p>\n\n<p>For example, I have this data set:</p>\n\n<pre><code>UID HHID PERID ActNo\n1   1000 1     1\n2   1000 1     2\n3   1000 1     3\n4   1000 2     1\n5   1000 2     2\n6   2000 1     1\n7   2000 1     2\n8   2000 1     3\n9   2000 1     4\n10  2000 2     1\n11  2000 2     2\n</code></pre>\n\n<p>Then I want to add the new column (MaxAct) as follows:</p>\n\n<pre><code>UID HHID PERID ActNo MaxAct\n1   1000 1     1     3\n2   1000 1     2     3\n3   1000 1     3     3\n4   1000 2     1     2\n5   1000 2     2     2\n6   2000 1     1     4\n7   2000 1     2     4\n8   2000 1     3     4\n9   2000 1     4     4\n10  2000 2     1     2\n11  2000 2     2     2\n</code></pre>\n"},{"tags":["r","plyr"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":11254473,"title":"R Replacing a row maximum with 0","body":"<p>I have a data.frame with numeric values. How can I replace the each row maximum with 0 \nSo for example in a row: </p>\n\n<blockquote>\n  <p>10, 1, 3, 4 </p>\n</blockquote>\n\n<p>the output would be </p>\n\n<blockquote>\n  <p>0, 1, 3, 4</p>\n</blockquote>\n\n<p>I tried:</p>\n\n<pre><code>df1  &lt;- data.frame(df)[apply(df,1,which.max=0)]\n</code></pre>\n\n<p>but I have something wrong.</p>\n\n<p>I would be grateful for your help.</p>\n"},{"tags":["r","data.table"],"answer_count":4,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":2446,"score":8,"question_id":5366403,"title":"average column values across all rows of a data frame","body":"<p>I've got a data frame that I read from a file like this:</p>\n\n<pre><code>name, points, wins, losses, margin\njoe, 1, 1, 0, 1\nbill, 2, 3, 0, 4\njoe, 5, 2, 5, -2\ncindy, 10, 2, 3, -2.5\n</code></pre>\n\n<p>etc.</p>\n\n<p>I want to average out the column values across all rows of this data, is there an easy way to do this in R?</p>\n\n<p>For example, I want to get the average column values for all \"Joe's\", coming out with something like</p>\n\n<pre><code>joe, 3, 1.5, 2.5, -.5\n</code></pre>\n"},{"tags":["r","formatting","plot","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":242,"score":1,"question_id":10727373,"title":"Controlling format/placement of axis labels when plotting 2D table objects in R","body":"<p>I'd like to gain greater control over axis label size and placement when plotting a 2-dimensional table in R, but the plotting rules seem to work differently for table objects than for data frames. To make my questions concrete, I've pasted in fake data at the end of this message using <code>dput()</code>. Running that code will create the <code>dept.table</code> object used in the plotting code below.</p>\n\n<p>When you run <code>plot</code> on a 2D table in R, it creates a mosaic plot, as in the following:</p>\n\n<pre><code>plot(dept.table, \n     col=c(\"yellow\",\"blue\",\"red\"), \n     las=1, \n     cex=.7, \n     dir=c(\"h\",\"v\"), \n     off=c(8,4))\n</code></pre>\n\n<p>There are three changes I'd like to make to the axis labels in the plot created by this call. </p>\n\n<p>First, alternate the height of the \"Freshman\", \"Sophomore\", etc. labels across the top, so that they don't overlap (I know I can shorten them, but I want to figure this out for future reference as well, since it's not always convenient to shorten labels). I thought of turning off axis labels and adding them manually with the <code>text()</code> function. However, adding <code>xaxt = 'n'</code> to the <code>plot</code> call evidently doesn't work when plotting a table object (R gives an \"extra argument(s) 'xaxt' will be disregarded\" message).</p>\n\n<p>Another option is to rotate the x-axis labels by setting <code>las=2</code>. However, I'd prefer to have the labels horizontal for easier reading. I should note, though, that when I do set <code>las=2</code>, the label \"Graduate Student\" overlaps onto the plot area. </p>\n\n<p>So there are several issues here: </p>\n\n<ol>\n<li>How do I turn off plotting of the x-axis labels so that I can add labels manually? </li>\n<li>Better yet, is there a more elegant way to get the labels to alternate up and down so that they don't overlap, without having to set the position of each one manually? </li>\n<li>If a label overlaps the plot area, is there a way (other than shortening the label) to eliminate the overlap?</li>\n<li><p>Is there a way to have different text sizes for the x-axis and y-axis labels? The actual plot I want to make has many more departments (the vertical axis) so I'd like to use a smaller text size for the y axis than for the x axis. The only option for axis text size seems to be <code>cex</code>, which adjusts both axes. Is there a way to adjust each axis separately? </p></li>\n<li><p>The y-axis labels are left justified. Is there a way to get them right justified, so they'll be close to the plot area? </p></li>\n</ol>\n\n<p>By the way, although I made this plot with base graphics, I'd be interested in whether there are better ways to do it with lattice, ggplot2, or perhaps another package.</p>\n\n<pre><code>dept.table = structure(c(10, 15, 20, 200, 5, 15, 35, 200, 49, 15, 25, 20, \n250, 5, 12, 34, 150, 30, 50, 108, 75, 800, 32, 39, 135, 400, \n195, 80, 99, 64, 700, 47, 41, 134, 350, 160, 5, 10, 5, 110, 5, \n4, 10, 30, 13), .Dim = c(9L, 5L), .Dimnames = structure(list(\n    c(\"Anthropology\", \"Economics\", \"Mathematics\", \"Business Administration\", \n    \"Geography\", \"Special Education, &amp; Deaf Studies\", \"History\", \n    \"Kinesiology &amp; Health Science\", \"Family &amp; Consumer Sciences\"\n    ), c(\"Freshman\", \"Sophomore\", \"Junior\", \"Senior\", \"Graduate Student\"\n    )), .Names = c(\"\", \"\")), class = \"table\")\n</code></pre>\n"},{"tags":["r"],"answer_count":3,"favorite_count":4,"up_vote_count":11,"down_vote_count":0,"view_count":120,"score":11,"question_id":11137887,"title":"Are there any guidelines for when reproducible code should be included into a publication?","body":"<p>Given the stress toward reproducible science, I was wondering if my recent work warrants the inclusion of example code in the publication. The datasets that I am using are quite big, so it wouldn't make sense to publish those necessarity - However, the statistical methods that I apply within R are not generally known to my audience (although I would think that they should be). </p>\n\n<p>I'm using empirical orthogonal function analysis (EOF) and generalized additive models (GAM) within my analysis. GAM, in particular, is widely used in ecological studies, but less so within the physical sciences - my work spans both disciplines. </p>\n\n<p>I definitely refer to the R packages that I use, and it wouldn't really be difficult for a reviewer / reader to look for those references (and included examples) themselves. So, my question is, what situations are most appropriate for the inclusion of reproducible code in a publication?</p>\n"},{"tags":["performance","algorithm","r"],"answer_count":2,"favorite_count":0,"up_vote_count":10,"down_vote_count":0,"view_count":104,"score":10,"question_id":12913446,"title":"Efficiently create dataframe from strings containing key-value pairs","body":"<p>I would like to ask you for efficiency suggestions for a specific coding problem in R. I have a string vector in the following style:</p>\n\n<pre><code>[1] \"HGVSc=ENST00000495576.1:n.820-1G&gt;A;INTRON=1/1;CANONICAL=YES\"\n[2] \"DISTANCE=2179\"                                              \n[3] \"HGVSc=ENST00000466430.1:n.911C&gt;T;EXON=4/4;CANONICAL=YES\"    \n[4] \"DISTANCE=27;CANONICAL=YES;common\"\n</code></pre>\n\n<p>In each element of the vector, the single entries are separated with a <code>;</code> and MOST of the single entries have the format <code>KEY=VALUE</code>. However, there are also some entries, which only have the format <code>KEY</code> (see \"common\" in [4]). In this example, there are 15 different keys and not every key appears in each element of the vector. The 15 different keys are:</p>\n\n<pre><code>names &lt;- c('ENSP','HGVS','DOMAINS','EXON','INTRON', 'HGVSp', 'HGVSc','CANONICAL','GMAF','DISTANCE', 'HGNC', 'CCDS', 'SIFT', 'PolyPhen', 'common')\n</code></pre>\n\n<p>From this vector I would like to create a dataframe that looks like this:</p>\n\n<pre><code>ENSP HGVS DOMAINS EXON INTRON HGVSp                        HGVSc CANONICAL\n1    -    -       -    -    1/1     - ENST00000495576.1:n.820-1G&gt;A       YES\n2    -    -       -    -      -     -                            -         -\n3    -    -       -  4/4      -     -   ENST00000466430.1:n.911C&gt;T       YES\n4    -    -       -    -      -     -                            -       YES\nGMAF DISTANCE HGNC CCDS SIFT PolyPhen common\n1    -        -    -    -    -        -      -\n2    -     2179    -    -    -        -      -\n3    -        -    -    -    -        -      -\n4    -       27    -    -    -        -    YES\n</code></pre>\n\n<p>I wrote this function to solve the problem:</p>\n\n<pre><code>unlist.info &lt;- function(names, column){\n  info.mat &lt;- matrix(rep('-', length(column)*length(names)), nrow=length(column), ncol=length(names), dimnames=list(c(), names))\n  info.mat &lt;- as.data.frame(info.mat, stringsAsFactors=F)\n\n  for (i in 1:length(column)){\n    info &lt;- unlist(strsplit(column[i], \"\\\\;\"))\n    for (e in info){\n      e &lt;- unlist(strsplit(e, \"\\\\=\"))\n      j &lt;- which(names == e[1])\n      if (length(e) &gt; 1){\n        # KEY=VALUE. The value might contain a = as well\n        value &lt;- paste(e[2:length(e)], collapse='=')\n        info.mat[i,j] &lt;- value\n      }else{\n        # only KEY\n        info.mat[i,j] &lt;- 'YES'\n      }\n    }\n  }\n  return(info.mat)\n}\n</code></pre>\n\n<p>And then I call:</p>\n\n<pre><code>mat &lt;- unlist.info(names, vector)\n</code></pre>\n\n<p>Even though this works, it is really slow. Also I am handling vectors with over 100.000 entries. Now I realize that looping is inelegant and inefficient in R and I am familiar with the concept of applying functions to data frames. However, since every entry of the vector contains a different subset of <code>KEY=VALUE</code> or <code>KEY</code> entries I could not come up with a more efficient function.</p>\n"},{"tags":["r","unicode","plot"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12926581,"title":"How to plot R barplot with Chinese text by setting locale on Ubuntu?","body":"<p>This is with ref to my previous question on this forum, <a href=\"http://stackoverflow.com/questions/12892335/how-to-plot-bar-plot-with-chinese-names-in-input-file\">How to plot bar plot with Chinese names in input file?</a></p>\n\n<p>I have already edited my <code>sessionInfo</code> like so:</p>\n\n<pre><code>&gt; sessionInfo()\nR version 2.14.1 (2011-12-22)\nPlatform: x86_64-unknown-linux-gnu (64-bit)\n\nlocale:\n[1] LC_CTYPE=zh_CN.UTF-8       LC_NUMERIC=C              \n[3] LC_TIME=zh_CN.UTF-8        LC_COLLATE=zh_CN.UTF-8    \n[5] LC_MONETARY=zh_CN.UTF-8    LC_MESSAGES=zh_CN.UTF-8   \n[7] LC_PAPER=C                 LC_NAME=C                 \n[9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=zh_CN.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nloaded via a namespace (and not attached):\n</code></pre>\n\n<p>But when i run my script <code>a.txt</code></p>\n\n<p><strong>a.txt</strong></p>\n\n<pre><code>x &lt;- read.csv(textConnection(\"名称,类,学生  \n木材,2,2 \n表,3,4 \n笔,4,2 \n垃圾桶,5,6 \n杯,6,3\"), header = TRUE) \nrownames(x) &lt;- x[,1] \nx &lt;- x[,-1] \nbarplot(t(x), horiz = TRUE, beside = TRUE, legend.text = TRUE, xlab=\"名称类学生\") \n\nsource(\"a.txt\",encoding=\"UTF-8\")\n</code></pre>\n\n<p>I get some weird characters instead of Chinese characters (see image below). How can I avoid them? </p>\n\n<p><img src=\"http://i.stack.imgur.com/scx8E.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","file-io","complex-numbers"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":12926756,"title":"In R, how can I read in complex(as in complex number) data using read.table","body":"<p>I am fairly new to R. I have a datafile which has a matrix of complex numbers, each of the form 123+123i, when I try to read in the data in R, using read.table(), it returns strings, which is not what I want. Is there some way to read in a file of complex numbers?</p>\n\n<p>One possible thing that I could do, since the program that generates the matrix is available to me, I can modify it to generate two real numbers instead of a single complex number, and after reading into R, I can make them into a single complex number, now would this be the canonical way to doing what I want?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":2295,"score":0,"question_id":4367177,"title":"R warning \"the condition has length > 1 and only the first element will be used\"","body":"<p>My R code:</p>\n\n<pre><code>bnc1&lt;-function(maxITR=100000, d=2, l=1){\n    counts=0;\n    for (i in 1:maxITR){\n        x=runif(1,0,pi);\n        y=runif(2,0,d/2);\n        if ((l/2*sin(x)) &gt;= y) counts=counts+1;\n    } \n    counts/maxITR*d/l\n}\n</code></pre>\n\n<p>Running the code:</p>\n\n<pre><code>&gt; bnc1(maxITR=1000)\n[1] 0.652\nThere were 50 or more warnings (use warnings() to see the first 50)\n&gt; warnings()\nWarning messages:\n1: In if ((l/2 * sin(x)) &gt;= y) counts = counts + 1 ... :\n  the condition has length &gt; 1 and only the first element will be used\n2: In if ((l/2 * sin(x)) &gt;= y) counts = counts + 1 ... :\n  the condition has length &gt; 1 and only the first element will be used\n...\n49: In if ((l/2 * sin(x)) &gt;= y) counts = counts + 1 ... :\n  the condition has length &gt; 1 and only the first element will be used\n50: In if ((l/2 * sin(x)) &gt;= y) counts = counts + 1 ... :\n  the condition has length &gt; 1 and only the first element will be used\n</code></pre>\n\n<p>Anyone has some idea why are the warnings? Thanks!</p>\n"},{"tags":["r","data.frame","data.table","plyr"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":80,"score":4,"question_id":12925063,"title":"numbering rows within groups in a data frame","body":"<p>working with a data frame similar to this:  </p>\n\n<pre><code> set.seed(100)  \n df &lt;- data.frame(cat=c(rep(\"aaa\",5),rep(\"bbb\",5),rep(\"ccc\",5)),val=runif(15))             \n df &lt;- arrange(df,cat,val)  \n df  \n\n   cat        val  \n1  aaa 0.05638315  \n2  aaa 0.25767250  \n3  aaa 0.30776611  \n4  aaa 0.46854928  \n5  aaa 0.55232243  \n6  bbb 0.17026205  \n7  bbb 0.37032054  \n8  bbb 0.48377074  \n9  bbb 0.54655860  \n10 bbb 0.81240262  \n11 ccc 0.28035384  \n12 ccc 0.39848790  \n13 ccc 0.62499648  \n14 ccc 0.76255108  \n15 ccc 0.88216552 \n</code></pre>\n\n<p>I am trying to add a column with numbering within each group.<br>\ndoing it this way obviously isn't using the powers of R:  </p>\n\n<pre><code> df$num &lt;- 1  \n for (i in 2:(length(df[,1]))) {  \n   if (df[i,\"cat\"]==df[(i-1),\"cat\"]) {  \n     df[i,\"num\"]&lt;-df[i-1,\"num\"]+1  \n     }  \n }  \n df  \n\n   cat        val num  \n1  aaa 0.05638315   1  \n2  aaa 0.25767250   2  \n3  aaa 0.30776611   3  \n4  aaa 0.46854928   4  \n5  aaa 0.55232243   5  \n6  bbb 0.17026205   1  \n7  bbb 0.37032054   2  \n8  bbb 0.48377074   3  \n9  bbb 0.54655860   4  \n10 bbb 0.81240262   5  \n11 ccc 0.28035384   1  \n12 ccc 0.39848790   2  \n13 ccc 0.62499648   3  \n14 ccc 0.76255108   4  \n15 ccc 0.88216552   5  \n</code></pre>\n\n<p>what would be a good way to do this with R tools?</p>\n"},{"tags":["r","replace","data.frame"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":87,"score":3,"question_id":12835942,"title":"Fast replacing values in dataframe in R","body":"<p>I have a dataframe of 150,000 rows with 2,000 columns containing values, some being negatives. \nI am replacing those negative values by 0, but it is extremely slow to do so (~60min or more). </p>\n\n<p><strong>> <code>df[df   &lt; 0] = 0</code></strong></p>\n\n<p>where <code>df[,1441:1453]</code> looks like (all columns/values numeric):</p>\n\n<pre><code>  V1441 V1442 V1443 V1444 V1445 V1446 V1447 V1448 V1449 V1450 V1451 V1452 V1453\n1     3     1     0     4     4    -2     0     3    12     5    17    34    27\n2     0     1     0     7     0     0     0     1     0     0     0     0     0\n3     0     2     0     1     2     3     6     1     2     1    -6     3     1\n4     1     2     3     6     1     2     1    -6     3     1    -4     1     0\n5     1     2     1    -6     3     1    -4     1     0     0     1     0     0\n6     1     0     0     1     0     0     0     0     0     0     1     2     2\n</code></pre>\n\n<p>Is there a way to speed up such process, eg the way I am doing it is utterly slow, and there is faster approach for this ? \nThanks.</p>\n"},{"tags":["r","ubuntu","parallel-processing"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":115,"score":2,"question_id":12924698,"title":"Parallel processing in R limited","body":"<p>I'm running ubuntu 12.04 and R 2.15.1 with the parallel and doParallel packages. when I run anything in parallel I'm limited to 100% of a core, when I should have up to 800%, since I am running it with 8 cores.  What shows up on the system monitor is that each child process is getting only 12%.</p>\n\n<p>What is going on that is limiting my execution speed?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12924894,"title":"Replacing characters using R","body":"<p>I have a csv file with 1 column, Address. It has values like:</p>\n\n<pre><code>A &lt;- structure(list(Address = structure(1:3, .Label = c(\"&amp;2340 P St\", \n \"&amp;5656 N St\", \"456 B Street\"), class = \"factor\")), .Names = \"Address\", \n row.names = c(NA, 3L), class = \"data.frame\")\nA\n##        Address\n## 1   &amp;2340 P St\n## 2   &amp;5656 N St\n## 3 456 B Street\n</code></pre>\n\n<p>I need to clean data – to erase all characters (or replace with space) if there is “&amp;”.\nI am expecting this result in my 2.csv file:</p>\n\n<pre><code>##        Address\n## 1 456 B Street\n</code></pre>\n\n<p>Here's the code:</p>\n\n<pre><code> A &lt;-read.csv(\"U:/161/1.csv\", header=T,sep=\",\")\n B&lt;-gsub(\"&amp;\", \" \", A$ADDRESS1, ignore.case = TRUE)\n write.table(B, file = \"U:/161/2.csv\", sep = \",\"\n , col.names = NA, qmethod = \"double\")\n</code></pre>\n\n<p>It only removes “&amp;”. How do I remove the rest of address?</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":47,"score":-1,"question_id":12925176,"title":"Generating first fifty prime numbers I tried following did not work any suggestions","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3789968/generate-a-list-of-primes-in-r-up-to-a-certain-number\">Generate a list of primes in R up to a certain number</a>  </p>\n</blockquote>\n\n\n\n<p>Generating first 50 prime numbers I tried following did not work any suggestions</p>\n\n<pre><code>f&lt;-integer(50)\nf[1]&lt;- 2\ni &lt;- 1\nwhile (i&lt;= 50) {\n    f[i] &lt;- i[i %% i+1] != 0 | i==i+1\n    i &lt;- i+1}\n</code></pre>\n"},{"tags":["r","sqlite","data.table","plyr","reshape"],"answer_count":2,"favorite_count":6,"up_vote_count":8,"down_vote_count":0,"view_count":469,"score":8,"question_id":5307313,"title":"Fastest Tall-Wide pivoting in R","body":"<p>I am dealing with a simple table of the form</p>\n\n<pre><code>date         variable   value\n1970-01-01   V1         0.434\n1970-01-01   V2         12.12\n1970-01-01   V3         921.1\n1970-01-02   V1         -1.10\n1970-01-03   V3         0.000\n1970-01-03   V5         312e6\n...          ...        ...\n</code></pre>\n\n<p>The pairs (date, variable) are unique. I would like to transform this table into a wide-form one.</p>\n\n<pre><code>date         V1         V2         V3         V4         V5        \n1970-01-01   0.434      12.12      921.1      NA         NA\n1970-01-02   -1.10      NA         NA         NA         NA\n1970-01-03   0.000      NA         NA         NA         312e6\n</code></pre>\n\n<p>And I would like to do it in the fastest possible way, since I have to repeat the operation repeatedly over tables with 1e6 records. In R native mode, I believe that both <code>tapply()</code>, <code>reshape()</code> and <code>d*ply()</code> are dominated speed-wise by <code>data.table</code>.  I would like to test the performance of the latter against a sqlite-based solution (or other DB). Has this been done before? Are there performance gains? And, how does one convert tall-to-wide in sqlite, when the number of \"wide\" fields (the date) is variable and not known in advance?</p>\n"},{"tags":["r","ordering","data.table","plyr"],"answer_count":1,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":494,"score":2,"question_id":5839265,"title":"R Plyr - Ordering results from DDPLY?","body":"<p>Does anyone know a slick way to order the results coming out of a ddply summarise operation?</p>\n\n<p>This is what I'm doing to get the output ordered by descending depth.</p>\n\n<pre><code>  ddims &lt;- ddply(diamonds, .(color), summarise, depth = mean(depth), table = mean(table))\n  ddims &lt;- ddims[order(-ddims$depth),]\n</code></pre>\n\n<p>With output...</p>\n\n<pre><code>&gt; ddims\n  color    depth    table\n7     J 61.88722 57.81239\n6     I 61.84639 57.57728\n5     H 61.83685 57.51781\n4     G 61.75711 57.28863\n1     D 61.69813 57.40459\n3     F 61.69458 57.43354\n2     E 61.66209 57.49120\n</code></pre>\n\n<p>Not too ugly, but I'm hoping for a way do it nicely within ddply(). Anyone know how?</p>\n\n<p>Hadley's ggplot2 book has this example for ddply and subset but it's not actually sorting the output, just selecting the two smallest diamonds per group.</p>\n\n<pre><code>ddply(diamonds, .(color), subset, order(carat) &lt;= 2)\n</code></pre>\n"},{"tags":["perl","r","data.table","plyr","reshape"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":120,"score":1,"question_id":12629287,"title":"Melt a table (data.frame) based on values of comma-separated character vector column","body":"<p>I'm doing an experiment where I have \"regions\" with some associated statistic (actually many other statistics and descriptive columns), and a comma-separated list of genes that lie in those regions. This list will be variable in number, and may not contain anything (\"NA\").</p>\n\n<p>How can I \"melt\" table a:</p>\n\n<pre><code>  region_id  statistic      genelist\n          1        2.5       A, B, C\n          2        0.5    B, C, D, E\n          3        3.2          &lt;NA&gt;\n          4        0.1          E, F\n</code></pre>\n\n<p>To create another table with a separate entry for each gene in the list of genes? I.e.</p>\n\n<pre><code>   region_id statistic gene\n           1       2.5    A\n           1       2.5    B\n           1       2.5    C\n           2       0.5    B\n           2       0.5    C\n           2       0.5    D\n           2       0.5    E\n           3       3.2 &lt;NA&gt;\n           4       0.1    E\n           4       0.1    F\n</code></pre>\n\n<p>I'm guessing there's a way to do this with R/plyr, but I'm not sure how. Thanks in advance.</p>\n\n<p>Edit:</p>\n\n<p>Using R you can recreate these toy vectors with this code:</p>\n\n<pre><code>a &lt;- structure(list(region_id = 1:4, statistic = c(2.5, 0.5, 3.2, \n0.1), genelist = structure(c(1L, 2L, NA, 3L), .Label = c(\"A, B, C\", \n\"B, C, D, E\", \"E, F\"), class = \"factor\")), .Names = c(\"region_id\", \n\"statistic\", \"genelist\"), class = \"data.frame\", row.names = c(NA, \n-4L))\n\nb &lt;- structure(list(region_id = c(1L, 1L, 1L, 2L, 2L, 2L, 2L, 3L, \n4L, 4L), statistic = c(2.5, 2.5, 2.5, 0.5, 0.5, 0.5, 0.5, 3.2, \n0.1, 0.1), gene = structure(c(1L, 2L, 3L, 2L, 3L, 4L, 5L, NA, \n5L, 6L), .Label = c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), class = \"factor\")), .Names = c(\"region_id\", \n\"statistic\", \"gene\"), class = \"data.frame\", row.names = c(NA, \n-10L))\n</code></pre>\n"},{"tags":["r","linear-regression","anova"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12923577,"title":"scope from add1()-command in R","body":"<p>I am not sure how to use the add1 command. Suppose I have a model</p>\n\n<pre><code>y=b0+b1*x1\n</code></pre>\n\n<p>and I would like to know if it would be a better fit to add more independent variables. Now I would test all models</p>\n\n<pre><code>y=b0+b1*x1+b2*x2\n</code></pre>\n\n<p>with different x2 (my different independent variables).\nThe add1 command somehow needs a \"scope\". I am not sure of, what that is.\nI could not find out how to use the add1 command. If I do this:</p>\n\n<pre><code>add1(fittedmodel)\n</code></pre>\n\n<p>I get an error, so I suppose I need to specify which variable I want to use by hand.\nThat is fine, that's actually what I wanted but wasn't sure if it is like that. If I do</p>\n\n<pre><code>add1(fittedmodel, scope=x1+x2, test=\"F\")\n</code></pre>\n\n<p>inserting a specific variable for x2,\nI get the following output:</p>\n\n<p>Single term additions</p>\n\n<p>Model:</p>\n\n<pre><code>sl ~ le\n       Df  Sum of Sq     RSS     AIC F value Pr(&gt;F)\n&lt;none&gt;               0.51211 -523.44               \nky      1 0.00097796 0.51113 -521.63  0.1856 0.6676\n</code></pre>\n\n<p>and I am not sure of if this is what I want. The Model it describes <code>sl~le</code> is not what I wanted (<code>sl~le+ky</code>), but that may just be the model it starts of with?\nThen I do not know what the <code>&lt;none&gt;</code> means.\nWould this now mean that the F-Test-value for comparing model <code>sl~le</code> to model <code>sl~le</code> is 0.1856? Or do I interpret the output wrong?</p>\n\n<p>Then, even if this is right, how do I do it for a model 'sl~le+ky+le:ky', that is if I do have an interaction?\nI don't seem to understand the scope parameter in the add1() command, but I need it, because without it, add1() does not work!</p>\n"},{"tags":["r","sas"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":163,"score":1,"question_id":12881338,"title":"Create SAS-like Library in R","body":"<p>In SAS there's an method of creating Library (using LIBNAME). This is helpful as when we have to do long data processing, we don't change always the dataset name. So, if we want to use a dataset again, without changing the name, we can put in a library. So, even if the dataset name are same, but since they are in different libraries, we can work on them together.</p>\n\n<p>My question is there any such option in R that can create Library (or separate folder within R) so that we can save our data there?</p>\n\n<p>Here's the example:</p>\n\n<p>Suppose I've a dataset \"dat1\". I summarize variables in dat1 var1 &amp; var2 for var3. </p>\n\n<pre><code>proc summary data=dat1 nway missing;\n  var var1 var2;\n  class var3;\n  output out=tmp.dat1 (drop = _freq_ _type_) sum = ;\n  run;\n</code></pre>\n\n<p>Then I merged dat1 with dat2, which is another dataset.Both dat1 &amp; dat2 has common variable var3, with which I merged. I created new dataset dat1 again.</p>\n\n<pre><code>proc sql;\n   create table dat1 as\n   select a.*,b.*\n   from dat1 a left join tmp.dat2 b\n   on a.var3=b.var3;\n  quit;\n</code></pre>\n\n<p>Now, I'm again summarizing dataset dat1 after merging to check if the values of var1 &amp; var 2 remain the same before &amp; after merging.</p>\n\n<pre><code>proc summary data=dat1 nway missing;\n  var var1 var2;\n  class var3;\n  output out=tmp1.dat1 (drop = _freq_ _type_) sum = ;\n  run;\n</code></pre>\n\n<p>The equivalent code in R will be </p>\n\n<pre><code>dat3&lt;-ddply(dat1,.(var3),summarise,var1=sum(var1,na.rm=TRUE),var2=sum(var2,na.rm=TRUE))\n\ndat1&lt;-sqldf(\"select a.*,b.* from dat1 a left join dat2 b on a.var3=b.var3\")\n\ndat4&lt;-ddply(dat1,.(var3),summarise,var1=sum(var1,na.rm=TRUE),var2=sum(var2,na.rm=TRUE))\n</code></pre>\n\n<p>In case of SAS I used just 2 dataset name. But in case of R, I'm using 4 dataset name. So, if I'm writing 4000 line code for data processing, having too many dataset name sometimes become overwhelming. In sas it became easy to have same dataset name as I'm using 2 libraries tmp, tmp1 other than the default work library. </p>\n\n<p>In SAS, library is defined as:</p>\n\n<pre><code>LIBNAME tmp \"directory_path\\folder_name\";\n</code></pre>\n\n<p>In this folder, dat1 will be stored.</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":12923214,"title":"Nomogram plot using ggplot","body":"<p>I am trying to reproduce Naive Bayes nomogram as given in <a href=\"http://iccle.googlecode.com/svn/trunk/share/pdf/mozina04.pdf\" rel=\"nofollow\">Nomograms for Visualization of Naive Bayesian Classifier by Mozina</a>. It is a great visualization for looking at Bayes probabilities. I have been searching and trying various things, but no luck. (I am unable to put all the points on one row for a column.) I've computed probabilities and put them in a data frame called <code>df</code></p>\n\n<pre><code>structure(list(.id = c(\"outlook\", \"outlook\", \"outlook\", \"windy\", \n\"windy\"), variablevalue = structure(c(1L, 2L, 3L, 5L, 6L), .Label = c(\"sunny\", \n\"overcast\", \"rainy\", \"'All'\", \"FALSE\", \"TRUE\"), class = \"factor\"), \nprob = c(0.222222222222222, 0.444444444444444, 0.333333333333333, \n0.666666666666667, 0.333333333333333)), .Names = c(\".id\", \n\"variablevalue\", \"prob\"), row.names = c(1L, 3L, 5L, 11L, 13L), class = \"data.frame\")\n</code></pre>\n\n<p>Here's how the chart would like (this chart is all cut and paste):\n<img src=\"http://i.stack.imgur.com/oEUyA.png\" alt=\"nomogram\"></p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":12922740,"title":"drawing ellipses/hyperbolas in R","body":"<p>I want to draw ellipses, hyperbolas in R. \nHow can I do it using ggplot2?\nLet me give an example</p>\n\n<pre><code>x^2 +3xy+ 4x+ 2y+ 2y^2 = 0 \n</code></pre>\n\n<p>for </p>\n\n<pre><code>x between -2 and 2\ny between -2 and 2\n</code></pre>\n"},{"tags":["r","linear-regression","lm","predict"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12923541,"title":"R: predict.lm() not recognizing an object","body":"<pre><code>&gt; reg.len &lt;- lm(chao1.ave ~ lg.std.len, b.div) # b.div is my data frame imported from a CSV file\n&gt; reg.len\n\nCall:\nlm(formula = chao1.ave ~ lg.std.len, data = b.div)\n\nCoefficients:\n(Intercept)   lg.std.len  \n      282.4       -115.7  \n\n&gt; newx &lt;- seq(0.6, 1.4, 0.01)\n&gt; prd.len &lt;- predict(reg.len, newdata=data.frame(x=newx), interval=\"confidence\", level=0.90, type=\"response\")\nError in eval(expr, envir, enclos) : object 'lg.std.len' not found\n</code></pre>\n\n<p>I've tried doing the lm like this: <code>lm(b.div$chao1.ave ~ b.div$lg.std.len)</code>, but then, <code>predict()</code> gives a warnings that the newdata and variables are different lengths. So, I tried the way above, and now <code>predict()</code> gives an error saying it doesn't recognize the object.  How to fix, please?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":45,"score":3,"question_id":12923958,"title":"When to use approxfun vs. approx","body":"<p>The documentation for <code>approxfun</code> states that it is \"often more useful than <code>approx</code>\". I'm struggling to get my head around <code>approxfun</code>. When would <code>approxfun</code> be more useful than <code>approx</code> (and when would <code>approx</code> be more useful)?</p>\n"},{"tags":["r","cluster-analysis"],"answer_count":1,"favorite_count":3,"up_vote_count":9,"down_vote_count":16,"view_count":1213,"score":-7,"question_id":5648383,"title":"How to apply a hierarchical or k-means cluster analysis using R?","body":"<p>I want to apply a hierarchical cluster analysis with R. I am aware of the <code>hclust()</code> function but not how to use this in practice; I'm stuck with supplying the data to the function and processing the output.</p>\n\n<p>I would also like to compare the hierarchical clustering with that produced by <code>kmeans()</code>. Again I am not sure how to call this function or use/manipulate the output from it.</p>\n\n<p>My data are similar to:</p>\n\n<pre><code>## dummy data\nrequire(MASS)\nset.seed(1)\ndat &lt;- data.frame(mvrnorm(100, mu = c(2,6,3), \n                          Sigma = matrix(c(10,   2,   4,\n                                            2,   3, 0.5,\n                                            4, 0.5,   2), ncol = 3)))\n</code></pre>\n"},{"tags":["r","vector","rowname"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12923809,"title":"Retain rownames as names of vector in R","body":"<p>I have a dataframe as follows:</p>\n\n<pre><code>&gt; df &lt;- data.frame(\"A\"=rnorm(26), \"B\"=rnorm(26),row.names=sample(letters,26))\n</code></pre>\n\n<p>I then want to take column <code>B</code> out as a vector using a different row order</p>\n\n<pre><code>&gt; newOrder &lt;- sample(letters,26)\n&gt; vec &lt;- df[newOrder,\"B\"] #1\n</code></pre>\n\n<p>How can I retain the correct rownames of <code>df</code> as the vector names of <code>vec</code> in a single statement at #1? That is, without having to do:</p>\n\n<pre><code>&gt; names(vec) &lt;- newOrder\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":58,"score":3,"question_id":12922281,"title":"Merge data frames by approximate column values","body":"<p>I've got two data frames containing timeseries (with time coded as numeric, rather than time objects; and time is unsorted). I'd like to normalize a response variable in one data frame to a response variable in another data frame. The problem is that the timepoints in the two data frames aren't quite equivalent. So, I'll need to merge the two data frames by the approximate match of the two time columns.</p>\n\n<p>The data look like this:</p>\n\n<pre><code>df1 &lt;- structure(list(t1 = c(3, 1, 2, 4), y1 = c(9, 1, 4, 16)), .Names = c(\"t1\", \"y1\"), row.names = c(NA, -4L), class = \"data.frame\")\ndf2 &lt;- structure(list(t2 = c(0.9, 4.1), y2 = structure(1:2, .Label = c(\"a\", \"b\"), class = \"factor\")), .Names = c(\"t2\", \"y2\"), row.names = c(NA, -2L), class = \"data.frame\")\n</code></pre>\n\n<p>The result should look like this:</p>\n\n<pre><code>t1  y1    y2\n 1   1    a\n 4  16    b\n</code></pre>\n\n<p>Seems like <code>approx</code> or <code>approxfun</code> would be useful, but I can't quite see how to do it.</p>\n"},{"tags":["r","plot"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":50,"score":-1,"question_id":12920906,"title":"Plot x to y, when x2 is equal to a specific value in R","body":"<p>How do I do the above? I would like to plot the points for that, but I only know how to plot one variable to another, not considering any other variable.\nFirst, I plot <code>x</code> to <code>y</code> and then I want I line (or points would be alright aswell) where <code>x2</code> is equal to a specific value.</p>\n\n<p>example:</p>\n\n<blockquote>\n  <p>x1: 1,1,1,1,1,2,2,2,2,2 <br>\n  x2: 1,2,3,4,5,1,2,3,4,5 <br>\n  y:  3,8,11,14,19,5,10,12,16,19</p>\n</blockquote>\n\n<p>I want to plot x1 to y (x1 on x-axis, y on y-axis). That is</p>\n\n<blockquote>\n  <p>plot(x1,y)</p>\n</blockquote>\n\n<p>now I could plot the points I want to have like this:</p>\n\n<blockquote>\n  <p>points(1,3)<br>\n  points(2,19)</p>\n</blockquote>\n\n<p>as these are the ones for x2==1.\nBut as I have a lot more data, I cannot do that. Plus I would like that to be a line.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":40,"score":0,"question_id":12923265,"title":"Nelder Mead in \"optim\", how does it calculate an initial simplex?","body":"<p>I am trying to move part of a project from R to MATLAB but in order to do so I need to know how the Nelder-Mead algorithm in optim is generating the initial simplex from the user inputted initial guess.</p>\n\n<p>Does anyone know how they are doing or how to view the actual source code for the algorithm?\nWhen I view the optim source code there is a line </p>\n\n<pre><code>res &lt;-.Internal(optim(par, fn1, gr1, method, con, lower, upper\n</code></pre>\n\n<p>that I think calls another file but I'm not familiar enough with R to know what is going on. </p>\n\n<p>I would really appreciate some help.</p>\n"},{"tags":["r","merge","data.table"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":118,"score":6,"question_id":12920803,"title":"merge data.table when the number of key columns are different","body":"<p>I am attempting to understand the logic in the <code>data.table</code> from the documentation and a bit unclear.  I know I can just try this and see what happens but I would like to make sure that there is no pathological case and therefore would like to know how the logic was actually coded. When two <code>data.table</code> objects have a different number of key columns, for example <code>a</code> has 2 and <code>b</code> has 3, and you run <code>c &lt;- a[b]</code>, will <code>a</code> and <code>b</code> be merged simply on the first two key columns or will the third column in a be automatically merged to the 3rd key column in <code>b</code>?  An example:</p>\n\n<pre><code>require(data.table)\na &lt;- data.table(id=1:10, t=1:20, v=1:40, key=c(\"id\", \"t\"))\nb &lt;- data.table(id=1:10, v2=1:20, key=\"id\")\nc &lt;- a[b]\n</code></pre>\n\n<p>This should select rows of <code>a</code> that match the <code>id</code> key column in <code>b</code>. For example, for <code>id==1</code> in <code>b</code>, there are 2 rows in <code>b</code> and 4 rows in <code>a</code> that should generate 8 rows in <code>c</code>. This is indeed what seems to happen:</p>\n\n<pre><code>&gt; head(c,10)\n    id  t  v v2\n 1:  1  1  1  1\n 2:  1  1 21  1\n 3:  1 11 11  1\n 4:  1 11 31  1\n 5:  1  1  1 11\n 6:  1  1 21 11\n 7:  1 11 11 11\n 8:  1 11 31 11\n 9:  2  2  2  2\n10:  2  2 22  2\n</code></pre>\n\n<p>The other way to try it is to do:</p>\n\n<pre><code>d &lt;-b[a]\n</code></pre>\n\n<p>This should do the same thing: for every row in <code>a</code> it should select the matching row in <code>b</code>: since <code>a</code> has an extra key column, <code>t</code>, that column should not be used for matching and a join based only on the first key column, <code>id</code> should be done.  It seems like this is the case:</p>\n\n<pre><code>&gt; head(d,10)\n    id v2  t  v\n 1:  1  1  1  1\n 2:  1 11  1  1\n 3:  1  1  1 21\n 4:  1 11  1 21\n 5:  1  1 11 11\n 6:  1 11 11 11\n 7:  1  1 11 31\n 8:  1 11 11 31\n 9:  2  2  2  2\n10:  2 12  2  2\n</code></pre>\n\n<p>Can someone confirm? To be clear: is the third key column of <code>a</code> ever used in any of the merges or does <code>data.table</code> only use the <code>min(length(key(DT)))</code> of the two tables.</p>\n"},{"tags":["r","sublimetext2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":102,"score":1,"question_id":12736865,"title":"Running R console in remote ssh'd desktop using SublimeREPL","body":"<p>I love Sublime Text 2, and love SublimeREPL's ability to run a console within it.</p>\n\n<p>I'm wondering whether it's possible to run that console on a remote desktop through ssh. </p>\n\n<p>I've tried modifying the sublimeREPL package settings to point to an external machine:\n<code>//\"default_extend_env\":{\"PATH\":\"{PATH};username@remotemachine:R\"}</code></p>\n\n<p>Unfortunately, that didn't work; when I ran sublimeREPL it just went right back to the local copy of R. (I'm running Mac OS X)</p>\n\n<p>Any way to run SublimeREPL's console on a remote machine? Ideally graphical output would get X-forwarded back to the local machine, but that's not totally necessary. </p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":95,"score":3,"question_id":11346685,"title":"Plots with a common x axis","body":"<p>I have a data.frame df with columns <code>T</code> ,<code>V1</code>,<code>V2</code>,<code>V3</code>,<code>V4</code>\nI would like to make a ggplot containing two plots with <code>T</code> as the common the x axis\nThe first plot contains <code>V1</code>\nThe second plot contains <code>V2</code>,<code>V3</code>,<code>V4</code></p>\n\n<p>I tried:</p>\n\n<pre><code>m1 &lt;- melt(df, id = \"T\") \n\nchart1&lt;-qplot(T, value, data = m1, geom = \"line\", group = variable) +\nstat_smooth() +\nfacet_grid(variable ~ ., scale = \"free_y\") \n</code></pre>\n\n<p>But this gives me four common plots whereas I just want two.\nIs there a way to do this?</p>\n"},{"tags":["r","data-visualization","lattice"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":147,"score":3,"question_id":12841895,"title":"dotplot in R with lattice: display of vertical axis and error bars","body":"<p>I'm trying to do a dotplot with the libraries <code>lattice</code> and <code>latticeExtra</code> in <code>R</code>. However, no proper representation of the values on the vertical y-axis is done. Instead of choosing the actual values of the numeric variable, <code>R</code> plots the rank of the value. That is, there are values <code>[375, 500, 625, 750, ..., 3000]</code> and <code>R</code> plots their ranks <code>[1,2,3,4,...23]</code> and chooses the scale accordingly. Has someone experienced a problem like this? How can I manage the get a proper representation with ticks like <code>(0, 500, 1000, 1500, ...)</code> on the vertical y-scale?</p>\n\n<p>Here the program code so far:</p>\n\n<pre><code>df.dose &lt;- read.table(\"data.csv\", sep=\",\", header=TRUE)\nlibrary(lattice); library(latticeExtra)\n\nuseOuterStrips(dotplot(z ~ sample.size | as.factor(effect.size)*as.factor(true.dose),\n               groups=as.factor(type), data=df.dose, as.table=TRUE))\n</code></pre>\n\n<p>(Added from comment below): Also, can error bars be added to the graph? I thought of the following (to be added to the call), but it doesn't seem to work. Is it possible somehow?</p>\n\n<pre><code>up=z+se, lo=z-se, panel.groups=function(x,y,..., up, lo, subscripts){ \n   up &lt;- up[subscripts]\n   lo &lt;- lo[subscripts]\n   panel.segments(lo, as.numeric(y), up, as.numeric(y), ...)\n}\n</code></pre>\n\n<p>Here's my data: <a href=\"https://www.dropbox.com/s/egy25cj00rhum40/data.csv\" rel=\"nofollow\">https://www.dropbox.com/s/egy25cj00rhum40/data.csv</a></p>\n\n<p>Added: here's the relevant portion of the data using <code>expand.grid</code> and <code>dput</code>:</p>\n\n<pre><code>df.dose &lt;- expand.grid(effect.size=c(-.5, -.625, -0.75),\n                       sample.size=c(40L, 60L, 80L),\n                       true.dose=c(375L, 500L, 750L, 1125L),\n                       type=c(\"dose\", \"categ\", \"FP2\", \"FP1\"))\ndf.dose$z &lt;- c(875L, 875L, 750L, 750L, 750L, 625L, 625L, 625L, 625L, 875L, \n875L, 750L, 1000L, 1000L, 1000L, 1125L, 1000L, 875L, 1000L, 1000L, \n875L, 1000L, 1000L, 875L, 1125L, 1000L, 1000L, 1250L, 1125L, \n1000L, 1250L, 1250L, 1125L, 1250L, 1000L, 1000L, 500L, 500L, \n500L, 500L, 500L, 500L, 500L, 500L, 500L, 625L, 625L, 625L, 625L, \n625L, 625L, 625L, 625L, 625L, 750L, 750L, 625L, 750L, 750L, 750L, \n750L, 750L, 750L, 875L, 875L, 750L, 750L, 875L, 875L, 875L, 875L, \n875L, 2500L, 1500L, 1125L, 2000L, 1000L, 1750L, 250L, 500L, 500L, \n1250L, 750L, 625L, 875L, 500L, 500L, 875L, 500L, 375L, 1250L, \n875L, 750L, 1000L, 625L, 625L, 875L, 500L, 500L, 1125L, 1000L, \n875L, 1125L, 875L, 625L, 1125L, 1000L, 625L, 2500L, 2125L, 2375L, \n2000L, 750L, 2625L, 250L, 625L, 250L, 875L, 875L, 500L, 625L, \n500L, 625L, 1000L, 500L, 375L, 1000L, 875L, 625L, 875L, 500L, \n500L, 875L, 500L, 500L, 1250L, 1125L, 875L, 1125L, 875L, 750L, \n1250L, 1000L, 625L)\n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12922195,"title":"is it possible to to have a fixed width on geom_bar","body":"<p>I am working with bunch of different data frames which could have multiple variables or a singel variable:</p>\n\n<p>my data frame looks like this:\n x</p>\n\n<pre><code>Team         Grade\nFootball      10\n</code></pre>\n\n<p>When I do this, bar size is huge. I would like to have a fix size so that it looks good when there is one or 2 rows of data: </p>\n\n<pre><code>ggplot(x, aes(Team, Grade, group=Team)) + geom_bar(aes(fill=Team))\n</code></pre>\n"},{"tags":["r","plyr"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12921730,"title":"Remove quotes from factors of a data frame","body":"<p>I have a data frame that I've <code>discretized</code> using <code>RWeka</code>. RWeka's discretization creates bins with single quotes in them. Although they are not causing any problems, while plotting it looks ugly to have a variable with <code>'All'</code> category. </p>\n\n<p>Here's the discretized data frame:</p>\n\n<pre><code>structure(list(outlook = structure(c(1L, 1L, 2L, 3L, 3L, 3L, \n2L, 1L, 1L, 3L, 1L, 2L, 2L, 3L), .Label = c(\"sunny\", \"overcast\", \n\"rainy\"), class = \"factor\"), temperature = structure(c(1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = \"'All'\", class = \"factor\"), \nhumidity = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L), .Label = \"'All'\", class = \"factor\"), \nwindy = c(FALSE, TRUE, FALSE, FALSE, FALSE, TRUE, TRUE, FALSE, \nFALSE, FALSE, TRUE, TRUE, FALSE, TRUE), play = structure(c(2L, \n2L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L), .Label = c(\"yes\", \n\"no\"), class = \"factor\")), .Names = c(\"outlook\", \"temperature\", \n\"humidity\", \"windy\", \"play\"), row.names = c(NA, -14L), class = \"data.frame\")\n</code></pre>\n\n<p>How can I remove the single quotes from the data and recreate the factors?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12848385,"title":"graphing anomalies from population with R","body":"<p>I am working with a big time series data which looks like:</p>\n\n<pre><code>ProcesID ProcessName  StartDate  EndDate   Duration\n   10       httpd      1/1/2012   1/2/1012  12 Hours\n   11       ftp        1/1/2012   1/2/1012  10 Hours\n   12       snmp       1/1/2012   1/2/1012  5 Hours\n   13       email      1/1/2012   1/2/1012  2 Hours\n   14       java       1/1/2012   1/2/1012  5 Hours\n   15       perl       1/1/2012   1/2/1012  7 Hours\n   20       php        1/1/2012   1/2/1012  6 Hours\n</code></pre>\n\n<p>Number of unique(<code>x$ProcessName</code>) is greater than 500. I cannot graph every <code>ProcessName</code>. I would like to pick the anamolies and graph them. </p>\n\n<p>I did try sample:</p>\n\n<pre><code> y&lt;-x[sample(nrow(x), 50, prob = NULL),]\n\n ggplot(subset(x, ProcessName %in% y$ProcessName), \n       aes(StartDate, Duration, group=ProcessName)) + geom_point()\n</code></pre>\n\n<p>I am not sure if <code>sample</code> is the right choice to perform this analysis? Has anybody did something similar to create graphs from a populationg for only anomolies?</p>\n"},{"tags":["r","csv","plyr"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12822582,"title":"R time series data manipulation with different data length_extract variable","body":"<p>I need some suggestions how to better design my problem’s resolution.</p>\n\n<p>I starting from many Csv file of result of parametric study (time series data). I want to analyze the influence of some parameters on variable. The idea is to extract some variable from table of result for each id of parametric study and create a data.frame for each variable to easily make some plot and some analysis. </p>\n\n<p>The problem is that some parameters change the time step of parametric study, so there are some csv much longer. One variable for example is Temperature. It is possible to maintain the differences on time step and evaluate Delta T varying one parameter? Plyr can do that? Or I have to resample part of my result to make this evaluation losing part of information?\nI achieve to this point at moment:</p>\n\n<pre><code>head(data, 5)\n\n                  names           Date.Time Tout.dry.bulb RHout TsupIn  TsupOut  QconvIn[Wm2]\n1 G_0-T_0-W_0-P1_0-P2_0 2005-01-01 00:03:00             0    50     23 15.84257 -1.090683e-14\n2 G_0-T_0-W_0-P1_0-P2_0 2005-01-01 00:06:00             0    50     23 16.66988  0.000000e+00\n3 G_0-T_0-W_0-P1_0-P2_0 2005-01-01 00:09:00             0    50     23 13.83446  1.090683e-14\n4 G_0-T_0-W_0-P1_0-P2_0 2005-01-01 00:12:00             0    50     23 14.34774  2.181366e-14\n5 G_0-T_0-W_0-P1_0-P2_0 2005-01-01 00:15:00             0    50     23 12.59164  2.181366e-14\n  QconvOut[Wm2] Hvout[Wm2K]  Qradout[Wm2] MeanRadTin MeanAirTin MeanOperTin\n1        0.0000       17.76 -5.428583e-08         23         23          23\n2     -281.3640       17.76 -1.151613e-07         23         23          23\n3     -296.0570       17.76 -1.018871e-07         23         23          23\n4     -245.7001       17.76 -1.027338e-07         23         23          23\n5     -254.8158       17.76 -9.458750e-08         23         23          23\n\n\n&gt; str(data)\n'data.frame':  1858080 obs. of  13 variables:\n$ names        : Factor w/ 35 levels \"G_0-T_0-W_0-P1_0-P2_0\",..: 1 1 1 1 1 1 1 1 1 1 ...\n$ Date.Time    : POSIXct, format: \"2005-01-01 00:03:00\" \"2005-01-01 00:06:00\" \"2005-01-01 00:09:00\" ...\n$ Tout.dry.bulb: num  0 0 0 0 0 0 0 0 0 0 ...\n$ RHout        : num  50 50 50 50 50 50 50 50 50 50 ...\n$ TsupIn       : num  23 23 23 23 23 23 23 23 23 23 ...\n$ TsupOut      : num  15.8 16.7 13.8 14.3 12.6 ...\n$ QconvIn[Wm2] : num  -1.09e-14 0.00 1.09e-14 2.18e-14 2.18e-14 ...\n$ QconvOut[Wm2]: num  0 -281 -296 -246 -255 ...\n$ Hvout[Wm2K]  : num  17.8 17.8 17.8 17.8 17.8 ...\n$ Qradout[Wm2] : num  -5.43e-08 -1.15e-07 -1.02e-07 -1.03e-07 -9.46e-08 ...\n$ MeanRadTin   : num  23 23 23 23 23 23 23 23 23 23 ...\n$ MeanAirTin   : num  23 23 23 23 23 23 23 23 23 23 ...\n$ MeanOperTin  : num  23 23 23 23 23 23 23 23 23 23 ...\n\nnames(DF)\n[1] \"G_0-T_0-W_0-P1_0-P2_0\" \"G_0-T_0-W_0-P1_0-P2_1\" \"G_0-T_0-W_0-P1_0-P2_2\"\n[4] \"G_0-T_0-W_0-P1_0-P2_3\" \"G_0-T_0-W_0-P1_0-P2_4\" \"G_0-T_0-W_0-P1_0-P2_5\"\n[7] \"G_0-T_0-W_0-P1_0-P2_6\" \"G_0-T_0-W_0-P1_1-P2_0\" \"G_0-T_0-W_0-P1_1-P2_1\"\n[10] \"G_0-T_0-W_0-P1_1-P2_2\" \"G_0-T_0-W_0-P1_1-P2_3\" \"G_0-T_0-W_0-P1_1-P2_4\"\n[13] \"G_0-T_0-W_0-P1_1-P2_5\" \"G_0-T_0-W_0-P1_1-P2_6\" \"G_0-T_0-W_0-P1_2-P2_0\"\n[16] \"G_0-T_0-W_0-P1_2-P2_1\" \"G_0-T_0-W_0-P1_2-P2_2\" \"G_0-T_0-W_0-P1_2-P2_3\"\n[19] \"G_0-T_0-W_0-P1_2-P2_4\" \"G_0-T_0-W_0-P1_2-P2_5\" \"G_0-T_0-W_0-P1_2-P2_6\"\n[22] \"G_0-T_0-W_0-P1_3-P2_0\" \"G_0-T_0-W_0-P1_3-P2_1\" \"G_0-T_0-W_0-P1_3-P2_2\"\n[25] \"G_0-T_0-W_0-P1_3-P2_3\" \"G_0-T_0-W_0-P1_3-P2_4\" \"G_0-T_0-W_0-P1_3-P2_5\"\n[28] \"G_0-T_0-W_0-P1_3-P2_6\" \"G_0-T_0-W_0-P1_4-P2_0\" \"G_0-T_0-W_0-P1_4-P2_1\"\n[31] \"G_0-T_0-W_0-P1_4-P2_2\" \"G_0-T_0-W_0-P1_4-P2_3\" \"G_0-T_0-W_0-P1_4-P2_4\"\n[34] \"G_0-T_0-W_0-P1_4-P2_5\" \"G_0-T_0-W_0-P1_4-P2_6\"\n</code></pre>\n\n<p>From P1_4-P2_0 to P1_4-P2_6 the length is 113760 obs estand of 37920 because the time step change from 3 min to 1 min.</p>\n\n<p>I’d like to have separated database for each variable in which I have date.time and value of variable for each names in column.\nHow I can do it?</p>\n\n<p>Thank for any suggestion</p>\n"},{"tags":["r","ggplot2","visualization"],"answer_count":3,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":500,"score":7,"question_id":7492274,"title":"Draw a chronological timeline with ggplot2","body":"<p>I have data like</p>\n\n<pre><code>data = as.data.frame(  rbind(   c(\"1492\", \"Columbus sailed the ocean blue\"),\n                                c(\"1976\", \"Americans listened to Styx\"),\n                                c(\"2008\", \"financial meltdown. great.\")\n                                ))\n</code></pre>\n\n<p>and I want to build a plot in <code>ggplot2</code> that will display an arrow for time <code>aes(x=$V1)</code> and text for <code>aes(label=$V2)</code>. It sounded pretty simple until I tried to draw it.</p>\n\n<p><strong>update:</strong> I didn't write it but you need to do <code>as.Date(\"1492\", format=\"%Y\")</code> to reproduce correctly.</p>\n\n<p><strong>NB:</strong> Solutions given below only deal with events that occur at a specific date -- not timelines with \"periods\" or \"eras\".</p>\n"},{"tags":["r","graphviz"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12921361,"title":"Rgraphviz neato layout","body":"<p>I'm trying to create a cluster diagram for an adjacency matrix I've constructed in R.  I can get it to render the diagram but I don't know how to modify the neato-specific parameters so the diagram doesn't look completely tangled.</p>\n\n<p>here's what I have so far:</p>\n\n<pre><code>am.graph&lt;-new(\"graphAM\", adjMat=linkadj, edgemode=\"undirected\")\nplot(am.graph, \"neato\")\n</code></pre>\n\n<p>Between the above commands it seems like you should use the <a href=\"http://rss.acs.unt.edu/Rdoc/library/Rgraphviz/html/layoutGraph.html\" rel=\"nofollow\">following function</a> but the documentation is too sparse for me to make sense of it </p>\n"},{"tags":["xml","r"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":267,"score":1,"question_id":9429390,"title":"Can Not Install XML Package","body":"<p>I can not install the latest XML package V3.9-4. \nI mannually install it in RGui by typing:</p>\n\n<pre><code>install.packages(\"LOCALDIR/XML_3.6-0.tar.gz\", repos=NULL, type=\"source\")\n</code></pre>\n\n<p>But get some error message:</p>\n\n<pre><code>* installing *source* package 'XML' ...\nPlease define LIB_XML (and LIB_ZLIB, LIB_ICONV)\nERROR: configuration failed for package 'XML'\n* removing 'LOCALDIR/R/win-library/2.12/XML'\n* restoring previous 'LOCALDIR/R/win-library/2.12/XML'\n</code></pre>\n\n<p>Anyone any idea?</p>\n\n<p>Thx!</p>\n"},{"tags":["r","datetime","time-series"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":213,"score":0,"question_id":6508088,"title":"Compare a fine and a coarse time series at only the coarse scale","body":"<p>I have two <code>data.frame</code>s in <code>R</code>, each indexed by date. One is coarser than the other and I would like to compare the data only along the coarser timescale.</p>\n\n<p>To be more concrete let's say one <code>data.frame</code> has time points <code>DF1[a,b,c,...,x,y,z]</code> and the other only has <code>DF2[f,p,t]</code>, where <code>p==\"July 19, 1917\"</code>. I wish to compare <code>DF1[f,p,t]</code> to <code>DF2[f,p,t]</code>.</p>\n\n<p>This isn't syntactic but I want to do  <code>for each $i { DF_combined &lt;- df1[$i] . df2[$i] if exists(df1[$i]); }</code>. In other words, make a new <code>data.frame</code> that only contains every shared observation day.</p>\n\n<p>I hope the question is clear. I've been looking at other SO answers for a couple of hours and haven't found one that covers what I'm trying to do yet. Thanks in advance.</p>\n"},{"tags":["r","categorization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12919816,"title":"plotting in different shapes using pch= argument","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12918424/using-pch-to-plot-categorical-data-in-different-shapes\">Using pch to plot categorical data in different shapes</a>  </p>\n</blockquote>\n\n\n\n<p>If I am using R to plot. How can I assign a particular shape to data points belonging to one category (using the <code>pch</code> argument to <code>plot()</code>) based on a column in my data frame that has the categorical data?  Will using <code>as.factor()</code> to group data and then using <code>pch</code> help ?</p>\n"},{"tags":["r","rgooglemaps"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12908166,"title":"RgoogleMaps PlotOnStaticMap not adding points to png fiile","body":"<p>I'm trying to save a map with points overlayed to a png file use RgoogleMaps.\nI'm able to successfully create maps and overlay points in a plot device but can't figure out how to get the points written to a png file of my map.</p>\n\n<p>I'm on a Mac OS X Lion 10.7.5\nR version 2.15.0</p>\n\n<p>Using example code from R docs I get the same results: lines on my open plot device, but not written to png file.</p>\n\n<p>Here is the example code I'm using:</p>\n\n<pre><code>lat = c(40.702147,40.718217,40.711614);\nlon = c(-74.012318,-74.015794,-73.998284);\ncenter = c(mean(lat), mean(lon));\nzoom &lt;- min(MaxZoom(range(lat), range(lon)));\n#this overhead is taken care of implicitly by GetMap.bbox();              \nMyMap &lt;- GetMap(center=center, zoom=zoom,markers = '&amp;markers=color:blue|label:S|40.702147,-74.015794&amp;markers=color:green|label:G|40.711614,-74.012318&amp;markers=color:red|color:red|label:C|40.718217,-73.998284', destfile = \"MyTile1.png\");\n\ntmp &lt;- PlotOnStaticMap(MyMap, lat = c(40.702147,40.711614,40.718217), lon = c(-74.015794,-74.012318,-73.998284), destfile = \"MyTile1.png\", cex=1.5,pch=20,col=c('red', 'blue', 'green'), add=FALSE);\n#and add lines:\nPlotOnStaticMap(MyMap, lat = c(40.702147,40.711614,40.718217), lon = c(-74.015794,-74.012318,-73.998284), lwd=1.5,col=c('red', 'blue', 'green'), FUN = lines, add=TRUE)\n</code></pre>\n\n<p>I know that png device is working because this works:</p>\n\n<pre><code>png('my.png')\nplot(seq(1:10))\ndev.off()\n</code></pre>\n\n<p>Thanks for any help.</p>\n"},{"tags":["r","random-forest"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12900319,"title":"Subscript out of bounds while building RF","body":"<p>I'm trying to build a classifier based upon a random forest in r.</p>\n\n<p>The code to reproduce this:</p>\n\n<pre><code>    library(quantmod)\n    library(randomForest)\n\n    getSymbols('^GSPC', from=\"2002-01-01\") \n    GSPC &lt;- GSPC[,1:5] # remove adjusted close\n    GSPC$wkret &lt;- lag(GSPC$GSPC.Close,-5)/GSPC$GSPC.Close # build weekly future return\n    GSPC$wkret &lt;- GSPC$wkret * 100 -100 # build index\n\n    cutoff &lt;- floor(dim(GSPC)[1]/4) # select the row at 25%\n    cutoffbreak &lt;- sort(abs(as.data.frame(GSPC$wkret)[,1]),decreasing=T)[cutoff] # get the top 25% return in absolute terms\n    y &lt;- cut(GSPC$wkret, breaks=c('-100',-cutoffbreak,cutoffbreak ,'100'),labels=c('down','','up')) # build factors \n    randomForest(GSPC[1:100],y[1:100]) # select first 100 to exclude NA's, dimension problems.\n</code></pre>\n\n<p>This works:</p>\n\n<pre><code>y[1:100]\n[1]                                                                                      down      down down\n [22]                up   up        down      down                          up   up   up   up \n=== zip ===\n\n&gt; is.factor(y)\n[1] TRUE\n\n&gt; x[1:100]\n              open    high     low   close     volume\n2002-01-02 1148.08 1154.67 1136.23 1154.67 1171000000\n2002-01-03 1154.67 1165.27 1154.01 1165.27 1398900000\n2002-01-04 1165.27 1176.55 1163.42 1172.51 1513000000\n2002-01-07 1172.51 1176.97 1163.55 1164.89 1308300000\n=== zip ===\n\n&gt; class(x)\n[1] \"xts\" \"zoo\"\n</code></pre>\n\n<p>This works (but makes no sense of course):</p>\n\n<pre><code>lm(y[1:100] ~ .,data=x[1:100])\n</code></pre>\n\n<p>but building a randomforest gives:</p>\n\n<pre><code>&gt; rf &lt;- randomForest(y[1:100] ~ .,data=x[1:100])\nError in randomForest.default(m, y, ...) : subscript out of bounds\n\n&gt; traceback()\n4: randomForest.default(m, y, ...)\n3: randomForest(m, y, ...)\n2: randomForest.formula(y[1:100] ~ ., data = x[1:100])\n1: randomForest(y[1:100] ~ ., data = x[1:100])\n</code></pre>\n\n<p>googling around says this is a dimensions problem, but can't figure out why/how.</p>\n\n<p>r version:</p>\n\n<blockquote>\n  <p>R.version\n                 _<br>\n          platform       i686-pc-linux-gnu<br>\n          arch           i686<br>\n          os             linux-gnu<br>\n          system         i686, linux-gnu<br>\n          status<br>\n          major          2<br>\n          minor          15.1<br>\n          year           2012<br>\n          month          06<br>\n          day            22<br>\n          svn rev        59600<br>\n          language       R<br>\n          version.string R version 2.15.1 (2012-06-22)\n          nickname       Roasted Marshmallows  </p>\n</blockquote>\n\n<p>library versions:</p>\n\n<pre><code>    randomForest version: \"2.15.1\"\n    quantmod version: \"2.15.1\"\n</code></pre>\n"},{"tags":["r","delete"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":12919984,"title":"How to delete specific rows and columns from a matrix in a smarter way?","body":"<p>Let's say <code>t1</code> is :</p>\n\n<pre><code>t1 &lt;- array(1:20, dim=c(10,10))\n\n      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]\n [1,]    1   11    1   11    1   11    1   11    1    11\n [2,]    2   12    2   12    2   12    2   12    2    12\n [3,]    3   13    3   13    3   13    3   13    3    13\n [4,]    4   14    4   14    4   14    4   14    4    14\n [5,]    5   15    5   15    5   15    5   15    5    15\n [6,]    6   16    6   16    6   16    6   16    6    16\n [7,]    7   17    7   17    7   17    7   17    7    17\n [8,]    8   18    8   18    8   18    8   18    8    18\n [9,]    9   19    9   19    9   19    9   19    9    19\n[10,]   10   20   10   20   10   20   10   20   10    20\n</code></pre>\n\n<p>I want to delete row 4-6 and column 7-9 from this matrix.</p>\n\n<p>I know how to remove it one by one using </p>\n\n<pre><code>t2 &lt;- t1[,-7]\nt3 &lt;- t2[,-8]\nt4 &lt;- t3[,-9]\nt5 &lt;- t4[-4,]\nt6 &lt;- t5[-5,]\nt7 &lt;- t6[-6,]\n</code></pre>\n\n<p>However, I believe it is the most stupid way of doing it.  Could you mind to advice some smarter ways of doing it?</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":12918989,"title":"Generating spatially uncorrelated random fields in R","body":"<p>I have a DEM (cellsize 10x10 and cells.dim 450x300)\nand I need to create 100 random error grids \nthat have the same dimensions as the DEM.</p>\n\n<p>The values in the error grids are generated from a \nnormal distribution that has mean of zero and\na standard deviation equal to the RMSE of original DEM ~ (0, +-3). </p>\n\n<p>Then I need to add those error grids to the original DEM \nand create 100 realisation of the original DEM.</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":1,"up_vote_count":11,"down_vote_count":0,"view_count":195,"score":11,"question_id":12792896,"title":"Passing arguments to iterated function through apply","body":"<p>I have a function like this dummy-one:</p>\n\n<pre><code>FUN &lt;- function(x, parameter){\n  if (parameter == 1){\n      z &lt;- DO SOMETHING WITH \"x\"}\n  if (parameter ==2){\n      z &lt;- DO OTHER STUFF WITH \"x\"}\nreturn(z)\n}\n</code></pre>\n\n<p>Now, I would like to use the function on a dataset using apply.\nThe problem is, that <code>apply(data,1,FUN(parameter=1))</code></p>\n\n<p>wont work, as FUN doesn't know what \"x\" is.\nIs there a way to tell apply to call FUN with \"x\" as the current row/col?\n`</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12919049,"title":"\"Subscript out of bounds\" when using effects package","body":"<p>I am using the effects package to construct some probability graphs showing the predicted probabilities from a logistic regression model.However, I get an odd error message and don't know what the issue is.</p>\n\n<p>When I attempt to generate the plots, I get the following error. The warning is not an issue, it's that I'm not understanding what the error message is telling me.</p>\n\n<pre><code>library(effects)    \n\ndat$won_ping = as.factor(dat$won_ping)\n\nmod2 = glm(won_ping ~ our_bid +\n  age_of_oldest_driver2 + \n  credit_type2 + \n  coverage_type2 +\n  home_owner2 +\n  vehicle_driver_score + \n  currently_insured2 +\n  zipcode2,\n  data=dat, family=binomial(link=\"logit\"))\n\n&gt; plot(effect(\"our_bid*vehicle_driver_score\", mod2), rescale.axis=FALSE, multiline=TRUE)\nWarning message:\nIn analyze.model(term, mod, xlevels, default.levels) :\n  our_bid:vehicle_driver_score does not appear in the model\nError in plot(effect(\"our_bid*vehicle_driver_score\", mod2), rescale.axis = FALSE,  : \n  error in evaluating the argument 'x' in selecting a method for function 'plot': Error in apply(mod.matrix[, components], 1, prod) : \n  subscript out of bounds\n</code></pre>\n\n<p>Here's info on my data and my glm commands:</p>\n\n<pre><code>&gt; str(dat)\n'data.frame':   85240 obs. of  71 variables:\n $ our_bid                     : num  155 123 183 98 108 159 98 123 98 200 ...\n $ won_ping                    : Factor w/ 2 levels \"0\",\"1\": 1 1 2 1 1 1 1 1 1 1 ...\n $ zipcode2                    : Factor w/ 4 levels \"1:6999\",\"10000:14849\",..: 4 3 2 1 3 2 3 1 2 2 ...\n $ age_of_oldest_driver2       : Factor w/ 4 levels \"18 to 21\",\"22 to 25\",..: NA 3 NA NA NA NA 3 NA 3 NA ...\n $ currently_insured2          : Factor w/ 2 levels \"0\",\"1\": 2 1 2 2 1 1 2 2 1 1 ...\n $ credit_type2                : Ord.factor w/ 4 levels \"POOR\"&lt;\"FAIR\"&lt;..: 2 3 2 3 2 2 1 3 3 2 ...\n $ coverage_type2              : Factor w/ 4 levels \"BASIC\",\"MINIMUM\",..: 4 3 3 3 3 3 3 3 4 3 ...\n $ home_owner2                 : Factor w/ 2 levels \"0\",\"1\": 1 2 2 2 2 2 2 2 2 2 ...\n $ vehicle_driver_score        : Factor w/ 2 levels \"0\",\"1\": 1 1 1 1 1 1 1 1 1 1 ...\n</code></pre>\n\n<p>And finally, here might be some useful info:</p>\n\n<pre><code>&gt; sessionInfo()\nR version 2.14.0 (2011-10-31)\nPlatform: x86_64-pc-mingw32/x64 (64-bit)\n\nlocale:\n[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252    LC_MONETARY=English_United States.1252\n[4] LC_NUMERIC=C                           LC_TIME=English_United States.1252    \n\nattached base packages:\n[1] grid      stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] effects_2.2-1    colorspace_1.1-1 nnet_7.3-1       MASS_7.3-16      lattice_0.20-0   foreign_0.8-46  \n\nloaded via a namespace (and not attached):\n[1] tools_2.14.0\n</code></pre>\n\n<p>Help! What is the error message mean? Normally, if a \"subscript is out of bounds\" that'd mean I'm selecting something outside the bounds of that data structure, but that simply is not occuring.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>To @Rowland</p>\n\n<p>As I said above, the warning and error messages are seperate and unrelated. Let's say I take out zipcode2 and run the glm:</p>\n\n<pre><code>mod2 = glm(won_ping ~ our_bid +\n  age_of_oldest_driver2 + \n  credit_type2 + \n  coverage_type2 +\n  home_owner2 +\n  vehicle_driver_score + \n  currently_insured2,\n  data=dat, family=binomial(link=\"logit\"))\n\n&gt; plot(effect(\"our_bid*home_owner2\", mod2), rescale.axis=FALSE, multiline=TRUE)\nWarning message:\nIn analyze.model(term, mod, xlevels, default.levels) :\n  our_bid:home_owner2 does not appear in the model\n</code></pre>\n\n<p>This produces just the warning, which is fine as I get the desired result. So the fact that \"<em>:</em>\" does not appear in the model is not the issue, and DOES NOT cause the error message.</p>\n"},{"tags":["r","statistics","simulation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12919260,"title":"function `sample` in R, are these two code snippets equivalent?","body":"<p>Are these two code snippets equivalent, i.e. are they doing the same thing?</p>\n\n<p>For what I understand from the help of <code>sample</code> they should do the same thing, i.e. both <code>s1</code> and <code>s2</code> are a random subset of <code>x</code>.</p>\n\n<p>First snippet:</p>\n\n<pre><code>sz &lt;- 5\nx &lt;- 1:10\ns1 &lt;- sample(x,size=sz,replace=F)\n</code></pre>\n\n<p>Second snippet:</p>\n\n<pre><code>sz &lt;- 5\nx &lt;- 1:10\ns2 &lt;- c()\nidx &lt;- sample(1:length(x),size=sz,replace=F)\nfor ( i in idx ) {\n    s2 &lt;- c(s2,x[i])\n}\n</code></pre>\n"},{"tags":["r"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":99,"score":2,"question_id":12917158,"title":"Loop over several columns with ddply","body":"<p>I have a df :</p>\n\n<p><code>head(df)</code> :</p>\n\n<pre><code>  Year              Asset1       Asset2        Asset3 Asset4    Asset5 \n1 1857              1729900        32570       288482 1251642      0                     0     67374            89832\n2 1858              1870213        35255       312262 1354817      0                     0     71948            95931\n3 1859              1937622        36418       322562 1399505      0                     0     76773           102364\n4 1860              1969257       207557        83393 1484403      0                     0     83102           110802\n5 1861              2107481       222969        89585 1594627      0                     0     85843           114457\n6 1862              2306227       235498        94619 1684234      0                     0     80613           211263\n</code></pre>\n\n<p>I use <code>ddply</code> to construct a new df where Asset 2:5 are divided by Asset1:</p>\n\n<pre><code>dft&lt;-ddply(df,.(Year),transform, \n\n              Asset2=Asset2/Asset1,\n              Asset3=Asset3/Asset1,\n              Asset4=Asset4/Asset1,\n              Asset5=Asset5/Asset1)\n</code></pre>\n\n<p>But it is quiet a lot of job if there are a lot of columns... Any suggestions?</p>\n\n<p>Best Regards!</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12918424,"title":"Using pch to plot categorical data in different shapes","body":"<p>I used <code>as.factor()</code> to group my data frame samples into categories.</p>\n\n<p>Lets say <code>family=as.factor(column name that contains the grouping parameter)</code>. and then used <code>plot3d(x,y,z,col=family)</code> to plot the categories in different colors, where <code>x</code>, <code>y</code> and <code>z</code> are columns in my data frame.</p>\n\n<p>Can I use yet another column in the same data frame to classify the samples on another basis and then plot these categories in different forms using the <code>pch</code> function while retaining the original information based on different colors of the initial grouping in the same plot?</p>\n"},{"tags":["java","r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12916100,"title":"why no command history in Java GUI for R (JGR)?","body":"<p>Apologies for asking in SO, but rforge.net doesn't seem to have either a forum or a working bugzilla.   Does anyone know if there's a functional reason that JGR doesn't allow saving and loading history?<br>\nIf not, is there a way to submit a 'feature request' to the team?</p>\n"},{"tags":["r","data-visualization","large-data"],"answer_count":2,"favorite_count":0,"up_vote_count":14,"down_vote_count":0,"view_count":132,"score":14,"question_id":12918367,"title":"In R, how to plot with a png as background?","body":"<p>In R, made a <a href=\"http://biocluster.ucr.edu/~alevchuk/cs235-proj/fig-5.png\" rel=\"nofollow\">plot with a 3M points</a> and saved it as PNG. It took a few hours and I would like to avoid re-drawing all the points.  </p>\n\n<p><img src=\"http://i.stack.imgur.com/hELX9.png\" alt=\"enter image description here\"></p>\n\n<p>How can I generate a new plot that has this PNG as a background?</p>\n"},{"tags":["r","matlab","polynomial-math"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":104,"score":0,"question_id":12914991,"title":"polyfit function conversion from matlab to r","body":"<p>So matlab help has the following description :</p>\n\n<pre><code>[P, S, MU] = POLYFIT[X,Y,N]\n</code></pre>\n\n<p>I know what the input variables mean, but i cant calculate the <code>MU</code> \"manually\". The <code>MU</code> i need for calculating the area of a peak.</p>\n\n<p>I need to convert source code from MATLAB to R, but don't know what's the best to do.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12916487,"title":"Scope of variables in recursively called functions","body":"<p>I understand that variables are local to a function in R, but what happens if I recursively call a function from itself? Will assignments from within the function be overwritten by subsequent evocations of the function?</p>\n"},{"tags":["r","model","lda"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12916344,"title":"Topicmodels in R for LDA and CTM","body":"<p>I am new to R and also to \"Topic Modeling\".</p>\n\n<p>I am trying to implement LDA and CTM using the R package topicmodels.</p>\n\n<p>I find that for small datasets, my program works. However, if I run it on a large dataset, it fails... (My R program gets \"killed\").</p>\n\n<p>I am running the R program on an Ubuntu Linux machine, with 4GB RAM.</p>\n\n<p>Would you kindly suggest some solution to my problem?</p>\n\n<p>Best regards,</p>\n"},{"tags":["arrays","r","function","data","factor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12915529,"title":"How do I perform a function on multiple rows of data which are factored by the column they are in R?","body":"<p>I have a table in a file with many rows which i have read into R using</p>\n\n<pre><code>data &lt;-read.table(\"path/to/data.txt\",header=TRUE, sep=\"\\t\",row.names=1)\n            A1    A2    A3    B1    B2    B3\n    Row1    1      3    2     3     2     6    \n    Row2    3      2    1     3     6     7\n    ...\n</code></pre>\n\n<p>I have then read this into a frame using</p>\n\n<pre><code>df &lt;-data.frame(data)\n</code></pre>\n\n<p>I would like to perform a function() to compare the A samples against the B samples for each row, </p>\n\n<pre><code>function(A,B)\n</code></pre>\n\n<p>but I am unsure how to specify only the A's and only the B's from the data frame for each row - is there a way to do this all at once for the whole data table? do I have to read the data into a frame or can I work straight from the initial read.table data? </p>\n"},{"tags":["r","lasso"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":52,"score":-3,"question_id":12916047,"title":"Non negative lasso in R","body":"<p>This is a repost, but any help will be appreciated. I am looking for non negative lasso implementation in R. Non negative means that all coefficients are positive.</p>\n"},{"tags":["r","output"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12915550,"title":"creating nice looking output in r","body":"<p>I am making a number of calculations from a dataset and I want to display the end results in a structured and ordered way in a txt document. </p>\n\n<p>So far I have tried something which  is really messy but it kinda works (see below), but I'm sure there are better and more elegant solutions. When using cbind, I get the [,1]   [,2] etc labels on top of my data and I don't need them in my output.</p>\n\n<pre><code>  id = c(1, 2,3,4)\n  age = c(10, 12, 14, 17)\n  gender = c(\"m\", \"f\", \"m\", \"f\")\n  dataset = data.frame (id,age, gender)\n  attach (dataset)\n  space = \"+++++++++++++++++++++++++++++++\"\n  print1 = summary (dataset)\n  print2 = cbind(\"age oldest student\", max(age))\n  printfull = capture.output(print1, space, print2, space)\n  write.table(printfull, \"C:/Users/me/Desktop/dataset123.txt\")\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":12904375,"title":"Increase efficiency for an R simulator of the Monty Hall Puzzle","body":"<p>The Monty Hall Problem is a simple puzzle involving probability that even stumps professionals in careers dealing with some heavy-duty math.  Here's the basic problem:</p>\n\n<p><strong>Suppose you're on a game show, and you're given the choice of three doors: Behind one      door is a car; behind the others, goats. You pick a door, say No. 1, and the host, who      knows what's behind the doors, opens another door, say No. 3, which has a goat. He then says to you, \"Do you want to pick door No. 2?\" Is it to your advantage to switch your choice?</strong></p>\n\n<p>You can find numerous explanations of the solution here: \n<a href=\"http://en.wikipedia.org/wiki/Monty_Hall_problem\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Monty_Hall_problem</a>\nGoal of my simulation: Prove that a switching strategy will win you the car 2/3 of the time.</p>\n\n<p>I got curious and wanted to write a little function that simulates the problem many times and returns the proportion of wins if you switched and the proportion of wins if you stayed with your first choice.  The function then plots the cumulative wins.  </p>\n\n<p>This function takes a long time to run once I get to about 10,000 simulations.  I know I don't need this many simulations to prove this but I'd love to hear some ideas on how to make it more efficient.  Thanks for your feedback!</p>\n\n<pre><code>Monty_Hall=function(repetitions){\ndoors=c('A','B','C')\nstay_wins=0\nswitch_wins=0\nseries=data.frame(sim_num=seq(repetitions),cum_sum_stay=replicate(repetitions,0),cum_sum_switch=replicate(repetitions,0))\nfor(i in seq(repetitions)){\n    winning_door=sample(doors,1)\n    contestant_chooses=sample(doors,1)\n    if(contestant_chooses==winning_door)\n        stay_wins=stay_wins+1\n    else\n        switch_wins=switch_wins+1\n    series[i,'cum_sum_stay']=stay_wins\n    series[i,'cum_sum_switch']=switch_wins\n}\nplot(series$sim_num,series$cum_sum_switch,col=2,ylab='Cumulative # of wins',\nxlab='Simulation #',main=sprintf('%d Simulations of the Monty Hall Paradox',repetitions),type='l')\nlines(series$sim_num,series$cum_sum_stay,col=4)\nlegend('topleft',legend=c('Cumulative wins from switching',\n'Cumulative wins from staying'),col=c(2,4),lty=1)\nresult=list(series=series,stay_wins=stay_wins,switch_wins=switch_wins,\nproportion_stay_wins=stay_wins/repetitions,\nproportion_switch_wins=switch_wins/repetitions)\nreturn(result)\n}\n#Theory predicts that it is to the contestant's advantage if he \n#switches his choice to the other door.  This function simulates the game\n#many times, and shows you the proportion of games in which staying or \n#switching would win the car.  It also plots the cumulative wins for each strategy.\nMonty_Hall(100)\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":55,"score":-1,"question_id":12911234,"title":"Clustering Large Data Matrix using R","body":"<p>I have a large data matrix (33183x1681), each row corresponding to one observation and each column corresponding to the variables. </p>\n\n<p>I applied K-medoids clustering using PAM function in R, and I tried to visualize the clustering results using the built-in plots available with the PAM function. I got this error:</p>\n\n<pre><code>Error in princomp.default(x, scores = TRUE, cor = ncol(x) != 2) :\ncannot use cor=TRUE with a constant variable\n</code></pre>\n\n<p>I think this problem is because of the high dimensionality of the data matrix I'm trying to cluster. </p>\n\n<p>Any thoughts/ideas how to tackle this issue?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12914151,"title":"differentially expressed genes in R","body":"<pre><code>I have the matrix in the following format :\n\n\nID_REF      GSM362180    GSM362181  GSM362188    GSM362189  GSM362192\n244901_at   5.094871713 4.626623079 4.554272515 4.748604391 4.759221647\n244902_at   5.194528083 4.985930299 4.817426064 5.151654407 4.838741605\n244903_at   5.412329253 5.352970877 5.06250609  5.305709079 8.365082403\n244904_at   5.529220594 5.28134657  5.467445095 5.62968933  5.458388909\n244905_at   5.024052699 4.714631878 4.792865831 4.843975286 4.657188246\n244906_at   5.786557533 5.242403911 5.060605782 5.458148567 5.890061836\n</code></pre>\n\n<p>In the above matrix the first column is the list of genes ( 22810) and the corresponding columns correspond to the different promoters ( totally 4 different types) . How would it be possible to find the differentially expressed genes in such a case ?? </p>\n\n<p>I wantto use the t- test to identify the DEG's. I know to find the DEG's using the multtest package in R in case of two conditions ( such as control and treatment). But do not know how to proceed with four different types of promoters and identify the DEG's .</p>\n"},{"tags":["r","function","integration","estimation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12910074,"title":"Non-numerical function estimation and integration","body":"<p>Please, put in R the following structures:</p>\n\n<pre><code>g &lt;- c(0.00125277273229879, 0.00126154615176554, 0.0012703959424814, \n0.00127932294600281, 0.00128832795839672, 0.00129741176435766, \n0.00130657513720778, 0.00131581896967928, 0.00132514399529097, \n0.00133455111246124, 0.00134404117411893, 0.0013536149592724, \n0.00136327342888814, 0.00137301739609167, 0.00138284774792897, \n0.00139276542262179, 0.00140277127309897, 0.00141286625464083, \n0.00142305128272433, 0.0508421359805228, 0.00186998245686827, \n0.00188362983020243, 0.00189739567535365, 0.00191128104995371, \n0.00192528723908206, 0.00193941540840815, 0.00195366674065997, \n0.00196804251523079, 0.00198254393190719, 0.0019971722359653, \n0.00201192874091554, 0.00202681464654449, 0.0020418313232245, \n0.00205698005034884, 0.00207226214711413, 0.002087678932717, \n0.00210323179458836, 0.00211892205192484, 0.00213475116039167, \n-0.114451596942742, 0.00120694924932032, 0.00121602907494663, \n0.00122519601872553, 0.00123445103025114, 0.00124379508186234, \n0.00125322929373903, 0.00126275455292721, 0.00127237205352726, \n0.00128208273376092, 0.00129188771380808)\n\ngx &lt;- c(122.05, 122.1, 122.15, 122.2, 122.25, 122.3, 122.35, 122.4, \n122.45, 122.5, 122.55, 122.6, 122.65, 122.7, 122.75, 122.8, 122.85, \n122.9, 122.95, 123, 123.05, 123.1, 123.15, 123.2, 123.25, 123.3, \n123.35, 123.4, 123.45, 123.5, 123.55, 123.6, 123.65, 123.7, 123.75, \n123.8, 123.85, 123.9, 123.95, 124, 124.05, 124.1, 124.15, 124.2, \n124.25, 124.3, 124.35, 124.4, 124.45, 124.5)\n</code></pre>\n\n<p>I would like to find a function which interpolates <code>g ~ gx</code>, but it should have some particular features:</p>\n\n<ul>\n<li>it should be expressed in functional form, e.g. if it's a polynomial it should return me poly degree and coefficents (if it was asymptotically Normal it would be great!).</li>\n<li>I would need to integrate the functional form, then I would appreciate if someone can tell me if R can solve non-numerical integrals.</li>\n</ul>\n\n<p>As an example of the second feature, consider</p>\n\n<pre><code>y &lt;- function(x) {\n x ^ 2\n}\n</code></pre>\n\n<p>Is there any way integrating <code>y</code> with R can return me <code>(x ^ 3) / 3</code> instead of a numerical value evaluated between integral extremes?</p>\n\n<p>Thanks,</p>\n"},{"tags":["r","postgresql","timestamp","subset"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":12913803,"title":"Creating subset from timestamp In SQL or R","body":"<p>I have a data-set which contains number of tables. I have to accomplish a process which needs a same dimension(size) for all the tables.</p>\n\n<p>I have to create sub-set in 2 scenario:</p>\n\n<p>1-Create sub-set based on timestamp (yyyy-mm-dd hour:min:sec)(timestamps column data type is varchar):</p>\n\n<p>1.1. I need a sub-set refers to a specific period of time:\nFrom 2004-08-12 To 2004-09-02</p>\n\n<p>1.2. Create sub-set from aformentioned sub-set based on time:\nFrom 8:00:00 To 20:00:00</p>\n\n<p>2-Create subset based on number of records:\nAsking for a first 10000 records of data.</p>\n\n<p>Moreover, I am using R software and simultaneously applying RPostgreSQL package. So I can use both Sql and R commands.  </p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1485,"score":1,"question_id":5411749,"title":"Plot multiple variables on y-axis using ggplot","body":"<p>I'm a beginner in R and I have a problem and need your help please.</p>\n\n<p>I have a text file containing data like this:</p>\n\n<pre><code>   A             C             G    class     phylum       order\n-0.000187   -0.219166   1.693306 Chordata   Monotremata   Mammalia  \n0.015664    -0.264506   1.482692 Chordata   Batidoidimorpha   Chondrichthyes    \n-0.404323   0.219374    2.230190 Platyhelminthes   Cyclophyllidea   Cestoda \n</code></pre>\n\n<p>but of course it has a lot of rows. I want to plot this data in such a way that all the classes are plotted on the x-axis, each one of them has the A, C and G value plotted as geom_point, and that these points are connected using a line with a specific color depending on A,C or G.\nI managed to do this by using the plot and par functions, but now I want to do it using the ggplot library.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["r","loops","for-loop"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":67,"score":3,"question_id":12909381,"title":"loop R multiple samples from single dataset","body":"<p>I am attempting to create a simple loop in R, where I have a large dataset and I want to create multiple smaller samples from this dataset and export them to excel:</p>\n\n<p>I thought it would work like this, but it doesn't:</p>\n\n<pre><code> idorg &lt;- c(1,2,3,4,5)\n x &lt;- c(14,20,21,16,17)\n y &lt;- c(31,21,20,50,13)\n dataset &lt;- cbind (idorg,x,y)\n\n\n for (i in 1:4)\n {\n attempt[i] &lt;- dataset[sample(1:nrow(dataset), 3, replace=FALSE),]\n write.table(attempt[i], \"C:/Users/me/Desktop/WWD/Excel/dataset[i].xls\", sep='\\t')\n }\n</code></pre>\n\n<p>In Stata you would need to preserve and restore your data when doing a loop like this, but is this also necessary in R?</p>\n"},{"tags":["r","gdal","netcdf","rgdal"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12910641,"title":"why gdal gave me different max and min values of a variable from R?","body":"<p>These three lines will open and read one variable from a netcdf file:</p>\n\n<pre><code>f=open.ncdf(\"C:\\\\BR_Ji1.nc\")\nA = get.var.ncdf(nc=f,varid=\"date\",verbose=TRUE)\nB = get.var.ncdf(nc=f,varid=\"GPP\",verbose=TRUE)\n[1] \"get.var.ncdf: entering. Here is varid:\"\n[1] \"GPP\"                 \n[1] \"checking to see if passed varid is actually a dimvar\"\n[1] \"entering vobjtodimname with varid= GPP\"\n[1] \"vobjtodimname: is a character type varid.  This file has 6 dims\"\n[1] \"vobjtodimname: no cases found, returning FALSE\"\n[1] \"get.var.ncdf: isdimvar: FALSE\"\n[1] \"vobjtovarid: entering with varid=GPP\"\n[1] \"Variable named GPP found in file with varid= 17\"\n[1] \"vobjtovarid: returning with varid deduced from name; varid= 17\"\n[1] \"get.var.ncdf: ending up using varid= 17\"\n[1] \"ndims: 2\"            \n[1] \"get.var.ncdf: varsize:\" \n[1]     1 17520          \n[1] \"get.var.ncdf: start:\" \n[1] 1 1                     \n[1] \"get.var.ncdf: count:\"\n[1]     1 17520            \n[1] \"get.var.ncdf: totvarsize: 17520\"\n[1] \"Getting var of type 3  (1=short, 2=int, 3=float, 4=double, 5=char, 6=byte)\"\n[1] \"get.var.ncdf: C call returned 0\"\n[1] \"count.nodegen: 17520    Length of data: 17520\"\n[1] \"get.var.ncdf: final dims of returned array:\"\n[1] 17520       \n[1] \"varid: 17\" \n[1] \"nc$varid2Rindex: 1\"  \"nc$varid2Rindex: 2\"  \"nc$varid2Rindex: 0\"  \"nc$varid2Rindex: 0\"  \"nc$varid2Rindex: 3\" \n[6] \"nc$varid2Rindex: 0\"  \"nc$varid2Rindex: 4\"  \"nc$varid2Rindex: 5\"  \"nc$varid2Rindex: 6\"  \"nc$varid2Rindex: 7\" \n[11] \"nc$varid2Rindex: 8\"  \"nc$varid2Rindex: 9\"  \"nc$varid2Rindex: 10\" \"nc$varid2Rindex: 11\" \"nc$varid2Rindex: 12\" \n[16] \"nc$varid2Rindex: 13\" \"nc$varid2Rindex: 14\" \"nc$varid2Rindex: 15\" \"nc$varid2Rindex: 16\" \"nc$varid2Rindex: 17\"\n[21] \"nc$varid2Rindex: 18\" \"nc$varid2Rindex: 19\" \"nc$varid2Rindex: 20\"\n[1] \"nc$varid2Rindex[varid]: 14\"\n[1] \"get.var.ncdf: setting missing values to NA\"\n[1] \"missval: -9999   tol: 0.09999\"\n[1] \"get.var.ncdf: implementing add_offset ( FALSE ) and scale_factor ( FALSE )\"\n[1] \"var has NEITHER add_offset nor scale_factor\"\n**K = get.var.ncdf(nc=f,varid=\"Qle\",verbose=TRUE)\nwrite.table(t(rbind(A,B,K)),\"C:\\\\Ji1-gpp-lat.txt\")**\n</code></pre>\n\n<p>When I looked at the extracted data I found that I have very small and negative values.\nThen I used gdalinfo and found that the max is 400 and min is 0 (which is normal and this is how the values should look like). Any ideas why I am getting the number wrongly?</p>\n"},{"tags":["r","graphics","formatting","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12910218,"title":"Set specific fill colors in ggplot2 by sign","body":"<p>Hi wanted to adjust the following chart so that the values below zero are filled in red and the ones above are in dark blue. How can I do this with ggplot2?</p>\n\n<pre><code>   mydata = structure(list(Mealtime = \"Breakfast\", Food = \"Rashers\", `2002` = 9.12, \n                            `2003` = 9.5, `2004` = 2.04, `2005` = -20.72, `2006` = 18.37, \n                            `2007` = 91.19, `2008` = 94.83, `2009` = 191.96, `2010` = -125.3, \n                            `2011` = -18.56, `2012` = 63.85), .Names = c(\"Mealtime\", \"Food\", \"2002\", \"2003\", \"2004\", \"2005\", \"2006\", \"2007\", \"2008\",\"2009\", \"2010\", \"2011\", \"2012\"), row.names = 1L, class = \"data.frame\")\nx=ggplot(mydata) +\n  aes(x=colnames(mydata)[3:13],y=as.numeric(mydata[1,3:13]),fill=sign(as.numeric(mydata[1,3:13]))) +\n  geom_bar(stat='identity') + guides(fill=F)\nprint(x)\n</code></pre>\n"},{"tags":["r","linear-regression"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":12908549,"title":"Linear regression for each cell in a table","body":"<p>I have four tables.  Each of them got 4 rows and 4 columns.  Followings are the four tables.</p>\n\n<p>For the 1st table,</p>\n\n<pre><code>t1 &lt;- array(1:20, dim=c(4,4))\n\n\n    [,1] [,2] [,3] [,4] \n[1,]    1    5    9   13 \n[2,]    2    6   10   14 \n[3,]    3    7   11   15 \n[4,]    4    8   12   16\n</code></pre>\n\n<p>For the 2nd table,</p>\n\n<pre><code>t2 &lt;- array(6:25, dim=c(4,4))\n\n     [,1] [,2] [,3] [,4]\n[1,]    6   10   14   18\n[2,]    7   11   15   19\n[3,]    8   12   16   20\n[4,]    9   13   17   21\n</code></pre>\n\n<p>For the 3rd table,</p>\n\n<pre><code>t3 &lt;- array(11:30, dim=c(4,4))\n\n     [,1] [,2] [,3] [,4]\n[1,]   11   15   19   23\n[2,]   12   16   20   24\n[3,]   13   17   21   25\n[4,]   14   18   22   26\n</code></pre>\n\n<p>For the 4th table,</p>\n\n<pre><code>t4 &lt;- array(21:30, dim=c(4,4))\n\n     [,1] [,2] [,3] [,4]\n[1,]   21   25   29   23\n[2,]   22   26   30   24\n[3,]   23   27   21   25\n[4,]   24   28   22   26\n</code></pre>\n\n<p>For each tables, I got a fixed set of y-value.  </p>\n\n<pre><code>t1 = 0.1 \nt2 = 3\nt4 = 0.5\nt6 = 7\n</code></pre>\n\n<p>In other words: </p>\n\n<pre><code>y &lt;- c( 0.1, 3, 0.75, 7)\n</code></pre>\n\n<p>Then, I want to extract x values from each of the cell in the four tables. That is for the [1,1] cell, the x-values extacted should be (0.1, 3, 0.5, 7).  We repeats this step one by one till the end of the table, i.e. the [4,4] cell.  Thus, I got a total of 16 sets of x-values as folows:</p>\n\n<pre><code>cell   x-values\n[1,1]  (1,6,11,21) \n[1,2]  (5,10,15,25) \n…..\n[4,4]  (16, 21,26,26)\n</code></pre>\n\n<p>Then I try to calculate the R2 for linear regression for each y-x pairs.  In other word, I want to got a total of 16 R2 values as follows:</p>\n\n<pre><code>For [1,1] cell, linear regression between (0.1, 3, 0.5, 7) and (1,6,11,21) = 0.6853\nFor [1,2] cell, linear regression between (0.1, 3, 0.5, 7) and (5,10,15,25) = 0.6853 \n…..\nFor [4,4] cell, linear regression between (0.1, 3, 0.5, 7) and (16, 21,26,26) = 0.2719 \n</code></pre>\n\n<p>Finally, I want to get a table with the following two columns</p>\n\n<pre><code>cell   R2 \n[1,1] 0.6853\n[1,2] 0.6853\n….\n[4,4] 0.2719\n</code></pre>\n\n<p>I learnt that to do linear regression for x and y series of data, I can use following command:</p>\n\n<pre><code>Rcoefficient &lt;- summary(lm(y ~ x, data=faithful))$r.squared\n</code></pre>\n\n<p>However, I have trouble readin each set of x-values from the four tables.  I tried to use reshape, but I still cannot get it right.  Could experts in Stackoverflow, help to suggest an efficient way to do it with R, as my real tables are very large with over 1000 columns and rows.</p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["linux","osx","r","cross-compiling"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":123,"score":3,"question_id":9760609,"title":"How do I cross compile R packages for MacOS from a Linux environment?","body":"<p>I'm running Linux and trying to compile an R package for use on a Mac. I could only find Linux->Windows and MacOS->Windows cross-compiling instructions. Does anybody know what I should do to compile a MacOS binary package for R?</p>\n\n<p>Or, I'll settle for I build server. Again, there's a Windows build-server for R packages, but does anybody know of a MacOS build-server?</p>\n"},{"tags":["r","data.table","plyr","sapply","tapply"],"answer_count":4,"favorite_count":124,"up_vote_count":106,"down_vote_count":0,"view_count":18042,"score":106,"question_id":3505701,"title":"R Grouping functions: sapply vs. lapply vs. apply. vs. tapply vs. by vs. aggregate vs.","body":"<p>Whenever I want to do something \"map\"py in <code>R</code>, I usually try to use a function in the <code>apply</code> family. (Side question: I still haven't learned <code>plyr</code> or <code>reshape</code> -- would <code>plyr</code> or <code>reshape</code> replace all of these entirely?)</p>\n\n<p>However, I've never quite understood the differences between them [how {<code>sapply</code>, <code>lapply</code>, etc.} apply the function to the input/grouped input, what the output will look like, or even what the input can be], so I often just go through them all until I get what I want.</p>\n\n<p>Can someone explain how to use which one when?</p>\n\n<p>[My current (probably incorrect/incomplete) understanding is...</p>\n\n<ol>\n<li><code>sapply(vec, f)</code>: input is a vector. output is a vector/matrix, where element <code>i</code> is <code>f(vec[i])</code> [giving you a matrix if <code>f</code> has a multi-element output]</li>\n<li><code>lapply(vec, f)</code>: same as <code>sapply</code>, but output is a list?</li>\n<li><code>apply(matrix, 1/2, f)</code>: input is a matrix. output is a vector, where element <code>i</code> is f(row/col i of the matrix)</li>\n<li><code>tapply(vector, grouping, f)</code>: output is a matrix/array, where an element in the matrix/array is the value of <code>f</code> at a grouping <code>g</code> of the vector, and <code>g</code> gets pushed to the row/col names</li>\n<li><code>by(dataframe, grouping, f)</code>: let <code>g</code> be a grouping. apply <code>f</code> to each column of the group/dataframe. pretty print the grouping and the value of <code>f</code> at each column.</li>\n<li><code>aggregate(matrix, grouping, f)</code>: similar to <code>by</code>, but instead of pretty printing the output, aggregate sticks everything into a dataframe.]</li>\n</ol>\n"},{"tags":["r","data.frame","reshape"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":78,"score":2,"question_id":12673874,"title":"reshape dataframe based on a string split in one column in R","body":"<p>I have the following data structure</p>\n\n<pre><code>ID  Type  Values\n1   A     5; 7; 8\n2   A     6\n3   B     2; 3\n</code></pre>\n\n<p>and I would like to reshape it to the following using R:</p>\n\n<pre><code>ID  Type  Values\n1   A     5\n1   A     7\n1   A     8\n2   A     6\n3   B     2\n3   B     3\n</code></pre>\n\n<p>I've been trying to work out how to do it with plyr but without any success.  What is the best way to do this?</p>\n"}]}
{"total":19203,"page":15,"pagesize":100,"questions":[{"tags":["r","aggregate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12857397,"title":"generating sums of data according to values of a variable","body":"<p>I have data similar to this:</p>\n\n<pre><code>Hosp    Score   Var1    Var2    Var3\n1       0       5       3       0\n1       1       10      8       1\n1       2       11      8       2\n1       3       5       3       2\n2       0       6       4       0\n2       2       10      6       1\n2       3       10      7       2\n3       1       4       3       2\netc...\n</code></pre>\n\n<p>there are approx 800 Hosps and 4 levels of the factor score (0,1,2,3). Some Hosps do not have an observation for a particular levels of score</p>\n\n<p>I would like to produce a new data frame where the variables Var1, Var2 and Var3 are summed. So using the data above this would give</p>\n\n<pre><code>Hosp    Var1    Var2    Var3\n1       32      22      5\n2       26      17      3\n3       4       3       2\n</code></pre>\n\n<p>This would be trivial in SQL (and I guess it is in R too!) but the only way I have found so far is with a loop, which adds a new row each time Hosp changes and increments the variables when it doesn't change (of course the data is sorted on Hosp). </p>\n\n<p>Is there a slick way to do this ?</p>\n"},{"tags":["r","data.frame","distinct-values"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12840294,"title":"Counting distinct values in a data frame in R","body":"<p>Let's say I have the following data frame in R:</p>\n\n<pre><code>&gt; myvec\n    name order_no\n1    Amy       12\n2   Jack       14\n3   Jack       16\n4   Dave       11\n5    Amy       12\n6   Jack       16\n7    Tom       19\n8  Larry       22\n9    Tom       19\n10  Dave       11\n11  Jack       17\n12   Tom       20\n13   Amy       23\n14  Jack       16\n</code></pre>\n\n<p>I want R to count distinct order_no values for each name. It should produce the following result:</p>\n\n<pre><code>name    number_of_distinct_orders\nAmy     2\nJack    3\nDave    1\nTom     2\nLarry   1\n</code></pre>\n\n<p>How can I do that?</p>\n"},{"tags":["r","lazy-evaluation","evaluation"],"answer_count":4,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":776,"score":5,"question_id":4682709,"title":"How to write an R function that evaluates an expression within a data-frame","body":"<p>Puzzle for the R cognoscenti: Say we have a data-frame:</p>\n\n<pre><code>df &lt;- data.frame( a = 1:5, b = 1:5 )\n</code></pre>\n\n<p>I know we can do things like</p>\n\n<pre><code>with(df, a)\n</code></pre>\n\n<p>to get a vector of results. </p>\n\n<p>But how do I write a function that takes an expression (such as <code>a</code> or <code>a &gt; 3</code>) and does the same thing inside. I.e. I want to write a function <code>fn</code> that takes a data-frame and an expression as arguments and returns the result of evaluating the expression \"within\" the data-frame as an environment. </p>\n\n<p>Never mind that this sounds contrived (I could just use <code>with</code> as above), but this is just a simplified version of a more complex function I am writing. I tried several variants ( using <code>eval</code>, <code>with</code>, <code>envir</code>, <code>substitute</code>, <code>local</code>, etc) but none of them work. For example if I define <code>fn</code> like so:</p>\n\n<pre><code>fn &lt;- function(dat, expr) {\n  eval(expr, envir = dat)\n}\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>&gt; fn( df, a )\nError in eval(expr, envir = dat) : object 'a' not found\n</code></pre>\n\n<p>Clearly I am missing something subtle about environments and evaluation. Is there a way to define such a function?</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12850386,"title":"Select nth element in data frame by factor","body":"<p>I've got a dataframe with a text column <code>name</code> and factor <code>city</code>. It is ordered alphabetically firstly by <code>city</code> and then <code>name</code>. Now I need to get a data frame which contains only nth element in each <code>city</code>, keeping this ordering. How can it be done in a pretty way without loops?</p>\n\n<p>I have:</p>\n\n<pre><code>name    city\nJohn    Atlanta\nJosh    Atlanta\nMatt    Atlanta\nBob     Boston\nKate    Boston\nLily    Boston\nMatt    Boston\n</code></pre>\n\n<p>I want a function, which returns n'th element by <code>city</code>, i.e., if it is 3rd, then:</p>\n\n<pre><code>name    city\nMatt    Atlanta\nLily    Boston\n</code></pre>\n\n<p>It should return <code>NULL</code> for <code>name</code> if it is out of range for the selected <code>city</code>, i.e., for 4th:</p>\n\n<pre><code>name    city\nNULL    Atlanta\nMatt    Boston\n</code></pre>\n\n<p>Using only base R please? </p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":77,"score":-1,"question_id":12907198,"title":"How to export R matrix object to .txt file","body":"<p>I have a R object say:</p>\n\n<pre><code>mat &lt;- matrix(1:100,nrow=20)\n</code></pre>\n\n<p>I want to send this matrix to .txt file so that the exported .txt file contains 20 rows and 5 columns. Is there easy way to do this?</p>\n\n<p>Thanks in advance,</p>\n"},{"tags":["r","nested","apply"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12673665,"title":"R - how to use apply (or some variant) to replace nested looping","body":"<p>I've been searching the forums for a while now, and I can't seem to figure out the answer to my problem (although I've come close a few times).  My apologies if this has already been answered elsewhere and I've missed it.</p>\n\n<p>I'm working with the Egyptian Skulls data from the HSAUR2 library.  I'll explain my problem via the code below.  I first load the skulls data and run statistical summaries on it (eg boxplots, means, std. devs, etc).  These summaries (not shown here) are broken down by variable (in columns 2-5 of the skulls data) and by \"epoch\" (column 1 of the skulls data).</p>\n\n<pre><code>library(HSAUR2)  # load the skulls data\nhead(skulls)\n#     epoch  mb  bh  bl nh\n# 1 c4000BC 131 138  89 49\n# 2 c4000BC 125 131  92 48\n# 3 c4000BC 131 132  99 50\n# 4 c4000BC 119 132  96 44\n# 5 c4000BC 136 143 100 54\n# 6 c4000BC 138 137  89 56\n</code></pre>\n\n<p>I then call powerTransform (part of the <code>car</code> package) to suggest appropriate transformations to convert the data so that the resulting distributions are \"more Normal\".  I have one transformation for each variable/epoch combination.</p>\n\n<pre><code>library(car)\ntfms_mb &lt;- by(skulls$mb,skulls$epoch, function(x) powerTransform(x))\ntfms_bh &lt;- by(skulls$bh,skulls$epoch, function(x) powerTransform(x))\ntfms_bl &lt;- by(skulls$bl,skulls$epoch, function(x) powerTransform(x))\ntfms_nh &lt;- by(skulls$nh,skulls$epoch, function(x) powerTransform(x))\n</code></pre>\n\n<p>To extract the coefficients, I use <code>sapply</code>.</p>\n\n<pre><code>mbc &lt;- sapply(tfms_mb,coef)\nbhc &lt;- sapply(tfms_bh,coef)\nblc &lt;- sapply(tfms_bl,coef)\nnhc &lt;- sapply(tfms_nh,coef)\n</code></pre>\n\n<p><strong>Question:</strong></p>\n\n<p>How do I apply the appropriate transformation to each variable/epoch pair?\nI am currently using the <code>bct()</code> function (from the <code>TeachingDemos</code> package) to apply the transformation and I can work out how to do it with one set value (eg raise all data to the power of 1.5):</p>\n\n<pre><code>library(TeachingDemos)\nby(skulls[,-1], skulls[,1], function(x) { bct(x,1.5)})\n</code></pre>\n\n<p>My question is, how do I replace the \"1.5\" in the above line, to cycle through the coefficients in mbc, bhc, etc. and apply the correct power to each variable/epoch combination?</p>\n\n<p>I've been reading up on the <code>apply</code> family of functions for a number of hours and also the the <code>plyr</code> package but this one has me stumped!  Any help would be appreciated.</p>\n"},{"tags":["r","aggregate"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12809590,"title":"Specific aggregation in a dataframe","body":"<p>I have a dataframe filled with course IDs, student IDs, week numbers (1 for the first week, 2 for the second, ...), and some information about what each user did in each course on each week. The final two columns of the df are non-NA if an instructor 'intervened' with the student in that course in that week, and NA otherwise. I want to compare each student's behavior before to after the week of their first intervention.</p>\n\n<p>So what I'd like to make is a column, 'HasIntervened', which is FALSE for weeks less than that of the student's first intervention and TRUE for weeks greater than or equal, but I'm having a hell of a time creating that simple column. I'm fairly certain that <code>aggregate</code> is going to be the way to go, but I'm just not thinking about the problem in the right way.</p>\n\n<p>Here is the <code>dput</code> of the first 60 rows (5 students' worth) of the dataframe:</p>\n\n<pre><code>structure(list(UserID = c(4188948L, 4188948L, 4188948L, 4188948L, \n4188948L, 4188948L, 4735684L, 4735684L, 4735684L, 4735684L, 4735684L, \n4735684L, 6292486L, 6292486L, 6292486L, 6292486L, 6292486L, 6292486L, \n6469671L, 6469671L, 6469671L, 6469671L, 6469671L, 6469671L, 6538263L, \n6538263L, 6538263L, 6538263L, 6538263L, 6538263L, 6621258L, 6621258L, \n6621258L, 6621258L, 6621258L, 6621258L, 6891869L, 6891869L, 6891869L, \n6891869L, 6891869L, 6891869L, 6891869L, 6891869L, 6891869L, 6891869L, \n6891869L, 6891869L, 6978155L, 6978155L, 6978155L, 6978155L, 6978155L, \n6978155L, 7195846L, 7195846L, 7195846L, 7195846L, 7195846L, 7195846L\n), CourseID = c(6567871L, 6567871L, 6567871L, 6567871L, 6567871L, \n6567871L, 6567168L, 6567168L, 6567168L, 6567168L, 6567168L, 6567168L, \n6567864L, 6567864L, 6567864L, 6567864L, 6567864L, 6567864L, 6567159L, \n6567159L, 6567159L, 6567159L, 6567159L, 6567159L, 6567162L, 6567162L, \n6567162L, 6567162L, 6567162L, 6567162L, 6567853L, 6567853L, 6567853L, \n6567853L, 6567853L, 6567853L, 6567159L, 6567159L, 6567159L, 6567159L, \n6567159L, 6567159L, 6567864L, 6567864L, 6567864L, 6567864L, 6567864L, \n6567864L, 6567873L, 6567873L, 6567873L, 6567873L, 6567873L, 6567873L, \n6567859L, 6567859L, 6567859L, 6567859L, 6567859L, 6567859L), \nWeekInCourse = c(1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, \n3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, 3, \n4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, \n5, 6, 1, 2, 3, 4, 5, 6), WeekPostCount = c(1L, 0L, 0L, 0L, \n0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 5L, 3L, 4L, 3L, 3L, 0L, 4L, \n0L, 0L, 0L, 0L, 0L, 3L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, \n0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 1L, 0L, 0L, 0L, 0L, 2L, \n2L, 0L, 0L, 4L, 0L, 3L, 0L, 3L, 0L, 0L, 0L), WeekLoginCount = c(2L, \n1L, 0L, 0L, 0L, 0L, 1L, 1L, 1L, 0L, 0L, 0L, 4L, 4L, 1L, 0L, \n0L, 0L, 3L, 3L, 1L, 0L, 0L, 0L, 2L, 1L, 0L, 0L, 0L, 0L, 1L, \n1L, 0L, 0L, 0L, 0L, 3L, 0L, 0L, 0L, 0L, 0L, 4L, 1L, 0L, 0L, \n0L, 0L, 3L, 3L, 1L, 0L, 0L, 0L, 1L, 1L, 0L, 0L, 0L, 0L), \nWeekPointsPercent = c(0, 0, 0, 0, 0, 0, 0, 0.185714285714286, \n0.375, 0.2, 0, 0, 0, 0.85, 0.7, 0.4, 0.7, 0.7, 0, 0.857142857142857, \n0.35, 0, 0, 0.712765957446808, 0, 1, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.25, 0, 0, 0, 0, 0, 0.5, 0.5, \n0, 0, 0.7, 1, 1, 0.375, 0.723076923076923, 0, 0.738636363636364\n), CumulativePointsPercent = c(0, 0, 0, 0, 0, 0, 0, 0.185714285714286, \n0.254545454545455, 0.235294117647059, 0.235294117647059, \n0.10958904109589, 0, 0.85, 0.8, 0.533333333333333, 0.55, \n0.563636363636364, 0, 0.857142857142857, 0.623076923076923, \n0.476470588235294, 0.476470588235294, 0.600558659217877, \n0, 1, 0.0666666666666667, 0.0666666666666667, 0.0461538461538462, \n0.0461538461538462, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0.25, 0.166666666666667, 0.0555555555555556, 0.05, 0.0454545454545455, \n0, 0.5, 0.5, 0.166666666666667, 0.15, 0.2, 1, 1, 0.615384615384615, \n0.669230769230769, 0.621428571428571, 0.666666666666667), \nRiskEstimate = c(0.627717786405816, 0.986868933315635, 0.986687587608184, \n0.993909863003438, 0.997123961252086, 0.995862152216296, \n0.914011371723269, 0.925359536086114, 0.902625588346349, \n0.956922151061089, 0.977244888475535, 0.975006380719003, \n0.215420992232115, 0.174623555825523, 0.241380495376484, \n0.699712463799006, 0.692014530298594, 0.697966901130338, \n0.765071150059092, 0.763071307309743, 0.767261726128078, \n0.835918063362269, 0.854949153314029, 0.805318343915736, \n0.792873572656207, 0.790581615380765, 0.82622599277251, 0.9330287497742, \n0.965763061363497, 0.951226314109191, 0.851355921713566, \n0.991081300877175, 0.989671569185701, 0.995402298000919, \n0.997671718747865, 0.996593366142757, 0.738690043138604, \n0.865412845144037, 0.831369850200541, 0.93845410260835, 0.968400480533385, \n0.9533338828382, 0.624930735381371, 0.981915016747928, 0.985037736895337, \n0.994680902796769, 0.996907588471311, 0.995388109404559, \n0.887995464972052, 0.970620002831325, 0.97136665697772, 0.992618626388727, \n0.99543249839328, 0.992149889176406, 0.923802324633255, 0.984464950934932, \n0.978726967214146, 0.971473084822075, 0.97886220009245, 0.979311013989987\n), RiskBin = c(3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, \n3L, 1L, 1L, 1L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, \n3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, \n3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, \n3L, 3L, 3L, 3L), InterventionID = c(NA, 26L, NA, NA, NA, \nNA, NA, NA, NA, NA, 50L, NA, NA, NA, NA, NA, 73L, NA, NA, \nNA, NA, NA, 56L, NA, NA, NA, NA, 46L, NA, NA, NA, 33L, NA, \nNA, NA, NA, 15L, NA, NA, 43L, 53L, NA, NA, NA, NA, NA, 71L, \nNA, NA, NA, NA, NA, 78L, NA, NA, 36L, NA, NA, 80L, NA), InterventionType = structure(c(NA, \n2L, NA, NA, NA, NA, NA, NA, NA, NA, 3L, NA, NA, NA, NA, NA, \n2L, NA, NA, NA, NA, NA, 3L, NA, NA, NA, NA, 3L, NA, NA, NA, \n2L, NA, NA, NA, NA, 3L, NA, NA, 3L, 2L, NA, NA, NA, NA, NA, \n2L, NA, NA, NA, NA, NA, 2L, NA, NA, 3L, NA, NA, 3L, NA), .Label = c(\"\", \n\"At-Risk Form\", \"Email\", \"Other\", \"Phone\"), class = \"factor\")), .Names = c(\"UserID\", \n\"CourseID\", \"WeekInCourse\", \"WeekPostCount\", \"WeekLoginCount\", \n\"WeekPointsPercent\", \"CumulativePointsPercent\", \"RiskEstimate\", \n\"RiskBin\", \"InterventionID\", \"InterventionType\"), row.names = c(NA, \n60L), class = \"data.frame\")\n</code></pre>\n"},{"tags":["r","matrix-inverse"],"answer_count":3,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":2950,"score":7,"question_id":11995832,"title":"Inverse of matrix in R","body":"<p>I was wondering what is your recommended way to compute the inverse of a matrix?</p>\n\n<p>The ways I found seem not satisfactory. For example, </p>\n\n<pre><code>&gt; c=rbind(c(1, -1/4), c(-1/4, 1))  \n&gt; c  \n      [,1]  [,2]  \n[1,]  1.00 -0.25  \n[2,] -0.25  1.00  \n&gt; inv(c)  \nError: could not find function \"inv\"  \n&gt; solve(c)    \n          [,1]      [,2]  \n[1,] 1.0666667 0.2666667  \n[2,] 0.2666667 1.0666667  \n&gt; solve(c)*c  \n            [,1]        [,2]  \n[1,]  1.06666667 -0.06666667  \n[2,] -0.06666667  1.06666667  \n&gt; qr.solve(c)*c  \n            [,1]        [,2]  \n[1,]  1.06666667 -0.06666667  \n[2,] -0.06666667  1.06666667  \n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":144,"score":3,"question_id":10990302,"title":"Is there any package that contains NFL football data?","body":"<p>I have come across the R <code>baseball</code> package containing basically the entire historical scope of professional baseball data that can be used for fantasy analysis. Does anyone know if something similar exists for NFL football data?</p>\n\n<p>I know of some previous answers that mention sites such as www.pro-football-reference.com that give data on every player, but I am looking for something in an aggregate, data frame format.</p>\n"},{"tags":["r","ggplot2"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":12905907,"title":"unwanted axis w/ facet_wrap with scales = \"free_x\"","body":"<p>Maybe this is a duplicate not sure (<a href=\"http://stackoverflow.com/questions/12560858/using-coord-flip-with-facet-wrapscales-free-y-in-ggplot2-seems-to-give-u\">LINK</a>).</p>\n\n<p>I want to use <code>coord_flip</code>, <code>facet_wrap</code> and the argument <code>scales = \"free\"</code>.  If one does so this adds unwanted scales in between the facets that are unnecessary.  </p>\n\n<pre><code>library(ggplot2)\n\nggplot(mtcars, aes(x=as.factor(gear),  y=carb, fill=vs)) +\n    geom_bar(position=\"dodge\", stat=\"identity\") +\n    coord_flip() + \n    facet_wrap(~ carb, ncol=2)  \n</code></pre>\n\n<p>Produces:</p>\n\n<p><img src=\"http://i.stack.imgur.com/lkkRz.png\" alt=\"enter image description here\"></p>\n\n<p>but adding the <code>scales = \"free\"</code> makes the axise/scales appear in the middle of facets rather than at the bottom as above.  How can I make them go away.</p>\n\n<pre><code>ggplot(mtcars, aes(x=as.factor(gear),  y=carb, fill=vs)) +\n    geom_bar(position=\"dodge\", stat=\"identity\") +\n    coord_flip() + \n    facet_wrap(~ carb, ncol=2, scales=\"free_x\")  \n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/Izhsg.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","output"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":57,"score":3,"question_id":12906836,"title":"copying output from one R session to another R session","body":"<p>I am having 2 R sessions now working on one vector in each of the session with slight difference inside, say:</p>\n\n<p>session1: <code>temp1 &lt;- c(1:10)</code></p>\n\n<p>session2: <code>temp2 &lt;- c(2:11)</code></p>\n\n<p>I want to copy the <code>temp1</code> from session1 into session2 and do a <code>%in%</code>, but I don't want use <code>print(temp1)</code> in session1, <code>ctrl-c</code> it, manually modify the output and then <code>ctrl-v</code> it in session2.</p>\n\n<p>I have seen someone using a generic function that create an output in the R session, then I <code>ctrl-c</code> the output directly and <code>ctrl-v</code> it in another R session and the object is already there. But I can't remember the function.</p>\n\n<p>Thanks.</p>\n"},{"tags":["eclipse","r","cdt","rcpp","statet"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":95,"score":3,"question_id":12886517,"title":"How to set up Eclipse + StatET + Rcpp on Windows","body":"<p>When I came to know that I can create a R package with C++ using Rcpp, I was excited about it and eager to know development environment for it. And thanks to <a href=\"http://blog.fellstat.com/?p=170\" rel=\"nofollow\">Fell Stat Blog</a>, I could quickly establish a great environment using Eclipse with StatET, its plugin for R, to use Rcpp and RInside (another package for embedding R into your C++ application) on Windows.</p>\n\n<p>Since the blog was, however, based on OS X, several things required trial &amp; error (&amp; almost give-up) to adjust for Windows - it took me 6 hours of my leisure time. For example, you need to install Rtools to be able to compile C/C++ using R CMD statements and Miktex to convert your Rd files to pdf file. In addition, build settings are different from OS X.</p>\n\n<p>In order to save others from possible trial &amp; error period I've experienced, I made this wiki on Eclipse + StatET + Rcpp on Windows. Feel free to make comment or another answer. Otherwise, enjoy this great open source environment for analytical software development you can get.</p>\n"},{"tags":["r","function","matrix"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":67,"score":-6,"question_id":12906451,"title":"How to remove linearly independent matrices?","body":"<p>Is there an R function that allows me to remove or extract linearly independent matrices?</p>\n\n<p>thank you</p>\n"},{"tags":["eclipse","r","statet"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":12867494,"title":"R help is not updated in Eclipse after R CMD install","body":"<p>I am developing a R package in Eclipse. Although I am new to this environment, it's been great.</p>\n\n<p>But one problem I am facing is that after running R CMD install after check and build in Eclipse, if I type in R console of Eclipse,</p>\n\n<pre><code>library(mypackagename)\n?mypackagename\n</code></pre>\n\n<p>Eclipse still displays old help. I've already tried restarting, rebooting, and so on in vain.  If I run R in windows, it displays correct help for the package. I wonder what is going on. </p>\n\n<p>I suspect Eclipse has its own cache for R help but can't find how to delete it.</p>\n\n<p><strong>Update</strong> As seen in @JimM's answer, you should select following to update R help.</p>\n\n<p><code>\"R console View menu\" -&gt; R environment -&gt; Index completely</code></p>\n\n<p>This will take 2-3 mins but I found there is no other way to update R help.</p>\n"},{"tags":["r","plot","neural-network","weight"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":12905920,"title":"Skip plotting excluded weights with the R neuralnet package","body":"<p>I'm using he neuralnet package in R.  I've successfully created a network that has a lot of weights excluded (i.e. the network is not fully connected).  </p>\n\n<p>My problem is an aesthetic one.  When I plot the network (using the included nn.plot() )  arrows are drawn for the excluded connections with a label of \"NA\".  This clutters up the chart and doesn't represent the architecture well.  </p>\n\n<p>I tried hacking nn.plot() to skip over weights equal to NA, but I'm new to R and can't seem to make this happen.</p>\n"},{"tags":["r","graphics"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":73,"score":3,"question_id":12899376,"title":"Plot Elements from List of Lists in Multiple Colors","body":"<p>I am trying to plot the elements from a list of lists, specifically coloring each point according the class to which it belongs, using the outer list index as a x value and the value of each element of the inner list as a y value.  An example list, with 2 sublists:</p>\n\n<pre><code>sample.list &lt;- list(list(\"A\"=0,\"B\"=0.14285, \"C\"=0.75), list(\"A\"=0.138,\"B\"=0,\"C\"=0.1))\n[[1]]\n[[1]]$A\n[1] 0\n\n[[1]]$B\n[1] 0.14285\n\n[[1]]$C\n[1] 0.75\n\n[[2]]\n[[2]]$A\n[1] 0.138\n\n[[2]]$B\n[1] 0\n\n[[2]]$C\n[1] 0.1\n</code></pre>\n\n<p>My desired output would plot the first sublist at the points</p>\n\n<p><code>(1, 0), (1, 0.14285), (1, 0.5)</code> </p>\n\n<p>(i.e. the sublist elements form a vertical line along <code>x=1</code>) and the second sublist would be similarly plotted.  Additionally, each sublist element would have a different color - <code>A</code> could be red, <code>B</code> green etc. Just to clarify, I am trying to do this all on one graph.  Moreover, the number of list elements could change from depending on the dataset.  Any pointers as to how to tackle this issue are very appreciated!</p>\n"},{"tags":["r","vector","for-loop","append"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":92,"score":0,"question_id":12904709,"title":"How to append elements to a vector without changing its size?","body":"<p>I want to add elements to a vector without changing its length. The vector should only contain 500 rows (1 column) after every for-loop. Here's what I have so far.</p>\n\n<pre><code># initialize the vector\nvalues&lt;- vector(mode = \"integer\", length= 500)\n\nfor (i in 1:500) {\nvalues&lt;-append(values, 2i, after = i-1)\n}\n</code></pre>\n\n<p>So the <code>values</code> vector should contain the following elements: <code>2,4,6,8,10, ... 998, 1000</code></p>\n\n<p>The problem with the append function is that if I add an element to the vector, it changes the length of the vector by 1. So at the end of the for-loop, the <code>value</code> vector would be length 1000 instead of 500, and contain the elements: <code>2,4,6,8, ... , 998, 1000, 0,0,0 [followed by zeros]</code>.</p>\n\n<p>Is there another R function that will what I expect it to do, or is there a way I can fix my code above?</p>\n\n<p>Thanks any help or suggestions are greatly appreciated.</p>\n"},{"tags":["r","ggplot2","rstudio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12904850,"title":"Query using geom_bar() of ggplot2 - R","body":"<p>I have a similar data frame as follows:</p>\n\n<pre><code>mapDF &lt;- structure(list(var = c(11L, 3L, 4L, 15L, 19L, 17L, 1L), approvals = c(10.5233545765422, \n67.9809421770218, 9.66394835013545, 2.93736399165075, 3.36787205222721, \n4.0168261757783, 1.50969267664431)), .Names = c(\"var\", \"approvals\"\n), row.names = c(NA, -7L), class = \"data.frame\")\n</code></pre>\n\n<p>When I try creating a bar graph using the data frame above using:</p>\n\n<pre><code>gplot &lt;- ggplot(mapDF, aes(x= mapDF[1], y= mapDF[2])) + geom_bar()\n</code></pre>\n\n<p>.. I get the following messages with <strong>nothing</strong> showing up in the 'Plots' section of RStudio:</p>\n\n<pre><code>Don't know how to automatically pick scale for object of type data.frame. Defaulting to continuous\nDon't know how to automatically pick scale for object of type data.frame. Defaulting to continuous\nError: stat_bin requires the following missing aesthetics: x\n</code></pre>\n\n<p>Can anyone please point out my error?</p>\n"},{"tags":["r","png"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":125,"score":4,"question_id":12888120,"title":"Loading PNG files directly from URL","body":"<p>I am using the <code>png</code> package to load PNGs as raster images, and then plotting them. The PNGs are coming from an online source, namely, Wikipedia. I can get the following to work:</p>\n\n<pre><code>library(png)\n\npngURL &lt;- \"http://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Flag_of_Afghanistan.svg/150px-Flag_of_Afghanistan.svg.png\"\n\n# Works:\ndownload.file(pngURL, \"temp.png\", mode = \"wb\")\nlocalPNG &lt;- readPNG(\"temp.png\")\nplot(1)\nrasterImage(localPNG, 0.8, 0.8, 1.2, 1.2)\n</code></pre>\n\n<p>However, rather than use <code>download.file()</code> to store the PNG locally, then re-loading it, it would be preferable to load the PNG directly from the URL. However, this does not work:</p>\n\n<pre><code># Does not work:\ninternetPNG &lt;- readPNG(pngURL)\n</code></pre>\n\n<p>As it results in</p>\n\n<pre><code>Error in readPNG(pngURL) : \n  unable to open http://upload.wikimedia.org/wiki...\n</code></pre>\n\n<p>Does anyone have suggestions for how to get this to work, or are there particular reasons that R won't load this PNG from a URL?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["r","knitr"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":12903133,"title":"Looping knitr options","body":"<p>I'm curious, is there a way to incorporate changes in knitr options in a loop?  For example, if I wanted to loop through and see how the same block of code looked in all different knitr themes, my first guess would be:</p>\n\n<p>\\documentclass{article}</p>\n\n<pre><code>\\begin{document}\n\n&lt;&lt;test&gt;&gt;=\nthemes&lt;-knit_theme$get()\n\n\nfor (a.theme in themes){\n\n  knit_theme$set(a.theme)\n\n  a &lt;- 3+5\n   b&lt;- sum(1:10, na.rm=T)\n  for(g in 1:10) z&lt;-0\n}\n@\n\n\\end{document}\n</code></pre>\n\n<p>And yet, this produces some pretty odd output.  Is there a way to use loops like this, to dynamically change output, or perhaps dynamically include or not include certain chunks?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":12902550,"title":"how to read file having special characters using read.csv in R","body":"<p>I have file located at two places.</p>\n\n<pre><code> a = \"C:/Documents and Settings/tandona/Desktop/javaSummary2.txt\"  \n b= \"M:\\CHR\\Statistics\\Projects\\NIEHS-NTP_Task1\\Work\\Genomics\\Dmitry_Gordenin\\Final-R-Scripts\\hg19.chrom.size\n</code></pre>\n\n<p>I can read the file at M drive but not the one at C drive, because there is space in \"Documents and Settings\". I get following error:</p>\n\n<pre><code>&gt;read.csv(as.character(a),sep = \"\\t\", header = TRUE, comment.char = \"\",check.names = FALSE, quote=\"\")\nError in file(file, \"rt\") : cannot open the connection\nIn addition: Warning message:\nIn file(file, \"rt\") :\n  cannot open file 'C:/Documents and Settings/tandona/Desktop/javaSummary2.txt': No such file or directory\n</code></pre>\n\n<p>How can I read the file having special characters?</p>\n\n<p>My bad, it was two part of the code. Front end is in java and it had the bug. R is working fine now.</p>\n"},{"tags":["r","sqlite","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":12904294,"title":"Flowstrates and R: extracting and reshaping data in required format","body":"<p>I'm working on trying to transform a large dataset into the required formats for analyzing within the <a href=\"http://code.google.com/p/jflowmap/wiki/Flowstrates\" rel=\"nofollow\">flowstrates</a> package. </p>\n\n<p>What I currently have is a large file (600k trips) with origin and destination points.</p>\n\n<p>Format is sort of like this:</p>\n\n<pre><code>tripID   Month start_pt   end_pt\n1        June   1           3\n2        June   1           3\n3        July   1           5\n4        July   1           7\n5        July   1           7\n</code></pre>\n\n<p>What I need to be able to generate is a file that has trip counts by unit time (let's say months) in a format like this:</p>\n\n<pre><code>start_pt   end_pt  June July August ... December\n1          3       2    0    5          9\n1          5       0    1    4          4\n1          7       0    2    0          0\n</code></pre>\n\n<p>It's easy enough to pre-segment the data by month and then generate counts for each origin-destination pair, but then putting it all back together causes all sorts of problems since each of the pre-segmented chunks of data have very different sizes. So it seems that I'd need to do this for the entire dataset at once. </p>\n\n<p>Are there any packages for doing this type of processing? Would it be easier to do this in something like SQL or SQLite?</p>\n\n<p>Thanks in advance for any help.</p>\n"},{"tags":["r","axis","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":144,"score":4,"question_id":12901396,"title":"Controlling axis ticks and axis lines separately on R lattice xyplot","body":"<p>How can I go about removing the box around an <code>xyplot</code>, while keeping the axis scale tick marks? In the spirit of Edward Tufte's minimalist data graphic aesthetic, these axis lines are \"non-data ink,\" and can (should?) be \"erased.\"</p>\n\n<pre><code>library(lattice)\nmy.df &lt;- data.frame(x=-10:10)\nmy.df$y &lt;- my.df$x^2\nxyplot(y~x,data=my.df)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/VLbIa.jpg\" alt=\"standard xyplot output\"></p>\n\n<p>It seems that the trellis display parameters (e.g. <code>axis.line$col</code>) control both the axis lines and axis ticks together:</p>\n\n<pre><code>xyplot(y~x,data=my.df,\n       par.settings=list(axis.line=list(col=\"transparent\")))\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/ZGzf5.jpg\" alt=\"with axis.line$col=&quot;transparent&quot;\"></p>\n\n<p>...which is not the desired result, so it doesn't look like there's a simple way to turn off the lines while leaving the box.</p>\n\n<p>The best I've been able to come up with is a brute-force hack, where I build the tick marks by hand using <code>panel.segments</code>:</p>\n\n<pre><code>at.x=pretty(c(-10,10))\nat.y=pretty(c(0,100))\nxyplot(y~x,data=my.df,\n       par.settings=list(axis.line=list(col=\"transparent\")),\n       scales=list(x=list(at=at.x,labels=at.x),\n       y=list(at=at.y,labels=at.y)),\n       panel=function(...){\n           panel.xyplot(...)\n           panel.segments(x0=at.x,x1=at.x,y0=-4,y1=-2)\n           panel.segments(x0=-11.5,x1=-11,y0=at.y,y1=at.y)\n       }\n       )\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/XRIBE.jpg\" alt=\"hand-made tick marks with panel.segments\"></p>\n\n<p>This is close to the desired result, but there's quite a bit of fiddling required to get the tick marks to be a reasonable length and offset a \"nice\" distance from the data points. These values won't translate from one graphic to the next. Plus, note that the axis labels are now padded too far from the tick marks. I'm sure there's a way to reduce that padding, but that would only make the code even uglier and less portable.</p>\n\n<p>So how can one go about suppressing just the lines that make up the \"box\" around the plot area, while leaving the tick marks and axis labels intact? Bonus points if this approach could also be used to suppress some, but not all of the lines (e.g. leave the left and lower lines, but suppress the top and right lines).</p>\n"},{"tags":["r","sequence"],"answer_count":1,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":77,"score":7,"question_id":12904177,"title":"Count how many times the element is repeated in a sequence (in R)","body":"<p>I have a sequence of events, coded as A,B, and C. For each element I need to count how many times this element was repeated before. For example:</p>\n\n<pre><code>x&lt;-c('A','A','A','B','C','C','A','B','A','C')\ny&lt;-c(0,1,2,0,0,1,0,0,0,0)\ncbind(x,y)\n\n     x   y  \n[1,] \"A\" \"0\"\n[2,] \"A\" \"1\"\n[3,] \"A\" \"2\"\n[4,] \"B\" \"0\"\n[5,] \"C\" \"0\"\n[6,] \"C\" \"1\"\n[7,] \"A\" \"0\"\n[8,] \"B\" \"0\"\n[9,] \"A\" \"0\"\n[10,] \"C\" \"0\"\n</code></pre>\n\n<p>I need to generate column y from x.</p>\n"},{"tags":["r","emacs","elisp","ess"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12903270,"title":"Emacs ESS Mode TAB stops indenting","body":"<p>I'm using Emacs 24 on Windows to write some R code. Up until about 30 minutes ago, whenever I would write a new function, ESS would automatically indent the lines following the function declaration and pressing the tab key on a new blank line would jump me to the appropriately indented starting position inside the declaration. </p>\n\n<p>EG:</p>\n\n<pre><code>foo &lt;- function() {\n    first line started here\n    second line here.  .etc\n}\n</code></pre>\n\n<p>Now, it is hard wrapping everything to the left, and not responding by automatically indenting after the function declaration or when I hit the tab key. </p>\n\n<pre><code>foo &lt;- function() {\nfirst line\nsecond line\n}\n</code></pre>\n\n<p>I've googled, but my google-fu is failing me on this. Anyone know how to restore default tab behavior to ESS in Emacs? </p>\n"},{"tags":["r","data-manipulation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12900860,"title":"Writing a \"find and replace for certain empty cells\" function in R","body":"<p>I have a dataframe that looks roughly like this:</p>\n\n<pre><code>March_created_at    March_email March_type  April_created_at April_email    April_type\n3/11/12 7:28    jeremy@asynk.ch PushEvent   4/1/12 4:03                     PushEvent\n3/11/12 7:28    jeremy@asynk.ch PushEvent   4/1/12 4:03                     PushEvent\n3/11/12 7:28    jeremy@asynk.ch PushEvent   4/1/12 4:03                     PushEvent\n3/11/12 7:28    jeremy@asynk.ch PushEvent   4/1/12 7:03     high            IssuesEvent\n3/11/12 11:06   medium          PushEvent   4/1/12 13:57    medium          PushEvent\n3/11/12 11:06   medium          PushEvent   4/1/12 13:57    medium          PushEvent\n3/11/12 11:06   medium          PushEvent   4/1/12 13:57    medium          PushEvent\n3/11/12 12:46                   PushEvent   \n3/11/12 12:46                   PushEvent   \n3/11/12 12:46                   PushEvent   \n</code></pre>\n\n<p>The full dataset can be found <a href=\"https://github.com/aronlindberg/VOSS-Sequencing-Toolkit/blob/master/rubinius_rubinius_sequencing/output.csv\" rel=\"nofollow\">here</a> as a CSV file</p>\n\n<p>Now, I'm using a function (thanks to Hadley Wickham) to replace certain email addresses with strings (such as \"high\" and \"medium\"). </p>\n\n<pre><code># the find-and-replace function\nreplace_all &lt;- function(df, pattern, replacement) {\n  char &lt;- vapply(df, function(x) is.factor(x) || is.character(x), logical(1))\n  df[char] &lt;- lapply(df[char], str_replace_all, pattern, replacement)  \n  df\n}\n\n# the function call\ndf.new &lt;- replace_all(df, fixed(\"bford@engineyard.com\"), \"core\")\n</code></pre>\n\n<p>However, there are some cells where there is nothing (e.g. rows 8-10 in column \"March_email\") written. I want to find all of these cells and replace them with the string \"low\" <em>if</em> the following condition holds:</p>\n\n<p>*There is a date attached to the same month (e.g. rows 8-10 has dates in the \"March_created_at column, so the empty cells in \"March_email\" indicate missing data that needs to be replaced)</p>\n\n<p>This means that if there is no date attached to that row where there is a blank cell in the email column (e.g. columns 8-10 for April), nothing should be replaced there. It is simply no data for that range.</p>\n\n<p>How can I accomplish this in R?</p>\n\n<p><strong>Appendix:</strong> Here is a dput() of the head of the dataset:</p>\n\n<pre><code>structure(list(March_created_at = c(\"2012-03-11 07:28:04\", \"2012-03-11 07:28:04\", \n\"2012-03-11 07:28:04\", \"2012-03-11 07:28:19\", \"2012-03-11 07:28:19\", \n\"2012-03-11 07:28:19\"), March_actor_attributes_email = c(\"jeremy@asynk.ch\", \n\"jeremy@asynk.ch\", \"jeremy@asynk.ch\", \"jeremy@asynk.ch\", \"jeremy@asynk.ch\", \n\"jeremy@asynk.ch\"), March_type = c(\"PushEvent\", \"PushEvent\", \n\"PushEvent\", \"PushEvent\", \"PushEvent\", \"PushEvent\"), April_created_at = c(\"2012-04-01     04:03:13\", \n\"2012-04-01 04:03:13\", \"2012-04-01 04:03:13\", \"2012-04-01 07:03:11\", \n\"2012-04-01 07:03:11\", \"2012-04-01 07:03:11\"), April_actor_attributes_email = c(\"\", \n\"\", \"\", \"high\", \"high\", \"high\"), April_type = c(\"PushEvent\", \n\"PushEvent\", \"PushEvent\", \"IssuesEvent\", \"IssuesEvent\", \"IssuesEvent\"\n), May_created_at = c(\"2012-05-01 00:16:05\", \"2012-05-01 00:16:05\", \n\"2012-05-01 00:16:05\", \"2012-05-01 01:03:19\", \"2012-05-01 01:03:19\", \n\"2012-05-01 01:03:19\"), May_actor_attributes_email = c(\"john.firebaugh@gmail.com\", \n\"john.firebaugh@gmail.com\", \"john.firebaugh@gmail.com\", \"mitch.tishmack@gmail.com\", \n\"mitch.tishmack@gmail.com\", \"mitch.tishmack@gmail.com\"), May_type = c(\"PushEvent\", \n\"PushEvent\", \"PushEvent\", \"IssueCommentEvent\", \"IssueCommentEvent\", \n\"IssueCommentEvent\"), June_created_at = c(\"2012-06-01 00:25:05\", \n\"2012-06-01 00:25:05\", \"2012-06-01 00:25:05\", \"2012-06-01 00:42:29\", \n\"2012-06-01 00:42:29\", \"2012-06-01 00:42:29\"), June_actor_attributes_email =     c(\"michaelklishin@me.com\", \n\"michaelklishin@me.com\", \"michaelklishin@me.com\", \"\", \"\", \"\"), \n    June_type = c(\"IssueCommentEvent\", \"IssueCommentEvent\", \"IssueCommentEvent\", \n    \"PushEvent\", \"PushEvent\", \"PushEvent\"), July_created_at = c(\"2012-07-01 13:46:20\", \n    \"2012-07-01 13:46:20\", \"2012-07-02 11:53:37\", \"2012-07-02 11:53:37\", \n    \"2012-07-02 12:27:30\", \"2012-07-02 12:27:30\"), July_actor_attributes_email = c(\"medium\", \n    \"medium\", \"ryoqun@gmail.com\", \"ryoqun@gmail.com\", \"ryoqun@gmail.com\", \n    \"ryoqun@gmail.com\"), July_type = c(\"PushEvent\", \"PushEvent\", \n    \"CreateEvent\", \"CreateEvent\", \"PushEvent\", \"PushEvent\"), \n    August_created_at = c(\"2012-08-01 00:04:09\", \"2012-08-01 00:04:09\", \n    \"2012-08-01 00:04:42\", \"2012-08-01 00:04:42\", \"2012-08-01 00:05:04\", \n    \"2012-08-01 00:05:04\"), August_actor_attributes_email = c(\"jeremy@asynk.ch\", \n    \"jeremy@asynk.ch\", \"jeremy@asynk.ch\", \"jeremy@asynk.ch\", \n    \"jeremy@asynk.ch\", \"jeremy@asynk.ch\"), August_type = c(\"IssueCommentEvent\", \n    \"IssueCommentEvent\", \"IssuesEvent\", \"IssuesEvent\", \"IssueCommentEvent\", \n    \"IssueCommentEvent\"), September_created_at = c(\"2012-09-01 18:12:24\", \n    \"2012-09-01 18:12:24\", \"2012-09-01 23:51:18\", \"2012-09-01 23:51:18\", \n    \"2012-09-02 00:34:54\", \"2012-09-02 00:34:54\"), September_actor_attributes_email = c(\"ryoqun@gmail.com\", \n    \"ryoqun@gmail.com\", \"ryoqun@gmail.com\", \"ryoqun@gmail.com\", \n    \"ryoqun@gmail.com\", \"ryoqun@gmail.com\"), September_type = c(\"CommitCommentEvent\", \n    \"CommitCommentEvent\", \"CreateEvent\", \"CreateEvent\", \"PushEvent\", \n    \"PushEvent\"), October_created_at = c(\"2012-10-01 07:48:38\", \n    \"2012-10-01 10:01:40\", \"2012-10-01 10:01:43\", \"2012-10-01 10:17:00\", \n    \"2012-10-01 16:08:29\", \"2012-10-01 18:06:46\"), October_actor_attributes_email = c(\"medium\", \n    \"medium\", \"medium\", \"medium\", \"\", \"core\"), October_type = c(\"PushEvent\", \n    \"IssuesEvent\", \"PushEvent\", \"PushEvent\", \"ForkEvent\", \"PullRequestEvent\"\n    )), .Names = c(\"March_created_at\", \"March_actor_attributes_email\", \n\"March_type\", \"April_created_at\", \"April_actor_attributes_email\", \n\"April_type\", \"May_created_at\", \"May_actor_attributes_email\", \n\"May_type\", \"June_created_at\", \"June_actor_attributes_email\", \n\"June_type\", \"July_created_at\", \"July_actor_attributes_email\", \n\"July_type\", \"August_created_at\", \"August_actor_attributes_email\", \n\"August_type\", \"September_created_at\", \"September_actor_attributes_email\", \n\"September_type\", \"October_created_at\", \"October_actor_attributes_email\", \n\"October_type\"), row.names = c(NA, 6L), class = \"data.frame\") \n</code></pre>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12902260,"title":"R for loop gives only one result","body":"<p>I have defined two Groups (<code>Group1</code> and <code>Group2</code>). Group is a vector with the column names that the user can define in the beginning of the script. Now I want to refer to these column names to calculate the ratio (e.g. <code>log2(b1/a1)</code>, <code>log2(b2/a2)</code>, ...), but my function does only calculate the first ration e.g <code>(log2(b1/a1)</code>.</p>\n\n<p>Do I have to use the <code>aggregate</code> function? The best solution would be that I get the three ratios as a data.frame to <code>cbind</code> them to <code>data_raw</code>.</p>\n\n<pre><code>Group1 &lt;- c(\"a1\", \"a2\",\"a3\")\nGroup2 &lt;- c(\"b1\",\"b2\",\"b3\")\nratio &lt;- function(x) {\n  for(i in 1:x) {\n    print(out &lt;- log2(data_raw[,Group2[i]])-log2(data_raw[,Group1[i]]))\n    return(out)\n  }\n}\nc &lt;- ratio(length(Group1))\n</code></pre>\n\n<p>For row SD calculation, which works fine if I calculate the ratios manually:</p>\n\n<pre><code>c &lt;- cbind(log2(data_raw[,Group2[1]]/data_raw[,Group1[1]]),\n           log2(data_raw[,Group2[2]]/data_raw[,Group1[2]]),\n           log2(data_raw[,Group2[3]]/data_raw[,Group1[3]]))\nc2 &lt;- as.data.frame(c)\nc2 &lt;- transform(c2, SD=rowSds(c2))\ndata_raw &lt;- cbind(data_raw, c2)\n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":65,"score":3,"question_id":12901489,"title":"How to increase number of bins for continuous color fill for ggplot2 map","body":"<p>I am relatively new at creating maps in R using ggplot2, but I have been struggling for a few days with this issue. I have created my plot, but can't seem to increase the number of bins used to map colors to my values. </p>\n\n<p>This is an issue, as the map doesn't do a good job showing the variation in the data. I'm not sure if I'm approaching this problem correctly.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>region=c('alaska','alabama','arkansas','arizona','california','colorado','connecticut','florida','georgia','hawaii','iowa','idaho','illinois','indiana','kansas','kentucky','louisiana','massachusetts','maryland','maine','michigan','minnesota','missouri','mississippi','montana','north carolina','north dakota','nebraska','new hampshire','new jersey','new mexico','nevada','new york','ohio','oregon','pennsylvania','south carolina','south dakota','tennessee','texas','utah','virginia','vermont','washington','wisconsin','west virginia','oklahoma','wyoming')\n\nsales=c(46,1240,471,2292,13427,1574,261,10036,826,1508,184,939,2356,1329,434,271,714,208,2027,21,950,500,1871,147,249,1204,69,175,369,1968,606,656,2369,2422,525,2902,1709,126,1563,12046,931,2271,46,2260,250,122,0,0)\n\nstate_data = as.data.frame(cbind(region,sales))\n\nlibrary(ggplot2)\nlibrary(maps)\nall_states &lt;- map_data(\"state\")\n\nD = merge(all_states, state_data, by = \"region\")\nD = D[with(D,order(D$group,D$order)),] \n\np = ggplot()\np = p + geom_polygon( data=D, aes(x=long, y=lat, group = group, fill=D$sales),colour=\"white\" )\np = p + xlab(\"\")\np = p + ylab(\"\")\np = p + labs(title = \"sales\")\np = p + guides(color=FALSE) \np = p + guides(size=FALSE) \np = p + guides(fill=guide_legend() )\np = p + guides(fill= guide_colorbar(title=\"sales\",barheight = 1,barwidth=15,direction=\"horizontal\",nbin=8) )\np = p + theme(legend.position=\"bottom\")\np\n</code></pre>\n\n<p>Ideally, I'd like to increase the number of  bins on the legend to about 8-10, and possibly add another color to the gradient to show additional detail. I've experimented with ggplot2 functions, but am not having much luck.</p>\n"},{"tags":["r","cjk","knitr","lyx"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12821720,"title":"CJK in knitr with LyX (Windows 7)","body":"<p>I'm trying to write a LyX document in English with some Chinese interspersed, and I also want knitr for the figures and analyses. My installation likes knitr, and it likes Chinese (using the \"Alternative\" approach here: <a href=\"http://wiki.lyx.org/LyX/Chinese#toc5\" rel=\"nofollow\">http://wiki.lyx.org/LyX/Chinese#toc5</a>), but I can't get documents with CJK in them to knit. </p>\n\n<p>My test document has this text (the Tex in a TeX code box):</p>\n\n<pre><code>Hello    \n\\cntxt{你好吗}\n</code></pre>\n\n<p>My user-defined preamble is (from the LyX wiki):</p>\n\n<pre><code>\\usepackage{CJKutf8}\n\\usepackage[overlap, CJK]{ruby}\n\\newenvironment{SChinese}{%\n\\CJKfamily{gbsn}%\n\\CJKtilde\n\\CJKnospace}{}\n\\newcommand{\\cntxt}[1]{\\begin{CJK}{UTF8}{}\\begin{SChinese}#1\\end{SChinese}\\end{CJK}}\n</code></pre>\n\n<p>Doc settings: my language is English, Encoding is utf8 (the other options for these don't seem to change anything). Turned off language marking in LyX as mentioned on Xie Yihui's site.</p>\n\n<p>When knitr is loaded and I do View [PDF (pdflatex)], it hiccups when it sends it to R:</p>\n\n<pre><code>10:13:40.589: Warning in readLines(input, warn = FALSE) :\n10:13:40.597:   invalid input found on input connection 'test-chinese-2.Rnw'\n</code></pre>\n\n<p>And latex doesn't like what it gets back:</p>\n\n<pre><code>! File ended while scanning use of \\cntxt.\n</code></pre>\n\n<p>Taking out the Chinese characters removes the error. Leaving the Chinese and unloading knitr also removes the error.  Any suggestions for how to keep the CJK, keep knitr loaded, and still get a document out?</p>\n\n<p>Lyx is native Windows 2.0.4, R is 2.15.1, knitr is 0.8.  The <a href=\"https://github.com/yihui/knitr-examples/blob/master/034-chinese.Rhtml\" rel=\"nofollow\">034-chinese.Rhtml</a> example in <a href=\"https://github.com/yihui/knitr-examples/\" rel=\"nofollow\">knitr-examples</a> works perfectly.</p>\n\n<p>Here is the messages window output:</p>\n\n<pre><code>13:45:45.419: Previewing ...\n13:45:45.581: Rscript --verbose --no-save --no-restore \"C:/Program Files (x86)/LyX20/Resources/scripts/lyxknitr.R\" \"C:/Users/Patrick/AppData/Local/Temp/lyx_tmpdir.Hp8472/lyx_tmpbuf2/\"\"test-chinese-2.Rnw\" \"C:/Users/Patrick/AppData/Local/Temp/lyx_tmpdir.Hp8472/lyx_tmpbuf2/\"\"test-chinese-2.tex\" UTF-8 \"C:/Users/Patrick/Downloads/\"\nRunning: Rscript --verbose --no-save --no-restore \"C:/Program Files (x86)/LyX20/Resources/scripts/lyxknitr.R\" \"C:/Users/Patrick/AppData/Local/Temp/lyx_tmpdir.Hp8472/lyx_tmpbuf2/\"\"test-chinese-2.Rnw\" \"C:/Users/Patrick/AppData/Local/Temp/lyx_tmpdir.Hp8472/lyx_tmpbuf2/\"\"test-chinese-2.tex\" UTF-8 \"C:/Users/Patrick/Downloads/\"\n13:45:47.202: [1] TRUE\n13:45:47.203: [1] TRUE\n13:45:47.230: running\n13:45:47.237:   'C:\\PROGRA~1\\R\\R-215~1.1\\bin\\i386\\Rterm.exe --slave --no-restore --no-save --no-restore --file=C:/Program Files (x86)/LyX20/Resources/scripts/lyxknitr.R --args C:/Users/Patrick/AppData/Local/Temp/l\n13:45:47.247: yx_tmpdir.Hp8472/lyx_tmpbuf2/test-chinese-2.Rnw C:/Users/Patrick/AppData/Local/Temp/lyx_tmpdir.Hp8472/lyx_tmpbuf2/test-chinese-2.tex UTF-8'\n13:45:47.252: \n13:45:47.258: Warning in readLines(input, warn = FALSE) :\n13:45:47.266:   invalid input found on input connection 'test-chinese-2.Rnw'\n13:45:47.802: \n  |                                                                       \n  |                                                                 |   0%\n  |                                             \n13:45:47.813:                           \n  |&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;| 100%\n13:45:47.820:   ordinary text without R code\n13:45:47.826: \n13:45:47.828: \n13:45:47.832: [1] \"test-chinese-2.tex\"\n13:45:47.836: [1] TRUE\n13:45:47.837: [1] TRUE\n13:45:47.843: \n13:45:47.844: \n13:45:47.848: processing file: test-chinese-2.Rnw\n13:45:47.854: output file: C:\\Users\\Patrick\\Downloads\\test-chinese-2.tex\n13:45:47.860: \n13:45:47.875: pdflatex  \"test-chinese-2.tex\"\nRunning: pdflatex  \"test-chinese-2.tex\" &gt; nul\n13:45:48.186: This is pdfTeX, Version 3.1415926-2.3-1.40.12 (MiKTeX 2.9)\n13:45:48.215: entering extended mode\n13:45:48.219: \n13:45:48.224: (C:\\Users\\Patrick\\AppData\\Local\\Temp\\lyx_tmpdir.Hp8472\\lyx_tmpbuf2\\test-chinese\n13:45:48.229: -2.tex\n13:45:48.233: LaTeX2e &lt;2011/06/27&gt;\n13:45:48.239: Babel &lt;v3.8m&gt; and hyphenation patterns for english, afrikaans, ancientgreek, ar\n13:45:48.247: abic, armenian, assamese, basque, bengali, bokmal, bulgarian, catalan, coptic, \n13:45:48.255: croatian, czech, danish, dutch, esperanto, estonian, farsi, finnish, french, ga\n13:45:48.263: lician, german, german-x-2009-06-19, greek, gujarati, hindi, hungarian, iceland\n13:45:48.269: ic, indonesian, interlingua, irish, italian, kannada, kurmanji, lao, latin, lat\n13:45:48.275: vian, lithuanian, malayalam, marathi, mongolian, mongolianlmc, monogreek, ngerm\n13:45:48.280: an, ngerman-x-2009-06-19, nynorsk, oriya, panjabi, pinyin, polish, portuguese, \n13:45:48.285: romanian, russian, sanskrit, serbian, slovak, slovenian, spanish, swedish, swis\n13:45:48.291: sgerman, tamil, telugu, turkish, turkmen, ukenglish, ukrainian, uppersorbian, u\n13:45:48.296: senglishmax, welsh, loaded.\n13:45:48.300: \n13:45:48.638: Error while previewing format: pdf2C:\\Users\\Vincent\\Documents\\LyX\\source\\lyx20x\\src\\support\\Systemcall.cpp(273): Systemcall: 'pdflatex  \"test-chinese-2.tex\"' finished with exit code 1\n</code></pre>\n"},{"tags":["r","syntax","console"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":12900051,"title":"Variables omitted when trying to display data frame in console","body":"<p>I have a data frame with 72 columns and 409 rows which is called: spect</p>\n\n<p>The problem: <code>print(spect)</code> does not display the whole data frame. When i scroll to the top of the console i see the following:</p>\n\n<pre><code>96       NA       NA       2      NA      NA       NA            \n97       NA       NA       2      NA      NA       NA               \n98       NA       NA       1       0      NA       NA \n</code></pre>\n\n<p>The problem with the output displayed above is that i dont see the variables, and the rows start at nr. 96. </p>\n\n<p>However when I ask R to display a subset, say print(spect[,1:3]) i get the expected result:</p>\n\n<blockquote>\n<pre><code>print(spect[,1:3])\n    idnr gender      age\n1      1 kvinde 22.07671\n2      2 kvinde 32.46575\n3      3 kvinde 19.72055\n4      4   mand 19.95617\n</code></pre>\n</blockquote>\n\n<p>Also, when i write <code>fix(spect)</code> the editor opens with expected correct result.\nAlso, when i do calculations on the data it seems to work properly. \nI dont have this problem with smaller dataframes with approximately 30 variables. \nI dont get an error message.</p>\n\n<p>max.print is</p>\n\n<blockquote>\n  <p>getOption(\"max.print\")\n  [1] 99999</p>\n</blockquote>\n\n<p>But the console has no-where near that maximum, in fact it shows only about 2000 rows. I get the same error after restarting my computer and R, and removing all objects and press \"control + l\" to clear the console.</p>\n\n<p>So is this just a bug in R or am i missing something?</p>\n"},{"tags":["r","plot","ggplot2"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":148,"score":0,"question_id":12897176,"title":"How to display longitude and latitude lines on a map using R?","body":"<p>I am trying to view this binary file(unsigned character, pixel =720 and lines=360) as a map   ,I tried the piece of code given bellow. First, I downloaded <a href=\"https://echange-fichiers.inra.fr/get?auto=1&amp;k=r9TjqDUEeWhs8VQKvxy\" rel=\"nofollow\">this file</a> from <a href=\"https://echange-fichiers.inra.fr/get?k=r9TjqDUEeWhs8VQKvxy\" rel=\"nofollow\">this location</a> and saved it as <code>landcover.bin</code>. </p>\n\n<pre><code>conne &lt;- file(\"C:\\\\landcover.bin\", \"rb\")\nsd&lt;- readBin(conne, integer(), size=1,  n=360*720, signed=F)\ny&lt;-matrix((data=sd), ncol=360, nrow=720)\nimage(y)\n</code></pre>\n\n<p>I got a map that looks weird, and then I swap ncol and nrow as</p>\n\n<pre><code>y&lt;-matrix((data=sd), ncol=720, nrow=360)\nimage(y)\n</code></pre>\n\n<p>I got a reasonable map but upside down</p>\n\n<p>My question can anyone tell me how can I display my file as (which is not supposed to be the same)and how to display the longitudes and latitudes as are shown on this map:</p>\n\n<p><img src=\"http://i.stack.imgur.com/cWfuI.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","statistics"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":92,"score":-3,"question_id":12899794,"title":"Outlier detection packages in R","body":"<p>I am searching for R package which provide the possibility to detect outlier(s) in some sample of observations?</p>\n\n<p>Thanks alot.</p>\n\n<p>Shahzad</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12897954,"title":"Condensing Multiple Columns That Are in a Yes/No Format to One Descriptive Column","body":"<p>This problem has plagued me for quite some time.  I always just work around it with a for loop, but I think it's finally time for me to find a quicker and more elegant way of doing this.</p>\n\n<p>As an example, let's say I have a data frame containing information on whether an item is red or blue.  The information is presented in this way:</p>\n\n<pre><code>item.df &lt;- data.frame(Item=seq(1,5), Red=c(\"Y\", \"Y\", \"N\", \"N\", \"N\"), Blue=c(\"N\", \"N\", \"Y\", \"Y\", \"N\"))\n</code></pre>\n\n<p>Clearly, this is not the most condensed way to represent this information.  Instead of having two separate Red and Blue columns, I simply want one item color column that would contain \"Red\", \"Blue\", or \"Neither\" (Or NA would also be acceptable).</p>\n\n<p>Obviously, I can achieve this by creating an empty Item.Color column and then filling it in by looping through each individual row.  But I'm sure there is a quicker way to do this.</p>\n\n<p>Back when I was a true R novice, I tried to do it by:</p>\n\n<pre><code>item.df$Item.Color &lt;- if(item.df$Red==\"Y\"){\"Red\"}\n</code></pre>\n\n<p>but I quickly learned this doesn't work, because the if statement will only read the first element in item.df$Red.</p>\n\n<p>Could there be a way to achieve this using do.call() or one of the apply() functions?  I've attempted, but I could never get it to do quite what I wanted.  Thanks in advance for any insight you might be able to provide!</p>\n\n<p>p.s. I would also be grateful to hear any suggestions for a better title for this question.  For me, that always seems to be the hardest part in asking questions.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12895292,"title":"Adding line to .First() during package installation","body":"<p>I'm developing R packages for my company of not so tech savy employees.</p>\n\n<p>To facilitate the life of the users I'm thinking of having a set of scripts at a global location that can get sourced at startup in order to update and load relevant packages.</p>\n\n<p>My idea is to have a script for each custom package that only gets sourced if that particalar package is installed. For this to work I need to modify the .First() function when the user installs the different packages, such that after packages A is installed:</p>\n\n<pre><code>.First() &lt;- function(){\n    source('script_to_package_A')\n}\n</code></pre>\n\n<p>and if package B is then installed:</p>\n\n<pre><code>.First() &lt;- function(){\n    source('script_to_package_A')\n    source('script_to_package_B')\n}\n</code></pre>\n\n<p>Thus i am interested to add a line inside the .Rprofile file if .First() is already defined and the line is not in there already or, if no .Rprofile exists, create it.</p>\n\n<p>What would be the best way to achieve this?</p>\n\n<p>best wishes\nThomas</p>\n\n<p>EDIT: Just to clarify - what I am looking for is a safe way to modify the .First() function that gets called during startup. That means that if a user already has defined a .First() function the additions will just be appended instead of replacing the old .First(). Preferably this addition to first will happen when a specific package is installed but this is not necessary. I'm fairly confident in what to add to the .First() function so this is not in question.</p>\n"},{"tags":["r","cluster-analysis","correlation","hierarchical-clustering","hclust"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":61,"score":5,"question_id":12897925,"title":"Error with multiscale hierarchical clustering in R","body":"<p>I'm doing hierarchical clustering with an R package called <code>pvclust</code>, which builds on <code>hclust</code> by incorporating bootstrapping to calculate significance levels for the clusters obtained.</p>\n\n<p>Consider the following data set with 3 dimensions and 10 observations:</p>\n\n<pre><code>mat &lt;- as.matrix(data.frame(\"A\"=c(9000,2,238),\"B\"=c(10000,6,224),\"C\"=c(1001,3,259),\n                        \"D\"=c(9580,94,51),\"E\"=c(9328,5,248),\"F\"=c(10000,100,50),\n                        \"G\"=c(1020,2,240),\"H\"=c(1012,3,260),\"I\"=c(1012,3,260),\n                        \"J\"=c(984,98,49)))\n</code></pre>\n\n<p>When I use <code>hclust</code> alone, the clustering runs fine for both Euclidean measures and correlation measures:</p>\n\n<pre><code># euclidean-based distance\ndist1 &lt;- dist(t(mat),method=\"euclidean\")\nmat.cl1 &lt;- hclust(dist1,method=\"average\")\n\n# correlation-based distance\ndist2 &lt;- as.dist(1 - cor(mat))\nmat.cl2 &lt;- hclust(dist2, method=\"average\")\n</code></pre>\n\n<p>However, when using the each set up with <code>pvclust</code>, as follows:</p>\n\n<pre><code>library(pvclust)\n\n# euclidean-based distance\nmat.pcl1 &lt;- pvclust(mat, method.hclust=\"average\", method.dist=\"euclidean\", nboot=1000)\n\n# correlation-based distance\nmat.pcl2 &lt;- pvclust(mat, method.hclust=\"average\", method.dist=\"correlation\", nboot=1000)\n</code></pre>\n\n<p>... I get the following errors:</p>\n\n<ul>\n<li>Euclidean: <code>Error in hclust(distance, method = method.hclust) : \nmust have n &gt;= 2 objects to cluster</code></li>\n<li>Correlation: <code>Error in cor(x, method = \"pearson\", use = use.cor) : \nsupply both 'x' and 'y' or a matrix-like 'x'</code>.</li>\n</ul>\n\n<p>Note that the distance is calculated by <code>pvclust</code> so there is no need for a distance calculation beforehand. Also note that the <code>hclust</code> method (average, median, etc.) does not affect the problem.</p>\n\n<p>When I increase the dimensionality of the data set to 4, <code>pvclust</code> now runs fine. Why is it that I'm getting these errors for <code>pvclust</code> at 3 dimensions and below but not for <code>hclust</code>? Furthermore, why do the errors disappear when I use a data set above 4 dimensions?</p>\n"},{"tags":["r","path","repository","cran"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12896935,"title":"Expand path to actual subdirectory containing packages for local repositories","body":"<p>Is there a function that expands the path to the actual subdirectory containing package binaries (or whatever the equivalent under Linux and Mac OS is called) given the URL-like path to a local repository's root directory in an <strong>OS-independent</strong> manner?</p>\n\n<h2>Due Dilligence</h2>\n\n<p><strong>Related Links</strong></p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/2905650/creating-a-local-cran-repository\">SO post</a></li>\n<li><a href=\"http://cran.r-project.org/doc/manuals/R-admin.html#Setting-up-a-package-repository\" rel=\"nofollow\">R Manual</a></li>\n</ul>\n\n<p>Suppose you have a repository under <code>L:/my_repo</code>:</p>\n\n<pre><code>path.repo &lt;- \"L:/my_repo\"\n</code></pre>\n\n<p>MS Windows requires a certain subdirectory structure:</p>\n\n<pre><code>path.sub  &lt;- file.path(\"bin/windows/contrib\", paste(version$major, \n    gsub(\"(?&lt;=\\\\d)\\\\.\\\\d\", \"\", version$minor, perl=TRUE), sep=\".\")\n)\n</code></pre>\n\n<p>Actually create the repository:</p>\n\n<pre><code>dir.create(file.path(path.repo, path.sub), recursive=TRUE, showWarnings=FALSE)\n</code></pre>\n\n<p>Once a package binary exists in the repository, the repository's index needs to be created:</p>\n\n<pre><code>setwd(file.path(path.repo, path.sub))\ntools::write_PACKAGES(\".\", type=\"win.binary\")\n</code></pre>\n\n<p>After that, the repository is good to go and you could install its packages via </p>\n\n<p>install.packages(\"mypackage\", repos=file.path(\"file://\", path.repo))</p>\n\n<p>So far, so good. I'd like to create a function that automatically copies a package binary to my local repository once the package binary has been built. In order to do so, I guess I need to retrieve the path to the actual directory containing the binaries and the two index files (<code>PACKAGES' and</code>PACKAGES.gz`). And that should happen in an <strong>OS-independent</strong> way in order to make it as generic as possible.</p>\n\n<p>Of course I could search for the index files via </p>\n\n<pre><code>unique(dirname(grep(\"PACKAGE*\", list.files(path.repo, recursive=TRUE, \n    full.names=TRUE), value=TRUE)))\n</code></pre>\n\n<p>But I wonder if there's a better way.</p>\n"},{"tags":["r","data.table"],"answer_count":4,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":131,"score":8,"question_id":12786335,"title":"Why is as.Date slow on a character vector?","body":"<p>I started using data.table package in R to boost performance of my code. I am using the following code:</p>\n\n<pre><code>sp500 &lt;- read.csv('../rawdata/GMTSP.csv')\ndays &lt;- c(\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\",\"Sunday\")\n\n# Using data.table to get the things much much faster\nsp500 &lt;- data.table(sp500, key=\"Date\")\nsp500 &lt;- sp500[,Date:=as.Date(Date, \"%m/%d/%Y\")]\nsp500 &lt;- sp500[,Weekday:=factor(weekdays(sp500[,Date]), levels=days, ordered=T)]\nsp500 &lt;- sp500[,Year:=(as.POSIXlt(Date)$year+1900)]\nsp500 &lt;- sp500[,Month:=(as.POSIXlt(Date)$mon+1)]\n</code></pre>\n\n<p>I noticed that the conversion done by as.Date function is very slow, when compared to other functions that create weekdays, etc. Why is that? Is there a better/faster solution, how to convert into date-format? (If you would ask whether I really need the date format, probably yes, because then use ggplot2 to make plots, which work like a charm with this type of data.)</p>\n\n<p>To be more precise</p>\n\n<pre><code>&gt; system.time(sp500 &lt;- sp500[,Date:=as.Date(Date, \"%m/%d/%Y\")])\n   user  system elapsed \n 92.603   0.289  93.014 \n&gt; system.time(sp500 &lt;- sp500[,Weekday:=factor(weekdays(sp500[,Date]), levels=days, ordered=T)])\n   user  system elapsed \n  1.938   0.062   2.001 \n&gt; system.time(sp500 &lt;- sp500[,Year:=(as.POSIXlt(Date)$year+1900)])\n   user  system elapsed \n  0.304   0.001   0.305 \n</code></pre>\n\n<p>On MacAir i5 with slightly less then 3000000 observations.</p>\n\n<p>Thanks</p>\n"},{"tags":["r","plyr"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":12898789,"title":"How to ddply a nested list","body":"<p>I have a nested list and need to calculate the correlation of frt and srt</p>\n\n<pre><code>   $`bs. bs`\n    fapp  frt sapp  srt\n1   bs 2280   bs 0.25\n2   bs 2287   bs 0.25\n3   bs 2288   bs 0.25\n4   bs 2289   bs 0.25\n\n$`bs. lhc`\n    fapp  frt sapp      srt\n5   bs 2320  lhc 0.250000\n6   bs 2333  lhc 0.250214\n7   bs 2524  lhc 0.316449\n</code></pre>\n\n<p>source:</p>\n\n<pre><code>    structure(list(`bs. bs` = structure(list(fapp = structure(c(1L,\n    1L, 1L, 1L), .Label = \"bs\", class = \"factor\"), frt = c(2280L,\n    2287L, 2288L, 2289L), sapp = structure(c(1L, 1L, 1L, 1L), .Label = c(\" bs\",\n    \" lhc\"), class = \"factor\"), srt = c(0.25, 0.25, 0.25, 0.25)), .Names = c(\"fapp\",\n    \"frt\", \"sapp\", \"srt\"), row.names = c(NA, 4L), class = \"data.frame\"),\n   `bs. lhc` = structure(list(fapp = structure(c(1L, 1L, 1L), .Label = \"bs\", class=         \"factor\"),\n    frt = c(2320L, 2333L, 2524L), sapp = structure(c(2L,\n    2L, 2L), .Label = c(\" bs\", \" lhc\"), class = \"factor\"),\n    srt = c(0.25, 0.250214, 0.316449)), .Names = c(\"fapp\",\n\"frt\", \"sapp\", \"srt\"), row.names = 5:7, class = \"data.frame\")), .Names = c(\"bs. bs\",\n   \"bs. lhc\"))\n</code></pre>\n\n<p>something like</p>\n\n<pre><code>    ddply(y,.(fapp + sapp),cor)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>    ddply(y,.(fapp,sapp),cor)\n</code></pre>\n\n<p>doesn't work</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12899086,"title":"Changing plot label sizes in R, cex is not working","body":"<p>I am making a very simple plot in R and would like the change the font size on the y-axis (the years).  I have used all the cex. commands, and can change everything except these years.</p>\n\n<p>Here is my matrix (inputm):  </p>\n\n<pre><code>     2010  2011\nCC 0.5550 0.480\nP  3.6700 3.865\nPF 1.4625 1.685\n</code></pre>\n\n<p>And my code:</p>\n\n<pre><code>barplot(inputm,beside=T, horiz=TRUE, xlim=c(-7,7), \ncol=c(\"black\",\"blue\",\"red\"), xlab=\"Mg C/ha\", cex.axis=2)\n</code></pre>\n\n<p>I can get the x-axis labels to change, but not the y.  What am I missing here?</p>\n"},{"tags":["r","binary","typeconverter","valueconverter","bitconverter"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":118,"score":6,"question_id":12892348,"title":"In R, how to convert binary string to binary or decimal value","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6614283/converting-decimal-to-binary-in-r\">Converting decimal to binary in R?</a>  </p>\n</blockquote>\n\n\n\n<p>In R language, is there any function to convert binary string into binary or decimal value?</p>\n\n<p>If I have a binary string <code>000101</code>, what should I do to convert it into <code>5</code>?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12897590,"title":"How to use a string to refer to a data frame in R?","body":"<p>I have 3 data frames called 'first', 'second' and 'third'</p>\n\n<p>I also have a string vector with their names in it </p>\n\n<pre><code> frames &lt;- c(\"first\",\"second\",\"third\")\n</code></pre>\n\n<p>I would like to loop through the vector and refer to the data frames</p>\n\n<pre><code>for (i in frames) {\n\n  #set first value be 0 in each data frame\n  i[1,1] &lt;- 0\n}\n</code></pre>\n\n<p>This does not work, what am I missing?</p>\n"},{"tags":["r","date","character","posix"],"answer_count":1,"favorite_count":4,"up_vote_count":2,"down_vote_count":0,"view_count":92,"score":2,"question_id":12898318,"title":"convert character to date *quickly* in R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12786335/why-is-as-date-slow-on-a-character-vector\">Why is as.Date slow on a character vector?</a>  </p>\n</blockquote>\n\n\n\n<p>I have a large <code>data.frame</code> (roughly 60 mil observations) that I read from a database using <code>RMySQL</code>. The dates are brought in as characters (there doesn't seem to be a way to change this) and so I use <code>as.Date</code> to convert things to date.  However, this takes an extremely long time witih so many observations.  Is there anything one can do to make this faster?</p>\n"},{"tags":["r","loops","append","coin-flipping"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":134,"score":-2,"question_id":12892985,"title":"Append rle result from loop","body":"<p>I am running a coin-toss simulation with a loop which runs about 1 million times.</p>\n\n<p>Each time I run the loop I wish to retain the table output from the RLE command. Unfortunately a simple append does not seem to be appropriate. Each time I run the loop I get a slightly different amount of data which seems to be one of the sticking points.</p>\n\n<p>This code gives an idea of what I am doing:</p>\n\n<pre><code>N &lt;- 5 #Number of times to run\nrlex &lt;-NULL\n#begin loop#############################\nfor (i in 1:N) { #tells R to repeat N number\nx &lt;-sample(0:1, 100000, 1/2)\nrlex &lt;-append(rlex, rle(x))\n}\ntable(rlex) #doesn't work\ntable(rle(x)) #only 1\n</code></pre>\n\n<p>So instead of having five separate rle results (in this simulation, 1 million in the full version), I want one merged rle table. Hope this is clear. Obviously my actual code is a bit more complex, hence any solution should be as close to what I have specified as possible.</p>\n\n<p>UPDATE: The loop is an absolute requirement. No ifs or buts. Perhaps I can pull out the table(rle(x)) data and put it into a matrix. However again the stumbling block is the fact that some of the less frequent run lengths do not always turn up in each loop. Thus I guess I am looking to conditionally fill a matrix based on the run length number?</p>\n\n<p>Last update before I give up: Retaining the rle$values will mean that too much data is being retained. My simulation is large-scale and I really only wish to retain the table output of the rle. Either I retain each table(rle(x)) for each loop and combine by hand (there will be thousands), or I find a programmatic way to keep the data (yes for zeroes and ones) and have one table that is formed from merging each of the individual loops as I go along. </p>\n\n<p>Either this is easyish to do, as specified, or I will not be doing it. It may seem a silly idea/request, but that should be incidental to whether it can be done. </p>\n\n<p><strong>Seriously last time</strong>. Here is an animated gif showing what I expect to happen. <img src=\"http://i.stack.imgur.com/GRMDx.gif\" alt=\"enter image description here\"></p>\n\n<p>After each iteration of the loop data is added to the table. This is as clear as I am going to be able to communicate it.</p>\n"},{"tags":["r","matlab","linear-regression","least-squares"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":37,"score":2,"question_id":12895805,"title":"Perpendicular offsets in a weighted least squares regression","body":"<p>Perpendicular offset least square fitting has a lot of advantages compared to the native least square fitting scheme. The following figure illustrates the difference between there, and for a more detailed comparison of these two methods, we refer to <a href=\"http://i.stack.imgur.com/uBLOf.png\" rel=\"nofollow\">here</a>. </p>\n\n<p><img src=\"http://i.stack.imgur.com/Aue8i.gif\" alt=\"enter image description here\"></p>\n\n<p>Perpendicular offset least square fitting, however, is not robust to outliers( points that are not supposed to be used for model estimation). Therefore, I am now considering to use a weighted perpendicular offset least square regression method. The method has two steps:</p>\n\n<ol>\n<li>Calculate the weighting factor for each points that are going to be used for line estimation;</li>\n<li>Perform perpendicular offset in a weighted least square regression scheme. </li>\n</ol>\n\n<p>For the time being, my biggest problem comes from step 2. Suppose the weighting factors are given, how can I get the formula to estimate the parameters of the line? Many thanks!</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Based on the kind suggestion of @MvG I have implemented the algorithm in MATLAB:</p>\n\n<pre><code>function  line =  estimate_line_ver_weighted(pt_x, pt_y,w);\n% pt_x  x coordinate\n% pt_y  y coordinate\n% w     weighting factor\n\n\npt_x = pt_x(:);\npt_y = pt_y(:);\nw    = w(:);\nw    = w/sum(w(:));\n\n% step 1: calculate n\nn = sum(w(:));\n\n% step 2: calculate weighted coordinates \ny_square = pt_y(:).*pt_y(:);\nx_square = pt_x(:).*pt_x(:);\nx_square_weighted = x_square.*w; % I am not sure here, and I also tried  \n                                 % x_square_weighted = x_square.*w.*w;\ny_square_weighted = y_square.*w; % I am not sure here, and I also tried\n                                 %   y_square_weighted = y_square.*w.*w;\nx_weighted        = pt_x.*w;\ny_weighted        = pt_y.*w;\n\n% step 3: calculate the formula\nB_upleft = sum(y_square_weighted)-sum(y_weighted).^2/n;\nB_upright = sum(x_square_weighted)-sum(x_weighted).^2/n;\nB_down = sum(x_weighted(:))*sum(y_weighted(:))/n-sum(x_weighted.*y_weighted);\nB = 0.5*(B_upleft-B_upright)/B_down;\n\n% step 4: calculate b\nif B&lt;0\n    b       = -B+sqrt(B.^2+1);\nelse\n    b       = -B+sqrt(B.^2+1);\nend\n\n% Step 5: calculate a\na = (sum(y_weighted)-b*sum(x_weighted))/n;\n\n% Step 6: the model is y = a + bx, and now we transform the model to \n% a*x + b*y + c = 0;\nc_ = a;\na_ = b;\nb_ = -1;\n\nline = [a_ b_ c_];\n</code></pre>\n\n<p>However, the result is not good as illustrated in the following script:</p>\n\n<pre><code>%% Procedure 1: given the data\npt_x = [   692   692   693   692   693   693   750];\npt_y = [ 919         971        1022        1074        1126        1230        1289];\n\n% Procedure 2: draw the point \n close all; figure; plot(pt_x,pt_y,'b*');\n\n% Procedure 3: estimate the line based on the weighted vertical offset\n% least square method.\n weighting = ones(length(pt_x),1);\n weighting(end) = 0.1;  % we give the last point a low weighting because obvously it is an outlier\n myline =    estimate_line_ver_weighted(pt_x,pt_y,weighting); \n a = myline(1); b = myline(2); c= myline(3);\n\n % Procedure 4: draw the line\n x_range = [min(pt_x):0.1:max(pt_x)];\n y_range = [min(pt_y):0.1:max(pt_y)];\n if length(x_range)&gt;length(y_range)\n        x_range_corrspond = -(a*x_range+c)/b;\n        hold on; plot(x_range,x_range_corrspond,'r');\n else\n        y_range_correspond = -(b*y_range+c)/a;\n        hold on; plot(y_range_correspond,y_range,'r');\n end\n</code></pre>\n\n<p>The following figure corresponds to the above script:\n<img src=\"http://i.stack.imgur.com/uBLOf.png\" alt=\"enter image description here\">.</p>\n\n<p>It is obvious that the implemented algorithm has some problems. I was wondering whether you might point out my mistakes. Thanks!</p>\n\n<pre><code>  [1]: http://mathworld.wolfram.com/LeastSquaresFittingPerpendicularOffsets.html\n  [2]: http://i.stack.imgur.com/P9MHh.gif\n</code></pre>\n"},{"tags":["r","ggplot2","ggplot"],"answer_count":3,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":161,"score":9,"question_id":12806260,"title":"How to enforce ggplot's position_dodge on categories with no data?","body":"<p>I'm trying to use position_dodge on ggplot to obtain boxplots of two different signals (ind) sharing the same categories (cat).  When there is a category with data for one signal but not for the other one, the boxplot for the signal with data covers all the horizontal spacing, and does not respect the position_dodge instruction for that particular category.  Is there a way to make ggplot to enforce the dodging rule?  As you can see on the example below, the signal x has no data for category B, so it loses the space reserved by position_dodge.  I would like to avoid that.</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>data&lt;-data.frame(cat=c('A','A','A','A','B','B','A','A','A','A','B','B'), \n                 values=c(3,2,1,4,NA,NA,4,5,6,7,8,9), \n                 ind=c('x','x','x','x','x','x','y','y','y','y','y','y'))\n\nprint(ggplot() +\n        scale_colour_hue(guide='none') +\n      geom_boxplot(\n           aes(x=as.factor(cat), y=values, \n               fill=ind), \n           position=position_dodge(width=.60), \n           data=data,\n           outlier.size = 1.2,\n           na.rm=T))\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/rKbeq.png\" alt=\"graph with original problem\"></p>\n\n<h1>PROGRESS UPDATE</h1>\n\n<p>After some workarounds, I came up with the outcome I was looking for... (kind of) </p>\n\n<pre><code>data            &lt;- data.frame(\ncat=c('A','A','A','A','B','B','A','A','A','A','B','B','B'), \nvalues=c(3,2,1,4,NA,NA,4,5,6,7,8,9, 0), \nind=c('x','x','x','x','x','x','y','y','y','y','y','y','x'))\n\np  &lt;- ggplot() +\n      scale_colour_hue(guide='none') +\n      geom_boxplot(aes(x=as.factor(cat), y=values, fill=ind),\n      position=position_dodge(width=.60), \n      data=data,\n      outlier.size = 1.2,\n      na.rm=T) +\n      geom_line(aes(x=x, y=y), \n                data=data.frame(x=c(0,3),y=rep(0,2)), \n                size = 1, \n                col='white')\nprint(p)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/G66bR.png\" alt=\"solution with workaround\"></p>\n\n<p>Some people remcomended using faceting for the effect I wanted.  Faceting doesn't give me the effect I'm looking for.  The final graph I was looking for is shown below:</p>\n\n<p><img src=\"http://i.stack.imgur.com/HHTZ8.png\" alt=\"final graph\"></p>\n\n<p>If you notice, the white major tick mark at y = 10 is thicker than the other tick marks.  This thicker line is the geom_line with size=1 that hides unwanted boxplots.</p>\n\n<p>I wish we could combine different geom objects more seamlessly.  I reported this as a bug on Hadley's github, but Hadley said this is how position_dodge behaves by design. I guess I'm using ggplot2 in a non-standard way and workarounds are the way to go on these kind of issues.  Anyways, I hope this helps some of the R folks to push ggplot great functionality a little further.</p>\n"},{"tags":["r","igraph"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12894549,"title":"Calculating cohesive blocks cohesion igraph 0.5.4","body":"<p>Is there a more or less direct way to estimate the cohesion for each cohesive block (i.e. the result of <code>cohesive.blocks()</code>) in igraph 0.5.4?  </p>\n\n<p>In the actual version (0.6) there is a function called <code>cohesion()</code>, but in version 0.5.x there is not. Is there an easier way to calculate it or should I just do it individually for each block (by hand!!)?</p>\n"},{"tags":["r","cluster-analysis","spectral"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12896864,"title":"Spectral clustering on a affinity matrix in R","body":"<p>I have a affinity matrix for a set of elements (0 for the diagonal [0,1] for the rest). I pass this matrix for the algorithm below and the result cl$cluster is a vector corresponding to the clusters for each point. Is this implementation correct? Should I normalize the matrix before or transform it into a distance matrix? The articles that I am reading explains how but not with an input matrix example. When I use an affinity matrix banal as this:</p>\n\n<pre><code>A &lt;- matrix(c(0,.8,0,0,.8,0,0,0,0,0,0,.9,0,0,.9,0),nrow=4)  \n</code></pre>\n\n<p>i.e, there's a high affinity between the elements 1 and 2 and other 3 and 4. The result shows:</p>\n\n<pre><code>Clustering vector:\n[1] 1 2 1 2\n</code></pre>\n\n<p>But it should display something like 1 1 2 2 or 2 2 1 1 . I don't understand. The algorithm in R:</p>\n\n<pre><code># matrix example\nA &lt;- matrix(c(0,.8,.5,.8,0,.9,.5,.9,0),nrow=3)\n\nK = rowSums(A)\nDinv = diag(1/K)\nD= diag(K)\nn = nrow(A)\n\n#laplacian L = D - A\nL = diag(1,n)-sqrt(Dinv) %*% A %*% sqrt(Dinv)\n\nevv = eigen(L,symmetric=TRUE)\n\n#second smallest eigenvalue\nc=2\n\ncl &lt;- kmeans(evv$vectors[,1:2],c)\n</code></pre>\n"},{"tags":["r","igraph","directed-graph","clique"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12896477,"title":"Cliques for directed graphs in igraph","body":"<p>I'm working on a Twitternetwork based on follower-relations in R. In this Network I want to determine the size of the largest cliques within everybody can read each others tweets in his or her timeline. Therefore I would need largest.cliques. But this function is ignoring directionality. I know its not integrated in the igraph package but is there a way to find cliques in directed networks, where every node is actively and passivly connected to each other?</p>\n"},{"tags":["r","list","vector","logical"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":53,"score":-2,"question_id":12894331,"title":"R select names from a list using logical vector","body":"<p>I have a question, suppose I have my <code>list</code> with names and its component and I want to get those names which have its components in other vector:</p>\n\n<p>that is my list <strong>neighbors</strong></p>\n\n<pre><code>neighbors[[1]]\n [1] \"CNBP\"                  \"IGF2BP1\"               \"RPL3|OK/SW-cl.32\"     \n [4] \"HNRNPC\"                \"PURA|hCG_45299\"        \"RPS3A\"                \n         \"Cnbp\"                  \"Mis12|DN-393H17.5\"    \nneighbors[[2]]\n[1] \"NIN\"                \"PRKACA\"             \"AURKA|RP5-1167H4.6\"\n[4] \"GSK3B\"              \"AMOT\"               \"UBC\"\n</code></pre>\n\n<p>and my vector of interest\n    <strong>mtop</strong>   </p>\n\n<pre><code>[1] \"TUBA1A\"                \"DNAJB1\"                \"MME\"                  \n[4] \"PRKCB\"                 \"PARK2|KB-152G3.1\"      \"UBC\" \n</code></pre>\n\n<p>So my idea for example is return the name of <code>neighbors[2]</code>, which have in common UBC</p>\n\n<p>Any ideas??</p>\n"},{"tags":["r","gtk","gwidgets"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12894097,"title":"gWidgets: Resize combobox to fit content","body":"<p>I have created a GUI using gWidgets and RGtk2. A part of the GUI is a glayout with a set of gcomboboxes. These boxes are initially empty and gets populated once a file is imported.</p>\n\n<p>On mac with Gtk+ running through X11 the width of the comboboxes gets resized to fit the longest textstring in the combobox. On windows this doesn't happen and the comboboxes gets scrollbars to accomodate the long text strings (see pictures).</p>\n\n<p><img src=\"http://i.stack.imgur.com/HmHpj.png\" alt=\"Combobox on Windows\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/pOhMQ.png\" alt=\"Combobox on Mac\"></p>\n\n<p>I have tried turning visibility off and on to force a redraw but the size stay fixed.</p>\n\n<p>Is there anyway to force the resizing on windows machines?</p>\n\n<p>The code for the container holding the relevant widgets are:</p>\n\n<pre><code>optionsBox &lt;- ggroup(cont=controlGroup)\naddSpring(optionsBox)\noptions &lt;- glayout(cont=optionsBox, spacing=5, fill='y')\noptList &lt;- list()\noptions[1, 1, anchor=c(1,0)] &lt;- 'Category:'\noptions[1, 2, anchor=c(-1,0)] &lt;- optList$category &lt;- gcombobox(category, cont=options)\noptions[2, 1, anchor=c(1,0)] &lt;- 'Order:'\noptions[2, 2, anchor=c(-1,0)] &lt;- optList$order &lt;- gcombobox(order, cont=options)\noptions[2, 3, anchor=c(1,0)] &lt;- optList$numeric &lt;- gcheckbox('numeric', checked=TRUE)\noptions[3, 1, anchor=c(1,0)] &lt;- 'Plottype:'\noptions[3, 2, anchor=c(-1,0)] &lt;- optList$plottype &lt;- gcombobox(c('Bar', 'Line'), cont=options)\naddSpring(optionsBox)\n</code></pre>\n\n<p>best wishes</p>\n\n<p>Thomas</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":12895783,"title":"r language mtext not working with image.plot array","body":"<p>I am using R to plot an array of plots using image.plot. Everything works well except that I cannot get mtext() to display a main title. Using very similar code for an array of plots using matplot() works fine.</p>\n\n<p>The code I am using is given below. </p>\n\n<pre><code>op &lt;- par(mfrow = c(2, 2))\npar(mar=c(5, 4, 4, 2) + 0.1)\npar(oma = c(0,0,2,1))\nfor (i in 2:nout){\n  image.plot(r,th,t(u[i,,]),xlab=\"r\",ylab=expression(paste(theta)),\n    zlim=c(0.1,0.9), main=paste(\"t = \",t[i]),col=pal)\n} \nmtext(side=3, outer=TRUE, cex=1.25, line=2,expression(\n  paste(\"u(t,r,\",theta, \")\")))\n</code></pre>\n\n<p>Any help appreciated.</p>\n"},{"tags":["r","loops","plyr","3d-array"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":12794404,"title":"add data to a 3-d array using R","body":"<p>I have a series of functions in MATLAB that need to be converted into R. Unfortunately I do not know R all that well. </p>\n\n<p>A major hurdle is loading csv 100 files that are each 50x86069 into a 100, 50, 86069 array. </p>\n\n<p>I have the code set up to open/write an array, and then read each 50x86069 csv file as part of a loop.</p>\n\n<pre><code>l &lt;- list.files(inputs)\ndata.array&lt;-array(0,dim=c(100,50,86069))\n\n# loop through the input files to get the data loaded into an array\nfor(i in 1:5)\nin.file &lt;- read.csv(paste(inputs,\"/\",l[[i]], sep = \"\"))\n\n    in.file = in.file[,-1] ## remove the first column\n</code></pre>\n\n<p>Now I need to put in.file into data.array(i,50,86069).</p>\n\n<p>Any help would be greatly appreciated!</p>\n\n<p>Thanks-</p>\n"},{"tags":["r","map","calculated-columns"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12894281,"title":"Calculate rows with same title","body":"<p>Since my other question got closed, here is the required data. \nWhat I'm trying to do is have R calculate the last column 'count' towards the column city so I can map the data. Therefore I would need some kind of code to match this. Since I want to show how many participants (in count) are in the state of e.g Hawaii (HI) </p>\n\n<pre><code>zip     city         state  latitude    longitude   count\n96860   Pearl Harbor    HI  24.859832   -168.021815 36\n96863   Kaneohe Bay     HI  21.439867   -157.74772  39\n99501   Anchorage       AK  61.216799   -149.87828  12\n99502   Anchorage       AK  61.153693   -149.95932  17\n99506   Elmendorf AFB   AK  61.224384   -149.77461  2\n</code></pre>\n\n<p>what I've tried is </p>\n\n<pre><code>match&lt;- c(match(datazip$state, datazip$number))&gt;$\n</code></pre>\n\n<p>but I'm really helpless trying to find a solution since I don't even know how to describe this in short. My plan afterwards is to make choropleth map with the data and believe me by now I've seen almost all the pages that try to give advice. so your help is pretty much appreciated. Thanks</p>\n"},{"tags":["r","winbugs"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":12895431,"title":"Model in rjags for sum to zero constraints","body":"<p>I am trying to fit an ANOVA model into rjags. The model is like this</p>\n\n<pre><code>for (r in 1:nE){\n  for ( j in 1:nP){\n    for ( i in 1:nA){\n      logit(p[i,j,r]) &lt;- mu[r] + theta[i,r] + varphi[j,r] + psi[(nA-i)+j,r]\n    }\n  }\n}\n</code></pre>\n\n<p>And I need to fit in the constraints that </p>\n\n<pre><code>for (r in 1:nE){\n  theta[nA,r] &lt;- 0 - sum(theta[1:(nA-1), r])\n  varphi[nP,r] &lt;- 0 - sum(varphi[1:(nP-1), r])\n  psi[nK,r] &lt;- 0 - sum(psi[1:(nK-1), r])\n}\n</code></pre>\n\n<p>which is the sum to zero constraints for this model. However, rjags gives me the message</p>\n\n<pre><code>\"Compilation error on line 14. Attempt to redefine node varphi[16,1]\"\n</code></pre>\n\n<p>If I delete the constraint part, the model compiled just fine but will not converge.  In BUGS, the model is accepted. </p>\n\n<p>How can I implement these constraints in rjags?</p>\n"},{"tags":["r","makefile"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12894502,"title":"Compile only some C files in src folder","body":"<p>Is there a way to compile only some *.c (or *.cpp) files in src folder and not all of them? Perhaps it may be possible by modifying Makevars somehow?</p>\n\n<p>A bit of background: I made a mistake of committing some files to the git master branch and would be easier for me to avoid their compilation rather than renaming them all or removing the branch.</p>\n"},{"tags":["r","date","exclude","posixct"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":108,"score":3,"question_id":12891232,"title":"Exclude specific time periods in R","body":"<p>I'm a beginner with R and have tried searching for data extraction for certain time periods but can't seem to find anything.</p>\n\n<p>I have a time series of continuous data measured at 10 minute intervals for a period of five months. For simplicity's sake, the data is available in two columns as follows: </p>\n\n<pre>\nTimestamp   Temp.Diff\n2/14/2011 19:00 -0.385\n2/14/2011 19:10 -0.535\n2/14/2011 19:20 -0.484\n2/14/2011 19:30 -0.409\n2/14/2011 19:40 -0.385\n2/14/2011 19:50 -0.215\n</pre>\n\n<p>... And it goes on for the next five months. I have read the Timestamp column using as.POSIXct() into R. </p>\n\n<p>Assuming that only certain times of the day are of interest to me, (e.g. from 12 noon to 3 PM), I would like either like to exclude the other hours of the day, OR just extract those 3 hours but still have the data flow sequentially (i.e. in a time series). I understand that you can easily subset data if you know the row numbers, but as this is a much larger dataset, is there a way to code R so it automatically recognises the time period I'm looking at? </p>\n\n<p>Any help with this is greatly appreciated! </p>\n"},{"tags":["r","data-mining","cluster-analysis","dbscan"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12893492,"title":"Choosing eps and minpts for DBSCAN (R)?","body":"<p>I've been searching for an answer for this question for quite a while, so I'm hoping someone can help me.  I'm using dbscan from the fpc library in R.  For example, I am looking at the USArrests data set and am using dbscan on it as follows:</p>\n\n<pre><code>library(fpc)\nds &lt;- dbscan(USArrests,eps=20)\n</code></pre>\n\n<p>Choosing eps was merely by trial and error in this case.  However I am wondering if there is a function or code available to automate the choice of the best eps/minpts.  I know some books recommend producing a plot of the kth sorted distance to its nearest neighbour.    That is, the x-axis represents \"Points sorted according to distance to kth nearest neighbour\" and the y-axis represents the \"kth nearest neighbour distance\".    </p>\n\n<p>This type of plot is useful for helping choose an appropriate value for eps and minpts.  I hope I have provided enough information for someone to be help me out.  I wanted to post a pic of what I meant however I'm still a newbie so can't post an image just yet.</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":90,"score":6,"question_id":12888302,"title":"facet_wrap fill by column","body":"<p>As far as I can tell <code>facet_wrap</code> fills by row.  In the same way you can specify how to fill a <code>matrix</code> with <code>byrow</code> I was hoping you could do the same with facet_wrap.  I know I could reorder the levels of a factor to plot in this maner but this seems like a bit of work if there's a shorter method that I'm overlooking.  </p>\n\n<pre><code>library(ggplot2)\n\nggplot(mtcars, aes(x=gear,  y=mpg, fill=vs)) +\n    geom_bar(position=\"dodge\", stat=\"identity\") + \n    facet_wrap(~ carb, ncol=2)  #fills by row\n</code></pre>\n\n<p>How can we fill by column?</p>\n"},{"tags":["r","map","colors","state"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12891844,"title":"colour states by number of participants with R","body":"<p>I like the <a href=\"http://stackoverflow.com/questions/12229969/specifying-the-colour-scale-for-maps-in-ggplot/12891156#12891156\">graphic</a> and I want to do the same with my data. What I want to show is the number of participants in each state. In my data I have given this information: </p>\n\n<pre><code>zip city state latitude longitude timezone dst number \n</code></pre>\n\n<p>How can I add all the number of participants that I have for each zipcode to the state and then colour the states differnt (depending on number of participnat)?I'm pretty much a beginner so I'm very thankful for a detailed explanation.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12890964,"title":"cm.quantile from CreditMetrics produces NaN","body":"<p>Please, put in R the following structure:</p>\n\n<pre><code>M &lt;- structure(c(0.861, 0.02115, 0.01031, 0.00218, 0.00062, 0.00075, \n0.00047, 0.00028, 0.00049, 0.00046, 0.00025, 0, 0, 0.00028, 0, \n0, 0, 0, 0, 0, 0, 0, 0.05806, 0.74127, 0.04621, 0.01426, 0.00119, \n0.00036, 0.00054, 0.00041, 0.00069, 0.00011, 2e-05, 0, 0.00018, \n0.00013, 0, 5e-05, 0.00036, 0, 0, 0, 0, 0, 0.02818, 0.08446, \n0.73325, 0.04292, 0.01296, 0.00212, 0.00136, 0.00082, 4e-04, \n0.00035, 0.00027, 0.00026, 0.00011, 0.00015, 7e-05, 0.00037, \n0, 0, 0, 0, 0, 0, 0.00544, 0.06172, 0.09626, 0.74319, 0.05289, \n0.0108, 0.00233, 0.00153, 0.00079, 0.00043, 0.00048, 0, 0.00027, \n8e-05, 8e-05, 0, 0, 0, 0, 0, 0, 0, 0.00326, 0.01558, 0.03482, \n0.08853, 0.74873, 0.05157, 0.01757, 0.00257, 0.00169, 0.00121, \n0.00171, 0.00026, 0.00021, 0.00038, 0.00018, 8e-05, 0, 0, 0, \n0, 0, 0, 0.00124, 0.00656, 0.01336, 0.03007, 0.08159, 0.75361, \n0.06561, 0.01745, 0.0068, 0.00239, 0.00146, 0.00076, 0.00144, \n8e-04, 0, 0.00019, 0.00029, 0.00011, 0, 0, 0, 0, 0.00014, 0.00125, \n0.00436, 0.00979, 0.02872, 0.07991, 0.73237, 0.06614, 0.0248, \n0.00557, 0.00342, 0.00063, 0.00127, 0.00088, 0.00037, 0.00064, \n0, 0, 0, 0, 0, 0, 0.00012, 0.0016, 0.00099, 0.0028, 0.0071, 0.0285, \n0.06673, 0.72947, 0.05849, 0.02627, 0.00567, 0.00293, 0.00147, \n0.00063, 0.00091, 0.00041, 0.00058, 0.00011, 0, 0, 0, 0, 0, 0.00029, \n0.00113, 0.00235, 0.00401, 0.00852, 0.03129, 0.07254, 0.73812, \n0.08704, 0.02916, 0.00736, 0.003, 0.00127, 9e-04, 0.00053, 0, \n0.00056, 0, 0, 0, 0, 0, 6e-05, 2e-05, 0.00079, 0.00171, 0.00407, \n0.01094, 0.02855, 0.06595, 0.70365, 0.09882, 0.03277, 0.00725, \n0.00273, 0.00133, 0.00093, 4e-05, 0.00214, 0, 0, 0, 0, 0.00016, \n6e-05, 3e-04, 0.00022, 0.0022, 0.0019, 0.00471, 0.00774, 0.01578, \n0.04864, 0.63246, 0.08694, 0.0249, 0.00447, 0.00286, 0.00076, \n0.00058, 0.00096, 0.00126, 0.00065, 0, 0, 0.00016, 0, 6e-05, \n0.00028, 0.00141, 0.00121, 0.00177, 0.00433, 0.00612, 0.02536, \n0.04685, 0.62721, 0.06413, 0.02543, 0.00599, 0.00224, 4e-04, \n0.00079, 0.00095, 0.00146, 0, 0, 0, 3e-05, 0, 0.00024, 0.00047, \n0.0012, 0.00191, 0.00286, 0.00555, 0.01114, 0.03758, 0.06879, \n0.63721, 0.06643, 0.01916, 0.00552, 0.00248, 0.00406, 0, 0.00195, \n0, 0, 2e-05, 0, 0.00016, 0.00024, 0.00078, 0.00051, 0.00097, \n0.00354, 0.00468, 0.0081, 0.01457, 0.02812, 0.05973, 0.63797, \n0.0695, 0.02281, 0.00754, 0.00682, 0.00158, 0.00211, 0, 0, 0, \n0, 8e-05, 0, 0.00024, 0.00036, 0.00049, 0.00074, 0.00239, 0.00355, \n0.0105, 0.02154, 0.0443, 0.06606, 0.61553, 0.06689, 0.02387, \n0.01201, 0.00443, 0.00552, 0, 0, 0, 0, 6e-05, 0, 1e-04, 0.00012, \n0.00022, 0.00042, 0.00104, 0.00262, 0.00677, 0.00992, 0.02098, \n0.03936, 0.079, 0.59103, 0.09278, 0.03765, 0.01549, 0.01576, \n0, 0, 0, 0, 0, 3e-05, 0, 0.00033, 3e-05, 0.00053, 0.00121, 0.00182, \n0.00138, 0.00213, 0.00489, 0.01213, 0.03251, 0.06436, 0.5217, \n0.07683, 0.02941, 0.01836, 0, 0, 2e-05, 0, 0.00024, 0, 7e-05, \n0.00032, 4e-05, 0.00029, 0.00017, 9e-04, 0.00185, 0.00202, 0.00339, \n0.00545, 0.01572, 0.03769, 0.08199, 0.46362, 0.07383, 0.03559, \n0, 0, 0, 0, 0, 0, 0, 6e-05, 7e-05, 7e-05, 0.00027, 0.00104, 0.00044, \n8e-04, 0.00068, 0.00253, 0.00483, 0.01156, 0.04023, 0.05112, \n0.3796, 0.04176, 0, 0, 0, 0, 4e-05, 0, 0, 0, 0.00014, 2e-04, \n1e-04, 0.00042, 0.00054, 0.00106, 0.00114, 0.00362, 0.0057, 0.01098, \n0.02518, 0.04904, 0.07889, 0.35197, 0, 0, 0.0422, 0.065969, 0.058349, \n0.06165, 0.05443, 0.05312, 0.05984, 0.05811, 0.06283, 0.06596, \n0.09949, 0.09921, 0.10674, 0.10623, 0.10933, 0.11679, 0.11731, \n0.12062, 0.14814, 0.16705, 1, 0, 0, 1.00000000002876e-06, 9.99999999917733e-07, \n0.000460000000000127, 0.000780000000000114, 0.000659999999999883, \n0.000600000000000045, 0.00141000000000013, 0.00163999999999986, \n0.00296999999999981, 0.00631000000000004, 0.00729000000000002, \n0.01671, 0.0229900000000003, 0.0360299999999999, 0.0661700000000001, \n0.0846699999999999, 0.17356, 0.26642, 0.35782, 0, 1), .Dim = c(22L, \n22L), .Dimnames = list(c(\"Aaa\", \"Aa1\", \"Aa2\", \"Aa3\", \"A1\", \"A2\", \n\"A3\", \"Baa1\", \"Baa2\", \"Baa3\", \"Ba1\", \"Ba2\", \"Ba3\", \"B1\", \"B2\", \n\"B3\", \"Caa1\", \"Caa2\", \"Caa3\", \"Ca-C\", \"WR\", \"Default\"), c(\"Aaa\", \n\"Aa1\", \"Aa2\", \"Aa3\", \"A1\", \"A2\", \"A3\", \"Baa1\", \"Baa2\", \"Baa3\", \n\"Ba1\", \"Ba2\", \"Ba3\", \"B1\", \"B2\", \"B3\", \"Caa1\", \"Caa2\", \"Caa3\", \n\"Ca-C\", \"WR\", \"Default\")))\n</code></pre>\n\n<p>Now input the following code:</p>\n\n<pre><code>library(CreditMetrics) # donwloadable from CRAN repository\ncm.quantile(M)\n</code></pre>\n\n<p>On my system this returns a matrix whose the last column, named <code>Aaa</code>, contains <code>NaN</code>s; these <code>NaN</code>s are a big problem in my further code developments.</p>\n\n<p>Why do those <code>NaN</code>s happen and how may I solve this issue?</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":12891067,"title":"function to show differences between two or more objects","body":"<p>When using R, I normally use <code>identical(a,b)</code> to check if the objects <code>a</code> and <code>b</code> are the same. If this returns <code>FALSE</code> I would like to be able to see where these differences are...is there a function that would show me this?</p>\n"},{"tags":["r","random","sampling"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12891385,"title":"Random sampling from data fram and finding the mean","body":"<p>Thank everbody for help.</p>\n\n<p>My data frame are 700*5 table.</p>\n\n<ol>\n<li>I want to random sampling n=50 for 1000 times.</li>\n<li><p>for each time I want to create a new colume (name Z) for store the selected and non-select such as</p>\n\n<p>1 selected, 0 non-select</p></li>\n<li><p>Eeach time bring select observation(z=1) to find the mean and SD. by creating a new table  to contain that value.</p></li>\n</ol>\n\n<p>** Now I have code for random sampling in no.1 but for 2-3, I really have no idea. Thank you every body agAIN..</p>\n"},{"tags":["r","data.table","xts"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":107,"score":4,"question_id":12479238,"title":"Data Frame Subset Performance","body":"<p>I have a couple of large data frames (1 million+ rows x 6-10 columns) I need to subset repeatedly. The subsetting section is the slowest part of my code and I curious if there is way to do this faster.</p>\n\n<pre><code>load(\"https://dl.dropbox.com/u/4131944/Temp/DF_IOSTAT_ALL.rda\")\nstart_in &lt;- strptime(\"2012-08-20 13:00\", \"%Y-%m-%d %H:%M\")\nend_in&lt;- strptime(\"2012-08-20 17:00\", \"%Y-%m-%d %H:%M\")\nsystem.time(DF_IOSTAT_INT &lt;- DF_IOSTAT_ALL[DF_IOSTAT_ALL$date_stamp &gt;= start_in &amp; DF_IOSTAT_ALL$date_stamp &lt;= end_in,])\n\n&gt; system.time(DF_IOSTAT_INT &lt;- DF_IOSTAT_ALL[DF_IOSTAT_ALL$date_stamp &gt;= start_in &amp; DF_IOSTAT_ALL$date_stamp &lt;= end_in,])\n   user  system elapsed \n  16.59    0.00   16.60 \n\ndput(head(DF_IOSTAT_ALL))\nstructure(list(date_stamp = structure(list(sec = c(14, 24, 34, \n44, 54, 4), min = c(0L, 0L, 0L, 0L, 0L, 1L), hour = c(0L, 0L, \n0L, 0L, 0L, 0L), mday = c(20L, 20L, 20L, 20L, 20L, 20L), mon = c(7L, \n7L, 7L, 7L, 7L, 7L), year = c(112L, 112L, 112L, 112L, 112L, 112L\n), wday = c(1L, 1L, 1L, 1L, 1L, 1L), yday = c(232L, 232L, 232L, \n232L, 232L, 232L), isdst = c(1L, 1L, 1L, 1L, 1L, 1L)), .Names = c(\"sec\", \n\"min\", \"hour\", \"mday\", \"mon\", \"year\", \"wday\", \"yday\", \"isdst\"\n), class = c(\"POSIXlt\", \"POSIXt\")), cpu = c(0.9, 0.2, 0.2, 0.1, \n0.2, 0.1), rsec_s = c(0, 0, 0, 0, 0, 0), wsec_s = c(0, 3.8, 0, \n0.4, 0.2, 0.2), util_pct = c(0, 0.1, 0, 0, 0, 0), node = c(\"bda101\", \n\"bda101\", \"bda101\", \"bda101\", \"bda101\", \"bda101\")), .Names = c(\"date_stamp\", \n\"cpu\", \"rsec_s\", \"wsec_s\", \"util_pct\", \"node\"), row.names = c(NA, \n6L), class = \"data.frame\")\n</code></pre>\n"},{"tags":["r"],"answer_count":6,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":130,"score":6,"question_id":12861061,"title":"Round to nearest arbitrary number from list","body":"<p>I'm basically looking for a way to do a variation of <a href=\"http://stackoverflow.com/questions/3160502/ruby-round-number-down-to-nearest-number-based-on-arbitrary-list-of-numbers\">this Ruby script</a> in R.<br>\nI have an <strong>arbitrary list of numbers</strong> (steps of a moderator for a regression plot in this case) which have unequal distances from each other, and I'd like to round values which are within a range around these numbers to the nearest number in the list. \nThe ranges don't overlap.</p>\n\n<pre><code>arbitrary.numbers &lt;- c(4,10,15) / 10\nnumbers &lt;- c(16:1 / 10, 0.39, 1.45)\nrange &lt;- 0.1\n</code></pre>\n\n<p>Expected output:</p>\n\n<pre><code>numbers\n## 1.6 1.5 1.4 1.3 1.2 1.1 1.0 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0.39 1.45\nround_to_nearest_neighbour_in_range(numbers,arbitrary.numbers,range)\n## 1.5 1.5 1.5 1.3 1.2 1.0 1.0 1.0 0.8 0.7 0.6 0.4 0.4 0.4 0.2 0.1 0.4 1.5\n</code></pre>\n\n<p>I've got a little helper function that might do for my specific problem, but it's not very flexible and it contains a loop. I can post it here, but I think a real solution would look completely different.</p>\n\n<h2>The different answers timed for speed (on a million numbers)</h2>\n\n<pre><code>&gt; numbers = rep(numbers,length.out = 1000000)\n&gt; system.time({ mvg.round(numbers,arbitrary.numbers,range) })[3]\nelapsed \n  0.067 \n&gt; system.time({ rinker.loop.round(numbers,arbitrary.numbers,range) })[3]\nelapsed \n  0.289 \n&gt; system.time({ rinker.round(numbers,arbitrary.numbers,range) })[3]\nelapsed \n  1.403 \n&gt; system.time({ nograpes.round(numbers,arbitrary.numbers,range) })[3]\nelapsed \n  1.971 \n&gt; system.time({ january.round(numbers,arbitrary.numbers,range) })[3]\nelapsed \n  16.12 \n&gt; system.time({ shariff.round(numbers,arbitrary.numbers,range) })[3]\nelapsed \n15.833 \n&gt; system.time({ mplourde.round(numbers,arbitrary.numbers,range) })[3]\nelapsed \n  9.613 \n&gt; system.time({ kohske.round(numbers,arbitrary.numbers,range) })[3]\nelapsed \n 26.274 \n</code></pre>\n\n<p>MvG's function is the fastest, about 5 times faster than Tyler Rinker's second function.</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":168,"score":2,"question_id":12229969,"title":"Specifying the colour scale for maps in ggplot","body":"<p>Having difficulty setting the colour scales for maps in ggplot. I need greyscale. Very grateful for an idea where I'm going wrong.  I also wonder if there is a more efficient way of getting the colour variable into ggplot (i.e. than by attaching it to 'fortified' data)?</p>\n\n<pre><code>library(ggplot2)\nstates &lt;- map_data(\"state\")\nvar &lt;- data.frame(table(states$region)) # using rows as a dummy variable\nstates$variable &lt;- var$Freq[match(states$region,var$Var1)]\n\nmap &lt;- ggplot(states, aes(x=long, y=lat)) + \n  geom_polygon(aes(group=group, fill=variable), col=NA,lwd=0)\n\nmap + scale_colour_gradient(low='white', high='grey20')\nmap + scale_colour_grey()\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/7Jpml.png\" alt=\"enter image description here\"></p>\n"},{"tags":["regex","r","grep"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":114,"score":1,"question_id":12885257,"title":"R grep whole words separated by special characters","body":"<p>Suppose there is a vector of sequences of the form <code>\"foo\"</code> or <code>\"foo|baz|bar\"</code> (one single word or multiple words separated by special character like <code>\"|\"</code>), and we are also given a word and we want to find to which items of the vector it has a <strong>whole word</strong> match. </p>\n\n<p>For example the word <code>\"foo\"</code> has a whole match in <code>\"foo|baz|bar\"</code>, but not a whole match in either <code>\"foobaz|bar\"</code> or <code>\"bazfoo\"</code>. </p>\n\n<p>First I tried to use <code>\"\\\\b\"</code> that indicates either the start or the end edges of a whole word and it works successfully:</p>\n\n<pre><code>grep(\"\\\\bfoo\\\\b\", \"foo\")         # match\ngrep(\"\\\\bfoo\\\\b\", \"foobaz|bar\")  # mismatch    \ngrep(\"\\\\bfoo\\\\b\", \"bazfoo\")      # mismatch\n</code></pre>\n\n<p>Then I tried to add <code>\"|\"</code> as the other possible separator of both ends, and group it with <code>\"\\\\b\"</code> using <code>[</code> and <code>]</code>:</p>\n\n<pre><code>grep(\"[|\\\\b]foo[|\\\\b]\", \"foo|baz|bar\")  # mismatch!\ngrep(\"[|\\\\b]foo[|\\\\b]\", \"foo\")          # mismatch!\n</code></pre>\n\n<p>Later I found <code>\\\\b</code> is not indicator of <em>start</em> or <em>end</em> of the character string, but start or end of a whole word (so many characters like space and <code>,|-^.</code> but <strong>not</strong> numbers and underline <code>_</code> separate whole words). So <code>\"[|\\\\b]foo[|\\\\b]\"</code> matches to all of these strings: <code>\"foo\", \"foo|bar|baz\", \"foo-bar\", \"baz foo|bar\"</code> but not to <code>\"foo_bar\"</code> or <code>\"foo2\"</code>.</p>\n\n<p>But my question still remains: Why <code>\"[|\\\\b]foo[|\\\\b]\"</code> pattern fails to match with <code>\"foo\"</code>?</p>\n"},{"tags":["r","data","data.table"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":96,"score":1,"question_id":11891609,"title":"Apply function in R causes memory allocation error","body":"<p>I am trying to do a calculation on each row of a data frame in R and append the calculation as a new column in the frame.  I started using the \"by\" function but it was incredibly slow doing the calculation so I switched to the \"apply\" function instead.  The way I imagine it will work is by running apply with my function, saving the output to a variable and appending that data to the original data frame.</p>\n\n<p>I created a function to calculate the term length of an insurance plan and return that value, which works fine on a sample data set.  When I use the my larger data set, I get an error of \"cannot allocate vector of size ... \".  I know many people recommend getting more RAM but I already have 16GB of memory and with the entire data set loaded in R my computer says it is using only 7.7GB of memory.  The data set has 44 columns with ~11 million records so I'm not seeing how adding one more column of data takes up 8GB of memory?!!</p>\n\n<p>Any point in the right direction would be great.  </p>\n\n<p>-</p>\n\n<p>Below is the function I am using:</p>\n\n<pre><code>get_term_length &lt;- function(row_data){\n\n    # convert values to dates\n    expiration_date &lt;- as.Date( row_data[42] )\n    start_date &lt;- as.Date( row_data[43] )\n    cancellation_date &lt;- as.Date( row_data[44] )\n\n    # check to see if the cancellation date is NA - just use entire policy length\n    if( is.na(cancellation_date) ){\n        return( expiration_date - start_date) )\n    }\n\n    # check to see if policy was cancelled early\n    if(cancellation_date &lt; expiration_date){\n        return( cancellation_date - start_date )\n    }\n\n    # the policy was for the entire term\n    else{\n        return( expiration_date - start_date )\n    }\n\n}\n</code></pre>\n\n<p>I have been running the function by calling:</p>\n\n<pre><code>tmp &lt;- apply(policy_data, 1, get_term_length)\n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":779,"score":8,"question_id":9857123,"title":"\"Error in continuous_scale\" and \"error in inherits\" ggplot2 & R 2.14.2","body":"<p>I am following a tutorial in the book \"Machine Learning for Hackers\" by Drew Conway, and I am stuck with a problem plotting a histogram. \nThe example code runs up the plotting section here:</p>\n\n<pre><code>&gt; quick.hist &lt;- ggplot(ufo.us, aes(x = DateOccurred)) +\n+   geom_histogram() + \n+   scale_x_date(major = \"50 years\")\n</code></pre>\n\n<p>produces</p>\n\n<pre><code>Error in continuous_scale(aesthetics, \"date\", identity, breaks = breaks,  : unused argument(s) (major = \"50 years\")\n</code></pre>\n\n<p>and</p>\n\n<pre><code>&gt; ggsave(plot = quick.hist,\n+        filename = \"C:\\test.png\",\n+        height = 6,\n+        width = 8)\n</code></pre>\n\n<p>produces</p>\n\n<pre><code>Error in inherits(plot, \"ggplot\") : object 'quick.hist' not found\n</code></pre>\n\n<p>I am using R version 2.14.2. and the ggplot2 library. Thanks in advance for any help.</p>\n\n<hr>\n\n<p><strong>Solved</strong></p>\n\n<p>A quick solution that worked fo me was to eliminate the '+ scale_x_date(major = \"50 years\")' part of every line that referenced a label. The final code that produce the histogram was like this:</p>\n\n<pre><code>&gt; quick.hist &lt;- ggplot(ufo.us, aes(x = DateOccurred)) +\n+   geom_histogram()\n</code></pre>\n\n<p>I would like to add labelsto the charts at some point, but for now, this solution works with the new version of ggplot2. </p>\n"},{"tags":["r","emacs","environment","ess"],"answer_count":1,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":137,"score":5,"question_id":12880794,"title":"Customizing the ESS environment for R","body":"<p>I am trying to optimize my <a href=\"http://ess.r-project.org/\" rel=\"nofollow\">ESS</a> - R environment. So far I make use of the <a href=\"http://www.svenhartenstein.de/Software/R-autoyas\" rel=\"nofollow\">r-autoyas</a>, I set intendation and stuff following <a href=\"http://google-styleguide.googlecode.com/svn/trunk/google-r-style.html\" rel=\"nofollow\">style guides</a>, in the mini-buffer there are eldoc hints for function arguments, and I have the option to <a href=\"https://gist.github.com/318365\" rel=\"nofollow\">press a key</a> in order to find information about variable at point (more <a href=\"http://www.sigmafield.org/comment/10\" rel=\"nofollow\">here</a>).</p>\n\n<p>Are there any other things you use in order to have a nice R environment? Maybe non-ESS people have some nice things to add (I got that info of variable at point from looking at an Eclipser). One example could be an easy way to insert \"just-before-defined\" variables without typing the variable name (should be something for that?).</p>\n\n<p>(Please help me to change the question instead of \"closing\" the thread if it is not well formulated)</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":62,"score":4,"question_id":12888438,"title":"R paired column index","body":"<p>Say I have two matrix, A and B:</p>\n\n<pre><code>mth &lt;- c(rep(1:5,2))\nday &lt;- c(rep(10,5),rep(11,5)) \nhr &lt;- c(3,4,5,6,7,3,4,5,6,7)  \nv &lt;- c(3,4,5,4,3,3,4,5,4,3)  \nA &lt;- data.frame(cbind(mth,day,hr,v))\n\nyear &lt;- c(2008:2012)\nmth &lt;- c(1:5)  \nB &lt;- data.frame(cbind(year,mth)) \n</code></pre>\n\n<p>What I want should be look like:</p>\n\n<pre><code>mth &lt;- c(rep(2008:2012,2))  \nday &lt;- c(rep(10,5),rep(11,5))  \nhr &lt;- c(3,4,5,6,7,3,4,5,6,7)  \nv &lt;- c(3,4,5,4,3,3,4,5,4,3)  \nA &lt;- data.frame(cbind(mth,day,hr,v)) \n</code></pre>\n\n<p>Basically what I need is to change the column mth in A with column year in B, Maybe I didn't search for the right keyword, I was not able to get what I want(I tried which()), please help, thank you.</p>\n"},{"tags":["java","eclipse","r","ubuntu","statet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":134,"score":0,"question_id":12872699,"title":"error: unable to load installed packages just now","body":"<p>When I tried to run r console in eclipse,got this error:</p>\n\n<hr>\n\n<pre><code>....Please make sure that R package 'rj' (1.1 or compatible) is installed...\n</code></pre>\n\n<p>So I tried to intall it in R console like this:</p>\n\n<hr>\n\n<pre><code>install.packages(c(\"rj\", \"rj.gd\"), repos=\"http://download.walware.de/rj-1.1\")\n</code></pre>\n\n<p>got this error:</p>\n\n<hr>\n\n<pre><code> ** testing if installed package can be loaded\n Error : .onLoad failed in loadNamespace() for 'rj.gd', details:\n call: dyn.load(file, DLLpath = DLLpath, ...)\n error: unable to load shared object '/home/alex/R/x86_64-pc-linux-gnu-library/2.15/rj.gd/libs/rj.gd.so':\n libjvm.so: cannot open shared object file: No such file or directory\n Error: loading failed\n Execution halted\n ERROR: loading failed\n</code></pre>\n\n<p>and I found when installing rjava like this: install.packages(\"rJava\") will get similar error:</p>\n\n<hr>\n\n<pre><code>** testing if installed package can be loaded\nError : .onLoad failed in loadNamespace() for 'rJava', details:\ncall: dyn.load(file, DLLpath = DLLpath, ...)\nerror: unable to load shared object '/home/alex/R/x86_64-pc-linux-gnu-library/2.15/rJava/libs/rJava.so':\nlibjvm.so: cannot open shared object file: No such file or directory\nError: loading failed\nExecution halted\nERROR: loading failed\n</code></pre>\n\n<h2>When I run  sudo R CMD javareconf,I got this outputs</h2>\n\n<pre><code>Java interpreter : /usr/bin/java\nJava version     : 1.7.0\nJava home path   : /usr/lib/jvm/java-7-oracle/jre\nJava compiler    : /usr/bin/javac\nJava headers gen.: /usr/bin/javah\nJava archive tool: /usr/bin/jar\nNOTE: Your JVM has a bogus java.library.path system property!\nTrying a heuristic via sun.boot.library.path to find jvm library...\nJava library path: $(JAVA_HOME)/lib/amd64:$(JAVA_HOME)/lib/amd64/server\nJNI linker flags : -L$(JAVA_HOME)/lib/amd64 -L$(JAVA_HOME)/lib/amd64/server -ljvm\nJNI cpp flags    : -I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux\n\nUpdating Java configuration in /etc/R\nDone.\n</code></pre>\n\n<h2>by the way,my configuration is:</h2>\n\n<pre><code>ubntu 11.10 64bit    eclipse 3.7    oracle-1.7-jdk    R version 2.15.1 \n</code></pre>\n"},{"tags":["r","data.frame"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":94,"score":3,"question_id":12888363,"title":"R How to change column values in a data frame","body":"<p>I have a simple data frame column transformation which can be done using an if/else loop, but I was wondering if there was a better way to do this.</p>\n\n<p>The initial data frame is,</p>\n\n<pre><code> df &lt;-data.frame(cbind(x=rep(10:15,3), y=0:8))\n df\n    x y\n1  10 0\n2  11 1\n3  12 2\n4  13 3\n5  14 4\n6  15 5\n7  10 6\n8  11 7\n9  12 8\n10 13 0\n11 14 1\n12 15 2\n13 10 3\n14 11 4\n15 12 5\n16 13 6\n17 14 7\n18 15 8\n</code></pre>\n\n<p>what I need to do is replace the values in column 'y' such that </p>\n\n<pre><code>'0' gets replaced with '2',\n'1' gets replaced with '2.2',\n'2' gets replaced with '2.4',\n...\n...\n'6' gets replaced with '3.2'\n'7' gets replaced with '3.3'\n'8' gets replaced with '10'\n</code></pre>\n\n<p>so that I end up with something like,</p>\n\n<pre><code>&gt; df\n    x    y\n1  10  2.0\n2  11  2.2\n3  12  2.4\n4  13  2.6\n5  14  2.8\n6  15  3.0\n7  10  3.2\n8  11  3.3\n9  12 10.0\n10 13  2.0\n11 14  2.2\n12 15  2.4\n13 10  2.6\n14 11  2.8\n15 12  3.0\n16 13  3.2\n17 14  3.3\n18 15 10.0\n</code></pre>\n\n<p>I have searched and found several proposals but couldnt get them to work. One of the attempts was something like,</p>\n\n<pre><code>&gt; levels(factor(df$y)) &lt;- c(2,2.2,2.4,2.6,2.8,3,3.2,3.3,10)\n\nError in levels(factor(df$y)) &lt;- c(2, 2.2, 2.4, 2.6, 2.8, 3, 3.2, 3.3,  : \n  could not find function \"factor&lt;-\"\n</code></pre>\n\n<p>But I get the error message shown above.</p>\n\n<p>Can anyone help me with this?</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12888254,"title":"geom_text labels on a faceted dodged barplot","body":"<p>I have used ggplot2 to create the image below.  I want to explore viewing the data by themes (foreign, economic, etc) as individual facets of facet_wrap.  I can restructure everything I want except I can no longer put the labels (73(1.02%), 67(.93%), etc) back on the bars.  How can I plot the labels?</p>\n\n<p><img src=\"http://i.stack.imgur.com/uCf7L.png\" alt=\"enter image description here\"></p>\n\n<p>Here's my code:</p>\n\n<pre><code>dat3 &lt;- structure(list(grouping.var = structure(c(1L, 3L, 1L, 3L, 1L, \n    3L, 1L, 3L, 1L, 3L, 1L, 3L, 1L, 3L, 1L, 3L), class = \"factor\", .Label = c(\"BIDEN\", \n    \"RADDATZ\", \"RYAN\")), word.count = c(7240, 7153, 7240, 7153, 7240, \n    7153, 7240, 7153, 7240, 7153, 7240, 7153, 7240, 7153, 7240, 7153\n    ), variable = structure(c(4L, 4L, 2L, 2L, 1L, 1L, 5L, 5L, 3L, \n    3L, 7L, 7L, 6L, 6L, 8L, 8L), .Label = c(\"foreign\", \"economic\", \n    \"rebublican_people\", \"health\", \"democratic_people\", \"romney\", \n    \"obama_any_name\", \"obama_by_name\"), class = \"factor\"), value = c(29, \n    36, 27, 47, 67, 73, 13, 28, 45, 24, 13, 20, 26, 21, 1, 14), labs = c(\"29(.0040)\", \n    \"36(.0050)\", \"27(.0037)\", \"47(.0066)\", \"67(.0093)\", \"73(.0102)\", \n    \"13(.0018)\", \"28(.0039)\", \"45(.0062)\", \"24(.0034)\", \"13(.0018)\", \n    \"20(.0028)\", \"26(.0036)\", \"21(.0029)\", \"1(.0001)\", \"14(.0020)\"\n    ), loc = c(22.5, 29.5, 20.5, 40.5, 60.5, 65.75, 6.5, 21.5, 38.5, \n    17.5, 6.5, 13.5, 19.5, 14.5, 7, 7.5), cols = c(\"black\", \"white\", \n    \"white\", \"white\", \"white\", \"white\", \"white\", \"white\", \"white\", \n    \"white\", \"white\", \"white\", \"white\", \"white\", \"white\", \"white\"\n    )), .Names = c(\"grouping.var\", \"word.count\", \"variable\", \"value\", \n    \"labs\", \"loc\", \"cols\"), row.names = c(NA, -16L), class = \"data.frame\")\n\n\nggplot(dat3, aes(x=variable,  y=value, fill=grouping.var)) + \n    geom_bar(position=\"dodge\", stat=\"identity\")  +\n    coord_flip() + theme_bw() + \n    theme(legend.position=\"top\", legend.background = element_rect(color=\"white\"),\n        panel.grid.major=element_blank(),panel.grid.minor=element_blank(),\n        legend.title=element_blank(), axis.ticks.y = element_blank(), \n        axis.text.y = element_blank()) +\n    ylab(\"\") +  xlab(\"\") + facet_wrap(~variable, ncol=2, scales = \"free_x\") +\n    scale_fill_manual(values=c(\"#0000FF\", \"#FF0000\"),\n        guide = guide_legend(reverse=TRUE))\n    geom_text(aes(label = labs,  y = loc, x = variable),\n              size = 5, position = position_dodge(width=0.9), color=dat3$cols) \n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":69,"score":4,"question_id":12888212,"title":"detecting outliers on wide data frame","body":"<p>x</p>\n\n<pre><code>Team Date       Score\nA    1-1-2012   80\nA    1-2-2012   90\nA    1-3-2012   50\nA    1-4-2012   40   \nB    1-1-2012   100\nB    1-2-2012   60\nB    1-3-2012   30\nB    1-4-2012   70\netc\n</code></pre>\n\n<p>I need to and can turn this data frame to wide data frame one row for each team with all the observations and dates as the heading:</p>\n\n<p>xx</p>\n\n<pre><code>Team 1-1-2012 1-2-2012  1-3-2012 1-4-2012\nA    80       90        50        40\nB    100     60         30        70  \n</code></pre>\n\n<p>I need to calculate the mean and sd for each row, which I can do:</p>\n\n<p>xx</p>\n\n<pre><code>Team 1-1-2012 1-2-2012  1-3-2012 1-4-2012  mean   sd\nA    80       90        50        40       75    20\nB    100     60         30        70       55    10 \n</code></pre>\n\n<p>Considering I have thousands of row in data frame xx. I would like to do calculation on each cell as this:</p>\n\n<p>if abs(xx-Mean) > 3*SD, create a counter column name and increment the value. The idea is that compare each observation against the mean and sd, if each observation for a given team matches this - abs(xx-Mean) > 3*SD, increment the counter. After checking each cell, I would like to look at each counter for each team and get the top ten high team that has the highest counter value. Basically I am trying to detect the most outliers. Once I get the top 10 team names, I would like to graph their time series data on data frame x.</p>\n\n<p>I hope I am not making this more complicated than it should be. Not sure, R already has function to do calculations on each cell. Any ideas how to accomplish this is appreciated?</p>\n"},{"tags":["r","na"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12888050,"title":"NA vector in language R","body":"<p>How I can identify if a resulting vector from one computation is full of the NA values?\nThanks</p>\n"},{"tags":["python","r","pil","cairo","rpy2"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":12887262,"title":"Generating an image from a raw vector containing a PNG image with Python.","body":"<p>In R I create a raw vector containing a PNG image with the following test code.(format = ARGB (640 x 480))  </p>\n\n<pre><code>library(Cairo)\nlibrary(png)\n\nCairo(type='raster')\nx=seq(0,3,by=0.01)    \ny=2*sin(2*pi*(x-1/4))\nplot(x,y)  #Test plot\nrawdata = writePNG(dev.capture(native=TRUE), raw())\nassign(\"rawpng\", rawdata, envir = .GlobalEnv)\n</code></pre>\n\n<p>The resulting vector looks like this:<code>c(89, 50, 4e, 47, 0d, 0a, 1a, 0a, 00, 00, 00, 0d, 49, 48, 44, \n52, 00, 00, 02, 80, 00, 00, 01, e0, 08, 06, 00, 00, 00, 35, d1, \ndc, e4, 00, 00, 20, 00, 49, 44, 41, 54, 78, 9c, ec, dd, 77,\naf, 5d, ee, cf, 75, 71, \n41, d6, 90, 99, e7, ec, b3, 66, 9f, b5, d7, 7a, d6, b3, c0, cc, \ncc, cc, cc, cc, cc, cc, cc, cc, cc, cc, cc, cc, cc, cc, cc, cc, \ncc, cc, cc, cc, cc, cc, cc, cc, cc, cc, cc, cc, cc, cc,..................................           b3, b0, fc, 1f, fe, 86, bd, ef, 71, 27, 9e, 88, 00, 00, 00, 00, \n49, 45, 4e, 44, ae, 42, 60, 82)</code></p>\n\n<p>Now i want to show the image in a Python canvas using the raw vector, but i can't seem to get it right. Using Rpy2 and Pil, I somehow managed to generate an image, but it's completly messed up.</p>\n\n<pre><code>rawdataVec = rpy2.robjects.globalenv['rawpng']\nrawdataArray = numpy.asarray(rawdataVec)\nnewshape = (640,480,4)\nnewstrides = (rawdataArray.itemsize, rawdataArray.itemsize,rawdataArray.itemsize)\ndata = numpy.lib.stride_tricks.as_strided(rawdataArray, shape=newshape, strides=newstrides)\nimg = Image.fromstring('RGBA', (640,480), data.tostring(),'raw','RGBA',0,1)\nphoto = ImageTk.PhotoImage(image=img)\n</code></pre>\n\n<p>I know that saving the plot as an image file and reloading it in Python would be much easier, but I need it without saving the file first.\nIs it even possible? </p>\n"},{"tags":["r","dependencies"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12887775,"title":"Editing Rcmd_environ for R","body":"<p>I am having trouble editing  Rcmd_environ file in <code>C:\\Program Files\\R\\R-2.12.1\\etc\\Renviron.site</code>\nbut says I don't have permission. I am trying to add <code>MYSQL_HOME=C:/mysql</code> so I can download RMySQL \naccording to this</p>\n\n<p><a href=\"http://stackoverflow.com/questions/4785933/adding-rmysql-package-to-r-fails\">adding RMySQL package to R fails?</a> </p>\n\n<p>Any suggestions?</p>\n"},{"tags":["r","regression"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":210,"score":2,"question_id":12881553,"title":"add a logarithmic regression line to a scatterplot (comparison with Excel)","body":"<p>In Excel, its pretty easy to fit a logarithmic trend line of a given set of trend line. Just click add trend line and then select \"Logarithmic.\" Switching to <code>R</code> for more power, I am a bit lost as to which function should one use to generate this.</p>\n\n<p>To generate the graph, I used <code>ggplot2</code> with the following code. </p>\n\n<pre><code>ggplot(data, aes(horizon, success)) + geom_line() + geom_area(alpha=0.3)+\n  stat_smooth(method='loess')\n</code></pre>\n\n<p>But the code does local polynomial regression fitting which is based on averaging out numerous small linear regressions. My question is whether there is a similar log trend line in <code>R</code> that is used in Excel. </p>\n\n<p>Edit: An alternative I am looking for is to get an log equation in form y = (c*ln(x))+b; is there a coef() function to get 'c' and 'b'?</p>\n\n<p>Edit2: Since I have more reputation, I can now post a bit more about what I am struggling to do. Let my data be:</p>\n\n<pre><code>0.599885189,0.588404133,0.577784156,0.567164179,0.556257176,0.545350172,0.535112897,\n0.52449292,0.51540375,0.507271336,0.499904325,0.498851894,0.498851894,0.497321087,\n0.4964600,0.495885955,0.494068121,0.492154612,0.490145427,0.486892461,0.482395714,\n0.477229238,0.471010333\n</code></pre>\n\n<p>The above data are y-points while the x-points are simply integers from 1:length(y) in increment of 1. In Excel: I can simply plot this and add a logarithmic trend line and the result would look:</p>\n\n<p><img src=\"http://i.stack.imgur.com/A4x6x.png\" alt=\"enter image description here\"></p>\n\n<p>With black being the log. In R, how would one do this with the above dataset?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12886572,"title":"Stacked bar plot for vectors that do not have the same size","body":"<p>I would like to describe my problem / situation first:\nI have a huge data set. I filter my data due to a number in one column (>0). In this column there are also 1,2,3. So the plan is to generate a stacked barplot. The bars are indicated by another column (12 different names - see example below) \nThis is a small example for my data:</p>\n\n<pre><code>dat &lt;- array(c(\"dbdb1\", \"dbdb2\",\"dbdb1\",\n               \"dbdb4\",\"dbdb1\",\"dbdb1\",\n               \"dbdb2\",\"dbdb4\",\"dbdb1\",\n               1,1,1,2,2,3,1,2,1),dim=c(9,2))\n</code></pre>\n\n<p>So now I'm going to separate them by the Number in my data set by <code>subset(data_set, \"column\"==1)</code> or <code>==2</code> or <code>==3</code> , (thats kinda ugly .. .) </p>\n\n<p>example: </p>\n\n<pre><code>mod1=as.vector(data_set, Phospho==1)\nmod2=as.vector(data_set, Phospho==2)\n    ...\n</code></pre>\n\n<p>After that i used the as.vector function to isolate the column (in the example with the dbdbX entries) as a vector. <code>as.vector1=as.vector(mod1$dbdbColumn)</code>\nNow i tried to plot my barplot graph by using <code>barplot(table(as.vector1,as.vector2)</code></p>\n\n<p>but due to the fact that they differ in length I cannot use this.</p>\n\n<p>Can you pleace help me? Thanks! I hope my problem is clear , sorry if its not</p>\n\n<p>Best regards and thx in advance</p>\n"},{"tags":["r","vector","matrix"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":87,"score":1,"question_id":12886655,"title":"extract data from a list without using loop in R","body":"<p>I have a vector v with row positions:</p>\n\n<pre><code>v&lt;-c(10,3,100,50,...)\n</code></pre>\n\n<p>with those positions I want to extract elements of a list, having a column fixed, for example lets suppose my column number is 2, so I am doing:</p>\n\n<pre><code>data&lt;-c()\ndata&lt;-c(list1[[v]][[2]])\n</code></pre>\n\n<p>list1 has the data in the following format:</p>\n\n<pre><code>[[34]]\n      [1] \"200_s_at\" \"483\"        \"1933\"        \"3664\"        \n</code></pre>\n\n<p>So for example, I want to extract from the row 342 the value 1910 only, column 2, and do the same with the next rows</p>\n\n<p>but I got an error when I want to do that, is it possible to do it directly? or should I have a loop that read one by one the positions in v and fill the data vector like:</p>\n\n<pre><code>#algorithm\nfor i&lt;-1 to length(v)\n    pos&lt;-v[i]\n    data[[i]]&lt;-c(list1[[pos]][[2]])\nnext i\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["r","ggplot2","bar-chart"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":43,"score":3,"question_id":12885383,"title":"How do I rearrange variables in a multiple facet bar chart using ggplot2 in R?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5208679/order-bars-in-ggplot2-bar-graph\">Order Bars in ggplot2 bar graph</a>  </p>\n</blockquote>\n\n\n\n<p>I have a large data set comprising of %coral cover in different 'Zones'. Using ggplot in R I've managed to produce the plot below, which is sooo nearly what I want! </p>\n\n<p>I basically want to swap the facets <code>(Coral.graph$Zone)</code> around so they go; blue, yellow, green. Also, I want to swap the variables <code>(Coral.graph$cover)</code> around in the x axis so they read; Branching, Massive, Table.Plate, Other.Hard, Soft, Sand, Rock, Rubble, Macroalgea, Other. At the moment they are both sorted alphabetically (as I'm a new user I can't post my graph..)</p>\n\n<p>Having followed the instructions in the linked answer, I'm still struggling. The linked answer lists the variables in \"decreasing\" order... as mine are not numerical I've tried listing them in the order I want, but my code writing is apparently inaccurate... Please help!</p>\n\n<p>My code is </p>\n\n<pre><code>coralgraph &lt;- Coral.graph\nbar &lt;- ggplot(coralgraph, aes(Coral,Cover))\nbar + stat_summary(fun.y=mean, geom=\"bar\", fill=\"White\", colour=\"Black\") + \n      facet_wrap(~Zone) + \n      stat_summary(fun.data= mean_cl_normal, geom= \"errorbar\", width=0.2) + \n      labs(x=\"Cover Type\", y=\"Mean Percentage Cover\") + \n      theme(legend.position=\"none\") + \n      coord_flip()\n</code></pre>\n\n<p>This is my second week using R, so I'm fairly novice! Sorry if this is an obvious question!!</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12886264,"title":"Getting the mean value in groups of an id","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8225621/faster-way-to-create-variable-that-aggregates-a-column-by-id\">faster way to create variable that aggregates a column by id</a>  </p>\n</blockquote>\n\n\n\n<p>So the thing is that i have following data loaded from a CSV file:</p>\n\n<pre><code>id      value2  value3\n1.000   0.010   14        \n1.000   0.019   15        \n0.995   0.024   13        \n0.995   0.031   20        \n0.990   0.012   13        \n.....\n</code></pre>\n\n<p>I want to calculate the mean/median etc. value of <code>value2</code> and <code>value3</code> in groups of <code>id</code>. Afterwards the plan was to be able to sort the result by either <code>value2</code> or <code>value3</code>.</p>\n\n<p>Is there a way to do such task?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["r","labels","factor","levels","na"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":64,"score":4,"question_id":12885289,"title":"Unspecified levels in factor()","body":"<p>I'm working with a dataset in R that comes with a codebook, which basically tells me what the labels for the different levels of my factor variables should be. For example, with the codebook, I can see that in my \"Sex\" variable, the 0s are \"Female\" and the 1s are \"Male.\" I'm using this information to label the values in my variables accordingly.</p>\n\n<p>However, I've recently discovered, to my dismay, that the codebook is not complete. For example, it tells me for one variable that 1s are \"Yes\" and 2s are \"No,\" but doesn't tell me what 7s, 8s, and 9s are, which I can see in the data. What I would like to do is label this variable as follows (or something like this):</p>\n\n<pre><code>data$variable &lt;- factor(data$variable,\n                        levels=c(1, 2, 7, 8, 9),\n                        labels=c(\"Yes\", \"No\", \"7\", \"8\", \"9\"))\n</code></pre>\n\n<p>Basically, I would like for all levels that weren't specified in the codebook to be labeled as themselves. The problem I am having is that this codebook is missing quite a few of these, and I would really rather not have to manually look at all undefined values in my data to construct the above code for ever variable. Plus, if I just leave out those missing levels, R automatically labels them as \"NA,\" which I do not want.</p>\n\n<p>Summary: I am trying to figure out how to use factor() such that instead of labeling all unspecified levels as \"NA,\" it labels them as themselves.</p>\n"},{"tags":["r","writetofile"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":12817853,"title":"File.choose() when outputting data?","body":"<p>I want to use the same script to process data in many text files that are stored in different places, and then to save the output to another unique location, without having to amend my script each time.  I have input data using:</p>\n\n<p><code>data &lt;- read.table(file.choose(),header=T)</code></p>\n\n<p>and would like to save the final table with a similar interface to select the location and enter a name for the file.</p>\n\n<p>I have tried:</p>\n\n<p><code>write.csv(data.table,file.choose())</code></p>\n\n<p>but this only works if I create an empty .csv file with the name that I would like, in the location I would like before running the script.</p>\n\n<p>Is there another (better) way of doing this?</p>\n"},{"tags":["r","data.frame"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":81,"score":1,"question_id":12884695,"title":"Collapse rows in a data frame using R","body":"<p>I have a data frame in R defined as follows:</p>\n\n<p>data frame:</p>\n\n<p><kbd>col 1 &nbsp;</kbd><kbd>col 2 &nbsp;</kbd><kbd>col 3&nbsp;</kbd><kbd>col4&nbsp;</kbd><br/>\n<kbd>  200  &nbsp;&nbsp;&nbsp;</kbd><kbd>AIG&nbsp;&nbsp;&nbsp;</kbd><kbd>8.5&nbsp;&nbsp;&nbsp;</kbd><kbd>12&nbsp;&nbsp;&nbsp;</kbd><br/>\n<kbd> 800 &nbsp;&nbsp;&nbsp;</kbd><kbd>AIG&nbsp;&nbsp;&nbsp;</kbd><kbd>8.1&nbsp;&nbsp;&nbsp;</kbd><kbd>20.1&nbsp;&nbsp;&nbsp;</kbd><br/>\n<kbd>500 &nbsp;&nbsp;&nbsp;</kbd><kbd>A1B&nbsp;&nbsp;&nbsp;</kbd><kbd>20&nbsp;&nbsp;&nbsp;</kbd><kbd>50.5&nbsp;&nbsp;&nbsp;</kbd><br/>\n<kbd>800 &nbsp;&nbsp;&nbsp;</kbd><kbd>A1B&nbsp;&nbsp;&nbsp;</kbd><kbd>12&nbsp;&nbsp;&nbsp;</kbd><kbd>30&nbsp;&nbsp;&nbsp;</kbd><br/>\n<kbd>120 &nbsp;&nbsp;&nbsp;</kbd><kbd>A2M&nbsp;&nbsp;&nbsp;</kbd><kbd>1.6&nbsp;&nbsp;&nbsp;</kbd><kbd>8.5&nbsp;&nbsp;&nbsp;</kbd><br/></p>\n\n<pre><code>dat &lt;- structure(list(col1 = c(200, 800, 500, 800, 120), col2 = structure(c(3L, \n    3L, 1L, 1L, 2L), .Label = c(\"A1B\", \"A2M\", \"AIG\"), class = \"factor\"), \n        col3 = c(8.5, 8.1, 20, 12, 1.6), col4 = c(12, 20.1, 50.5, \n        30, 8.5)), .Names = c(\"col1\", \"col2\", \"col3\", \"col4\"), row.names = c(NA, \n    -5L), class = \"data.frame\")\n</code></pre>\n\n<p>Then I'd like to collapse the rows by id (in this case the unique ids are A1G, A1B, A2M). <br/>\nCol 1, I'd like to collapse it by adding the rows with the same id. <br/>\nCol 2, I'd like to collapse it to each unique id <br/>\nCol 3, I'd like to collapse it as follows, take col1*col3, add them, and then divide them by the sum of col1. <br/> I.e., the A1G new row value should be (8.5*20+8.1*80)/(80+20).  Aka the weighted average of column 3 weighted by the values of col1. <br/>\nCol 4, I'd like to take the maximum value.</p>\n\n<p>For our example, the new data should look like:</p>\n\n<p><kbd>column 1   &nbsp;</kbd><kbd>column 2 &nbsp;</kbd><kbd>column 3&nbsp;</kbd><kbd>column 4&nbsp;</kbd><br/>\n<kbd>  800+200=1000  &nbsp;&nbsp;&nbsp;</kbd><kbd>AIG&nbsp;&nbsp;&nbsp;</kbd><kbd>(8.5*200+8.1*800)/1000=8.18&nbsp;&nbsp;&nbsp;</kbd><kbd>max(12,20.1)=20.1&nbsp;&nbsp;&nbsp;</kbd><br/>\n<kbd> 800+500=1300 &nbsp;&nbsp;&nbsp;</kbd><kbd>AIG&nbsp;&nbsp;&nbsp;</kbd><kbd>(20*800+12*500)/1300=16.9&nbsp;&nbsp;&nbsp;</kbd><kbd>max(50.5, 30)=50.5&nbsp;&nbsp;&nbsp;</kbd><br/>\n<kbd>500 &nbsp;&nbsp;&nbsp;</kbd><kbd>A2M&nbsp;&nbsp;&nbsp;</kbd><kbd>1.6&nbsp;&nbsp;&nbsp;</kbd><kbd>8.5&nbsp;&nbsp;&nbsp;</kbd><br/></p>\n\n<p>Any suggestions?</p>\n\n<p>Thanks!</p>\n"},{"tags":["r","data.frame","extract","column"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12884500,"title":"Extracting some columns in R","body":"<p>I have a following sample data frame:</p>\n\n<pre><code>x&lt;-c(1:4)\ny&lt;-c(9:12)\nz&lt;-c(\"a\",\"b\",\"c\",\"d\")\ndata&lt;-data.frame(x,y,z) # as data: \n\n      x  y z\n    1 1  9 a\n    2 2 10 b\n    3 3 11 c\n    4 4 12 d\n</code></pre>\n\n<p>I want to extract the column 2 or 3 using the function (note: I am using column names to extract). My code is as follows:</p>\n\n<pre><code>data_frame&lt;-function(col){\ncols&lt;-c(\"y\",\"z\")\n# column x is already there; it is not in a vector of col.\nif (col %in% cols){\nkk&lt;-data[,c(\"x\",\"col\")] \nreturn (kk)}\n}\n</code></pre>\n\n<p>Now, I want the output for <code>data_frame(\"y\")</code>. However, R gives me the following error:</p>\n\n<pre><code>data_frame(\"y\")\nError in `[.data.frame`(data, , c(\"x\", \"col\")) : \n  undefined columns selected. \n</code></pre>\n\n<p>I was wondering why R is not taking my argument <code>col</code> which is <code>y</code> here. I am a bit upset  why R is interpreting argument <code>col</code> as the name of the column. Your valuable suggestion in this regard would be highly appreciated. </p>\n"},{"tags":["r","function"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12884502,"title":"prototype function in R","body":"<p>I am using notepad++ as my editor for R. One of the difficulties I face is that I don't always remember what the parameter structure looks like for a function I am attempting to call.  Is there a way to have prototypes of the function (like in C++) listed in the .r file?  This way I can see what the call convention is.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12874884,"title":"Trouble filtering data frame in R","body":"<p>I imported csv file into dataset. Now I want to copy a 48-row block of data starting from i-th row into a new dataframe then to skip over 3 48-row blocks and then to append the 4th 48-row block to the new dataframe's end, so on until the end of dataframe. \nI spent many hours on this issue without any success.\nThanks in advance for any possible hint.</p>\n"},{"tags":["r","grouping","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":12880241,"title":"Shingles with lattice package's equal.count()","body":"<p>Why does the <code>equal.count()</code> function create overlapping shingles when it is clearly possible to create groupings with no overlap. Also, on what basis are the overlaps decided?</p>\n\n<p>For example:</p>\n\n<pre><code>equal.count(1:100,4)\n\nData:\n  [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22\n [23]  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44\n [45]  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66\n [67]  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88\n [89]  89  90  91  92  93  94  95  96  97  98  99 100\n\nIntervals:\n   min   max count\n1  0.5  40.5    40\n2 20.5  60.5    40\n3 40.5  80.5    40\n4 60.5 100.5    40\n\nOverlap between adjacent intervals:\n[1] 20 20 20\n</code></pre>\n\n<p>Wouldn't it be better to create groups of size 25 ? Or maybe I'm missing something that makes this functionality useful?</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":106,"score":2,"question_id":12883386,"title":"plot only x and y axis (no box) in ggplot2","body":"<p>The convention of some journals is to show only the x and y axis in a plot not a box around the entire plot area.  How can I achieve this in ggplot2?  I tried <code>theme_minimal_cb_L</code> from <a href=\"https://github.com/hadley/ggplot2/wiki/Themes\" rel=\"nofollow\">HERE</a> but it seems to erase the entire box around the plot (does not leave the x and y axis) as seen here:</p>\n\n<p><img src=\"http://i.stack.imgur.com/jaEfJ.png\" alt=\"enter image description here\"></p>\n\n<p>Here's the code I'm using:</p>\n\n<pre><code>dat &lt;- structure(list(x = c(0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1, 1.05, \n    1.1, 1.15, 1.2, 1.25, 1.3), y1 = c(34, 30, 26, 23, 21, 19, 17, \n    16, 15, 13, 12, 12, 11), y2 = c(45, 39, 34, 31, 28, 25, 23, 21, \n    19, 17, 16, 15, 14)), .Names = c(\"x\", \"y1\", \"y2\"), row.names = c(NA, \n    -13L), class = \"data.frame\")\n\n\nlibrary(reshape2); library(ggplot2)\ndat2 &lt;- melt(dat, id='x')\n\ntheme_minimal_cb_L &lt;- function (base_size = 12, base_family = \"\", ...){\n  modifyList (theme_minimal (base_size = base_size, base_family = base_family),\n              list (axis.line = element_line (colour = \"black\")))\n}\n\nggplot(data=dat2, aes(x=x, y=value, color=variable)) + \n    geom_point(size=3) + geom_line(size=.5) +\n    theme_minimal_cb_L()\n</code></pre>\n"},{"tags":["r","emacs","autocomplete","ess","rstudio"],"answer_count":3,"favorite_count":5,"up_vote_count":19,"down_vote_count":0,"view_count":813,"score":19,"question_id":6865344,"title":"Is it possible to get code completion for R in Emacs ESS similar to what is available in Rstudio?","body":"<p>Rstudio has a great code completion feature. It provides a quick view of functions that start with a given string, as well as function and parameter definitions.</p>\n\n<p>ESS is powerful enough, familiar to me, and integrated into Emacs, where I conduct most of my work -  so I am hesitant to move, but this feature is making me consider such a move. </p>\n\n<p>Is it possible to integrate this feature into Emacs ESS? </p>\n\n<p>Is there anything similar to this for Emacs ESS?</p>\n\n<p>Any hope that there will be (and if so, how could I support such an effort?)</p>\n\n<p><img src=\"http://i.stack.imgur.com/EAadb.png\" alt=\"enter image description here\"></p>\n"},{"tags":["oracle","r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":12354874,"title":"ROracle installation fails on R 2.15.1 using Rtools 2.15","body":"<p>I'm trying to compile the ROracle package version 1.1-4 under Windows using R 2.15.1 and Rtools 2.15</p>\n\n<pre><code>install.packages('ROracle',type='source')\n</code></pre>\n\n<p>but it seems that <code>ocimingw.c</code> is missing (see output below). I get the same error message using <code>R CMD INSTALL --build</code>.</p>\n\n<p><strong>edit 2012-09-11</strong>: The problem is apparently specific to 1.1-4, as I managed to build and install 1.1-1 normally.</p>\n\n<p>Any idea what the solution might be?</p>\n\n<pre><code>trying URL 'http://stat.ethz.ch/CRAN/src/contrib/ROracle_1.1-4.tar.gz'\nContent type 'application/x-gzip' length 156924 bytes (153 Kb)\nopened URL\ndownloaded 153 Kb\n\n* installing *source* package 'ROracle' ...\n** package 'ROracle' successfully unpacked and MD5 sums checked\nlooking for Instant Client c:/instantclient/x64/instantclient_11_2\ncygwin warning:\n  MS-DOS style path detected: C:\\instantclient\\x64\\instantclient_11_2\n  Preferred POSIX equivalent is: /cygdrive/c/instantclient/x64/instantclient_11_2\n  CYGWIN environment variable option \"nodosfilewarning\" turns off this warning.\n  Consult the user's guide for more details about POSIX paths:\n    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames\nfound Instant Client C:\\instantclient\\x64\\instantclient_11_2\nfound Instant Client SDK c:/instantclient/x64/instantclient_11_2/sdk/include\ngenerating ocimingw.lib from ocimingw.def\nx86_64-w64-mingw32-dlltool: not found\ncopying from c:/instantclient/x64/instantclient_11_2/sdk/include\n** libs\nWarning: this package has a non-empty 'configure.win' file,\nso building only the main architecture\n\ncygwin warning:\n  MS-DOS style path detected: C:/R/R-215~1.1/etc/x64/Makeconf\n  Preferred POSIX equivalent is: /cygdrive/c/R/R-215~1.1/etc/x64/Makeconf\n  CYGWIN environment variable option \"nodosfilewarning\" turns off this warning.\n  Consult the user's guide for more details about POSIX paths:\n    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames\ngcc -m64 -I\"C:/R/R-215~1.1/include\" -DNDEBUG -I./oci    -I\"d:/RCompile/CRANpkg/extralibs64/local/include\"     -O2 -Wall  -std=gnu99 -mtune=core2 -c rodbi.c -o rodbi.o\nrodbi.c: In function 'rociResExec':\nrodbi.c:1169:14: warning: unused variable 'drv' [-Wunused-variable]\nrodbi.c: In function 'rociResFetch':\nrodbi.c:1187:16: warning: unused variable 'drv' [-Wunused-variable]\nrodbi.c: In function 'rociResInfo':\nrodbi.c:1256:16: warning: unused variable 'drv' [-Wunused-variable]\nrodbi.c: In function 'rociResTerm':\nrodbi.c:1323:14: warning: unused variable 'drv' [-Wunused-variable]\nrodbi.c: In function 'rodbiCheck':\nrodbi.c:2348:25: warning: pointer targets in passing argument 1 of 'snprintf' differ in signedness [-Wpointer-sign]\nc:\\rtools\\gcc-4.6.3\\bin\\../lib/gcc/i686-w64-mingw32/4.6.3/../../../../i686-w64-mingw32/include/stdio.h:505:15: note: expected 'char * restrict' but argument is of type 'text *'\nrodbi.c: In function 'rawToStrhexCall':\nrodbi.c:2573:7: warning: pointer targets in passing argument 1 of 'Rf_mkChar' differ in signedness [-Wpointer-sign]\nC:/R/R-215~1.1/include/Rinternals.h:628:6: note: expected 'const char *' but argument is of type 'unsigned char *'\nrodbi.c:2557:26: warning: unused variable 'seglen' [-Wunused-variable]\nrodbi.c: In function 'rociResInit':\nrodbi.c:1121:3: warning: 'qry_encoding' may be used uninitialized in this function [-Wuninitialized]\ngcc -m64 -I\"C:/R/R-215~1.1/include\" -DNDEBUG -I./oci    -I\"d:/RCompile/CRANpkg/extralibs64/local/include\"     -O2 -Wall  -std=gnu99 -mtune=core2 -c rooci.c -o rooci.o\nIn file included from C:/R/R-215~1.1/include/R.h:44:0,\n                 from rodbi.h:37,\n                 from rooci.c:47:\nC:/R/R-215~1.1/include/R_ext/RS.h:43:0: warning: \"ERROR\" redefined [enabled by default]\nc:\\rtools\\gcc-4.6.3\\bin\\../lib/gcc/i686-w64-mingw32/4.6.3/../../../../i686-w64-mingw32/include/wingdi.h:70:0: note: this is the location of the previous definition\nrooci.c: In function 'roociInitializeRes':\nrooci.c:620:32: warning: 'cnvcid' may be used uninitialized in this function [-Wuninitialized]\ngcc -m64 -shared -s -static-libgcc -o ROracle.dll tmp.def rodbi.o rooci.o -L. ocimingw.lib -Ld:/RCompile/CRANpkg/extralibs64/local/lib/x64 -Ld:/RCompile/CRANpkg/extralibs64/local/lib -LC:/R/R-215~1.1/bin/x64 -lR\ngcc.exe: error: ocimingw.lib: No such file or directory\nERROR: compilation failed for package 'ROracle'\n* removing 'C:/R/R-2.15.1/library/ROracle'\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12882632,"title":"Plot matrix column against a vector","body":"<p>Suppose I have a matrix with n columns and m rows. In my case I have a setup depending on a parameter which can take n different values. For each of these values I do some calculation, the m elements in the rows. Now I would like to plot each column against a vector (timestep), which is of course of length m. How do I do this? It should be something like plot(timestep,i-th column)? Thanks in advance!</p>\n\n<p>cheers</p>\n\n<p>math</p>\n"},{"tags":["r","regression"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":12882283,"title":"Counting values above a centile in a centile regression","body":"<p>I am trying to figure out how to count values above a certain centile in a centile regression.\nI am using reference values to create a centile regression using the package lmsqreg, then I am plotting the experimental values on top.\neg.</p>\n\n<hr>\n\n<pre><code>#reference data\n\nmale.weight &lt;- lmsqreg.fit(log(males$heart),\n                           log(males$weight),\n                           pvec = (centiles &lt;- c(0.03, 0.1, 0.5, 0.9, 0.97)),\n                           lam.fixed=1)\n\n\nplot(log(males$weight),log(males$heart),\n     axes=FALSE,\n     frame.plot=TRUE,\n     xlab=\"Weight (kg)\",\n     ylab=\"Heart weight (g)\",\n     main=\"Men\", \n     col = \"white\",\n     xlim = c(3.2,5.2),\n     ylim = c(4.7, 7))\n\naxis(1,at=log(xat &lt;- c(3,5,7,9,11,13,15,17,19)*10),\n     labels=xat)\n\naxis(2,at=log(yat &lt;- (1.5:10)*100),labels=yat)\n\nlpars &lt;- list(lty=rep(c(2,1,2),\n                      c(2,1,2)),\n              col=c(\"#444444\",\"#999999\",\"#000000\")\n              [c(1,2,3,2,1)])\n\nfor(l in 1:nrow(male.weight$qsys$outmat) ){\n  lines(male.weight$qsys$targetx,\n        male.weight$qsys$outmat[l,],\n        lty=lpars$lty[l],col=lpars$col[l])\n\n}\n\n\n\n #experimental data\n\n\npoints(log(m.heart$weight[m.heart$cod.g == \"nCA\"]),\n       log(m.heart$heart.w[m.heart$cod.g == \"nCA\"]),\n       pch = 21, col = \"black\")\n\npoints(log(m.heart$weight[m.heart$cod.g == \"CA\"]),\n       log(m.heart$heart.w[m.heart$cod.g == \"CA\"]),\n       pch = \"♥\", col = \"red\")\n</code></pre>\n\n<hr>\n\n<p>What I would like to find out is what percentage of <code>m.heart$weight[m.heart$cod.g == \"nCA\"]</code> (experimental data) lies above the 0.9 and the 0.97 centile. Something similar might have been answered elsewhere, but as I am not familiar with the nomenclature for this area, I am not sure what am I supposed to search for.</p>\n\n<p>Thanks in advance,</p>\n\n<p>Lola</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":15,"view_count":177,"score":-12,"question_id":11625517,"title":"Where to look for the documentation of function `t` of R?","body":"<pre><code>ggimage (t(img[,2:1]), fullpage = TRUE, scale_axes = FALSE) \n</code></pre>\n\n<p>Now I couldn't find any documentation for <code>t</code> in Google, I can't understand what happens by <code>[,2:1]</code>.</p>\n\n<p>The <code>ggmaps</code> <a href=\"http://cran.r-project.org/web/packages/ggmap/ggmap.pdf\" rel=\"nofollow\">documentation</a> doesn't have an explanation for <code>t</code>.</p>\n\n<p>Where should I find the documentation for one letter functions like <code>t</code> which aren't searchable in Google?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12880433,"title":"Conditional creation of Variable using R","body":"<p>I'm trying to create a new var \"PERIOD\" based on dates. The sample data is given below:</p>\n\n<pre><code>Date\n1/10/2012\n1/11/2012\n1/12/2012\n1/13/2012\n1/14/2012\n1/15/2012\n1/16/2012\n1/17/2012\n1/18/2012\n</code></pre>\n\n<p>After conditioning the new dataset looks like:</p>\n\n<pre><code>  Date      PERIOD\n1/10/2012     Y1\n1/11/2012     Y1\n1/12/2012     Y1\n1/13/2012     Y1\n1/14/2012     Y1\n1/15/2012     Y2\n1/16/2012     Y2\n1/17/2012     Y2\n1/18/2012     Y2\n</code></pre>\n\n<p>The code I was using is </p>\n\n<pre><code>dat$PERIOD&lt;-{If '1/10/2012' &lt;=  as.Date(dat$Date) &lt;= '1/14/2012' dat$PERIOD='Y1' else\n    If '1/15/2012' &lt;=  as.Date(dat$Date) &lt;= '1/18/2012'dat$PERIOD='Y2'\n}\n</code></pre>\n\n<p>But I'm getting error:</p>\n\n<pre><code>Error: unexpected string constant in dat$PERIOD&lt;-{If '1/10/2012'\n</code></pre>\n\n<p>Thank you. Regards,</p>\n"},{"tags":["c++","windows","r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12802723,"title":"\"comm: file 1 is not in sorted order\" when compiling R source in Windows","body":"<p>While compiling R source 2.15.1 in Windows 7, I get following error.</p>\n\n<blockquote>\n  <p>comm: file 1 is not in sorted order </p>\n  \n  <p>make[3]: <em>*</em> [R.dll] Error 1</p>\n  \n  <p>make[2]: <em>*</em> [../../bin/i386/R.dll] Error 2 </p>\n  \n  <p>make[1]: <em>*</em> [rbuild]</p>\n  \n  <p>Error 2 make: <em>*</em> [all] Error 2</p>\n</blockquote>\n\n<p>Basically I installed Rtools 2.15.1 before compiling the source with \"make all recommended\". Do I have to install any other software? I tried other OS such as windows 7, windows 2008, XP and results were consistent.</p>\n"},{"tags":["python","r","syntax","programming-languages"],"answer_count":1,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":100,"score":3,"question_id":12879412,"title":"Comparison of Python and R vocabularies","body":"<p>I was searching for language comparisons of R and Python and come across a comparison of vocabularies for R and JuliaLang. This is similar to what I was looking except for a different language.</p>\n\n<p><a href=\"http://www.johnmyleswhite.com/notebook/2012/04/09/comparing-julia-and-rs-vocabularies/\" rel=\"nofollow\">Comparing R and JuliaLang vocabularies</a></p>\n\n<p>Does anyone know if there is a similar comparison for R and Python? In this cheat-sheat like format.</p>\n\n<p>Thanks.</p>\n"},{"tags":["r","loops","automation","statistics"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12879218,"title":"How to automatise Kolmogorov - Smirnoff tests using R?","body":"<p>It's possible to automatise this (using a loop, a function or something)? Currently I'm doing all the work \"manually\" (in other words, step by step), and it's very annoying for me. I use kstest().</p>\n\n<p>Consider the null hypothesis H0 : X ∼ N(0, 1).</p>\n\n<p>For diﬀerent values of µ (for instance µ = 0, 0.25, 0.50, 0.75, 1,) and for diﬀerent values of n (for instance n = 25, 50, 100), do the following steps:</p>\n\n<ul>\n<li>Generate 1000 samples from N(µ, 1).</li>\n<li>For each sample, test the hypothesis H0 : X ∼ N(0, 1).</li>\n<li>Obtain the frequency of rejections in each case.</li>\n<li>Check that the level is well approximated when the null hypothesis is true\n(example, take α = 0.10, 0.05, 0.01).</li>\n</ul>\n\n<p>Thank you so much.</p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":103,"score":5,"question_id":12876820,"title":"gsub and pad inside of a parenthesis","body":"<p>I have  vector like this:</p>\n\n<pre><code>x &lt;- c(\"20(0.23)\", \"15(0.2)\", \"16(0.09)\")\n</code></pre>\n\n<p>and I don't want to mess with the numbers on the outside of the parenthesis but want to remove the leading zero on the numbers inside and make everything have 2 digits.  The output will look like:</p>\n\n<pre><code>\"20(.23)\", \"15(.20)\", \"16(.09)\"\n</code></pre>\n\n<p><strong>Useful information:</strong></p>\n\n<p>I can remove leading zero and retain 2 digits using the function below taken from: <a href=\"http://stackoverflow.com/questions/12643391/how-to-remove-leading-0-in-a-numeric-r-variable\">LINK</a></p>\n\n<pre><code>numformat &lt;- function(val) { sub(\"^(-?)0.\", \"\\\\1.\", sprintf(\"%.2f\", val)) }\n\nnumformat(c(0.2, 0.26))\n#[1] \".20\" \".26\"\n</code></pre>\n\n<p>I know <code>gsub</code> can be used but I don't know how.  I'll provide a <code>strsplit</code> answer but that's hackish at best.</p>\n"}]}
{"total":19203,"page":16,"pagesize":100,"questions":[{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":2,"view_count":108,"score":1,"question_id":12878688,"title":"ggplot2 clustering in R","body":"<p><img src=\"http://i.stack.imgur.com/JHgex.jpg\" alt=\"\"></p>\n\n<p>can someone point me in the right direction to making a plot like this one w/ ggplot2? even just the function type.</p>\n\n<p>I've been looking around in ggplot2 and can't find anything like this.</p>\n"},{"tags":["r","ggplot2","bubble-chart"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":12830160,"title":"How do I change the colour of an outline in a ggplot bubble plot?","body":"<p>I am putting together a bubble chart in ggplot2, and want to change the outline of my bubbles (to comply with work's formatting guidelines). My problem is that I'm using colors to group variables, and I'm using a custom palette (again, for work). Ideally, I'd like to put black borders on the bubbles. </p>\n\n<p>Here's my data-frame:</p>\n\n<pre><code>mmur &lt;- structure(list(Medgrowth = c(-1.02232983588915, 3.01155115511551,-0.220617729642996, 1.96506550218342, 0.943970767356888, 0.810810810810807,0.0166694449074782, 0.21064457239153, 0.0876731544801004, 0.132216835610393,0.370644922164558,0.23378141437756, 1.27810650887574, 0.42301184433164,0.394880174291941, 0.54216172568924, 1.32690882134916, 0.499722376457527,-0.108885017421599), Medunemp = c(4.430550475, 2.5060469975,4.1239796475, 2.0585977455, 3.846659243, 3.1792594425, 4.0033450105,6.0882984255, 3.091889808,3.7462810695, 2.4038147815, 3.0065393475,2.3331894185, 4.9482480125, 2.0955470885, 1.616694725, 1.873037069,3.060170157, 3.0131425595), Empsize = c(324.2,270.6, 962.1,149, 962.4, 421.1, 1197.8, 777.8, 552.8, 234.8, 421.1, 203.2,915.7, 396.1, 685.9, 904.5, 1366.9, 215.4, 440.5), Eduratio = c(0.1,0.2, 0.1, 0.2, 0.1, 0.2, 0.1, 0.1, 0.1, 0.3, 0.3, 0.2, 0.5, 0.2,0.3, 0.6, 0.4, 0.2, 0.1), Names = structure(c(3L, 12L, 11L, 7L,5L, 19L, 17L, 1L, 18L, 10L, 8L, 16L, 14L, 2L, 15L, 6L, 9L, 4L,13L), .Label = c(\"Accom\", \"Admin\",\"Agric\", \"Arts.\", \"Const\",\"Educa\", \"Elect\", \"Finan\", \"Healt\",\"Infor\",\"Manuf\",\"Minin\",\"Other\", \"Profe\", \"Publi\", \"Renta\", \"Retai\", \"Trans\", \"Whole\"), class = \"factor\"), colour1 = structure(c(6L, 5L, 6L, 5L, 6L,5L, 6L, 6L, 6L, 4L, 4L, 5L, 2L, 5L, 4L, 1L, 3L, 5L, 6L), .Label = c(\"#8C2D04\",\"#CC4C02\", \"#EC7014\", \"#FE9929\",\"#FEC44F\", \"#FEE391\"), class = \"factor\")), .Names = c(\"Medgrowth\",\"Medunemp\", \"Empsize\", \"Eduratio\", \"Names\", \"colour1\"), row.names = c(\"Agric\",\"Minin\", \"Manuf\", \"Elect\", \"Const\", \"Whole\", \"Retai\", \"Accom\",\"Trans\", \"Infor\", \"Finan\", \"Renta\", \"Profe\", \"Admin\", \"Publi\",\"Educa\", \"Healt\", \"Arts.\", \"Other\"), class = \"data.frame\")\n</code></pre>\n\n<p>And here's my plot code:</p>\n\n<pre><code>bbubc1 &lt;- ggplot(mmur, aes(x = Medgrowth, y = Medunemp, size = Empsize, label = Names, colour = colour1)) +\n    geom_point() + \n    scale_size(range = c(5, sqrt(max(mmur$Empsize)/min(mmur$Empsize)*5^2)), name = \"Employment in\\n2012 (thousands)\") +\n    geom_text(size = 4, colour = \"black\", vjust = -1) + \n    scale_colour_manual(values = levels(mmur$colour1), name = \"Per cent with\\ntertiary degree\", label = c(60, 50, 40, 30, 20, 10)) + \n    xlab(\"Median employment growth rate 2001 - 2012\") +\n    ylab(\"Median unemployment rate 2001 - 2012\") + \n    opts(axis.text.x=theme_text(angle=0, hjust=0, size = 16)) + \n    opts(axis.text.y=theme_text(angle=0, hjust=0, size = 16)) +\n    opts(axis.title.x=theme_text(size = 16)) + \n    opts(legend.title = theme_text(size = 16)) + \n    opts(axis.title.y=theme_text(size = 16, angle = 90)) + \n    geom_vline(colour = I(\"grey\")) + \n    geom_hline(colour = I(\"grey\")) + \n    ylim(c(0,7))\n</code></pre>\n\n<p>The plot is here:\n<img src=\"http://i.stack.imgur.com/qQAUC.png\" alt=\"The plot I want to edit\"></p>\n"},{"tags":["r","rmysql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":282,"score":0,"question_id":10270616,"title":"installing RMySQL gives error RS-MySQL.h:32:19: fatal error: mysql.h: No such file","body":"<p>I tried to install the RMySQL-library (R version 2.14.2, WinXP on 32bit)\nbut got the following error message:</p>\n\n<pre><code>install.packages(\"D:/R/library/RMySQL_0.9-3.tar.gz\",repos=NULL, type=\"source\")\n</code></pre>\n\n<p>...</p>\n\n<pre><code>RS-MySQL.h:32:19: fatal error: mysql.h: No such file or directory\ncompilation terminated.\nmake: *** [RS-MySQL.o] Error 1\nERROR: compilation failed for package 'RMySQL'\n* removing 'C:/Dokumente und Einstellungen/Giordano/R/win-library/2.14/RMySQL'\nWarning message:\nIn install.packages(\"D:/R/library/RMySQL_0.9-3.tar.gz\", repos = NULL,  :\n  installation of package 'D:/R/library/RMySQL_0.9-3.tar.gz' had non-zero exit status\n</code></pre>\n\n<p>This is only a part of the output which contains the error message. I do not understand this message and maybe somebode can give me some advices.\nThanks for help.\ngiordano. </p>\n"},{"tags":["r","heatmap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12877306,"title":"R remove borders of pheatmap","body":"<p>I found the <a href=\"http://cran.r-project.org/web/packages/pheatmap/index.html\" rel=\"nofollow\">pheatmap (pretty heatmap)</a> package a really nice and easy way to produce heatmaps. In addition to normal <code>heatmap()</code> command, it produces a color bar representing which quantity is behind each color, and also does not have unwanted details of <code>heatmap.2</code>. </p>\n\n<p>There is a thin border between rows and columns. No problem for low number of rows, but for higher number of rows these borders make the heatmap not so nice. Is there any solution to remove them?</p>\n\n<p>According to the manual, the <code>border_color=NA</code> should remove it, however when I create a PDF file from the output, still there exist thin borders between the rows and columns.</p>\n"},{"tags":["r","api","data"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":91,"score":1,"question_id":12874047,"title":"Yahoo Finance Data out of date","body":"<p>I'm fetching historic data from Yahoo finance in R using getYahooData from the TTR package. Most of the data I'm getting, however, does not include the last few days of trading - For example I'm getting the most recent day as 24/09/12 today on all but one ticker (which is up to date, JMAT.L)</p>\n\n<p>Does anyone have a data source or a fetch method that'll get me some up to date data?</p>\n\n<p>Thanks.</p>\n"},{"tags":["r","roxygen","roxygen2","oai"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12251530,"title":"Best practice for package creation when importing packages with functions of same name","body":"<p>I am creating a package called rmetadata <a href=\"https://github.com/ropensci/rmetadata\" rel=\"nofollow\">here</a>. The purpose of the package is to make requests to the <a href=\"http://www.openarchives.org/OAI/openarchivesprotocol.html\" rel=\"nofollow\">OAI-PMH</a> services of many data sources on scholarly publications/metadata. I wrote other packages (rpmc, rdatacite, etc.) that have functions named the same thing to be consistent as they do the same thing in each package, but for different data sources. </p>\n\n<p>On installing rmetadata </p>\n\n<pre><code>install_github('rmetadata', 'ropensci')\nlibrary(rmetadata)\n</code></pre>\n\n<p>I get many warnings like</p>\n\n<pre><code>Warning: replacing previous import 'identify' when loading 'rdryad'\nWarning: replacing previous import 'listidentifiers' when loading 'rdryad'\nWarning: replacing previous import 'listmetadataformats' when loading 'rdryad'\n</code></pre>\n\n<p>What should I do?  Should I rename the functions within each of the packages that rmetadata calls? e.g., identify becomes dryad_identify in rdryad, and identify becomes datacite_identify in rdatacite. </p>\n\n<p>Or something else?</p>\n"},{"tags":["r","missing-data","factorization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12876846,"title":"Doing NMF in R with missing values (NA) in the matrix","body":"<p>I am looking for a package/if-possible-relatively-off-the-shelf solution for NMF (non-negative matrix factorization) in R, that can handle missing values (NA) and not consider them as 0. </p>\n\n<p>The goal is in fact to estimate these missing values through the product of the factorization,\nfor a simple recommender system. </p>\n\n<p>The NMF CRAN-package is great, but doesn't seems able to do that (neither can its much more recent continuation off-CRAN), and I couldn't find suitable alternative packages...</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":12876501,"title":"R ggplot2: Labelling a horizontal line on the y axis with a numeric value","body":"<p>I have a horizontal line in a ggplot and I would like to label it's value (7.1) on the y axis.</p>\n\n<pre><code>library(ggplot2)\ndf &lt;- data.frame(y=c(1:10),x=c(1:10))\nh &lt;- 7.1\nplot1 &lt;- ggplot(df, aes(x=x,y=y)) + geom_point() \nplot2 &lt;- plot1+ geom_hline(aes(yintercept=h))\n</code></pre>\n\n<p>Thank you for your help.</p>\n"},{"tags":["r","time","regression"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":12874928,"title":"Sample regression, x = months, huge bandwidths","body":"<p>I have two vectors, <code>x</code> and <code>y</code>.</p>\n\n<p><code>x</code> is a vector where each entry represents a month for a period of several years, so I have (let's say) 10 years of data, then <code>length(x) = 120</code> and so on. \n(I have used the \"posix.ct\" command so they really are \"months\" in that sense, but couldn't I just have <code>x</code> as a numerical vector like <code>c(1:n)</code> or something, since I already know which month and which year a certain element of <code>c(1:n)</code> corresponds to? i.e if <code>x = c(1:n)</code>, I know that <code>x[13]</code> is february of the second year and so on..)</p>\n\n<p>y is a vector where each elements is an observation of a particular variable at a certain month. \nSo the observed data is grouped like this (january,0.123), (february,2.125) and so on.\nI have two vectors for the months;</p>\n\n<pre><code>x1 = seq(as.POSIXct(\"YYYY-MM-DD\", tz=\"GMT\"),\n       as.POSIXct(\"YYYY-MM-DD\", tz=\"GMT\"),\n       by=\"month\")\nx2 = c(1:length(x1)) \n</code></pre>\n\n<p>What I want to do is to run ksmooth:</p>\n\n<pre><code>plot(x1,y)\nsmooth = ksmooth(x2,y,\"normal\")     \nlines(smooth)\n</code></pre>\n\n<p>The reason that I use x1 in the plot() command is that I don't know how to otherwise get the x-axis in time.</p>\n\n<p>R should automatically find a decent smoothing parameter when I haven't specified anything. The result is that ksmooth$y is equal to the input vector y! Also, a vertical bar is produced in the plot. If I replace <code>x2</code> by <code>x1</code> in the code above, <code>ksmooth$y</code> is NA for all values except for the first and last, which equal those of the input <code>y</code>.  </p>\n\n<p>So i try some bandwidths:\n<code>h = 0.1</code>: now <code>smooth$y = y</code>, as before. A vertical bar is produced (it is the same color as I specified in the <code>lines()</code> command, so it must have to do with the <code>ksmooth</code> command.)\n<code>h = 10</code>: get some non-strange results for smooth$y, however, a vertical bar is produced as before.</p>\n\n<p>Then, I tried the crazy idea of very large bandwidths;\n<code>h = 1e+06</code>: This produced nothing when I used <code>x1</code> and <code>x2</code> as in the code above. When I changed <code>x2</code> to <code>x1</code> however, I get some good results. For <code>h = 1e+09</code> (that's huge!!) I get a very nice result. (I get a curve that fits the data and looks nice)\nBut <code>h = 1e+09</code>, is that reasonable? in all the examples I have looked h is something betweeen 0.1 and 10, give or take. heard something about a rule of thumb: h should equal n^(-1/5) where n is the number of data points.</p>\n"},{"tags":["forms","r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":12875012,"title":"Populating an HTML dropdown box with an R vector","body":"<p>I am playing around with Rook and googleVis in an attempt to\nproduce some interactive charts</p>\n\n<p>I currently have an HTML text box where users can input a date to trigger changes</p>\n\n<pre><code>res &lt;- Rook::Response$new()\nres$write('&lt;input type=\"text\" name=\"theDate\"&gt;')\n</code></pre>\n\n<p>I want to replace this with a combobox</p>\n\n<pre><code>res$write('&lt;input type=\"dropdown\" name=\"theDate\"&gt;')\n</code></pre>\n\n<p>populated by an R vector similar to this</p>\n\n<pre><code>displayDates &lt;- c(\"12 Mar 1980\" ,\"19 Mar 1980\")\n</code></pre>\n\n<p>It is like a decade since I have done any of this HTML stuff and I'm\nalso just beginning with Rook</p>\n"},{"tags":["r","reshape"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12871229,"title":"From rows to a single column","body":"<p>There are many files for which data is in the following form </p>\n\n<pre><code>year Jan Feb Mar ...........Dec\n1990 x1  x2   x3           x12    \n1991 y1  y2   y3           y12\n</code></pre>\n\n<p>.\n. </p>\n\n<pre><code>2000 z1 z2 z3             z12\n</code></pre>\n\n<p>I want to transpose each of the rows and stack them as a column to get the time series as </p>\n\n<pre><code>x1\nx2\n\n\n..\nx12\ny1\ny2\n..\ny12\nz1\n.\n.\nz12\n</code></pre>\n\n<p>I have looked at the reshape package but not clear as to how it will apply in this problem.\nAny ideas for doing this in R ?</p>\n"},{"tags":["r","list","data.frame"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":80,"score":2,"question_id":12875716,"title":"list of lists with different lengths to data.frame in R","body":"<p>I have read many answers in SO about converting list of lists to df. But, I have noticed that they all have the length of lists (within the main big list) to be the same. I have a different case:</p>\n\n<pre><code>h1 &lt;- list(USA = c(10,13,17,11), RUSSIA = NULL, BRAZIL = NULL,\n  CHINA = c(11,11,10,8,12), TAIWAN = c(12,9,9,11,9,12,14), CHILE = NULL)\n</code></pre>\n\n<p>I want to convert the above list <code>h1</code> to a data.frame. My expected output should be a data.frame that has 2 columns - country_name, list. Something like this:</p>\n\n<pre><code>country_name, list\nUSA    [10, 13, 17, 11]\nRUSSIA NULL\nBRAZIL NULL\nCHINA  [11, 11, 10, 8, 12]\nTAIWAN [12, 9, 9, 11, 9, 12, 14]\nCHILE  NULL\n</code></pre>\n\n<p>I did the follwing, but, did not work:</p>\n\n<pre><code>do.call(rbind, h1)\n</code></pre>\n\n<p>It tries to keep the column numbers same across all the rows. I do not want that. I want to see how I can use ldply to such cases. Any suggestion is appreciated.</p>\n"},{"tags":["r","igraph"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":12874431,"title":"Import weighted edgelist using igraph","body":"<p>I have the following txt file representing a network in edgelist format.</p>\n\n<p>The first two columns represent the usual: which node is connected to which other nodes</p>\n\n<p>The third column represents weights, representing the number of times each node has contacted the other.</p>\n\n<p>I have searched the <code>igraph</code> documentation but there's no mention of how to include an argument for weight when importing standard file formats like txt.</p>\n\n<p>The file can be accessed from <a href=\"https://dl.dropbox.com/u/22681355/OClinks_w.txt\" rel=\"nofollow\">here</a> and this is the code I've been using:</p>\n\n<pre><code>read.graph(\"Irvine/OClinks_w.txt\", format=\"edgelist\")\n</code></pre>\n\n<p>This code treats the third column as something other than weight.</p>\n\n<p>Does anyone know the solution?</p>\n"},{"tags":["r","data","frame"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12717248,"title":"Data frame linear fit","body":"<p>This is perhaps a simple question, but I am n00b. Say I have a data frame with a bunch of columns. I need to call lm function over the column 1 and 2, 1 and 3, and so on. So basically I need to loop over all columns and store the results of the fit as I build the model. The problem I am running into is that:</p>\n\n<pre><code>lm(df[1]~df[2], data = df) #doesnt work. In this case df is the data frame object \n                           #and df[1] is the first column. \n</code></pre>\n\n<p>What is a good way to do this in a loop, as in access the columns of <code>df</code> in an iterative fashion?</p>\n\n<p>Thanks.</p>\n"},{"tags":["r","spatial"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":75,"score":2,"question_id":12873591,"title":"Overplotting two SpatialPolygonsDataFrames with spplot","body":"<p>I have a bunch of data which I've plotted at the county level, <a href=\"http://stackoverflow.com/questions/12682212/how-to-get-spplot-lattice-to-not-draw-borders-around-polygons\">without borders</a>.  I'd like to add in state boundaries.  I have a state shapefile (polygons), but <code>spplot</code> doesn't seem to have any way to add on top of the previous map.  Is there any way to do this without rewriting the panel function to take two SPDFs (which seems pretty specialized for what is likely a problem other people have)?</p>\n\n<p>Here's a reproducible example:</p>\n\n<pre><code>library(sp)\nSrs1 = Polygons(list(Polygon(cbind(c(2,4,4,1,2),c(2,3,5,4,2)))), \"s1\")\nSrs2 = Polygons(list(Polygon(cbind(c(5,4,2,5),c(2,3,2,2)))), \"s2\")\n\ncounty &lt;- SpatialPolygonsDataFrame( SpatialPolygons(list(Srs1,Srs2)), \n                                  data.frame( z=1:2, row.names=c(\"s1\",\"s2\") ) )\n\nSrsA &lt;- Polygons(list(Polygon(cbind(c(3,5,5,1,3),c(3,4,6,5,3)))),\"sA\")\nstate &lt;- SpatialPolygonsDataFrame( SpatialPolygons(list(SrsA)),\n                                  data.frame( z=1,row.names=\"sA\" ))\n\nspplot( county, zcol=\"z\",col=NA )\nspplot( state, add=TRUE ) # Note the add=TRUE does nothing here, but that's the spirit of what I want to accomplish\n</code></pre>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12873770,"title":"Creating an STID object in R","body":"<p>I'm trying to write an STIDF object, but struggling with the STIDF function from the spacetime package.\nThe line beginning \"bigfoot.stidf\" is where I have problems. With this version, I get:</p>\n\n<pre><code>Error in [.default`(data, o, , drop = FALSE) : \n  incorrect number of dimensions\n</code></pre>\n\n<p>The data set is from the plotKML package.</p>\n\n<pre><code>library(plotKML)\ndata(bigfoot)\nbigfoot.sp &lt;- SpatialPointsDataFrame(bigfoot[,c('Lon', 'Lat')], data=bigfoot,proj4string=CRS('+proj=longlat +datum=WGS84'))\nplotKML(bigfoot.sp, kmz=FALSE)\nbigfoot.stidf &lt;-STIDF(bigfoot.sp, time = bigfoot$DATE, data = bigfoot$NAMES)\nplotKML(bigfoot.stidf,KMZ=FALSE)\n</code></pre>\n\n<p>Can anyone help with how to create this STIDF object?</p>\n\n<p>I want to show the positions of reports changing with time in Google earth.</p>\n"},{"tags":["mysql","r","utf-8","character-encoding","odbc"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":104,"score":3,"question_id":12869778,"title":"Fetching UTF-8 text from MySQL in R returns \"????\"","body":"<p>I'm stuck trying to fetch UTF-8 text in a MySQL database from R.  I'm running R on OS X (tried both via the GUI and command line), where the default locale is en_US.UTF-8, and no matter what I try, the query result shows \"?\" for all non-ASCII characters.</p>\n\n<p>I've tried setting <code>options(encoding='UTF-8')</code>, <code>DBMSencoding='UTF-8'</code> when connecting via ODBC, setting <code>Encoding(res$str) &lt;- 'UTF-8'</code> after fetching the results, as well as 'utf8' variants of each of those, all to no avail.  Running the query from the command line mysql client shows the results correctly.</p>\n\n<p>I'm totally stumped.  Any ideas why it's not working, or other things I should try?</p>\n\n<p>Here's a fairly minimal test case:</p>\n\n<pre><code>$ mysql -u root\nmysql&gt; CREATE DATABASE test;\nmysql&gt; USE test;\nmysql&gt; CREATE TABLE test (str VARCHAR(10)) ENGINE=InnoDB DEFAULT CHARSET=utf8;\nQuery OK, 0 rows affected (0.02 sec)\n\nmysql&gt; INSERT INTO test (str) VALUES ('こんにちは');\nQuery OK, 1 row affected (0.00 sec)\n\nmysql&gt; select * from test;\n+-----------------+\n| str             |\n+-----------------+\n| こんにちは      |\n+-----------------+\n1 row in set (0.00 sec)\n</code></pre>\n\n<p>Querying the table in R using both RODBC and RMySQL shows \"?????\" for the str column:</p>\n\n<pre><code>&gt; con &lt;- odbcDriverConnect('DRIVER=mysql;user=root', DBMSencoding='UTF-8')\n&gt; sqlQuery(con, 'SELECT * FROM rtest.test')\n    str\n1 ?????\n&gt; library(RMySQL)\nLoading required package: DBI\n&gt; con &lt;- dbConnect(MySQL(), user='root')\n&gt; dbGetQuery(con, 'SELECT * FROM rtest.test')\n    str\n1 ?????\n</code></pre>\n\n<p>For completeness, here's my sessionInfo:</p>\n\n<pre><code>&gt; sessionInfo()\nR version 2.15.1 (2012-06-22)\nPlatform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] RMySQL_0.9-3 DBI_0.2-5    RODBC_1.3-6 \n</code></pre>\n"},{"tags":["r","plot","knitr"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":68,"score":3,"question_id":12849755,"title":"utf8 in plot labels using knitr","body":"<p>Can't compile the following Rnw document into pdf using knitr</p>\n\n<pre><code>\\documentclass{article}\n\\usepackage[utf8]{inputenc}\n\\usepackage[russian]{babel}\n\\begin{document}\n\n&lt;&lt;&gt;&gt;=\nhist(rnorm(100),main=\"Гистограмма\")\n@\n\n\\end{document}\n</code></pre>\n\n<p>With labels in English everything is ok.</p>\n\n<hr>\n\n<p>Edit 1:\nNow i have two versions of pdf. In <a href=\"https://github.com/bdemeshev/em301/raw/master/russian_labels_knitr/f.pdf\" rel=\"nofollow\">the first one</a> letters are replaced by points. </p>\n\n<p>In <a href=\"https://github.com/bdemeshev/em301/raw/master/russian_labels_knitr/ff.pdf\" rel=\"nofollow\">the second one</a> all letters are overlapped. The second one is produced using addtional code chunk</p>\n\n<pre><code>&lt;&lt;&gt;&gt;=\npdf.options(encoding = \"CP1251\")\n@\n</code></pre>\n\n<p>I am using Ubuntu 12.04 + R 2.14 + Texlive. </p>\n\n<hr>\n\n<p>Edit 2:</p>\n\n<p>For the moment i've found the following partial solution:</p>\n\n<pre><code>&lt;&lt;&gt;&gt;=\ncairo_pdf(\"figure.pdf\")\nhist(rnorm(100),main=\"Гистограмма\")\ndev.off()\n@\n\\includegraphics{figure.pdf}\n</code></pre>\n\n<hr>\n\n<p>Edit 3:</p>\n\n<p>Using the following code:</p>\n\n<pre><code>\\documentclass{article}\n\\usepackage[utf8]{inputenc}\n\\usepackage[russian]{babel}\n\\begin{document}\n\n&lt;&lt;dev='cairo_pdf'&gt;&gt;=\nhist(rnorm(100),main=\"Гистограмма\")\n@\n\n\\end{document}\n</code></pre>\n\n<p>I obtain a CORRECT histogram, with a <a href=\"https://github.com/bdemeshev/em301/raw/master/russian_labels_knitr/fff.pdf\" rel=\"nofollow\">lot of WARNINGS</a>. How to avoid or at least suppress them?</p>\n\n<hr>\n\n<p>Finally! Ura!</p>\n\n<pre><code>\\documentclass{article}\n\\usepackage[utf8]{inputenc}\n\\usepackage[russian]{babel}\n\\begin{document}\n\n&lt;&lt;dev='cairo_pdf',warning=FALSE&gt;&gt;=\nhist(rnorm(100),main=\"Гистограмма\")\n@\n\n\\end{document}\n</code></pre>\n\n<p>Could i avoid warnings? Can someone explain me all that stuff with encodings and warnings?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12559813,"title":"Default sizing of R console window upon opening it","body":"<p>When I open my default RGui (not R Studio or anything fancy), there will be a full-screen grey RGui window and a tiny white \"R Console\". How do I</p>\n\n<p><strong>a)</strong> Make it such that the \"R Console\" is maximized upon opening RGui.</p>\n\n<p><strong>b)</strong> Make it such that when I open RGui, it takes up a proportion of my full screen instead of my entire screen.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":12869730,"title":"if else statement gone bad","body":"<p>I get an error message when running this, is there anything that is blatently obvious to anyone?      </p>\n\n<pre><code> yo &lt;-  function(x) {\n\n      filt &lt;- ddply(x, .(primer,day), summarise, count=sum(timepoints==0)) # this will tell you all primers that have a 0 hr time point by giveing a 1 in the count column\n\n\n\n if (any(filt$count) == 0)     { # this was the case once so I implemented this if else part\n\n      filt &lt;- filt[filt$count == 0,]\n      include &lt;-!(x$primer%in%filt$primer)&amp;(x$day%in%filt$day) # all primers that have 0 hrs\n      x &lt;- x[include,] \n     ### for any given replicate, divide each timepoint by its zero hour \n     x &lt;- ddply(x, .(primer),transform, foldInduction=realConc/realConc[timepoints==0])\n\n}\n\n\n  else {\nx &lt;- ddply(x, .(primer), transform, foldInduction=realConc/realConc[timepoints==0])\n   }\n  x[,-9]\n\n  } \n</code></pre>\n"},{"tags":["perl","r","regression"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":12864939,"title":"Extracting regression tree models built with R rpart","body":"<p>I've built several regression tree models using the rpart package in R and I need to migrate them into another language such as Perl.  </p>\n\n<p>The predict function works fine within R, but is there a way to print out something like the weighted formula at each node?</p>\n\n<p>Thank you,</p>\n\n<p>Rich</p>\n"},{"tags":["eclipse","r","ubuntu","plugins","statet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12861455,"title":"Error:Cannot compile a simple JNI program","body":"<p>When I tried to run r console in eclipse,got this error:</p>\n\n<pre><code>....Please make sure that R package 'rj' (1.1 or compatible) is installed...\n</code></pre>\n\n<p>So I tried to intall in R console like this:</p>\n\n<pre><code>install.packages(c(\"rj\", \"rj.gd\"), repos=\"http://download.walware.de/rj-1.1\")\n</code></pre>\n\n<p>got this error:</p>\n\n<pre><code>checking whether Java interpreter works... checking whether JNI programs can be compiled... configure: error:             Cannot compile a simple JNI program. See config.log for details.configure: error: ./configure failed for jri ERROR: configuration failed for package ‘rj’\n</code></pre>\n\n<p>by the way,my configuration is:ubntu 11.10 64bit+eclipse 3.7,and I have followed this post: <a href=\"http://www.twm-kd.com/linux/install-oracle-java-sdk-in-ubuntu-11-10/\" rel=\"nofollow\">http://www.twm-kd.com/linux/install-oracle-java-sdk-in-ubuntu-11-10/</a> to install oracle-1.7.0-jdk,then run: \"sudo R CMD javareconf\",got:</p>\n\n<pre><code>Java interpreter : /usr/bin/java\nJava version     : 1.7.0\nJava home path   : /usr/lib/jvm/java-7-oracle/jre\nJava compiler    : /usr/bin/javac\nJava headers gen.: /usr/bin/javah\nJava archive tool: /usr/bin/jar\nJava library path: :/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib\nJNI linker flags : -L -L/usr/java/packages/lib/amd64 -L/usr/lib64 -L/lib64 -L/lib -L/usr/lib -ljvm\nJNI cpp flags    : -I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux\nUpdating Java configuration in /etc/R\nDone.\n</code></pre>\n\n<h2>session info</h2>\n\n<pre><code>R version 2.13.1 (2011-07-08)\nPlatform: x86_64-pc-linux-gnu (64-bit)\n\nlocale:\n[1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n[3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n[5] LC_MONETARY=C              LC_MESSAGES=en_US.UTF-8   \n[7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n[9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base \n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":115,"score":0,"question_id":12866189,"title":"calculating the outliers in R","body":"<p>I have a data frame like this:</p>\n\n<p>x</p>\n\n<pre><code>Team 01/01/2012  01/02/2012  01/03/2012  01/01/2012 01/04/2012 SD Mean\nA     100         50           40        NA         30       60  80\n</code></pre>\n\n<p>I like to perform calculation on each cell to the mean and sd to calculate the outliers. For example,</p>\n\n<pre><code>abs(x-Mean) &gt; 3*SD\n</code></pre>\n\n<p><code>x$count&lt;-c(1)</code> (increment this value if the above condition is met).</p>\n\n<p>I am doing this to check the anomaly in my data set. If I know the column names, it would be easier to do the calculations, but number of columns will vary. Some cells may have NA in them. </p>\n\n<p>I like to subtrack mean from each cell, and I tried this</p>\n\n<pre><code>x$diff&lt;-sweep(x, 1, x$Mean, FUN='-')\n</code></pre>\n\n<p>does not seem to be working, any ideas?</p>\n"},{"tags":["arrays","r","matrix","data.frame"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":105,"score":2,"question_id":12866418,"title":"How to loop through an array in pairs?","body":"<p>I have a 1000x1 vector (1000 rows and 1 column). I want to get elements in pairs (row 1 and row 2, row 3 and row 4, row 5 and row 6, etc.)</p>\n\n<p>Here's what I have so far</p>\n\n<pre><code>for (j in 1: ncol(total_loci)){\n    for (i in 1: sample_size){\n    # a pair\n    genotype[i]&lt;- paste(total_loci[i, j], total_loci[i+1,j], sep=\"\")\n    }\n}\n</code></pre>\n\n<p>Genotype should thus be a 500x1 vector (500 rows and 1 column) containing the genotype. Assume that my for-loops are correct. I think my I needs to skip every other index -- so my <code>i</code> should start at 1 then 3, 5, 7, 9, etc. The variable <code>total_loci</code> is of class data frame.</p>\n"},{"tags":["r","grouping","sas","anova"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":87,"score":3,"question_id":12863547,"title":"To get grouped results in R","body":"<p>Here I have like below data set.\nIn SAS system, to get grouped results in whatever I do such as means, GLM or REG, I can cord as:</p>\n\n<pre><code>proc sort; by B;\nproc glm;\nclass A;\nmodel C=A; by B;\nrun;\n</code></pre>\n\n<p>Then, I can get GLM results within or by B level.\nBut, I DO NOT know how to use like'by' to grouping in R system.\nYou might want to suggest me to use <strong>>subset()</strong>, however, this cord would be really difficult when you have, for example, 10 levels of B.\nYou might want to learn me but only anova analysis but also regression and average.\nHere is anyone to help me?</p>\n\n<pre><code>raw data\n\nA   B   C\na   a   0.47\na   b   0.88\na   c   2.32\na   d   3.26\na   a   0.93\na   b   1.86\na   c   3.22\na   d   0.92\na   a   0.45\na   b   0.92\na   c   2.31\na   d   3.24\nb   a   0.91\nb   b   1.84\nb   c   3.27\nb   d   0.86\nb   a   0.47\nb   b   0.90\nb   c   2.33\nb   d   3.19\nb   a   0.92\nb   b   1.84\nb   c   3.25\nb   d   0.93\nc   a   0.45\nc   b   0.92\nc   c   2.33\nc   d   3.08\nc   a   0.93\nc   b   1.86\nc   c   3.25\nc   d   0.93\nc   a   0.47\nc   b   0.90\nc   c   2.26\nc   d   3.09\n</code></pre>\n"},{"tags":["r","legend","lattice","pages"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12838439,"title":"R lattice: how to get a different legend on each page of xyplot?","body":"<p>I'm doing an xyplot with lattice.\nI have like 30 plots on several pages with the same legend on all pages although not all the lines (group items) are on the pages.  I have almost 20 different colored lines (some on all plots and some depending on the plots) and it's impossible to have a readable display with so many colors.<br>\nWhat I would like to obtain is a legend depending on the actual content of the plots on each page (whatever the number of plots by page) and I have no idea on how to solve this nor did I find anything like this on the forum, but maybe I'm not searching the right way.</p>\n\n<p>Any help?</p>\n"},{"tags":["r","sed","awk","grep"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":12866206,"title":"Removing Rows of a File Following 'NA's","body":"<p>My data is arranged in a particular way, without headers, and with columns that do not necessarily contain the same kind of information.  A portion of it can be produced using: </p>\n\n<pre><code>data &lt;- textConnection(\"rs123,22,337647,C,T\n1,7385,0.4156,-0.0019,0.0037\n1,16550,0.959163800640972,-0.0241,0.0128\n1,17218,0.0528,0.015,0.039\nrs193,22,366349,C,T\n1,7385,0.3708,0.0017,0.0035\n1,16550,0.793259111116741,-0.0028,0.009\n1,17218,0.9547,-0.016,0.033\nrs194,22,366300,NA,NA\n0,0,0,0,0\n0,0,0,0,0\n0,0,0,0,0\nrs118,22,301327,C,T\n1,7385,0.0431,-0.0085,0.0077\n1,16550,0.789981059331214,0.0036,0.0092\n1,17218,0.99,-0.057,0.062\nrs120,22,497528,C,G\n1,7385,0.0716,0.0012,0.0073\n1,16550,0.233548238634496,-0.0033,0.0064\n1,17218,0.4563,-0.002,0.015\nrs109,22,309825,A,G\n1,5520,0.8611,2e-04,0.0044\n0,0,0,0,0\n1,17218,0.9762,0.076,0.044\nrs144,22,490068,C,T\n0,0,0,0,0\n0,0,0,0,0\n1,17218,0.2052,-0.013,0.032\")\nmydata &lt;- read.csv(data, header = F, sep = \",\", stringsAsFactors=FALSE)\n</code></pre>\n\n<p>My question is this: I can write a line to grep/awk lines containing 'NA' (these are the SNPs that contain no data)</p>\n\n<pre><code>grep -v 'NA' file.in &gt; file.out\n</code></pre>\n\n<p>But how can I then ALSO specify that the 3 following lines ALSO be removed? I do NOT want to remove every line containing all zeros, only the lines containing all zeros that follow a line containing a SNP with 'NA's. </p>\n\n<p>Thank you for your input! </p>\n"},{"tags":["r","package"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12867840,"title":"Downloading Package \"Cart\" in R","body":"<p>Does anybody know where I can download the R package \"cart\" that can help create Gastner's \n\"Mapping with Diffusion-based Cartograms\" ? I tried a install.package on R and says it's not available\nfor R 2.15. There is a page on R-forge about it but it doesn't explain how to download the package.</p>\n\n<p>Thanks.</p>\n"},{"tags":["r","ggplot2","missing-data","stacked-area-chart","timeserieschart"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":12860281,"title":"introducing a gap in continuous x axis using ggplot","body":"<p>This is kinda a build-on on my previous <a href=\"http://stackoverflow.com/questions/12849175/correct-for-missing-values-in-a-stacked-area-plot-using-ggplot2\">post</a> creating an stacked area/bar plot with missing values (all the script I run can be found there). In this post, however, Im asking if its possible to leave a gap in an continuous x axis? I have a time-serie (month-by-month) over a year, but for one sample one month is missing and I would like to show this month as a complete gap in the plot. Almost like plotting a graph for Jan-Aug (Sep is missing) and one for Oct-Dec and merging these with a gap for Sep. </p>\n\n<p>The only things I have come up trying are treating the missing month as zero or NA, creating a hugh drop in the area chart for Sep or excluding it but with an x axis ranging from 1-11, respectively (see plots in dropbox folder).</p>\n\n<p>The data set Im working on can be found in my <a href=\"https://www.dropbox.com/sh/pnkspwnn1qslm6u/JapTKCwqMS\" rel=\"nofollow\">dropbox folder</a> and it's named r_class.txt and you can also see the two different plots (Rplots1 and 2).  </p>\n\n<p>Any ideas would really be appreciated! </p>\n"},{"tags":["r","matching"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12841912,"title":"Merging two databases in R","body":"<p>I have two survey datasets which I want to combine for my study. The sample data look like this: </p>\n\n<pre><code>**Data A**\nX      Y         Z  Participation (in %)\n24    Black     10000      10\n28    Hispanic  250000     12\n54    White     20000      32\n32    White     32000      14\n\n**`Data B`**\n    X       Y        Z   Crime (in %)\n    24    Black     10000      4\n    28    Hispanic  250000     3\n    32    White     320000     5\n</code></pre>\n\n<p>Data A and B have X, Y, Z variables in common. The unique variable for data A is participation and that for data B is crime. Here is what I wanted to do:</p>\n\n<p>a. Partition each dataset into 9 cells as follows:</p>\n\n<pre><code>             Age group\n   Race    24-40  41-50  51-60 \n   White\n  Hispanic\n   Black\n</code></pre>\n\n<p>b. Rank each cell on the basis of variable Z.</p>\n\n<p>c. Include 10 observations of A for each observation of B. </p>\n\n<p>d. Draw a random sample of A so that number of observations of A is equal to B. </p>\n\n<p>e. Match the rank samples A and B one to one. </p>\n\n<p>I know that R has special package called StatsMatch for this. It, however, doesn't meet my requirements. As far as I understand, it does <strong>a</strong> and <strong>e</strong> and skips the middle steps. I am novice regarding this package and want to learn from an experienced user of this community. </p>\n"},{"tags":["r","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":114,"score":0,"question_id":12865218,"title":"Getting rid of \"AsIs\" class attribute","body":"<p>Simple question I think but have not found an answer. How to a get rid of the \"AsIs\" class attribute on my data frame. It is preventing the <code>write.dbf</code> from the <code>foreign</code> package from converting to dbf.\nI am working from rpy2 but it does work with R data frame with no \"AsIs\". I put the full code below the error message. \n        dbfs = write_dbf(r_dataframe)</p>\n\n<pre><code>Error in function (dataframe, file, factor2char = TRUE, max_nchar = 254)  : \n  data frame contains columns of unsupported class(es) AsIs\n\n---------------------------------------------------------------------------\nRRuntimeError                             Traceback (most recent call last)\n&lt;ipython-input-26-9072df63231a&gt; in &lt;module&gt;()\n----&gt; 1 dbfs = write_dbf(r_dataframe)\n\n/home/matthew/.virtualenvs/mypython/lib/python3.2/site-packages/rpy2-2.2.6dev_20120814-py3.2-linux-i686.egg/rpy2/robjects/functions.py in __call__(self, *args, **kwargs)\n     80                 v = kwargs.pop(k)\n     81                 kwargs[r_k] = v\n---&gt; 82         return super(SignatureTranslatedFunction, self).__call__(*args, **kwargs)\n\n/home/matthew/.virtualenvs/mypython/lib/python3.2/site-packages/rpy2-2.2.6dev_20120814-py3.2-linux-i686.egg/rpy2/robjects/functions.py in __call__(self, *args, **kwargs)\n     32         for k, v in kwargs.items():\n     33             new_kwargs[k] = conversion.py2ri(v)\n---&gt; 34         res = super(Function, self).__call__(*new_args, **new_kwargs)\n     35         res = conversion.ri2py(res)\n     36         return res\n\nRRuntimeError: Error in function (dataframe, file, factor2char = TRUE, max_nchar = 254)  : \n  data frame contains columns of unsupported class(es) AsIs\n</code></pre>\n\n<p>I am using python rpy2 to talk to R. That is not where the problem is but here is my code. The <code>write.dbf</code> works from Rpy2 if I use a data frame from R with no \"AsIs\". </p>\n\n<p>(python)</p>\n\n<pre><code>    df = DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6], 'C':[7,8,9]},index=[\"one\", \"two\", \"three\"])  I am going from python pandas dataframe to and R datafram using \n\n    fore = importr(\"foreign\")\n\n    In [19]:\n\n    r_dataframe = com.convert_to_r_dataframe(df)\n\n    In [20]:\n\n    print(type(r_dataframe))\n\n    &lt;class 'rpy2.robjects.vectors.DataFrame'&gt;\n\n    In [32]:\n\n    r_dataframe\n\n    Out[32]:\n\n&lt;DataFrame - Python:0xb3db8ac / R:0xc23ac50&gt;\n[IntVector, IntVector, IntVector]\n  A: &lt;class 'rpy2.robjects.vectors.IntVector'&gt;\n  &lt;IntVector - Python:0xc1fb1ec / R:0xc23ac28&gt;\n[       1,        2,        3]\n  B: &lt;class 'rpy2.robjects.vectors.IntVector'&gt;\n  &lt;IntVector - Python:0xc1fb36c / R:0xc23ac00&gt;\n[       4,        5,        6]\n  C: &lt;class 'rpy2.robjects.vectors.IntVector'&gt;\n  &lt;IntVector - Python:0xc1fb4ec / R:0xc23abd8&gt;\n[       7,        8,        9]\n\n\n    print(r_dataframe)\n\n          A B C\n    one   1 4 7\n    two   2 5 8\n    three 3 6 9\n\n    In [25]:\n\n    write_dbf =robjects.r(\"write.dbf\")\n\n    read_dbf = robjects.r(\"read.dbf\")\n\n    In [26]:\n\n    dbfs = write_dbf(r_dataframe)\n\nError in function (dataframe, file, factor2char = TRUE, max_nchar = 254)  : \n  data frame contains columns of unsupported class(es) AsI\n\n    dbfs = write_dbf(r_dataframe)\n</code></pre>\n"},{"tags":["r","plyr"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":12868611,"title":"Positional Matching Trickery","body":"<p>I wrote this nifty function to apply a function for every combination of vectorized arguments:</p>\n\n<pre><code>require(plyr)\nrequire(ggplot2)\n\n\n###eapply accepts a function and and a call to expand grid\n###where columns created by expand.grid must correspond to arguments of fun\n##each row created by expand.grid will be called by fun independently\n\n###arguments\n##fun either a function or a non-empty character string naming the function to be called.\n###... vectors, factors, or a list containing thse\n\n###value\n###a data frame\n\n##Details\n##at this time, elements of ... must be at least partially named to match args of fun\n##positional matching does not work\n\n###from the ddply documentation page:\n###The most unambiguous behaviour is achieved when fun returns a data frame - in that case pieces will \n###be combined with rbind.fill. If fun returns an atomic vector of fixed length, it will be rbinded \n###together and converted to a data frame. Any other values will result in an error. \n\neapply &lt;- function(fun,...){\n    if(!is.character(fun)) fun &lt;- as.character(substitute(fun))\n    adply(\n        expand.grid(...),\n        1,\n        function(x,fun) do.call(fun,x),\n        fun\n    )\n}\n\n\n##example use:\n\nm &lt;- function(n,visit.cost){\n    if(n*visit.cost &lt; 250){\n        c(\"total.cost\"=n*visit.cost)\n    }else{\n        c(\"total.cost\"=250 + (n*visit.cost-250)*.25)\n    }\n\n}\n\n\nd &lt;- eapply(m, n=1:30, visit.cost=c(40,60,80,100))\n\n\nggplot(d,aes(x=n,y=total.cost,color=as.factor(visit.cost),group=visit.cost)) + geom_line()\n</code></pre>\n\n<p>How can I rewrite the function such that the arguments passed to expand.grid need not be named:</p>\n\n<pre><code>d &lt;- eapply(m, 1:30, c(40,60,80,100))\n</code></pre>\n\n<p>Alternatively, are there any existing functions that have similar functionality?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":68,"score":0,"question_id":12868581,"title":"List all column except for one in R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4605206/drop-columns-r-data-frame\">Drop Columns R Data frame</a>  </p>\n</blockquote>\n\n\n\n<p>Let's say i have a dataframe with column c1,c2,c3.</p>\n\n<p>I want to list just c1,c2. How do I do that?</p>\n\n<p>I've tried:</p>\n\n<pre><code>head(data[column!=\"c3\"])\nhead(data)[,2]\nhead(data[!\"c3\"])\n</code></pre>\n\n<p>Thank you!</p>\n"},{"tags":["r","datetime","ggplot2","lubridate"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":263,"score":2,"question_id":10705328,"title":"extract hours and seconds from POSIXct for plotting purposes in R","body":"<p>Suppose I have the following <code>data.frame</code> <code>foo</code></p>\n\n<pre><code>           start.time duration\n1 2012-02-06 15:47:00      1\n2 2012-02-06 15:02:00      2\n3 2012-02-22 10:08:00      3\n4 2012-02-22 09:32:00      4\n5 2012-03-21 13:47:00      5\n</code></pre>\n\n<p>And <code>class(foo$start.time)</code> returns</p>\n\n<pre><code>[1] \"POSIXct\" \"POSIXt\" \n</code></pre>\n\n<p>I'd like to create a plot of <code>foo$duration</code> v. <code>foo$start.time</code>.  In my scenario, I'm only interested in the time of day rather than the actual day of the year.  How does one go about extracting the time of day as hours:seconds from <code>POSIXct</code> class of vector?</p>\n"},{"tags":["r","loops","for-loop"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":68,"score":0,"question_id":12863637,"title":"for() loop step width","body":"<p>Let I have an array like</p>\n\n<pre><code>a &lt;- seq(1, 100, 1)\n</code></pre>\n\n<p>and I want to select just the elements that occur each 3 steps with a <code>for()</code> loop starting from the second one, e.g. 2, 5, 8, 11 and so on.</p>\n\n<p>How should I use <code>for()</code> in this case?</p>\n\n<pre><code>b &lt;- NULL\n# for(i in 1:length(a)) { # Is there any additional argument?\n   # b[i] &lt;- a[...] # Or I can just multiply 'i' by some integer?\n# }\n</code></pre>\n\n<p>Thanks,</p>\n"},{"tags":["r","syntax"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":12868122,"title":"Converting a subset of factors in a dataframe to numeric using as.numeric(levels(f))[f]","body":"<p>I have a dataframe with 100 variables, of which I would like a subset, say dataframename[,30:50] to be converted to their original numeric values (1,2,3,4,5). </p>\n\n<p>I know that I should use <code>as.numeric(levels(f))[f]</code> when I convert a factor, but I can only make this work when I convert the factors one at a time. I would like to convert them all at once.</p>\n\n<p>This wont work:</p>\n\n<pre><code>as.numeric(levels(dataframename[,30:50]))[dataframename[,30:50]]  \n</code></pre>\n\n<p>neither will this:</p>\n\n<pre><code>sapply(dataframename[,30:50],as.numeric(levels(dataframename[,30:50]))    \n[dataframename[,30:50]]  \n</code></pre>\n\n<p>Any ideas or stuff I should read?</p>\n"},{"tags":["image","r","graphics"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12863277,"title":"rect function does not show top border under certain parameters","body":"<p>When I try to use the function below, I notice that my top row is missing the horizontal line in the plot. I've tracked this down to the line that specifies my rect dimensions, specifically how high and low it should be. Is there a parameter I can set so that the top line always appears? The code below does not have the top line..</p>\n\n<pre><code>Plot.Lines &lt;- function(colCount, rowCount, cex){\n  colCount &lt;- colCount # number per row\n  rowCount &lt;- rowCount\n\n  plot( c(1,colCount), c(0,rowCount), type=\"n\", ylab=\"\", xlab=\"\",\n       axes=FALSE, ylim=c(rowCount,0))\n  title(\"My Lines\")\n\n  for (j in 0:(rowCount-1))\n  {\n    base &lt;- j*colCount\n    remaining &lt;- length(colors()) - base\n    RowSize &lt;- ifelse(remaining &lt; colCount, remaining, colCount)\n    for(i in 1:RowSize){\n      rect(i-0.5,j-0.5,i+0.5, j+0.5, border = \"black\", col = colors()[base + (1:RowSize)]) \n    }\n    for(i in 1:RowSize){\n      text(x = i, y =j, labels = paste(base + i), cex =cex, col = \"black\")\n    }\n  }\n}\n\nPlot.Lines(25, 6, cex = 0.5)\n</code></pre>\n\n<p>However, if I change the line to:</p>\n\n<pre><code>rect(i-0.5,j-0.2,i+0.5, j+0.2, border = \"black\", col = colors()[base + (1:RowSize)]) \n</code></pre>\n\n<p>then it works, although there is a space between the rows. Is there a way I an set it automatically given the colCount and the rowCount?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12865790,"title":"converting MIAMIA305 to map in R","body":"<p>I have got a little problem. I have data which I want to map but the thing is that I dont have real location names just the short forms like: SANSAN210 OR miamia305 which I think is the the state and the county and the area code phone number. Does anyone how to convert this so I can map it on the us map?</p>\n"},{"tags":["r","data.frame"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":109,"score":1,"question_id":12863945,"title":"Keep rows of data frame that match certain criteria - EXPANDED","body":"<p>I shortly asked the following question:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/12861596/keep-rows-of-data-frame-that-match-certain-criteria\">Keep rows of data frame that match certain criteria</a></p>\n\n<p>I was wondering if it is possible to expand the code provided to say, for instance, give me only those rows where a number in column b appears in at least X out of the 4 letters A,B,C and D? So for instance, the number 5 appears in column a in B,C,D but not in A. However, I would like to return all rows where the number appears in at least 2 out of the 4 letters. That means, the number 5 should be kept plus of course all numbers that appear in all letters. Hope it is clear what I am trying to say.</p>\n\n<p>Many thanks in advance!</p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":66,"score":4,"question_id":12866704,"title":"retain improper name with indexing","body":"<p>I have need to name columns of a data.frame with duplicate names.  inside of <code>data.frame</code> you can use <code>check.names = FALSE</code> to do the naughty name deed.  But if you index this then you lose the naughty names when indexing.  I want to retain those names.  So beloe is an example and the output I get and I'd like to get:</p>\n\n<pre><code>x &lt;- data.frame(b= 4:6, a =6:8, a =6:8, check.names = FALSE)\nx[, -1]\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>  a a.1\n1 6   6\n2 7   7\n3 8   8\n</code></pre>\n\n<p>I'd like:</p>\n\n<pre><code>  a a\n1 6 6\n2 7 7\n3 8 8\n</code></pre>\n"},{"tags":["r","google-prediction"],"answer_count":2,"favorite_count":3,"up_vote_count":14,"down_vote_count":0,"view_count":646,"score":14,"question_id":12300933,"title":"Google Prediction using R","body":"<p>Has anyone successfully used the Google Predication API from within R?  My goal is to perform the following tasks:</p>\n\n<ul>\n<li>Upload and manage the data in Google Storage</li>\n<li>Use this data to train a model from Google Prediction</li>\n</ul>\n\n<p>I have followed the install instructions located <a href=\"https://developers.google.com/storage/docs/gsutil_install\">here</a> and <a href=\"http://code.google.com/p/r-google-prediction-api-v12/\">here</a> (when using Windows).  I have not been able to successfully connect using both Mac OSX and Windows.</p>\n\n<p>I suspect that the core issue is authentication. There is scattered documentation and I feel like I have tried everything (even the overview of the R package designed for this purpose).  </p>\n\n<p>I am not the greatest programmer, but I can typically follow along with code and piece together what I need from worked examples.  At this point, though, I simply do not know what else to try.</p>\n\n<p>Many thanks in advance.</p>\n"},{"tags":["r","plot","ggplot2","stacked"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":12863034,"title":"Stacked dot plot using ggplot2","body":"<p>I am interested in making a stacked dotplot like the one in link below in ggplot2.  </p>\n\n<p><img src=\"http://i.stack.imgur.com/Na4u2.png\" alt=\"\"></p>\n\n<p>The following was made using <code>dotPlot</code> function in <code>BHH2</code> package but does not have the coloring and faceting ease of <code>ggplot2</code>.</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":159,"score":2,"question_id":12794020,"title":"Calculating R function with arguments which are columns of a data frame","body":"<p>I have the following code.</p>\n\n<pre><code>completemodel &lt;- function(model, colnum)\n{\n  modlst = c()\n  tuplenum = length(model)\n  if(tuplenum != 0)\n    for(i in 1:tuplenum)\n      modlst = c(modlst, model[[i]])\n  index = seq(0, colnum-1)\n  inddiff = setdiff(index, modlst)\n  inddifflen = length(inddiff)\n  for(i in seq(length.out=inddifflen))\n    model = append(model, inddiff[i])\n  return(model)\n}\n\n##   Calculate number of parameters in model.\nnumparam &lt;- function(mod, colnum)\n  {\n    library(RJSONIO)\n    mod = fromJSON(mod)\n    mod = completemodel(mod, colnum)\n    totnum = 0\n    for(tup in mod)\n      totnum = totnum +(4**length(tup))\n    return(totnum)\n  }\n\nx = cbind.data.frame(rownum=c(100, 100), colnum=c(10, 20), modeltrue=c(\"[]\", \"[]\"), modelresult=c(\"[[1,2]]\",\"[[1,3]]\"), stringsAsFactors=FALSE)\n\n&gt; x\n  rows colnum modeltrue modelresult\n1  100     10        []     [[1,2]]\n2  100     20        []     [[1,3]]\n</code></pre>\n\n<p>How can I operate on <code>x</code> to give me a data frame that looks like the following? Here of course\nI mean that the value of e.g. <code>numparam(\"[]\", 10)</code> when I write <code>numparam(\"[]\", 10)</code>.</p>\n\n<pre><code>  rownum   colnum    numparam_modeltrue   numparam_modelresult\n  100        10      numparam(\"[]\", 10)   numparam(\"[[1,2]]\", 10)\n  100        20      numparam(\"[]\", 20)   numparam(\"[[1,3]]\", 20)\n</code></pre>\n\n<p>Some version of the apply function might work, but I am having problems finding the proper formulation.</p>\n\n<p>UPDATE: It seems that if the <code>rownnum</code>, <code>colnum</code> tuple is not unique, then one can do the following.</p>\n\n<pre><code>x = cbind.data.frame(id=c(1, 2, 3), rownum=c(100, 100, 100), colnum=c(10, 20, 20), modeltrue=c(\"[]\", \"[]\", \"[]\"),\n  modelresult=c(\"[[1,2]]\",\"[[1,3]]\",\"[[1,3, 4]]\"), stringsAsFactors = FALSE)\n\n##Then, create a data.table and set the key\n\nlibrary(data.table)\nxDT &lt;- as.data.table(x)\nsetkeyv(xDT, c(\"id\", \"rownum\", \"colnum\")\n</code></pre>\n\n<p>Is that the correct method?</p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":131,"score":2,"question_id":12696462,"title":"Conditional Sum Depending on Other Data Frame Columns","body":"<p>Let's say you have a data frame generated by the following commands:</p>\n\n<pre><code>date &lt;- seq(as.Date(\"2012-09-01\"), Sys.Date(), 1)\nid &lt;- rep(c(\"a\",\"b\",\"c\",\"d\"), 8)\nbdate &lt;- seq(as.Date(\"2012-08-01\"), as.Date(\"2012-11-01\"), 1)[sample(1:32, 32)]\n\n# The end date should be random but greater than the begin date. However, I set it to 15 days later for simplicity.\nedate &lt;- bdate + 15\n\nvalue &lt;- seq(1, 1000, 1)[sample(1:1000, 32)]\ndfa &lt;- data.frame(id, value, bdate, edate)\nnames(dfa) &lt;- c(\"ID\", \"Value\", \"Begin.Date\", \"End.Date\")\n</code></pre>\n\n<p>The goal is to sum all the observations by ID (i.e., \"a\", \"b\", or \"c\") in the following way:</p>\n\n<pre><code>Date        a   b   c\n2012-08-01  XXX YYY ZZZ\n2012-08-02  XXX YYY ZZZ\n2012-08-03  XXX YYY ZZZ\n</code></pre>\n\n<p>The values XXX, YYY, and ZZZ represent the sum of all the observations where the date on column \"Date\" falls between dfa$Begin.Date and dfa$End.Date on the original data frame, for each ID.</p>\n\n<p>My current solution is practically useless for large datasets so I was wondering if there are any faster ways to do it.</p>\n\n<p>My current script:</p>\n\n<pre><code># Create additional data frame\ndfb &lt;- data.frame(seq(as.Date(\"2012-08-01\"), as.Date(\"2012-11-01\"), 1))\nnames(dfb)[1] &lt;- \"Date\"\n\n# Variable for unique IDs\nnid &lt;- unique(dfa$ID)\n\n# Number of total IDs\ntid &lt;- length(nid)\n\nfor (i in c(1:tid))\n{\nsums &lt;- vapply(dfb$Date, function(x)\n{\ntemp &lt;- subset(dfa, dfa$ID == nid[i])\ntemp &lt;- subset(temp, temp$Begin.Date &lt; x &amp; temp$End.Date &gt; x)\nres &lt;- sum(temp$Value)\nres\n}, FUN.VALUE = 0.1\n)\ndfb[1+i] &lt;- sums\n}\n\n# Change column names to ID\nnames(dfb) &lt;- c(\"Date\", as.character(nid))\n</code></pre>\n\n<p>EDIT: I posted an answer below with a more efficient way to do this. However, I accepted Matthew's answer because it set me on the right path.</p>\n"},{"tags":["r","get","apostrophe"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":12859210,"title":"Access data deep in a structure using get()","body":"<p>I have a <code>p</code> structure in R memory and I'm trying to access the <code>Rate</code> column of the matrix.</p>\n\n<p>When I type <code>p$6597858$Sample</code> in the console, I get ...</p>\n\n<pre><code> p$`6597858`$Sample\n        Rate             Available                 X                    Y\n[1,]    1.01              1520.93                0.00                  0.0\n[2,]    1.02               269.13                0.00                  0.0\n[3,]    1.03               153.19                0.00                  0.0\n[4,]    1.04               408.80                0.00                  0.0\n</code></pre>\n\n<p>and so on ...</p>\n\n<p>Within my code when I try to </p>\n\n<pre><code>get(\"p$`6597858`$Sample[,1]\") \n</code></pre>\n\n<p>I get this returned ...</p>\n\n<pre><code>object 'p$`6597858`$Sample[ ,1]' not found\n</code></pre>\n\n<p>Is this an apostrophe problem?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":90,"score":1,"question_id":12861734,"title":"Calculating standard deviation of each row","body":"<p>I am trying to use <code>rowSds()</code>to calculate each rows standard deviation so that I can pick the rows that have high sds to graph.</p>\n\n<p>My data frame is called <code>xx</code> is like this:</p>\n\n<pre><code>head(xx,1)\n     Job     variable 2012-02-23 2012-02-24 2012-02-25 2012-02-27 2012-02-28 2012-02-29 2012-03-01 2012-03-02 2012-03-03 2012-03-05 2012-03-06 2012-03-07 2012-03-08 2012-03-09 2012-03-10 2012-03-12 2012-03-13 2012-03-14\n1 A Duration        152        424         NA        499        320        117        211        363         NA        605         76        309        204        185         NA         25        733        500\n  2012-03-15 2012-03-16 2012-03-17 2012-03-19 2012-03-20 2012-03-21 2012-03-22 2012-03-23 2012-03-24 2012-03-26 2012-03-27 2012-03-28 2012-03-29 2012-03-30 2012-03-31 2012-04-02 2012-04-03 2012-04-04 2012-04-05 2012-04-06\n1        521        601         NA        229        758        421        334        659         NA        419        423        444        289        594         NA        327        533        183        211        235\n  2012-04-07 2012-04-09 2012-04-10 2012-04-11 2012-04-12 2012-04-13 2012-04-14 2012-04-16 2012-04-17 2012-04-18 2012-04-19 2012-04-20 2012-04-21 2012-04-23 2012-04-24 2012-04-25 2012-04-26 2012-04-27 2012-04-28 2012-04-30\n1         NA        225        419        236        218        188         NA        205        547        153        196        200         NA        259        257        208        302        244         NA        806\n  2012-05-01 2012-05-02 2012-05-03 2012-05-04 2012-05-05 2012-05-07 2012-05-08 2012-05-09 2012-05-10 2012-05-11 2012-05-12 2012-05-14 2012-05-15 2012-05-16 2012-05-17 2012-05-18 2012-05-19 2012-05-21 2012-05-22 2012-05-23\n1        402        492       1078        440         NA        382        576       1105        511        368         NA        360        381       1152        718        353         NA        408        413        935\n  2012-05-24 2012-05-25 2012-05-26 2012-05-28 2012-05-29 2012-05-30 2012-05-31 2012-06-01 2012-06-02 2012-06-04 2012-06-05 2012-06-06 2012-06-07 2012-06-08 2012-06-09 2012-06-11 2012-06-12 2012-06-13 2012-06-14 2012-06-15\n1        306        277         NA        253        367        977        557        432         NA        328        521        467        972       1556         NA        386       1394        401        857        857\n  2012-06-16 2012-06-18 2012-06-19 2012-06-20 2012-06-21 2012-06-22 2012-06-23 2012-06-25 2012-06-26 2012-06-27 2012-06-28 2012-06-29 2012-06-30 2012-07-02 2012-07-03 2012-07-04 2012-07-05 2012-07-06 2012-07-07 2012-07-09\n1         NA       1056        324        329        327        325         NA        341        268        231        245        301         NA        283        365        297        310        260         NA        254\n  2012-07-10 2012-07-11 2012-07-12 2012-07-13 2012-07-14 2012-07-16 2012-07-17 2012-07-18 2012-07-19 2012-07-20 2012-07-21 2012-07-23 2012-07-24 2012-07-25 2012-07-26 2012-07-27 2012-07-28 2012-07-30 2012-07-31 2012-08-01\n1        283        395        273        273         NA        278        243        210        356        267         NA        442        483        271        327        271         NA        716        598        577\n  2012-08-02 2012-08-03 2012-08-06 2012-08-07 2012-08-08 2012-08-09 2012-08-10 2012-08-13 2012-08-14 2012-08-15 2012-08-16 2012-08-17 2012-08-20 2012-08-21 2012-08-22 2012-08-23 2012-08-24 2012-08-27 2012-08-28 2012-08-29\n1        345        403        318        522        333        259        404        244        240        288        245         22        738        530        390        648        294        403        381        724\n  2012-08-30 2012-08-31 2012-09-03 2012-09-04 2012-09-05 2012-09-06 2012-09-07 2012-09-10 2012-09-11 2012-09-12 2012-09-13 2012-09-14 2012-09-17 2012-09-18 2012-09-19 2012-09-20 2012-09-21 2012-09-24 2012-09-25 2012-09-26\n1        740        575        558        785        883        501        901        500        285        174        562       1047        603        990        289        173        253        512        236        278\n  2012-09-27 2012-09-28 2012-10-01 2012-10-02 2012-10-03 2012-10-04 2012-10-05 2012-10-08 2012-10-09 2012-10-10 2012-10-11 1        173        277        217        291        197        308        124        387        369        250        242\n</code></pre>\n\n<p>I am trying to calculate each rows standard deviation and assinging to sd column name:</p>\n\n<pre><code>xx$sd&lt;-rowSds(xx)\n</code></pre>\n\n<p>I get this error: </p>\n\n<pre><code>Error in apply(na.omit(as.matrix(x), ...), 1, FUN, ...) : \n  error in evaluating the argument 'X' in selecting a method for function 'apply': Error in na.omit(as.matrix(x), ...) : \n  error in evaluating the argument 'object' in selecting a method for function 'na.omit': Error in `colnames&lt;-`(`*tmp*`, value = c(\"2012-02-23\", \"2012-02-24\", \"2012-02-25\",  : \n  length of 'dimnames' [2] not equal to array extent\n</code></pre>\n\n<p>Any ideas how can I omit <code>NA</code> when calculating the SD? Is my syntax correct?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12863112,"title":"Importing dataset with badly organized headers","body":"<p>I have <a href=\"https://dl.dropbox.com/u/22681355/data.csv\" rel=\"nofollow\">this dataset</a> from the European Central Bank, but it is not coded in suitable way for importing to R:</p>\n\n<p>When trying to import using read.csv I get the following error: </p>\n\n<pre><code>Error in read.table(file = file, header = header, sep = sep, quote = quote, : \n  more columns than column names\n</code></pre>\n\n<p>I'm wondering what the right method of correcting this is?</p>\n"},{"tags":["r","phylogeny"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12848635,"title":"R distance matrix format from already calculated data","body":"<p>This is  my first time working with R. </p>\n\n<p>I have a table with 3 columns and 12090 rows (156 bacteria). The first two columns are names of bacteria and the last column is a number indicating relatedness between the organisms (based on a kind of genome similarity). example would be (made up numbers):</p>\n\n<pre><code>bacteria1    bacteria2    0.25846\nbacteria1    bacteria3    0.35986\nbacteria2    bacteria1    0.57896\nbacteria2    bacteria3    0.54596\nbacteria3    bacteria1    0.23659\nbacteria3    bacteria2    0.36528\n</code></pre>\n\n<p>I would like to be able to neighbor join these into a phylogenetic tree of sorts. I see that 'nj' needs a distance matrix to do this. How would I convert this into a distance matrix or usable format? (The numbers are already distance so there shouldn't be any math being done)\nI've tried as.dist() and as.matrix() and reshape() but being new I may have done everything wrong. (reshape may be what I need..)</p>\n\n<p>Or if anyone knows how to make these into a tree through other means that would be grand.</p>\n\n<p>Thanks for any help. </p>\n"},{"tags":["r","r-faq"],"answer_count":3,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":1010,"score":9,"question_id":1788779,"title":"View the source of an R package","body":"<p>Is there an easy way to view the source of an R package (or a method in a package), from within the interactive environment?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12864867,"title":"Row based summary calculations","body":"<p>xx</p>\n\n<pre><code>head(xx,1)\n     Sport    variable 2012.07.01 2012.07.02 2012.07.03 2012.07.04 2012.07.05 2012.07.06 2012.07.07 2012.07.08 2012.07.09 2012.07.10 2012.07.11 2012.07.12 2012.07.13 2012.07.14 2012.07.15 2012.07.16 2012.07.17\n1 Soccer Likes         13         13         14         12         11         11         NA          9         16         11         12         15         10         NA         13          9         10\n  2012.07.18 2012.07.19 2012.07.20 2012.07.21 2012.07.22 2012.07.23 2012.07.24 2012.07.25 2012.07.26 2012.07.27 2012.07.28 2012.07.29 2012.07.30 2012.07.31 2012.08.01 2012.08.02 2012.08.03 2012.08.04 2012.08.05\n1         16         10         17         NA         10         15         14         11         11         13         NA         13         26        987        898        162        146         NA        257\n  2012.08.06 2012.08.07 2012.08.08 2012.08.09 2012.08.10 2012.08.11 2012.08.12 2012.08.13 2012.08.14 2012.08.15 2012.08.16 2012.08.17 2012.08.18 2012.08.19 2012.08.20 2012.08.21 2012.08.22 2012.08.23 2012.08.24\n1        370        443        490        612        646         NA        311        371        432        512        610        734         NA       1002        931        886        190        317        386\n  2012.08.25 2012.08.26 2012.08.27 2012.08.28 2012.08.29 2012.08.30 2012.08.31 2012.09.01 2012.09.02 2012.09.03 2012.09.04 2012.09.05 2012.09.06 2012.09.07 2012.09.08 2012.09.09 2012.09.10 2012.09.11 2012.09.12\n1         NA        586        812        904        863        941        922         NA        150        146        175        132        254        330         NA        198        281        254        316\n  2012.09.13 2012.09.14 2012.09.15 2012.09.16 2012.09.17 2012.09.18 2012.09.19 2012.09.20 2012.09.21 2012.09.22 2012.09.23 2012.09.24 2012.09.25 2012.09.26 2012.09.27 2012.09.28 2012.09.29 2012.09.30 2012.10.01\n1        416        594         NA        668        745        972        984        885        496         NA        687        734        767        832        965        934         NA        200        225\n  2012.10.02 2012.10.03 2012.10.04 2012.10.05 2012.10.06 2012.10.07 2012.10.08 2012.10.09 2012.10.10 2012.10.11       SD Mean        Max   Min mean\n1        219        181        198        229         NA        364        431        492        592        612 336.9102   NA soccer     9   NA\n</code></pre>\n\n<p>trying to calculate row standard deviation, mean, max, min etc per each row with the following formula:</p>\n\n<pre><code>transform(xx, SD=apply(xx,1, sd, na.rm = TRUE)) \ntransform(xx, Mean=apply(xx,1, mean, na.rm = TRUE)) \ntransform(xx, Max=apply(xx,1, max, na.rm = TRUE)) \ntransform(xx, Min=apply(xx,1, min, na.rm = TRUE)) \n</code></pre>\n\n<p>I dont think this is working since my first two columns are text rather than all numbers.</p>\n\n<p>Is there a way to just calculate numbers in row based calculations?</p>\n"},{"tags":["r","regression","linear-regression","anova"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":109,"score":0,"question_id":12863178,"title":"Comparing two linear models with anova() in R","body":"<p>I don't quite understand what the p-value in this output means. I don't mean p-values as such, but in this case.</p>\n\n<pre><code>&gt; Model 1: sl ~ le + ky \n&gt; Model 2: sl ~ le   \n  Res.Df     RSS Df   Sum of Sq      F Pr(&gt;F) \n1     97 0.51113                              \n2     98 0.51211 -1 -0.00097796 0.1856 0.6676\n</code></pre>\n\n<p>I get something like that, and now I am wondering which model is the better fit.\nAs there is only ONE and not TWO p-values I'm getting confused.\nI get different pvalues using summary(model1) or summary(model2)</p>\n\n<p>Now if </p>\n\n<pre><code>&gt; fm2&lt;-lm(Y~X+T)\n</code></pre>\n\n<p>(T being my indicator variable) and </p>\n\n<pre><code>&gt; fm4&lt;-lm(Y~X)\n</code></pre>\n\n<p>if I do </p>\n\n<pre><code>&gt; anova(fm2,fm4)\n</code></pre>\n\n<p>this tests the null hypothesis <code>H0: alpha1==alpha2</code>\n<code>(Ha: alpha1!=alpha2)</code>c(alpha being my intercept)\nSo it is tested whether it is better to have one intercept (=> <code>alpha1==alpha2</code>), or two intercepts (<code>alpha1!=alpha2</code>)</p>\n\n<p>In this case we would now obviously reject the null Hypotheses, as the p-value is 0.6676.</p>\n\n<p>This would mean we should rather stick with model <code>fm4</code>, as it is more appropriate for our data.</p>\n\n<p>Did I draw the conclusions right? I tried my very best, but I am not sure what the p-value means. As there is only on, this is what I thought it might mean.\nCan someone clear things up?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12863841,"title":"Converting char to date time","body":"<p>In a data.frame, I have a date time stamp in the form:</p>\n\n<pre><code>head(x$time)\n[1] \"Thu Oct 11 22:18:02 2012\" \"Thu Oct 11 22:50:15 2012\" \"Thu Oct 11 22:54:17 2012\"\n[4] \"Thu Oct 11 22:43:13 2012\" \"Thu Oct 11 22:41:18 2012\" \"Thu Oct 11 22:15:19 2012\"\n</code></pre>\n\n<p>Everytime I try to convert it with <code>as.Date</code>, <strong>lubridate</strong>, or <strong>zoo</strong> I get <code>NA</code>s or Errors.</p>\n\n<p>What is the way to convert this time to a readable form?</p>\n\n<p>I've tried:</p>\n\n<pre><code> Time&lt;-strptime(x$time,format=\"&amp;m/%d/%Y  %H:$M\")\n    x$minute&lt;-parse_date_time(x$time)\n    x$minute&lt;-mdy(x$time)\n    x$minute&lt;-as.Date(x$time,\"%m/%d/%Y %H:%M:%S\")\n    x$minute&lt;-as.time(x$time)\n    x$minute&lt;-as.POSIXct(x$time,format=\"%H:%M\")\n    x$minute&lt;-minute(x$time)\n</code></pre>\n"},{"tags":["r","date","dateformat"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":12864910,"title":"representing data in year/qtr format using R","body":"<p>I have a bunch of dates that are of the format <code>yyyy-mm-dd</code> and I would like to convert them to a <code>yyyy-q</code> format where <code>qq</code> is the quarter of the year (so months 1, 2, 3 map to q=1 and 4, 5, 6 map to q=2, etc.).  I use the following function to accomplish this:</p>\n\n<pre><code>get_month &lt;- function(d) { return(as.numeric(format(d, \"%m\")))}\nget_qtr &lt;- function(d) {\nf &lt;- function(m) {\n    if (m %in% c(1,2,3)) { return(1) }\n    else if (m %in% c(4,5,6)) { return(2) }\n    else if (m %in% c(7,8,9)) { return(3) }\n    else if (m %in% c(10,11,12)) { return(4) }\n}\nm &lt;- get_month(d)\nr &lt;- sapply(m, f)\nreturn(r)\n}\n</code></pre>\n\n<p>This is, however, very slow.  Is there a faster way of doing this?</p>\n"},{"tags":["c++","r","rinside"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12864113,"title":"RInside segmentation fault and linking issue","body":"<p>I'm trying to call R from c++ on linux via RInside, I compiled R-2.15.1 from source with gcc version 4.5.3 (Debian 4.5.3-1) , I don't have sudo rights to use apt-get install. I'm using OpenBlas and a system optimized lapack. The blas and lapack libraries work fine for many scalapack applications</p>\n\n<p>I installed R with </p>\n\n<pre><code>./configure --with-blas=\"-I/lib/OpenBLAS-v0.2.3-0/xianyi-OpenBLAS-48f075c/install/include -L/lib/OpenBLAS-v0.2.3-0/xianyi-OpenBLAS-48f075c/install/lib -lopenblas -lgfortran\" --with-lapack=\"/usr/lib/liblapack.so -lgfortran\" --enable-BLAS-shlib=yes --enable-R-shlib --enable-R-static-lib --prefix= . \n</code></pre>\n\n<p>which installed and runs fine,I ran make check with no errors, also all the packages (Rcpp and RInside) installed fine..</p>\n\n<p>however when i use the given RInside <code>makefile</code> , the basic hello world example from <code>/standard/rinside_sample0.cpp</code> compiles! but it does not run and i get the following error</p>\n\n<pre><code>./rinside_sample0: error while loading shared libraries: libRblas.so: cannot open shared object file: No such file or directory\n</code></pre>\n\n<p>the file <code>libRblas.so</code> exists and is in the <code>R/lib</code> folder,</p>\n\n<p>when i try to link it manually with the g++ command the make file creates or linking as follows i get a segmentation fault</p>\n\n<pre><code>/R/lib/libRblas.so ./hello_world\nSegmentation fault\n</code></pre>\n\n<p>EDIT:  heres how the example make file tries to compile an example, (which compiles fine) but won't run with the above missing <code>libRblas.so</code> error </p>\n\n<pre><code>g++ -I/nfs/user03/jimmie21/libs/lib64/R/include -I/nfs/user03/jimmie21/libs/lib64/R/library/Rcpp/include -I/nfs/user03/jimmie21/libs/lib64/R/library/RInside/include -g -O2 -Wall -I/usr/local/include   hello_world.cpp  -L/nfs/user03/jimmie21/libs/lib64/R/lib -lR  -L/nfs/user03/jimmie21/libs/lib64/R/lib -lRblas -L/nfs/user03/jimmie21/libs/lib64/R/lib -lRlapack -L/nfs/user03/jimmie21/libs/lib64/R/lib -lRblas -L/nfs/user03/jimmie21/libs/lib64/R/library/Rcpp/lib -lRcpp -Wl,-rpath,/nfs/user03/jimmie21/libs/lib64/R/library/Rcpp/lib -L/nfs/user03/jimmie21/libs/lib64/R/library/RInside/lib -lRInside -Wl,-rpath,/nfs/user03/jimmie21/libs/lib64/R/library/RInside/lib -o hello_world\n</code></pre>\n"},{"tags":["r","data.frame"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":97,"score":2,"question_id":12861596,"title":"Keep rows of data frame that match certain criteria","body":"<p>I created a simple data.frame:</p>\n\n<pre><code>data.frame(a = rep(LETTERS[1:4], each=4),\n           b = c(sample(6,4),sample(6,4),sample(6,4),sample(6,4)))\n\n   a b\n1  A 6\n2  A 4\n3  A 2\n4  A 3\n5  B 5\n6  B 1\n7  B 3\n8  B 6\n9  C 2\n10 C 3\n11 C 5\n12 C 1\n13 D 4\n14 D 5\n15 D 1\n16 D 3\n</code></pre>\n\n<p>How can I keep only those rows of the data.frame where the number in column b appears in all 4 letters of column a? So, for instance, the number 3 in column b appears for A, B, C and D in column a and should therefore be kept.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12862755,"title":"need to re-organize data frame by row to perform calcuations on each row","body":"<p>My original data frame is this:\nx</p>\n\n<pre><code>Team  Date   variable  value\nA 2012-07-01 Score      13\nA 2012-07-02 Score      12\nA 2012-07-03 Score      2097\nA 2012-07-04 Score      45\nA 2012-07-05 Score      41\nA 2012-07-06 Score      763\n</code></pre>\n\n<p>need to to be like this</p>\n\n<pre><code>z\n    Team 2012-07-01 2012-07-02 2012-07-03 2012-07-04 2012-07-05 2012-07-06 \n    A     13         12          2097      45        41         763\n\nlibrary(reshape)\nz&lt;-cast(x, Team + variable ~ Date)\n</code></pre>\n\n<p>I get a warning message stating this: </p>\n\n<pre><code>Aggregation requires fun.aggregate: length used as default\n</code></pre>\n"},{"tags":["r","emacs","ess"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":55,"score":4,"question_id":12805873,"title":"changing indentation in emacs ess","body":"<p>I would like to know how can I change indentation in emacs ess. \nI generally like default one (ess-set-style 'C++ 'quiet)\nBut sometimes it formats really weirdly. For example this is what I would like to have, and this will be default formatting if it is not part of the function:</p>\n\n<pre><code>  ggplot(data = overtime.by.month,\n         aes(x=\"\",\n             y=Percent,\n             fill = Overtime)) +\n  geom_bar(width = 1) +\n  xlab('') +\n  ylab(sub.txt) +\n  labs(title = title.txt) +\n  facet_wrap(~Year.Month) +\n  geom_text(aes(y = txt.pos, label = Per.txt)) +\n  coord_polar(theta = \"y\") +\n  scale_fill_manual(values = c('green', 'red')) +\n  theme(axis.ticks = element_blank(),\n        axis.text.y = element_blank(),\n        axis.text.x = element_blank())\n</code></pre>\n\n<p>This is what I get with current indentation style, if I put it inside of the function. </p>\n\n<pre><code>a &lt;- function(){\n\n    a &lt;- ggplot(data = overtime.by.month,\n                aes(x=\"\",\n                    y=Percent,\n                    fill = Overtime)) +\n                        geom_bar(width = 1) +\n                            xlab('') +\n                                ylab(sub.txt) +\n                                    labs(title = title.txt) +\n                                        facet_wrap(~Year.Month) +\n                                            geom_text(aes(y = txt.pos, label = Per.txt)) +\n                                                coord_polar(theta = \"y\") +\n                                                    scale_fill_manual(values = c('green', 'red')) +\n                                                        theme(axis.ticks = element_blank(),\n                                                              axis.text.y = element_blank(),\n                                                              axis.text.x = element_blank())\n}\n</code></pre>\n\n<p>UPDATE: I followed both VitoshKa's and Dirk's suggestions, after reinstallation, and updating .emacs problem went away. Thank you guys</p>\n\n<p>UPDATE2: Problem is back. I think now it will be reproducible for all. I tried to on two different machines. It happens when you put code inside of the function. I updated post to reflect changes. </p>\n"},{"tags":["r","arbitrary-precision","binomial-coefficients"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":89,"score":3,"question_id":12844624,"title":"Strange precision issues in R when computing cumulative binomial probability","body":"<p>I've been running into some weird problems when using this code:</p>\n\n<pre><code>positions&lt;-c(58256)\noccurrencies&lt;-c(30)\nfrequency&lt;-c(11/5531777)\nlength&lt;-c(4)\n\nprob&lt;-c(0)\nfor(i in 0:(occurrencies-1))\n{\n  pow&lt;-frequency^i\n  pow1&lt;-(1-frequency)^(positions-i)\n  bin&lt;-choose(positions, i)\n  prob&lt;&lt;-prob+(bin*pow*pow1)\n}\n</code></pre>\n\n<p>Each iteration of this for loop should calculate the binomial probability that, <code>i</code> number of occurrences of the event occur given the frequency. Each iteration also sums up the result. This should result in the <code>prob</code> variable never exceeding 1, but after 7 or so for loop iterations, everything goes to hell and <code>prob</code> excedes 1.</p>\n\n<p>I thought it might be a question of precision digits, so i tried using <a href=\"http://cran.r-project.org/web/packages/Rmpfr/vignettes/Rmpfr-pkg.pdf\" rel=\"nofollow\">Rmpfr</a> but to no avail- the same problem persisted.</p>\n\n<p>I was wondering if there are any tips or packages to overcome this situation, or if I'm stuck with this.</p>\n"},{"tags":["r","netcdf"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":12860486,"title":"why R does not provide information as much as gdalinfo?","body":"<p>I opend a netcdf file thru R and looked at the information and then I used gdalinfo to look at the information of the same file.I found that there are much much information shown by gdalinfo such as\ntime  origin , units , etc.....may be there is a command to grasp more information of a variable in Netcdf file thru R?</p>\n\n<pre><code>             f=open.ncdf(\"C:\\\\BR_Ban.nc\")\n\n              &gt; f\n            [1] \"file C:\\\\Users\\\\aalyaari\\\\Desktop\\\\fluxnetdata\\\\GF_Guy_6Y.nc has 4 dimensions:\"\n              [1] \"x   Size: 1\"\n              [1] \"y   Size: 1\"\n              [1] \"land   Size: 1\"\n           [1] \"tstep   Size: 105120\"\n       [1] \"double nav_lon[x,y]  Longname:Longitude Missval:1e+30\"\n       [1] \"double nav_lat[x,y]  Longname:Latitude Missval:1e+30\"\n       [1] \"float time[tstep]  Longname:Time axis Missval:1e+30\"\n     [1] \"float timestp[tstep]  Longname:Time step axis Missval:1e+30\"\n\nThen read one variable\n\n           A = get.var.ncdf(nc=f,varid=\"time\",verbose=TRUE)\n     [1] \"vobjtodimname: is a character type varid.  This file has 6 dims\"\n    [1] \"vobjtodimname: no cases found, returning FALSE\"\n     [1] \"get.var.ncdf: isdimvar: FALSE\"\n      [1] \"vobjtovarid: entering with varid=date\"\n     [1] \"Variable named date found in file with varid= 7\"\n     [1] \"vobjtovarid: returning with varid deduced from name; varid= 7\"\n    [1] \"get.var.ncdf: ending up using varid= 7\"\n     [1] \"ndims: 2\"\n  [1] \"get.var.ncdf: varsize:\"\n    [1]     3 52560\n     [1] \"get.var.ncdf: start:\"\n     [1] 1 1\n      [1] \"get.var.ncdf: count:\"\n    [1]     3 52560\n     [1] \"get.var.ncdf: totvarsize: 157680\"\n     [1] \"Getting var of type 3  (1=short, 2=int, 3=float, 4=double, 5=char, 6=byte)\"\n    [1] \"get.var.ncdf: C call returned 0\"\n    [1] \"count.nodegen: 3    Length of data: 157680\"     \"count.nodegen: 52560    Length of data: 157680\"\n     [1] \"get.var.ncdf: final dims of returned array:\"\n        [1]     3 52560\n</code></pre>\n"},{"tags":["r","gwidgets"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12855164,"title":"position of the labels in a widget","body":"<p>In the widget below, is it possible to change the position of the label of the \"radio\" groups. I would like something like that instead of having \"Type\" above the items:</p>\n\n<pre><code>Type        o Quantitative\n            o Qualitative\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/jgpH1.jpg\" alt=\"enter image description here\"></p>\n\n<pre><code>win &lt;- gwindow(\"Empirical Phase Diagram\")\n\nBigDataGroup &lt;- ggroup(cont=win)\nDataGroup &lt;- gframe(\"Data\", container = BigDataGroup, horizontal=FALSE)\n\ngrp.file &lt;- ggroup(horizontal=FALSE, container = DataGroup)\nlbl.file &lt;- glabel(\"File: \", container = grp.file)\nbrowse.file &lt;- gfilebrowse(container = grp.file)\n\nInput1Group &lt;-  gframe(\"First input variable \", container = DataGroup, horizontal=FALSE)\ngrp.text.input1 &lt;- ggroup(horizontal=FALSE, container = Input1Group)\nlbl.text.input1 &lt;- glabel(\"Column index\",  container = grp.text.input1)\ninsert.text.input1 &lt;- gedit(text=\"A\", container = grp.text.input1)\ngrp.type.input1 &lt;- ggroup(horizontal=FALSE, container = Input1Group)\n#addSpring(grp.type.input1)\nlbl.type.input1 &lt;- glabel(\"Type \", container = grp.type.input1)\ninsert.type.input1 &lt;- gradio(items=c(\"Quantitative\", \"Qualitative\"), container = grp.type.input1) \n\nInput2Group &lt;-  gframe(\"Second input variable \", container = DataGroup, horizontal=FALSE)\ngrp.text.input2 &lt;- ggroup(horizontal=FALSE, container = Input2Group)\nlbl.text.input2 &lt;- glabel(\"Column index\", container = grp.text.input2)\ninsert.text.input2 &lt;- gedit(text=\"B\", container = grp.text.input2)\ngrp.type.input2 &lt;- ggroup(horizontal=FALSE, container = Input2Group)\nlbl.type.input2 &lt;- glabel(\"Type \", container = grp.type.input2)\ninsert.type.input2 &lt;- gradio(items=c(\"Quantitative\", \"Qualitative\"), container = grp.type.input2) \n\ngrp.text.output &lt;- ggroup(horizontal=FALSE, container = DataGroup)\nlbl.text.output &lt;- glabel(\"Output variable range \", container = grp.text.output)\ninsert.text.output &lt;- gedit(initial.msg=\"type a range e.g. C:AD\", container = grp.text.output)\n\nOptionsGroup &lt;- ggroup(horizontal=FALSE, container = BigDataGroup)\ngrp.colorspace &lt;- ggroup(horizontal=FALSE, container = OptionsGroup)\ninsert.colorspace &lt;- gradio(items=c(\"RGB\", \"LAB\", \"LUV\"))\nlbl.colorspace &lt;- gframe(\"Color space \", container = grp.colorspace)\nadd(lbl.colorspace, insert.colorspace)\n\nGoGroup &lt;- ggroup(horizontal=FALSE, container = BigDataGroup)\naddSpring(GoGroup)\nread &lt;- gbutton(text=\"Go\", container = GoGroup, \n    handler = function(h, ...) {\n    print(EPD(filename=svalue(browse.file), \n        input1=svalue(insert.text.input1),\n        input2=svalue(insert.text.input2),\n        outputs=svalue(insert.text.output),\n        color.space=svalue(insert.colorspace))\n        )\n    }\n)\n</code></pre>\n"},{"tags":["r","environment"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":95,"score":4,"question_id":12851018,"title":"How to populate an environment in R","body":"<p>I'm using the <code>IMIS</code> package (Incremental Mixture Importance Sampling) to estimate parameters. Unfortunately, it's written to look for functions <code>likelihood</code>, <code>sample.prior</code>, and <code>prior</code> in the environment it's called in, so I can't wrap it in a function (my end goal). The univariate example from <code>?IMIS</code> works just fine,</p>\n\n<pre><code>require(IMIS)\nlikelihood &lt;- function(theta) exp(-1*sin(3*theta)*sin(theta^2) - 0.1*theta^2)\nprior &lt;- function(theta) dnorm(theta, 0, 5)\nsample.prior &lt;- function(n) rnorm(n, 0, 5)\nresult = IMIS(500, 3000, 100, 10)\n\n## also fine using do.call (pertinent below)\nresult &lt;- do.call(IMIS, args = list(B = 500, B.re = 3000, number_k = 100, D = 10))\n</code></pre>\n\n<p>but unsurprisingly, wrapping it in a function does not:</p>\n\n<pre><code>rm(likelihood, prior, sample.prior, result)\nimisWrap &lt;- function() {\n    likelihood &lt;- function(theta) exp(-1*sin(3*theta)*sin(theta^2) - 0.1*theta^2)\n    prior &lt;- function(theta) dnorm(theta, 0, 5)\n    sample.prior &lt;- function(n) rnorm(n, 0, 5)\n    result = IMIS(500, 3000, 100, 10)\n    return(result)\n}\nimisWrap() ## can't find sample.prior\n</code></pre>\n\n<p>I <em>think</em> the way around this is to create an environment in my wrapper (or use its environment) and then use <code>do.call</code> to run <code>IMIS</code> in that environment, but I don't know how to create a new environment that has <code>likelihood</code>, <code>prior</code>, <code>sample.prior</code>, and <code>result</code> in it.</p>\n\n<hr>\n\n<p><strong>Edit:</strong> Using @BenBolker's excellent comments I have an improved but still not working attempt:</p>\n\n<pre><code>imisWrap2 &lt;- function() {\n    likelihood &lt;- function(theta) exp(-1*sin(3*theta)*sin(theta^2) - 0.1*theta^2)\n    prior &lt;- function(theta) dnorm(theta, 0, 5)\n    sample.prior &lt;- function(n) rnorm(n, 0, 5)\n    imisEnv &lt;- new.env()\n    assign(\"likelihood\", likelihood, envir = imisEnv)\n    assign(\"sample.prior\", sample.prior, envir = imisEnv)\n    assign(\"prior\", prior, envir = imisEnv)\n    result = do.call(IMIS,\n                     args = list(B = 500, B.re = 3000, number_k = 100, D = 10),\n                     envir = imisEnv)\n    return(result)\n}\n</code></pre>\n\n<p>But this still can't find the functions.</p>\n"},{"tags":["r","optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":12852329,"title":"Optimisation in R","body":"<p>I'm new to R and I have a problem with optimisation.</p>\n\n<pre><code>d &lt;- c(0, 9.017, -9.017, 0, 9.017, 0, -8.579, -7.849, 0, 0, -7.849, \n    -9.017, 0, -7.849, -7.849, 0, 0, 0, 8.579, 1.168, 8.579, 8.579, \n    -7.849, 0.729, 8.579, 9.017, 0, -0.438)\n\nx &lt;- c(0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, \n    1, 1, 0, 1, 1, 1, 0, 1)\n\nlog.like&lt;-function (sigma){ \n    theta = pnorm(d,mean=0,sd=sigma) \n    logl = sum(log((theta ^ x) * ((1-theta)^(1-x))))\n    -logl\n}\n\noptim(0,fn=log.like,method=\"L-BFGS-B\",lower=0,upper=1)\n</code></pre>\n\n<p>It gives me the following error:</p>\n\n<pre><code> Error in optim(0, fn = log.like, method = \"L-BFGS-B\", lower = 0, upper = 1) : \n  L-BFGS-B needs finite values of 'fn'\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12861354,"title":"Calculate daily change in value in R","body":"<p>I have a matrix with the following values: <code>a &lt;- c(4,6,7,78,3,2,5,6,7,8)</code></p>\n\n<p>I would like to create a second matrix <code>b</code> which lists the changes in <code>a</code>'s value at each step.</p>\n\n<p>So the solution would be: <code>b &lt;- c(2,1,71,-75,-1,3,1,1,1)</code></p>\n\n<p>Is there a function for this in R and if there isn't what is the easiest way to proceed?</p>\n"},{"tags":["r","installation-package"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12861014,"title":"Problems installing R packages","body":"<p>I'm setting up a new laptop running Gentoo and wish to install R (as I do on all of my computers!).</p>\n\n<p>However, I've hit a bit of a problem when it comes to installing packages.</p>\n\n<p>I first tried to:</p>\n\n<pre><code>&gt; install.packages(c(\"ggplot2\", \"plyr\", \"reshape2\"))\n</code></pre>\n\n<p>And it duly downloaded all of the packages and its dependencies.  However they didn't install reporting.</p>\n\n<pre><code>Error in library(data.table) : there is no package called ‘data.table’\nCalls: .First -&gt; library\nExecution halted\nError in library(data.table) : there is no package called ‘data.table’\nCalls: .First -&gt; library\nExecution halted\nError in library(data.table) : there is no package called ‘data.table’\nCalls: .First -&gt; library\nExecution halted\nError in library(data.table) : there is no package called ‘data.table’\nCalls: .First -&gt; library\nExecution halted\nError in library(data.table) : there is no package called ‘data.table’\nCalls: .First -&gt; library\nExecution halted\nError in library(data.table) : there is no package called ‘data.table’\nCalls: .First -&gt; library\nExecution halted\nError in library(data.table) : there is no package called ‘data.table’\nCalls: .First -&gt; library\nExecution halted\nError in library(data.table) : there is no package called ‘data.table’\nCalls: .First -&gt; library\n</code></pre>\n\n<p>Not a problem I'll just install the data.table package, unfortunately...</p>\n\n<pre><code>&gt; install.packages(\"data.table\")\ntrying URL 'http://cran.uk.r-project.org/src/contrib/data.table_1.8.2.tar.gz'\nContent type 'application/x-gzip' length 818198 bytes (799 Kb)\nopened URL\n==================================================\ndownloaded 799 Kb\n\nError in library(data.table) : there is no package called ‘data.table’\nCalls: .First -&gt; library\nExecution halted\n\nThe downloaded source packages are in\n    ‘/tmp/RtmpbQtALj/downloaded_packages’\nUpdating HTML index of packages in '.Library'\nMaking packages.html  ... done\nWarning message:\nIn install.packages(\"data.table\") :\n  installation of package ‘data.table’ had non-zero exit status\n</code></pre>\n\n<p>And there is no indication of why installation failed at all, so I've no idea how to go about solving this? A traceback() isn't available either.</p>\n\n<p>GCC is installed and configured as the output of gcc-config shows (and the fact that I can install other software from source no problem).</p>\n\n<pre><code># gcc-config -l\n [1] x86_64-pc-linux-gnu-4.6.3 *\n</code></pre>\n\n<p>Stumped as to how to go about solving this one.  Any thoughts or ideas on how to get more information out of <code>install.packages()</code> welcome.</p>\n\n<p>EDIT : contents of .First as requested....</p>\n\n<pre><code>&gt; .First\nfunction () \n{\n    library(data.table)\n    library(foreign)\n    library(ggplot2)\n    library(Hmisc)\n    library(lattice)\n    library(plyr)\n    library(rms)\n    library(xtable)\n    cat(\"\\nWelcome at\", date(), \"\\n\")\n}\n</code></pre>\n\n<p>EDIT 2 : No Rprofile.site but there is /usr/lib64/R/library/base/R/Rprofile which has....</p>\n\n<pre><code># cat /usr/lib64/R/library/base/R/Rprofile \n### This is the system Rprofile file. It is always run on startup.\n### Additional commands can be placed in site or user Rprofile files\n### (see ?Rprofile).\n\n### Notice that it is a bad idea to use this file as a template for\n### personal startup files, since things will be executed twice and in\n### the wrong environment (user profiles are run in .GlobalEnv).\n\n.GlobalEnv &lt;- globalenv()\nattach(NULL, name = \"Autoloads\")\n.AutoloadEnv &lt;- as.environment(2)\nassign(\".Autoloaded\", NULL, envir = .AutoloadEnv)\nT &lt;- TRUE\nF &lt;- FALSE\nR.version &lt;- structure(R.Version(), class = \"simple.list\")\nversion &lt;- R.version            # for S compatibility\n\n## for backwards compatibility only\nR.version.string &lt;- R.version$version.string\n\n## NOTA BENE: options() for non-base package functionality are in places like\n##            --------- ../utils/R/zzz.R\n\noptions(keep.source = interactive())\noptions(warn = 0)\n# options(repos = c(CRAN=\"@CRAN@\"))\n# options(BIOC = \"http://www.bioconductor.org\")\n\noptions(timeout = 60)\noptions(encoding = \"native.enc\")\noptions(show.error.messages = TRUE)\n## keep in sync with PrintDefaults() in  ../../main/print.c :\noptions(scipen = 0)\noptions(max.print = 99999)# max. #{entries} in internal printMatrix()\noptions(add.smooth = TRUE)# currently only used in 'plot.lm'\noptions(stringsAsFactors = TRUE)\nif(!interactive() &amp;&amp; is.null(getOption(\"showErrorCalls\")))\n    options(showErrorCalls = TRUE)\n\nlocal({dp &lt;- Sys.getenv(\"R_DEFAULT_PACKAGES\")\n       if(identical(dp, \"\")) # marginally faster to do methods last\n           dp &lt;- c(\"datasets\", \"utils\", \"grDevices\", \"graphics\",\n                   \"stats\", \"methods\")\n       else if(identical(dp, \"NULL\")) dp &lt;- character(0)\n       else dp &lt;- strsplit(dp, \",\")[[1]]\n       dp &lt;- sub(\"[[:blank:]]*([[:alnum:]]+)\", \"\\\\1\", dp) # strip whitespace\n       options(defaultPackages = dp)\n     })\n\n## Expand R_LIBS_* environment variables.\nSys.setenv(R_LIBS_SITE =\n           .expand_R_libs_env_var(Sys.getenv(\"R_LIBS_SITE\")))\nSys.setenv(R_LIBS_USER =\n           .expand_R_libs_env_var(Sys.getenv(\"R_LIBS_USER\")))\n\n.First.sys &lt;- function()\n{\n    for(pkg in getOption(\"defaultPackages\")) {\n        res &lt;- require(pkg, quietly = TRUE, warn.conflicts = FALSE,\n                       character.only = TRUE)\n        if(!res)\n            warning(gettextf('package %s in options(\"defaultPackages\") was not found',     sQuote(pkg)),\n                    call.=FALSE, domain = NA)\n    }\n}\n\n.OptRequireMethods &lt;- function()\n{\n      if(\"methods\" %in% getOption(\"defaultPackages\")) {\n        res &lt;- require(\"methods\", quietly = TRUE, warn.conflicts = FALSE,\n                       character.only = TRUE)\n        if(!res)\n            warning('package \"methods\" in options(\"defaultPackages\") was not found', call.=FALSE)\n    }\n}\n\nif(nzchar(Sys.getenv(\"R_BATCH\"))) {\n    .Last.sys &lt;- function()\n    {\n        cat(\"&gt; proc.time()\\n\")\n        print(proc.time())\n    }\n    ## avoid passing on to spawned R processes\n    ## A system has been reported without Sys.unsetenv, so try this\n    try(Sys.setenv(R_BATCH=\"\"))\n}\n###-*- R -*- Unix Specific ----\n\n.Library &lt;- file.path(R.home(), \"library\")\n.Library.site &lt;- Sys.getenv(\"R_LIBS_SITE\")\n.Library.site &lt;- if(!nchar(.Library.site)) file.path(R.home(), \"site-library\") else unlist(strsplit(.Library.site, \":\"))\n.Library.site &lt;- .Library.site[file.exists(.Library.site)]\n\ninvisible(.libPaths(c(unlist(strsplit(Sys.getenv(\"R_LIBS\"), \":\")),\n                      unlist(strsplit(Sys.getenv(\"R_LIBS_USER\"), \":\")\n                      ))))\n\nlocal({\n## we distinguish between R_PAPERSIZE as set by the user and by configure\npapersize &lt;- Sys.getenv(\"R_PAPERSIZE_USER\")\nif(!nchar(papersize)) {\n    lcpaper &lt;- Sys.getlocale(\"LC_PAPER\") # might be null: OK as nchar is 0\n    papersize &lt;- if(nchar(lcpaper))\n        if(length(grep(\"(_US|_CA)\", lcpaper))) \"letter\" else \"a4\"\n    else Sys.getenv(\"R_PAPERSIZE\")\n}\noptions(papersize = papersize,\n        printcmd = Sys.getenv(\"R_PRINTCMD\"),\n        dvipscmd = Sys.getenv(\"DVIPS\", \"dvips\"),\n        texi2dvi = Sys.getenv(\"R_TEXI2DVICMD\"),\n        browser = Sys.getenv(\"R_BROWSER\"),\n        pager = file.path(R.home(), \"bin\", \"pager\"),\n        pdfviewer = Sys.getenv(\"R_PDFVIEWER\"),\n        useFancyQuotes = TRUE)\n})\n\n## non standard settings for the R.app GUI of the Mac OS X port\nif(.Platform$GUI == \"AQUA\") {\n    ## this is set to let RAqua use both X11 device and X11/TclTk\n    if (Sys.getenv(\"DISPLAY\") == \"\")\n    Sys.setenv(\"DISPLAY\" = \":0\")\n\n    ## this is to allow gfortran compiler to work\n    Sys.setenv(\"PATH\" = paste(Sys.getenv(\"PATH\"),\":/usr/local/bin\",sep = \"\"))\n}## end \"Aqua\"\n\nlocal({\n    tests_startup &lt;- Sys.getenv(\"R_TESTS\")\n    if(nzchar(tests_startup)) source(tests_startup)\n})\n</code></pre>\n"},{"tags":["r","list","random-forest"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":298,"score":2,"question_id":7815969,"title":"R put multiple randomForest objects into a vector","body":"<p>I am curious if R has the ability to place objects into vectors/lists/arrays/etc.  I am using the randomforest package to work on subsets of a larger piece of data and would like to store each version in a list.  It would be similar to this:</p>\n\n<pre><code>answers &lt;- c()\nfor(i in 1:10){\nx &lt;- round((1/i), 3)\nanswers &lt;- (rbind(answers, x))\n}\n</code></pre>\n\n<p>Ideally I'd like to do something like this:</p>\n\n<pre><code>answers &lt;- c()\nfor(i in 1:10){\nRF &lt;- randomForest(training, training$data1, sampsize=c(100), do.trace=TRUE, importance=TRUE, ntree=50,,forest=TRUE)\nanswers &lt;- (rbind(answers, RF))\n}\n</code></pre>\n\n<p>This kind of works but here's the output for a single RF object:</p>\n\n<pre><code>&gt; RF \n\nCall:\n randomForest(x = training, y = training$data1, ntree = 50, sampsize = c(100), importance = TRUE, do.trace = TRUE,      forest = TRUE) \n               Type of random forest: regression\n                     Number of trees: 10\nNo. of variables tried at each split: 2\n\n          Mean of squared residuals: 0.05343956\n                    % Var explained: 14.32\n</code></pre>\n\n<p>While this is the out put for the 'answers' list:</p>\n\n<pre><code>&gt; answers \n   call       type         predicted      mse        rsq        oob.times      importance importanceSD\nRF Expression \"regression\" Numeric,150000 Numeric,10 Numeric,10 Integer,150000 Numeric,16 Numeric,8   \nRF Expression \"regression\" Numeric,150000 Numeric,10 Numeric,10 Integer,150000 Numeric,16 Numeric,8   \nRF Expression \"regression\" Numeric,150000 Numeric,10 Numeric,10 Integer,150000 Numeric,16 Numeric,8   \nRF Expression \"regression\" Numeric,150000 Numeric,10 Numeric,10 Integer,150000 Numeric,16 Numeric,8   \nRF Expression \"regression\" Numeric,150000 Numeric,10 Numeric,10 Integer,150000 Numeric,16 Numeric,8   \nRF Expression \"regression\" Numeric,150000 Numeric,10 Numeric,10 Integer,150000 Numeric,16 Numeric,8   \nRF Expression \"regression\" Numeric,150000 Numeric,10 Numeric,10 Integer,150000 Numeric,16 Numeric,8   \nRF Expression \"regression\" Numeric,150000 Numeric,10 Numeric,10 Integer,150000 Numeric,16 Numeric,8   \nRF Expression \"regression\" Numeric,150000 Numeric,10 Numeric,10 Integer,150000 Numeric,16 Numeric,8   \nRF Expression \"regression\" Numeric,150000 Numeric,10 Numeric,10 Integer,150000 Numeric,16 Numeric,8   \n   localImportance proximity ntree mtry forest  coefs y              test inbag\nRF NULL            NULL      10    2    List,11 NULL  Integer,150000 NULL NULL \nRF NULL            NULL      10    2    List,11 NULL  Integer,150000 NULL NULL \nRF NULL            NULL      10    2    List,11 NULL  Integer,150000 NULL NULL \nRF NULL            NULL      10    2    List,11 NULL  Integer,150000 NULL NULL \nRF NULL            NULL      10    2    List,11 NULL  Integer,150000 NULL NULL \nRF NULL            NULL      10    2    List,11 NULL  Integer,150000 NULL NULL \nRF NULL            NULL      10    2    List,11 NULL  Integer,150000 NULL NULL \nRF NULL            NULL      10    2    List,11 NULL  Integer,150000 NULL NULL \nRF NULL            NULL      10    2    List,11 NULL  Integer,150000 NULL NULL \nRF NULL            NULL      10    2    List,11 NULL  Integer,150000 NULL NULL \n</code></pre>\n\n<p>Does anyone know how to store all the RF objects or call them so that the info stored is the same as a single RF object?  Thanks for suggestions.</p>\n"},{"tags":["arrays","r"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":12859215,"title":"Switching row-major to column-major dimensions","body":"<p>I am putting into R a row-major data as a vector. R interprets this as column-major data and as far as I can see there is no way to tell array to behave in a row-major way.</p>\n\n<p>Let's say I have:</p>\n\n<pre><code>array(1:12, c(3,2,2), \n    dimnames=list(c(\"r1\", \"r2\", \"r3\"), c(\"c1\", \"c2\"),c(\"t1\", \"t2\"))\n)\n</code></pre>\n\n<p>Which gives:</p>\n\n<pre><code>, , t1\n\n   c1 c2\nr1  1  4\nr2  2  5\nr3  3  6\n\n, , t2\n\n   c1 c2\nr1  7 10\nr2  8 11\nr3  9 12\n</code></pre>\n\n<p>I want to transform this data to row-major array:</p>\n\n<pre><code>, , t1\n   c1 c2\nr1  1  2\nr2  3  4\nr3  5  6\n\n, , t2\n\n   c1 c2\nr1  7  8\nr2  9 10\nr3 11 12\n</code></pre>\n"},{"tags":["r","maps","geocoding","zipcode"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":82,"score":0,"question_id":12858533,"title":"how do I map (on a geographical map) data in R just given the US Zipcodes","body":"<p>for a school project I have to map some data on a geographical map in R. Therefore I've got some data containing the zipcode and many other information (just no more information on the state, county or whatever).\nI've been trying to point out on a map of the usa first all the zips I have. Just dots. Afterwards I wanted to mix and match the criteria like the count of zips I have in the data (e.g. the zips that appear very often I wanted to colour dark and the less often ones in a lither colour, later I wanted to point out e.g. the number of churns in a state).\nCan somebody help me out on how I can do this?  </p>\n\n<p>thanks a lot</p>\n"},{"tags":["algorithm","r"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12858503,"title":"Which function/algorithm for this merging and filling operation?","body":"<p>I have written R code that merges two data frames based on first column and for missing data adds the value from above. Here is what is does:</p>\n\n<p>Two input data frames:</p>\n\n<pre><code>1 a\n2 b\n3 c\n5 d\n</code></pre>\n\n<p>And</p>\n\n<pre><code>1 e\n4 f\n6 g\n</code></pre>\n\n<p>My code gives this output:</p>\n\n<pre><code>   1 a e\n   2 b e\n   3 c e\n   4 c f\n   5 d f\n   6 d g\n</code></pre>\n\n<p>My code is however inefficient as it is not vectorized properly. Are there some R functions which I could use? Basically a function I am looking for is that fills in missing values / NA values and takes the value from previous element and puts it in place of NA.</p>\n\n<p>I looked through reference book of R, but could not find anything.</p>\n"},{"tags":["r","ggplot2","ggplot","kernel-density"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":12462479,"title":"R ggplot2 - Simple plot- cannot specify log axis limits","body":"<p>I'm trying to create a simple densityplot in R in ggplot2. Here's my code which works great.</p>\n\n<pre><code>d &lt;-  ggplot(result, aes(x=result$baseMeanA)) \nd + geom_density(colour=\"darkgreen\", size=2, fill=\"darkgreen\") + \nscale_x_log10() + scale_y_continuous(limits = c(0, 0.45))\n</code></pre>\n\n<p>The problem is that I cannot adjust the x-axis as I would like, into negative numbers. </p>\n\n<pre><code>scale_x_log10(limits= c(1, 10000))\n</code></pre>\n\n<p>works great, but </p>\n\n<pre><code>scale_x_log10(limits= c(-1, 10000))\n</code></pre>\n\n<p>does not work at all! It gives me this error:</p>\n\n<blockquote>\n  <p>Error in if (zero_range(range)) { : missing value where TRUE/FALSE needed</p>\n</blockquote>\n\n<p>Please help! </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12855194,"title":"Download and unzip shapefile to temporary directory","body":"<p>In an effort to make reproducible posts at SO, I am trying to download data files to a temporary location and from there to load them into R. I am mostly using code from JD Longs answer <a href=\"http://stackoverflow.com/questions/7044808/using-r-to-download-gzipped-data-file-extract-and-import-data\">in this SO Post</a>. The downloading and unzipping works all fine, but I am unable to load the file from the temporary directory. This is the code I am using:</p>\n\n<pre><code>library(maptools)\ntmpdir &lt;- tempdir()\nurl &lt;- 'http://epp.eurostat.ec.europa.eu/cache/GISCO/geodatafiles/NUTS_2010_03M_SH.zip'\nfile &lt;- basename(url)\ndownload.file(url, file)\nunzip(file, exdir = tmpdir )\n\n## I guess the error is somewhere in the next two lines\nshapeFile &lt;- paste(tmpdir,\"/Shape/data/NUTS_RG_03M_2010\")\nEU &lt;- readShapeSpatial(shapeFile)\n# --&gt; Error in getinfo.shape(fn) : Error opening SHP file\n</code></pre>\n\n<p>I have been looking into the man files for tempdir() without success. Settinge the working directory to the temporary location didn't work either. I probably miss something very basic here. Do you have any hints how to get around this?</p>\n"},{"tags":["r","ggplot2","missing-data","stacked-area-chart","stackedbarseries"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12849175,"title":"Correct for missing values in a Stacked area plot using ggplot2","body":"<p>I've been trying to recreate this <a href=\"http://groups.google.com/group/ggplot2/browse_thread/thread/594d6d321da7043e\" rel=\"nofollow\">post</a> on a combination of stacked bar/area plot. I have some problems with missing values though. </p>\n\n<p>Here's my data: <a href=\"https://www.dropbox.com/sh/pnkspwnn1qslm6u/JapTKCwqMS\" rel=\"nofollow\">https://www.dropbox.com/sh/pnkspwnn1qslm6u/JapTKCwqMS</a></p>\n\n<p>What I run is;</p>\n\n<pre><code>    wa=read.table('wa_class.txt', sep=\"\", header=F, na.string=\"0\")\n    names(wa)=c(\"Class\",\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\")\n    wam=melt(wa)\nwam$variablen=as.numeric(wam$variable)\n</code></pre>\n\n<p>How it looks like  </p>\n\n<pre><code>    &gt; head(wam)\n                   Class variable     value variablen\n1         Actinobacteria      Jan 38.115163         1\n2          Flavobacteria      Jan        NA         1\n3        Sphingobacteria      Jan  3.640469         1\n4    Alphaproteobacteria      Jan 13.631663         1\n5 Betaproteobacteria_b28      Jan  3.718671         1\n6     Betaproteobacteria      Jan 14.732354         1\n\nggplot(na.omit(wam[,c(\"Class\",\"value\",\"variablen\")]), aes(wam,x=variablen, y=value, fill=Class)) + geom_area(color=\"black\") + geom_linerange(aes(ymax=value), position=\"stack\") + scale_x_continuous(breaks=1:max(wam$variablen)) + labs(title=\"Water\", x=\"Month\", y=\"Relative abundance (%)\")\n</code></pre>\n\n<p>...so I have tried to correct for the missing values with use na.omit on the variables I plot. However, I get layers in the plot which e.g. is overriding each other (see dropbox folder).</p>\n\n<p>I found this post (see dropbox folder) which corrected for it, but seemed only to have one. And I couldn't reproduce it since the link to the data is dead.</p>\n\n<p>Any help would really be appreciated!</p>\n\n<p>Thanks,</p>\n\n<p>Jo</p>\n"},{"tags":["r","crontab","cronexpression"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":12855256,"title":"convert cron to timestamps in R","body":"<p>I am looking for a way to convert cron information into a list of timestamps, using R.\nis there an easy way to do do?</p>\n\n<p>Given the crontab and a start date and an end date, I would like to obtain the list of trigger timestamps during these 2 dates.</p>\n\n<p>I have not found any package that specifically deals with CRON info, but maybe somebody has already had this problem?</p>\n\n<p>Thanks</p>\n"},{"tags":["r","formatting","plot","multiple","rows"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12855277,"title":"Two-row-plot formatting","body":"<p>I have the following problem:\nI want to make a plot in R where two figures are above each other. However, the upper figure should take up most of the space and the lower figure should just have a very low height (it just serves to indicate special positions in the \"main\" figure). At the moment I have this code, but I don't know how to set the space each row should take up (and \nthe second plot should be immediately beneath the first one):</p>\n\n<pre><code>dev.new()\npng(\"multitest.png\")\npar( mfrow = c( 2, 1 ) ) \nplot( rnorm( n = 10 ), col = \"blue\", main = \"plot 1\", cex.lab = 1.1,ylab=\"yname\", xlab='')\nplot( rnorm( n = 10 ), col = \"red\", main = \"\", cex.lab = 1.1, xaxt='n',yaxt='n',xlab=\"xname\", ylab=\"\")\ndev.off()\n</code></pre>\n\n<p>I have to run it on a server where I don't know if additional packages are available for R. If there is a suggestions using additional packages, I will try it though.\nThank you in advance, I have used plots in R just for simple histograms so far.</p>\n"},{"tags":["r","rcpp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12857860,"title":"Passing attributes to Rcpp::Function","body":"<p>I'm trying to pass a vector to the R function called from within Rcpp:</p>\n\n<pre><code>Rcpp::Function aperm(\"aperm\");\nint perm[3] = {2,1,3};\narr = aperm(arr, Rcpp::Named(\"perm\", perm));\n</code></pre>\n\n<p>I've tried to wrap the perm before calling aperm but in both cases I am getting various Rcpp errors:</p>\n\n<pre><code>arr = aperm(arr, Rcpp::Named(\"perm\", Rcpp::wrap(perm)));\n</code></pre>\n\n<p>Is it possible to pass a vector as a parameter to an R function when calling it from Rcpp?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":75,"score":8,"question_id":12848570,"title":"Valid expressions to the quote function","body":"<p>According to the manual of <code>quote(expr)</code>:</p>\n\n<blockquote>\n  <p>expr: any syntactically valid R expression</p>\n</blockquote>\n\n<p>While <code>quote(x==y)</code> returns a call <code>x==y</code> successfully, <code>quote(x=y)</code> fails:</p>\n\n<pre><code>Error in quote(x = y) : supplied argument name 'x' does not match 'expr'\n</code></pre>\n\n<p>Both <code>x=y</code> and <code>x==y</code> are syntactically valid R expressions, aren't they? Why <code>quote()</code> fails on <code>x=y</code>?</p>\n"},{"tags":["r","title"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":12847415,"title":"main=paste( substitute(...), substitute(...) ) in R_hist_title","body":"<p>I'm trying to assemble a title for a histogram plot in R. The title I want derives from two sources, first a vector (death.cause) specifying, er, cause-of-death, and second a field from a data.frame, into which I index using a list, deathratecols, to get at the field.</p>\n\n<pre><code>&gt; death.cause \n\n&gt; [[1]] [1] \"Heart Attack\"\n&gt; \n&gt; [[2]] [1] \"Heart Failure\"\n&gt; \n&gt; [[3]] [1] \"Pneumonia\"\n\n\n&gt; deathratecols\n\n&gt; [1] 11 17 23\n</code></pre>\n\n<p>I want to assemble title like: Heart Attack (x-bar = 7.63763) , where x-bar is the mean of the data column. I can get the two parts to work separately as below. </p>\n\n<pre><code>&gt; main=substitute(x, list(x=death.cause[[i]]) )) # gives title \"Heart Attack\" \n\n&gt; main=substitute(bar(X)==k, list(k=mean(outcome[, deathratecols[i] ], na.rm=TRUE   ) )) # gives title x-bar=7.63763\n</code></pre>\n\n<p>But my efforts to put the two together using paste() have failed.</p>\n\n<p>? someone point out the error of my ways please</p>\n"},{"tags":["r","spatial"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":12820176,"title":"Cropping plot from shapefile","body":"<p>I am trying to produce Choroplete maps using shapefiles and Data provided by Eurostat. The shapefile has been downloaded <a href=\"http://epp.eurostat.ec.europa.eu/cache/GISCO/geodatafiles/\" rel=\"nofollow\">here</a>: using JD Longs code from <a href=\"http://stackoverflow.com/questions/7044808/using-r-to-download-gzipped-data-file-extract-and-import-data\">this post</a>.</p>\n\n<p>This is the minimal code to reproduce the figure I posted below.</p>\n\n<pre><code>library(maptools)\ntmpdir &lt;- tempdir()\nurl &lt;- 'http://epp.eurostat.ec.europa.eu/cache/GISCO/geodatafiles/NUTS_2010_03M_SH.zip'\nfile &lt;- basename(url)\ndownload.file(url, file)\nunzip(file, exdir = tmpdir )\nshapeFile &lt;- paste(tmpdir,\"/Shape/data/NUTS_RG_03M_2010\", sep=\"\")\n\nEU &lt;- readShapeSpatial(shapeFile)\nplot(EU)\n</code></pre>\n\n<p>My problem is that I would like to have the plot area to focus on Europe only, but due to the Overseas regions (France and Spain), the plot does not have the right focus. Is there an easy way to \"crop\" the plot area in the above example? </p>\n\n<p>The polygons I want to get rid of are are part of the \"Country_Shape\", so filtering them out is no option. \nI tried to achieve my goal by defining the xlim and ylim parameters in the plot command, but did not succeed. I used locator() to get the coordinates from the graphics device, but plugging the values in didn't provide the wanted results.</p>\n\n<p><img src=\"http://i.stack.imgur.com/AG1b7.jpg\" alt=\"The minimal example\"></p>\n"},{"tags":["r","netcdf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12854565,"title":"How to write data from netcdf file to an excel or text file?","body":"<p>I have a netcdf file that has 6 dimensions:</p>\n\n<pre><code>f=open.ncdf(\"C:\\\\BR_Ban.nc\")\n[1] \"x   Size: 1\"\n[1] \"y   Size: 1\"\n[1] \"land   Size: 1\"\n[1] \"time_counter   Size: 52560\"\n[1] \"datedim   Size: 3\"\n[1] \"PFT   Size: 2\"\n[1] \"file BR_Ban.nc has 5 variables:\"\n[1] \"float nav_lon[x,y]  Longname:Longitude Missval:1e+30\"\n[1] \"float nav_lat[x,y]  Longname:Latitude Missval:1e+30\"\n[1] \"double time[time_counter]  Longname:Time axis Missval:1e+30\"\n[1] \"float date[datedim,time_counter]  Longname:date Missval:1e+30\"\n[1] \"float Tair[land,time_counter]  Longname:Near surface air temperature Missval:-9999\"\n</code></pre>\n\n<p>I read the varible <code>date</code>:</p>\n\n<pre><code>A = get.var.ncdf(nc=f,varid=\"date\",verbose=TRUE)\n[1] \"vobjtodimname: is a character type varid.  This file has 6 dims\"\n[1] \"vobjtodimname: no cases found, returning FALSE\"\n[1] \"get.var.ncdf: isdimvar: FALSE\"\n[1] \"vobjtovarid: entering with varid=date\"\n[1] \"Variable named date found in file with varid= 7\"\n[1] \"vobjtovarid: returning with varid deduced from name; varid= 7\"\n[1] \"get.var.ncdf: ending up using varid= 7\"\n[1] \"ndims: 2\"\n[1] \"get.var.ncdf: varsize:\"\n[1]     3 52560\n[1] \"get.var.ncdf: start:\"\n[1] 1 1\n[1] \"get.var.ncdf: count:\"\n[1]     3 52560\n[1] \"get.var.ncdf: totvarsize: 157680\"\n[1] \"Getting var of type 3  (1=short, 2=int, 3=float, 4=double, 5=char, 6=byte)\"\n[1] \"get.var.ncdf: C call returned 0\"\n[1] \"count.nodegen: 3    Length of data: 157680\"     \"count.nodegen: 52560    Length of data: 157680\"\n[1] \"get.var.ncdf: final dims of returned array:\"\n[1]     3 52560\n</code></pre>\n\n<p>Then I read the variable <code>Tair</code> as I did for <code>date</code>.\nI wrote the two variables to two text files. May anyone help me to write both of them to one text file or excel? This piece of code will write only one variable:</p>\n\n<pre><code>write.table(as.double(A),\"C:\\\\folder\\\\shwon_Br_Ban_flux net.txt\")\n</code></pre>\n\n<p>The problem with this variable <code>date</code> is that I got a text file that looks like this:</p>\n\n<pre><code>\"x\"\n\"1\"  2004\n\"2\"   1\n\"3\"  0.5\n\"4\"  2004\n\"5\"    1\n\"6\"    1\n</code></pre>\n\n<p>up to</p>\n\n<pre><code>\"157675\" 2006\n\"157676\" 365\n\"157677\" 23.5\n\"157678\" 2007\n\"157679\" 366\n\"157680\" 0\n</code></pre>\n\n<p>As you can see, all in one column \"year,hour and day\". Is there a way to write the time step \"half hourly\" in one column, the year in another column and the same for the day?</p>\n"},{"tags":["python","r","rpy2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12855161,"title":"Building Rpy2 for windows","body":"<p>I was confused that official <code>rpy2</code> last version didn't supported for windows platforms. </p>\n\n<p>I found unofficial building of the last development version on 'lgautier' bitbucket repository  <a href=\"https://bitbucket.org/breisfeld/rpy2_w32_fix/issue/1/binary-installer-for-win32\" rel=\"nofollow\">here</a> Building in attachement. </p>\n\n<p>Hope it's usefull for you.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12854489,"title":"Running a function repeatedly and appending its output","body":"<p>I'm using the GillespieSSA package for R, which allows you to call a single instance of a stochastic simulation easily and quickly. But a single realization isn't super-useful, I'd like to be able to look at the variability that arises from chance, etc. Consider a very basic model:</p>\n\n<pre><code>library(GillespieSSA)\nx0 &lt;- c(S=499, I=1, R=0)\na &lt;- c(\"0.001*{S}*{I}\",\"0.1*{I}\")\nnu &lt;- matrix(c(-1,0,\n               +1,-1,\n               0, +1),nrow=3,byrow=T)\nout &lt;- ssa(x0, a, nu, tf=100)\n</code></pre>\n\n<p>That puts out a profoundly complicated list, the interesting bits of which are in <code>out$data</code>.</p>\n\n<p>My question is, I can grab out$data for a single call of the instance, tag it with a variable indicating what call of the function it is, and then append that data to the old data to come out with one big set at the end. So in crude pseudo-R, something like:</p>\n\n<pre><code>nruns &lt;- 10\nfor (i in 1:nruns){\n   out &lt;- ssa(x0, a, nu, tf=100)\n   data &lt;- out$data\n   run &lt;- rep(i,times=length[data[,2]))\n   data &lt;- cbind(data,run)\n</code></pre>\n\n<p>But where data isn't being overwritten at each time step. I feel like I'm close, but having hopped between several languages this week, my R loop fu, weak as it already is, is failing.</p>\n"},{"tags":["arrays","r","mongodb","rmongodb"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":12839549,"title":"Extract values from an array in mongoDB to dataframe using rmongodb","body":"<p>I'm querying a database containing entries as displayed in the example. All entries contain the following values:</p>\n\n<ul>\n<li><code>_id</code>: unique id of <code>overallitem</code> and <code>placed_items</code></li>\n<li><code>name</code>: the name of te <code>overallitem</code></li>\n<li><code>loc</code>: location of the <code>overallitem</code> and <code>placed_items</code></li>\n<li><code>time_id</code>: time the <code>overallitem</code> was stored</li>\n<li><code>placed_items</code>: array containing <code>placed_items</code> (can range from zero: <code>placed_items : [],</code> to unlimited amount. </li>\n<li><code>category_id</code>: the category of the <code>placed_items</code></li>\n<li><code>full_id</code>: the full id of the <code>placed_items</code></li>\n</ul>\n\n<p>I want to extract the <code>name</code>, <code>full_id</code> and <code>category_id</code> on a per <code>placed_items</code> level given a <code>time_id</code> and <code>loc</code> constraint</p>\n\n<p>Example data:</p>\n\n<pre><code>{\n \"_id\" : \"5040\",\n \"name\" : \"entry1\",\n \"loc\" : 1,\n \"time_id\" : 20121001,\n \"placed_items\" : [],\n}\n{\n \"_id\" : \"5041\",\n \"name\" : \"entry2\",\n \"loc\" : 1,\n \"time_id\" : 20121001,\n \"placed_items\" : [\n  {\n   \"_id\" : \"5043\",\n   \"category_id\" : 101,\n   \"full_id\" : 901,\n  },\n  {\n   \"_id\" : \"5044\",\n   \"category_id\" : 102,\n   \"full_id\" : 902,\n  }\n ],\n}\n{\n \"_id\" : \"5042\",\n \"name\" : \"entry3\",\n \"loc\" : 1,\n \"time_id\" : 20121001,\n \"placed_items\" : [\n  {\n   \"_id\" : \"5045\",\n   \"category_id\" : 101,\n   \"full_id\" : 903,\n  },\n ],\n}\n</code></pre>\n\n<p>The expected outcome for this example would be:</p>\n\n<pre><code>\"name\"    \"full_id\" \"category_id\"\n\"entry2\"    901         101\n\"entry2\"    902         102\n\"entry3\"    903         101\n</code></pre>\n\n<p>So if <code>placed_items</code> is empty, do put the entry in the dataframe and if <code>placed_items</code> containts <code>n</code> entries, put <code>n</code> entries in dataframe</p>\n\n<p>I tried to work out an RBlogger example to create the desired dataframe. </p>\n\n<pre><code>#Set up database\n    mongo &lt;- mongo.create()\n\n    #Set up condition\n    buf &lt;- mongo.bson.buffer.create()\n    mongo.bson.buffer.append(buf, \"loc\", 1)\n    mongo.bson.buffer.start.object(buf, \"time_id\")\n    mongo.bson.buffer.append(buf, \"$gte\", 20120930)\n    mongo.bson.buffer.append(buf, \"$lte\", 20121002)\n    mongo.bson.buffer.finish.object(buf)\n    query &lt;- mongo.bson.from.buffer(buf)\n\n    #Count  \n    count &lt;- mongo.count(mongo, \"items_test.overallitem\", query) \n\n#Note that these counts don't work, since the count should be based on \n#the number of placed_items in the array, and not the number of entries. \n\n    #Setup Cursor\n    cursor &lt;- mongo.find(mongo, \"items_test.overallitem\", query)\n    #Create vectors, which will be filled by the while loop\n    name &lt;- vector(\"character\", count)\n    full_id&lt;- vector(\"character\", count)\n    category_id&lt;- vector(\"character\", count) \n\n    i &lt;- 1\n    #Fill vectors\n    while (mongo.cursor.next(cursor)) {\n        b &lt;- mongo.cursor.value(cursor)\n        order_id[i] &lt;- mongo.bson.value(b, \"name\")\n        product_id[i] &lt;- mongo.bson.value(b, \"placed_items.full_id\")\n        category_id[i] &lt;- mongo.bson.value(b, \"placed_items.category_id\")\n        i &lt;- i + 1\n    }\n    #Convert to dataframe\n    results &lt;- as.data.frame(list(name=name, full_id=full_uid, category_id=category_id))\n</code></pre>\n\n<p>The conditions work and the code works if I would want to extract values on an <code>overallitem</code> level (i.e. <code>_id</code> or <code>name</code>) but fails to gather the information on a <code>placed_items</code> level. Furthermore, the dotted call for extracting <code>full_id</code> and <code>category_id</code> does not seem to work. Can anyone help?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12849623,"title":"In R, how does one place multiple filled.contour() plots in a single device?","body":"<p><code>layout()</code> doesn't cut it, since <code>filled.contour()</code> actually <em>uses</em> <code>layout()</code> to set up the main plot and the legend to the side.  I can always get my plots one by one and combine them with some graphics utility, but it would be more efficient to stay in R if I can.  Any ideas?  Thanks.</p>\n"},{"tags":["c#","visual-studio-2010","r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":87,"score":0,"question_id":12852873,"title":"R.NET With C# Web Application","body":"<p>I am trying to integrate R with C# <strong>Web Application</strong> using R.NET\nI loaded the R.NET dll and called the RDOTNET library in the .cs file which I named as R.cs class. \nThe Code is ::</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing RDotNet;\n\nnamespace Rtrial_1\n{\n    public class R\n    {\n        public R() \n        {\n\n            REngine.SetDllDirectory(@\"C:\\Program Files\\R\\R-2.15.1\\bin\\i386\");\n            using (REngine engine = REngine.CreateInstance(\"RDotNet\", new[] { \"-q\" })) //quiet mode\n            {\n                NumericVector group1 = engine.CreateNumericVector(new double[] { 30.02, 29.99, 30.11, 29.97, 30.01, 29.99 });\n                engine.SetSymbol(\"group1\", group1);\n                NumericVector group2 = engine.EagerEvaluate(\"group2 &lt;- c(29.89, 29.93, 29.72, 29.98, 30.02, 29.98)\").AsNumeric();\n                Console.WriteLine(\"Group1: [{0}]\", string.Join(\", \", group1));\n            }\n\n        } \n    }\n}\n</code></pre>\n\n<p>The Application has failed to start because Rlapack.dll was not found.Re-installing the application may fix this problem. I tired reinstalling the R but it didn't worked out.\nAs well as the bin folder contains the respective dll. </p>\n\n<p>Please someone help me. I am working on VS 2010, R-1.15.1 </p>\n"},{"tags":["r","latex","knitr","lyx"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":109,"score":2,"question_id":12448507,"title":"Error with R function using Knitr in Lyx","body":"<p>I am getting an error when using the summary() function using\nKnitr in Lyx. The functions preceding it works.</p>\n\n<pre><code>&lt;&lt;&gt;&gt;=\nlibrary(faraway)\nhead(teengamb)\nmdl &lt;- lm(gamble ~ sex + status, data=teengamb) \nsummary(mdl)\n@\n</code></pre>\n\n<p>I am inputing this code through Insert Tex Code in Lyx. I just tested I can run summary(teengamb) but not summary(mdl). Both codes work in RStudio.</p>\n\n<p>The error is \"Undefined Control Sequence\" with description \"\\end{verbatim} ...\"</p>\n"},{"tags":["r","igraph","knitr","tkplot"],"answer_count":1,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":105,"score":8,"question_id":12810763,"title":"tkplot in latex via knitr and igraph","body":"<p>This may be a wild strange dream.  I dreampt that I could put a <code>tkplot</code> from <code>igraph</code> inside a latex document via <code>knitr</code>.  I know Yihui is know for animation stuff so I thought maybe this is possible.  A google search didn't show what I was after so here's a non working attempt:</p>\n\n<pre><code>\\documentclass[a4paper]{scrartcl}\n\\begin{document}\n\n&lt;&lt;setup, include=FALSE, cache=FALSE&gt;&gt;=\nlibrary(igraph)\n@\n\n&lt;&lt;network&gt;&gt;=\nedges &lt;- structure(c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \n    \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"A\", \"B\", \"C\", \n    \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"E\", \"G\", \"G\", \"F\", \"H\", \"G\", \n    \"D\", \"J\", \"J\", \"D\", \"B\", \"C\", \"D\", \"I\", \"I\", \"H\", \"A\", \"B\", \"G\", \n    \"I\", \"F\", \"D\", \"F\", \"J\", \"D\", \"B\", \"E\", \"E\", \"A\", \"E\"), .Dim = c(30L, \n    2L), .Dimnames = list(NULL, c(\"person\", \"choice\")))\n\ng &lt;- graph.data.frame(edges, directed=TRUE)\ntkplot(g)\n@ \n\n\\end{document}\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":12850656,"title":"How to subset variable names in R?","body":"<p>I have a data set that looks like this: </p>\n\n<pre><code>head(data)\n                              country      fixef\n1             as.factor(country.x)Albania -0.4446439\n2             as.factor(country.x)Algeria -0.3400060\n3             as.factor(country.x)Andorra -1.0455948\n4              as.factor(country.x)Angola  0.7477114\n5 as.factor(country.x)Antigua and Barbuda -0.1996655\n6           as.factor(country.x)Argentina -0.3404206\n</code></pre>\n\n<p>How can I remove (in R) everything else besides the name of the country, so that it would look like this:</p>\n\n<pre><code>head(data)\n                     country      fixef\n1                    Albania -0.4446439\n2                    Algeria -0.3400060\n3                    Andorra -1.0455948\n4                    Angola   0.7477114\n5        Antigua and Barbuda -0.1996655\n6                  Argentina -0.3404206\n</code></pre>\n\n<p>Thank you,</p>\n\n<p>Antonio Pedro. </p>\n"},{"tags":["r","distribution","declaration"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":88,"score":3,"question_id":12848736,"title":"how to declare a user defined distribution in R","body":"<p>How do you define your own distributions in R?  If I have a distribution that looks something like this:</p>\n\n<pre><code>P(D=0)=2/4, P(D=1)=1/4, P(D=2)=1/4\n</code></pre>\n\n<p>How do I turn that into a distribution I can work with?</p>\n\n<p>In the end, I want to be able to use these and do things involving cdfs, icdfs and pmfs. Like find the probability of 1 through a cdf type thing. And I also need to find out how to graph things. But I was going to ask in smaller steps and try to figure things out in between.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":66,"score":4,"question_id":12849631,"title":"Why does approx return a list rather than a data frame or array?","body":"<p>It makes no sense to me that <code>approx</code> would return a list, since - if I understand it correctly - the two elements of the list that it returns are guaranteed to be numeric and of equal length. Given that, it would seem to make more sense to return an array or a data frame.</p>\n\n<p>I'm writing some functions using <code>approx</code>, and this makes me thing that I don't fully understand how it works. Is there a situation in which a list is necessary, or better?</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":127,"score":1,"question_id":12762431,"title":"Is this the solution to get data from EUROSTAT into R?","body":"<p>I often use data from EUROSTAT and found it quite annoying that the data could not be load straight forwardly into R. I have written this snippet to get any dataset provided by the bulk download facility from EUROSTAT <a href=\"http://epp.eurostat.ec.europa.eu/NavTree_prod/everybody/BulkDownloadListing?sort=1&amp;dir=dic%2Fen\" rel=\"nofollow\">http://epp.eurostat.ec.europa.eu/NavTree_prod/everybody/BulkDownloadListing?sort=1&amp;dir=dic%2Fen</a> </p>\n\n<p>Is there a better way? ..this one worked for me:</p>\n\n<pre><code>    #this library is used to download data from eurostat and to find datasets\n#later extend to extend to find datasets with certain dimensions\n\n#download data from eurostat\n#unpack and convert to dataframe\n#load label descriptions\n#load factors\n#save as r data object\n\ndatasetname=\"ebd_all\"\n\nLANGUAGE=\"en\"\n\ninstall.packages(\"RCurl\")\nlibrary(RCurl)\nlibrary(data.table)\nlibrary(reshape)\nlibrary(stringr)\n\nbaseurl=\"http://epp.eurostat.ec.europa.eu/NavTree_prod/everybody/BulkDownloadListing?sort=1&amp;file=data%2F\"\n\nfullfilename=paste(datasetname,\".tsv.gz\",sep=\"\")\ntemp &lt;- paste(tempfile(),\".gz\",sep=\"\")\ndownload.file(paste(baseurl,fullfilename,sep=\"\"),temp)\ndataconnection &lt;- gzfile(temp)\nd=read.delim(dataconnection)\nlongdata=melt(d,id=colnames(d)[1])\n\nfirstname=colnames(d)[1] # remove .time and count how many headings are there \nfirstname=substr(firstname,1,nchar(firstname)-nchar(\".time\"))\nheadings=toupper(strsplit(firstname,\".\",fixed=TRUE)[[1]])\nheadingcount=length(headings)\ncolnames(longdata)=c(\"dimensions\",\"time\",\"value\")\n\n\n#get the data on the dimension tables\ndf=data.frame(dimensions=as.character(longdata[,\"dimensions\"]))\ndf = transform(df, dimensions= colsplit(dimensions, split = \"\\\\,\",names=headings))\ndimensions=data.table(df$dimensions)\n\n#download the dimension labels - save headings as better variable\ndimfile=paste(\"http://epp.eurostat.ec.europa.eu/NavTree_prod/everybody/BulkDownloadListing?sort=1&amp;file=dic%2F\",LANGUAGE,\"%2Fdimlst.dic\",sep=\"\")\n\ntemp &lt;- paste(tempfile(),\".gz\",sep=\"\")\ndownload.file(dimfile,temp)\ndataconnection &lt;- gzfile(temp)\ndimdata=read.delim(dataconnection,header=FALSE)\ncolnames(dimdata)=c(\"colname\",\"desc\")\nlab=dimdata$desc\nnames(lab)=dimdata$colname\n\n#create  headings that speak for themselves for columns\nspeakingheadings=as.character(lab[headings])\n\n#download factors for each heading and add\nfor(heading in headings){\n  factorfile=paste(\"http://epp.eurostat.ec.europa.eu/NavTree_prod/everybody/BulkDownloadListing?sort=1&amp;file=dic%2F\",LANGUAGE,\"%2F\",tolower(heading),\".dic\",sep=\"\")\n  temp &lt;- paste(tempfile(),\".gz\",sep=\"\")\n  download.file(factorfile,temp)\n  dataconnection &lt;- gzfile(temp)\n  factordata=read.delim(dataconnection,header=FALSE)\n  colnames(factordata)=c(heading,paste(heading,\"_desc\",sep=\"\"))\n  #join the heading to the heading dataset\n  dimensions=merge(dimensions,factordata,by=heading,all.x=TRUE)\n}\n\n\n  #at the end at speaking headings\nsetnames(dimensions,colnames(dimensions)[1:length(speakingheadings)],speakingheadings)\n\n  #add data columns by writing and reading again---FASTER ;-)\ntemp=tempfile()\nvalues=data.frame(value=as.character(longdata$value))\nvalues = transform(values, value= colsplit(value, split = \"\\\\ \",names=c(\"value\",\"flag\")))\nvalues=values$value\nvalues=data.table(values)\n\nvalues$value=as.character(values$value)\nvalues$flag=as.character(values$flag)\nvalues[value==flag,flag:=NA]\nvalues$value=as.double(values$value)\n\neurostatdata=cbind(dimensions,time=longdata$time,values) \nsave(eurostatdata,file=paste(datasetname,\".RData\"))\n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":1,"up_vote_count":15,"down_vote_count":0,"view_count":208,"score":15,"question_id":12096492,"title":"Remove \"floating\" axis labels in facet_wrap plot?","body":"<p>Using facet_wrap in ggplot2 to create a grid, but I have an uneven number of panels so the last row is incomplete. At the bottom of the last, blank panel is the axis ticks and text. Is it possible to shift this axis up (giving the last facet in each column the appearance of having applied free_x)? If not, can I remove it altogether as is seen below?</p>\n\n<p>To clarify with examples, this is what I'm getting:\n<a href=\"http://sape.inf.usi.ch/sites/default/files/ggplot2-facet-wrap.png\">http://sape.inf.usi.ch/sites/default/files/ggplot2-facet-wrap.png</a></p>\n\n<p><img src=\"http://i.stack.imgur.com/jzegM.png\" alt=\"enter image description here\"></p>\n\n<p>I desire something seen here (though, ideally with axis labelling on the facet in column 4):\n<a href=\"http://stackoverflow.com/questions/11979017/changing-facet-label-to-math-formula-in-ggplot2\">Changing facet label to math formula in ggplot2</a></p>\n\n<p><img src=\"http://i.stack.imgur.com/SkzSS.png\" alt=\"enter image description here\"></p>\n\n<p>Thanks for any ideas or insight!</p>\n"},{"tags":["database","r","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":86,"score":-4,"question_id":12845639,"title":"Accessing SQLite Database in R","body":"<p>I want to access and manipulate a large data set in R. Since it's a large CSV file (~ 0.5 GB), I plan to import it<br>\nto SQLite and then access it from R. I know the <code>sqldf</code> and <code>RSQLite</code> packages can do this but I went \nover their manuals and they are not helpful. Being a newbie to SQL doesn't help either.</p>\n\n<p>I want to know do I have to set the R directory to SQLite's and then go from there? How do I read in the database in R then?\nHeck, if you know how to access the DB from R without using SQL, please tell me.</p>\n\n<p>Thanks! </p>\n"},{"tags":["r","printing","ggplot2","ggplot"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":12842567,"title":"ggplot2: suppress drawing of plot when calling print method","body":"<p>As a follow up to <a href=\"http://stackoverflow.com/questions/12828125/ggplot2-reading-maximum-bar-height-from-plot-object-containing-geom-histogram\">this question</a>, suppose I do something like this:</p>\n\n<pre><code>p &lt;- ggplot(mtcars, aes(mpg)) + geom_histogram(aes(y = ..count..)) + facet_wrap(~am)\nr &lt;- print(p)\n</code></pre>\n\n<p>In the second line I'm calling the print method just so that I can programmatically inspect its return value before adding additional layers to the plot object. </p>\n\n<p>My question: Is there a way to suppress drawing the plot at that point?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":12847834,"title":"Write a function that takes two arguments, x and n, and returns h(x, n). using FOR loop","body":"<p>I am trying to write a function in R that takes two arguments, x and n, and returns h(x, n); x=1\nDoes anyone know how to do this using a for loop?</p>\n\n<p>The function I am working with is:\nx^0 + x^1 + x^2...x^n</p>\n\n<p>I have been working for a while on this and am not sure if I am doing this correctly.\nCan anyone give me some guidance on how to do this problem.</p>\n\n<p>Here is what I have..</p>\n\n<pre><code>n = seq(1,6, by = 1)\nx = 1\nh = function (x,n){\n    for (i in 0:n){\n        for( i in 1:n){\n        sum = sum +x^i\n    {\n}}\n</code></pre>\n"},{"tags":["r","classification","decisiontrees"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":864,"score":3,"question_id":9666212,"title":"How to compute error rate from a Decision Tree?","body":"<p>Does anyone know how to calculate the error rate for a decision tree with R?\nI am using the <code>rpart()</code> function</p>\n"},{"tags":["r","plyr"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":81,"score":1,"question_id":12847690,"title":"Calculating the mean, standard error and % in R for a data frame","body":"<p>I have a data frame with following structure, <code>dput(scoreDF)</code>:</p>\n\n<pre><code>scoreDF &lt;- structure(list(ID = c(1, 2), Status = structure(c(2L, 1L),\n  .Label = c(\"Fail\", \"Pass\"), class = \"factor\"), Subject_1_Score = c(100, 25),\n  Subject_2_Score = c(50, 76)), .Names = c(\"ID\", \"Status\", \"Subject_1_Score\",\n  \"Subject_2_Score\"), row.names = c(NA, -2L), class = \"data.frame\")\n</code></pre>\n\n<p>Now, I need to come up with the % of students who passed and failed, mean of the students who passed and failed, standard error for the same.</p>\n\n<p>For standard error, I have defined a function as follows:</p>\n\n<pre><code>stdErr &lt;- function(x) {sd(x)/ sqrt(length(x))}\n</code></pre>\n\n<p>where I expect <code>x</code> to be a vector whose standard error needs to be calculated.</p>\n\n<p>I have seen the doc for <code>ddply</code>, but I am not able to figure out how to calculate the % i.e. (number of passes)/ (total count) and standard error for the data frame above.</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":68,"score":5,"question_id":12847816,"title":"Restructure csv data for r and ggplot2","body":"<p>I'm new to R and ggplot2. I have a csv file with beverage consumption data. The first column is the Year, and then the next 9 columns are beverage types like, coffee, tea, soda, etc., with values for the consumption amount for the year value of that row. The data covers a 41 year period. I've been researching this and trying many things. I can easily create a dot plot for any one type of beverage with ggplot. </p>\n\n<p>However, I want to create horizontal stacked dot plots with Year on the x axis for each plot. So, there'd be a plot for coffee, and then right below it, one for tea, etc. I think I want to use facets. I'm also thinking I want to get my data restructured so it has 3 columns: one for year, one for \"category\" (i.e., coffee, tea, soda, etc.), and the last one for the value. My thinking is that once I get the data in that form, then using faceting should be straight forward.</p>\n\n<p>Problem is, I can't seem to figure out how to get my data in that form.  Here is how the first few rows of the data look:</p>\n\n<pre><code>Year    Whole Milk  Other Milk  Total Milk  Tea Coffee  Diet Soda   Regular Soda    Total Soda  Juice\n1970    25.5    5.8 31.3    6.8 33.4    2.1 22.2    24.3    5.5\n1971    25  6.3 31.3    7.2 32.2    2.2 23.3    25.5    5.8\n1972    24.1    6.9 31  7.3 33.6    2.3 23.9    26.2    6\n</code></pre>\n\n<p>Can someone help me?</p>\n\n<p><code>dput</code> of the data is:</p>\n\n<pre><code>structure(list(Year = 1970:1972, `Whole Milk` = c(25.5, 25, 24.1\n), `Other Milk` = c(5.8, 6.3, 6.9), `Total Milk` = c(31.3, 31.3, \n31), Tea = c(6.8, 7.2, 7.3), Coffee = c(33.4, 32.2, 33.6), `Diet Soda` = c(2.1, \n2.2, 2.3), `Regular Soda` = c(22.2, 23.3, 23.9), `Total Soda` = c(24.3, \n25.5, 26.2), Juice = c(5.5, 5.8, 6)), .Names = c(\"Year\", \"Whole Milk\", \n\"Other Milk\", \"Total Milk\", \"Tea\", \"Coffee\", \"Diet Soda\", \"Regular Soda\", \n\"Total Soda\", \"Juice\"), class = \"data.frame\", row.names = c(NA, \n-3L))\n</code></pre>\n"},{"tags":["r","distance","similarity","cosine"],"answer_count":4,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":3108,"score":1,"question_id":2535234,"title":"Find cosine similarity in R","body":"<p>I'm wondering if there is a built in function in R that can find the cosine similarity (or cosine distance) between two arrays?</p>\n\n<p>Currently, I implemented my own function, but I can't help but think that R should already come with one :)</p>\n\n<p>Thanks,\nDerek</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":86,"score":2,"question_id":12847196,"title":"make paired, inverted histograms","body":"<p>I would like to make paired dotplot histograms for two groups across a set of different tests with the two groups shown in opposite directions on the y-axis. Using this simple data set</p>\n\n<pre><code>dat &lt;- data.frame(score = rnorm(100), group = rep(c(\"Control\", \"Experimental\"), 50), test = rep(LETTERS[1:2], each=50))\n</code></pre>\n\n<p>I can make faceted dotplots like this</p>\n\n<pre><code>ggplot(dat, aes(score, fill=group)) + facet_wrap(~ test) + geom_dotplot(binwidth = 1, dotsize = 1)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/ETyAe.png\" alt=\"faceted dotplot example\"></p>\n\n<p>but I want the Control dots to be pointing down rather than up. Using <a href=\"http://stackoverflow.com/questions/7579995/facet-grid-of-back-to-back-histogram-failing\">this question and answer</a>, I can make a histogram version that looks more or less like what I want</p>\n\n<pre><code>ggplot() + \n  geom_histogram(data=subset(dat, group==\"Experimental\"), aes(score, fill=\"Experimental\", y= ..count..)) +\n  geom_histogram(data=subset(dat, group==\"Control\"), aes(score, fill=\"Control\", y= -..count..)) +\n  scale_fill_hue(\"Group\")\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/AOH9S.png\" alt=\"paired, inverted histograms\">\nbut now the faceting is gone. I know I could do the faceting manually using <code>grid.arrange</code>, but that would be laborious (my actual data set has many tests, not just 2), is there a more elegant solution?</p>\n\n<p>Two follow-up questions:</p>\n\n<ol>\n<li><code>geom_histogram</code> is giving me a warning that says \"Stacking not well defined when ymin != 0\". Does anyone know how \"not well defined\" it is? In other words, is this something I should be concerned about?</li>\n<li>I'd prefer to use dotplot instead of histogram, but the inversion doesn't seem to work for dotplot. Why is that? Any ideas how to get it to work?</li>\n</ol>\n\n<p>Thanks in advance!</p>\n"},{"tags":["r","variables"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":111,"score":0,"question_id":12843456,"title":"How do I make a dummy variable in R?","body":"<p>So, my data set consists of 15 variables, one of them (sex) has only 2 levels. I want to use it as a dummy variable, but the levels are 1 and 2. How do I do this? I want to have levels 0 and 1, but I don't know how to manage this in R!</p>\n"},{"tags":["r","spline"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12846618,"title":"analytical derivative of splinefun()","body":"<p>I'm trying to fit a natural cubit spline to probabilistic data (probabilities that a random variable is smaller than certain values) to obtain a cumulative distribution function, which works well enough using <code>splinefun()</code>:</p>\n\n<pre><code>cutoffs &lt;- c(-90,-60,-30,0,30,60,90,120)\nprobs &lt;- c(0,0,0.05,0.25,0.5,0.75,0.9,1)\nCDF.spline &lt;- splinefun(cutoffs,probs, method=\"natural\")\nplot(cutoffs,probs)\ncurve(CDF.spline(x), add=TRUE, col=2, n=1001)\n</code></pre>\n\n<p>I would then, however, like to use the density function, i.e. the derivative of the spline, to perform various calculations (e.g. to obtain the expected value of the random variable).</p>\n\n<p>Is there any way of obtaining this derivative as a function rather than just evaluated at a discrete number of points via <code>splinefun(x, deriv=1</code>)?</p>\n\n<p><a href=\"https://stat.ethz.ch/pipermail/r-help/2006-March/101901.html\" rel=\"nofollow\">This</a> is pretty close to what I'm looking for, but alas the example doesn't seem to work in R version 2.15.0.</p>\n\n<p>Barring an analytical solution, what's the cleanest numerical way of going about this?</p>\n"}]}
{"total":19203,"page":17,"pagesize":100,"questions":[{"tags":["windows","r","github","ropensci"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":121,"score":0,"question_id":12846817,"title":"From Windows OS to GitHub repositry - install_github() wont work - maybe Rtools related","body":"<p>A: This is the project I've got in mind - (weblink) schamberlain.github.com/2012/10/rgbif-newfxns/</p>\n\n<p>B: Here is their GitHub - <a href=\"https://github.com/ropensci/rgbif\" rel=\"nofollow\">https://github.com/ropensci/rgbif</a></p>\n\n<p>C: My machine: i86-64bit, Windows 7, R. 2.15, RStudio 0.96.330</p>\n\n<p>Following their instructions, I perform the following:</p>\n\n<p>a) Download &amp; Installation of Rtools 2.15 (weblink) cran.r-project.org/bin/windows/Rtools/</p>\n\n<p>this step is plain sorcery to me, I am just following the instructions given in the \"Windows toolset\" appendix (weblink) cran.r-project.org/doc/manuals/R-admin.html#The-Windows-toolset.</p>\n\n<p>In the end I've got this nasty C:\\Rtools folder in my system, and the PATH variables (no idea what this is) are set as the appendix suggest (as far as I can say).</p>\n\n<p>b) in R: library(devtools)</p>\n\n<p>c) in R: install_github(\"rgbif\", \"ropensci\")</p>\n\n<p>This will produce some notification output and ends in this <a href=\"http://pastebin.com/sU3G54SJ\" rel=\"nofollow\">Error message</a> (its a pastebin.com snipet of the output).</p>\n\n<p>I am not sure whether or not it is possible to help with the provided information. Also I am feeling there is something missing between (a) and (b) - b/c I can't see a package 'Rtools' afterwards in R - maybe thats how it's supposed to be, how should I know?</p>\n\n<p>I should add: In my default library folder .../Documents/R/win-library/2.15 there IS afterwards an un-zipped folder \"ropensci-rgbif-60c74ca\" with all the needed files in it! But I can't access it from within R.</p>\n"},{"tags":["r","spatial","correlation"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":12844380,"title":"Testing for Spatial Autocorrelation in a Negative Binomial Regression Model","body":"<p>Currently, I am working on a count data set measuring events in a third-order administrative unit. The frequency of events varies for each third-order administrative unit to account for the variability, I am using a negative binomial regression model. </p>\n\n<p>A crude graphically analysis of the residual of the regression indicates that there is no spatial autocorrelation exists. The goal would be to find a method to assess spatial autocorrelation in a negative binomial regression model, since a regular test of spatial autocorrelation are not feasible (ex. Global Moran's I). Do you have any suggestion?</p>\n"},{"tags":["sql","r","government","census"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":64,"score":-1,"question_id":12843319,"title":"R 2010 census data handling","body":"<p>I'm not sure where the correct place is to ask this question but here goes:</p>\n\n<p>I'm trying to extract some data from the 2010 census, specifically the state-level summary files 1 &amp; 2 (for New Jersey) and put it into R.  Specifically I'm looking for income and family size by city/municipality.</p>\n\n<p>I can download and unzip the files (from here: <a href=\"http://www2.census.gov/census_2010/04-Summary_File_1/New_Jersey/\" rel=\"nofollow\">NJ SF1 File</a>), but I can't figure out how to put the files together for use as they don't seem to have any headings on them.</p>\n\n<p>I'd appreciate any suggestions on how this data is organized and apologize in advance for posting in the incorrect area.</p>\n\n<p>NOTE: I've looked at the <code>usCensus2010</code> package and it might be a good alternative but I'm trying to avoid downloading 2+ GB and doing an install from source if possible.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12837142,"title":"error with dynGraph package","body":"<p>The <code>acp</code> object in the R code below is the ouput of a <code>PCA()</code> call. Do you have any idea about the cause of the error ?</p>\n\n<pre><code>&gt; library(dynGraph)\nLoading required package: rJava\n&gt; dynGraph(acp)\nError in .jinit(classpath = paste(dir, \"dynGraph.jar\", sep = \"\")) :\n  Cannot create Java virtual machine (-4)\n</code></pre>\n\n<p><strong>EDIT:</strong> Below is an example producing another error:</p>\n\n<pre><code>library(FactoMineR)\nlibrary(dynGraph)\n\nD &lt;- scan()\n3 -2 -1\n2 -1 -3\n1 2 -3\n-3 1 2\n-2 0 3\n\nD &lt;- as.data.frame(matrix(D, byrow=TRUE, ncol=3))\nnames(D) &lt;- c(\"x\",\"y\",\"z\")\nrownames(D) &lt;- LETTERS[1:nrow(D)]\n\nacp &lt;- PCA(D,  \n    scale.unit=FALSE,\n    ncp=2, graph=FALSE)\n\ndynGraph(acp)\n\n&gt; dynGraph(acp)\nError in .jcall(obj, , \"addVal\", annot[1, 1], tab) : \n  java.lang.AbstractMethodError: org.apache.xerces.dom.DeferredTextImpl.getTextContent()Ljava/lang/String;\n</code></pre>\n\n<p><strong>EDIT:</strong> In fact dynGraph works well with the previous example when simply typing:</p>\n\n<pre><code>dynGraph(D)\n</code></pre>\n\n<p>So I suspect the errors are due to a bad practice ?</p>\n\n<p><strong>EDIT:</strong> Below is the sessionInfo() output:</p>\n\n<pre><code>&gt; sessionInfo()\nR version 2.15.1 (2012-06-22)\nPlatform: i386-pc-mingw32/i386 (32-bit)\n\nlocale:\n[1] LC_COLLATE=English_United Kingdom.1252  LC_CTYPE=English_United Kingdom.1252   \n[3] LC_MONETARY=English_United Kingdom.1252 LC_NUMERIC=C                           \n[5] LC_TIME=English_United Kingdom.1252    \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] dynGraph_1.05        rJava_0.9-3          FactoMineR_1.20      scatterplot3d_0.3-33 cluster_1.14.2      \n[6] lattice_0.20-10      ellipse_0.3-7       \n\nloaded via a namespace (and not attached):\n[1] grid_2.15.1  tools_2.15.1\n</code></pre>\n"},{"tags":["r","lazy-evaluation","ellipsis"],"answer_count":2,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":99,"score":7,"question_id":12845747,"title":"Why doesn't lazy evaluation work in this R function?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4682709/how-to-write-an-r-function-that-evaluates-an-expression-within-a-data-frame\">How to write an R function that evaluates an expression within a data-frame</a>  </p>\n</blockquote>\n\n\n\n<p>I want to write a function that sorts a data.frame -- instead of using the cumbersome order().  Given something like</p>\n\n<pre><code>&gt; x=data.frame(a=c(5,6,7),b=c(3,5,1))\n&gt; x\n  a b\n1 5 3\n2 6 5\n3 7 1\n</code></pre>\n\n<p>I want to say something like:</p>\n\n<pre><code>sort.df(x,b)\n</code></pre>\n\n<p>So here's my function:</p>\n\n<pre><code>sort.df &lt;- function(df, ...) {\n  with(df, df[order(...),])\n}\n</code></pre>\n\n<p>I was really proud of this.  Given R's lazy evaluation, I figured that the ... parameter would only be evaluated when needed -- and by that time it would be in scope, due to 'with'.</p>\n\n<p>If I run the 'with' line directly, it works.  But the function doesn't.</p>\n\n<pre><code>&gt; with(x,x[order(b),])\n  a b\n3 7 1\n1 5 3\n2 6 5\n&gt; sort.df(x,b)\nError in order(...) : object 'b' not found\n</code></pre>\n\n<p>What's wrong and how to fix it?  I see this sort of \"magic\" frequently in packages like plyr, for example.  What's the trick?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":72,"score":0,"question_id":12844316,"title":"Align text when using tableGrob or grid.table in R","body":"<p>When creating a table using tableGrob or grid.table.\nIs there way to align the text inside the table? First column to the left, and the other columns to the right? Rather than the default \"center\".</p>\n\n<p>Thank you!</p>\n\n<p>something like this: where I want column \"a\" alligned to the left.</p>\n\n<pre><code>a&lt;-c(\"one\",\"two\",\"thirty five\")\nb&lt;-c(1, 2, 3)\nc&lt;-c(4, 5, 6)\ndata&lt;-data.frame(a,b,c)\nwindows()\ngrid.table(data,gpar.coretext=gpar(fontsize = 12),            \n           gpar.coltext = gpar(fontsize = 12),            \n           gpar.rowtext = gpar(fontsize = 12),            \n           gpar.corefill = gpar(fill = \"green\", alpha = 0.5, col = NA),           \n           h.even.alpha = 0.5,            \n           equal.width = FALSE,            \n           show.rownames = FALSE,            \n           show.vlines = TRUE,           \n           padding.h = unit(15, \"mm\"),            \n           padding.v = unit(8, \"mm\")            ) \n</code></pre>\n"},{"tags":["r","github","ropensci"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12829100,"title":"Error when using install_github: 'exdir' does not exist","body":"<p>I am trying to install a package from github, but keep getting the following error;</p>\n\n<pre><code>\"Error in unzip(src, list = TRUE) : 'exdir' does not exist\".\n</code></pre>\n\n<p>I'm guessing that unzip doesn't have permission to create a directory to unzip into, but I don't know a way to pass a parameter in to the exdir argument.</p>\n\n<pre><code>&gt; require(devtools)\n&gt; install_github(\"rvertnet\", \"ropensci\")\n\nInstalling github repo(s) rvertnet/master from ropensci\nInstalling rvertnet.zip from https://api.github.com/repos/ropensci/rvertnet/zipball/master\nError in unzip(src, list = TRUE) : 'exdir' does not exist\n</code></pre>\n\n<p>This is my first time installing from github, so I may be missing something really simple.  I did try with other packages (<code>ggplot2</code>) and got the same error.</p>\n\n<p>Edit: added results from <code>sessionInfo()</code>:</p>\n\n<pre><code>&gt; sessionInfo()\nR version 2.15.1 (2012-06-22)\nPlatform: i386-pc-mingw32/i386 (32-bit)\n\nlocale:\n[1] LC_COLLATE=English_Canada.1252  LC_CTYPE=English_Canada.1252   LC_MONETARY=English_Canada.1252\n[4] LC_NUMERIC=C                    LC_TIME=English_Canada.1252    \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] devtools_0.8\n\nloaded via a namespace (and not attached):\n[1] digest_0.5.2    evaluate_0.4.2  httr_0.1.1      memoise_0.1     parallel_2.15.1 plyr_1.7.1     \n[7] RCurl_1.91-1.1  stringr_0.6.1   tools_2.15.1    whisker_0.1\n</code></pre>\n\n<p>I have set my <code>TMP</code>, <code>TMPDIR</code>, and <code>TEMP</code> to a writeable folder via renviron.site:</p>\n\n<pre><code>&gt; Sys.getenv(c(\"TMP\",\"TEMP\",\"TMPDIR\"))\n          TMP          TEMP        TMPDIR \n\"H:\\\\R\\\\temp\" \"H:\\\\R\\\\temp\" \"H:\\\\R\\\\temp\"\n</code></pre>\n"},{"tags":["r","plot"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":734,"score":1,"question_id":6174439,"title":"Include small table in legend in R graphics","body":"<p>I am plotting a dotplot for sales for companies grouped by countries. So my code is <code>dotchart(sales, labels=company, groups=country, data=mydata)</code>. I have also created a table of mean sales values by country. Is there any way to include this table as legend inside the dotplot?</p>\n\n<p>Four hours later... I just stumbled upon a really neat way of adding tabular information to plots using the <code>addtable2plot</code> command in the <code>plotrix</code> package. Following up on chl's example:</p>\n\n<pre><code>res &lt;- matrix(nc=3, nr=4)\nfor (i in 1:4) res[i,] &lt;- tapply(iris[,i], iris[,5], mean)\ncolnames(res) &lt;- levels(iris[,5])\nrownames(res) &lt;- colnames(iris)[1:4]\n\nlibrary(plotrix)\ndotchart(res, auto.key=list(position=\"top\", column=3), xlab=\"Mean\"); addtable2plot(3,15, res, cex=.8)\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":59,"score":4,"question_id":12844585,"title":"R grouping by date ranges","body":"<p>This would seem to be a simple task but I'm having difficulty executing it as well as finding examples of how it is done in R.</p>\n\n<p>I have a data frame with about 75K records. One field has dates and it goes back about 11 years.  I've used the following code to strip off the hours minutes seconds so I just have year-month-day</p>\n\n<pre><code> dat$date=round.POSIXt(dat$date,units=\"day\")\n</code></pre>\n\n<p>I am now trying to create a new field \"FiscalYear\" based on dates such that if the date is between 2008-07-01 and 2009-06-30 it gets assigned FY09...then between 2009-07-01 and 2010-06-30 it gets assigned to FY10, etc...</p>\n\n<p>The method I've been trying is with ifelse using >= &amp;&amp; &lt;= to set the date ranges but this isn't working.  Any thoughts?</p>\n"},{"tags":["r","reshape","reshape2"],"answer_count":3,"favorite_count":0,"up_vote_count":10,"down_vote_count":0,"view_count":116,"score":10,"question_id":12837609,"title":"Reshaping a data frame with more than one measure variable","body":"<p>I'm using a data frame similar to this one:</p>\n\n<pre><code>df&lt;-data.frame(student=c(rep(1,5),rep(2,5)), month=c(1:5,1:5),  \n      quiz1p1=seq(20,20.9,0.1),quiz1p2=seq(30,30.9,0.1),  \n      quiz2p1=seq(80,80.9,0.1),quiz2p2=seq(90,90.9,0.1))      \n\nprint(df)  \n\n   student month quiz1p1 quiz1p2 quiz2p1 quiz2p2  \n1     1     1    20.0    30.0    80.0    90.0  \n2     1     2    20.1    30.1    80.1    90.1  \n3     1     3    20.2    30.2    80.2    90.2  \n4     1     4    20.3    30.3    80.3    90.3\n5     1     5    20.4    30.4    80.4    90.4\n6     2     1    20.5    30.5    80.5    90.5\n7     2     2    20.6    30.6    80.6    90.6\n8     2     3    20.7    30.7    80.7    90.7\n9     2     4    20.8    30.8    80.8    90.8\n10    2     5    20.9    30.9    80.9    90.9\n</code></pre>\n\n<p>Describing grades received by students during five months – in two quizzes divided into two parts each.</p>\n\n<p>I need to get the two quizzes into separate rows – so that each student in each month will have two rows, one for each quiz, and two columns – for each part of the quiz.\nWhen I melt the table:</p>\n\n<pre><code>melt.data.frame(df, c(\"student\", \"month\"))\n</code></pre>\n\n<p>I get the two parts of the quiz in separate lines too.</p>\n\n<pre><code>dcast(dfL,student+month~variable)\n</code></pre>\n\n<p>of course gets me right back where I started, and I can't find a way to cast the table back in to the required form.\nIs there a way to make the melt command function something like: </p>\n\n<pre><code>melt.data.frame(df, measure.var1=c(\"quiz1p1\",\"quiz2p1\"), \n                measure.var2=c(\"quiz1p2\",\"quiz2p2\"))  \n</code></pre>\n"},{"tags":["r","indexing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":44,"score":-1,"question_id":12843437,"title":"Simplify function and runtime in R","body":"<p>I have 2 dataframes:</p>\n\n<p>this structure is for both dataframes, but one of them is larger(rowwise) than the other\nshuffleddf1 is larger than df2</p>\n\n<blockquote>\n  <p>structure(list(V1 = c(0, 0, 0, 0, 0, 0), V2 = c(1,  2,\n  3, 4, 5, 6), V3 = c(0.376, 0.736, \n  0.2376, 0.203, 0.188, 0.7771 )), .Names = c(\"V1\", \"V2\", \"V3\"), row.names = c(NA, 6L), class = \"data.frame\")</p>\n</blockquote>\n\n<pre><code>shuffleddf1\n\nV1 V2 V3\n0  0  0.342\n0  1  0.254\n0  2  0.512\n0  3  0.134\n\n       df2\n\nV1 V2 V3\n0  0  0.154\n0  1  0.541\n0  2  0.356\n0  3  0.124\n</code></pre>\n\n<p>i have the following function that will count the value of V3 depending on some conditions in both dataframes.</p>\n\n<pre><code>fres = NULL\npcmp&lt;-function(shuffleddf1,df2,v1,v2,v3)\n{\n    for(d1 in 1:nrow(shuffleddf1))\n    {\n        for(d2 in 1:nrow(df2))\n        {   \n        if(shuffleddf1[d1,]$v1 == df2[d2,]$v1) &amp;&amp; (shuffleddf1[d1,]$v2 == df2[d2,]$v2)\n            {\n                cv3 = count(shuffleddf1$v3, shuffleddf1$v3 &gt;= df2$v3)\n                p = cv3/nrow(shuffleddf1$v3)\n                fres &lt;- rbind(fres, data.frame(nv1=shuffleddf1$v1, nv2=shuffleddf1$v2, np=p))\n            }   \n        }   \n    }\n}\n</code></pre>\n\n<p>but the dataframes are so big, and this function will take to much time.</p>\n\n<p>is there anyway to perform the same acrions performed in the function but in a more indexed and fast way ??</p>\n"},{"tags":["r","regression","linear-regression"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12844302,"title":"Regression Lines With Same Intercept","body":"<p>So, I struggle with Regression a lot. I just found out how to get 2 lines with the same slope, but I cannot manage to get 2 lines with the same intercept. I read about ANCOVA a lot (because I thought this was what I needed), but no one uses the same intercepts; just the same slope.\nCan someone help out with this?</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":12843952,"title":"How to set up y variable for rpart method = poisson?","body":"<p>I want to build a prediction  tree for count data using rpart. I have a data set where the dependent variable (the variable I want to predict) variable is a number of times a certain\nquestion on a survey received a \"yes\" answer. The surveys pertain to\nevents that may be attended by one person or multiple people. Sometimes we get\nonly 1 survey per event. Sometimes several different people who participated in\nthe same event fill out surveys (one survey per person).</p>\n\n<p>I want to use the number of \"yes\" answers that  an event received as the dependent variable and use a bunch of other variables (some categorical and some numerical) as predictors. Clearly, the\nnumber of \"yes\" votes an event receives depends on how many surveys we have filled out for that\nevent (in addition to potentially depending on other predictors, such as where\nit was held, what kind of event, etc.) because if we had only 1 survey, then we\ncan only get a maximum of 1 \"yes\" answer, while if we got 3 surveys for an event\nwe can get up to 3 \"yes\" votes. I get an impression that I should use \"poisson\" method in rpart and make \"y variable\" be a 2 column data frame with column 1 being the number of \"yes\" votes we\ngot  for a given individual event and the column 2 being the number of surveys filled out for that event.</p>\n\n<p>Is this a correct approach? </p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":82,"score":3,"question_id":12829995,"title":"This R reshaping should be simple, but","body":"<p>I have what should be a simple reshaping problem, but I can't figure it out. Part of my data looks like this:</p>\n\n<pre><code>foo &lt;- structure(list(grade = c(3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, \n3, 3, 4, 4, 5, 5, 6, 6), var.type = structure(c(3L, 2L, 3L, 2L, \n3L, 2L, 3L, 2L, 3L, 2L, 3L, 2L, 3L, 2L, 3L, 2L, 3L, 2L, 3L, 2L\n), .Label = c(\"Raw Score\", \"SE\", \"SS\"), class = \"factor\"), var.val = c(120L, \n47L, 120L, 46L, 120L, 46L, 120L, 47L, 120L, 46L, 120L, 46L, 120L, \n12L, 120L, 14L, 120L, 16L, 120L, 20L)), .Names = c(\"grade\", \"var.type\", \n\"var.val\"), row.names = c(2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, \n11L, 12L, 13L, 15L, 16L, 17L, 18L, 19L, 20L, 21L, 22L), class = \"data.frame\")\n</code></pre>\n\n<p>or </p>\n\n<pre><code>  grade var.type var.val\n2     3       SS     120\n3     3       SE      47\n4     4       SS     120\n5     4       SE      46\n6     5       SS     120\n7     5       SE      46\n</code></pre>\n\n<p>I want to make it look like this:</p>\n\n<pre><code>grade    SS    SE\n3        120   47\n4        120   46\n5        120   46\n</code></pre>\n\n<p>and so on. I have tried reshape, cast, and dcast as in this thread:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/10130579/reshaping-dataset\">Reshaping dataset</a></p>\n\n<p>but nothing seems to work. I would really appreciate some help. TIA.</p>\n"},{"tags":["r","header","matrix"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":97,"score":-3,"question_id":12807493,"title":"Add a name to the column header for an existing matrix in r","body":"<p>I have a headered matrix and I would like to add the word \"genes\" to the first position in the column header for the matrix, basically attaching that word to the beginning of the column header.  </p>\n\n<p>Here is what I have so far:\nI input a matrix into R, </p>\n\n<pre><code>matrix_a &lt;- read.table(args[1], sep='\\t', header=T, row.names=1);\n</code></pre>\n\n<p>and generate a heatmap from that matrix, using heatmap.2.  I then extract the data for the corresponding heatmap using the carpet variable.</p>\n\n<p>Here is the code used to generate the heatmap:</p>\n\n<pre><code>result &lt;- heatmap.2(mtscaled, Rowv=T, scale='none', dendrogram=\"row\", symm = T, col=bluered(16), breaks = my.breaks)\n</code></pre>\n\n<p>Here I am extracting the values for the clustered matrix, after passing the original matrix through heatmap.2: </p>\n\n<pre><code>new_matrix &lt;- result$carpet\nold_name &lt;- colnames(new_matrix)\n</code></pre>\n\n<p>Here I am trying to attach the name \"genes\" to the column name</p>\n\n<pre><code>old_name &lt;- cat(\"genes\",old_name)\ncolnames(new_matrix) &lt;- old_name;\nwrite.table(new_matrix, file=\"data_result3.txt\",sep = \" \\t\",col.names = T, row.names = T);\n</code></pre>\n\n<p>When I try to attach \"genes\" to the header using:</p>\n\n<pre><code>old_name &lt;- cat(\"genes\",old_name)\n</code></pre>\n\n<p>The headers are printed out to the screen properly, \nbut when I examine the result file the vector number is printed:</p>\n\n<p>\"V1\"    \"V2\"    \"V3\"    \"V4\"    \"V5\"    \"V6\"  </p>\n\n<p>Instead I would like the result to look like:</p>\n\n<p>genes   Pacs-11 Pacs-2  PC06E7.3    PC49C3.3    Pceh-60 PF52C6.12</p>\n\n<p>In this way genes comes before the rest of the matrix header.</p>\n\n<p>Here is a link to my dataset:\n<a href=\"http://pastebin.com/xaXbPpFM\" rel=\"nofollow\">Full Dataset</a></p>\n\n<p>Here is the dataSet after running <code>dput(head(new_matrix))</code>\n<a href=\"http://pastebin.com/gN8vy6Hu\" rel=\"nofollow\">output of dput</a></p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12843452,"title":"Simulate ARFIMA process with custom initial values","body":"<p>My question deals with the <strong>fracdiff.sim</strong> function in <strong>R</strong> (in the fracdiff package) for which the help document, just like for <strong>arima.sim</strong>, is not really clear concerning initial values.</p>\n\n<p>It's ok that stationary processes do not depend on their initial values when time grows, but my aim is to see in my simulations the return of my long memory process (fitted with <strong>arfima</strong>) to its mean.</p>\n\n<p>Therefore, I need to input at least the p final values of my <em>in-sample</em> process (and eventually q innovations) if it is ARFIMA(p,d,q). In other words, I would like to set the burn-in period's length to 0 and give starting values instead.</p>\n\n<p>Nevertheless, I'm currently not able to do this. I know that <strong>fracdiff.sim</strong> makes it possible for the user to chose the length of a <em>burning period</em> (which leads to the stationnary behavior) and the mean of the simulated process (it is simulated and then translated to make the means match). There is also a condition: the length of the burn-in period must be >= p+q. What I suppose is that there is something to do with the <strong>innov</strong> argument but I'm really not sure.</p>\n\n<p>This idea is inspired by the <strong>arima.sim</strong> function which has a <strong>start.innov</strong> argument. However, even if my aim was to simulate an ARMA(p,q), I'm not sure of the exact use of this argument (the help is quite poor) : must we input only q innovations ? put with them the p last values of the in-sample process ? In which order ?</p>\n\n<p>To sum up, I want to simulate ARFIMA processes starting from a specific value and having a specific mean in order to see the return to the mean and not only the long term behavior. I fund beginnings of solutions for arima.sim on the internet but nobody clearly answered, and if the solution uses <strong>start.innov</strong>, how to solve the problem for ARFIMA processes (<strong>fracdiff.sim</strong> doesn't have the <strong>start.innov</strong> argument) ?</p>\n\n<p>Hopping I have been clear enough,</p>\n"},{"tags":["r","ggplot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":62,"score":-1,"question_id":12827974,"title":"ggplot: facet_grid and geom_text","body":"<p>I am not able to combine <code>facet_grid</code> and <code>geom_text</code> (that I use to label plotted data). And I do not understand the error message (see (7) and (8)).</p>\n\n<p>Actually I thought this to be a good idea</p>\n\n<pre><code>  ggplot (data=cdata) + geom_segment (aes (x=start.ens, xend=end.ens, yend=0, y=peak), \n                                           color =\"red\") +  \n                        geom_text(aes (x=start.ens, xend=end.ens,yend=0, y=0, \n                                          label = plabel, size=3)) +  \n                       geom_point (aes (x=start.ens, y=fc.trans)) + \n                       facet_grid (type~., scales=\"free_y\")\nFehler in unit(x, default.units) : 'x' and 'units' must have length &gt; 0\n</code></pre>\n\n<p>But I get a white R Graphic response. So it did not work. At the end of the mail I checked each \"motif\" of my syntax (see (1) to (6). It worked. But I am not able to combine <code>facet_grid</code> and <code>geom_text</code>. Does anybody have helpful instructions?</p>\n\n<pre><code>&gt; dput (test)\nstructure(list(illu.id = c(\"ILMN_1245389\", \"ILMN_1256699\", NA, \nNA, NA, NA, NA, NA, NA), targetid = c(\"LOC236604\", \"SFI1\", NA, \nNA, NA, NA, NA, NA, NA), transcript.id = c(\"ENSMUST00000132408\", \n\"ENSMUST00000137633\", NA, NA, NA, NA, NA, NA, NA), start.ens = c(3125936L, \n3142378L, 3333333L, 11088023L, 11867948L, 11940898L, 12367448L, \n12376673L, 14181873L), fc.trans = c(0.8656, 0.7751, NA, NA, NA, \nNA, NA, NA, NA), fc.trans.diff = c(-0.00859999999999994, -0.0514000000000001, \nNA, NA, NA, NA, NA, NA, NA), diff.quad = c(7.3959999999999e-05, \n0.00264196000000001, NA, NA, NA, NA, NA, NA, NA), type = c(\"Expression\", \n\"Expression\", \"p300\", \"p300\", \"p300\", \"p300\", \"p300\", \"p300\", \n\"p300\"), plabel = c(NA, NA, 1L, 2L, 3L, 4L, 5L, 6L, 7L), end.ens = c(NA, \nNA, 3333433L, 11088523L, 11868673L, 11941848L, 12368073L, 12377048L, \n14182823L), peak = c(NA, NA, 8L, 7L, 8L, 8L, 12L, 7L, 10L)), .Names = c(\"illu.id\", \n\"targetid\", \"transcript.id\", \"start.ens\", \"fc.trans\", \"fc.trans.diff\", \n\"diff.quad\", \"type\", \"plabel\", \"end.ens\", \"peak\"), row.names = c(1L, \n2L, 4L, 5L, 6L, 7L, 8L, 9L, 10L), class = \"data.frame\")\n&gt; test\n        illu.id  targetid      transcript.id start.ens fc.trans fc.trans.diff\n1  ILMN_1245389 LOC236604 ENSMUST00000132408   3125936   0.8656       -0.0086\n2  ILMN_1256699      SFI1 ENSMUST00000137633   3142378   0.7751       -0.0514\n4          &lt;NA&gt;      &lt;NA&gt;               &lt;NA&gt;   3333333       NA            NA\n5          &lt;NA&gt;      &lt;NA&gt;               &lt;NA&gt;  11088023       NA            NA\n6          &lt;NA&gt;      &lt;NA&gt;               &lt;NA&gt;  11867948       NA            NA\n7          &lt;NA&gt;      &lt;NA&gt;               &lt;NA&gt;  11940898       NA            NA\n8          &lt;NA&gt;      &lt;NA&gt;               &lt;NA&gt;  12367448       NA            NA\n9          &lt;NA&gt;      &lt;NA&gt;               &lt;NA&gt;  12376673       NA            NA\n10         &lt;NA&gt;      &lt;NA&gt;               &lt;NA&gt;  14181873       NA            NA\n    diff.quad       type plabel  end.ens peak\n1  0.00007396 Expression     NA       NA   NA\n2  0.00264196 Expression     NA       NA   NA\n4          NA       p300      1  3333433    8\n5          NA       p300      2 11088523    7\n6          NA       p300      3 11868673    8\n7          NA       p300      4 11941848    8\n8          NA       p300      5 12368073   12\n9          NA       p300      6 12377048    7\n10         NA       p300      7 14182823   10\n</code></pre>\n\n<p>Now I am trying some plots. Number 7 and 8 do not work (white screen) though the motifs work (see number 1 to 6).</p>\n\n<p>(1) </p>\n\n<pre><code>p &lt;- ggplot (data=test) + geom_segment (aes (x=start.ens, xend=end.ens, yend=0, y=peak), color =\"red\")\n</code></pre>\n\n<p>(2)</p>\n\n<pre><code>pt &lt;- p + geom_text(aes (x=start.ens, xend=end.ens,yend=0, y=0, label = plabel, size=3))\n</code></pre>\n\n<p>(3)</p>\n\n<pre><code> e &lt;- ggplot (data=test) + geom_point (aes (x=start.ens, y=fc.trans))\n</code></pre>\n\n<p>(4) </p>\n\n<pre><code>et &lt;- e + geom_text(aes( x=start.ens, y=fc.trans, label=transcript.id, size=3))\n</code></pre>\n\n<p>(5) </p>\n\n<pre><code>pe &lt;- p+ geom_point (aes (x=start.ens, y=fc.trans))\n</code></pre>\n\n<p>(6) </p>\n\n<pre><code>pef &lt;- pe + facet_grid (type~., scales=\"free_y\")\n</code></pre>\n\n<p>(7) </p>\n\n<pre><code>peft &lt;- pef + geom_text(aes (x=start.ens, xend=end.ens,yend=0, y=0, label = plabel, size=3))\n&gt; peft\n\nFehler in unit(x, default.units) : 'x' and 'units' must have length &gt; 0\n</code></pre>\n\n<p>(8) </p>\n\n<pre><code>petf &lt;- pef +  geom_text(aes( x=start.ens, y=fc.trans, label=transcript.id, size=3))\n&gt; petf\nFehler in unit(x, default.units) : 'x' and 'units' must have length &gt; 0\n</code></pre>\n"},{"tags":["r","string-matching","subset"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":65,"score":3,"question_id":12837462,"title":"How to subset data with advance string matching","body":"<p>I have the following data frame from which I would like to extract rows based on matching strings.</p>\n\n<pre><code>&gt; GEMA_EO5\ngene_symbol  fold_EO  p_value                           RefSeq_ID      BH_p_value\n       KNG1 3.433049 8.56e-28              NM_000893,NM_001102416    1.234245e-24\n      REXO4 3.245317 1.78e-27                           NM_020385    2.281367e-24\n      VPS29 3.827665 2.22e-25                 NM_057180,NM_016226    2.560770e-22\n    CYP51A1 3.363149 5.95e-25              NM_000786,NM_001146152    6.239386e-22\n      TNPO2 4.707600 1.60e-23 NM_001136195,NM_001136196,NM_013433    1.538000e-20\n      NSDHL 2.703922 6.74e-23              NM_001129765,NM_015922    5.980454e-20\n     DPYSL2 5.097382 1.29e-22                           NM_001386    1.062868e-19\n</code></pre>\n\n<p>So I would like to extract e.g. two rows based on matching strings in $RefSeq_ID, that works fine with the following:</p>\n\n<pre><code>&gt; list&lt;-c(\"NM_001386\", \"NM_020385\")\n&gt; GEMA_EO6&lt;-subset(GEMA_EO5, GEMA_EO5$RefSeq_ID %in% list, drop = TRUE)\n\n&gt; GEMA_EO6\n\ngene_symbol  fold_EO  p_value RefSeq_ID    BH_p_value\n      REXO4 3.245317 1.78e-27 NM_020385  2.281367e-24\n     DPYSL2 5.097382 1.29e-22 NM_001386  1.062868e-19\n</code></pre>\n\n<p>But some of the rows have several RefSeq_IDs separated with commas, so I am looking for a general way of telling if $RefSeq_ID contains a certain string pattern and then subset that row.</p>\n"},{"tags":["r","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12834861,"title":"Access local dataframe outside the function in R","body":"<p>I created a function that will fill a data frame but I forgot to write <code>return df1</code> at the end of the function. and the script takes too long to finish. so it's not feasible to rerun it again.</p>\n\n<p>the function does something like that:</p>\n\n<blockquote>\n  <p>df &lt;- function(df1){</p>\n  \n  <p>.... some operations on df1</p>\n  \n  <p>return df1</p>\n  \n  <p>}</p>\n</blockquote>\n\n<p>Is there any way that I can access this dataframe from inside the function and then apply more tests on it normally as a global one?</p>\n\n<p>Maybe something like this: <code>myfunc.df1</code></p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12842940,"title":"Define Factor variable with unobserved levels","body":"<p>I'm working with a dataset that has the following structure...</p>\n\n<pre><code>grades &lt;- c(\"7A\", \"8B\", \"6C\", \"6B+\")\n</code></pre>\n\n<p>...however there are a number of currently unobserved levels not in my dataset.  But I do not wish to have the factors defined automatically (so am using read.csv(..., stringsAsFactors=FALSE) when reading in my data). I would like to explicitly define the levels and their labels and convert the imported strings to be an ordered factor so that all grades are represented with associated counts of zero if none are observed.</p>\n\n<pre><code>real.grades  &lt;- ordered(x = character(), \n                        levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17),                       \n                        labels = c(\"6A\", \"6A+\", \"6B\", \"6B+\", \"6C\", \"6C+\", \"7A\", \"7A+\", \"7B\", \"7B+\", \"7C\", \"7C+\", \"8A\", \"8A+\", \"8B\", \"8B+\", \"8C\"))\n</code></pre>\n\n<p>...but am struggling as to how to do this?</p>\n\n<p>Suggestions and pointers gratefully received, thanks in advance.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12842151,"title":"Initializing and Appending to a data.frame in R","body":"<p>I'm trying to initialize a data.frame with 2 columns and 40 rows to which I'll go on adding rows. This is the code that I have - </p>\n\n<pre><code>result.frame = as.data.frame(matrix(ncol=2, nrow=10))\nnames(result.frame) = c(\"ID\", \"Value\")\nfor (i in 1:10) {\n    value = somefunction(i)\n    rbind(result.frame, c(i, value))\n}\n</code></pre>\n\n<p>When I run this, I'm just getting a data.frame containing NA. Also, I read on SO that dynamically growing structures is one of the least efficient ways to code in R. If this is true, what is the right way to accomplish something like this?</p>\n\n<p>Thanks a lot!</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":81,"score":1,"question_id":12805793,"title":"OLS estimation with AR(1) term","body":"<p>For reasons that I cannot explain (because I can't, not because I don't want to), a process used at my office requires running some regressions on Eviews.</p>\n\n<p>The equation specification used on Eviews is:</p>\n\n<pre><code>dependent_variable c independent_variable ar(1)\n</code></pre>\n\n<p>Furthermore, the process used is \"NLS and ARMA.\"</p>\n\n<p>I don't use Eviews but, as I understand it, that equation means an OLS regression with a constant, one independent variable and an AR(1) term.\nI tried running this in R:</p>\n\n<pre><code>result &lt;- lm(df$dependent[2:48] ~ df$independent[1:47] + df$dependent[1:47])\n</code></pre>\n\n<p>Where df is a data.frame containing the dependent and independent variables (both spanning 48 observations).</p>\n\n<p>Am I doing it right? Because the parameter estimations, while similar, are different in Eviews. Different enough that I cannot use them.</p>\n\n<p>I've thoroughly searched the internet for what this means. I've read up on ARIMA and ARMAX models but I don't think that this is it. I'm sorry but I'm not that knowledgeable on statistics. By the way, estimating ARMAX models seems very complicated and is done by ML, not LS, so I'm really hoping that's not it.</p>\n\n<p>EDIT: I had to edit the model indexes <em>again</em> because I messed them up, <em>again</em>.</p>\n"},{"tags":["r","conditional","data.frame"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12840216,"title":"Adding columns with condition check on row name","body":"<p>I am having troubles adding column conditionally to a df.  For instance, I would like to add class values to column VarB and VarC according to the value of Var A.</p>\n\n<p>For instance, I would like to add 'yes' to VarB when VarA equals \"a\", \"c\" and \"e\" and \"no\" when it equals \"b\" and \"d\".  Also, I would like to add \"1\" to  VarC when VarA equals \"a\" or \"e\"; \"2\" to VarC when VarA equals \"b\" or \"d\"; and, \"3\" to VarC when VarA equals \"c\".</p>\n\n<pre><code>VarA\n a     \n b     \n c     \n d     \n e \n</code></pre>\n\n<p>Any tips?</p>\n"},{"tags":["image","r","plot","tiff","lines"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":81,"score":3,"question_id":12839684,"title":"Vertical white lines when plotting heatmap in TIFF","body":"<p>When I plot a <code>matrix</code> with the <code>image</code> function as a TIFF file, I often get vertical or horizontal lines. </p>\n\n<p>My matrix is of 150000 rows x 2000 columns, the lines also appears when plotting matrices of 150000 rows x 100 columns.  The results are the same. </p>\n\n<p>Where do the lines come from? Is this some sort of pixelated artifact? I get them almost all the time.</p>\n\n<p>The matrix looks like this:</p>\n\n<pre><code>    V999 V1000 V1001 V1002 V1003 V1004 V1005 V1006 V1007 V1008 V1009 V1010\n[1,]    1     4     0     0    15    15    15    15     8     0     1     0\n[2,]    0     3    12     5    15    15    15     1    15     4     0     2\n[3,]    0     0     0     3     6    15    15    15    15    15     0     3\n[4,]    3     6    15    15    15    15    15     0     3    15    15     2\n[5,]   15    15    15     0     3    15    15     2     1     5     8    11\n[6,]    2     1     5     8    11    15    15    15     0     0     4     3\n\n\ntiff(\"test.tiff\", width=450, height=1100) \nimage(t(mc),  col = col1, main=\"950-1500\"\ndev.off()\n</code></pre>\n\n<p>Any hints/comments will be much appreciated. </p>\n\n<p><img src=\"http://i.stack.imgur.com/XobDZ.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12840654,"title":"Trouble with a for loop while rearranging a data.frame","body":"<p>I have a df :</p>\n\n<pre><code>Years Company ID    Name    Return\n2003    23  622009  a       2323123\n2008    14  622008  v       2312343\n2009    43  622007  c       35345345\n2006    32  622006  d       45656554\n2005    67  622005  f       756756766\n1999    60  622004  y       4564533\n2001    63  622003  i       6756766\n2002    66  622002  m       32423412\n2008    68  622001  o       934833833\n2004    48  622000  e       34132222\n</code></pre>\n\n<p>I am trying to rearrange the ordering of the <code>Years</code> column in ascending order (so the most recent year (2009) is on the top). In example :</p>\n\n<pre><code>Years Company ID    Name    Return\n2009    62  622007  c       35345345\n2008    62  622008  v       2312343 \n2008    62  622001  o       934833833 \n2006    62  622006  d       45656554\n2005    62  622005  f       756756766\n</code></pre>\n\n<p>and so on...</p>\n\n<p>I tried to do it with a for loop but it gives an incorrect answer. I get only the last row :</p>\n\n<pre><code>2005    62  622005  f       756756766\n\nfor (i in 1:length(unique(df$Year))){\n  mm&lt;-df[df$Year==unique(df$Year)[i],]\n}\n</code></pre>\n\n<p>Could someone please guide me what I am doing wrong?</p>\n"},{"tags":["java","r","ubuntu"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":49,"score":4,"question_id":12839411,"title":"run \"sudo R CMD javareconf\" get \"Cannot find any Java interpreter\"","body":"<p>I tried to install a plugin for eclipse,but get an error,after some googling,got a suggestion to run\n:sudo R CMD javareconf,but got this error:</p>\n\n<pre><code>*** Cannot find any Java interpreter\n*** Please make sure 'java' is on your PATH or set JAVA_HOME correspondingly\n</code></pre>\n\n<p>By the way,my $JAVA_HOME points to a oracle-jdk-7</p>\n"},{"tags":["r","graph","ggplot2"],"answer_count":6,"favorite_count":6,"up_vote_count":5,"down_vote_count":0,"view_count":3380,"score":5,"question_id":1735540,"title":"Creating a Pareto Chart with ggplot2 and R","body":"<p>I have been struggling with how to make a <a href=\"http://en.wikipedia.org/wiki/Pareto%5Fchart\">Pareto Chart</a> in R using the ggplot2 package. In many cases when making a bar chart or histogram we want items sorted by the X axis. In a Pareto Chart we want the items ordered descending by the value in the Y axis. Is there a way to get ggplot to plot items ordered by the value in the Y axis? I tried sorting the data frame first but it seems ggplot reorders them. </p>\n\n<p>Example:</p>\n\n<pre><code>val &lt;- read.csv(\"http://www.cerebralmastication.com/wp-content/uploads/2009/11/val.txt\")\nval&lt;-with(val, val[order(-Value), ])\np &lt;- ggplot(val)\np + geom_bar(aes(State, Value, fill=variable), stat = \"identity\", position=\"dodge\") + scale_fill_brewer(palette = \"Set1\")\n</code></pre>\n\n<p>the data frame val is sorted but the output looks like this:</p>\n\n<p><img src=\"http://www.cerebralmastication.com/wp-content/uploads/2009/11/exp.png\" alt=\"alt text\"></p>\n\n<p>Hadley correctly pointed out that this produces a much better graphic for showing actuals vs. predicted:</p>\n\n<pre><code>ggplot(val, aes(State, Value)) + geom_bar(stat = \"identity\", subset = .(variable == \"estimate\"), fill = \"grey70\") + geom_crossbar(aes(ymin = Value, ymax = Value), subset = .(variable == \"actual\"))\n</code></pre>\n\n<p>which returns:</p>\n\n<p><img src=\"http://www.cerebralmastication.com/wp-content/uploads/2009/11/exp1.png\" alt=\"alt text\"></p>\n\n<p>But it's still not a Pareto Chart. Any tips?</p>\n"},{"tags":["r","anova","lme4"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":82,"score":3,"question_id":12838087,"title":"Difference in model fitness estimate between lmer() and anova()","body":"<p>I want to model the treatment effect over time on biological data using <code>lmer()</code> to take into account the individual effect.\nThe procedure usually used is to build several models by deleting step by step fixed effects and interactions terms and then find the best models using <code>anova(model1,model2)</code> and keeping the most parcimonious model when non significant difference are found.\nHowever I've found different model fitness values (AIC, BIC..) between the output of <code>summary(model1)</code> and <code>anova (model1,model2)</code>.\nHere is the code:</p>\n\n<pre><code>#Data are in z6\nm1&lt;-lmer(Brightness~factor(FT)*factor(Time)+(1|ID),z6)\nm2&lt;-lmer(Brightness~factor(FT)+factor(Time)+(1|ID),z6)\nsummary(m1)@AICtab \nAIC     BIC    logLik deviance  REMLdev\n2284.223 2335.65 -1128.112  2301.36 2256.223\nsummary(m2)@AICtab\nAIC      BIC    logLik deviance  REMLdev\n2298.247 2331.307 -1140.124  2302.42 2280.247\nanova(m1,m2)\nData: z6\nModels:\nm2: Brightness ~ factor(FT) + factor(Time) + (1 | ID)\nm1: Brightness ~ factor(FT) * factor(Time) + (1 | ID)\nDf    AIC    BIC  logLik  Chisq Chi Df Pr(&gt;Chisq)\nm2  9 2320.4 2353.5 -1151.2                         \nm1 14 2329.4 2380.8 -1150.7 1.0601      5     0.9576\n</code></pre>\n\n<p>There 14 AIC unit difference between the two model when comparing the <code>summary()</code> output but only 9 in the <code>anova()</code>. Where does this difference come from?\nThanks in advance.</p>\n"},{"tags":["r","ggplot2","geospatial"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":90,"score":3,"question_id":12834802,"title":"Non-linear color distribution over the range of values in a geom_raster","body":"<p>I'm faced with the following problem: a few extreme values are dominating the colorscale of my <code>geom_raster</code> plot. An example is probably more clear (note that this example only works with a recent ggplot2 version, I use 0.9.2.1):</p>\n\n<pre><code>library(ggplot2)\nlibrary(reshape)\ntheme_set(theme_bw())\n\nm_small_sd = melt(matrix(rnorm(10000), 100, 100))\nm_big_sd = melt(matrix(rnorm(100, sd = 10), 10, 10))\nnew_xy = m_small_sd[sample(nrow(m_small_sd), nrow(m_big_sd)), c(\"X1\",\"X2\")]\nm_big_sd[c(\"X1\",\"X2\")] = new_xy\nm = data.frame(rbind(m_small_sd, m_big_sd))\nnames(m) = c(\"x\", \"y\", \"fill\")\n\nggplot(m, aes_auto(m)) + geom_raster() + scale_fill_gradient2()\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/KuscT.png\" alt=\"enter image description here\"></p>\n\n<p>Right now I solve this by setting the values over a certain quantile equal to that quantile:</p>\n\n<pre><code>qn = quantile(m$fill, c(0.01, 0.99), na.rm = TRUE)\nm = within(m, { fill = ifelse(fill &lt; qn[1], qn[1], fill)\n                fill = ifelse(fill &gt; qn[2], qn[2], fill)})\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/NHg2m.png\" alt=\"enter image description here\"></p>\n\n<p>This does not really feel like an optimal solution. What I would like to do is have a non-linear mapping of colors to the range of values, i.e. more colors present in the area with more observations. In <code>spplot</code> I could use <code>classIntervals</code> from the <code>classInt</code> package to calculate the appropriate class boundaries:</p>\n\n<pre><code>library(sp)\nlibrary(classInt)\ngridded(m) = ~x+y\ncol = c(\"#EDF8B1\", \"#C7E9B4\", \"#7FCDBB\", \"#41B6C4\", \n        \"#1D91C0\", \"#225EA8\", \"#0C2C84\", \"#5A005A\")\nat = classIntervals(m$fill, n = length(col) + 1)$brks\nspplot(m, at = at, col.regions = col)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/Ml78a.png\" alt=\"enter image description here\"></p>\n\n<p>To my knowledge it is not possible to hardcode this mapping of colors to class intervals like I can in <code>spplot</code>. I could transform the <code>fill</code> axis, but as there are negative values in the <code>fill</code> variable that will not work.</p>\n\n<p>So my question is: are there any solutions to this problem using ggplot2?</p>\n"},{"tags":["r","equation","fit"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":12835747,"title":"In R, how do you get the best fitting equation to a set of data?","body":"<p>I'm not sure wether R can do this (I assume it can, but maybe that's just because I tend to assume that R can do anything :-)). What I need is to find the best fitting equation to describe a dataset.</p>\n\n<p>For example, if you have these points:</p>\n\n<p><code>df = data.frame(x = c(1, 5, 10, 25, 50, 100), y = c(100, 75, 50, 40, 30, 25))</code></p>\n\n<p>How do you get the best fitting equation? I know that you can get the best fitting curve with:</p>\n\n<pre><code>plot(loess(df$y ~ df$x))\n</code></pre>\n\n<p>But as I understood you can't extract the equation, see <a href=\"http://stackoverflow.com/questions/1785118/loess-fit-and-resulting-equation\">Loess Fit and Resulting Equation</a>.</p>\n\n<p>When I try to build it myself (note, I'm not a mathematician, so this is probably not the ideal approach :-)), I end up with smth like:</p>\n\n<pre><code>y.predicted = 12.71 + ( 95 / (( (1 + df$x) ^ .5 ) / 1.3))\n</code></pre>\n\n<p>Which kind of seems to approximate it - but I can't help to think that smth more elegant probably exists :-)</p>\n\n<p>I have the feeling that fitting a linear or polynomial model also wouldn't work, because the formula seems different from what those models generally use (i.e. this one seems to need divisions, powers, etc). For example, the approach in <a href=\"http://stackoverflow.com/questions/3822535/fitting-polynomial-model-to-data-in-r\">Fitting polynomial model to data in R</a> gives pretty bad approximations.</p>\n\n<p>I remember from a long time ago that there exist languages (Matlab may be one of them?) that do this kind of stuff. Can R do this as well, or am I just at the wrong place?</p>\n\n<p>(Background info: basically, what we need to do is find an equation for determining numbers in the second column based on the numbers in the first column; but we decide the numbers ourselves. We have an idea of how we want the curve to look like, but we can adjust these numbers to an equation if we get a better fit. It's about the pricing for a product (a cheaper alternative to current expensive software for qualitative data analysis); the more 'project credits' you buy, the cheaper it should become. Rather than forcing people to buy a given number (i.e. 5 or 10 or 25), it would be nicer to have a formula so people can buy exactly what they need - but of course this requires a formula. We have an idea for some prices we think are ok, but now we need to translate this into an equation.</p>\n"},{"tags":["r","data.frame","column"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12801638,"title":"How to name a column while creating a data frame using a name stored in a variable?","body":"<p>Trying to create a data.frame like this:</p>\n\n<pre><code>a = \"foo\"\nbar = data.frame(a = 1:3)\n</code></pre>\n\n<p>But the name of the column is <code>a</code>, not <code>foo</code>:</p>\n\n<pre><code>&gt; bar\n  a\n1 1\n2 2\n3 3\n</code></pre>\n\n<p>The column can be renamed after creating data.frame, but how to easily assign it's name by a variable just in the same data.frame command?</p>\n"},{"tags":["r","matlab"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":12836531,"title":"Populating a co-occurrence matrix","body":"<p>I am looking for a fast and efficient way to populate a co-occurrence matrix(so as to say). \nHere is a sample of the data I am working with: </p>\n\n<pre><code>col1 col2\na e    \na f    \na e    \nb f    \nc g    \na e    \nd f    \na e    \na g    \nb e    \nc e\n</code></pre>\n\n<p>And I want a matrix of the following form: </p>\n\n<pre><code>... e...  f...  g    \na    \nb    \nc    \nd\n</code></pre>\n\n<p>with the corresponding entry relating to the frequency. </p>\n\n<p>For example, element (3,1) in the matrix would correspond to frequency of the co-occurrence of (c,e) and should have a value of 1 and that of (1,1) should have a value 3 corresponding to 3 entries of (a,e) in the dataset. </p>\n\n<p>I am currently individually calculating the items using two for loops and it takes an extremely long time to compute the matrix (the actual data has about a million rows). </p>\n"},{"tags":["r","unicode","text-mining","tm"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12836529,"title":"Unicode symbols when creating DocumentTermMatrix","body":"<p>I am using the TM package from CRAN in R. I have problems creating a DocumentTermMatrix based on a Corpus. The problems is when I create a TermDocumentMatrix based on an UTF-8 corpus then some words turn into a unicode symbols.</p>\n\n<pre><code>corpus &lt;- Corpus(VectorSource(vector_with_texts_in_several_languages, encoding = \"UTF-8\"))\ntdm &lt;- TermDocumentMatrix(corpus, control=list(weighting=weightTfIdf))\nprint(Terms(tdm)[1:3])\n</code></pre>\n\n<p>Returns:</p>\n\n<pre><code>[1] \"&lt;U+03BB&gt;a&lt;U+03B3&gt;&lt;U+03AF&gt;a\"\n[2] \"&lt;U+03C1&gt;&lt;U+03AE&gt;fa&lt;U+03BD&gt;&lt;U+03BF&gt;&lt;U+03C2&gt;\" \n[3] \"&lt;U+03C1&gt;&lt;U+03AF&gt;p&lt;U+03BF&gt;&lt;U+03C5&gt;\"\n</code></pre>\n\n<p>If I manually inspect the corpus then I see correct output.</p>\n\n<pre><code>print(corpus[[1]])\n</code></pre>\n\n<p>Returns:</p>\n\n<pre><code>квартира на кутузовском\n</code></pre>\n\n<p>Does anyone know how I can get a TermDocumentMatrix with correct Terms? Or is there a way to convert these unicode symbols into 'readable' output again?</p>\n\n<p>Note: print(Terms(tdm)) does NOT contain words from print(corpus[[1]])</p>\n"},{"tags":["python","r","letters"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":78,"score":2,"question_id":12835674,"title":"Sequence of letters in Python","body":"<p>Is there a built-in method / module in Python to generate letters such as the built-in constant LETTERS or letters constant in R?</p>\n\n<p>The R built-in constant works as <code>letters[n]</code> where if <code>n = 1:26</code> the lower-case letters of the alphabet are produced.</p>\n\n<p>Thanks.</p>\n"},{"tags":["r","social-networking","igraph"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":54,"score":0,"question_id":12834673,"title":"Properties of a network","body":"<p>I have been studying biological networks as part of my coursework in college using R. The library i graph has most of the commands to calculate properties like degree, degree distribution, path lengths etc. Hence I have been using those commands. But now my instructor wants me to write a code for the calculation of these properties. I know the formulae for them but since I am a novice in programming, I am clueless what to do. I am using the following sequence to calculate degree distribution:</p>\n\n<pre><code>degree(g)\nsort(degree(g))\nrle(sort(degree(g)))\nrle(sort(degree(g)))$lengths\nrle(sort(degree(g)))$lengths/10\n</code></pre>\n\n<p>But others I am not able to calculate, if anybody can help me in calculating path length, shortest path length, average path length, clustering coefficient, closeness and betweeness centrality, diameter, it will be really useful. Thanks a ton!</p>\n"},{"tags":["r","colors"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":12834593,"title":"wrong color conversion with colorspace package","body":"<p>Look at the following example:</p>\n\n<pre><code>&gt; library(colorspace)\n&gt; # convert color with coordinates (0.2,0.3,0.4) in the RGB space into a character string:\n&gt; ( x &lt;- hex(RGB(0.2,0.3,0.4)) )\n[1] \"#7C95AA\"\n&gt; # reverse conversion:\n&gt; hex2RGB(x)  ## not the original coordinates !\n             R         G         B\n[1,] 0.4862745 0.5843137 0.6666667\n&gt; # now do the first conversion with the rgb() function from grDevices package:\n&gt; library(grDevices)\n&gt; ( y &lt;- rgb(0.2,0.3,0.4) )\n[1] \"#334C66\"\n&gt; # reverse conversion:\n&gt; hex2RGB(y)  ## close to the original coordinates\n       R         G   B\n[1,] 0.2 0.2980392 0.4\n</code></pre>\n\n<p>It seems that the conversion of three coordinates in the RGB color space into a character string is wrong with the hex() function from the colorspace package. Is it a bug, or is it me who wrongly use the package ?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":12803871,"title":"Moving Weighted Average with Multiple Observations per Date in R","body":"<p>I am very new to R so I apologize in advance if this is a trivial questions.  I have a large set of data consisting of mortgage loan information icluding date of origination.  I need to calculate a moving weighted (by loan amount) average of FICO scores over 3 month windows.  The problem that I'm running into, is that I don't know how to account for the fact that there are multiple loans originated in the same month/year, and I know that an average of 3 months of averages is inaccurate.  </p>\n\n<p>SO how might I go about doing this if I have the following fields:</p>\n\n<pre><code>funded$loan_amount\nfunded$fico_score\nfunded$date\n</code></pre>\n"},{"tags":["r","mapreduce","linear-regression"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":112,"score":2,"question_id":12829577,"title":"Map Reduce Linear Regression in base R","body":"<p>I'm working on a distributed linear regression calculation in R for Hadoop, but before implementing it, I'd like to verify that my calculations agree with the results of the <code>lm</code> function.</p>\n\n<p>I have the following functions which attempt to implement the generic \"summation\" framework discussed by Andrew Ng et al. in the paper <a href=\"http://www.cs.stanford.edu/people/ang//papers/nips06-mapreducemulticore.pdf\" rel=\"nofollow\">Map-Reduce for Machine Learning on Multicore</a>.</p>\n\n<p>For linear regression, this involves mapping each row y_i and x_i to P_i and Q_i such that:</p>\n\n<pre><code>P_i = x_i * transpose(x_i)\nQ_i = x_i * y_i\n</code></pre>\n\n<p>Then reducing to solve for the coefficients, theta:\n<code>theta = (sum(P_i))^-1 * sum(Q_i)</code></p>\n\n<p>The R functions to do this are:</p>\n\n<pre><code>calculate_p &lt;- function(dat_row) {\n  dat_row %*% t(dat_row)\n}\n\ncalculate_q &lt;- function(dat_row) {\n  dat_row[1,1] * dat_row[, -1]\n}\n\ncalculate_pq &lt;- function(dat_row) {\n  c(calculate_p(matrix(dat_row[-1], nrow=1)), calculate_q(matrix(dat_row, nrow=1)))\n}\n\nmap_pq &lt;- function(dat) {\n  t(apply(dat, 1, calculate_pq))\n}\n\nreduce_pq &lt;- function(pq) {\n  (1 / sum(pq[, 1])) * apply(pq[, -1], 2, sum)\n}\n</code></pre>\n\n<p>You can implement it on some synthetic data by running:</p>\n\n<pre><code>X &lt;- matrix(rnorm(20*5), ncol = 5)\ny &lt;- as.matrix(rnorm(20))\nreduce_pq(map_pq(cbind(y, X)))\n[1]  0.010755882 -0.006339951 -0.034797768  0.067438662 -0.033557351\ncoef(lm.fit(X, y))\n          x1           x2           x3           x4           x5 \n-0.038556283 -0.002963991 -0.195897701  0.422552974 -0.029823962\n</code></pre>\n\n<p>Unfortunately, the outputs don't match, so obviously I'm doing something wrong. Any ideas how I can fix it?</p>\n"},{"tags":["r","object","names"],"answer_count":4,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1676,"score":3,"question_id":1770787,"title":"R: access field values","body":"<p>I would like to know how I can access the individual fields contained in an R object. Or, more precisely, how to get R to tell me how.</p>\n\n<p>For example, if I run the following code:</p>\n\n<pre><code>dx.ct &lt;- ur.df(dat1[,'dx'], lags=3, type='trend')\nsummary(dx.ct)\n</code></pre>\n\n<p>then I get this output:</p>\n\n<pre><code>############################################### \n# Augmented Dickey-Fuller Test Unit Root Test # \n############################################### \n\nTest regression trend \n\n\nCall:\nlm(formula = z.diff ~ z.lag.1 + 1 + tt + z.diff.lag)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.46876 -0.24506  0.02420  0.15752  0.66688 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)  \n(Intercept)  1.099231   0.561377   1.958   0.0606 .\nz.lag.1     -0.239438   0.141093  -1.697   0.1012  \ntt          -0.019831   0.007799  -2.543   0.0170 *\nz.diff.lag1 -0.306326   0.193001  -1.587   0.1241  \nz.diff.lag2 -0.214229   0.186135  -1.151   0.2599  \nz.diff.lag3 -0.223433   0.179040  -1.248   0.2228  \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 \n\nResidual standard error: 0.3131 on 27 degrees of freedom\nMultiple R-squared: 0.3326,     Adjusted R-squared: 0.209 \nF-statistic: 2.691 on 5 and 27 DF,  p-value: 0.04244 \n\n\nValue of test-statistic is: -1.697 2.4118 3.2358 \n\nCritical values for test statistics: \n      1pct  5pct 10pct\ntau3 -4.15 -3.50 -3.18\nphi2  7.02  5.13  4.31\nphi3  9.31  6.73  5.61\n</code></pre>\n\n<p>So, I know that I should be able to access all of the values above individually, I don't know how to point to them. Is there some way to ask R to show me how they are stored?</p>\n\n<p>I am thinking along the lines of:</p>\n\n<pre><code>showobjects(summary(dx.ct))\n</code></pre>\n\n<p>And then it outputs</p>\n\n<pre><code>$formula\n$residuals\n$coefficients\netc.\n</code></pre>\n\n<p>and then I can do</p>\n\n<pre><code>showobjects(summary(dx.ct)$residuals)\n</code></pre>\n\n<p>which then outputs</p>\n\n<pre><code>$min\n$1Q\n$median\netc.\n</code></pre>\n\n<p>Thanks<br>\nKarl</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":361,"score":0,"question_id":5302049,"title":"Last Observation Carried Forward (na.locf) on Panel (cross section) Time Series","body":"<p>Is there a way to use na.locf functions to fill in NA values in a cross section (panel) time series data.</p>\n\n<p>I have a panel dataset setup similarly to years of data, setup similarly to the following:</p>\n\n<pre><code>library(zoo) #actual [r] code and data!\nlibrary(plm)\ndata(Produc)\na&lt;-data.frame(Produc)\nb&lt;-subset(a,state==\"WYOMING\"|state==\"WISCONSIN\",select = state:hwy)  #limit to an easy subset)\n</code></pre>\n\n<p>The data has suppression (ie missing values not released by the government data agency) and I'd like to just pull next observations to fill in NA values. </p>\n\n<pre><code>b[[2,4]]&lt;-NA\nb[[17,4]]&lt;-NA\nb[[18,3]]&lt;-NA\nc&lt;-na.locf(b,na.rm=FALSE,fromLast=FALSE)\n</code></pre>\n\n<p>Using the na.locf function will fill the NA's but nothing will stop it from pulling data incorrectly to fill in a city's last year with the next city's first year data.I am beginning to think that I need to split the dataframe into individual city frames.</p>\n"},{"tags":["r","reshape2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":12831524,"title":"Can dcast be used without an aggregate function?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12829995/this-r-reshaping-should-be-simple-but\">This R reshaping should be simple, but</a>  </p>\n</blockquote>\n\n\n\n<p><code>dcast</code> from <code>reshape2</code> works without a formula where there are no duplicates. Take these example data:</p>\n\n<pre><code>df &lt;- structure(list(id = c(\"A\", \"B\", \"C\", \"A\", \"B\", \"C\"), cat = c(\"SS\", \n\"SS\", \"SS\", \"SV\", \"SV\", \"SV\"), val = c(220L, 222L, 223L, 224L, \n225L, 2206L)), .Names = c(\"id\", \"cat\", \"val\"), class = \"data.frame\", row.names = c(NA, \n-6L))\n</code></pre>\n\n<p>I'd like to <code>dcast</code> these data and just have the values tabulated, without applying any function to the <code>value.var</code> including the default <code>length</code>.</p>\n\n<p>In this case, it works fine.</p>\n\n<pre><code>&gt; dcast(df, id~cat, value.var=\"val\")\n  id  SS   SV\n1  A 220  224\n2  B 222  225\n3  C 223 2206\n</code></pre>\n\n<p>But when there are duplicate variables, the <code>fun</code> defaults to <code>length</code>. Is there a way to avoid it?</p>\n\n<pre><code>df2 &lt;- structure(list(id = c(\"A\", \"B\", \"C\", \"A\", \"B\", \"C\", \"C\"), cat = c(\"SS\", \n\"SS\", \"SS\", \"SV\", \"SV\", \"SV\", \"SV\"), val = c(220L, 222L, 223L, \n224L, 225L, 220L, 1L)), .Names = c(\"id\", \"cat\", \"val\"), class = \"data.frame\", row.names = c(NA, \n-7L))\n\n&gt; dcast(df2, id~cat, value.var=\"val\")\nAggregation function missing: defaulting to length\n  id SS SV\n1  A  1  1\n2  B  1  1\n3  C  1  2\n</code></pre>\n\n<p>Ideally what I'm looking for is to add a <code>fun = NA</code>, as in don't try to aggregate the <code>value.var</code>. The result I'd like when dcasting df2:</p>\n\n<pre><code> id  SS  SV\n1  A 220 224\n2  B 222 225\n3  C 223 220\n4. C NA  1\n</code></pre>\n"},{"tags":["r","graph-theory","igraph"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":98,"score":-1,"question_id":12810972,"title":"Degree of a Network","body":"<p>I have started working with networks in R. I know there is a package in R called <code>igraph</code> that has many functions for network analysis and visualization. I want to calculate the degree of a small network. e.g.</p>\n\n<pre><code>mydegree=c(2,3,5)\ng=degree.sequence.game(mydegree)\n</code></pre>\n\n<p>Now to get the degree of each node I can simply use the command <code>degree</code> in <code>igraph</code> and say <code>degree(g)</code>. But what formula can I use to calculate the degree if I don't want to use this degree command?</p>\n"},{"tags":["r","bootstrap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12783162,"title":"Deming Regression Updates","body":"<p>I installed R and the bootstrap and mcr packages.  I need to do a stratified boostrap sample.  Greg Snow provided a useful script to do it on SO.  But I need to be sure that I can stratify by site and still get the bootstrap CIs for the slope and intercept parameters.  I could use anyone's help.  I need this by Monday.  Mostly people on SO have not been helpful because they have been just downvoting my question. Any help would be appreciated.</p>\n\n<p>Here is Greg Snow's code:</p>\n\n<pre><code>library(mcr) \nmodel1 &lt;- mcreg(mydata$xvar, mydata$yvar, \n  error.ratio=1, method.reg=\"Deming\", method.ci=\"bootstrap\") \nprintSummary(model1) \ngetCoefficients(model1) \nplot(model1) \n</code></pre>\n\n<p>Add on:  My colleague Robert LaBudde provided his solution to our online bootstrap course that is going on now. Here it is as requested before migration.</p>\n\n<pre><code>require('mcr')\ndat1 &lt;- dat[dat$Site=='1',] #data for 1st site\nn1&lt;- nrow(dat1)\ndat2 &lt;- dat[dat$Site=='2',] #data for 2nd site\nn2&lt;- nrow(dat2)\ndat3 &lt;- dat[dat$Site=='3',] #data for 3rd site\nn3 &lt;- nrow(dat3)\nn &lt;- n1+n2+n3 #total number of data\nc(n, n1, n2, n3) #show number of data for each site\n\nB = 10000 #number of resamples\nslope &lt;- rep(0,B) #Deming slope estimates\ninter &lt;- rep(0,B) #Deming intercept estimates\nR2 &lt;- rep(0,B) #Squared correlations for resamples\nfor (iReal in 1:B) { #resampling loop\n    s1&lt;- sample(1:n1,n1,replace=TRUE)\n    s2&lt;- sample(1:n2,n2,replace=TRUE)\n    s3&lt;- sample(1:n3,n3,replace=TRUE)\n    rdat&lt;- rbind(dat1[s1,], dat2[s2,], dat3[s3,]) #combined resample\n    fit&lt;- mcreg(rdat$MethR, rdat$MethC, method.reg='Deming', method.ci='analytical')\n    slope[iReal]&lt;- getCoefficients(fit)[2]\n    inter[iReal]&lt;- getCoefficients(fit)[1]\n    R2[iReal]&lt;- cor(rdat$MethR,rdat$MethC)^2\n                  } #iReal\nc( mean(R2), mean(inter), mean(slope)) #bootstrap estimates\nquantile(R2, probs=c(.025,.975)) #R2 C.I.\nquantile(inter, probs=c(.025,.975)) #Intercept C.I.\nquantile(slope, probs=c(.025,.975)) #Slope C.I.\n</code></pre>\n"},{"tags":["r","bayesian","montecarlo","markov-chains","mcmc"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":243,"score":2,"question_id":1528428,"title":"R: MCMClogit confusion","body":"<p>Could anybody explain to me why</p>\n\n<pre><code>simulatedCase &lt;- rbinom(100,1,0.5)\nsimDf &lt;- data.frame(CASE = simulatedCase)\nposterior_m0 &lt;&lt;- MCMClogit(CASE ~ 1, data = simDf, b0 = 0, B0 = 1)\n</code></pre>\n\n<p>always results in a MCMC acceptance ratio of 0? Any explanation would be greatly appreciated!</p>\n"},{"tags":["r","optimization","newtons-method"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12828254,"title":"Newton-Raphson maximisation fitting","body":"<p>I have an equation that I am integrating:</p>\n\n<pre><code>    integrand &lt;- Vectorize(function(x,scale,con,time,tau,degrade,monkey){scale * (con * (time - tau)) - degrade * monkey)}\n\n    # I have to Vectorize because I'm integrating and all the values are constats\n\n    eq &lt;- integrate(integrand,lower=0,upper=time)$value\n</code></pre>\n\n<p>eq gives me a concentration of monkeys which I'll refer to as M.</p>\n\n<p>The data below (train and train2) found M at 7 different time points (0,20,40,60,120,240,360) during a six hour period. The way train and train2's Ms were found was NOT using this equation. This equation is an artificial way to find M.</p>\n\n<p>I want to use this equation at the 7 given timepoints for the argument 'time' and fit those final 7 values of M to both train and train2's Ms.</p>\n\n<p>In my equation the arguments 'scale','tau', and 'degrade' are unknown parameters. With...\ncon = 55;\ntime = 1 of the 7 timepoints;\nmonkey = 1 of 7 Ms (from train and train2) corresponding to the time point.</p>\n\n<p>The reason I want to use train and train2 both, to find my unknown parameters is because they have different upper 't' bounds for their integrals which is specified. </p>\n\n<p>So I want the values for my current unknown parameters (scale, tau, and degrade) which will result in the best global fit of the artificial 7 Ms to both train and train2 Ms.</p>\n\n<p>train (t upper bound == 360)</p>\n\n<pre><code>timepoints          M\n         0  1.0000000\n        20  0.7202642\n        40  0.8000305\n        60  1.7430986\n       120 16.5172242\n       240 33.9140056\n       360 34.5735984\n</code></pre>\n\n<p>train2 (t upper bound == 60)</p>\n\n<pre><code>timepoints          M\n         0  1.0000000\n        20  0.7540779\n        40  0.7641358\n        60  0.8694150\n       120 16.5431465\n       240 16.7493493\n       360  6.2145258\n</code></pre>\n\n<p>I want to use a newton-raphson maximisation fit, but i'm unsure totally how to plug in my 3 known parameters, and get the best global fit 3 unknown parameters out.</p>\n\n<p>My reasoning behind choosing newton-ralphson is its ability to deal w/ k variables. If you see an easier/better way to do this, please let me know.  </p>\n\n<pre><code>       maxNR(eq, ...? # how do I list my known parameter vector and how will it print\n       # the three unknown parameters?\n</code></pre>\n\n<p>Basically I need some help writing this code, I've never used it before.</p>\n\n<p>Thank you for you time</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":72,"score":-2,"question_id":12830146,"title":"Two intersecting triangle in R","body":"<p>If we assume that <code>s1(x)=s2(x)</code> (the areas of the two triangles are equal) and and we know <code>(x1, y1), (x2, y2), (x3, y3)</code>and also we assume that the line <code>L</code> which is between (x1, y1) and (x, y(x)), because we know for example \nanother point in this line so we know the slope and the line. How can I find <code>x</code> value in R?</p>\n\n<p><img src=\"http://i.stack.imgur.com/XxwVg.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["memory-management","r"],"answer_count":4,"favorite_count":5,"up_vote_count":9,"down_vote_count":0,"view_count":11214,"score":9,"question_id":1395229,"title":"Increasing the memory available to R processes","body":"<p>I would like to increase the amount of memory available to R.  What are the methods for achieving this?</p>\n"},{"tags":["r","file-io","reading","read.table"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":93,"score":-1,"question_id":12828438,"title":"R read.csv vs. read.table","body":"<p>I have seen in several cases that while <code>read.table()</code> is not able to read a tab delimited file (for example the annotation table of a microarray) returning the following error:</p>\n\n<pre><code>Error in scan(file, what, nmax, sep, dec, quote, skip, nlines, na.strings,  : \nline xxx did not have yyy elements\n</code></pre>\n\n<p><code>read.csv()</code> works perfectly on the same file with no errors. I think also the speed of <code>read.csv()</code> is also higher than <code>read.table()</code>. </p>\n\n<p>Even more: <code>read.table()</code> is doing very crazy reading a file of me. It makes this error while reading line 100, but when I copy and paste lines 90 to 110 just after the head of the same file, it still makes error of line 100+21 (new lines copied at the beginning). If there is any problem with that line, why doesn't it report that error while reading the pasted line at the beginning? I confirm that <code>read.csv()</code> reads the same file with no error.</p>\n\n<p>Do you have any idea of why <code>read.table()</code> is unable to read the same files that <code>read.csv()</code> works on it? Also is there any reason to use <code>read.table()</code> in any cases?</p>\n"},{"tags":["r","data-manipulation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12829309,"title":"Writing a generic function for \"find and replace\" in R","body":"<p>I need to write a generic function for \"find and replace in R\". How can I write a function that takes the following inputs</p>\n\n<ul>\n<li>A CSV file (or data frame)</li>\n<li>A string to find, for example \"name@email.com\"</li>\n<li>A string the replace the found string with, for example \"medium\"</li>\n</ul>\n\n<p>and rewrites the CSV file/data frame so that all the found strings are replaced with the replacement string?</p>\n"},{"tags":["r","ggplot2","histogram"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":89,"score":5,"question_id":12828125,"title":"ggplot2: Reading maximum bar height from plot object containing geom_histogram","body":"<p>Like this <a href=\"http://stackoverflow.com/questions/7611691/relative-positioning-of-geom-text-in-ggplot2\">previous poster</a>, I am also using <code>geom_text</code> to annotate plots in gglot2. And I want to position those annotations in relative coordinates (proportion of facet H &amp; W) rather than data coordinates.  Easy enough for most plots, but in my case I'm dealing with histograms. I'm sure the relevant information as to the y scale must be lurking in the plot object somewhere (after adding <code>geom_histogram</code>), but I don't see where. </p>\n\n<p>My question: How do I read maximum bar height from a faceted ggplot2 object containing <code>geom_histogram</code>? Can anyone help?</p>\n"},{"tags":["r","plyr"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12828423,"title":"Applying a function to a data frame","body":"<p>I can't figure out why this isn't working.  I have a data set with 5 columns, n rows.  I just want to apply a function to each row and have the result returned in an n by 1 vector.</p>\n\n<p>Just to test out how everything works, i made this simple function: </p>\n\n<pre><code>f1 &lt;- function(uniqueid,Perspvalue,expvalue,stddevi,stddevc) {\n    uniqueid+ Perspvalue- expvalue+ stddevi+stddevc\n}\n</code></pre>\n\n<p>and here's the first few rows of my data set:</p>\n\n<pre><code>&gt; data\n     uniqueid   Perspvalue    expvalue      stddevi      stddevc\n1           1 2.404421e+03  3337239.00 8.266566e+03 3.324624e+03\n2           2 1.345307e+03  3276559.87 7.068823e+03 2.648072e+03\n3           3 1.345307e+03  3276559.87 7.068823e+03 2.648072e+03\n</code></pre>\n\n<p>Note that it's a data frame (i think), and not a matrix.  I loaded in the data from a csv using read.csv.</p>\n\n<p>So i try this: <code>apply(data,1,f1)</code></p>\n\n<p>But my result is this: <code>Error in uniqueid + Perspvalue : 'Perspvalue' is missing</code></p>\n\n<p>I expected a number instead of an error.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12828555,"title":"Adding lines and labels in lattice barchart after re-ordering group variable","body":"<p>When I re-order my group variable the legend and colors are displayed properly, but my percentages within the barchart no longer line up. I remove the re-order then I get the percentages line up correctly within the barchart, but my barchart and legend are displayed alaphbelical which I dont want. How can I re-position the text within the barchart boxes after I re-order my group. Here is my code</p>\n\n<pre><code>#Libraries to be Used\nlibrary(plyr)\nlibrary(lattice)\nrequire(latticist)\nrequire(latticeExtra)\nlibrary(RColorBrewer) \n\n# creates color schemes\nMyPalette &lt;- brewer.pal(5, \"Set3\")\n\nbarchart(Rate*100~ReportQtr\n         |factor(Question,levels=c(\"Question 3\",\"Question 4\",\"Question 5\"\n                ,\"Question 1\",\"Question 2\"))\n        ,ptsatAll\n        ,groups=factor(Response,levels=c(\"Not beneficial\",\"Somewhat beneficial\"\n                                         ,\"Beneficial\",\"Very beneficial\"\n                                         ,\"Extremely beneficial\"\n                                         ,\"Not helpful\",\"Somewhat helpful\",\"Helpful\"\n                                         ,\"Very helpful\",\"Extremely helpful\"\n                                         ,\"Not satisfied\",\"Somewhat satisfied\"\n                                         ,\"Satisfied\",\"Very satisfied\"\n                                         ,\"Extremely satisfied\"\n                                         ,\"Not recommend\",\"Somewhat recommend\"\n                                         ,\"Recommend\",\"Strongly recommend\"))\n        ,box.ratio = 1\n        ,stack = T,horizontal = F\n        ,ylab = \"Response Rate (%)\"\n        ,panel = function(...) {\n             panel.barchart(...,col = MyPalette[c(1,2,3,5,4)])\n             tmp &lt;- list(...)\n             tmp &lt;- data.frame(x=tmp$x, y=tmp$y)\n             ## calculate positions of text labels\n             df &lt;- ddply(tmp, .(x),function(y) {\n                 data.frame(y, pos=cumsum(y$y)-y$y/2)\n             })\n             panel.text(x=df$x, y=df$pos,\n                        label=paste(round(df$y,0),\"%\",sep=\"\")\n                        ,cex=0.7, col=\"black\",font=4)\n\n            }\n      ,auto.key=list(columns=4,space=\"top\",\n                      cex=0.8, size=1.4, adj=1,\n                      between=0.2, between.colums=0.1,border=T,\n                      points = FALSE, rectangles = TRUE)\n      ,par.settings = simpleTheme(col =MyPalette[c(1,2,3,5,4)])\n      ,strip = strip.custom(var.name=c(\"\"),sep=\"  \",strip.names=TRUE\n        ,strip.levels=TRUE,style = 1,par.strip.text = list(cex = 0.8,font=2,col=\"white\")\n        ,trellis.par.set(\"strip.background\" = list(col=c(\"blue\"))\n        ,trellis.par.set(\"strip.border\" = list(col=\"black\"))))\n      ,scales = list(x = list(alternating = 1,rot=50,cex=.8,relation = \"same\")\n                   , y = list(alternating = 1,relation = \"same\"))\n      )\n</code></pre>\n"},{"tags":["r","lattice"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12828027,"title":"conditional panel function in lattice for multiple y variables","body":"<p>I have a dataset in which a value (<code>mean</code>) can or cannot fall within an interval given by <code>lower.bound</code> and <code>upper.bound</code>. I would like to plot this using <code>lattice</code> and have achieved something really nice, but there are still three things missing, I don't know how to tackle (I am relatively new to <code>lattice</code>).</p>\n\n<pre><code>df &lt;- read.table(\"http://pastebin.com/raw.php?i=FQh6F12t\")\n\nrequire(lattice)\nlattice.options(default.theme = standard.theme(color = FALSE))\n\nhead(df)\n##    code topic problem mean lower.bound upper.bound consistent\n## 7  A04C  coke      MP 99.5       36.45       95.95          0\n## 8  A04C  coke      MT 47.5       22.78      100.00          1\n## 11 A04C  girl      MP 50.0        4.75        9.75          0\n## 12 A04C  girl      MT 99.5       20.00      100.00          1\n## 23 A14G  coke      MP 88.5       21.25       66.75          0\n## 24 A14G  coke      MT 82.5       48.36      100.00          1    \n\ndotplot(lower.bound + mean + upper.bound ~ code | problem * topic, \n       data = df, pch = c(6, 3, 2), scales = list(x = list(draw = FALSE)),\n       as.table = TRUE)\n</code></pre>\n\n<p>This produces:\n<img src=\"http://i.stack.imgur.com/lUTKf.png\" alt=\"enter image description here\"></p>\n\n<p>The down-arrows/triangles indicate the lower bound, the up arrows/triangles indicate the upper bound and the <code>+</code> marks the <code>mean</code>. The following things I would like to add to the plot but have no idea how (besides obviously customizing the panel function):</p>\n\n<ol>\n<li><strong>Conditional <code>pch</code> based on whether or not a <code>mean</code> value is inside the interval.</strong> The variable <code>consistent</code> indicates this (0 = outside the interval). <code>pch</code> should be <code>1</code> for values inside and <code>3</code> for values outside the interval. (pch for the lower- and upper bound should remain unchanged)</li>\n<li><strong>Marking the interval.</strong> I would like to draw a thicker line between the <code>lower.bound</code> and <code>upper.bound</code> at each x-axis tick.</li>\n<li><strong>Add the proportion of values outside the interval to the panel headers</strong> (e.g., <code>MP; 58.6%</code> to the panel in the upper left corner).</li>\n</ol>\n\n<p>For 1 and 2 my problem obviously is, that I don't know how to deal with custom panel function when having multiple y variables (i.e., how to write conditional panel functions based on this). But I couldn't find anything on it. </p>\n\n<p>For 3, the proportion of values outside the interval is given by something like:</p>\n\n<pre><code>1 - with(df, tapply(consistent, list(topic, problem), mean))\n##          MP     MT\n## coke 0.5862 0.1724\n## girl 0.8276 0.1724\n</code></pre>\n\n<p>If the answer would furthermore include a nice ordering of levels on the x-axis that would definitely be a plus. The order can change in every panel (i.e., even in panels above each other the same x-axis tick can correspond to a different level of <code>code</code>). But this is not important.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":12680680,"title":"melting multiple spans of variables","body":"<p>(still) new to r, and very confused as to how I should accomplish multiple melts of my data. Here is a subset:</p>\n\n<pre><code>df &lt;- structure(list(Subject = c(101L, 101L, 101L, 102L, 102L, 102L\n), Condition = structure(c(1L, 1L, 1L, 2L, 2L, 2L), .Label = c(\"apass\", \n\"vpas\"), class = \"factor\"), FreqCode = structure(c(1L, 1L, 1L, \n2L, 2L, 2L), .Label = c(\"LessVerbal\", \"MoreVerbal\"), class = \"factor\"), \nItem = c(1L, 4L, 7L, 1L, 4L, 7L), Len = c(80L, 68L, 85L, \n68L, 85L, 79L), R1_1.RT = c(237L, 203L, 207L, 336L, 487L, \n340L), R1_2.RT = c(177L, 225L, 162L, 634L, 590L, 347L), R1_3.RT = c(200L, \n226L, 212L, 707L, 653L, 379L), R1.RT = c(614L, 654L, 581L, \n1677L, 1730L, 1066L), R1_1 = structure(c(1L, 1L, 1L, 1L, \n1L, 1L), .Label = \"The\", class = \"factor\"), R1_2 = structure(c(3L, \n1L, 2L, 1L, 2L, 4L), .Label = c(\"antique\", \"course\", \"new\", \n\"road\"), class = \"factor\"), R1_3 = structure(c(4L, 1L, 2L, \n1L, 2L, 3L), .Label = c(\"car\", \"materials\", \"surfaces\", \"technology\"\n), class = \"factor\"), R1 = structure(c(3L, 1L, 2L, 1L, 2L, \n4L), .Label = c(\"The antique car\", \"The course materials\", \n\"The new technology\", \"The road surfaces\"), class = \"factor\")), .Names = c(\"Subject\", \n\"Condition\", \"FreqCode\", \"Item\", \"Len\", \"R1_1.RT\", \"R1_2.RT\", \n\"R1_3.RT\", \"R1.RT\", \"R1_1\", \"R1_2\", \"R1_3\", \"R1\"), class = \"data.frame\", row.names =  \nc(NA, \n-6L))\n</code></pre>\n\n<p>My goal is to get output that (in part) looks like this:</p>\n\n<pre><code>Region RT WordRegion Word\nR1_1.RT 237 R1_1 the\n...\nR1_2.RT 177 R1_2 new\n...\n</code></pre>\n\n<p>EDIT: The variable ending with \".RT\" (e.g., R1_1.RT) are Region names and will be melted into a Region column. The variables ending in numbers (e.g., R1_1) correspond exactly to the Region names and their associated values. I want them to be melted alongside the Region names so that I can analyze them in relation to the Region column</p>\n\n<p>In the first part of the code, I melt all of the values into a Region column and change the value to RT. This seems to work fine:</p>\n\n<pre><code>#long transform (with individual regions at end)\nSmallMelt1 = melt(df, measure.vars = c(\"R1_1.RT\", \"R1_2.RT\", \"R1_3.RT\", \"R1.RT\"), var = \"Region\")\n#change newly created column name to \"RT\" (note:you have to change the number in [] to match your data)\ncolnames(SmallMelt1)[11 ] &lt;- \"RT\"\n</code></pre>\n\n<p>But I don't get how to simultaneously melt another span of variables such that they will line up vertically with the first span. I want to do something like this, after the first melt, but it does not work:</p>\n\n<pre><code>#Second Melt for region names (doesn't work)\nSmallMelt2 = melt(SmallMelt1, measure.vars = c(\"R1_1\", \"R1_2\", \"R1_3\", \"R1\"), var = \"WordRegion\")\n\n#Change name to Word\ncolnames(SmallMelt2)[9] &lt;- \"Word\" #add col number for \"value\" here\n</code></pre>\n\n<p>Please let me know if you need any clarification. I hope someone can help... thanks in advance - DT</p>\n"},{"tags":["image","r","pgm"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12826051,"title":"read.pnm() - error trying to read pgm image","body":"<p>I'm trying to read a pgm file in R. I set my wd to where the image is and then simply try to read it:</p>\n\n<pre><code>   setwd(\"~/3 Diplomado/5 Multivariado/lfwcrop_grey/faces\")\n\n   library(pixmap)\n\n    x &lt;- read.pnm(system.file(\"Aaron_Guiel_0001.pgm\", package=\"pixmap\")[1])\n</code></pre>\n\n<p>But I get the following error:</p>\n\n<p>Error in if (ch == \"#\") { : argument is of length zero\nIn addition: Warning message:\nIn file(file, open = \"rb\") :\n  file(\"\") only supports open = \"w+\" and open = \"w+b\": using the former</p>\n\n<p>Not sure what it is. I think it simply doesnt find the image.\nWhat am I doing wrong? any hints? Thank you in advanced!</p>\n\n<p>J.</p>\n"},{"tags":["r","sequence"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":96,"score":2,"question_id":12824931,"title":"Measure the periodicity of a sequence of numbers [R]","body":"<p>A periodic sequence is a sequence that repeats itself after <em>n</em> terms, for example, the following is a periodic sequence:</p>\n\n<p>1, 2, 3, 1, 2, 3, 1, 2, 3, ...</p>\n\n<p>And we define the <em>period</em> of that sequence to be the number of terms in each subsequence (the subsequence above is 1, 2, 3).  So the period for the above sequence is 3.</p>\n\n<p>In R, I can define the above sequence (albeit not to infinity), using:</p>\n\n<pre><code>sequence &lt;- rep(c(1,2,3),n) #n is a predefined variable\n</code></pre>\n\n<p>So if <code>n = 50</code>, <code>sequence</code> will be the sequence 1, 2, 3, 1, 2, 3, ... , 1, 2, 3, where each number has appeared 50 times, in the obvious way.</p>\n\n<p>I am looking to build a function that calculates the periodicity of <code>sequence</code>.  Pseudocode is as follows:</p>\n\n<pre><code>period &lt;- function(sequence){\n    subsequence &lt;- subsequence(sequence) #identify the subsequence\n    len.subsequence &lt;- length(subsequence) #calculate its length\n    return(len.subsequence) #return it\n}\n</code></pre>\n\n<p>How would I identify the subsequence? This is sort of a reversing of the <code>rep</code> function, such that I pass in a sequence and it passes out the length of the initial vector.</p>\n"},{"tags":["r","hclust"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12826552,"title":"Exporting hclust cluster membership","body":"<p>I am new to R. I am trying to do hclust and export the cluster membership. I have used the following. Is this correct or is there a better way?</p>\n\n<pre><code>FCtable1&lt;-as.matrix(read.delim(\"table1.txt\", row.names=1, header=TRUE, sep=\"\\t\"))\nDisttab1&lt;-dist(FCtable1, method=\"euclidean\")\nHclustout1&lt;-hclust(Disttab1, method=\"average\")\nclustnumber&lt;- cutree(Hclustout1, h=1000)\ntab1clustn &lt;-data.frame(FCtable1, clustnumber)\nwrite.table(tab1clustn,  file=\" tab1clustn.xls\", row.names=T, sep=\"\\t\")\n</code></pre>\n\n<p>Thanks\nR</p>\n"},{"tags":["xml","r","xpath","xquery"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":812,"score":5,"question_id":3876571,"title":"How can I use xpath querying using R's XML library?","body":"<p>The xml file has this snippet:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;PC-AssayContainer\n    xmlns=\"http://www.ncbi.nlm.nih.gov\"\n    xmlns:xs=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xs:schemaLocation=\"http://www.ncbi.nlm.nih.gov ftp://ftp.ncbi.nlm.nih.gov/pubchem/specifications/pubchem.xsd\"\n&gt;\n....\n    &lt;PC-AnnotatedXRef&gt;\n      &lt;PC-AnnotatedXRef_xref&gt;\n        &lt;PC-XRefData&gt;\n          &lt;PC-XRefData_pmid&gt;17959251&lt;/PC-XRefData_pmid&gt;\n        &lt;/PC-XRefData&gt;\n      &lt;/PC-AnnotatedXRef_xref&gt;\n    &lt;/PC-AnnotatedXRef&gt;\n</code></pre>\n\n<p>I tried to parse it using xpath's global search and also tried with some namespacing:</p>\n\n<pre><code>library('XML')\ndoc = xmlInternalTreeParse('http://s3.amazonaws.com/tommy_chheng/pubmed/485270.descr.xml')\n&gt;pathApply(doc, \"//PC-XRefData_pmid\")\nlist()\nattr(,\"class\")\n[1] \"XMLNodeSet\"\n&gt; getNodeSet(doc, \"//PC-XRefData_pmid\")\nlist()\nattr(,\"class\")\n[1] \"XMLNodeSet\"\n&gt; xpathApply(doc, \"//xs:PC-XRefData_pmid\", ns=\"xs\")\nlist()\n&gt; xpathApply(doc, \"//xs:PC-XRefData_pmid\", ns= c(xs = \"http://www.w3.org/2001/XMLSchema-instance\"))\nlist()\n</code></pre>\n\n<p>Shouldn't the xpath match:</p>\n\n<pre><code>&lt;PC-XRefData_pmid&gt;17959251&lt;/PC-XRefData_pmid&gt;\n</code></pre>\n"},{"tags":["r","rcpp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":255,"score":0,"question_id":10123751,"title":"rcpp caught segfault","body":"<p>I'm trying to use Rcpp, but c++ is completely new to me, and I'm getting this error,\nbut, only sometimes, the majority of the time the function runs pretty well, some one has a guess?</p>\n\n<p>The Error I get:\n <strong>* caught segfault *</strong>\naddress 0x28, cause 'memory not mapped'</p>\n\n<p>Here is use case:</p>\n\n<pre><code>library(inline)\nrequire(RcppArmadillo)\nx &lt;- matrix(rnorm(200, 300, 0.03), ncol=1)\ny &lt;- rnorm(600, 300, 0.003) \nwm &lt;- sapply(x, function(z) z/y)\nw &lt;- matrix(sample(0:1, 360000, replace=TRUE), nrow=600) \nans &lt;- call.gibbs(x, y, 5000, w, wm, sample)\n</code></pre>\n\n<p>below follows my code, a gibbs sampler:</p>\n\n<pre><code>call.gibbs &lt;- cxxfunction(\n        signature(x=\"numeric\", y=\"numeric\",N=\"interger\", w=\"numeric\", p=\"numeric\", fun= \"function\" ), \n        plugin=\"RcppArmadillo\", \n        includes=c(\"#include &lt;stdlib.h&gt;\", \"#include &lt;cmath&gt;\",\"#include &lt;numeric&gt;\" ), \n        body='\n            using namespace Rcpp;\n\n            NumericVector xa(x);\n            NumericVector ya(y);\n            int Na = as&lt;int&gt;(N);\n            int n_xa = xa.size(), n_ya = ya.size();\n            arma::mat wa = Rcpp::as&lt;arma::mat&gt;(w);\n            Rcpp::NumericMatrix n(p); //one column to each x[i]/y\n            NumericVector limite(n_xa);\n            arma::mat z(n_ya, n_xa);\n            arma::mat beta(n_ya, n_xa);\n            arma::colvec one(xa.begin(), xa.size());\n            arma::colvec betaM(ya.begin(), ya.size());\n            arma::colvec betaP(ya.begin(), ya.size());\n            z.col(0) = arma::zeros&lt;arma::mat&gt;(n_ya, 1);\n            NumericVector nV(n_ya);\n\n            int i, j, randLR;\n\n                for (i=0; i&lt;n_xa; i++) {\n                    for (j=0; j&lt;n_ya; j++) {\n                       z(j,i) = 0;  \n                    }\n                     randLR = rand() % n_ya;\n                     z(randLR,i)=1;\n                     limite(i)  = i;\n                     one(i) = 1;\n                }\n\n                beta = wa * z;\n                one = beta * one;\n\n                int mu = 1;\n                double sigma = 0.001;\n\n                Function f(fun);\n\n            int k, l,l2, pos;\n            NumericMatrix prob_table(n_xa, Na);\n            NumericMatrix class_table(n_xa, Na);\n\n                for(k=0; k&lt;Na; k++){\n                   limite = f(limite, n_xa);\n\n                   for (l=0; l&lt;n_xa; l++) {\n                       l2=limite(l);     \n\n                       betaM = one - wa * z.col(l2);\n                       std::transform(betaM.begin(), betaM.end(), betaM.begin(), std::bind2nd(std::plus&lt;double&gt;(),1));\n                       std::transform(betaM.begin(), betaM.end(), betaM.begin(), std::bind2nd(std::divides&lt;double&gt;(),std::accumulate(betaM.begin(), betaM.end(), 0.0)));\n\n                       nV = n(_, l2);\n                       std::transform(nV.begin(), nV.end(), nV.begin(), std::bind2nd(std::divides&lt;double&gt;(),std::accumulate(nV.begin(), nV.end(), 0.0)));\n\n                       int nP;\n                       for (nP=0; nP&lt;betaP.size(); nP++) {\n                                betaP(nP) = betaM(nP)*nV(nP);\n                                z(nP, l2) = 0;\n                       }\n\n                           // continuing control\n                           if (std::accumulate(betaP.begin(), betaP.end(), 0.0) &gt; 0) {\n                                std::transform(betaP.begin(), betaP.end(), betaP.begin(), std::bind2nd(std::divides&lt;double&gt;(),std::accumulate(betaP.begin(), betaP.end(), 0.0)));\n                           }\n                           else {\n                               std::transform(betaP.begin(), betaP.end(), betaP.begin(), std::bind2nd(std::plus&lt;double&gt;(),1));\n                           }\n\n                       pos = as&lt;int&gt;(f(ya.size(), 1, \"FALSE\",  betaP)) - 1;  \n                       z(pos, l2) = 1;\n                       one = betaM + wa * z.col(l);\n\n                       prob_table(l2,k) = betaP(pos);\n                       pos = pos + 1;\n                       class_table(l2,k) = pos;\n                   }\n                }\n            return Rcpp::List::create( Rcpp::Named(\"beta\")=beta, Rcpp::Named(\"z\")=z, Rcpp::Named(\"pos\")=pos, Rcpp::Named(\"limite\")=limite, Rcpp::Named(\"n\")=nV, Rcpp::Named(\"betaM\")=betaM, Rcpp::Named(\"betaP\")=betaP, Rcpp::Named(\"prob_table\")=prob_table, Rcpp::Named(\"class_table\")=class_table );\n            '\n)\n</code></pre>\n"},{"tags":["r","matrix","binary-data"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":55,"score":0,"question_id":12826152,"title":"How to create a binary matrix from a data.frame?","body":"<p>I have a data.frame with 16 columns. Here's one example row.</p>\n\n<pre><code>    &gt; data[16,]\n                      V1              V2              V3                 V4\n    16 comp27182_c0_seq4 ENSP00000442096 ENSG00000011143 ENSFCAP00000011376\n                       V5                V6                V7                V8\n    16 ENSFCAG00000012261 comp48601_c0_seq1 comp19130_c0_seq3 comp22796_c2_seq3\n                       V9 V10                V11                V12\n    16 comp146901_c0_seq1     comp157916_c0_seq1 comp158124_c0_seq1\n                      V13               V14 V15 V16\n    16 comp229797_c0_seq1 comp61875_c0_seq2\n</code></pre>\n\n<p>I'm only interested in columns 1 and 6-16. The first column contains the name I would like to use as a column name in the matrix,  6 to 16 may contain either a string or '' (nothing). \nI would like to transform this data.frame into a matrix showing 1 or 0, reflecting the content in columns 6-16.</p>\n\n<pre><code>                  V1 V2 V3 V4 V5 V6 V7 V8 V9 V10 V11\ncomp27182_c0_seq4 1  1  1  1  0  1  1  1  1   0   0\n</code></pre>\n\n<p>I've trying to use mask without success. I'm sure there's a very easy option out there.</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["r","datetime"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":88,"score":-1,"question_id":12825589,"title":"Convert Oracle Timestamp to Date/Time in R","body":"<p>I often read data from <code>Oracle</code> into <code>R</code>.  To get around the <code>TIMESTAMP</code> format in some of my tables, I read in the column in as a character string with <code>TO_CHAR</code> in my SQL statement.  </p>\n\n<p>However, I want to convert the data held in the string back into a date + time format that R can utilize.  Unfortunately,I have no idea as to how to best do this, especially considering the AM/PM component.  Stripping out the date is easy enough, but I have no idea as to how to retain the time part of each record.  </p>\n\n<p>Here are a few records of data:</p>\n\n<pre><code>c(\"31-JUL-12 10.08.35.432 AM\", \"31-JUL-12 08.53.18.316 AM\", \"18-JUL-12 01.17.52.939 PM\", \n\"13-AUG-12 05.34.11.405 PM\", \"15-AUG-12 02.04.31.505 PM\", \"21-AUG-12 09.10.03.976 AM\"\n)\n</code></pre>\n\n<p>One note: these data are timezone EST.</p>\n\n<p>Any help will be greatly appreciated!</p>\n"},{"tags":["r","debugging"],"answer_count":3,"favorite_count":1,"up_vote_count":14,"down_vote_count":0,"view_count":160,"score":14,"question_id":12807237,"title":"R undebug all functions","body":"<p>Consider we have called <code>debug()</code> for several functions to make a breakpoint on them. When we find and solve the bug, is there anyway to <code>undebug()</code> all functions already marked by <code>debug()</code> by a single command?</p>\n\n<p>Here is a good benchmark to see if your proposed method really works perfect:</p>\n\n<pre><code>&gt; library(limma) # bioconductor\n&gt; debug(read.ilmn)\n&gt; read.ilmn(\"a.txt\") # No problem if this file does not exist\nBrowse[2]&gt; debug(.read.oneilmnfile) # This is the debug browser for read.ilmn()\nBrowse[2]&gt; Q # To exit debug browser\n&gt; undebug.all() # Here run your proposed function to undebug everything!\n&gt; read.ilmn(\"a.txt\")\n# Now if the debug browser is not started, you are lucky to pass this test!\n</code></pre>\n\n<p>You may see the accepted answer below. Any case that this answer does not work, or cleaner versions are more than welcome.</p>\n"},{"tags":["r","soap","ubuntu-12.04"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12807496,"title":"Accessing a webservice with R, RCurl, and SSOAP - 'Error in .getClassFromCache(Class, where)'","body":"<p>I am relatively new to using R and I am trying to access a webservice (AILUN) and I am getting and error which could be something fairly simple.</p>\n\n<p>I am using Ubuntu 12.04 and R version 2.15.1</p>\n\n<p>I have installed all of the prerequisites for the package 'SSOAP' from <a href=\"http://www.omegahat.org\" rel=\"nofollow\">http://www.omegahat.org</a></p>\n\n<p>Here is a step-by-step from the R command line. The files were downloaded from <a href=\"http://ailun.stanford.edu/webservice.php\" rel=\"nofollow\">http://ailun.stanford.edu/webservice.php</a></p>\n\n<pre><code>&gt; getwd()\n[1] \"/home/gserver/Webservice\"\n&gt; library(SSOAP)\n&gt; platformAnnotation_FindGPL &lt;- function(array_send,ratio)\n+ {\n+ AILUN &lt;- SOAPServer(\"http://ailun.stanford.edu/WebServ/Platform_Annotation.php\")\n+ gpl_info &lt;- .SOAP(AILUN, \"platformAnnotation_FindGPL\",templfile=array_send ,matchRatio=ratio, action=\"/Platform_Annotation.php\")\n+ return (gpl_info)\n+ \n+ }\n&gt; con &lt;- file(\"probe_ID.txt\", \"r\")\n&gt; array1 &lt;- readLines(con)\n&gt; ratio &lt;- 30\n&gt; result &lt;- platformAnnotation_FindGPL(array1,ratio)\nError in .getClassFromCache(Class, where) : \n  attempt to use zero-length variable name\n&gt; \n</code></pre>\n\n<p>Any advice or assistance is greatly appreciated!!</p>\n"},{"tags":["r","apply"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12821673,"title":"calculate correlation matrix of a matrix with apply","body":"<p>I want to calculate correlation matrix P which each P[i,j]  is correlation coefficient of row i and col j in matrix Data. for example </p>\n\n<pre><code>  Data &lt;- matrix(rnorm(500),50,10)\n  P &lt;- matrix(0,50,50)\n  for (i in 1:50) \n     for(j in 1:50)\n        P[i,j] &lt;- cor(Data[i,],Data[j,])\n</code></pre>\n\n<p>But how can I use apply or something like this command to calculate such correlations. </p>\n"},{"tags":["r","ggplot2"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":32,"score":0,"question_id":12804367,"title":"Change view to zone in on values below xx%, include a break mark, for greater than xx%","body":"<p>I was trying to make plots using <code>ggplot2</code>, and I want to change view to zone in on values, for example below 30%, and include a break mark, for greater than 30%.</p>\n\n<p>I know in ggplot, in order to zone views, using </p>\n\n<pre><code>coord_cartesian(xlim = c(xx,xx), ylim=c(0, 0.3))\n</code></pre>\n\n<p>is an option, but how can I include a break mark for values greater than 30%(30%~100%)? </p>\n\n<p>Any suggestion would be appreciated!</p>\n"},{"tags":["r","data-manipulation"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":107,"score":2,"question_id":12822784,"title":"Rearranging a dataframe in R","body":"<p>I have a dataframe that looks like this:</p>\n\n<pre><code>created_at  actor_attributes_email      type\n3/11/12 7:28    jeremy@asynk.ch         PushEvent\n3/11/12 7:28    jeremy@asynk.ch         PushEvent\n3/11/12 7:28    jeremy@asynk.ch         PushEvent\n3/11/12 7:42    jeremy@asynk.ch         IssueCommentEvent\n3/11/12 11:06   d.bussink@gmail.com     PushEvent\n3/11/12 11:06   d.bussink@gmail.com     PushEvent\n</code></pre>\n\n<p>Now I want to rearrange it by month (still sorted by time, and still maintaining the integrity of the rows). That should create 3 columns for each month, and then put all the data relevant to that month (created_at, actor_attributes_email, &amp; type) in those 3 columns, so that I get the following headers (for all the months present in the data):</p>\n\n<pre><code>april_created_at april_actor_attributes_email april_type may_created_at may_actor_attributes_email may_type  \n</code></pre>\n\n<p>How can I accomplish this in R?</p>\n\n<p>The CSV file with the entire dataset can be found here:\n<a href=\"https://github.com/aronlindberg/VOSS-Sequencing-Toolkit/blob/master/rubinius_rubinius_sequencing/rubinius_6months.csv\" rel=\"nofollow\">https://github.com/aronlindberg/VOSS-Sequencing-Toolkit/blob/master/rubinius_rubinius_sequencing/rubinius_6months.csv</a></p>\n\n<p>Here is a <code>dput()</code> of the first rows of the CSV:</p>\n\n<pre><code>structure(list(created_at = structure(c(1L, 1L, 1L, 2L, 2L, 2L, \n3L, 3L, 3L, 4L, 4L, 4L, 5L, 5L, 5L, 6L, 6L, 6L, 7L, 7L, 7L, 8L, \n8L, 8L, 9L, 9L, 9L, 10L, 10L, 10L), .Label = c(\"2012-03-11 07:28:04\", \n\"2012-03-11 07:28:19\", \"2012-03-11 07:42:16\", \"2012-03-11 11:06:13\", \n\"2012-03-11 12:46:25\", \"2012-03-11 13:03:12\", \"2012-03-11 13:12:34\", \n\"2012-03-11 13:14:52\", \"2012-03-11 13:30:14\", \"2012-03-11 13:30:48\"\n), class = \"factor\"), actor_attributes_email = structure(c(3L, \n3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c(\"\", \n\"d.bussink@gmail.com\", \"jeremy@asynk.ch\"), class = \"factor\"), \n    type = structure(c(2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, \n    2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, \n    2L, 2L, 2L, 2L, 2L), .Label = c(\"IssueCommentEvent\", \"PushEvent\"\n    ), class = \"factor\")), .Names = c(\"created_at\", \"actor_attributes_email\", \n\"type\"), class = \"data.frame\", row.names = c(NA, -30L))\n</code></pre>\n\n<p>Some other assumptions are:</p>\n\n<ul>\n<li>Even if \"PushEvent\" (for example) is repeated 10x I need to retain all of these, since I will be doing sequence analysis using the R package TraMineR</li>\n<li>Columns can be of unequal length</li>\n<li>There is no relationship between the columns for different months</li>\n<li>Data within a certain month should be sorted with the earliest time first</li>\n</ul>\n"},{"tags":["r","format","visualization","d3.js","data-visualization"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":98,"score":1,"question_id":12818864,"title":"How to write to json with children from R","body":"<p>I want to turn an R data.frame into a JSON object in order to use it for preparing data visualizations with d3.js. I found a lot of questions that asked how to get JSON into R, but very few on how to write data from R to JSON. </p>\n\n<p>A particular problem is that the JSON file needs to be nested by using factors, i.e. columns of the data.frame. I think that writing from nested lists could be a solution, but I already failed to create a nested list from a data.frame :(</p>\n\n<p>I have preprared an example:</p>\n\n<p>this represents my data.frame (called \"MyData\").</p>\n\n<pre><code>ID  Location Station   Size Percentage\n1     Alpha    Zeta    Big       0.63\n2     Alpha    Zeta Medium       0.43\n3     Alpha    Zeta  small       0.47\n4     Alpha    Yota    Big       0.85\n5     Alpha    Yota Medium       0.19\n6     Alpha    Yota  small       0.89\n7      Beta   Theta    Big       0.09\n8      Beta   Theta Medium       0.33\n9      Beta   Theta  small       0.79\n10     Beta    Meta    Big       0.89\n11     Beta    Meta Medium       0.71\n12     Beta    Meta  small       0.59\n</code></pre>\n\n<p>now, I want to turn it into something like this valid json format, including the children nodes:</p>\n\n<pre><code>   {\n \"name\":\"MyData\",\n \"children\":[\n   {\n     \"name\":\"Alpha\",\n     \"children\":[\n        {\n           \"name\":\"Zeta\",\n           \"children\":[\n              {\n                 \"name\":\"Big\",\n                 \"Percentage\":0.63\n              },\n              {\n                 \"name\":\"Medium\",\n                 \"Percentage\":0.43\n              },\n              {\n                 \"name\":\"Small\",\n                 \"Percentage\":0.47\n              }\n           ]\n        },\n        {\n           \"name\":\"Yota\",\n           \"children\":[\n              {\n                 \"name\":\"Big\",\n                 \"Percentage\":0.85\n              },\n              {\n                 \"name\":\"Medium\",\n                 \"Percentage\":0.19\n              },\n              {\n                 \"name\":\"Small\",\n                 \"Percentage\":0.89\n              }\n           ]\n        }\n    ]   \n},\n    {\n     \"name\":\"Zeta\",\n     \"children\":[\n        {\n           \"name\":\"Big\",\n           \"Percentage\":0.63\n        },\n        {\n           \"name\":\"Medium\",\n           \"Percentage\":0.43\n        },\n        {\n           \"name\":\"Small\",\n           \"Percentage\":0.47\n        }\n     ]\n  },\n  {\n     \"name\":\"Yota\",\n     \"children\":[\n        {\n           \"name\":\"Big\",\n           \"Percentage\":0.85\n        },\n        {\n           \"name\":\"Medium\",\n           \"Percentage\":0.19\n        },\n        {\n           \"name\":\"Small\",\n           \"Percentage\":0.89\n        }\n     ]\n  }\n  ]\n }\n</code></pre>\n\n<p>If anyone could help me out I would be very much grateful!\nthank you</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":56,"score":4,"question_id":12824279,"title":"Assignment to the result of a function changes variable","body":"<p>Looking through the <code>ave</code> function, I found a remarkable line:</p>\n\n<pre><code>split(x, g) &lt;- lapply(split(x, g), FUN) # From ave\n</code></pre>\n\n<p>Interestingly, this line changes the value of <code>x</code>, which I found unexpected. I expected that <code>split(x,g)</code> would result in a list, which could be assigned to, but discarded afterward. My question is, why does the value of <code>x</code> change?</p>\n\n<p>Another example may explain better:</p>\n\n<pre><code>a &lt;- data.frame(id=c(1,1,2,2), value=c(4,5,7,6))\n#   id value\n# 1  1     4\n# 2  1     5\n# 3  2     7\n# 4  2     6\n\nsplit(a,a$id) # Split a row-wise by id into a list of size 2\n# $`1`\n#   id value\n# 1  1     4\n# 2  1     5\n# $`2`\n#   id value\n# 3  2     7\n# 4  2     6\n\n# Find the row with highest value for each id\nlapply(split(a,a$id),function(x) x[which.max(x$value),])\n# $`1`\n#   id value\n# 2  1     5\n# $`2`\n#   id value\n# 3  2     7\n\n# Assigning to the split changes the data.frame a!\nsplit(a,a$id)&lt;-lapply(split(a,a$id),function(x) x[which.max(x$value),])\na\n#   id value\n# 1  1     5\n# 2  1     5\n# 3  2     7\n# 4  2     7\n</code></pre>\n\n<p>Not only has <code>a</code> changed, but it changed to a value that does not look like the right hand side of the assignment! Even if assigning to <code>split(a,a$id)</code> somehow changes <code>a</code> (which I don't understand), why does it result in a <code>data.frame</code> instead of a <code>list</code>? </p>\n\n<p>Note that I understand that there are better ways to accomplish this task. My question is why does <code>split(a,a$id)&lt;-lapply(split(a,a$id),function(x) x[which.max(x$value),])</code> change <code>a</code>?</p>\n"},{"tags":["r","permutation"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":12815165,"title":"permutation with repetition","body":"<p>In R, how can I produce all the permutation of a group, but in this group there are some repetitive elements.</p>\n\n<p>Example :</p>\n\n<pre><code>A = {1,1,2,2,3} \n</code></pre>\n\n<p>solution :</p>\n\n<pre><code>1,1,2,2,3\n1,1,2,3,2\n1,1,3,2,2\n1,2,1,2,3\n1,2,2,1,3\n1,2,2,3,1\n.\n.\n</code></pre>\n"},{"tags":["r","graph","graph-theory","shortest-path"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":179,"score":2,"question_id":2771178,"title":"Are there any R Packages for Graphs (shortest path, etc.)?","body":"<p>I know that R is statistical pkg, but probably there is library to work with graphs and find shortest path btw 2 nodes.</p>\n\n<p>PS actually, I've found igraph and e1071, which one is better?\nThank you</p>\n"},{"tags":["r","xts"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":105,"score":5,"question_id":12823445,"title":"Faster Way of Calculating Rolling Realized Volatility in R","body":"<p>I want to calculate the rolling 20 day realized volatility for a collection of indices.  Here is the code I use to download the index prices, calculate the daily returns and the 20 day realized volatility.</p>\n\n<pre><code>library(quantmod)\nlibrary(PerformanceAnalytics)\n\ntickers = c(\"^RUT\",\"^STOXX50E\",\"^HSI\", \"^N225\", \"^KS11\")\nmyEnv &lt;- new.env()\ngetSymbols(tickers, src='yahoo', from = \"2003-01-01\", env = myEnv)\nindex &lt;- do.call(merge, c(eapply(myEnv, Ad), all=FALSE))\n\n#Calculate daily returns for all indices and convert to arithmetic returns\nindex.ret &lt;- exp(CalculateReturns(index,method=\"compound\")) - 1\nindex.ret[1,] &lt;- 0\n\n#Calculate realized volatility\nrealizedvol &lt;- rollapply(index.ret, width = 20, FUN=sd.annualized)\n</code></pre>\n\n<p>Everything works pretty quick until the final line.  I haven't timed it but it is on the scale of minutes whereas I would expect it to take only seconds.  Is there a faster way to calculate the realized volatility? </p>\n\n<p>Thank you.</p>\n"},{"tags":["r","regression","smoothing","loess"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":82,"score":1,"question_id":12822069,"title":"loess predict with new x values","body":"<p>I am attempting to understand how the <code>predict.loess</code> function is able to compute new predicted values (<code>y_hat</code>) at points <code>x</code> that do not exist in the original data.  For example (this is a simple example and I realize loess is obviously not needed for an example of this sort but it illustrates the point):</p>\n\n<pre><code>x &lt;- 1:10\ny &lt;- x^2\nmdl &lt;- loess(y ~ x)\npredict(mdl, 1.5)\n[1] 2.25\n</code></pre>\n\n<p><code>loess</code> regression works by using polynomials at each <code>x</code> and thus it creates a predicted <code>y_hat</code> at each <code>y</code>.  However, because there are no coefficients being stored, the \"model\" in this case is simply the details of what was used to predict each <code>y_hat</code>, for example, the <code>span</code> or <code>degree</code>.  When I do <code>predict(mdl, 1.5)</code>, how is <code>predict</code> able to produce a value at this new <code>x</code>?  Is it interpolating between two nearest existing <code>x</code> values and their associated <code>y_hat</code>? If so, what are the details behind how it is doing this?</p>\n\n<p>I have read the <code>cloess</code> documentation online but am unable to find where it discusses this.</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":373,"score":2,"question_id":11765067,"title":"Unable to install the \"zoo\" package (R version 2.15.1)","body":"<p>I'm currently using R version 2.15.1, and I'm trying to install the \"zoo\" package, but I get the following error:  \"package ‘zoo’ is not available (for R version 2.15.1)\". Documentation says it depends on R>=2.10.0, are there any add-on packages it depends on that I need to install? I'm using the function \"install.packages\" to try to install this package, any thoughts thanks. </p>\n\n<pre><code>R version 2.15.1 (2012-06-22)\nPlatform: x86_64-pc-linux-gnu (64-bit)\n\nlocale:\n[1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n[3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n[5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n[7] LC_PAPER=C                 LC_NAME=C                 \n[9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] splines   stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n[1] ggplot2_0.9.0    lattice_0.20-6   nlme_3.1-104     MASS_7.3-19     \n[5] rms_3.5-0        Hmisc_3.9-3      survival_2.36-14\n\nloaded via a namespace (and not attached):\n[1] cluster_1.14.2     colorspace_1.1-1   dichromat_1.2-4    digest_0.5.2      \n[5] grid_2.15.1        memoise_0.1        munsell_0.3        plyr_1.7.1        \n[9] proto_0.3-9.2      RColorBrewer_1.0-5 reshape2_1.2.1     scales_0.2.0      \n[13] stringr_0.6        tcltk_2.15.1       tools_2.15.1 \n</code></pre>\n"},{"tags":["r"],"answer_count":5,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":105,"score":5,"question_id":12805964,"title":"Remove duplicates keeping entry with largest absolute value","body":"<p>Let's say I have four samples: id=1, 2, 3, and 4, with one or more measurements on each of those samples:</p>\n\n<pre><code>&gt; a &lt;- data.frame(id=c(1,1,2,2,3,4), value=c(1,2,3,-4,-5,6))\n&gt; a\n  id value\n1  1     1\n2  1     2\n3  2     3\n4  2    -4\n5  3    -5\n6  4     6\n</code></pre>\n\n<p>I want to remove duplicates, keeping only one entry per ID - the one having the largest absolute value of the \"value\" column. I.e., this is what I want:</p>\n\n<pre><code>&gt; a[c(2,4,5,6), ]\n  id value\n2  1     2\n4  2    -4\n5  3    -5\n6  4     6\n</code></pre>\n\n<p>How might I do this in R? </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12822949,"title":"prop.test iteratively","body":"<p>I have a situation like this: first of all I have a data.frame:</p>\n\n<blockquote>\n  <p>DF<br>\n       COL1       COL2<br>\n       29         1623<br>\n       27         1600<br>\n       30         1617<br>\n       8          1620        </p>\n</blockquote>\n\n<p>Then, I have a vector like this:</p>\n\n<blockquote>\n<pre><code> [1]        [2]  \n 50         1602        \n</code></pre>\n</blockquote>\n\n<p>What I need is to bind the first row of DF with the vector to have: </p>\n\n<p>output</p>\n\n<blockquote>\n  <p>[1]    [2]<br>\n   29    1623<br>\n   50    1602   </p>\n</blockquote>\n\n<p>On this output I would like to apply the prop.test using this code: </p>\n\n<blockquote>\n  <p>prop.test(output[,1], output[,2], correct=FALSE) </p>\n</blockquote>\n\n<p>I need to do this on the entire DF, so:</p>\n\n<p>first: bind first row of DF with the vector<br>\nsecond: prop.test<br>\nthen again<br>\nfirst: bind second row of DF with the vector<br>\nsecond: prop.test</p>\n\n<p>This iteratively.</p>\n\n<p>Any suggestion please?</p>\n\n<p>thanks a lot</p>\n"},{"tags":["r","gwidgets"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12819232,"title":"How to add a spinning wheel animation to a gWidgets GUI","body":"<p>I have just started making GUI's in R and as a first step I'm working with gWidgets before venturing into some lower level frameworks...</p>\n\n<p>I would like to add a spinning wheel animation to show that a process is running. While gWidgets doesn't seem to support this, RGtk2 does.</p>\n\n<p>So my basic question is how to add an RGtk2 widget to a gWidgets GUI when the widget is not 'natively' supported by gWidgets. Also, how do you manipulate the widget once added...</p>\n\n<p>Thanks in advance</p>\n\n<p>Thomas</p>\n"},{"tags":["r","data.table"],"answer_count":6,"favorite_count":4,"up_vote_count":14,"down_vote_count":1,"view_count":408,"score":13,"question_id":6147119,"title":"Challenge: recoding a data.frame() — make it faster","body":"<p>Recoding is a common practice for survey data, but the most obvious routes take more time than they should. </p>\n\n<p>The fastest code that accomplishes the same task with the provided sample data by <code>system.time()</code> on my machine wins. </p>\n\n<pre><code>## Sample data\ndat &lt;- cbind(rep(1:5,50000),rep(5:1,50000),rep(c(1,2,4,5,3),50000))\ndat &lt;- cbind(dat,dat,dat,dat,dat,dat,dat,dat,dat,dat,dat,dat)\ndat &lt;- as.data.frame(dat)\nre.codes &lt;- c(\"This\",\"That\",\"And\",\"The\",\"Other\")\n</code></pre>\n\n<p>Code to optimize.</p>\n\n<pre><code>for(x in 1:ncol(dat)) { \n    dat[,x] &lt;- factor(dat[,x], labels=re.codes)\n    }\n</code></pre>\n\n<p>Current <code>system.time()</code>: </p>\n\n<pre><code>   user  system elapsed \n   4.40    0.10    4.49 \n</code></pre>\n\n<p>Hint: <code>dat &lt;- lapply(1:ncol(dat), function(x) dat[,x] &lt;- factor(dat[,x],labels=rc)))</code> is not any faster.</p>\n"},{"tags":["r","ggplot2","axis"],"answer_count":0,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":206,"score":7,"question_id":11978429,"title":"x axis on top of the figure in ggplot","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/11766422/change-position-of-tick-marks-of-a-single-graph-using-ggplot2\">change position of tick marks of a single graph, using ggplot2</a>  </p>\n</blockquote>\n\n\n\n<p>How can I get the x-axis on top of my plot using ggplot2/R?</p>\n\n<p>This <a href=\"http://stackoverflow.com/questions/8639973/how-to-plot-with-x-axis-at-the-top-of-the-figure\">question</a> is similar, but in python.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12816900,"title":"prop.test on single observations","body":"<p>I have a situation like this: \nI produced 1000 random lists (here only 4 random lists are reported) composed of genes. I checked how many genes in this lists are mutated. Here the mutated genes are reported in the column Mutated_genes. It is simply a count. The expected is p = 0.02 (p column).</p>\n\n<blockquote>\n  <p>DFR<br>\n     Mutated_genes                Tot     p</p>\n\n<pre><code> 29         1600        0.02\n 27         1600        0.02\n 30         1600        0.02\n 8          1600        0.02\n</code></pre>\n</blockquote>\n\n<p>I would like to perform a chi squared test. To do that I used the following code:</p>\n\n<blockquote>\n  <p>prop.test(DFR$Mutated_genes, p = DFR$p, DFR$Tot, alternative=\"two.sided\", conf.level=.99)</p>\n</blockquote>\n\n<p>The problem is that it performs chi.squared on the entire matrix. As a matter of fact the output is: </p>\n\n<blockquote>\n  <p>X-squared = 10009.67, df = 1000, p-value &lt; 2.2e-16<br>\n  alternative hypothesis: two.sided </p>\n</blockquote>\n\n<p>I would like to have the chi squared value for each row, so for each observation. How this can be done?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["r","data.table"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":12821881,"title":"Turn vector output into columns in data.table?","body":"<p>I am generating output by applying function to some subsets of data.table. I am using function like this:</p>\n\n<pre><code>data[, foo(args), by=list(Year, Month)]\n</code></pre>\n\n<p>My function <code>foo</code> return always a vector of length <code>n</code>. I am getting an output like this:</p>\n\n<pre><code>      Year Month           V1\n   1: 1983     2 9.734669e-06\n   2: 1983     2 9.165665e-06\n   3: 1983     2 2.097477e-05\n   4: 1983     2 3.803727e-05\n</code></pre>\n\n<p>But I would like something like</p>\n\n<pre><code>      Year Month           V1           V2           V3           V4 ...\n   1: 1983     2 9.734669e-06 9.165665e-06 2.097477e-05 3.803727e-05 ...\n</code></pre>\n\n<p>I even tried using <code>list(foo(args))</code>, it didn't help. Or should the output be in form <code>foo$V1, foo$V2 ...</code>?</p>\n"},{"tags":["r","igraph"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":56,"score":-1,"question_id":12821971,"title":"stretching igraph","body":"<p>I am trying to create an igraph that shows the relationship between vertex's. It works but vertexs are on top of each other. I really like to stretch it so that nodes are clear and and readable by the end user.</p>\n\n<p>my df is this:</p>\n\n<pre><code>Player    Sport \nA         Soccer\nA         Baseball\nA         Voleyball\nA         Swimming\nB         Soccer\nB         Baseball\nC         Baseball\nC         Track\nC         Gymnastic\nC         Diving\n\ng &lt;- graph.data.frame(df)\n\nplot(g, layout = layout.kamada.kawai,  vertex.label = V(g)$name,  vertex.label.color= \"darkblue\",  edge.arrow.size=0.9,  edge.curved=T, edge.label.color=\"#F900F9\", edge.label.font=10,vertex.shape=\"rectangle\",edge.color=\"darkgreen\")\n</code></pre>\n\n<p>when I plot the g, I get nodes on top of each other. I like to show this in width=800 and height=500 png. How do you stretch this graph so that you get a good and clear wiew of the diagram, rather than nodes being on top of each other?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":54,"score":0,"question_id":12805054,"title":"create a frequency matrix from a 4 dim matrix in R","body":"<p>I have a matrix in k*4 dimension that each row is one of a combination of <code>(1:20,1:20,1:20,1:20)</code> and specify type of quadruplet node . For example for <code>k=3</code> I have 3 tetrahedron that type of node is here</p>\n\n<pre><code>X &lt;- matrix(c(1,  3, 1 ,4,\n              2,  5, 6 ,1,\n              12,20,15 ,3),   3,4,byrow=T) \n</code></pre>\n\n<p>Now I want to create a frequency table in dim 20*8000 from it that record the frequency of each node in contact with the three remaining node. On the other hand I want to know that each node in quadruplet is in contact with which type of node. </p>\n\n<p>For example for the first row I have a one in 1,(1,3,4)th of F and also in 3,(1,1,4) and in 4,(1,1,3).</p>\n\n<p>I hope that I could explain my problem good to understand.\nPlease help me in code of this conversion</p>\n\n<p>Note: \nAs the first row of my X matrix is 1,3,1,4 the output matrix(F) should record a  one in the </p>\n\n<pre><code>F[1,which(colnames(F)==\"1 3 4\") &lt;- F[1,which(colnames(F)==\"1 3 4\") +1\nF[1,which(colnames(F)==\"1 3 4\") &lt;- F[1,which(colnames(F)==\"1 3 4\") +1\nF[3,which(colnames(F)==\"1 1 4\") &lt;- F[3,which(colnames(F)==\"1 1 4\") +1\nF[4,which(colnames(F)==\"1 1 3\") &lt;- F[4,which(colnames(F)==\"1 1 3\")+1\n</code></pre>\n\n<p>It means that each row add 4 ones to the frequency matrix in the 4 row of it and it may be the same for 2,3 or 4 of it. For example because of one is repeated in the row one, adds two records to F[1,which(colnames(F)==\"1 3 4\")</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12820189,"title":"How to force older packages to install on newer versions of R?","body":"<p>I cannot install <code>proj4string</code> into my current version of R (2.15.1):</p>\n\n<pre><code>Warning message:\npackage ‘proj4string’ is not available (for R version 2.15.1) \n</code></pre>\n\n<p>I assume this is because 2.15.1 is fairly new and the package just hasn't been updated.  Is there a general mechanism for forcing R to install an older version of a binary package (realizing that there may be bugs that result)?</p>\n"},{"tags":["string","r","parsing","eval","tilde"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":70,"score":4,"question_id":12819364,"title":"Stop R from parsing ~ to user's home directory","body":"<p>I try to run the following script in R (minimized example):</p>\n\n<pre><code>library(neuralnet)\n\narrhythmia &lt;- read.csv(file=\".../arrhythmia-edited.csv\", head=TRUE, sep=\",\")\n\n# create the first parameter for neuralnet formular \n# format like 'classification ~ attribute1 + attribute2 + ...\n# i have so many features, that why i use a for\ninput &lt;- \"\"\nfor (i in 1:259)\n  input &lt;- paste(input, paste(paste('arrhythmia[,',i),'] +'))\ninput &lt;- paste(input, 'arrhythmia[,260]')\n\n# create string for function call\nnnet.func &lt;- paste('neuralnet(arrhythmia[,261] ~', input)\nnnet.func &lt;- paste(nnet.func, ', data=arrhythmia)')\n\n# call function neuralnet\n# should be like: neuralnet(arrhythmia[,261] ~ arrhythmia[,1] + arrhythmia[,2] + ... + arrhytmia[,260], data=arrhythmia)\nnet.arrhythmia &lt;- eval(parse(nnet.func))\n</code></pre>\n\n<p>The problem is that R is parsing this as following (using Linux):</p>\n\n<pre><code>'neuralnet(arrhythmia[,261] /home/user  arrhythmia[, 1 ] + ....\n</code></pre>\n\n<p>How can I prevent R from parsing ~ into /home/[user-directory]? </p>\n"},{"tags":["r","for-loop","append","inherit","confidence-interval"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12816974,"title":"R lme loop woes with \"try\" and lme confidence intervals","body":"<p>R users, I've still been hashing out bits and pieces related to my initial question as seen here and now I'm quite stuck.</p>\n\n<p><b>http://stackoverflow.com/questions/12270578/skipping-over-an-error-warning-in-an-lme-loop-in-r</b></p>\n\n<p>Here is the code using mtcars as an example dataset. I want to save the lower and upper confidence intervals for every response variable as listed below (but not for the intercept, though I still need its other coefficients for the lme but I've got that already), all in one go (my real dataset is very large and I'm trying to automate it as much as possible)</p>\n\n<pre><code>library(log10)\nlibrary(nlme) \nlibrary(lattice)\n\nresponseVariables = c(\"mpg\",                                   \n \"disp\",             \n \"hp\")\n\ncarModels &lt;- list()\ncarModelNames &lt;- list()\ncoint&lt;- list()  \ncoint2&lt;- list()\ncoint$fixed &lt;- list()\nlower&lt;- list() \nupper&lt;- list() \ncarCIlower &lt;- list()\ncarCIupper &lt;- list()\n\n\nfor (i in responseVariables){\n    print(\"Doing: \")\n    print(i)\n    mtcars$tmp &lt;- as.numeric(mtcars[,i])\n    tmpLme &lt;- lme( log10(tmp) ~ I(log10(wt)), random = ~1 | carb / gear / am, data=mtcars,na.action=na.omit ) \n    carModels &lt;- append(carModels, list(tmpLme))\n    carModelNames &lt;- append(carModelNames,i) \n\n\n    coint &lt;- try(intervals(tmpLme))   \n        if (inherits(coint, \"try-error\")) {\n        tmpLme &lt;- lme(log10(tmp) ~ log10(wt), random = ~1 | carb / gear, data=mtcars, na.action=na.omit);\n        coint &lt;- try(intervals(tmpLme));\n\n    } else if (inherits(coint, \"try-error\")) {\n        tmpLme &lt;- lme(log10(tmp) ~ log10(wt), random = ~1 | carb / gear, data=mtcars, na.action=na.omit, method=\"ML\");\n        coint &lt;- try(intervals(tmpLme));\n\n    } else if (inherits(coint, \"try-error\")) {\n        tmpLme &lt;- lme(log10(tmp) ~ log10(wt), random = ~1 | carb, data=mtcars, na.action=na.omit);\n        coint &lt;- try(intervals(tmpLme));\n           #} \n\n    coint2&lt;- append(coint, list(tmpLme))   \n    lower &lt;- dim(coint2$fixed)[1]   \n    upper &lt;- dim(coint2$fixed)[1]\n    carCIlower &lt;- append(carCIlower, coint2$fixed[2,1],lower) \n    carCIupper &lt;- append(carCIupper, coint2$fixed[2,3],upper)  \n    vs_wt &lt;- cbind(carModelNames , carCIlower , carCIlower )\n    }\n        }\n</code></pre>\n\n<p>Currently I can get the CI values if I run the commands for each response variable, but not as part of the loop. The loop doesn't proceed past the coint2 statement. Well it does but it doesn't give me answers for coint2 and beyond. Or if I run those lines again it'll only give me values for the last item in the loop (i=hp). Also I see there's an unbalanced curly bracket (I've commented it out to show you) but if I use it gives me the lower CI for \"disp\" for the lower and upper CI for all resp variables.</p>\n\n<p>Can someone point out what's missing?</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":307,"score":3,"question_id":10393269,"title":"Create non-overlapping stacked area plot with ggplot2","body":"<p>I have some data scraped and processed from the web in this form:</p>\n\n<pre><code>&gt;head(dat)\n  count  name          episode    percent\n1   309   don 01-a-little-kiss 0.27081507\n2   220 megan 01-a-little-kiss 0.19281332\n3   158  joan 01-a-little-kiss 0.13847502\n4   113 peggy 01-a-little-kiss 0.09903593\n5   107 roger 01-a-little-kiss 0.09377739\n6    81  pete 01-a-little-kiss 0.07099036\n</code></pre>\n\n<p>I'm trying to created a stacked area chart, similar to the one here: <a href=\"http://stackoverflow.com/questions/4651428/making-a-stacked-area-plot-using-ggplot2\">Making a stacked area plot using ggplot2</a></p>\n\n<p>When I do a </p>\n\n<pre><code>require(RCurl)\nrequire(ggplot2)\nlink &lt;- getURL(\"http://dl.dropbox.com/u/25609375/so_data/final.txt\")\ndat &lt;- read.csv(textConnection(link), sep=' ', header=FALSE, \n             col.names=c('count', 'name', 'episode'))\n\ndat &lt;- ddply(dat, .(episode), transform, percent = count / sum(count))\n\nggplot(dat, aes(episode, percent, group=name)) + \n     geom_area(aes(fill=name, colour=name), position='stack')\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/pUEhY.png\" alt=\"enter image description here\"></p>\n\n<p>I get this bizarre chart. </p>\n\n<p>I want the areas not to cross eachother, and to fill the entire canvas as the total percent for each <code>episode</code> factor equals 100%.</p>\n"},{"tags":["r","plot"],"answer_count":3,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":3828,"score":7,"question_id":4785657,"title":"R - How to draw an empty plot?","body":"<p>Every once in a while I need to make an empty plot. This is the best could I come up with.</p>\n\n<pre><code>plot(0,xaxt='n',yaxt='n',bty='n',pch='',ylab='',xlab='')\n</code></pre>\n\n<p>Any simpler solutions? </p>\n\n<p>p.s 1: completely empty, no axis etc.</p>\n\n<p>Thanks!</p>\n"},{"tags":["r","ggplot2","heatmap"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":161,"score":1,"question_id":12732412,"title":"heat maps in R with heatmap.2","body":"<p>I am trying to create a heatmap in R. I have tried using the heatmap.2 command.</p>\n\n<p>My data consists of x, and y columns and associated relative frequency of a point(frequency divided by the total frequency)</p>\n\n<p>with zero frequency in most places and a small relative frequency in others. I have converted my data to a matrix since this seems what the heatmap command wants and attempted to remove the x and y-coordinates. </p>\n\n<pre><code>BB &lt;- matrix(as.matrix(surfacerevfreq1[, 3]),  ncol = 35, byrow = T)\n</code></pre>\n\n<p>There are two problems as I see it, not all x and y -coordinates are listed. i.e. the x-coordinate starts at 1 and goes to 35 whereas the y-coordinate starts at 11 and goes to 30. The heatmap function does not seem to like this. I have thought over inserting zeros at the beggining of the data set so that each point from  1- 10  on the y-axis had a value. However, I am not sure if this is the best idea.</p>\n\n<p>So I suppose my question is: how do I format my data in such a way that I can a valid heatmap from this data? I should add that I want the numbers on my x and y-scale displayed also if possible. Since the purpose it to graphically show the relative frequency associated with each point.</p>\n\n<p>thanks.</p>\n\n<p>here is a subset of my data so that you can see what it looks like in matrix form</p>\n\n<pre><code>    col1         col2         col3         col4         col5         col6            col7         col8         col9        col10        col11        col12 \n0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000    0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 \n   col13        col14        col15        col16        col17         col18            col19        col20        col21        col22        col23        col24 \n0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000  0.0000000000 0.0000000000 0.0000000000 0.0005017561 0.0005017561 0.0000000000 \n   col25        col26        col27        col28        col29            col30            col31        col32        col33        col34        col35 \n0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000      0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 \n</code></pre>\n\n<p>and here is the heatmap command that I am using:</p>\n\n<pre><code>hU &lt;- heatmap.2(xx, Rowv=FALSE, symm=TRUE,  trace=\"none\", density.info=\"none\",   dendrogram=\"none\")\n</code></pre>\n"},{"tags":["r","file-format"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12804203,"title":"Is there an R package to parse geophysical \"Log Ascii Standard\" Files (.las files)?","body":"<p>Is there an R package that can read .las files, i.e. Schlumberger <a href=\"http://en.wikipedia.org/wiki/Log_ASCII_Standard\" rel=\"nofollow\">Log Ascii standard</a> files?<br>\nIt should be capable of reading las 2.0 files.</p>\n\n<p>Please note:</p>\n\n<ul>\n<li>I am not talking about LIDAR .las files here. </li>\n<li>I am talking about geophysical \nwell-hole logging files (not logging files for computer apps, demons and the like)</li>\n</ul>\n\n<p>Searching for R and Las and Logfiles on the internet gives me personally too many red herrings.</p>\n\n<p>Updates from Comments:</p>\n\n<p>I am also considering scripts or APIs that could make use of language bindings for R.</p>\n\n<p>So far, I've found the following scripts:</p>\n\n<ul>\n<li><a href=\"https://github.com/wellstorm/las2witsml\" rel=\"nofollow\">las2witsml</a> - a ruby script</li>\n<li><a href=\"http://cpansearch.perl.org/src/KYOMAIODP/Text-LAS-Parser-0.01/lib/Text/LAS/Parser.pm\" rel=\"nofollow\">Text-LAS-Parser-0.01</a> - a perl script</li>\n</ul>\n\n<p>However, all these scripts so far seem not very mature to me.</p>\n\n<p>There is also  a freeware software package <a href=\"http://www.slb.com/services/characterization/software/data_utilities/log_data_toolbox.aspx\" rel=\"nofollow\">\"Log Data Toolbox</a>\" by Schlumberger, but it only runs under Windows and might have compatibility issues with non-english Versions of Windows (if I remember correctly).</p>\n\n<p>There is a <a href=\"http://www.kgs.ku.edu/stratigraphic/PROFILE/applet.html\" rel=\"nofollow\">complex java applet</a> from the Kansas Geological Survey, but it is a bit sluggish for large .las input-files.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":57,"score":-1,"question_id":12814441,"title":"Error in scan(file, what...), but there is no values missing and no space in header","body":"<p>I have a script. The script run perfectly in two other datasets, but failed to run in the last datasets. There was an error when I run the script to the last datasets:</p>\n\n<pre><code> \"Now Processing files  MAHOUT.432.csv  and  Files_MAHOUT.432.csv\"\n    Error in scan(file, what, nmax, sep, dec, quote, skip, nlines, na.strings, : \n      line 1 did not have 156 elements\n</code></pre>\n\n<p>From my understanding, there were two possibilities why this might happened:\n1. there is a missing values\n2. space in the header</p>\n\n<p>I have checked both possibilities, and it appear that, there was no missing values and there was no space in the header. </p>\n\n<pre><code> #load .csv files\n    a.files &lt;- grep(\"^MAHOUT\", dir(), value=TRUE) \n    b.files &lt;- paste(\"Files_\", a.files, sep=\"\")\n    a.files\n    b.files\n\n    for(i in 1:length(a.files))\n    {\n        print(paste(\"Now Processing files \",paste(a.files[i]),paste(\" and \"),paste(b.files[i])))\n        a &lt;- read.table(a.files[i], header=T, sep=\",\", row.names=1)\n        b &lt;- read.table(b.files[i], header=T, sep=\",\", row.names=1) \n    ...\n</code></pre>\n\n<p>Here is the dput(a)</p>\n\n<pre><code>structure(list(MAHOUT.432 = c(0L, 0L, 1L, 0L, 0L), MAHOUT.434 = c(0L, \n1L, 0L, 0L, 0L), MAHOUT.435 = c(0L, 0L, 1L, 0L, 0L), MAHOUT.436 = c(0L, \n0L, 0L, 1L, 0L), MAHOUT.437 = c(0L, 0L, 0L, 1L, 0L), MAHOUT.438 = c(0L, \n0L, 1L, 0L, 0L), MAHOUT.439 = c(0L, 0L, 1L, 0L, 0L), MAHOUT.440 = c(0L, \n0L, 1L, 0L, 0L), MAHOUT.441 = c(0L, 0L, 1L, 0L, 0L), MAHOUT.442 = c(1L, \n0L, 0L, 0L, 0L), MAHOUT.443 = c(0L, 0L, 0L, 1L, 0L)), .Names = c(\"MAHOUT.432\", \n\"MAHOUT.434\", \"MAHOUT.435\", \"MAHOUT.436\", \"MAHOUT.437\", \"MAHOUT.438\", \n\"MAHOUT.439\", \"MAHOUT.440\", \"MAHOUT.441\", \"MAHOUT.442\", \"MAHOUT.443\"\n), class = \"data.frame\", row.names = c(\"Drew Farris\", \"Grant Ingersoll\", \n\"Sean Owen\", \"Ted Dunning\", \"Unassigned\"))\n</code></pre>\n\n<p>and here is dput(b)</p>\n\n<pre><code>structure(list(VectorTest.java = c(0L, 0L, 0L, 1L, 0L, 0L, 0L, \n0L, 0L, 0L, 0L), TestKmeansClustering.java = c(0L, 0L, 0L, 0L, \n0L, 0L, 0L, 0L, 0L, 0L, 0L), AbstractVector.java. = c(0L, 0L, \n0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L), DenseVector.java. = c(0L, \n0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L), SparseVector.java. = c(0L, \n0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L), KMeansDriver.java = c(0L, \n0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L), CanopyClusteringJob.java = c(0L, \n0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L), Job.java = c(0L, 0L, \n0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L), Constants.java = c(0L, 0L, \n0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L), OutputMapper.java = c(0L, \n0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L)), .Names = c(\"VectorTest.java\", \n\"TestKmeansClustering.java\", \"AbstractVector.java.\", \"DenseVector.java.\", \n\"SparseVector.java.\", \"KMeansDriver.java\", \"CanopyClusteringJob.java\", \n\"Job.java\", \"Constants.java\", \"OutputMapper.java\"), class = \"data.frame\", row.names = c(\"MAHOUT-432\", \n\"MAHOUT-434\", \"MAHOUT-435\", \"MAHOUT-436\", \"MAHOUT-437\", \"MAHOUT-438\", \n\"MAHOUT-439\", \"MAHOUT-440\", \"MAHOUT-441\", \"MAHOUT-442\", \"MAHOUT-443\"\n</code></pre>\n\n<p>sessioninfo()</p>\n\n<pre><code>R version 2.15.1 (2012-06-22)\nPlatform: i386-pc-mingw32/i386 (32-bit)\n</code></pre>\n\n<p>Appreciate your help.</p>\n"},{"tags":["r","colors","ggplot2","categorization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12814523,"title":"Categorizing samples in R, and plotting them in different colors","body":"<p>I am new to learning R. I wanted to know how I can asssign a categorical value to observations I have read in as a dataframe. For eg I have data for m variables from n samples and I want to assign some samples as group 1 and some samples as group 2 and so on. Also, how can I visualise different groups in different colors when I plot them?</p>\n"},{"tags":["r","plot","histogram"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":181,"score":0,"question_id":12784929,"title":"Plotting two histograms of a continuous variable, with bars next to each other instead of overlapping","body":"<p>I am trying to plot two histograms in one plot, but the way these two groups are distributed makes the histogram a little hard to interpret. My histogram now looks like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/L377C.jpg\" alt=\"enter image description here\"></p>\n\n<p>This is my code:</p>\n\n<pre><code>hist(GROUP1, col=rgb(0,0,1,1/2), breaks=100, freq=FALSE,xlab=\"X\",main=\"\")  # first histogram\nhist(GROUP1, col=rgb(1,0,0,1/2), breaks=100, freq=FALSE , add=T)  # second\nlegend(0.025,600,legend=c(\"group 1\",\"group 2\"),col=c(rgb(1,0,0,1/2),rgb(0,0,1,1/2)),pch=20,bty=\"n\",cex=1.5)\n</code></pre>\n\n<p>Is it possible to plot this histograms, with the bars of the two groups right next to each other, instead of them overlapping? I realize that that might add some confusion, since the X-axis represents a continuous variable... Other suggestions of how to make this plot in more clear are of course also welcome!</p>\n"},{"tags":["r","export-to-excel","import-from-excel"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":426,"score":3,"question_id":1848331,"title":"What's a robust method in R for importing from and exporting data to Excel?","body":"<p>I've used RODBC for some time to import Excel spreadsheets with mostly good results. However I have had no luck writing to an Excel spreadsheet. Also are there favorable differences using the xlsx format with Excel2007? </p>\n"},{"tags":["r"],"answer_count":6,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":5667,"score":2,"question_id":5568847,"title":"How to open CSV file in R when R says \"no such file or directory\"?","body":"<p>I have an excel file that I want to open in R. I tried both of these commands after saving the excel file as a csv file or a text file.</p>\n\n<p>read.table() or read.csv()</p>\n\n<p>I think part of the problem is where the file is located. I have it saved on the desk top. What am I missing here?</p>\n\n<p>Here is the R output</p>\n\n<pre><code>In file(file, \"rt\") :\n  cannot open file 'Rtrial.csv': No such file or directory\n&gt; help.search(\"read.csv\")\n&gt; read.csv(\"Rtrial.csv\")\nError in file(file, \"rt\") : cannot open the connection\nIn addition: Warning message:\nIn file(file, \"rt\") :\n  cannot open file 'Rtrial.csv': No such file or directory\n&gt; read.table(\"tab\")\n</code></pre>\n"},{"tags":["r","loops"],"answer_count":6,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":1318,"score":6,"question_id":4894506,"title":"Avoid two for loops in R","body":"<p>I have a R code that can do convolution of two functions...  </p>\n\n<pre><code>convolveSlow &lt;- function(x, y) {  \nnx &lt;- length(x); ny &lt;- length(y)  \nxy &lt;- numeric(nx + ny - 1)  \nfor(i in seq(length = nx)) {  \n xi &lt;- x[[i]]  \n        for(j in seq(length = ny)) {  \n            ij &lt;- i+j-1  \n            xy[[ij]] &lt;- xy[[ij]] + xi * y[[j]]  \n        }  \n    }  \n    xy  \n}  \n</code></pre>\n\n<p>Is there a way to remove the two for loops and make the code run faster?</p>\n\n<p>Thank you\nSan</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":12810861,"title":"How to get a single trendline with multiple data sets in R and ggplot2?","body":"<p>I have multiple sources of data over three decades. \nThe data is discontiguous and overlaps in multiple places. I would like to plot the points for each data source in a different color but then add a single trendline that uses all of the data sources.\nThe included code has some sample data and two plot examples. The first call to ggplot, plots a single trendline for all of the data. the second ggplot call, plots each source distinctly in different colors with its own trendline. </p>\n\n<pre><code>    library(ggplot2)\n    the.data &lt;- read.table( header=TRUE, sep=\",\", \n    text=\"source,year,value\n    S1,1976,56.98\n    S1,1977,55.26\n    S1,1978,68.83\n    S1,1979,59.70\n    S1,1980,57.58\n    S1,1981,61.54\n    S1,1982,48.65\n    S1,1983,53.45\n    S1,1984,45.95\n    S1,1985,51.95\n    S1,1986,51.85\n    S1,1987,54.55\n    S1,1988,51.61\n    S1,1989,52.24\n    S1,1990,49.28\n    S1,1991,57.33\n    S1,1992,51.28\n    S1,1993,55.07\n    S1,1994,50.88\n    S2,1993,54.90\n    S2,1994,51.20\n    S2,1995,52.10\n    S2,1996,51.40\n    S3,2002,57.95\n    S3,2003,47.95\n    S3,2004,48.15\n    S3,2005,37.80\n    S3,2006,56.96\n    S3,2007,48.91\n    S3,2008,44.00\n    S3,2009,45.35\n    S3,2010,49.40\n    S3,2011,51.19\") \n    ggplot( the.data, aes( the.data$year, the.data$value ) ) + geom_point() + geom_smooth()\n    #ggplot( the.data, aes( the.data$year, the.data$value, color=the.data$source ) ) + geom_point() + geom_smooth()\n</code></pre>\n\n<p>The second call displays the colored data points and I would like to add a single contiguous trendline representing all of the years.</p>\n"},{"tags":["r","operators"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12810643,"title":"augmented assignment in R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5738831/r-plus-equals-and-plus-plus-equivalent-from-c-c-java-etc\">R:  += (plus equals) and ++ (plus plus) equivalent from c++/c#/java, etc.?</a>  </p>\n</blockquote>\n\n\n\n<p>I like to be specific in my variable names, but this can lead to very long commands in R. For example,</p>\n\n<pre><code>MyModelOutput$coefficients[1] &lt;- MyModelOutput$coefficients[1] + samplingAdjustment[1]\n</code></pre>\n\n<p>I know that C uses augmented assignment operators, so the above could be written as</p>\n\n<pre><code>MyModelOutput$coefficients[1] += samplingAdjustment[1]\n</code></pre>\n\n<p>Is there such an operator for R? I have been unable to find it in the manual or other help pages. Is there a cleaner way to write this?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":147,"score":0,"question_id":9236306,"title":"Pass arguments to a function from each row of a matrix","body":"<p>I created this function:</p>\n\n<pre><code>nDone&lt;- function (under,strike,ttoe,vol,rf,dy) {\n    return(pnorm(((log(under/strike) + (rf-dy+(vol^2)/2)*ttoe)/(vol*(ttoe^0.5)))))\n }\n\nnDone(90,100,3,0.17,0.05,0)\n[1] 0.6174643\n</code></pre>\n\n<p>So far that's fine and works.  Now I want the function to be applied to each row of a matrix.</p>\n\n<pre><code>b&lt;- c(90,95,100,100,3,2,0.17,0.18,0.05,0.05,0,0)\ndim(b) &lt;- c(2,6)\n</code></pre>\n\n<p>Which gives:</p>\n\n<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6]\n[1,]   90  100    3 0.17 0.05    0\n[2,]   95  100    2 0.18 0.05    0\n</code></pre>\n\n<p>So now I want to pass the elements in each row to the function. I've tried using apply:</p>\n\n<pre><code>apply(b,1,nDone)\n</code></pre>\n\n<p>And get the following error:</p>\n\n<pre><code>Error in under/strike : 'strike' is missing\n</code></pre>\n\n<p>I've also tried:</p>\n\n<pre><code>lapply(b,nDone)\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>Error in under/strike : 'strike' is missing\n</code></pre>\n\n<p>What I want is multiple results of the function. What am I doing wrong here?</p>\n"},{"tags":["r","statistics"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":45,"score":3,"question_id":12809209,"title":"R package for creating multidimensional, periodic basis function?","body":"<p>I am doing some modelling work in which I am trying to parametrise an effect that varies with season and time of day. The time of day effect differs between seasons in a complex way so it seems the most general approach is to model the effect in a periodic [time of day, day of year] space.</p>\n\n<p>The effect being described has a non-linear relationship to the actual predictor and predicted quantities, so I need an explicit parametrisation that I can tune using non-linear optimisation.</p>\n\n<p>So, the most obvious option would be a 2D Fourier basis. Can anyone recommend an R package for generating this? I found the package fda which has the function 'create.fourier.basis' but this appears to only apply to 1D.</p>\n\n<p>Beyond a Fourier approach, the sampling of the data I have is highly irregular in the [time of day, day of year] plane so ideally a more localised approach such as a periodic cubic spline in which I can place more knots in the data rich parts of the plane would be preferable. Does anyone know of an R package that creates a 2D basis for this kind of representation?</p>\n"},{"tags":["r","histogram"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":12808901,"title":"Color histogram bins by majority class","body":"<p>I've written a useful function to color histogram bars by the majority class in each bar:</p>\n\n<pre><code>color_hist &lt;- function(x, cats, ...){\n  hist &lt;- hist(x, plot=FALSE, ...)\n  cuts &lt;- cut(x, breaks=hist$breaks)\n\n  color = apply(table(cuts, cats), 1, which.max)\n\n  hist(x, col=color,...)\n}\n\ncolor_hist(iris[,4], iris[,5])\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/i9LbS.png\" alt=\"color hist\"></p>\n\n<p>I'd like to replicate the behavior of <code>hist()</code> as much as possible, but I can't figure out how to pass the title and x label from the original histogram to the colorized one:</p>\n\n<p><img src=\"http://i.stack.imgur.com/BzqKs.png\" alt=\"hist2\"></p>\n\n<p>I'd like the new histogram to have the same default title/xlabels as the old histogram, and I'd also like to pass through any other user-specified parameters. Can anyone help me solve this problem, or improve this function in any other way?</p>\n\n<p>(It would also be cool if I could get the colors to blend into each other, depending on the class percentages...)</p>\n"}]}
{"total":19203,"page":18,"pagesize":100,"questions":[{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":92,"score":6,"question_id":12807217,"title":"Splitting a number in R","body":"<p>In <code>R</code> I have a number, say <code>1293828893</code>, called <code>x</code>.</p>\n\n<p>I wish to split this number so as to remove the middle 4 digits <code>3828</code> and return them, pseudocode is as follows:</p>\n\n<pre><code>splitnum &lt;- function(number){\n     #check number is 10 digits\n     if(nchar(number) != 10){\n          stop(\"number not of right size\");\n     }\n     middlebits &lt;- middle 4 digits of number\n     return(middlebits);\n}\n</code></pre>\n\n<p>This is a pretty simple question but the only solutions I have found apply to character strings, rather than numeric ones.</p>\n\n<p>If of interest, I am trying to create an implementation in <code>R</code> of the <a href=\"http://en.wikipedia.org/wiki/Middle_square_method\">Middle-square method</a>, but this step is particularly tricky.</p>\n"},{"tags":["r","xts"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":12808504,"title":"Conditional statement on an xts object in R","body":"<p>I have an xts object in R and I want to create another object from it. My xts object looks like:</p>\n\n<pre><code>dates = seq(from=as.Date('2012-09-01'),to=as.Date('2012-09-05'),'day')\nmy_xts_obj = xts(c(1,2,3,4,5),dates)\n&gt; my_xts_obj\n           [,1]\n2012-09-01    1\n2012-09-02    2\n2012-09-03    3\n2012-09-04    4\n2012-09-05    5\n</code></pre>\n\n<p>I want to create another object that meets the following conditions</p>\n\n<pre><code>val = 0, if my_xts_obj &gt;2.5 and &lt;3.5\nval = -1, if my_xts_obj &lt;2.5\nval = +1, if my_xts_obj &lt;3.5\n</code></pre>\n\n<p>to yield,</p>\n\n<pre><code>my_new_xts_obj\n\n           [,1]\n2012-09-01    -1\n2012-09-02    -1\n2012-09-03    0\n2012-09-04    1\n2012-09-05    1\n</code></pre>\n\n<p>One approach I could use is to parse it thru a for loop, use an if then statement to make my object. Is there a better way?</p>\n\n<p>Another approach I can think of would be </p>\n\n<pre><code>my_new_xts_obj = my_xts_obj%/%2.5 + my_xts_obj%/%3.5, gives me \n2012-09-01    0\n2012-09-02    0\n2012-09-03    1\n2012-09-04    2\n2012-09-05    3\n</code></pre>\n\n<p>This is not exactly what I am looking for</p>\n"},{"tags":["regex","r","twitter"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12799910,"title":"R Regex for direct messages on Twitter","body":"<p>I got a set of Twitter status updates and im trying to filter all direct messages, senders and receivers of the latter. My dataframe includes columns for senders and text. Using regular expressions I'm trying filter the receivers out of the text column. </p>\n\n<p>this ist what I got, but its returning some strange results</p>\n\n<pre><code>   WD &lt;- getwd()\n   if (!is.null(WD)) setwd(WD)\n\n   load(\"data.R\")\n   #http://www.unet.univie.ac.at/~a0406222/data.R\n\n   dmtext &lt;- grep(\"^@[a-z0-9_]{1,15}\", tweets$text, perl=T, value=TRUE,ignore.case=TRUE)\n   dm.receiver &lt;- gsub(\"^@([a-z0-9_]{1,15})[ :,].*$\", \"\\\\1\", dmtext, perl=T,ignore.case=TRUE)\n   dm.sender &lt;- as.character(tweets$from_user[grep(\"^@[a-z0-9_]{1,15}\", tweets$text,       perl=T,ignore.case=TRUE,value=FALSE)])\n\n\n   dm.df &lt;- data.frame(dm.sender,dm.receiver,dmtext)\n\n   dm.df[1:1000,2]\n</code></pre>\n\n<p>these are some examples of the bad results I get for dm.receiver</p>\n\n<pre><code>    @insultaofuturo Apesar da proibição, jovens insistem em acampar no Aterro na Rio+20\\nhttp://t.co/dCfFHUWV\n    @mqtodd Bringing the .green Internet to Rio+20 Summit | DotGreen\\nhttp://t.co/pQqYilXp #RioPlus20 #gogreen\n    @Shyman33 Elinor Ostrom's trailblazing commons research can inspire Rio+20\\n http://t.co/m7OTHBtP\n    @OccupyRio20 @pnud_es @FBuenAbad @rioplussocial #Futurewewant \\nALGO DE ESTO SE HA CUMPLIDO? http://t.co/QDlVwT5z\n    @UNDP_CDG#UNDP#Asia-Pacific#Rio+20E-discussion on National&amp;amp;Local Planning for Sustainable Development. Contribute&amp;amp;mail:aprc.rio20@undp.org\n</code></pre>\n\n<p>why is it that I get results longer than 15 characters using {1,15}?</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":245,"score":1,"question_id":10888117,"title":"ggplot: relative frequencies of two groups","body":"<p>I want a plot like this except that each facet sums to 100%.  Right now group M is 0.05+0.25=0.30 instead of 0.20+0.80=1.00.</p>\n\n<pre><code>df &lt;- rbind(\n    data.frame(gender=c(rep('M',5)), outcome=c(rep('1',4),'0')),\n    data.frame(gender=c(rep('F',10)), outcome=c(rep('1',7),rep('0',3)))\n)\n\ndf\n\nggplot(df, aes(outcome)) +\n    geom_bar(aes(y = (..count..)/sum(..count..))) +\n    facet_wrap(~gender, nrow=2, ncol=1) \n</code></pre>\n\n<p>(Using y = ..density.. gives worse results.)</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12799150,"title":"What causes undefined column selected in rfe?","body":"<p>I am using the <code>rfe</code> function in the <code>caret</code> package to do feature selection. I frequently get the following error:</p>\n\n<blockquote>\n  <p>'Error in { : \n    task 1 failed - \"error in evaluating the argument 'x' in selecting a method for function 'as.data.frame': Error in <code>[.data.frame</code>(x, , retained, drop = FALSE) : \n    undefined columns selected`</p>\n</blockquote>\n\n<p>I'm doing 100 samples and it runs for about 60 samples or so before producing the error I'm executing the following:</p>\n\n<pre><code>folds=100\nvalidmethod='boot'\nsubsets=c(5,10,15,20,25)\n\nctrl &lt;- rfeControl(functions = funcs,\n                   method = validmethod,\n                   rerank=TRUE,\n                   saveDetails=TRUE,\n                   verbose = TRUE,\n                   returnResamp = \"all\",\n                   number=folds)\n\nrfe(df.preds,df.depend, metric=smetric,sizes=subsets, rfeControl=ctrl)\n</code></pre>\n\n<p>Can someone help me understand the types of things which would cause this error?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12806272,"title":"Create a 1 at a random point within ranges of a matrix column","body":"<p>Given the following data format, If D1 is a matrix in R how would I populate column X2 each day with a single, random 1 between the times of 0630 &amp; 1030 (inclusive)?? Only one 1 per day, that 1 appearing at a random point. The real data is much longer, maybe 1000 days or more so I'd end up with 1000 1's all placed between 0630 &amp; 1030.</p>\n\n<p>Note that while this is 5 minute data I'd like to find a solution that worked with other periods also. (15 minute, 1 minute, etc.) That could be a second step if necessary.</p>\n\n<pre><code>D1 &lt;- structure(c(1110920, 1110920, 1110920, 1110920, 1110920, 1110920, \n1110920, 1110920, 1110920, 1110920, 1110920, 1110920, 1110920, \n1110920, 1110920, 1110920, 1110920, 1110920, 1110920, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, \n1110921, 1110921, 1110921, 1110921, 1110921, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, \n1110922, 1110922, 1110922, 1110922, 2225, 2230, 2235, 2240, 2245, \n2250, 2255, 2300, 2305, 2310, 2315, 2320, 2325, 2330, 2335, 2340, \n2345, 2350, 2355, 0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, \n100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 200, \n205, 210, 215, 220, 225, 230, 235, 240, 245, 250, 255, 300, 305, \n310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 400, 405, 410, \n415, 420, 425, 430, 435, 440, 445, 450, 455, 500, 505, 510, 515, \n520, 525, 530, 535, 540, 545, 550, 555, 600, 605, 610, 615, 620, \n625, 630, 635, 640, 645, 650, 655, 700, 705, 710, 715, 720, 725, \n730, 735, 740, 745, 750, 755, 800, 805, 810, 815, 820, 825, 830, \n835, 840, 845, 850, 855, 900, 905, 910, 915, 920, 925, 930, 935, \n940, 945, 950, 955, 1000, 1005, 1010, 1015, 1020, 1025, 1030, \n1035, 1040, 1045, 1050, 1055, 1100, 1105, 1110, 1115, 1120, 1125, \n1130, 1135, 1140, 1145, 1150, 1155, 1200, 1205, 1210, 1215, 1220, \n1225, 1230, 1235, 1240, 1245, 1250, 1255, 1300, 1305, 1310, 1315, \n1335, 1340, 1345, 1350, 1355, 1400, 1405, 1410, 1415, 1420, 1425, \n1430, 1505, 1510, 1515, 1520, 1525, 1530, 1535, 1540, 1545, 1550, \n1555, 1600, 1605, 1610, 1615, 1620, 1625, 1630, 1635, 1640, 1645, \n1650, 1655, 1700, 1705, 1710, 1715, 1720, 1725, 1730, 1735, 1740, \n1745, 1750, 1755, 1800, 1805, 1810, 1815, 1820, 1825, 1830, 1835, \n1840, 1845, 1850, 1855, 1900, 1905, 1910, 1915, 1920, 1925, 1930, \n1935, 1940, 1945, 1950, 1955, 2000, 2005, 2010, 2015, 2020, 2025, \n2030, 2035, 2040, 2045, 2050, 2055, 2100, 2105, 2110, 2115, 2120, \n2125, 2130, 2135, 2140, 2145, 2150, 2155, 2200, 2205, 2210, 2215, \n2220, 2225, 2230, 2235, 2240, 2245, 2250, 2255, 2300, 2305, 2310, \n2315, 2320, 2325, 2330, 2335, 2340, 2345, 2350, 2355, 0, 5, 10, \n15, 20, 25, 30, 35, 40, 45, 50, 55, 100, 105, 110, 115, 120, \n125, 130, 135, 140, 145, 150, 155, 200, 205, 210, 215, 220, 225, \n230, 235, 240, 245, 250, 255, 300, 305, 310, 315, 320, 325, 330, \n335, 340, 345, 350, 355, 400, 405, 410, 415, 420, 425, 430, 435, \n440, 445, 450, 455, 500, 505, 510, 515, 520, 525, 530, 535, 540, \n545, 550, 555, 600, 605, 610, 615, 620, 625, 630, 635, 640, 645, \n650, 655, 700, 705, 710, 715, 720, 725, 730, 735, 740, 745, 750, \n755, 800, 805, 810, 815, 820, 825, 830, 835, 840, 845, 850, 855, \n900, 905, 910, 915, 920, 925, 930, 935, 940, 945, 950, 955, 1000, \n1005, 1010, 1015, 1020, 1025, 1030, 1035, 1040, 1045, 1050, 1055, \n1100, 1105, 1110, 1115, 1120, 1125, 1130, 1135, 1140, 1145, 1150, \n1155, 1200, 1205, 1210, 1215, 1220, 1225, 1230, 1235, 1240, 1245, \n1250, 1255, 1300, 1305, 1310, 1315, 1335, 1340, 1345, 1350, 1355, \n1400, 1405, 1410, 1415, 1420, 1425, 1430, 1435, 1505, 1510, 1515, \n1520, 1525, 1530, 1535, 1540, 1545, 1550, 1555, 1600, 1605, 1610, \n1615, 1620, 1625, 1630, 1635, 1640, 1645, 1650, 1655, 1700, 1705, \n1710, 1715, 1720, 1725, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \n0, 0, 0, 0), .Dim = c(500L, 3L), .Dimnames = list(NULL, c(\"Date\", \n\"Time\", \"X2\")))\n</code></pre>\n"},{"tags":["r","environment-variables"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":12803269,"title":"R understanding variable scopes","body":"<p>How do i modify the value of vairable 'loco' in following snippet:</p>\n\n<pre><code>poco &lt;- function() {\n\nfunc &lt;- function(x) {\n    print(loco)\n    loco &lt;- loco+x\n}\n\nloco &lt;- 123\nfunc(1)\nfunc(2)\n}\n</code></pre>\n\n<p>this functions gives following result:</p>\n\n<pre><code>&gt; poco()\n[1] 123\n[1] 123\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":74,"score":5,"question_id":12806491,"title":"how to create 3 by 3 Contingency table with two variables in R","body":"<p><strong>Example:</strong> </p>\n\n<pre><code>x &lt;- c( 1, NA, 0, 1)\ny &lt;- c(NA, NA, 0, 1)\ntable(x,y, useNA=\"always\") # ---&gt;\n#       y\n# x      0 1 &lt;NA&gt;\n#   0    1 0    0\n#   1    0 1    1\n#  &lt;NA&gt;  0 0    1\n</code></pre>\n\n<p><strong>My question is:</strong></p>\n\n<pre><code>a &lt;- c(NA, NA, NA, NA)\nb &lt;- c(1, 1, 1, 1)\ntable(a, b, useNA=\"always\") ## --&gt; It is 1X2 matrix. \n#       b\n# a      1 &lt;NA&gt;\n#   &lt;NA&gt; 4    0\n</code></pre>\n\n<p>I want to get a 3X3 table with the <strong>same colnames, rownames and dimensions</strong> as the example above.. Then I will apply chisq.test for the table.\nThank you very much for your answers!</p>\n"},{"tags":["r","sorting"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":44,"score":4,"question_id":12806128,"title":"lexicographical ordering in R","body":"<p>I have a following data frame </p>\n\n<pre><code>a = data.frame(a=c(1,2,3,4,5,6,7),b=c(1,2,3,10,12,21,4),c=c(1,2,10,11,\"X\",\"Y\",3))\n&gt; a\n  a  b  c\n1 1  1  1\n2 2  2  2\n3 3  3 10\n4 4 10 11\n5 5 12  X\n6 6 21  Y\n7 7  4  3\n</code></pre>\n\n<p>I want to sort whole data frame in lexicographical order, so that the output (for example, column \"c\") should be like</p>\n\n<pre><code>&gt; a[,\"c\"]\n[1] 1  2  3 10 11  X  Y\n</code></pre>\n\n<p>I tried and I am geting different answer</p>\n\n<pre><code>indata &lt;- a[do.call(order,a[,c(\"c\",\"a\",\"b\")]),]\n&gt; indata[,\"c\"]\n[1] 1  10 11 2  3  X  Y\nLevels: 1 10 11 2 3 X Y\n</code></pre>\n\n<p>I tried gtools, mixedorder package and worked fine on one column:</p>\n\n<pre><code>&gt; a[mixedorder(a$c),]\n  a  b  c\n1 1  1  1\n2 2  2  2\n3 3  3 10\n4 4 10 11\n5 5 12  X\n6 6 21  Y\n7 7  4  3\n</code></pre>\n\n<p>but it doesn't work if I include multiple columns:</p>\n\n<pre><code>&gt; a[with(a,order(mixedorder(c),mixedorder(b),mixedorder(a))),]\n  a  b  c\n1 1  1  1\n2 2  2  2\n4 4 10 11\n5 5 12  X\n6 6 21  Y\n7 7  4  3\n3 3  3 10\n</code></pre>\n\n<p>though I am expecting :</p>\n\n<pre><code>  a  b  c\n1 1  1  1\n2 2  2  2\n4 7  4  3\n5 3  3 10\n6 4 10 11\n7 5 12  X\n3 6 21  Y\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":28,"score":4,"question_id":12806157,"title":"Sum columns in maM(marrayNorm) in R","body":"<p>I have to confess that I'm a <em>newbie</em> in R so, I really need some help here!</p>\n\n<p>I have a <code>marrayNorm</code> object from library <code>marray</code> (on bioconductor), after the normalization of 12 arrays with 13640 spots each. Now I need to convert my 12 columns into 6 columns by sum together each 2 array normalized data columns .</p>\n\n<p>start with <code>maM(marrayNorm)</code>:</p>\n\n<pre><code> **a   b   c   d** ... (up to 12 columns)  \n 1    2    3   4  \n 5   6   7   8   \n9   10  11  12  \n</code></pre>\n\n<p>...13640 rows</p>\n\n<p>end with:</p>\n\n<pre><code>**ab  cd**  \n3   7  \n11  15  \n19  23  \n</code></pre>\n"},{"tags":["r","xtable"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":81,"score":5,"question_id":12800784,"title":"How to get dimnames in xtable.table output?","body":"<p>I'd like to have the dimensions labeled in my <code>xtable</code> output.  However, the table method of <code>xtable</code> does not output dimension labels even when I specify them manually to <code>table</code>:</p>\n\n<pre><code>set.seed(10)\nd &lt;- data.frame(x=sample(1:4),y=sample(1:4))\ntb &lt;- with(d, table(d,dnn=c(\"Xs\",\"Ys\")))\n&gt; tb\n   Ys\nXs  1 2 3 4\n  1 0 0 0 1\n  2 0 1 0 0\n  3 1 0 0 0\n  4 0 0 1 0\n&gt; xtable(tb)\n% latex table generated in R 2.15.1 by xtable 1.7-0 package\n% Tue Oct  9 09:06:10 2012\n\\begin{table}[ht]\n\\begin{center}\n\\begin{tabular}{rrrrr}\n  \\hline\n &amp; 1 &amp; 2 &amp; 3 &amp; 4 \\\\ \n  \\hline\n1 &amp;   0 &amp;   0 &amp;   0 &amp;   1 \\\\ \n  2 &amp;   0 &amp;   1 &amp;   0 &amp;   0 \\\\ \n  3 &amp;   1 &amp;   0 &amp;   0 &amp;   0 \\\\ \n  4 &amp;   0 &amp;   0 &amp;   1 &amp;   0 \\\\ \n   \\hline\n\\end{tabular}\n\\end{center}\n\\end{table}\n</code></pre>\n\n<p>Inspection of the code for <code>xtable.table</code> doesn't yield any secrets.  Short of building them manually with multirow is there any way of getting the dimensions labeled?</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":86,"score":3,"question_id":12805168,"title":"Fast way to flatten a list of list while only keeping the 1st element in each sublist","body":"<p>Consider the command that creates a list of list as follows:</p>\n\n<pre><code>myList &lt;- list(a = list(1:5), b = \"Z\", c = NA)\n</code></pre>\n\n<p>This creates something like:</p>\n\n<pre><code> $a\n $a[[1]]\n [1] 1 2 3 4 5\n\n $b\n [1] \"Z\"\n\n $c\n [1] NA\n</code></pre>\n\n<p>Now when I do unlist to this, </p>\n\n<pre><code>unlist(myList, recursive = FALSE)\n</code></pre>\n\n<p>I get </p>\n\n<pre><code> $a\n [1] 1 2 3 4 5\n\n $b\n [1] \"Z\"\n\n $c\n [1] NA\n</code></pre>\n\n<p>whereas what I am actually looking for is the first element from each sublist , i.e.</p>\n\n<pre><code> 1\n \"Z\"\n NA\n</code></pre>\n\n<p>Loops are very slow. No loops please.</p>\n"},{"tags":["r","venn-diagram"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":77,"score":3,"question_id":12803390,"title":"VennDiagram - internal labels","body":"<p><img src=\"http://i.stack.imgur.com/X8y4A.png\" alt=\"enter image description here\">I plotted my genelists using the VennDiagram R package, and the diagram looks fine.</p>\n\n<p>I wanted to add internal labels to the Venn diagram like, if data is shared by first and second group but not by the third and fourth group, then the label should be 1100. I found one thing on Venn{gplots} package which uses the <code>showSetLogicLabel=TRUE</code> to do this. </p>\n\n<p>I am searching exactly for the same functionality, but using the VennDiagram package.</p>\n\n<p>Exactly, like in the below picture, which gives binary codes to every count in the diagram. \nI wanted to generate that binary codes in the VennDiagram package.</p>\n\n<p><img src=\"http://rgm2.lab.nig.ac.jp/RGM_results/gplots%3avenn/venn_016_big.png\" alt=\"\"></p>\n"},{"tags":["r","variables"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1159,"score":1,"question_id":6330468,"title":"How can I define a global variable (text) in R","body":"<p>I want to develop a variable as a parameter in a function, like</p>\n\n<p>W&lt;-\"Hi I am working on R\" (W is the variable, it is the text file)</p>\n\n<p>The function I want to develop is like getText=function(W){} this function get call another script.</p>\n\n<p>Then W can work as a global variable everywhere in the script appearing W can show the \"Hi I am working on R\"</p>\n"},{"tags":["data","r","dataset","statistics"],"answer_count":17,"favorite_count":41,"up_vote_count":33,"down_vote_count":0,"view_count":4165,"score":33,"question_id":2252144,"title":"Datasets for Running Statistical Analysis on","body":"<p>What datasets exist out on the internet that I can run statistical analysis on?</p>\n"},{"tags":["r","latex","knitr"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":83,"score":3,"question_id":12746684,"title":"Can I use a knitr inline expression in the title of a latex document?","body":"<p>I'd like to use a Knitr/Sweave in-line call (<code>\\Sexpr{}</code>) in the title of a LaTeX document, after the \\begin{document} command but before the \\maketitle command. The in-line R code would extract one or two pieces of information from an R data-frame created early in the R script I'm embedding in LaTeX.</p>\n\n<p>I have a couple of Knitr chunks that create a data.frame from which I derive the information I want to put in the Title. I've tried placing these chunks between LaTeX's \\begin{document} call and the \\title code, like this:</p>\n\n<pre><code>\\documentclass\n[LaTex Preamble]\n\\begin{document}\n[%% Knitr chunks that initialize an R data-frame]\n\\title \\Sexpr{--a snippet of R code that extracts an element from the data-frame --}\n\\maketitle\n... (rest of the LaTeX document)\n</code></pre>\n\n<p>and I've also tried putting the Knitr chunks in the preamble to the LaTeX code before \\begin{document} statement.</p>\n\n<p>But in Knitr seems to ignore code (other than initialization) that is placed ahead of the \\maketitle call in LaTeX, so the in-line snippets included the title look like errors to Latex and it halts output.</p>\n\n<p>I can't find any information in the Knitr documentation on including in-line code in the Title of a LaTeX document.</p>\n\n<p>Any ideas?</p>\n\n<hr>\n\n<p>OK: Found the solution thanks to the hint from @ben-bolker below. Ben uses the formatting of R chunks before output to an RNW file (in a 2-step Knitr process: latex -> rnw -> pdf) . But I'm compiling the LaTeX file to PDF in one-step without going to an RNW file from inside TeXShop (on Mac OSX). I found that I could get Ben's example to work using the RNW delimiters (&lt;&lt;>>=) and one-step compiling. But I couldn't mix the usual LaTeX chunk-delimiters (%%begin.rcode and %% end.rcode) and the RNW in-line statement hook (\\Sexpr{}). The latter didn't work no matter how I fiddled with it. Eventually I found that the correct in-line hook for LaTeX is <strong>\\\\rinline{}</strong>. </p>\n\n<p>It's not very clear in the Knitr documentation that this is the required format for LaTeX and I found it eventually mainly thanks to Ben's example. Best, Peter</p>\n\n<hr>\n\n<p><strong>Update 2</strong> ... and then there's RTFM (or the 'cheat sheet' in this case): <a href=\"http://cran.r-project.org/web/packages/knitr/vignettes/knitr-refcard.pdf\" rel=\"nofollow\">http://cran.r-project.org/web/packages/knitr/vignettes/knitr-refcard.pdf</a></p>\n"},{"tags":["graphics","r","ggplot2"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":3017,"score":2,"question_id":1476185,"title":"How to overlay a line for an lm object on a ggplot2 scatterplot","body":"<p>I have some data, </p>\n\n<pre><code>calvarbyruno.1&lt;-structure(list(Nominal = c(1, 3, 6, 10, 30, 50, 150, 250), Run = structure(c(1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c(\"1\", \"2\", \"3\"), class = \"factor\"), \n    PAR = c(1.25000000000000e-05, 0.000960333333333333, 0.00205833333333334, \n    0.00423333333333333, 0.0322333333333334, 0.614433333333334, \n    1.24333333333333, 1.86333333333333), PredLin = c(-0.0119152187070942, \n    0.00375925114245899, 0.0272709559167888, 0.0586198956158952, \n    0.215364594111427, 0.372109292606959, 1.15583278508462, 1.93955627756228\n    ), PredQuad = c(-0.0615895732702735, -0.0501563307416599, \n    -0.0330831368244257, -0.0104619953693943, 0.100190275883806, \n    0.20675348710041, 0.6782336426345, 1.04748729725370)), .Names = c(\"Nominal\", \n\"Run\", \"PAR\", \"PredLin\", \"PredQuad\"), row.names = c(NA, 8L), class = \"data.frame\")\ncalweight &lt;- -2\n</code></pre>\n\n<p>for which I've created both a linear and a quadratic lm model</p>\n\n<pre><code>callin.1&lt;-lm(PAR~Nominal,data=calvarbyruno.1,weight=Nominal^calweight)\ncalquad.1&lt;-lm(PAR~Nominal+I(Nominal^2),data=calvarbyruno.1,weight=Nominal^calweight)\n</code></pre>\n\n<p>I can then plot my data values using ggplot2</p>\n\n<pre><code>qplot(PAR,Nominal,data=calvarbyruno.1)\n</code></pre>\n\n<p>But can't work out how to overlay a line representing the two lm objects... Any ideas ?</p>\n"},{"tags":["r","data-visualization","ggplot2"],"answer_count":1,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":107,"score":8,"question_id":12792911,"title":"How can I draw something in the background of a ggplot?","body":"<p>I'm working on making shot charts for basketball. I need to figure out how to actually draw the outline of a basketball court in the background. Any ideas?</p>\n\n<p><img src=\"http://i.stack.imgur.com/YnEt0.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/7j4Oy.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/qzlUw.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","graph","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12797892,"title":"Minor breaks do not show when using scale_x_reverse","body":"<p>I can't get the <code>minor_breaks</code> argument to do anything when I use the convenience function <code>scale_x_reverse</code></p>\n\n<pre><code>df &lt;- data.frame(x=c(10,20,40,90,300),y=c(1,2,7,2,7)) #define data frame\n\n# scale_x_continuous uses minor_breaks just like it should\nggplot(df, aes(x,y)) + geom_line() +\n    scale_x_continuous(breaks=c(10,50,100,150,200,250,300), minor_breaks=10:300)\n\n# scale_x_reverse seems to ignore the minor_breaks option\nggplot(df, aes(x,y)) + geom_line() + \n    scale_x_reverse(breaks=c(10,50,100,150,200,250,300), minor_breaks=10:300)\n</code></pre>\n\n<p>Is there any way that I can reverse the X axis but still be able to customise the minor breaks?</p>\n"},{"tags":["r","plot","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":2,"view_count":103,"score":1,"question_id":12794596,"title":"How fill part of a circle using ggplot2","body":"<pre><code>circleFun &lt;- function(center = c(0,0),diameter = 1, npoints = 100){\nr = diameter / 2\ntt &lt;- seq(0,2*pi,length.out = npoints)\nxx &lt;- center[1] + r * cos(tt)\nyy &lt;- center[2] + r * sin(tt)\nreturn(data.frame(x = xx, y = yy))\n}\ndat &lt;- circleFun(c(1,-1),2.3,npoints = 100)\nggplot(dat,aes(x,y)) + geom_path(color=\"black\") + ggtitle(\"circle\")\n</code></pre>\n\n<p>I am plotting with ggplot2. I want to fill the circle with blue only in first quadrant. What should I do?</p>\n\n<p>Thank you !</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12801949,"title":"gWidgetsWWW: Loading files remotely","body":"<p>I can not find how to upload files remotely.I tried to run the example of gWidgetsWWW2's documentation:</p>\n\n<pre><code>w &lt;- gwindow()\ngstatusbar(\"Powered by gWidgetsWWW2 and Rook\", cont=w)\nf &lt;- gfile(\"Choose a file for upload\", cont=w, handler=function(h,...) {\n  galert(paste(\"You uploaded\", svalue(h$obj)), parent=w)\n})\n</code></pre>\n\n<p>But I get the following error:</p>\n\n<pre><code>Error in gfile(\"Choose a file for upload\", cont = w, handler = function(h,  : \n  Not for non-local use\n</code></pre>\n\n<p>Could you help me with this?</p>\n"},{"tags":["r","match"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12786005,"title":"match with language R for getting the position","body":"<p>I am using match for getting if an element is in a list. For example my list is:</p>\n\n<pre><code>  c(\"a\",\"b\",\"h\",\"e\"...) and so on\n</code></pre>\n\n<p>if I want to see if element h is in the list I am using match in this way:</p>\n\n<pre><code>  if (\"h\" %in% v){do something}\n</code></pre>\n\n<p>How I can get the position of where it finds the element in the list?\nThanks</p>\n"},{"tags":["r","multidimensional-array","reshape"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12786584,"title":"Reshape multidimensional array","body":"<p>I have an array representing hourly temperature data, and want to compute daily maxima (or minima, or means).  I can do this using a for loop, but I am sure there must be many better ways to do this in R.  </p>\n\n<pre><code>require(ncdf4)\nnc &lt;- nc_open('file.nc')\nt2 &lt;- ncvar_get(nc,var='T2')  # [ncols, nrows, nsteps]\n</code></pre>\n\n<p>Now t2 is an array with 744 hourly time steps for a 31-day month.  What I want is:</p>\n\n<pre><code>t2.max[ncols, nrows, 31]\n</code></pre>\n\n<p>or, more generally, I would like to reshape t2 to:</p>\n\n<pre><code>t2.reshape[ncols, nrows, ndays, 24]\n</code></pre>\n\n<p>and from there I can use apply to compute daily means or maxima or whatever.</p>\n\n<p>I want the result to be an array, not a data frame.</p>\n\n<p>Suggestions?  I tried using melt/cast from the reshape package, but could not understand how to specify the desired formula.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":1,"view_count":94,"score":5,"question_id":12799457,"title":"Calculating the number of dots lie above and below the regression line with R","body":"<p>How do I calculate the number of dots lie above and below the regression line on the scatter plot? How can I do this R?</p>\n\n<pre><code>data=read.csv(\"info.csv\")\npar(pty=\"s\")\nplot(data$col1,data$col2,xlab=\"xaxis\", ylab=\"yaxis\", xlim=c(0.0,1), cex.lab=1.5,cex.axis = 1.5,ylim=c(0.0,1),col.lab=\"red\",col=\"blue\", pch=19)\nabline(a=-1.21, b=2.21)\n</code></pre>\n"},{"tags":["r","curl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12799100,"title":"Debug authorisation in R curl using NTLM","body":"<p>I am trying to access a URL from a windows (sharepoint 2007) web server within a corporate network.  I'm using R and curl but can't seem to get the authorization part right. (There is no proxy or firewall between me and the web server, and I'm on a windows machine on the same domain)  This is what I've currently got;</p>\n\n<pre><code>library(SSOAP)\nlibrary(XML)\nlibrary(RCurl)\n\n#This works fine for a page with no authroisation required\ny = tryCatch(getURLContent(\"http://www.example.com/webpagewithnoauthroisation.html\", \n                verbose=TRUE, \n                httpauth=\"ntlm\", userpwd=\"DOMAIN/username:password\"), \n        HTTPError = function(e) {\n            cat(\"HTTP error: \", e$message, \"\\n\")\n        })\n\n#This fails for a page that needs authoisation\nx = tryCatch(getURLContent(\"http://sharepoint.example.com/Pages/Default.aspx\", \n                verbose=TRUE, \n                httpauth=\"ntlm\", userpwd=\"DOMAIN/username:password\"), \n        HTTPError = function(e) {\n            cat(\"HTTP error: \", e$message, \"\\n\")\n        })\n\n&gt; Error: Unauthorized\n</code></pre>\n\n<p>I'm a bit stumped how to debug this (on my Windows machine).  Any good suggestions on debugging (r) Curl authentication issues ?</p>\n\n<p>Edit: I thought it would be NTLM, but have just read that it may something else (Kerberos ?).  The target web server is a Sharepoint 2007 server.</p>\n"},{"tags":["python","r","scipy"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":80,"score":3,"question_id":12797658,"title":"python's scipy.stats.ranksums vs. R's wilcox.test","body":"<p>Both python's scipy.stats.ranksums and R's wilcox.test are supposed to calculate two-sided p-values for a Wilcoxon rank sum test. But when I run both functions on the same data, I get p-values that differ by orders of magnitude:</p>\n\n<p>R:</p>\n\n<pre><code>&gt; x=c(57.07168,46.95301,31.86423,38.27486,77.89309,76.78879,33.29809,58.61569,18.26473,62.92256,50.46951,19.14473,22.58552,24.14309)\n&gt; y=c(8.319966,2.569211,1.306941,8.450002,1.624244,1.887139,1.376355,2.521150,5.940253,1.458392,3.257468,1.574528,2.338976)\n&gt; print(wilcox.test(x, y))\n\n        Wilcoxon rank sum test\n\ndata:  x and y \nW = 182, p-value = 9.971e-08\nalternative hypothesis: true location shift is not equal to 0 \n</code></pre>\n\n<p>Python:</p>\n\n<pre><code>&gt;&gt;&gt; x=[57.07168,46.95301,31.86423,38.27486,77.89309,76.78879,33.29809,58.61569,18.26473,62.92256,50.46951,19.14473,22.58552,24.14309]\n&gt;&gt;&gt; y=[8.319966,2.569211,1.306941,8.450002,1.624244,1.887139,1.376355,2.521150,5.940253,1.458392,3.257468,1.574528,2.338976]\n&gt;&gt;&gt; scipy.stats.ranksums(x, y)\n(4.415880433163923, 1.0059968254463979e-05)\n</code></pre>\n\n<p>So R gives me 1e-7 while Python gives me 1e-5.</p>\n\n<p>Where does this difference come from and which one is the 'correct' p-value?</p>\n"},{"tags":["r","plot"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":82,"score":5,"question_id":12795828,"title":"Adding a matrix to a plot?","body":"<p>Is there anyway to add a table to a plot. Suppose that I have the plot below:</p>\n\n<pre><code>curve(dnorm, -3, +4)\n</code></pre>\n\n<p>Now I like to add a matrix beneath the plot:</p>\n\n<pre><code>testMat &lt;- matrix(1:20, ncol = 5)\n</code></pre>\n\n<p>My goal? I'm writing a plot function that not only does create a plot, but it also shows a matrix including the information I'm interested in underneath the plot. </p>\n\n<p>Please see the attached picture to see what I mean.\nI really appreciate your help. </p>\n\n<p><img src=\"http://i.stack.imgur.com/U8pCF.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","reshape","melt","reshape2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":89,"score":2,"question_id":12620964,"title":"How to reshape a dataframe with \"reoccurring\" columns?","body":"<p>I am new to data analysis with R. I recently got a pre-formatted environmental observation-model dataset, an example subset of which is shown below:</p>\n\n<pre><code>date                   site      obs    mod      site           obs    mod\n2000-09-01 00:00:00    campus    NA     61.63    city centre    66     56.69\n2000-09-01 01:00:00    campus    52     62.55    city centre    NA     54.75\n2000-09-01 02:00:00    campus    52     63.52    city centre    56     54.65\n</code></pre>\n\n<p>Basically, the data include the time series of hourly observed and modelled concentrations of a pollutant at various sites in \"reoccurring columns\", i.e., site - obs - mod (in the example I only showed 2 out of the total 75 sites). I read this \"wide\" dataset in as a data frame, and wanted to reshape it into the \"narrower\" format as:</p>\n\n<pre><code>date                   site           obs    mod\n2000-09-01 00:00:00    campus         NA     61.63\n2000-09-01 01:00:00    campus         52     62.55\n2000-09-01 02:00:00    campus         52     63.52\n2000-09-01 00:00:00    city centre    66     56.69\n2000-09-01 01:00:00    city centre    NA     54.75\n2000-09-01 02:00:00    city centre    56     54.65\n</code></pre>\n\n<p>I believed that I should use the package \"reshape2\" to do this.  Firstly I tried to melt and then dcast the dataset:</p>\n\n<pre><code>test.melt &lt;- melt(test.data, id.vars = \"date\", measure.vars = c(\"site\", \"obs\", \"mod\"))\n</code></pre>\n\n<p>However, it only returned half of the data, i.e., records of the site(s) (\"city centre\") following the first one (\"campus\") were all cut off:</p>\n\n<pre><code>date                   variable    value\n2001-01-01 00:00:00    site        campus\n2001-01-01 01:00:00    site        campus\n2001-01-01 02:00:00    site        campus\n2001-01-01 00:00:00    obs         NA\n2001-01-01 01:00:00    obs         52\n2001-01-01 02:00:00    obs         52\n2001-01-01 00:00:00    mod         61.63\n2001-01-01 01:00:00    mod         62.55\n2001-01-01 02:00:00    mod         63.52\n</code></pre>\n\n<p>I then tried recast:</p>\n\n<pre><code>test.recast &lt;- recast(test.data, date ~ site + obs + mod)\n</code></pre>\n\n<p>However, it returned with error message:</p>\n\n<pre><code>Error in eval(expr, envir, enclos) : object 'site' not found\n</code></pre>\n\n<p>I have tried to search for previous questions but have not found similar scenarios (correct me if I am wrong).  Could someone please help me with this?</p>\n\n<p>Many thanks in advance!</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12796757,"title":"plot value labels along with bars","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6644997/showing-data-values-on-stacked-bar-chart-in-ggplot2\">Showing data values on stacked bar chart in ggplot2</a>  </p>\n</blockquote>\n\n\n\n<p>I have the following ggplot</p>\n\n<p><img src=\"http://i.stack.imgur.com/gUGkg.png\" alt=\"enter image description here\"></p>\n\n<pre><code>dt &lt;- structure(list(Age.group = structure(1:5, .Label = c(\"0-29 yrs\", \"30-49 yrs\", \"50-64 yrs\", \"65-79 yrs\", \"80+ years\"), class = \"factor\"),     Rx.Brufen = c(4.91767279891635, 24.849329416471, 39.384529665324,     42.0512030516413, 45.0282816501013), Brufen.C.I = c(9.49857407873833,     10.4942035949849, 11.0935906177108, 16.7322917304551, 18.5232702433842   ), Brufen.declined = c(1.25219908256281, 1.1156980249761,     1.18510539437499, 0.73845826559561, 1.00121613129538)), .Names = c(\"Age.group\", \"Rx.Brufen\", \"Brufen.C.I\", \"Brufen.declined\"), row.names = c(NA, -5L), class = \"data.frame\")\n\ndt.m &lt;- melt(dt, 1)\n\ncolnames(dt.m)[2] &lt;- \"Rx\"\ncolnames(dt.m)[3] &lt;- \"Proportion\"\nggplot(dt.m, aes(x=Age.group,y=Proportion, fill=Rx)) +\n    geom_bar() +\n    labs(x=\"Age Group\", y=\"Proportion %\",fill = \"\") +\n    theme(legend.position=c(.5, .9), legend.direction = \"horizontal\" ) +\n    ylim(c(0,100))\n</code></pre>\n\n<p>I would like to plot the actual values, as percentages (inside the bars for the green and red bars,  and just above for the blue ones, since they won't fit inside). Can someone advise how to achieve this ?</p>\n"},{"tags":["r","postgresql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12797909,"title":"creating temp table from a data frame in R using RPostgreSQL","body":"<p>I have a data frame which I need to write as a <strong>temp table</strong> in R using RPostgreSQL package.</p>\n\n<p>Example:</p>\n\n<pre><code>&gt;data(USArrests)\n#Assuming that we have already established a connection to the postgres db\n#Let conn be the postgres connection object\n&gt;dbWriteTable(conn, \"temp_table_data\", USArrests, temp.table=TRUE)\n</code></pre>\n\n<p>This does not work. The argument temp.table is seemingly ignored. </p>\n\n<p>If there is no way out to deal with dbWriteTable, is there anyway to write a data frame as a temp table ?</p>\n"},{"tags":["r","reshape"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12789098,"title":"How do I cast a character column in R","body":"<p>Using a data frame like this</p>\n\n<pre><code>df &lt;- data.frame(Season=c(\"1992\",\"1993\",\"1993\"),\n               Team=c(\"Man Utd.\",\"Blackburn\",\"Blackburn\"),\n               Player=c(\"Peter Schmeichel(42)\",\"Tim Flowers(39)\",\"Bobby Mimms(4)\"),\n               Order = c(1,1,2))\n</code></pre>\n\n<p>How do i get to this</p>\n\n<pre><code>   1992  Man Utd. Peter Schmeichel(42)     \n   1993 Blackburn      Tim Flowers(39)  Bobby Mimms(4) \n</code></pre>\n"},{"tags":["r","3d","powerpoint","presentation"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":104,"score":4,"question_id":12781129,"title":"embedding a R animated 3D plot in PowerPoint","body":"<p>The <code>rgl</code> R package allows to plot interactive 3D figures and to save these figures in a html document (with the <code>writeWebGL()</code> function). </p>\n\n<p>I would like to put such an interactive 3D figure in a PowerPoint presentation. Is it possible ?</p>\n\n<p><strong>EDIT:</strong> After studying Dieter Menne's answer with the help of Google, my conclusions are the following ones:</p>\n\n<ul>\n<li>Currently Luke Tierney's method to convert a 3D graphic to an U3D file and/or an Asymptote file only works for graphics crated with the <code>misc3d</code> package, not the <code>rgl</code> package.</li>\n<li>The export of 3D rgl graphics to <a href=\"http://en.wikipedia.org/wiki/VRML\" rel=\"nofollow\">VRML/X3D</a> files has been announced as a future plan. Perhaps this would allow to embed a 3D rgl graphic into a Powerpoint and/or LaTeX presentation.</li>\n</ul>\n"},{"tags":["r","data.frame"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":2,"view_count":75,"score":-1,"question_id":12796065,"title":"collapse a data.frame into a vector","body":"<p>I have a data frame like this: </p>\n\n<blockquote>\n  <p>COL1     COL2     COL3 </p>\n\n<pre><code> a         h\n b    f    \n c    g        \n d         j\n</code></pre>\n</blockquote>\n\n<p>I would like the following output:</p>\n\n<blockquote>\n  <p>COL<br>\n     a<br>\n     b<br>\n     c<br>\n     d<br>\n     f<br>\n     g<br>\n     h<br>\n     j   </p>\n</blockquote>\n\n<p>How this can be done? \nThanks in advance!</p>\n"},{"tags":["r","powerpoint"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12791404,"title":"How to run an R script file on powerpoint (VBA)","body":"<h2>I have this script file:</h2>\n\n<pre><code>library(fBasics) # Load the package fBasics.\nda=read.table(\"C:\\\\Users\\\\jose\\\\Tese\\\\Analysis of Financial Time Series\\\\dibm3dx7008.txt\",header=T) # Load the data.\n\ndim(da) # Find size of the data: 9845 rows and 5 columns.\nda[1,] # See the first row of the data\n\nibm=da[,2] # Obtain IBM simple returns\nsibm=ibm*100 # Percentage simple returns\nbasicStats(sibm) # Compute the summary statistics\n</code></pre>\n\n<hr>\n\n<p>And I want to run it from powerpoint;\nI have tried the VBA in powerpoint, can anyone help me</p>\n"},{"tags":["r","plot","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":89,"score":2,"question_id":12793717,"title":"How to plot non-standardized data with ggplot2?","body":"<p>I plot Iris data with <code>ggplot2</code>. It seems <code>ggplot2</code> will standardized the data to (0.1) interval automatically. How can I plot the data without any standardized manipulation?</p>\n\n<pre><code>library(ggplot2)\np &lt;- ggpcp(iris, vars = names(iris[1:4]))\np + geom_line(aes(color = Species)) + ylim(0,8)\n</code></pre>\n\n<hr>\n\n<p>I am not a native English speaker and I am sorry to make ambiguity. Actually, the iris data various from 0 to 8. I want to plot the data exactly reflected the real value, but not the standardized value (transform the original data to (0,1) interval).</p>\n"},{"tags":["r","stata"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":607,"score":5,"question_id":4433490,"title":"Heteroscedasticity robust standard errors with the PLM package","body":"<p>I am trying to learn <strong>R</strong> after been using <strong>STATA</strong> and I must say that I love it. But now I am having some trouble. I am about to do some multiple regressions with Panel Data so I am using the <strong>plm</strong> package.</p>\n\n<p>Now I want to have the same results with <strong>plm</strong> in <strong>R</strong> as when I use the <strong>lm</strong>-function and <strong>STATA</strong> when I perform a <strong>Heteroscedasticity robust</strong> and <strong>entity fixed regression</strong>.</p>\n\n<p>Lets say that I have a panel dataset with the variables Y, ENTITY, TIME, V1</p>\n\n<p>I get the same standard errors i R with this code</p>\n\n<pre><code>lm.model&lt;-lm(Y ~ V1 + factor(ENTITY), data=data)\ncoeftest(lm.model, vcov.=vcovHC(lm.model, type=\"HC1))\n</code></pre>\n\n<p>as when I in STATA perform this regression</p>\n\n<pre><code>xi: reg Y V1 i.ENTITY, robust\n</code></pre>\n\n<p>But when I am performing this regression with the PLM package I get other standard errors</p>\n\n<pre><code>plm.model&lt;-plm(Y ~ V1 , index=C(\"ENTITY\",\"YEAR\"), model=\"within\", effect=\"individual\", data=data)\ncoeftest(plm.model, vcov.=vcovHC(plm.model, type=\"HC1))\n</code></pre>\n\n<ul>\n<li>Have I missed to set some options?</li>\n<li>Does the plm model use some other kind of estimation and if so how does it do it?</li>\n<li>Can I in some way have the same standard erreros with <strong>plm</strong> as in <strong>STATA</strong> with \",robust\"</li>\n</ul>\n\n<p>Would really appreciate some help dear fRiends =)</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12793577,"title":"How to control number of minor grid lines in ggplot2?","body":"<p>By default, it seems that ggplot2 uses a minor grid that is just half of the major grid. Is there any way to to break this up?</p>\n\n<p>For example, I have a plot where the x-axis is years, and the major breaks are (1850, 1900, 1950, 2000). This means the minor grid points are at (1875, 1925, 1975), which is a little unintuitive for years. How can I make the minor grid appear at every decade?</p>\n"},{"tags":["r","alignment","bioinformatics","bioconductor","sequence-alignment"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":77,"score":2,"question_id":12326841,"title":"Looking for algorithm to do long pair wise nucleotide alignments","body":"<p>I am trying to scan for possible <code>SNPs</code> and <code>indels</code> by aligning scaffolds to subsequences from a reference genome. (the raw reads are not available). I am using <code>R/bioconductor</code> and the `pairwiseAlignment function from the Biostrings package.\nThis was working fine for smaller scaffolds, but failed when I tried to align as 56kbp scaffold with the error message: </p>\n\n<blockquote>\n  <p>Error in QualityScaledXStringSet.pairwiseAlignment(pattern = pattern, \n  :    cannot allocate memory block of size 17179869183.7 Gb</p>\n</blockquote>\n\n<p>I am not sure if this is a bug or not ? ; I was under the impression that the <code>Needleman-Wunsch algorithm</code> used by <code>pairwiseAlignment</code> is an <code>O(n*m)</code> which I thought would imply the computational demand to be on the order of <code>3.1E9</code> operations <code>(56K * 56k ~= 3.1E9)</code>. It seems the <code>Needleman-Wunsch</code> similarity matrix should as well take up on the order of 3.1 gigs of memory as well. Not sure if I'm not remembering big-o notation correctly or that is actually the memory overhead that would be needed to build the alignment given the overhead of the <code>R scripting</code> environment. </p>\n\n<p>Does anybody have suggestions for a better alignment algorithm to use for aligning longer sequences? An initial alignment was already done using BLAST to find the region of the reference genome to align. I am not entirely confident <code>BLAST</code>'s reliability for correctly placing indels and I have not yet been able to find an api as good as that provided by biostrings for parsing the raw BLAST alignments. </p>\n\n<p>By the way, here is a code snippet that replicates the problem:</p>\n\n<pre><code>library(\"Biostrings\")\nscaffold_set = read.DNAStringSet(scaffold_file_name) #scaffold_set is a DNAStringSet instance\nscafseq = scaffold_set[[scaffold_name]] #scaf_seq is a \"DNAString\" instance\n\ngenome = read.DNAStringSet(genome_file_name)[[1]] #genome is a \"DNAString\" instance\n\n#qstart, qend, substart, subend are all from intial BLAST alignment step\nscaf_sub = subseq(scafseq, start=qstart, end=qend) #56170-letter \"DNAString\" instance\ngenomic_sub = subseq(genome, start=substart, end=subend) #56168-letter \"DNAString\" instance\n\ncuralign = pairwiseAlignment(pattern = scaf_sub, subject = genomic_sub)\n#that last line gives the error: \n#Error in .Call2(\"XStringSet_align_pairwiseAlignment\", pattern, subject,  : \n#cannot allocate memory block of size 17179869182.9 Gb\n</code></pre>\n\n<p>The error does not happen with shorter alignments (hundreds of bases).\nI have not yet found the length cutoff where the error starts happening</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":7,"up_vote_count":6,"down_vote_count":0,"view_count":1468,"score":6,"question_id":3305613,"title":"using grid and ggplot2 to create join plots using R","body":"<p>I would like to know what can I do to fix a grid of plots. The plots are arranged in an array so that all the plots in a row have the same Y axis variable and all the plots in a column have the same X axis variable.</p>\n\n<p>When joined together in a grid this creates a multiplot. I disable the labels on most of the plots excepting the outer ones, since the inner ones have the same variable and scale. However, since the outer plots have labels and axis values, they result in a different size from the other ones.</p>\n\n<p>I was thinking of adding 2 more columns and rows to the grid, for the variable names and the axis range values... then plotting only the variable names on the corresponding grid space and the axis values on another grid space, therefore only plotting the points in the remaining space and getting equal sizes.</p>\n\n<p>EDIT 1:\nThanks to rcs for pointing me toward <code>align.plot</code></p>\n\n<p>Edited align.plot to accept null values (for when having title/text in the axis isnt desired)</p>\n\n<p>Now I'm closer to the goal but the first columun plots are still smaller width than the rest due to the labels.</p>\n\n<p>example code:</p>\n\n<pre><code>grid_test &lt;- function ()\n{\n    dsmall &lt;- diamonds[sample(nrow(diamonds), 100), ] \n\n    #-----/align function-----\n    align.plots &lt;- function(gl, ...){\n       # Obtained from http://groups.google.com/group/ggplot2/browse_thread/thread/1b859d6b4b441c90\n       # Adopted from http://ggextra.googlecode.com/svn/trunk/R/align.r\n\n       # BUGBUG: Does not align horizontally when one has a title.\n       #    There seems to be a spacer used when a title is present.  Include the\n       #    size of the spacer.  Not sure how to do this yet.\n\n       stats.row &lt;- vector( \"list\", gl$nrow )\n       stats.col &lt;- vector( \"list\", gl$ncol )\n\n       lstAll &lt;- list(...)\n\n       dots &lt;- lapply(lstAll, function(.g) ggplotGrob(.g[[1]]))\n       #ytitles &lt;- lapply(dots, function(.g) editGrob(getGrob(.g,\"axis.title.y.text\",grep=TRUE), vp=NULL))\n       #ylabels &lt;- lapply(dots, function(.g) editGrob(getGrob(.g,\"axis.text.y.text\",grep=TRUE), vp=NULL))\n       #xtitles &lt;- lapply(dots, function(.g) editGrob(getGrob(.g,\"axis.title.x.text\",grep=TRUE), vp=NULL))\n       #xlabels &lt;- lapply(dots, function(.g) editGrob(getGrob(.g,\"axis.text.x.text\",grep=TRUE), vp=NULL))\n       plottitles &lt;- lapply(dots, function(.g) editGrob(getGrob(.g,\"plot.title.text\",grep=TRUE), vp=NULL))\n\n       xtitles &lt;- lapply(dots, function(.g) if(!is.null(getGrob(.g,\"axis.title.x.text\",grep=TRUE)))\n                         editGrob(getGrob(.g,\"axis.title.x.text\",grep=TRUE), vp=NULL) else ggplot2:::.zeroGrob)   \n\n       xlabels &lt;- lapply(dots, function(.g) if(!is.null(getGrob(.g,\"axis.text.x.text\",grep=TRUE)))\n                         editGrob(getGrob(.g,\"axis.text.x.text\",grep=TRUE), vp=NULL) else ggplot2:::.zeroGrob)  \n\n       ytitles &lt;- lapply(dots, function(.g) if(!is.null(getGrob(.g,\"axis.title.y.text\",grep=TRUE)))\n                         editGrob(getGrob(.g,\"axis.title.y.text\",grep=TRUE), vp=NULL) else ggplot2:::.zeroGrob)   \n\n       ylabels &lt;- lapply(dots, function(.g) if(!is.null(getGrob(.g,\"axis.text.y.text\",grep=TRUE)))\n                         editGrob(getGrob(.g,\"axis.text.y.text\",grep=TRUE), vp=NULL) else ggplot2:::.zeroGrob)  \n\n       legends &lt;- lapply(dots, function(.g) if(!is.null(.g$children$legends))\n                         editGrob(.g$children$legends, vp=NULL) else ggplot2:::.zeroGrob)\n\n       widths.left &lt;- mapply(`+`, e1=lapply(ytitles, grobWidth),\n                            e2= lapply(ylabels, grobWidth), SIMPLIFY=FALSE)\n       widths.right &lt;- lapply(legends, grobWidth)\n       #  heights.top &lt;- lapply(plottitles, grobHeight)\n       heights.top &lt;- lapply( plottitles, function(x) unit(0,\"cm\") )\n       heights.bottom &lt;- mapply(`+`, e1=lapply(xtitles, grobHeight), e2= lapply(xlabels, grobHeight), SIMPLIFY=FALSE)\n\n       for ( i in seq_along( lstAll ) ) {\n          lstCur &lt;- lstAll[[i]]\n\n          # Left\n          valNew &lt;- widths.left[[ i ]]\n          valOld &lt;- stats.col[[ min(lstCur[[3]]) ]]$widths.left.max\n          if ( is.null( valOld ) ) valOld &lt;- unit( 0, \"cm\" )\n          stats.col[[ min(lstCur[[3]]) ]]$widths.left.max &lt;- max( do.call( unit.c, list(valOld, valNew) ) )\n\n          # Right\n          valNew &lt;- widths.right[[ i ]]\n          valOld &lt;- stats.col[[ max(lstCur[[3]]) ]]$widths.right.max\n          if ( is.null( valOld ) ) valOld &lt;- unit( 0, \"cm\" )\n          stats.col[[ max(lstCur[[3]]) ]]$widths.right.max &lt;- max( do.call( unit.c, list(valOld, valNew) ) )\n\n          # Top\n          valNew &lt;- heights.top[[ i ]]\n          valOld &lt;- stats.row[[ min(lstCur[[2]]) ]]$heights.top.max\n          if ( is.null( valOld ) ) valOld &lt;- unit( 0, \"cm\" )\n          stats.row[[ min(lstCur[[2]]) ]]$heights.top.max &lt;- max( do.call( unit.c, list(valOld, valNew) ) )\n\n          # Bottom\n          valNew &lt;- heights.bottom[[ i ]]\n          valOld &lt;- stats.row[[ max(lstCur[[2]]) ]]$heights.bottom.max\n          if ( is.null( valOld ) ) valOld &lt;- unit( 0, \"cm\" )\n          stats.row[[ max(lstCur[[2]]) ]]$heights.bottom.max &lt;- max( do.call( unit.c, list(valOld, valNew) ) )\n       }\n\n       for(i in seq_along(dots)){\n          lstCur &lt;- lstAll[[i]]\n          nWidthLeftMax &lt;- stats.col[[ min( lstCur[[ 3 ]] ) ]]$widths.left.max\n          nWidthRightMax &lt;- stats.col[[ max( lstCur[[ 3 ]] ) ]]$widths.right.max\n          nHeightTopMax &lt;- stats.row[[ min( lstCur[[ 2 ]] ) ]]$heights.top.max\n          nHeightBottomMax &lt;- stats.row[[ max( lstCur[[ 2 ]] ) ]]$heights.bottom.max\n          pushViewport( viewport( layout.pos.row=lstCur[[2]],\n                         layout.pos.col=lstCur[[3]], just=c(\"left\",\"top\") ) )\n          pushViewport(viewport(\n                         x=unit(0, \"npc\") + nWidthLeftMax - widths.left[[i]],\n                         y=unit(0, \"npc\") + nHeightBottomMax - heights.bottom[[i]],\n                         width=unit(1, \"npc\") - nWidthLeftMax + widths.left[[i]] -\n                                               nWidthRightMax + widths.right[[i]],\n                         height=unit(1, \"npc\") - nHeightBottomMax + heights.bottom[[i]] -\n                                               nHeightTopMax + heights.top[[i]],\n                         just=c(\"left\",\"bottom\")))\n          grid.draw(dots[[i]])\n          upViewport(2)\n       }\n\n    }\n    #-----\\align function-----\n\n    # edge margins\n    margin1 = 0.1\n    margin2 = -0.9\n    margin3 = 0.5\n\n    plot &lt;- ggplot(data = dsmall) + geom_point(mapping = aes(x = x, y = depth, colour = cut)) + opts(legend.position=\"none\")\n    plot &lt;- plot + opts(axis.text.x = theme_blank(), axis.ticks = theme_blank(), axis.title.x = theme_blank())\n    plot1 &lt;- plot + opts(plot.margin=unit.c(unit(margin1, \"lines\"), unit(margin1,\"lines\"), unit(margin2,\"lines\"), unit(margin3,\"lines\")))\n\n    plot &lt;- ggplot(data = dsmall) + geom_point(mapping = aes(x = y, y = depth, colour = cut)) + opts(legend.position=\"none\")\n    plot &lt;- plot + opts(axis.text.x = theme_blank(), axis.ticks = theme_blank(), axis.title.x = theme_blank(), axis.text.y = theme_blank(), axis.title.y = theme_blank())\n    plot2 &lt;- plot + opts(plot.margin=unit.c(unit(margin1, \"lines\"), unit(margin1,\"lines\"), unit(margin2,\"lines\"), unit(margin2,\"lines\")))\n\n    plot &lt;- ggplot(data = dsmall) + geom_point(mapping = aes(x = z, y = depth, colour = cut)) + opts(legend.position=\"none\")\n    plot &lt;- plot + opts(axis.text.x = theme_blank(), axis.ticks = theme_blank(), axis.title.x = theme_blank(), axis.text.y = theme_blank(), axis.title.y = theme_blank())\n    plot3 &lt;- plot + opts(plot.margin=unit.c(unit(margin1, \"lines\"), unit(margin1,\"lines\"), unit(margin2,\"lines\"), unit(margin2,\"lines\")))\n\n    plot &lt;- ggplot(data = dsmall) + geom_point(mapping = aes(x = x, y = price, colour = cut)) + opts(legend.position=\"none\")\n    plot &lt;- plot + opts(axis.text.x = theme_blank(), axis.ticks = theme_blank(), axis.title.x = theme_blank())\n    plot4 &lt;- plot + opts(plot.margin=unit.c(unit(margin1, \"lines\"), unit(margin1,\"lines\"), unit(margin2,\"lines\"), unit(margin3,\"lines\")))\n\n    plot &lt;- ggplot(data = dsmall) + geom_point(mapping = aes(x = y, y = price, colour = cut)) + opts(legend.position=\"none\")\n    plot &lt;- plot + opts(axis.text.x = theme_blank(), axis.ticks = theme_blank(), axis.title.x = theme_blank(), axis.text.y = theme_blank(), axis.title.y = theme_blank())\n    plot5 &lt;- plot + opts(plot.margin=unit.c(unit(margin1, \"lines\"), unit(margin1,\"lines\"), unit(margin2,\"lines\"), unit(margin2,\"lines\")))\n\n    plot &lt;- ggplot(data = dsmall) + geom_point(mapping = aes(x = z, y = price, colour = cut)) + opts(legend.position=\"none\")\n    plot &lt;- plot + opts(axis.text.x = theme_blank(), axis.ticks = theme_blank(), axis.title.x = theme_blank(), axis.text.y = theme_blank(), axis.title.y = theme_blank())\n    plot6 &lt;- plot + opts(plot.margin=unit.c(unit(margin1, \"lines\"), unit(margin1,\"lines\"), unit(margin2,\"lines\"), unit(margin2,\"lines\")))\n\n    plot &lt;- ggplot(data = dsmall) + geom_point(mapping = aes(x = x, y = carat, colour = cut)) + opts(legend.position=\"none\")\n    plot &lt;- plot + opts(axis.ticks = theme_blank())\n    plot7 &lt;- plot + opts(plot.margin=unit.c(unit(margin1, \"lines\"), unit(margin1,\"lines\"), unit(margin3,\"lines\"), unit(margin3,\"lines\")))\n\n    plot &lt;- ggplot(data = dsmall) + geom_point(mapping = aes(x = y, y = carat, colour = cut)) + opts(legend.position=\"none\")\n    plot &lt;- plot + opts(axis.ticks = theme_blank(), axis.text.y = theme_blank(), axis.title.y = theme_blank())\n    plot8 &lt;- plot + opts(plot.margin=unit.c(unit(margin1, \"lines\"), unit(margin1,\"lines\"), unit(margin3,\"lines\"), unit(margin2,\"lines\")))\n\n    plot &lt;- ggplot(data = dsmall) + geom_point(mapping = aes(x = z, y = carat, colour = cut)) + opts(legend.position=\"none\")\n    plot &lt;- plot + opts(axis.ticks = theme_blank(), axis.text.y = theme_blank(), axis.title.y = theme_blank())\n    plot9 &lt;- plot + opts(plot.margin=unit.c(unit(margin1, \"lines\"), unit(margin1,\"lines\"), unit(margin3,\"lines\"), unit(margin2,\"lines\")))\n\n    grid_layout &lt;- grid.layout( nrow=3, ncol=3, widths=c(2,2,2), heights=c(2,2,2) )\n    grid.newpage()\n    pushViewport( viewport( layout=grid_layout ) )\n    align.plots( grid_layout,\n             list( plot1, 1, 1 ),\n             list( plot2, 1, 2 ),\n             list( plot3, 1, 3 ),\n             list( plot4, 2, 1 ),\n             list( plot5, 2, 2 ),\n             list( plot6, 2, 3 ),\n             list( plot7, 3, 1 ),\n             list( plot8, 3, 2 ),\n             list( plot9, 3, 3 ) )\n}\n</code></pre>\n\n<p>original image:</p>\n\n<p><img src=\"http://i.stack.imgur.com/fDRK0.jpg\" alt=\"i27.tinypic.com/o53s5y.jpg\"></p>\n\n<p>current progress image:</p>\n\n<p><img src=\"http://i.stack.imgur.com/ZCM1G.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","parallel-processing","plyr"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12792739,"title":"Parallel option giving different results","body":"<p>This is related to my previous question <a href=\"http://stackoverflow.com/questions/12790504/mclapply-vs-for-loops-for-plotting-speed-and-scalability-focus\">mclapply vs for loops for plotting: speed and scalability focus</a>, I think I now have three/four ways of doing the same thing, but get different results even when setting the random seed.</p>\n\n<p>Firstly...why are the results different...</p>\n\n<p>Are <code>results2</code> and <code>results3</code> in effect doing the same thing?</p>\n\n<p>Although not shown in the first example (it is shown below)...there are times that results2 takes longer than when not using the <code>.parrallel = TRUE</code> option, why is that?</p>\n\n<pre><code>&gt; rm(list=ls())\n&gt; gc()\n         used (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 253264 13.6    1801024  96.2  1643320  87.8\nVcells 829208  6.4   22407472 171.0 28009341 213.7\n&gt; require(ggplot2)\nLoading required package: ggplot2\n&gt; require(plyr)\nLoading required package: plyr\n&gt; require(foreach)\nLoading required package: foreach\nforeach: simple, scalable parallel programming from Revolution Analytics\nUse Revolution R for scalability, fault tolerance and more.\nhttp://www.revolutionanalytics.com\n&gt; require(doMC)\nLoading required package: doMC   \nLoading required package: iterators\nLoading required package: multicore\n&gt; registerDoMC(cores=4)\n&gt; gc()\n          used (Mb) gc trigger  (Mb) max used  (Mb)\nNcells  409261 21.9    1440819  77.0  1643320  87.8\nVcells 1039134  8.0   17925977 136.8 28009341 213.7\n&gt; df &lt;- expand.grid(i = 1:100, j = 1:2 , k = seq(100, 500, 100))\n&gt; params &lt;- mapply(list, n = df[, 3], mu = df[, 1], stdev = df[,2], SIMPLIFY = F)\n&gt; ff &lt;- function(tlist) {\n+     set.seed(123)\n+     n &lt;- tlist$n\n+     mu &lt;- tlist$mu\n+     stdev &lt;- tlist$stdev\n+     x1 &lt;- c(1:n)\n+     y1 &lt;- rnorm(n,mu,stdev)\n+     z1 &lt;- data.frame(cbind(x1,y1))\n+     ggplot(z1, aes(x=x1,y=y1))+\n+         geom_point()+\n+         labs(title=paste(\"n=\",n,\"mu=\",mu, \"stdev=\",stdev))\n+ }\n&gt; system.time(results &lt;- llply(params, ff))\n   user  system elapsed \n  5.363   0.009   5.368 \n&gt; system.time(results2 &lt;- llply(params, ff,.parallel=TRUE))\n   user  system elapsed \n  2.689   0.259   2.938 \n&gt; system.time(results3 &lt;- mclapply(params, ff, mc.cores = 4, mc.preschedule = TRUE))\n   user  system elapsed \n  7.488   0.685   2.501 \n&gt; identical(results,results2)\n[1] FALSE\n&gt; identical(results,results3)\n[1] FALSE\n&gt; identical(results2,results3)\n[1] FALSE\n</code></pre>\n\n<p>comparisons:</p>\n\n<pre><code>require(rbenchmark)\nbenchmark(results &lt;- llply(params, ff),\n          results2 &lt;- llply(params, ff,.parallel=TRUE), \n           results3 &lt;- mclapply(params, ff, mc.cores = 4, mc.preschedule = TRUE),\n             replications=5 )\n</code></pre>\n\n<p>giving the following results:</p>\n\n<pre><code>                                                                    test replications elapsed relative user.self sys.self user.child sys.child\n 1                                          results &lt;- llply(params, ff)            5  27.869    1.521    27.833    0.043      0.000     0.000\n 2                       results2 &lt;- llply(params, ff, .parallel = TRUE)            5 109.990    6.003     5.455    2.472     37.565     7.048\n 3 results3 &lt;- mclapply(params, ff, mc.cores = 4, mc.preschedule = TRUE)            5  18.322    1.000     1.582    1.545     42.730    10.441\n</code></pre>\n\n<p>And even more weirdly when doing 10 replications instead of just 5....</p>\n\n<pre><code> benchmark(results &lt;- llply(params, ff),\n      results2 &lt;- llply(params, ff,.parallel=TRUE), \n      results3 &lt;- mclapply(params, ff, mc.cores = 4, mc.preschedule = TRUE),\n       replications=10 )\n</code></pre>\n\n<p>you get this:</p>\n\n<pre><code>                                                                     test replications elapsed relative user.self sys.self user.child sys.child\n  1                                          results &lt;- llply(params, ff)           10  55.031    1.000    54.641    0.144      0.000     0.000\n  2                       results2 &lt;- llply(params, ff, .parallel = TRUE)           10 107.801    1.959     9.877    6.045     80.022    23.062\n  3 results3 &lt;- mclapply(params, ff, mc.cores = 4, mc.preschedule = TRUE)           10 297.556    5.407     3.576    5.624     96.493    31.035\n</code></pre>\n\n<p>What is going on here?</p>\n"},{"tags":["r","fasta"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":96,"score":1,"question_id":11821149,"title":"Writing fasta files using R package seqinr?","body":"<p>When I use write.fasta in seqinr, the file that it outputs looks like this:</p>\n\n<pre><code>&gt;Sequence name 1\n\n&gt;Sequence name 2\n\n&gt;Sequence name 3\n...etc\n\nSequence 1 Sequence 2 Sequence 3 ...etc\n</code></pre>\n\n<p>In other words, the sequence names are all at the beginning of the file, and then the sequences are output together at the end of the file. </p>\n\n<p>What I'd like to do is this:</p>\n\n<pre><code>&gt;Sequence name 1\nSequence 1\n&gt;Sequence name 2\nSequence 2\n&gt;Sequence name 3\nSequence 3\n...etc\n</code></pre>\n\n<p>Is that possible with write.fasta? </p>\n"},{"tags":["sql","r","rodbc"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":45,"score":0,"question_id":12791584,"title":"Providing lookup list from R vector as SQL table for RODBC lookup","body":"<p>I have a list of IDs in an R vector. </p>\n\n<pre><code>IDlist &lt;- c(23, 232, 434, 35445)\n</code></pre>\n\n<p>I would like to write an RODBC sqlQuery with a clause stating something like</p>\n\n<pre><code>WHERE idname IN IDlist\n</code></pre>\n\n<p>Do I have to read the whole table and then merge it to the idList vector within R? Or how can I provide these values to the RODBC statement, so recover only the records I'm interested in?</p>\n\n<p><strong>Note:</strong> As the list is quite long, pasting individual values into the SQL statement, as in the answer below, won't do it.</p>\n"},{"tags":["image","r","slider","slideshow"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12792096,"title":"How to slideshow through multiple jpegs/png","body":"<p>This is follow up question to this question: <a href=\"http://stackoverflow.com/questions/12790504/mclapply-vs-for-loops-for-plotting-speed-and-scalability-focus\">mclapply vs for loops for plotting: speed and scalability focus</a></p>\n\n<p>If I have a bunch of images in the pattern \"n_mu_stdev.jpeg\", as given in Chase's solution to the above question, is there an R based method that allows some sort of slideshow with a slider according to the parameter values? From the packages that I have looked at most of the image readers tend read in the image as a data file and then re-plot it rather than just displaying a raw image, thus slowing it down dramatically...</p>\n\n<p>I am not amazingly familiar with JavaScript, CSS or jQuery so if that is the proposed solution, then would probably need a step by step guide in terms of what to install etc.</p>\n\n<p>one other solution i had considered was potentially uploading all individual images upon generation to a photo-sharing site like flickr or imgur (e.g kinda like in knitr), keeping note of the urls and then all the sliders do is choose which row of a dataframe to look at, which provides the correct url from which to get and display the image?...</p>\n"},{"tags":["r","if-statement","for-loop","else"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12792125,"title":"If statement R missing value","body":"<p>I was trying to execute this functions, but I kept on getting an error with my if statment: Error in if (value[1][i] &lt; 0) { : missing value where TRUE/FALSE needed:</p>\n\n<pre><code>Monte_Carlo &lt;- function(trial)\n{\n    S_T &lt;- S_o*exp((r - q - (1/2)*sigma^2)*period + sigma*rnorm(trial, mean = 0, sd = 1))\n    K &lt;- matrix(100, nrow = 1, ncol = 20)   \n    value &lt;- K - S_T\n\n    for(i in 1:trial)\n    {\n        if(value[1][i] &lt; 0)\n        {\n            value[1][i] = 0;\n        }\n    }\n    return (mean(value)*exp(-r))\n}\n</code></pre>\n"},{"tags":["r","knitr"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":72,"score":0,"question_id":12792047,"title":"knitr: starting a fresh R session to clear RAM","body":"<p>I sometimes work with lots of objects and it would be nice to have a fresh start because of memory issues between chunks. Consider the following example:</p>\n\n<p>warning: I have 8GB of RAM. If you don't have much, this might eat it all up.</p>\n\n<pre><code>&lt;&lt;chunk1&gt;&gt;=\na &lt;- 1:200000000\n@\n&lt;&lt;chunk2&gt;&gt;=\nb &lt;- 1:200000000\n@\n&lt;&lt;chunk3&gt;&gt;=\nc &lt;- 1:200000000\n@\n</code></pre>\n\n<p>The solution in this case is:</p>\n\n<pre><code>&lt;&lt;chunk1&gt;&gt;=\na &lt;- 1:200000000\n@\n&lt;&lt;chunk2&gt;&gt;=\nrm(a)\ngc()\nb &lt;- 1:200000000\n@\n&lt;&lt;chunk3&gt;&gt;=\nrm(b)\ngc()\nc &lt;- 1:200000000\n@\n</code></pre>\n\n<p>However, in my example (which I can post because it relies on a large dataset), even after I remove all of the objects and run <code>gc()</code>, <code>R</code> does not clear all of the memory (only some). The reason is found in <code>?gc</code>:</p>\n\n<pre><code>However, it can be useful to call ‘gc’ after a large object has\nbeen removed, as this may prompt R to return memory to the\noperating system.\n</code></pre>\n\n<p>Note the important word <code>may</code>. <code>R</code> has a lot of situations where it specifies <code>may</code> like this and so it is not a bug.</p>\n\n<p>Is there a chunk option according to which I can have <code>knitr</code> start a new <code>R</code> session?</p>\n"},{"tags":["r","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12791657,"title":"Look and feel of legend in lattice plots","body":"<p>I'm looking for 1) more vertical space between \"A\", \"B\" and \"C\", \"\\n\" is not a solution Iam lokking for. 2) I want to change the plotting order of symbols and text. That means, first I want to plot the lines of the legend and after that text.</p>\n\n<pre><code> attach(mtcars)\n gear.f&lt;-factor(gear,levels=c(3,4,5),\n labels=c(\"3gears\",\"4gears\",\"5gears\"))\n cyl.f &lt;-factor(cyl,levels=c(4,6,8),\n labels=c(\"4cyl\",\"6cyl\",\"8cyl\"))\n\n densityplot(~mpg|cyl.f,\n      main=\"Density Plot by Number of Cylinders\",\n      xlab=\"Miles per Gallon\"\n     ,par.settings = list(superpose.line = list(col=c(1,2,3)))\n     ,auto.key=list(corner = c(.98, .02),text = c(\"A\", \"B\", \"C\")\n                   ,lines=T,points=F)\n            ) \n</code></pre>\n"},{"tags":["r","time-series"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12791708,"title":"Recognizing time series in R","body":"<pre><code>data=read.table(file.choose(),sep=\",\",header=TRUE)\ndate=as.Date(data$Date,\"%Y-%m-%d\")\nplot(date,data$Close,type=\"l\",ylab=\"price of google\")\n</code></pre>\n\n<p>A couple of questions:</p>\n\n<ol>\n<li><p>If wanted to create two separate graphs and lay one on top and the other on the bottom, within the same picture graph how do you do that?</p></li>\n<li><p>What if I want to play them together on the same graph (and with different dual axis)</p></li>\n<li><p>Are there any other common methods you guys use when telling R to recognize a variable is a time series? as.Date is the only one I know so far.</p></li>\n</ol>\n\n<p>Why is it that R will recognize \"%Y-%m-%d\" if Y is capitalized in the date format?</p>\n\n<p>thank you.</p>\n"},{"tags":["r","for-loop","foreach","ggplot2","mclapply"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":105,"score":1,"question_id":12790504,"title":"mclapply vs for loops for plotting: speed and scalability focus","body":"<p>I am running a function in R that can take a long time to run as it carries out multiple commands to transform and subset some data before it pushes it into <code>ggplot</code> to plot. I need to run this function multiple times adjusting the arguments values. The example I will provide is a simple one...but was wondering how to speed it up? if scaled up, i.e. what is the fastest way of getting every single combination...is there a generic method of converting <code>for</code> loops into <code>mclapply</code> assuming they are faster...please feel free to provide alternative mock examples that demonstrate a preference for a particular method</p>\n\n<p><em>mock example:</em></p>\n\n<p>the basic function:</p>\n\n<pre><code>ff &lt;- function(n, mu, stdev){\n     x1 &lt;- c(1:n)\n     y1 &lt;- rnorm(n,mu,stdev)\n     z1 &lt;- data.frame(cbind(x1,y1))\n     ggplot(z1, aes(x=x1,y=y1))+\n       geom_point()+\n       labs(title=paste(\"n=\",n,\"mu=\",mu, \"stdev=\",stdev))\n}\n</code></pre>\n\n<p>so the nieve way of going through parameters would be to do the following...</p>\n\n<pre><code>for(i in 1:10){\n    for(j in 1:2){\n       for(k in seq(100,500,by=100)){\n         ff(k,i,j)\n       }\n    }\n}\n</code></pre>\n\n<p>what would be the fastest way of speeding this up? I'm assuming it might need something like <code>expand.grid(x=c(1:10),y=c(1:2),z=seq(100,500,by=100))</code> and the using <code>mclapply</code> to run through each row...in some sort of parallel manner? (I have 4 cores available for this). Please feel free to pull bits out of the basic function or put things into the basic function according to the methods that would create the greatest improvement in speed. The process will obviously take longer if you increase the range for each parameter, but is there nothing that can be done about that...or can that be changed somehow too if split across more cores or something...?</p>\n\n<p>and for bonus points...is there anything that will save the output images and create sliders like in the package <code>manipulate</code> to go through all the parameters in an interactive manner...in which all it is doing is pulling out the relevant image, rather than recalculating it each time.</p>\n\n<p>N.B. Please feel free to use/suggest any other packages (like <code>foreach</code>) that you think might be useful for your solution</p>\n"},{"tags":["r","vector"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12791409,"title":"Rep() function to create a matrix","body":"<blockquote>\n  <p>x=1:20</p>\n  \n  <p>[1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</p>\n  \n  <p>rep(x,2)</p>\n  \n  <p>[1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</p>\n  \n  <p>View(rep(x,2))</p>\n</blockquote>\n\n<p>Having a problem with generating a 20 by 2 vector using the rep() function in R.</p>\n\n<p>Instead of creating two columns, each running from 1 to 20, when I view the data in the R workspace, it is displayed as 40X1 vector i.e. 1-20 1-20.</p>\n\n<p>How do you use the rep() function to create a repeated column vector of 20X2? Thank you.</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":118,"score":2,"question_id":12737783,"title":"R tilde operator: What does ~0+a means?","body":"<p>I have seen how to use ~ operator in formula. For example <code>y~x</code> means: y is distributed as x.</p>\n\n<p>However I am really confused of what does <code>~0+a</code> means in this code:</p>\n\n<pre><code>require(limma)\na = factor(1:3)\nmodel.matrix(~0+a)\n</code></pre>\n\n<p>Why just <code>model.matrix(a)</code> does not work? Why the result of <code>model.matrix(~a)</code> is different from <code>model.matrix(~0+a)</code>? And finally what is the meaning of ~ operator here?</p>\n"},{"tags":["r","selection"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":50,"score":4,"question_id":12790378,"title":"How to choose non-interruped numbers only?","body":"<p>I have two vectors:</p>\n\n<pre><code>x&lt;-c(0,1,0,2,3,0,1,1,0,2)\ny&lt;-c(\"00:01:00\",\"00:02:00\",\"00:03:00\",\"00:04:00\",\"00:05:00\",\n     \"00:06:00\",\"00:07:00\",\"00:08:00\",\"00:09:00\",\"00:10:00\")\n</code></pre>\n\n<p>I need to choose only those in <code>y</code>, where values of <code>x</code> is not interrupted by 0. As a result, I'd like to get a dataframe like this</p>\n\n<pre><code>y        x\n00:04:00 2\n00:05:00 3\n00:07:00 1\n00:08:00 1\n</code></pre>\n\n<p>We built a script like this, but with a big dataset it takes time. Is there a more elegant solution? And I wonder, why <code>df&lt;-rbind(bbb,df)</code> returns inverted df?</p>\n\n<pre><code>aaa&lt;-data.frame(y,x)\ndf&lt;-NULL\nfor (i in 1:length(aaa$x)){\n  bbb&lt;-ifelse((aaa$x[i]*aaa$x[i+1])!=0, \n              aaa$x[i], \n              ifelse((aaa$x[i]*aaa$x[i-1])!=0, \n                     aaa$x[i], \n                     NA))\n  df&lt;-rbind(bbb,df)\n}\ndf&lt;-data.frame(rev(df))\naaa$x&lt;-df$rev.df.\nbbb&lt;-na.omit(aaa)\nbbb\n</code></pre>\n\n<p>I'm a newbie in R, so please, as much detail as you can :) Thank you!</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12790462,"title":"Replacing missing data in vector with existing data","body":"<p>I have a vector (I actually just retrieved individual columns from a dataframe) which has missing data in it. I want to replace the missing data with the next available data (or previous data if the next one is unavailable) in the vector. So for instance,</p>\n\n<pre><code>data &lt;- c(NA, NA, NA, NA, 5, NA, NA, 7, NA, NA)\n</code></pre>\n\n<p>should become</p>\n\n<pre><code>data &lt;- c(5, 5, 5, 5, 5, 7, 7, 7, 7, 7)\n</code></pre>\n\n<p>I know this is a very specific way to fill in missing data, but I was wondering if there is an elegant solution to this. I tried using <code>which(is.na(data))</code> to get the missing indices and <code>which(!is.na(data))</code> to get the indices with data, but manipulating the vector even with those 2 lists of indices requires a lot of messy logic. I was wondering if I was misusing <code>which</code> in any way or if there were other in-built functions or packages that would allow me to perform this logic gracefully. </p>\n\n<p>Thank you for your help!</p>\n\n<p>For reference, the code below works as long as the vector does not end with a bunch of NAs but I would have to add more logic to make it work with the original data set. </p>\n\n<pre><code>data &lt;- c(NA, NA, NA, NA, 5, NA, NA, 7)\nmissingIndeces &lt;- which(is.na(data))\nfilledIndeces &lt;- which(!is.na(data))\nif(length(missingIndeces) &gt; 1) {\n    for(j in 1:length(data)) {\n        temp &lt;- data[j:length(data)]\n        filledData &lt;- which(!is.na(temp))\n        if(filledData[1] &gt; 1)\n            data[j] &lt;- temp[filledData[1]]\n    }\n}\n</code></pre>\n"},{"tags":["python","r","bioinformatics","biopython"],"answer_count":5,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":186,"score":4,"question_id":12760271,"title":"How do I convert the three letter amino acid codes to one letter code with python or R?","body":"<p>I have a fasta file as shown below. I would like to convert the <a href=\"https://en.wikipedia.org/wiki/Amino_acid#Table_of_standard_amino_acid_abbreviations_and_properties\" rel=\"nofollow\">three letter codes</a> to one letter code. How can I do this with python or R?</p>\n\n<pre><code>&gt;2ppo\nARGHISLEULEULYS\n&gt;3oot\nMETHISARGARGMET\n</code></pre>\n\n<p>desired  output</p>\n\n<pre><code>&gt;2ppo\nRHLLK\n&gt;3oot\nMHRRM\n</code></pre>\n\n<p>your suggestions would be appreciated!!</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":62,"score":-1,"question_id":12790253,"title":"How to make the square root symbol in axes labels?","body":"<p>How can I make the square root symbol to appear ceiling an axis label in R?</p>\n"},{"tags":["r","timestamp"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":12790057,"title":"find very frequent activity times in R","body":"<p>I have a data-frame which contains date, time, userid and activity. I want to extract only those entries where this person is active (\"act\") at a --very high frequency-- (timestamp) (the ones in bold) - from 02/20/2012,03:16:59  to 02/20/2012,03:18:15. How do I do it? </p>\n\n<p>I thought of reading the records one-by-one, computing the time difference (difftime \"as.numeric\") with the previous record and then getting at the result and plotting the activity density plot. But, this approach has an assumption that my entries are in chronological order. I do not want to assume that.</p>\n\n<p>I believe there must be an elegant and efficient approache to doing this. If you can point me in the right direction, I shall begin exploring.</p>\n\n<p>Thanks!</p>\n\n<pre><code>02/01/2012,10:26:29,xyz, act\n02/01/2012,13:30:39,xyz, act\n02/01/2012,17:20:47,xyz, act\n02/01/2012,20:26:29,xyz, act\n02/02/2012,16:16:59,xyz, act\n\n**02/20/2012,03:16:59,xyz, act\n02/20/2012,03:17:11,xyz, act\n02/20/2012,03:17:20,xyz, act\n02/20/2012,03:17:29,xyz, act\n02/20/2012,03:17:40,xyz, act\n02/20/2012,03:17:49,xyz, act\n02/20/2012,03:18:01,xyz, act\n02/20/2012,03:18:15,xyz, act**\n\n02/23/2012,23:16:59,xyz, act\n02/09/2012,11:45:11,xyz, act\n02/09/2012,11:55:39,xyz, act\n02/10/2012,13:22:17,xyz, act\n02/10/2012,15:36:59,xyz, act\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":12789797,"title":"How to fix a character value returned as a numeric value in R?","body":"<p>I am a new R user and having some difficulty when trying to rename certain records in a column.</p>\n\n<p>My data have columns named classcode and fish_tl, among others. Classcode is a character value, fish_tl is numeric. </p>\n\n<p>When classcode='OCAL' and fish_tl&lt;20, I need to rename that value of classcode so that it is now \"OCALYOY\". I don't want to change any of the other records in classcode.</p>\n\n<p>I'm running the following code:</p>\n\n<pre><code>data$classcode&lt;-ifelse(data$classcode=='OCAL'&amp; data$fish_tl&lt;20,\n                              'OCALYOY',data$classcode)\n</code></pre>\n\n<p>My problem seems to be with the \"else\" aspect: the code runs fine, and returns 'OCALYOY' as expected, but the other values of classcode have now been converted to numeric (although when I look at the mode of that field, it still returns as \"character\").</p>\n\n<p>What am I doing wrong?\nThanks very much!</p>\n"},{"tags":["r","dataset","organizing"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12789392,"title":"reorganize two row into one row in r","body":"<p>I have large dataset like the following:</p>\n\n<pre><code>myd &lt;- data.frame (var1 = c(\"A\", \"A\", \"B1-1\", \"B1-1\", \"C\", \"C\", \"D1\", \"D1\"),\n                   var2 = c(1,    2,    2,       2,     3,  1,   1,    4))\n var1 var2\n1    A    1\n2    A    2\n3 B1-1    2\n4 B1-1    2\n5    C    3\n6    C    1\n7   D1    1\n8   D1    4\n</code></pre>\n\n<p>Please note that each level in var1 is repeated twice and has two values in var2.</p>\n\n<p>For each levels of var1, I want to create a new dataset where var2 values are now in row wise (shorted) and combined into one column with following type of output:</p>\n\n<pre><code>   var1    var2.h1 var2.h2      h1.h2  \n1    A      1         2           12\n2   B1-1    2         2           22\n3    C      1         3            13\n4   D1      1         4             14\n</code></pre>\n"},{"tags":["r","data.frame","plyr","rowsum"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12787547,"title":"R: use a row as a grouping vector for row sums","body":"<p>If I have a data set laid out like:</p>\n\n<pre><code>Cohort Food1 Food2 Food 3 Food 4\n--------------------------------\nGroup   1     1     2       3\n A      1     1     0       1\n B      0     0     1       0\n C      1     1     0       1\n D      0     0     0       1\n</code></pre>\n\n<p>I want to sum each row, where I can define food groups into different categories. So I would like to use the Group row as the defining vector.</p>\n\n<p>Which would mean that food1 and food2 are in group 1, food3 is in group 2, food 4 is in group 3.</p>\n\n<p>Ideal output something like:</p>\n\n<pre><code>Cohort Group1 Group2 Group3\n A      2       0      1\n B      0       1      0\n C      2       0      1\n D      0       0      1\n</code></pre>\n\n<p>I tried using this rowsum() based functions but no luck, do I need to use ddply() instead?</p>\n\n<p>Example data from comment:</p>\n\n<pre><code>dat &lt;-\nstructure(list(species = c(\"group\", \"princeps\", \"bougainvillei\", \n\"hombroni\", \"lindsayi\", \"concretus\", \"galatea\", \"ellioti\", \"carolinae\", \n\"hydrocharis\"), locust = c(1L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, \n0L), grasshopper = c(1L, 0L, 0L, 1L, 0L, 0L, 1L, 0L, 1L, 0L), \n    snake = c(2L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L), fish = c(2L, \n    1L, 0L, 1L, 1L, 0L, 1L, 0L, 1L, 0L), frog = c(2L, 0L, 0L, \n    0L, 0L, 0L, 0L, 1L, 0L, 0L), toad = c(2L, 0L, 0L, 0L, 0L, \n    1L, 0L, 0L, 0L, 0L), fruit = c(3L, 0L, 0L, 0L, 0L, 1L, 1L, \n    0L, 0L, 0L), seed = c(3L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, \n    0L)), .Names = c(\"species\", \"locust\", \"grasshopper\", \"snake\", \n\"fish\", \"frog\", \"toad\", \"fruit\", \"seed\"), class = \"data.frame\", row.names = c(NA, \n-10L))\n</code></pre>\n"},{"tags":["r","matrix","sparse"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12786391,"title":"Sparse matrix in R using library irlba","body":"<p>I have large data in my database. I have to create a matrix has size 600.000x20.000 or like that, but many of cells will be empty. How can I use this R programming language to create my matrix or by using singular value decomposition(SVD) methods? I do not know using in language R and I'll use the sparse matrix in Java programming? I am so confused...</p>\n"},{"tags":["string","r","histogram"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":12785400,"title":"Joining text to form a column name to be used in a table","body":"<p>I'm trying to use a loop to create histograms where the column name reference changes as a result of the loop by changing the string of the column name.  I want to get four histograms for <code>column1</code>, <code>column2</code>, <code>column3</code>, <code>column4</code>.  (In my actually example the columns are not named column 1, but I want it to be clear).      </p>\n\n<pre><code>For (i in 1:4){\n  hist( paste(\"dataset$column\" +i )  , main =\"title\") \n}\n</code></pre>\n\n<p>When I try using paste I get the error that <code>x</code> must be numeric, but if I try it using just one as a check like</p>\n\n<pre><code>hist( dataset$column1), main = \"title\")  \n</code></pre>\n\n<p>it works fine so its not the data itself.</p>\n"},{"tags":["r","list","selection"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":12787246,"title":"Selection from a list","body":"<p>I'm doing some analysis on financial time series and used the function <code>acf()</code> and applied it to the columns of a matrix containing returns for three assets (VBLTX, FMAGX, SBUX), like so:</p>\n\n<pre><code>ret.acf&lt;-apply(ret.mat, 2, acf, plot=FALSE)\n</code></pre>\n\n<p>Now, since acf returns correlation coefficients even for lag 0, I want to eliminate results at said lag. I did:</p>\n\n<pre><code>ret.acf$VBLTX$acf[1]&lt;-NA\nret.acf$FMAGX$acf[1]&lt;-NA\nret.acf$SBUX$acf[1]&lt;-NA\n</code></pre>\n\n<p>Is there an easier way to do this? Something along the lines of <code>ret.acf$ALL$acf[1]&lt;-NA</code></p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":12772411,"title":"ggplot2: mixing simple and grouped bars in a single bar plot","body":"<p>I have a <code>data.frame</code> :</p>\n\n<pre><code>df &lt;- structure(list(sample = structure(c(1L, 1L, 1L, 1L, 2L, 2L, 2L, \n2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L), .Label = c(\"A\", \n\"B\", \"C\"), class = \"factor\"), replicate = c(1L, 1L, 1L, 1L, 1L, \n1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L), \n    treatment = structure(c(1L, 2L, 3L, 4L, 1L, 2L, 3L, 4L, 1L, \n    2L, 3L, 4L, 1L, 2L, 3L, 4L, 1L, 2L, 3L, 4L), .Label = c(\"V0\", \n    \"V2\", \"V4\", \"V6\"), class = \"factor\"), mean = c(72.5, 66.4, \n    60.3, 56.3, 90.7, 86.9, 68.8, 64.6, 73.3, 69.8, 62.3, 68.7, \n    77.1, 73.6, 65.9, 65.3, 75.7, 73.8, 65.9, 66.8), sd = c(5.4, \n    6.1, 3.5, 4.7, 1.2, 4.9, 8.4, 6.1, 7.3, 3.5, 5.9, 2.2, 3.2, \n    3, 3.1, 4.2, 4.2, 2.4, 2.2, 2.6)), .Names = c(\"sample\", \"replicate\", \n\"treatment\", \"mean\", \"sd\"), class = \"data.frame\", row.names = c(NA, \n-20L))\n</code></pre>\n\n<p>For some samples I have replicates while for others I don't :</p>\n\n<pre><code>&gt; head(df, 15)\n   sample replicate treatment mean  sd\n1       A         1        V0 72.5 5.4\n2       A         1        V2 66.4 6.1\n3       A         1        V4 60.3 3.5\n4       A         1        V6 56.3 4.7\n5       B         1        V0 90.7 1.2\n6       B         1        V2 86.9 4.9\n7       B         1        V4 68.8 8.4\n8       B         1        V6 64.6 6.1\n9       C         1        V0 73.3 7.3\n10      C         1        V2 69.8 3.5\n11      C         1        V4 62.3 5.9\n12      C         1        V6 68.7 2.2\n13      C         2        V0 77.1 3.2\n14      C         2        V2 73.6 3.0\n15      C         2        V4 65.9 3.1\n</code></pre>\n\n<p>I would like to plot means in a faceted bar plot for each <code>sample</code> value. I would like to get grouped bars when replicates > 1. Is it possible with ggplot2 ?</p>\n\n<p>What I get so far :</p>\n\n<pre><code>g &lt;- ggplot(df, aes(x=treatment, y=mean, fill=sample)) \ng &lt;- g + geom_bar(position=\"dodge\")\ng &lt;- g + geom_errorbar(aes(ymax=mean+sd, ymin=mean-sd), position=\"dodge\")\ng &lt;- g +  facet_grid(. ~ sample)\n\ng\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/tCYUN.png\" alt=\"bar plot\"></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Following the suggestion of @Tyler Rinker, I get :</p>\n\n<pre><code>g &lt;- ggplot(df, aes(x=treatment, y=mean, fill=replicate))\ng &lt;- g + geom_bar(position=\"dodge\", stat=\"identity\")\ng &lt;- g + geom_errorbar(aes(ymax=mean+sd, ymin=mean-sd), position=\"dodge\", width=0.25)\ng &lt;- g +  facet_grid(. ~ sample)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/sQLv2.png\" alt=\"test2\"></p>\n\n<p>However, I would like to get the bars for the 'C' sample replicates displayed side-by-side.</p>\n\n<p><strong>EDIT2</strong> Very close to ...</p>\n\n<p>Simply by adding <code>group</code> = <code>replicate</code> :</p>\n\n<pre><code>g &lt;- ggplot(df, aes(x=treatment, y=mean, group=replicate, fill=replicate))\ng &lt;- g + geom_bar(position=\"dodge\", stat=\"identity\")\ng &lt;- g + geom_errorbar(aes(ymax=mean+sd, ymin=mean-sd), position=\"dodge\", width=0.25)\ng &lt;- g +  facet_grid(. ~ sample)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/J61LP.png\" alt=\"test3\"></p>\n\n<p>However there is a remaining problem with the position of the error bars. I guess I have to play with dodge ? But I don't know how ...</p>\n\n<p><strong>EDIT3</strong> Eventually... thanks to @joran</p>\n\n<pre><code>dodge &lt;- position_dodge(width = 0.9)\n</code></pre>\n\n<p>I checked that other values than 0.9 did not lead to a correct positioning of the error bars</p>\n\n<pre><code>g &lt;- ggplot(df, aes(x=treatment, y=mean, group=replicate, fill=replicate))\ng &lt;- g + geom_bar(position=\"dodge\", stat=\"identity\") \ng &lt;- g + geom_errorbar(aes(ymax=mean+sd, ymin=mean-sd), position=dodge, width=0.25, color=\"black\")\ng &lt;- g +  facet_grid(. ~ sample)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/8POmE.png\" alt=\"test4\"></p>\n"},{"tags":["r","statistics","time-series"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12788308,"title":"Deseasonalize Count Data","body":"<p>I used stl() in R to decompose count data into trend, seasonal &amp; irregular components. The resulting trend values are not integers anymore. I have the following questions:</p>\n\n<ol>\n<li>Is stl() an appropriate way to deseasonalize count data?</li>\n<li>Since the resulting trend is not interger valued anymore, can I use lm() to model the trend components?</li>\n</ol>\n"},{"tags":["r","hadoop","polygon","point-in-polygon","geofencing"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":80,"score":-3,"question_id":12780528,"title":"Detention time of a moving point in a polygon","body":"<p><strong>Im Sorry for this question, i will improve it tomorrow...</strong></p>\n\n<p>I have big log files, where Persons with their with Lat and Long coordinates with a timestamp are stored. The entries look like this :</p>\n\n<pre><code>Person - Timestamp - Lat - Long\n</code></pre>\n\n<p>The log files are very big, in sum we're talking about 3 million entries, which are spread over 10 log files.</p>\n\n<p>Furthermore, i have a XML file, where Rectangle - Polygons are defined, with the following properties:</p>\n\n<pre><code>Polygon_id - Lat_min - Lat_max - Long_min - Long_max\n</code></pre>\n\n<p>Now i want to count the detention time of each person in each polygon. Afterwards, i want to show the results of this calculation in a web-based interface.</p>\n\n<p>At the moment, i have no idea how i can do that...</p>\n\n<p>What is the best way to do that? Do you have any idea?</p>\n\n<p>Is Hadoop a good opportunity to solve this problem? Or maybe R?</p>\n\n<p>Best,</p>\n\n<p>Hans</p>\n"},{"tags":["r","type-coercion"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12788040,"title":"R avoid coercion from matrix to numeric","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/9949202/1-dimensional-matrix-is-changed-to-a-vector-in-r\">1-dimensional Matrix is changed to a vector in R</a>  </p>\n</blockquote>\n\n\n\n<p>I work with <code>matrix</code> objects in R and many times it happens that I want to select only one column of a matrix a use it as a <code>matrix</code> of one column !!! Yes, I mean I don't want R to coerce it automatically to a <code>numeric</code> class because the meaning is a matrix of 1 column in that case. How to avoid R doing this silly conversion all the time at a general level. I don't want to clutter my code with <code>as.matrix</code> everywhere !</p>\n"},{"tags":["r","data.frame"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12787551,"title":"Creating a data frame from two vectors using cbind","body":"<p>Consider the following R code.</p>\n\n<pre><code>&gt; x = cbind(c(10, 20), c(\"[]\", \"[]\"), c(\"[[1,2]]\",\"[[1,3]]\"))\n&gt; x\n     [,1] [,2] [,3]     \n[1,] \"10\" \"[]\" \"[[1,2]]\"\n[2,] \"20\" \"[]\" \"[[1,3]]\"\n</code></pre>\n\n<p>Similarly</p>\n\n<pre><code>&gt; x = rbind(c(10, \"[]\", \"[[1,2]]\"), c(20, \"[]\", \"[[1,3]]\"))\n&gt; x\n     [,1] [,2] [,3]     \n[1,] \"10\" \"[]\" \"[[1,2]]\"\n[2,] \"20\" \"[]\" \"[[1,3]]\"\n</code></pre>\n\n<p>Now, I don't want the integers <code>10</code> and <code>20</code> to be converted to strings.\nHow can I perform this operation without any such conversion? I would of\ncourse also like to know why this conversion happens. I looked at\nthe <code>cbind</code> help and also tried Googling, but had no luck finding a\nsolution. I also believe that in some cases. R converts strings to\nfactors, and I don't want that to happen either, though it doesn't seem\nto be happening here.</p>\n"},{"tags":["c++","r","package","configure"],"answer_count":2,"favorite_count":5,"up_vote_count":12,"down_vote_count":0,"view_count":830,"score":12,"question_id":5171516,"title":"where is a good tutorial on creating an R package with C++ source code?","body":"<p>I'm at a loss when I start looking at configure scripts.  I'm not sure how to go about creating an R package which has several functions built from C/C++ in such a way that it's portable between Windows &amp; Linux.  My attempts to modify the guts of existing packages have been unfruitful.</p>\n\n<p>Any help or links would be greatly appreciated.</p>\n\n<p><strong>Update:</strong>  If <em>possible</em> I would like to link against:\n<a href=\"http://www.boost.org/\" rel=\"nofollow\">Boost</a>,\n<a href=\"http://www.nvidia.com/object/cuda_home_new.html\" rel=\"nofollow\">CUDA</a>, &amp;\n<a href=\"http://www.open-mpi.org/projects/hwloc/\" rel=\"nofollow\">hwloc</a></p>\n\n<p>However, I realize that Boost will be a nightmare &amp; hwloc won't be much better. So I'd settle for just CUDA.  This was why I dove in the deep end and tried modifying some existing packages to suit my needs (rgl &amp; rglpk). But I'm willing to start out without dependencies and build from the ground up.  Thank you everyone for your suggestions!!</p>\n"},{"tags":["r","plot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":117,"score":-5,"question_id":12786334,"title":"How to plot in R like this?","body":"<p>How to plot in R like this(same as the graphs) ? Could you please post the R code in your answer?</p>\n\n<p>I am a R beginner and I find it is difficult to plot in R for me.</p>\n\n<p><img src=\"http://i.stack.imgur.com/TW2N3.png\" alt=\"\">\n<img src=\"http://i.stack.imgur.com/PSa93.png\" alt=\"\"></p>\n\n<p>Thank you !</p>\n"},{"tags":["r","date","type-conversion"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":51,"score":3,"question_id":12786722,"title":"Converting weeks of year to dates","body":"<p>I have a data set with number of weeks from the beginning of the year (<code>%W</code>), which I would like to convert to dates in order to plot it using date on x-axis</p>\n\n<pre><code>dat &lt;- structure(data.frame(week = c(22, 34, 15), year = c(2009, 2009, 2010), x = c(3.4, 5.2, 1.3)))\n</code></pre>\n\n<p>I try to convert the weeks based on <a href=\"http://stackoverflow.com/questions/6242955/converting-year-and-month-to-a-date-in-r\">earlier questions</a> here, but end up getting <code>\"YYYY-10-01\"</code> for each date.</p>\n\n<pre><code>as.Date(paste(\"01\", dat$week, dat$year, sep = \"-\"), format = \"%d-%W-%Y\")\n</code></pre>\n\n<p>Why is this and how can do it right?</p>\n"},{"tags":["r","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12784458,"title":"What does negative length vectors in a wireframe plot (lattice package) means?","body":"<p>I want to plot a wireframe in R using the lattice package. However, I get the following error message \"error using packet 1 negative length vectors are not allowed\". The data looks like the following:</p>\n\n<pre><code>&gt; result_mean\n  experiment alpha beta   packet\n1          0   1.0    1 3.000000\n2          0   1.1    1 2.571429\n</code></pre>\n\n<p>The command to create the data is the following</p>\n\n<pre><code>  png(file=paste(\"foobar.png\"),width=1280, height=1280);\n    plot &lt;- wireframe(result_mean$packet ~ result_mean$alpha * result_mean$beta,       \n      data=result_mean, scales = list(arrows=FALSE, cex= .45, col = \"black\", font = 3),\n      drape = TRUE, colorkey = TRUE, main = \"Foo\",\n      col.regions = terrain.colors(100),\n      screen = list(z = -60, x = -60),\n      xlab=\"alpha\", ylab=\"beta\", zlab=\"mean \\npackets\");\n  print(plot);\n  dev.off();\n</code></pre>\n\n<p>I'm wondering what this error message means and if there is a good way to debug this?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["r","ggplot2","boxplot"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":142,"score":1,"question_id":12784376,"title":"Multiple box plots within one group","body":"<p>I found some <a href=\"http://stackoverflow.com/questions/12427887/how-to-plot-multiple-box-plots-in-one-plot\">solutions</a> but not exactly what I want. I have 5 dataframes in R and each dataframe has 4 columns:</p>\n\n<p>Lets say name of the first dataframe is \"Gene1\"</p>\n\n<pre>Ind1     Ind2       Ind3      Ind4\n1          3         3.2        2.5\n1          3         4          2\n1.5        2         2.2        1\n3.4        2         1          3</pre>\n\n<p>and remaining dataframes are called \"Gene2\", \"Gene3\",\"Gene4\",\"Gene5\" and are similar.</p>\n\n<p>I want to plot boxplots side by side in same plot for all dataframes and for all columns. I did not find any plot like this, so I can't upload a picture but I will try to explain.</p>\n\n<p>Now from above data, the plot will have 20 box plots. First 4 box plot should be close to each other and x-axis name should be \"Gene1\" (for all 4 box plots) and then a little space in plot and again 4 box plots with x-axis name \"Gene2\" and so on.</p>\n\n<p>I can easily plot all the box plots in one plot but I am not able to distinguish dataframes. Meaning, it should clearly show us that first 4 box plots are from \"Gene1\" and next 4 box plots are from \"Gene2\" and so on.</p>\n\n<p>Please let me know if the problem is not clear.</p>\n"},{"tags":["r","list","append"],"answer_count":4,"favorite_count":2,"up_vote_count":17,"down_vote_count":0,"view_count":187,"score":17,"question_id":12772522,"title":"Does appending to a list in R result in copying?","body":"<p>Suppose I have create a list in R and append to it as follows:</p>\n\n<pre><code>x = list(10)\nx[[2]] = 20\n</code></pre>\n\n<p>Is this equivalent to </p>\n\n<pre><code>x = list(10)\nx = list(10, 20)\n</code></pre>\n\n<p>? I'm not so experienced with the particular details of how R handles lists in memory, but my limited understanding is that it tends to be copy-happy; what would be ideal for me would be that the first option doesn't involve essentially creating another list in memory, but just results in setting aside a new place in memory for the appended value. Essentially, if I have a big list, I don't want R to make another copy of it if I just want to append something to it.</p>\n\n<p>If the behaviour I want is not what is given here, is there any other way I can get the desired effect?</p>\n"},{"tags":["r","data-structures"],"answer_count":3,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":136,"score":6,"question_id":12773933,"title":"Proper data structure for a bi-directional key<->val lookup table","body":"<p>I have a set of key (character) &lt;-> hash (integer) associations in R. I'd like to store these associations in a single structure that allows me to reference a key/hash pair by key, and also by hash.</p>\n\n<p>So something like </p>\n\n<pre><code>\"hello\" &lt;-&gt; 1234\n</code></pre>\n\n<p>in variable <code>db</code>.</p>\n\n<p>And access it with (ish; doesn't have to be this exact access syntax):</p>\n\n<pre><code>db[\"hello\"] -&gt; 1234\ndb[1234] -&gt; \"hello\"\n</code></pre>\n\n<p>I tried using a data frame, and naming the rownames the keys. But then I cannot reference a row by hash integer. If I use hash integers as rownames, then I cannot reference by keyname, etc.</p>\n\n<p>My current solution is to keep two dbs as two data frames. One has the hashes as rownames, the other has the keys as rownames. This works, but it seems a bit awkward and repetitive to keep around two identical data frames (other than their rownames).</p>\n\n<p>I'd like it to be super fast in both directions :). I think this means O(log(n)) for character direction, and O(1) for integer direction, but I'm not a data-structure/algorithm expert. O(log(n)) in the integer direction is probably OK, but I think O(n) (needs to traverse the whole db solution) in either direction will weigh things down too much.</p>\n\n<p>The db is also bijective. That is, each key maps to exactly one value, and each value maps to exactly one key.</p>\n\n<p>EDIT: Thanks for the posts so far:</p>\n\n<p>Running a few tests, the match technique is definitely slower than a keyed data.table. As Martin pointed out, this is due solely to the time required for match to create the keyed table. That is, both match and a keyed data.table perform a binary search to find the value. But regardless, match is too slow for my needs when returning a single value. So I'll code up a data.table solution and post.</p>\n\n<pre><code>&gt; system.time(match(1,x))\n   user  system elapsed \n  0.742   0.054   0.792 \n&gt; system.time(match(1,x))\n   user  system elapsed \n  0.748   0.064   0.806 \n&gt; system.time(match(1e7,x))\n   user  system elapsed \n  0.747   0.067   0.808 \n&gt; system.time(x.table[1])\n   user  system elapsed \n      0       0       0 \n&gt; system.time(x.table[1e7])\n   user  system elapsed \n  0.001   0.001   0.000 \n&gt; system.time(x.table[1e7])\n   user  system elapsed \n  0.005   0.000   0.005 \n&gt; system.time(x.table[1])\n   user  system elapsed \n  0.001   0.000   0.000 \n&gt; system.time(x.table[1])\n   user  system elapsed \n  0.020   0.001   0.038 \n</code></pre>\n\n<p>EDIT2:</p>\n\n<p>I went with the fmatch solution and a named vector. I liked the simplicity of the match approach, but I'm doing repeated lookups on the db, so the performance hit of recreating the hash table on each call to match was too great.</p>\n\n<p>fmatch has the same interface as match, works on the same named vector data type, etc. It just caches/memoizes the created hash table, so that subsequent calls on the named vector only have to perform the hash lookup. All of this is abstracted from the caller, so fmatch is simply a dropin for match.</p>\n\n<p>Simple wrapper code for the bidirectional lookup:</p>\n\n<pre><code>getChunkHashes = function(chunks, db) {\n    return(db[chunks])\n}\n\ngetChunks = function(chunkHashes, db) {\n    return(names(db[fmatch(chunkHashes, db)]))\n}\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":12784098,"title":"Using system.time in R, getting very varied times","body":"<p>I have written two functions in R and I need to see which is faster so I used system.time. However, the answers are so varied I can't tell. As its for assessed work I don't feel I can actually post the code (in case someone corrects it). Both functions call rbinom to generate multiple values and this is the only part that isn't a simple calculation.</p>\n\n<p>The function time needs to be as fast as possible but both are returning times of anywhere between 0.17 and 0.33. As the mark is 0.14/(my function time) x 10 it's important I know the exact time.</p>\n\n<p>I have left gcFirst=TRUE as recommended in the R help.</p>\n\n<p>My question is why are the times so inconsistent? Is it most likely to be the functions themselves, my laptop or R?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":86,"score":5,"question_id":12698700,"title":"R: Functions -- Display of environment name instead of memory address of that environment?","body":"<p>What is the way to display the name of the environment inside the function as like built-in functions? For example, when I type the function: mean available in base package, I can see the environment as \"namespace:base\".</p>\n\n<pre><code>mean\n\n   function (x, ...) \n   UseMethod(\"mean\")\n   &lt;bytecode: 0x0547f17c&gt;\n   **&lt;environment: namespace:base&gt;**\n</code></pre>\n\n<p>However, when I attach a function to the newly created environment, here to access the values for the free variable (z) inside the function (f), it automatically resides in .GlobalEnv environment and the name of the environment is not displayed inside the function, but the memory address \"0x051abd60\" of (e1) environment is seen. </p>\n\n<pre><code>     e1 &lt;- new.env()\n     e1$z &lt;- 10\n     f &lt;- function(x) {\n           x + z \n      }\n     environment(f) = e1\n     f\n\n               function(x) {\n                    x + z \n               }\n               **&lt;environment: 0x051abd60&gt;**\n</code></pre>\n\n<p>Why do I see this behavior? Why don't I get my environment name inside the function as like built-in functions of R and also the functions available from various R packages? Is there a difference between environment data structure and .GlobalEnv environment available from search()</p>\n\n<p>Any pointers towards the motivation behind this behavior would be highly appreciated.</p>\n\n<p>Thank you</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":89,"score":-4,"question_id":12782675,"title":"Entering values into a vector in R","body":"<p>I have the precipitation values at 7 hours of every day in a year including: c(0,3,6,9,12,15,18)</p>\n\n<p>For the rest of hours of each day, I am supposed to put the value of 0. I started to write the commands below:</p>\n\n<pre><code>&gt;Tps   &lt;- rep(seq(1,365,by=1),each=7)  \n&gt;Hour &lt;- rep(c(0,3,6,9,12,15,18),365)  \n&gt;precipitation &lt;- DATA$precipitation \n</code></pre>\n\n<p>Any suggestion please?</p>\n"},{"tags":["r","abc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12692333,"title":"R: ABC error with 1 Ss","body":"<p><strong>Edit: Solved, the error dissapeared whe I updated the package.</strong></p>\n\n<p>I'm getting an error when working with just one summary statistic. Is there any reason why this is happening? Is there a way to get around this problem?\nThanks</p>\n\n<pre><code>library(abc)\ndata(human)\n\ntarget&lt;-(stat.voight[\"hausa\",])[,1]\nsumstat&lt;-(stat.3pops.sim)[,1]\nmodsel.ha &lt;- postpr(target, models, sumstat, tol=.05, method=\"mnlogistic\")\n\n#Error in eval(predvars, data, env) : numeric 'envir' arg not of length one\n</code></pre>\n\n<p>Aditional details: no other objects were loaded (to my knowledge) as the R session had just been started. When I use two summary statistics instead of just 1 postpr works fine.\nSession details as per request from nograpes</p>\n\n<pre><code>    sessionInfo()\n    R version 2.15.1 (2012-06-22)\n    Platform: i686-pc-linux-gnu (32-bit)\n\n    locale:\n     [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8       \n     [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=de_DE.UTF-8   \n     [7] LC_PAPER=C                 LC_NAME=C                  LC_ADDRESS=C              \n    [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\n    attached base packages:\n    [1] stats     graphics  grDevices utils     datasets  methods   base     \n\n    other attached packages:\n    [1] abc_1.5       locfit_1.5-7  quantreg_4.79 SparseM_0.96  nnet_7.3-4    MASS_7.3-          21  \n\n    loaded via a namespace (and not attached):\n    [1] grid_2.15.1     lattice_0.20-10 tools_2.15.1 \n</code></pre>\n"},{"tags":["c++","r","static-libraries"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12781518,"title":"Linking static library into R","body":"<p>I have a static library which I am trying to use inside my R package. This is only for internal use.</p>\n\n<p>The libq.a for now is just within ./src folder. I was trying to add the following to src/Makevars:</p>\n\n<pre><code>PKG_LIBS=\"-l/path/to/lib/libq.a\"\n</code></pre>\n\n<p>Where /path/to/lib is an absolute path to the libq.a location (for testing purposes only). But that doesn't seem to help. Do I have to do anything else in order to load that static library?</p>\n"},{"tags":["r","lasso"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12774167,"title":"Non negative lasso implementation in R","body":"<p>I am looking for some open source or an existing library I can use. As far as I tell the glmnet package isn't very easily extensible to cover the non negative case. I may be wrong, Any one with any ideas much appreciated.</p>\n"},{"tags":["r","stata"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":82,"score":4,"question_id":12783066,"title":"Is there a fast way to search for variables in R?","body":"<p>In Stata the \"lookfor\" command offers a quick way to search for variables in a dataset (and it searches both the variable names and labels). So \"lookfor education\" quickly finds you variables related to education. Is there an equivalent shortcut function in R?</p>\n"},{"tags":["r","data.table"],"answer_count":2,"favorite_count":3,"up_vote_count":15,"down_vote_count":0,"view_count":434,"score":15,"question_id":7033106,"title":"Why has data.table defined := rather than overloading <-?","body":"<p>data.table has introduced the := operator. Why not overload &lt;-?</p>\n"},{"tags":["r","find","match","unique-values"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12782308,"title":"finding values without a loop in R","body":"<p>I have one vector v, created with c(), that has this data:</p>\n\n<pre><code> v[a,b,d,z,e,f], it must be unordered\n</code></pre>\n\n<p>And I have a txt file with the form:</p>\n\n<pre><code>     label      1            2          3       ....\n      b        100        2000          15\n      z        123          14          12\n      a         55         565          55\n     .....\n</code></pre>\n\n<p>I have extracted the txt file, that is delimited with tabs with strplit</p>\n\n<pre><code>      ext_data&lt;-strsplit(file,\"\\t\") \n</code></pre>\n\n<p>What I want to do is to see if the elements of vector V matches one of the elements of label, it can be there like not, and after that extract the corresponding elements of the column 1 of the txt file, then the elements of column 2 and so on</p>\n\n<p>I have made the matching using for loop, but is taking too much time, because the txt file contains too much data, like this (algorithmically)</p>\n\n<pre><code>      for i=1 to length(v)\n             for pos=2 to ext_data      #I put pos=2 because I start in the second row\n                  if match(vector) and ext_data(pos,1)  \n                       retrieve data from column C     \n</code></pre>\n\n<p>Any suggestion?</p>\n\n<p>In rough way what I want is to know if there could be a way to use the match, but with columns, maybe transforming the column label in a row?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":12780453,"title":"searching rows in R until it matches a given value then","body":"<p>I ´m getting the first steps in R and perhaps someone could help me. I have a table with n columns and n rows, and what I want to write a script to search each rows for a value, if don´t matches the value than it should proceed to the next row until if matchs the value. Once it matches the value it should go back to the previous row and the concatenate this row with the first column of the table. Can anyone give me any idea on how to make this on R?</p>\n"},{"tags":["r","cluster-analysis","k-means","hierarchical-clustering"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":12779578,"title":"K-centers clustering using R","body":"<p>I can't find a simple library function for k-centers clustering using R, whereas I could for k-means (<code>kmeans()</code>) and hierarchical clustering (<code>hclust()</code>).</p>\n\n<p>Is there a library function for simple greedy k-centers clustering using R as depicted in <a href=\"http://proteneer.com/blog/?p=207\" rel=\"nofollow\">this  post</a></p>\n\n<p>If not - as I am new to R - how would one go about implementing it (I understand the logic - just not how to actually write it in R code).</p>\n"},{"tags":["r","3d","matrix","plot","rgl"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":6488,"score":3,"question_id":3979240,"title":"R: Plotting a 3D surface from x, y, z","body":"<p>imagine I have a 3 columns matrix<br>\nx, y, z\nwhere z is a function of x and y.</p>\n\n<p>I know how to plot a \"scatter plot\" of these points with\n<code>plot3d(x,y,z)</code></p>\n\n<p>But if I want a surface instead I must use other commands such as  surface3d \nThe problem is that it doesn't accept the same inputs as plot3d\nit seems to need a matrix with </p>\n\n<pre><code>(nº elements of z) = (n of elements of x) * (n of elements of x)\n</code></pre>\n\n<p>How can I get this matrix?\nI've tried with the command interp, as I do when I need to use contour plots.</p>\n\n<p>How can I plot a surface directly from x,y,z without calculating this matrix?\nIf I had too many points this matrix would be too big.</p>\n\n<p>cheers</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":7,"view_count":65,"score":-6,"question_id":12764414,"title":"Searching for Documentation In R","body":"<p>I would like to create a vector that is spaced by .5 from 1 to 10. So 1 1.5 2 2.5 .... 9.5 10. How do I that in R?</p>\n\n<p>Now what if I want to create a vector from 1 to 10 , equally spaced, that has a length of 20 how do I do that?</p>\n\n<p>Lastly, is there an easier way to search documentation in R, such as typing \"equally spaced\" or \"vector of fixed length\" to find out what codes are availiable? So far CRAN's documentation is for those who know the function first and can easily search it. The search engine doesn't allow searching words in the documentation that might lead to the relevant function.</p>\n"},{"tags":["r","plot","legend"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12777976,"title":"Change the size of the text in legend according to the length of the legend vector in the graph","body":"<p>I have to draw a 20 plots and horizontally place a legends in each plots.</p>\n\n<p>I gave the following command for the first plot:</p>\n\n<pre><code>plot(x=1:4,y=1:4)\nlegend(\"bottom\",legend = c(\"a\",\"b\",\"c\",\"d\"),horiz=TRUE,text.font=2,cex=0.64)\n</code></pre>\n\n<p>then for the second plot I tried : </p>\n\n<pre><code>plot(x=1:2,y=1:2)\nlegend(\"bottom\",legend = c(\"a\",\"b\"),horiz=TRUE,text.font=2,cex=0.64)\n</code></pre>\n\n<p>But because the size of the character vector passed to legend argument are different I get the size of the legend different.</p>\n\n<p>Since I have to plot so many different plots having varying sizes of legends,I would want to do it in an automated fashion.</p>\n\n<p>Is there a way to do this which can fix the size of the legend in all the plots and fit it to graph size?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":71,"score":-1,"question_id":12542720,"title":"Apache log file format analysis by R","body":"<p>I was trying to do the analysis of weblog files by R. I am comfortable to deal with the date and bytes, wherever numeric data is present but fail to deal with the strings. </p>\n\n<p>From the log file (log file in CSV format), I want to find out the particular user (with help of IP and Agents) and its total spending on the web page. </p>\n"},{"tags":["r","spline"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12778014,"title":"Only plotting the fitted spline line and not the data points","body":"<p>I have checked my references, it seems to me that to fit a dataset with x and y, many tutorial need to first plot the x and y,  then the fitted line is plot. The normal procedure is like below:</p>\n\n<pre><code>## Calculate the fitted line\nsmoothingSpline = smooth.spline(tree_number[2:100], jaccard[1:99], spar=0.35) \nplot(tree_number[2:100],jaccard[1:99]) #plot the data points\nlines(smoothingSpline) # add the fitted spline line.\n</code></pre>\n\n<p>However, I do not want to plot the tree_number and jaccard, but rather, I only want to plot the fitted spline line in the plot, how should I do? </p>\n"},{"tags":["r","ms-word","ggplot2"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":196,"score":1,"question_id":12747916,"title":"R eps export and import into Word 2010","body":"<p>I'm having trouble with exporting eps files from R and importing into Word 2010.</p>\n\n<p>I'm using <code>ggplot2</code> plots, eg</p>\n\n<pre><code>library(ggplot2)\np &lt;- qplot(disp,hp,data=mtcars) + stat_smooth()\np\n</code></pre>\n\n<p>Even after calling <code>setEPS()</code> neither of the following produce files which can be successfully imported.</p>\n\n<pre><code>ggsave(\"plot.eps\")\n\npostscript(\"plot.eps\")\nprint(p)\ndev.off()\n</code></pre>\n\n<p>The strange thing is that if I produce the plot using <code>File</code> -> <code>Save As</code> -> <code>Postscript</code> from the menu in the GUI, it can be imported correctly. However, when the Word document is subsequently exported as a pdf, the fonts in the graphic are a little jagged.</p>\n\n<p>So my questions are:</p>\n\n<ul>\n<li>What combination of (<code>ggsave</code>/<code>postscript</code>) settings allows me to produce eps files that can be imported into Word 2010?</li>\n<li>How can I ensure the fonts remain clear when the Word document is exported as a pdf?</li>\n</ul>\n\n<p><strong>Update</strong></p>\n\n<p>After more investigation I have had more luck with <code>cairo_ps</code> to produce the plots. However, no text shows up when imported into Word.</p>\n\n<p>Furthermore, after checking the various eps outputs (<code>cairo_ps</code>, save from the GUI, <code>ggsave</code>) in a latex document, it seems like the eps import filter in Word quite poor as the printed/pdf output doesn't match the quality of the latex'd document. The <code>ggsave</code> version (which uses <code>postscript</code>) did have some issues with colours that the other two methods didn't have though.</p>\n\n<p>The conclusion is that this is a Word issue and therefore <code>fortune(109)</code> does not apply. I'd be happy to be proven otherwise, but I'll award the answer and the bounty to whoever can provide the commands that can replicate the output from the GUI in command form.</p>\n"},{"tags":["r"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":196,"score":-1,"question_id":10367120,"title":"R filtering out a subset","body":"<p>I have a data.frame A\nand a data.frame B which contains a subset of A</p>\n\n<p>How can I create a data.frame C which is data.frame A with data.frame B excluded?\nThanks for your help.</p>\n"},{"tags":["r","kernlab"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12774845,"title":"R ksvm kernlab unused arguments","body":"<p>I'm learning how to use ksvm from kernlab to do classification. I've played with some examples (i.e. iris etc). However, when I try with my data, I keep getting an error:</p>\n\n<p>Error in rbfdot(length = 4, lambda = 0.5) : \n  unused argument(s) (length = 4, lambda = 0.5)</p>\n\n<p>I really appreciate if someone can point out what went wrong, or point me to the appropriate documents.</p>\n\n<p>Attached is my data file.</p>\n\n<p>DataFile: <a href=\"http://www.mediafire.com/view/?todfg2su1qmw18n\" rel=\"nofollow\">http://www.mediafire.com/view/?todfg2su1qmw18n</a></p>\n\n<p>My R code:</p>\n\n<pre><code>id = \"100397.txt\"\ndat &lt;- read.table(id, header=FALSE,sep = \",\")\nn = nrow(dat) # number of data points\nnumCol = ncol(dat)\ndat &lt;- dat[,-c(numCol)] ### get rid of the last column because it is not useful.\nnumCol = ncol(dat) ### update the number of columns\n\nntrain &lt;- round(n*0.8) # get 80% of data points for cross-validation training\n\ntindex &lt;- sample(n,ntrain) # get all indices for cross-valication trainining\n\nxtrain &lt;- dat[tindex,-c(numCol)] # training data, not include the class label\n\nxtest  &lt;- dat[-tindex,-c(numCol)] # test data, not include the class label\n\nytrain &lt;- dat[tindex,c(numCol)] # class label for training data\n\nytest  &lt;- dat[-tindex,c(numCol)] # class label for testing data\n\nnrow(xtrain)\n\nlength(ytrain)\n\nnrow(xtest)\n\nlength(ytest)\n\n### SVM function ###\nsvp &lt;- ksvm(xtrain, ytrain, type=\"C-bsvc\", kernel='rbf', C = 10, prob.model=TRUE)\n</code></pre>\n"},{"tags":["r","data","plot"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":120,"score":1,"question_id":12766253,"title":"qqline connects the first and third quartiles. How do I draw a line between different quantiles (ie 30% and 70%)?","body":"<p>I have a qqnorm plot of a data set with 1000+ points. I want to draw a line between two quantiles at a time (say 30% and 70%) just as qqline does with 25% and 75%, but with the freedom of choosing which quantiles to use. I've poked around with ggplot a bit but can't seem to get something that works. What's the best way to do this?</p>\n\n<p>Thanks!</p>\n\n<p>edit: \nMy data are the changes in the dollar to pound exchange rate in the Garch data set of Ecdat: </p>\n\n<pre><code>diffbp = diff(Garch[,5])\n</code></pre>\n\n<p>After that, all I'm doing is </p>\n\n<pre><code>qqnorm(diffbp)\n\nqqline(diffbp)\n</code></pre>\n\n<p>but I also need plots where qqline can go through different quantiles, for comparison.</p>\n\n<p>thanks again for all your help!</p>\n\n<p>edit 2: \nI've tried the following:</p>\n\n<pre><code>&gt; qqnorm(diffbp)\n\n&gt; quantile(diffbp,probs=c(0.01,0.99))\n       1%       99% \n-0.029850  0.032675 \n\n&gt; qqline(c(-0.029850,0.032675))\n</code></pre>\n\n<p>I don't think the resulting lines are exactly what I'm going for. Namely, I believe that the line always goes through -1 and 1 on the x axis, when I want it to go through the appropriate quantiles.</p>\n\n<p>edit 3: Figured it out! Computed the sample and theoretical quantiles by hand, computed the equation of the line through them, and then drew the line using abline(). Rather time-consuming way of going about it, though. </p>\n"},{"tags":["r","character","string-concatenation"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":1,"view_count":129,"score":4,"question_id":12775085,"title":"The difference between concatenating character strings with paste() vs. cat()?","body":"<p>What are the differences between concatenating strings with cat() and paste()? cat() shows some unexpected behavior as mentioned below:\n1) Why R does not use double quote (\" \") when it prints the results of calling cat():\nex:</p>\n\n<pre><code>cat(\"test\")\n## R prints: test\n</code></pre>\n\n<p>2) Why the functions length() and mode() which are functions available for almost all objects in R, do not work on cat()?</p>\n\n<pre><code>length(cat(\"test\"))\n## results: test[1] 0\nmode(cat(\"test\"))\n## test[1] \"NULL\"\n</code></pre>\n\n<p>3) Why do c-style escape sequences work with cat() but not with paste()?</p>\n\n<pre><code>cat(\"1)Line1\\n 2)Line2\\n 3)Line3\")\npaste(\"1)Line1\\n 2)Line2\\n 3)Line3\")\n</code></pre>\n\n<p>4) Why doesn't R's recycling rule work with cat()?</p>\n\n<pre><code>cat(\"Grade\",c(2,3,4,5))\n## results: Grade 2 3 4 5\npaste(\"Grade\",c(2,3,4,5))\n## \"Grade 2\" \"Grade 3\" \"Grade 4\" \"Grade 5\"\n</code></pre>\n\n<p>Thank you very much for your help.</p>\n"},{"tags":["r","statistics","statistical-analysis"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12774318,"title":"Matrix turns into something else when I run it through impute.knn.","body":"<p>I'm new to R, but I have a microarray dataset. I have an NA value at one location, and I try to use impute.knn() from library(impute), but after running the matrix through the impute.knn() function, it seems to turn into another structure. Can anyone explain what's going on?</p>\n\n<pre><code>&gt; m &lt;- as.matrix(m)\n\n# checking structure\n&gt; str(m)\n  num [1:22283, 1:20] 1942.1 40.1 72.1 4693.6 35.9 ...\n  - attr(*, \"dimnames\")=List of 2\n  ..$ : chr [1:22283] \"1007_s_at\" \"1053_at\" \"117_at\" \"121_at\" ...\n  ..$ : chr [1:20] \"GSM146778-Normal\" \"GSM146780-Normal\" \"GSM146782-Normal\"\n\n# checking missing value of cell\n&gt; m[x,y] \n[1] NA\n\n# impute missing value\n&gt; m.i &lt;- impute.knn(m, 6)\n\n# check value of imputed value\n&gt; m.i[x,y]\nError in r.imp[\"206054_at\", \"GSM146784-Normal\"] : incorrect number of dimensions\n\n# check structure of imputed matrix\n&gt; str(m.i)\nList of 3\n$ data     : num [1:22283, 1:20] 1942.1 40.1 72.1 4693.6 35.9 ...\n..- attr(*, \"dimnames\")=List of 2\n.. ..$ : chr [1:22283] \"1007_s_at\" \"1053_at\" \"117_at\" \"121_at\" ...\n.. ..$ : chr [1:20] \"GSM146778-Normal\" \"GSM146780-Normal\" \"GSM146782-Normal\" \"GSM146784-Normal\" ...\n$ rng.seed : num 3.62e+08\n$ rng.state: int [1:626] 403 50 1992223309 -108730617 1600482030 698744776 \n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":100,"score":-3,"question_id":12759591,"title":"Simple introduction to linear models in R -","body":"<p>It was hard for me to understand linear models in R. There are a lot of documents for the case, but many of them are technical manuals rather than teaching the concept.</p>\n\n<p>I found <a href=\"http://users.monash.edu.au/~murray/stats/BIO4200/LinearModels.pdf\" rel=\"nofollow\">this article</a> really simple and instructive, I hope it would be useful for the other people who have the same problem. </p>\n\n<p>Do you have any better suggestion?</p>\n"},{"tags":["r","loops"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":118,"score":0,"question_id":12767209,"title":"looping through each element in a list and add number to each item. using R","body":"<p>I read in a file and R returns a list, like this:<br>\nlist 1:\n\"1)\"      \"Seo  \"   \"agad \"   \"na \"     \"ciad \"   \"faclan \" \"a \"<br>\nlist 2:  \"cannteil \" \"(canntail) \"     \"a-staigh \"       \"dhan \"       \"<br>\nlist 3: \"2)\"       \"Seo \"     \"sinn, \"   \"sin \"     \"direach \" \"fuirich…\"  </p>\n\n<p>What I want is to get a vector where, if the 1st element in [[i]] has a number, then the other elements in [[i]] also get the same number and if the 1st element in [[i]] doesn't have a number, then all elements in [[i]] will have the number shown in the previous line, like this:  </p>\n\n<p>\"1\\t1)\"       \"1\\tSeo  \"    \"1\\tagad \"    \"1\\tna \"  \"1\\tciad \"    \"1\\tfaclan \"  \"1\\ta \"       ....\n\"2\\t2)\" \"2\\tseo\", 2\\tsinn....</p>\n\n<p>Could anyone tell me the code for this? And, is there a way to get a vector containing only the number corresponding each word without pasting it before each word?</p>\n\n<p>Thank you</p>\n\n<p>My code was the following, but it didn't give me what I want (all the elements get the number 1, even those in the list starting with number 2.)\nWhat part of the code is wrong?</p>\n\n<pre><code>word=\"\" \ntemp=\"\" \nfor (i in 1:length(file)) { \n       if (grepl('\\\\d+\\)',file[[i]][1])) {       \n       snum=grep('\\\\d+',file[[i]][1]) \n       temp=paste(snum, file[[i]], sep=\"\\t\") \n         } else { \n       temp=paste(snum,utter.short[[i]],sep=\"\\t\") \n         }   word=c(word,temp) \n     }\n</code></pre>\n"},{"tags":["r","gis","raster"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12676188,"title":"Extract pixel value for corresponding point location in R","body":"<p>I have animal gps data with several locations for each day and regular gaps of several days when no location of the animal was recorded. Additionally, I have satellite data in intervals of 16 days. I would now like to <strong>extract the pixel value</strong> that corresponds to the <strong>specific point</strong> and to the <strong>specific time</strong>. </p>\n\n<p>This means if the location of the animals was recorded e.g. 2 days before a satellite image was taken, I want to extract the pixel value of this image (that comes after) rather than from the images that was taken 14 days before the animal location was recorded. I always want to extract from the image that lies closer according to the time. </p>\n\n<p>I created some test data that hopefully illustrates the problem:</p>\n\n<pre><code>library(sp)\nlibrary(raster)\n\n### Create test data\n# create first raster\nedc2012001_m &lt;- raster(ncol=36, nrow=18)\nedc2012001_m[] &lt;- sample(1:ncell(edc2012001_m))\n\n# create second raster\nedc2012017_m &lt;- raster(ncol=36, nrow=18)\nedc2012017_m[] &lt;- sample(1:ncell(edc2012017_m))\n\nrasters&lt;-stack(edc2012001_m,edc2012017_m)\n\n# Create xy coordinates\ntime&lt;-c(\"2012-01-01\", \"2012-01-01\", \"2012-01-01\", \"2012-01-02\", \"2012-01-02\", \"2012-01-02\", \"2012-01-12\", \"2012-01-12\", \"2012-01-13\", \"2012-01-13\")\nx &lt;- rep(-50,10)\ny &lt;- sample(c(-80:80), 10)\ndata&lt;-data.frame(x,y,time)\n\n# Convert data to spatial points data frame\ncoordinates(data) &lt;- c(\"x\",\"y\")\n\n### Extract all data from raster stack\nextract(rasters, data)\n</code></pre>\n\n<p>The number string in the name of the first raster indicates that the image was taken on the first day in 2012, the second image was taken on the 17th day of this year.</p>\n\n<p>The 7th location in the test data for example shall now be extracted from the second raster file as it lies closer according to the time.</p>\n\n<p>All in all I have 87 raster files and 600 observations. I am really not sure how to program this. I guess I could use <code>substr()</code> to retrieve the date info from the raster names. But besides that...\nI am thankful for every hint I can get, also about functions that might be helpful in this context.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":126,"score":0,"question_id":12771745,"title":"Error: In storage.mode(x) <- \"double\" : NAs introduced by coercion","body":"<p>I'm new to R, but I'm trying to estimate a missing value in a large microarray dataset using <code>impute.knn()</code> from library(impute) using 6 nearest neighbors. </p>\n\n<p>Here's an example: </p>\n\n<pre><code>seq1 &lt;- seq(1:12)\nmat1 &lt;- matrix(seq1, 3)\nmat1[2,2] &lt;- \"NA\"\nimpute.knn(mat1, k=6)\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>Error in knnimp.internal(x, k, imiss, irmiss, p, n, maxp = maxp) : \nNA/NaN/Inf in foreign function call (arg 1)\nIn addition: Warning message:\nIn storage.mode(x) &lt;- \"double\" : NAs introduced by coercion\n</code></pre>\n\n<p>I've also tried the following:</p>\n\n<pre><code>impute.knn(mat1[2,2], k=6)\n</code></pre>\n\n<p>and I get the following error:</p>\n\n<pre><code>Error in rep(1, p) : invalid 'times' argument\n</code></pre>\n\n<p>My google-fu has been off today. Any suggestions to why I might be getting this error?</p>\n\n<p>edit: I've tried </p>\n\n<pre><code>mat1[2,2] &lt;- NA \n</code></pre>\n\n<p>as James suggested, but I get a segmentation fault. Using </p>\n\n<pre><code>replace(mat1, mat1[2,2], NA) \n</code></pre>\n\n<p>does not help either. Any other suggestions?</p>\n"},{"tags":["r","metadata","read.table"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":111,"score":5,"question_id":12771711,"title":"read.table and comments in R","body":"<p>I'd like to add metadata to my spreadsheet as comments, and have R ignore these afterwards.  </p>\n\n<p>My data are of the form</p>\n\n<pre><code>v1,v2,v3,\n1,5,7,\n4,2,1,#possible error,\n</code></pre>\n\n<p>(which the exception that it is much longer.  the first comment actually appears well outside of the top 5 rows, used by <code>scan</code> to determine the number of columns)</p>\n\n<p>I've been trying:</p>\n\n<pre><code>read.table(\"data.name\",header=TRUE,sep=\",\",stringsAsFactors=FALSE,comment.char=\"#\")\n</code></pre>\n\n<p>But <code>read.table</code> (and, for that matter, <code>count.fields</code>) thinks that I have one more field than I actually do.  My data frame ends up with a blank column called 'X'.  I think this is because my spreadsheet program adds commas to the end of every line (as in the above example).</p>\n\n<p>Using <code>flush=TRUE</code> has no effect, even though (according to the help file) it \" [...] allows putting comments after the last field [...]\"</p>\n\n<p>Using <code>colClasses=c(rep(NA,3),NULL)</code> has no effect either.</p>\n\n<p>I could just delete the column afterwards, but since it seems that this is a common practice I'd like to learn how to do it properly. </p>\n\n<p>Thanks,</p>\n\n<p>Andrew</p>\n"}]}
{"total":19203,"page":19,"pagesize":100,"questions":[{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":12771988,"title":"R: qqline connects the first and third quartiles. How do I draw a line between different quantiles (ie 30% and 70%)?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12766253/qqline-connects-the-first-and-third-quartiles-how-do-i-draw-a-line-between-diff\">qqline connects the first and third quartiles. How do I draw a line between different quantiles (ie 30% and 70%)?</a>  </p>\n</blockquote>\n\n\n\n<p>I have a qqnorm plot of a data set with 1000+ points. I want to draw a line between two quantiles at a time (say 30% and 70%) just as qqline does with 25% and 75%, but with the freedom of choosing which quantiles to use. I've poked around with ggplot a bit but can't seem to get something that works. What's the best way to do this?</p>\n\n<p>I've found a function that seems to do what I want, called plot.qqline in the package sma. Unfortunately, this is a really old package and is now deprecated. However, that's the type of functionality I'm looking for.</p>\n\n<p>edit: Figured it out!</p>\n"},{"tags":["r","statistics"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12771795,"title":"Pareto package in R","body":"<p>How I get the qpareto function in R? When I type <code>qpareto(.05/2, 2, 15)</code>, R doesn't recognize what the <code>qpareto</code> function is. I tried typing <code>library(VGAM)</code> and that didn't pop anything up either. Neither did <code>library(rmutils)</code></p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12771522,"title":"cannt read file with \"#\" and space using read.table or read.csv in R","body":"<p>I have file which first row is a header. Header can have spaces and even # symbol ( or may be other special characters, I am not sure about). I am trying to read this file using read.csv or read.table but it keeps throwing me errors:</p>\n\n<pre><code>undefined columns selected \n\n\nmore columns than column names \n</code></pre>\n\n<p>My tab delimited chromFile file is like:</p>\n\n<pre><code>Chromosome# Chr chr Size    UCSC NCBI36/hg18    NCBIBuild36 NCBIBuild37\n1   Chr1    chr1    247199719   247249719   247249719   249250621\n2   Chr2    chr2    242751149   242951149   242951149   243199373\n</code></pre>\n\n<p>Command:</p>\n\n<pre><code>chromosomes &lt;- read.csv(chromFile, sep=\"\\t\",skip =0, header = TRUE,  )\n</code></pre>\n\n<p>I want to first look for a way to read the file as it as other than replacing the space or # with some other readable symbol.</p>\n"},{"tags":["r"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":403,"score":2,"question_id":4858511,"title":"Recoding Numeric Vector R","body":"<p>I have a numeric vector, let's say something like:</p>\n\n<pre><code>x &lt;- rep(1:6, 300)\n</code></pre>\n\n<p>What I would like to do is recode the vector, in place such that 6=1,5=2,4=3,3=4,2=5,1=6. I don't want to create a factor out of it. </p>\n\n<p>Everything I have tried so far gives me the wrong counts because of the order, ie: </p>\n\n<pre><code>x[x == 6] &lt;- 1 \nx[x == 5] &lt;- 2 ## Lines that follow where x[x == 2] removes 5's entirely from counts. \n</code></pre>\n\n<p>Note: I'm aware of the car package, but would prefer to use base R for this problem.</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":3,"up_vote_count":21,"down_vote_count":1,"view_count":1044,"score":20,"question_id":4996090,"title":"How to disable \"Save workspace image?\" prompt in R?","body":"<p>When I exit the interactive R shell, it shows an annoying prompt every time:</p>\n\n<pre>\n>\n>\nSave workspace image? [y/n/c]: n\n</pre>\n\n<p>I'm always answering \"no\" to it, because if I wished to save my work, I'd do that <em>before</em> trying to exit.</p>\n\n<p>How to get rid of the prompt?</p>\n"},{"tags":["r","loops"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":41,"score":-1,"question_id":12768013,"title":"Loop in R with cumsum for polygon function","body":"<p>I am working on a loop in R:</p>\n\n<p><code>dypol</code> and <code>wnc</code> are 1-by-3 matrices and <code>x</code> is a 1-by-100 matrix.\nI want the loop to return a 3-by-100 matrix (cumulative for each column). I have this:</p>\n\n<pre><code>For (i in 1:100) {\ni=dypol*t(x^2)-dypol+wnc\n{yi = cumsum(i) }\n}\n</code></pre>\n\n<p>but it returns only the first row.</p>\n"},{"tags":["r","list","matrix"],"answer_count":1,"favorite_count":2,"up_vote_count":11,"down_vote_count":0,"view_count":152,"score":11,"question_id":12768114,"title":"R flatten out list hierarchy to matrix or data.frame","body":"<p>I would like to flatten out a list hierarchy (similar to JSON) to a matrix or data frame. Let's say that I create the following list:</p>\n\n<pre><code>a &lt;- list(\n  b1 = list(\n     c1 = list(\n       d1 = data.frame()\n     ),\n     c2 = data.frame()\n  ),\n  b2 = data.frame()\n)\n</code></pre>\n\n<p>Where each letter is another level or step down the hierarchy. Then I want a function, e.g. <code>listToMatrix(mylist = a, steps = 2)</code>, that generates the following:</p>\n\n<pre><code>    [,1] [,2]\n[1,] \"b1\" \"c1\"\n[2,] \"b1\" \"c2\"\n[3,] \"b2\" \"b2\"\n</code></pre>\n\n<p>Observe that the function's argument <code>steps = 2</code> imply that it should only go 2 steps down the hierarchy. Also, if there aren't enough levels available in one direction, see <code>b2</code>, then it should keep the previous list name in the matrix. </p>\n\n<p>Any suggestions? :)</p>\n"},{"tags":["r","formatting","decimal"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":103,"score":3,"question_id":12643391,"title":"How to remove leading \"0.\" in a numeric R variable","body":"<p>How can one concisely change a numeric R variable (keeping it numeric) so that, e.g., \n\"-0.34\" becomes simply \"-.34\"?</p>\n"},{"tags":["windows","r","windows-xp","rcpp"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":308,"score":3,"question_id":9764495,"title":"How to get Rcpp to work in R on a Windows XP platform?","body":"<p>I've been trying to work with Rcpp in R 2.14.2 on a Windows XP platform. As far as I can tell, I followed all of the recommended steps for getting Rcpp to work: </p>\n\n<ol>\n<li>I installed R in a directory called C:\\R\\R-2.14.2; </li>\n<li>I installed the latest version of Rtools in the directory C:\\R\\Rtools;</li>\n<li>I set the environment PATH to the following (in this exact same order): </li>\n</ol>\n\n<blockquote>\n  <p>C:\\R\\Rtools\\bin;C:\\R\\Rtools\\gcc-4.6.3\\bin;<br>\n      C:\\R\\R-2.14.2\\bin\\i386;C:\\WINDOWS;C:\\WINDOWS\\system32</p>\n</blockquote>\n\n<p>Despite all of this, when I tried to run a test example in R to see if Rcpp works, I got an error message.  Here is the test example: </p>\n\n<pre><code>library(Rcpp)\nlibrary(inline)\n\nbody &lt;- '\nNumericVector xx(x);\nreturn wrap( std::accumulate( xx.begin(), xx.end(), 0.0));'\n\nadd &lt;- cxxfunction(signature(x = \"numeric\"), body, plugin = \"Rcpp\")\n\nx &lt;- 1\ny &lt;- 2\nres &lt;- add(c(x, y))\nres\n</code></pre>\n\n<p>Here is the rather long error message produced by R as a result of trying to execute the above R code.  Can anyone tell me what it is that I am doing wrong and what else I need to do to make sure that Rcpp works? </p>\n\n<pre><code>cygwin warning:\nMS-DOS style path detected: C:/R/R-214~1.2/etc/i386/Makeconf\nPreferred POSIX equivalent is: /cygdrive/c/R/R-214~1.2/etc/i386/Makeconf\nCYGWIN environment variable option \"nodosfilewarning\" turns off this warning.\nConsult the user's guide for more details about POSIX paths:\nhttp://cygwin.com/cygwin-ug-net/using.html#using-pathnames\ng++.exe: error: C:/Documents: No such file or directory\ng++.exe: error: and: No such file or directory\ng++.exe: error: Settings/dv6110ca/My: No such file or directory\ng++.exe: error: Documents/R/win-library/2.14/Rcpp/lib/i386/libRcpp.a: No such file  \nor directory\n\nERROR(s) during compilation: source code errors or compiler configuration errors!\n\nProgram source:\n1: \n2: // includes from the plugin\n3: \n4: #include &lt;Rcpp.h&gt;\n5: \n6: \n7: #ifndef BEGIN_RCPP\n8: #define BEGIN_RCPP\n9: #endif\n10: \n11: #ifndef END_RCPP\n12: #define END_RCPP\n13: #endif\n14: \n15: using namespace Rcpp;\n16: \n17: \n18: // user includes\n19: \n20: \n21: // declarations\n22: extern \"C\" {\n23: SEXP file684203c3ec2( SEXP x) ;\n24: }\n25: \n26: // definition\n27: \n28: SEXP file684203c3ec2( SEXP x ){\n29: BEGIN_RCPP\n30: \n31: NumericVector xx(x);\n32: return wrap( std::accumulate( xx.begin(), xx.end(), 0.0));\n33: END_RCPP\n34: }\n35: \n36: \nError in compileCode(f, code, language = language, verbose = verbose) : \nCompilation ERROR, function(s)/method(s) not created! cygwin warning:\nMS-DOS style path detected: C:/R/R-214~1.2/etc/i386/Makeconf\nPreferred POSIX equivalent is: /cygdrive/c/R/R-214~1.2/etc/i386/Makeconf\nCYGWIN environment variable option \"nodosfilewarning\" turns off this warning.\nConsult the user's guide for more details about POSIX paths:\nhttp://cygwin.com/cygwin-ug-net/using.html#using-pathnames\ng++.exe: error: C:/Documents: No such file or directory\ng++.exe: error: and: No such file or directory\ng++.exe: error: Settings/dv6110ca/My: No such file or directory\ng++.exe: error: Documents/R/win-library/2.14/Rcpp/lib/i386/libRcpp.a: No such file or  \ndirectory\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":289,"score":7,"question_id":12765497,"title":"create a ribbon plot","body":"<p>I'm wanting to create a ribbon plot (really it's a line plot of multiple groups of a categorical variable) but displayed in a 3d style.  This would look something like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/MBjCI.gif\" alt=\"enter image description here\"></p>\n\n<p>So maybe we would want to plot the following sample data as a ribbon plot:</p>\n\n<pre><code>set.seed(10)\nfun &lt;- function(i) data.frame(person=rep(LETTERS[i], 26), \n    letter=letters, count=sample(0:100, 26, T))\ndat &lt;- do.call(rbind, lapply(1:10, function(i) fun(i)))\n\nlibrary(ggplot2) #a traditional 2-d line plot of the data\nggplot(data=dat, aes(x=letter, y=count, group=person, color=person)) + \n    geom_line()\n</code></pre>\n\n<p>How can this be achieved in R?  I know there may be better ways to display the data but my interest currently is in producing the ribbon style plot.</p>\n"},{"tags":["r","table","latex","data.frame","xtable"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12766173,"title":"xtable package: Skipping some rows in the output","body":"<p>In the <code>xtable</code> output, if I want some rows to have nothing in them I will put <code>NA</code>'s in the elements of the matrix that correspond to the row that I want skipped.</p>\n\n<p>However this will lead to xtable output of something like <code>&amp; &amp; &amp; &amp; &amp; &amp; &amp; &amp; \\\\</code>. What I want to know is how do I make it so it's ONLY <code>\\\\</code> for that row that I wish to skip.</p>\n"},{"tags":["r","plot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":429,"score":0,"question_id":12766166,"title":"Error in plot.new() : figure margins too large in R","body":"<p>I'm new to R but I've made numerous correlation plots with smaller data sets. However, when I try to plot a large dataset (2gb+), I can produce the plot just fine, but the legend doesn't show up. Any advice? or alternatives?</p>\n\n<pre><code>&gt; library(gplots)\n&gt; r.cor &lt;- cor(r)\n&gt; layout(matrix(c(1,1,1,1,1,1,1,1,2,2), 5, 2, byrow = TRUE))\n&gt; par(oma=c(5,7,1,1))\n&gt; cx &lt;- rev(colorpanel(25,\"yellow\",\"black\",\"blue\"))\n&gt; leg &lt;- seq(min(r.cor,na.rm=T),max(r.cor,na.rm=T),length=10)\n&gt; image(r.cor,main=\"Correlation plot Normal/Tumor data\",axes=F,col=cx)\n&gt; axis(1, at=seq(0,1,length=ncol(r.cor)), labels=dimnames(r.cor)[[2]], \n+  cex.axis=0.9,las=2)\n&gt; axis(2,at=seq(0,1,length=ncol(r.cor)), labels=dimnames(r.cor)[[2]],\n+  cex.axis=0.9,las=2)\n&gt; image(as.matrix(leg),col=cx,axes=T)     \n\nError in plot.new() : figure margins too large\n\n&gt; tmp &lt;- round(leg,2)\n&gt; axis(1,at=seq(0,1,length=length(leg)), labels=tmp,cex.axis=1)\n</code></pre>\n"},{"tags":["r","wavelet"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":223,"score":2,"question_id":11192291,"title":"continuous wavelet transform","body":"<p>This question is rather vague but has anyone used the biwavelet package in R and been successful? I have the following code:</p>\n\n<pre><code>require(biwavelet)\nt1 &lt;- cbind(DecTime,Temp)    \n## continuous wavelet transform\nwt1 &lt;- wt(t1)\nplot(wt1)\n</code></pre>\n\n<p>and it returns the error:</p>\n\n<p><em>Error in image.default(x$t, yvals, t(zvals), zlim = zlims, ylim = rev(range(yvals)),  : \n  'x' and 'y' values must be finite and non-missing</em></p>\n\n<p>I dont understand this error because my data does not contain any missing values and they are all finite.</p>\n\n<p>When trying to reproduce the example:</p>\n\n<pre><code>require(biwavelet)\nDate = seq(from=as.POSIXct(\"2011-01-01 00:00\"), \n           to=as.POSIXct(\"2011-12-31 23:00\"), length=8760)\nDecTime = julian(Date, Date[1])\n\ndata=cbind(as.numeric(DecTime), rnorm(8760))\n## Continuous wavelet transform\nwt.t1=wt(data)\nplot(wt.t1)\n</code></pre>\n\n<p>It annoyingly works, therefore I do not know why my data fails in this package. The data in the above example is the same class as my data i.e. 'matrix'. Any help or advise would be appreciated.</p>\n\n<p>Altered:</p>\n\n<pre><code>require(biwavelet)\nDate = seq(from=as.POSIXct(\"2011-01-01 00:00\"), \n           to=as.POSIXct(\"2011-12-31 23:00\"), length=8760)\nDecTime = julian(Date, Date[1])\nD &lt;- c(4.0267, 4.0211, 4.0005,4.0042,4.0042,4.0191)\ndata=cbind(as.numeric(DecTime[1:6]),as.numeric(D))\n## Continuous wavelet transform\nwt.t1=wt(data)\nplot(wt.t1)\n\n\n&gt; data\n           [,1]   [,2]\n[1,] 0.00000000 4.0267\n[2,] 0.04166667 4.0211\n[3,] 0.08333333 4.0005\n[4,] 0.12500000 4.0042\n[5,] 0.16666667 4.0042\n[6,] 0.20833333 4.0191\n&gt; class(data)\n[1] \"matrix\"\n&gt; class(data[,1])\n[1] \"numeric\"\n&gt; class(data[,2])\n[1] \"numeric\"\n&gt; wt.t1=wt(data)\n&gt; plot(wt.t1)\nError in image.default(x$t, yvals, t(zvals), zlim = zlims, ylim = rev(range(yvals)),  : \n  invalid z limits\n</code></pre>\n"},{"tags":["r","wavelet"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":11952538,"title":"On using the biwavelet package in R","body":"<p>Could anyone suggest why the following example code does not work:</p>\n\n<pre><code>require(biwavelet)\nt &lt;- seq(1/24, 365, 1/24)\nA &lt;- 2\nfs &lt;- 1/24\ny &lt;- A + sin(2*pi*fs*t)\nd = cbind(t,y)\nwt.t1 &lt;- wt(d)\nplot(wt.t1)\n</code></pre>\n\n<p>It generates an error stating:</p>\n\n<pre><code>Error in image.default(x$t, yvals, t(zvals), zlim = zlims, ylim = rev(range(yvals)),  : \n  invalid z limits\n</code></pre>\n\n<p>How would I fix this problem?</p>\n\n<p><strong>Additional:</strong></p>\n\n<p>In response to Gavin Simpsons answer: If I keep the data to only include one frequency but alter the time vector, the code works fine. </p>\n\n<pre><code>require(biwavelet)\nA &lt;- 2\nfs &lt;- 1/24\ny &lt;- A + sin(2*pi*fs*t)\nd &lt;- cbind(seq(1,8760), y) \nwt.t1 &lt;- wt(d)\nplot(wt.t1)\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":82,"score":-5,"question_id":12766276,"title":"Running Entire R code","body":"<p>How does one run an entire R code script after having written it? So far the only methods I've used included highlighting the entire script and then clicking the run button. The other option is to run each line one by one. Is there an easier way to run the entire script with a single button or a shortcut?</p>\n\n<p>Thank you!</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":108,"score":6,"question_id":12765083,"title":"Principal Component Analysis in R data color","body":"<p>Hi everyone I have a simple question but for which i havent been able to get an answer in any tutorial. Ive done a simple principal component analysis on a set of data and then plot my data with biplot. </p>\n\n<pre><code>CP &lt;- prcomp(dat, scale. = T)\nsummary(CP)\n\nbiplot(CP)\n</code></pre>\n\n<p>With this i get a scatter plot of my data in terms of the first and second component. I wish to separate my data by color, indicating R to paint my first 20 data in red and next 20 data in blue. I dont know how to tell R to color those two sets of data.\nAny help will be very appreciated. thks!\n(im very new to R)</p>\n"},{"tags":["emacs","r","sweave"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":193,"score":4,"question_id":2849657,"title":"emacs editing Rnw keep region highlighted when highlighting R chunk","body":"<p>When editing an Rnw file in Emacs, I often want to make the region cover a chunk of text that contains an R chunk. For a simple example, </p>\n\n<pre><code>ewr\n&lt;&lt;&gt;&gt;=\n@ \nwer\n</code></pre>\n\n<p>I use transient-mark-mode such that the region is highlighted. But, if I put the point on the first line and hit C-SPC, then use C-n to move the point down, the highlighting disappears when I try to advance the point past the &lt;&lt;. The region I want is still selected, but highlighting seems to fail when crossing the &lt;&lt;. How can I fix this?</p>\n\n<p>Thanks and best regards</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":66,"score":-1,"question_id":12765668,"title":"Making Curly Brackets More Noticeable in R","body":"<p>IS there a way to make the curly {} brackets more noticeable in R? Is there a package or a feature than can allow you to match the curly brackets?</p>\n\n<p>Thank you!</p>\n"},{"tags":["regex","r"],"answer_count":5,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":201,"score":6,"question_id":10309122,"title":"Split on first comma in string","body":"<p>How can I efficiently split the following string on the first comma using base?</p>\n\n<pre><code>x &lt;- \"I want to split here, though I don't want to split elsewhere, even here.\"\nstrsplit(x, ???)\n</code></pre>\n\n<p>Desired outcome (2 strings):</p>\n\n<pre><code>[[1]]\n[1] \"I want to split here\"   \"though I don't want to split elsewhere, even here.\"\n</code></pre>\n\n<p>Thank you in advance.</p>\n\n<p>EDIT: Didn't think to mention this.  This needs to be able to generalize to a column, vector of strings like this, as in:</p>\n\n<pre><code>y &lt;- c(\"Here's comma 1, and 2, see?\", \"Here's 2nd sting, like it, not a lot.\")\n</code></pre>\n\n<p>The outcome can be two columns or one long vector  (that I can take every other element of) or a list of stings with each index ([[n]]) having two strings.</p>\n\n<p>Apologies for the lack of clarity.</p>\n"},{"tags":["r","split","time-series","xts"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12739654,"title":"split.xts at a custom time","body":"<p>I am currently using split.xts in the form of <code>split(xts.obj,'days')</code> to create lists of intra-day data, so that each element of the list represents one day. This breaks up a day from midnight to (just before) midnight the next day is there a way to split up the data into the lists at an arbitrary time, e.g. say 9am till 08:59.59.999am the next day?</p>\n\n<p>It's a reasonably generic question but if you want sample data...here it is...The below should illustrate my point about the split occurring at midnight.</p>\n\n<pre><code>require(xts)\nx &lt;- xts(rnorm(1000000),Sys.time()-1000000:1)\nx1 &lt;- split(x,'days')\nhead(x1[[2]])\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>The solution is very similar to one produced as the answer to this question... <a href=\"http://stackoverflow.com/questions/9908643/how-do-i-extract-subset-day0-to-day1-index-times-from-minutely-data-via-xts\">How do I extract / subset day+0 to day+1 index times from minutely data via xts in R?</a>, but if there is a more direct way of doing it that would be appreciated...</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12765560,"title":"Is there any way to add to a column name in R?","body":"<p>I'm new to R and need a bit of help. Basically, I have microarray data in a data frame and would like to append to the column name. Columns are named: A, B, C, etc.</p>\n\n<blockquote>\n  <p>[user] > names(first.df)</p>\n  \n  <p>[1] \"A\" \"B\" \"C\" \"D\"</p>\n</blockquote>\n\n<p>Another data frame identifies each factor (A, B, C, etc.) as \"good\" or \"bad\"</p>\n\n<blockquote>\n  <p>[user] > second.df</p>\n  \n  <p>[1]\n  A     good</p>\n  \n  <p>B     bad</p>\n  \n  <p>C     bad</p>\n  \n  <p>D     good</p>\n</blockquote>\n\n<p>Is there any way to add the \"good\"/\"bad\" to the column header of the first data frame?</p>\n\n<blockquote>\n  <p>[user] > names(first.df)</p>\n  \n  <p>[1]  \"A-good\"  \"B-bad\"   \"C-bad\"   \"D-good\"</p>\n</blockquote>\n\n<p>I've tried isolating names to their own data frame (e.g. names(first.df) &lt;- c(names(first.df), second.df[,2]) and merging with no luck. Any advice?</p>\n"},{"tags":["r","time-series","xts"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":141,"score":2,"question_id":12740851,"title":"to.minutes using custom endpoints","body":"<p>I am using intra-day data that starts at 9:50am and would like to convert it into 20 minute time intervals so the first period would be from 09:50 to 10:09:59 and the second time period would be from 10:10 to 10:29:59 etc. However <code>to.minutes()</code> from the <code>xts</code> package seems to fix it onto the hours and the has time bars at 09:59:59 and 10:19:59 etc...i.e. it is 10 minutes out... i know its probably not a regular request...but is there anyway of doing this so that it has the correct endpoints, i.e. basing it upon the frist timestamp?</p>\n\n<p>and for bonus points...is there a way to do do it based on the final time stamp? (i.e. generateing the period endpoints going backwards from that timestamp?</p>\n\n<p>here is an illustration of my point about it being 10 minutes out (from what I want)</p>\n\n<pre><code>x &lt;- xts(rnorm(24*60*60), as.POSIXct(format(paste(Sys.Date(),'09:50')))-((24*60*60):1))\nhead(x)\nx1 &lt;- to.minutes(x, 20)\nhead(x1)\n</code></pre>\n\n<p>I can think of a way to correct this by using splits, cuts, lapplys do.calls and rbinds....but I would basically be re-creating an OHLC object...and feel that it might be inefficient in comparison to existing solutions...</p>\n"},{"tags":["c","r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12765304,"title":"calling R function \"optim\" from C","body":"<p>I am new to C.</p>\n\n<p>I am trying to use optim function from C. According to \"Writing R Extension\" Section 5.8, the Nelder Mead method requires 16 arguments:</p>\n\n<pre><code>void nmmin(int n, double *xin, double *x, double *Fmin, optimfn fn,\n           int *fail, double abstol, double intol, void *ex,\n           double alpha, double beta, double gamma, int trace,\n           int *fncount, int maxit);\n</code></pre>\n\n<p>In my understanding, unlike R which accepts default values in arguments of functions, C requires users of the function to provide all the arguments.\nAlthough I read optim hep page, I still have troubles understanding the meaning of some of these arguments i.e.:</p>\n\n<ul>\n<li>fail</li>\n<li>intol</li>\n<li>ex</li>\n<li>fncount</li>\n</ul>\n\n<p>I highly appreciate if anyone can direct me where the descriptions of all the arguments are.</p>\n\n<p>p.s.</p>\n\n<p>The followings are the arguments that I figure out what they are:</p>\n\n<ul>\n<li>n: the number of parameters,</li>\n<li>xin: the initial value of the parameter</li>\n<li>x: storage for the final parameters on exit, with fi</li>\n<li>Fmin: the final value of the objective function</li>\n<li>fn: the objective function</li>\n<li>abstol: absolute tolerance</li>\n<li>maxit: the maximum number of iterations</li>\n<li>trace: Non-negative integer. If positive, tracing information on the progress of the optimization is produced.</li>\n</ul>\n\n<p>The followings are some arguments specific for the Nelder Mead method:</p>\n\n<ul>\n<li><p>alpha:  R optim function uses = 1</p></li>\n<li><p>beta:   R optim function uses = 0.5</p></li>\n<li><p>gamma:  R optim function uses = 2 \n(I found these default values by reading the optim function codes)</p></li>\n</ul>\n"},{"tags":["r","x12"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12764681,"title":"R X12 automdl trouble","body":"<p>Does anyone have an idea why I might receive this error:</p>\n\n<p>Error in automdl &amp;&amp; is.null(arima) : invalid 'x' type in 'x &amp;&amp; y'</p>\n\n<p>When attempting to run the second example in the R package x12?</p>\n\n<pre><code>library(x12)\ndata(AirPassengers)\nx12out &lt;- x12(AirPassengers,x12path=\"c:\\\\x12arima\\\\x12a.exe\",transform=\"auto\",\n          automdl=\"TRUE\")\n</code></pre>\n\n<p>Running the first example with the fulling specified ARIMA works.</p>\n\n<pre><code>x12out &lt;- x12(AirPassengers,x12path=\"c:\\\\x12arima\\\\x12a.exe\",transform=\"auto\",\n          arima=c(0,1,1),sarima=c(0,1,1),regvariables=\"lpyear\",\n          sigmalim=c(2.0,3.0),outlier=\"all\",critical=list(LS=3.5,TC=3),\n          seasonalma=\"s3x3\")\n</code></pre>\n\n<p>Clearly the \"automdl\" is choking for some reason?</p>\n"},{"tags":["r","ubuntu","rstudio"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12758789,"title":"Make Rstudio works with custom compiled R on Ubuntu","body":"<p>I instlled R 2.14 with R Commander via Ubuntu Software Center at first.</p>\n\n<p>And then I installed Rstudio and it worked fine with R 2.14.</p>\n\n<p>After a while, I wanted to use R 2.15 but failed compiling the R 2.15 source code. </p>\n\n<p>Therefore, I tried \"sudo apt-get build-dep r-base\".\nAfter that I compiled R 2.15 successfully, and installed R 2.15.</p>\n\n<p>But, now Rstudio keeps reporting \n\"R shared library (/usr/local/lib/R/lib/libR.so) not found. If this is a custom build of R, was it built with the --enable-R-shlib option?\"</p>\n\n<p>It seems that I should reinstall R 2.15 with option --enable-R-shlib.</p>\n\n<p>But the problem is that how can I unstall R 2.15?</p>\n\n<p>I tried \"sudo apt-get autoremove r-base\", but R 2.15 still works on my Ubuntu.</p>\n\n<p>Any ideas on how I can make Rstudio works with custom compiled R?</p>\n\n<p>Thanks,</p>\n"},{"tags":["r","na"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":58,"score":-3,"question_id":12763890,"title":"Exclude Blank and NA in R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4862178/r-remove-rows-with-nas-in-data-frame\">R - remove rows with NAs in data.frame</a>  </p>\n</blockquote>\n\n\n\n<p>I have a dataframe named sub.new with multiple columns in it. And I'm trying to exclude any cell that's NA or \"\". I tried to use <code>subset()</code>, but it's targeting specific column conditional. Is there anyway to scan through the whole dataframe and create a subset that no cell is NA or \"\"?</p>\n\n<p>Any suggestions? Thanks</p>\n"},{"tags":["vb.net","r","random","statistics"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":62,"score":-4,"question_id":12763928,"title":"Integrate R with VB.NET","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/10763516/how-to-communicate-with-r-through-vbnet-or-c\">how to communicate with R through VBnet( or C#)</a>  </p>\n</blockquote>\n\n\n\n<p>I want to generate a random number from log-normal and triangular distribution in VB.NET. </p>\n\n<p>To do so I thought of integrating R with VB.NET. I added following reference to R,</p>\n\n<pre><code>STATCONNECTORCLNTLib;\nStatConnectorCommonLib;\nSTATCONNECTORSRVLib;\n</code></pre>\n\n<p>My questions:</p>\n\n<ol>\n<li>is there anything else that I need to do to use R in VB.NET</li>\n<li>How can I use R commands in VB.NET?</li>\n</ol>\n\n<p>Thanks!</p>\n"},{"tags":["windows","r","localization","settings","rstudio"],"answer_count":1,"favorite_count":0,"up_vote_count":9,"down_vote_count":0,"view_count":95,"score":9,"question_id":12760491,"title":"The R console is in my native language, how can I set R to English?","body":"<p>I am using R on Windows 7. Apparently R somehow found evidence that I speak languages besides English, and stubbornly insists on giving output in the console in my own language. For a variety of reasons, this is undesirable, and I want R to be English.</p>\n\n<h2>What works</h2>\n\n<p>I am able to use <code>LANGUAGE=en</code> as a command line option for the R console desktop shortcut, but the language is still wrong in Rstudio, which launches the R executable directly and hence ignores the command line arguments in the shortcut.</p>\n\n<h2>What doesn't work</h2>\n\n<p>I have tried creating an <code>.Renviron</code> file under <code>C:\\Users\\[MY_NAME]\\Documents</code>, which is the path returned for the working directory by <code>getwd()</code>, with <code>LANGUAGE=en</code> in it. R ignores this. My <code>R_ENVIRON</code> and <code>R_ENVIRON_USER</code> variables show up as <code>\"\"</code> so <code>.Renviron</code> should be the correct filename.</p>\n\n<p>I have also tried creating <code>.Renviron</code> under <code>R_HOME\\etc</code> (<code>R_HOME</code> points to <code>C:/PROGRA~1/R/R-215~1.0</code>) and R also ignores it.</p>\n\n<p>I was somewhat successful with adding <code>Sys.setenv(LANGUAGE=\"en\")</code> in <code>R_HOME\\etc</code> - this made all output from the R console English, except for the initial copyright information.</p>\n\n<h2>The question</h2>\n\n<p>How can I make R default to English such that this is propagated to RStudio?</p>\n"},{"tags":["r","if-statement","switch-statement"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":12379128,"title":"R switch statement on comparisons","body":"<p>I'm trying to write an R script to evaluate different expressions based on fitting a value within ranges. The idea is that if Length is within one range, it will get evaluated one way, and if it's in a longer range it will get evaluated differently. </p>\n\n<p>I can make this work with if/else statements, but it's pretty ugly, and I'm sure there must be a better way... here's code that works.</p>\n\n<pre><code>Length=8.2\n\nif (Length&lt;1) \n    mode=\"Walk\"\nelse if (1&lt;=Length &amp; Length &lt;5)\n    mode=\"bike\" \nelse if (5&lt;=Length &amp; Length &lt;10)\n    mode=\"drive\"\nelse if (Length&gt;=10)\n    mode=\"fly\"\n</code></pre>\n\n<p>I've been trying to make something work with the switch function, but it seems to only work with text or integers... is there a way to have a switch statement that conducts evaluations at each case such as this?</p>\n\n<pre><code>Length=3.5\n\nswitch(Length,\n       (Length&lt;1)  mode=\"Walk\"\n       (1&lt;=Length &amp; Length &lt;5)  mode=\"bike\"\n       (5&lt;=Length &amp; Length &lt;10)  mode=\"drive\"\n       (Length=&gt;10)  mode=\"fly\"\n)\n</code></pre>\n"},{"tags":["linux","r","installation","rstudio"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":89,"score":1,"question_id":12374646,"title":"error installing TSA package for R on RStudio","body":"<p>so I've been struggling with this issue for a while now, and I cannot seem to find this issue anywhere else on the internet.</p>\n\n<p>I am running: \nLinux Mint 12(based on Ubuntu 11.10)\nThe latest version of R(2.15.1)\nRStudio(0.96.331)</p>\n\n<p>Both R and RStudio are the latest versions, so my issues with installing TSA are not based on an outdated version of R.</p>\n\n<p>Here is the error message I am getting when I try to install TSA through RStudio(I installed PerformanceAnalytics and xts without any issues):</p>\n\n<blockquote>\n  <p>installing <em>source</em> package ‘TSA’ ...</p>\n  \n  <p>** Creating default NAMESPACE file</p>\n  \n  <p>** R</p>\n  \n  <p>** data</p>\n  \n  <p>** preparing package for lazy loading</p>\n  \n  <p>Error : .onLoad failed in loadNamespace() for 'Matrix', details:</p>\n  \n  <p>call: assignInNamespace(\"..Old..as.matrix\", base::as.matrix, ns = \"base\")</p>\n  \n  <p>error: locked binding of ‘..Old..as.matrix’ cannot be changed</p>\n  \n  <p>Error : package ‘mgcv’ could not be loaded</p>\n  \n  <p>ERROR: lazy loading failed for package ‘TSA’</p>\n  \n  <ul>\n  <li>removing ‘/home/client/R/i686-pc-linux-gnu-library/2.15/TSA’</li>\n  </ul>\n  \n  <p>Warning in install.packages :</p>\n  \n  <p>installation of package ‘TSA’ had non-zero exit status</p>\n</blockquote>\n\n<p>I have checked my version of mgcv and it is the latest(I checked on my Software Manager and it is installed as well as the latest version).</p>\n\n<p>I really have no idea of what to do now. I contemplated installing TSA manually onto my system itself, but I couldn't find a reliable website that explains how to install packages directly to R itself.</p>\n\n<p>All assistance with this issue will be greatly appreciated.</p>\n"},{"tags":["arrays","r","linear-algebra","vectorization","matrix-multiplication"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":12380445,"title":"Basic R: Multiplying elements in 3-D array with loop","body":"<p>I have two 3-D arrays, <strong>A</strong> and <strong>B</strong>, each 2 x 3 x 3.  Examples shown below (which will help clarify how I'd like to multiply).</p>\n\n<pre><code> A1   A2   A3                             B1   B2   B3  \n A4   A5   A6                             B4   B5   B6\n\n A7   A8   A9                             B7   B8   B9\n A10  A11  A12                            B10  B11  B12\n\n A13  A14  A15                            B13  B14  B15\n A16  A17  A18                            B16  B17  B18\n</code></pre>\n\n<p>What I want to do is create a matrix where the 3 <strong>A</strong> matrices are averaged and the value at a location is weighted by the corresponding <strong>B</strong> value...I can't explain well, but for example, the first element is:</p>\n\n<pre><code>[(A1*B1)+(A7*B7)+(A13*B13)] / sum(B1,B7,B13).\n</code></pre>\n\n<p>Another element is:</p>\n\n<pre><code>[(A5*B5)+(A11*B11)+(A17*B17)] / sum(B5,B11,B17).\n</code></pre>\n\n<p>and so on...the result is a 2 x 3 matrix.  I've been playing with different combinations of nested for loops, an example of which is shown below, but I haven't figured out how to do it properly... help appreciated.</p>\n\n<pre><code>for (j in 1:2){\n     for (k in 1:3){\n          ans[j*k]=sum(A[j,k,1:3]*B[j,k,1:3])/sum(B[j,k,1:3])\n     }\n}\n</code></pre>\n"},{"tags":["r"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":12377447,"title":"How to Create a Column of Ranks While Grouping in R","body":"<p>I am using R and I want to create a column showing a sequence or rank, while grouping by two factors (hhid and period).</p>\n\n<p>For example, I have this data set:</p>\n\n<pre><code>hhid perid\n1000 1     \n1000 1\n1000 1\n1000 2\n1000 2\n2000 1\n2000 1\n2000 1\n2000 1\n2000 2\n2000 2\n</code></pre>\n\n<p>I want to add a column called \"actno\" like this:</p>\n\n<pre><code>hhid perid actno\n1000 1     1\n1000 1     2\n1000 1     3\n1000 2     1\n1000 2     2\n2000 1     1\n2000 1     2\n2000 1     3\n2000 1     4\n2000 2     1\n2000 2     2\n</code></pre>\n"},{"tags":["python","r","graph","social-networking","rda"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12763784,"title":"R creating networks in .rda format","body":"<p>I am completely new to R. I am working on a spectral stochastic block model, which I need to compare with an already proposed method having an R implementation. This program takes a network as an <code>rda</code> file like <a href=\"http://pastebin.com/T9wdWZ2G\" rel=\"nofollow\">this</a> as input. \nNote: I just copied this text from the view of the .rda file created by r.These rda files are not readable outside R and I am finding no way to create files for other datasets using some other language(like python).</p>\n\n<p>The content is basically like: the first list is a RMO of the adjacency matrix of the graph, and the second and third are node labels for the rows and columns respectively. I have these required matrices and labels. Is there some way that I can create such datasets in R itself?</p>\n\n<p>P.S: I tried changing the content of this file in R's view and paste in my matrices, and it worked. But I have huge graphs with close to 20k nodes and this approach fails there.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12361879,"title":"Replicating and Altering Data Frame in R","body":"<p>Hi I'm trying replicate a data frame and then alter one of my columns called \"i\" for iteration based on the replicate number.</p>\n\n<p>E.g. My starting data frame is:</p>\n\n<pre><code>dataframex &lt;- data.frame(i = c(1, 1, 1),\n                         x = c(1, 3, 5),\n                         y = c(2, 4, 6))\ndataframex \n#   i x y\n# 1 1 1 2\n# 2 1 3 4\n# 3 1 5 6\n</code></pre>\n\n<p>I used the command code</p>\n\n<pre><code>dataframex[rep(1:nrow(dataframex), times=3), ]\n#     i x y\n# 1   1 1 2\n# 2   1 3 4\n# 3   1 5 6\n# 1.1 1 1 2\n# 2.1 1 3 4\n# 3.1 1 5 6\n# 1.2 1 1 2\n# 2.2 1 3 4\n# 3.2 1 5 6\n</code></pre>\n\n<p>But what I really want is:</p>\n\n<pre><code>#     i x y\n# 1   1 1 2\n# 2   1 3 4\n# 3   1 5 6\n# 1.1 2 1 2\n# 2.1 2 3 4\n# 3.1 2 5 6\n# 1.2 3 1 2\n# 2.2 3 3 4\n# 3.2 3 5 6\n</code></pre>\n\n<p>i.e. the iteration column indicates the number of replicated data sets i have. I want to then use the iteration column to merge this data frame with another. </p>\n\n<p>P.s. sorry this is the first time I've used stackoverflow and I couldn't figure out how to make a table so I hope you can understand my makeshift column separators.</p>\n"},{"tags":["r","function","type-conversion","expression"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":49,"score":4,"question_id":12758810,"title":"Expression to function","body":"<p>I'm trying to solve an equation using <code>uniroot()</code> but before that I must differentiate an expression.</p>\n\n<p>I create the expression, then differentiate it with <code>D()</code> but I have no clue how to return said expression to a function I can take the root of.</p>\n\n<p>So far I have:</p>\n\n<pre><code>eq&lt;-expression((w^2)*3+((1-w)^2)*2.5+2*w*(1-w)*0.9)\nf&lt;-D(eq, name=\"w\")\n</code></pre>\n\n<p>Thank you in advance for your help!</p>\n"},{"tags":["r","stat","sox",".wav"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":12757685,"title":"Batch measurements of .wav files with sox stats","body":"<p>My question is similar to a previous question about \"get-mean-amplitude-of-wav-from-sox\":</p>\n\n<p><a href=\"http://stackoverflow.com/questions/12383496/get-mean-amplitudeonly-of-wav-from-sox/12434108#12434108\">Get Mean amplitude(only) of .wav from sox</a></p>\n\n<p>I would like to be able to use the stats sox to do batch measurements of 1,000's of .wav files in a directory, and store the results in a data frame or some similar structure I can save as a csv text file.   </p>\n\n<p>For one sound file, the code would be:</p>\n\n<p>./sox SampleSound.wav -n  stat</p>\n\n<p>Resulting in the following output:</p>\n\n<pre><code>Samples read:          72000000\nLength (seconds):   3600.000000\nScaled by:         2147483647.0\nMaximum amplitude:     0.778809\nMinimum amplitude:    -1.000000\nMidline amplitude:    -0.110596\nMean    norm:          0.062671\nMean    amplitude:    -0.008131\nRMS     amplitude:     0.172914\nMaximum delta:         1.778809\nMinimum delta:         0.000000\nMean    delta:         0.014475\nRMS     delta:         0.057648\nRough   frequency:         1061\nVolume adjustment:        1.000\n</code></pre>\n\n<p>I would like to: \n- take batch measurements on 1,000's of sound files in a given directory,\n- capture the stats output in columns along with the sound file name that was measured,\n- and export for use as covariates in an analysis in R.</p>\n\n<p>Thanks!  </p>\n\n<p>Matthew</p>\n"},{"tags":["r","text-mining"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12629993,"title":"Trouble with findAssocs from package tm","body":"<p>I am attempting to find words associated with a particular word in a term document matrix using the tm package.</p>\n\n<p>I am using findAssocs to do this. Arguments for findAssocs are:</p>\n\n<ul>\n<li>x: A term-document matrix.</li>\n<li>term: A character holding a term.</li>\n<li>corlimit: A numeric for the lower correlation bound limit. </li>\n</ul>\n\n<p>I am consistently getting numeric(0) as my result </p>\n\n<p>Example:</p>\n\n<p>findAssocs(test.dtm, \"investment\", 0.90)\nnumeric(0)</p>\n\n<p>Does anyone have familiarity with findAssocs and know what I am doing wrong? Or does anyone know more broadly what the numeric(0) result could mean?</p>\n\n<p>Thank you very much in advance for any help. </p>\n"},{"tags":["r","ggplot2"],"answer_count":3,"favorite_count":7,"up_vote_count":12,"down_vote_count":0,"view_count":3014,"score":12,"question_id":3544002,"title":"Easier way to plot the cumulative frequency distribution in ggplot?","body":"<p>I'm looking for an easier way to draw the cumulative distribution line in ggplot.</p>\n\n<p>I have some data whose histogram I can immediately display with</p>\n\n<pre><code>qplot (mydata, binwidth=1);\n</code></pre>\n\n<p>I found a way to do it at\n<a href=\"http://www.r-tutor.com/elementary-statistics/quantitative-data/cumulative-frequency-graph\" rel=\"nofollow\">http://www.r-tutor.com/elementary-statistics/quantitative-data/cumulative-frequency-graph</a>\nbut it involves several steps and when exploring data it's time consuming. Is there a way to do it in a more straightforward way in ggplot, similar to how trend lines and confidence intervals can be added by specifying options?</p>\n\n<p>Thanks you.</p>\n"},{"tags":["r","data.frame"],"answer_count":2,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":127,"score":7,"question_id":12752648,"title":"Download economic official data from a Central Bank web page","body":"<p>I've been searching for a while any answer to my question. I read <a href=\"http://stackoverflow.com/questions/7407735/importing-wikipedia-tables-in-r\">this</a>, <a href=\"http://stackoverflow.com/questions/12372355/r-crashing-on-readhtmltable-call-to-wikipedia\">this</a> and <a href=\"http://stackoverflow.com/questions/12208043/r-readhtmltable-function-error\">this</a> and some others related but I still get not answer. </p>\n\n<p>My problem is quite simple (I hope it is) but the answer is not (at least for myself), I want to import some economic data from <a href=\"http://www.bcn.gob.ni/estadisticas/trimestrales_y_mensuales/siec/datos/4.IMAE.htm\">this</a> web which is an indicator for Nicaraguan economic activity measured each month, so far I've tried this:</p>\n\n<pre><code>library(XML)\nu &lt;- \"http://www.bcn.gob.ni/estadisticas/trimestrales_y_mensuales/siec/datos/4.IMAE.htm\"\nu &lt;- htmlParse(u,encoding=\"UTF-8\")\nimae &lt;- readHTMLTable(doc=u, header=T)\nimae\n\nlibrary(httr)\nu2 &lt;- \"http://www.bcn.gob.ni/estadisticas/trimestrales_y_mensuales/siec/datos/4.IMAE.htm\"\npage &lt;- GET(u2, user_agent(\"httr\"))\nx &lt;- readHTMLTable(text_content(page), as.data.frame=TRUE)\n</code></pre>\n\n<p>with no success as you can imagine. The first chunk of code gave me this output</p>\n\n<pre><code>   $`NULL`\n                                  BANCO CENTRAL DE NICARAGUA    NA    NA    NA   NA   NA   NA   NA   NA   NA   NA    NA    NA       NA\n1                                                             &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;\n2 &lt;U+633C&gt;&lt;U+3E64&gt;ndice Mensual de Actividad Económica(IMAE)  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;\n3                                           (Base: 1994=100)  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;\n4                                                             &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;\n5                                                        Año   Ene   Feb   Mar  Abr  May  Jun  Jul  Ago  Sep  Oct   Nov   Dic Promedio\n6                                                             &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;\n7                                                       1994 101.6 107.6 100.1 95.7 94.7 92.8 92.1 96.8 98.5 97.4 101.7 121.1    100.0\n8                                               Fuente: BCN.  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;\n</code></pre>\n\n<p>I tried using <code>skip.rows=1:5</code> but it doesn't really change the main result which is too much <code>NA</code>. Is there anybody who can shed some light on this question?</p>\n\n<p>The expected result is a data.frame with the information shown in <a href=\"http://www.bcn.gob.ni/estadisticas/trimestrales_y_mensuales/siec/datos/4.IMAE.htm\">this web</a></p>\n"},{"tags":["r","solr"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":12761017,"title":"How to access Solr data from R script?","body":"<p>Is there a R package that simplify access to the data stored into Apache Solr server? \nI know that Solr has a REST-like API, and R has a <code>RCurl</code> package that provide http/https communication, but such communication is not as simple as we would like. \nPlease help me find a way to simplify the Solr - R interaction.\nThanks.</p>\n"},{"tags":["r","project","combine","workspaces"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":100,"score":3,"question_id":12760397,"title":"Combining or merging workspaces in R and general workspace management","body":"<p>I often find myself transferring workspaces to different scratch drives etc when one computing system is down/busy, or, I want to run two long-winded packages simultaneously to save time and loading the same workspace twice in different places.</p>\n\n<p>Because of this, I'd really love a way to see the different objects between workspaces and a way to combine them, adding only the new, changed or updated workspace objects to a similar workspace. This would be extremely useful for me. </p>\n\n<p>So far I am relying on manual note-taking and getting befuddled with my scribbles two weeks down the line. I really just want to learn so good working practices and habits that make this sort of this easier. </p>\n\n<p>Generally I would really like to learn more about workspace management and how experienced users keep workspaces for long, ongoing projects comprehensive and tidy. I often use Rstudio but working remotely or using our HPC system it can be a bit laggy and clunky so I tend to use command line and interactive sessions.</p>\n\n<p>I think maybe making lists of objects might be the key, but I'd like to be able to annotate things more easily, maybe with the data and parameters used to make the object etc. </p>\n\n<p>Thanks.</p>\n"},{"tags":["r","data.frame","permutation","combinations"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":12760030,"title":"combination with missing or mismathes in r","body":"<p>I have to create unique combination while allowing some mismatches. The following is an example:</p>\n\n<pre><code>set.seed (1234)\ndataf &lt;- data.frame (var1 = sample( c(\"A\", \"B\", \"-\"),20, replace = T),\n            var2 = sample( c(\"A\"),20, replace = T),\n            var3 = sample( c(\"B\", \"B\", \"B\", \"-\"),20, replace = T),\n            var4 = sample( c(\"A\",\"A\", \"A\",  \"-\"),20, replace = T),\n            var5 = sample( c(\"A\", \"B\", \"A\", \"A\", \"-\"),20, replace = T)\n            )\n dataf\n</code></pre>\n\n<p>Rules:</p>\n\n<p>(1) Generate Unique combinations:</p>\n\n<pre><code>     A B     A  B  B   - combination 1\n    A  A     A  B  B    - combination 2\n    B  B     B  A  A    - combination 3 \n   so on ...\n</code></pre>\n\n<p>(2)  Allow one (can be n) mismatch to create a category. For example:</p>\n\n<pre><code>A   B    A  B  B\nA   A    A  B  B\nB   A    A  B  B\nB   A    B  B  B \nB   A    A  B  A\n</code></pre>\n\n<p>are same as there a single mismatch at different variables. </p>\n\n<p>(3)  \"-\" indicates missing values, can be treated as similar way as integers in matching means that one mismatch allowed. </p>\n\n<pre><code>A   B    A  B  B\n A   -    A  B  B\n A   B    A  -  B\n</code></pre>\n\n<p>However if there are two missing values then combination is declared unknown (-)</p>\n\n<pre><code> A   B    A  B  B\n A   -    A  -  B\n A   B    A  -  -\n</code></pre>\n\n<p>The following is workout for the above data. </p>\n\n<pre><code>    var1 var2 var3 var4 var5       comb\n1     A    A    B    -    -       -\n\n2     B    A    B    A    A        1\n3     B    A    B    A    A        1\n4     B    A    B    A    A        1\n5     -    A    B    A    A        1\n6     B    A    B    A    -        1\n\n7     A    A    B    A    B        2\n8     A    A    B    A    B        2\n\n9     B    A    B    A    A        1\n\n10    B    A    -    A    -        -\n\n11    -    A    B    A    A        1\n\n12    B    A    B    -    -        -\n\n13    A    A    B    A    A        2\n\n14    -    A    B    -    A        -\n\n15    A    A    B    A    A        2\n16    -    A    B    A    A        2\n17    A    A    B    A    B        2\n\n18    A    A    -    A    A        3\n\n19    A    A    B    A    B        2\n\n20    A    A    -    A    A        3\n</code></pre>\n\n<p>Any idea ? </p>\n"},{"tags":["r","ggplot2","label","histogram"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":245,"score":2,"question_id":11404531,"title":"R: ggplot2: Adding count labels to histogram with density overlay","body":"<p>I have a time-series that I'm examining for data heterogeneity, and wish to explain some important facets of this to some data analysts. I have a density histogram overlayed by a KDE plot (in order to see both plots obviously). However the original data are counts, and I want to place the count values as labels above the histogram bars.</p>\n\n<p>Here is some code:</p>\n\n<pre><code>$tix_hist &lt;- ggplot(tix, aes(x=Tix_Cnt)) \n             + geom_histogram(aes(y = ..density..), colour=\"black\", fill=\"orange\", binwidth=50) \n             + xlab(\"Bin\") + ylab(\"Density\") + geom_density(aes(y = ..density..),fill=NA, colour=\"blue\") \n             + scale_x_continuous(breaks=seq(1,1700,by=100))\n\n    tix_hist + opts(\n       title = \"Ticket Density To-Date\",\n       plot.title = theme_text(face=\"bold\", size=18), \n       axis.title.x = theme_text(face=\"bold\", size=16),\n       axis.title.y = theme_text(face=\"bold\", size=14, angle=90),\n       axis.text.x = theme_text(face=\"bold\", size=14),\n       axis.text.y = theme_text(face=\"bold\", size=14)\n           )\n</code></pre>\n\n<p>I thought about extrapolating count values using KDE bandwidth, etc, . Is it possible to data frame the numeric output of a ggplot frequency histogram and add this as a 'layer'. I'm not savvy on the layer() function yet, but any ideas would be helpful. Many thanks!</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":6,"view_count":92,"score":-4,"question_id":10476933,"title":"How to find the number of system drives using R?","body":"<p>Using R, I want to find the number of system drives available on computer &amp; external flash drives attached to it.</p>\n"},{"tags":["r","statistics","princomp"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12760108,"title":"Principal Components Analysis - how to get the contribution (%) of each parameter to a Prin.Comp.?","body":"<p>I want to know to what degree a measurement/parameter contributes to one of the calculated principal components.</p>\n\n<p>A real-world description:</p>\n\n<ol>\n<li>i've got five climatic parameters to the geographic distribution of a species</li>\n<li>i performed a PCA with these five parameters</li>\n<li>the plot of the PC1 vs. PC2 shows an interesting pattern</li>\n</ol>\n\n<p>Question: How do I get the percentage of contribution (of each parameter) to each PC?</p>\n\n<p>What I expect: PC1 is composed to 30% of parameter1, to 50% of parameter2, to 20% of parameter3, 0% of parameter4 and 0% of parameter5. PC2 is composed...</p>\n\n<p>An example with 5 dummy-parameters:</p>\n\n<pre><code>a &lt;- rnorm(10, 50, 20)\nb &lt;- seq(10, 100, 10)\nc &lt;- seq(88, 10, -8)\nd &lt;- rep(seq(3, 16, 3), 2)\ne &lt;- rnorm(10, 61, 27)\n\nmy_table &lt;- data.frame(a, b, c, d, e)\n\npca &lt;- princomp(my_table, cor=T)\n\nbiplot(pca) # same: plot(pca$scores[,1], pca$scores[,2])\n\npca\nsummary(pca)\n</code></pre>\n\n<p>Where is my information hidden?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":129,"score":0,"question_id":12758075,"title":"How to create dummy variables?","body":"<p>I have a variable that is a factor :</p>\n\n<pre><code> $ year           : Factor w/ 8 levels \"2003\",\"2004\",..: 4 6 4 2 4 1 3 3 7 2 ...\n</code></pre>\n\n<p>I would like to create 8 dummy variables, named \"2003\", \"2004\" etc that take the value 0 or 1 depending on the value that the variable \"year\" takes. The nearest I could come up with is</p>\n\n<pre><code>dt1 &lt;- cbind (dt1, model.matrix(~dt1$year - 1) )\n</code></pre>\n\n<p>But this has the unfortunate consequences of</p>\n\n<ol>\n<li>The dummy variables are named dt1$year2003, not just \"2003\", \"2004\" etc</li>\n<li>It seems that NA rows are omitted altogether by <code>model.matrix</code> (so the above command fails due to different lengths when NA is present in the <code>year</code> variable).</li>\n</ol>\n\n<p>Of course I can get around these problems with more code, but I like my code to be as concise as possible (within reason) so if anyone can suggest better ways to make the dummy variables I would be obliged.</p>\n"},{"tags":["c","r","rcpp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12753304,"title":"Returning an output from a .C call in R","body":"<p>In the documentation for the <code>.C</code> function in R <a href=\"http://cran.r-project.org/doc/manuals/R-exts.html#Interface-functions-_002eC-and-_002eFortran\" rel=\"nofollow\">here</a>, it says that the C function itself must be of return type <code>void</code>.  I'm working on some inherited code that uses the <code>.C</code> function (rather than <code>.Call</code> or Rcpp), but I'd like to write a function that \"returns\" a vector of unknown size.  If I knew the size of this vector, I could allocate it in R and pass the pointer to C, whose contents can then be modified.  Given that I don't know its size, what is the way to declare it in R?  I imagine it will have this shape, but I don't know the details:</p>\n\n<pre><code>output &lt;- ?????\nstorage.mode(a) &lt;- \"integer\"\ntmp &lt;- .C(\"myfunc\",a,output)\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12759537,"title":"R: Constructing a table from three dataframes of equal columns but different names","body":"<p>I have three dataframes of variable row length:</p>\n\n<pre><code>df1 (column names a,b,c)\n\ndf2 (column names d,e,f)\n\ndf3 (column names g,h,i)\n</code></pre>\n\n<p>How can I combine them into one table \n(one dataframe under the other)</p>\n\n<pre><code>table.all &lt;- rbind(df1,df2,df3)\n</code></pre>\n\n<p>only works for same column names but my column names are different.</p>\n\n<p>Then save this table to a csv: </p>\n\n<pre><code>write.csv(table.all ,\"table.all .csv\")\n</code></pre>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12759367,"title":"How to view value of a variable inside a function?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4442518/general-suggestions-for-debugging-r\">General suggestions for debugging R?</a>  </p>\n</blockquote>\n\n\n\n<p>When debugging, I would often like to know the value of a variable used in a function that has completed executing. How can that be achieved?</p>\n\n<p>Example:</p>\n\n<p>I have function:</p>\n\n<pre><code>MyFunction &lt;- function() {\n    x &lt;- rnorm(10) # assign 10 random normal numbers to x\n    return(mean(x))\n}\n</code></pre>\n\n<p>I would like to know the values stored in <strong>x</strong> which are not available to me after the function is done executing and the function's environment is cleaned up.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12759590,"title":"how to do predictions from cox survival model with time varying coefficients","body":"<p>I have built a survival cox-model, which includes a covariate * time interaction. (non-proportionality detected)\nI am now wondering how could I most easily get survival predictions from my model.</p>\n\n<p>My model was specified:</p>\n\n<pre><code>coxph(formula = Surv(event_time_mod, event_indicator_mod) ~ Sex + \nageC + HHcat_alt + Main_Branch + Acute_seizure + TreatmentType_binary + \nICH + IVH_dummy + IVH_dummy:log(event_time_mod) \n</code></pre>\n\n<p>And now I was hoping to get a prediction using survfit and providing new.data for the combination of variables I am doing the predictions:</p>\n\n<pre><code>survfit(cox, new.data=new)\n</code></pre>\n\n<p>Now as I have event_time_mod in the right-hand side in my model I need to specify it in the new data frame passed on \nto survfit. This event_time would need to be set at individual times of the predictions. Is there an easy way to specify event_time_mod to be the correct time to  survfit?\nOr are there any other options for achieving predictions from my model?</p>\n\n<p>Of course I could create as many rows in the new data frame as there are distinct times in the predictions and setting to event_time_mod to correct values but it feels really cumbersome and I thought that there must be a better way.</p>\n"},{"tags":["string","r","loops","data.frame"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":87,"score":0,"question_id":12720643,"title":"Loop over each line and store each word in a line and make a data frame in R","body":"<p>I have the following file:</p>\n\n<pre><code>[1]/tI /tam /tCharlotte   \n[2]/ti /tam /tcharlotte   \n[3]/tYou /tare /tsmart  \n[4]/tyou /tare /tsmart  \n</code></pre>\n\n<p>And I want the output data frame to have the following form:</p>\n\n<pre><code>word      gloss  \nI         i  \nam        am      \nCharlotte charlotte    \nYou       you    \nare       are    \nsmart     smart    \n</code></pre>\n\n<p>Is it possible to write a code for that? Do I need to separate the file by tab? </p>\n"},{"tags":["python","r","bioconductor"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":5,"view_count":78,"score":-5,"question_id":12759318,"title":"How to generate unique random lists","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12754724/random-sampling-a-list-of-genes\">Random sampling a list of genes</a>  </p>\n</blockquote>\n\n\n\n<p>I would like to create 1000 random lists of 1652 genes from a universe of 19.000 genes. I decided to replace since the universe is not so big. The only condition is that lists can contain similar genes between them (due to replacement) but each list can not contain a gene more than one time. So it will be unique in the single list. Any suggestion about this?</p>\n\n<p>Ex: Universe = letters[1:26]</p>\n\n<p>Desired output:</p>\n\n<blockquote>\n<pre><code> [[1]]  [[2]]   [[3]]   [[...]]\n   a      b       f\n   b      c       a\n   c      d       b\n   f      z       j\n   h      j       o\n</code></pre>\n</blockquote>\n\n<p>I would like avoid a situation like:</p>\n\n<blockquote>\n<pre><code> [[1]]  [[...]]\n  a   \n  a   \n  b   \n  c\n  c\n</code></pre>\n</blockquote>\n\n<p>Since the universe is not so big I cannot set REPLACE = F. If I set REPLACE = T, replicated elements occur in the list...this is what I'm trying to avoid for my analysis.</p>\n\n<p>Thanks in advance</p>\n\n<p>E.</p>\n"},{"tags":["r"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":481,"score":4,"question_id":11022675,"title":"Rotate histogram in R or overlay a density in a barplot","body":"<p>I would like to rotate a histogram in R, plotted by hist(). The question is not new, and in several forums I have found that it is not possible. However, all these answers date back to 2010 or even later.</p>\n\n<p>Has anyone found a solution meanwhile?</p>\n\n<p>One way to get around the problem is to plot the histogram via barplot() that offers the option \"horiz=TRUE\". The plot works fine but I fail to overlay a density in the barplots. The problem probably lies in the x-axis since in the vertical plot, the density is centered in the first bin, while in the horizontal plot the density curve is messed up.</p>\n\n<p>Any help is very much appreciated!</p>\n\n<p>Thanks,</p>\n\n<p>Niels</p>\n\n<p>Code:</p>\n\n<pre><code>require(MASS)\nSigma &lt;- matrix(c(2.25, 0.8, 0.8, 1), 2, 2)\nmvnorm &lt;- mvrnorm(1000, c(0,0), Sigma)\n\nscatterHist.Norm &lt;- function(x,y) {\n zones &lt;- matrix(c(2,0,1,3), ncol=2, byrow=TRUE)\n layout(zones, widths=c(2/3,1/3), heights=c(1/3,2/3))\n xrange &lt;- range(x) ; yrange &lt;- range(y)\n par(mar=c(3,3,1,1))\n plot(x, y, xlim=xrange, ylim=yrange, xlab=\"\", ylab=\"\", cex=0.5)\n xhist &lt;- hist(x, plot=FALSE, breaks=seq(from=min(x), to=max(x), length.out=20))\n yhist &lt;- hist(y, plot=FALSE, breaks=seq(from=min(y), to=max(y), length.out=20))\n top &lt;- max(c(xhist$counts, yhist$counts))\n par(mar=c(0,3,1,1))\n plot(xhist, axes=FALSE, ylim=c(0,top), main=\"\", col=\"grey\")\n x.xfit &lt;- seq(min(x),max(x),length.out=40)\n x.yfit &lt;- dnorm(x.xfit,mean=mean(x),sd=sd(x))\n x.yfit &lt;- x.yfit*diff(xhist$mids[1:2])*length(x)\n lines(x.xfit, x.yfit, col=\"red\")\n par(mar=c(0,3,1,1))\n plot(yhist, axes=FALSE, ylim=c(0,top), main=\"\", col=\"grey\", horiz=TRUE)\n y.xfit &lt;- seq(min(x),max(x),length.out=40)\n y.yfit &lt;- dnorm(y.xfit,mean=mean(x),sd=sd(x))\n y.yfit &lt;- y.yfit*diff(yhist$mids[1:2])*length(x)\n lines(y.xfit, y.yfit, col=\"red\")\n}\nscatterHist.Norm(mvnorm[,1], mvnorm[,2])\n\n\nscatterBar.Norm &lt;- function(x,y) {\n zones &lt;- matrix(c(2,0,1,3), ncol=2, byrow=TRUE)\n layout(zones, widths=c(2/3,1/3), heights=c(1/3,2/3))\n xrange &lt;- range(x) ; yrange &lt;- range(y)\n par(mar=c(3,3,1,1))\n plot(x, y, xlim=xrange, ylim=yrange, xlab=\"\", ylab=\"\", cex=0.5)\n xhist &lt;- hist(x, plot=FALSE, breaks=seq(from=min(x), to=max(x), length.out=20))\n yhist &lt;- hist(y, plot=FALSE, breaks=seq(from=min(y), to=max(y), length.out=20))\n top &lt;- max(c(xhist$counts, yhist$counts))\n par(mar=c(0,3,1,1))\n barplot(xhist$counts, axes=FALSE, ylim=c(0, top), space=0)\n x.xfit &lt;- seq(min(x),max(x),length.out=40)\n x.yfit &lt;- dnorm(x.xfit,mean=mean(x),sd=sd(x))\n x.yfit &lt;- x.yfit*diff(xhist$mids[1:2])*length(x)\n lines(x.xfit, x.yfit, col=\"red\")\n par(mar=c(3,0,1,1))\n barplot(yhist$counts, axes=FALSE, xlim=c(0, top), space=0, horiz=TRUE)\n y.xfit &lt;- seq(min(x),max(x),length.out=40)\n y.yfit &lt;- dnorm(y.xfit,mean=mean(x),sd=sd(x))\n y.yfit &lt;- y.yfit*diff(yhist$mids[1:2])*length(x)\n lines(y.xfit, y.yfit, col=\"red\")\n}\nscatterBar.Norm(mvnorm[,1], mvnorm[,2])\n</code></pre>\n\n#\n\n<p>Source of scatter plot with marginal histograms (click first link after \"adapted from...\"):</p>\n\n<p><a href=\"http://r.789695.n4.nabble.com/newbie-scatterplot-with-marginal-histograms-done-and-axes-labels-td872589.html\" rel=\"nofollow\">http://r.789695.n4.nabble.com/newbie-scatterplot-with-marginal-histograms-done-and-axes-labels-td872589.html</a></p>\n\n<p>Source of density in a scatter plot:</p>\n\n<p><a href=\"http://www.statmethods.net/graphs/density.html\" rel=\"nofollow\">http://www.statmethods.net/graphs/density.html</a></p>\n"},{"tags":["r","hadoop","streaming"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":140,"score":1,"question_id":11143406,"title":"Temporarily installing R packages on Hadoop nodes for streaming jobs","body":"<p>I have access to a Hadoop cluster that has base R (2.14.1) but no additional packages installed in every node. I've been writing base R mapper and reducer streaming scripts to get around the fact that I have no additional packages. However, I've come to a point where I need to use certain packages, rjson mainly, as part of my scripts.</p>\n\n<p>I don't have admin privileges on the cluster, and the user accounts are fairly restricted. Having the cluster admins install the package on every node is not an option (for now), and the cluster has no external internet access.</p>\n\n<p>I've uploaded the rjson_0.2.8.tar.gz source file to my gateway node. Is it possible to install R packages temporarily by adding <code>install.packages(\"rjson_0.2.8.tar.gz\", repos = NULL, lib = /tmp)</code> or something along those lines, such that the package is intalled when the script starts, and pass the source via the -cacheArchive parameter of the streaming job? I'd like the package to be installed in a temp location such that it dissapears when the job is complete.</p>\n\n<p>Is this even possible?</p>\n\n<p>I know I'll get some \"use python\" answers since it's for processing JSON, which is an option, but the question is for any package. :)</p>\n"},{"tags":["python","perl","r","unix","bioconductor"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":10,"view_count":145,"score":-10,"question_id":12754724,"title":"Random sampling a list of genes","body":"<p>I would like to create 1000 random lists of 1652 genes from a universe of 19.000 genes. I decided to replace since the universe is not so big. The only condition is that lists can contain similar genes between them (due to replacement) but each list can not contain a gene more than one time. So it will be unique in the single list.\nAny suggestion about this?</p>\n\n<p>Ex: Universe = letters[1:26]</p>\n\n<p>Desired output:</p>\n\n<blockquote>\n<pre><code> [[1]]  [[2]]   [[3]]   [[...]]\n   a      b       f\n   b      c       a\n   c      d       b\n   f      z       j\n   h      j       o\n</code></pre>\n</blockquote>\n\n<p>I would like avoid a situation like:</p>\n\n<blockquote>\n<pre><code> [[1]]  [[...]]\n  a   \n  a   \n  b   \n  c\n  c\n</code></pre>\n</blockquote>\n\n<p>Since the universe is not so big I cannot set REPLACE = F.  If I set REPLACE = T, replicated elements occur in the list...this is what I'm trying to avoid for my analysis.</p>\n\n<p>Thanks in advance</p>\n\n<p>E.</p>\n"},{"tags":["apache","r","cookies","rapache"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":11267908,"title":"How to retrieve a cookie in R Apache","body":"<p>How do I get the cookie's value in R-Apache?</p>\n\n<p>I set the cookie in my html code using brew\n:</p>\n\n<p><code>setCookie(name=\"ID\",value=paste(sample(1:9999,1)))</code></p>\n\n<p>My page has a form that sends post data to my R code. How would I be able to retrieve this cookie in the R code?</p>\n\n<p>Thanks!</p>\n"},{"tags":["r","loops","while-loop"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":91,"score":1,"question_id":12755872,"title":"How to use while loop in R to generate a matrix with specific number?","body":"<p>I have generate a matrix by using the following <em>for</em> loop. <br>\nAnd now I am trying to generate a same matrix using <em>while</em> loop but don't know how to do so. <br>\nCan anyone help with this? Thank you so much.</p>\n\n<pre><code>i&lt;- 1\nj&lt;- 1\nm1&lt;- matrix(0, nrow=5, ncol=5)\nfor(i in 1:5) {\nfor(j in i:5) {\nm1[i,j]&lt;- (j-i)*2+1\n}\n}\nm1\n</code></pre>\n"},{"tags":["r","data.frame","variable-assignment","data.table"],"answer_count":1,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":117,"score":5,"question_id":11680579,"title":"assign multiple columns using := in data.table, by group","body":"<p>What is the best way to assign to multiple columns using <code>data.table</code>? For example:</p>\n\n<pre><code>f &lt;- function(x) {c(\"hi\", \"hello\")}\nx &lt;- data.table(id=1:10)\n</code></pre>\n\n<p>I would like to do something liket his (of course this syntax is incorrect):</p>\n\n<pre><code>x[,(col1, col2):=f(), by=\"id]\n</code></pre>\n\n<p>And to extend that I make have many columns with names in a variable (say <code>column_names</code>) and I would like to do:</p>\n\n<pre><code>x[,col_names:=another_f(), by=\"id\", with=FALSE]\n</code></pre>\n\n<p>What is the correct way to do something like this?  </p>\n"},{"tags":["r","variance"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12758508,"title":"Residual variance extracted from glm and lmer in R","body":"<p>I am trying to take what I have read about multilevel modelling and merge it with what I know about <code>glm</code> in R. I am now using the height growth data from <a href=\"http://www.bristol.ac.uk/cmm/learning/support/datasets/\" rel=\"nofollow\">here</a>.</p>\n\n<p>I have done some coding shown below:</p>\n\n<pre><code>library(lme4)\nlibrary(ggplot2)\n\nsetwd(\"~/Documents/r_code/multilevel_modelling/\")\n\nrm(list=ls())\n\noxford.df &lt;- read.fwf(\"oxboys/OXBOYS.DAT\",widths=c(2,7,6,1))\nnames(oxford.df) &lt;- c(\"stu_code\",\"age_central\",\"height\",\"occasion_id\")\noxford.df &lt;- oxford.df[!is.na(oxford.df[,\"age_central\"]),]\noxford.df[,\"stu_code\"] &lt;- factor(as.character(oxford.df[,\"stu_code\"]))\noxford.df[,\"dummy\"] &lt;- 1\n\nchart &lt;- ggplot(data=oxford.df,aes(x=occasion_id,y=height))\nchart &lt;- chart + geom_point(aes(colour=stu_code))\n\n# see if lm and glm give the same estimate\nglm.01 &lt;- lm(height~age_central+occasion_id,data=oxford.df)\nglm.02 &lt;- glm(height~age_central+occasion_id,data=oxford.df,family=\"gaussian\")\nsummary(glm.02)\nvcov(glm.02)\nvar(glm.02$residual)\n(logLik(glm.01)*-2)-(logLik(glm.02)*-2)\n1-pchisq(-2.273737e-13,1)\n# lm and glm give the same estimation\n# so glm.02 will be used from now on\n\n# see if lmer without level2 variable give same result as glm.02\nmlm.03 &lt;- lmer(height~age_central+occasion_id+(1|dummy),data=oxford.df,REML=FALSE)\n(logLik(glm.02)*-2)-(logLik(mlm.03)*-2)\n# 1-pchisq(-3.408097e-07,1)\n# glm.02 and mlm.03 give the same estimation, only if REML=FALSE\n</code></pre>\n\n<p><code>mlm.03</code> gives me the following output:</p>\n\n<pre><code>&gt; mlm.03\nLinear mixed model fit by maximum likelihood \nFormula: height ~ age_central + occasion_id + (1 | dummy) \n   Data: oxford.df \n  AIC  BIC logLik deviance REMLdev\n 1650 1667 -819.9     1640    1633\nRandom effects:\n Groups   Name        Variance Std.Dev.\n dummy    (Intercept)  0.000   0.0000  \n Residual             64.712   8.0444  \nNumber of obs: 234, groups: dummy, 1\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  142.994     21.132   6.767\nage_central    1.340     17.183   0.078\noccasion_id    1.299      4.303   0.302\n\nCorrelation of Fixed Effects:\n            (Intr) ag_cnt\nage_central  0.999       \noccasion_id -1.000 -0.999\n</code></pre>\n\n<p>You can see that there is a variance for the residual in the <code>random effect</code> section, which I have read from <code>Applied Multilevel Analysis - A Practical Guide</code> by Jos W.R. Twisk, that this represents the amount of \"unexplained variance\" from the model.</p>\n\n<p>I wondered if I could arrive at the same residual variance from <code>glm.02</code>, so I tried the following:</p>\n\n<pre><code>&gt; var(resid(glm.01))\n[1] 64.98952\n&gt; sd(resid(glm.01))\n[1] 8.061608\n</code></pre>\n\n<p>The results are slightly different from the <code>mlm.03</code> output. Does this refer to the same \"residual variance\" stated in <code>mlm.03</code>?</p>\n"},{"tags":["r","data.table"],"answer_count":2,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":167,"score":8,"question_id":11745169,"title":"dynamic column names in data.table, R","body":"<p>i am trying to add columns to my <code>data.table</code>, where the names are dynamic. i addition i need to use the <code>by</code> argument when adding these columns.  for example:</p>\n\n<pre><code>test_dtb &lt;- data.table(a=sample(1:100, 100), b=sample(1:100, 100), id=rep(1:10,10))\ncn &lt;- parse(text=\"blah\")\ntest_dtb[,eval(cn):=mean(a), by=id]\n\nError in `[.data.table`(test_dtb, , `:=`(eval(cn), mean(a)), by = id) : \n  LHS of := must be a single column name when with=TRUE. When with=FALSE the LHS may be a vector of column names or positions.\n</code></pre>\n\n<p>Another attempt:</p>\n\n<pre><code>cn &lt;- \"blah\"\ntest_dtb[,cn:=mean(a), by=id, with=FALSE]\nError in `[.data.table`(test_dtb, , `:=`(cn, mean(a)), by = id, with = FALSE) : 'with' must be TRUE when 'by' or 'keyby' is provided\n</code></pre>\n\n<hr>\n\n<p><strong>Update from Matthew:</strong></p>\n\n<p>This now works in v1.8.3 on R-Forge. Thanks for highlighting!<br>\nSee this similar question for new examples :</p>\n\n<p><a href=\"http://stackoverflow.com/questions/11680579/assign-multiple-columns-using-in-data-table-by-group\">Assign multiple columns using data.table, by group</a></p>\n"},{"tags":["r","variable-scope"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":12750923,"title":"Conflict of variables in R language","body":"<p>I have a script of R which takes other scripts of R and manipulates them in such a way, and also executes their code. My script uses some variables (obviously), and when the other scripts use a common variable name, I get in a mess. I wish I could execute the other script like in a capsule, such that the coinciding variables do not affect each other.</p>\n\n<p>I have been reading about environments, and have made a lot of trials, but I don't catch their real meaning.</p>\n\n<p>Example:</p>\n\n<pre><code>script1.txt\n___________\ni=sample(10:20,1)\n\nscript2.txt\n___________\ni=sample(10:20,1) \n\nmyscript.txt\n___________\nother.script = c(\"script1.txt\", \"script2.txt\")\nfor( i in 1:2 ) {\n    source(other.script[i])\n}\ni==2\n</code></pre>\n\n<p>I wish each variable \"i\" does its duty without affecting the other ones (specially the one in myscript, I don't care much about the other ones).</p>\n"},{"tags":["r","time-series","forecasting","volatility"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12757141,"title":"volatility forecasting using GARCH","body":"<p>I have the log returns of closing prices and am trying to use GARCH(1,1) model to forecast volatility of these log returns. So, far I have the following code, but I get incorrect values for my forecast.</p>\n\n<pre><code>library(quantmod) \nlibrary(tseries) \nlibrary(fGarch)\n\nr = Data[indexStart:indexEnd] # Log Returns\nfgarch.fitted = fGarch::garchFit(~ garch(1,1), data = as.zoo(na.omit(r)),trace = FALSE) \npredict(fgarch.fitted, n.ahead = 1,doplot=F)[3]\n</code></pre>\n"},{"tags":["r","ggplot2","data.frame","histogram"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":99,"score":-1,"question_id":12744757,"title":"histogram for data frame binned data","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2546016/how-to-define-fill-colours-in-ggplot-histogram\">how to define fill colours in ggplot histogram?</a>  </p>\n</blockquote>\n\n\n\n<p>I want to plot (histogram) counts of fishes per length class from a data frame which summarize this information in a binned format (data.frame(...,length=length, counts=N)). I'm a new user of ggplot2, but seems It could be a good choice. Can I create this histogram from a data.frame object?</p>\n\n<p>Sorry for being so brief, Here is the structure of a piece of df,</p>\n\n<pre><code>'data.frame':   416 obs. of  3 variables:\n $ specie: Factor w/ 1 level \"speciesA\": 1 1 1 1 1 1 1 1 1 1 ...\n $ length: num  34.5 35 35.5 36 36.5 37 37.5 38 38.5 39 ...\n $ Counts: num  2 0 0 0 1 0 1 1 0 1 ...\n</code></pre>\n\n<p>In this case, fishers catch 2 individuals 34.5 cm large, 1 36.5, and so on...\nThank you very much for your answers</p>\n"},{"tags":["r","subset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12755397,"title":"Subsetting R array: dimension lost when its length is 1","body":"<p>When subsetting arrays, R behaves differently depending on whether one of the dimensions is of length 1 or not.  If a dimension has length 1, that dimension is lost during subsetting:</p>\n\n<pre><code>ax &lt;- array(1:24, c(2,3,4))\nay &lt;- array(1:12, c(1,3,4))\ndim(ax)\n#[1] 2 3 4\ndim(ay)\n#[1] 1 3 4\ndim(ax[,1:2,])\n#[1] 2 2 4\ndim(ay[,1:2,])\n#[1] 2 4\n</code></pre>\n\n<p>From my point of view, ax and ay are the same, and performing the same subset operation on them should return an array with the same dimensions.  I can see that the way that R is handling the two cases might be useful, but it's undesirable in the code that I'm writing.  It means that when I pass a subsetted array to another function, the function will get an array that's missing a dimension, if I happened to reduce a dimension to length 1 at an earlier stage.  (So in this case R's flexibility is making my code less flexible!)</p>\n\n<p>How can I prevent R from losing a dimension of length 1 during subsetting?  Is there another way of indexing?  Some flag to set?</p>\n"},{"tags":["regex","r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":7,"view_count":93,"score":-7,"question_id":12756233,"title":"Regular expression in R : \"^\\\\.[t$]\" ","body":"<pre><code>&gt; x=c(\".\",\"..\",\".test.\",\".test\",\"tyu\",\".t\")\n&gt; x\n[1] \".\"      \"..\"     \".test.\" \".test\"  \"tyu\"    \".t\"   \n&gt;y1=x[grep(\"^\\\\.[t$]\",x)]\n&gt; y1\n[1] \".test.\" \".test\"  \".t\"  \n</code></pre>\n\n<p>Why does y1 contain  <code>.test.</code>? </p>\n\n<p>y1: start with . and  end with t  . </p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":80,"score":3,"question_id":12755642,"title":"Visually Inspecting Data in R","body":"<p>First I want to point I am a very visual person, and so I would like to see the time series data I have in cells when I load it into R. I know I can use the Fix(data) command to vizually inspect the data in cells but what If have a single data vector.</p>\n\n<p>How do I get R to show a single time series data vector in cells? Everytime I use the fix(singlevariable) it shows it akwardly as C(.....).</p>\n\n<p>How do I show two or more data series in R in a cell visual format? I cant say fix(variable1, variable2)</p>\n\n<p>Help! Thank you!</p>\n"},{"tags":["r","search"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":69,"score":3,"question_id":12738746,"title":"Searching for functions in R library","body":"<p>New to the forum. Is there a way to search for functions within a particular library in R?</p>\n\n<p>Lets say I would like a list of all the functions in the \"graphics\" library. How would do that?</p>\n\n<p>If I want to find the specific documentation on the \"plot\" command I am having trouble finding the documentation when I used the help.search(\"plot\"). It gives me all these other functions from different libraries. I just want to be able to find and narrow down the searches when I look for a particular function.</p>\n"},{"tags":["r","matlab"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":53,"score":-3,"question_id":12754703,"title":"Using matlab mex files with R","body":"<p>I would want to use a certain function written in c for use with matlab, with the mex system.\nAny ideas/experience about how to port this to R?</p>\n\n<p>Since comments say this is to vague, some detail. There is a certain well-written matlab function I need for use with R (All the rest of my code are in R). This function have an empty\nm-file, only documentation. All the work is in the corresponding .c-file, but this is c-code written specifically for use with matlab, so contains a lot of calls to mx-functions, which I understand are hooks into the inner life of matlab. </p>\n\n<p>The suggestion to communicate via data files will not work, I need this function within an iterative algorithm. </p>\n"},{"tags":["r","data.table"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":166,"score":5,"question_id":12055146,"title":"add multiple columns to subset of data.table with :=","body":"<p>my question is an extension to the previously answered one here:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/11308754/add-multiple-columns-to-r-data-table-in-one-function-call\">Add multiple columns to R data.table in one function call?</a></p>\n\n<p>I'm having problems assigning multiple new columns if the data.table has a key according to which I subset. Example:</p>\n\n<pre><code>library(data.table)\nexample(data.table)\nDT[J(\"a\")]\n   x y  v  m\n1: a 1 42 42\n2: a 3 42 42\n3: a 6 42 42\n</code></pre>\n\n<p>i.e. DT has a <code>key(DT) = c(\"x\", \"y\")</code>, and I want to assign 2 new columns <code>new1</code> and <code>new2</code> in one call, similar to the above solution. I do this:</p>\n\n<pre><code>DT[J(\"a\"),c(\"new1\",\"new2\") := list(c(1,2,3),c(3,2,1)),with=FALSE]\n</code></pre>\n\n<p>but I get that</p>\n\n<pre><code>   x y  v  m new1\n1: a 1 42 42    1\n2: a 3 42 42    2\n3: a 6 42 42    3\n4: b 1  4  5   NA\n5: b 3  5  5   NA\n6: b 6  6  5   NA\n7: c 1  7  8   NA\n8: c 3  8  8   NA\n9: c 6  9  8   NA\n</code></pre>\n\n<p>i.e. behaviour as expected (assign values to where x==a, NA else), but only for the first column. Is that my mistake or is it a bug?</p>\n\n<p>Notice that without subsetting DT, this works perfectly:</p>\n\n<pre><code>DT[,c(\"new1\",\"new2\") := list(c(1,2,3),c(3,2,1)),with=FALSE]\n   x y  v  m new1 new2\n1: a 1 42 42    1    3\n2: a 3 42 42    2    2\n3: a 6 42 42    3    1\n4: b 1  4  5    1    3\n5: b 3  5  5    2    2\n6: b 6  6  5    3    1\n7: c 1  7  8    1    3\n8: c 3  8  8    2    2\n9: c 6  9  8    3    1\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12754420,"title":"C function resulting in rounded number","body":"<p><strong>The case</strong></p>\n\n<p>I have compiled shared library for dyn.loading into R. Then when I call the wrapper function in R I get result rounded with truncated part after decimal point. I am probably missing something well known as it is my first try to use .C function, but I can't find what is the cause of rounding. There is my code below.</p>\n\n<p><strong>My C code</strong></p>\n\n<pre><code>#include &lt;freesteam/steam_pT.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;R.h&gt;\n\n// gcc -Wall -fPIC -c Rsteam_h_pT_2.c -o  Rsteam_h_pT_2.o -I/usr/local/include -I/opt/R-2.14.0/lib/R/include -L/usr/local/lib -lfreesteam\n// gcc -Wall -shared -o Rsteam_h_pT_2.so Rsteam_h_pT_2.o -I/usr/local/include -I/opt/R-2.14.0/lib/R/include -L/usr/local/lib -lfreesteam\n\n// function\ndouble steam_h_pT(double p, double T){\nSteamState S = freesteam_set_pT(p, T);\ndouble s = freesteam_h(S);\nreturn s;\n}\n\n\n// wrapper\ndouble steam_h_pT(double, double);\nvoid steam_h_pT_R_wrapper(double *p, double *T, double *result) { *result = steam_h_pT(*p, *T); }\n</code></pre>\n\n<p><strong>My R function</strong></p>\n\n<pre><code>steam_h_pT &lt;- function(p_Pa,T_K)\n {\n dyn.load('Rsteam_h_pT.so')\n # Call the C function\n returned_data = .C('steam_h_pT_R_wrapper', p=as.numeric(p_Pa), T= as.numeric(T_K), result=numeric(1))\n # Return the value of the result parameter\n return(returned_data$result)\n }\n</code></pre>\n\n<p><strong>My R session</strong></p>\n\n<pre><code>&gt; steam_h_pT(100000,400)\n[1] 2730398\n&gt; str(steam_h_pT(100000,400))\nnum 2730398\n&gt; \n</code></pre>\n\n<p><strong>Expected result from original code</strong></p>\n\n<pre><code>bash&gt;./steam_h_pT 1e5 400\n2730397.845968\n</code></pre>\n\n<p><strong>Now, why it gets rounded in R?</strong></p>\n"},{"tags":["r","mean"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":62,"score":4,"question_id":12754054,"title":"Column of static mean for n rows","body":"<p>Given a data frame with two columns, I'm looking to calculate a third column which would contain the mean for every n number of rows while keeping the data frame intact. </p>\n\n<p>Given the data frame</p>\n\n<pre><code> index&lt;-1:20\n V&lt;-c(2,5,7,4,8,9,4,6,8,NA,3,4,5,6,0,4,5,7,5,3)\n DF&lt;-data.frame(index,V)\n</code></pre>\n\n<p>How could I create DF$mean which would be the non-rolling mean of every 5 rows. </p>\n\n<pre><code>   index V  mean\n      1 2    5.2\n      2 5    5.2\n      3 7    5.2\n      4 4    5.2\n      5 8    5.2\n      6 9    6.75\n      7 4    6.75    \n      8 6    6.75    \n      9 8    6.75    \n     10 NA   6.75  \n     11 3    3.6\n     12 4    3.6\n     13 5    3.6\n     14 6    3.6 \n     15 0    3.6\n     16 4    4.8\n     17 5    4.8\n     18 7    4.8\n     19 5    4.8\n     20 3    4.8\n</code></pre>\n"},{"tags":["ruby","arrays","r","math","vector"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":2,"view_count":99,"score":2,"question_id":12753419,"title":"Are arrays in Ruby and similarly typed languages vectors?","body":"<p>R wraps csv'd lists of numbers (comma separated values i.e. <code>1, 2, 3</code>) in the <code>c()</code> function, a part of the R core library, which converts csv'd lists of numbers into vectors.</p>\n\n<p>These vectors look like Ruby or Java arrays, with the exception that these csv'd lists are wrapped in <code>c()</code> rather than <code>[]</code>. It seems like arrays are really a subset of vectors. Is it true? And if so, what does this mean when it comes to arrays and matrices?</p>\n\n<p>One discussion on the subject I found stated that arrays are static vectors. But in Ruby, arrays aren't static. In Ruby, arrays are vectors?</p>\n"},{"tags":["r","pdf","ggplot2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12696554,"title":"ggplot2 colors change brightness levels when saved in PDF","body":"<p>I'm having problem when I save ggplot2 charts to PDF. It seems that color looses its brightness when saved. </p>\n\n<p>Problem is that it doesn't always happen, i.e. in the same PDF report same green color will be bright on one page and on the next page it will be darker. Colors represent same variable and this might lead to some confusion. I don't really care that they look darker in PDF, I would like to do it consistently and not change from page to page. \nAlpha levels are not changed (default) - I verified it. \nSame is true for fonts, in PDF sometimes they are bolder that on screen, again for some charts, on one page it will be normal, on the other one bolder.  </p>\n\n<p>What causing it and any suggestions on how to fix it?</p>\n\n<p>I'm running R version 2.15.1, and ggplot2 0.9.2.1 on windows XP</p>\n\n<p>UPDATE:\nAfter trying to create example - I found the reason, using image on first page. \nHere is the code:</p>\n\n<pre><code>library(ggplot2)\nlibrary(scales)\nlibrary(png)\nlibrary(grid)\n\ndata.set &lt;- \n  data.frame(year = c(2010, 2010, 2011,2011, 2012, 2012),\n            overtime = c('TRUE', 'FALSE', 'TRUE', 'FALSE', 'TRUE', 'FALSE'),\n            value = c(100, 200, 150, 250, 50, 75))\n\n  logo &lt;-  readPNG(system.file(\"img\", \"Rlogo.png\", package=\"png\"))\n  logo &lt;- rasterGrob(logo, interpolate=TRUE)\n  title.page &lt;-\n    qplot(1:10,1:10, geom = 'blank') +\n    annotation_custom(logo, xmin = 0, xmax = 10, ymin = 8, ymax = 10)\n\n\nmy.chart.1 &lt;- \n  ggplot(data = data.set,\n         aes(x = overtime,\n             y = value, \n             fill = overtime)) + \n  geom_bar(stat=\"identity\")+\n  scale_fill_manual(values = c('green','red'))\n\nmy.chart.2 &lt;- \n  my.chart.1 + \n  facet_wrap(~year)\n\n## NO PROBLEMS\npdf(file='no.problems.pdf')\n  print(my.chart.1)\n  print(my.chart.2)\ndev.off()\n## PROBLEMS WITH COLORS\npdf(file='problems.pdf')\n  print(title.page)\n  print(my.chart.1)\n  print(my.chart.2)\ndev.off()\n</code></pre>\n\n<p>Colors on second and third pages (problems.pdf) will look different.</p>\n"},{"tags":["osx","r","mpich2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12748491,"title":"MPICH2 from macports missing symbols","body":"<p>I'm trying to write a program with Rmpi, unfortunately a symbol required is undefined, and tracking it down with otool and nm seems to just lead me to <code>libmpich.3.3.dylib</code>.  Unfortunately the symbol <code>MPI_Comm_dup</code>, is undefined in this dynamic library.</p>\n\n<p>However, I'm not an expert on OSX dynamic libraries, and am wondering if I am correct in my approach and conclusion.  Furthermore I am open to any suggestions to resolve this issue.</p>\n\n<p>Thanks,</p>\n\n<pre><code>Error : .onLoad failed in loadNamespace() for 'Rmpi', details:\n  call: dyn.load(file, DLLpath = DLLpath, ...)\n  error: unable to load shared object '/home/jonathan.lisic/R/x86_64-apple-darwin12.2.0-library/2.15/Rmpi/libs/x86_64/Rmpi.so':\n  dlopen(/home/jonathan.lisic/R/x86_64-apple-darwin12.2.0-library/2.15/Rmpi/libs/x86_64/Rmpi.so, 6): Symbol not found: _MPI_Comm_dup\n  Referenced from: /opt/local/lib/libmpich.3.3.dylib\n  Expected in: flat namespace\n in /opt/local/lib/libmpich.3.3.dylib\nError: package/namespace load failed for Rmpi\n\njonathan.lisic@server:/opt/local$ otool -L /home/jonathan.lisic/R/x86_64-apple-darwin12.2.0-library/2.15/Rmpi/libs/x86_64/Rmpi.so\n/home/jonathan.lisic/R/x86_64-apple-darwin12.2.0-library/2.15/Rmpi/libs/x86_64/Rmpi.so:\n        Rmpi.so (compatibility version 0.0.0, current version 0.0.0)\n        /opt/local/lib/libmpich.3.3.dylib (compatibility version 0.0.0, current version 3.0.0)\n        /opt/local/lib/libmpl.1.dylib (compatibility version 3.0.0, current version 3.0.0)\n        /opt/local/lib/libopa.1.dylib (compatibility version 2.0.0, current version 2.0.0)\n        /opt/local/lib/R/lib/x86_64/libR.dylib (compatibility version 2.15.0, current version 2.15.1)\n        /usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1669.0.0)\n        /opt/local/lib/gcc45/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)\n        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 169.3.0)\n\njonathan.lisic@server:/opt/local/lib$ otool -L libmpich.dylib\nlibmpich.dylib:\n        /opt/local/lib/libmpich.3.3.dylib (compatibility version 0.0.0, current version 3.0.0)\n        /opt/local/lib/gcc43/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)\n        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 169.3.0)\n\njonathan.lisic@server:/opt/local/lib$ otool -L libmpich.3.3.dylib\nlibmpich.3.3.dylib:\n        /opt/local/lib/libmpich.3.3.dylib (compatibility version 0.0.0, current version 3.0.0)\n        /opt/local/lib/gcc43/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)\n        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 169.3.0)\n\njonathan.lisic@server:/opt/local/lib$ nm  -u libmpich.3.3.dylib | egrep dup\n_MPI_Comm_dup\n_MPL_trstrdup\n_dup2\n_strdup\n</code></pre>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12753662,"title":"How to: Set factor variance to 1 (for observed variables)","body":"<p>I'm doing my master thesis in psychology and I'm using the <code>lme4</code> package in R for mixed-effects models.\nI have a variable called <code>Employment</code>. How do I set the error-variance to 1 for that variable? Is this even possible. This is something wich is done in structural equation modeling (MPlus). </p>\n\n<p>This is my formula:</p>\n\n<pre><code>fm2 &lt;- lmer(wellbeing~1+employ*ethic+(1|education),Dat)\n</code></pre>\n"},{"tags":["r","data.table"],"answer_count":2,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":489,"score":5,"question_id":11308754,"title":"Add multiple columns to R data.table in one function call?","body":"<p>I have a function that returns two values in a list. Both values need to be added to a data.table in two new columns. Evaluation of the function is costly, so I would like to avoid having to compute the function twice. Here's the example:</p>\n\n<pre><code>library(data.table)\nexample(data.table)\nDT\n   x y  v\n1: a 1 42\n2: a 3 42\n3: a 6 42\n4: b 1  4\n5: b 3  5\n6: b 6  6\n7: c 1  7\n8: c 3  8\n9: c 6  9\n</code></pre>\n\n<p>Here's an example of my function. Remember I said it's costly compute, on top of that there is no way to deduce one return value from the other given values (as in the example below):</p>\n\n<pre><code>myfun &lt;- function (y, v) \n{\nret1 = y + v\nret2 = y - v\nreturn(list(r1 = ret1, r2 = ret2))\n}\n</code></pre>\n\n<p>Here's my way to add two columns in one statement. That one needs to call myfun twice, however:</p>\n\n<pre><code>DT[,new1:=myfun(y,v)$r1][,new2:=myfun(y,v)$r2]\n\n   x y  v new1 new2\n1: a 1 42   43  -41\n2: a 3 42   45  -39\n3: a 6 42   48  -36\n4: b 1  4    5   -3\n5: b 3  5    8   -2\n6: b 6  6   12    0\n7: c 1  7    8   -6\n8: c 3  8   11   -5\n9: c 6  9   15   -3\n</code></pre>\n\n<p>Any suggestions on how to do this? I could save <code>r2</code> in a separate environment each time I call myfun, I just need a way to add two columns by reference at a time. </p>\n"},{"tags":["r","graphviz","igraph"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":94,"score":2,"question_id":9663504,"title":"Is there a package to convert network() or igraph() networks to Rgraphviz compatible in R?","body":"<p>Spent a lot of time formatting networks in the formats used for analysis in SNA and igraph packages.  Is there a bridge between these and Rgraphviz's desired data-type?  By this, I mean, preserves: Source-to-destination, Label, Edge weight, other attributes like color, etc.</p>\n"},{"tags":["r","network-programming","gml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12751497,"title":"How to convert csv file containing network data into GML","body":"<p>I have a dataset containing network data of email conversations consisting of two columns representing the connections between agents.</p>\n\n<p>The dataset can be accessed from <a href=\"https://dl.dropbox.com/u/22681355/email.csv\" rel=\"nofollow\">here</a> </p>\n\n<p>Since I'm using igraph in R I would like to convert this file to GML format.</p>\n\n<p>Is there any way to do this?</p>\n"},{"tags":["r","gwidgets"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":11953569,"title":"What is the preferred way to upload files using gWidgetsWWW?","body":"<p><code>gWidgetsWWW</code> manual indicates that the <code>gfilebrowse</code> widget is written only for local installs. </p>\n\n<p>In my local prototype with <code>gWidgets</code> I was using a technique described <a href=\"http://4dpiecharts.com/2010/10/06/creating-guis-in-r-with-gwidgets/\" rel=\"nofollow\">here</a>, but as I am trying to build an app that sits on a web server, then what would be the best way to select and upload a file to the server (using <code>gWidgetsWWW</code>) for further processing?</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12752592,"title":"Bar chart in ggplot not grouping by factor","body":"<p>I'm trying to plot a bar chart in <code>ggplot2</code> where each factor gets the mean of the observations.  However, the plot is the mean of the entire population, and is not breaking out/grouping by the factor, which is what I want</p>\n\n<p>Here is the chart:\n<img src=\"http://i.stack.imgur.com/W7DvW.png\" alt=\"enter image description here\"></p>\n\n<p>When I calculate the mean for the groups, there is a difference, which is what I want to plot.  </p>\n\n<pre><code>  US      Foreign\n1 89.76   124.02\n</code></pre>\n\n<p>Here is the mean of the entire column in the dataframe</p>\n\n<pre><code>mean(clients$OrderSize)\n[1] 96.71\n</code></pre>\n\n<p>Here is the structure of the dataframe.  I have CountryType as a factor, as this is what I want to group by:</p>\n\n<pre><code>str(clients)\n'data.frame':   252774 obs. of  4 variables:\n$ ClientID     : Factor w/ 252774 levels \"58187855\",\"59210128\",..: 19 20 21 22 23 24 25 26 27 28 ...\n$ Country      : Factor w/ 207 levels \"Afghanistan\",..: 196 60 139 196 196 40 40 196 196 196 ...\n$ CountryType  : Factor w/ 2 levels \"Foreign\",\"US\": 2 1 1 2 2 1 1 2 2 2 ...\n$ OrderSize    : num  12.95 21.99 5.00 7.50 44.5 ...\n</code></pre>\n\n<p>This is the call I am making:   </p>\n\n<pre><code>ggplot(data = clients, aes(x=CountryType, y=mean(OrderSize))) + geom_bar() + ylab(\"\")\n</code></pre>\n\n<p>And I tried explictely setting CountryType as a factor with no luck:</p>\n\n<pre><code>ggplot(data = clients, aes(x=factor(CountryType), y=mean(OrderSize))) + geom_bar() + ylab(\"\")\n</code></pre>\n\n<p>Do I need to pre-calculate the means for the two groups before I call <code>ggplot</code> or am I missing something?</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12737146,"title":"Assigning values to a df$column based on another column in the same df","body":"<pre><code>df2 &lt;- data.frame(Mean = c(.5,4,2.3,1.2,3.7,3.3,.8), Numbers = \"NA\")\n\n\nfor(i in 1:length(df2$Mean)){\n\n\n        if(df2$Mean[i] &lt;= .5) {\n\n\n        df2$Number[i] = 0\n\n        }\n\n        else if(df2$Mean[i] &gt; .5 &amp; df2$Mean[i] &lt; 1.5){\n\n        df2$Number[i] = 1\n\n        }\n\n        else if(df2$Mean[i] &gt; 1.5 &amp; df2$Mean[i] &lt; 2.5){\n\n        df2$Number[i] = 2\n\n        }\n\n        else if(df2$Mean[i] &gt; 2.5 &amp; df2$Mean[i] &lt; 3.5){\n\n        df2$Number[i] = 3\n\n        }\n\n        else {\n\n        df2$Number[i] = 4\n\n        }\n\n}\n</code></pre>\n\n<p>This works! However when I try to make a function out of it and call the function it dosen't work. I save the function file as \"df2type.txt\":</p>\n\n<pre><code>type &lt;- function(df2){\n\nfor(i in 1:length(df2$Mean)){\n\n\n        if(df2$Mean[i] &lt;= .5) {\n\n\n        df2$Number[i] = 0\n\n        }\n\n        else if(df2$Mean[i] &gt; .5 &amp; df2$Mean[i] &lt; 1.5){\n\n        df2$Number[i] = 1\n\n        }\n\n        else if(df2$Mean[i] &gt; 1.5 &amp; df2$Mean[i] &lt; 2.5){\n\n        df2$Number[i] = 2\n\n        }\n\n        else if(df2$Mean[i] &gt; 2.5 &amp; df2$Mean[i] &lt; 3.5){\n\n        df2$Number[i] = 3\n\n        }\n\n        else {\n\n        df2$Number[i] = 4\n\n        }\n\n}\n}\n</code></pre>\n\n<p>I invoke the function as:</p>\n\n<pre><code>source(\"df2type.txt\")\ntype(df2)\n</code></pre>\n\n<p>Could you please tell me why the function is not working?  </p>\n\n<p>Thank you so much!          </p>\n"},{"tags":["r","function","distance"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":93,"score":1,"question_id":12751501,"title":"Optimize my own distance function in R","body":"<p>I am trying to create a new distance function for my data. However, the performance of my code is very slow when compared to the dist function from stats package. For instance, see the results for the euclidean distance:</p>\n\n<pre><code>mydist = function (x){\n\n  euclidean = function (a, b){\n    sqrt(sum((a-b)^2))\n  }\n\n  distances = matrix(0, nrow=nrow(x), ncol=nrow(x))\n  for (i in 1:nrow(x))\n    for (j in 1:(i-1)){  # &lt;- corrected this\n      if (j &gt; 0){\n         distances[i,j]=euclidean(x[i,], x[j,])\n         distances[j,i]=distances[i,j]\n      }\n    }\n\n  distances\n}\n\n\nm=matrix(1:800, ncol=2)\nsystem.time(as.dist(mydist(m)))\n  usuário   sistema decorrido \n    0.714     0.000     0.716      # &lt;- updated values with corrected version\n\nsystem.time(dist(m))\n  usuário   sistema decorrido \n    0.004     0.000     0.002 \n</code></pre>\n\n<p>I will not use euclidean distance. I am developing a new one, much more complex using some statistics specific for my data, different from those of the proxy package, for instance. I have hundreds of variables and thousands of examples (lines) in the dataset. Can't wait a few hours just to compute the distance. </p>\n\n<p><strong>I have tried another code using outer with apply. It was faster than the two loops, but still very slow.</strong> Can anyone suggest anything?</p>\n"},{"tags":["r","text-mining","text-analysis","lda","topic-modeling"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":131,"score":1,"question_id":10488343,"title":"Removing an \"empty\" character item from a corpus of documents in R?","body":"<p>I am using the <code>tm</code> and <code>lda</code> packages in R to topic model a corpus of news articles. However, I am getting a \"non-character\" problem represented as <code>\"\"</code> that is messing up my topics. Here is my workflow:</p>\n\n<pre><code>text &lt;- Corpus(VectorSource(d$text))\nnewtext &lt;- lapply(text, tolower)\nsw &lt;- c(stopwords(\"english\"), \"ahram\", \"online\", \"egypt\", \"egypts\", \"egyptian\")\nnewtext &lt;- lapply(newtext, function(x) removePunctuation(x))\nnewtext &lt;- lapply(newtext, function(x) removeWords(x, sw))\nnewtext &lt;- lapply(newtext, function(x) removeNumbers(x))\nnewtext &lt;- lapply(newtext, function(x) stripWhitespace(x))\nd$processed &lt;- unlist(newtext)\ncorpus &lt;- lexicalize(d$processed)\nk &lt;- 40\nresult &lt;-lda.collapsed.gibbs.sampler(corpus$documents, k, corpus$vocab, 500, .02, .05,\ncompute.log.likelihood = TRUE, trace = 2L)\n</code></pre>\n\n<p>Unfortunately, when I train the lda model, everything looks great except the most frequently occurring word is \"\". I try to remedy this by removing it from the vocab as given below and reestimating the model just as above: </p>\n\n<pre><code>newtext &lt;- lapply(newtext, function(x) removeWords(x, \"\"))\n</code></pre>\n\n<p>But, it's still there, as evidenced by:</p>\n\n<pre><code>str_split(newtext[[1]], \" \")\n\n[[1]]\n [1] \"\"              \"body\"          \"mohamed\"       \"hassan\"       \n [5] \"cook\"          \"found\"         \"turkish\"       \"search\"       \n [9] \"rescue\"        \"teams\"         \"rescued\"       \"hospital\"     \n[13] \"rescue\"        \"teams\"         \"continued\"     \"search\"       \n[17] \"missing\"       \"body\"          \"cook\"          \"crew\"         \n[21] \"wereegyptians\" \"sudanese\"      \"syrians\"       \"hassan\"       \n[25] \"cook\"          \"cargo\"         \"ship\"          \"sea\"          \n[29] \"bright\"        \"crashed\"       \"thursday\"      \"port\"         \n[33] \"antalya\"       \"southern\"      \"turkey\"        \"vessel\"       \n[37] \"collided\"      \"rocks\"         \"port\"          \"thursday\"     \n[41] \"night\"         \"result\"        \"heavy\"         \"winds\"        \n[45] \"waves\"         \"crew\"          \"\"             \n</code></pre>\n\n<p>Any suggestions on how to go about removing this? Adding <code>\"\"</code> to my list of stopwords doesn't help, either.</p>\n"},{"tags":["r","function","package"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":12748716,"title":"Replace definition of built-in function in R?","body":"<p>The 'sparcl' package uses the 'kmeans' function in the standard 'stat' package. I want to make it use my own implementation of kmeans++ instead.</p>\n\n<p>One way to do this would be to edit the code in the sparcl package itself. I'd prefer to avoid this, both because it would be messy and because I'm not sure how I would then install that edited code in R.</p>\n\n<p>Unfortunately, the superassignment operator \"&lt;&lt;-\" doesn't work:</p>\n\n<pre><code>&gt; kmeans &lt;&lt;- function(x) print(\"hi!\")\nError: cannot change value of locked binding for 'kmeans'\n</code></pre>\n\n<p>neither does \"assign\":</p>\n\n<pre><code>assign(\"kmeans\",function(x) {print(\"HI THERE!\"); return(FALSE)},pos=\"package:sparcl\")\nError in assign(\"is.null\", function(x) { : \n  cannot add bindings to a locked environment\n</code></pre>\n\n<p>So is editing the package code the only way?</p>\n\n<p>Thanks!</p>\n"},{"tags":["r","list","matrix","split","unique"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12738359,"title":"Split matrices in a list with string criteria","body":"<p>I created a list which contains 105 matrices as follows:</p>\n\n<pre><code>m&lt;-vector(\"list\",105)\nfor (i in 2:105) {\n    m[[i-1]]&lt;-Datos[(x[i-1]+1):x[i],1:14] }\nm[[105]]&lt;-Datos[(x[105]+1):533195,1:14]\n</code></pre>\n\n<p>For example a part of my matrix number 104 returns (In columns):</p>\n\n<pre><code>m[[104]]\n\n    ID:                    \n     8866 \n     8866 \n     8866 \n     8866 \n     8866 \n     8866 \n     8866 \n     8866\n\n  Date: \n     1990-4-15 \n     1990-4-16\n     1990-4-17\n     1990-4-18\n     1990-4-15\n     1990-4-16\n     1990-4-17\n     1990-4-18\n\n    Series: \n        APV \n        APV \n        APV \n        APV \n        INV \n        INV \n        INV \n        INV\n</code></pre>\n\n<p>These are some of my columns of the matrix. What I would like is to split this matrix using the series columns. I think it would be like a list of a list depending of the number of different Series there are. In this case there are 2: <code>APV and INV</code> ( Note that I don't know the names of the series for each matrix, so there must be a function that extract the unique different series)</p>\n\n<p>In summary, I would like that:</p>\n\n<pre><code>m[[104]][[1]] returns:\n\n        ID:                    \n         8866 \n         8866 \n         8866 \n         8866 \n\n\n      Date: \n         1990-4-15 \n         1990-4-16\n         1990-4-17\n         1990-4-18\n\n\n        Series: \n            APV \n            APV \n            APV \n            APV \n\n\n\nAnd m[[104]][[2]] returns:\n\n        ID:                    \n         8866 \n         8866 \n         8866 \n         8866 \n\n\n      Date: \n         1990-4-15 \n         1990-4-16\n         1990-4-17\n         1990-4-18\n\n\n        Series: \n\n            INV \n            INV \n            INV \n            INV\n</code></pre>\n\n<p>Or maybe you come up with a more efficient way to do this.</p>\n\n<p>PD: Didn't know how to put the columns at the same level</p>\n"},{"tags":["r","packages","bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":5,"view_count":110,"score":-3,"question_id":12750551,"title":"Doing Deming regression in R. Time sensitive","body":"<p>I just loaded R to my windows machine and included bootstrap routines and the mcr routine for Deming regression.  Very basic questions. </p>\n\n<ol>\n<li><p>How do I imbed Deming regression inside a bootstrap sampling routine?</p></li>\n<li><p>How do I input my data into R? The data is in an Excel spreadsheet.</p></li>\n</ol>\n\n<p>Please try to give me a quick way.  I am trying to do this today if possible!</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12750997,"title":"Add a field conditional on the other with a function","body":"<p>I apologize if the title may not be clear.</p>\n\n<p>With</p>\n\n<pre><code>df &lt;- data.frame(profit = c(1, 1, 0, 0, 0, -1),\n                 offerA = round(rnorm(6), 2), \n                 offerB = round(runif(6), 2), \n                 offerC = sample(1:6))\n\ndf\n  profit offerA offerB offerC\n1      1  -0.51   0.91      6\n2      1  -0.03   0.75      4\n3      0  -1.02   0.28      5\n4      0   0.63   0.61      1\n5      0   2.32   0.37      2\n6     -1  -0.15   0.43      3\n</code></pre>\n\n<p>I need to add a field named <code>bid</code> depending on the value of <code>profit</code> under the following conditions:</p>\n\n<pre><code>with(df,\n  if (profit &gt; 0) {\n    apply(cbind(offerA, offerB, offerC), 1, max)\n  }\n  else if (profit = 0) {\n    apply(cbind(offerA, offerB, offerC), 1, mean)\n  }\n  else if (profit &lt; 0) {\n    apply(cbind(offerA, offerB, offerC), 1, min)\n  }\n)\n</code></pre>\n\n<p>In this example the new <code>df</code> will be:</p>\n\n<pre><code>df\n  profit offerA offerB offerC   bid\n1      1  -0.51   0.91      6     6\n2      1  -0.03   0.75      4     4\n3      0  -1.02   0.28      5  1.42\n4      0   0.63   0.61      1  0.75\n5      0   2.32   0.37      2  1.56\n6     -1  -0.15   0.43      3 -0.15\n</code></pre>\n\n<p>Because the value of <code>bid</code> is computed by rows, I want to write a function <code>addBid()</code> so that I can use something like <code>apply(df, 1, addBid)</code> but I can't think of a good way adding my conditions above into the function. I hope I'm clear with my question. Thanks!</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":114,"score":1,"question_id":12748811,"title":"Can this R function be vectorized?","body":"<pre><code>bucketIndex &lt;- function(v, N){\n  o &lt;- rep(0, length(v))\n\n  curSum &lt;- 0\n  index  &lt;- 1\n\n  for(i in seq(length(v))){\n    o[i] &lt;- index\n\n    curSum &lt;- curSum + v[i]\n    if(curSum &gt; N){\n      curSum &lt;- 0\n      index &lt;- index + 1\n    }\n  }\n\n  o\n}\n\n&gt; bucketIndex(c(1, 1, 2, 1, 5, 1), 3)\n[1] 1 1 1 2 2 3\n</code></pre>\n\n<p>I'm wondering if this function is fundamentally un-vectorizable. If it is, is there some package to deal with this \"class\" of functions, or is the only alternative (if I want speed) to write it as a c extension?</p>\n"},{"tags":["r","ggplot2","legend"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":12751159,"title":"ggplot2: Making changes to symbols in the legend","body":"<p>I'm having a problem making the symbols in the legend of my plot match those in the plot itself.  </p>\n\n<p>Suppose the data has four columns like this </p>\n\n<pre><code>data = data.frame(x = sample(1:10, 10, replace=TRUE), y = sample(1:10, 10, replace=TRUE), \n           Rank = sample(1:10, 10, replace = TRUE), Quantified = factor(sample(1:2, 10, replace = TRUE))\n)\n</code></pre>\n\n<p>I would like points to be different sizes (distinguished by 'Rank') and represented by different symbols (crosses and open circles, distinguished by 'Quantified').  </p>\n\n<p>My code is </p>\n\n<pre><code>ggplot(data, aes(x = x, y = y)) +\n          geom_point(aes(size = Rank, shape = Quantified)) +\n          scale_shape_manual(\"Quantified\", labels = c(\"Yes\", \"No\"), values = c(1, 4)\n )\n</code></pre>\n\n<p>The symbols in the plot are as I want them.  </p>\n\n<p>My problem is that I would like the circles in the top legend to be <strong>unfilled</strong> as they are in the plot.  </p>\n\n<p>I've tried a variety of commands in different parts of the code (e.g., fill = \"white\") but nothing seems to work quite right.</p>\n\n<p>Any suggestions?  </p>\n"},{"tags":["r","igraph"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12750679,"title":"re-arranging vertex in igraph","body":"<pre><code>df\n\nnetwork  bus_unit   outage\nA        Online     4\nB        Internal   5\nA        Finance    6\nB        IT         5\nA       IT         6\nA       Marketing  40\n</code></pre>\n\n<p>I need to greate a igraph which I can do with something like this:</p>\n\n<pre><code>g &lt;- graph.data.frame(df)\nplot(g,  \n     layout = layout.fruchterman.reingold,  \n     vertex.label = V(g) $name,\n     vertex.label.color= \"black\", \n     edge.arrow.size=1, \n     edge.curved=FALSE, \n     edge.label=df$outage)\n</code></pre>\n\n<p>My problem is that I like to show the network A ontop of the graph since it is the culprit. Is there anyway to organize this igraph, move vertex's around etc.</p>\n\n<p>thanks for your help.</p>\n"},{"tags":["r","user-interface","io"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12747769,"title":"Dribble in R: how to duplicate all i/o into a file?","body":"<p>Is there something like the <a href=\"http://www.lispworks.com/documentation/HyperSpec/Body/f_dribbl.htm\" rel=\"nofollow\">Common Lisp function DRIBBLE</a> or <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/utilities/tee.html\" rel=\"nofollow\">Unix command tee</a> in R?</p>\n\n<p>Specifically, I want <em>everything I type</em> <strong>and</strong> <em>everything R prints</em> back to me to be appended to a file (<code>tee</code> only captures stdout; I want <em>everyting</em>: errors, warnings, print, cat, my input).</p>\n\n<p>I found a <a href=\"https://stat.ethz.ch/pipermail/r-help/2002-March/019247.html\" rel=\"nofollow\">10 year old message</a> on the subject which offers a weak version of that (it does not capture the output from cat/print).</p>\n\n<p>The standard function <a href=\"http://stat.ethz.ch/R-manual/R-patched/library/base/html/sink.html\" rel=\"nofollow\">sink</a> only <em>captures</em> (not <em>duplicates</em>) the R's output; and it does <em>not</em> capture my input.</p>\n\n<p>Is there a better way?</p>\n"},{"tags":["r","github","package"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":265,"score":1,"question_id":10939496,"title":"Build Slidify Package from Source","body":"<p>Is anyone else having issues build the slidify package from github.  I want to play around but the install returns an error.  Here are the commmands I used and resulting error:</p>\n\n<pre><code>&gt; library(devtools)\nRtools not on path and not installed in default location.\nWarning message:\npackage ‘devtools’ was built under R version 2.14.2 \n&gt; install_github('slidify', 'ramnathv')\nInstalling github repo(s) slidify/master from ramnathv\nInstalling slidify.zip from https://github.com/ramnathv/slidify/zipball\nInstalling slidify\n* checking for file 'C:\\Users\\btibert\\AppData\\Local\\Temp\\RtmpsrQIgw\\ramnathv-slidify-954647c/DESCRIPTION' ... OK\n* preparing 'slidify':\n* checking DESCRIPTION meta-information ... OK\nWarning in .write_description(db, ldpath) :\n  Unknown encoding with non-ASCII data: converting to ASCII\n* checking for LF line-endings in source and make files\n* checking for empty or unneeded directories\n* building 'slidify_0.1.tar.gz'\n ERROR\npackaging into .tar.gz failed\nError: Command failed (1)\nIn addition: Warning message:\nrunning command '\"C:/PROGRA~1/R/R-214~1.1/bin/i386/R\" CMD build \"C:\\Users\\btibert\\AppData\\Local\\Temp\\RtmpsrQIgw\\ramnathv-slidify-954647c\" --no-manual --no-vignettes' had status 1 \n</code></pre>\n\n<p>I am on Windows 7, but here is my session info just in case:</p>\n\n<pre><code>&gt; sessionInfo()\nR version 2.14.1 (2011-12-22)\nPlatform: i386-pc-mingw32/i386 (32-bit)\n\nlocale:\n[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252   \n[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.1252    \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] devtools_0.6 plyr_1.7.1   RODBC_1.3-4 \n\nloaded via a namespace (and not attached):\n[1] RCurl_1.9-5.1 tools_2.14.1 \n</code></pre>\n\n<p>UPDATE:  After updating to R 2.15.0, I get the following error (even after install Rtools):</p>\n\n<pre><code>Warning: invalid package 'Files/R/R-2.15.0/library'\nError: ERROR: cannot cd to directory 'C:/Program'\nError: Command failed (1)\nIn addition: Warning message:\nrunning command '\"C:/PROGRA~1/R/R-215~1.0/bin/i386/R\" CMD INSTALL C:\\Users\\btibert\\AppData\\Local\\Temp\\Rtmp8oMxGU/slidify_0.1.tar.gz --library=C:/Program Files/R/R-2.15.0/library' had status 1\n</code></pre>\n"},{"tags":["r","rapache"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12749824,"title":"Errors in Deploying Rapache and Rook","body":"<p>I am trying to create a web application using R and Rook.</p>\n\n<p>I saw this example <a href=\"http://www.road2stat.com/cn/r/rook.html\" rel=\"nofollow\">http://www.road2stat.com/cn/r/rook.html</a> and I have been able to replicate it in my command line (Calling it from inside R). But I want multiple users to be able to connect to the app at the same-time so i want to deploy it like Jeff said here - <a href=\"http://jeffreyhorner.tumblr.com\" rel=\"nofollow\">http://jeffreyhorner.tumblr.com</a></p>\n\n<p>I have been able to replicate most of the examples that came with Rook package like Jeff stated on his blog. These include-\nsummary.r\nrnorm\nRookTestApp</p>\n\n<p>The problem I am having now is that I  cant make the former example work (That is -www.road2stat)  It gives me an error message  every time I try to upload a file to it. This does not happen when I use the command line.  </p>\n\n<p>My error message is like so -<br>\nInternal Server Error \nThe server encountered an internal error or misconfiguration and was unable to complete your request............</p>\n\n<p>This is my path to deploy my app</p>\n\n<pre><code>&lt;Location /test/Visbin&gt;\nSetHandler r-handler\nRFileEval /usr/lib/R/library/Rook/exampleApps/visbin.R:Rook::Server$call(newapp)\n&lt;/Location&gt;\n</code></pre>\n\n<p>This is the app I am trying to replicate</p>\n\n<pre><code>newapp = function(env) {\nreq = Rook::Request$new(env)\nres = Rook::Response$new()\nres$write('Choose a Binary file to Train:\\n')\nres$write('&lt;form method=\"POST\" enctype=\"multipart/form-data\"&gt;\\n')\nres$write('&lt;input type=\"file\" name=\"data\"&gt;\\n')\nres$write('xdim:\\n')\nres$write('&lt;form method=\"POST\"&gt;\\n')\nres$write('&lt;input type=\"text\" name=\"xdim\" value=\"12\"&gt;\\n')\nres$write('ydim:\\n')\nres$write('&lt;form method=\"POST\"&gt;\\n')\nres$write('&lt;input type=\"text\" name=\"ydim\" value=\"25\"&gt;\\n')\nres$write('ncolors:\\n')\nres$write('&lt;form method=\"POST\"&gt;\\n')\nres$write('&lt;input type=\"text\" name=\"ncolors\" value=\"8\"&gt;\\n')\nres$write('&lt;input type=\"submit\" name=\"Go!\"&gt;\\n&lt;/form&gt;\\n&lt;br&gt;')\n\nmyNormalize = function (target) {\nreturn((target - min(target))/(max(target) - min(target)))\n}\n\nif (!is.null(req$POST())) {\ndata = req$POST()[[\"data\"]]\nhash = digest(data$tempfile, algo = \"md5\", file = TRUE)\ndestFile = file(data$tempfile, \"rb\")\nk = floor((file.info(data$tempfile)$size/16)) - 2\ndoneFile = readBin(con = destFile, what = \"raw\", n = 2 * 8 * k)\nclose(destFile)\ntmpFile0 = rbind(doneFile[seq(1, (2 * 8 * k) - 1, 2)], doneFile[seq(2, (2 * 8 * k), 2)])\ntmpFile1 = paste(tmpFile0[1, ], tmpFile0[2, ], sep = \"\")\ninitMat = matrix(strtoi(tmpFile1, 16L), ncol = 8, byrow = TRUE)\nnormMat = myNormalize(initMat)\ntrainedSOM = kohonen::som(normMat, grid = somgrid(xdim = req$POST()[[\"xdim\"]], ydim = req$POST()[[\"ydim\"]], \"hexagonal\"))\npng(paste(\"/tmp/\", hash, \".png\", sep = \"\"))\nplot(trainedSOM, type = \"dist.neighbours\", palette.name = rainbow, ncolors = as.numeric(req$POST()[[\"ncolors\"]]), main = \"\")\ndev.off()\nres$write(paste(\"&lt;img src='\", s$full_url(\"pic\"), \"/\", hash, \".png'\", \" /&gt;\", sep = \"\"))\n}\nres$finish()\n</code></pre>\n\n<p>}</p>\n\n<p>And this is my command line instruction -</p>\n\n<pre><code>s = Rhttpd$new()\ns$add(app = newapp, name = \"visbin\")\ns$add(app = File$new(\"/tmp\"), name = \"pic\")\ns$start()\ns$browse(\"visbin\")\n</code></pre>\n\n<p>Can anyone please point me in the right direction or direct me to resources that will assist me in doing it.</p>\n\n<p>P.S - I am using a fedora 15 and I have Rapache-1.2.0 installed.</p>\n"},{"tags":["r","datetime","lubridate"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":110,"score":2,"question_id":11406935,"title":"How to decompose the data of date in R?","body":"<p>in R, I got the data class of date as follow:</p>\n\n<pre><code>20100701\n20100702\n20100703\n20100704\n</code></pre>\n\n<p>how could I transform them to the follow form:</p>\n\n<pre><code>2010 07 01\n2010 07 02\n2010 07 03\n</code></pre>\n\n<p>the data of year,month and day in 3 columns.</p>\n"},{"tags":["r","datetime"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12748681,"title":"Plotting 2 datasets with different dates on the same plot in r","body":"<p>I have a Dataset_1 that only has some values some months, e.g. </p>\n\n<pre><code>Day Month   Year    Value\n10  5   2003    12\n17  5   2003    46\n1   6   2003    23\n16  6   2003    43\n16  10  2003    23\n26  10  2003    12\n</code></pre>\n\n<p>and Dataset_2 that has regular 1 hour values for the same time period e.g</p>\n\n<pre><code>Day Month   Year    Hour Value\n10  5       2003    0:00 13\n10  5       2003    1:00 12\n(...)\n26  10      2003    21:00 12\n26  10      2003    22:00 12\n</code></pre>\n\n<p>Dataset_1 is used to evaluate Dataset_2. I would therefore like to plot the regular-interval-Dataset_2 against the not-so-regular-Dataset_1. Is there a way, probably using the date stamps that are in common, to plot all the timesteps of Dataset_2 but to get R to plot the points of Dataset_1 at the corresponding date of Dataset_2?</p>\n\n<p>Thank you.</p>\n"},{"tags":["r","igraph"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":12748020,"title":"showing data frame in igraph","body":"<p>my data frame is called</p>\n\n<p>p</p>\n\n<pre><code>Impacted_system, Application_Caused_Incident Number_of_Incident                   \nWeb                  Financials        10                   \nPeopleSoft           HR                30\nPPP                  PeopleSoft        50\n</code></pre>\n\n<p>etc</p>\n\n<p>I like to show igraph diagram having the edges to be impacted Systems, edges having text in showing the impacted_system and the Number of incidents.</p>\n\n<p>I did this:</p>\n\n<pre><code>g &lt;- graph.data.frame(p)\nplot.igraph(g)\n</code></pre>\n\n<p>I get graph with edges having numbers. I relly like to see the text like HR, Web  and the number of incidents on edges etc. any ideas?</p>\n"},{"tags":["r","sapply"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12749168,"title":"Updating a dataframe with function and sapply","body":"<p>I am attempting to set a column in a dataframe equal to either 'US' or 'Foreign', depending on country.  I believe the proper way to do so is to write a function, then use <code>sapply</code> to actually update the dataframe.  This is the first time I've attempted something like this in <code>R</code> - in <code>SQL</code>, I would have just written an <code>UPDATE</code> query.  </p>\n\n<p>Here is my dataframe:</p>\n\n<pre><code>str(clients)\n'data.frame':   252774 obs. of  4 variables:\n $ ClientID     : Factor w/ 252774 levels \"58187855\",\"59210128\",..: 19 20 21 22 23 24 25 26 27 28 ...\n $ Country          : Factor w/ 207 levels \"Afghanistan\",..: 196 60 139 196 196 40 40 196 196 196 ...\n $ CountryType     : chr  \"\" \"\" \"\" \"\" ...\n $ OrderSize        : num  12.95 21.99 5.00 7.50 44.5 ...\n\n\nhead(clients)\n       ClientID  Country       CountryType  OrderSize\n1      58187855  United States              12.95\n2      59210128  France                     21.99\n3      65729284  Pakistan                   5.00\n4      25819711  United States              7.50\n5      62837458  United States              44.55\n6      88379852  China                      99.28\n</code></pre>\n\n<p>The function I attempted to write is this:</p>\n\n<pre><code>updateCountry &lt;- function(x) {\n  if (clients$Country == \"US\") {\n        clients$CountryType &lt;- \"US\"\n  } else {\n    clients$CountryType &lt;- \"Foreign\"\n    }\n}\n</code></pre>\n\n<p>I would then apply it like so:</p>\n\n<pre><code>sapply(clients, updateCountry)\n</code></pre>\n\n<p>When I run <code>sapply</code> against the head of the dataframe, I get this:</p>\n\n<pre><code>\"US\" \"US\" \"US\" \"US\" \"US\" \"US\" \nWarning messages:\n1: In if (clients$Country == \"United States\") { :\n  the condition has length &gt; 1 and only the first element will be used\n2: In if (clients$Country == \"United States\") { :\n  the condition has length &gt; 1 and only the first element will be used\n3: In if (clients$Country == \"United States\") { :\n  the condition has length &gt; 1 and only the first element will be used\n4: In if (clients$Country == \"United States\") { :\n  the condition has length &gt; 1 and only the first element will be used\n5: In if (clients$Country == \"United States\") { :\n  the condition has length &gt; 1 and only the first element will be used\n6: In if (clients$Country == \"United States\") { :\n  the condition has length &gt; 1 and only the first element will be used\n</code></pre>\n\n<p>It appears that the function is classifying the Country correctly, but is not updating the clients$CountryType column correctly.  What am I doing wrong?  Also - is this the best way to accomplish updating the dataframe?</p>\n"},{"tags":["r","linux-kernel","compiler-optimization","kvm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":12692049,"title":"How to optimize R performance","body":"<p>We have a recent performance bench mark that I am trying to understand. We have a large script that performance appears 50% slower on a Redhat Linux machine than a Windows 7 laptop where the specs are comparable. The linux machine is virtualized using kvm and has 4 cores assigned to it along with 16GB of memory. The script is not io intensive but has quite a few for loops. Mainly I am wondering if there are any R compile options that I can use to optimize or any kernel compiler options that might help to make this more comparable. Any pointers would be appreciated. I will try to get another machine and test it in using raw metal also for a better comparison. </p>\n\n<p><img src=\"http://i.stack.imgur.com/kr0FF.png\" alt=\"Peformance comparisons\"></p>\n\n<p>These are the configure flags that I am using to compile R on the linux machine. I have experimented quite a bit and this seems to cut 12 seconds off the execution time in the green for larger data sets. Essentially I went from 2.087 to 1.48 seconds with these options.</p>\n\n<pre><code>./configure CFLAGS=\"-O3 -g -std=gnu99\" CXXFLAGS=\"-O3 -g\" FFLAGS=\"-O2 -g\" LDFLAGS=\"-Bdirect,--hash-stype=both,-Wl,-O1\" --enable-R-shlib --without-x --with-cairo --with-libpng --with-jpeglib\n</code></pre>\n\n<p><strong>Update 1</strong></p>\n\n<p>The script has not been optimized yet. Another group is actually working on the script and we have put in requests to use the apply function but not sure how this explains the disparity in the times.</p>\n\n<p>The top of the profile looks like this. Most of these functions will later be optimized using the apply functions but right now it is bench marked apples to apples on both machines. </p>\n\n<pre><code>\"eval.with.vis\"                    8.66    100.00      0.12     1.39\n\"source\"                           8.66    100.00      0.00     0.00\n\"[\"                                5.38     62.12      0.16     1.85\n\"GenerateQCC\"                      5.30     61.20      0.00     0.00\n\"[.data.frame\"                     5.20     60.05      2.40    27.71\n\"ZoneCalculation\"                  5.12     59.12      0.02     0.23\n\"cbind\"                            3.22     37.18      0.34     3.93\n\"[[\"                               2.26     26.10      0.38     4.39\n\"[[.data.frame\"                    1.88     21.71      0.82     9.47\n</code></pre>\n\n<p>My first suspicion and I will be testing shortly and updating with my findings is that KVM linux virtualization is to blame. This script is very memory intensive and due to the large number of array operations and R being pass by copy ( which of course has to malloc ) this may be causing the problem. Since the VM does not have direct access to the memory controller and must share it with it's other VM's this could very likely cause the problem. I will be getting a raw machine later on today and will update with my findings. </p>\n\n<p>Thank you all for the quick updates.</p>\n\n<p><strong>Update 2</strong></p>\n\n<p>We originally thought the cause of the performance problem was caused by hyper threading with a VM, but this turned out to be incorrect and performance was the same on a bare metal machine comparatively.</p>\n\n<p>We later realized that the windows laptop is using a 32 bit version of R for computations. This led us to try the 64 bit version of R and the result was ~140% slower than 32 bit on the same exact same script. This leads me to the question of how is it possible that the 64 bit could be ~140% slower than the 32 bit version of R?</p>\n\n<p>What we are seeing is that the 32</p>\n\n<p>Windows 32 bit execution time 48 seconds\nWindows 64 bit execution time 2.33 seconds. </p>\n\n<p>Linux 64 bit execution time 2.15 seconds.\nLinux 32 bit execution time &lt; in progress > ( Built a 32 bit version on RHEL 6.3 x86_64 but did not see performance improvement am going to reload with 32 bit version of RHEL 6.3 ) </p>\n\n<p>I found this link but it only explains a 15-20% hit on some 64 bit machines. </p>\n\n<p><a href=\"http://www.hep.by/gnu/r-patched/r-admin/R-admin_51.html\" rel=\"nofollow\">http://www.hep.by/gnu/r-patched/r-admin/R-admin_51.html</a></p>\n\n<p>Sorry I cannot legally post the script. </p>\n"},{"tags":["r","ggplot2"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1094,"score":3,"question_id":9563368,"title":"Create Stacked percent barplot in R","body":"<p>I have a csv file with data in the following format</p>\n\n<pre><code>,ONE,TWO,THREE\n1,23,234,324\n2,34,534,12\n3,56,324,124\n4,34,234,124\n5,123,534,654\n</code></pre>\n\n<p>I acquire the info in the following way</p>\n\n<pre><code>data &lt;- read.csv(file=\"file.csv\",sep=\",\",header=TRUE)\n</code></pre>\n\n<p>and I want to produce a percent bar plot. This is how it looks in LibreOffice Calc.\n<img src=\"http://i.stack.imgur.com/SbTdJ.png\" alt=\"enter image description here\"></p>\n\n<p>So far all I have been able to get is is a stacked barplot(not percent), using </p>\n\n<pre><code>barplot(as.matrix(data))\n</code></pre>\n\n<p>Any help? </p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12746667,"title":"increasing the line thickness of geom_smooth","body":"<p>I have this ggplot:</p>\n\n<pre><code>ggplot(dt.m, aes(x=pct.on.OAC.cont,y=Number.of.Practices, fill=Age.Group)) +\n    geom_bar(stat=\"identity\",position=position_dodge()) +   \n    geom_smooth(aes(x=pct.on.OAC.cont,y=Number.of.Practices, colour=Age.Group), se=F)\n</code></pre>\n\n<p>How can I increase the thickness of the lines drawn by geom_smooth ?</p>\n"}]}
{"total":19203,"page":20,"pagesize":100,"questions":[{"tags":["r","matrix","cluster-analysis","data-visualization","heatmap"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":144,"score":0,"question_id":12646691,"title":"Trying to determine why my heatmap made using heatmap.2 and using breaks in R is not symmetrical","body":"<p>I am trying to cluster a protein dna interaction dataset, and draw a heatmap using heatmap.2 from the R package gplots. My matrix is symmetrical.<br>\nHere is a copy of the data-set I am using after it is run through pearson:<a href=\"http://pastebin.com/JQ1wgVwD\" rel=\"nofollow\">DataSet</a> </p>\n\n<p>Here is the complete process that I am following to generate these graphs: Generate a distance matrix using some correlation in my case pearson, then take that matrix and pass it to R and run the following code on it:</p>\n\n<pre><code>library(RColorBrewer);\nlibrary(gplots);\nlibrary(MASS);\nargs &lt;- commandArgs(TRUE);\nmatrix_a &lt;- read.table(args[1], sep='\\t', header=T, row.names=1);\nmtscaled &lt;- as.matrix(scale(matrix_a))\n# location &lt;- args[2];\n# setwd(args[2]);\npdf(\"result.pdf\", pointsize = 15, width = 18, height = 18)\nmycol &lt;- c(\"blue\",\"white\",\"red\")\nmy.breaks &lt;- c(seq(-5, -.6, length.out=6),seq(-.5999999, .1, length.out=4),seq(.100009,5, length.out=7))\n#colors &lt;- colorpanel(75,\"midnightblue\",\"mediumseagreen\",\"yellow\") \nresult &lt;- heatmap.2(mtscaled, Rowv=T, scale='none', dendrogram=\"row\", symm = T, col=bluered(16), breaks=my.breaks)\ndev.off() \n</code></pre>\n\n<p>The issue I am having is once I use breaks to help me control the color separation the heatmap no longer looks symmetrical. </p>\n\n<p>Here is the heatmap before I use breaks, as you can see the heatmap looks symmetrical:\n<img src=\"http://i.stack.imgur.com/C5SJq.png\" alt=\"Without Breaks\"> </p>\n\n<p>Here is the heatmap when breaks are used:\n<img src=\"http://i.stack.imgur.com/GYFPo.png\" alt=\"With breaks\"></p>\n\n<p>I have played with the cutoff's for the sequences to make sure for instance one sequence does not end exactly where the other begins, but I am not able to solve this problem.  I would like to use the breaks to help bring out the clusters more.  </p>\n\n<p>Here is an example of what it should look like, this image was made using cluster maker:\n<img src=\"http://i.stack.imgur.com/hknRG.png\" alt=\"enter image description here\"></p>\n\n<p>I don't expect it to look identical to that, but I would like it if my heatmap is more symmetrical and I had better definition in terms of the clusters.  The image was created using the same data.  </p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":55,"score":-1,"question_id":12747890,"title":"Random lists with replacement","body":"<p>I would like to create 1000 random lists of 1652 genes from a universe of 44.400 genes.\nI decided to replace. I used the following instruction to create the random lists: </p>\n\n<pre><code>randomMatrix&lt;-replicate(1000, sample(gene_list, 1652, replace = T))\n</code></pre>\n\n<p>The point is that in each list a gene is replicated. For my study, genes can be replicated between lists but not in each list. How can I impose not to replicate genes in each single list?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":35,"score":3,"question_id":12747234,"title":"Replicate a list to create a list-of-lists","body":"<p>I am trying to create a list with the following (nested) structure:</p>\n\n<pre><code>l &lt;- list()\nfor(i in seq(5)) l[[i]] &lt;- list(a=NA,b=NA)\n&gt; str(l)\nList of 5\n $ :List of 2\n  ..$ a: logi NA\n  ..$ b: logi NA\n $ :List of 2\n  ..$ a: logi NA\n  ..$ b: logi NA\n $ :List of 2\n  ..$ a: logi NA\n  ..$ b: logi NA\n $ :List of 2\n  ..$ a: logi NA\n  ..$ b: logi NA\n $ :List of 2\n  ..$ a: logi NA\n  ..$ b: logi NA\n</code></pre>\n\n<p>I'd like to do this via <code>rep</code> or similar, as I'm creating a whole bunch of blank lists which I will later fill in.  (I'm aware that I can just expand a list via referring to its next index, but that doesn't work when indexing two-deep).</p>\n\n<p>I thought that <code>rep</code> worked for this, but it does not appear to.  <code>?rep</code> gives the following example:</p>\n\n<pre><code>fred &lt;- list(happy = 1:10, name = \"squash\")\nrep(fred, 5)\n</code></pre>\n\n<p>Which returns:</p>\n\n<pre><code>&gt; str(rep(fred, 5))\nList of 10\n $ happy: int [1:10] 1 2 3 4 5 6 7 8 9 10\n $ name : chr \"squash\"\n $ happy: int [1:10] 1 2 3 4 5 6 7 8 9 10\n $ name : chr \"squash\"\n $ happy: int [1:10] 1 2 3 4 5 6 7 8 9 10\n $ name : chr \"squash\"\n $ happy: int [1:10] 1 2 3 4 5 6 7 8 9 10\n $ name : chr \"squash\"\n $ happy: int [1:10] 1 2 3 4 5 6 7 8 9 10\n $ name : chr \"squash\"\n</code></pre>\n\n<p>In other words, it flattens the list.</p>\n\n<p>I've also tried <code>list( rep(fred,5) )</code> which similarly fails.</p>\n\n<p>How do I replicate a list-of-lists?</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12747291,"title":"To revise the funciton to delete the global variable in R function?","body":"<pre><code>word &lt;- c('abc noboby@stat.berkeley.edu','text with no email','first me@mything.com also you@yourspace.com')\npattern &lt;- '[-A-Za-z0-9_.%]+@[-A-Za-z0-9_.%]+\\\\.[A-Za-z]+'\n\n\ngetmail&lt;-function(pattern,word){\nmail&lt;&lt;-c()\nsapply(word,function(x){\nout&lt;-gregexpr(pattern,x)\nfor (i in 1:length(out[[1]])){\nif (out[[1]][i]&gt;0)\nmail&lt;&lt;-union(mail,substr(x,start=out[[1]][i],stop=out[[1]][i]+attr(out[[1]],\"match.length\")[i]-1))\n}})\nreturn(mail)\n}\n\ngetmail(pattern,word)\n\n[1] \"noboby@stat.berkeley.edu\" \"me@mything.com\"           \"you@yourspace.com\"       \nls()\n[1] \"getmail\" \"mail\"    \"pattern\" \"word\"     \n</code></pre>\n\n<p>The function get the result ,but i feel it is better if there is no global  variable <code>mail</code> in the namespace after i run getmail(pattern,word) ,how can i revise it?\nDo not delete sapply  function,do as my way ,just not to let <code>mail</code> in the namespace . </p>\n\n<p>i know i can get the result in more simply way,but i want to learn something more about function.</p>\n\n<pre><code>mail&lt;-c()\nout&lt;-gregexpr(pattern,word)\nfor (i in 1:length(out)){\n  for (j in 1:length(out[[i]])){\n    if (out[[i]][j]&gt;0)\n    mail&lt;-union(mail,substr(word[i],start=out[[i]][j],stop=out[[i]][j]+attr(out[[i]],\"match.length\")[j]-1))}}\nmail\n[1] \"noboby@stat.berkeley.edu\" \"me@mything.com\"           \"you@yourspace.com\"       \n</code></pre>\n"},{"tags":["r","function","vector","for-loop"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12738363,"title":"R: Hold Values Generated in For Loop","body":"<p>I apologize for this question in advance, but I've looked pretty hard and haven't been able to find a solution.</p>\n\n<p>How do I values generated by a for loop in a variable?</p>\n\n<p>For example:</p>\n\n<pre><code>myfunction &lt;- function(x=1:5) {\n                for(i in 1:length(x)) {\n                r&lt;-x[i]\n                }\n                print(r)\n              }\n</code></pre>\n\n<p>If I run the above code, I only get the last value for x, in this case 5. I understand that this is because I'm overwriting r each time through the for loop.</p>\n\n<p>I've also tried:</p>\n\n<pre><code>myfunction &lt;- function(x=1:5) {\n                for(i in 1:length(x)) {\n                r[i]&lt;-x[i]\n                }\n                print(r)\n              }\n</code></pre>\n\n<p>But I still just get the last value.</p>\n\n<p>The only solution I've found is to specify the length of the variable that will hold the generated values before using r&lt;-numeric(length):</p>\n\n<pre><code>myfunction &lt;- function(x=1:5) {\n                r&lt;-numeric(5)\n                for(i in 1:length(x)) {\n                r[i]&lt;-x[i]\n                }\n                print(r)\n              }\n</code></pre>\n\n<p>But this solution will obviously be insufficient if I don't know the length of the vector to be returned beforehand.</p>\n\n<p>Thanks for any help!</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12746523,"title":"Preventing a second legend","body":"<p>I have a ggplot, which also displays a legend:</p>\n\n<pre><code>ggplot(dt.m, aes(x=pct.on.OAC.cont,y=Number.of.Practices, fill=Age.Group)) +\n    geom_bar(stat=\"identity\",position=position_dodge())\n</code></pre>\n\n<p>When I add another line, I also get a second legend:</p>\n\n<pre><code>geom_smooth(aes(x=pct.on.OAC.cont,y=Number.of.Practices, colour=Age.Group), se=F, alpha=0.5)\n</code></pre>\n\n<p>How can I prevent the second legend from displaying ?</p>\n"},{"tags":["r","time-series","zoo"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":166,"score":0,"question_id":12636839,"title":"Creating a time offset for a zoo object","body":"<p>I have a zoo object that contains velocity data from two different points (V1 and V2), as well as  particle Data from the same two points. The distance between the two points is 170m. </p>\n\n<pre><code>Date&lt;- as.POSIXct(\"2012-01-01 08:00:00\") + 1:120\nV1&lt;-rnorm(200,mean=5) #Velocity in m/sec\nR&lt;-rnorm(4,mean=3)\nV2&lt;-V1+R #Velocity in m/sec\nData1&lt;-rnorm(200, mean=20)\nData2&lt;-rnorm(200, mean=25)\nV&lt;-data.frame(V1,V2,Data1,Data2)\nz&lt;-zoo(as.matrix(V),order.by=Date)\nL&lt;-170 #Length =170m\n</code></pre>\n\n<p>If I average the velocity data</p>\n\n<pre><code>z$Avg_Vel&lt;-rowMeans(z[,1:2])\n</code></pre>\n\n<p>I should have a pretty good idea of how fast the particles are traveling, and since I know the distance I should have a good idea of how long it is taking the particles to travel from Point 1 to Point 2 during the course of the time series.</p>\n\n<pre><code>z$Off&lt;-L/z$Avg_Vel\n</code></pre>\n\n<p>But I cant figure out how to offset my zoo object to account for the time delay it takes for particles to travel between the two points. So if I am interested in finding the difference between Data 1 and Data 2, I don't want to do</p>\n\n<pre><code>Diff&lt;-z$Data1-z$Data2\n</code></pre>\n\n<p>As this does not include the offset</p>\n\n<p>If it takes 2 minutes for the particles to travel from point 1 to point 2, than I would want</p>\n\n<pre><code>Diff&lt;-z$Data1-z$Data2(+2min)\n</code></pre>\n\n<p>So that I am looking at the difference between Data1 at time x, and Data2 at time x+2min</p>\n\n<p>To clarify in response to an answer, the end result would be a rolling offset. So that </p>\n\n<pre><code>  Offset&lt;-z$Off\n</code></pre>\n\n<p>Looking at this kind of Offset</p>\n\n<pre><code>round(as.numeric(z$Off))\n</code></pre>\n\n<p>The result would look like this</p>\n\n<pre><code>1 Diff&lt;- Diff&lt;-z$Data1-z$Data2(+22 sec)\n2 Diff&lt;- Diff&lt;-z$Data1-z$Data2(+23 sec)\n3 Diff&lt;- Diff&lt;-z$Data1-z$Data2(+32 sec)..........\n</code></pre>\n"},{"tags":["r","list","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12746218,"title":"Matrix operations on objects in a list","body":"<p>I have a list like the one below containing matrices that I want to do separate operations on.</p>\n\n<pre><code>data &lt;- data.frame(matrix(data = c(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,2,0,0,0,0,2,0,0,0,0,2,0,0,0,0,2), nrow = 8, ncol = 4, byrow = TRUE) )\nmatrix_list &lt;- list(data[1:4, ], data[5:8, ])\n</code></pre>\n\n<p>I know I can do matrix operations on each object separately, like this</p>\n\n<pre><code>eigen(matrix_list[[1]])\n</code></pre>\n\n<p>And I can do an operation on all items with a <code>for</code> loop</p>\n\n<pre><code>for (i in 1:2){print(eigen((data_list[[i]])))}\n</code></pre>\n\n<p>How can I skip the <code>for</code> loop and operate on the list directly?  It would be great if i could just do something like \"eigen(matrix_list)\"</p>\n"},{"tags":["r","data","statistics","data-mining"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12738615,"title":"Possible metrics to derive from a multitude of partially overlapping latency data?","body":"<p>I have a massive application littered with latency measurements which end up in log files, and which can be parsed out into a table like this:</p>\n\n<pre><code>SecsSinceNoon NumObjsMadeInFuncFoo SomeFuncBar AtoBInFileBazdotC CompressCallbackInLibBill\n0                        NA              234            4                 7888\n1                        NA              244            6                 7895\n2                        17              244            6                 5274\n3                        16              NA             8                  NA\n.                        .               .              .                  .\n</code></pre>\n\n<p>The first column is what second from the beginning of the application..so if it runs for 10 hours we're dealing with 36000 rows and about 80-100 columns. The columns contain average value of a latency measurement over that second bucket, or counts of some occurrence over that second bucket. (There are actually two companion tables generated where the columns are max and min over the corresponding second bucket too). Because not all parts of the application are always active at the same time, the overlap is not perfect, there may even be two columns whose non-NA overlap is empty, while several other columns overlap with values for long periods of time.</p>\n\n<p>Loading a table like the above into R and generating a straight up correlation matrix, or correlating a column to any other column over a period of time on which it overlaps can yield some useful information when trying to figure out how latency measurements or counts in one part can affect or are related to others.</p>\n\n<p>My question is, what are some other things I can do with this data? Possibly other metrics or R packages or something I can look into building out of this large amount of rich information? Not much comes to mind besides cross correlating different columns.</p>\n"},{"tags":["r"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":12745826,"title":"Bigger Tag for R in Stackoverflow","body":"<p>This is a question to the moderators of stackoverflow!</p>\n\n<p>Would you please assign a bit of more space for R tag in your website? </p>\n\n<p>I just tried to click on the tag, but removed it :-)</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":12745633,"title":"Can't rm object in R?","body":"<p>In my console ,i can not delete objects ,why?   </p>\n\n<pre><code>&gt; ls()\n[1] \"f1\"      \"f2\"      \"getmail\" \"k\"       \"mail\"    \"pattern\" \"rm\"      \"word\"    \"x\"      \n&gt; rm(k)\nError in rm(k) : unused argument(s) (k)\n&gt; rm(\"k\")\nError in rm(\"k\") : unused argument(s) (\"k\")\n</code></pre>\n"},{"tags":["r","transform","nested-loops"],"answer_count":1,"favorite_count":0,"up_vote_count":9,"down_vote_count":0,"view_count":227,"score":9,"question_id":12327535,"title":"Data transformation avoiding nested loops in R","body":"<p>I have a contingency table data matrix with 6 columns and 37 rows.\nI need to apply a Chi squared transformation to give me Row profiles and Column profiles for a correspondence analysis.</p>\n\n<p>Unfortunately I've been told I will need to use nested loops to transform the data and carry out the CA (rather than doing it the more sensible ways in R). I was given the structure to use for my nested loop:</p>\n\n<pre><code>transformed.data=data0\n\nfor (row.index in 1:nrow(data)) {\n  for (col.index in 1:ncol(data)) {\n    transfomed.data[row.index,col.index]=\n       \"TRANSFORMATION\"[row.index,col.index]\n  }\n}\n</code></pre>\n\n<p>From what i understand by using the nested loop it will apply my <em>\"TRANSFORMATION\"</em> first to the rows and then to the columns.</p>\n\n<p>The transformation I want done on the data to get the row profiles is:</p>\n\n<blockquote>\n  <p><strong>(</strong> X( <em>ij</em> ) / sum( X( <strong><em>i</em></strong> ) ) <strong>)</strong> / sqrt( sum( X( <strong><em>j</em></strong> ) ) )            </p>\n</blockquote>\n\n<p>While the transformation I want done on the data to get the column profiles is:</p>\n\n<blockquote>\n  <p><strong>(</strong> X( <em>ij</em> ) / sum( X( <strong><em>j</em></strong> ) ) <strong>)</strong> / sqrt( sum( X( <strong><em>i</em></strong> ) ) )            </p>\n</blockquote>\n\n<p>What would I enter as my <em>\"TRANSFORMATION\"</em> in the last line of the nested loop to get it to output my desired transformation for profiles. Otherwise if I've miss understood the point of a nested loop here please describe what it would allow me to do.</p>\n\n<p>This is the code for a subset of my data:</p>\n\n<pre><code>matrix(c(15366,2079,411,366,23223,2667,699,819,31632,2724,717,1473,49938,3111,1062,11964)\n,nrow=4,ncol=4,byrow=T)\n</code></pre>\n\n<p>So using this subset alone I would expect the row profile for the first row to be: </p>\n\n<pre><code>0.002432689 0.0003291397 6.506803e-05 5.794379e-05\n</code></pre>\n\n<p>And the column profile for the first column to be:</p>\n\n<pre><code>0.0009473414, 0.0132572344, 0.0572742202, 0.0132863528 \n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":70,"score":4,"question_id":12744282,"title":"How to deal with spaces in column names?","body":"<p>I know it is preferred if variable names do not have spaces in them. I have a situation where I need publication-quality charts, so axes and legends need to have properly formatted labels, ie with spaces. So, for example, in development I might have variables called \"Pct.On.OAC\" and Age.Group, but in my final plot I need \"% on OAC\" and \"Age Group\" to appear:</p>\n\n<pre><code>'data.frame':   22 obs. of  3 variables:\n $ % on OAC           : Factor w/ 11 levels \"0\",\"0.1-9.9\",..: 1 2 3 4 5 6 7 8 9 10 ...\n $ Age Group          : Factor w/ 2 levels \"Aged 80 and over\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ Number of Practices: int  47 5 33 98 287 543 516 222 67 14 ...\n</code></pre>\n\n<p>But when I try to plot these:</p>\n\n<pre><code>ggplot(dt.m, aes(x=`% on OAC`,y=`Number of Practices`, fill=`Age Group`)) +\n    geom_bar()\n)\n</code></pre>\n\n<p>no problem with that. But when I add a facet:</p>\n\n<pre><code>ggplot(dt.m, aes(x=`% on OAC`,y=`Number of Practices`, fill=`Age Group`)) +\n    geom_bar() +\n    facet_grid(`Age Group`~ .) \n</code></pre>\n\n<p>I get <code>Error in</code>[.data.frame<code>(base, names(rows)) : undefined columns selected</code></p>\n\n<p>If I change <code>Age Group</code> to <code>Age.Group</code> then it works fine, but as I said, I don't want the dot to appear in the title legend.</p>\n\n<p>So my questions are:</p>\n\n<ol>\n<li>Is there a workaround for the problem with the facet ?</li>\n<li>Is there a better general approach to dealing with the problem of spaces (and other characters) in variable names when I want the final plot to include them ? I suppose I can manually overide them, but that seems like a lot of faffing around.</li>\n</ol>\n"},{"tags":["c++","r","rcpp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12738758,"title":"Q. speed between \"R with indicator\" and \"c++ with for\"","body":"<p>I felt the speed of the following R code is good. Is there any way to increase speed using c++? I felt my c++ code is not that faster.</p>\n\n<pre><code>#R-code\n&gt; s&lt;-5\n&gt; t&lt;-2\n&gt; y&lt;-c(1,2,3,4,5)\n&gt; r&lt;-c(1,5,5,3,3)\n&gt; \n&gt; sindex&lt;-r[r==s]\n&gt; tindex&lt;-r[r==t]\n&gt; \n&gt; \n&gt; res&lt;-sum(y[sindex])+sum(y[tindex])\n&gt; \n&gt; sindex\n[1] 5 5\n&gt; tindex\nnumeric(0)\n&gt; \n&gt; res\n[1] 10\n\n#c++\nres1=0; res2=0;\nfor(i=0;i&lt;n;i++){\nif(r[i]==s){\n    res1=res1+y[s];\n}\nif(r[i]==t){\n    res2=res2+y[t];\n}\n}\nres=res1+res2\n</code></pre>\n"},{"tags":["mysql","r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12744373,"title":"r - how to assign 0 instead of \"no rows selected\" (dataframe 0 rows 0 columns)","body":"<p>I am trying to assign a value returned by a MySQL query to a variable in R, or 0 in case the query returns empty set (no records found). I thought I could use COALESCE like this:</p>\n\n<pre><code>data&lt;-dbGetQuery(con,\"COALESCE(( SELECT id FROM payments WHERE user_id=25578),0)\")\n</code></pre>\n\n<p>However, I get a syntax error message:</p>\n\n<pre><code>RS-DBI driver: (could not run statement: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM payments WHERE user_id=25578,0)' at line 1).\n</code></pre>\n\n<p>I have been trying to find an alternative but unsuccessful. Thanks for help!</p>\n"},{"tags":["r","search-and-replace","data.table"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":119,"score":2,"question_id":12723182,"title":"Combine set of conditions in data.table to extract value using binary search","body":"<p>Since my terrible execution and interpretation of my <a href=\"http://stackoverflow.com/questions/12669399/extract-value-from-one-dataframe-and-place-into-other-based-on-a-set-of-conditio\">previous question</a> I'll start over and will try to formulate the question as short and general possible. </p>\n\n<p>I have two dataframes (see the examples below). Each dataset contains the same number of columns. </p>\n\n<pre><code>tc &lt;- textConnection('\nID  Track1  Track2  Track3  Track4  Time    Loc\n4   15      \"\"      \"\"      50      40      1   \n5   17      115     109     55      50      1   \n6   17      115     109     55      60      1   \n7   13      195     150     60      70      1\n8   13      195     150     60      80      1\n9   \"\"      \"\"      181     70      90      2 #From this row, example data added\n10  \"\"      \"\"      182     70      92      2\n11  429     31      \"\"      80      95      3\n12  480     31      12      80      96      3 \n13  118     \"\"      \"\"      90      100     4\n14  120     16      213     90      101     4   \n')\n\nMATCHINGS &lt;- read.table(tc, header=TRUE)\n\ntc &lt;- textConnection('\nID  Track1  Track2  Track3  Track4  Time    Loc\n\"\"  15      \"\"      \"\"      50      40      1   \n\"\"  17      \"\"     109      55      50      1\n\"\"  17      432    109      55      65      1   \n\"\"  17      115     109     55      59      1       \n\"\"  13      195     150     60      68      1\n\"\"  13      195     150     60      62      1\n\"\"  10      5       1       10      61      3\n\"\"  13      195     150     60      72      1\n\"\"  40      \"\"      181     70      82      2 #From this row, example data added\n\"\"  \"\"      \"\"      182     70      85      2\n\"\"  429     \"\"      \"\"      80      90      3\n\"\"  \"\"      31      12      80      92      3\n\"\"  \"\"      \"\"      \"\"      90      95      4\n\"\"  118     16      213     90      96      4\n')\n\nINVOLVED &lt;- read.table(tc, header=TRUE)\n</code></pre>\n\n<p>The goal is to place the least recent ID from <code>MATCHINGS</code> into <code>INVOLVED</code> by matching on <code>Track1</code> to <code>Track4</code> and <code>Loc</code>. An extra condition is that the <code>Time</code> of the matching <code>INVOLVED</code> entry may not be higher than the <code>Time</code> of the entry in <code>MATCHING</code>. Furthermore a match on <code>Track1</code> is most preferred, a match on <code>Track4</code> is least preferred. However only <code>Track4</code> is always available (all other <code>Track</code>-columns can be empty). Thus the expected results are:</p>\n\n<pre><code>ID Track1 Track2 Track3 Track4 Time Loc\n4     15     \"\"     \"\"     50   40   1\n5     17     \"\"    109     55   50   1\n\"\"    17    432    109     55   65   1\n6     17    115    109     55   59   1\n7     13    195    150     60   68   1\n7     13    195    150     60   62   1\n\"\"    10      5      1     10   61   3\n8     13    195    150     60   72   1\n9     40     \"\"    181     70   82   2 #From this row, example data added\n10    \"\"     \"\"    182     70   85   2\n11    429    \"\"     \"\"     80   90   3\n12    \"\"     31     12     80   92   3\n13    \"\"     \"\"     \"\"     90   95   4 \n13    118    16    213     90   96   4\n</code></pre>\n\n<p>I tried to this with the <code>data.table</code> package, but fail in doing this efficient. Is it possible to get rid of the vector scans and efficiently go through the data without looping?</p>\n\n<pre><code>dat &lt;- data.table(MATCHINGS)\nfor(i in 1:nrow(INVOLVED)){\n    row &lt;- INVOLVED[i,]\n    match &lt;- dat[Time&gt;=row$Time][Loc==row$Loc][Track4==row$Track4][Track4!=\"\"][order(Time)][1]\n    if(!is.na(match$ID)){ INVOLVED$ID[i]&lt;-match$ID }\n    match &lt;- dat[Time&gt;=row$Time][Loc==row$Loc][Track3==row$Track3][Track3!=\"\"][order(Time)][1]\n    if(!is.na(match$ID)){ INVOLVED$ID[i]&lt;-match$ID }\n    match &lt;- dat[Time&gt;=row$Time][Loc==row$Loc][Track2==row$Track2][Track2!=\"\"][order(Time)][1]\n    if(!is.na(match$ID)){ INVOLVED$ID[i]&lt;-match$ID }\n    match &lt;- dat[Time&gt;=row$Time][Loc==row$Loc][Track1==row$Track1][Track1!=\"\"][order(Time)][1]\n    if(!is.na(match$ID)){ INVOLVED$ID[i]&lt;-match$ID }\n}\n</code></pre>\n\n<p><strong>update</strong></p>\n\n<p>Updated the example data showing the need for <code>Track 1 to 3</code>. As shown <code>Track1</code> is most important and <code>Track4</code> least important. Even if <code>Track1 to 3</code> match to <code>MATCHINGS x</code> and <code>Track4</code> matches to <code>MATCHINGS y</code>, the <code>ID</code> of <code>y</code> should be assigned to that <code>INVOLVED row</code>. So: <code>Track3</code> match overrides <code>Track4</code> match, <code>Track2</code> match overrides <code>Track3</code> match, <code>Track1</code> match overrides <code>Track2</code> match.   </p>\n"},{"tags":["r","data.table","plyr"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":133,"score":4,"question_id":9935755,"title":"reshaping data (a faster way)","body":"<p>I came across a table of freq. counts today I had to expand into a data frame of raw values.  I was able to do it but was wondering if there's a faster way using the reshape package or data.table?</p>\n\n<p><strong>The original table looked like this:</strong></p>\n\n<pre><code>   i1 i2 i3 i4  m  f\n1   0  0  0  0 22 29\n2   1  0  0  0 30 50\n3   0  1  0  0 13 15\n4   0  0  1  0  1  6\n5   1  1  0  0 24 67\n6   1  0  1  0  5 12\n7   0  1  1  0  1  2\n8   1  1  1  0 10 22\n9   0  0  0  1 10  7\n10  1  0  0  1 27 30\n11  0  1  0  1 14  4\n12  0  0  1  1  1  0\n13  1  1  0  1 54 63\n14  1  0  1  1  8 10\n15  0  1  1  1  8  6\n16  1  1  1  1 57 51\n</code></pre>\n\n<p><strong>Here's an easy grab of the data using dput:</strong></p>\n\n<pre><code>dat &lt;- structure(list(i1 = c(0L, 1L, 0L, 0L, 1L, 1L, 0L, 1L, 0L, 1L, \n0L, 0L, 1L, 1L, 0L, 1L), i2 = c(0L, 0L, 1L, 0L, 1L, 0L, 1L, 1L, \n0L, 0L, 1L, 0L, 1L, 0L, 1L, 1L), i3 = c(0L, 0L, 0L, 1L, 0L, 1L, \n1L, 1L, 0L, 0L, 0L, 1L, 0L, 1L, 1L, 1L), i4 = c(0L, 0L, 0L, 0L, \n0L, 0L, 0L, 0L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), m = c(22L, 30L, \n13L, 1L, 24L, 5L, 1L, 10L, 10L, 27L, 14L, 1L, 54L, 8L, 8L, 57L\n), f = c(29L, 50L, 15L, 6L, 67L, 12L, 2L, 22L, 7L, 30L, 4L, 0L, \n63L, 10L, 6L, 51L)), .Names = c(\"i1\", \"i2\", \"i3\", \"i4\", \"m\", \n\"f\"), class = \"data.frame\", row.names = c(NA, -16L))\n</code></pre>\n\n<p><strong>My approach(s) to reshape the data (is there a faster way?):</strong></p>\n\n<pre><code>#step 1: method 1 (in this case binding and stacking uses less code than reshape)\ndat2 &lt;- data.frame(rbind(dat[,1:4], dat[, 1:4]), \n    sex = rep(c('m', 'f'), each=16),\n    n = c(dat$m, dat$f))\ndat2\n\n#step 1: method 2    \ndat3 &lt;- reshape(dat, direction = \"long\", idvar = 1:4,\n    varying = list(c(\"m\", \"f\")),\n    v.names = c(\"n\"),\n    timevar = \"sex\",\n    times = c(\"m\", \"f\"))\n    rownames(dat3) &lt;- 1:nrow(dat3)\n    dat3 &lt;- data.frame(dat3)\n    dat3$sex &lt;- as.factor(dat3$sex)\n\nall.equal(dat3, dat2) #just to show both method 1 and 2 give the same data frame\n\n#step 2\ndat4 &lt;- dat2[rep(seq_len(nrow(dat2)), dat2$n), 1:5]\nrownames(dat4) &lt;- 1:nrow(dat4)\ndat4\n</code></pre>\n\n<p>I assume this is a common problem as when you want to take a table from an article and reproduce it, it requires some unpacking.  I am finding myself doing this more and more and want to make sure I'm being efficient.</p>\n"},{"tags":["r","data.table","sqldf"],"answer_count":4,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":551,"score":7,"question_id":4697914,"title":"speeding up data frame matching","body":"<p>I have two dataframes, much like these:</p>\n\n<pre><code>data = data.frame(data=cbind(1:12,rep(c(1,2),6),rep(c(1,2,3),4)))\ncolnames(data)=c('v','h','c')\n\nlookup = data.frame(data=cbind(c(rep(1,3),rep(2,3)),rep(c(1,2,3),2),21:26))\ncolnames(lookup)=c('h','c','t')\n</code></pre>\n\n<p>I want to subtract lookup$t from data$v where the h and c columns match.</p>\n\n<p>I thought something like this would work</p>\n\n<pre><code>data$v-lookup$t[lookup$h==data$h&amp;lookup$c==data$c]\n</code></pre>\n\n<p>but doesn't magically know that I want to implicitly iterate over the rows of data</p>\n\n<p>I ended up doing this</p>\n\n<pre><code>myt = c()\nfor(i in 1:12) {\nmyt[i] = lookup$t[lookup$h==data$h[i]&amp;lookup$c==data$c[i]]\n}\n</code></pre>\n\n<p>which works fine, but I'm hoping someone can suggest a more sensible way that doesn't involve a loop. </p>\n"},{"tags":["r","grouping","data.table","plyr"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":92,"score":4,"question_id":12714182,"title":"grouping on string fields in R","body":"<p>I have a data frame like this:</p>\n\n<pre><code>         date      time userid        status\n1  02/25/2012  09:22:10   aabc     logged_in\n2  02/25/2012  09:30:10   aabc    logged_out\n3  02/25/2012  09:29:20   abbc    logged_out\n4  02/25/2012  09:27:30    abc     logged_in\n5  02/25/2012  09:26:29    abc  login_failed\n6  02/25/2012  09:26:39    abc  login_failed\n7  02/25/2012  09:26:52    abc  login_failed\n8  02/25/2012  09:27:09    abc  login_failed\n9  02/25/2012  09:27:20    abc  login_failed\n10 02/25/2012  09:24:10   abdc     logged_in\n11 02/25/2012  09:24:12   abdc    logged_out\n12 02/25/2012  09:22:10   abhc     logged_in\n13 02/25/2012  09:30:10   abuc     logged_in\n14 02/25/2012  09:30:14   abuc    logged_out\n15 02/25/2012  09:29:40    baa     logged_in\n</code></pre>\n\n<p>I want to the userids, status and \"count\" of the login_failures for each userid. I did this:</p>\n\n<p><code>ddply(mytbl, c('userid', 'status'), function(x) c(count=nrow(x)))</code> , but this gives the count for all userids. I want to restrict my output to only those userids whose status is 'login _failed'. Any ideas? I have seen questions on grouping by numeric fields, but, none on strings.</p>\n\n<p>I am not very familiar with all the plyr features. It will great to see how this can be done using summarize, aggregate, sqldf, data.table etc. Slowly understanding each of them.</p>\n\n<p>Thanks\nSri</p>\n"},{"tags":["r","list","data.frame","data.table"],"answer_count":3,"favorite_count":3,"up_vote_count":21,"down_vote_count":0,"view_count":1742,"score":21,"question_id":4863341,"title":"how to merge a list of data.frames by row","body":"<p>Most of the questions about merging data.frame in lists on SO don't quite relate to what I'm trying to get across here, but feel free to prove me wrong.</p>\n\n<p>I have a list of data.frames. I would like to \"rbind\" rows into another data.frame by row. In essence, all first rows form one data.frame, second rows second data.frame and so on.\nResult would be a list of the same length as the number of rows in my original data.frame(s). So far, the data.frames are identical in dimensions.</p>\n\n<p>Here's some data to play around with.</p>\n\n<pre><code>sample.list &lt;- list(data.frame(x = sample(1:100, 10), y = sample(1:100, 10), capt = sample(0:1, 10, replace = TRUE)),\n        data.frame(x = sample(1:100, 10), y = sample(1:100, 10), capt = sample(0:1, 10, replace = TRUE)),\n        data.frame(x = sample(1:100, 10), y = sample(1:100, 10), capt = sample(0:1, 10, replace = TRUE)),\n        data.frame(x = sample(1:100, 10), y = sample(1:100, 10), capt = sample(0:1, 10, replace = TRUE)),\n        data.frame(x = sample(1:100, 10), y = sample(1:100, 10), capt = sample(0:1, 10, replace = TRUE)),\n        data.frame(x = sample(1:100, 10), y = sample(1:100, 10), capt = sample(0:1, 10, replace = TRUE)),\n        data.frame(x = sample(1:100, 10), y = sample(1:100, 10), capt = sample(0:1, 10, replace = TRUE)))\n</code></pre>\n\n<p>Here's what I've come up with with the good ol' for loop.</p>\n\n<pre><code>#solution 1\nmy.list &lt;- vector(\"list\", nrow(sample.list[[1]]))\nfor (i in 1:nrow(sample.list[[1]])) {\n    for (j in 1:length(sample.list)) {\n        my.list[[i]] &lt;- rbind(my.list[[i]], sample.list[[j]][i, ])\n    }\n}\n\n#solution 2 (so far my favorite)\nsample.list2 &lt;- do.call(\"rbind\", sample.list)\nmy.list2 &lt;- vector(\"list\", nrow(sample.list[[1]]))\n\nfor (i in 1:nrow(sample.list[[1]])) {\n    my.list2[[i]] &lt;- sample.list2[seq(from = i, to = nrow(sample.list2), by = nrow(sample.list[[1]])), ]\n}\n</code></pre>\n\n<p>Can this be improved using vectorization without much brainhurt? Correct answer will contain a snippet of code, of course. \"Yes\" as an answer doesn't count.</p>\n\n<p><em>EDIT</em></p>\n\n<pre><code>#solution 3 (a variant of solution 2 above)\nind &lt;- rep(1:nrow(sample.list[[1]]), times = length(sample.list))\nmy.list3 &lt;- split(x = sample.list2, f = ind)\n</code></pre>\n\n<p><em>BENCHMARKING</em></p>\n\n<p>I've made my list larger with more rows per data.frame. I've benchmarked the results which are as follows:</p>\n\n<pre><code>#solution 1\nsystem.time(for (i in 1:nrow(sample.list[[1]])) {\n    for (j in 1:length(sample.list)) {\n        my.list[[i]] &lt;- rbind(my.list[[i]], sample.list[[j]][i, ])\n    }\n})\n   user  system elapsed \n 80.989   0.004  81.210 \n\n# solution 2\nsystem.time(for (i in 1:nrow(sample.list[[1]])) {\n    my.list2[[i]] &lt;- sample.list2[seq(from = i, to = nrow(sample.list2), by = nrow(sample.list[[1]])), ]\n})\n   user  system elapsed \n  0.957   0.160   1.126 \n\n# solution 3\nsystem.time(split(x = sample.list2, f = ind))\n   user  system elapsed \n  1.104   0.204   1.332 \n\n# solution Gabor\nsystem.time(lapply(1:nr, bind.ith.rows))\n   user  system elapsed \n  0.484   0.000   0.485 \n\n# solution ncray\nsystem.time(alply(do.call(\"cbind\",sample.list), 1,\n                .fun=matrix, ncol=ncol(sample.list[[1]]), byrow=TRUE,\n                dimnames=list(1:length(sample.list),names(sample.list[[1]]))))\n   user  system elapsed \n 11.296   0.016  11.365\n</code></pre>\n"},{"tags":["r","neural-network"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1189,"score":1,"question_id":4891899,"title":"how to predict new cases using the neuralnet package","body":"<p>Using RGUI. I have a dataset called Data. The response variable that I'm interested in is contained in the first column of Data. </p>\n\n<p>I have training sets of Data called DataTrain and DataTest.</p>\n\n<p>With DataTrain I trained a neural network model (called DataNN) using the package and function neuralnet.  </p>\n\n<pre><code>&gt; DataNN = neuralnet(DataTrain[,1] ~ DataTrain[,2] + DataTrain[,3], hidden = 1,\n    data = DataTrain) \n</code></pre>\n\n<p>Does anyone know how to create a prediction on this model using the test set (DataTest)?</p>\n\n<p>Normally (for other models) I would use \"predict\" for this. E.g.</p>\n\n<pre><code>&gt; DataPred = predict(DataNN, DataTest)\n</code></pre>\n\n<p>But when doing this for neuralnet I get:</p>\n\n<pre><code>&gt; DataPred = predict(DataNN, DataTest)\n\nError in UseMethod(\"predict\") : \nno applicable method for 'predict' applied to an object of class \"nn\"  \n</code></pre>\n\n<p>Obviously I can't run \"predict\" on this model. Does anyone know of any alternatives?</p>\n\n<p>I've checked the help for neuralnet and I found a method called \"prediction\" (http://127.0.0.1:21861/library/neuralnet/html/prediction.html). I don't think it's what I want at all though, or at least I don't know how to apply it to my Data.</p>\n\n<p>Any help would be appreciated (if there is any solution to this at all).</p>\n"},{"tags":["r","lm","predict"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12602159,"title":"Use rlm model for a newdata","body":"<p>how can I use a created rlm model (see below) for a new test data which differs from the training data through having only 1 row. When I try to predict the target value with the test data t just like <code>predict(regmod,t)</code> than I get the message that the test data differs from the training data in row counts and with further warnings... <br/>\nI would like to get only one value for the target value.</p>\n\n<pre><code>regmod&lt;-rlm( y ~ x1*x2*x3+x4),psi=psi.huber,method=\"M\")\n</code></pre>\n\n<p>Below an exemplary structure of data how I use for the rlm model.\nThe point which effects the warnings is that the test data has only one row, I just would\nlike to predict the target value of the test data (only one value) only one row.</p>\n\n<p>training data:</p>\n\n<p>y; x1; x2;  x3;  x4;</p>\n\n<p>2;  3;  4;   5;   6;</p>\n\n<p>7;  8;  9;  10;  11;</p>\n\n<p>9;  6;  7;   9;  12;</p>\n\n<p>.;´ .;  .;   .;   .;</p>\n\n<p>.;  .;  .;   .;   .;</p>\n\n<p>.;  .;  .;   .;   .;</p>\n\n<p>95; 7; 82;  21;  12;</p>\n\n<p>test tada:</p>\n\n<p>y; x1; x2; x3; x4;</p>\n\n<p>_; 5;  2;  8;  2; </p>\n\n<p>Would be happy if someone could give me ideas.</p>\n"},{"tags":["r","ggplot2","ggplot"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":129,"score":2,"question_id":12629492,"title":"math symbols in ggplot2 0.9.2","body":"<p>When you want to add math symbols to <code>facet_wrap</code> you used to be able to use the <code>grid</code> packge as in <a href=\"http://stackoverflow.com/questions/11979017/changing-facet-label-to-math-formula-in-ggplot2\">(example taken from here)</a>:</p>\n\n<pre><code>library(ggplot2); library(grid)\nd &lt;- ggplot(diamonds, aes(carat, price, fill = ..density..)) \n    xlim(0, 2) + stat_binhex(na.rm = TRUE) + opts(aspect.ratio = 1)\nd &lt;- d + facet_wrap(~ color, ncol = 4)\ngrob &lt;- ggplotGrob(d)\nstrip_elem &lt;- grid.ls(getGrob(grob, \"strip.text.x\", grep=TRUE, global=TRUE))$name\ngrob &lt;- editGrob(grob, strip_elem[1], label=expression(Y[1]))\ngrid.draw(grob)\n</code></pre>\n\n<p>This no longer works as it gives this error:</p>\n\n<pre><code>&gt;  strip_elem &lt;- grid.ls(getGrob(grob, \"strip.text.x\", grep=TRUE, global=TRUE))$name\nError in getGrob(grob, \"strip.text.x\", grep = TRUE, global = TRUE) : \n  It is only valid to get a child from a 'gTree'\n&gt; grob &lt;- editGrob(grob, strip_elem[1], label=expression(Y[1]))\nError in editGrob(grob, strip_elem[1], label = expression(Y[1])) : \n  object 'strip_elem' not found\n</code></pre>\n\n<p>How can we add math symbols in version 0.9.2?</p>\n"},{"tags":["r","data","append","data.frame","frame"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":95,"score":1,"question_id":12740784,"title":"appending list to data frame in R","body":"<p>I have created an empty data frame in R with two columns:</p>\n\n<pre><code>d&lt;-data.frame(id=c(), numobs=c())\n</code></pre>\n\n<p>I would like to append this data frame (in a loop) with a list, <code>d1</code> that has output:</p>\n\n<pre><code>[1] 1  100\n</code></pre>\n\n<p>I tried using <code>rbind</code>:</p>\n\n<pre><code>d&lt;-rbind(d, d2)\n</code></pre>\n\n<p>and <code>merge</code>:</p>\n\n<pre><code>d&lt;-merge(d, d2)\n</code></pre>\n\n<p>And I even tried just making a list of lists and then converting it to a data frame, and then giving that data frame names:</p>\n\n<pre><code>d&lt;-rbind(dlist1, dlist2)\ndframe&lt;-data.frame(d)\nnames(dframe)&lt;-c(\"id\",\"numobs\")\n</code></pre>\n\n<p>But none of these seem to meet the standards of a routine checker (this is for a class), which gives the error:</p>\n\n<pre><code>Error: all(names(cc) %in% c(\"id\", \"nobs\")) is not TRUE\n</code></pre>\n\n<p>Even though it works fine in my workspace.</p>\n\n<p>This is frustrating since the error does not reveal where the error is occuring.</p>\n\n<p>Can anyone help me to either merge 2 data frames or append a data frame with a list?</p>\n\n<p>Thanks!</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12725603,"title":"Reading big data in R by read.big.matrix","body":"<p>I am reading a data of dimension 3131875*5 in r using <code>read.big.matrix</code>. My data has both character and numeric columns including date variable. The command which I should use is </p>\n\n<pre><code>as1 &lt;- read.big.matrix(\"C:/Documents and Settings/Arundhati.Mukherjee/My Documents/Arundhati/big data/MB07_Arundhati/sample2.txt\",\n                       header=TRUE, \n                       backingfile=\"session.bin\",\n                       descriptorfile=\"session.desc\",\n                       type = NA)\n</code></pre>\n\n<p>But <code>type = NA</code> is not accepted in R in this case and I am getting an error:</p>\n\n<pre><code>Error in filebacked.big.matrix(nrow = nrow, ncol = ncol, type = type,  : \n  Problem creating filebacked matrix.\nIn addition: Warning messages:\n1: In na.omit(as.integer(firstLineVals)) : NAs introduced by coercion\n2: In na.omit(as.double(firstLineVals)) : NAs introduced by coercion\n3: In read.big.matrix(\"C:/Documents and Settings/Arundhati.Mukherjee/My Documents/Arundhati/big data/MB07_Arundhati/sample2.txt\",  :\n  Because type was not specified, we chose double based on the first line of data.\n</code></pre>\n\n<p>I need to know what should be the <code>type</code> here. I tried with options like <code>double</code> but that is throwing me same error.</p>\n\n<p>Please help me.</p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":4,"up_vote_count":6,"down_vote_count":1,"view_count":1512,"score":5,"question_id":6467277,"title":"Proxy setting for R","body":"<p>I am facing problem while conecting R with internet in my office. May be this due to LAN settings. I tried the almost all possible ways I come across in the web (see below) but still in vain. </p>\n\n<ul>\n<li><p>Method1: Invoking R using --internet2</p></li>\n<li><p>Method2: Invoking R by setting \"~/Rgui.exe\" <code>http_proxy=http:/999.99.99.99:8080/ http_proxy_user=ask</code></p></li>\n<li><p>Method3: Setting Setinternet2=TRUE</p></li>\n<li><p>Method4:</p>\n\n<p><code>curl &lt;- getCurlHandle()</code></p>\n\n<p><code>curlSetOpt(.opts = list(proxy = '999.99.99.99:8080'), curl = curl)</code></p>\n\n<p><code>Res &lt;- getURL('http://www.cricinfo.com', curl = curl)</code></p></li>\n</ul>\n\n<p>In above all methods I can able to load packages directly from CRAN also able to download files using download.file command</p>\n\n<p>But using <code>getURL(RCurl)</code>, <code>readHTMLTable(XML)</code>, <code>htmlTreeParse(XML)</code> commands I am unable to extract web data. I am getting <code>~&lt;HEAD&gt;\\n&lt;TITLE&gt;Access Denied&lt;/TITLE&gt;\\n&lt;/HEAD&gt;~</code> error.</p>\n\n<p>How to set LAN proxy settings for XML package in R?</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":12740097,"title":"ggplot2 remove nonsignificant zeros","body":"<p>In a barplot that I've flipped the coordinates and stacked as a proportional bar I'd like to change the y scale (now in the x scale position) to not have non significant zeros:</p>\n\n<p>My attempt:</p>\n\n<pre><code>ggplot(diamonds, aes(color, fill=cut)) + \n    geom_bar(position='fill') + coord_flip() +\n    scale_y_discrete(breaks = c(0, .25, .5, .75, 1), \n        labels=c(\"0\", \".25\", \".5\", \".75\", \"1\"))\n</code></pre>\n\n<p>Current plot:\n<img src=\"http://i.stack.imgur.com/Yuu9l.png\" alt=\"enter image description here\"></p>\n"},{"tags":["r","data"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":588,"score":0,"question_id":7374314,"title":"Data cleaning in Excel sheets using R","body":"<p>I have data in Excel sheets and I need a way to clean it. I would like remove inconsistent values, like Branch name is specified as (Computer Science and Engineering, C.S.E, C.S, Computer Science). So how can I bring all of them into single notation? </p>\n"},{"tags":["vb.net","r","distribution"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":113,"score":-1,"question_id":12719666,"title":"Random Number Generation using R in VB.NET","body":"<p>How to do following,</p>\n\n<p>a) Get R syntax working in VB.NET</p>\n\n<p>b) Generate random number from triangular distribution</p>\n\n<p>(I have managed to add reference to R in VB.NET.)</p>\n\n<p>Thanks</p>\n"},{"tags":["c++","r","rcpp"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12719334,"title":"How to handle list in R to Rcpp","body":"<p>I have a list in R that x&lt;-list(c(1,2,3), c(4,5), c(5,5), c(6)). I want to input the list to Rcpp and return them as an average vector, c(2, 4.5, 5, 6).</p>\n\n<p>I am not sure how to handle the list in Rcpp. I got an error message, so could someone check my code?</p>\n\n<pre><code>library(inline)\n\nfx = cxxfunction(signature(x='List'), body = \n'\n    Rcpp::List xlist(x);\n    int n = xlist.size();\n    double res[n];\n\n    for(int i=0; i&lt;n; i++) {\n        Rcpp NumericVector y(xlist[i]);\n        int m=y.size();\n        res[i]=0;\n        for(int j=0; j&lt;m; j++){\n            res[i]=res[i]+y[j]  \n        }\n    }\n\n  return(wrap(res));\n'\n, plugin='Rcpp')\n\nx&lt;-list(c(1,2,3), c(4,5), c(5,5), c(6))\nfx(x)\n</code></pre>\n"},{"tags":["r","reference-class"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":12738402,"title":"Building an R package that defines reference classes","body":"<p>I am creating an R package. The package defines several reference classes. There is a dependency between the classes because one is the base class and the others are subclasses. Due to this dependency, the package files must be loaded in a certain order: the <em>base class</em> first, then the subclasses. With just my luck, however, R is loading the <em>subclasses</em> first and complaining that the base class is not defined.</p>\n\n<p>How can I force the package's source files to be executed in a particular order?</p>\n\n<p>My current, kludge \"solution\" is to put all class definitions into one source file, with the base class defined first. Talk about ugly. There's gotta be a better way.</p>\n"},{"tags":["r","function","loops","panel","inequality"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":12722653,"title":"Calculate Concentration Index by Region and Year (panel data)","body":"<p>This is my first post and very stuck on trying to build my first function that calculates Herfindahl measures on Firm gross output, using panel data (year=1998:2007) with firms = obs. by year (1998-2007) and region (\"West\",\"Central\",\"East\",\"NE\") and am having problems with passing arguments through the function. I think I need to use two loops (one for time and one for region).  Any help would be useful.. I really dont want to have to subset my data 400+ times to get herfindahl measures one at a time.  Thanks in advance!</p>\n\n<p>Below I provide: 1) My starter code (only returns one value); 2) desired output (2-bins that contain the hefindahl measures by 1) year and by 2) year-region); and 3) original data</p>\n\n<h2>1) My starter Code</h2>\n\n<pre><code>myherf&lt;- function (x, time, region){\ntime = year # variable is defined in my data and includes c(1998:2007)\nregion = region # Variable is defined in my data, c(\"West\", \"Central\",\"East\",\"NE\")\n    for (i in 1:length(time)) {\n      for (j in 1:length(region)) {\n        herf[i,j] &lt;- x/sum(x)\n        herf[i,j] &lt;- herf[i,j]^2\n        herf[i,j] &lt;- sum(herf[i,j])^1/2        \n      }\n    }\n  return(herf[i,j])\n}\n</code></pre>\n\n<p>myherf(extractiveoutput$x, i, j)<br>\n  Error in herf[i, j] &lt;- x/sum(x) : object 'herf' not found </p>\n\n<hr>\n\n<p>2) My desired outcome is the following two vectors:   </p>\n\n<pre><code>A. (1x10 vector)              \nYear  herfindahl(yr)  \n1998    x                        \n1999    x                       \n...                             \n2007    x                       \n\nB. (1x40 vector)  \nYear  Region   hefindahl(yr-region)  \n1998  West      x                                     \n1998  Central   x                                    \n1998  East      x    \n1998  NE        x    \n...  \n2007  West      x    \n2007  Central   x  \n2007  East      x   \n2007  northeast x   \n</code></pre>\n\n<hr>\n\n<p>3) Original Data   </p>\n\n<pre><code>Obs. industry year  region    grossoutput  \n1         06 1998    Central 0.048804830  \n2         07 1998    Central 0.011222478  \n3         08 1998    Central 0.002851575  \n4         09 1998    Central 0.009515881  \n5         10 1998    Central 0.0067931  \n...  \n\n12        06 1999    Central 0.050861447  \n13        07 1999    Central 0.008421093  \n14        08 1999    Central 0.002034649  \n15        09 1999    Central 0.010651283  \n16        10 1999    Central 0.007766118  \n...  \n111       06 1998       East 0.036787413  \n112       07 1998       East 0.054958377  \n113       08 1998       East 0.007390260  \n114       09 1998       East 0.010766598  \n115       10 1998       East 0.015843418  \n...  \n436       31 2007       West 0.166044176  \n437       32 2007       West 0.400031011  \n438       33 2007       West 0.133472059  \n439       34 2007       West 0.043669662  \n440       45 2007       West 0.017904620  \n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":62,"score":1,"question_id":12737441,"title":"How R interprets ... arguments?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3057341/how-to-use-rs-ellipsis-feature-when-writing-your-own-function\">How to use R&#39;s ellipsis feature when writing your own function?</a>  </p>\n</blockquote>\n\n\n\n<p>I am wondering how R interprets ... arguments? </p>\n\n<p>For instance consider the <code>makeContrasts(..., contrasts=NULL, levels)</code> of package <code>limma</code>. You can run: </p>\n\n<pre><code> &gt; require(limma)\n &gt; makeContrasts(a + b, b+c, levels=letters[1:3])\n\n       Contrasts\n Levels a + b b + c\n      a     1     0\n      b     1     1\n      c     0     1\n</code></pre>\n\n<p>and it interprets the parameters <code>a + b, b+c</code> without <code>a, b</code> and <code>c</code> being already defined as R objects.</p>\n\n<p>I tried to make a similar function:</p>\n\n<pre><code>foo = function(...) {\n    print(typeof(...))\n}\n\n&gt; foo(a + b) \nError in typeof(...) : object 'a' not found\n</code></pre>\n\n<p>So I am really confused what type of object is really passed to <code>makeContrasts</code>? And is there anyway to modify this object?</p>\n"},{"tags":["r","lme4"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12737353,"title":"Using a matrix of predictors with lmer()","body":"<p>I am attempting to fit a model with a large number of predictors, such that it would be tedious to enumerate them in a model formula. This is straightforward to do with lm():</p>\n\n<pre><code>indicatorMatrix &lt;- data.frame(matrix(rbinom(26000, 1, 1/3), ncol = 26))\ncolnames(indicatorMatrix) &lt;- LETTERS\nsomeDV &lt;- rnorm(nrow(indicatorMatrix))\n\nhead(indicatorMatrix) \n\n# One method, enumerating variables by name:\nolsModel1 &lt;- lm(someDV ~ A + B + C + D,  # ...etc.\n               data = indicatorMatrix)\n\n# Preferred method, including the matrix of predictors:\nolsModel2 &lt;- lm(someDV ~ as.matrix(indicatorMatrix))\nsummary(olsModel2)\n</code></pre>\n\n<p>Since I have a very large number of predictors (more than the 26 in this invented example), I don't want to list them individually as in the first example (<code>someDV ~ A + B + C + D...</code>), and I can avoid this by just including the predictors <code>as.matrix</code>.</p>\n\n<p>However, I want to fit a mixed effects model, like this:</p>\n\n<pre><code>library(lme4)\nmeModel1 &lt;- lmer(someDV ~ (1 | A) + (1 | B) + (1 | C),  # ...etc.\n                 data = indicatorMatrix)\nsummary(meModel1)\n</code></pre>\n\n<p><strong>Except</strong> that I want to include a large number of random effects terms. Rather than having to type <code>(1 | A) ... (1 | ZZZ)</code>, I would like to include each predictor in a manner analogous to the matrix approach used for <code>olsModel2</code> above. The following, obviously, does not work:</p>\n\n<pre><code>meModel2 &lt;- lmer(someDV ~ (1 | as.matrix(indicatorMatrix)))\n</code></pre>\n\n<p>Do you have any suggestions for how I can best replicate the matrix-predictor approach for random effects with lmer()? I am very willing to consider \"pragmatic\" solutions (i.e. hacks), so long as they are \"programmatic,\" and don't require me to copy &amp; paste, etc. etc.</p>\n\n<p>Thanks in advance for your time.</p>\n"},{"tags":["regex","r"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":95,"score":2,"question_id":12735503,"title":"Extract numbers between brackets within a string","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8613237/extract-info-inside-all-parenthesis-in-r-regex\">Extract info inside all parenthesis in R (regex)</a>  </p>\n</blockquote>\n\n\n\n<p>I inported data from excel and one cell consists of these long strings that contain number and letters, is there a way to extract only the numbers from that string and store it in a new variable? Unfortunately, some of the entries have two sets of brackets and I would only want the second one? Could I use grep for that?</p>\n\n<p>the strings look more or less like this, the length of the strings vary however:</p>\n\n<pre><code>\"East Kootenay C (5901035) RDA 01011\"\n</code></pre>\n\n<p>or like this:</p>\n\n<pre><code>\"Thompson-Nicola J (Copper Desert Country) (5933039) RDA 02020\"\n</code></pre>\n\n<p>All I want from this is <code>5901035</code> and <code>5933039</code></p>\n\n<p>Any hints and help would be greatly appreciated.</p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":98,"score":2,"question_id":12735795,"title":"Pass ... argument to another function","body":"<p>I am writing a function foo(..., lev) on the base of makeContrasts function of package limma (of bioconductor):</p>\n\n<pre><code>makeContrasts(..., contrasts=NULL, levels)\n</code></pre>\n\n<p>I want to pass the ... argument of foo 'as-is' to makeContrasts. Here is my code:</p>\n\n<pre><code>foo = function(..., lev) {\n    e = substitute(list(...))\n    makeContrasts(e[[2]], levels=lev)\n}\n\nfoo(a + b, design)\n</code></pre>\n\n<p>The reason I have used e[[2]] is that e will be <strong>list(a+b)</strong> and e[[1]] is <strong>list</strong> but e[[2]] is what I need: <strong>a + b</strong></p>\n\n<p>But the problem is that the actual argument passed to makeContrast is  <strong>e[[2]]</strong> and not <strong>a + b</strong>.\nSo what to do?</p>\n\n<p>The complete parameter assignments are as below:</p>\n\n<pre><code>ct = factor(c(\"a\",\"b\"))\ndesign = model.matrix(~0+ct)\ncolnames(design)=levels(ct)\nmakeContrasts(a+b,levels=design) # It works\nfoo(a+b, design) # Does not work\n</code></pre>\n"},{"tags":["r","xlsx"],"answer_count":6,"favorite_count":5,"up_vote_count":10,"down_vote_count":0,"view_count":3656,"score":10,"question_id":7049272,"title":"Importing .xlsx file into R","body":"<p>Please can someone help me on the best way to import an excel 2007 (.xlsx) file into R. I have tried several methods and none seems to work. I have upgraded to 2.13.1, windows XP, xlsx 0.3.0, I don't know why the error keeps coming up. I tried:</p>\n\n<pre><code>AB&lt;-read.xlsx(\"C:/AB_DNA_Tag_Numbers.xlsx\",\"DNA_Tag_Numbers\")\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>AB&lt;-read.xlsx(\"C:/AB_DNA_Tag_Numbers.xlsx\",1)\n</code></pre>\n\n<p>but I get the error:</p>\n\n<pre><code> Error in .jnew(\"java/io/FileInputStream\", file) : \n  java.io.FileNotFoundException: C:\\AB_DNA_Tag_Numbers.xlsx (The system cannot find the file specified)\n</code></pre>\n\n<p>Thank you.</p>\n"},{"tags":["r","cluster-analysis","histogram","segmentation","threshold"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":5,"view_count":76,"score":-1,"question_id":12734895,"title":"non parametric approach for histogram segmentation in R","body":"<p>Does anyone have an implementation of this algorithm in R?</p>\n\n<p><a href=\"http://perso.telecom-paristech.fr/~delon/HistoSeg/\" rel=\"nofollow\">http://perso.telecom-paristech.fr/~delon/HistoSeg/</a></p>\n\n<p>Based on this paper:</p>\n\n<p><a href=\"http://dmi.uib.es/~tami/publicacions/HistSegpreprint.pdf\" rel=\"nofollow\">http://dmi.uib.es/~tami/publicacions/HistSegpreprint.pdf</a></p>\n\n<p>EDIT: This got some downvotes right away. I'm not exactly sure why. This is not homework. I am not a student. I would like to experiment with this on a large number of histograms and possibly integrate into an application I use to analyze real time data structures.</p>\n\n<p>I was simply asking if anyone knew of an implementation. I search through CRAN and did not find one. I used my limited google skills to find something with no luck. If someone knows of an implementation in a language other than R, I could port it. Thank you.</p>\n"},{"tags":["r","match"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12730378,"title":"paring down arrays with partially overlapping information","body":"<p>The problem:<br>\nUsing R, I have two arrays, both with the same type of data (e.g. same row, column, and/or layer names). However, they have different dimensions. The row &amp; column names are partially overlapping. That is, most levels of row and column factors appear in both arrays, but some are unique to each array. I want to take one of these arrays, and pare it down so that is consists ONLY of the row &amp; column levels that are common to both arrays. I have been able to accomplish this before by writing my own very convoluted function, but it seems like this really ought to be a simple operation.  Can anybody point me in the right direction for this?</p>\n\n<p>Here is some example code of what I thought was an unnecessarily laborious way to accomplish this.  In this case, sp.ixn.core was a smaller 2D array, and I wanted to pare down a 3D array so the rows and columns matched sp.ixn.core ... the last bit was me double checking to see if the numbers added up correctly.</p>\n\n<pre><code>temp=table(data$plant,data$Species,data$jdate)\ntemp2=array(,dim=c(nrow(sp.ixn.core),ncol(temp),dim(temp)[3]))\n\nfor (i in 1:length(rownames(sp.ixn.core))){\ntemp2[i,,] = temp[rownames(temp) == rownames(sp.ixn.core)[i],,]\n}\n\ncolnames(temp2) = colnames(temp)\ntemp3=array(,dim=c(nrow(sp.ixn.core),ncol(sp.ixn.core),dim(temp)[3]))\nfor (i in 1:length(colnames(sp.ixn.core))){\ntemp3[,i,] = temp2[,colnames(temp2) == colnames(sp.ixn.core)[i],]\n}\ndim(temp3)\n\nsp.ixn.core.tbl = temp3\ndimnames(sp.ixn.core.tbl)[[3]] = dimnames(temp)[[3]]\ndimnames(sp.ixn.core.tbl)[[2]] = colnames(sp.ixn.core)\ndimnames(sp.ixn.core.tbl)[[1]] = rownames(sp.ixn.core)\ndimnames(sp.ixn.core.tbl)\n\nfor (i in 1:nrow(sp.ixn.core)){\n    if (sum(sp.ixn.core.tbl[i,,]) == rowSums(sp.ixn.core)[i])\n        print(\"yes\")\n}\n\nfor (i in 1:ncol(sp.ixn.core)){\n    if (sum(sp.ixn.core.tbl[,i,]) == colSums(sp.ixn.core)[i])\n        print(\"yes\")\n}\n</code></pre>\n"},{"tags":["r","xml-parsing"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":12716519,"title":"\"XML content does not seem to be XML\" : Error in xmlTreeParse in R","body":"<p>I am going through the <a href=\"http://cran.r-project.org/web/packages/topicmodels/vignettes/topicmodels.pdf\" rel=\"nofollow\">topicmodels</a> tutorial in R.  Around page 12, they strip HTML tags and Greek letters:</p>\n\n<pre><code>R&gt; library(\"XML\")\nR&gt; remove_HTML_markup &lt;- function(s) {\n+ doc &lt;- htmlTreeParse(s, asText = TRUE, trim = FALSE)\n+ xmlValue(xmlRoot(doc))\n+ }\nR&gt; remove_HTML_markup(JSS_papers[1,\"description\"])\nError: XML content does not seem to be XML, nor to identify a file name ...\n</code></pre>\n\n<p><code>JSS_papers</code> stores metadata related to a collection of papers downloaded from a journal.  The entry under the <code>description</code> tag is the abstract of the article.  This one doesn't have any tags:     </p>\n\n<pre><code>JSS_papers[1,\"description\"] = \"The fit of a variogram model to spatially-distributed \n    data is often difficult to assess. A graphical diagnostic written in S-plus is   \n    introduced that allows the user to determine both the general quality of the fit of a \n    variogram model, and to find specific pairs of locations that do not have measurements \n    that are consonant with the fitted variogram. It can help identify nonstationarity,    \n    outliers, and poor variogram fit in general. Simulated data sets and a set of soil      \n    nitrogen concentration data are examined using this graphical diagnostic.\"\n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":71,"score":5,"question_id":12731835,"title":"Create part-fixed, part-free axis limits on facets with ggplot?","body":"<p>I'd like to create a faceted plot using ggplot2 in which the minimum limit of the y axis will be fixed (say at 0) and the maximum limit will be determined by the data in the facet (as it is when <code>scales=\"free_y\"</code>. I was hoping that something like the following would work, but no such luck:</p>\n\n<pre><code>library(plyr)\nlibrary(ggplot2)\n\n#Create the underlying data\nl &lt;- gl(2, 10, 20, labels=letters[1:2])\nx &lt;- rep(1:10, 2)\ny &lt;- c(runif(10), runif(10)*100)\ndf &lt;- data.frame(l=l, x=x, y=y)\n\n#Create a separate data frame to define axis limits\ndfLim &lt;- ddply(df, .(l), function(y) max(y$y))\nnames(dfLim)[2] &lt;- \"yMax\"\ndfLim$yMin &lt;- 0\n\n#Create a plot that works, but has totally free scales\np &lt;- ggplot(df, aes(x=x, y=y)) + geom_point() + facet_wrap(~l, scales=\"free_y\") \n#Add y limits defined by the limits dataframe\np + ylim(dfLim$yMin, dfLim$yMax)\n</code></pre>\n\n<p>It's not too surprising to me that this throws an error (<code>length(lims) == 2 is not TRUE</code>) but I can't think of a strategy to get started on this problem.</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12733651,"title":"search and replace a character","body":"<p>I have a string like this</p>\n\n<pre><code>x&lt;-c(\"This is a test (120)\")\n</code></pre>\n\n<p>I need to replace the empty space between test and ( so that text will be like this</p>\n\n<pre><code>x&lt;-c(\"This is a test(120)\") \n</code></pre>\n\n<p>I tried this </p>\n\n<pre><code>s&lt;-gsub(\"\\t\\v\\(\", \"\", x) \n</code></pre>\n\n<p>not working, any input would be appreciated.</p>\n"},{"tags":["r","summary"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12733169,"title":"extracting N from lme summary in R","body":"<p>I'm looking for a quick way to pull out the number of observations (N) generated in the summary of a lme test, instead of copying and pasting? I found this online but the command doesn't appear to be built-in and the textreg package isn't uploaded to this site.</p>\n\n<p><b>https://r-forge.r-project.org/scm/viewvc.php/<em>checkout</em>/pkg/trunk/R/texreg.R?revision=28&amp; root=texreg&amp;pathrev=30</b></p>\n\n<pre><code>n &lt;- nobs(model) #extract number of observations\n</code></pre>\n\n<p>Many thanks.</p>\n"},{"tags":["r","lattice","scatter-plot"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":12718419,"title":"how to color points dependent on a numerical threshold using R lattice xyplot","body":"<p>I would like to color the points in each panel based on the value of z.\nThe code that I currently have does not distinguish the z values from each panel.\nI realize that I need a panel function and panel.superpose may be helpful, but I am lost. </p>\n\n<pre><code>x &lt;- c(1:10, 1:10)\ny &lt;- c(10:1, 10:1)\nz &lt;- c(1:10, seq(1,20, by=2))\na = c(rep(\"one\",10),rep(\"two\",10))\n\nxyplot(y ~ x |a,\n   panel=function(x,y, ...) {\n     panel.xyplot(x,y, pch=20, cex=0.3, col = ifelse(z &lt; 5, \"red\", \"black\"))\n   }\n   )\n</code></pre>\n\n<p>The correct plot would only have the tope two points red in the \"two\" panel.</p>\n"},{"tags":["r","linear-regression"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12732424,"title":"Get Confidence Interval For One Point On Regression Line In R?","body":"<p>How do I get the CI for one point on the regression line? I'm quite sure I should use confint() for that, but if I try this</p>\n\n<pre><code>confint(model,param=value)\n</code></pre>\n\n<p>it just gives me the same number as if I just type in </p>\n\n<pre><code>confint(model)\n</code></pre>\n\n<p>if I try without a value, it does not give me any values at all.</p>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["r"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":136,"score":5,"question_id":12730629,"title":"What does the % keyword in mean in R?","body":"<p>I tried to do this simple search but could find anything on the % symbol in R. What does the following mean?</p>\n\n<pre><code>time(x) %in% time(Y))\n</code></pre>\n\n<p><code>x</code> and <code>y</code> are usual matrices. </p>\n\n<p>I am trying understand what <code>%in%</code> does as I cannot locate the help file in my R shell.</p>\n\n<p>How do I look up help on <code>%in%</code> and similar functions that follow the <code>%stuff%</code> pattern, and why do they look so funny?</p>\n"},{"tags":["oop","r","encapsulation","public-method","private-methods"],"answer_count":2,"favorite_count":7,"up_vote_count":20,"down_vote_count":1,"view_count":471,"score":19,"question_id":11073253,"title":"OOP with R: is there a way to declare public and private methods (S4 Reference Classes)?","body":"<p>Up-front: I <strong>am</strong> aware that R is a <em>functional</em> language, so please don't bite ;-)</p>\n\n<p>I've had <strong>great</strong> experiences with using an OOP approach for a lot of my programs.\nNow, I'm wondering if there's a way to make a distinction between <em>public</em> and <em>private</em> methods when using <a href=\"http://stat.ethz.ch/R-manual/R-patched/library/methods/html/refClass.html\">S4 Reference Classes</a> in R?</p>\n\n<h2>Example</h2>\n\n<h2>Class Definitions</h2>\n\n<pre><code>setRefClass(\"B\",\n    field=list(\n        b.1=\"numeric\",\n        b.2=\"logical\"\n    ),\n    methods=list(\n        thisIsPublic=function(...) {\n            thisIsPublic_ref(.self=.self, ...)\n        },\n        thisIsPrivate=function(...) {\n            thisIsPrivate_ref(.self=.self, ...)\n        }\n    )\n)\n\nsetRefClass(\"A\",\n    field=list(\n        a.1=\"B\"\n    )\n)\n</code></pre>\n\n<p><strong>NOTE</strong></p>\n\n<p>I usually do not place the <em>actual</em> method definition within the class def but separate it to a S4 method (i.e. <code>thisIsPublic_ref</code>) for the following reasons:</p>\n\n<ol>\n<li>That way the class def stays clearly arranged and is easier to read in cases when the individual method defs grow quite large.</li>\n<li>It allows you to switch to a <em>functional</em> execution of the method at any time. Be <code>x</code> an instance of a certain class, you are able to call <code>foo_ref(.self=x)</code> instead of <code>x$foo()</code>.</li>\n<li>It allows you to byte-compile the methods via <code>compiler::cmpfun()</code> which I think is not possible if you have \"plain\" Reference Class methods.</li>\n</ol>\n\n<p>It sure does not really make sense to make it that complicated for this specific example, but I thought I'd nevertheless illustrate that approach.</p>\n\n<h2>Method Definitions</h2>\n\n<pre><code>setGeneric(\n    name=\"thisIsPublic_ref\",\n    signature=c(\".self\"),\n    def=function(\n        .self,\n        ...\n    ) {\n    standardGeneric(\"thisIsPublic_ref\")    \n    }\n)\nsetGeneric(\n    name=\"thisIsPrivate_ref\",\n    signature=c(\".self\"),\n    def=function(\n        .self,\n        ...\n    ) {\n    standardGeneric(\"thisIsPrivate_ref\")    \n    }\n)\n\nrequire(compiler)\n\nsetMethod(\n    f=\"thisIsPublic_ref\",\n    signature=signature(.self=\"B\"),\n    definition=cmpfun(function(  \n        .self,\n        ...\n    ){\n    .self$b.1 * 1000\n    })\n)\nsetMethod(\n    f=\"thisIsPrivate_ref\",\n    signature=signature(.self=\"B\"),\n    definition=cmpfun(function(  \n        .self,\n        ...\n    ){\n    .self$b.2\n    })\n)\n</code></pre>\n\n<h2>Instances</h2>\n\n<pre><code>x.b &lt;- new(\"B\", b.1=10, b.2=TRUE)\nx.a &lt;- new(\"A\", a.1=x.b, a.2=\"hello world\")\n</code></pre>\n\n<h2>Public vs. private</h2>\n\n<p>Instances of class <code>A</code> (i.e. <code>x.a</code>) should be allowed to use class <code>B</code>'s <strong>public</strong> methods:</p>\n\n<pre><code>&gt; x.a$a.1$thisIsPublic()\n[1] 10000\n</code></pre>\n\n<p>Instances of class <code>A</code> (i.e. <code>x.a</code>) should <strong>not</strong> be allowed to use class <code>B</code>'s <strong>private</strong> methods. So I would want this <strong>not</strong> to work, i.e. result in an error:</p>\n\n<pre><code>&gt; x.a$a.1$thisIsPrivate()\n[1] TRUE\n</code></pre>\n\n<p>Any idea how one could specify this? </p>\n\n<p>The only thing I came up with so far:</p>\n\n<p>Adding a <code>sender</code> argument to each method, explicitly specify it for each method call and check if <code>class(.self) == class(sender)</code>. But that seems a bit “explicit“.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12730030,"title":"Call to plot doesn't actually produce plot","body":"<p>See the loop below--it calls plot k(k-1)/2 times, but no plots are ever actually produced.. Yet if I change the code to call the plots manually (e.g. plot(my_tree,c(1,2),..), plots ARE produced.)</p>\n\n<p>my_tree is a GBM object.  See the full code below </p>\n\n<pre><code>#there is nothing wrong with this code, but yet it does not work\nfor (i in my_tree$var.names) {\n        for (j in my_tree$var.names) {\n                if (i &lt; j) plot(my_tree, c(i, j), n.trees=best.iter)\n        }\n}\n</code></pre>\n\n<p>==== full program below</p>\n\n<pre><code>pdf(\"demo.pdf\")\n\nN &lt;- 100000\nalldata &lt;- data.frame();\ntrain &lt;- factor( ifelse(runif(N)&lt;0.5, 'T', 'V'))\nX1 &lt;- rnorm(N);\nX2 &lt;- rnorm(N);\nX3 &lt;- runif(N);\nX4 &lt;- rpois(N, lambda=4);\nlinear.pred &lt;- -3 + 0.25*X1 + 0.125*X2 - X3 + X4**abs(X1)\ntemp &lt;- binomial()\ny &lt;- rbinom(N, 1, p=temp$linkinv(linear.pred))\n\nalldata &lt;- data.frame(train,X1,X2,X3,X4,y)\nrm(train,X1,X2,X3,X4,y,linear.pred)\n\ntrain &lt;- alldata[alldata$train=='T',]\n\nlibrary(gbm)\nmy_tree&lt;-gbm(y ~ X1 + X2 + X3 + X4,\n    distribution=\"bernoulli\",\n    data=train,\n    train.fraction=0.5,\n    interaction.depth=8,\n    n.trees=300,\n    shrinkage=0.1,\n    verbose=TRUE)\n\nbest.iter &lt;- gbm.perf(my_tree, method=\"test\")\nprint(best.iter)\n\nsummary(my_tree, ntrees=best.iter)\n\n# make one and two ways\nfor (i in my_tree$var.names) {\n        plot(my_tree, i, best.iter)      \n}\n\n#there is nothing wrong with this code, but yet it does not work\nfor (i in my_tree$var.names) {\n        for (j in my_tree$var.names) {\n                if (i &lt; j) plot(my_tree, c(i, j), n.trees=best.iter)\n        }\n}\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":12712984,"title":"R IBrokers. How to get currency contract to work in reqHistoricalData calls? e.g. CADUSD rates? And how to pull index prices? e.g. S&P, DJI?","body":"<p>I am currently learning how to use the <code>IBrokers</code> package.</p>\n\n<p>I can pull equity prices at frequencies I want, and option prices, but I'm currently stuck on pulling foreign exchange rates.</p>\n\n<p>I don't know how to set up the right <code>twsContract</code>, for calling with <code>reqHistoricalData</code>.</p>\n\n<p>I am interested in getting CADUSD currencies on say a 1 min basis.  How can I do this?</p>\n\n<p>The example in the manual gives:</p>\n\n<pre><code>currency &lt;- twsCurrency(\"EUR\")\n</code></pre>\n\n<p>When I try and call this with say <code>reqHistoricalData(tws, currency)</code> it comes back with an error saying something like \"no historical data available 1D\".  As I can't even get the example in the manual to work, I'm rather stuck...</p>\n\n<p>Can someone please enlighten me as to what the correct syntax is?  If I have a couple of examples that actually work, I can take it from there.</p>\n\n<p>Also, when I try using <code>\"USD.CAD\"</code> or <code>\"CAD.USD\"</code> as the ticker in the <code>twsContract</code> object, I'm getting complaints that this isn't a valid security.  How can I find out what the right ticker name for <code>USD.CAD</code> would be?  Right now I figure out the ticket for stocks by looking at my interactive brokers application which is open at the same time obviously, and typing the company name and doing a search.  The ticker generally comes back e.g. (type apple, get back AAPL when I want to add this security to my portfolio in the interactive brokers workstation).</p>\n\n<p>Any help would be much appreciated.</p>\n\n<p>Also, another related question is how can I pull the historical of say the S&amp;P500 price index on a 1 min basis say?</p>\n\n<p>I am guessing I would use a <code>twsContract</code> object in R, but I don't know what parameters to use.  What should the ticker be?  The trade workstation mentions it's an \"index\" product type (obviously), which doesn't fit into any of the wrappers like <code>twsStock</code>, <code>twsCurrency</code> etc... Again, Is there an example of this somewhere, which actually works? </p>\n"},{"tags":["r","syntax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":50,"score":-2,"question_id":12663790,"title":"Syntax for getting data from SQLlite db with a loop?","body":"<p><strong>Solution:</strong></p>\n\n<p>Combining the answer bellow:</p>\n\n<pre><code>#First create a vector with all my dates\n\n#Create a frame to hold the data\ntestdf = data.frame(sdci=rep(\"\",1),stringsAsFactors=FALSE)\n\n#needs library(lubridate) for month/year functions\nlibrary(lubridate)\n\n#Loop and Add data to the df\nfor (i in 1:lenght(dates2){testdf[i, ] = c(dbGetQuery(con,paste0(' SELECT \\\nsdci_',year(dates2[i]),'_',sprintf(\"%02d\",month(dates2[i])),'_mean from \\ \ngr_sea_outlets_tier2 order by area_km2'))}\n</code></pre>\n\n<p><strong>END OF EDIT</strong></p>\n\n<p>I am getting my data one-by-one with this command:</p>\n\n<pre><code>data$\"2000/8/1\" = dbGetQuery(db,\"SELECT sdci_2000_08_mean as '2000/08/01' from  gr_sea_outlets_tier2 order by area_km2 desc limit 1;\")\n</code></pre>\n\n<p>but since I have 50 tables the processes becomes a bit tiresome. </p>\n\n<p>Im trying to create a loop for it but I can't figure the syntax. </p>\n\n<p>Here is some pseudocode (bash like) for what I want to do:</p>\n\n<pre><code>for year in $(seq 2000 2010); do\n    for month in $(seq -w 05 09); do\n         data$\"$year\"/\"$month\"/01\" = dbGetQuery(db,\"SELECT sdci_$year_$month_mean as '$year/$month/01' from  gr_sea_outlets_tier2 order by area_km2 desc limit 1;\"); \n        done; \n done\n</code></pre>\n\n<p>As a tempory solution ive manages to get bash to create a set of commands for me to parse into R. </p>\n\n<pre><code> for year in $(seq 2000 2010); do for month in $(seq -w 05 09); do echo data\\$\\'\"$year\"-\"$month\"-\"01\"\\' \\&lt;\\- dbConnect\\(db,\\\"SELECT sdci_\"$year\"_\"$month\"_mean from gr_sea_outlets_tier2 order by area_km2 desc limit 1\\;\\\"\\) &gt;&gt; r.cmd.data ; done; done\n</code></pre>\n\n<p>But Ι think its possible to do it inside R</p>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":12729967,"title":"How to make the size of a point in ggplot2 inversely proportional to its numeric value?","body":"<p>I am using <strong>ggplot2</strong> to visualize three variables from a dataset such as this:</p>\n\n<pre><code>data = data.frame(x = sample(1:10, 10, replace=TRUE), y = sample(1:10, 10, replace=TRUE), Rank = sample(1:10, 10, replace = TRUE))\n</code></pre>\n\n<p>with example code here:</p>\n\n<pre><code>ggplot(data, aes(x = x, y = y)) + geom_point(aes(size = Rank))\n</code></pre>\n\n<p>However, I would like the size of a point to be <em>inversely</em> proportional to its rank, so that points with a rank close to '1' are large, and for this to be displayed correctly in the legend. </p>\n\n<p>Can anyone help? </p>\n"},{"tags":["regex","r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":12727664,"title":"Extract all numbers from a single string in R","body":"<p>Let's imagine you have a string:</p>\n\n<pre><code>strLine &lt;- \"The transactions (on your account) were as follows: 0 3,000 (500) 0 2.25 (1,200)\"\n</code></pre>\n\n<p>Is there a function that strips out the numbers into an array/vector producing the following required solution:</p>\n\n<pre><code>result &lt;- c(0, 3000, -500, 0, 2.25, -1200)?\n</code></pre>\n\n<p>i.e. </p>\n\n<pre><code>result[3] = -500\n</code></pre>\n\n<p>Notice, the numbers are presented in accounting form so negative numbers appear between (). Also, you can assume that only numbers appear to the right of the first occurance of a number. I am not that good with regexp so would appreciate it if you could help if this would be required. Also, I don't want to assume the string is always the same so I am looking to strip out all words (and any special characters) before the location of the first number.</p>\n"},{"tags":["java","eclipse","r","rjava","jri"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":110,"score":1,"question_id":12676933,"title":"new Rengine(...); fails without error","body":"<p>I'm trying to set up JRI with Eclipse on a Windows 7 x64 system. I tried it once on my Laptop and it worked. Now on my Desktop it fails although everything of the R, rJava and JRI installation is exactly the same.</p>\n\n<p>I set the JRI and R Paths correctly to: \n<code>C:\\Program Files\\R\\R-2.15.1\\library\\rJava\\jri;C:\\Program Files\\R\\R-2.15.1\\bin\\x64</code></p>\n\n<p>Also I set <code>R_DOC_DIR</code> etc in Eclipse.</p>\n\n<p>Every time I try to run <code>new Rengine(...);</code> it fails without any error or exception. Debugging revealed an: <code>&lt;terminated, exit value: 10&gt;C:\\Program Files\\Java\\jre6\\bin\\javaw.exe (01.10.2012 18:00:31)</code></p>\n\n<p>Is there anything I can try? It really bothers me that it works an my Laptop but not on my Workstation despite the same settings everywhere.</p>\n\n<p>Edit: The code that is used to get the Rengine object.</p>\n\n<pre><code>public static Rengine getRengine(){\n    if (re == null) createRengine();\n    return re;\n}\n\npublic static void createRengine(){\n    if (re!=null) return;\n    try{\n        if (!Rengine.versionCheck()) {\n            System.err.println(\"** Version mismatch **\");\n            System.exit(1);\n        }  \n        String[] arguments = {\"--save\"};\n        re=new Rengine(arguments, false, null);\n        if (!re.waitForR()) {\n            System.out.println(\"Cannot load R\");\n            return;\n        }\n    }\n    catch (Exception e){\n        e.printStackTrace();\n    }\n}\n</code></pre>\n\n<p>Edit: The last time i tried it i got an errormessage (creating of the REngine worked, this happened never before), R was missing a registryentry. After installing R 2.15.1 again it suddenly worked. Now after a restart it's the same like before. The program crashes at the creation of the REngine.</p>\n"},{"tags":["r"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":234,"score":4,"question_id":8282894,"title":"R package for zip code & other geodata from IP addresses?","body":"<p>I have a list of about 200,000 IP addresses. I would like to link these to geographic location and get any other data that an IP address can give as well.</p>\n\n<p>The best I've found so far is a service provided by infochimps:\n<a href=\"http://www.infochimps.com/datasets/digital-element-ip-intelligence-demographics\" rel=\"nofollow\">http://www.infochimps.com/datasets/digital-element-ip-intelligence-demographics</a>\nThere's also an R package for infochimps. But infochimps requires you to pay and for 200,000 IP addresses this could get expensive.</p>\n\n<p>Is there any R package that can do something like this?</p>\n\n<p>Thank you</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":72,"score":0,"question_id":12697030,"title":"Save a plot as an image, then plot over it in","body":"<p>I'm working on an R package that allows users to edit timeseries by clicking and dragging points on a graph. </p>\n\n<p>I need to have 6 lines shown at all times on the graph, though only one of the lines is 'active' and can be edited with the mouse. </p>\n\n<p>It works ok now, but because I am drawing so many lines and plotting several times a second when the 'click and drag' function is active, the screen flashes a lot, which is hard on the eyes. </p>\n\n<p>I would like to make a plot with the nonactive series, then save this plot as an image, then write the image to a device and plot the 'active' line over the image for the rest of the event loop. By my reckoning this would lower the number of 'layers' in the graph from 6 to 2.</p>\n\n<p>Some in the comments said some real code would be helpful. Here is my code:</p>\n\n<pre><code>near.point&lt;-function(point,x.vec,y.vec){   #this function takes 'point' which is an x,y val and then finds the point in x.vec, y.vec which is nearby, and returns it\n    dis.vec&lt;- sqrt(abs(x.vec/(max(x.vec)-min(x.vec))-point[1]/(max(x.vec)-min(x.vec)))^2 + abs(y.vec/(max(y.vec)-min(y.vec))-point[2]/(max(y.vec)-min(y.vec)))^2) #vector of total distances of #pointer click from line points\n    return(which(dis.vec==min(dis.vec)) )\n}\n\nsavepar &lt;- par(ask=FALSE)\npicker.mover &lt;- function(bl,scenarios,date.labs,target,name) { #this function allows one to edit #line points with the mouse\n\n#plot the baseline (the first time series)\nplot(unlist(bl),col=\"black\",type=\"l\",lwd=2,xaxt=\"n\",main=name,xlab=\"\",\n     ylab=\"Add function to bring in units, later\",sub=paste(paste(\"S\",target,sep=\"\"),\"active\",sep=\" \"),ylim=c(.96*min(scenarios),1.04*max(scenarios)))\naxis(1,at=seq(1,length(date.labs),12),labels=date.labs[seq(1,length(date.labs),12)])\n#plot the nontarget scenarios, the other lines to show in the graph but not be edited with mouse\nfor(i in c(1:6)[-which(c(1:6)==target)]){ #this 'which' structure returns a sequence from #1 to 6 excluding the target scenario     \n    lines(scenarios[,i],col=(i),pch=5,lwd=1)\n    }\n    #plot the target scenario\n    lines(unlist(scenarios[,target]),type=\"b\",col=\"blue\",lwd=3)\n    #####legend structure###################################################\n    l.widths &lt;-rep(1,7);l.widths[target+1] &lt;-3 \n    l.colors&lt;-c(\"black\",1:6);l.colors[target+1]&lt;-\"blue\" \n    legend(\"bottomright\",c(\"BL\",\"S1\",\"S2\",\"S3\",\"S4\",\"S5\",\"S6\"),lty=c(1,1,1,1,1,1,1),lwd=l.widths,col=l.colors)\n        ####End legend structure###############################################    \n\n#some graphics events functions, Frankensteined from the getGrapnicsEven R help example\n\ndevset &lt;- function()\n    if (dev.cur() != eventEnv$which) dev.set(eventEnv$which)\n\ndragmousedown &lt;- function(buttons, x, y) { #what happens when we click\n    start.x &lt;- grconvertX(x,\"ndc\",\"user\") #&lt;&lt;- super assignment\n    start.y &lt;- grconvertY(y,\"ndc\",\"user\")\n    #devset()\n\n    temp.point&lt;&lt;-near.point(c(start.x,start.y),\n        1:length(unlist(bl)),scenarios[,target])\n    points(temp.point,scenarios[temp.point,target],col=\"Red\"\n       ,pch=21,bg=\"red\",lwd=2)\n\n          eventEnv$onMouseMove &lt;- dragmousemove\n    NULL\n}\n\ndragmousemove &lt;- function(buttons, x, y) { #what happens when we move after clicking\n    #devset()\n\n\n    y.scaled&lt;-grconvertY(y,\"ndc\",\"user\")\n    scenarios[temp.point,target]&lt;&lt;-y.scaled\n\n#och plotta hela grej igen\n#plot the baseline\nplot(unlist(bl),col=\"black\",type=\"l\",lwd=2,xaxt=\"n\",xlab=\"\",\n     ylab=\"Add function to bring in units, later\",sub=paste(paste(\"S\",target,sep=\"\"),\"active\",sep=\" \"),main=name,ylim=c(.96*min(scenarios),1.04*max(scenarios)))\n      axis(1,at=seq(1,length(date.labs),12),labels=date.labs[seq(1,length(date.labs),12)])\n\n#plot the nontarget scenarios\nfor(i in c(1:6)[-which(c(1:6)==target)]){ #this 'which' structure returns a sequence from 1 to 6 excluding the target scenario      \n    lines(scenarios[,i],col=(i),pch=5,lwd=1)\n    }\n    #plot the target scenario\n    lines(unlist(scenarios[,target]),type=\"b\",col=\"blue\",lwd=3)\n    ####legend structure###################################################\n    l.widths &lt;-rep(1,7);l.widths[target+1] &lt;-3 \n    l.colors&lt;-c(\"black\",1:6);l.colors[target+1]&lt;-\"blue\" \n    legend(\"bottomright\",c(\"BL\",\"S1\",\"S2\",\"S3\",\"S4\",\"S5\",\"S6\"),lty=c(1,1,1,1,1,1,1),lwd=l.widths,col=l.colors)\n        ####End legend structure###############################################\n\n    points(temp.point,scenarios[temp.point,target],col=\"Red\"\n       ,pch=21,bg=\"red\",lwd=2)\n\n  temp.text&lt;- paste(as.character(date.labs[temp.point]),\":\",sep=\"\") #report date\ntemp.text &lt;- paste(temp.text,paste(round(100*(scenarios[temp.point,target]/unlist(bl)[temp.point]-1),3),\"%\",sep=\"\"),sep=\" \")\ntemp.text&lt;- paste(temp.text,\"from BL\")\nlegend(\"topleft\",temp.text)\n    NULL\n}\n\nmouseup &lt;- function(buttons, x, y) {    \n    eventEnv$onMouseMove &lt;- NULL\n}   \n\nkeydown &lt;- function(key) {\n    if (key == \"q\") return(invisible(1))\n    eventEnv$onMouseMove &lt;- NULL\n    NULL\n}\n\nsetGraphicsEventHandlers(prompt=\"Click and drag, hit q to quit\",\n                 onMouseDown = dragmousedown,\n                 onMouseUp = mouseup,\n                 onKeybd = keydown)\neventEnv &lt;- getGraphicsEventEnv()\n}\n</code></pre>\n\n<p>My <code>datas</code> data frame is huge, but pretend it just has vectors of timeseries.</p>\n\n<p>First col is dates, then col 2 is the 'baseline' forecast and 3 to 8 are alternative scenarios.</p>\n\n<p>I just use the lines below to test, I have another function to run the whole thing</p>\n\n<pre><code>picker.mover(bl=datas[,2],scenarios=datas[,3:8],date.labs=datas[,1],target=1,name=colnames(datas)[2])\ngetGraphicsEvent()\npar(savepar)\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":11189067,"title":"Performing adf test on a data.frame","body":"<p>I can perform an adf test on a vector:</p>\n\n<pre><code>library(tseries)\nht &lt;- adf.test(vector, alternative=\"stationary\", k=0)\n</code></pre>\n\n<p>but I am having trouble  performing it on columns of values in a data.frame:</p>\n\n<pre><code>ht &lt;- adf.test(dataframe, alternative=\"stationary\", k=0)\n</code></pre>\n\n<p>Is there a way of doing this?</p>\n"},{"tags":["r","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":46,"score":4,"question_id":12727980,"title":"Create block matrices with identical value in R","body":"<p>I want to create k blocks with identical values in a n*n matrix (k can be divided exactly by the row number times the columns number as n*n ):</p>\n\n<p>for example, when n = 4 and k = 4, (k can be divided exactly by 4*4=16), a matrix is create like this:</p>\n\n<pre><code>1 1 2 2\n1 1 2 2\n3 3 4 4\n3 3 4 4\n</code></pre>\n\n<p>How can I do this without a for loop?</p>\n"},{"tags":["xml","r","reference"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":12719400,"title":"How to get EndNote xml file into an R data frame","body":"<p>I wish to get a XML file produced by EndNote into an R data frame.</p>\n\n<p>I would like each final child node (e.g. title, author...) to be a column</p>\n\n<p>An example EndNote xml file is available here:</p>\n\n<p><a href=\"https://gist.github.com/raw/3831049/80f1315ba03d278b4f5f0d916fb1999709fc40e6/endnote.xml\" rel=\"nofollow\">Example on gist</a></p>\n\n<p>I have yet to resolve this using library(XML).  I am hoping someone has a ready made solution, sorry if this sounds lazy.</p>\n"},{"tags":["html","r","xpath"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":70,"score":1,"question_id":12713222,"title":"xpath expression not working","body":"<pre><code>    &lt;DOC NUMBER=1&gt;\n&lt;DOCFULL&gt; --&gt;\n&lt;br&gt;&lt;div class=\"c0\"&gt;\n&lt;p class=\"c1\"&gt;&lt;span class=\"c2\"&gt;Dokument 1 von 3&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;br&gt;&lt;div class=\"c0\"&gt;\n&lt;br&gt;&lt;p class=\"c1\"&gt;&lt;span class=\"c2\"&gt;Associated Press Financial Wire&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;br&gt;&lt;div class=\"c3\"&gt;\n&lt;p class=\"c1\"&gt;&lt;span class=\"c2\"&gt;April 25, 2012 Wednesday 9:18 PM GMT &lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;br&gt;&lt;div class=\"c4\"&gt;\n&lt;p class=\"c5\"&gt;&lt;span class=\"c6\"&gt;Apple CEO Tim Cook emerges from Steve Jobs' shadow&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;br&gt;&lt;div class=\"c4\"&gt;\n&lt;p class=\"c5\"&gt;&lt;span class=\"c7\"&gt;BYLINE: &lt;/span&gt;&lt;span class=\"c2\"&gt;By PETER SVENSSON, AP Technology Writer&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;br&gt;&lt;div class=\"c4\"&gt;\n&lt;p class=\"c5\"&gt;&lt;span class=\"c7\"&gt;SECTION: &lt;/span&gt;&lt;span class=\"c2\"&gt;BUSINESS NEWS&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;br&gt;&lt;div class=\"c4\"&gt;\n&lt;p class=\"c5\"&gt;&lt;span class=\"c7\"&gt;LENGTH: &lt;/span&gt;&lt;span class=\"c2\"&gt;794 words&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;br&gt;&lt;div class=\"c4\"&gt;\n&lt;p class=\"c5\"&gt;&lt;span class=\"c7\"&gt;DATELINE: &lt;/span&gt;&lt;span class=\"c2\"&gt;NEW YORK &lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;br&gt;&lt;div class=\"c4\"&gt;\n&lt;p class=\"c8\"&gt;&lt;span class=\"c2\"&gt; MAIN TEXT 1&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;br&gt;&lt;div class=\"c4\"&gt;\n&lt;p class=\"c5\"&gt;&lt;span class=\"c7\"&gt;LOAD-DATE: &lt;/span&gt;&lt;span class=\"c2\"&gt;April 26, 2012&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;br&gt;&lt;div class=\"c4\"&gt;\n&lt;p class=\"c5\"&gt;&lt;span class=\"c7\"&gt;LANGUAGE: &lt;/span&gt;&lt;span class=\"c2\"&gt;ENGLISH&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;br&gt;&lt;div class=\"c4\"&gt;\n&lt;p class=\"c5\"&gt;&lt;span class=\"c7\"&gt;PUBLICATION-TYPE: &lt;/span&gt;&lt;span class=\"c2\"&gt;Newswire&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;br&gt;&lt;div class=\"c0\"&gt;\n&lt;br&gt;&lt;p class=\"c1\"&gt;&lt;span class=\"c2\"&gt;Copyright 2012 Associated Press&lt;br&gt;All Rights Reserved&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;!-- Hide XML section from browser\n&lt;/DOCFULL&gt;\n&lt;/DOC&gt; --&gt;\n</code></pre>\n\n<p>I am new to xpath and I want to use it in combination with R (Duncan Lang's xml package) to query a html document that I received from LexisNexis. The document contains multiple news articles and each article is bounded by the <code>&lt;DOC NUMBER=1&gt; &lt;DOCFULL&gt;</code> tags. I wish to extract a couple of information for each document, e.g. to extract the SECTION information, I got this far:</p>\n\n<pre><code>doc &lt;- htmlParse(\"hmtldoc.HTML\")\nxpathSApply(doc,\"//span[text()='SECTION: ']/..\", xmlValue)\n</code></pre>\n\n<p>which gives me:</p>\n\n<pre><code>[1] \"SECTION: BUSINESS NEWS\" \"SECTION: BUSINESS NEWS\" \"SECTION: BUSINESS NEWS\"\n</code></pre>\n\n<p>That is output I can work with. The main problem is that not every article has SECTION information. What I need to know is which article provides this information and which don't, preferably by returning NA or an empty list element so I can deduce this information myself. </p>\n\n<p>Associated with this question: I tried to come up with a solution where I selected either the DOC or DOCFULL node first and went on from there, e.g.:</p>\n\n<pre><code>xpathSApply(doc,\"//DOCFULL/*/span[text()='SECTION: ']/..\", xmlValue)\n</code></pre>\n\n<p>I thought this should return the same text as above, but it doesn't. Anyways, I am still very new to this language and appreciate any help.</p>\n"},{"tags":["r","map","ggplot2","continuous","heat"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":296,"score":1,"question_id":11531059,"title":"Creating a continuous heat map in R","body":"<p>I have a series of x and y coordinates that each have a distance attached to them. I would like to create a heat map that displays the average distance for every point within the x and y ranges as a heat map. Since the points are not spaced evenly from each other in a lattice-like shape, the method would require some kind of smoothing function that clusters data and calculates the average for each point the vicinity and then representing that average with a color. </p>\n\n<p>So far, using <code>ggplot2</code>, I can only find methods like <code>stat_density2d</code> and <code>geom_tile</code>, which only work for displaying point density and representing evenly spaced points (as far as I can tell).</p>\n\n<p>Ideally it would follow the same principle as this image: \n<img src=\"http://i.stack.imgur.com/tbfm4.png\" alt=\"enter image description here\"></p>\n\n<p>in which colors were assigned based on the given points in the vicinity even though the density and placement of the points was not uniform. </p>\n\n<p>I do not want to create a heat map in matrix form like this image: <img src=\"http://i.stack.imgur.com/xLwM0.png\" alt=\"enter image description here\"></p>\n\n<p>in which a table is color-coded. Instead, I would like to create a continuous heat map using non-uniformly distributed x and y coordinates that, in effect, displays the limit in which the data is broken into infinitely many rectangles. This may not be the actual method used by the function, but it provides a general idea as to what I'm looking for.</p>\n\n<p>Here is some sample data:</p>\n\n<pre><code>data=data.frame(x=c(1,1,2,2,3,4,5,6,7,7,8,9),\n  y=c(2,4,5,1,3,8,4,8,1,1,6,9),\n  distance=c(66,84,93,76,104,29,70,19,60,50,46,36))\n</code></pre>\n\n<p>How can I make a heat map with distance as the color scale that covers the entire range of numbers, like the plot in the first link provided?</p>\n\n<p>Any help is greatly appreciated!</p>\n"},{"tags":["r","time-series","data-manipulation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12726651,"title":"Time series data manipulation","body":"<p>I've had this problem before, but I didn't write down the solution, so now I'm in trouble again!</p>\n\n<p>I have a dataframe like the following:</p>\n\n<pre><code>Date    Product    Qty    Income\n201001  0001       1000   2000\n201002  0001       1500   3000\n201003  0001       1200   2400\n.\n.\n201001  0002       3500   2000\n201002  0002       3200   1900\n201003  0002       3100   1850\n</code></pre>\n\n<p>In words, I have one line for each combination of Date/Product, and the information of Quantity and Income for each combination.</p>\n\n<p>I want to rearrange this dataframe so it looks like the following:</p>\n\n<pre><code>Date    Qty.0001    Income.0001   Qty.0002    Income.0002\n201001  1000        2000          3500        2000\n201002  1500        3000          3200        1900\n201003  1200        2400          3100        1850\n</code></pre>\n\n<p>In words, I want to have one line for each date, and one column for each combination of Product/Information(Qty, Income).</p>\n\n<p>How can I achieve this? Thanks in advance!</p>\n"},{"tags":["r","map","projection"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12725458,"title":"R mapproj lambert-azimuthal equal area projection","body":"<p>How can I do a lambert-azimuthal equal area projection with the mapproj package?\n<a href=\"http://cran.r-project.org/web/packages/mapproj/mapproj.pdf\" rel=\"nofollow\">http://cran.r-project.org/web/packages/mapproj/mapproj.pdf</a></p>\n\n<p>There is </p>\n\n<blockquote>\n  <p>azequalarea() equal-area</p>\n</blockquote>\n\n<p>and </p>\n\n<blockquote>\n  <p>lambert(lat0,lat1) conformal, true scale on lat0 and lat1</p>\n</blockquote>\n\n<p>What one is closests to lambert-azimuthal equal area projection?</p>\n"},{"tags":["r","plot","ggplot2"],"answer_count":1,"favorite_count":5,"up_vote_count":16,"down_vote_count":0,"view_count":8677,"score":16,"question_id":3606697,"title":"How to set limits for axes in ggplot2 R plots?","body":"<p>Say I plot the following in R:</p>\n\n<pre><code>library(ggplot2)    \ncarrots &lt;- data.frame(length = rnorm(500000, 10000, 10000))\ncukes &lt;- data.frame(length = rnorm(50000, 10000, 20000))\ncarrots$veg &lt;- 'carrot'\ncukes$veg &lt;- 'cuke'\nvegLengths &lt;- rbind(carrots, cukes)\nggplot(vegLengths, aes(length, fill = veg)) + geom_density(alpha = 0.2)\n</code></pre>\n\n<p>Now say I only want to plot the region between x=-5000 to 5000, instead of the entire range. How can I do that?</p>\n"},{"tags":["r","data-binding","vector","data.frame"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12725878,"title":"R combining vectors into a data frame but without a continuous common variable","body":"<p>I have two different files which I'd like to combine to make one data frame but I've no idea how to do it! The first file has two columns; one is the date, the following is a binary code for debris flow events. Then my other file has also two columns; the date and then precipitation data. </p>\n\n<p>The thing is, is that the two date columns don't all contain the same dates. The binary one is every day from April - October from 1900 - 2005, yet the precipitation file has dates from from say, 1911 to 2004, with some missing data on certain months and during certain years.</p>\n\n<p>So my question is how to make a data frame which would have the date, the binary 0 or 1, and then the corresponding precip value from that particular date. I only want the precip information for the days where I have information in the binary file; the others can be disregarded.</p>\n\n<p>I have tried using codes which I found in answer to other questions asked but none of them work with my issue. If I'm honest I don't really know if this is what I need. I'm hoping to end up doing a logistic regression.</p>\n\n<p>I'd be really grateful if anyone could help me and suggest a way to do it!\nI'm also really not very technical and am not at all comfortable with R so if you could be really basic in your advice I'd appreciate it!</p>\n"},{"tags":["python","r","shell","posix"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":71,"score":-3,"question_id":12723135,"title":"Which is the standard posix way:double \\  or single \\  in regex  expression?","body":"<p>to get file which ended in . ,you can do :<br>\n1.R</p>\n\n<pre><code>list.files(path='/home/test', all.files=TRUE, pattern=\"\\\\.$\")\n</code></pre>\n\n<p>or</p>\n\n<pre><code>list.files(path='/home/test', all.files=TRUE, pattern=\".+\\\\.$\")\n</code></pre>\n\n<p>must double \\ in R  ,can  use  neither <code>.+\\.$</code>  nor <code>\\.$</code></p>\n\n<p>2.python</p>\n\n<pre><code>import os\nimport re\nfor   root,   dirs,   files   in   os.walk(\"/home/test\"):\n    for file in files:\n        if re.search(\".+\\.$\",file):\n            print file\n</code></pre>\n\n<p>can  either  use  <code>.+\\\\.$</code>   or <code>\\.$</code> or <code>\\\\.$</code> in python.</p>\n\n<p>3.shell</p>\n\n<pre><code>find /home/test  -regex  \".+\\.$\"\n</code></pre>\n\n<p>can use   \".+\\.$\"  too in shell</p>\n\n<p>I want to know<br>\n1.which is the posix way between <code>.+\\\\.$</code>  and <code>.+\\.$</code>  ?<br>\n2.why i can't use <code>find /home/test  -regex  \"\\.$\"</code>  in shell?</p>\n"},{"tags":["r","plyr"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12724745,"title":"ddply + summarise function column name input","body":"<p>I am trying to use <code>ddply</code> and <code>summarise</code> together from the <code>plyr</code> package but am having difficulty parsing through column names that keep changing...In my example i would like something that would parse in X1 programatically rather than hard coding in X1 into the ddply function.</p>\n\n<p>setting up an example</p>\n\n<pre><code>require(xts)\nrequire(plyr)\nrequire(reshape2)\nrequire(lubridate)\nt &lt;- xts(matrix(rnorm(10000),ncol=10), Sys.Date()-1000:1)\nt.df &lt;- data.frame(coredata(t))\nt.df &lt;- cbind(day=wday(index(t), label=TRUE, abbr=TRUE), t.df)\nt.df.l &lt;- melt(t.df, id.vars=c(\"day\",colnames(t.df)[2]), measure.vars=colnames(t.df)[3:ncol(t.df)])\n</code></pre>\n\n<p>This is the bit im am struggling with....</p>\n\n<pre><code>cor.vars &lt;- ddply(t.df.l, c(\"day\",\"variable\"), summarise, cor(X1, value))\n</code></pre>\n\n<p>i do not want to use the term X1 and would like to use something like</p>\n\n<pre><code>cor.vars &lt;- ddply(t.df.l, c(\"day\",\"variable\"), summarise, cor(colnames(t.df)[2], value))\n</code></pre>\n\n<p>but that comes up with the error: <code>Error in cor(colnames(t.df)[2], value) : 'x' must be numeric</code></p>\n\n<p>I also tried various other combos that parse in the vector values for the x argument in cor...but for some reason none of them seem to work...</p>\n\n<p>any ideas?</p>\n"},{"tags":["r","api","post","rcurl"],"answer_count":2,"favorite_count":3,"up_vote_count":2,"down_vote_count":1,"view_count":125,"score":1,"question_id":12302941,"title":"Convert curl code into R via the RCurl package?","body":"<p>How I would write the following curl POST method using R and the RCurl package?</p>\n\n<pre><code>curl -k -u myusername:mypassword -d '{\"text\":\"Hello World!\",\"level\":\"Noob\"}' -H \"Content-Type: application/json\" -H \"Accept: application/json\" \"http://api.website/v1/access?\"\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":93,"score":-2,"question_id":12723800,"title":"How to return a error message in R?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1608130/equivalent-of-throw-in-r\">Equivalent of &ldquo;throw&rdquo; in R</a>  </p>\n</blockquote>\n\n\n\n<p>I was wandering how one is able to produce error messages in R, especially from within a function?</p>\n"},{"tags":["java","r","apache-commons-math","loess"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":95,"score":4,"question_id":12704658,"title":"Difference between R.loess and org.apache.commons.math LoessInterpolator","body":"<p>I'm trying to compute the convert a R script to java using the <strong>apache.commons.math</strong> library. Can I use <a href=\"http://commons.apache.org/math/api-2.2/org/apache/commons/math/analysis/interpolation/LoessInterpolator.html\" rel=\"nofollow\">org.apache.commons.math.analysis.interpolation.LoessInterpolator</a> in place of <a href=\"http://commons.apache.org/math/api-2.2/org/apache/commons/math/analysis/interpolation/LoessInterpolator.html\" rel=\"nofollow\">R loess</a> ? I cannot get the same result.</p>\n\n<p><strong>EDIT</strong>.</p>\n\n<p>here is a java program that creates a random array(x,y) and compute the loess with LoessInterpolator or by calling R. At the end, the results are printed.</p>\n\n<pre><code>import java.io.*;\nimport java.util.Random;\n\nimport org.apache.commons.math.analysis.interpolation.LoessInterpolator;\n\n\npublic class TestLoess\n    {\n    private String RScript=\"/usr/local/bin/Rscript\";\n    private static class ConsummeInputStream\n        extends Thread\n        {\n        private InputStream in;\n        ConsummeInputStream(InputStream in)\n            {\n            this.in=in;\n            }\n        @Override\n        public void run()\n            {\n            try\n                {\n                int c;\n                while((c=this.in.read())!=-1) \n                    System.err.print((char)c);\n                }\n            catch(IOException err)\n                {\n                err.printStackTrace();\n                }\n            }\n        }\n    TestLoess()\n        {\n\n        }\n    private void run() throws Exception\n        {\n        int num=100;\n        Random rand=new Random(0L);\n        double x[]=new double[num];\n        double y[]=new double[x.length];\n        for(int i=0;i&lt; x.length;++i)\n            {\n            x[i]=rand.nextDouble()+(i&gt;0?x[i-1]:0);\n            y[i]=Math.sin(i)*100;\n            }\n        LoessInterpolator loessInterpolator=new LoessInterpolator(\n            0.75,//bandwidth,\n            2//robustnessIters\n\n            );\n        double y2[]=loessInterpolator.smooth(x, y);\n\n        Process proc=Runtime.getRuntime().exec(\n            new String[]{RScript,\"-\"}\n            );\n        ConsummeInputStream errIn=new ConsummeInputStream(proc.getErrorStream());\n        BufferedReader stdin=new BufferedReader(new InputStreamReader(proc.getInputStream()));\n        PrintStream out=new PrintStream(proc.getOutputStream());\n        errIn.start();\n        out.print(\"T&lt;-as.data.frame(matrix(c(\");\n        for(int i=0;i&lt; x.length;++i)\n            {\n            if(i&gt;0) out.print(',');\n            out.print(x[i]+\",\"+y[i]);\n            }\n        out.println(\"),ncol=2,byrow=TRUE))\");\n        out.println(\"colnames(T)&lt;-c('x','y')\");\n        out.println(\"T2&lt;-loess(y ~ x, T)\");\n        out.println(\"write.table(residuals(T2),'',col.names= F,row.names=F,sep='\\\\t')\");\n        out.flush();\n        out.close();\n        double y3[]=new double[x.length];\n        for(int i=0;i&lt; y3.length;++i)\n            {\n            y3[i]=Double.parseDouble(stdin.readLine());\n            }\n        System.out.println(\"X\\tY\\tY.java\\tY.R\");\n        for(int i=0;i&lt; y3.length;++i)\n            {\n            System.out.println(\"\"+x[i]+\"\\t\"+y[i]+\"\\t\"+y2[i]+\"\\t\"+y3[i]);\n            }\n        }\n\n    public static void main(String[] args)\n        throws Exception\n        {\n        new TestLoess().run();\n        }\n    }\n</code></pre>\n\n<p>compilation &amp; exec:</p>\n\n<pre><code>javac -cp commons-math-2.2.jar TestLoess.java &amp;&amp; java -cp commons-math-2.2.jar:. TestLoess\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>X   Y   Y.java  Y.R\n0.730967787376657   0.0 6.624884763714674   -12.5936186703287\n0.9715042030481429  84.14709848078965   6.5263049649584 71.9725380029913\n1.6089216283982513  90.92974268256818   6.269100654071115   79.839773167581\n2.159358633515885   14.112000805986721  6.051308261720918   3.9270340708818\n2.756903911313087   -75.68024953079282  5.818424835586378   -84.9176311089431\n3.090122310789737   -95.89242746631385  5.689740879461759   -104.617807889069\n3.4753114955304554  -27.941549819892586 5.541837854229562   -36.0902352062634\n4.460153035730264   65.6986598718789    5.168028655980764   58.9472823439219\n5.339335553602744   98.93582466233818   4.840314399516663   93.3329030534449\n6.280584733084859   41.21184852417566   4.49531113985498    36.7282165788057\n6.555538699120343   -54.40211108893698  4.395343460231256   -58.5812856445538\n6.68443584999412    -99.99902065507035  4.348559404444451   -104.039069260889\n6.831037507640638   -53.657291800043495 4.295400167908642   -57.5419313320511\n6.854275630124528   42.016703682664094  4.286978656933373   38.1564179414478\n7.401015387322993   99.06073556948704   4.089252482141094   95.7504087842369\n8.365502247999844   65.02878401571168   3.7422883733498726  62.5865641279576\n8.469992934250815   -28.790331666506532 3.704793544880599   -31.145867173504\n9.095139297716374   -96.13974918795569  3.4805388562453574  -98.0047896609079\n9.505935493207435   -75.09872467716761  3.3330472034239405  -76.6664588290508\n</code></pre>\n\n<p>the output values for y are clearly not the same between R and Java; TheY.R column looks good (it's close to the original Y column). How should I change this in order to get Y.java ~ Y.R ?</p>\n"},{"tags":["r","machine-learning","data-mining"],"answer_count":8,"favorite_count":30,"up_vote_count":13,"down_vote_count":0,"view_count":4421,"score":13,"question_id":4811995,"title":"R and Data Mining","body":"<p>Instead starting to code in Matlab, I recently started learning R, mainly because it is open-source. I am currently working in data mining and machine learning field. I found many machine learning algorithms implemented in R, and I am still exploring different packages implemented in R.</p>\n\n<p>I have quick question: how do you compare R to Matlab for data mining application, its popularity, pros and cons, industry and academic acceptance etc.? Which one would you choose and why?</p>\n\n<p>I went through various comparisons for Matlab vs R against various metrics but I am specifically interested to get answer for its applicability in  Data Mining and ML. \nSince both language are pretty new for me I was just wondering if R would be a good choice or not.</p>\n\n<p>I appreciate any kind of suggestions.</p>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":12712346,"title":"How to apply mean, sd etc. function to a whole matrix","body":"<p>I have the following <code>matrix</code></p>\n\n<pre><code>Rho &lt;- structure(c(1, 0.466666666666667, -0.866666666666667, -0.466666666666667, \n-0.333333333333333, 0.466666666666667, 1, -0.6, -0.466666666666667, \n-0.333333333333333, -0.866666666666667, -0.6, 1, 0.333333333333333, \n0.466666666666667, -0.466666666666667, -0.466666666666667, 0.333333333333333, \n1, -0.2, -0.333333333333333, -0.333333333333333, 0.466666666666667, \n-0.2, 1), .Dim = c(5L, 5L), .Dimnames = list(c(\"SPX Index\", \"MXE2 Index\", \n\"USG4TR Index\", \"FNAR Index\", \"DBLCMAVL Index\"), c(\"SPX Index\", \n\"MXE2 Index\", \"USG4TR Index\", \"FNAR Index\", \"DBLCMAVL Index\")))\n</code></pre>\n\n<p>I thought that, in order to apply functions to single matrix arguments (like rows and/or column), I had to use <code>mapply()</code> or <code>apply()</code> in several ways.</p>\n\n<p>But, if I input</p>\n\n<pre><code>mean(Rho)  \nsd(Rho)\n</code></pre>\n\n<p>this returns me separate application of functions:</p>\n\n<pre><code>&gt; mean(Rho)\n     SPX Index     MXE2 Index   USG4TR Index     FNAR Index DBLCMAVL Index \n   -0.04000000     0.01333333     0.06666667     0.04000000     0.12000000 \n&gt; sd(Rho)\n     SPX Index     MXE2 Index   USG4TR Index     FNAR Index DBLCMAVL Index \n     0.7566006      0.6902496      0.7774603      0.6282250      0.5932959 \n</code></pre>\n\n<p>This is not what I want: I want the mean and st. dev. of <strong>all</strong> the elements of my matrix, like</p>\n\n<pre><code>&gt; mean(mean(Rho))\n[1] 0.04\n</code></pre>\n\n<p>in just one command.</p>\n\n<p>Is there a way to do it <strong>without</strong> coercing my matrix to vector/numeric/other?</p>\n\n<pre><code>&gt; sessionInfo()\nR version 2.15.1 (2012-06-22)\nPlatform: i386-pc-mingw32/i386 (32-bit)\n\nlocale:\n[1] LC_COLLATE=English_Australia.1252  LC_CTYPE=English_Australia.1252   \n[3] LC_MONETARY=English_Australia.1252 LC_NUMERIC=C                      \n[5] LC_TIME=English_Australia.1252    \n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] PerformanceAnalytics_1.0.4.4 xts_0.8-6                   \n [3] zoo_1.7-7                    gogarch_0.7-2               \n [5] fastICA_1.1-16               fGarch_2150.81              \n [7] fBasics_2160.81              rmgarch_0.97                \n [9] Matrix_1.0-9                 lattice_0.20-10             \n[11] Kendall_2.2                  spd_1.7                     \n[13] KernSmooth_2.23-8            rugarch_1.0-11              \n[15] Rsolnp_1.12                  truncnorm_1.0-6             \n[17] chron_2.3-42                 numDeriv_2012.3-1           \n[19] MASS_7.3-18                  RcppArmadillo_0.3.4.2       \n[21] Rcpp_0.9.13                  timeSeries_2160.94          \n[23] timeDate_2160.95             rcom_2.2-5                  \n[25] rscproxy_2.0-5              \n\nloaded via a namespace (and not attached):\n[1] boot_1.3-5       grid_2.15.1      stabledist_0.6-4 tools_2.15.1 \n</code></pre>\n"},{"tags":["r","ggplot2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12722280,"title":"multiple ggplots overall title","body":"<p>Hi I am using a solution that is on Cookbook for R to plot multiple ggplots in one go...i.e. the code from this bottom of the page on this link <a href=\"http://wiki.stdout.org/rcookbook/Graphs/Multiple%20graphs%20on%20one%20page%20(ggplot2)/\" rel=\"nofollow\">http://wiki.stdout.org/rcookbook/Graphs/Multiple%20graphs%20on%20one%20page%20(ggplot2)/</a></p>\n\n<p>I would like to add an overall title to this plot but am not sure how to do it. i.e. I would like to be able to have an amended function that has the additional argument for title like the below </p>\n\n<pre><code>multiplot(..., plotlist=NULL, file, cols=1, layout=NULL, title=\"\")\n</code></pre>\n\n<p>any help would be much appreciated</p>\n"},{"tags":["r","subset","na"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12112108,"title":"Subset function not removing NAs","body":"<p>I have a data frame like this:</p>\n\n<pre><code>df\n\nDate     Player Injured\n1/2/2012      A      No\n1/3/2012      B     Yes\n1/4/2012      C      No\n1/5/2012      B      NA\n1/5/2012      A      No\n1/7/2012      B     Yes\n1/8/2012      A      No\n1/3/2012      B     Yes\n1/2/2012      D      No\n1/3/2012      F      NA\n</code></pre>\n\n<p>I am trying to use subset function to select players that injury info is NA:</p>\n\n<pre><code>x &lt;- subset(df, injured!=\"NA\")\n</code></pre>\n\n<p>x data frame is not populating. It seems very straightforward. Any ideas what I am doing wrong here?</p>\n"},{"tags":["r","workflow"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12716533,"title":"Calling different sections of an external script through \"source\"","body":"<p>I have just finished writing a set of R scripts. There is one master file and 5 additional external r files called by the <code>source</code> function. I was wondering whether it is possible to unify the five external scripts into one single file; dividing the entire code into five sections run into different moments.</p>\n\n<p>Is it possible to do so by using <code>source</code>?. If not, which strategy do you suggest?</p>\n"},{"tags":["r","ggplot2","time-series","correlation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":101,"score":0,"question_id":12718743,"title":"chart.Correlation independent vs dependent variables visualisation","body":"<p>In R, I have a dataset that has one independent variable and 9 dependent variables, and I want to see the scatter plot, histogram plus correlation values like in <code>chart.Correlation()</code> but I don't want to see the correlations between the dependent variables...as it is unnecessary.</p>\n\n<p>I.e in the following mock example, I only care about/want to see the top row and to left most column, with all the histograms, with all the red lines and significance stars etc, BUT I don't care about/don't want all other other scatter plots and correlation values. Is this possible/is there a neat way of seeing all this in one visualisation...i.e. independent variable vs all dependent variables...?</p>\n\n<p>mock example:</p>\n\n<pre><code>d &lt;- xts(matrix(rnorm(10000),ncol=10), Sys.Date()-1000:1)\nlibrary(PerformanceAnalytics)\nchart.Correlation(d)\n</code></pre>\n\n<p>On a side note...I am getting a bit annoyed by the font size of some of the correlation values produced from <code>chart.Correlation</code>... any way to set a minimum and maximum font size so that the font size doesn't become unreadable...</p>\n\n<p>Also please feel free to use any other package (e.g. ggplot2 etc) that you think might be useful to help find a solution to the problem.</p>\n\n<p>thanks in advance</p>\n\n<p>EDIT:</p>\n\n<p>So this is what I have come up with so far using <code>ggplot</code> and <code>plyr</code>...I'm still missing the histogram of the independent variable...oh and <code>multiplot</code> comes from here:  <a href=\"http://wiki.stdout.org/rcookbook/Graphs/Multiple%20graphs%20on%20one%20page%20(ggplot2)/\" rel=\"nofollow\">http://wiki.stdout.org/rcookbook/Graphs/Multiple%20graphs%20on%20one%20page%20(ggplot2)/</a></p>\n\n<p>and have now included it as answer...but any other suggestions/improvements would be well received....</p>\n\n<pre><code>require(plyr)\nrequire(ggplot2)\n\nindep.dep.cor &lt;- function(xts.obj, title=\"\"){\n\n        # First column always assumed to be independent\n        df &lt;- data.frame(coredata(xts.obj))\n        assign('df',df,envir=.GlobalEnv)\n\n        df.l &lt;- melt(df, id.vars=colnames(df)[1], measure.vars=colnames(df)[2:ncol(df)])\n        assign('df.l',df.l, envir=.GlobalEnv)\n\n        cor.vals &lt;- ddply(df.l, c(\"variable\"), summarise, round(cor(df[,1],value),3))\n        stars &lt;- ddply(df.l, c(\"variable\"), summarise, symnum(cor.test(df[,1],value)$p.value, corr = FALSE, na = FALSE, cutpoints = c(0, 0.001, 0.01, 0.05, 0.1, 1), symbols = c(\"***\", \"**\", \"*\", \".\", \" \")))\n        cor.vals$stars &lt;- stars[,2]\n        assign('cor.vals',cor.vals,envir=.GlobalEnv)\n\n        bin.w &lt;- min((ddply(df.l,c(\"variable\"),summarise,diff(range(value))/30))[,2])\n\n        m1 &lt;- ggplot(df.l,aes_string(x=\"value\"))+\n            facet_grid(.~variable)+\n            stat_density(aes(y=..density..),fill=NA, colour=\"red\", size=1.2)+\n            geom_histogram(aes(y=..density..),fill=\"white\", colour=\"black\", binwidth=bin.w)+\n            opts(title=title)\n\n        m2 &lt;- ggplot(df.l,aes_string(x=colnames(df.l)[1], y=\"value\"))+\n            facet_grid(.~variable)+geom_point(aes(alpha=0.2))+\n            opts(legend.position=\"none\")+\n            geom_text(data=cor.vals,aes(label=paste(cor.vals[,2],cor.vals[,3]),size=abs(cor.vals[,2])*2,colour=cor.vals[,2]),x=Inf,y=Inf,vjust=1,hjust=1,show_guide=FALSE)+\n                scale_colour_gradient(low = \"red\", high=\"blue\")+\n                geom_smooth(method=\"loess\")\n\n        multiplot(m1,m2,cols=1)\n}\n\nindep.dep.cor(d)\n</code></pre>\n"},{"tags":["r","axis","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":12288020,"title":"Need axis under all panels","body":"<p>How do I display axis under all bottom panels? In this example if there is a grid with missing squares the axis are not displayed.    </p>\n\n<pre><code>library(lattice)\narr&lt;- array(replicate(10, rnorm(10)), dim =c(10,10,10) )\ndotplot(arr, type = \"b\", horizontal = F, col = \"red\",\n    main =list( \" Centrality\", cex=1.5), xlab.top=\"\",as.table=T,\n    ylab =list( \"Centralities\", cex=1.3), \n    xlab = list(\"Proportion Cutpoints\"), \n    scale=list(y=list(cex=1.2,  alternating =1), cex =1),\n    auto.key=list(  points = F, border= \"grey\",\n                      space = \"top\", lines = T, columns=4,height=10,\n                      title = \"Technologies\"),\n    par.settings = list(superpose.line = list(col = \"red\", lwd=2, lty=1:6 ),\n                        layout.heights= list(xlab.key.padding = 1), \n                        layout.widths = list(key.ylab.padding = 1)),\n    par.strip.text = list(cex=1.5))\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/ku2YZ.png\" alt=\"Missing labels\"></p>\n"},{"tags":["php","mysql","r","statistics"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12721198,"title":"How to translate this \"R\" formula into MySQL/PHP?","body":"<p>R is used for statistical computing. I don't know statistics never worked with R. I was given this formula in \"R\" to solve a problem, but need help to translate it into either MySQL or PHP. Below is a direct quote:</p>\n\n<p>In R we can compute</p>\n\n<pre><code>x &lt;- matrix(c(-954234, 3589, 43243455, 2521, 149940475, 3939,     243853640, 3936, 262995399, 3025, 751195421, 5333, 10677437299, 7477), ncol=2, byrow=TRUE); y     &lt;- apply(x, 2, sum); y[1] / y[2],\n</code></pre>\n\n<p>producing $406,697 for the average.</p>\n\n<p>Some background information on this. This is data from the IRS 2008 for Income Tax data by zip code. The above data is from a single zip code (10021). The table (please see below). The task is to create an <strong>Average</strong> Adjust Gross Income (AGI), and the above R example is the solution. Thanks!</p>\n\n<pre><code>1 = 'Under $10,000' \n2 = '$10,000 under $25,000' \n3 = '$25,000 under $50,000' \n4 = '$50,000 under $75,000' \n5 = '$75,000 under $100,000' \n6 = '$100,000 under $200,000' \n7 = '$200,000 or more '\n</code></pre>\n\n<p>\"Number of Returns\" is the Number of tax returns for that agi_class. </p>\n\n<pre><code>mysql&gt; select A00100,zipcode,agi_class,N1 as 'Number of Returns' from taxbyzip2008 where zipcode=\"10021\";\n\n+-------------+---------+-----------+-------------------+ \n| A00100      | zipcode | agi_class | Number of Returns | \n+-------------+---------+-----------+-------------------+ \n| -954234     | 10021   | 1         | 3589              | \n| 43243455    | 10021   | 2         | 2521              | \n| 149940475   | 10021   | 3         | 3939              | \n| 243853640   | 10021   | 4         | 3936              | \n| 262995399   | 10021   | 5         | 3025              | \n| 751195421   | 10021   | 6         | 5333              | \n| 10677437299 | 10021   | 7         | 7477              | \n+-------------+---------+-----------+-------------------+\n</code></pre>\n"},{"tags":["r","ggplot2","groups"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12720242,"title":"Plot a 24 hour cycle monthly for multiple variables?","body":"<p>I have data that can be mimicked in the following manner:</p>\n\n<pre><code>set.seed(1234)\n\nfoo &lt;- data.frame(month = rep(month.name, each = 24),\n              hour = rep(seq(1:24), 12),\n              value1 = rnorm(nrow(foo), 60, 1),\n              value2 = rnorm(nrow(foo), 60, 1))\n\nfoo &lt;- melt(foo, id = c('month', 'hour'))\n</code></pre>\n\n<p>I would like to create a plot for the entire year using ggplot that displays the 24 hour cycle of each variable per month.</p>\n\n<p>Here's what I've tried so far:</p>\n\n<pre><code>t.plot &lt;- ggplot(foo,\n             aes(interaction(month,hour), value, group = interaction(variable,hour)))\n\nt.plot &lt;- t.plot + geom_line(aes(colour = variable))\nprint(t.plot)\n</code></pre>\n\n<p>I get this, which throws the data into misalignment. For such a small SD you see that the first 24 values should be nearer to 60, but they are all over the place.  I don't understand what's causing this discrepancy. </p>\n\n<p><a href=\"https://www.dropbox.com/s/rv6uxhe7wk7q35w/foo.png\" rel=\"nofollow\">https://www.dropbox.com/s/rv6uxhe7wk7q35w/foo.png</a></p>\n\n<p>when I plot:</p>\n\n<pre><code>plot(interaction(foo$month,foo$hour)[1:24], foo$value[1:24])\n</code></pre>\n\n<p>I get the shape that I would expect however the xaxis is very strange and not what I was expecting.</p>\n\n<p>Any help?</p>\n"},{"tags":["r","tmux"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12720297,"title":"Can't plot in R from tmux","body":"<p>I'm able to <code>plot()</code> in <code>R</code> from a regular terminal, but I can't do so from a <code>tmux</code> pseudo-tty. <code>png()</code> works fine but I can't write to the monitor.</p>\n\n<p><strong>UPDATE:</strong> Sorry, there's no error message. <code>R</code> merely fails to \"print\" to the monitor.</p>\n\n<p><strong>UPDATE 2:</strong> <kbd>ctrl</kbd>+<kbd>b</kbd> <code>:showenv</code> returns </p>\n\n<pre><code>DISPLAY=:0                                                                     \nSSH_AGENT_PID=1786\n-SSH_ASKPASS\nSSH_AUTH_SOCK=/tmp/ssh-ebteUtjL1719/agent.1719\n-SSH_CONNECTION\nWINDOWID=18928777\nXAUTHORITY=/home/me/.Xauthority\n</code></pre>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12716087,"title":"match two data.frame","body":"<p>I have a situation like this:    </p>\n\n<p>DF1   </p>\n\n<blockquote>\n<pre><code>  COL1   COL2   COL3  ...   \n\n   a      b      c       \n   b      d      b\n   f      e      a\n   g      m      f      \n</code></pre>\n</blockquote>\n\n<p>DF2    </p>\n\n<blockquote>\n  <p>COL<br>\n   a<br>\n   b<br>\n   c<br>\n   d<br>\n   e<br>\n   f<br>\n   g<br>\n   h<br>\n   i<br>\n   l<br>\n   m<br>\n   n<br>\n   o  </p>\n</blockquote>\n\n<p>I would like to match each column of DF1 with the only one column of DF2 and score how many occurrence of DF2 are in each column of DF1. How this can be done?</p>\n\n<p>Thanks in advance,</p>\n\n<p>E.</p>\n"},{"tags":["osx","r"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12719549,"title":"making MacVim work with R - tutorial for beginners","body":"<p>Please,</p>\n\n<p>does anyone know a tutorial for how to execute R codes from MacVim? I found some plugins but I was not even able to install any of them... the instructions usually don't make much sense for beginners.</p>\n\n<p>Thanks!</p>\n"},{"tags":["r","curves"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12268250,"title":"Error: Missing value or an infinity produced when evaluating the model","body":"<p>I am trying to compare Vbert growth curves from several years of fish data. I am following the code provided by: <a href=\"http://www.ncfaculty.net/dogle/fishR/gnrlex/VonBertalanffy/VonBertalanffy.pdf\" rel=\"nofollow\">http://www.ncfaculty.net/dogle/fishR/gnrlex/VonBertalanffy/VonBertalanffy.pdf</a></p>\n\n<p>Specifically the section on VBGM Comparisons between groups. </p>\n\n<p>This code is pretty cut and dry. I am able to run it perfectly with the \"fake\" data that is provided. But when I run it with my own data I get stuck with this line: </p>\n\n<pre><code>fitGen &lt;- nls(vbGen,data=LMB,start=svGen)\n</code></pre>\n\n<p>I get this error code:</p>\n\n<blockquote>\n  <p>Error in numericDeriv(form[[3L]], names(ind), env) :<br>\n  &nbsp; Missing value or an infinity produced when evaluating the model.</p>\n</blockquote>\n\n<p>Does anyone know how to fix it? I have no missing values and do not know how to fix the infinity produced. </p>\n\n<p>Here is my data set:</p>\n\n<pre><code>structure(list(Age = c(1L, 2L, 3L, 5L, 1L, 2L, 3L, 4L, 1L, 2L, \n3L, 4L, 1L, 2L, 3L, 4L, 5L, 1L, 2L, 3L, 4L, 5L, 1L, 2L, 3L, 4L, \n5L, 1L, 2L, 3L, 4L, 5L, 1L, 2L, 3L, 4L, 5L), MM = c(155.79, 296.37, \n325.77, 374.65, 181.46, 258.31, 321.88, 355.6, 139.75, 230.72, \n319.61, 344.84, 130.92, 236.34, 290.53, 360.33, 400.61, 155.33, \n240.87, 315.46, 345.05, 378.2, 134.71, 256.66, 333.71, 362.99, \n381.46, 153.91, 217.21, 287.8, 357.28, 385.62, 222.25, 288.93, \n294.05, 332.79, 367.39), Year = c(2005L, 2005L, 2005L, 2005L, \n2006L, 2006L, 2006L, 2006L, 2007L, 2007L, 2007L, 2007L, 2008L, \n2008L, 2008L, 2008L, 2008L, 2009L, 2009L, 2009L, 2009L, 2009L, \n2010L, 2010L, 2010L, 2010L, 2010L, 2011L, 2011L, 2011L, 2011L, \n2011L, 2012L, 2012L, 2012L, 2012L, 2012L)), .Names = c(\"Age\", \n\"MM\", \"Year\"), class = \"data.frame\", row.names = c(NA, -37L))\n</code></pre>\n\n<p>In case it's helpful here is all my code before this point: </p>\n\n<pre><code>str(LMB) \nMMi=as.integer(MM)\nYearf=as.factor(Year)\nAgei=as.integer(Age)\n( svCom &lt;- vbStarts(MMi~Agei,data=LMB))\n( svGen &lt;- lapply(svCom,rep,2) )\nvbGen &lt;- MMi~Linf[Yearf]*(1-exp(-K[Yearf]*(Age-t0[Yearf]))+error)\nfitGen &lt;- nls(vbGen,data=LMB,start=svGen)\n</code></pre>\n"},{"tags":["r","graphics","plot","lattice"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":95,"score":0,"question_id":12718847,"title":"How to set panel label font size in lattice graphics in R","body":"<p>I've created a lattice plot with three panels. I can control the font size for the axis and tick labels, but I haven't been able to figure out how to increase the font size of the panel labels. Here's a concrete example:</p>\n\n<pre><code># See below for the fake data to run this code\nlibrary(lattice)\nbarchart(choice ~ yes+no+not.app|group, data=data, \n         stack=TRUE, col=c(\"green\",\"red\",\"blue\"), \n         xlim=c(0,100), layout=c(3,1),\n         scales=list(cex=c(1.4,1.4), alternating=3),\n         xlab=list(label=\"Percent of Respondents\", fontsize=20), \n         main=\"\")\n</code></pre>\n\n<p>Here's the graph this code produces. Note how all the fonts are nice and big except for the panel labels (\"Group 1\", \"Group 2\", \"Group 3\"). I've been fishing around R-help and Stack Overflow, but haven't been able to work this one out. Does anyone know the magic incantation?</p>\n\n<p><img src=\"http://i.stack.imgur.com/R9QT0.png\" alt=\"enter image description here\"></p>\n\n<pre><code>data = structure(list(choice = c(\"Choice 1\", \"Choice 1\", \"Choice 1\", \n\"Choice 2\", \"Choice 2\", \"Choice 2\", \"Choice 3\", \"Choice 3\", \"Choice 3\", \n\"Choice 4\", \"Choice 4\", \"Choice 4\"), group = c(\"Group 1\", \"Group 2\", \n\"Group 3\", \"Group 1\", \"Group 2\", \"Group 3\", \"Group 1\", \"Group 2\", \n\"Group 3\", \"Group 1\", \"Group 2\", \"Group 3\"), yes = c(23.53, 20.47, \n22.94, 16.51, 16.54, 16.51, 9.68, 13.39, 10.4, 24.48, 29.92, \n25.54), no = c(41.37, 37.01, 40.52, 48.39, 40.94, 46.94, 55.22, \n44.09, 53.06, 40.42, 27.56, 37.92), not.app = c(35.1, 42.52, \n36.54, 35.1, 42.52, 36.54, 35.1, 42.52, 36.54, 35.1, 42.52, 36.54\n)), .Names = c(\"choice\", \"group\", \"yes\", \"no\", \"not.app\"), row.names = c(NA, \n12L), class = \"data.frame\")\n</code></pre>\n"},{"tags":["r","data.frame"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12718994,"title":"R go through duplicates & choose","body":"<p>I've got a data frame like this:</p>\n\n<pre><code>id date               amt\n1  2012-05-03 10:33   32\n2  2012-06-01 12:49   242\n2  2012-06-05 00:09   43\n3  2012-06-03 05:19   323\n3  2012-06-08 08:45   12\n4  2012-06-09 12:38   32\n5  2012-06-09 10:31   53\n</code></pre>\n\n<p>Now I want to remove the duplicate <code>id</code>'s so that the one with the earliest date is selected. The number of duplicate entries varies. I care only about the first occurrence of each particular <code>id</code> and the corresponding <code>amt</code>, all other entries should be removed. </p>\n\n<p>I understand how I can do this with a loop but I feel there can be a short and elegant solution in R.</p>\n"},{"tags":["r","date"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":12718892,"title":"R remove rows where an entry is not a date","body":"<p>I have a data frame where one column is (meant to be) a date in the form <code>00:00:00.0 yyyy-mm-dd</code>. Most of the entries are, but some are not. Is there a way to delete the rows that contain non-dates? Something like (if the column is \"DATE\")</p>\n\n<pre><code>data &lt;- data[is.Date(DATE)==TRUE,]\n</code></pre>\n\n<p>For example.</p>\n\n<pre><code>Fruit  Date\napple  00:00:00.0 2005-02-01\npear   00:00:00.0 2006-02-01\norange 00:00:00.0 -8-2-402145\nrhino  00:00:00.0 2003-04-21\n</code></pre>\n\n<p>I want</p>\n\n<pre><code>Fruit  Date\napple  00:00:00.0 2005-02-01\npear   00:00:00.0 2006-02-01\nrhino  00:00:00.0 2003-04-21\n</code></pre>\n"},{"tags":["r","list"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":59,"score":1,"question_id":12718472,"title":"How to output a list to file in R","body":"<p>Assume having a list of books with authors , after reading the data into a list \"LS\" I tried to enter it into a file and the output was </p>\n\n<pre><code>&gt; write.table(LS, \"output.txt\")\nError in data.frame(..., title = NULL,  : \n  arguments imply differing number of rows: 1, 0\n\n&gt; write(LS, \"output.txt\")\nError in cat(list(...), file, sep, fill, labels, append) : \n  argument 1 (type 'list') cannot be handled by 'cat'\n</code></pre>\n\n<p>I was able to use dput but I would like the data to be formatted well (no redundancy of repeated keywords all over the file). Any suggestions?\nThanks</p>\n\n<p><strong>UPDATE</strong>\ndput( head (LS, 2))</p>\n\n<pre><code>list(structure(list( title = \"Book 1\", \nauthors = list(structure(c(\"Pooja\", \"Garg\"),\n .Names = c(\"forename\",\"surname\")), \nstructure(c(\"Renu\", \"Rastogi\"), \n.Names = c(\"forename\",\"surname\")))),\n .Names = c(\"title\", \"authors\")), \n\nstructure(list( title = \"Book 2\", \n authors = list(structure(c(\"Barry\", \"Smit\"), .Names = c(\"forename\", \n    \"surname\")), structure(c(\"Tom\", \"Johnston\"), .Names = c(\"forename\", \n    \"surname\")))), .Names = c(\"title\", \"authors\")))\n</code></pre>\n"},{"tags":["r","matrix","similarity","proximity"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12716872,"title":"Fast computation of average proximity in proximity matrix","body":"<p>I've got a similarity matrix between all cases and, in a separate data frame, classes of these cases. I want to compute average similarity between cases from the same class, here is the equation for an example n from class j:</p>\n\n<p><img src=\"http://i.stack.imgur.com/xXFXt.jpg\" alt=\"Average proximity between cases\"></p>\n\n<p>We have to compute a sum of all squared proximities between n and all cases k that come from the same class as n. Link: <a href=\"http://www.stat.berkeley.edu/~breiman/RandomForests/cc_home.htm#outliers\" rel=\"nofollow\">http://www.stat.berkeley.edu/~breiman/RandomForests/cc_home.htm#outliers</a></p>\n\n<p>I implemented that with 2 for loops, but it is really slow. Is there a faster way to do such thing in R?</p>\n\n<p>Thanks.</p>\n\n<p>//DATA (dput)</p>\n\n<p>Data frame with classes:</p>\n\n<pre><code>structure(list(class = structure(c(1L, 2L, 2L, 1L, 3L, 3L, 1L, \n                            1L, 2L, 3L), .Label = c(\"1\", \"2\", \"3\", \"5\", \"6\", \"7\"), class = \"factor\")), .Names = \"class\", row.names = c(NA, \n            -10L), class = \"data.frame\")\n</code></pre>\n\n<p>Proximity matrix (row m and column m correspond to class in row m of data frame above):</p>\n\n<pre><code>structure(c(1, 0.60996875, 0.51775, 0.70571875, 0.581375, 0.42578125, \n0.6595, 0.7134375, 0.645375, 0.468875, 0.60996875, 1, 0.77021875, \n0.55171875, 0.540375, 0.53084375, 0.4943125, 0.462625, 0.7910625, \n0.56321875, 0.51775, 0.77021875, 1, 0.451375, 0.60353125, 0.62353125, \n0.5203125, 0.43934375, 0.6909375, 0.57159375, 0.70571875, 0.55171875, \n0.451375, 1, 0.69196875, 0.59390625, 0.660375, 0.76834375, 0.606875, \n0.65834375, 0.581375, 0.540375, 0.60353125, 0.69196875, 1, 0.7194375, \n0.684, 0.68090625, 0.50553125, 0.60234375, 0.42578125, 0.53084375, \n0.62353125, 0.59390625, 0.7194375, 1, 0.53665625, 0.553125, 0.513, \n0.801625, 0.6595, 0.4943125, 0.5203125, 0.660375, 0.684, 0.53665625, \n1, 0.8456875, 0.52878125, 0.65303125, 0.7134375, 0.462625, 0.43934375, \n0.76834375, 0.68090625, 0.553125, 0.8456875, 1, 0.503, 0.6215, \n0.645375, 0.7910625, 0.6909375, 0.606875, 0.50553125, 0.513, \n0.52878125, 0.503, 1, 0.60653125, 0.468875, 0.56321875, 0.57159375, \n0.65834375, 0.60234375, 0.801625, 0.65303125, 0.6215, 0.60653125, \n1), .Dim = c(10L, 10L))\n</code></pre>\n\n<p>Correct result:</p>\n\n<pre><code>c(2.44197227050781, 2.21901680175781, 2.07063155175781, 2.52448621289062, \n1.88040830957031, 2.16019295703125, 2.58622273828125, 2.81453253222656, \n2.1031745078125, 2.00542063378906)\n</code></pre>\n"},{"tags":["linux","r","multicore","nohup"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":12715982,"title":"Stopping a nohup parallel simulation in R","body":"<p>I need to cancel a parallel processing simulation that I started on a Linux server using R.</p>\n\n<p>Last night I connected to the server using ssh and started the simulation from the shell with the nohup command:\nnohup R CMD BATCH mysimulation.R</p>\n\n<p>The mysimulation.R file uses the mclapply command in the multicore package to spawn additional instances of R to run the simulation in parallel. For instance, when I run top in the shell I see ten different instances of R running, then finishing a run of the simulation, then starting again to continue with the additional simulation replications.</p>\n\n<p>I have almost no experience working directly with a Linux server (the extent of my knowledge is cd, ls, and the nohup command mentioned above). I <a href=\"http://stackoverflow.com/questions/8007380/how-to-kill-a-nohup-process\">searched around a bit</a> for a solution and thought killing the process might work. I tried:</p>\n\n<p>kill -9 mypid (which said it killed the process).</p>\n\n<p>However, the simulation continues to run. I can see the instances of R continuing to run, close, and respawn. Can anyone point me to resources or walk me through the specific steps I need to take to shut down this simulation? Thanks.</p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":89,"score":1,"question_id":12711598,"title":"newbie debugging","body":"<p>I'm trying to debug the <code>cosmo</code> R package because I'm trying to find out where all the motifs are.\nI display some of them printing the \"motif\" variable but I don't know how to show all of the found motifs in one run.</p>\n\n<p><a href=\"http://www.bioconductor.org/packages/2.10/bioc/html/cosmo.html\" rel=\"nofollow\">http://www.bioconductor.org/packages/2.10/bioc/html/cosmo.html</a></p>\n\n<p>I think that they must be in line 366 in \"sites\" variable in cosmo.R: </p>\n\n<pre><code>for (i in 1:com$selNumSites){\n      site &lt;- seqMat[com$alignStarts[i]:(com$alignStarts[i]+com$selWidth-1),\n                     com$alignSeqs[i]]\n      sites &lt;- c(sites, toString(site))\n</code></pre>\n\n<p>But when I try to debug it I need first to load the cosmo library, then read the data and then run cosmo:</p>\n\n<pre><code>library(cosmo)\nseqal &lt;- system.file(\"Exfiles/short702k.FASTA\", package=\"cosmo\")\nres &lt;- cosmo(seqs=seqal, constraints=\"None\", minW=10, maxW=10, models=\"TCM\" )\n</code></pre>\n\n<p>For debugging line 366 I think I should:</p>\n\n<pre><code>library(cosmo)\nseqal &lt;- system.file(\"Exfiles/short702k.FASTA\", package=\"cosmo\")\nsetBreakpoint(\"cosmo.R\",366)\nres &lt;- cosmo(seqs=seqal, constraints=\"None\", minW=10, maxW=10, models=\"TCM\" )\n</code></pre>\n\n<p>But I don't get any value of any variable.. </p>\n\n<p>And it doesn't seem to be the easiest way to get the sites variable values..</p>\n"},{"tags":["r","ggplot2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":100,"score":2,"question_id":12715635,"title":"ggplot2 - bar plot with both stack and dodge","body":"<p>I am trying to create a barplot using <code>ggplot2</code> where I am stacking by one variable and dodging by another.</p>\n\n<p>Here is an example data set:</p>\n\n<pre><code>df=data.frame(\n  year=rep(c(\"2010\",\"2011\"),each=4),\n  treatment=rep(c(\"Impact\",\"Control\")),\n  type=rep(c(\"Phylum1\",\"Phylum2\"),each=2),\n  total=sample(1:100,8))\n</code></pre>\n\n<p>I would like to create a barplot where <code>x=treatment</code>, <code>y=total</code>, the stacked variable is <code>type</code> and the dodged variable is <code>year</code>. Of course I can do one or the other:</p>\n\n<pre><code>ggplot(df,aes(y=total,x=treatment,fill=type))+geom_bar(position=\"dodge\",stat=\"identity\")\n\nggplot(df,aes(y=total,x=treatment,fill=year))+geom_bar(position=\"dodge\",stat=\"identity\")\n</code></pre>\n\n<p>But not both! Thanks to anyone who can provide advice.</p>\n"},{"tags":["r","data.frame","dollar-sign"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":84,"score":-1,"question_id":12389318,"title":"Dollar sign before a variable","body":"<p>I have this sample code to create a new data frame 'new_data' from the existing data frame 'my_data'.</p>\n\n<pre><code>new_data = NULL\nn = 10 #this number correspond to the number of rows in my_data\nconditions = c(\"Bas_A\", \"Bas_T\", \"Oper_A\", \"Oper_T\") # the vector characters correspond to the target column names in my_data\nfor (cond in conditions){\n    for (i in 1:n){\n        new_data &lt;- rbind(new_data, c(cond, my_data$cond[i]))\n    }\n}\n</code></pre>\n\n<p>The problem is that <code>my_data$cond</code> (where cond is a variable, and not the column name) is not accepted.</p>\n\n<p><strong>How can I call a column of a data frame by using, after the dollar sign, a variable value?</strong></p>\n"},{"tags":["r"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":69,"score":0,"question_id":12717728,"title":"Get files number in a dir in R?","body":"<p>in shell ,to make a dir:</p>\n\n<pre><code>mkdir  /home/test\n</code></pre>\n\n<p>then ,to create a file named \".test\" in the \"/home/test\"</p>\n\n<pre><code>a=list.files(path = \"/home/test\",include.dirs = FALSE)\na\ncharacter(0)\na=list.files(path = \"/home/test\",include.dirs = TRUE)\na\ncharacter(0)\na=list.files(path = \"/home/test/\",include.dirs = TRUE)\na\ncharacter(0)\nlist.files(path = '/home/test', all.files=TRUE,inclued.dirs=FALSE)\n[1] \".\"     \"..\"    \".test\"\na=list.files(path = '/home/test', all.files=TRUE)\nlength(a)\n[1] 3\n</code></pre>\n\n<p>how can i get <code>length(a)</code> = 1 using regular expression parameters <code>pattern=</code> in <code>list.files</code> to prune <code>.</code> and <code>..</code></p>\n"},{"tags":["r","function","piecewise"],"answer_count":6,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":774,"score":2,"question_id":8788050,"title":"How to define a piecewise function in R","body":"<p>I want to define a piecewise function using R, however, my R code goes wrong. Any suggestion is welcome.</p>\n\n<pre><code>x&lt;-seq(-5, 5, by=0.01)\n  for (x in -5:5){\n  if (-0.326 &lt; x &lt; 0.652) fx&lt;- 0.632\n  else if (-1.793&lt;x&lt;-1.304) fx&lt;- 0.454  \n  else if (1.630&lt;x&lt;2.119) fx&lt;-0.227  \n  else fx&lt;- 0 }\n</code></pre>\n"},{"tags":["r","scale","ggplot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12716752,"title":"How to scale colour in ggplot for independent layer?","body":"<p>I have a data set that documents the energy use of three buildings.  I have a melted data frame that can be mimicked from the diamonds set:</p>\n\n<pre><code>data &lt;- melt(diamonds[,c('depth','table','cut','color')],id=c('cut','color'))\n</code></pre>\n\n<p>Essentially, I have heating ('depth') and cooling ('table') data for each month('cut') from three different buildings (7 'color' factors).  I would like to plot the three buildings (7 'color' factors) side by side in a bar plot for each month ('cut').  </p>\n\n<p>I want the bars representing either cooling ('table') or heating ('depth') to vary their shade based on the building ('color' factor) while remaining grouped by month ('cut').  This is a bad way to visualize the diamonds data, but should work well for buildings as their heating and cooling months typically don't overlap.  So far I have:</p>\n\n<pre><code>p &lt;- ggplot(data,\n        aes(color,value,group=cut))\np &lt;- p + geom_bar(stat = 'identity',\n              position = 'dodge',\n              aes(fill = variable))\nprint(p)\n</code></pre>\n\n<p>I tried playing with scale_fill_manual, but couldn't think of a strategy that works:</p>\n\n<pre><code>colours &lt;- c('#0000FF', '#0033FF', '#0066FF', '#FF0000', '#FF3300', '#FF6600')\n\np &lt;- p + scale_fill_manual(values = colours,\n                           group = data$variable)\n</code></pre>\n"},{"tags":["r"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12716393,"title":"splitting data.frame cell in R based on a delimeter","body":"<p>I have a data frame like this:</p>\n\n<pre><code>x\n\nTicketID   Application     Impacted_Systems\n1          Web             Online; PeopleSoft, Financials\netc\n</code></pre>\n\n<p>what I like to do is create another data.frame based on x$Impacted_Systems put each items separated by \";\" to its own colum, then compine it with data frame x to graph it.</p>\n\n<p>I have this so far:</p>\n\n<pre><code>data.frame(do.call('rbind', strsplit(as.character(x$Impacted_Systems),';'))) \n</code></pre>\n\n<p>this creates the columns for each string separated by \";\" twice:</p>\n\n<pre><code>X1      X2       X3       X4       X5   X6      X7\n1   Online  PeopleSoft Financials   Online  PeopleSoft Financials           Online\n</code></pre>\n\n<p>any ideas what I am doing wrong? In this particular case there should be only 3 columns, not 7.</p>\n\n<p>I tried this</p>\n\n<pre><code>p&lt;-colsplit(x$Impacted_Systems, \";\") \n</code></pre>\n\n<p>this is expecting names option. The problem is number of impacted systems will vary, it is not fixed.</p>\n"},{"tags":["r","plot","lme4"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":180,"score":1,"question_id":11123147,"title":"dotplot of random effects","body":"<p>I have an generalized mixed effects model such as the following:</p>\n\n<pre><code>d &lt;- data.frame(\n    g = sample(c(\"A\",\"B\",\"C\",\"D\",\"E\"), 250, replace=TRUE),\n    x = runif(250, max=100),\n    y = sample(c(0,1), 250, replace=TRUE)\n)\n\nrequire(lme4)\n\nfm &lt;- lmer(y ~ x + (1 + x | g), data=d, family=binomial)\n</code></pre>\n\n<p>I'd like to plot the random effect of the intercepts using <code>dotplot</code> but without plotting the random slope component of x. My problem is that I can't seem to figure out how to access <em>just</em> the intercept component and not the random slopes.</p>\n\n<p>For example, what I want is the left hand side of this plot:</p>\n\n<pre><code>dotplot(ranef(fm, postVar=TRUE))\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/cYgDH.jpg\" alt=\"enter image description here\"></p>\n\n<p>Using <code>dotplot(ranef(fm, postVar=TRUE)$g[,2])</code> doesn't give me what I want even though I think it should! I've looked at <code>str(fm)</code>, but didn't see anything that helped me get any closer. </p>\n\n<p>Any help and hints would be much appreciated!</p>\n"},{"tags":["r","oop","s4"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":407,"score":3,"question_id":3412942,"title":"In R, how can one make a method of an S4 object that directly adjusts the values inside the slots of that object?","body":"<p>Is there a way to allow a method of an S4 object to directly adjust the values inside the slots of that object without copying the entire object into memory and having to re-write it to the parent environment at the end of the method?  Right now I have an object that has slots where it keeps track of its own state.  I call a method that advances it to the next state, but right now it seems like I have to assign() each value (or a copy of the object invoking the method) back to the parent environment.  As a result, the object oriented code seems to be running <em>a lot</em> slower than code that simply adjusts the various state variables in a loop.</p>\n"},{"tags":["r","s4"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":173,"score":3,"question_id":3466599,"title":"dputting an S4 object","body":"<p>How would a person <code>dput()</code> an S4 object? I tried this</p>\n\n<pre><code>require(sp)\nrequire(splancs)\nplot(0, 0, xlim = c(-100, 100), ylim = c(-100, 100))\npoly.d &lt;- getpoly() #draw a pretty polygon - PRETTY!\npoly.d &lt;- rbind(poly.d, poly.d[1,]) # close the polygon because of Polygons() and its kin\npoly.d &lt;- SpatialPolygons(list(Polygons(list(Polygon(poly.d)), ID = 1)))\npoly.d\ndput(poly.d)\n</code></pre>\n\n<p>Notice that if I <code>dput()</code> an S4 object, I cannot reconstruct it again. Your thoughts?</p>\n"},{"tags":["r","s4"],"answer_count":4,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":365,"score":8,"question_id":9900134,"title":"Is it bad practice to access S4 objects slots directly using @?","body":"<p>This one is almost a philosophical question: is it bad to access and/or set slots of S4 objects directly using <code>@</code>?</p>\n\n<p>I have always been told it was bad practice, and that users should use \"accessor\" S4 methods, and that developers should provide their users with these. But I'd like to know if anybody knows the real deal behind this?</p>\n\n<p>Here's an example using the <code>sp</code> package (but could be generalised for any S4 class):</p>\n\n<pre><code>&gt; library(sp)\n&gt; foo &lt;- data.frame(x = runif(5), y = runif(5), bar = runif(5))\n&gt; coordinates(foo) &lt;- ~x+y\n&gt; class(foo)\n[1] \"SpatialPointsDataFrame\"\nattr(,\"package\")\n[1] \"sp\"\n\n&gt; str(foo)\nFormal class 'SpatialPointsDataFrame' [package \"sp\"] with 5 slots\n  ..@ data       :'data.frame': 5 obs. of  1 variable:\n  .. ..$ bar: num [1:5] 0.621 0.273 0.446 0.174 0.278\n  ..@ coords.nrs : int [1:2] 1 2\n  ..@ coords     : num [1:5, 1:2] 0.885 0.763 0.591 0.709 0.925 ...\n  .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. ..$ : NULL\n  .. .. ..$ : chr [1:2] \"x\" \"y\"\n  ..@ bbox       : num [1:2, 1:2] 0.591 0.155 0.925 0.803\n  .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. ..$ : chr [1:2] \"x\" \"y\"\n  .. .. ..$ : chr [1:2] \"min\" \"max\"\n  ..@ proj4string:Formal class 'CRS' [package \"sp\"] with 1 slots\n  .. .. ..@ projargs: chr NA\n\n&gt; foo@data\n        bar\n1 0.6213783\n2 0.2725903\n3 0.4458229\n4 0.1743419\n5 0.2779656\n&gt; foo@data &lt;- data.frame(bar = letters[1:5], baz = runif(5))\n&gt; foo@data\n  bar        baz\n1   a 0.22877446\n2   b 0.93206667\n3   c 0.28169866\n4   d 0.08616213\n5   e 0.36713750\n</code></pre>\n"},{"tags":["r","s4","gwidgets"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":142,"score":0,"question_id":2835375,"title":"How to patch an S4 method in an R package?","body":"<p>If you find a bug in a package, it's usually possible to patch the problem with <code>fixInNamespace</code>, e.g. <code>fixInNamespace(\"mean.default\", \"base\")</code>.</p>\n\n<p>For S4 methods, I'm not sure how to do it though.  The method I'm looking at is in the <code>gWidgetstcltk</code> package.  You can see the source code with</p>\n\n<pre><code>getMethod(\".svalue\", c(\"gTabletcltk\", \"guiWidgetsToolkittcltk\"))\n</code></pre>\n\n<p>I can't find the methods with <code>fixInNamespace</code>.</p>\n\n<pre><code>fixInNamespace(\".svalue\", \"gWidgetstcltk\")\n\nError in get(subx, envir = ns, inherits = FALSE) : \n  object '.svalue' not found\n</code></pre>\n\n<p>I thought <code>setMethod</code> might do the trick, but</p>\n\n<pre><code>setMethod(\".svalue\", c(\"gTabletcltk\", \"guiWidgetsToolkittcltk\"),\n  definition = function (obj, toolkit, index = NULL, drop = NULL, ...) \n  {\n      widget = getWidget(obj)\n      sel &lt;- unlist(strsplit(tclvalue(tcl(widget, \"selection\")), \n          \" \"))\n      if (length(sel) == 0) {\n          return(NA)\n      }\n      theChildren &lt;- .allChildren(widget)\n      indices &lt;- sapply(sel, function(i) match(i, theChildren))\n      inds &lt;- which(visible(obj))[indices]\n      if (!is.null(index) &amp;&amp; index == TRUE) {\n          return(inds)\n      }\n      if (missing(drop) || is.null(drop)) \n          drop = TRUE\n      chosencol &lt;- tag(obj, \"chosencol\")\n      if (drop) \n          return(obj[inds, chosencol, drop = drop])\n      else return(obj[inds, ])\n  },\n  where = \"package:gWidgetstcltk\"  \n)\n\nError in setMethod(\".svalue\", c(\"gTabletcltk\", \"guiWidgetsToolkittcltk\"),  : \n  the environment \"gWidgetstcltk\" is locked; cannot assign methods for function \".svalue\"\n</code></pre>\n\n<p>Any ideas?</p>\n"}]}
